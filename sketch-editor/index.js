!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("stream"),require("util")):"function"==typeof define&&define.amd?define(["stream","util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).sketchEditor=t(e.require$$0,e.require$$1)}(this,(function(e,t){"use strict";let r;const n=new Uint8Array(16);function i(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(n)}const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));var a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function s(e,t,r){if(a.randomUUID&&!t&&!e)return a.randomUUID();const n=(e=e||{}).random||(e.rng||i)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}(n)}var l,c=100,u=100,h={left:0,top:0,right:"auto",bottom:"auto",width:"auto",height:"auto",lineHeight:"normal",fontFamily:"arial",fontSize:16,fontWeight:400,fontStyle:"normal",visibility:"visible",backgroundColor:[0,0,0,0],color:[0,0,0,1],opacity:1,fill:[],fillOpacity:[],fillEnable:[],fillMode:[],fillRule:"nonzero",stroke:[],strokeEnable:[],strokeWidth:[],strokePosition:[],strokeMode:[],strokeDasharray:[],strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:0,letterSpacing:0,paragraphSpacing:0,textAlign:"left",textVerticalAlign:"top",textDecoration:[],translateX:0,translateY:0,scaleX:1,scaleY:1,rotateZ:0,transformOrigin:["center","center"],booleanOperation:"none",mixBlendMode:"normal",pointerEvents:!0,maskMode:"none",breakMask:!1,blur:"none",shadow:[],shadowEnable:[],innerShadow:[],innerShadowEnable:[],hueRotate:0,saturate:1,brightness:1,contrast:1};function d(e){return Object.assign({},h,e)}!function(e){e.PAGE="page",e.ART_BOARD="artBoard",e.SYMBOL_MASTER="symbolMaster",e.SYMBOL_INSTANCE="symbolInstance",e.GROUP="group",e.BITMAP="bitmap",e.TEXT="text",e.SLICE="slice",e.SHAPE_GROUP="$shapeGroup",e.POLYLINE="$polyline"}(l||(l={}));var f={TAG_NAME:l,getDefaultStyle:d},p=function(e,t){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},p(e,t)};function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var m,g,y,b,x,w,E,_,S,C,T,A,k,M,O,L,R,I,P,F,D,N,B,U,z,X,H,G,j,Y,W,q,V,K,Z=function(){return Z=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Z.apply(this,arguments)};function J(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function Q(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function $(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError,function(e){e[e.Linear=0]="Linear",e[e.Radial=1]="Radial",e[e.Angular=2]="Angular"}(m||(m={})),function(e){e[e.Unmanaged=0]="Unmanaged",e[e.SRGB=1]="SRGB",e[e.P3=2]="P3"}(g||(g={})),function(e){e[e.Color=0]="Color",e[e.Gradient=1]="Gradient",e[e.Pattern=4]="Pattern"}(y||(y={})),function(e){e[e.Center=0]="Center",e[e.Inside=1]="Inside",e[e.Outside=2]="Outside"}(b||(b={})),function(e){e[e.Normal=0]="Normal",e[e.Darken=1]="Darken",e[e.Multiply=2]="Multiply",e[e.ColorBurn=3]="ColorBurn",e[e.Lighten=4]="Lighten",e[e.Screen=5]="Screen",e[e.ColorDodge=6]="ColorDodge",e[e.Overlay=7]="Overlay",e[e.SoftLight=8]="SoftLight",e[e.HardLight=9]="HardLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e[e.PlusDarker=16]="PlusDarker",e[e.PlusLighter=17]="PlusLighter"}(x||(x={})),function(e){e[e.Butt=0]="Butt",e[e.Round=1]="Round",e[e.Projecting=2]="Projecting"}(w||(w={})),function(e){e[e.Miter=0]="Miter",e[e.Round=1]="Round",e[e.Bevel=2]="Bevel"}(E||(E={})),function(e){e[e.Gaussian=0]="Gaussian",e[e.Motion=1]="Motion",e[e.Zoom=2]="Zoom",e[e.Background=3]="Background"}(_||(_={})),function(e){e[e.Tile=0]="Tile",e[e.Fill=1]="Fill",e[e.Stretch=2]="Stretch",e[e.Fit=3]="Fit"}(S||(S={})),function(e){e[e.OpenArrow=0]="OpenArrow",e[e.FilledArrow=1]="FilledArrow",e[e.Line=2]="Line",e[e.OpenCircle=3]="OpenCircle",e[e.FilledCircle=4]="FilledCircle",e[e.OpenSquare=5]="OpenSquare",e[e.FilledSquare=6]="FilledSquare"}(C||(C={})),function(e){e[e.NonZero=0]="NonZero",e[e.EvenOdd=1]="EvenOdd"}(T||(T={})),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(A||(A={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Centered=2]="Centered",e[e.Justified=3]="Justified",e[e.Natural=4]="Natural"}(k||(k={})),function(e){e[e.None=0]="None",e[e.Uppercase=1]="Uppercase",e[e.Lowercase=2]="Lowercase"}(M||(M={})),function(e){e[e.None=0]="None",e[e.Underlined=1]="Underlined"}(O||(O={})),function(e){e[e.None=0]="None",e[e.Strikethrough=1]="Strikethrough"}(L||(L={})),function(e){e[e.None=-1]="None",e[e.Union=0]="Union",e[e.Subtract=1]="Subtract",e[e.Intersection=2]="Intersection",e[e.Difference=3]="Difference"}(R||(R={})),function(e){e.PNG="png",e.JPG="jpg",e.TIFF="tiff",e.EPS="eps",e.PDF="pdf",e.WEBP="webp",e.SVG="svg"}(I||(I={})),function(e){e[e.Suffix=0]="Suffix",e[e.SecondaryPrefix=1]="SecondaryPrefix",e[e.PrimaryPrefix=2]="PrimaryPrefix"}(P||(P={})),function(e){e[e.Scale=0]="Scale",e[e.Width=1]="Width",e[e.Height=2]="Height"}(F||(F={})),function(e){e[e.None=0]="None",e[e.SlideFromLeft=1]="SlideFromLeft",e[e.SlideFromRight=2]="SlideFromRight",e[e.SlideFromBottom=3]="SlideFromBottom",e[e.SlideFromTop=4]="SlideFromTop"}(D||(D={})),function(e){e[e.Undecided=0]="Undecided",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"}(N||(N={})),function(e){e[e.Stretch=0]="Stretch",e[e.PinToEdge=1]="PinToEdge",e[e.Resize=2]="Resize",e[e.Float=3]="Float"}(B||(B={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(U||(U={})),function(e){e[e.Min=0]="Min",e[e.Middle=1]="Middle",e[e.Max=2]="Max"}(z||(z={})),function(e){e[e.Disabled=-1]="Disabled",e[e.Legacy=0]="Legacy",e[e.Rounded=1]="Rounded",e[e.Smooth=2]="Smooth"}(X||(X={})),function(e){e[e.Rounded=0]="Rounded",e[e.RoundedInverted=1]="RoundedInverted",e[e.Angled=2]="Angled",e[e.Squared=3]="Squared"}(H||(H={})),function(e){e[e.None=0]="None",e[e.Straight=1]="Straight",e[e.Mirrored=2]="Mirrored",e[e.Asymmetric=3]="Asymmetric",e[e.Disconnected=4]="Disconnected"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Legacy=1]="Legacy",e[e.ConsistentBaseline=2]="ConsistentBaseline"}(j||(j={})),function(e){e[e.Flexible=0]="Flexible",e[e.Fixed=1]="Fixed",e[e.FixedWidthAndHeight=2]="FixedWidthAndHeight"}(Y||(Y={})),function(e){e[e.Local=0]="Local",e[e.Workspace=1]="Workspace",e[e.ThirdParty=2]="ThirdParty"}(W||(W={})),function(e){e.PublicRelease="com.bohemiancoding.sketch3",e.Beta="com.bohemiancoding.sketch3.beta",e.Private="com.bohemiancoding.sketch3.private",e.FeaturePreview="com.bohemiancoding.sketch3.feature-preview",e.Internal="com.bohemiancoding.sketch3.internal",e.Experimental="com.bohemiancoding.sketch3.experimental",e.Testing="com.bohemiancoding.sketch3.testing"}(q||(q={})),function(e){e[e.True=0]="True",e[e.False=1]="False"}(V||(V={})),function(e){e.MSImmutableColorAsset="MSImmutableColorAsset",e.MSImmutableDocumentLibraryInfo="MSImmutableDocumentLibraryInfo",e.MSImmutableFlowConnection="MSImmutableFlowConnection",e.MSImmutableForeignLayerStyle="MSImmutableForeignLayerStyle",e.MSImmutableForeignSwatch="MSImmutableForeignSwatch",e.MSImmutableForeignSymbol="MSImmutableForeignSymbol",e.MSImmutableForeignTextStyle="MSImmutableForeignTextStyle",e.MSImmutableFreeformGroupLayout="MSImmutableFreeformGroupLayout",e.MSImmutableGradientAsset="MSImmutableGradientAsset",e.MSImmutableHotspotLayer="MSImmutableHotspotLayer",e.MSImmutableInferredGroupLayout="MSImmutableInferredGroupLayout",e.MSImmutableOverrideProperty="MSImmutableOverrideProperty",e.MSImmutablePatchInfo="MSImmutablePatchInfo",e.MSImmutablePrototypeViewport="MSImmutablePrototypeViewport",e.MSJSONFileReference="MSJSONFileReference",e.MSJSONOriginalDataReference="MSJSONOriginalDataReference",e.Artboard="artboard",e.AssetCollection="assetCollection",e.AttributedString="attributedString",e.Bitmap="bitmap",e.Blur="blur",e.Border="border",e.BorderOptions="borderOptions",e.Color="color",e.ColorControls="colorControls",e.CurvePoint="curvePoint",e.ExportFormat="exportFormat",e.ExportOptions="exportOptions",e.Fill="fill",e.FontDescriptor="fontDescriptor",e.FontReference="fontReference",e.Gradient="gradient",e.GradientStop="gradientStop",e.GraphicsContextSettings="graphicsContextSettings",e.Group="group",e.ImageCollection="imageCollection",e.InnerShadow="innerShadow",e.LayoutGrid="layoutGrid",e.Oval="oval",e.OverrideValue="overrideValue",e.Page="page",e.ParagraphStyle="paragraphStyle",e.Polygon="polygon",e.Rect="rect",e.Rectangle="rectangle",e.RulerData="rulerData",e.Shadow="shadow",e.ShapeGroup="shapeGroup",e.ShapePath="shapePath",e.SharedStyle="sharedStyle",e.SharedStyleContainer="sharedStyleContainer",e.SharedTextStyleContainer="sharedTextStyleContainer",e.SimpleGrid="simpleGrid",e.Slice="slice",e.Star="star",e.StringAttribute="stringAttribute",e.Style="style",e.Swatch="swatch",e.SwatchContainer="swatchContainer",e.SymbolContainer="symbolContainer",e.SymbolInstance="symbolInstance",e.SymbolMaster="symbolMaster",e.Text="text",e.TextStyle="textStyle",e.Triangle="triangle"}(K||(K={}));var ee=Object.freeze({__proto__:null,get AnimationType(){return D},get BlendMode(){return x},get BlurType(){return _},get BooleanOperation(){return R},get BorderPosition(){return b},get BundleId(){return q},get ClassValue(){return K},get ColorSpace(){return g},get CornerStyle(){return H},get CurveMode(){return G},get DocumentLibraryType(){return W},get ExportFileFormat(){return I},get ExportFormatNamingScheme(){return P},get FillType(){return y},get GradientType(){return m},get InferredLayoutAnchor(){return z},get InferredLayoutAxis(){return U},get LayerListExpanded(){return N},get LineCapStyle(){return w},get LineJoinStyle(){return E},get LineSpacingBehaviour(){return j},get MarkerType(){return C},get NumericalBool(){return V},get PatternFillType(){return S},get PointsRadiusBehaviour(){return X},get ResizeType(){return B},get StrikethroughStyle(){return L},get TextBehaviour(){return Y},get TextHorizontalAlignment(){return k},get TextTransform(){return M},get TextVerticalAlignment(){return A},get UnderlineStyle(){return O},get VisibleScaleType(){return F},get WindingRule(){return T}}),te="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function re(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ne,ie,oe,ae={},se={},le={},ce={exports:{}},ue={exports:{}};function he(){if(ne)return ue.exports;return ne=1,"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?ue.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,a=arguments.length;switch(a){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function(){e.call(null,t)}));case 3:return process.nextTick((function(){e.call(null,t,r)}));case 4:return process.nextTick((function(){e.call(null,t,r,n)}));default:for(i=new Array(a-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick((function(){e.apply(null,i)}))}}}:ue.exports=process,ue.exports}var de,fe,pe,ve={exports:{}};function me(){if(de)return ve.exports;de=1;var e,t="object"==typeof Reflect?Reflect:null,r=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}ve.exports=i,ve.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}p(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,r)}(e,i,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,o,l,c;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),l=o[t]),void 0===l)l=o[t]=r,++e._eventsCount;else if("function"==typeof l?l=o[t]=n?[r,l]:[l,r]:n?l.unshift(r):l.push(r),(i=s(e))>0&&l.length>i&&!l.warned){l.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=l.length,c=u,console&&console.warn&&console.warn(c)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=c.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)r(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},ve.exports}function ge(){return pe?fe:(pe=1,fe=e)}for(var ye={exports:{}},be={},xe={byteLength:function(e){var t=ke(e),r=t[0],n=t[1];return 3*(r+n)/4-n}},we=xe.toByteArray=function(e){var t,r,n=ke(e),i=n[0],o=n[1],a=new Ce(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=Se[e.charCodeAt(r)]<<18|Se[e.charCodeAt(r+1)]<<12|Se[e.charCodeAt(r+2)]<<6|Se[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=Se[e.charCodeAt(r)]<<2|Se[e.charCodeAt(r+1)]>>4,a[s++]=255&t);1===o&&(t=Se[e.charCodeAt(r)]<<10|Se[e.charCodeAt(r+1)]<<4|Se[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},Ee=xe.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(Me(e,a,a+o>s?s:a+o));1===n?(t=e[r-1],i.push(_e[t>>2]+_e[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(_e[t>>10]+_e[t>>4&63]+_e[t<<2&63]+"="));return i.join("")},_e=[],Se=[],Ce="undefined"!=typeof Uint8Array?Uint8Array:Array,Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=0;Ae<64;++Ae)_e[Ae]=Te[Ae],Se[Te.charCodeAt(Ae)]=Ae;function ke(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Me(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(_e[(i=n)>>18&63]+_e[i>>12&63]+_e[i>>6&63]+_e[63&i]);return o.join("")}Se["-".charCodeAt(0)]=62,Se["_".charCodeAt(0)]=63;var Oe,Le,Re,Ie={};
  /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Pe(){return Le||(Le=1,function(e){var t=xe,r=(Oe||(Oe=1,Ie.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=c}return(f?-1:1)*a*Math.pow(2,o-n)},Ie.write=function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+f]=255&a,f+=p,a/=256,c-=8);e[r+f-p]|=128*v}),Ie),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|f(e,t),n=o(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(U(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(U(e,ArrayBuffer)||e&&U(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(U(e,SharedArrayBuffer)||e&&U(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=function(e){if(a.isBuffer(e)){var t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||z(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),o(e<0?0:0|d(e))}function u(e){for(var t=e.length<0?0:0|d(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,a.prototype),n}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||U(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(i)return n?-1:D(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return _(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function y(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(z(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return B(D(t,e.length-r),e,r,n)}function x(e,t,r,n){return B(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return B(N(t),e,r,n)}function E(e,t,r,n){return B(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function _(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function S(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,c=e[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),U(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(U(o,Uint8Array))i+o.length>n.length?a.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),l=Math.min(o,s),c=this.slice(n,i),u=e.slice(t,r),h=0;h<l;++h)if(c[h]!==u[h]){o=c[h],s=u[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return x(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=X[e[o]];return i}function M(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(e,t,n,i,o){return t=+t,n>>>=0,o||R(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function P(e,t,n,i,o){return t=+t,n>>>=0,o||R(e,0,n,8),r.write(e,t,n,i,52,8),n+8}a.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),r.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%l]}return this};var F=/[^+/0-9A-Za-z-_]/g;function D(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function N(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function U(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function z(e){return e!=e}var X=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()}(be)),be}function Fe(){return Re||(Re=1,function(e,t){var r=Pe(),n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(ye,ye.exports)),ye.exports}var De,Ne={};function Be(){if(De)return Ne;function e(e){return Object.prototype.toString.call(e)}return De=1,Ne.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},Ne.isBoolean=function(e){return"boolean"==typeof e},Ne.isNull=function(e){return null===e},Ne.isNullOrUndefined=function(e){return null==e},Ne.isNumber=function(e){return"number"==typeof e},Ne.isString=function(e){return"string"==typeof e},Ne.isSymbol=function(e){return"symbol"==typeof e},Ne.isUndefined=function(e){return void 0===e},Ne.isRegExp=function(t){return"[object RegExp]"===e(t)},Ne.isObject=function(e){return"object"==typeof e&&null!==e},Ne.isDate=function(t){return"[object Date]"===e(t)},Ne.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},Ne.isFunction=function(e){return"function"==typeof e},Ne.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},Ne.isBuffer=Pe().Buffer.isBuffer,Ne}var Ue,ze,Xe={exports:{}},He={exports:{}};function Ge(){if(ze)return Xe.exports;ze=1;try{var e=require("util");if("function"!=typeof e.inherits)throw"";Xe.exports=e.inherits}catch(e){Xe.exports=(Ue||(Ue=1,"function"==typeof Object.create?He.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:He.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),He.exports)}return Xe.exports}var je,Ye,We,qe,Ve,Ke,Ze,Je,Qe,$e={exports:{}};function et(){return je||(je=1,function(e){var r=Fe().Buffer,n=t;e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);for(var t,n,i,o=r.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=o,i=s,t.copy(n,i),s+=a.data.length,a=a.next;return o},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})}($e)),$e.exports}function tt(){if(We)return Ye;We=1;var e=he();function t(e,t){e.emit("error",t)}return Ye={destroy:function(r,n){var i=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(n?n(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(t,this,r)):e.nextTick(t,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,(function(r){!n&&r?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,e.nextTick(t,i,r)):e.nextTick(t,i,r):n&&n(r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},Ye}function rt(){if(Ze)return Ke;Ze=1;var e=he();function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}Ke=p;var n,i=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:e.nextTick;p.WritableState=f;var o=Object.create(Be());o.inherits=Ge();var a={deprecate:Ve?qe:(Ve=1,qe=t.deprecate)},s=ge(),l=Fe().Buffer,c=(void 0!==te?te:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var u,h=tt();function d(){}function f(t,o){n=n||nt(),t=t||{};var a=o instanceof n;this.objectMode=!!t.objectMode,a&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var s=t.highWaterMark,l=t.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:a&&(l||0===l)?l:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===t.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,r){var n=t._writableState,o=n.sync,a=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),r)!function(t,r,n,i,o){--r.pendingcb,n?(e.nextTick(o,i),e.nextTick(x,t,r),t._writableState.errorEmitted=!0,t.emit("error",i)):(o(i),t._writableState.errorEmitted=!0,t.emit("error",i),x(t,r))}(t,n,o,r,a);else{var s=y(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||g(t,n),o?i(m,t,n,s,a):m(t,n,s,a)}}(o,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function p(e){if(n=n||nt(),!(u.call(p,this)||this instanceof n))return new p(e);this._writableState=new f(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function v(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function m(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),x(e,t)}function g(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,v(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(v(e,t,!1,t.objectMode?1:c.length,c,u,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function y(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),x(e,t)}))}function x(t,r){var n=y(r);return n&&(!function(t,r){r.prefinished||r.finalCalled||("function"==typeof t._final?(r.pendingcb++,r.finalCalled=!0,e.nextTick(b,t,r)):(r.prefinished=!0,t.emit("prefinish")))}(t,r),0===r.pendingcb&&(r.finished=!0,t.emit("finish"))),n}return o.inherits(p,s),f.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(f.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(p,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===p&&(e&&e._writableState instanceof f)}})):u=function(e){return e instanceof this},p.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},p.prototype.write=function(t,r,n){var i,o=this._writableState,a=!1,s=!o.objectMode&&(i=t,l.isBuffer(i)||i instanceof c);return s&&!l.isBuffer(t)&&(t=function(e){return l.from(e)}(t)),"function"==typeof r&&(n=r,r=null),s?r="buffer":r||(r=o.defaultEncoding),"function"!=typeof n&&(n=d),o.ended?function(t,r){var n=new Error("write after end");t.emit("error",n),e.nextTick(r,n)}(this,n):(s||function(t,r,n,i){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||r.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),e.nextTick(i,a),o=!1),o}(this,o,t,n))&&(o.pendingcb++,a=function(e,t,r,n,i,o){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var s=t.objectMode?1:n.length;t.length+=s;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,s,n,i,o);return c}(this,o,s,t,r,n)),a},p.prototype.cork=function(){this._writableState.corked++},p.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||g(this,e))},p.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),p.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},p.prototype._writev=null,p.prototype.end=function(t,r,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,r=null):"function"==typeof r&&(n=r,r=null),null!=t&&this.write(t,r),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,r,n){r.ending=!0,x(t,r),n&&(r.finished?e.nextTick(n):t.once("finish",n));r.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(p.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),p.prototype.destroy=h.destroy,p.prototype._undestroy=h.undestroy,p.prototype._destroy=function(e,t){this.end(),t(e)},Ke}function nt(){if(Qe)return Je;Qe=1;var e=he(),t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};Je=l;var r=Object.create(Be());r.inherits=Ge();var n=pt(),i=rt();r.inherits(l,n);for(var o=t(i.prototype),a=0;a<o.length;a++){var s=o[a];l.prototype[s]||(l.prototype[s]=i.prototype[s])}function l(e){if(!(this instanceof l))return new l(e);n.call(this,e),i.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||e.nextTick(u,this)}function u(e){e.end()}return Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),l.prototype._destroy=function(t,r){this.push(null),this.end(),e.nextTick(r,t)},Je}var it,ot,at,st,lt,ct,ut,ht,dt={};function ft(){if(it)return dt;it=1;var e=Fe().Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(r){var n;switch(this.encoding=function(r){var n=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(r);if("string"!=typeof n&&(e.isEncoding===t||!t(r)))throw new Error("Unknown encoding: "+r);return n||r}(r),this.encoding){case"utf16le":this.text=o,this.end=a,n=4;break;case"utf8":this.fillLast=i,n=4;break;case"base64":this.text=s,this.end=l,n=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(n)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function o(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function a(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function s(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function c(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}return dt.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},r.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var o=n(t[i]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(e.lastNeed=o-2),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},dt}function pt(){if(at)return ot;at=1;var e=he();ot=m;var r,n=function(){if(oe)return ie;oe=1;var e={}.toString;return ie=Array.isArray||function(t){return"[object Array]"==e.call(t)}}();m.ReadableState=v,me().EventEmitter;var i=function(e,t){return e.listeners(t).length},o=ge(),a=Fe().Buffer,s=(void 0!==te?te:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l=Object.create(Be());l.inherits=Ge();var c=t,u=void 0;u=c&&c.debuglog?c.debuglog("stream"):function(){};var h,d=et(),f=tt();l.inherits(m,o);var p=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var n=t instanceof(r=r||nt());this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=ft().StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function m(e){if(r=r||nt(),!(this instanceof m))return new m(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function g(e,t,r,n,i){var o,l=e._readableState;null===t?(l.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,w(e)}(e,l)):(i||(o=function(e,t){var r;n=t,a.isBuffer(n)||n instanceof s||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(l,t)),o?e.emit("error",o):l.objectMode||t&&t.length>0?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n?l.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):y(e,l,t,!0):l.ended?e.emit("error",new Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?y(e,l,t,!1):_(e,l)):y(e,l,t,!1))):n||(l.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(l)}function y(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),_(e,t)}Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),m.prototype.destroy=f.destroy,m.prototype._undestroy=f.undestroy,m.prototype._destroy=function(e,t){this.push(null),t(e)},m.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),r=!0),g(this,e,t,!1,r)},m.prototype.unshift=function(e){return g(this,e,null,!0,!1)},m.prototype.isPaused=function(){return!1===this._readableState.flowing},m.prototype.setEncoding=function(e){return h||(h=ft().StringDecoder),this._readableState.decoder=new h(e),this._readableState.encoding=e,this};var b=8388608;function x(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=b?e=b:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(t){var r=t._readableState;r.needReadable=!1,r.emittedReadable||(u("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?e.nextTick(E,t):E(t))}function E(e){u("emit readable"),e.emit("readable"),A(e)}function _(t,r){r.readingMore||(r.readingMore=!0,e.nextTick(S,t,r))}function S(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(u("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function C(e){u("readable nexttick read 0"),e.read(0)}function T(e,t){t.reading||(u("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function k(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=a.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function M(t){var r=t._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,e.nextTick(O,r,t))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}return m.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?M(this):w(this),null;if(0===(e=x(e,t))&&t.ended)return 0===t.length&&M(this),null;var n,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=x(r,t))),null===(n=e>0?k(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&M(this)),null!==n&&this.emit("data",n),n},m.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},m.prototype.pipe=function(t,r){var o=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,u("pipe count=%d opts=%j",a.pipesCount,r);var s=(!r||!1!==r.end)&&t!==process.stdout&&t!==process.stderr?c:y;function l(e,r){u("onunpipe"),e===o&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,u("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",h),t.removeListener("error",v),t.removeListener("unpipe",l),o.removeListener("end",c),o.removeListener("end",y),o.removeListener("data",p),d=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}function c(){u("onend"),t.end()}a.endEmitted?e.nextTick(s):o.once("end",s),t.on("unpipe",l);var h=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,A(e))}}(o);t.on("drain",h);var d=!1;var f=!1;function p(e){u("ondata"),f=!1,!1!==t.write(e)||f||((1===a.pipesCount&&a.pipes===t||a.pipesCount>1&&-1!==L(a.pipes,t))&&!d&&(u("false write response, pause",a.awaitDrain),a.awaitDrain++,f=!0),o.pause())}function v(e){u("onerror",e),y(),t.removeListener("error",v),0===i(t,"error")&&t.emit("error",e)}function m(){t.removeListener("finish",g),y()}function g(){u("onfinish"),t.removeListener("close",m),y()}function y(){u("unpipe"),o.unpipe(t)}return o.on("data",p),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(t,"error",v),t.once("close",m),t.once("finish",g),t.emit("pipe",o),a.flowing||(u("pipe resume"),o.resume()),t},m.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=L(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},m.prototype.on=function(t,r){var n=o.prototype.on.call(this,t,r);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):e.nextTick(C,this))}return n},m.prototype.addListener=m.prototype.on,m.prototype.resume=function(){var t=this._readableState;return t.flowing||(u("resume"),t.flowing=!0,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(T,t,r))}(this,t)),this},m.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this},m.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<p.length;o++)e.on(p[o],this.emit.bind(this,p[o]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(m.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),m._fromList=k,ot}function vt(){if(lt)return st;lt=1,st=n;var e=nt(),t=Object.create(Be());function r(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(t){if(!(this instanceof n))return new n(t);e.call(this,t),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",i)}function i(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){o(e,t,r)})):o(this,null,null)}function o(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}return t.inherits=Ge(),t.inherits(n,e),n.prototype.push=function(t,r){return this._transformState.needTransform=!1,e.prototype.push.call(this,t,r)},n.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},n.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},n.prototype._destroy=function(t,r){var n=this;e.prototype._destroy.call(this,t,(function(e){r(e),n.emit("close")}))},st}function mt(){return ht||(ht=1,function(t,r){var n=e;"disable"===process.env.READABLE_STREAM&&n?(t.exports=n,(r=t.exports=n.Readable).Readable=n.Readable,r.Writable=n.Writable,r.Duplex=n.Duplex,r.Transform=n.Transform,r.PassThrough=n.PassThrough,r.Stream=n):((r=t.exports=pt()).Stream=n||r,r.Readable=r,r.Writable=rt(),r.Duplex=nt(),r.Transform=vt(),r.PassThrough=function(){if(ut)return ct;ut=1,ct=r;var e=vt(),t=Object.create(Be());function r(t){if(!(this instanceof r))return new r(t);e.call(this,t)}return t.inherits=Ge(),t.inherits(r,e),r.prototype._transform=function(e,t,r){r(null,e)},ct}())}(ce,ce.exports)),ce.exports}if(le.base64=!0,le.array=!0,le.string=!0,le.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,le.nodebuffer="undefined"!=typeof Buffer,le.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)le.blob=!1;else{var gt=new ArrayBuffer(0);try{le.blob=0===new Blob([gt],{type:"application/zip"}).size}catch(e){try{var yt=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);yt.append(gt),le.blob=0===yt.getBlob("application/zip").size}catch(e){le.blob=!1}}}try{le.nodestream=!!mt().Readable}catch(e){le.nodestream=!1}var bt,xt={};function wt(){if(bt)return xt;bt=1;var e=Ot(),t=le,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return xt.encode=function(t){for(var n,i,o,a,s,l,c,u=[],h=0,d=t.length,f=d,p="string"!==e.getTypeOf(t);h<t.length;)f=d-h,p?(n=t[h++],i=h<d?t[h++]:0,o=h<d?t[h++]:0):(n=t.charCodeAt(h++),i=h<d?t.charCodeAt(h++):0,o=h<d?t.charCodeAt(h++):0),a=n>>2,s=(3&n)<<4|i>>4,l=f>1?(15&i)<<2|o>>6:64,c=f>2?63&o:64,u.push(r.charAt(a)+r.charAt(s)+r.charAt(l)+r.charAt(c));return u.join("")},xt.decode=function(e){var n,i,o,a,s,l,c=0,u=0,h="data:";if(e.substr(0,5)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&f--,e.charAt(e.length-2)===r.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=t.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)n=r.indexOf(e.charAt(c++))<<2|(a=r.indexOf(e.charAt(c++)))>>4,i=(15&a)<<4|(s=r.indexOf(e.charAt(c++)))>>2,o=(3&s)<<6|(l=r.indexOf(e.charAt(c++))),d[u++]=n,64!==s&&(d[u++]=i),64!==l&&(d[u++]=o);return d},xt}var Et,_t,St,Ct,Tt={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}};var At=null;At="undefined"!=typeof Promise?Promise:function(){if(Ct)return St;Ct=1;var e=function(){if(_t)return Et;_t=1;var e,t,r=te.MutationObserver||te.WebKitMutationObserver;if(process.browser)if(r){var n=0,i=new r(l),o=te.document.createTextNode("");i.observe(o,{characterData:!0}),e=function(){o.data=n=++n%2}}else if(te.setImmediate||void 0===te.MessageChannel)e="document"in te&&"onreadystatechange"in te.document.createElement("script")?function(){var e=te.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},te.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var a=new te.MessageChannel;a.port1.onmessage=l,e=function(){a.port2.postMessage(0)}}else e=function(){process.nextTick(l)};var s=[];function l(){var e,r;t=!0;for(var n=s.length;n;){for(r=s,s=[],e=-1;++e<n;)r[e]();n=s.length}t=!1}return Et=function(r){1!==s.push(r)||t||e()}}();function t(){}var r={},n=["REJECTED"],i=["FULFILLED"],o=["PENDING"];if(!process.browser)var a=["UNHANDLED"];function s(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=o,this.queue=[],this.outcome=void 0,process.browser||(this.handled=a),e!==t&&h(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function c(t,n,i){e((function(){var e;try{e=n(i)}catch(e){return r.reject(t,e)}e===t?r.reject(t,new TypeError("Cannot resolve promise with itself")):r.resolve(t,e)}))}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function i(t){n||(n=!0,r.reject(e,t))}function o(t){n||(n=!0,r.resolve(e,t))}var a=d((function(){t(o,i)}));"error"===a.status&&i(a.value)}function d(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}return St=s,s.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,r){if("function"!=typeof e&&this.state===i||"function"!=typeof r&&this.state===n)return this;var s=new this.constructor(t);return process.browser||this.handled===a&&(this.handled=null),this.state!==o?c(s,this.state===i?e:r,this.outcome):this.queue.push(new l(s,e,r)),s},l.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){c(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){r.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){c(this.promise,this.onRejected,e)},r.resolve=function(e,t){var n=d(u,t);if("error"===n.status)return r.reject(e,n.value);var o=n.value;if(o)h(e,o);else{e.state=i,e.outcome=t;for(var a=-1,s=e.queue.length;++a<s;)e.queue[a].callFulfilled(t)}return e},r.reject=function(t,r){t.state=n,t.outcome=r,process.browser||t.handled===a&&e((function(){t.handled===a&&process.emit("unhandledRejection",r,t)}));for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callRejected(r);return t},s.resolve=function(e){return e instanceof this?e:r.resolve(new this(t),e)},s.reject=function(e){var n=new this(t);return r.reject(n,e)},s.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var a=new Array(i),s=0,l=-1,c=new this(t);++l<i;)u(e[l],l);return c;function u(e,t){n.resolve(e).then((function(e){a[t]=e,++s!==i||o||(o=!0,r.resolve(c,a))}),(function(e){o||(o=!0,r.reject(c,e))}))}},s.race=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var a,s=-1,l=new this(t);++s<i;)a=e[s],n.resolve(a).then((function(e){o||(o=!0,r.resolve(l,e))}),(function(e){o||(o=!0,r.reject(l,e))}));return l},St}();var kt,Mt={Promise:At};function Ot(){return kt||(kt=1,function(e){var t=le,r=wt(),n=Tt,i=Mt;function o(e){return e}function a(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e.newBlob=function(t,r){e.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(e,t,r){var n=[],i=0,o=e.length;if(o<=r)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,o)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,o)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return t.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return t.nodebuffer&&1===String.fromCharCode.apply(null,n.allocBuffer(1)).length}catch(e){return!1}}()}};function l(t){var r=65536,n=e.getTypeOf(t),i=!0;if("uint8array"===n?i=s.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=s.applyCanBeUsed.nodebuffer),i)for(;r>1;)try{return s.stringifyByChunk(t,n,r)}catch(e){r=Math.floor(r/2)}return s.stringifyByChar(t)}function c(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}e.applyFromCharCode=l;var u={};u.string={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,n.allocBuffer(e.length))}},u.array={string:l,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(e)}},u.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return c(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return n.newBufferFrom(e)}},u.nodebuffer={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:o},e.transformTo=function(t,r){if(r||(r=""),!t)return r;e.checkSupport(t);var n=e.getTypeOf(r);return u[n][t](r)},e.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},e.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":t.nodebuffer&&n.isBuffer(e)?"nodebuffer":t.uint8array&&e instanceof Uint8Array?"uint8array":t.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},e.checkSupport=function(e){if(!t[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},e.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},e.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r},e.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},e.prepareContent=function(n,o,s,l,c){var u=i.Promise.resolve(o).then((function(e){return t.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new i.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e}));return u.then((function(o){var u,h=e.getTypeOf(o);return h?("arraybuffer"===h?o=e.transformTo("uint8array",o):"string"===h&&(c?o=r.decode(o):s&&!0!==l&&(o=a(u=o,t.uint8array?new Uint8Array(u.length):new Array(u.length)))),o):i.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}}(se)),se}function Lt(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}!function(e,t){if(!e.setImmediate){var r,n,i,o,a=1,s={},l=!1,c=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(i="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&d(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){d(e.data)},r=function(e){n.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?function(){var e=c.documentElement;r=function(t){var r=c.createElement("script");r.onreadystatechange=function(){d(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():r=function(e){setTimeout(d,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return s[a]=i,r(a),a++},u.clearImmediate=h}function h(e){delete s[e]}function d(e){if(l)setTimeout(d,0,e);else{var r=s[e];if(r){l=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{h(e),l=!1}}}}}("undefined"==typeof self?te:self),Lt.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};var Rt=Lt;!function(e){for(var t=Ot(),r=le,n=Tt,i=Rt,o=new Array(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1;function s(){i.call(this,"utf-8 decode"),this.leftOver=null}function l(){i.call(this,"utf-8 encode")}e.utf8encode=function(e){return r.nodebuffer?n.newBufferFrom(e,"utf-8"):function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},e.utf8decode=function(e){return r.nodebuffer?t.transformTo("nodebuffer",e).toString("utf-8"):function(e){var r,n,i,a,s=e.length,l=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)l[n++]=i;else if((a=o[i])>4)l[n++]=65533,r+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&r<s;)i=i<<6|63&e[r++],a--;a>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),t.applyFromCharCode(l)}(e=t.transformTo(r.uint8array?"uint8array":"array",e))},t.inherits(s,i),s.prototype.processChunk=function(n){var i=t.transformTo(r.uint8array?"uint8array":"array",n.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=i;(i=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),i.set(a,this.leftOver.length)}else i=this.leftOver.concat(i);this.leftOver=null}var s=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}(i),l=i;s!==i.length&&(r.uint8array?(l=i.subarray(0,s),this.leftOver=i.subarray(s,i.length)):(l=i.slice(0,s),this.leftOver=i.slice(s,i.length))),this.push({data:e.utf8decode(l),meta:n.meta})},s.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=s,t.inherits(l,i),l.prototype.processChunk=function(t){this.push({data:e.utf8encode(t.data),meta:t.meta})},e.Utf8EncodeWorker=l}(ae);var It=Rt,Pt=Ot();function Ft(e){It.call(this,"ConvertWorker to "+e),this.destType=e}Pt.inherits(Ft,It),Ft.prototype.processChunk=function(e){this.push({data:Pt.transformTo(this.destType,e.data),meta:e.meta})};var Dt,Nt,Bt=Ft;var Ut=Ot(),zt=Bt,Xt=Rt,Ht=wt(),Gt=Mt,jt=null;if(le.nodestream)try{jt=function(){if(Nt)return Dt;Nt=1;var e=mt().Readable;function t(t,r,n){e.call(this,r),this._helper=t;var i=this;t.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}return Ot().inherits(t,e),t.prototype._read=function(){this._helper.resume()},Dt=t}()}catch(e){}function Yt(e,t){return new Gt.Promise((function(r,n){var i=[],o=e._internalType,a=e._outputType,s=e._mimeType;e.on("data",(function(e,r){i.push(e),t&&t(r)})).on("error",(function(e){i=[],n(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return Ut.newBlob(Ut.transformTo("arraybuffer",t),r);case"base64":return Ht.encode(t);default:return Ut.transformTo(e,t)}}(a,function(e,t){var r,n=0,i=null,o=0;for(r=0;r<t.length;r++)o+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,i),s);r(e)}catch(e){n(e)}i=[]})).resume()}))}function Wt(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=t,this._mimeType=r,Ut.checkSupport(n),this._worker=e.pipe(new zt(n)),e.lock()}catch(e){this._worker=new Xt("error"),this._worker.error(e)}}Wt.prototype={accumulate:function(e){return Yt(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){Ut.delay(t,arguments,r)})),this},resume:function(){return Ut.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(Ut.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new jt(this,{objectMode:"nodebuffer"!==this._outputType},e)}};var qt=Wt,Vt={base64:!1,binary:!1,dir:!1,createFolders:!0,date:null,compression:null,compressionOptions:null,comment:null,unixPermissions:null,dosPermissions:null},Kt=Ot(),Zt=Rt;function Jt(e){Zt.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=Kt.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}Kt.inherits(Jt,Zt),Jt.prototype.cleanUp=function(){Zt.prototype.cleanUp.call(this),this.data=null},Jt.prototype.resume=function(){return!!Zt.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Kt.delay(this._tickAndRepeat,[],this)),!0)},Jt.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(Kt.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},Jt.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};var Qt=Jt,$t=Ot();var er=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var tr=function(e,t){return void 0!==e&&e.length?"string"!==$t.getTypeOf(e)?function(e,t,r,n){var i=er,o=n+r;e=~e;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return~e}(0|t,e,e.length,0):function(e,t,r,n){var i=er,o=n+r;e=~e;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length,0):0},rr=Rt,nr=tr;function ir(){rr.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}Ot().inherits(ir,rr),ir.prototype.processChunk=function(e){this.streamInfo.crc32=nr(e.data,this.streamInfo.crc32||0),this.push(e)};var or=ir,ar=Ot(),sr=Rt;function lr(e){sr.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}ar.inherits(lr,sr),lr.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}sr.prototype.processChunk.call(this,e)};var cr=Mt,ur=Qt,hr=or,dr=lr;function fr(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}fr.prototype={getContentWorker:function(){var e=new ur(cr.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new dr("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new ur(cr.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},fr.createWorkerFrom=function(e,t,r){return e.pipe(new hr).pipe(new dr("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new dr("compressedSize")).withStreamInfo("compression",t)};var pr=fr,vr=qt,mr=Qt,gr=ae,yr=pr,br=Rt,xr=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};xr.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(t=t.pipe(new gr.Utf8EncodeWorker)),!i&&n&&(t=t.pipe(new gr.Utf8DecodeWorker))}catch(e){(t=new br("error")).error(e)}return new vr(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof yr&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new gr.Utf8EncodeWorker)),yr.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof yr?this._data.getContentWorker():this._data instanceof br?this._data:new mr(this._data)}};for(var wr=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],Er=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_r=0;_r<wr.length;_r++)xr.prototype[wr[_r]]=Er;var Sr=xr,Cr={},Tr={},Ar={},kr={};!function(e){var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(kr);var Mr={},Or={},Lr={},Rr=kr,Ir=0,Pr=1;function Fr(e){for(var t=e.length;--t>=0;)e[t]=0}var Dr=0,Nr=29,Br=256,Ur=Br+1+Nr,zr=30,Xr=19,Hr=2*Ur+1,Gr=15,jr=16,Yr=7,Wr=256,qr=16,Vr=17,Kr=18,Zr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Jr=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Qr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],$r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],en=new Array(2*(Ur+2));Fr(en);var tn=new Array(2*zr);Fr(tn);var rn=new Array(512);Fr(rn);var nn=new Array(256);Fr(nn);var on=new Array(Nr);Fr(on);var an,sn,ln,cn=new Array(zr);function un(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function hn(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function dn(e){return e<256?rn[e]:rn[256+(e>>>7)]}function fn(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function pn(e,t,r){e.bi_valid>jr-r?(e.bi_buf|=t<<e.bi_valid&65535,fn(e,e.bi_buf),e.bi_buf=t>>jr-e.bi_valid,e.bi_valid+=r-jr):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function vn(e,t,r){pn(e,r[2*t],r[2*t+1])}function mn(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function gn(e,t,r){var n,i,o=new Array(Gr+1),a=0;for(n=1;n<=Gr;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=mn(o[s]++,s))}}function yn(e){var t;for(t=0;t<Ur;t++)e.dyn_ltree[2*t]=0;for(t=0;t<zr;t++)e.dyn_dtree[2*t]=0;for(t=0;t<Xr;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Wr]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bn(e){e.bi_valid>8?fn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function xn(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function wn(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&xn(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!xn(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function En(e,t,r){var n,i,o,a,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?vn(e,i,t):(vn(e,(o=nn[i])+Br+1,t),0!==(a=Zr[o])&&pn(e,i-=on[o],a),vn(e,o=dn(--n),r),0!==(a=Jr[o])&&pn(e,n-=cn[o],a))}while(s<e.last_lit);vn(e,Wr,t)}function _n(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=Hr,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)wn(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],wn(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,wn(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,v=0;for(o=0;o<=Gr;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<Hr;r++)(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(o=p,v++),l[2*n+1]=o,n>c||(e.bl_count[o]++,a=0,n>=f&&(a=d[n-f]),s=l[2*n],e.opt_len+=s*(o+a),h&&(e.static_len+=s*(u[2*n+1]+a)));if(0!==v){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,v-=2}while(v>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>c||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),gn(o,c,e.bl_count)}function Sn(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*qr]++):s<=10?e.bl_tree[2*Vr]++:e.bl_tree[2*Kr]++,s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))}function Cn(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)do{vn(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(vn(e,i,e.bl_tree),s--),vn(e,qr,e.bl_tree),pn(e,s-3,2)):s<=10?(vn(e,Vr,e.bl_tree),pn(e,s-3,3)):(vn(e,Kr,e.bl_tree),pn(e,s-11,7));s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}}Fr(cn);var Tn=!1;function An(e,t,r,n){pn(e,(Dr<<1)+(n?1:0),3),function(e,t,r,n){bn(e),fn(e,r),fn(e,~r),Rr.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}Lr._tr_init=function(e){Tn||(!function(){var e,t,r,n,i,o=new Array(Gr+1);for(r=0,n=0;n<Nr-1;n++)for(on[n]=r,e=0;e<1<<Zr[n];e++)nn[r++]=n;for(nn[r-1]=n,i=0,n=0;n<16;n++)for(cn[n]=i,e=0;e<1<<Jr[n];e++)rn[i++]=n;for(i>>=7;n<zr;n++)for(cn[n]=i<<7,e=0;e<1<<Jr[n]-7;e++)rn[256+i++]=n;for(t=0;t<=Gr;t++)o[t]=0;for(e=0;e<=143;)en[2*e+1]=8,e++,o[8]++;for(;e<=255;)en[2*e+1]=9,e++,o[9]++;for(;e<=279;)en[2*e+1]=7,e++,o[7]++;for(;e<=287;)en[2*e+1]=8,e++,o[8]++;for(gn(en,Ur+1,o),e=0;e<zr;e++)tn[2*e+1]=5,tn[2*e]=mn(e,5);an=new un(en,Zr,Br+1,Ur,Gr),sn=new un(tn,Jr,0,zr,Gr),ln=new un(new Array(0),Qr,0,Xr,Yr)}(),Tn=!0),e.l_desc=new hn(e.dyn_ltree,an),e.d_desc=new hn(e.dyn_dtree,sn),e.bl_desc=new hn(e.bl_tree,ln),e.bi_buf=0,e.bi_valid=0,yn(e)},Lr._tr_stored_block=An,Lr._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return Ir;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Pr;for(t=32;t<Br;t++)if(0!==e.dyn_ltree[2*t])return Pr;return Ir}(e)),_n(e,e.l_desc),_n(e,e.d_desc),a=function(e){var t;for(Sn(e,e.dyn_ltree,e.l_desc.max_code),Sn(e,e.dyn_dtree,e.d_desc.max_code),_n(e,e.bl_desc),t=Xr-1;t>=3&&0===e.bl_tree[2*$r[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?An(e,t,r,n):4===e.strategy||o===i?(pn(e,2+(n?1:0),3),En(e,en,tn)):(pn(e,4+(n?1:0),3),function(e,t,r,n){var i;for(pn(e,t-257,5),pn(e,r-1,5),pn(e,n-4,4),i=0;i<n;i++)pn(e,e.bl_tree[2*$r[i]+1],3);Cn(e,e.dyn_ltree,t-1),Cn(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),En(e,e.dyn_ltree,e.dyn_dtree)),yn(e),n&&bn(e)},Lr._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(nn[r]+Br+1)]++,e.dyn_dtree[2*dn(t)]++),e.last_lit===e.lit_bufsize-1},Lr._tr_align=function(e){pn(e,2,3),vn(e,Wr,en),function(e){16===e.bi_valid?(fn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)};var kn=function(e,t,r,n){for(var i=65535&e,o=e>>>16&65535,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16};var Mn=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var On,Ln=function(e,t,r,n){var i=Mn,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return~e},Rn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},In=kr,Pn=Lr,Fn=kn,Dn=Ln,Nn=Rn,Bn=0,Un=4,zn=0,Xn=-2,Hn=-1,Gn=4,jn=2,Yn=8,Wn=9,qn=286,Vn=30,Kn=19,Zn=2*qn+1,Jn=15,Qn=3,$n=258,ei=$n+Qn+1,ti=42,ri=103,ni=113,ii=666,oi=1,ai=2,si=3,li=4;function ci(e,t){return e.msg=Nn[t],t}function ui(e){return(e<<1)-(e>4?9:0)}function hi(e){for(var t=e.length;--t>=0;)e[t]=0}function di(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(In.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function fi(e,t){Pn._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,di(e.strm)}function pi(e,t){e.pending_buf[e.pending++]=t}function vi(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function mi(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,In.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=Fn(e.adler,t,i,r):2===e.state.wrap&&(e.adler=Dn(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function gi(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-ei?e.strstart-(e.w_size-ei):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+$n,f=c[o+a-1],p=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===p&&c[r+a-1]===f&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<d);if(n=$n-(d-o),o=d-$n,n>a){if(e.match_start=t,a=n,n>=s)break;f=c[o+a-1],p=c[o+a]}}}while((t=h[t&u])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function yi(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-ei)){In.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);t=r=a;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=mi(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=Qn)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+Qn-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<Qn)););}while(e.lookahead<ei&&0!==e.strm.avail_in)}function bi(e,t){for(var r,n;;){if(e.lookahead<ei){if(yi(e),e.lookahead<ei&&t===Bn)return oi;if(0===e.lookahead)break}if(r=0,e.lookahead>=Qn&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-ei&&(e.match_length=gi(e,r)),e.match_length>=Qn)if(n=Pn._tr_tally(e,e.strstart-e.match_start,e.match_length-Qn),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Qn){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=Pn._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(fi(e,!1),0===e.strm.avail_out))return oi}return e.insert=e.strstart<Qn-1?e.strstart:Qn-1,t===Un?(fi(e,!0),0===e.strm.avail_out?si:li):e.last_lit&&(fi(e,!1),0===e.strm.avail_out)?oi:ai}function xi(e,t){for(var r,n,i;;){if(e.lookahead<ei){if(yi(e),e.lookahead<ei&&t===Bn)return oi;if(0===e.lookahead)break}if(r=0,e.lookahead>=Qn&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Qn-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-ei&&(e.match_length=gi(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===Qn&&e.strstart-e.match_start>4096)&&(e.match_length=Qn-1)),e.prev_length>=Qn&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Qn,n=Pn._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-Qn),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=Qn-1,e.strstart++,n&&(fi(e,!1),0===e.strm.avail_out))return oi}else if(e.match_available){if((n=Pn._tr_tally(e,0,e.window[e.strstart-1]))&&fi(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return oi}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Pn._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Qn-1?e.strstart:Qn-1,t===Un?(fi(e,!0),0===e.strm.avail_out?si:li):e.last_lit&&(fi(e,!1),0===e.strm.avail_out)?oi:ai}function wi(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function Ei(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Yn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new In.Buf16(2*Zn),this.dyn_dtree=new In.Buf16(2*(2*Vn+1)),this.bl_tree=new In.Buf16(2*(2*Kn+1)),hi(this.dyn_ltree),hi(this.dyn_dtree),hi(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new In.Buf16(Jn+1),this.heap=new In.Buf16(2*qn+1),hi(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new In.Buf16(2*qn+1),hi(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _i(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=jn,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?ti:ni,e.adler=2===t.wrap?0:1,t.last_flush=Bn,Pn._tr_init(t),zn):ci(e,Xn)}function Si(e){var t,r=_i(e);return r===zn&&((t=e.state).window_size=2*t.w_size,hi(t.head),t.max_lazy_match=On[t.level].max_lazy,t.good_match=On[t.level].good_length,t.nice_match=On[t.level].nice_length,t.max_chain_length=On[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Qn-1,t.match_available=0,t.ins_h=0),r}function Ci(e,t,r,n,i,o){if(!e)return Xn;var a=1;if(t===Hn&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>Wn||r!==Yn||n<8||n>15||t<0||t>9||o<0||o>Gn)return ci(e,Xn);8===n&&(n=9);var s=new Ei;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Qn-1)/Qn),s.window=new In.Buf8(2*s.w_size),s.head=new In.Buf16(s.hash_size),s.prev=new In.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new In.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,Si(e)}On=[new wi(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(yi(e),0===e.lookahead&&t===Bn)return oi;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,fi(e,!1),0===e.strm.avail_out))return oi;if(e.strstart-e.block_start>=e.w_size-ei&&(fi(e,!1),0===e.strm.avail_out))return oi}return e.insert=0,t===Un?(fi(e,!0),0===e.strm.avail_out?si:li):(e.strstart>e.block_start&&(fi(e,!1),e.strm.avail_out),oi)})),new wi(4,4,8,4,bi),new wi(4,5,16,8,bi),new wi(4,6,32,32,bi),new wi(4,4,16,16,xi),new wi(8,16,32,32,xi),new wi(8,16,128,128,xi),new wi(8,32,128,256,xi),new wi(32,128,258,1024,xi),new wi(32,258,258,4096,xi)],Or.deflateInit=function(e,t){return Ci(e,t,Yn,15,8,0)},Or.deflateInit2=Ci,Or.deflateReset=Si,Or.deflateResetKeep=_i,Or.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?Xn:(e.state.gzhead=t,zn):Xn},Or.deflate=function(e,t){var r,n,i,o;if(!e||!e.state||t>5||t<0)return e?ci(e,Xn):Xn;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===ii&&t!==Un)return ci(e,0===e.avail_out?-5:Xn);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===ti)if(2===n.wrap)e.adler=0,pi(n,31),pi(n,139),pi(n,8),n.gzhead?(pi(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),pi(n,255&n.gzhead.time),pi(n,n.gzhead.time>>8&255),pi(n,n.gzhead.time>>16&255),pi(n,n.gzhead.time>>24&255),pi(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),pi(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(pi(n,255&n.gzhead.extra.length),pi(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Dn(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(pi(n,0),pi(n,0),pi(n,0),pi(n,0),pi(n,0),pi(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),pi(n,3),n.status=ni);else{var a=Yn+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=ni,vi(n,a),0!==n.strstart&&(vi(n,e.adler>>>16),vi(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=Dn(e.adler,n.pending_buf,n.pending-i,i)),di(e),i=n.pending,n.pending!==n.pending_buf_size));)pi(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=Dn(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Dn(e.adler,n.pending_buf,n.pending-i,i)),di(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,pi(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Dn(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Dn(e.adler,n.pending_buf,n.pending-i,i)),di(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,pi(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Dn(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=ri)}else n.status=ri;if(n.status===ri&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&di(e),n.pending+2<=n.pending_buf_size&&(pi(n,255&e.adler),pi(n,e.adler>>8&255),e.adler=0,n.status=ni)):n.status=ni),0!==n.pending){if(di(e),0===e.avail_out)return n.last_flush=-1,zn}else if(0===e.avail_in&&ui(t)<=ui(r)&&t!==Un)return ci(e,-5);if(n.status===ii&&0!==e.avail_in)return ci(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==Bn&&n.status!==ii){var s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(yi(e),0===e.lookahead)){if(t===Bn)return oi;break}if(e.match_length=0,r=Pn._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(fi(e,!1),0===e.strm.avail_out))return oi}return e.insert=0,t===Un?(fi(e,!0),0===e.strm.avail_out?si:li):e.last_lit&&(fi(e,!1),0===e.strm.avail_out)?oi:ai}(n,t):3===n.strategy?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=$n){if(yi(e),e.lookahead<=$n&&t===Bn)return oi;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=Qn&&e.strstart>0&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=e.strstart+$n;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=$n-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Qn?(r=Pn._tr_tally(e,1,e.match_length-Qn),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Pn._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(fi(e,!1),0===e.strm.avail_out))return oi}return e.insert=0,t===Un?(fi(e,!0),0===e.strm.avail_out?si:li):e.last_lit&&(fi(e,!1),0===e.strm.avail_out)?oi:ai}(n,t):On[n.level].func(n,t);if(s!==si&&s!==li||(n.status=ii),s===oi||s===si)return 0===e.avail_out&&(n.last_flush=-1),zn;if(s===ai&&(1===t?Pn._tr_align(n):5!==t&&(Pn._tr_stored_block(n,0,0,!1),3===t&&(hi(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),di(e),0===e.avail_out))return n.last_flush=-1,zn}return t!==Un?zn:n.wrap<=0?1:(2===n.wrap?(pi(n,255&e.adler),pi(n,e.adler>>8&255),pi(n,e.adler>>16&255),pi(n,e.adler>>24&255),pi(n,255&e.total_in),pi(n,e.total_in>>8&255),pi(n,e.total_in>>16&255),pi(n,e.total_in>>24&255)):(vi(n,e.adler>>>16),vi(n,65535&e.adler)),di(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?zn:1)},Or.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==ti&&69!==t&&73!==t&&91!==t&&t!==ri&&t!==ni&&t!==ii?ci(e,Xn):(e.state=null,t===ni?ci(e,-3):zn):Xn},Or.deflateSetDictionary=function(e,t){var r,n,i,o,a,s,l,c,u=t.length;if(!e||!e.state)return Xn;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==ti||r.lookahead)return Xn;for(1===o&&(e.adler=Fn(e.adler,t,u,0)),r.wrap=0,u>=r.w_size&&(0===o&&(hi(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new In.Buf8(r.w_size),In.arraySet(c,t,u-r.w_size,r.w_size,0),t=c,u=r.w_size),a=e.avail_in,s=e.next_in,l=e.input,e.avail_in=u,e.next_in=0,e.input=t,yi(r);r.lookahead>=Qn;){n=r.strstart,i=r.lookahead-(Qn-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+Qn-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=Qn-1,yi(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Qn-1,r.match_available=0,e.next_in=s,e.input=l,e.avail_in=a,r.wrap=o,zn},Or.deflateInfo="pako deflate (from Nodeca project)";var Ti={},Ai=kr,ki=!0,Mi=!0;try{String.fromCharCode.apply(null,[0])}catch(e){ki=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Mi=!1}for(var Oi=new Ai.Buf8(256),Li=0;Li<256;Li++)Oi[Li]=Li>=252?6:Li>=248?5:Li>=240?4:Li>=224?3:Li>=192?2:1;function Ri(e,t){if(t<65534&&(e.subarray&&Mi||!e.subarray&&ki))return String.fromCharCode.apply(null,Ai.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}Oi[254]=Oi[254]=1,Ti.string2buf=function(e){var t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Ai.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},Ti.buf2binstring=function(e){return Ri(e,e.length)},Ti.binstring2buf=function(e){for(var t=new Ai.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},Ti.buf2string=function(e,t){var r,n,i,o,a=t||e.length,s=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)s[n++]=i;else if((o=Oi[i])>4)s[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<a;)i=i<<6|63&e[r++],o--;o>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return Ri(s,n)},Ti.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Oi[e[r]]>t?r:t};var Ii=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Pi=Or,Fi=kr,Di=Ti,Ni=Rn,Bi=Ii,Ui=Object.prototype.toString,zi=0,Xi=-1,Hi=0,Gi=8;function ji(e){if(!(this instanceof ji))return new ji(e);this.options=Fi.assign({level:Xi,method:Gi,chunkSize:16384,windowBits:15,memLevel:8,strategy:Hi,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bi,this.strm.avail_out=0;var r=Pi.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==zi)throw new Error(Ni[r]);if(t.header&&Pi.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?Di.string2buf(t.dictionary):"[object ArrayBuffer]"===Ui.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=Pi.deflateSetDictionary(this.strm,n))!==zi)throw new Error(Ni[r]);this._dict_set=!0}}function Yi(e,t){var r=new ji(t);if(r.push(e,!0),r.err)throw r.msg||Ni[r.err];return r.result}ji.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=Di.string2buf(e):"[object ArrayBuffer]"===Ui.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new Fi.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=Pi.deflate(i,n))&&r!==zi)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(Di.buf2binstring(Fi.shrinkBuf(i.output,i.next_out))):this.onData(Fi.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=Pi.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===zi):2!==n||(this.onEnd(zi),i.avail_out=0,!0)},ji.prototype.onData=function(e){this.chunks.push(e)},ji.prototype.onEnd=function(e){e===zi&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Fi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Mr.Deflate=ji,Mr.deflate=Yi,Mr.deflateRaw=function(e,t){return(t=t||{}).raw=!0,Yi(e,t)},Mr.gzip=function(e,t){return(t=t||{}).gzip=!0,Yi(e,t)};var Wi={},qi={},Vi=kr,Ki=15,Zi=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ji=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Qi=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],$i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],eo=kr,to=kn,ro=Ln,no=function(e,t){var r,n,i,o,a,s,l,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C,T;r=e.state,n=e.next_in,C=e.input,i=n+(e.avail_in-5),o=e.next_out,T=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,v=r.lencode,m=r.distcode,g=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=v[f&g];t:for(;;){if(f>>>=x=b>>>24,p-=x,0===(x=b>>>16&255))T[o++]=65535&b;else{if(!(16&x)){if(64&x){if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}b=v[(65535&b)+(f&(1<<x)-1)];continue t}for(w=65535&b,(x&=15)&&(p<x&&(f+=C[n++]<<p,p+=8),w+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=m[f&y];;){if(f>>>=x=b>>>24,p-=x,16&(x=b>>>16&255)){if(E=65535&b,p<(x&=15)&&(f+=C[n++]<<p,(p+=8)<x&&(f+=C[n++]<<p,p+=8)),(E+=f&(1<<x)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=x,p-=x,E>(x=o-a)){if((x=E-x)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(_=0,S=d,0===h){if(_+=c-x,x<w){w-=x;do{T[o++]=d[_++]}while(--x);_=o-E,S=T}}else if(h<x){if(_+=c+h-x,(x-=h)<w){w-=x;do{T[o++]=d[_++]}while(--x);if(_=0,h<w){w-=x=h;do{T[o++]=d[_++]}while(--x);_=o-E,S=T}}}else if(_+=h-x,x<w){w-=x;do{T[o++]=d[_++]}while(--x);_=o-E,S=T}for(;w>2;)T[o++]=S[_++],T[o++]=S[_++],T[o++]=S[_++],w-=3;w&&(T[o++]=S[_++],w>1&&(T[o++]=S[_++]))}else{_=o-E;do{T[o++]=T[_++],T[o++]=T[_++],T[o++]=T[_++],w-=3}while(w>2);w&&(T[o++]=T[_++],w>1&&(T[o++]=T[_++]))}break}if(64&x){e.msg="invalid distance code",r.mode=30;break e}b=m[(65535&b)+(f&(1<<x)-1)]}}break}}while(n<i&&o<s);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=f,r.bits=p},io=function(e,t,r,n,i,o,a,s){var l,c,u,h,d,f,p,v,m,g=s.bits,y=0,b=0,x=0,w=0,E=0,_=0,S=0,C=0,T=0,A=0,k=null,M=0,O=new Vi.Buf16(16),L=new Vi.Buf16(16),R=null,I=0;for(y=0;y<=Ki;y++)O[y]=0;for(b=0;b<n;b++)O[t[r+b]]++;for(E=g,w=Ki;w>=1&&0===O[w];w--);if(E>w&&(E=w),0===w)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(x=1;x<w&&0===O[x];x++);for(E<x&&(E=x),C=1,y=1;y<=Ki;y++)if(C<<=1,(C-=O[y])<0)return-1;if(C>0&&(0===e||1!==w))return-1;for(L[1]=0,y=1;y<Ki;y++)L[y+1]=L[y]+O[y];for(b=0;b<n;b++)0!==t[r+b]&&(a[L[t[r+b]]++]=b);if(0===e?(k=R=a,f=19):1===e?(k=Zi,M-=257,R=Ji,I-=257,f=256):(k=Qi,R=$i,f=-1),A=0,b=0,y=x,d=o,_=E,S=0,u=-1,h=(T=1<<E)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){p=y-S,a[b]<f?(v=0,m=a[b]):a[b]>f?(v=R[I+a[b]],m=k[M+a[b]]):(v=96,m=0),l=1<<y-S,x=c=1<<_;do{i[d+(A>>S)+(c-=l)]=p<<24|v<<16|m}while(0!==c);for(l=1<<y-1;A&l;)l>>=1;if(0!==l?(A&=l-1,A+=l):A=0,b++,0==--O[y]){if(y===w)break;y=t[r+a[b]]}if(y>E&&(A&h)!==u){for(0===S&&(S=E),d+=x,C=1<<(_=y-S);_+S<w&&!((C-=O[_+S])<=0);)_++,C<<=1;if(T+=1<<_,1===e&&T>852||2===e&&T>592)return 1;i[u=A&h]=E<<24|_<<16|d-o}}return 0!==A&&(i[d+A]=y-S<<24|64<<16),s.bits=E,0},oo=1,ao=2,so=0,lo=-2,co=1,uo=12,ho=30,fo=852,po=592;function vo(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function mo(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new eo.Buf16(320),this.work=new eo.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function go(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=co,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new eo.Buf32(fo),t.distcode=t.distdyn=new eo.Buf32(po),t.sane=1,t.back=-1,so):lo}function yo(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,go(e)):lo}function bo(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?lo:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,yo(e))):lo}function xo(e,t){var r,n;return e?(n=new mo,e.state=n,n.window=null,(r=bo(e,t))!==so&&(e.state=null),r):lo}var wo,Eo,_o=!0;function So(e){if(_o){var t;for(wo=new eo.Buf32(512),Eo=new eo.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(io(oo,e.lens,0,288,wo,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;io(ao,e.lens,0,32,Eo,0,e.work,{bits:5}),_o=!1}e.lencode=wo,e.lenbits=9,e.distcode=Eo,e.distbits=5}function Co(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new eo.Buf8(o.wsize)),n>=o.wsize?(eo.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),eo.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(eo.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}qi.inflateReset=yo,qi.inflateReset2=bo,qi.inflateResetKeep=go,qi.inflateInit=function(e){return xo(e,15)},qi.inflateInit2=xo,qi.inflate=function(e,t){var r,n,i,o,a,s,l,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C,T=0,A=new eo.Buf8(4),k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return lo;(r=e.state).mode===uo&&(r.mode=13),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,h=s,d=l,_=so;e:for(;;)switch(r.mode){case co:if(0===r.wrap){r.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===c){r.check=0,A[0]=255&c,A[1]=c>>>8&255,r.check=ro(r.check,A,2,0),c=0,u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=ho;break}if(8!=(15&c)){e.msg="unknown compression method",r.mode=ho;break}if(u-=4,E=8+(15&(c>>>=4)),0===r.wbits)r.wbits=E;else if(E>r.wbits){e.msg="invalid window size",r.mode=ho;break}r.dmax=1<<E,e.adler=r.check=1,r.mode=512&c?10:uo,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=ho;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=ho;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,r.check=ro(r.check,A,2,0)),c=0,u=0,r.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,r.check=ro(r.check,A,4,0)),c=0,u=0,r.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,r.check=ro(r.check,A,2,0)),c=0,u=0,r.mode=5;case 5:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,r.check=ro(r.check,A,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((f=r.length)>s&&(f=s),f&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),eo.arraySet(r.head.extra,n,o,f,E)),512&r.flags&&(r.check=ro(r.check,n,f,o)),s-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;f=0;do{E=n[o+f++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E))}while(E&&f<s);if(512&r.flags&&(r.check=ro(r.check,n,f,o)),s-=f,o+=f,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;f=0;do{E=n[o+f++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E))}while(E&&f<s);if(512&r.flags&&(r.check=ro(r.check,n,f,o)),s-=f,o+=f,E)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=ho;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=uo;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=vo(c),c=0,u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,2;e.adler=r.check=1,r.mode=uo;case uo:if(5===t||6===t)break e;case 13:if(r.last){c>>>=7&u,u-=7&u,r.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=1&c,u-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(So(r),r.mode=20,6===t){c>>>=2,u-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=ho}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ho;break}if(r.length=65535&c,c=0,u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(f=r.length){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;eo.arraySet(i,n,o,f,a),s-=f,o+=f,l-=f,a+=f,r.length-=f;break}r.mode=uo;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ho;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.lens[k[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[k[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},_=io(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,_){e.msg="invalid code lengths set",r.mode=ho;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(T=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,y=65535&T,!((m=T>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(y<16)c>>>=m,u-=m,r.lens[r.have++]=y;else{if(16===y){for(C=m+2;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=m,u-=m,0===r.have){e.msg="invalid bit length repeat",r.mode=ho;break}E=r.lens[r.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===y){for(C=m+3;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=m,E=0,f=3+(7&(c>>>=m)),c>>>=3,u-=3}else{for(C=m+7;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=m,E=0,f=11+(127&(c>>>=m)),c>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ho;break}for(;f--;)r.lens[r.have++]=E}}if(r.mode===ho)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=ho;break}if(r.lenbits=9,S={bits:r.lenbits},_=io(oo,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,_){e.msg="invalid literal/lengths set",r.mode=ho;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},_=io(ao,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,_){e.msg="invalid distances set",r.mode=ho;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,no(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===uo&&(r.back=-1);break}for(r.back=0;g=(T=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,y=65535&T,!((m=T>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(g&&!(240&g)){for(b=m,x=g,w=y;g=(T=r.lencode[w+((c&(1<<b+x)-1)>>b)])>>>16&255,y=65535&T,!(b+(m=T>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=m,u-=m,r.back+=m,r.length=y,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=uo;break}if(64&g){e.msg="invalid literal/length code",r.mode=ho;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(C=r.extra;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(T=r.distcode[c&(1<<r.distbits)-1])>>>16&255,y=65535&T,!((m=T>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(!(240&g)){for(b=m,x=g,w=y;g=(T=r.distcode[w+((c&(1<<b+x)-1)>>b)])>>>16&255,y=65535&T,!(b+(m=T>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=m,u-=m,r.back+=m,64&g){e.msg="invalid distance code",r.mode=ho;break}r.offset=y,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(C=r.extra;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ho;break}r.mode=25;case 25:if(0===l)break e;if(f=d-l,r.offset>f){if((f=r.offset-f)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ho;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),v=r.window}else v=i,p=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{i[a++]=v[p++]}while(--f);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;i[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[o++]<<u,u+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?ro(r.check,i,d,a-d):to(r.check,i,d,a-d)),d=l,(r.flags?c:vo(c))!==r.check){e.msg="incorrect data check",r.mode=ho;break}c=0,u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=ho;break}c=0,u=0}r.mode=29;case 29:_=1;break e;case ho:_=-3;break e;case 31:return-4;default:return lo}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<ho&&(r.mode<27||4!==t))&&Co(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?ro(r.check,i,d,e.next_out-d):to(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===uo?128:0)+(20===r.mode||15===r.mode?256:0),(0===h&&0===d||4===t)&&_===so&&(_=-5),_},qi.inflateEnd=function(e){if(!e||!e.state)return lo;var t=e.state;return t.window&&(t.window=null),e.state=null,so},qi.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?(r.head=t,t.done=!1,so):lo},qi.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?lo:11===r.mode&&to(1,t,n,0)!==r.check?-3:Co(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,so):lo},qi.inflateInfo="pako inflate (from Nodeca project)";var To={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Ao=qi,ko=kr,Mo=Ti,Oo=To,Lo=Rn,Ro=Ii,Io=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Po=Object.prototype.toString;function Fo(e){if(!(this instanceof Fo))return new Fo(e);this.options=ko.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ro,this.strm.avail_out=0;var r=Ao.inflateInit2(this.strm,t.windowBits);if(r!==Oo.Z_OK)throw new Error(Lo[r]);if(this.header=new Io,Ao.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Mo.string2buf(t.dictionary):"[object ArrayBuffer]"===Po.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Ao.inflateSetDictionary(this.strm,t.dictionary))!==Oo.Z_OK))throw new Error(Lo[r])}function Do(e,t){var r=new Fo(t);if(r.push(e,!0),r.err)throw r.msg||Lo[r.err];return r.result}Fo.prototype.push=function(e,t){var r,n,i,o,a,s=this.strm,l=this.options.chunkSize,c=this.options.dictionary,u=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?Oo.Z_FINISH:Oo.Z_NO_FLUSH,"string"==typeof e?s.input=Mo.binstring2buf(e):"[object ArrayBuffer]"===Po.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new ko.Buf8(l),s.next_out=0,s.avail_out=l),(r=Ao.inflate(s,Oo.Z_NO_FLUSH))===Oo.Z_NEED_DICT&&c&&(r=Ao.inflateSetDictionary(this.strm,c)),r===Oo.Z_BUF_ERROR&&!0===u&&(r=Oo.Z_OK,u=!1),r!==Oo.Z_STREAM_END&&r!==Oo.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0!==s.avail_out&&r!==Oo.Z_STREAM_END&&(0!==s.avail_in||n!==Oo.Z_FINISH&&n!==Oo.Z_SYNC_FLUSH)||("string"===this.options.to?(i=Mo.utf8border(s.output,s.next_out),o=s.next_out-i,a=Mo.buf2string(s.output,i),s.next_out=o,s.avail_out=l-o,o&&ko.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(ko.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(u=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==Oo.Z_STREAM_END);return r===Oo.Z_STREAM_END&&(n=Oo.Z_FINISH),n===Oo.Z_FINISH?(r=Ao.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Oo.Z_OK):n!==Oo.Z_SYNC_FLUSH||(this.onEnd(Oo.Z_OK),s.avail_out=0,!0)},Fo.prototype.onData=function(e){this.chunks.push(e)},Fo.prototype.onEnd=function(e){e===Oo.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ko.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Wi.Inflate=Fo,Wi.inflate=Do,Wi.inflateRaw=function(e,t){return(t=t||{}).raw=!0,Do(e,t)},Wi.ungzip=Do;var No={};(0,kr.assign)(No,Mr,Wi,To);var Bo="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,Uo=No,zo=Ot(),Xo=Rt,Ho=Bo?"uint8array":"array";function Go(e,t){Xo.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}Ar.magic="\b\0",zo.inherits(Go,Xo),Go.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(zo.transformTo(Ho,e.data),!1)},Go.prototype.flush=function(){Xo.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Go.prototype.cleanUp=function(){Xo.prototype.cleanUp.call(this),this._pako=null},Go.prototype._createPako=function(){this._pako=new Uo[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},Ar.compressWorker=function(e){return new Go("Deflate",e)},Ar.uncompressWorker=function(){return new Go("Inflate",{})};var jo=Rt;Tr.STORE={magic:"\0\0",compressWorker:function(){return new jo("STORE compression")},uncompressWorker:function(){return new jo("STORE decompression")}},Tr.DEFLATE=Ar;var Yo={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},Wo=Ot(),qo=Rt,Vo=ae,Ko=tr,Zo=Yo,Jo=function(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},Qo=function(e,t,r,n,i,o){var a,s,l=e.file,c=e.compression,u=o!==Vo.utf8encode,h=Wo.transformTo("string",o(l.name)),d=Wo.transformTo("string",Vo.utf8encode(l.name)),f=l.comment,p=Wo.transformTo("string",o(f)),v=Wo.transformTo("string",Vo.utf8encode(f)),m=d.length!==l.name.length,g=v.length!==f.length,y="",b="",x="",w=l.dir,E=l.date,_={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(_.crc32=e.crc32,_.compressedSize=e.compressedSize,_.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),u||!m&&!g||(S|=2048);var C,T,A,k=0,M=0;w&&(k|=16),"UNIX"===i?(M=798,k|=(C=l.unixPermissions,T=w,A=C,C||(A=T?16893:33204),(65535&A)<<16)):(M=20,k|=63&(l.dosPermissions||0)),a=E.getUTCHours(),a<<=6,a|=E.getUTCMinutes(),a<<=5,a|=E.getUTCSeconds()/2,s=E.getUTCFullYear()-1980,s<<=4,s|=E.getUTCMonth()+1,s<<=5,s|=E.getUTCDate(),m&&(b=Jo(1,1)+Jo(Ko(h),4)+d,y+="up"+Jo(b.length,2)+b),g&&(x=Jo(1,1)+Jo(Ko(p),4)+v,y+="uc"+Jo(x.length,2)+x);var O="";return O+="\n\0",O+=Jo(S,2),O+=c.magic,O+=Jo(a,2),O+=Jo(s,2),O+=Jo(_.crc32,4),O+=Jo(_.compressedSize,4),O+=Jo(_.uncompressedSize,4),O+=Jo(h.length,2),O+=Jo(y.length,2),{fileRecord:Zo.LOCAL_FILE_HEADER+O+h+y,dirRecord:Zo.CENTRAL_FILE_HEADER+Jo(M,2)+O+Jo(p.length,2)+"\0\0\0\0"+Jo(k,4)+Jo(n,4)+h+y+p}},$o=function(e){return Zo.DATA_DESCRIPTOR+Jo(e.crc32,4)+Jo(e.compressedSize,4)+Jo(e.uncompressedSize,4)};function ea(e,t,r,n){qo.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}Wo.inherits(ea,qo),ea.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,qo.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},ea.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=Qo(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ea.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=Qo(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:$o(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ea.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,i){var o=Wo.transformTo("string",i(n));return Zo.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Jo(e,2)+Jo(e,2)+Jo(t,4)+Jo(r,4)+Jo(o.length,2)+o}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},ea.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ea.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},ea.prototype.resume=function(){return!!qo.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ea.prototype.error=function(e){var t=this._sources;if(!qo.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},ea.prototype.lock=function(){qo.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()};var ta=Tr,ra=ea;Cr.generateWorker=function(e,t,r){var n=new ra(t.streamFiles,r,t.platform,t.encodeFileName),i=0;try{e.forEach((function(e,r){i++;var o=function(e,t){var r=e||t,n=ta[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,t.compression),a=r.options.compressionOptions||t.compressionOptions||{},s=r.dir,l=r.date;r._compressWorker(o,a).withStreamInfo("file",{name:e,dir:s,date:l,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(n)})),n.entriesCount=i}catch(e){n.error(e)}return n};var na=Ot(),ia=Rt;function oa(e,t){ia.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}na.inherits(oa,ia),oa.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},oa.prototype.pause=function(){return!!ia.prototype.pause.call(this)&&(this._stream.pause(),!0)},oa.prototype.resume=function(){return!!ia.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};var aa=oa,sa=ae,la=Ot(),ca=Rt,ua=qt,ha=Vt,da=pr,fa=Sr,pa=Cr,va=Tt,ma=aa,ga=function(e,t,r){var n,i=la.getTypeOf(t),o=la.extend(r||{},ha);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=ba(e)),o.createFolders&&(n=ya(e))&&xa.call(this,n,!0);var a="string"===i&&!1===o.binary&&!1===o.base64;r&&void 0!==r.binary||(o.binary=!a),(t instanceof da&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",i="string");var s=null;s=t instanceof da||t instanceof ca?t:va.isNode&&va.isStream(t)?new ma(e,t):la.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var l=new fa(e,s,o);this.files[e]=l},ya=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},ba=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},xa=function(e,t){return t=void 0!==t?t:ha.createFolders,e=ba(e),this.files[e]||ga.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function wa(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var Ea={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t},file:function(e,t,r){if(1===arguments.length){if(wa(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,ga.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(wa(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=xa.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=la.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:sa.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");la.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=pa.generateWorker(this,r,n)}catch(e){(t=new ca("error")).error(e)}return new ua(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}},_a=Ea,Sa=Ot();function Ca(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}Ca.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return Sa.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}};var Ta=Ca,Aa=Ta;function ka(e){Aa.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}Ot().inherits(ka,Aa),ka.prototype.byteAt=function(e){return this.data[this.zero+e]},ka.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o-this.zero;return-1},ka.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&r===o[1]&&n===o[2]&&i===o[3]},ka.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Ma=ka,Oa=Ta;function La(e){Oa.call(this,e)}Ot().inherits(La,Oa),La.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},La.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},La.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},La.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Ra=La,Ia=Ma;function Pa(e){Ia.call(this,e)}Ot().inherits(Pa,Ia),Pa.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Fa=Pa,Da=Fa;function Na(e){Da.call(this,e)}Ot().inherits(Na,Da),Na.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Ba=Na,Ua=Ot(),za=le,Xa=Ma,Ha=Ra,Ga=Ba,ja=Fa,Ya=function(e){var t=Ua.getTypeOf(e);return Ua.checkSupport(t),"string"!==t||za.uint8array?"nodebuffer"===t?new Ga(e):za.uint8array?new ja(Ua.transformTo("uint8array",e)):new Xa(Ua.transformTo("array",e)):new Ha(e)},Wa=Ya,qa=Ot(),Va=pr,Ka=tr,Za=ae,Ja=Tr,Qa=le;function $a(e,t){this.options=e,this.loadOptions=t}$a.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in Ja)if(Object.prototype.hasOwnProperty.call(Ja,t)&&Ja[t].magic===e)return Ja[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+qa.pretty(this.compressionMethod)+" unknown (inner file : "+qa.transformTo("string",this.fileName)+")");this.decompressed=new Va(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=Wa(this.extraFields[1].value);this.uncompressedSize===qa.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===qa.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===qa.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===qa.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=Qa.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Za.utf8decode(this.fileName),this.fileCommentStr=Za.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=qa.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=qa.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=Wa(e.value);return 1!==t.readInt(1)||Ka(this.fileName)!==t.readInt(4)?null:Za.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=Wa(e.value);return 1!==t.readInt(1)||Ka(this.fileComment)!==t.readInt(4)?null:Za.utf8decode(t.readData(e.length-5))}return null}};var es=$a,ts=Ya,rs=Ot(),ns=Yo,is=es,os=le;function as(e){this.files=[],this.loadOptions=e}as.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+rs.pretty(t)+", expected "+rs.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=os.uint8array?"uint8array":"array",r=rs.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(ns.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(ns.CENTRAL_FILE_HEADER);)(e=new is({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(ns.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,ns.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(ns.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===rs.MAX_VALUE_16BITS||this.diskWithCentralDirStart===rs.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===rs.MAX_VALUE_16BITS||this.centralDirRecords===rs.MAX_VALUE_16BITS||this.centralDirSize===rs.MAX_VALUE_32BITS||this.centralDirOffset===rs.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(ns.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(ns.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,ns.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(ns.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ns.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(n>0)this.isSignature(t,ns.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=ts(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var ss=as,ls=Ot(),cs=Mt,us=ae,hs=ss,ds=or,fs=Tt;function ps(e){return new cs.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new ds);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}function vs(){if(!(this instanceof vs))return new vs;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new vs;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}vs.prototype=_a,vs.prototype.loadAsync=function(e,t){var r=this;return t=ls.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:us.utf8decode}),fs.isNode&&fs.isStream(e)?cs.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):ls.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new hs(t);return r.load(e),r})).then((function(e){var r=[cs.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var i=0;i<n.length;i++)r.push(ps(n[i]));return cs.Promise.all(r)})).then((function(e){for(var n=e.shift(),i=n.files,o=0;o<i.length;o++){var a=i[o],s=a.fileNameStr,l=ls.resolve(a.fileNameStr);r.file(l,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(r.file(l).unsafeOriginalName=s)}return n.zipComment.length&&(r.comment=n.zipComment),r}))},vs.support=le,vs.defaults=Vt,vs.version="3.10.1",vs.loadAsync=function(e,t){return(new vs).loadAsync(e,t)},vs.external=Mt;var ms=re(vs),gs=2048,ys=!1,bs={debug:!1,offscreenCanvas:!1,tile:!1,deltaTime:8,maxTextureSize:gs,get MAX_TEXTURE_SIZE(){return this.maxTextureSize},set MAX_TEXTURE_SIZE(e){this.maxTextureSize=e,ys=!0},MAX_TEXTURE_UNITS:8,MAX_VARYING_VECTORS:15,init:function(e,t,r){ys?e<this.maxTextureSize&&(this.maxTextureSize=e):this.maxTextureSize=Math.min(gs,e),gs=e,this.MAX_TEXTURE_UNITS=t,this.MAX_VARYING_VECTORS=r},treeLvPadding:16,historyTime:1e3,guidesSnap:8},xs={}.toString;function ws(e){return function(t){return xs.call(t)==="[object "+e+"]"}}var Es,_s=ws("Object"),Ss=ws("String"),Cs=(Es=["Function","AsyncFunction","GeneratorFunction"],function(e){for(var t=xs.call(e),r=0,n=Es.length;r<n;r++)if(t==="[object "+Es[r]+"]")return!0;return!1}),Ts=ws("Number"),As=ws("Boolean"),ks=ws("Date"),Ms={}.hasOwnProperty,Os=Ms.toString,Ls=Os.call(Object);function Rs(e){return null==e}function Is(e){if(!e||"[object Object]"!==xs.call(e))return!1;var t=Object.getPrototypeOf(e);if(!t)return!0;var r=Ms.call(t,"constructor")&&t.constructor;return"function"==typeof r&&Os.call(r)===Ls}function Ps(e){if(Rs(e)||"object"!=typeof e)return e;if(ks(e))return new Date(e);if(!Is(e)&&!Array.isArray(e))return e;var t=Array.isArray(e)?[]:{};return Object.keys(e).forEach((function(r){t[r]=Ps(e[r])})),t}function Fs(e,t,r){if(e===t)return!0;if(_s(e)&&_s(t)){for(var n={},i=r||Object.keys(e),o=0,a=i.length;o<a;o++){var s=i[o];if(!t.hasOwnProperty(s)||!Fs(e[s],t[s]))return!1;n[s]=!0}for(o=0,a=(i=r||Object.keys(t)).length;o<a;o++){s=i[o];if(!n.hasOwnProperty(s))return!1}return!0}if(ks(e)&&ks(t))return e.getTime()===t.getTime();if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(o=0,a=e.length;o<a;o++)if(!Fs(e[o],t[o]))return!1;return!0}return e===t}var Ds={isNil:Rs,isString:Ss,isNumber:Ts,isObject:_s,isBoolean:As,isDate:ks,isFunction:Cs,isPlainObject:Is,equal:Fs,extend:function(e,t,r){if(null===t||"object"!=typeof t)return e;r||(r=Object.keys(t));for(var n=0,i=r.length;n<i;){var o=r[n];e[o]=t[o],n++}return e},clone:Ps},Ns=1e3/60,Bs={},Us="function"==typeof OffscreenCanvas&&OffscreenCanvas.prototype.getContext;var zs,Xs,Hs,Gs,js,Ys,Ws,qs,Vs,Ks,Zs,Js,Qs,$s,el,tl,rl,nl,il,ol={},al={},sl={},ll=0,cl=0,ul=[],hl=0,dl=[],fl={requestAnimationFrame:function(e){return e?("undefined"!=typeof requestAnimationFrame?(fl.requestAnimationFrame=requestAnimationFrame.bind(null),t=requestAnimationFrame(e)):(t=setTimeout(e,Ns),fl.requestAnimationFrame=function(e){return setTimeout(e,Ns)}),t):-1;var t},cancelAnimationFrame:function(e){var t;return"undefined"!=typeof cancelAnimationFrame?(fl.cancelAnimationFrame=cancelAnimationFrame.bind(null),t=cancelAnimationFrame(e)):(t=clearTimeout(e),fl.cancelAnimationFrame=function(e){return clearTimeout(e)}),t},now:function(){return"undefined"!=typeof performance?(fl.now=function(){return Math.floor(performance.now())},Math.floor(performance.now())):(fl.now=Date.now.bind(Date),Date.now())},hasOffscreenCanvas:function(e){return e&&Bs.hasOwnProperty(e)},getOffscreenCanvas:function(e,t,r,n){return function(e,t,r,n){var i;i=r?Bs[r]?Bs[r]:Bs[r]=!bs.debug&&bs.offscreenCanvas&&Us?new OffscreenCanvas(e,t):document.createElement("canvas"):!bs.debug&&bs.offscreenCanvas&&Us?new OffscreenCanvas(e,t):document.createElement("canvas"),e=Math.ceil(e),t=Math.ceil(t),i.width=e,i.height=t,i.style.position="fixed",i.style.left="9999px",i.style.webkitFontSmoothing="antialiased",bs.debug&&(i.style.width=e+"px",i.style.height=t+"px",r&&i.setAttribute("key",r)),document.body.appendChild(i);var o=i.getContext("2d",n);return o||fl.error("Total canvas memory use exceeds the maximum limit"),{canvas:i,ctx:o,available:!0,release:function(){this.available&&!bs.debug&&(this.available=!1,o.globalAlpha=1,o.globalCompositeOperation="source-over",o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,e,t),i.width=i.height=0,document.body.removeChild(i),i=null)}}}(e,t,r,n)},isWebGLTexture:function(e){if(e&&"undefined"!=typeof WebGLTexture)return e instanceof WebGLTexture},defaultFontFamily:"Arial",defaultFontSize:16,getFontCanvas:function(){return fl.getOffscreenCanvas(16,16,"__$$CHECK_SUPPORT_FONT_FAMILY$$__",{willReadFrequently:!0})},checkSupportFontFamily:function(e){if(e===this.defaultFontFamily)return!0;if(ol.hasOwnProperty(e))return ol[e];var t=fl.getFontCanvas().ctx;t.textAlign="center",t.fillStyle="#000",t.textBaseline="middle",zs||(t.clearRect(0,0,16,16),t.font="16px "+this.defaultFontFamily,t.fillText("a",8,8),zs=t.getImageData(0,0,16,16).data),t.clearRect(0,0,16,16),/\s/.test(e)&&(e='"'+e.replace(/"/g,'\\"')+'"'),t.font="16px "+e+","+this.defaultFontFamily,t.fillText("a",8,8);for(var r=t.getImageData(0,0,16,16).data,n=0,i=r.length;n<i;n++)if(zs[n]!==r[n])return ol[e]=!0;return ol[e]=!1},FONT:sl,loadFont:function(e,t,r){if(Cs(t)&&(r=t,t=e),Array.isArray(t)){if(!t.length)return r&&r(null);var n=0,i=t.length,o=[];t.forEach((function(e,t){fl.loadFont(e.fontFamily,e.url,(function(e){o[t]=e,++n===i&&r&&r(o)}))}))}else{if(!t||!Ss(t))return fl.error("Load font invalid: "+t),void(r&&r({state:2,success:!1,url:t}));var a=sl[t]=sl[t]||{state:0,task:[]};if(2===a.state)r&&r(a);else if(1===a.state)r&&a.task.push(r);else{if(a.state=1,r&&a.task.push(r),ll>0&&hl>=ll)return void dl.push({fontFamily:e,url:t});function s(e,t,r){if(t instanceof ArrayBuffer)i(t);else{var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){n.response?i(n.response):o()},n.onerror=o,n.send()}function i(n){var i=new FontFace(e,n);if(i.load().then((function(){"undefined"!=typeof document&&document.fonts.add(i),r.state=2,r.success=!0,r.url=t,r.arrayBuffer=n,r.task.splice(0).forEach((function(e){return e(r)}))})).catch(o),hl++,dl.length){var a=dl.shift();s(a.fontFamily,a.url,sl[a.url])}}function o(){if(r.state=2,r.success=!1,r.url=t,r.task.splice(0).forEach((function(e){return e(r)})),hl--,dl.length){var e=dl.shift();s(e.fontFamily,e.url,sl[e.url])}}}hl++,s(e,t,a)}}},addArrayBufferFont:function(e,t){if("undefined"!=typeof document&&"undefined"!=typeof FontFace){var r=new FontFace(e,t);document.fonts.add(r)}},addLocalFont:function(e){if("undefined"!=typeof document&&"undefined"!=typeof FontFace){var t=new FontFace(e,"local(".concat(e));document.fonts.add(t)}},IMG:al,INIT:0,LOADED:2,LOADING:1,get MAX_LOAD_NUM(){return ll},set MAX_LOAD_NUM(e){ll=parseInt(e)||0},loadImg:function(e,t){if(Array.isArray(e)){if(!e.length)return t&&t([]);var r=0,n=e.length,i=[];e.forEach((function(e,o){fl.loadImg(e,(function(e){i[o]=e,++r===n&&t&&t(i)}))}))}else{if(!e||!Ss(e))return fl.error("Loadimg failed: "+e),void(t&&t({state:2,success:!1,url:e}));var o=al[e]=al[e]||{state:0,task:[]};if(2===o.state)t&&t(o);else if(1===o.state)t&&o.task.push(t);else{if(o.state=1,t&&o.task.push(t),ll>0&&cl>=ll)return void ul.push(e);function a(e,t){var r=new Image;if(r.onload=function(){if(t.state=2,t.success=!0,t.width=r.width,t.height=r.height,t.source=r,t.url=e,t.task.splice(0).forEach((function(e){e(t)})),cl--,ul.length){var n=ul.shift();a(n,al[n])}},r.onerror=function(){(t.state=2,t.success=!1,t.url=e,t.task.splice(0).forEach((function(e){return e(t)})),cl--,ul.length)&&a(ul.shift(),t)},"data:"!==e.substr(0,5)){var n=/^(?:\w+:)?\/\/([^/:]+)/.exec(e);n&&("undefined"!=typeof location&&location.hostname===n[1]||(r.crossOrigin="anonymous"))}r.src=e}cl++,a(e,o)}}},loadArrayBufferImg:function(e){return J(this,void 0,void 0,(function(){var t,r;return Q(this,(function(n){return t=new Blob([e]),r=new Image,[2,new Promise((function(e,n){r.onload=function(){e(r)},r.onerror=function(e){n(e)},r.src=URL.createObjectURL(t)}))]}))}))},pdfjsLibWorkerSrc:"https://gw.alipayobjects.com/os/lib/pdfjs-dist/3.11.174/build/pdf.worker.min.js",loadArrayBufferPdf:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,c;return Q(this,(function(u){switch(u.label){case 0:return(t=window.pdfjsLib).GlobalWorkerOptions.workerSrc=fl.pdfjsLibWorkerSrc,r=new Blob([e]),n=URL.createObjectURL(r),[4,t.getDocument(n).promise];case 1:return[4,u.sent().getPage(1)];case 2:return i=u.sent(),o=i.getViewport({scale:1}),(a=document.createElement("canvas")).width=o.width,a.height=o.height,s=a.getContext("2d"),[4,i.render({viewport:o,canvasContext:s,background:"transparent"}).promise];case 3:return u.sent(),[4,new Promise((function(e,t){a.toBlob((function(r){r?e(r):t()}))}))];case 4:return l=u.sent(),c=new Image,[2,new Promise((function(e,t){c.onload=function(){e(c)},c.onerror=function(e){t(e)},c.src=URL.createObjectURL(l)}))]}}))}))},loadLocalFonts:function(){return J(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:if("undefined"==typeof navigator)return[3,5];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,navigator.permissions.query({name:"local-fonts"})];case 2:return"denied"===t.sent().state?(fl.error("No Permission."),[2,[]]):[4,window.queryLocalFonts()];case 3:return[2,t.sent()];case 4:return e=t.sent(),fl.error(e),[2,[]];case 5:return[2,[]]}}))}))},log:function(e){console.log(e)},warn:function(e){console.warn(e)},error:function(e){console.error(e)}};function pl(e,t){if(void 0===t&&(t=!1),"auto"===e)return{v:0,u:Xs.AUTO};var r=parseFloat(e)||0;return/%$/.test(e)?{v:r,u:Xs.PERCENT}:/px$/i.test(e)?{v:r,u:Xs.PX}:/deg$/i.test(e)?{v:r,u:t?Xs.PX:Xs.DEG}:{v:r,u:t?Xs.PX:Xs.NUMBER}}!function(e){e[e.AUTO=0]="AUTO",e[e.PX=1]="PX",e[e.PERCENT=2]="PERCENT",e[e.NUMBER=3]="NUMBER",e[e.DEG=4]="DEG",e[e.RGBA=5]="RGBA",e[e.BOOLEAN=6]="BOOLEAN",e[e.STRING=7]="STRING",e[e.GRADIENT=8]="GRADIENT",e[e.BLUR=9]="BLUR",e[e.PATTERN=10]="PATTERN",e[e.SHADOW=11]="SHADOW",e[e.MATRIX=12]="MATRIX"}(Xs||(Xs={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.CENTER=2]="CENTER",e[e.JUSTIFY=3]="JUSTIFY"}(Hs||(Hs={})),function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM"}(Gs||(Gs={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.MULTIPLY=1]="MULTIPLY",e[e.SCREEN=2]="SCREEN",e[e.OVERLAY=3]="OVERLAY",e[e.DARKEN=4]="DARKEN",e[e.LIGHTEN=5]="LIGHTEN",e[e.COLOR_DODGE=6]="COLOR_DODGE",e[e.COLOR_BURN=7]="COLOR_BURN",e[e.HARD_LIGHT=8]="HARD_LIGHT",e[e.SOFT_LIGHT=9]="SOFT_LIGHT",e[e.DIFFERENCE=10]="DIFFERENCE",e[e.EXCLUSION=11]="EXCLUSION",e[e.HUE=12]="HUE",e[e.SATURATION=13]="SATURATION",e[e.COLOR=14]="COLOR",e[e.LUMINOSITY=15]="LUMINOSITY"}(js||(js={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ITALIC=1]="ITALIC",e[e.OBLIQUE=2]="OBLIQUE"}(Ys||(Ys={})),function(e){e[e.LINEAR=0]="LINEAR",e[e.RADIAL=1]="RADIAL",e[e.CONIC=2]="CONIC"}(Ws||(Ws={})),function(e){e[e.NONE=0]="NONE",e[e.GAUSSIAN=1]="GAUSSIAN",e[e.MOTION=2]="MOTION",e[e.RADIAL=3]="RADIAL",e[e.BACKGROUND=4]="BACKGROUND"}(qs||(qs={})),function(e){e[e.NONE=0]="NONE",e[e.UNION=1]="UNION",e[e.SUBTRACT=2]="SUBTRACT",e[e.INTERSECT=3]="INTERSECT",e[e.XOR=4]="XOR"}(Vs||(Vs={})),function(e){e[e.NONE=0]="NONE",e[e.STRAIGHT=1]="STRAIGHT",e[e.MIRRORED=2]="MIRRORED",e[e.ASYMMETRIC=3]="ASYMMETRIC",e[e.DISCONNECTED=4]="DISCONNECTED"}(Ks||(Ks={})),function(e){e[e.ROUNDED=0]="ROUNDED",e[e.ROUNDED_INVERTED=1]="ROUNDED_INVERTED",e[e.ANGLED=2]="ANGLED",e[e.SQUARED=3]="SQUARED"}(Zs||(Zs={})),function(e){e[e.NON_ZERO=0]="NON_ZERO",e[e.EVEN_ODD=1]="EVEN_ODD"}(Js||(Js={})),function(e){e[e.NONE=0]="NONE",e[e.OUTLINE=1]="OUTLINE",e[e.ALPHA=2]="ALPHA",e[e.GRAY=3]="GRAY",e[e.ALPHA_WITH=4]="ALPHA_WITH",e[e.GRAY_WITH=5]="GRAY_WITH"}(Qs||(Qs={})),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE"}($s||($s={})),function(e){e[e.MITER=0]="MITER",e[e.ROUND=1]="ROUND",e[e.BEVEL=2]="BEVEL"}(el||(el={})),function(e){e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.OUTSIDE=2]="OUTSIDE"}(tl||(tl={})),function(e){e[e.TILE=0]="TILE",e[e.FILL=1]="FILL",e[e.STRETCH=2]="STRETCH",e[e.FIT=3]="FIT"}(rl||(rl={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN"}(nl||(nl={})),function(e){e[e.AUTO=0]="AUTO",e[e.FIXED_W=1]="FIXED_W",e[e.FIXED_W_H=2]="FIXED_W_H"}(il||(il={}));var vl,ml,gl={StyleUnit:Xs,calUnit:pl,TEXT_ALIGN:Hs,TEXT_VERTICAL_ALIGN:Gs,MIX_BLEND_MODE:js,FONT_STYLE:Ys,GRADIENT:Ws,BLUR:qs,BOOLEAN_OPERATION:Vs,CURVE_MODE:Ks,CORNER_STYLE:Zs,FILL_RULE:Js,MASK:Qs,STROKE_LINE_CAP:$s,STROKE_LINE_JOIN:el,STROKE_POSITION:tl,PATTERN_FILL_TYPE:rl,TEXT_BEHAVIOUR:il,VISIBILITY:nl};!function(e){e[e.NONE=0]="NONE",e[e.UNDERLINE=1]="UNDERLINE",e[e.LINE_THROUGH=2]="LINE_THROUGH"}(vl||(vl={})),function(e){e[e.DISABLED=-1]="DISABLED",e[e.LEGACY=0]="LEGACY",e[e.ROUNDED=1]="ROUNDED",e[e.SMOOTH=2]="SMOOTH"}(ml||(ml={}));var yl=function(){var e=0,t=-3;function r(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new r,this.dtree=new r}var i=new r,o=new r,a=new Uint8Array(30),s=new Uint16Array(30),l=new Uint8Array(30),c=new Uint16Array(30),u=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new r,d=new Uint8Array(320);function f(e,t,r,n){var i,o;for(i=0;i<r;++i)e[i]=0;for(i=0;i<30-r;++i)e[i+r]=i/r|0;for(o=n,i=0;i<30;++i)t[i]=o,o+=1<<e[i]}var p=new Uint16Array(16);function v(e,t,r,n){var i,o;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<n;++i)e.table[t[r+i]]++;for(e.table[0]=0,o=0,i=0;i<16;++i)p[i]=o,o+=e.table[i];for(i=0;i<n;++i)t[r+i]&&(e.trans[p[t[r+i]]++]=i)}function m(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function g(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,n+r}function y(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=0,n=0,i=0,o=e.tag;do{n=2*n+(1&o),o>>>=1,++i,r+=t.table[i],n-=t.table[i]}while(n>=0);return e.tag=o,e.bitcount-=i,t.trans[r+n]}function b(e,t,r){var n,i,o,a,s,l;for(n=g(e,5,257),i=g(e,5,1),o=g(e,4,4),a=0;a<19;++a)d[a]=0;for(a=0;a<o;++a){var c=g(e,3,0);d[u[a]]=c}for(v(h,d,0,19),s=0;s<n+i;){var f=y(e,h),p=void 0;switch(f){case 16:for(p=d[s-1],l=g(e,2,3);l;--l)d[s++]=p;break;case 17:for(l=g(e,3,3);l;--l)d[s++]=0;break;case 18:for(l=g(e,7,11);l;--l)d[s++]=0;break;default:d[s++]=f}}v(t,d,0,n),v(r,d,n,i)}function x(t,r,n){for(;;){var i=y(t,r);if(256===i)return e;if(i<256)t.dest[t.destLen++]=i;else{var o,u,h,d=void 0;for(o=g(t,a[i-=257],s[i]),u=y(t,n),d=h=t.destLen-g(t,l[u],c[u]);d<h+o;++d)t.dest[t.destLen++]=t.dest[d]}}}function w(r){for(var n,i;r.bitcount>8;)r.sourceIndex--,r.bitcount-=8;if((n=256*(n=r.source[r.sourceIndex+1])+r.source[r.sourceIndex])!==(65535&~(256*r.source[r.sourceIndex+3]+r.source[r.sourceIndex+2])))return t;for(r.sourceIndex+=4,i=n;i;--i)r.dest[r.destLen++]=r.source[r.sourceIndex++];return r.bitcount=0,e}return function(e,t){var r;for(r=0;r<7;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;r<24;++r)e.trans[r]=256+r;for(r=0;r<144;++r)e.trans[24+r]=r;for(r=0;r<8;++r)e.trans[168+r]=280+r;for(r=0;r<112;++r)e.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}(i,o),f(a,s,4,3),f(l,c,2,1),a[28]=0,s[28]=258,function(r,a){var s,l,c=new n(r,a);do{switch(s=m(c),g(c,2,0)){case 0:l=w(c);break;case 1:l=x(c,i,o);break;case 2:b(c,c.ltree,c.dtree),l=x(c,c.ltree,c.dtree);break;default:l=t}if(l!==e)throw new Error("Data error")}while(!s);return c.destLen<c.dest.length?"function"==typeof c.dest.slice?c.dest.slice(0,c.destLen):c.dest.subarray(0,c.destLen):c.dest}}(),bl={UTF16:function(e,t,r){for(var n=[],i=r/2,o=0;o<i;o++,t+=2)n[o]=e.getUint16(t);return String.fromCharCode.apply(null,n)}},xl={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};function wl(e,t){for(var r="",n=t;n<t+4;n++)r+=String.fromCharCode(e.getInt8(n));return r}function El(e,t){return e.getUint16(t,!1)}function _l(e,t){return e.getUint32(t,!1)}bl.MACSTRING=function(e,t,r,n){var i=xl[n];if(void 0!==i){for(var o="",a=0;a<r;a++){var s=e.getUint8(t+a);o+=s<=127?String.fromCharCode(s):i[127&s]}return o}};var Sl={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Cl(e,t){for(var r=[],n=12,i=0;i<t;i+=1){var o=wl(e,n),a=_l(e,n+4),s=_l(e,n+8),l=_l(e,n+12);r.push({tag:o,checksum:a,offset:s,length:l,compression:!1}),n+=16}return r}function Tl(e,t){if("WOFF"===t.compression){var r=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),n=new Uint8Array(t.length);return yl(r,n),n.byteLength!==t.length&&fl.error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length"),{data:new DataView(n.buffer,0),offset:0}}return{data:e,offset:t.offset}}var Al=function(){function e(e,t){this.data=e,this.offset=t,this.relativeOffset=0}return e.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},e.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},e.prototype.parseULong=function(){var e=_l(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},e.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},e.prototype.parseFixed=function(){var e,t,r=(e=this.data,t=this.offset+this.relativeOffset,e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535);return this.relativeOffset+=4,r},e.prototype.parseVersion=function(e){var t=El(this.data,this.offset+this.relativeOffset),r=El(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+r/e/10},e.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=Sl[e]*t},e}(),kl=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Ml={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Ol={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},Ll={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Rl={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Il(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return Ml[t];case 3:return Ol[t]}}var Pl="utf-16";function Fl(e,t,r){switch(e){case 0:return Pl;case 1:return Rl[r]||Ll[t];case 3:if(1===t||10===t)return Pl}}var Dl={0:"unicode",1:"macintosh",2:"reserved",3:"windows"};function Nl(e){return Dl[e]}function Bl(e,t){var r,n=new Al(e,t),i=n.parseULong();r="Unsupported ltag table version.",1===i||fail(r),n.skip("uLong",1);for(var o=n.parseULong(),a=[],s=0;s<o;s++){for(var l="",c=t+n.parseUShort(),u=n.parseUShort(),h=c;h<c+u;++h)l+=String.fromCharCode(e.getInt8(h));a.push(l)}return a}var Ul={parse:function(e){var t,r,n=new DataView(e,0),i=wl(n,0),o=!1;if(i===String.fromCharCode(0,1,0,0)||"true"===i||"typ1"===i)r=Cl(n,t=El(n,4));else if("OTTO"===i)r=Cl(n,t=El(n,4)),o=!0;else if("wOFF"===i){var a=wl(n,4);if(a===String.fromCharCode(0,1,0,0));else if("OTTO"!==a)return void fl.error("Unsupported OpenType flavor "+i);r=function(e,t){for(var r=[],n=44,i=0;i<t;i+=1){var o=wl(e,n),a=_l(e,n+4),s=_l(e,n+8),l=_l(e,n+12),c=void 0;c=s<l&&"WOFF",r.push({tag:o,offset:a,compression:c,compressedLength:s,length:l}),n+=20}return r}(n,t=El(n,12))}else if("wOF2"===i){fl.error("WOFF2 require an external decompressor library, see examples at: https://github.com/opentypejs/opentype.js/issues/183#issuecomment-1147228025")}else fl.error("Unsupported OpenType signature "+i);for(var s,l,c,u,h=2048,d=0,f=!1,p=0;p<t;p++){var v=r[p];if("head"===v.tag){var m=Tl(n,v);(g=new Al(m.data,m.offset)).parseVersion(),g.parseFixed(),g.parseULong(),g.parseULong(),g.parseUShort(),h=g.parseUShort()}else if("hhea"===v.tag){if(!f){m=Tl(n,v);(g=new Al(m.data,m.offset)).parseVersion(),s=Math.abs(g.parseShort()),l=Math.abs(g.parseShort()),d=Math.abs(g.parseShort()||0)}}else if("ltag"===v.tag){u=Bl((m=Tl(n,v)).data,m.offset)}else if("name"===v.tag)c=Tl(n,v);else if("OS/2"===v.tag){m=Tl(n,v);var g,y=(g=new Al(m.data,m.offset)).parseUShort();g.parseShort(),g.parseUShort(),g.parseUShort(),g.parseUShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort();for(var b=0;b<10;b++)g.parseByte();g.parseULong(),g.parseULong(),g.parseULong(),g.parseULong(),g.parseByte(),g.parseByte(),g.parseByte(),g.parseByte();var x=g.parseUShort(),w=y>=4&&(128&x||o);(w||void 0===s)&&(g.parseUShort(),g.parseUShort(),s=Math.abs(g.parseShort()),l=Math.abs(g.parseShort()),d=Math.abs(g.parseShort()||0),w&&(f=!0))}}var E=c?function(e,t,r){for(var n={},i=new Al(e,t),o=i.parseUShort(),a=i.parseUShort(),s=i.offset+i.parseUShort(),l=0;l<a;l++){var c=i.parseUShort(),u=i.parseUShort(),h=i.parseUShort(),d=i.parseUShort(),f=kl[d]||d,p=i.parseUShort(),v=i.parseUShort(),m=Il(c,h,r),g=Fl(c,u,h),y=Nl(c);if(void 0!==g&&void 0!==m&&void 0!==y){var b=void 0;if(b=g===Pl?bl.UTF16(e,s+v,p):bl.MACSTRING(e,s+v,p,g)){var x=n[y];void 0===x&&(x=n[y]={});var w=x[f];void 0===w&&(w=x[f]={}),w[m]=b}}}return 1===o&&i.parseUShort(),n}(c.data,c.offset,u):{},_={};return E.macintosh&&Object.assign(_,E.macintosh),E.windows&&Object.assign(_,E.windows),{name:_,emSquare:h,ascent:s,descent:l,lineGap:d}}},zl={name:"Arial",family:"Arial",lhr:1.14990234375,car:1.1171875,blr:.9052734375,lgr:.03271484375,list:[{style:"Regular",postscriptName:"Arial",loaded:!0}]},Xl="localFonts",Hl={Arial:zl},Gl={Arial:zl},jl={KEY_INFO:Xl,info:Hl,data:Gl,hasRegister:function(e){return Gl.hasOwnProperty(e)},registerLocalFonts:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,m;return Q(this,(function(g){switch(g.label){case 0:return e?[3,2]:[4,fl.loadLocalFonts()];case 1:e=g.sent()||[],g.label=2;case 2:t={},"undefined"!=typeof localStorage&&(t=JSON.parse(localStorage.getItem(Xl)||"{}")),r=t.data||{},(!t.version||t.version<2)&&(r={}),n=0,i=e.length,g.label=3;case 3:return n<i?(o=e[n],a=o.postscriptName,s=o.family,l=o.style,fl.addLocalFont(a),r.hasOwnProperty(s)&&(c=r[s],Hl[s]=Hl[s]||{name:c.name,family:s,lhr:c.lhr,car:c.car,blr:c.blr,lgr:c.lgr,list:[]}),Hl.hasOwnProperty(s)?[3,6]:(u=Hl[s]={name:"",family:"",lhr:0,car:0,blr:0,lgr:0,list:[]},[4,o.blob()])):[3,8];case 4:return[4,g.sent().arrayBuffer()];case 5:h=g.sent(),(d=Ul.parse(h))&&d.name&&(u.name=(null===(p=d.name.preferredFamily)||void 0===p?void 0:p.zh)||(null===(v=d.name.preferredFamily)||void 0===v?void 0:v.en)||(null===(m=d.name.fontFamily)||void 0===m?void 0:m.zh)),u.name=u.name||s,u.family=s,f=this._cal(s,d),Object.assign(u,f),g.label=6;case 6:this._register(s,l,a,!0),g.label=7;case 7:return n++,[3,3];case 8:return this.updateLocalStorage(),[2]}}))}))},registerAb:function(e){var t,r,n,i,o,a,s,l,c={},u=Ul.parse(e);u&&u.name&&(c.family=(null===(t=u.name.preferredFamily)||void 0===t?void 0:t.en)||(null===(r=u.name.fontFamily)||void 0===r?void 0:r.en),c.name=(null===(n=u.name.preferredFamily)||void 0===n?void 0:n.zh)||(null===(i=u.name.preferredFamily)||void 0===i?void 0:i.en)||(null===(o=u.name.fontFamily)||void 0===o?void 0:o.zh)||c.family);var h=c.family,d=(null===(a=u.name.preferredSubfamily)||void 0===a?void 0:a.en)||(null===(s=u.name.fontSubfamily)||void 0===s?void 0:s.en),f=null===(l=u.name.postScriptName)||void 0===l?void 0:l.en;if(h&&d&&f){if(!Hl.hasOwnProperty(h)){var p=this._cal(h,u);Object.assign(c,p),c.list=[],Hl[h]=Gl[h]=c}return this._register(h,d,f,!0),fl.addArrayBufferFont(f,e),this.data[h]}},_cal:function(e,t){var r=0;return["times","helvetica","courier"].indexOf(e.toLowerCase())>-1&&(r=Math.round(.15*(t.ascent+t.descent))),{lhr:(t.ascent+r+t.descent+t.lineGap)/t.emSquare,car:(t.ascent+r+t.descent)/t.emSquare,blr:(t.ascent+r)/t.emSquare,lgr:t.lineGap/t.emSquare}},_register:function(e,t,r,n,i){for(var o=Hl[e],a=o.list=o.list||[],s=!1,l=0,c=a.length;l<c;l++){var u=a[l];if(u.postscriptName===r){s=!0,n&&(u.loaded=!0);break}}return s||a.push({style:t,postscriptName:r,loaded:n,url:i}),{family:e,postscriptName:r,data:Gl[e]=Gl[r]=o}},registerData:function(e){var t=this,r=e.family;Hl.hasOwnProperty(r)||(Hl[r]=Gl[r]=e),e.list.forEach((function(e){t._register(r,e.style,e.postscriptName,e.loaded,e.url)}))},updateLocalStorage:function(){var e={};for(var t in Hl)if(Hl.hasOwnProperty(t)){var r=Hl[t];e[t]={name:r.name,lhr:r.lhr,car:r.car,blr:r.blr,lgr:r.lgr}}"undefined"!=typeof localStorage&&localStorage.setItem(Xl,JSON.stringify({version:2,data:e}))}};function Yl(e,t,r,n){return e*r+t*n}function Wl(e,t,r,n,i,o){return e*n+t*i+r*o}function ql(e,t,r,n){return e*n-r*t}function Vl(e,t,r,n){var i=Yl(e,t,r,n),o=Math.pow(r,2)+Math.pow(n,2);return{x:i*r/o,y:i*n/o}}function Kl(e,t,r,n,i){void 0===i&&(i=!1);var o=0;if(t===n)if(r>e)o=1;else{if(!(r<e))return 0;o=-1}else e===r?n>t?o=1/0:n<t&&(o=-1/0):o=Yl(e,t,r,n)/(Zl(e,t)*Zl(r,n));return i?o:Math.acos(o)||0}function Zl(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function Jl(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function Ql(e,t){var r=Zl(e,t);return{x:e/r,y:t/r}}function $l(e,t,r,n){return Math.abs(e)<1e-9&&Math.abs(t)<1e-9&&Math.abs(r)<1e-9&&Math.abs(n)<1e-9}function ec(e,t,r,n,i,o){return Math.abs(e)<1e-9&&Math.abs(t)<1e-9&&Math.abs(r)<1e-9&&Math.abs(n)<1e-9&&Math.abs(i)<1e-9&&Math.abs(o)<1e-9}function tc(e,t,r,n){var i=Yl(e,t,r,n)/(Zl(e,t)*Zl(r,n));return i<-1?i=-1:i>1&&(i=1),Math.acos(i)}function rc(e,t,r,n,i,o){var a=Wl(e,t,r,n,i,o)/(Jl(e,t,r)*Jl(n,i,o));return a<-1?a=-1:a>1&&(a=1),Math.acos(a)}var nc={dotProduct:Yl,dotProduct3:Wl,crossProduct:ql,crossProduct3:function(e,t,r,n,i,o){return{x:t*o-i*r,y:r*n-o*e,z:e*i-n*t}},projection:Vl,includedAngle:Kl,length:Zl,length3:Jl,unitize:Ql,unitize3:function(e,t,r){var n=Jl(e,t,r);return{x:e/n,y:t/n,z:r/n}},angle:tc,angle3:rc,isParallel:function(e,t,r,n){if($l(e,t,r,n))return!0;var i=tc(e,t,r,n);return Math.abs(i)<1e-9||Math.PI-Math.abs(i)<1e-9},isParallel3:function(e,t,r,n,i,o){if(ec(e,t,r,n,i,o))return!0;var a=rc(e,t,r,n,i,o);return Math.abs(a)<1e-9||Math.PI-Math.abs(a)<1e-9},isZero:$l,isZero3:ec};function ic(){return new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function oc(e){return!e||!e.length||1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]}function ac(e,t){if(oc(e))return new Float64Array(t);if(oc(t))return new Float64Array(e);for(var r=ic(),n=0;n<4;n++){var i=e[n],o=e[n+4],a=e[n+8],s=e[n+12];r[n]=i*t[0]+o*t[1]+a*t[2]+s*t[3],r[n+4]=i*t[4]+o*t[5]+a*t[6]+s*t[7],r[n+8]=i*t[8]+o*t[9]+a*t[10]+s*t[11],r[n+12]=i*t[12]+o*t[13]+a*t[14]+s*t[15]}return r}function sc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function lc(e){if(oc(e))return ic();var t=new Float64Array(16);t[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],t[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],t[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],t[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],t[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],t[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],t[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],t[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],t[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],t[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],t[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],t[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],t[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],t[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];var r=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12];if(0===r)return ic();r=1/r;for(var n=new Float64Array(16),i=0;i<16;i++)n[i]=t[i]*r;return n}function cc(e,t){return e&&t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e}function uc(e,t,r){return t||r?(e[12]+=e[0]*t+e[4]*r,e[13]+=e[1]*t+e[5]*r,e[14]+=e[2]*t+e[6]*r,e[15]+=e[3]*t+e[7]*r,e):e}function hc(e,t,r){if(!e&&!t)return r;var n=r[3],i=r[7],o=r[11],a=r[15];return r[0]+=n*e,r[1]+=n*t,r[4]+=i*e,r[5]+=i*t,r[8]+=o*e,r[9]+=o*t,r[12]+=a*e,r[13]+=a*t,r}function dc(e,t,r){return t||r?(e[12]+=e[0]*t+e[4]*r,e[13]+=e[1]*t+e[5]*r,e[14]+=e[2]*t+e[6]*r,e[15]+=e[3]*t+e[7]*r,e):e}function fc(e,t){if(!t)return e;var r=Math.sin(t),n=Math.cos(t),i=e[0],o=e[1],a=e[2],s=e[3],l=e[4],c=e[5],u=e[6],h=e[7];return e[0]=i*n+l*r,e[1]=o*n+c*r,e[2]=a*n+u*r,e[3]=s*n+h*r,e[4]=i*-r+l*n,e[5]=o*-r+c*n,e[6]=a*-r+u*n,e[7]=s*-r+h*n,e}function pc(e,t){return 1===t||(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t),e}function vc(e,t){return 1===t||(e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t),e}function mc(e,t){return 1===t||(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t),e}function gc(e,t){if(t&&!oc(t)){var r=e.x,n=e.y,i=t[0],o=t[1],a=t[4],s=t[5];return{x:(1===i?r:r*i)+(a?n*a:0)+t[12],y:(1===o?r:r*o)+(s?n*s:0)+t[13]}}return e}function yc(e){if(16===e.length)return lc(e);var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5];if(1===t&&0===r&&0===n&&1===i&&0===o&&0===a)return e;var s=t*i-r*n;return 0===s?e:new Float64Array([i/s,-r/s,-n/s,t/s,(n*a-i*o)/s,(r*o-t*a)/s])}function bc(e,t,r,n,i){var o,a,s,l,c=gc({x:e,y:t},i),u=c.x,h=c.y,d=gc({x:r,y:n},i),f=d.x,p=d.y;if(i&&i.length&&(i[1]||i[2]||i[4]||i[6]||i[7]||i[8])){var v=gc({x:r,y:t},i);o=v.x,a=v.y,s=(v=gc({x:e,y:n},i)).x,l=v.y}else o=f,a=h,s=u,l=p;return{x1:u,y1:h,x2:o,y2:a,x3:f,y3:p,x4:s,y4:l}}var xc={identity:ic,isE:oc,toE:sc,assignMatrix:cc,inverse:yc,inverse4:lc,calPoint:gc,calRectPoints:bc,tfoMultiply:hc,multiplyTfo:uc,multiply:ac,multiplyRef:function(e,t){if(oc(e))return t;if(oc(t))return cc(t,e),t;for(var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],v=t[13],m=t[14],g=t[15],y=0;y<4;y++){var b=e[y],x=e[y+4],w=e[y+8],E=e[y+12];t[y]=b*r+x*n+w*i+E*o,t[y+4]=b*a+x*s+w*l+E*c,t[y+8]=b*u+x*h+w*d+E*f,t[y+12]=b*p+x*v+w*m+E*g}return t},multiplyTranslate:dc,multiplyTranslateX:function(e,t){return t?(e[12]+=e[0]*t,e[13]+=e[1]*t,e[14]+=e[2]*t,e[15]+=e[3]*t,e):e},multiplyTranslateY:function(e,t){return t?(e[12]+=e[4]*t,e[13]+=e[5]*t,e[14]+=e[6]*t,e[15]+=e[7]*t,e):e},multiplyRotateZ:fc,multiplyScale:mc,multiplyScaleX:pc,multiplyScaleY:vc};function wc(e){return e*Math.PI/180}function Ec(e){return 180*e/Math.PI}function _c(e,t,r,n){void 0===n&&(n=!1);for(var i,o=r[0],a=o.x,s=o.y,l=r[0],c=l.x,u=l.y,h=r.length,d=1;d<h;d++){var f=r[d],p=f.x,v=f.y;a=Math.max(a,p),s=Math.max(s,v),c=Math.min(c,p),u=Math.min(u,v)}if(e<c||t<u||e>a||t>s)return!1;if((e<=c||t<=u||e>=a||t>=s)&&!n)return!1;d=0;for(var m=r.length;d<m;d++){var g=r[d],y=g.x,b=g.y,x=r[(d+1)%m],w=x.x,E=x.y,_=ql(w-y,E-b,e-y,t-b);if(0!==_){if(_=_>0?1:0,void 0===i)i=_;else if(i^_)return!1}else if(n){if(e===y&&t===b||e===w&&t===E)return!0;var S=e-y,C=w-e,T=t-b,A=E-t;if(0===S||0===C){if(T^A)return!0}else if(0===T||0===A){if(S^C)return!0}else if(S^C&&T^A)return!0}}return!0}function Sc(e,t,r,n,i,o,a,s){var l,c;if(void 0===s&&(s=!1),r>=i&&(r=(l=[i,r])[0],i=l[1]),n>=o&&(n=(c=[o,n])[0],o=c[1]),a&&!oc(a)){var u=gc({x:r,y:n},a),h=gc({x:i,y:n},a),d=gc({x:i,y:o},a),f=gc({x:r,y:o},a);return _c(e,t,[{x:u.x,y:u.y},{x:h.x,y:h.y},{x:d.x,y:d.y},{x:f.x,y:f.y}])}return s?e>=r&&t>=n&&e<=i&&t<=o:e>r&&t>n&&e<i&&t<o}function Cc(e,t,r,n){return Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2))}function Tc(e,t,r){var n=(Math.pow(t,2)+Math.pow(r,2)-Math.pow(e,2))/(2*t*r);return Math.acos(n)||0}function Ac(e,t,r,n,i,o,a,s,l){if(void 0===l&&(l=!1),l){if(e>a||t>s||i>r||o>n)return!1;if((r===i||e===a)&&(n<o||t>s))return!1;if((n===t||t===n)&&(r<i||e>a))return!1}else if(e>=a||t>=s||i>=r||o>=n)return!1;return!0}function kc(e,t,r,n,i,o){var a,s;void 0===o&&(o=!1),e>r&&(e=(a=[r,e])[0],r=a[1]),t>n&&(t=(s=[n,t])[0],n=s[1]);for(var l=0,c=0,u=0,h=0,d=0,f=i.length;d<f;d++){var p=i[d],v=p.x,m=p.y;if(d?(l=Math.min(l,v),c=Math.min(c,m),u=Math.max(u,v),h=Math.max(h,m)):(l=v,c=m,u=v,h=m),o){if(v>=e&&v<=r&&m>=t&&m<=n)return!0}else if(v>e&&v<r&&m>t&&m<n)return!0;var g=i[(d+1)%f],y=g.x,b=g.y;if(v===y){if(v>=e&&v<=r)if(m>=b){if(m>=n&&b<=t)return!0}else if(m<=t&&b>=n)return!0}else if(m===b){if(m>=t&&m<=n)if(v>=y){if(v>=r&&y<=e)return!0}else if(v<=e&&y>=r)return!0}else{var x=y-v,w=b-m,E=(e-v)/x;if(E>=0&&E<=1){var _=m+E*w;if(o&&_>=t&&_<=n||!o&&_>t&&_<n)return!0}var S=(r-v)/x;if(S>=0&&S<=1){_=m+S*w;if(o&&_>=t&&_<=n||!o&&_>t&&_<n)return!0}}}return l<=e&&c<=t&&u>=r&&h>=n}var Mc={d2r:wc,r2d:Ec,H:4*(Math.sqrt(2)-1)/3,h:function(e){return e*=.5,(1-Math.cos(e))/Math.sin(e)*4/3},pointInConvexPolygon:_c,pointInRect:Sc,pointsDistance:Cc,angleBySides:Tc,isRectsOverlap:Ac,isRectsInside:function(e,t,r,n,i,o,a,s,l){if(void 0===l&&(l=!1),l){if(e<=i&&t<=o&&r>=a&&n>=s)return!0}else if(e<i&&t<o&&r>a&&n>s)return!0;return!1},isConvexPolygonsOverlap:function(e,t,r){void 0===r&&(r=!1);for(var n=0,i=0,o=0,a=0,s=0,l=e.length;s<l;s++){var c=e[s],u=c.x,h=c.y;s?(n=Math.min(n,u),i=Math.min(i,h),o=Math.max(o,u),a=Math.max(a,h)):(n=u,i=h,o=u,a=h)}var d=0,f=0,p=0,v=0;for(s=0,l=t.length;s<l;s++){var m=t[s];u=m.x,h=m.y;s?(d=Math.min(d,u),f=Math.min(f,h),p=Math.max(p,u),v=Math.max(v,h)):(d=u,f=h,p=u,v=h)}if(r){if(n>p||i>v||o<d||a<f)return!1}else if(n>=p||i>=v||o<=d||a<=f)return!1;var g=!0;e:for(s=0,l=e.length;s<l;s++)for(var y=e[s],b=(u=y.x,h=y.y,void 0),x=0,w=t.length;x<w-1;x++){var E=t[x],_=E.x,S=E.y,C=t[(x+1)%w];if(0!==(I=ql((L=C.x)-_,(R=C.y)-S,u-_,h-S))){if(I=I>0?1:0,void 0===b)b=I;else if(b^I){g=!1;continue e}}else if(r){if(u===_&&h===S||u===L&&h===R)return!0;var T=L-u,A=h-S,k=R-h;if(0===(D=u-_)||0===T){if(A^k)return!0}else if(0===A||0===k){if(D^T)return!0}else if(D^T&&A^k)return!0;g=!1}}if(g)return!0;e:for(s=0,l=t.length;s<l-1;s++)for(var M=t[s],O=(u=M.x,h=M.y,b=void 0,x=0,e.length);x<O-1;x++){var L,R,I,P=e[x],F=(_=P.x,S=P.y,e[(x+1)%O]);if(0!==(I=ql((L=F.x)-_,(R=F.y)-S,u-_,h-S))){if(I=I>0?1:0,void 0===b)b=I;else if(b^I){g=!1;continue e}}else if(r){if(u===_&&h===S||u===L&&h===R)return!0;var D;T=L-u,A=h-S,k=R-h;if(0===(D=u-_)||0===T){if(A^k)return!0}else if(0===A||0===k){if(D^T)return!0}else if(D^T&&A^k)return!0;g=!1}}return!!g},isConvexPolygonOverlapRect:kc},Oc={position:/(([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-?gradient\s*\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i,blur:/(gauss|motion|radial|background)\s*\((.+)\)/i,color:/(?:#[a-f\d]{3,8})|(?:rgba?\s*\(.+?\))/i,number:/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)[pxremvwhina%]*/gi};function Lc(e,t){return Rc(e,wc(t))}function Rc(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=e[5]=n,e[1]=r,e[4]=-r,e}function Ic(e,t,r){var n=e.slice(0);return 0===t&&0===r||oc(e)?n:n=uc(n=hc(t,r,n),-t,-r)}function Pc(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0);var n=ic();n[12]=e.translateX?rh(e.translateX,t):0,n[13]=e.translateY?rh(e.translateY,r):0;var i=e.rotateZ?e.rotateZ.v:0,o=e.scaleX?e.scaleX.v:1,a=e.scaleY?e.scaleY.v:1;return oc(n)?Lc(n,i):i&&fc(n,wc(i)),1!==o&&(oc(n)?n[0]=o:pc(n,o)),1!==a&&(oc(n)?n[5]=a:vc(n,a)),n}function Fc(e,t,r){var n=e.slice(0);return n=hc(-t,-r,n=uc(n,t,r))}var Dc={calRotateZ:Lc,calRotateZRadian:Rc,calMatrix:Pc,calMatrixByOrigin:Ic,calTransformByMatrixAndOrigin:Fc},Nc=1e-9;function Bc(e){var t=[],r=e[3],n=e[2]/r,i=e[1]/r,o=(3*i-n*n)/3,a=(2*n*n*n-9*i*n+27*(e[0]/r))/27,s=n/3,l=a*a/4+o*o*o/27,c=a/2;if(Math.abs(l)<=Nc&&(l=0),l>0){var u=Math.sqrt(l),h=void 0,d=void 0;d=(h=-c+u)>=0?Math.pow(h,1/3):-Math.pow(-h,1/3),(h=-c-u)>=0?d+=Math.pow(h,1/3):d-=Math.pow(-h,1/3),t.push(d-s)}else if(l<0){var f=Math.sqrt(-o/3),p=Math.atan2(Math.sqrt(-l),-c)/3,v=Math.cos(p),m=Math.sin(p),g=Math.sqrt(3);t.push(2*f*v-s),t.push(-f*(v+g*m)-s),t.push(-f*(v-g*m)-s)}else{h=void 0;h=c>=0?-Math.pow(c,1/3):Math.pow(-c,1/3),t.push(2*h-s),t.push(-h-s)}return t}function Uc(e){for(var t=e.length-1,r=t;r>=0&&0===e[r];r--)t--;var n=[];switch(t){case 1:n=function(e){var t=[],r=e[1];return 0!==r&&t.push(-e[0]/r),t}(e);break;case 2:n=function(e){var t=[],r=e[2],n=e[1]/r,i=n*n-e[0]/r*4;if(i>0){var o=Math.sqrt(i);t.push(.5*(-n+o)),t.push(.5*(-n-o))}else 0===i&&t.push(.5*-n);return t}(e);break;case 3:n=Bc(e);break;case 4:n=function(e){var t=[],r=e[4],n=e[3]/r,i=e[2]/r,o=e[1]/r,a=e[0]/r,s=Bc([1,-i,n*o-4*a,-n*n*a+4*i*a-o*o].reverse())[0],l=n*n/4-i+s;if(Math.abs(l)<=Nc&&(l=0),l>0){var c=Math.sqrt(l),u=(p=3*n*n/4-c*c-2*i)+(f=(4*n*i-8*o-n*n*n)/(4*c)),h=p-f;if(Math.abs(u)<=Nc&&(u=0),Math.abs(h)<=Nc&&(h=0),u>=0){var d=Math.sqrt(u);t.push(-n/4+(c+d)/2),t.push(-n/4+(c-d)/2)}h>=0&&(d=Math.sqrt(h),t.push(-n/4+(d-c)/2),t.push(-n/4-(d+c)/2))}else if(l<0);else{var f;if((f=s*s-4*a)>=-Nc){var p;if(f<0&&(f=0),(p=3*n*n/4-2*i)+(f=2*Math.sqrt(f))>=Nc){var v=Math.sqrt(p+f);t.push(-n/4+v/2),t.push(-n/4-v/2)}p-f>=Nc&&(v=Math.sqrt(p-f),t.push(-n/4+v/2),t.push(-n/4-v/2))}}return t}(e)}return n}function zc(e,t,r,n){return[n-t,e-r,t*(r-e)-e*(n-t)]}function Xc(e,t,r){return[r,-1,t-r*e]}function Hc(e,t,r,n){return t===n?0:e===r?n>t?1/0:-1/0:(n-t)/(r-e)}var Gc={getRoots:Uc,twoPoint2General:zc,pointSlope2General:Xc,lineSlope:Hc};function jc(e,t,r,n,i,o){var a=Math.min(e,i),s=Math.min(t,o),l=Math.max(e,i),c=Math.max(t,o);if(r<a||n<s||r>l||n>c){var u=(e-r)/(e-2*r+i);isNaN(u)||u<0?u=0:u>1&&(u=1);var h=(t-n)/(t-2*n+o);isNaN(h)||h<0?h=0:h>1&&(h=1);var d=1-u,f=1-h,p=d*d*e+2*d*u*r+u*u*i,v=f*f*t+2*f*h*n+h*h*o;a=Math.min(a,p),s=Math.min(s,v),l=Math.max(l,p),c=Math.max(c,v)}return[a,s,l,c]}function Yc(e,t,r,n,i,o,a,s){Array.isArray(e)&&(a=e[3].x,s=e[3].y,i=e[2].x,o=e[2].y,r=e[1].x,n=e[1].y,t=e[0].y,e=e[0].x);var l=Math.min(e,a),c=Math.min(t,s),u=Math.max(e,a),h=Math.max(t,s);(r<l||n<c||r>u||n>h||i<l||o<c||i>u||o>h)&&au(e,t,r,n,i,o,a,s).forEach((function(d){var f=$c([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],d);l=Math.min(l,f.x),c=Math.min(c,f.y),u=Math.max(u,f.x),h=Math.max(h,f.y)}));return[l,c,u,h]}function Wc(e,t,r,n,i,o,a,s){var l=arguments.length;if(Array.isArray(e)){if((l=e.length)<2||l>4)throw new Error("Unsupported order");return 4===l?Yc(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y):3===l?jc(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y):[Math.min(e[0].x,e[1].x),Math.min(e[0].y,e[1].y),Math.max(e[0].x,e[1].x),Math.max(e[0].y,e[1].y)]}if(4===l||void 0===i||void 0===o)return[Math.min(e,r),Math.min(t,n),Math.max(e,r),Math.max(t,n)];if(6===l||void 0===a||void 0===s)return jc(e,t,r,n,i,o);if(8===l)return Yc(e,t,r,n,i,o,a,s);throw new Error("Unsupported order")}function qc(e,t,r){var n=e,i=(2*t+r)/3,o=(t+2*r)/3;return(n(t)+3*n(i)+3*n(o)+n(r))*(r-t)/8}function Vc(e,t,r,n){void 0===n&&(n=1e-9);var i=e,o=(t+r)/2,a=qc(i,t,r),s=qc(i,t,o),l=qc(i,o,r),c=s+l-a;return Math.abs(c)<=15*n?s+l+c/15:Vc(i,t,o,n/2)+Vc(i,o,r,n/2)}function Kc(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=1),2===e.length){var n=e[0],i=n.x,o=n.y,a=e[1],s=a.x,l=a.y;return Math.sqrt(Math.pow(s-i,2)+Math.pow(l-o,2))}if(e.length>4)throw new Error("Unsupported order");return Vc((function(t){var r=Zc(t,e);return Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))}),t,r)}function Zc(e,t,r){if(void 0===r&&(r=1),4===t.length)return function(e,t,r){void 0===r&&(r=1);var n=t[0],i=n.x,o=n.y,a=t[1],s=a.x,l=a.y,c=t[2],u=c.x,h=c.y,d=t[3],f=d.x,p=d.y,v=0,m=0;return 0===r?(v=Math.pow(1-e,3)*i+3*e*Math.pow(1-e,2)*s+3*(1-e)*Math.pow(e,2)*u+Math.pow(e,3)*f,m=Math.pow(1-e,3)*o+3*e*Math.pow(1-e,2)*l+3*(1-e)*Math.pow(e,2)*h+Math.pow(e,3)*p):1===r?(v=3*((1-e)*(1-e)*(s-i)+2*(1-e)*e*(u-s)+e*e*(f-u)),m=3*((1-e)*(1-e)*(l-o)+2*(1-e)*e*(h-l)+e*e*(p-h))):2===r?(v=6*(u-2*s+i)*(1-e)+6*(f-2*u+s)*e,m=6*(h-2*l+o)*(1-e)+6*(p-2*h+l)*e):3===r&&(v=6*(f-3*u+3*s-i),m=6*(p-3*h+3*l-o)),{x:v,y:m}}(e,t,r);if(3===t.length)return function(e,t,r){void 0===r&&(r=1);var n=t[0],i=n.x,o=n.y,a=t[1],s=a.x,l=a.y,c=t[2],u=c.x,h=c.y,d=0,f=0;return 0===r?(d=Math.pow(1-e,2)*i+2*e*(1-e)*s+Math.pow(e,2)*u,f=Math.pow(1-e,2)*o+2*e*(1-e)*l+Math.pow(e,2)*h):1===r?(d=2*(1-e)*(s-i)+2*e*(u-s),f=2*(1-e)*(l-o)+2*e*(h-l)):2===r&&(d=2*(u-2*s+i),f=2*(h-2*l+o)),{x:d,y:f}}(e,t,r);throw new Error("Unsupported order")}function Jc(e,t){var r=e[0],n=r.x,i=r.y,o=e[1],a=o.x,s=o.y,l=(a-n)*t+n,c=(s-i)*t+i;if(2===e.length)return[{x:n,y:i},{x:l,y:c}];var u=e[2],h=u.x,d=u.y,f=(h-a)*t+a,p=(d-s)*t+s,v=(f-l)*t+l,m=(p-c)*t+c;if(4===e.length){var g=e[3];return[{x:n,y:i},{x:l,y:c},{x:v,y:m},{x:(((g.x-h)*t+h-f)*t+f-v)*t+v,y:(((g.y-d)*t+d-p)*t+p-m)*t+m}]}if(3===e.length)return[{x:n,y:i},{x:l,y:c},{x:v,y:m}];throw new Error("Unsupported order")}function Qc(e,t,r){var n;void 0===t&&(t=0),void 0===r&&(r=1),t=Math.max(t,0),t=Math.min(t,1),r=Math.max(r,0),r=Math.min(r,1);var i=e.slice(0);if(0===t&&1===r)return i;var o=r<t;return o&&(t=(n=[r,t])[0],r=n[1]),r<1&&(i=Jc(e,r)),t>0&&(r<1&&(t/=r),i=Jc(i.reverse(),1-t).reverse()),o&&i.reverse(),i}function $c(e,t){if(void 0===t&&(t=0),0===t)return e[0];if(1===t)return e[e.length-1];if(4===e.length)return tu(e,t);if(3===e.length)return eu(e,t);if(2===e.length)return{x:e[0].x+(e[1].x-e[0].x)*t,y:e[0].y+(e[1].y-e[0].y)*t};throw new Error("Unsupported order")}function eu(e,t){return{x:e[0].x*(1-t)*(1-t)+2*e[1].x*t*(1-t)+e[2].x*t*t,y:e[0].y*(1-t)*(1-t)+2*e[1].y*t*(1-t)+e[2].y*t*t}}function tu(e,t){return{x:e[0].x*(1-t)*(1-t)*(1-t)+3*e[1].x*t*(1-t)*(1-t)+3*e[2].x*t*t*(1-t)+e[3].x*t*t*t,y:e[0].y*(1-t)*(1-t)*(1-t)+3*e[1].y*t*(1-t)*(1-t)+3*e[2].y*t*t*(1-t)+e[3].y*t*t*t}}function ru(e,t,r,n){if(void 0===n&&(n=1e-9),4===e.length)return function(e,t,r,n){void 0===n&&(n=1e-9);for(var i=vu(e,t,!0),o=vu(e,r,!1),a=[],s=0,l=i.length;s<l;s++)for(var c=i[s],u=0,h=o.length;u<h;u++){var d=o[u],f=Math.abs(c-d);f<=n&&a.push({x:c,y:d,diff:f})}a.sort((function(e,t){return e.diff-t.diff})),a.length>3&&a.splice(3);a=a.map((function(e){return.5*(e.x+e.y)}));var p=[];return a.forEach((function(i){var o=pu(e,i,!0),a=pu(e,i,!1);Math.abs(o-t)<=n&&Math.abs(a-r)<=n&&p.push(i)})),p}(e,t,r,n);if(3===e.length)return function(e,t,r,n){void 0===n&&(n=1e-9);for(var i=vu(e,t,!0),o=vu(e,r,!1),a=[],s=0,l=i.length;s<l;s++)for(var c=i[s],u=0,h=o.length;u<h;u++){var d=o[u],f=Math.abs(c-d);f<=n&&a.push({x:c,y:d,diff:f})}a.sort((function(e,t){return e.diff-t.diff})),a.length>2&&a.splice(2);a=a.map((function(e){return.5*(e.x+e.y)}));var p=[];return a.forEach((function(i){var o=pu(e,i,!0),a=pu(e,i,!1);Math.abs(o-t)<=n&&Math.abs(a-r)<=n&&p.push(i)})),p}(e,t,r,n);if(2===e.length)return function(e,t,r,n){void 0===n&&(n=1e-9);var i=(t-e[0].x)/(e[1].x-e[0].x),o=(r-e[0].y)/(e[1].y-e[0].y);if(Math.abs(i-o)<=n)return[.5*(i+o)];return[]}(e,t,r,n);throw new Error("Unsupported order")}function nu(e,t){if(void 0===t&&(t=0),2===e.length){var r=e[0],n=r.x,i=r.y,o=e[1];return Hc(n,i,o.x,o.y)}if(3===e.length)return iu(e,t);if(4===e.length)return ou(e,t);throw new Error("Unsupported order")}function iu(e,t){void 0===t&&(t=0);var r=du(e,t,!0);return 0===r?1/0:du(e,t,!1)/r}function ou(e,t){var r=du(e,t,!0);return 0===r?1/0:du(e,t,!1)/r}function au(e,t,r,n,i,o,a,s){var l=arguments.length;if(4===l)return[0,1];if(6===l)return function(e,t,r,n,i,o){var a=(e-r)/(e-2*r+i);isNaN(a)||a<0?a=0:a>1&&(a=1);var s=(t-n)/(t-2*n+o);isNaN(s)||s<0?s=0:s>1&&(s=1);var l=[a];return s!==a&&l.push(s),l.sort((function(e,t){return e-t})),l[0]>0&&l.unshift(0),l[l.length-1]<1&&l.push(1),l}(e,t,r,n,i,o);if(8===l)return function(e,t,r,n,i,o,a,s){var l=-3*t+3*n,c=6*t-12*n+6*o,u=-3*t+9*n-9*o+3*s,h=Uc([-3*e+3*r,6*e-12*r+6*i,-3*e+9*r-9*i+3*a]).filter((function(e){return e>=0&&e<=1})),d=Uc([l,c,u]).filter((function(e){return e>=0&&e<=1})),f=h.concat(d);f.sort((function(e,t){return e-t}));for(var p=f.length-1;p>0;p--)f[p]===f[p-1]&&f.splice(p,1);return f}(e,t,r,n,i,o,a,s);throw new Error("Unsupported order")}function su(e,t,r){if(void 0===t&&(t=!0),void 0===r&&(r=1e-9),e.length<3||e.length>4)throw new Error("Unsupported order");var n=t?e[0].x:e[0].y,i=t?e[1].x:e[1].y,o=t?e[2].x:e[2].y;if(4===e.length){var a=Uc([3*i-3*n,2*(3*n-6*i+3*o),3*(3*i-n-3*o+(t?e[3].x:e[3].y))]).filter((function(e){return e>r&&e<1-r}));return a.sort((function(e,t){return e-t}))}if(3===e.length){a=Uc([2*(i-n),2*(n-2*i+o)]).filter((function(e){return e>r&&e<1-r}));return a}}function lu(e,t,r){if(void 0===t&&(t=!0),void 0===r&&(r=1e-9),e.length<3||e.length>4)throw new Error("Unsupported order");var n=t?e[0].x:e[0].y,i=t?e[1].x:e[1].y,o=t?e[2].x:e[2].y;if(4===e.length){var a=Uc([2*(3*n-6*i+3*o),6*(3*i-n-3*o+(t?e[3].x:e[3].y))]).filter((function(e){return e>r&&e<1-r}));return console.log(a),a.sort((function(e,t){return e-t}))}if(3===e.length)return(a=2*(n-2*i+o))>r&&a<1-r?[a]:[]}function cu(e,t,r,n){if(void 0===n&&(n=1e-9),e.length<2||e.length>4)throw new Error("Unsupported order");if(2===e.length){var i=e[1].x-e[0].x,o=e[1].y-e[0].y,a=t-e[0].x,s=r-e[0].y,l=Math.sqrt(Math.pow(i,2)+Math.pow(o,2)),c=Math.sqrt(Math.pow(a,2)+Math.pow(s,2)),u=Kl(i,o,a,s,!0),h=void 0,d=i*(h=1===u?-a/l:-1===u?a/l:u===1/0?-s/l:u===-1/0?s/l:c*u/l),f=o*h;return{x:d+=e[0].x,y:f+=e[0].y,d:Math.sqrt(Math.pow(d-t,2)+Math.pow(f-r,2)),t:h}}var p=su(e,!0),v=su(e,!1),m=lu(e,!0),g=lu(e,!1),y=[];p&&y.push.apply(y,p),v&&v.forEach((function(e){y.includes(e)||y.push(e)})),m&&m.forEach((function(e){y.includes(e)||y.push(e)})),g&&g.forEach((function(e){y.includes(e)||y.push(e)})),y.sort((function(e,t){return e-t}));var b=[];if(y.forEach((function(i,o){if(!o){var a=uu(e,0,i,t,r,n);void 0!==a&&b.push(a)}var s=uu(e,i,y[o+1]||1,t,r,n);void 0!==s&&b.push(s)})),!y.length){var x=uu(e,0,1,t,r,n);void 0!==x&&b.push(x)}if(b.sort((function(e,t){return e.d-t.d})),b.length)return{x:b[0].x,y:b[0].y,t:b[0].t,d:b[0].d}}function uu(e,t,r,n,i,o,a,s){void 0===o&&(o=1e-9),void 0===a&&(a=3),void 0===s&&(s=30);var l=[],c=hu(e,t,r,t,n,i,o,a,s);if(c&&l.push(c),1===r){var u=hu(e,t,r,r,n,i,o,a,s);u&&l.push(u)}var h=hu(e,t,r,.5*(t+r),n,i,o,a,s);if(h&&l.push(h),l.length)return l.sort((function(e,t){return e.d-t.d})),l[0]}function hu(e,t,r,n,i,o,a,s,l){void 0===a&&(a=1e-9),void 0===s&&(s=5),void 0===l&&(l=30);for(var c=n,u=0;u++<l;){var h=pu(e,n,!0)-i,d=pu(e,n,!1)-o,f=du(e,n,!0),p=du(e,n,!1),v=fu(e,n,!0),m=fu(e,n,!1),g=h*f+d*p,y=Math.pow(f,2)+h*v+Math.pow(p,2)+d*m;if(y<0)return;if((n-=g/y)>r?n=r:n<t&&(n=t),u>s){var b=pu(e,n,!0),x=pu(e,n,!1),w=pu(e,c,!0),E=pu(e,c,!1),_=Math.sqrt(Math.pow(b-w,2)+Math.pow(x-E,2));if(Math.abs(_)<a)break}c=n}var S=pu(e,n,!0),C=pu(e,n,!1);return{x:S,y:C,t:n,d:Math.sqrt(Math.pow(i-S,2)+Math.pow(o-C,2))}}function du(e,t,r){if(void 0===r&&(r=!0),e.length<3||e.length>4)throw new Error("Unsupported order");var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y,o=r?e[2].x:e[2].y;return 3===e.length?2*(n-2*i+o)*t+2*(i-n):4===e.length?3*(3*i-n-3*o+(r?e[3].x:e[3].y))*t*t+2*(3*n-6*i+3*o)*t+3*i-3*n:void 0}function fu(e,t,r){if(void 0===r&&(r=!0),e.length<2||e.length>4)throw new Error("Unsupported order");if(2===e.length)return 0;var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y,o=r?e[2].x:e[2].y;return 3===e.length?2*(n-2*i+o):4===e.length?6*(3*i-n-3*o+(r?e[3].x:e[3].y))*t+2*(3*n-6*i+3*o):void 0}function pu(e,t,r){if(void 0===r&&(r=!0),e.length<2||e.length>4)throw new Error("Unsupported order");var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y;if(2===e.length)return n+(i-n)*t;var o=r?e[2].x:e[2].y;if(3===e.length)return Math.pow(1-t,2)*n+2*t*(1-t)*i+Math.pow(t,2)*o;if(4===e.length){var a=r?e[3].x:e[3].y;return Math.pow(1-t,3)*n+3*Math.pow(1-t,2)*t*i+3*Math.pow(t,2)*(1-t)*o+Math.pow(t,3)*a}}function vu(e,t,r){void 0===r&&(r=!0);var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y,o=r?e[2].x:e[2].y;return 4===e.length?Uc([n-t,3*(i-n),3*(o+n-2*i),(r?e[3].x:e[3].y)-n+3*i-3*o]).filter((function(e){return e>=0&&e<=1})):Uc([n-t,2*(i-n),o+n-2*i]).filter((function(e){return e>=0&&e<=1}))}var mu={bboxBezier:Wc,bezierLength:Kc,bezierAt:Zc,sliceBezier:Qc,getPointByT:$c,getT:vu,getPointT:ru,getPointWithDByApprox:cu,bezierSlope:nu,bezierExtremaT:au,bezierTangent:function(e,t){if(void 0===t&&(t=0),2===e.length)return zc(e[0].x,e[0].y,e[1].x,e[1].y);if(3===e.length)return function(e,t){void 0===t&&(t=0);var r=iu(e,t),n=eu(e,t);return Xc(n.x,n.y,r)}(e,t);if(4===e.length)return function(e,t){void 0===t&&(t=0);var r=ou(e,t),n=tu(e,t);return Xc(n.x,n.y,r)}(e,t);throw new Error("Unsupported order")},splitBezierT:function(e,t,r,n){if(void 0===r&&(r=5),t<2)return[];if(e.length>4||e.length<2)throw new Error("Unsupported order");for(var i=e[0],o=e[e.length-1],a=[{x:i.x,y:i.y,t:0}],s=1/t,l=1;l<t;l++){var c=s*l,u=$c(e,c);a.push({x:u.x,y:u.y,t:c})}if(a.push({x:o.x,y:o.y,t:1}),2===e.length)return a;var h=(n=n||Kc(e))/t;for(l=0;l<r;l++){for(var d=[0],f=1;f<t;f++)d[f]=Math.sqrt(Math.pow(a[f].x-a[f-1].x,2)+Math.pow(a[f].y-a[f-1].y,2));var p=0;for(f=1;f<t;f++){p+=d[f]-h;var v=a[f],m=Zc(v.t,e,1),g=Math.sqrt(Math.pow(m.x,2)+Math.pow(m.y,2)),y=Zc(v.t,e,2),b=p*g,x=p*Math.sqrt(Math.pow(y.x,2)+Math.pow(y.y,2))+g*g;v.t=v.t-b/x;u=$c(e,v.t);v.x=u.x,v.y=u.y}}return a},getBezierMonotonicityT:su,getBezierMonotonicityT2:lu,bezierDerivative:du,bezierDerivative2:fu,bezierValue:pu},gu=nc.unitize3,yu=nc.crossProduct3,bu=nc.dotProduct3,xu=nc.isParallel3,wu=nc.length3;function Eu(e){var t=e[0],r=e[e.length-1];return[Math.min(t.x,r.x),Math.min(t.y,r.y),Math.max(t.x,r.x),Math.max(t.y,r.y)]}function _u(e,t,r,n,i,o){var a,s,l,c,u,h,d,f,p=[{a:e,b:t,t1:0,t2:1,t3:0,t4:1}],v=e.length,m=t.length;if(2===v&&2===m){var g=Tu(e[0].x,e[0].y,e[1].x,e[1].y,t[0].x,t[0].y,t[1].x,t[1].y,!0,r);return g&&o.push({x:g.x,y:g.y,t1:g.toSource,t2:g.toClip}),o}for(var y=function(){var e=p.pop(),t=e.a,n=e.b,g=e.t1,y=e.t2,b=e.t3,x=e.t4,w=i?Eu(t):Wc(t[0].x,t[0].y,t[1].x,t[1].y,null===(a=t[2])||void 0===a?void 0:a.x,null===(s=t[2])||void 0===s?void 0:s.y,null===(l=t[3])||void 0===l?void 0:l.x,null===(c=t[3])||void 0===c?void 0:c.y),E=i?Eu(n):Wc(n[0].x,n[0].y,n[1].x,n[1].y,null===(u=n[2])||void 0===u?void 0:u.x,null===(h=n[2])||void 0===h?void 0:h.y,null===(d=n[3])||void 0===d?void 0:d.x,null===(f=n[3])||void 0===f?void 0:f.y);if(i){if(t[0].x===n[0].x&&t[0].y===n[0].y)return o.push({x:t[0].x,y:t[0].y,t1:g,t2:b}),"continue";if(t[0].x===n[m-1].x&&t[0].y===n[m-1].y)return o.push({x:t[0].x,y:t[0].y,t1:g,t2:x}),"continue";if(t[v-1].x===n[0].x&&t[v-1].y===n[0].y)return o.push({x:n[0].x,y:n[0].y,t1:y,t2:b}),"continue";if(t[v-1].x===n[m-1].x&&t[v-1].y===n[m-1].y)return o.push({x:t[v-1].x,y:t[v-1].y,t1:y,t2:x}),"continue";if((w[0]===E[2]||w[2]===E[0])&&w[1]<=E[3]&&w[3]>=E[1]){var _=w[2]===E[0];if(2===v){if(T=Cu(t,n,w,_)){var S=g+T.tl*(y-g),C=b+T.tb*(x-b);o.push({x:T.x,y:T.y,t1:S,t2:C})}}else if(2===m){if(T=Cu(n,t,E,!_)){S=b+T.tl*(x-b),C=g+T.tb*(y-g);o.push({x:T.x,y:T.y,t1:C,t2:S})}}else{var T=function(e,t,r,n){var i,o,a,s,l,c;void 0===n&&(n=!0);var u=e.length,h=t.length,d=n?r[2]:r[0];if(e[0].x===d||e[u-1].x===d)if(t[0].x===d||t[h-1].x===d){if(e[0].x===d&&t[0].x===d&&e[0].y===t[0].y)return{x:d,y:e[0].y,ta:0,tb:0};if(e[0].x===d&&t[h-1].x===d&&e[0].y===t[h-1].y)return{x:d,y:e[0].y,ta:0,tb:1};if(e[u-1].x===d&&t[h-1].x===d&&e[u-1].y===t[h-1].y)return{x:d,y:e[u-1].y,ta:1,tb:1};if(e[u-1].x===d&&t[0].x===d&&e[u-1].y===t[0].y)return{x:d,y:e[u-1].y,ta:1,tb:0}}else{var f=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1})),p=$c(t,f[0]);if(e[0].x===d&&e[0].y===p.y)return{x:d,y:p.y,ta:0,tb:f[0]};if(e[u-1].x===d&&e[u-1].y===p.y)return{x:d,y:p.y,ta:1,tb:f[0]}}else{var v=au(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,null===(a=e[3])||void 0===a?void 0:a.x,null===(s=e[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1})),m=$c(e,v[0]);if(t[0].x===d||t[h-1].x===d){if(t[0].x===d&&t[0].y===m.y)return{x:d,y:m.y,ta:v[0],tb:0};if(t[h-1].x===d&&t[h-1].y===m.y)return{x:d,y:m.y,ta:v[0],tb:1}}else{var g=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(l=t[3])||void 0===l?void 0:l.x,null===(c=t[3])||void 0===c?void 0:c.y).filter((function(e){return e>0&&e<1})),y=$c(t,g[0]);if(m.y===y.y)return{x:d,y:m.y,ta:v[0],tb:g[0]}}}}(t,n,w,_);if(T){var A=g+T.ta*(y-g);C=b+T.tb*(x-b);o.push({x:T.x,y:T.y,t1:A,t2:C})}}return"continue"}if((w[1]===E[3]||w[3]===E[1])&&w[0]<=E[2]&&w[2]>=E[0]){var k=w[3]===E[1];if(2===v){if(T=Su(t,n,w,k)){S=g+T.tl*(y-g),C=b+T.tb*(x-b);o.push({x:T.x,y:T.y,t1:S,t2:C})}}else if(2===m){if(T=Su(n,t,E,!k)){S=b+T.tl*(x-b),C=g+T.tb*(y-g);o.push({x:T.x,y:T.y,t1:C,t2:S})}}else{T=function(e,t,r,n){var i,o,a,s,l,c;void 0===n&&(n=!0);var u=e.length,h=t.length,d=n?r[3]:r[1];if(e[0].y===d||e[u-1].y===d)if(t[0].y===d||t[h-1].y===d){if(e[0].y===d&&t[0].y===d&&e[0].x===t[0].x)return{x:e[0].x,y:d,ta:0,tb:0};if(e[0].y===d&&t[h-1].y===d&&e[0].x===t[h-1].x)return{x:e[0].x,y:d,ta:0,tb:1};if(e[u-1].y===d&&t[h-1].y===d&&e[u-1].x===t[h-1].x)return{x:e[u-1].x,y:d,ta:1,tb:1};if(e[u-1].y===d&&t[0].y===d&&e[u-1].x===t[0].x)return{x:e[u-1].x,y:d,ta:1,tb:0}}else{var f=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1})),p=$c(t,f[0]);if(e[0].y===d&&e[0].x===p.x)return{x:p.x,y:d,ta:0,tb:f[0]};if(e[u-1].y===d&&e[u-1].x===p.x)return{x:p.x,y:d,ta:1,tb:f[0]}}else{var v=au(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,null===(a=e[3])||void 0===a?void 0:a.x,null===(s=e[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1})),m=$c(e,v[0]);if(t[0].y===d||t[h-1].y===d){if(t[0].y===d&&t[0].x===m.x)return{x:m.x,y:d,ta:v[0],tb:0};if(t[h-1].y===d&&t[h-1].x===m.x)return{x:m.x,y:d,ta:v[0],tb:1}}else{var g=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(l=t[3])||void 0===l?void 0:l.x,null===(c=t[3])||void 0===c?void 0:c.y).filter((function(e){return e>0&&e<1})),y=$c(t,g[0]);if(m.x===y.x)return{x:m.x,y:d,ta:v[0],tb:g[0]}}}}(t,n,w,k);if(T){A=g+T.ta*(y-g),C=b+T.tb*(x-b);o.push({x:T.x,y:T.y,t1:A,t2:C})}}return"continue"}if(2===v){if(t[0].x===t[1].x)return vu(n,t[0].x,!0).forEach((function(e){if(!(e<0||e>1)){var r=$c(n,e),i=(r.y-t[0].y)/(t[1].y-t[0].y);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:i,t2:e})}})),"continue";if(t[0].y===t[1].y)return vu(n,t[0].y,!1).forEach((function(e){if(!(e<0||e>1)){var r=$c(n,e),i=(r.x-t[0].x)/(t[1].x-t[0].x);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:i,t2:e})}})),"continue"}else if(2===m){if(n[0].x===n[1].x)return vu(t,n[0].x,!0).forEach((function(e){if(!(e<0||e>1)){var r=$c(t,e),i=(r.y-n[0].y)/(n[1].y-n[0].y);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:e,t2:i})}})),"continue";if(n[0].y===n[1].y)return vu(t,n[0].y,!1).forEach((function(e){if(!(e<0||e>1)){var r=$c(t,e),i=(r.x-n[0].x)/(n[1].x-n[0].x);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:e,t2:i})}})),"continue"}}if(function(e,t,r,n,i){if(e[0]>t[2]||e[1]>t[3]||t[0]>e[2]||t[1]>e[3])return!1;if((e[2]===t[0]||e[0]===t[2])&&(t[3]<e[1]||e[1]>t[3]))return!1;if((e[3]===t[1]||e[1]===t[3])&&(t[2]<e[0]||e[0]>t[2]))return!1;var o=r.length,a=n.length;if(i){if(o===a){for(var s=r[0].x-n[0].x,l=r[0].y-n[0].y,c=!0,u=!0,h=0;h<o&&(r[h].x-n[h].x!==s&&(c=!1),r[h].y-n[h].y!==l&&(u=!1),c||u);h++);if(c&&u)return!1;if(c){for(var d=r[0].y-n[0].y,f=lu(r.map((function(e,t){return{x:e.x-n[t].x,y:e.y-n[t].y}})),!1)||[],p=(h=0,f.length);h<p;h++){var v=$c(r,f[h]),m=$c(n,f[h]);if(d>0&&v.y-m.y<=0||d<0&&v.y-m.y>=0)return!0}return!1}if(u){for(d=r[0].x-n[0].x,f=lu(r.map((function(e,t){return{x:e.x-n[t].x,y:e.y-n[t].y}})),!0)||[],h=0,p=f.length;h<p;h++){v=$c(r,f[h]),m=$c(n,f[h]);if(d>0&&v.x-m.x<=0||d<0&&v.x-m.x>=0)return!0}return!1}}}else{if(e[1]===t[3]||e[3]===t[1]){var g=e[1]===t[3]?e[1]:e[3];return 2===o?e[1]===e[3]||(n[1].y===g||n[a-2].y===g):2===a?t[1]===t[3]||(r[1].y===g||r[o-2].y===g):r[1].y===g||r[o-2].y===g||n[1].y===g||n[a-2].y===g}if(e[0]===t[2]||e[2]===t[0]){var y=e[0]===t[2]?e[0]:e[2];return 2===o?e[0]===e[2]||(n[1].x===y||n[a-2].y===y):2===a?t[0]===t[2]||(r[1].x===y||r[o-2].x===y):r[1].x===y||r[o-2].x===y||n[1].x===y||n[a-2].x===y}}return!0}(w,E,t,n,i)){if(v===m){for(var M=!0,O=0;O<v;O++)if(Math.abs(t[O].x-n[O].x)>.1*r||Math.abs(t[O].y-n[O].y)>.1*r){M=!1;break}if(M)return o.push({x:.5*(t[0].x+n[0].x),y:.5*(t[0].y+n[0].y),t1:g,t2:b}),o.push({x:.5*(t[v-1].x+n[m-1].x),y:.5*(t[v-1].y+n[m-1].y),t1:y,t2:x}),"continue"}var L=w[2]-w[0]||Number.EPSILON,R=w[3]-w[1]||Number.EPSILON,I=E[2]-E[0]||Number.EPSILON,P=E[3]-E[1]||Number.EPSILON;if(L<=r&&R<=r&&I<=r&&P<=r){A=.5*(g+y),C=.5*(b+x);if(0===g)((F=t[0]).x===n[0].x&&F.y===n[0].y||F.x===n[m-1].x&&F.y===n[m-1].y)&&(A=0);else if(1===y){((F=t[v-1]).x===n[0].x&&F.y===n[0].y||F.x===n[m-1].x&&F.y===n[m-1].y)&&(A=1)}if(0===b)((F=n[0]).x===t[0].x&&F.y===t[0].y||F.x===t[v-1].x&&F.y===t[v-1].y)&&(C=0);else if(1===x){var F;((F=n[m-1]).x===t[0].x&&F.y===t[0].y||F.x===t[v-1].x&&F.y===t[v-1].y)&&(C=1)}var D=$c(t,A),N=$c(n,C);o.push({x:.5*(D.x+N.x),y:.5*(D.y+N.y),t1:A,t2:C})}else if((L>r||R>r)&&(I>r||P>r)){var B=Qc(t,0,.5),U=Qc(t,.5,1),z=Qc(n,0,.5),X=Qc(n,.5,1);p.push({a:B,b:z,t1:g,t2:g+.5*(y-g),t3:b,t4:b+.5*(x-b)}),p.push({a:B,b:X,t1:g,t2:g+.5*(y-g),t3:b+.5*(x-b),t4:x}),p.push({a:U,b:z,t1:g+.5*(y-g),t2:y,t3:b,t4:b+.5*(x-b)}),p.push({a:U,b:X,t1:g+.5*(y-g),t2:y,t3:b+.5*(x-b),t4:x})}else if(L>r||R>r){B=Qc(t,0,.5),U=Qc(t,.5,1);p.push({a:B,b:n,t1:g,t2:g+.5*(y-g),t3:b,t4:x}),p.push({a:U,b:n,t1:g+.5*(y-g),t2:y,t3:b,t4:x})}else if(I>r||P>r){z=Qc(n,0,.5),X=Qc(n,.5,1);p.push({a:t,b:z,t1:g,t2:y,t3:b,t4:b+.5*(x-b)}),p.push({a:t,b:X,t1:g,t2:y,t3:b+.5*(x-b),t4:x})}}};p.length;)y();o.sort((function(e,t){return e.t1===t.t1?e.t2-t.t2:e.t1-t.t1}));for(var b=o.length-1;b>0;b--){var x=o[b],w=o[b-1];if(Math.abs(x.x-w.x)<=n&&Math.abs(x.y-w.y)<=n)if(1===b)0===x.t1||1===x.t1||0===x.t2||1===x.t2?o.shift():o.splice(1,1);else for(var E=b-1;E>0;E--){var _=o[E],S=o[E-1],C=Math.abs(_.x-S.x)>n&&Math.abs(_.y-S.y)>n;if(C||1===E){var T=C?E:E-1,A=o[T];if(Math.abs(x.x-A.x)<=n&&Math.abs(x.y-A.y)<=n)if(0===x.t1||1===x.t1||0===x.t2||1===x.t2)o.splice(T,b-T);else if(0===A.t1||1===A.t1||0===A.t2||1===A.t2)o.splice(T+1,b-T);else{var k=o[T+b>>1];o.splice(T,b-T+1,k)}else o.splice(T+1,b-T-1);b=T;break}}}return o}function Su(e,t,r,n){var i,o,a,s;void 0===n&&(n=!0);var l=t.length,c=n?r[3]:r[1];if(r[1]===r[3])if(t[0].y===c||t[l-1].y===c){if((u=((d=t[0].y===c?t[0].x:t[l-1].x)-r[0])/(r[2]-r[0]))>=0&&u<=1)return{x:d,y:c,tl:u,tb:t[0].y===c?0:1}}else{var u,h=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1}));if((u=((f=$c(t,h[0])).x-r[0])/(r[2]-r[0]))>=0&&u<=1)return{x:f.x,y:c,tl:u,tb:h[0]}}else if(t[0].y===c||t[l-1].y===c){var d=t[0].y===c?t[0].x:t[l-1].x;if(e[0].x===d&&e[0].y===c||e[1].x===d&&e[1].y===c)return{x:d,y:c,tl:e[0].y===c?0:1,tb:t[0].y===c?0:1}}else{var f;h=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(a=t[3])||void 0===a?void 0:a.x,null===(s=t[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1}));if((f=$c(t,h[0])).x===e[0].x&&e[0].y===c||f.x===e[1].x&&e[1].y===c)return{x:f.x,y:c,tl:f.x===e[0].x?0:1,tb:h[0]}}}function Cu(e,t,r,n){var i,o,a,s;void 0===n&&(n=!0);var l=t.length,c=n?r[2]:r[0];if(r[0]===r[2])if(t[0].x===c||t[l-1].x===c){if((u=((d=t[0].x===c?t[0].y:t[l-1].y)-r[1])/(r[3]-r[1]))>=0&&u<=1)return{x:c,y:d,tl:u,tb:t[0].x===c?0:1}}else{var u,h=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1}));if((u=((f=$c(t,h[0])).y-r[1])/(r[3]-r[1]))>=0&&u<=1)return{x:c,y:f.y,tl:(f.y-r[1])/(r[3]-r[1]),tb:h[0]}}else if(t[0].x===c||t[l-1].x===c){var d=t[0].x===c?t[0].x:t[l-1].x;if(e[0].x===c&&e[0].y===d||e[1].x===c&&e[1].y===d)return{x:c,y:d,tl:e[0].x===c?0:1,tb:t[0].x===c?0:1}}else{var f;h=au(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(a=t[3])||void 0===a?void 0:a.x,null===(s=t[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1}));if((f=$c(t,h[0])).y===e[0].y&&e[0].x===c||f.y===e[1].y&&e[1].x===c)return{x:c,y:f.y,tl:f.y===e[0].y?0:1,tb:h[0]}}}function Tu(e,t,r,n,i,o,a,s,l,c){void 0===l&&(l=!0),void 0===c&&(c=0);var u=(s-o)*(r-e)-(a-i)*(n-t);if(0!==u){var h=((a-i)*(t-o)-(s-o)*(e-i))/u,d=((r-e)*(t-o)-(n-t)*(e-i))/u,f=1-c;if(l&&(h<c||h>f||d<c||d>f))return;return{x:e+h*(r-e),y:t+h*(n-t),toSource:h,toClip:d}}}function Au(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}}function ku(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function Mu(e,t,r){var n=Au(e,t),i=Au(r,t),o=bu(i.x,i.y,i.z,i.x,i.y,i.z);return bu(i.x,i.y,i.z,n.x,n.y,n.z)/o}var Ou={intersectLineLine:Tu,intersectBezier2Line:function(e,t,r,n,i,o,a,s,l,c,u,h,d){void 0===u&&(u=.1),void 0===h&&(h=.5),void 0===d&&(d=!1);var f=[];return _u([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:c}],u,h,d,f),f},intersectBezier3Line:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p){void 0===d&&(d=.1),void 0===f&&(f=.5),void 0===p&&(p=!1);var v=[];return _u([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],[{x:l,y:c},{x:u,y:h}],d,f,p,v),v},intersectBezier2Bezier2:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p){void 0===d&&(d=.1),void 0===f&&(f=.5),void 0===p&&(p=!1);var v=[];return _u([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:c},{x:u,y:h}],d,f,p,v),v},intersectBezier3Bezier3:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,m,g,y){void 0===m&&(m=.1),void 0===g&&(g=.5),void 0===y&&(y=!1);var b=[];return _u([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],[{x:l,y:c},{x:u,y:h},{x:d,y:f},{x:p,y:v}],m,g,y,b),b},intersectBezier2Bezier3:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,m){void 0===p&&(p=.1),void 0===v&&(v=.5),void 0===m&&(m=!1);var g=[];return _u([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:c},{x:u,y:h},{x:d,y:f}],p,v,m,g),g},intersectLineLine3:function(e,t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1e-9);var a=Au(e,r),s=Au(n,r),l=Au(t,e),c=a.x*s.x+a.y*s.y+a.z*s.z,u=s.x*l.x+s.y*l.y+s.z*l.z,h=a.x*l.x+a.y*l.y+a.z*l.z,d=s.x*s.x+s.y*s.y+s.z*s.z,f=(l.x*l.x+l.y*l.y+l.z*l.z)*d-u*u;if(!(Math.abs(f)<o)){var p,v,m=(c*u-h*d)/f,g=(c+u*m)/d,y={x:e.x+m*l.x,y:e.y+m*l.y,z:e.z+m*l.z},b={x:r.x+g*s.x,y:r.y+g*s.y,z:r.z+g*s.z};if(!((p=y,v=b,Math.sqrt(Math.pow(p.x-v.x,2)+Math.pow(p.y-v.y,2)+Math.pow(p.z-v.z,2)))>o)){var x,w,E=(x=ku(y,b),w=1/2,{x:x.x*w,y:x.y*w,z:x.z*w});if(!i)return E;var _=Mu(E,e,t),S=Mu(E,r,n);return _<0&&Math.abs(_)<1e-9?_=0:_>1&&_-1<1e-9&&(_=1),S<0&&Math.abs(S)<1e-9?S=0:S>1&&S-1<1e-9&&(S=1),E.pa=_,E.pb=S,1===i&&_>=0&&_<=1||2===i&&S>=0&&S<=1||3===i&&_>=0&&_<=1&&S>=0&&S<=1?E:void 0}}},intersectPlanePlane:function(e,t,r,n,i,o){var a=gu(t.x-e.x,t.y-e.y,t.z-e.z),s=gu(r.x-e.x,r.y-e.y,r.z-e.z),l=gu(i.x-n.x,i.y-n.y,i.z-n.z),c=gu(o.x-n.x,o.y-n.y,o.z-n.z),u=yu(a.x,a.y,a.z,s.x,s.y,s.z),h=gu(u.x,u.y,u.z),d=yu(l.x,l.y,l.z,c.x,c.y,c.z),f=gu(d.x,d.y,d.z);if(xu(h.x,h.y,h.z,f.x,f.y,f.z))return null;var p=yu(f.x,f.y,f.z,h.x,h.y,h.z),v=ku(a,l),m=gu(p.x,p.y,p.z),g=h.x,y=h.y,b=h.z,x=-g*e.x-y*e.y-b*e.z,w=f.x,E=f.y,_=f.z,S=-w*n.x-E*n.y-_*n.z,C=m.x,T=m.y,A=m.z,k=[-x,-S,-(-C*v.x-T*v.y-A*v.z)],M=g*(E*A-_*T)-y*(w*A-_*C)+b*(w*T-E*C);if(Math.abs(M)<1e-9)return null;var O=1/M,L={x:O*(E*A-_*T)*k[0]+O*(b*T-y*A)*k[1]+O*(y*_-b*E)*k[2],y:O*(_*C-w*A)*k[0]+O*(g*A-b*C)*k[1]+O*(b*w-g*_)*k[2],z:O*(w*T-E*C)*k[0]+O*(y*C-g*T)*k[1]+O*(g*E-y*w)*k[2]};return[L,ku(L,m)]},pointOnLine3:function(e,t,r,n){void 0===n&&(n=1e-9);var i=t.x-e.x,o=t.y-e.y,a=t.z-e.z,s=r.x-e.x,l=r.y-e.y,c=r.z-e.z,u=yu(i,o,a,s,l,c);return wu(u.x,u.y,u.z)<n}};function Lu(e,t){void 0===t&&(t=2);var r=Math.pow(10,t);return Math.round(e*r)/r}var Ru={geom:Mc,matrix:xc,vector:nc,isec:Ou,bezier:mu,toPrecision:Lu};function Iu(e,t,r){void 0===r&&(r=!1);for(var n=[],i=e[0].color,o=0,a=e.length;o<a;o++)n.push(e[o]);(1===n.length&&n.push(Ps(n[0])),void 0===n[0].offset&&(n[0].offset=0),n.length>1)&&(void 0===n[o=n.length-1].offset&&(n[o].offset=1));var s=n[0].offset;for(o=1,a=n.length;o<a-1;o++){if(void 0!==(b=n[o]).offset)s=b.offset;else{for(var l=o+1,c=n[n.length-1].offset;l<a-1;l++){var u=n[l];if(void 0!==u.offset){c=u.offset;break}}for(var h=(c-s)/(l-o+1),d=o;d<l;d++){n[d].offset=s+h*(d+1-o)}o=l}}n.sort((function(e,t){return e.offset-t.offset}));for(o=0,a=n.length;o<a;o++){if((b=n[o]).offset>1){n.splice(o);var f=n[o-1];if(f&&f.offset<1){var p=b.color[0]-f.color[0],v=b.color[1]-f.color[1],m=b.color[2]-f.color[2],g=b.color[3]-f.color[3],y=(1-f.offset)/(b.offset-f.offset);n.push({color:[b.color[0]+p*y,b.color[1]+v*y,b.color[2]+m*y,b.color[3]+g*y],offset:1})}break}}for(o=n.length-1;o>=0;o--){var b;if((b=n[o]).offset<0){n.splice(0,o+1);var x=n[o];if(x&&x.offset>0){p=x.color[0]-b.color[0],v=x.color[1]-b.color[1],m=x.color[2]-b.color[2],g=x.color[3]-b.color[3],y=-b.offset/(x.offset-b.offset);n.unshift({color:[b.color[0]+p*y,b.color[1]+v*y,b.color[2]+m*y,b.color[3]+g*y],offset:0})}break}}if(n.forEach((function(e){e.offset<0?e.offset=0:e.offset>1&&(e.offset=1)})),n.length||n.push({color:i,offset:0},{color:i,offset:1}),r){var w=n[0],E=n[n.length-1];if(w.offset>0||E.offset<1){p=E.color[0]-w.color[0],v=E.color[1]-w.color[1],m=E.color[2]-w.color[2],g=E.color[3]-w.color[3];var _=w.offset+(1-E.offset);if(w.offset>0){y=w.offset/_;n.unshift({color:[w.color[0]+p*y,w.color[1]+v*y,w.color[2]+m*y,w.color[3]+g*y],offset:0})}if(E.offset<1){y=(1-E.offset)/_;n.push({color:[E.color[0]-p*y,E.color[1]-v*y,E.color[2]-m*y,E.color[3]-g*y],offset:1})}}}return n}function Pu(e){if(Oc.gradient.test(e)){var t=Oc.gradient.exec(e);if(t&&["linear","radial","conic"].indexOf(t[1].toLowerCase())>-1)return!0}return!1}function Fu(e){var t=Oc.gradient.exec(e);if(t){var r={linear:Ws.LINEAR,radial:Ws.RADIAL,conic:Ws.CONIC}[t[1].toLowerCase()],n=void 0;if(r===Ws.LINEAR)if(o=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)/.exec(t[2]))n=[parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]),parseFloat(o[4])];else{var i=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)/.exec(t[2]);n=i?[wc(parseFloat(i[1]))]:[]}else if(r===Ws.RADIAL){var o;n=(o=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)(\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?))?/.exec(t[2]))?[parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]),parseFloat(o[4]),parseFloat(o[5])||0]:[.5,.5,1,1]}else r===Ws.CONIC&&(n=[]);var a=t[2].match(/(([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)?\s*((#[0-9a-f]{3,8})|(rgba?\s*\(.+?\)))\s*([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)?)|(transparent)/gi)||[],s=a.map((function(e,t){var r,n=/(?:#[0-9a-f]{3,8})|(?:rgba?\s*\(.+?\))|(?:transparent)/i.exec(e),i=/[-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?(?:(?:px)|%)?/.exec(e.replace(n[0],""));if(i){var o=pl(i[0]);o.u!==Xs.PERCENT&&(o.v*=100,o.u=Xs.PERCENT),r=o}else t?t===a.length-1&&(r={v:100,u:Xs.PERCENT}):r={v:0,u:Xs.PERCENT};return{color:{v:n?Wu(n[0]):[0,0,0,1],u:Xs.RGBA},offset:r}}));s.sort((function(e,t){return e.offset&&t.offset?e.offset.v-t.offset.v:0}));for(var l=s.length-2;l>0;l--){if(!s[l].offset){for(var c=s[l+1].offset.v,u=s[0].offset.v,h=l,d=l-1;d>=0;d--){if(0===d){l=d;break}if(s[d].offset){l=d,u=s[d].offset.v;break}}for(var f=(c-u)/(h-l+1),p=l+1;p<=h;p++)s[l].offset={v:u+(p-l)*f,u:Xs.PERCENT}}}return{t:r,d:n,stops:s}}}function Du(e,t,r,n,i){var o,a,s,l;if(e%(2*Math.PI)==0)o=s=.5*n,a=0,l=i;else if(e%Math.PI==0)o=s=.5*n,a=i,l=0;else if(e%(.5*Math.PI)==0)o=0,s=n,a=l=.5*i;else if(e%(1.5*Math.PI)==0)o=n,s=0,a=l=.5*i;else{var c=.5*n,u=.5*i,h=Math.min(c,u),d=Math.sin(e%360),f=Math.cos(e%360);o=c-h*d,a=u-h*f,s=c+h*d,l=u+h*f}return{x1:o+=t,y1:a+=r,x2:s+=t,y2:l+=r}}function Nu(e,t,r,n,i,o){var a,s,l,c,u;if(t.length<=1){var h=Du(null!==(a=t[0])&&void 0!==a?a:Math.PI,r,n,i,o);s=h.x1,l=h.y1,c=h.x2,u=h.y2}else s=r+t[0]*i,l=n+t[1]*o,c=r+t[2]*i,u=n+t[3]*o;var d=Math.sqrt(Math.pow(c-s,2)+Math.pow(u-l,2));return{x1:s,y1:l,x2:c,y2:u,total:d,stop:Iu(e,0,!1)}}function Bu(e,t,r,n,i,o){var a,s=r+t[0]*i,l=n+t[1]*o,c=r+t[2]*i,u=n+t[3]*o,h=t[4],d=Math.sqrt(Math.pow(c-s,2)+Math.pow(u-l,2)),f=Iu(e,0,!1);if(h&&1!==h){if(a=ic(),u!==l)if(c===s)fc(a,wc(u>=l?90:270));else fc(a,Math.atan((u-l)/(c-s)));vc(a,h),a=Ic(a,s,l)}return{cx:s,cy:l,tx:c,ty:u,ellipseLength:h,matrix:a,total:d,stop:f}}function Uu(e,t,r,n,i,o){var a=Math.floor(r+.5*i),s=Math.floor(n+.5*o),l=Math.floor(r+.5*i)-a,c=Math.floor(n+.5*o)-s;a%2==0&&a++,s%2==0&&s++;var u=0;u=0===l?c>=0?0:Math.PI:Math.atan(c/l);Math.sqrt(Math.pow(l,2)+Math.pow(c,2));return{angle:u,cx:a,cy:s,stop:Iu(e,0,!0)}}function zu(e,t,r,n){var i,o,a,s;void 0===t&&(t=100),void 0===r&&(r=100),void 0===n&&(n=!1);var l=e.t,c=e.d,u=e.stops,h=c[0],d=c[1],f=c[2],p=c[3];h*=t,f*=t,d*=r,p*=r;var v=0;1===c.length?v=c[0]:h===f?d<p&&(v=180):v=f>h?p>=d?90+Ec(Math.atan((p-d)/(f-h))):Ec(Math.atan((f-h)/(d-p))):p>=d?180+Ec(Math.atan((h-f)/(p-d))):360-Ec(Math.atan((h-f)/(d-p)));var m=u.slice(0);if(m.sort((function(e,t){return e.offset-t.offset})),l===Ws.LINEAR){var g=void 0,y=void 0;v<=90?(g={x:0,y:r},y={x:t,y:0}):v<=180?(g={x:0,y:0},y={x:t,y:r}):v<=270?(g={x:t,y:0},y={x:0,y:r}):(g={x:t,y:r},y={x:0,y:0});var b=Ps(m).sort((function(e,t){return e.offset-t.offset}));if(n){var x=Math.sqrt(Math.pow(p-g.y,2)+Math.pow(f-g.x,2)),w=Math.sqrt(Math.pow(d-g.y,2)+Math.pow(h-g.x,2)),E=Math.sqrt(Math.pow(p-d,2)+Math.pow(f-h,2)),_=Tc(x,w,E),S=_?w*Math.cos(_):w,C=(_=Tc(x=Math.sqrt(Math.pow(d-y.y,2)+Math.pow(h-y.x,2)),w=Math.sqrt(Math.pow(p-y.y,2)+Math.pow(f-y.x,2)),E))?w*Math.cos(_):w;if(b[0].offset>0&&b.unshift({color:b[0].color.slice(0),offset:0}),b[b.length-1].offset<1&&b.push({color:b[b.length-1].color.slice(0),offset:1}),S>1e-9)for(var T=S/E,A=function(e,t){var r=b[e];if(r.offset>=T){var n=b[e-1]||{color:r.color,offset:0};if(b.splice(0,e),r.offset>T){var i=E*(r.offset-n.offset),o=(S-n.offset*E)/i,a=n.color.map((function(e,t){return 3===t?e+(r.color[t]-e)*o:e+Math.floor((r.color[t]-e)*o)})),s={color:a,offset:0};b.unshift(s)}return"break"}},k=0,M=b.length;k<M;k++){if("break"===A(k))break}else S<-1e-9&&b.forEach((function(e){e.offset=(e.offset*E-S)/(E-S)}));if(C>1e-9){T=(E-C)/E;var O=function(e){var t=b[e];if(t.offset<=T){var r=b[e+1]||{color:t.color,offset:1};if(b.splice(e+1),t.offset<T){var n=E*(r.offset-t.offset),i=(C-(1-r.offset)*E)/n,o=r.color.map((function(e,r){return 3===r?e+(t.color[r]-e)*i:e+Math.floor((t.color[r]-e)*i)})),a={color:o,offset:1};b.push(a)}return"break"}};for(k=b.length-1;k>=0;k--){if("break"===O(k))break}}else C<-1e-9&&b.forEach((function(e){e.offset=e.offset*(E-S)/(E-S-C)}))}var L="linear-gradient(";return L+=n?Lu(v)+"deg":c.join(" "),b.forEach((function(e){L+=", ",e.color[3]=Lu(e.color[3]),L+=qu(e.color)+" "+Lu(100*e.offset)+"%"})),L+")"}if(l===Ws.RADIAL){var R=1;if(n){var I=Math.sqrt(Math.pow(f-h,2)+Math.pow(p-d,2)),P=Math.sqrt(Math.pow(h,2)+Math.pow(d,2)),F=Math.sqrt(Math.pow(h-t,2)+Math.pow(d,2)),D=Math.sqrt(Math.pow(h-t,2)+Math.pow(d-r,2)),N=Math.sqrt(Math.pow(h,2)+Math.pow(d-r,2)),B=Math.max(P,F,D,N);R=B/I}var U="radial-gradient(";return U+=n?"circle at ".concat(100*Lu(c[0]),"% ").concat(100*Lu(c[1]),"%, "):c.join(" ")+", ",m.forEach((function(e,t){t&&(U+=", ");var r=e.color.map((function(e,t){return 3===t?Lu(e):Math.min(255,Math.floor(e*R))}));U+=qu(r)+" "+Lu(100*e.offset)+"%"})),U+")"}if(l===Ws.CONIC){var z="conic-gradient(";n&&(z+="from 90deg, ");var X=m[0],H=m[m.length-1];if(n&&(X.offset>0||H.offset<1)){var G=[X.color[0]-H.color[0],X.color[1]-H.color[1],X.color[2]-H.color[2],null!==(o=null!==(i=X.color[3])&&void 0!==i?i:1-H.color[3])&&void 0!==o?o:1],j=1-H.offset+X.offset;if(X.offset>0){var Y=X.offset/j;m.unshift({color:[Math.min(255,Math.max(0,Math.round(X.color[0]-G[0]*Y))),Math.min(255,Math.max(0,Math.round(X.color[1]-G[1]*Y))),Math.min(255,Math.max(0,Math.round(X.color[2]-G[2]*Y))),Math.min(1,Math.max(0,null!==(a=X.color[3])&&void 0!==a?a:1-G[3]*Y))],offset:0})}if(H.offset<1){Y=(1-H.offset)/j;m.push({color:[Math.min(255,Math.max(0,Math.round(H.color[0]+G[0]*Y))),Math.min(255,Math.max(0,Math.round(H.color[1]+G[1]*Y))),Math.min(255,Math.max(0,Math.round(H.color[2]+G[2]*Y))),Math.min(1,Math.max(0,null!==(s=H.color[3])&&void 0!==s?s:1+G[3]*Y))],offset:1})}}return m.forEach((function(e,t){t&&(z+=", "),e.color[3]=Lu(e.color[3]),z+=qu(e.color)+" "+Lu(100*e.offset)+"%"})),z+")"}return""}var Xu={isGradient:Pu,parseGradient:Fu,getColorStop:Iu,getLinear:Nu,getRadial:Bu,getConic:Uu,convert2Css:zu,getLinearCoords:Du};function Hu(e){var t={};if(["left","top","right","bottom","width","height"].forEach((function(r){if(e.hasOwnProperty(r)){var n=pl(e[r]||0,!0);"width"!==r&&"height"!==r||n.v<0&&(n.v=0),t[r]=n}})),e.hasOwnProperty("lineHeight")){var r=e.lineHeight;if(Rs(r)||"normal"===r)t.lineHeight={v:0,u:Xs.AUTO};else(M=pl(r||0,!0)).v<=0&&(M={v:0,u:Xs.AUTO}),t.lineHeight=M}(e.hasOwnProperty("visibility")&&(t.visibility={v:/hidden/i.test(e.visibility)?nl.HIDDEN:nl.VISIBLE,u:Xs.NUMBER}),e.hasOwnProperty("fontFamily")&&(t.fontFamily={v:(e.fontFamily||"").toString().trim().replace(/['"]/g,"").replace(/\s*,\s*/g,","),u:Xs.STRING}),e.hasOwnProperty("fontSize"))&&((M=pl(e.fontSize||fl.defaultFontSize,!0)).v<=0&&(M.v=fl.defaultFontSize),t.fontSize=M);if(e.hasOwnProperty("fontWeight")){var n=e.fontWeight;Ss(n)?/thin/i.test(n)?t.fontWeight={v:100,u:Xs.NUMBER}:/lighter/i.test(n)?t.fontWeight={v:200,u:Xs.NUMBER}:/light/i.test(n)?t.fontWeight={v:300,u:Xs.NUMBER}:/medium/i.test(n)?t.fontWeight={v:500,u:Xs.NUMBER}:/semiBold/i.test(n)?t.fontWeight={v:600,u:Xs.NUMBER}:/bold/i.test(n)?t.fontWeight={v:700,u:Xs.NUMBER}:/extraBold/i.test(n)?t.fontWeight={v:800,u:Xs.NUMBER}:/black/i.test(n)?t.fontWeight={v:900,u:Xs.NUMBER}:t.fontWeight={v:400,u:Xs.NUMBER}:t.fontWeight={v:Math.min(900,Math.max(100,parseInt(n)||400)),u:Xs.NUMBER}}if(e.hasOwnProperty("fontStyle")){var i=e.fontStyle,o=Ys.NORMAL;/italic/i.test(i)?o=Ys.ITALIC:/oblique/i.test(i)&&(o=Ys.OBLIQUE),t.fontStyle={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("color")&&(t.color={v:Wu(e.color),u:Xs.RGBA}),e.hasOwnProperty("backgroundColor")){var a=e.backgroundColor;t.backgroundColor={v:Wu(a),u:Xs.RGBA}}if(e.hasOwnProperty("opacity")){var s=parseFloat(e.opacity);isNaN(s)&&(s=1),t.opacity={v:Math.max(0,Math.min(1,s)),u:Xs.NUMBER}}if(e.hasOwnProperty("fill")){var l=e.fill;Array.isArray(l)?t.fill=l.map((function(e){if(Ss(e))if(Pu(e)){if(t=Fu(e))return{v:t,u:Xs.GRADIENT}}else if(Oc.img.test(e)){var t;if(t=Oc.img.exec(e)){var r=rl.TILE,n=e.replace(t[0],"");n.indexOf("fill")>-1?r=rl.FILL:n.indexOf("stretch")>-1?r=rl.STRETCH:n.indexOf("fit")>-1&&(r=rl.FIT);var i=void 0,o=/([\d.]+)%/.exec(n);return o&&(i={v:parseFloat(o[1]),u:Xs.PERCENT}),{v:{url:t[2],type:r,scale:i},u:Xs.PATTERN}}}return{v:Wu(e),u:Xs.RGBA}})):t.fill=[]}if(e.hasOwnProperty("fillEnable")){var c=e.fillEnable;Array.isArray(c)?t.fillEnable=c.map((function(e){return{v:e,u:Xs.BOOLEAN}})):t.fillEnable=t.fill.map((function(){return{v:!0,u:Xs.BOOLEAN}}))}if(e.hasOwnProperty("fillOpacity")){var u=e.fillOpacity;Array.isArray(u)?t.fillOpacity=u.map((function(e){return{v:Math.max(0,Math.min(1,e)),u:Xs.NUMBER}})):t.fillOpacity=t.fill.map((function(){return{v:1,u:Xs.NUMBER}}))}if(e.hasOwnProperty("fillMode")){var h=e.fillMode;Array.isArray(h)?t.fillMode=h.map((function(e){return{v:ju(e),u:Xs.NUMBER}})):t.fillMode=t.fill.map((function(){return{v:js.NORMAL,u:Xs.NUMBER}}))}if(e.hasOwnProperty("fillRule")){var d=e.fillRule;t.fillRule={v:"evenodd"===d?Js.EVEN_ODD:Js.NON_ZERO,u:Xs.NUMBER}}if(e.hasOwnProperty("stroke")){var f=e.stroke;Array.isArray(f)?t.stroke=f.map((function(e){if(Ss(e))if(Pu(e)){if(t=Fu(e))return{v:t,u:Xs.GRADIENT}}else if(Oc.img.test(e)){var t;if(t=Oc.img.exec(e)){var r=rl.TILE,n=e.replace(t[0],"");n.indexOf("fill")>-1?r=rl.FILL:n.indexOf("stretch")>-1?r=rl.STRETCH:n.indexOf("fit")>-1&&(r=rl.FIT);var i=void 0,o=/([\d.]+)%/.exec(n);return o&&(i={v:parseFloat(o[1]),u:Xs.PERCENT}),{v:{url:t[2],type:r,scale:i},u:Xs.PATTERN}}}return{v:Wu(e),u:Xs.RGBA}})):t.stroke=[]}if(e.hasOwnProperty("strokeEnable")){var p=e.strokeEnable;Array.isArray(p)?t.strokeEnable=p.map((function(e){return{v:e,u:Xs.BOOLEAN}})):t.strokeEnable=t.stroke.map((function(){return{v:!0,u:Xs.BOOLEAN}}))}if(e.hasOwnProperty("strokeWidth")){var v=e.strokeWidth;Array.isArray(v)?t.strokeWidth=v.map((function(e){return{v:Math.max(0,e),u:Xs.PX}})):t.strokeWidth=t.stroke.map((function(){return{v:1,u:Xs.NUMBER}}))}if(e.hasOwnProperty("strokePosition")){var m=e.strokePosition;Array.isArray(m)?t.strokePosition=m.map((function(e){var t=tl.CENTER;return"inside"===e?t=tl.INSIDE:"outside"===e&&(t=tl.OUTSIDE),{v:t,u:Xs.NUMBER}})):t.strokePosition=t.stroke.map((function(){return{v:tl.CENTER,u:Xs.NUMBER}}))}if(e.hasOwnProperty("strokeMode")){var g=e.strokeMode;Array.isArray(g)?t.strokeMode=g.map((function(e){return{v:ju(e),u:Xs.NUMBER}})):t.strokeMode=t.stroke.map((function(){return{v:js.NORMAL,u:Xs.NUMBER}}))}if(e.hasOwnProperty("strokeDasharray")){var y=e.strokeDasharray;Array.isArray(y)?t.strokeDasharray=y.map((function(e){return{v:Math.max(0,e),u:Xs.PX}})):t.strokeDasharray=[]}if(e.hasOwnProperty("strokeLinecap")){var b=e.strokeLinecap;o=$s.BUTT;"round"===b?o=$s.ROUND:"square"===b&&(o=$s.SQUARE),t.strokeLinecap={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("strokeLinejoin")){var x=e.strokeLinejoin;o=el.MITER;"round"===x?o=el.ROUND:"bevel"===x&&(o=el.BEVEL),t.strokeLinejoin={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("strokeMiterlimit")&&(t.strokeMiterlimit={v:parseFloat(e.strokeMiterlimit)||0,u:Xs.NUMBER}),["translateX","translateY","scaleX","scaleY","rotateZ"].forEach((function(r){if(e.hasOwnProperty(r)){var n=pl(e[r],!1);!function(e,t){"scaleX"===e||"scaleY"===e?t.u=Xs.NUMBER:"translateX"===e||"translateY"===e?t.u===Xs.NUMBER&&(t.u=Xs.PX):t.u===Xs.NUMBER&&(t.u=Xs.DEG)}(r,n),t[r]=n}})),e.hasOwnProperty("letterSpacing")&&(t.letterSpacing=pl(e.letterSpacing||0,!0)),e.hasOwnProperty("paragraphSpacing")&&(t.paragraphSpacing=pl(e.paragraphSpacing||0,!0)),e.hasOwnProperty("textAlign")){var w=e.textAlign;o=Hs.LEFT;"center"===w?o=Hs.CENTER:"right"===w?o=Hs.RIGHT:"justify"===w&&(o=Hs.JUSTIFY),t.textAlign={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("textVerticalAlign")){var E=e.textVerticalAlign;o=Gs.TOP;"middle"===E?o=Gs.MIDDLE:"bottom"===E&&(o=Gs.BOTTOM),t.textVerticalAlign={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("textDecoration")){var _=e.textDecoration;Array.isArray(_)?t.textDecoration=_.map((function(e){var t=vl.NONE;return"underline"===e?t=vl.UNDERLINE:"line-through"!==e&&"lineThrough"!==e||(t=vl.LINE_THROUGH),{v:t,u:Xs.NUMBER}})):t.textDecoration=[]}if(e.hasOwnProperty("transformOrigin")){var S=e.transformOrigin,C=void 0;(C=Array.isArray(S)?S:(S||"").toString().match(Oc.position))&&C.length?1===C.length&&(C[1]=C[0]):C=[50,50];for(var T=[],A=0;A<2;A++){var k=C[A];if(/^[-+]?[\d.]/.test(k)){var M=pl(k,!0);T.push(M)}else T.push({v:{top:0,left:0,center:50,right:100,bottom:100}[k],u:Xs.PERCENT}),Rs(T[A].v)&&(T[A].v=50)}t.transformOrigin=T}if(e.hasOwnProperty("booleanOperation")){var O=e.booleanOperation;o=Vs.NONE;"union"===O?o=Vs.UNION:"subtract"===O?o=Vs.SUBTRACT:"intersect"===O?o=Vs.INTERSECT:"xor"===O&&(o=Vs.XOR),t.booleanOperation={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("mixBlendMode")&&(t.mixBlendMode={v:ju(e.mixBlendMode),u:Xs.NUMBER}),e.hasOwnProperty("pointerEvents")&&(t.pointerEvents={v:!!e.pointerEvents,u:Xs.BOOLEAN}),e.hasOwnProperty("maskMode")){var L=e.maskMode;o=Qs.NONE;"outline"===L?o=Qs.OUTLINE:"alpha"===L?o=Qs.ALPHA:"gray"===L?o=Qs.GRAY:"alpha-with"===L?o=Qs.ALPHA_WITH:"gray-with"===L&&(o=Qs.GRAY_WITH),t.maskMode={v:o,u:Xs.NUMBER}}if(e.hasOwnProperty("breakMask")&&(t.breakMask={v:!!e.breakMask,u:Xs.BOOLEAN}),e.hasOwnProperty("blur")){var R=e.blur;if(o=Oc.blur.exec(R)){var I=o[1].toLowerCase();if("gauss"===I)t.blur={v:{t:qs.GAUSSIAN,radius:{v:parseFloat(o[2])||0,u:Xs.PX}},u:Xs.BLUR};else if("background"===I){var P=0;(F=/saturation\s*\((.+)\)/i.exec(R))&&(P=parseInt(F[1])||0),t.blur={v:{t:qs.BACKGROUND,radius:{v:parseInt(o[2])||0,u:Xs.PX},saturation:{v:P,u:Xs.PERCENT}},u:Xs.BLUR}}else if("radial"===I){var F=/center\s*\((.+)\)/i.exec(R),D=[{v:50,u:Xs.PERCENT},{v:50,u:Xs.PERCENT}];if(F){var N=F[1].match(Oc.number);N&&(D[0]={v:parseFloat(N[0]),u:Xs.PERCENT},D[1]={v:parseFloat(N[1]),u:Xs.PERCENT})}t.blur={v:{t:qs.RADIAL,radius:{v:parseFloat(o[2])||0,u:Xs.PX},center:D},u:Xs.BLUR}}else if("motion"===I){F=/angle\s*\((.+)\)/i.exec(R);var B={v:0,u:Xs.DEG};F&&(B.v=parseFloat(F[1])),t.blur={v:{t:qs.MOTION,radius:{v:parseFloat(o[2])||0,u:Xs.PX},angle:B},u:Xs.BLUR}}else t.blur={v:{t:qs.NONE},u:Xs.BLUR}}else t.blur={v:{t:qs.NONE},u:Xs.BLUR}}if(e.hasOwnProperty("shadow")){var U=e.shadow;Array.isArray(U)?t.shadow=U.map((function(e){var t=Oc.color.exec(e),r=e;t&&(r=r.slice(0,t.index)+r.slice(t.index+t[0].length));var n=r.match(Oc.number),i=pl(n?n[0]:"0px",!0),o=pl(n?n[1]:"0px",!0),a=pl(n?n[2]:"0px",!0);return a.v=Math.max(0,a.v),{v:{x:i,y:o,blur:a,spread:pl(n?n[3]:"0px",!0),color:{v:Wu(t?t[0]:"#000"),u:Xs.RGBA}},u:Xs.SHADOW}})):t.shadow=[]}if(e.hasOwnProperty("shadowEnable")){var z=e.shadowEnable;Array.isArray(z)?t.shadowEnable=z.map((function(e){return{v:e,u:Xs.BOOLEAN}})):t.shadowEnable=t.shadow.map((function(){return{v:!0,u:Xs.BOOLEAN}}))}if(e.hasOwnProperty("innerShadow")){var X=e.innerShadow;Array.isArray(X)?t.innerShadow=X.map((function(e){var t=Oc.color.exec(e),r=e;t&&(r=r.slice(0,t.index)+r.slice(t.index+t[0].length));var n=r.match(Oc.number),i=pl(n?n[0]:"0px",!0),o=pl(n?n[1]:"0px",!0),a=pl(n?n[2]:"0px",!0);a.v=Math.max(0,a.v);var s=pl(n?n[3]:"0px",!0);return s.v=Math.max(0,s.v),{v:{x:i,y:o,blur:a,spread:s,color:{v:Wu(t?t[0]:"#000"),u:Xs.RGBA}},u:Xs.SHADOW}})):t.innerShadow=[]}if(e.hasOwnProperty("innerShadowEnable")){var H=e.innerShadowEnable;Array.isArray(H)?t.innerShadowEnable=H.map((function(e){return{v:e,u:Xs.BOOLEAN}})):t.innerShadowEnable=t.innerShadow.map((function(){return{v:!0,u:Xs.BOOLEAN}}))}if(["hueRotate","saturate","brightness","contrast"].forEach((function(r){if(e.hasOwnProperty(r)){var n=pl(e[r]);"hueRotate"===r?n.u!==Xs.DEG&&(n.u=Xs.DEG):n.u!==Xs.PERCENT&&(n.v*=100,n.u=Xs.PERCENT),t[r]=n}})),e.hasOwnProperty("matrix")){var G=e.matrix;Array.isArray(G)&&(t.matrix={v:G,u:Xs.MATRIX})}return t}function Gu(e){return Z(Z({},e),{color:Wu(e.color),textAlign:{left:Hs.LEFT,center:Hs.CENTER,right:Hs.RIGHT,justify:Hs.JUSTIFY}[e.textAlign],textDecoration:e.textDecoration.map((function(e){return{none:vl.NONE,underline:vl.UNDERLINE,lineThrough:vl.LINE_THROUGH,"line-through":vl.LINE_THROUGH}[e]}))})}function ju(e){var t=js.NORMAL;return/multiply/i.test(e)?t=js.MULTIPLY:/screen/i.test(e)?t=js.SCREEN:/overlay/i.test(e)?t=js.OVERLAY:/darken/i.test(e)?t=js.DARKEN:/lighten/i.test(e)?t=js.LIGHTEN:/color[\-\s]dodge/i.test(e)||/colorDodge/.test(e)?t=js.COLOR_DODGE:/color[\-\s]burn/i.test(e)||/colorBurn/.test(e)?t=js.COLOR_BURN:/hard[\-\s]light/i.test(e)||/hardLight/.test(e)?t=js.HARD_LIGHT:/soft[\-\s]light/i.test(e)||/softLight/.test(e)?t=js.SOFT_LIGHT:/difference/i.test(e)?t=js.DIFFERENCE:/exclusion/i.test(e)?t=js.EXCLUSION:/hue/i.test(e)?t=js.HUE:/saturation/i.test(e)?t=js.SATURATION:/color/i.test(e)?t=js.COLOR:/luminosity/i.test(e)&&(t=js.LUMINOSITY),t}function Yu(e,t,r){var n=t[e],i=r[e];if("transformOrigin"===e)return n[0].v===i[0].v&&n[0].u===i[0].u&&n[1].v===i[1].v&&n[1].u===i[1].u;if("color"===e||"backgroundColor"===e)return n.v[0]===i.v[0]&&n.v[1]===i.v[1]&&n.v[2]===i.v[2]&&n.v[3]===i.v[3];if("fill"===e||"stroke"===e){if(n.length!==i.length)return!1;for(var o=0,a=n.length;o<a;o++){var s=n[o],l=i[o];if(s.u!==l.u)return!1;if(s.u===Xs.RGBA){if(s.v[0]!==l.v[0]||s.v[1]!==l.v[1]||s.v[2]!==l.v[2]||s.v[3]!==l.v[3])return!1}else if(s.u===Xs.GRADIENT){if(s.v.t!==l.v.t)return!1;if(s.v.d.length!==l.v.d.length)return!1;for(var c=0,u=s.v.d.length;c<u;c++)if(s.v.d[c]!==l.v.d[c])return!1;if(s.v.stops.length!==l.v.stops.length)return!1;for(var h=0,d=s.v.stops.length;h<d;h++){var f=s.v.stops[h],p=l.v.stops[h];if(f.color.v[0]!==p.color.v[0]||f.color.v[1]!==p.color.v[1]||f.color.v[2]!==p.color.v[2]||f.color.v[3]!==p.color.v[3])return!1;if(f.offset&&!p.offset||!f.offset&&p.offset)return!1;if(f.offset.u!==p.offset.u||f.offset.v!==p.offset.v)return!1}}}return!0}if("fillEnable"===e||"fillRule"===e||"fillOpacity"===e||"strokeEnable"===e||"strokeWidth"===e||"strokePosition"===e||"strokeDasharray"===e||"shadowEnable"===e||"innerShadowEnable"===e){if(n.length!==i.length)return!1;for(o=0,a=n.length;o<a;o++){s=n[o],l=i[o];if(s.u!==l.u||s.v!==l.v)return!1}return!0}if("matrix"===e){if(n&&!i||!n&&i)return!1;var v=n.v,m=i.v;if(v.length!==m.length)return!1;for(o=0,a=v.length;o<a;o++)if(v[o]!==m[o])return!1;return!0}if("shadow"===e||"innerShadow"===e){if(n.length!==i.length)return!1;for(o=0,a=n.length;o<a;o++){s=n[o].v,l=i[o].v;if(s.x.v!==l.x.v||s.x.u!==l.x.u||s.y.v!==l.y.v||s.y.u!==l.y.u||s.blur.v!==l.blur.v||s.blur.u!==l.blur.u||s.spread.v!==l.spread.v||s.spread.u!==l.spread.u)return!1;var g=s.color.v,y=l.color.v;if(g[0]!==y[0]||g[1]!==y[1]||g[2]!==y[2]||g[3]!==y[3])return!1}return!0}return n.v===i.v&&n.u===i.u}function Wu(e){if(Array.isArray(e))return e;var t=[];if(!e||/transparent/i.test(e))t=[0,0,0,0];else if(/^#?[a-f\d]{3,8}$/i.test(e))3===(e=e.replace("#","")).length||4===e.length?(t.push(parseInt(e.charAt(0)+e.charAt(0),16)),t.push(parseInt(e.charAt(1)+e.charAt(1),16)),t.push(parseInt(e.charAt(2)+e.charAt(2),16)),4===e.length?t[3]=parseInt(e.charAt(3)+e.charAt(3),16):t[3]=1):6===e.length?(t.push(parseInt(e.slice(0,2),16)),t.push(parseInt(e.slice(2,4),16)),t.push(parseInt(e.slice(4),16)),t[3]=1):8===e.length?(t.push(parseInt(e.slice(0,2),16)),t.push(parseInt(e.slice(2,4),16)),t.push(parseInt(e.slice(4,6),16)),t.push(parseInt(e.slice(6),16)/255)):(t[0]=t[1]=t[2]=0,t[3]=1);else{var r=e.match(/rgba?\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)(?:\s*,\s*([\d.]+))?\s*\)/i);r?(t=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],Rs(r[4])?t[3]=1:t[3]=parseFloat(r[4])):t=[0,0,0,0]}return t}function qu(e){var t=Wu(e);return Array.isArray(t)&&(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),3===t.length||4===t.length)?4===t.length?(t[3]=Math.max(t[3],0),"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"):"rgba("+t[0]+","+t[1]+","+t[2]+",1)":e||"rgba(0,0,0,0)"}function Vu(e){var t=e.toString(16).toUpperCase();return 1===t.length&&(t="0"+t),t}function Ku(e){var t=Wu(e);return!Array.isArray(t)||3!==t.length&&4!==t.length?e||"#000":(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),4===t.length&&t[3]<1?(t[3]=Math.max(t[3],0),"#"+Vu(t[0])+Vu(t[1])+Vu(t[2])+Vu(Math.floor(255*t[3]))):"#"+Vu(t[0])+Vu(t[1])+Vu(t[2]))}function Zu(e){return Array.isArray(e)||(e=Wu(e)),[e[0]/255,e[1]/255,e[2]/255,3===e.length?1:e[3]]}function Ju(e){var t=e.fontSize||fl.defaultFontSize,r=e.fontFamily||fl.defaultFontFamily;/[\s.,/\\]/.test(r)&&(r='"'+r.replace(/"/g,'\\"')+'"');var n="";e.fontStyle===Ys.ITALIC&&(n="italic ");var i="";return 400!==e.fontWeight&&(i=e.fontWeight+" "),n+i+t+"px "+r}function Qu(e){for(var t=e.split(/\s*,\s*/),r=0,n=t.length;r<n;r++){var i=t[r].replace(/^['"]/,"").replace(/['"]$/,"");if(jl.hasRegister(i)||fl.checkSupportFontFamily(i))return i}return fl.defaultFontFamily}function $u(e,t){t||(t=Qu(e.fontFamily));var r=(jl.data[t]||jl.data[fl.defaultFontFamily]||jl.data.Arial||{}).lhr;return e.fontSize*r}function eh(e,t){var r=e.fontSize,n=Qu(e.fontFamily),i=$u(e,n),o=(jl.data[n]||jl.data[fl.defaultFontFamily]||jl.data.Arial||{}).blr||1;return.5*((null!=t?t:e.lineHeight)-i)+r*o}function th(e,t){var r=e.fontSize,n=Qu(e.fontFamily),i=$u(e,n),o=(jl.data[n]||jl.data[fl.defaultFontFamily]||jl.data.Arial||{}).car||1;return.5*((null!=t?t:e.lineHeight)-i)+r*o}function rh(e,t){return e.u===Xs.PX?e.v:e.u===Xs.PERCENT?e.v*t*.01:0}function nh(e,t,r,n,i){if(e===qs.NONE)return"none";var o=["none","gauss","motion","radial","background"][e]+"(".concat(t,")");if(e===qs.MOTION)o+=" angle(".concat(r||0,")");else if(e===qs.RADIAL){for(var a=(n||[]).map((function(e){return 100*e+"%"}));a.length<2;)a.push("50%");o+=" center(".concat(a.join(", "),")")}else e===qs.BACKGROUND&&(o+=" saturation(".concat(100*(void 0===i?1:i),"%)"));return o}function ih(e){return"".concat(qu(e.color)," ").concat(e.x," ").concat(e.y," ").concat(e.blur," ").concat(e.spread)}function oh(e,t,r,n){if(void 0===n&&(n=!1),Array.isArray(e))return qu(e);var i=e;if(void 0!==i.url){var o=["tile","fill","stretch","fit"][i.type];return"url(".concat(i.url,") ").concat(o," ").concat(i.scale)}return zu(e,t,r,n)}function ah(e){return["center","inside","outside"][e]||"inside"}function sh(e){return e[0]=Math.min(255,Math.max(0,Math.round(e[0]))),e[1]=Math.min(255,Math.max(0,Math.round(e[1]))),e[2]=Math.min(255,Math.max(0,Math.round(e[2]))),e.length>3&&(e[3]=Math.min(1,Math.max(0,e[3]))),e}var lh,ch={normalize:Hu,normalizeRich:Gu,normalizeColor:sh,equalStyle:Yu,color2rgbaInt:Wu,color2rgbaStr:qu,color2hexStr:Ku,color2gl:Zu,calFontFamily:Qu,calNormalLineHeight:$u,getBaseline:eh,getContentArea:th,calSize:rh,getCssBlur:nh,getCssShadow:ih,getCssFillStroke:oh,getCssStrokePosition:ah};function uh(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l;return Q(this,(function(c){switch(c.label){case 0:return[4,hh(e,"document.json")];case 1:if(t=c.sent(),r=[],!t.pages)return[3,5];n=0,i=t.pages.length,c.label=2;case 2:return n<i?(o=r,a=n,[4,hh(e,t.pages[n]._ref+".json")]):[3,5];case 3:o[a]=c.sent(),c.label=4;case 4:return n++,[3,2];case 5:return[4,hh(e,"meta.json")];case 6:return s=c.sent(),[4,hh(e,"user.json")];case 7:return l=c.sent(),[4,dh({document:t,pages:r,meta:s,user:l},e)];case 8:return[2,c.sent()]}}))}))}function hh(e,t){return J(this,void 0,void 0,(function(){var r,n;return Q(this,(function(i){switch(i.label){case 0:return[4,null===(n=e.file(t))||void 0===n?void 0:n.async("string")];case 1:return(r=i.sent())?[2,JSON.parse(r)]:[2,{}]}}))}))}function dh(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,h,d,f,p,v,m,g,y;return Q(this,(function(b){switch(b.label){case 0:return(r=((null===(m=e.document)||void 0===m?void 0:m.fontReferences)||[]).filter((function(e){if(!e.fontData||!e.fontData._ref)return!1;var t=e.fontFamilyName;return!jl.hasRegister(t)&&!!e.postscriptNames[0]}))).length?[4,Promise.all(r.map((function(e){return"MSFontData"===e.fontData._ref_class&&t?function(e,t){return J(this,void 0,void 0,(function(){var r,n;return Q(this,(function(i){switch(i.label){case 0:return(r=t.file(e))?[4,r.async("arraybuffer")]:(fl.error("font not exist: >>>".concat(e,"<<<")),[2]);case 1:return n=i.sent(),jl.registerAb(n),[2]}}))}))}(e.fontData._ref,t):"MSNetFontData"===e.fontData._ref_class?function(e,t){return J(this,void 0,void 0,(function(){return Q(this,(function(r){return jl.hasRegister(t)?[2]:[2,new Promise((function(t,r){fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){jl.registerAb(e),t()})).catch((function(){r()}))}))]}))}))}(e.fontData._ref,e.postscriptNames[0]):void 0})))]:[3,2];case 1:b.sent(),b.label=2;case 2:n={zipFile:t,user:e.user,imgSrcRecord:{}},i=[],o=(null===(g=e.document)||void 0===g?void 0:g.foreignSymbols)||[],h=0,d=o.length,b.label=3;case 3:return h<d?(a=i,s=h,[4,ph(o[h].symbolMaster,(h+1)/(d+1),n,c,u)]):[3,6];case 4:a[s]=b.sent(),b.label=5;case 5:return h++,[3,3];case 6:if(l=[],!e.pages)return[3,10];h=0,d=e.pages.length,b.label=7;case 7:return h<d?(f=l,p=h,[4,fh(e.pages[h],(h+1)/(d+1),n)]):[3,10];case 8:f[p]=b.sent(),b.label=9;case 9:return h++,[3,7];case 10:return[2,{document:{uuid:(v=e.document).do_objectID,assets:{uuid:v.assets.do_objectID},layerStyles:{uuid:v.layerStyles.do_objectID},layerTextStyles:{uuid:v.layerTextStyles.do_objectID}},pages:l,currentPageIndex:(null===(y=e.document)||void 0===y?void 0:y.currentPageIndex)||0,symbolMasters:i}]}}))}))}function fh(e,t,r){return J(this,void 0,void 0,(function(){var n,i,o,a,s,h,d,f,p,v,m;return Q(this,(function(g){switch(g.label){case 0:n=[],i=0,o=e.layers.length,g.label=1;case 1:return i<o?[4,ph(e.layers[i],(i+1)/(o+1),r,c,u)]:[3,4];case 2:(a=g.sent())&&n.push(a),g.label=3;case 3:return i++,[3,1];case 4:return s=0,h=0,d=1,(f=r.user[e.do_objectID])&&(p=f.scrollOrigin,v=f.zoomValue,p&&(m=/\{([+-.\d]+),\s*([+-.\d]+)}/.exec(p))&&(s=parseFloat(m[1])||0,h=parseFloat(m[2])||0),v&&(d=v)),[2,{tagName:l.PAGE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:e.frame.constrainProportions,rule:{baseX:e.horizontalRulerData.base,baseY:e.verticalRulerData.base},style:{width:c,height:u,visibility:"hidden",translateX:s,translateY:h,scaleX:d,scaleY:d,transformOrigin:[0,0],pointerEvents:!1},isLocked:!1,isExpanded:!1},children:n.filter((function(e){return e}))}]}}))}))}function ph(e,t,r,n,i){return J(this,void 0,void 0,(function(){var o,a,s,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C,T,A,k,M,O,L,R,I,P,F,D,N,B,U,z,X,H,G,j,Y,W,q,V,K,Z,J,$,te,re,ne,ie,oe,ae,se,le,ce,ue,he,de,fe,pe,ve,me,ge,ye,be,xe,we,Ee,_e,Se,Ce,Te,Ae,ke,Me,Oe,Le,Re,Ie,Pe,Fe,De,Ne,Be,Ue,ze,Xe,He,Ge,je,Ye,We,qe,Ve,Ke,Ze,Je,Qe,$e,et,tt,rt,nt,it,ot,at,st,lt,ct,ut,ht,dt,ft,pt,vt,mt,gt,yt,bt,xt,wt,Et,_t,St,Ct,Tt,At;return Q(this,(function(Q){switch(Q.label){case 0:if(o=e.frame.width||.5,a=e.frame.height||.5,s=e.frame.x||0,c=e.frame.y||0,n<0&&(n=0),i<0&&(i=0),o<0&&(s+=o,o=Math.abs(o)),a<0&&(c+=a,a=Math.abs(a)),u=e.isVisible?"visible":"hidden",h=null!==(it=null===(nt=null===(rt=e.style)||void 0===rt?void 0:rt.contextSettings)||void 0===nt?void 0:nt.opacity)&&void 0!==it?it:1,d=-e.rotation,f=e.isFlippedHorizontal?-1:1,p=e.isFlippedVertical?-1:1,e._class===ee.ClassValue.SymbolInstance&&e.scale&&1!==e.scale&&(f*=e.scale,p*=e.scale,v=o/e.scale,m=a/e.scale,s-=.5*(v-o),c-=.5*(m-a),o/=e.scale,a/=e.scale),g=e.isLocked,y=e.layerListExpandedType===ee.LayerListExpanded.Expanded,b=e.frame.constrainProportions,e._class!==ee.ClassValue.Artboard&&e._class!==ee.ClassValue.SymbolMaster)return[3,5];Qe=[],$e=0,et=e.layers.length,Q.label=1;case 1:return $e<et?[4,ph(e.layers[$e],($e+1)/(et+1),r,o,a)]:[3,4];case 2:(tt=Q.sent())&&Qe.push(tt),Q.label=3;case 3:return $e++,[3,1];case 4:return x=e.hasBackgroundColor,w=x?[Math.floor(255*e.backgroundColor.red),Math.floor(255*e.backgroundColor.green),Math.floor(255*e.backgroundColor.blue),e.backgroundColor.alpha]:[255,255,255,1],e._class===ee.ClassValue.SymbolMaster?(E=e.symbolID,_=e.includeBackgroundColorInInstance,[2,{tagName:l.SYMBOL_MASTER,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,constrainProportions:b,hasBackgroundColor:x,resizesContent:e.resizesContent,symbolId:E,includeBackgroundColorInInstance:_,style:{width:o,height:a,visibility:u,opacity:h,translateX:s,translateY:c,rotateZ:d,backgroundColor:w},isLocked:g,isExpanded:y},children:Qe.filter((function(e){return e}))}]):[2,{tagName:l.ART_BOARD,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,constrainProportions:b,hasBackgroundColor:x,resizesContent:e.resizesContent,style:{width:o,height:a,visibility:u,opacity:h,translateX:s,translateY:c,rotateZ:d,backgroundColor:w},isLocked:g,isExpanded:y},children:Qe.filter((function(e){return e}))}];case 5:return S=e.resizingConstraint^lh.UNSET,C=0,T=0,A="auto",k="auto",S&lh.LEFT?(C=s,S&lh.RIGHT?(A=n-s-o,o="auto"):S&lh.WIDTH||(A=100*(n-s-o)/n+"%",o="auto"),s=0):S&lh.RIGHT?(A=n-s-o,S&lh.WIDTH?C="auto":(C=100*s/n+"%",o="auto"),s=0):S&lh.WIDTH?(C=100*(s+.5*o)/n+"%",s="-50%"):(C=100*s/n+"%",A=100*(n-s-o)/n+"%",s=0,o="auto"),S&lh.TOP?(T=c,S&lh.BOTTOM?(k=i-c-a,a="auto"):S&lh.HEIGHT||(k=100*(i-c-a)/i+"%",a="auto"),c=0):S&lh.BOTTOM?(k=i-c-a,S&lh.HEIGHT?T="auto":(T=100*c/i+"%",a="auto"),c=0):S&lh.HEIGHT?(T=100*(c+.5*a)/i+"%",c="-50%"):(T=100*c/i+"%",k=100*(i-c-a)/i+"%",c=0,a="auto"),(!n||n<0)&&("auto"!==C&&(C="0%"),"auto"!==A&&(A="0%")),(!i||i<0)&&("auto"!==T&&(T="0%"),"auto"!==k&&(k="0%")),M="none",O=e.hasClippingMask,L=e.clippingMaskMode,O&&(M=L?"alpha":"outline"),R=e.shouldBreakMaskChain,I="none",(null===(at=null===(ot=e.style)||void 0===ot?void 0:ot.blur)||void 0===at?void 0:at.isEnabled)&&(P=e.style.blur,(F=P.type)===ee.BlurType.Gaussian?I="gauss(".concat(P.radius,"px)"):F===ee.BlurType.Background?I="background(".concat(P.radius,"px) saturation(").concat(100*(P.saturation||0),"%)"):F===ee.BlurType.Zoom?(D=P.center.match(Oc.number)||["0.5","0.5"],N=D.map((function(e){return 100*parseFloat(e)+"%"})),I="radial(".concat(P.radius,"px) center(").concat(N[0],", ").concat(N[1],")")):F===ee.BlurType.Motion&&(I="motion(".concat(P.radius,"px) angle(").concat(-1*(P.motionAngle||0),")"))),B=0,U=1,z=1,X=1,(H=null===(st=e.style)||void 0===st?void 0:st.colorControls)&&H.isEnabled&&(H.hue&&(B=Ec(H.hue)),U=H.saturation,H.brightness&&(z=H.brightness+1),X=H.contrast),G=null===(ct=null===(lt=e.style)||void 0===lt?void 0:lt.contextSettings)||void 0===ct?void 0:ct.blendMode,j=bh(G),Y=[],W=[],q=[],V=[],(K=null===(ut=e.style)||void 0===ut?void 0:ut.shadows)&&K.forEach((function(e){var t=[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha];Y.push("".concat(qu(t)," ").concat(e.offsetX," ").concat(e.offsetY," ").concat(e.blurRadius," ").concat(e.spread," ")),W.push(e.isEnabled)})),(Z=null===(ht=e.style)||void 0===ht?void 0:ht.innerShadows)&&Z.forEach((function(e){var t=[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha];q.push("".concat(qu(t)," ").concat(e.offsetX," ").concat(e.offsetY," ").concat(e.blurRadius," ").concat(e.spread)),V.push(e.isEnabled)})),e._class!==ee.ClassValue.SymbolInstance?[3,8]:[4,mh(e,r)];case 6:return J=Q.sent(),Ne=J.fill,Be=J.fillEnable,Ue=J.fillOpacity,[4,wh(e.overrideValues,r)];case 7:return $=Q.sent(),[2,{tagName:l.SYMBOL_INSTANCE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,symbolId:e.symbolID,overrideValues:$,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:y}}];case 8:if(e._class!==ee.ClassValue.Group)return[3,14];Qe=[],$e=0,et=e.layers.length,Q.label=9;case 9:return $e<et?[4,ph(e.layers[$e],($e+1)/(et+1),r,e.frame.width,e.frame.height)]:[3,12];case 10:(tt=Q.sent())&&Qe.push(tt),Q.label=11;case 11:return $e++,[3,9];case 12:return[4,mh(e,r)];case 13:return te=Q.sent(),Ne=te.fill,Be=te.fillEnable,Ue=te.fillOpacity,[2,{tagName:l.GROUP,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:y},children:Qe.filter((function(e){return e}))}];case 14:return e._class!==ee.ClassValue.Bitmap?[3,19]:(re="",ne="","MSImageData"!==e.image._ref_class?[3,16]:(ne=e.image._ref.replace(/^images\//,""),[4,yh(e.image._ref,r)]));case 15:return re=Q.sent(),[3,17];case 16:"MSNetworkImage"===e.image._ref_class&&(re=e.image._ref),Q.label=17;case 17:return[4,mh(e,r)];case 18:return ie=Q.sent(),Ne=ie.fill,Be=ie.fillEnable,Ue=ie.fillOpacity,ze=ie.fillMode,He=ie.stroke,Ge=ie.strokeEnable,je=ie.strokeWidth,Ye=ie.strokePosition,We=ie.strokeMode,qe=ie.strokeDasharray,Ve=ie.strokeLinecap,Ke=ie.strokeLinejoin,Ze=ie.strokeMiterlimit,[2,{tagName:l.BITMAP,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,stroke:He,strokeEnable:Ge,strokeWidth:je,strokePosition:Ye,strokeMode:We,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:q,innerShadowEnable:V,hueRotate:B,saturate:U,brightness:z,contrast:X},isLocked:g,isExpanded:y,src:re,md5:ne}}];case 19:return e._class!==ee.ClassValue.Text?[3,21]:(oe=e.textBehaviour,ae=void 0,oe===ee.TextBehaviour.Flexible?(ae=il.AUTO,"auto"!==C&&"auto"!==A&&(A="auto",se=parseFloat(C.toString()),C=/%$/.test(C.toString())?se+50*e.frame.width/n+"%":se+.5*e.frame.width,s="-50%"),o=e.frame.width,"auto"!==T&&"auto"!==k&&(k="auto",le=parseFloat(T.toString()),T=/%$/.test(T.toString())?le+50*e.frame.height/i+"%":le+.5*e.frame.height,c="-50%"),a=e.frame.height):oe===ee.TextBehaviour.Fixed?(ae=il.FIXED_W,"auto"!==T&&"auto"!==k&&(k="auto",le=parseFloat(T.toString()),T=/%$/.test(T.toString())?le+50*e.frame.height/i+"%":le+.5*e.frame.height,c="-50%"),a=e.frame.height):ae=il.FIXED_W_H,ce=e.attributedString,ue=ce.string,he=ce.attributes,de=he.length?he.map((function(e){var t=e.location,r=e.length,n=e.attributes,i=n.MSAttributedStringFontAttribute,o=(void 0===i?{}:i).attributes,a=void 0===o?{}:o,s=a.name,l=void 0===s?fl.defaultFontFamily:s,c=a.size,u=void 0===c?fl.defaultFontSize:c,h=n.MSAttributedStringColorAttribute,d=void 0===h?{}:h,f=d.red,p=void 0===f?0:f,v=d.green,m=void 0===v?0:v,g=d.blue,y=void 0===g?0:g,b=d.alpha,x=void 0===b?1:b,w=n.kerning,E=void 0===w?0:w,_=n.underlineStyle,S=void 0===_?ee.UnderlineStyle.None:_,C=n.strikethroughStyle,T=void 0===C?ee.StrikethroughStyle.None:C,A=n.paragraphStyle,k=void 0===A?{}:A,M=k.alignment,O=void 0===M?0:M,L=k.maximumLineHeight,R=void 0===L?0:L,I=k.paragraphSpacing,P=void 0===I?0:I,F=[];return S!==ee.UnderlineStyle.None&&F.push("underline"),T!==ee.StrikethroughStyle.None&&F.push("lineThrough"),{location:parseInt(t)||0,length:parseInt(r)||0,fontFamily:l,fontSize:u,fontWeight:400,fontStyle:"normal",letterSpacing:E,textAlign:["left","right","center","justify"][O||0],textDecoration:F,lineHeight:R,paragraphSpacing:P,color:[Math.floor(255*p),Math.floor(255*m),Math.floor(255*y),x]}})):[],fe=null===(vt=null===(pt=null===(ft=null===(dt=e.style)||void 0===dt?void 0:dt.textStyle)||void 0===ft?void 0:ft.encodedAttributes)||void 0===pt?void 0:pt.MSAttributedStringFontAttribute)||void 0===vt?void 0:vt.attributes,pe=(null==fe?void 0:fe.size)||(null===(mt=de[0])||void 0===mt?void 0:mt.fontSize)||fl.defaultFontSize,ve=(null==fe?void 0:fe.name)||(null===(gt=de[0])||void 0===gt?void 0:gt.fontFamily)||fl.defaultFontFamily,me=null===(xt=null===(bt=null===(yt=e.style)||void 0===yt?void 0:yt.textStyle)||void 0===bt?void 0:bt.encodedAttributes)||void 0===xt?void 0:xt.paragraphStyle,ge=(null==me?void 0:me.maximumLineHeight)||"normal",ye=(null===(Et=null===(wt=e.style)||void 0===wt?void 0:wt.textStyle)||void 0===Et?void 0:Et.encodedAttributes)||{},be=ye.underlineStyle,xe=void 0===be?0:be,we=ye.strikethroughStyle,Ee=void 0===we?0:we,_e=ye.kerning,Se=void 0===_e?0:_e,Ce=ye.MSAttributedStringColorAttribute,Te=void 0!==(null==me?void 0:me.alignment)?["left","right","center","justify"][me.alignment||0]:null!==(St=null===(_t=de[0])||void 0===_t?void 0:_t.textAlign)&&void 0!==St?St:"left",Ae=null===(Tt=null===(Ct=e.style)||void 0===Ct?void 0:Ct.textStyle)||void 0===Tt?void 0:Tt.verticalAlignment,ke=["top","middle","bottom"][Ae||0],Me=[],xe!==ee.UnderlineStyle.None&&Me.push("underline"),xe&&Ee!==ee.StrikethroughStyle.None&&Me.push("lineThrough"),Oe=(null==me?void 0:me.paragraphSpacing)||0,Le=Ce?[Math.floor(255*Ce.red),Math.floor(255*Ce.green),Math.floor(255*Ce.blue),Ce.alpha]:(null===(At=de[0])||void 0===At?void 0:At.color)||[0,0,0,1],de[0]&&de[0].textAlign!==Te&&(Te=de[0].textAlign),[4,mh(e,r)]);case 20:return Re=Q.sent(),Ne=Re.fill,Be=Re.fillEnable,Ue=Re.fillOpacity,ze=Re.fillMode,He=Re.stroke,Ge=Re.strokeEnable,je=Re.strokeWidth,Ye=Re.strokePosition,We=Re.strokeMode,qe=Re.strokeDasharray,Ve=Re.strokeLinecap,Ke=Re.strokeLinejoin,Ze=Re.strokeMiterlimit,Je=Re.styleId,[2,{tagName:l.TEXT,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,textBehaviour:ae,styleId:Je,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,stroke:He,strokeEnable:Ge,strokeWidth:je,strokePosition:Ye,strokeMode:We,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,fontSize:pe,fontFamily:ve,color:Le,textAlign:Te,textVerticalAlign:ke,textDecoration:Me,letterSpacing:Se,lineHeight:ge,paragraphSpacing:Oe,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:y,content:ue,rich:de}}];case 21:return e._class!==ee.ClassValue.Rectangle&&e._class!==ee.ClassValue.Oval&&e._class!==ee.ClassValue.Star&&e._class!==ee.ClassValue.Triangle&&e._class!==ee.ClassValue.Polygon&&e._class!==ee.ClassValue.ShapePath?[3,23]:(Ie=e.points.map((function(e){var t=gh(e.point),r=gh(e.curveFrom),n=gh(e.curveTo);return{x:t.x,y:t.y,cornerRadius:e.cornerRadius,cornerStyle:e.cornerStyle,curveMode:e.curveMode,hasCurveFrom:e.hasCurveFrom,hasCurveTo:e.hasCurveTo,fx:r.x,fy:r.y,tx:n.x,ty:n.y}})),[4,mh(e,r)]);case 22:return Pe=Q.sent(),Ne=Pe.fill,Be=Pe.fillEnable,Ue=Pe.fillOpacity,ze=Pe.fillMode,Xe=Pe.fillRule,He=Pe.stroke,Ge=Pe.strokeEnable,je=Pe.strokeWidth,Ye=Pe.strokePosition,We=Pe.strokeMode,qe=Pe.strokeDasharray,Ve=Pe.strokeLinecap,Ke=Pe.strokeLinejoin,Ze=Pe.strokeMiterlimit,Je=Pe.styleId,Fe=ml.DISABLED,e.pointRadiusBehaviour===ee.PointsRadiusBehaviour.Legacy?Fe=ml.LEGACY:e.pointRadiusBehaviour===ee.PointsRadiusBehaviour.Rounded?Fe=ml.ROUNDED:e.pointRadiusBehaviour===ee.PointsRadiusBehaviour.Smooth&&(Fe=ml.SMOOTH),[2,{tagName:l.POLYLINE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,points:Ie,isClosed:e.isClosed,fixedRadius:e.fixedRadius||0,pointRadiusBehaviour:Fe,isRectangle:"rectangle"===e._class,isOval:"oval"===e._class,styleId:Je,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,fillRule:Xe,stroke:He,strokeEnable:Ge,strokeWidth:je,strokePosition:Ye,strokeMode:We,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,booleanOperation:["union","subtract","intersect","xor"][e.booleanOperation]||"none",mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:y}}];case 23:return e._class!==ee.ClassValue.ShapeGroup?[3,29]:[4,mh(e,r)];case 24:De=Q.sent(),Ne=De.fill,Be=De.fillEnable,Ue=De.fillOpacity,ze=De.fillMode,Xe=De.fillRule,He=De.stroke,Ge=De.strokeEnable,je=De.strokeWidth,Ye=De.strokePosition,We=De.strokeMode,qe=De.strokeDasharray,Ve=De.strokeLinecap,Ke=De.strokeLinejoin,Ze=De.strokeMiterlimit,Je=De.styleId,Qe=[],$e=0,et=e.layers.length,Q.label=25;case 25:return $e<et?[4,ph(e.layers[$e],($e+1)/(et+1),r,e.frame.width,e.frame.height)]:[3,28];case 26:(tt=Q.sent())&&Qe.push(tt),Q.label=27;case 27:return $e++,[3,25];case 28:return[2,{tagName:l.SHAPE_GROUP,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,styleId:Je,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,fillRule:Xe,stroke:He,strokeEnable:Ge,strokeWidth:je,strokePosition:Ye,strokeMode:We,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,booleanOperation:["union","subtract","intersect","xor"][e.booleanOperation]||"none",mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:y},children:Qe}];case 29:return e._class===ee.ClassValue.Slice?[2,{tagName:l.SLICE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,style:{left:C,top:T,right:A,bottom:k,width:o,height:a,visibility:u,opacity:h,translateX:s,translateY:c,scaleX:f,scaleY:p,rotateZ:d,breakMask:R},isLocked:g}}]:(fl.error(e),[2])}}))}))}function vh(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u;return Q(this,(function(h){switch(h.label){case 0:return e.fillType!==ee.FillType.Pattern?[3,4]:(r="","MSImageData"!==(n=e.image)._ref_class?[3,2]:[4,yh(n._ref,t)]);case 1:return r=h.sent(),[3,3];case 2:"MSNetworkImage"===n._ref_class&&(r=n._ref),h.label=3;case 3:return i=["tile","fill","stretch","fit"][e.patternFillType],o=e.patternTileScale,[2,"url(".concat(r,") ").concat(i," ").concat(100*o,"%")];case 4:if(e.fillType===ee.FillType.Gradient){if(a=e.gradient,s=gh(a.from),l=gh(a.to),c=a.stops.map((function(e){return qu([Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha])+" "+100*e.position+"%"})),a.gradientType===ee.GradientType.Linear)return[2,"linearGradient(".concat(s.x," ").concat(s.y," ").concat(l.x," ").concat(l.y,",").concat(c.join(","),")")];if(a.gradientType===ee.GradientType.Radial)return u=a.elipseLength,[2,"radialGradient(".concat(s.x," ").concat(s.y," ").concat(l.x," ").concat(l.y," ").concat(u,",").concat(c.join(","),")")];if(a.gradientType===ee.GradientType.Angular)return[2,"conicGradient(".concat(.5," ").concat(.5," ").concat(.5," ").concat(.5,",").concat(c.join(","),")")];throw new Error("Unknown gradient")}return[2,[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha]];case 5:return[2]}}))}))}function mh(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C,T,A,k,M,O,L,R,I,P;return Q(this,(function(F){switch(F.label){case 0:if(r=e.style||{},n=r.borders,i=r.borderOptions,o=r.fills,a=r.windingRule,s=r.miterLimit,l=r.do_objectID,c=[],u=[],h=[],d=[],!o)return[3,4];b=0,x=o.length,F.label=1;case 1:return b<x?[4,vh(w=o[b],t)]:[3,4];case 2:f=F.sent(),c.push(f),u.push(w.isEnabled),h.push(null!==(R=null===(L=w.contextSettings)||void 0===L?void 0:L.opacity)&&void 0!==R?R:1),A=null===(I=w.contextSettings)||void 0===I?void 0:I.blendMode,d.push(bh(A)),F.label=3;case 3:return b++,[3,1];case 4:if(p=[],v=[],m=[],g=[],y=[],n)for(b=0,x=n.length;b<x;b++){if((w=n[b]).fillType===ee.FillType.Gradient)if(E=w.gradient,_=gh(E.from),S=gh(E.to),C=E.stops.map((function(e){return qu([Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha])+" "+100*e.position+"%"})),E.gradientType===ee.GradientType.Linear)p.push("linearGradient(".concat(_.x," ").concat(_.y," ").concat(S.x," ").concat(S.y,",").concat(C.join(","),")"));else if(E.gradientType===ee.GradientType.Radial)T=E.elipseLength,p.push("radialGradient(".concat(_.x," ").concat(_.y," ").concat(S.x," ").concat(S.y," ").concat(T,",").concat(C.join(","),")"));else{if(E.gradientType!==ee.GradientType.Angular)throw new Error("Unknown gradient");p.push("conicGradient(".concat(_.x," ").concat(_.y," ").concat(S.x," ").concat(S.y,",").concat(C.join(","),")"))}else p.push([Math.floor(255*w.color.red),Math.floor(255*w.color.green),Math.floor(255*w.color.blue),w.color.alpha]);v.push(w.isEnabled),m.push(w.thickness||0),w.position===ee.BorderPosition.Inside?g.push("inside"):w.position===ee.BorderPosition.Outside?g.push("outside"):g.push("center"),A=null===(P=w.contextSettings)||void 0===P?void 0:P.blendMode,y.push(bh(A))}return k=[],M="butt",O="miter",i&&(i.dashPattern.forEach((function(e){k.push(e)})),i.lineCapStyle===ee.LineCapStyle.Round?M="round":i.lineCapStyle===ee.LineCapStyle.Projecting&&(M="square"),i.lineJoinStyle===ee.LineJoinStyle.Round?O="round":i.lineJoinStyle===ee.LineJoinStyle.Bevel&&(O="bevel")),[2,{fill:c,fillEnable:u,fillOpacity:h,fillMode:d,fillRule:a===ee.WindingRule.EvenOdd?"evenodd":"nonzero",stroke:p,strokeEnable:v,strokeWidth:m,strokePosition:g,strokeMode:y,strokeDasharray:k,strokeLinecap:M,strokeLinejoin:O,strokeMiterlimit:s,styleId:l}]}}))}))}function gh(e){var t=/{(.+),\s*(.+)}/.exec(e||"");return t?{x:parseFloat(t[1])||0,y:parseFloat(t[2])||0}:{x:0,y:0}}function yh(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c;return Q(this,(function(u){switch(u.label){case 0:return e&&t.zipFile?t.imgSrcRecord.hasOwnProperty(e)?[2,t.imgSrcRecord[e]]:(r=t.zipFile.file(e))||(r=t.zipFile.file(e))?[4,r.async("arraybuffer")]:(fl.error("image not exist: >>>".concat(e,"<<<")),[2,""]):[2,""];case 1:if(n=u.sent(),i=new Uint8Array(n),o=!1,37===i[0]&&80===i[1]&&68===i[2]&&70===i[3]&&(o=!0),!n.byteLength)return fl.error("image is empty: >>>".concat(e,"<<<")),[2,""];if(!o)return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,fl.loadArrayBufferPdf(n)];case 3:return a=u.sent(),[3,5];case 4:return s=u.sent(),fl.error(s),[2,""];case 5:return[3,9];case 6:return u.trys.push([6,8,,9]),[4,fl.loadArrayBufferImg(n)];case 7:return a=u.sent(),[3,9];case 8:return l=u.sent(),fl.error(l),[2,""];case 9:return c=a.src||"blob:file://"+e,fl.IMG[c]={success:!0,state:fl.LOADED,width:a.width,height:a.height,source:a,url:c},t.imgSrcRecord[e]=c,[2,c]}}))}))}function bh(e){void 0===e&&(e=ee.BlendMode.Normal);var t="normal";return e===ee.BlendMode.Darken?t="darken":e===ee.BlendMode.Multiply?t="multiply":e===ee.BlendMode.ColorBurn?t="color-burn":e===ee.BlendMode.Lighten?t="lighten":e===ee.BlendMode.Screen?t="screen":e===ee.BlendMode.ColorDodge?t="color-dodge":e===ee.BlendMode.Overlay?t="overlay":e===ee.BlendMode.SoftLight?t="soft-light":e===ee.BlendMode.HardLight?t="hard-light":e===ee.BlendMode.Difference?t="difference":e===ee.BlendMode.Exclusion?t="exclusion":e===ee.BlendMode.Hue?t="hue":e===ee.BlendMode.Saturation?t="saturation":e===ee.BlendMode.Color?t="color":e===ee.BlendMode.Luminosity?t="luminosity":e===ee.BlendMode.PlusDarker||ee.BlendMode.PlusLighter,t}function xh(e,t){return t?(t.alpha=e[3],t.red=e[0]/255,t.green=e[1]/255,t.blue=e[2]/255,t):{_class:"color",alpha:e[3],red:e[0]/255,green:e[1]/255,blue:e[2]/255}}function wh(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u,h,d,f;return Q(this,(function(p){switch(p.label){case 0:r={},n=0,i=e.length,p.label=1;case 1:return n<i?(o=e[n],a=o.overrideName.split("_"),s=a[0],l=a[1],c=l.split(":"),u=c[0],h=c[1],d=(h||u).split("-"),f=o.value,"stringValue"!==d[0]?[3,2]:(d[0]="content",[3,4])):[3,6];case 2:return"fill"!==d[0]||"color"!==u?[3,4]:[4,vh({color:f},t)];case 3:f=qu(f=p.sent()),p.label=4;case 4:(r[s]=r[s]||[]).push({key:d,value:f}),p.label=5;case 5:return n++,[3,1];case 6:return[2,r]}}))}))}
  /*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */!function(e){e[e.UNSET=63]="UNSET",e[e.RIGHT=1]="RIGHT",e[e.WIDTH=2]="WIDTH",e[e.LEFT=4]="LEFT",e[e.BOTTOM=8]="BOTTOM",e[e.HEIGHT=16]="HEIGHT",e[e.TOP=32]="TOP"}(lh||(lh={}));function Eh(e){let t=e.length;for(;--t>=0;)e[t]=0}const _h=256,Sh=286,Ch=30,Th=15,Ah=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),kh=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Mh=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Oh=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Lh=new Array(576);Eh(Lh);const Rh=new Array(60);Eh(Rh);const Ih=new Array(512);Eh(Ih);const Ph=new Array(256);Eh(Ph);const Fh=new Array(29);Eh(Fh);const Dh=new Array(Ch);function Nh(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let Bh,Uh,zh;function Xh(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Eh(Dh);const Hh=e=>e<256?Ih[e]:Ih[256+(e>>>7)],Gh=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},jh=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,Gh(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Yh=(e,t,r)=>{jh(e,r[2*t],r[2*t+1])},Wh=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},qh=(e,t,r)=>{const n=new Array(16);let i,o,a=0;for(i=1;i<=Th;i++)a=a+r[i-1]<<1,n[i]=a;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=Wh(n[t]++,t))}},Vh=e=>{let t;for(t=0;t<Sh;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Ch;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Kh=e=>{e.bi_valid>8?Gh(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Zh=(e,t,r,n)=>{const i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},Jh=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Zh(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Zh(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},Qh=(e,t,r)=>{let n,i,o,a,s=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+s++],n+=(255&e.pending_buf[e.sym_buf+s++])<<8,i=e.pending_buf[e.sym_buf+s++],0===n?Yh(e,i,t):(o=Ph[i],Yh(e,o+_h+1,t),a=Ah[o],0!==a&&(i-=Fh[o],jh(e,i,a)),n--,o=Hh(n),Yh(e,o,r),a=kh[o],0!==a&&(n-=Dh[o],jh(e,n,a)))}while(s<e.sym_next);Yh(e,256,t)},$h=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let a,s,l,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<o;a++)0!==r[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):r[2*a+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,r[2*l]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=n[2*l+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)Jh(e,r,a);l=o;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Jh(e,r,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,r[2*l]=r[2*a]+r[2*s],e.depth[l]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,r[2*a+1]=r[2*s+1]=l,e.heap[1]=l++,Jh(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,u,h,d,f,p,v=0;for(d=0;d<=Th;d++)e.bl_count[d]=0;for(r[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)u=e.heap[c],d=r[2*r[2*u+1]+1]+1,d>l&&(d=l,v++),r[2*u+1]=d,u>n||(e.bl_count[d]++,f=0,u>=s&&(f=a[u-s]),p=r[2*u],e.opt_len+=p*(d+f),o&&(e.static_len+=p*(i[2*u+1]+f)));if(0!==v){do{for(d=l-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,v-=2}while(v>0);for(d=l;0!==d;d--)for(u=e.bl_count[d];0!==u;)h=e.heap[--c],h>n||(r[2*h+1]!==d&&(e.opt_len+=(d-r[2*h+1])*r[2*h],r[2*h+1]=d),u--)}})(e,t),qh(r,c,e.bl_count)},ed=(e,t,r)=>{let n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))},td=(e,t,r)=>{let n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)do{Yh(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(Yh(e,i,e.bl_tree),s--),Yh(e,16,e.bl_tree),jh(e,s-3,2)):s<=10?(Yh(e,17,e.bl_tree),jh(e,s-3,3)):(Yh(e,18,e.bl_tree),jh(e,s-11,7));s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}};let rd=!1;const nd=(e,t,r,n)=>{jh(e,0+(n?1:0),3),Kh(e),Gh(e,r),Gh(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var id=e=>{rd||((()=>{let e,t,r,n,i;const o=new Array(16);for(r=0,n=0;n<28;n++)for(Fh[n]=r,e=0;e<1<<Ah[n];e++)Ph[r++]=n;for(Ph[r-1]=n,i=0,n=0;n<16;n++)for(Dh[n]=i,e=0;e<1<<kh[n];e++)Ih[i++]=n;for(i>>=7;n<Ch;n++)for(Dh[n]=i<<7,e=0;e<1<<kh[n]-7;e++)Ih[256+i++]=n;for(t=0;t<=Th;t++)o[t]=0;for(e=0;e<=143;)Lh[2*e+1]=8,e++,o[8]++;for(;e<=255;)Lh[2*e+1]=9,e++,o[9]++;for(;e<=279;)Lh[2*e+1]=7,e++,o[7]++;for(;e<=287;)Lh[2*e+1]=8,e++,o[8]++;for(qh(Lh,287,o),e=0;e<Ch;e++)Rh[2*e+1]=5,Rh[2*e]=Wh(e,5);Bh=new Nh(Lh,Ah,257,Sh,Th),Uh=new Nh(Rh,kh,0,Ch,Th),zh=new Nh(new Array(0),Mh,0,19,7)})(),rd=!0),e.l_desc=new Xh(e.dyn_ltree,Bh),e.d_desc=new Xh(e.dyn_dtree,Uh),e.bl_desc=new Xh(e.bl_tree,zh),e.bi_buf=0,e.bi_valid=0,Vh(e)},od=(e,t,r,n)=>{let i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<_h;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),$h(e,e.l_desc),$h(e,e.d_desc),a=(e=>{let t;for(ed(e,e.dyn_ltree,e.l_desc.max_code),ed(e,e.dyn_dtree,e.d_desc.max_code),$h(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Oh[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?nd(e,t,r,n):4===e.strategy||o===i?(jh(e,2+(n?1:0),3),Qh(e,Lh,Rh)):(jh(e,4+(n?1:0),3),((e,t,r,n)=>{let i;for(jh(e,t-257,5),jh(e,r-1,5),jh(e,n-4,4),i=0;i<n;i++)jh(e,e.bl_tree[2*Oh[i]+1],3);td(e,e.dyn_ltree,t-1),td(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Qh(e,e.dyn_ltree,e.dyn_dtree)),Vh(e),n&&Kh(e)},ad={_tr_init:id,_tr_stored_block:nd,_tr_flush_block:od,_tr_tally:(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(Ph[r]+_h+1)]++,e.dyn_dtree[2*Hh(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{jh(e,2,3),Yh(e,256,Lh),(e=>{16===e.bi_valid?(Gh(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var sd=(e,t,r,n)=>{let i=65535&e,o=e>>>16&65535,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do{i=i+t[n++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16};const ld=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var cd=(e,t,r,n)=>{const i=ld,o=n+r;e^=-1;for(let r=n;r<o;r++)e=e>>>8^i[255&(e^t[r])];return~e},ud={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},hd={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:dd,_tr_stored_block:fd,_tr_flush_block:pd,_tr_tally:vd,_tr_align:md}=ad,{Z_NO_FLUSH:gd,Z_PARTIAL_FLUSH:yd,Z_FULL_FLUSH:bd,Z_FINISH:xd,Z_BLOCK:wd,Z_OK:Ed,Z_STREAM_END:_d,Z_STREAM_ERROR:Sd,Z_DATA_ERROR:Cd,Z_BUF_ERROR:Td,Z_DEFAULT_COMPRESSION:Ad,Z_FILTERED:kd,Z_HUFFMAN_ONLY:Md,Z_RLE:Od,Z_FIXED:Ld,Z_DEFAULT_STRATEGY:Rd,Z_UNKNOWN:Id,Z_DEFLATED:Pd}=hd,Fd=258,Dd=262,Nd=42,Bd=113,Ud=666,zd=(e,t)=>(e.msg=ud[t],t),Xd=e=>2*e-(e>4?9:0),Hd=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Gd=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=i?r-i:0}while(--t);t=i,n=t;do{r=e.prev[--n],e.prev[n]=r>=i?r-i:0}while(--t)};let jd=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const Yd=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},Wd=(e,t)=>{pd(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Yd(e.strm)},qd=(e,t)=>{e.pending_buf[e.pending++]=t},Vd=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Kd=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=sd(e.adler,t,i,r):2===e.state.wrap&&(e.adler=cd(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},Zd=(e,t)=>{let r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match;const l=e.strstart>e.w_size-Dd?e.strstart-(e.w_size-Dd):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+Fd;let f=c[o+a-1],p=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(r=t,c[r+a]===p&&c[r+a-1]===f&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<d);if(n=Fd-(d-o),o=d-Fd,n>a){if(e.match_start=t,a=n,n>=s)break;f=c[o+a-1],p=c[o+a]}}}while((t=h[t&u])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead},Jd=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Dd)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Gd(e),n+=t),0===e.strm.avail_in)break;if(r=Kd(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=jd(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=jd(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Dd&&0!==e.strm.avail_in)},Qd=(e,t)=>{let r,n,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(r=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>i&&(r=i),r<o&&(0===r&&t!==xd||t===gd||r!==n+e.strm.avail_in))break;a=t===xd&&r===n+e.strm.avail_in?1:0,fd(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Yd(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(Kd(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==gd&&t!==xd&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Kd(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,n=e.strstart-e.block_start,(n>=o||(n||t===xd)&&t!==gd&&0===e.strm.avail_in&&n<=i)&&(r=n>i?i:n,a=t===xd&&0===e.strm.avail_in&&r===n?1:0,fd(e,e.block_start,r,a),e.block_start+=r,Yd(e.strm)),a?3:1)},$d=(e,t)=>{let r,n;for(;;){if(e.lookahead<Dd){if(Jd(e),e.lookahead<Dd&&t===gd)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=jd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-Dd&&(e.match_length=Zd(e,r)),e.match_length>=3)if(n=vd(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=jd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=jd(e,e.ins_h,e.window[e.strstart+1]);else n=vd(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Wd(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===xd?(Wd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wd(e,!1),0===e.strm.avail_out)?1:2},ef=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<Dd){if(Jd(e),e.lookahead<Dd&&t===gd)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=jd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Dd&&(e.match_length=Zd(e,r),e.match_length<=5&&(e.strategy===kd||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=vd(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=jd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Wd(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=vd(e,0,e.window[e.strstart-1]),n&&Wd(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=vd(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===xd?(Wd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wd(e,!1),0===e.strm.avail_out)?1:2};function tf(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const rf=[new tf(0,0,0,0,Qd),new tf(4,4,8,4,$d),new tf(4,5,16,8,$d),new tf(4,6,32,32,$d),new tf(4,4,16,16,ef),new tf(8,16,32,32,ef),new tf(8,16,128,128,ef),new tf(8,32,128,256,ef),new tf(32,128,258,1024,ef),new tf(32,258,258,4096,ef)];function nf(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Pd,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Hd(this.dyn_ltree),Hd(this.dyn_dtree),Hd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Hd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Hd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const of=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Nd&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Bd&&t.status!==Ud?1:0},af=e=>{if(of(e))return zd(e,Sd);e.total_in=e.total_out=0,e.data_type=Id;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Nd:Bd,e.adler=2===t.wrap?0:1,t.last_flush=-2,dd(t),Ed},sf=e=>{const t=af(e);var r;return t===Ed&&((r=e.state).window_size=2*r.w_size,Hd(r.head),r.max_lazy_match=rf[r.level].max_lazy,r.good_match=rf[r.level].good_length,r.nice_match=rf[r.level].nice_length,r.max_chain_length=rf[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),t},lf=(e,t,r,n,i,o)=>{if(!e)return Sd;let a=1;if(t===Ad&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>9||r!==Pd||n<8||n>15||t<0||t>9||o<0||o>Ld||8===n&&1!==a)return zd(e,Sd);8===n&&(n=9);const s=new nf;return e.state=s,s.strm=e,s.status=Nd,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=o,s.method=r,sf(e)};var cf=(e,t)=>lf(e,t,Pd,15,8,Rd),uf=(e,t)=>{if(of(e)||t>wd||t<0)return e?zd(e,Sd):Sd;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===Ud&&t!==xd)return zd(e,0===e.avail_out?Td:Sd);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(Yd(e),0===e.avail_out)return r.last_flush=-1,Ed}else if(0===e.avail_in&&Xd(t)<=Xd(n)&&t!==xd)return zd(e,Td);if(r.status===Ud&&0!==e.avail_in)return zd(e,Td);if(r.status===Nd&&0===r.wrap&&(r.status=Bd),r.status===Nd){let t=Pd+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=Md||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,Vd(r,t),0!==r.strstart&&(Vd(r,e.adler>>>16),Vd(r,65535&e.adler)),e.adler=1,r.status=Bd,Yd(e),0!==r.pending)return r.last_flush=-1,Ed}if(57===r.status)if(e.adler=0,qd(r,31),qd(r,139),qd(r,8),r.gzhead)qd(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),qd(r,255&r.gzhead.time),qd(r,r.gzhead.time>>8&255),qd(r,r.gzhead.time>>16&255),qd(r,r.gzhead.time>>24&255),qd(r,9===r.level?2:r.strategy>=Md||r.level<2?4:0),qd(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(qd(r,255&r.gzhead.extra.length),qd(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=cd(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(qd(r,0),qd(r,0),qd(r,0),qd(r,0),qd(r,0),qd(r,9===r.level?2:r.strategy>=Md||r.level<2?4:0),qd(r,3),r.status=Bd,Yd(e),0!==r.pending)return r.last_flush=-1,Ed;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=cd(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=i,Yd(e),0!==r.pending)return r.last_flush=-1,Ed;t=0,n-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=cd(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=cd(e.adler,r.pending_buf,r.pending-n,n)),Yd(e),0!==r.pending)return r.last_flush=-1,Ed;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,qd(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=cd(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=cd(e.adler,r.pending_buf,r.pending-n,n)),Yd(e),0!==r.pending)return r.last_flush=-1,Ed;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,qd(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=cd(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Yd(e),0!==r.pending))return r.last_flush=-1,Ed;qd(r,255&e.adler),qd(r,e.adler>>8&255),e.adler=0}if(r.status=Bd,Yd(e),0!==r.pending)return r.last_flush=-1,Ed}if(0!==e.avail_in||0!==r.lookahead||t!==gd&&r.status!==Ud){let n=0===r.level?Qd(r,t):r.strategy===Md?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(Jd(e),0===e.lookahead)){if(t===gd)return 1;break}if(e.match_length=0,r=vd(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Wd(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===xd?(Wd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wd(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===Od?((e,t)=>{let r,n,i,o;const a=e.window;for(;;){if(e.lookahead<=Fd){if(Jd(e),e.lookahead<=Fd&&t===gd)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+Fd;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=Fd-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=vd(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=vd(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Wd(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===xd?(Wd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Wd(e,!1),0===e.strm.avail_out)?1:2})(r,t):rf[r.level].func(r,t);if(3!==n&&4!==n||(r.status=Ud),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),Ed;if(2===n&&(t===yd?md(r):t!==wd&&(fd(r,0,0,!1),t===bd&&(Hd(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Yd(e),0===e.avail_out))return r.last_flush=-1,Ed}return t!==xd?Ed:r.wrap<=0?_d:(2===r.wrap?(qd(r,255&e.adler),qd(r,e.adler>>8&255),qd(r,e.adler>>16&255),qd(r,e.adler>>24&255),qd(r,255&e.total_in),qd(r,e.total_in>>8&255),qd(r,e.total_in>>16&255),qd(r,e.total_in>>24&255)):(Vd(r,e.adler>>>16),Vd(r,65535&e.adler)),Yd(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Ed:_d)},hf={deflateInit:cf,deflateInit2:lf,deflateReset:sf,deflateResetKeep:af,deflateSetHeader:(e,t)=>of(e)||2!==e.state.wrap?Sd:(e.state.gzhead=t,Ed),deflate:uf,deflateEnd:e=>{if(of(e))return Sd;const t=e.state.status;return e.state=null,t===Bd?zd(e,Cd):Ed},deflateSetDictionary:(e,t)=>{let r=t.length;if(of(e))return Sd;const n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==Nd||n.lookahead)return Sd;if(1===i&&(e.adler=sd(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&(Hd(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Jd(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=jd(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,Jd(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,n.wrap=i,Ed},deflateInfo:"pako deflate (from Nodeca project)"};const df=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var ff={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const t in r)df(r,t)&&(e[t]=r[t])}}return e},flattenChunks:e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,i=e.length;t<i;t++){let i=e[t];r.set(i,n),n+=i.length}return r}};let pf=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){pf=!1}const vf=new Uint8Array(256);for(let e=0;e<256;e++)vf[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;vf[254]=vf[254]=1;var mf={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},buf2string:(e,t)=>{const r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,i;const o=new Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){o[i++]=t;continue}let a=vf[t];if(a>4)o[i++]=65533,n+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&n<r;)t=t<<6|63&e[n++],a--;a>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&pf)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+vf[e[r]]>t?r:t}};var gf=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const yf=Object.prototype.toString,{Z_NO_FLUSH:bf,Z_SYNC_FLUSH:xf,Z_FULL_FLUSH:wf,Z_FINISH:Ef,Z_OK:_f,Z_STREAM_END:Sf,Z_DEFAULT_COMPRESSION:Cf,Z_DEFAULT_STRATEGY:Tf,Z_DEFLATED:Af}=hd;function kf(e){this.options=ff.assign({level:Cf,method:Af,chunkSize:16384,windowBits:15,memLevel:8,strategy:Tf},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gf,this.strm.avail_out=0;let r=hf.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==_f)throw new Error(ud[r]);if(t.header&&hf.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?mf.string2buf(t.dictionary):"[object ArrayBuffer]"===yf.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=hf.deflateSetDictionary(this.strm,e),r!==_f)throw new Error(ud[r]);this._dict_set=!0}}kf.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?Ef:bf,"string"==typeof e?r.input=mf.string2buf(e):"[object ArrayBuffer]"===yf.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===xf||o===wf)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=hf.deflate(r,o),i===Sf)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=hf.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===_f;if(0!==r.avail_out){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},kf.prototype.onData=function(e){this.chunks.push(e)},kf.prototype.onEnd=function(e){e===_f&&(this.result=ff.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const Mf=16209;var Of=function(e,t){let r,n,i,o,a,s,l,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C;const T=e.state;r=e.next_in,S=e.input,n=r+(e.avail_in-5),i=e.next_out,C=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),s=T.dmax,l=T.wsize,c=T.whave,u=T.wnext,h=T.window,d=T.hold,f=T.bits,p=T.lencode,v=T.distcode,m=(1<<T.lenbits)-1,g=(1<<T.distbits)-1;e:do{f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),y=p[d&m];t:for(;;){if(b=y>>>24,d>>>=b,f-=b,b=y>>>16&255,0===b)C[i++]=65535&y;else{if(!(16&b)){if(64&b){if(32&b){T.mode=16191;break e}e.msg="invalid literal/length code",T.mode=Mf;break e}y=p[(65535&y)+(d&(1<<b)-1)];continue t}for(x=65535&y,b&=15,b&&(f<b&&(d+=S[r++]<<f,f+=8),x+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),y=v[d&g];;){if(b=y>>>24,d>>>=b,f-=b,b=y>>>16&255,16&b){if(w=65535&y,b&=15,f<b&&(d+=S[r++]<<f,f+=8,f<b&&(d+=S[r++]<<f,f+=8)),w+=d&(1<<b)-1,w>s){e.msg="invalid distance too far back",T.mode=Mf;break e}if(d>>>=b,f-=b,b=i-o,w>b){if(b=w-b,b>c&&T.sane){e.msg="invalid distance too far back",T.mode=Mf;break e}if(E=0,_=h,0===u){if(E+=l-b,b<x){x-=b;do{C[i++]=h[E++]}while(--b);E=i-w,_=C}}else if(u<b){if(E+=l+u-b,b-=u,b<x){x-=b;do{C[i++]=h[E++]}while(--b);if(E=0,u<x){b=u,x-=b;do{C[i++]=h[E++]}while(--b);E=i-w,_=C}}}else if(E+=u-b,b<x){x-=b;do{C[i++]=h[E++]}while(--b);E=i-w,_=C}for(;x>2;)C[i++]=_[E++],C[i++]=_[E++],C[i++]=_[E++],x-=3;x&&(C[i++]=_[E++],x>1&&(C[i++]=_[E++]))}else{E=i-w;do{C[i++]=C[E++],C[i++]=C[E++],C[i++]=C[E++],x-=3}while(x>2);x&&(C[i++]=C[E++],x>1&&(C[i++]=C[E++]))}break}if(64&b){e.msg="invalid distance code",T.mode=Mf;break e}y=v[(65535&y)+(d&(1<<b)-1)]}}break}}while(r<n&&i<a);x=f>>3,r-=x,f-=x<<3,d&=(1<<f)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<a?a-i+257:257-(i-a),T.hold=d,T.bits=f};const Lf=15,Rf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),If=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Pf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ff=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Df=(e,t,r,n,i,o,a,s)=>{const l=s.bits;let c,u,h,d,f,p,v=0,m=0,g=0,y=0,b=0,x=0,w=0,E=0,_=0,S=0,C=null;const T=new Uint16Array(16),A=new Uint16Array(16);let k,M,O,L=null;for(v=0;v<=Lf;v++)T[v]=0;for(m=0;m<n;m++)T[t[r+m]]++;for(b=l,y=Lf;y>=1&&0===T[y];y--);if(b>y&&(b=y),0===y)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(g=1;g<y&&0===T[g];g++);for(b<g&&(b=g),E=1,v=1;v<=Lf;v++)if(E<<=1,E-=T[v],E<0)return-1;if(E>0&&(0===e||1!==y))return-1;for(A[1]=0,v=1;v<Lf;v++)A[v+1]=A[v]+T[v];for(m=0;m<n;m++)0!==t[r+m]&&(a[A[t[r+m]]++]=m);if(0===e?(C=L=a,p=20):1===e?(C=Rf,L=If,p=257):(C=Pf,L=Ff,p=0),S=0,m=0,v=g,f=o,x=b,w=0,h=-1,_=1<<b,d=_-1,1===e&&_>852||2===e&&_>592)return 1;for(;;){k=v-w,a[m]+1<p?(M=0,O=a[m]):a[m]>=p?(M=L[a[m]-p],O=C[a[m]-p]):(M=96,O=0),c=1<<v-w,u=1<<x,g=u;do{u-=c,i[f+(S>>w)+u]=k<<24|M<<16|O}while(0!==u);for(c=1<<v-1;S&c;)c>>=1;if(0!==c?(S&=c-1,S+=c):S=0,m++,0==--T[v]){if(v===y)break;v=t[r+a[m]]}if(v>b&&(S&d)!==h){for(0===w&&(w=b),f+=g,x=v-w,E=1<<x;x+w<y&&(E-=T[x+w],!(E<=0));)x++,E<<=1;if(_+=1<<x,1===e&&_>852||2===e&&_>592)return 1;h=S&d,i[h]=b<<24|x<<16|f-o}}return 0!==S&&(i[f+S]=v-w<<24|64<<16),s.bits=b,0};const{Z_FINISH:Nf,Z_BLOCK:Bf,Z_TREES:Uf,Z_OK:zf,Z_STREAM_END:Xf,Z_NEED_DICT:Hf,Z_STREAM_ERROR:Gf,Z_DATA_ERROR:jf,Z_MEM_ERROR:Yf,Z_BUF_ERROR:Wf,Z_DEFLATED:qf}=hd,Vf=16180,Kf=16190,Zf=16191,Jf=16192,Qf=16194,$f=16199,ep=16200,tp=16206,rp=16209,np=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function ip(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const op=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Vf||t.mode>16211?1:0},ap=e=>{if(op(e))return Gf;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Vf,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,zf},sp=e=>{if(op(e))return Gf;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ap(e)},lp=(e,t)=>{let r;if(op(e))return Gf;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Gf:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,sp(e))},cp=(e,t)=>{if(!e)return Gf;const r=new ip;e.state=r,r.strm=e,r.window=null,r.mode=Vf;const n=lp(e,t);return n!==zf&&(e.state=null),n};let up,hp,dp=!0;const fp=e=>{if(dp){up=new Int32Array(512),hp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Df(1,e.lens,0,288,up,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Df(2,e.lens,0,32,hp,0,e.work,{bits:5}),dp=!1}e.lencode=up,e.lenbits=9,e.distcode=hp,e.distbits=5},pp=(e,t,r,n)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var vp=(e,t)=>{let r,n,i,o,a,s,l,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S=0;const C=new Uint8Array(4);let T,A;const k=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(op(e)||!e.output||!e.input&&0!==e.avail_in)return Gf;r=e.state,r.mode===Zf&&(r.mode=Jf),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,h=s,d=l,_=zf;e:for(;;)switch(r.mode){case Vf:if(0===r.wrap){r.mode=Jf;break}for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,C[0]=255&c,C[1]=c>>>8&255,r.check=cd(r.check,C,2,0),c=0,u=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=rp;break}if((15&c)!==qf){e.msg="unknown compression method",r.mode=rp;break}if(c>>>=4,u-=4,E=8+(15&c),0===r.wbits&&(r.wbits=E),E>15||E>r.wbits){e.msg="invalid window size",r.mode=rp;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:Zf,c=0,u=0;break;case 16181:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,(255&r.flags)!==qf){e.msg="unknown compression method",r.mode=rp;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=rp;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=cd(r.check,C,2,0)),c=0,u=0,r.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,r.check=cd(r.check,C,4,0)),c=0,u=0,r.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=cd(r.check,C,2,0)),c=0,u=0,r.mode=16184;case 16184:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=cd(r.check,C,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>s&&(f=s),f&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+f),E)),512&r.flags&&4&r.wrap&&(r.check=cd(r.check,n,f,o)),s-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break e;f=0;do{E=n[o+f++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E))}while(E&&f<s);if(512&r.flags&&4&r.wrap&&(r.check=cd(r.check,n,f,o)),s-=f,o+=f,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break e;f=0;do{E=n[o+f++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E))}while(E&&f<s);if(512&r.flags&&4&r.wrap&&(r.check=cd(r.check,n,f,o)),s-=f,o+=f,E)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=rp;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Zf;break;case 16189:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=np(c),c=0,u=0,r.mode=Kf;case Kf:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,Hf;e.adler=r.check=1,r.mode=Zf;case Zf:if(t===Bf||t===Uf)break e;case Jf:if(r.last){c>>>=7&u,u-=7&u,r.mode=tp;break}for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=1&c,c>>>=1,u-=1,3&c){case 0:r.mode=16193;break;case 1:if(fp(r),r.mode=$f,t===Uf){c>>>=2,u-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=rp}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=rp;break}if(r.length=65535&c,c=0,u=0,r.mode=Qf,t===Uf)break e;case Qf:r.mode=16195;case 16195:if(f=r.length,f){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;i.set(n.subarray(o,o+f),a),s-=f,o+=f,l-=f,a+=f,r.length-=f;break}r.mode=Zf;break;case 16196:for(;u<14;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=rp;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.lens[k[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[k[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},_=Df(0,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,_){e.msg="invalid code lengths set",r.mode=rp;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;S=r.lencode[c&(1<<r.lenbits)-1],m=S>>>24,g=S>>>16&255,y=65535&S,!(m<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(y<16)c>>>=m,u-=m,r.lens[r.have++]=y;else{if(16===y){for(A=m+2;u<A;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=m,u-=m,0===r.have){e.msg="invalid bit length repeat",r.mode=rp;break}E=r.lens[r.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===y){for(A=m+3;u<A;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=m,u-=m,E=0,f=3+(7&c),c>>>=3,u-=3}else{for(A=m+7;u<A;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=m,u-=m,E=0,f=11+(127&c),c>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=rp;break}for(;f--;)r.lens[r.have++]=E}}if(r.mode===rp)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=rp;break}if(r.lenbits=9,T={bits:r.lenbits},_=Df(1,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,_){e.msg="invalid literal/lengths set",r.mode=rp;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},_=Df(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,_){e.msg="invalid distances set",r.mode=rp;break}if(r.mode=$f,t===Uf)break e;case $f:r.mode=ep;case ep:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,Of(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===Zf&&(r.back=-1);break}for(r.back=0;S=r.lencode[c&(1<<r.lenbits)-1],m=S>>>24,g=S>>>16&255,y=65535&S,!(m<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(g&&!(240&g)){for(b=m,x=g,w=y;S=r.lencode[w+((c&(1<<b+x)-1)>>b)],m=S>>>24,g=S>>>16&255,y=65535&S,!(b+m<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=m,u-=m,r.back+=m,r.length=y,0===g){r.mode=16205;break}if(32&g){r.back=-1,r.mode=Zf;break}if(64&g){e.msg="invalid literal/length code",r.mode=rp;break}r.extra=15&g,r.mode=16201;case 16201:if(r.extra){for(A=r.extra;u<A;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;S=r.distcode[c&(1<<r.distbits)-1],m=S>>>24,g=S>>>16&255,y=65535&S,!(m<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(!(240&g)){for(b=m,x=g,w=y;S=r.distcode[w+((c&(1<<b+x)-1)>>b)],m=S>>>24,g=S>>>16&255,y=65535&S,!(b+m<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=m,u-=m,r.back+=m,64&g){e.msg="invalid distance code",r.mode=rp;break}r.offset=y,r.extra=15&g,r.mode=16203;case 16203:if(r.extra){for(A=r.extra;u<A;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=rp;break}r.mode=16204;case 16204:if(0===l)break e;if(f=d-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=rp;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),v=r.window}else v=i,p=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{i[a++]=v[p++]}while(--f);0===r.length&&(r.mode=ep);break;case 16205:if(0===l)break e;i[a++]=r.length,l--,r.mode=ep;break;case tp:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[o++]<<u,u+=8}if(d-=l,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?cd(r.check,i,d,a-d):sd(r.check,i,d,a-d)),d=l,4&r.wrap&&(r.flags?c:np(c))!==r.check){e.msg="incorrect data check",r.mode=rp;break}c=0,u=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=rp;break}c=0,u=0}r.mode=16208;case 16208:_=Xf;break e;case rp:_=jf;break e;case 16210:return Yf;default:return Gf}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<rp&&(r.mode<tp||t!==Nf))&&pp(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?cd(r.check,i,d,e.next_out-d):sd(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Zf?128:0)+(r.mode===$f||r.mode===Qf?256:0),(0===h&&0===d||t===Nf)&&_===zf&&(_=Wf),_},mp=e=>{if(op(e))return Gf;let t=e.state;return t.window&&(t.window=null),e.state=null,zf},gp=(e,t)=>{if(op(e))return Gf;const r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,zf):Gf},yp=(e,t)=>{const r=t.length;let n,i,o;return op(e)?Gf:(n=e.state,0!==n.wrap&&n.mode!==Kf?Gf:n.mode===Kf&&(i=1,i=sd(i,t,r,0),i!==n.check)?jf:(o=pp(e,t,r,r),o?(n.mode=16210,Yf):(n.havedict=1,zf)))},bp={inflateReset:sp,inflateReset2:lp,inflateResetKeep:ap,inflateInit:e=>cp(e,15),inflateInit2:cp,inflate:vp,inflateEnd:mp,inflateGetHeader:gp,inflateSetDictionary:yp,inflateInfo:"pako inflate (from Nodeca project)"};var xp=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const wp=Object.prototype.toString,{Z_NO_FLUSH:Ep,Z_FINISH:_p,Z_OK:Sp,Z_STREAM_END:Cp,Z_NEED_DICT:Tp,Z_STREAM_ERROR:Ap,Z_DATA_ERROR:kp,Z_MEM_ERROR:Mp}=hd;function Op(e){this.options=ff.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gf,this.strm.avail_out=0;let r=bp.inflateInit2(this.strm,t.windowBits);if(r!==Sp)throw new Error(ud[r]);if(this.header=new xp,bp.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=mf.string2buf(t.dictionary):"[object ArrayBuffer]"===wp.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=bp.inflateSetDictionary(this.strm,t.dictionary),r!==Sp)))throw new Error(ud[r])}function Lp(e,t){const r=new Op(t);if(r.push(e),r.err)throw r.msg||ud[r.err];return r.result}Op.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?_p:Ep,"[object ArrayBuffer]"===wp.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=bp.inflate(r,a),o===Tp&&i&&(o=bp.inflateSetDictionary(r,i),o===Sp?o=bp.inflate(r,a):o===kp&&(o=Tp));r.avail_in>0&&o===Cp&&r.state.wrap>0&&0!==e[r.next_in];)bp.inflateReset(r),o=bp.inflate(r,a);switch(o){case Ap:case kp:case Tp:case Mp:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(0===r.avail_out||o===Cp))if("string"===this.options.to){let e=mf.utf8border(r.output,r.next_out),t=r.next_out-e,i=mf.buf2string(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==Sp||0!==s){if(o===Cp)return o=bp.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Op.prototype.onData=function(e){this.chunks.push(e)},Op.prototype.onEnd=function(e){e===Sp&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ff.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Rp={Inflate:Op,inflate:Lp,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Lp(e,t)},ungzip:Lp,constants:hd};const{Inflate:Ip,inflate:Pp,inflateRaw:Fp,ungzip:Dp}=Rp;var Np=Pp,Bp={},Up={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"};Object.keys(Up).forEach((function(e){return Bp[Up[e]]=e}));var zp,Xp,Hp,Gp,jp,Yp=["none","red","orange","yellow","green","blue","violet","gray"],Wp=["LMsk","Lr16","Lr32","Layr","Mt16","Mt32","Mtrn","Alph","FMsk","lnk2","FEid","FXid","PxSD","cinf"];function qp(e,t,r){var n=function(e){var t={};return Object.keys(e).forEach((function(r){return t[e[r]]=r})),t}(r);return{decode:function(e){var r=e.split(".")[1];if(r&&!n[r])throw new Error("Unrecognized value for enum: '".concat(e,"'"));return n[r]||t},encode:function(n){if(n&&!r[n])throw new Error("Invalid value for enum: '".concat(n,"'"));return"".concat(e,".").concat(r[n]||r[t])}}}function Vp(e,t){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return t?3:e+1;case-1:return t?4:3;default:return e+1}}function Kp(e,t,r){return e<t?t:e>r?r:e}function Zp(e){for(var t=e.data,r=t instanceof Float32Array?1:t instanceof Uint16Array?65535:255,n=0,i=0|t.length;n<i;n=n+4|0)t[n+0]=0,t[n+1]=0,t[n+2]=0,t[n+3]=r}function Jp(e){var t,r=Qp(e.width,e.height);if(e.data instanceof Uint8ClampedArray)t=e;else{t=tv(e.width,e.height);var n=e.data,i=t.data;if(n instanceof Float32Array)for(var o=0,a=n.length;o<a;o+=4)i[o+0]=Math.round(255*Math.pow(n[o+0],1/2.2)),i[o+1]=Math.round(255*Math.pow(n[o+1],1/2.2)),i[o+2]=Math.round(255*Math.pow(n[o+2],1/2.2)),i[o+3]=Math.round(255*n[o+3]);else{var s=n instanceof Uint16Array?8:0;for(o=0,a=n.length;o<a;o++)i[o]=n[o]>>>s}}return r.getContext("2d").putImageData(t,0,0),r}!function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"}(zp||(zp={})),function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"}(Xp||(Xp={})),function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"}(Hp||(Hp={})),function(e){e[e.Color0=0]="Color0",e[e.Color1=1]="Color1",e[e.Color2=2]="Color2",e[e.Color3=3]="Color3",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"}(Gp||(Gp={})),function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"}(jp||(jp={}));var Qp=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")},$p=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvasFromData method")},ev=void 0,tv=function(e,t){return ev||(ev=Qp(1,1)),ev.getContext("2d").createImageData(e,t)};function rv(e){return 4294967168&e?4294965248&e?4294901760&e?4:3:2:1}function nv(e,t,r){var n=rv(r);switch(n){case 1:e[t]=r;break;case 2:e[t]=r>>6&31|192,e[t+1]=63&r|128;break;case 3:e[t]=r>>12&15|224,e[t+1]=r>>6&63|128,e[t+2]=63&r|128;break;default:e[t]=r>>18&7|240,e[t+1]=r>>12&63|128,e[t+2]=r>>6&63|128,e[t+3]=63&r|128}return n}function iv(e){if(e.length>1e3&&"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);var t=new Uint8Array(function(e){for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>=55296&&n<=56319){if(r+1<e.length){var i=e.charCodeAt(r+1);56320==(64512&i)&&(r++,t+=rv(((1023&n)<<10)+(1023&i)+65536))}}else t+=rv(n)}return t}(e));return function(e,t,r){for(var n=0;n<r.length;n++){var i=r.charCodeAt(n);if(i>=55296&&i<=56319){if(n+1<r.length){var o=r.charCodeAt(n+1);56320==(64512&o)&&(n++,t+=nv(e,t,((1023&i)<<10)+(1023&o)+65536))}}else t+=nv(e,t,i)}}(t,0,e),t}function ov(e,t){if(t>=e.length)throw Error("Invalid byte index");var r=e[t];if(128==(192&r))return 63&r;throw Error("Invalid continuation byte")}function av(e){if(e.byteLength>1e3&&"undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t=[],r=0;r<e.length;){var n=e[r++],i=void 0;if(128&n)if(192==(224&n)){if((i=(31&n)<<6|ov(e,r++))<128)throw Error("Invalid continuation byte")}else if(224==(240&n)){if((i=(15&n)<<12|ov(e,r++)<<6|ov(e,r++))<2048)throw Error("Invalid continuation byte");if(i>=55296&&i<=57343)throw Error("Lone surrogate U+".concat(i.toString(16).toUpperCase()," is not a scalar value"))}else{if(240!=(248&n))throw Error("Invalid UTF-8 detected");if((i=(15&n)<<18|ov(e,r++)<<12|ov(e,r++)<<6|ov(e,r++))<65536||i>1114111)throw Error("Invalid continuation byte")}else i=n;i>65535&&(i-=65536,t.push(String.fromCharCode(i>>>10&1023|55296)),i=56320|1023&i),t.push(String.fromCharCode(i))}return t.join("")}"undefined"!=typeof document&&(Qp=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},$p=function(e){var t=new Image;t.src="data:image/jpeg;base64,"+Ee(e);var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0),r});var sv=function(){return sv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},sv.apply(this,arguments)};var lv,cv,uv={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},hv=(lv=uv,cv={},Object.keys(lv).forEach((function(e){return cv[lv[e]]=e})),cv);function dv(e,t){return{name:e,classID:t}}for(var fv=dv("","null"),pv={strokeStyleContent:dv("","solidColorLayer"),printProofSetup:dv("Proof Setup","proofSetup"),Grad:dv("Gradient","Grdn"),Trnf:dv("Transform","Trnf"),patternFill:dv("","patternFill"),ebbl:dv("","ebbl"),SoFi:dv("","SoFi"),GrFl:dv("","GrFl"),sdwC:dv("","RGBC"),hglC:dv("","RGBC"),"Clr ":dv("","RGBC"),tintColor:dv("","RGBC"),Ofst:dv("","Pnt "),ChFX:dv("","ChFX"),MpgS:dv("","ShpC"),DrSh:dv("","DrSh"),IrSh:dv("","IrSh"),OrGl:dv("","OrGl"),IrGl:dv("","IrGl"),TrnS:dv("","ShpC"),Ptrn:dv("","Ptrn"),FrFX:dv("","FrFX"),phase:dv("","Pnt "),frameStep:fv,duration:fv,workInTime:fv,workOutTime:fv,audioClipGroupList:fv,bounds:dv("","Rctn"),customEnvelopeWarp:dv("","customEnvelopeWarp"),warp:dv("","warp"),"Sz  ":dv("","Pnt "),origin:dv("","Pnt "),autoExpandOffset:dv("","Pnt "),keyOriginShapeBBox:dv("","unitRect"),Vrsn:fv,psVersion:fv,docDefaultNewArtboardBackgroundColor:dv("","RGBC"),artboardRect:dv("","classFloatRect"),keyOriginRRectRadii:dv("","radii"),keyOriginBoxCorners:fv,rectangleCornerA:dv("","Pnt "),rectangleCornerB:dv("","Pnt "),rectangleCornerC:dv("","Pnt "),rectangleCornerD:dv("","Pnt "),compInfo:fv,quiltWarp:dv("","quiltWarp"),generatorSettings:fv,crema:fv,FrIn:fv,blendOptions:fv,FXRf:fv,Lefx:fv,time:fv,animKey:fv,timeScope:fv,inTime:fv,outTime:fv,sheetStyle:fv,translation:fv,Skew:fv,boundingBox:dv("","boundingBox"),"Lnk ":dv("","ExternalFileLink"),frameReader:dv("","FrameReader"),effectParams:dv("","motionTrackEffectParams"),Impr:dv("None","none"),Anch:dv("","Pnt "),"Fwd ":dv("","Pnt "),"Bwd ":dv("","Pnt "),FlrC:dv("","Pnt "),meshBoundaryPath:dv("","pathClass"),filterFX:dv("","filterFXStyle"),Fltr:dv("","rigidTransform"),FrgC:dv("","RGBC"),BckC:dv("","RGBC"),sdwM:dv("Parameters","adaptCorrectTones"),hglM:dv("Parameters","adaptCorrectTones"),customShape:dv("","customShape"),origFXRefPoint:fv,FXRefPoint:fv,ClMg:dv("","ClMg")},vv={"Crv ":dv("","CrPt"),Clrs:dv("","Clrt"),Trns:dv("","TrnS"),keyDescriptorList:fv,solidFillMulti:dv("","SoFi"),gradientFillMulti:dv("","GrFl"),dropShadowMulti:dv("","DrSh"),innerShadowMulti:dv("","IrSh"),frameFXMulti:dv("","FrFX"),FrIn:fv,FSts:fv,LaSt:fv,sheetTimelineOptions:fv,trackList:dv("","animationTrack"),globalTrackList:dv("","animationTrack"),keyList:fv,audioClipGroupList:fv,audioClipList:fv,countObjectList:dv("","countObject"),countGroupList:dv("","countGroup"),slices:dv("","slice"),"Pts ":dv("","Pthp"),SbpL:dv("","SbpL"),pathComponents:dv("","PaCm"),filterFXList:dv("","filterFX"),puppetShapeList:dv("","puppetShape"),channelDenoise:dv("","channelDenoiseParams"),ShrP:dv("","Pnt "),layerSettings:fv,list:fv,Adjs:dv("","CrvA")},mv={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName","placed","description","reason","artboardPresetName","json","clipID","relPath","fullPath","mediaDescriptor","Msge","altTag","url","cellText","preset","KnNm","FPth","comment","originalPath"],tdta:["EngineData","LUT3DFileData","indexArray","originalVertexArray","deformedVertexArray","LqMe"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Cnt ","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","comp","compID","originalCompID","curvesPresetKind","mixerPresetKind","uOrder","vOrder","PgNm","totalPages","Crop","numerator","denominator","frameCount","Annt","keyOriginType","unitValueQuadVersion","keyOriginIndex","major","minor","fix","docDefaultNewArtboardBackgroundType","artboardBackgroundType","numModifyingFX","deformNumRows","deformNumCols","FrID","FrDl","FsID","LCnt","AFrm","AFSt","numBefore","numAfter","Spcn","minOpacity","maxOpacity","BlnM","sheetID","gblA","globalAltitude","descVersion","frameReaderType","LyrI","zoomOrigin","fontSize","Rds ","sliceID","topOutset","leftOutset","bottomOutset","rightOutset","filterID","meshQuality","meshExpansion","meshRigidity","VrsM","VrsN","NmbG","WLMn","WLMx","AmMn","AmMx","SclH","SclV","Lvl ","TlNm","TlOf","FlRs","Thsh","ShrS","ShrE","FlRs","Vrnc","Strg","ExtS","ExtD","HrzS","VrtS","NmbR","EdgF","Ang1","Ang2","Ang3","Ang4","lastAppliedComp","capturedInfo"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","BlrQ","bvlT","bvlS","bvlD","Md  ","glwS","GrdF","GlwT","RplS","BlrM","SmBM","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder","enableCompCore","enableCompCoreGPU","compCoreSupport","compCoreGPUSupport","Engn","enableCompCoreThreads","gs99","FrDs","trackID","animInterpStyle","horzAlign","vertAlign","bgColorType","shapeOperation","UndA","Wvtp","Drct","WndM","Edg ","FlCl","IntE","IntC","Cnvr","Fl  ","Dstr","MztT","Lns ","ExtT","DspM","ExtR","ZZTy","SphM","SmBQ","placedLayerOCIOConversion","gradientsInterpolationMethod"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","uglg","antialiasGloss","useShape","Vsbl","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint","keyShapeInvalidated","autoExpandEnabled","autoNestEnabled","autoPositionEnabled","shrinkwrapOnSaveEnabled","present","showInDialog","overprint","sheetDisclosed","lightsDisclosed","meshesDisclosed","materialsDisclosed","hasMotion","muted","Effc","selected","autoScope","fillCanvas","cellTextIsHTML","Smoo","Clsp","validAtPosition","rigidType","hasoptions","filterMaskEnable","filterMaskLinked","filterMaskExtendWithWhite","removeJPEGArtifact","Mnch","ExtF","ExtM","moreAccurate","GpuY","LIWy","Cnty"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","Wdth","Hght","strokeStyleMiterLimit","strokeStyleResolution","layerTime","keyOriginResolution","xx","xy","yx","yy","tx","ty","FrGA","frameRate","audioLevel","rotation","X   ","Y   ","redFloat","greenFloat","blueFloat","imageResolution","PuX0","PuX1","PuX2","PuX3","PuY0","PuY1","PuY2","PuY3"],UntF:["sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","H   ","Top ","Left","Btom","Rght","Rslt","topRight","topLeft","bottomLeft","bottomRight","ClNs","Shrp"],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","slices","LaSt","Trnf","nonAffineTransform","keyDescriptorList","guideIndeces","gradientFillMulti","solidFillMulti","frameFXMulti","innerShadowMulti","dropShadowMulti","FrIn","FSts","FsFr","sheetTimelineOptions","audioClipList","trackList","globalTrackList","keyList","audioClipList","warpValues","selectedPin","Pts ","SbpL","pathComponents","pinOffsets","posFinalPins","pinVertexIndices","PinP","PnRt","PnOv","PnDp","filterFXList","puppetShapeList","ShrP","channelDenoise","Mtrx","layerSettings","list","compList","Adjs"],ObAr:["meshPoints","quiltSliceX","quiltSliceY"],"obj ":["null","Chnl"],"Pth ":["DspF"]},gv=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],yv={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF",Trnf:"doub",nonAffineTransform:"doub",keyDescriptorList:"Objc",gradientFillMulti:"Objc",solidFillMulti:"Objc",frameFXMulti:"Objc",innerShadowMulti:"Objc",dropShadowMulti:"Objc",LaSt:"Objc",FrIn:"Objc",FSts:"Objc",FsFr:"long",blendOptions:"Objc",sheetTimelineOptions:"Objc",keyList:"Objc",warpValues:"doub",selectedPin:"long","Pts ":"Objc",SbpL:"Objc",pathComponents:"Objc",pinOffsets:"doub",posFinalPins:"doub",pinVertexIndices:"long",PinP:"doub",PnRt:"long",PnOv:"bool",PnDp:"doub",filterFXList:"Objc",puppetShapeList:"Objc",ShrP:"Objc",channelDenoise:"Objc",Mtrx:"long",compList:"long",Chnl:"enum"},bv={},xv=0,wv=Object.keys(mv);xv<wv.length;xv++)for(var Ev=wv[xv],_v=0,Sv=mv[Ev];_v<Sv.length;_v++){var Cv=Sv[_v];bv[Cv]=Ev}for(var Tv=0,Av=Object.keys(pv);Tv<Av.length;Tv++){Cv=Av[Tv];bv[Cv]||(bv[Cv]="Objc")}for(var kv=0,Mv=Object.keys(vv);kv<Mv.length;kv++){Cv=Mv[kv];yv[Cv]="Objc"}function Ov(e,t,r,n){return"presetKind"===e?"string"==typeof t?"enum":"long":"null"===e&&"slices"===r?"TEXT":"groupID"===e?"slices"===r?"long":"TEXT":"Sz  "===e?"Wdth"in t?"Objc":"units"in t?"UntF":"doub":"Type"===e?"string"==typeof t?"enum":"long":"AntA"===e?"string"==typeof t?"enum":"bool":"Hrzn"!==e&&"Vrtc"!==e||"keyType.Pstn"!==n.Type&&"Ofst"!==n._classID?"Hrzn"===e||"Vrtc"===e||"Top "===e||"Left"===e||"Btom"===e||"Rght"===e?"slices"===r?"long":"number"==typeof t?"doub":"UntF":"Vrsn"===e?"number"==typeof t?"long":"Objc":"Rd  "===e||"Grn "===e||"Bl  "===e?"artd"===r?"long":"doub":"Trnf"===e?Array.isArray(t)?"VlLs":"Objc":bv[e]:"long"}function Lv(e){return dy(e,$g(e)||4)}function Rv(e,t){if(4===t.length&&"warp"!==t&&"time"!==t&&"hold"!==t&&"list"!==t)gx(e,0),Tx(e,t);else{gx(e,t.length);for(var r=0;r<t.length;r++)fx(e,t.charCodeAt(r))}}function Iv(e,t){for(var r=Bv(e),n=t?{_name:r.name,_classID:r.classID}:{},i=ty(e),o=0;o<i;o++){var a=Lv(e),s=Fv(e,sy(e),t);n[a]=s}return n}function Pv(e,t,r,n,i){Mx(e,t),Rv(e,r);var o=Object.keys(n),a=o.length;"_name"in n&&a--,"_classID"in n&&a--,bx(e,a);for(var s=0,l=o;s<l.length;s++){var c=l[s];if("_name"!==c&&"_classID"!==c){var u=Ov(c,n[c],i,n),h=pv[c];"bounds"===c&&"text"===i?h=dv("","bounds"):"origin"===c?u="slices"===i?"enum":"Objc":"Cyn "!==c&&"Mgnt"!==c&&"Ylw "!==c&&"Blck"!==c||"CMYC"!==n._classID?/^PN[a-z][a-z]$/.test(c)?u="TEXT":/^PT[a-z][a-z]$/.test(c)?u="long":/^PF[a-z][a-z]$/.test(c)?u="doub":"Rds "!==c&&"Thsh"!==c||"number"!=typeof n[c]||"SmrB"!==n._classID?"ClSz"===c||"Rds "===c||"Amnt"===c?u="number"==typeof n[c]?"long":"UntF":"sdwM"!==c&&"hglM"!==c||"string"!=typeof n[c]?"blur"===c&&"string"==typeof n[c]?u="enum":"Hght"===c&&"number"==typeof n[c]&&"Embs"===n._classID?u="long":"Angl"!==c||"number"!=typeof n[c]||"Embs"!==n._classID&&"smartSharpen"!==n._classID&&"Twrl"!==n._classID&&"MtnB"!==n._classID?"Angl"===c&&"number"==typeof n[c]?u="doub":"bounds"===c&&"slices"===i?(u="Objc",h=dv("","Rct1")):"Scl "===c?"object"==typeof n[c]&&"Hrzn"in n[c]?(u="Objc",h=fv):u="number"==typeof n[c]?"long":"UntF":"audioClipGroupList"===c&&1===o.length?u="VlLs":"Strt"!==c&&"Brgh"!==c||!("H   "in n)?"Wdth"===c&&"object"==typeof n[c]?u="UntF":"Ofst"===c&&"number"==typeof n[c]?u="long":"Strt"===c&&"object"==typeof n[c]?(u="Objc",h=fv):-1!==gv.indexOf(c)?u="RGBC"===r&&"artd"!==i?"doub":"long":"profile"===c?u="printOutput"===r?"TEXT":"tdta":"strokeStyleContent"===c?n[c]["Clr "]?h=dv("","solidColorLayer"):n[c].Grad?h=dv("","gradientLayer"):n[c].Ptrn&&(h=dv("","patternLayer")):"bounds"===c&&"quiltWarp"===i&&(h=dv("","classFloatRect")):u="doub":u="long":u="enum":u="doub":u="doub",h&&"RGBC"===h.classID&&"H   "in n[c]&&(h={classID:"HSBC",name:""}),Rv(e,c),Tx(e,u||"long"),Nv(e,u||"long",n[c],c,h,i)}}}function Fv(e,t,r){switch(t){case"obj ":return function(e){for(var t=$g(e),r=[],n=0;n<t;n++){var i=sy(e);switch(i){case"prop":Bv(e);var o=Lv(e);r.push(o);break;case"Clss":r.push(Bv(e));break;case"Enmr":Bv(e);var a=Lv(e),s=Lv(e);r.push("".concat(a,".").concat(s));break;case"rele":Bv(e),r.push(ty(e));break;case"Idnt":case"indx":r.push($g(e));break;case"name":Bv(e),r.push(uy(e));break;default:throw new Error("Invalid descriptor reference type: ".concat(i))}}return r}(e);case"Objc":case"GlbO":return Iv(e,r);case"VlLs":for(var n=$g(e),i=[],o=0;o<n;o++){var a=sy(e);i.push(Fv(e,a,r))}return i;case"doub":return ny(e);case"UntF":var s=sy(e),l=ny(e);if(!uv[s])throw new Error("Invalid units: ".concat(s));return{units:uv[s],value:l};case"UnFl":s=sy(e),l=ry(e);if(!uv[s])throw new Error("Invalid units: ".concat(s));return{units:uv[s],value:l};case"TEXT":return uy(e);case"enum":var c=Lv(e);l=Lv(e);return"".concat(c,".").concat(l);case"long":return $g(e);case"comp":return{low:ty(e),high:ty(e)};case"bool":return!!Vg(e);case"type":case"GlbC":return Bv(e);case"alis":return dy(e,$g(e));case"tdta":return ay(e,$g(e));case"ObAr":$g(e),uy(e),Lv(e);var u=$g(e);for(i=[],o=0;o<u;o++){var h=Lv(e);sy(e),sy(e);for(var d=$g(e),f=[],p=0;p<d;p++)f.push(ny(e));i.push({type:h,values:f})}return i;case"Pth ":$g(e);var v=sy(e);ey(e);var m=function(e,t){var r="";for(;t--;){var n=Qg(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}(e,ey(e));return{sig:v,path:m};default:throw new Error("Invalid TySh descriptor OSType: ".concat(t," at ").concat(e.offset.toString(16)))}}var Dv={meshPoints:"rationalPoint",quiltSliceX:"UntF",quiltSliceY:"UntF"};function Nv(e,t,r,n,i,o){switch(t){case"obj ":!function(e,t,r){gx(e,r.length);for(var n=0;n<r.length;n++){var i=r[n],o="unknown";switch("string"==typeof i&&(o=/^[a-z ]+\.[a-z ]+$/i.test(i)?"Enmr":"name"),Tx(e,o),o){case"Enmr":var a=i.split("."),s=a[0],l=a[1];Uv(e,"\0",s),Rv(e,s),Rv(e,l);break;case"name":Uv(e,"\0","Lyr "),kx(e,i+"\0");break;default:throw new Error("Invalid descriptor reference type: ".concat(o))}}}(e,0,r);break;case"Objc":case"GlbO":if("object"!=typeof r)throw new Error("Invalid struct value: ".concat(JSON.stringify(r),", key: ").concat(n));if(!i)throw new Error("Missing ext type for: '".concat(n,"' (").concat(JSON.stringify(r),")"));Pv(e,r._name||i.name,r._classID||i.classID,r,o);break;case"VlLs":if(!Array.isArray(r))throw new Error("Invalid list value: ".concat(JSON.stringify(r),", key: ").concat(n));gx(e,r.length);for(var a=0;a<r.length;a++){var s=yv[n];Tx(e,s||"long"),Nv(e,s||"long",r[a],"".concat(n,"[]"),vv[n],o)}break;case"doub":if("number"!=typeof r)throw new Error("Invalid number value: ".concat(JSON.stringify(r),", key: ").concat(n));wx(e,r);break;case"UntF":if(!hv[r.units])throw new Error("Invalid units: ".concat(r.units," in ").concat(n));Tx(e,hv[r.units]),wx(e,r.value);break;case"UnFl":if(!hv[r.units])throw new Error("Invalid units: ".concat(r.units," in ").concat(n));Tx(e,hv[r.units]),xx(e,r.value);break;case"TEXT":Mx(e,r);break;case"enum":if("string"!=typeof r)throw new Error("Invalid enum value: ".concat(JSON.stringify(r),", key: ").concat(n));var l=r.split("."),c=l[0],u=l[1];Rv(e,c),Rv(e,u);break;case"long":if("number"!=typeof r)throw new Error("Invalid integer value: ".concat(JSON.stringify(r),", key: ").concat(n));gx(e,r);break;case"bool":if("boolean"!=typeof r)throw new Error("Invalid boolean value: ".concat(JSON.stringify(r),", key: ").concat(n));fx(e,r?1:0);break;case"tdta":gx(e,r.byteLength),Sx(e,r);break;case"ObAr":gx(e,16),Mx(e,"");var h=Dv[n];if(!h)throw new Error("Not implemented ObArType for: ".concat(n));Rv(e,h),gx(e,r.length);for(a=0;a<r.length;a++){Rv(e,r[a].type),Tx(e,"UnFl"),Tx(e,"#Pxl"),gx(e,r[a].values.length);for(var d=0;d<r[a].values.length;d++)wx(e,r[a].values[d])}break;case"Pth ":var f=12+2*r.path.length;gx(e,f),Tx(e,r.sig),yx(e,f),yx(e,r.path.length),function(e,t){for(var r=0;r<t.length;r++)mx(e,t.charCodeAt(r))}(e,r.path);break;default:throw new Error("Not implemented descriptor OSType: ".concat(t))}}function Bv(e){return{name:uy(e),classID:Lv(e)}}function Uv(e,t,r){kx(e,t),Rv(e,r)}function zv(e,t){void 0===t&&(t=!1);var r=ty(e);if(16!==r)throw new Error("Invalid descriptor version: ".concat(r));return Iv(e,t)}function Xv(e,t,r,n,i){void 0===i&&(i=""),bx(e,16),Pv(e,t,r,n,i)}function Hv(e){return{x:e.Hrzn,y:e.Vrtc}}function Gv(e){return{Hrzn:e.x,Vrtc:e.y}}function jv(e){return{top:vm(e["Top "]),left:vm(e.Left),right:vm(e.Rght),bottom:vm(e.Btom)}}function Yv(e){var t;return(t={Left:xm(e.left,"bounds.left")})["Top "]=xm(e.top,"bounds.top"),t.Rght=xm(e.right,"bounds.right"),t.Btom=xm(e.bottom,"bounds.bottom"),t}function Wv(e){var t={enabled:!!e.enab,position:Nm.decode(e.Styl),fillType:Bm.decode(e.PntT),blendMode:Tm.decode(e["Md  "]),opacity:fm(e.Opct),size:vm(e["Sz  "])};return void 0!==e.present&&(t.present=e.present),void 0!==e.showInDialog&&(t.showInDialog=e.showInDialog),void 0!==e.overprint&&(t.overprint=e.overprint),e["Clr "]&&(t.color=um(e["Clr "])),e.Grad&&(t.gradient=im(e)),e.Ptrn&&(t.pattern=om(e)),t}function qv(e){var t={};return t.enab=!!e.enabled,void 0!==e.present&&(t.present=!!e.present),void 0!==e.showInDialog&&(t.showInDialog=!!e.showInDialog),t.Styl=Nm.encode(e.position),t.PntT=Bm.encode(e.fillType),t["Md  "]=Tm.encode(e.blendMode),t.Opct=ym(e.opacity),t["Sz  "]=xm(e.size,"size"),e.color&&(t["Clr "]=hm(e.color)),e.gradient&&(t=sv(sv({},t),sm(e.gradient))),e.pattern&&(t=sv(sv({},t),lm(e.pattern))),void 0!==e.overprint&&(t.overprint=!!e.overprint),t}function Vv(e,t,r){for(var n,i,o,a=r?{"Scl ":bm(null!==(n=e.scale)&&void 0!==n?n:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":bm(null!==(i=e.scale)&&void 0!==i?i:1)},s=0,l=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"];s<l.length;s++){if(e[f=l[s]]&&!Array.isArray(e[f]))throw new Error("".concat(f," should be an array"))}var c=function(e){return!!e&&e.length>1&&r},u=function(e){return!!e&&e.length>=1&&(!r||1===e.length)};if(u(e.dropShadow)&&(a.DrSh=tm(e.dropShadow[0],"dropShadow",t)),c(e.dropShadow)&&(a.dropShadowMulti=e.dropShadow.map((function(e){return tm(e,"dropShadow",t)}))),u(e.innerShadow)&&(a.IrSh=tm(e.innerShadow[0],"innerShadow",t)),c(e.innerShadow)&&(a.innerShadowMulti=e.innerShadow.map((function(e){return tm(e,"innerShadow",t)}))),e.outerGlow&&(a.OrGl=tm(e.outerGlow,"outerGlow",t)),c(e.solidFill)&&(a.solidFillMulti=e.solidFill.map((function(e){return tm(e,"solidFill",t)}))),c(e.gradientOverlay)&&(a.gradientFillMulti=e.gradientOverlay.map((function(e){return tm(e,"gradientOverlay",t)}))),c(e.stroke)&&(a.frameFXMulti=e.stroke.map((function(e){return qv(e)}))),e.innerGlow&&(a.IrGl=tm(e.innerGlow,"innerGlow",t)),e.bevel&&(a.ebbl=tm(e.bevel,"bevel",t)),u(e.solidFill)&&(a.SoFi=tm(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(a.patternFill=tm(e.patternOverlay,"patternOverlay",t)),u(e.gradientOverlay)&&(a.GrFl=tm(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(a.ChFX=tm(e.satin,"satin",t)),u(e.stroke)&&(a.FrFX=qv(null===(o=e.stroke)||void 0===o?void 0:o[0])),r){a.numModifyingFX=0;for(var h=0,d=Object.keys(e);h<d.length;h++){var f,p=e[f=d[h]];if(Array.isArray(p))for(var v=0,m=p;v<m.length;v++){m[v].enabled&&a.numModifyingFX++}else p.enabled&&a.numModifyingFX++}}return a}function Kv(e,t){var r={};return e.masterFXSwitch||(r.disabled=!0),e["Scl "]&&(r.scale=fm(e["Scl "])),e.DrSh&&(r.dropShadow=[em(e.DrSh,t)]),e.dropShadowMulti&&(r.dropShadow=e.dropShadowMulti.map((function(e){return em(e,t)}))),e.IrSh&&(r.innerShadow=[em(e.IrSh,t)]),e.innerShadowMulti&&(r.innerShadow=e.innerShadowMulti.map((function(e){return em(e,t)}))),e.OrGl&&(r.outerGlow=em(e.OrGl,t)),e.IrGl&&(r.innerGlow=em(e.IrGl,t)),e.ebbl&&(r.bevel=em(e.ebbl,t)),e.SoFi&&(r.solidFill=[em(e.SoFi,t)]),e.solidFillMulti&&(r.solidFill=e.solidFillMulti.map((function(e){return em(e,t)}))),e.patternFill&&(r.patternOverlay=em(e.patternFill,t)),e.GrFl&&(r.gradientOverlay=[em(e.GrFl,t)]),e.gradientFillMulti&&(r.gradientOverlay=e.gradientFillMulti.map((function(e){return em(e,t)}))),e.ChFX&&(r.satin=em(e.ChFX,t)),e.FrFX&&(r.stroke=[Wv(e.FrFX)]),e.frameFXMulti&&(r.stroke=e.frameFXMulti.map((function(e){return Wv(e)}))),r}function Zv(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.time,a=o.denominator,s=o.numerator,l=i.selected,c=i.animKey,u={numerator:s,denominator:a},h=Im.decode(i.animInterpStyle);switch(c.Type){case"keyType.Opct":r.push({interpolation:h,time:u,selected:l,type:"opacity",value:fm(c.Opct)});break;case"keyType.Pstn":r.push({interpolation:h,time:u,selected:l,type:"position",x:c.Hrzn,y:c.Vrtc});break;case"keyType.Trnf":r.push({interpolation:h,time:u,selected:l,type:"transform",scale:Hv(c["Scl "]),skew:Hv(c.Skew),rotation:c.rotation,translation:Hv(c.translation)});break;case"keyType.sheetStyle":var d={interpolation:h,time:u,selected:l,type:"style"};c.sheetStyle.Lefx&&(d.style=Kv(c.sheetStyle.Lefx,t)),r.push(d);break;case"keyType.globalLighting":r.push({interpolation:h,time:u,selected:l,type:"globalLighting",globalAngle:c.gblA,globalAltitude:c.globalAltitude});break;default:throw new Error("Unsupported keyType value")}}return r}function Jv(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=n.time,o=n.selected,a=void 0!==o&&o,s=n.interpolation,l=Im.encode(s),c=void 0;switch(n.type){case"opacity":c={Type:"keyType.Opct",Opct:ym(n.value)};break;case"position":c={Type:"keyType.Pstn",Hrzn:n.x,Vrtc:n.y};break;case"transform":c={Type:"keyType.Trnf","Scl ":Gv(n.scale),Skew:Gv(n.skew),rotation:n.rotation,translation:Gv(n.translation)};break;case"style":c={Type:"keyType.sheetStyle",sheetStyle:{Vrsn:1,blendOptions:{}}},n.style&&(c.sheetStyle={Vrsn:1,Lefx:Vv(n.style,!1,!1),blendOptions:{}});break;case"globalLighting":c={Type:"keyType.globalLighting",gblA:n.globalAngle,globalAltitude:n.globalAltitude};break;default:throw new Error("Unsupported keyType value")}t.push({Vrsn:1,animInterpStyle:l,time:i,animKey:c,selected:a})}return t}function Qv(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o={type:Pm.decode(i.trackID),enabled:i.enab,keys:Zv(i.keyList,t)};i.effectParams&&(o.effectParams={fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin,keys:Zv(i.effectParams.keyList,t)}),r.push(o)}return r}function $v(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(sv(sv({trackID:Pm.encode(n.type),Vrsn:1,enab:!!n.enabled,Effc:!!n.effectParams},n.effectParams?{effectParams:{keyList:Jv(n.keys),fillCanvas:n.effectParams.fillCanvas,zoomOrigin:n.effectParams.zoomOrigin}}:{}),{keyList:Jv(n.keys)}))}return t}function em(e,t){for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],a=e[o];switch(o){case"enab":r.enabled=!!a;break;case"uglg":r.useGlobalLight=!!a;break;case"AntA":r.antialiased=!!a;break;case"Algn":r.align=!!a;break;case"Dthr":r.dither=!!a;break;case"Invr":r.invert=!!a;break;case"Rvrs":r.reverse=!!a;break;case"Clr ":r.color=um(a);break;case"hglC":r.highlightColor=um(a);break;case"sdwC":r.shadowColor=um(a);break;case"Styl":r.position=Nm.decode(a);break;case"Md  ":r.blendMode=Tm.decode(a);break;case"hglM":r.highlightBlendMode=Tm.decode(a);break;case"sdwM":r.shadowBlendMode=Tm.decode(a);break;case"bvlS":r.style=Am.decode(a);break;case"bvlD":r.direction=Mm.decode(a);break;case"bvlT":r.technique=km.decode(a);break;case"GlwT":r.technique=Om.decode(a);break;case"glwS":r.source=Lm.decode(a);break;case"Type":r.type=Rm.decode(a);break;case"gs99":r.interpolationMethod=Fm.decode(a);break;case"Opct":r.opacity=fm(a);break;case"hglO":r.highlightOpacity=fm(a);break;case"sdwO":r.shadowOpacity=fm(a);break;case"lagl":case"Angl":r.angle=dm(a);break;case"Lald":r.altitude=dm(a);break;case"Sftn":r.soften=vm(a);break;case"srgR":r.strength=fm(a);break;case"blur":r.size=vm(a);break;case"Nose":r.noise=fm(a);break;case"Inpr":r.range=fm(a);break;case"Ckmt":r.choke=vm(a);break;case"ShdN":r.jitter=fm(a);break;case"Dstn":r.distance=vm(a);break;case"Scl ":r.scale=fm(a);break;case"Ptrn":r.pattern={name:a["Nm  "],id:a.Idnt};break;case"phase":r.phase={x:a.Hrzn,y:a.Vrtc};break;case"Ofst":r.offset={x:fm(a.Hrzn),y:fm(a.Vrtc)};break;case"MpgS":case"TrnS":r.contour={name:a["Nm  "],curve:a["Crv "].map((function(e){return{x:e.Hrzn,y:e.Vrtc}}))};break;case"Grad":r.gradient=rm(a);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[o]=a;break;case"_name":case"_classID":break;default:t&&console.log("Invalid effect key: '".concat(o,"', value:"),a)}}return r}function tm(e,t,r){for(var n={},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=e[a];switch(a){case"enabled":n.enab=!!s;break;case"useGlobalLight":n.uglg=!!s;break;case"antialiased":n.AntA=!!s;break;case"align":n.Algn=!!s;break;case"dither":n.Dthr=!!s;break;case"invert":n.Invr=!!s;break;case"reverse":n.Rvrs=!!s;break;case"color":n["Clr "]=hm(s);break;case"highlightColor":n.hglC=hm(s);break;case"shadowColor":n.sdwC=hm(s);break;case"position":n.Styl=Nm.encode(s);break;case"blendMode":n["Md  "]=Tm.encode(s);break;case"highlightBlendMode":n.hglM=Tm.encode(s);break;case"shadowBlendMode":n.sdwM=Tm.encode(s);break;case"style":n.bvlS=Am.encode(s);break;case"direction":n.bvlD=Mm.encode(s);break;case"technique":"bevel"===t?n.bvlT=km.encode(s):n.GlwT=Om.encode(s);break;case"source":n.glwS=Lm.encode(s);break;case"type":n.Type=Rm.encode(s);break;case"interpolationMethod":n.gs99=Fm.encode(s);break;case"opacity":n.Opct=ym(s);break;case"highlightOpacity":n.hglO=ym(s);break;case"shadowOpacity":n.sdwO=ym(s);break;case"angle":"gradientOverlay"===t||"patternFill"===t?n.Angl=gm(s):n.lagl=gm(s);break;case"altitude":n.Lald=gm(s);break;case"soften":n.Sftn=xm(s,a);break;case"strength":n.srgR=ym(s);break;case"size":n.blur=xm(s,a);break;case"noise":n.Nose=ym(s);break;case"range":n.Inpr=ym(s);break;case"choke":n.Ckmt=xm(s,a);break;case"jitter":n.ShdN=ym(s);break;case"distance":n.Dstn=xm(s,a);break;case"scale":n["Scl "]=ym(s);break;case"pattern":n.Ptrn={"Nm  ":s.name,Idnt:s.id};break;case"phase":n.phase={Hrzn:s.x,Vrtc:s.y};break;case"offset":n.Ofst={Hrzn:ym(s.x),Vrtc:ym(s.y)};break;case"contour":n["satin"===t?"MpgS":"TrnS"]={"Nm  ":s.name,"Crv ":s.curve.map((function(e){return{Hrzn:e.x,Vrtc:e.y}}))};break;case"gradient":n.Grad=nm(s);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[a]=s;break;default:r&&console.log("Invalid effect key: '".concat(a,"', value:"),s)}}return n}function rm(e){if("GrdF.CstS"===e.GrdF){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map((function(e){return{color:um(e["Clr "]),location:e.Lctn/t,midpoint:e.Mdpn/100}})),opacityStops:e.Trns.map((function(e){return{opacity:fm(e.Opct),location:e.Lctn/t,midpoint:e.Mdpn/100}}))}}return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:Dm.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map((function(e){return e/100})),max:e["Mxm "].map((function(e){return e/100}))}}function nm(e){var t,r;if("solid"===e.type){var n=Math.round(4096*(null!==(t=e.smoothness)&&void 0!==t?t:1));return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:n,Clrs:e.colorStops.map((function(e){var t;return{"Clr ":hm(e.color),Type:"Clry.UsrS",Lctn:Math.round(e.location*n),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}})),Trns:e.opacityStops.map((function(e){var t;return{Opct:ym(e.opacity),Lctn:Math.round(e.location*n),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}}))}}return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:Dm.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(4096*(null!==(r=e.roughness)&&void 0!==r?r:1)),"Mnm ":(e.min||[0,0,0,0]).map((function(e){return 100*e})),"Mxm ":(e.max||[1,1,1,1]).map((function(e){return 100*e}))}}function im(e){var t=rm(e.Grad);return t.style=Rm.decode(e.Type),void 0!==e.Dthr&&(t.dither=e.Dthr),void 0!==e.gradientsInterpolationMethod&&(t.interpolationMethod=Fm.decode(e.gradientsInterpolationMethod)),void 0!==e.Rvrs&&(t.reverse=e.Rvrs),void 0!==e.Angl&&(t.angle=dm(e.Angl)),void 0!==e["Scl "]&&(t.scale=fm(e["Scl "])),void 0!==e.Algn&&(t.align=e.Algn),void 0!==e.Ofst&&(t.offset={x:fm(e.Ofst.Hrzn),y:fm(e.Ofst.Vrtc)}),t}function om(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return void 0!==e.Lnkd&&(t.linked=e.Lnkd),void 0!==e.phase&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function am(e){if("Grad"in e)return im(e);if("Ptrn"in e)return sv({type:"pattern"},om(e));if("Clr "in e)return{type:"color",color:um(e["Clr "])};throw new Error("Invalid vector content")}function sm(e){var t={};return void 0!==e.dither&&(t.Dthr=e.dither),void 0!==e.interpolationMethod&&(t.gradientsInterpolationMethod=Fm.encode(e.interpolationMethod)),void 0!==e.reverse&&(t.Rvrs=e.reverse),void 0!==e.angle&&(t.Angl=gm(e.angle)),t.Type=Rm.encode(e.style),void 0!==e.align&&(t.Algn=e.align),void 0!==e.scale&&(t["Scl "]=ym(e.scale)),e.offset&&(t.Ofst={Hrzn:ym(e.offset.x),Vrtc:ym(e.offset.y)}),t.Grad=nm(e),t}function lm(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return void 0!==e.linked&&(t.Lnkd=!!e.linked),void 0!==e.phase&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function cm(e){return"color"===e.type?{key:"SoCo",descriptor:{"Clr ":hm(e.color)}}:"pattern"===e.type?{key:"PtFl",descriptor:lm(e)}:{key:"GdFl",descriptor:sm(e)}}function um(e){if("H   "in e)return{h:pm(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};if("redFloat"in e)return{fr:e.redFloat,fg:e.greenFloat,fb:e.blueFloat};throw new Error("Unsupported color descriptor")}function hm(e){if(e){if("r"in e)return{_name:"",_classID:"RGBC","Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("fr"in e)return{_name:"",_classID:"RGBC",redFloat:e.fr,greenFloat:e.fg,blueFloat:e.fb};if("h"in e)return{_name:"",_classID:"HSBC","H   ":gm(360*e.h),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{_name:"",_classID:"CMYC","Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{_name:"",_classID:"LABC",Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{_name:"",_classID:"GRYC","Gry ":e.k};throw new Error("Invalid color value")}return{_name:"",_classID:"RGBC","Rd  ":0,"Grn ":0,"Bl  ":0}}function dm(e){if(void 0===e)return 0;if("Angle"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value}function fm(e){if(void 0===e)return 1;if("Percent"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value/100}function pm(e){if(void 0===e)return 1;if("Percent"===e.units)return e.value/100;if("Angle"===e.units)return e.value/360;throw new Error("Invalid units: ".concat(e.units))}function vm(e){var t=e.units,r=e.value;if("Pixels"!==t&&"Millimeters"!==t&&"Points"!==t&&"None"!==t&&"Picas"!==t&&"Inches"!==t&&"Centimeters"!==t&&"Density"!==t)throw new Error("Invalid units: ".concat(JSON.stringify({units:t,value:r})));return{value:r,units:t}}function mm(e,t){return void 0===t&&(t="Pixels"),"number"==typeof e?{value:e,units:t}:vm(e)}function gm(e){return{units:"Angle",value:e||0}}function ym(e){return{units:"Percent",value:Math.round(100*(e||0))}}function bm(e){return{units:"Percent",value:100*(e||0)}}function xm(e,t){if(null==e)return{units:"Pixels",value:0};if("object"!=typeof e)throw new Error("Invalid value: ".concat(JSON.stringify(e)," (key: ").concat(t,") (should have value and units)"));var r=e.units,n=e.value;if("number"!=typeof n)throw new Error("Invalid value in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));if("Pixels"!==r&&"Millimeters"!==r&&"Points"!==r&&"None"!==r&&"Picas"!==r&&"Inches"!==r&&"Centimeters"!==r&&"Density"!==r)throw new Error("Invalid units in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));return{units:r,value:n}}function wm(e){return{numerator:e.numerator,denominator:e.denominator}}var Em=qp("textGridding","none",{none:"None",round:"Rnd "}),_m=qp("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"}),Sm=qp("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm",platform:"antiAliasPlatformGray",platformLCD:"antiAliasPlatformLCD"}),Cm=qp("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist",cylinder:"warpCylinder",custom:"warpCustom"}),Tm=qp("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns","linear height":"linearHeight",height:"Hght",subtraction:"Sbtr"}),Am=qp("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"}),km=qp("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"}),Mm=qp("BESs","up",{up:"In  ",down:"Out "}),Om=qp("BETE","softer",{softer:"SfBL",precise:"PrBL"}),Lm=qp("IGSr","edge",{edge:"SrcE",center:"SrcC"}),Rm=qp("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"}),Im=qp("animInterpStyle","linear",{linear:"Lnr ",hold:"hold"}),Pm=qp("stdTrackID","opacity",{opacity:"opacityTrack",style:"styleTrack",sheetTransform:"sheetTransformTrack",sheetPosition:"sheetPositionTrack",globalLighting:"globalLightingTrack"}),Fm=qp("gradientInterpolationMethodType","perceptual",{perceptual:"Perc",linear:"Lnr",classic:"Gcls",smooth:"Smoo"}),Dm=qp("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl",hsl:"HSLC"}),Nm=qp("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"}),Bm=qp("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"}),Um=qp("ESliceType","image",{image:"Img ",noImage:"noImage"}),zm=qp("ESliceHorzAlign","default",{default:"default"}),Xm=qp("ESliceVertAlign","default",{default:"default"}),Hm=qp("ESliceOrigin","userGenerated",{userGenerated:"userGenerated",autoGenerated:"autoGenerated",layer:"layer"}),Gm=qp("ESliceBGColorType","none",{none:"None",matte:"matte",color:"Clr "}),jm=qp("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"}),Ym=qp("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"}),Wm=qp("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"}),qm=qp("BlrM","ispinmage",{spin:"Spn ",zoom:"Zm  "}),Vm=qp("BlrQ","good",{draft:"Drft",good:"Gd  ",best:"Bst "}),Km=qp("SmBM","normal",{normal:"SBMN","edge only":"SBME","overlay edge":"SBMO"}),Zm=qp("SmBQ","medium",{low:"SBQL",medium:"SBQM",high:"SBQH"}),Jm=qp("DspM","stretch to fit",{"stretch to fit":"StrF",tile:"Tile"}),Qm=qp("UndA","repeat edge pixels",{"wrap around":"WrpA","repeat edge pixels":"RptE"}),$m=qp("Cnvr","rectangular to polar",{"rectangular to polar":"RctP","polar to rectangular":"PlrR"}),eg=qp("RplS","medium",{small:"Sml ",medium:"Mdm ",large:"Lrg "}),tg=qp("SphM","normal",{normal:"Nrml","horizontal only":"HrzO","vertical only":"VrtO"}),rg=qp("Wvtp","sine",{sine:"WvSn",triangle:"WvTr",square:"WvSq"}),ng=qp("ZZTy","pond ripples",{"around center":"ArnC","out from center":"OtFr","pond ripples":"PndR"}),ig=qp("Dstr","uniform",{uniform:"Unfr",gaussian:"Gsn "}),og=qp("Chnl","composite",{red:"Rd  ",green:"Grn ",blue:"Bl  ",composite:"Cmps"}),ag=qp("MztT","fine dots",{"fine dots":"FnDt","medium dots":"MdmD","grainy dots":"GrnD","coarse dots":"CrsD","short lines":"ShrL","medium lines":"MdmL","long lines":"LngL","short strokes":"ShSt","medium strokes":"MdmS","long strokes":"LngS"}),sg=qp("Lns ","50-300mm zoom",{"50-300mm zoom":"Zm  ","32mm prime":"Nkn ","105mm prime":"Nkn1","movie prime":"PnVs"}),lg=qp("blurType","gaussian blur",{"gaussian blur":"GsnB","lens blur":"lensBlur","motion blur":"MtnB"}),cg=qp("DfsM","normal",{normal:"Nrml","darken only":"DrkO","lighten only":"LghO",anisotropic:"anisotropic"}),ug=qp("ExtT","blocks",{blocks:"Blks",pyramids:"Pyrm"}),hg=qp("ExtR","random",{random:"Rndm","level-based":"LvlB"}),dg=qp("FlCl","background color",{"background color":"FlBc","foreground color":"FlFr","inverse image":"FlIn","unaltered image":"FlSm"}),fg=qp("CntE","upper",{lower:"Lwr ",upper:"Upr "}),pg=qp("WndM","wind",{wind:"Wnd ",blast:"Blst",stagger:"Stgr"}),vg=qp("Drct","from the right",{left:"Left",right:"Rght"}),mg=qp("IntE","odd lines",{"odd lines":"ElmO","even lines":"ElmE"}),gg=qp("IntC","interpolation",{duplication:"CrtD",interpolation:"CrtI"}),yg=qp("FlMd","wrap around",{"set to transparent":"Bckg","repeat edge pixels":"Rpt ","wrap around":"Wrp "});qp("prjM","fisheye",{fisheye:"fisP",perspective:"perP",auto:"auto","full spherical":"fusP"});var bg=qp("presetKindType","presetKindCustom",{custom:"presetKindCustom",default:"presetKindDefault"}),xg=function(){return xg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xg.apply(this,arguments)},wg={};function Eg(e,t,r,n){var i={key:e,has:t,read:r,write:n};wg[i.key]=i}var _g=[void 0,"PPI","PPCM"],Sg=[void 0,"Inches","Centimeters","Points","Picas","Columns"],Cg="0123456789abcdef";function Tg(e){return e<=57?e-48:e-87}function Ag(e,t){return Tg(e.charCodeAt(t))<<4|Tg(e.charCodeAt(t+1))}function kg(e,t){return av(ay(e,t))}function Mg(e,t){Sx(e,iv(t))}function Og(e){for(var t=ay(e,Vg(e)),r=!1,n=0;n<t.byteLength;n++)if(128&t[n]){r=!0;break}return r?new TextDecoder("gbk").decode(t):av(t)}function Lg(e,t){for(var r="",n=0,i=t.codePointAt(n++);void 0!==i;i=t.codePointAt(n++))r+=i>127?"?":String.fromCodePoint(i);var o=iv(r);fx(e,o.byteLength),Sx(e,o)}Eg(1061,(function(e){return void 0!==e.captionDigest}),(function(e,t){for(var r="",n=0;n<16;n++){var i=Vg(e);r+=Cg[i>>4],r+=Cg[15&i]}t.captionDigest=r}),(function(e,t){for(var r=0;r<16;r++)fx(e,Ag(t.captionDigest,2*r))})),Eg(1060,(function(e){return void 0!==e.xmpMetadata}),(function(e,t,r){t.xmpMetadata=kg(e,r())}),(function(e,t){Mg(e,t.xmpMetadata)}));var Rg=qp("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});Eg(1082,(function(e){return void 0!==e.printInformation}),(function(e,t){var r,n,i=zv(e);t.printInformation={printerName:i.printerName||"",renderingIntent:Rg.decode(null!==(r=i.Inte)&&void 0!==r?r:"Inte.Img ")};var o=t.printInformation;void 0!==i.PstS&&(o.printerManagesColors=i.PstS),void 0!==i["Nm  "]&&(o.printerProfile=i["Nm  "]),void 0!==i.MpBl&&(o.blackPointCompensation=i.MpBl),void 0!==i.printSixteenBit&&(o.printSixteenBit=i.printSixteenBit),void 0!==i.hardProof&&(o.hardProof=i.hardProof),i.printProofSetup&&("Bltn"in i.printProofSetup?o.proofSetup={builtin:i.printProofSetup.Bltn.split(".")[1]}:o.proofSetup={profile:i.printProofSetup.profile,renderingIntent:Rg.decode(null!==(n=i.printProofSetup.Inte)&&void 0!==n?n:"Inte.Img "),blackPointCompensation:!!i.printProofSetup.MpBl,paperWhite:!!i.printProofSetup.paperWhite})}),(function(e,t){var r,n,i=t.printInformation,o={};i.printerManagesColors?o.PstS=!0:(void 0!==i.hardProof&&(o.hardProof=!!i.hardProof),o.ClrS="ClrS.RGBC",o["Nm  "]=null!==(r=i.printerProfile)&&void 0!==r?r:"CIE RGB"),o.Inte=Rg.encode(i.renderingIntent),i.printerManagesColors||(o.MpBl=!!i.blackPointCompensation),o.printSixteenBit=!!i.printSixteenBit,o.printerName=i.printerName||"",i.proofSetup&&"profile"in i.proofSetup?o.printProofSetup={profile:i.proofSetup.profile||"",Inte:Rg.encode(i.proofSetup.renderingIntent),MpBl:!!i.proofSetup.blackPointCompensation,paperWhite:!!i.proofSetup.paperWhite}:o.printProofSetup={Bltn:(null===(n=i.proofSetup)||void 0===n?void 0:n.builtin)?"builtinProof.".concat(i.proofSetup.builtin):"builtinProof.proofCMYK"},Xv(e,"","printOutput",o)})),Eg(1005,(function(e){return void 0!==e.resolutionInfo}),(function(e,t){var r=iy(e),n=Jg(e),i=Jg(e),o=iy(e),a=Jg(e),s=Jg(e);t.resolutionInfo={horizontalResolution:r,horizontalResolutionUnit:_g[n]||"PPI",widthUnit:Sg[i]||"Inches",verticalResolution:o,verticalResolutionUnit:_g[a]||"PPI",heightUnit:Sg[s]||"Inches"}}),(function(e,t){var r=t.resolutionInfo;Ex(e,r.horizontalResolution||0),vx(e,Math.max(1,_g.indexOf(r.horizontalResolutionUnit))),vx(e,Math.max(1,Sg.indexOf(r.widthUnit))),Ex(e,r.verticalResolution||0),vx(e,Math.max(1,_g.indexOf(r.verticalResolutionUnit))),vx(e,Math.max(1,Sg.indexOf(r.heightUnit)))}));var Ig=["centered","size to fit","user defined"];Eg(1062,(function(e){return void 0!==e.printScale}),(function(e,t){t.printScale={style:Ig[Zg(e)],x:ry(e),y:ry(e),scale:ry(e)}}),(function(e,t){var r=t.printScale,n=r.style,i=r.x,o=r.y,a=r.scale;px(e,Math.max(0,Ig.indexOf(n))),xx(e,i||0),xx(e,o||0),xx(e,a||0)})),Eg(1006,(function(e){return void 0!==e.alphaChannelNames}),(function(e,t,r){if(t.alphaChannelNames)fy(e,r());else for(t.alphaChannelNames=[];r()>0;){var n=Og(e);t.alphaChannelNames.push(n)}}),(function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){Lg(e,n[r])}})),Eg(1045,(function(e){return void 0!==e.alphaChannelNames}),(function(e,t,r){for(t.alphaChannelNames=[];r()>0;)t.alphaChannelNames.push(uy(e))}),(function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){Mx(e,n[r])}})),Eg(1053,(function(e){return void 0!==e.alphaIdentifiers}),(function(e,t,r){for(t.alphaIdentifiers=[];r()>=4;)t.alphaIdentifiers.push(ty(e))}),(function(e,t){for(var r=0,n=t.alphaIdentifiers;r<n.length;r++){bx(e,n[r])}})),Eg(1010,(function(e){return void 0!==e.backgroundColor}),(function(e,t){return t.backgroundColor=Iy(e)}),(function(e,t){return Ix(e,t.backgroundColor)})),Eg(1037,(function(e){return void 0!==e.globalAngle}),(function(e,t){return t.globalAngle=$g(e)}),(function(e,t){return gx(e,t.globalAngle)})),Eg(1049,(function(e){return void 0!==e.globalAltitude}),(function(e,t){return t.globalAltitude=ty(e)}),(function(e,t){return bx(e,t.globalAltitude)})),Eg(1011,(function(e){return void 0!==e.printFlags}),(function(e,t){t.printFlags={labels:!!Vg(e),cropMarks:!!Vg(e),colorBars:!!Vg(e),registrationMarks:!!Vg(e),negative:!!Vg(e),flip:!!Vg(e),interpolate:!!Vg(e),caption:!!Vg(e),printFlags:!!Vg(e)}}),(function(e,t){var r=t.printFlags;fx(e,r.labels?1:0),fx(e,r.cropMarks?1:0),fx(e,r.colorBars?1:0),fx(e,r.registrationMarks?1:0),fx(e,r.negative?1:0),fx(e,r.flip?1:0),fx(e,r.interpolate?1:0),fx(e,r.caption?1:0),fx(e,r.printFlags?1:0)})),Eg(1080,(function(e){return void 0!==e.countInformation}),(function(e,t){var r=zv(e);t.countInformation=r.countGroupList.map((function(e){return{color:{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]},name:e["Nm  "],size:e["Rds "],fontSize:e.fontSize,visible:e.Vsbl,points:e.countObjectList.map((function(e){return{x:e["X   "],y:e["Y   "]}}))}}))}),(function(e,t){Xv(e,"","Cnt ",{Vrsn:1,countGroupList:t.countInformation.map((function(e){return{"Rd  ":e.color.r,"Grn ":e.color.g,"Bl  ":e.color.b,"Nm  ":e.name,"Rds ":e.size,fontSize:e.fontSize,Vsbl:e.visible,countObjectList:e.points.map((function(e){return{"X   ":e.x,"Y   ":e.y}}))}}))})})),Eg(1024,(function(e){return void 0!==e.layerState}),(function(e,t){return t.layerState=Jg(e)}),(function(e,t){return vx(e,t.layerState)})),Eg(1026,(function(e){return void 0!==e.layersGroup}),(function(e,t,r){for(t.layersGroup=[];r()>0;)t.layersGroup.push(Jg(e))}),(function(e,t){for(var r=0,n=t.layersGroup;r<n.length;r++){vx(e,n[r])}})),Eg(1072,(function(e){return void 0!==e.layerGroupsEnabledId}),(function(e,t,r){for(t.layerGroupsEnabledId=[];r()>0;)t.layerGroupsEnabledId.push(Vg(e))}),(function(e,t){for(var r=0,n=t.layerGroupsEnabledId;r<n.length;r++){fx(e,n[r])}})),Eg(1069,(function(e){return void 0!==e.layerSelectionIds}),(function(e,t){var r=Jg(e);for(t.layerSelectionIds=[];r--;)t.layerSelectionIds.push(ty(e))}),(function(e,t){vx(e,t.layerSelectionIds.length);for(var r=0,n=t.layerSelectionIds;r<n.length;r++){bx(e,n[r])}})),Eg(1032,(function(e){return void 0!==e.gridAndGuidesInformation}),(function(e,t){var r=ty(e),n=ty(e),i=ty(e),o=ty(e);if(1!==r)throw new Error("Invalid 1032 resource version: ".concat(r));t.gridAndGuidesInformation={grid:{horizontal:n,vertical:i},guides:[]};for(var a=0;a<o;a++)t.gridAndGuidesInformation.guides.push({location:ty(e)/32,direction:Vg(e)?"horizontal":"vertical"})}),(function(e,t){var r=t.gridAndGuidesInformation,n=r.grid||{horizontal:576,vertical:576},i=r.guides||[];bx(e,1),bx(e,n.horizontal),bx(e,n.vertical),bx(e,i.length);for(var o=0,a=i;o<a.length;o++){var s=a[o];bx(e,32*s.location),fx(e,"horizontal"===s.direction?1:0)}})),Eg(1065,(function(e){return void 0!==e.layerComps}),(function(e,t){var r=zv(e,!0);t.layerComps={list:[]};for(var n=0,i=r.list;n<i.length;n++){var o=i[n];t.layerComps.list.push({id:o.compID,name:o["Nm  "],capturedInfo:o.capturedInfo}),"comment"in o&&(t.layerComps.list[t.layerComps.list.length-1].comment=o.comment)}"lastAppliedComp"in r&&(t.layerComps.lastApplied=r.lastAppliedComp)}),(function(e,t){for(var r=t.layerComps,n={list:[]},i=0,o=r.list;i<o.length;i++){var a=o[i],s={_classID:"Comp"};s["Nm  "]=a.name,"comment"in a&&(s.comment=a.comment),s.compID=a.id,s.capturedInfo=a.capturedInfo,n.list.push(s)}"lastApplied"in r&&(n.lastAppliedComp=r.lastApplied),Xv(e,"","CompList",n)}));var Pg=["normal",void 0,void 0,void 0,void 0,void 0,void 0,"multiply","screen",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"difference"];function Fg(e){return{"Top ":e.top,Left:e.left,Btom:e.bottom,Rght:e.right}}function Dg(e){return{top:e["Top "],left:e.Left,bottom:e.Btom,right:e.Rght}}function Ng(e,t){return e[Math.max(0,Math.min(e.length-1,t))]}Eg(1078,(function(e){return void 0!==e.onionSkins}),(function(e,t){var r=zv(e);t.onionSkins={enabled:r.enab,framesBefore:r.numBefore,framesAfter:r.numAfter,frameSpacing:r.Spcn,minOpacity:r.minOpacity/100,maxOpacity:r.maxOpacity/100,blendMode:Pg[r.BlnM]||"normal"}}),(function(e,t){var r=t.onionSkins;Xv(e,"","null",{Vrsn:1,enab:r.enabled,numBefore:r.framesBefore,numAfter:r.framesAfter,Spcn:r.frameSpacing,minOpacity:100*r.minOpacity|0,maxOpacity:100*r.maxOpacity|0,BlnM:Math.max(0,Pg.indexOf(r.blendMode))})})),Eg(1075,(function(e){return void 0!==e.timelineInformation}),(function(e,t){var r,n,i=zv(e);t.timelineInformation={enabled:i.enab,frameStep:wm(i.frameStep),frameRate:i.frameRate,time:wm(i.time),duration:wm(i.duration),workInTime:wm(i.workInTime),workOutTime:wm(i.workOutTime),repeats:i.LCnt,hasMotion:i.hasMotion,globalTracks:Qv(i.globalTrackList,!!e.logMissingFeatures)},(null===(n=null===(r=i.audioClipGroupList)||void 0===r?void 0:r.audioClipGroupList)||void 0===n?void 0:n.length)&&(t.timelineInformation.audioClipGroups=i.audioClipGroupList.audioClipGroupList.map((function(e){return{id:e.groupID,muted:e.muted,audioClips:e.audioClipList.map((function(e){var t=e.clipID,r=e.timeScope,n=e.muted,i=e.audioLevel,o=e.frameReader;return{id:t,start:wm(r.Strt),duration:wm(r.duration),inTime:wm(r.inTime),outTime:wm(r.outTime),muted:n,audioLevel:i,frameReader:{type:o.frameReaderType,mediaDescriptor:o.mediaDescriptor,link:{name:o["Lnk "]["Nm  "],fullPath:o["Lnk "].fullPath,relativePath:o["Lnk "].relPath}}}}))}})))}),(function(e,t){var r,n=t.timelineInformation,i={Vrsn:1,enab:n.enabled,frameStep:n.frameStep,frameRate:n.frameRate,time:n.time,duration:n.duration,workInTime:n.workInTime,workOutTime:n.workOutTime,LCnt:n.repeats,globalTrackList:$v(n.globalTracks),audioClipGroupList:{audioClipGroupList:null===(r=n.audioClipGroups)||void 0===r?void 0:r.map((function(e){return{groupID:e.id,muted:e.muted,audioClipList:e.audioClips.map((function(e){return{clipID:e.id,timeScope:{Vrsn:1,Strt:e.start,duration:e.duration,inTime:e.inTime,outTime:e.outTime},frameReader:{frameReaderType:e.frameReader.type,descVersion:1,"Lnk ":{descVersion:1,"Nm  ":e.frameReader.link.name,fullPath:e.frameReader.link.fullPath,relPath:e.frameReader.link.relativePath},mediaDescriptor:e.frameReader.mediaDescriptor},muted:e.muted,audioLevel:e.audioLevel}}))}}))},hasMotion:n.hasMotion};Xv(e,"","null",i,"anim")})),Eg(1076,(function(e){return void 0!==e.sheetDisclosure}),(function(e,t){var r=zv(e);t.sheetDisclosure={},r.sheetTimelineOptions&&(t.sheetDisclosure.sheetTimelineOptions=r.sheetTimelineOptions.map((function(e){return{sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}})))}),(function(e,t){var r=t.sheetDisclosure,n={Vrsn:1};r.sheetTimelineOptions&&(n.sheetTimelineOptions=r.sheetTimelineOptions.map((function(e){return{Vrsn:2,sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}}))),Xv(e,"","null",n)})),Eg(1054,(function(e){return void 0!==e.urlsList}),(function(e,t){var r=ty(e);t.urlsList=[];for(var n=0;n<r;n++){if("slic"!==sy(e)&&e.throwForMissingFeatures)throw new Error("Unknown long");var i=ty(e),o=uy(e);t.urlsList.push({id:i,url:o,ref:"slice"})}}),(function(e,t){var r=t.urlsList;bx(e,r.length);for(var n=0;n<r.length;n++)Tx(e,"slic"),bx(e,r[n].id),kx(e,r[n].url)}));var Bg=["autoGenerated","layer","userGenerated"],Ug=["noImage","image"],zg=["default"];Eg(1050,(function(e){return e.slices?e.slices.length:0}),(function(e,t){var r=ty(e);if(6===r){t.slices||(t.slices=[]);var n=$g(e),i=$g(e),o=$g(e),a=$g(e),s=uy(e),l=ty(e);t.slices.push({bounds:{top:n,left:i,bottom:o,right:a},groupName:s,slices:[]});for(var c=t.slices[t.slices.length-1].slices,u=0;u<l;u++){var h=ty(e),d=ty(e),f=Ng(Bg,ty(e)),p="layer"==f?ty(e):0,v=uy(e),m=Ng(Ug,ty(e)),g=$g(e),y=$g(e),b=$g(e),x=$g(e),w=uy(e),E=uy(e),_=uy(e),S=uy(e),C=!!Vg(e),T=uy(e),A=Ng(zg,ty(e)),k=Ng(zg,ty(e)),M=Vg(e),O=Vg(e),L=Vg(e),R=Vg(e),I=M+O+L+R===0?"none":0===M?"matte":"color";c.push({id:h,groupId:d,origin:f,associatedLayerId:p,name:v,target:E,message:_,altTag:S,cellTextIsHTML:C,cellText:T,horizontalAlignment:A,verticalAlignment:k,type:m,url:w,bounds:{top:y,left:g,bottom:x,right:b},backgroundColorType:I,backgroundColor:{r:O,g:L,b:R,a:M}})}(P=zv(e)).slices.forEach((function(e){var t=c.find((function(t){return e.sliceID==t.id}));t&&(t.topOutset=e.topOutset,t.leftOutset=e.leftOutset,t.bottomOutset=e.bottomOutset,t.rightOutset=e.rightOutset)}))}else{if(7!==r&&8!==r)throw new Error("Invalid slices version (".concat(r,")"));var P=zv(e);t.slices||(t.slices=[]),t.slices.push({groupName:P.baseName,bounds:Dg(P.bounds),slices:P.slices.map((function(e){return xg(xg({},e["Nm  "]?{name:e["Nm  "]}:{}),{id:e.sliceID,groupId:e.groupID,associatedLayerId:0,origin:Hm.decode(e.origin),type:Um.decode(e.Type),bounds:Dg(e.bounds),url:e.url,target:e.null,message:e.Msge,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horizontalAlignment:zm.decode(e.horzAlign),verticalAlignment:Xm.decode(e.vertAlign),backgroundColorType:Gm.decode(e.bgColorType),backgroundColor:e.bgColor?{r:e.bgColor["Rd  "],g:e.bgColor["Grn "],b:e.bgColor["Bl  "],a:e.bgColor.alpha}:{r:0,g:0,b:0,a:0},topOutset:e.topOutset||0,leftOutset:e.leftOutset||0,bottomOutset:e.bottomOutset||0,rightOutset:e.rightOutset||0})}))})}}),(function(e,t,r){var n=t.slices[r],i=n.bounds,o=n.groupName,a=n.slices;bx(e,6),gx(e,i.top),gx(e,i.left),gx(e,i.bottom),gx(e,i.right),kx(e,o),bx(e,a.length);for(var s=0;s<a.length;s++){var l=a[s],c=l.backgroundColor,u=c.a,h=c.r,d=c.g,f=c.b;"none"===l.backgroundColorType?u=h=d=f=0:"matte"===l.backgroundColorType&&(u=0,h=d=f=255),bx(e,l.id),bx(e,l.groupId),bx(e,Bg.indexOf(l.origin)),"layer"===l.origin&&bx(e,l.associatedLayerId),kx(e,l.name||""),bx(e,Ug.indexOf(l.type)),gx(e,l.bounds.left),gx(e,l.bounds.top),gx(e,l.bounds.right),gx(e,l.bounds.bottom),kx(e,l.url),kx(e,l.target),kx(e,l.message),kx(e,l.altTag),fx(e,l.cellTextIsHTML?1:0),kx(e,l.cellText),bx(e,zg.indexOf(l.horizontalAlignment)),bx(e,zg.indexOf(l.verticalAlignment)),fx(e,u),fx(e,h),fx(e,d),fx(e,f)}var p={bounds:Fg(i),slices:[]};a.forEach((function(e){var t=xg(xg({sliceID:e.id,groupID:e.groupId,origin:Hm.encode(e.origin),Type:Um.encode(e.type),bounds:Fg(e.bounds)},e.name?{"Nm  ":e.name}:{}),{url:e.url,null:e.target,Msge:e.message,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horzAlign:zm.encode(e.horizontalAlignment),vertAlign:Xm.encode(e.verticalAlignment),bgColorType:Gm.encode(e.backgroundColorType)});if("color"===e.backgroundColorType){var r=e.backgroundColor,n=r.r,i=r.g,o=r.b,a=r.a;t.bgColor={"Rd  ":n,"Grn ":i,"Bl  ":o,alpha:a}}t.topOutset=e.topOutset||0,t.leftOutset=e.leftOutset||0,t.bottomOutset=e.bottomOutset||0,t.rightOutset=e.rightOutset||0,p.slices.push(t)})),Xv(e,"","null",p,"slices")})),Eg(1064,(function(e){return void 0!==e.pixelAspectRatio}),(function(e,t){if(ty(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:ny(e)}}),(function(e,t){bx(e,2),wx(e,t.pixelAspectRatio.aspect)})),Eg(1041,(function(e){return void 0!==e.iccUntaggedProfile}),(function(e,t){t.iccUntaggedProfile=!!Vg(e)}),(function(e,t){fx(e,t.iccUntaggedProfile?1:0)})),Eg(1044,(function(e){return void 0!==e.idsSeedNumber}),(function(e,t){return t.idsSeedNumber=ty(e)}),(function(e,t){return bx(e,t.idsSeedNumber)})),Eg(1036,(function(e){return void 0!==e.thumbnail||void 0!==e.thumbnailRaw}),(function(e,t,r){var n=ty(e),i=ty(e),o=ty(e);ty(e),ty(e),ty(e);var a=Jg(e),s=Jg(e);if(1!==n||24!==a||1!==s)return e.logMissingFeatures&&e.log("Invalid thumbnail data (format: ".concat(n,", bitsPerPixel: ").concat(a,", planes: ").concat(s,")")),void fy(e,r());var l=ay(e,r());e.useRawThumbnail?t.thumbnailRaw={width:i,height:o,data:l}:l.byteLength&&(t.thumbnail=$p(l))}),(function(e,t){var r,n=0,i=0,o=new Uint8Array(0);if(t.thumbnailRaw)n=t.thumbnailRaw.width,i=t.thumbnailRaw.height,o=t.thumbnailRaw.data;else try{var a=null===(r=t.thumbnail.toDataURL("image/jpeg",1))||void 0===r?void 0:r.substring(23);a&&(o=we(a),n=t.thumbnail.width,i=t.thumbnail.height)}catch(e){}var s=4*Math.floor((24*n+31)/32),l=s*i*1,c=o.length;bx(e,1),bx(e,n),bx(e,i),bx(e,s),bx(e,l),bx(e,c),vx(e,24),vx(e,1),Sx(e,o)})),Eg(1057,(function(e){return void 0!==e.versionInfo}),(function(e,t,r){if(1!==ty(e))throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!Vg(e),writerName:uy(e),readerName:uy(e),fileVersion:ty(e)},fy(e,r())}),(function(e,t){var r=t.versionInfo;bx(e,1),fx(e,r.hasRealMergedData?1:0),kx(e,r.writerName),kx(e,r.readerName),bx(e,r.fileVersion)})),Eg(7e3,(function(e){return void 0!==e.imageReadyVariables}),(function(e,t,r){t.imageReadyVariables=kg(e,r())}),(function(e,t){Mg(e,t.imageReadyVariables)})),Eg(7001,(function(e){return void 0!==e.imageReadyDataSets}),(function(e,t,r){t.imageReadyDataSets=kg(e,r())}),(function(e,t){Mg(e,t.imageReadyDataSets)})),Eg(1088,(function(e){return void 0!==e.pathSelectionState}),(function(e,t,r){var n=zv(e);t.pathSelectionState=n.null}),(function(e,t){Xv(e,"","null",{null:t.pathSelectionState})}));var Xg=qp("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"});Eg(4e3,(function(e){return void 0!==e.animations}),(function(e,t,r){var n=sy(e);if("mani"===n)py(e,"IRFR"),Ry(e,1,(function(r){for(var n=function(){py(e,"8BIM");var r=sy(e);Ry(e,1,(function(n){if("AnDs"===r){var i=zv(e);t.animations={frames:i.FrIn.map((function(e){return{id:e.FrID,delay:(e.FrDl||0)/100,dispose:e.FrDs?Xg.decode(e.FrDs):"auto"}})),animations:i.FSts.map((function(e){return{id:e.FsID,frames:e.FsFr,repeats:e.LCnt,activeFrame:e.AFrm||0}}))}}else if("Roll"===r){var o=ay(e,n());e.logDevFeatures&&e.log("#4000 Roll",o)}else e.logMissingFeatures&&e.log("Unhandled subsection in #4000",r)}))};r()>0;)n()}));else if("mopt"===n){var i=ay(e,r());e.logDevFeatures&&e.log("#4000 mopt",i)}else e.logMissingFeatures&&e.log("Unhandled key in #4000:",n)}),(function(e,t){t.animations&&(Tx(e,"mani"),Tx(e,"IRFR"),Ox(e,1,(function(){Tx(e,"8BIM"),Tx(e,"AnDs"),Ox(e,1,(function(){for(var r={FrIn:[],FSts:[]},n=0;n<t.animations.frames.length;n++){var i=t.animations.frames[n],o={FrID:i.id};i.delay&&(o.FrDl=100*i.delay|0),o.FrDs=Xg.encode(i.dispose),r.FrIn.push(o)}for(n=0;n<t.animations.animations.length;n++){var a=t.animations.animations[n],s={FsID:a.id,AFrm:0|a.activeFrame,FsFr:a.frames,LCnt:0|a.repeats};r.FSts.push(s)}Xv(e,"","null",r)}))})))}));var Hg=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},Gg=[0,1,3,2],jg=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"];function Yg(e){for(var t=e.width*e.height*4,r=0;r<t;r+=4)e.data[r+1]=e.data[r],e.data[r+2]=e.data[r]}function Wg(e,t,r){return{view:new DataView(e,t,r),offset:0,strict:!1,debug:!1,large:!1,globalAlpha:!1,log:console.log}}function qg(e,t){if(e.strict)throw new Error(t);e.debug&&e.log(t)}function Vg(e){return e.offset+=1,e.view.getUint8(e.offset-1)}function Kg(e){return e.view.getUint8(e.offset)}function Zg(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}function Jg(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}function Qg(e){return e.offset+=2,e.view.getUint16(e.offset-2,!0)}function $g(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}function ey(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)}function ty(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}function ry(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)}function ny(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}function iy(e){return $g(e)/65536}function oy(e){return $g(e)/(1<<24)}function ay(e,t){var r=e.view.byteOffset+e.offset;if(e.offset+=t,r+t>e.view.buffer.byteLength){if(qg(e,"Reading bytes exceeding buffer length"),t>104857600)throw new Error("Reading past end of file");var n=new Uint8Array(t),i=Math.min(t,e.view.byteLength-r);return i>0&&n.set(new Uint8Array(e.view.buffer,r,i)),n}return new Uint8Array(e.view.buffer,r,t)}function sy(e){return vy(e,4)}function ly(e,t){var r=String.fromCharCode(e.view.getUint8(t))+String.fromCharCode(e.view.getUint8(t+1))+String.fromCharCode(e.view.getUint8(t+2))+String.fromCharCode(e.view.getUint8(t+3));return"8BIM"==r||"8B64"==r}function cy(e,t){for(var r=Vg(e),n=r?vy(e,r):"";++r%t;)e.offset++;return n}function uy(e){return hy(e,ty(e))}function hy(e,t){for(var r="";t--;){var n=Jg(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}function dy(e,t){for(var r="";t--;)r+=String.fromCharCode(Vg(e));return r}function fy(e,t){e.offset+=t}function py(e,t,r){var n=e.offset,i=sy(e);if(i!==t&&i!==r)throw new Error("Invalid signature: '".concat(i,"' at 0x").concat(n.toString(16)))}function vy(e,t){for(var r=ay(e,t),n="",i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return n}function my(e){return"8BIM"===e||"MeSa"===e||"AgHg"===e||"PHUT"===e||"DCSR"===e}function gy(e,t){var r;void 0===t&&(t={}),py(e,"8BPS");var n=Jg(e);if(1!==n&&2!==n)throw new Error("Invalid PSD file version: ".concat(n));fy(e,6);var i=Jg(e),o=ty(e),a=ty(e),s=Jg(e),l=Jg(e),c=1===n?3e4:3e5;if(a>c||o>c)throw new Error("Invalid size: ".concat(a,"x").concat(o));if(i>16)throw new Error("Invalid channel count: ".concat(i));if(![1,8,16,32].includes(s))throw new Error("Invalid bitsPerChannel: ".concat(s));if(-1===Gg.indexOf(l))throw new Error("Color mode not supported: ".concat(null!==(r=jg[l])&&void 0!==r?r:l));var u={width:a,height:o,channels:i,bitsPerChannel:s,colorMode:l};Object.assign(e,t),e.large=2===n,e.globalAlpha=!1;var h=[0,1,-1,2,-2,3,-3,4,-4];Ry(e,1,(function(t){if(t()){if(2===l){if(768!=t())throw new Error("Invalid color palette size");u.palette=[];for(var r=0;r<256;r++)u.palette.push({r:Vg(e),g:0,b:0});for(r=0;r<256;r++)u.palette[r].g=Vg(e);for(r=0;r<256;r++)u.palette[r].b=Vg(e)}fy(e,t())}}));var d={};Ry(e,1,(function(t){for(var r=function(){for(var t=e.offset,r="",n=0,i=h;n<i.length;n++){var o=i[n];try{e.offset=t+o,r=sy(e)}catch(e){}if(my(r))break}if(!my(r))throw new Error("Invalid signature: '".concat(r,"' at 0x").concat(t.toString(16)));var a=Jg(e);cy(e,2),Ry(e,2,(function(t){var r=wg[a],n=1036===a&&!!e.skipThumbnail;if(r&&!n)try{r.read(e,d,t)}catch(r){if(e.throwForMissingFeatures)throw r;fy(e,t())}else fy(e,t())}))};t()>0;)r()}));var f=Hg(d,["layersGroup","layerGroupsEnabledId"]);Object.keys(f)&&(u.imageResources=f),Ry(e,1,(function(t){if(Ry(e,2,(function(t){yy(e,u,d),fy(e,t())}),void 0,e.large),t()>0){var r=function(e){return Ry(e,1,(function(t){if(t()){var r=Jg(e),n=Jg(e),i=Jg(e),o=Jg(e),a=Jg(e),s=Jg(e)/255,l=Vg(e);return fy(e,t()),{overlayColorSpace:r,colorSpace1:n,colorSpace2:i,colorSpace3:o,colorSpace4:a,opacity:s,kind:l}}}))}(e);r&&(u.globalLayerMaskInfo=r)}else fy(e,t());for(;t()>0;){for(;t()&&0===Kg(e);)fy(e,1);t()>=12?_y(e,u,u,d):fy(e,t())}}),void 0,e.large);var p=u.children&&u.children.length;return e.skipCompositeImageData&&(e.skipLayerImageData||p)||function(e,t){var r,n=Jg(e),i=null!==(r=t.bitsPerChannel)&&void 0!==r?r:8;if(-1===Gg.indexOf(t.colorMode))throw new Error("Color mode not supported: ".concat(t.colorMode));if(0!==n&&1!==n)throw new Error("Compression type not supported: ".concat(n));var o=Sy(t.width,t.height,i);switch(Zp(o),t.colorMode){case 0:if(1!==i)throw new Error("Invalid bitsPerChannel for bitmap color mode");var a=void 0;if(0===n)a=ay(e,Math.ceil(t.width/8)*t.height);else{if(1!==n)throw new Error("Bitmap compression not supported: ".concat(n));Ly(e,{data:a=new Uint8Array(t.width*t.height),width:t.width,height:t.height},t.width,t.height,8,1,[0],e.large)}!function(e,t,r,n){if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("Invalid bit depth");for(var i=0,o=0,a=0;i<n;i++)for(var s=0;s<r;)for(var l=e[a++],c=0;c<8&&s<r;c++,s++,o+=4){var u=128&l?0:255;l<<=1,t[o+0]=u,t[o+1]=u,t[o+2]=u,t[o+3]=255}}(a,o.data,t.width,t.height);break;case 3:case 1:var s=1===t.colorMode?[0]:[0,1,2];if(t.channels&&t.channels>3)for(var l=3;l<t.channels;l++)s.push(l);else e.globalAlpha&&s.push(3);if(0===n)for(l=0;l<s.length;l++)ky(e,o,t.width,t.height,i,4,s[l]);else 1===n&&(e.offset,Ly(e,o,t.width,t.height,i,4,s,e.large));1===t.colorMode&&Yg(o);break;case 2:if(8!==i)throw new Error("bitsPerChannel Not supproted");if(1!==t.channels)throw new Error("Invalid channel count");if(!t.palette)throw new Error("Missing color palette");if(0===n)throw new Error("Not implemented");if(1!==n)throw new Error("Not implemented");var c={width:o.width,height:o.height,data:new Uint8Array(o.width*o.height)};Ly(e,c,t.width,t.height,i,1,[0],e.large),function(e,t,r){for(var n=e.width*e.height,i=e.data,o=t.data,a=0,s=0;a<n;a++,s+=4){var l=r[i[a]];o[s+0]=l.r,o[s+1]=l.g,o[s+2]=l.b,o[s+3]=255}}(c,o,t.palette);break;case 4:if(8!==i)throw new Error("bitsPerChannel Not supproted");if(4!==t.channels)throw new Error("Invalid channel count");s=[0,1,2,3];if(e.globalAlpha&&s.push(4),0===n)throw new Error("Not implemented");if(1!==n)throw new Error("Not implemented");var u={width:o.width,height:o.height,data:new Uint8Array(o.width*o.height*5)};e.offset,Ly(e,u,t.width,t.height,i,5,s,e.large),Cy(u,o,!0);break;default:throw new Error("Color mode not supported: ".concat(t.colorMode))}if(e.globalAlpha){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");var h=o.data,d=o.width*o.height*4;for(l=0;l<d;l+=4){var f=h[l+3];if(0!=f&&255!=f){var p=1/(f/255),v=255*(1-p);h[l+0]=h[l+0]*p+v,h[l+1]=h[l+1]*p+v,h[l+2]=h[l+2]*p+v}}}e.useImageData?t.imageData=o:t.canvas=Jp(o)}(e,u),u}function yy(e,t,r){var n,i,o=r.layersGroup,a=void 0===o?[]:o,s=r.layerGroupsEnabledId,l=void 0===s?[]:s,c=Zg(e);c<0&&(e.globalAlpha=!0,c=-c);for(var u=[],h=[],d=0;d<c;d++){var f=by(e,t,r),p=f.layer,v=f.channels;void 0!==a[d]&&(p.linkGroup=a[d]),void 0!==l[d]&&(p.linkGroupEnabled=!!l[d]),u.push(p),h.push(v)}if(!e.skipLayerImageData)for(d=0;d<c;d++)wy(e,t,u[d],h[d]);t.children||(t.children=[]);var m=[t];for(d=u.length-1;d>=0;d--){var g=u[d],y=g.sectionDivider?g.sectionDivider.type:0;1===y||2===y?(g.opened=1===y,g.children=[],(null===(n=g.sectionDivider)||void 0===n?void 0:n.key)&&(g.blendMode=null!==(i=Up[g.sectionDivider.key])&&void 0!==i?i:g.blendMode),m[m.length-1].children.unshift(g),m.push(g)):3===y?m.pop():m[m.length-1].children.unshift(g)}}function by(e,t,r){var n={};n.top=$g(e),n.left=$g(e),n.bottom=$g(e),n.right=$g(e);for(var i=Jg(e),o=[],a=0;a<i;a++){var s=Zg(e),l=ty(e);if(e.large){if(0!==l)throw new Error("Sizes larger than 4GB are not supported");l=ty(e)}o.push({id:s,length:l})}py(e,"8BIM");var c=sy(e);if(!Up[c])throw new Error("Invalid blend mode: '".concat(c,"'"));n.blendMode=Up[c],n.opacity=Vg(e)/255,n.clipping=1===Vg(e);var u=Vg(e);return n.transparencyProtected=!!(1&u),n.hidden=!!(2&u),32&u&&(n.effectsOpen=!0),fy(e,1),Ry(e,1,(function(i){!function(e,t){Ry(e,1,(function(r){if(r()){var n={};t.mask=n,n.top=$g(e),n.left=$g(e),n.bottom=$g(e),n.right=$g(e),n.defaultColor=Vg(e);var i=Vg(e);if(n.positionRelativeToLayer=!!(1&i),n.disabled=!!(2&i),n.fromVectorData=!!(8&i),r()>=18){var o={};t.realMask=o;var a=Vg(e);o.positionRelativeToLayer=!!(1&a),o.disabled=!!(2&a),o.fromVectorData=!!(8&a),o.defaultColor=Vg(e),o.top=$g(e),o.left=$g(e),o.bottom=$g(e),o.right=$g(e)}if(16&i){var s=Vg(e);1&s&&(n.userMaskDensity=Vg(e)/255),2&s&&(n.userMaskFeather=ny(e)),4&s&&(n.vectorMaskDensity=Vg(e)/255),8&s&&(n.vectorMaskFeather=ny(e))}fy(e,r())}}))}(e,n);var o=function(e){return Ry(e,1,(function(t){for(var r=xy(e),n=xy(e),i=[];t()>0;){var o=xy(e),a=xy(e);i.push({sourceRange:o,destRange:a})}return{compositeGrayBlendSource:r,compositeGraphBlendDestinationRange:n,ranges:i}}))}(e);for(o&&(n.blendingRanges=o),n.name=cy(e,1);i()>4&&!ly(e,e.offset);)e.offset++;for(;i()>=12;)_y(e,n,t,r);fy(e,i())})),{layer:n,channels:o}}function xy(e){return[Vg(e),Vg(e),Vg(e),Vg(e)]}function wy(e,t,r,n){var i,o,a,s,l,c=(r.right||0)-(r.left||0),u=(r.bottom||0)-(r.top||0),h=4===t.colorMode;if(c&&u)if(h){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");l={width:c,height:u,data:new Uint8ClampedArray(c*u*5)};for(var d=4;d<l.data.byteLength;d+=5)l.data[d]=255}else Zp(l=Sy(c,u,null!==(i=t.bitsPerChannel)&&void 0!==i?i:8));for(var f=0,p=n;f<p.length;f++){var v=p[f];if(0!==v.length){if(v.length<2)throw new Error("Invalid channel length");var m=e.offset,g=Jg(e);if(g>3&&(e.offset-=1,g=Jg(e)),g>3&&(e.offset-=3,g=Jg(e)),g>3)throw new Error("Invalid compression: ".concat(g));if(-2===v.id||-3===v.id){var y=-2===v.id?r.mask:r.realMask;if(!y)throw new Error("Missing layer ".concat(-2===v.id?"mask":"real mask"," data"));var b=(y.right||0)-(y.left||0),x=(y.bottom||0)-(y.top||0);if(b<0||x<0||b>3e4||x>3e4)throw new Error("Invalid mask size");if(b&&x){var w=Sy(b,x,null!==(o=t.bitsPerChannel)&&void 0!==o?o:8);Zp(w),e.offset,Ey(e,v.length,w,g,b,x,null!==(a=t.bitsPerChannel)&&void 0!==a?a:8,0,e.large,4),Yg(w),e.useImageData?y.imageData=w:y.canvas=Jp(w)}}else{var E=Vp(v.id,h),_=l;if(E<0&&(_=void 0,e.throwForMissingFeatures))throw new Error("Channel not supported: ".concat(v.id));Ey(e,v.length,_,g,c,u,null!==(s=t.bitsPerChannel)&&void 0!==s?s:8,E,e.large,h?5:4),e.offset=m+v.length,_&&1===t.colorMode&&Yg(_)}}}if(l){if(h){var S=l;Cy(S,l=tv(S.width,S.height),!1)}e.useImageData?r.imageData=l:r.canvas=Jp(l)}}function Ey(e,t,r,n,i,o,a,s,l,c){if(0===n)ky(e,r,i,o,a,c,s);else if(1===n)Ly(e,r,i,o,a,c,[s],l);else if(2===n)Oy(e,t,r,i,o,a,c,s,!1);else{if(3!==n)throw new Error("Invalid Compression type: ".concat(n));Oy(e,t,r,i,o,a,c,s,!0)}}function _y(e,t,r,n){var i=sy(e);if("8BIM"!==i&&"8B64"!==i)throw new Error("Invalid signature: '".concat(i,"' at 0x").concat((e.offset-4).toString(16)));var o=sy(e),a="8B64"===i||e.large&&-1!==Wp.indexOf(o);Ry(e,2,(function(i){var a=Sb[o];if(a)try{a.read(e,t,i,r,n)}catch(t){if(e.throwForMissingFeatures)throw t}else e.logMissingFeatures&&e.log("Unhandled additional info: ".concat(o)),fy(e,i());i()&&(e.logMissingFeatures&&e.log("Unread ".concat(i()," bytes left for additional info: ").concat(o)),fy(e,i()))}),!1,a)}function Sy(e,t,r,n){if(void 0===n&&(n=4),1===r||8===r)return 4===n?tv(e,t):{width:e,height:t,data:new Uint8ClampedArray(e*t*n)};if(16===r)return{width:e,height:t,data:new Uint16Array(e*t*n)};if(32===r)return{width:e,height:t,data:new Float32Array(e*t*n)};throw new Error("Invalid bitDepth (".concat(r,")"))}function Cy(e,t,r){for(var n=t.width*t.height*4,i=e.data,o=t.data,a=0,s=0;s<n;a+=5,s+=4){var l=i[a],c=i[a+1],u=i[a+2],h=i[a+3];o[s]=(l*h|0)/255|0,o[s+1]=(c*h|0)/255|0,o[s+2]=(u*h|0)/255|0,o[s+3]=r?255-i[a+4]:i[a+4]}}function Ty(e,t){if(8===t)return e;if(16===t){if(e.byteOffset%2){var r=new Uint16Array(e.byteLength/2);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(e),r}return new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2)}if(32===t){if(e.byteOffset%4){r=new Float32Array(e.byteLength/4);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(e),r}return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}throw new Error("Invalid bitDepth (".concat(t,")"))}function Ay(e,t,r,n){!function(e,t){if(e.byteLength/e.length!=t.byteLength/t.length)throw new Error("Invalid array types")}(e.data,t);for(var i=e.width*e.height,o=e.data,a=0,s=0|r;a<i;a++,s=s+n|0)o[s]=t[a]}function ky(e,t,r,n,i,o,a){var s=ay(e,r*n*Math.floor(i/8));if(32==i)for(var l=0;l<s.byteLength;l+=4){var c=s[l+0],u=s[l+1],h=s[l+2],d=s[l+3];s[l+0]=d,s[l+1]=h,s[l+2]=u,s[l+3]=c}var f=Ty(s,i);t&&a<o&&Ay(t,f,a,o)}function My(e,t,r,n){for(var i=0;i<r;i++)for(var o=1,a=i*t+1;o<t;o++,a++)e[a]=(e[a-1]+e[a])%n}function Oy(e,t,r,n,i,o,a,s,l){var c=ay(e,t),u=Np(c);if(r&&s<a){var h=Ty(u,o);if(8===o)l&&My(u,n,i,256),Ay(r,u,s,a);else if(16===o)l&&My(h,n,i,65536),Ay(r,h,s,a);else{if(32!==o)throw new Error("Invalid bitDepth");l&&My(u,4*n,i,256);for(var d=s,f=new Uint32Array(r.data.buffer,r.data.byteOffset,r.data.length),p=0;p<i;p++)for(var v=4*n*p,m=0;m<n;m++,v++,d+=a){var g=v+n,y=g+n,b=y+n;f[d]=(u[v]<<24|u[g]<<16|u[y]<<8|u[b])>>>0}}}}function Ly(e,t,r,n,i,o,a,s){var l,c=t&&t.data;if(s){l=new Uint32Array(a.length*n);for(var u=0,h=0;u<a.length;u++)for(var d=0;d<n;d++,h++)l[h]=ty(e)}else{l=new Uint16Array(a.length*n);for(u=0,h=0;u<a.length;u++)for(d=0;d<n;d++,h++)l[h]=Jg(e)}if(1!==i&&8!==i)throw new Error("Invalid bit depth (".concat(i,")"));var f=o-1|0,p=0;for(h=0;p<a.length;p++){var v=0|a[p];if(!c||(p>f||v>f))for(d=0;d<n;d++,h++)fy(e,l[h]);else{d=0;for(var m=0|v;d<n;d++,h++)for(var g=l[h],y=ay(e,g),b=0,x=0;b<g;b++){var w=y[b];if(w>128){var E=y[++b];w=256-w|0;for(var _=0;_<=w&&x<r;_=_+1|0,x=x+1|0)c[m]=E,m=m+o|0}else if(w<128)for(_=0;_<=w&&x<r;_=_+1|0,x=x+1|0)c[m]=y[++b],m=m+o|0}}}}function Ry(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!1);var o=ty(e);if(i){if(0!==o)throw new Error("Sizes larger than 4GB are not supported");o=ty(e)}if(!(o<=0&&n)){var a=e.offset+o;if(a>e.view.byteLength)throw new Error("Section exceeds file size");var s=r((function(){return a-e.offset}));for(e.offset!==a&&(e.offset>a?qg(e,"Exceeded section limits"):qg(e,"Unread section data"));a%t;)a++;return e.offset=a,s}}function Iy(e){switch(Jg(e)){case 0:var t=Jg(e)/257,r=Jg(e)/257,n=Jg(e)/257;return fy(e,2),{r:t,g:r,b:n};case 1:var i=Jg(e)/65535,o=Jg(e)/65535;n=Jg(e)/65535;return fy(e,2),{h:i,s:o,b:n};case 2:return{c:Jg(e)/257,m:Jg(e)/257,y:Jg(e)/257,k:u=Jg(e)/257};case 7:var a=Zg(e)/1e4,s=Zg(e),l=Zg(e),c=s<0?s/12800:s/12700;n=l<0?l/12800:l/12700;return fy(e,2),{l:a,a:c,b:n};case 8:var u=255*Jg(e)/1e4;return fy(e,6),{k:u};default:throw new Error("Invalid color space")}}var Py=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function Fy(e){return py(e,"8BIM"),Up[sy(e)]||"normal"}function Dy(e,t){Tx(e,"8BIM"),Tx(e,Bp[t]||"norm")}function Ny(e){return Vg(e)/255}function By(e,t){fx(e,0|Math.round(255*t))}function Uy(e,t){var r;bx(e,51),bx(e,2),Ex(e,t.size&&t.size.value||0),Ex(e,0),Ex(e,t.angle||0),Ex(e,t.distance&&t.distance.value||0),Ix(e,t.color),Dy(e,t.blendMode),fx(e,t.enabled?1:0),fx(e,t.useGlobalLight?1:0),By(e,null!==(r=t.opacity)&&void 0!==r?r:1),Ix(e,t.color)}function zy(e){return 32===e||10===e||13===e||9===e}function Xy(e){return e>=48&&e<=57||46===e||45===e}function Hy(e){var t=0;function r(){for(;t<e.length&&zy(e[t]);)t++}function n(){var r=e[t];return t++,92===r&&(r=e[t],t++),r}function i(){var r="";if(41===e[t])return t++,r;if(254!==e[t]||255!==e[t+1])throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&41!==e[t];){var i=n()<<8|n();r+=String.fromCharCode(i)}return t++,r}var o=null,a=[];function s(e){a.length?(l(e),a.push(e)):(a.push(e),o=e)}function l(e){if(!a.length)throw new Error("Invalid data");var t=a[a.length-1];if("string"==typeof t)a[a.length-2][t]=e,u();else{if(!Array.isArray(t))throw new Error("Invalid data");t.push(e)}}function c(e){a.length||s({});var t=a[a.length-1];if(t&&"string"==typeof t)l("nil"===e?null:"/".concat(e));else{if(!t||"object"!=typeof t)throw new Error("Invalid data");a.push(e)}}function u(){if(!a.length)throw new Error("Invalid data");a.pop()}for(r();t<e.length;){var h=t,d=e[h];if(60===d&&60===e[h+1])t+=2,s({});else if(62===d&&62===e[h+1])t+=2,u();else if(47===d){for(var f=t+=1;t<e.length&&!zy(e[t]);)t++;for(var p="",v=f;v<t;v++)p+=String.fromCharCode(e[v]);c(p)}else if(40===d)t+=1,l(i());else if(91===d)t+=1,s([]);else if(93===d)t+=1,u();else if(110===d&&117===e[h+1]&&108===e[h+2]&&108===e[h+3])t+=4,l(null);else if(116===d&&114===e[h+1]&&117===e[h+2]&&101===e[h+3])t+=4,l(!0);else if(102===d&&97===e[h+1]&&108===e[h+2]&&115===e[h+3]&&101===e[h+4])t+=5,l(!1);else if(Xy(d)){for(var m="";t<e.length&&Xy(e[t]);)m+=String.fromCharCode(e[t]),t++;l(parseFloat(m))}else t+=1,console.log("Invalid token ".concat(String.fromCharCode(d)," at ").concat(t));r()}return o}var Gy=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth","AutoLeading"],jy=["RunLengthArray"];function Yy(e,t){void 0===t&&(t=!1);var r=new Uint8Array(1024),n=0,i=0;function o(e){if(n>=r.length){var t=new Uint8Array(2*r.length);t.set(r),r=t}r[n]=e,n++}function a(e){for(var t=0;t<e.length;t++)o(e.charCodeAt(t))}function s(){if(t)a(" ");else for(var e=0;e<i;e++)a("\t")}function l(e,r){s(),a("/".concat(e)),f(r,e,!0),t||a("\n")}function c(e){return e.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function u(e,t){return t&&-1!==Gy.indexOf(t)||(0|e)!==e?c(e):function(e){return e.toString()}(e)}function h(e){var t=Object.keys(e);return-1!==t.indexOf("98")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),-1!==t.indexOf("99")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),t}function d(e){40!==e&&41!==e&&92!==e||o(92),o(e)}function f(e,r,n){function p(){n?a(" "):s()}if(void 0===n&&(n=!1),null===e)p(),a(t?"/nil":"null");else if("number"==typeof e)p(),a(u(e,r));else if("boolean"==typeof e)p(),a(e?"true":"false");else if("string"==typeof e)if(p(),"99"!==r&&"98"!==r||"/"!==e.charAt(0)){a("("),o(254),o(255);for(var v=0;v<e.length;v++){var m=e.charCodeAt(v);d(m>>8&255),d(255&m)}a(")")}else a(e);else if(Array.isArray(e))if(p(),e.every((function(e){return"number"==typeof e}))){a("[");for(var g=-1!==jy.indexOf(r),y=0,b=e;y<b.length;y++){var x=b[y];a(" "),a(g?u(x):c(x))}a(" ]")}else{a("["),t||a("\n");for(var w=0,E=e;w<E.length;w++){f(x=E[w],r),t||a("\n")}s(),a("]")}else if("object"==typeof e){n&&!t&&a("\n"),s(),a("<<"),t||a("\n"),i++;for(var _=0,S=h(e);_<S.length;_++){var C=S[_];l(C,e[C])}i--,s(),a(">>")}}if(t){if("object"==typeof e)for(var p=0,v=h(e);p<v.length;p++){var m=v[p];l(m,e[m])}}else a("\n\n"),f(e);return r.slice(0,n)}var Wy=function(){return Wy=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Wy.apply(this,arguments)},qy={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},Vy={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},Ky={font:qy,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},Zy={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},Jy=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],Qy=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],$y=["none","crisp","strong","smooth","sharp"],eb=["left","right","center","justify-left","justify-right","justify-center","justify-all"];function tb(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function rb(e){var t=e.Values;switch(e.Type){case 0:return{k:255*t[1]};case 1:return 1===t[0]?{r:255*t[1],g:255*t[2],b:255*t[3]}:{r:255*t[1],g:255*t[2],b:255*t[3],a:255*t[0]};case 2:return{c:255*t[1],m:255*t[2],y:255*t[3],k:255*t[4]};default:throw new Error("Unknown color type in text layer")}}function nb(e){if(e){if("r"in e)return{Type:1,Values:["a"in e?e.a/255:1,e.r/255,e.g/255,e.b/255]};if("c"in e)return{Type:2,Values:[1,e.c/255,e.m/255,e.y/255,e.k/255]};if("k"in e)return{Type:0,Values:[1,e.k/255]};throw new Error("Invalid color type in text layer")}return{Type:1,Values:[0,0,0,0]}}function ib(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ob(e,t){if(!e||!t)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){if(e[a=n[r]]!==t[a])return!1}for(var i=0,o=Object.keys(t);i<o.length;i++){var a;if(e[a=o[i]]!==t[a])return!1}return!0}function ab(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t.name)return r;return e.push(t),e.length-1}function sb(e,t,r){for(var n={},i=0,o=t;i<o.length;i++){var a=o[i],s=tb(a);void 0!==e[s]&&(n[a]="justification"===a?eb[e[s]]:"font"===a?r[e[s]]:"fillColor"===a||"strokeColor"===a?rb(e[s]):e[s])}return n}function lb(e,t,r){for(var n,i={},o=0,a=t;o<a.length;o++){var s=a[o],l=tb(s);void 0!==e[s]&&(i[l]="justification"===s?eb.indexOf(null!==(n=e[s])&&void 0!==n?n:"left"):"font"===s?ab(r,e[s]):"fillColor"===s||"strokeColor"===s?nb(e[s]):e[s])}return i}function cb(e,t){return sb(e,Jy,t)}function ub(e,t){return sb(e,Qy,t)}function hb(e,t){return lb(e,Jy,t)}function db(e,t){return lb(e,Qy,t)}function fb(e,t,r){if(t.length){for(var n=function(r){var n=t[0].style[r];if(void 0!==n){var i=!1;i=Array.isArray(n)?t.every((function(e){return ib(e.style[r],n)})):"object"==typeof n?t.every((function(e){return ob(e.style[r],n)})):t.every((function(e){return e.style[r]===n})),i&&(e[r]=n)}if(void 0!==e[r])for(var o=0,a=t;o<a.length;o++){var s=a[o];(Array.isArray(n)?ib(s.style[r],n):"object"==typeof n?ob(s.style[r],n):s.style[r]===n)&&delete s.style[r]}},i=0,o=r;i<o.length;i++){n(o[i])}t.every((function(e){return 0===Object.keys(e.style).length}))&&(t.length=0)}}function pb(e){var t,r,n,i,o,a,s,l,c,u,h,d,f="".concat((e.text||"").replace(/\r?\n/g,"\r"),"\r"),p=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],v=(null===(t=e.style)||void 0===t?void 0:t.font)||(null===(n=null===(r=e.styleRuns)||void 0===r?void 0:r.find((function(e){return e.style.font})))||void 0===n?void 0:n.style.font)||qy,m=[],g=[],y=e.paragraphStyleRuns;if(y&&y.length){for(var b=f.length,x=0,w=y;x<w.length;x++){var E=w[x];b-=R=Math.min(E.length,b),R&&(1===b&&E===y[y.length-1]&&(R++,b--),g.push(R),m.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:hb(Wy(Wy(Wy({},Vy),e.paragraphStyle),E.style),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}b&&(g.push(b),m.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:hb(Wy(Wy({},Vy),e.paragraphStyle),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}else for(var _=0,S=0;_<f.length;_++)13===f.charCodeAt(_)&&(g.push(_-S+1),m.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:hb(Wy(Wy({},Vy),e.paragraphStyle),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),S=_+1);for(var C=db(Wy(Wy({},Ky),{font:v}),p),T=e.styleRuns||[{length:f.length,style:e.style||{}}],A=[],k=[],M=f.length,O=0,L=T;O<L.length;O++){var R,I=L[O];M-=R=Math.min(I.length,M),R&&(1===M&&I===T[T.length-1]&&(R++,M--),k.push(R),A.push({StyleSheet:{StyleSheetData:db(Wy(Wy({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),I.style),p)}}))}M&&T.length&&(k.push(M),A.push({StyleSheet:{StyleSheetData:db(Wy({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),p)}}));var P=Wy(Wy({},Zy),e.gridInfo),F="vertical"===e.orientation?2:0,D="vertical"===e.orientation?1:0,N="box"===e.shapeType?1:0,B={ShapeType:N};0===N?B.PointBase=e.pointBase||[0,0]:B.BoxBounds=e.boxBounds||[0,0,0,0],B.Base={ShapeType:N,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var U={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"、。，．・：；？！ー―’”）〕］｝〉》」』】ヽヾゝゞ々ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ゛゜?!)]},.:;℃℉¢％‰",NoEnd:"‘“（〔［｛〈《「『【([{￥＄£＠§〒＃",Keep:"―‥",Hanging:"、。.,"},{Name:"PhotoshopKinsokuSoft",NoStart:"、。，．・：；？！’”）〕］｝〉》」』】ヽヾゝゞ々",NoEnd:"‘“（〔［｛〈《「『【",Keep:"―‥",Hanging:"、。.,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:hb(Wy(Wy({},Vy),e.paragraphStyle),p)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:C}],FontSet:p.map((function(e){return{Name:e.name,Script:e.script||0,FontType:e.type||0,Synthetic:e.synthetic||0}})),SuperscriptSize:null!==(i=e.superscriptSize)&&void 0!==i?i:.583,SuperscriptPosition:null!==(o=e.superscriptPosition)&&void 0!==o?o:.333,SubscriptSize:null!==(a=e.subscriptSize)&&void 0!==a?a:.583,SubscriptPosition:null!==(s=e.subscriptPosition)&&void 0!==s?s:.333,SmallCapSize:null!==(l=e.smallCapSize)&&void 0!==l?l:.7};return{EngineDict:{Editor:{Text:f},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:m,RunLengthArray:g,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:A,RunLengthArray:k,IsJoinable:2},GridInfo:{GridIsOn:!!P.isOn,ShowGrid:!!P.show,GridSize:null!==(c=P.size)&&void 0!==c?c:18,GridLeading:null!==(u=P.leading)&&void 0!==u?u:22,GridColor:nb(P.color),GridLeadingFillColor:nb(P.color),AlignLineHeightToGridFlags:!!P.alignLineHeightToGridFlags},AntiAlias:$y.indexOf(null!==(h=e.antiAlias)&&void 0!==h?h:"sharp"),UseFractionalGlyphWidths:null===(d=e.useFractionalGlyphWidths)||void 0===d||d,Rendered:{Version:1,Shapes:{WritingDirection:F,Children:[{ShapeType:N,Procession:D,Lines:{WritingDirection:F,Children:[]},Cookie:{Photoshop:B}}]}}},ResourceDict:Wy({},U),DocumentResources:Wy({},U)}}var vb={0:{uproot:!0,children:{0:{name:"Type"},1:{name:"Values"}}}},mb={0:{name:"Font"},1:{name:"FontSize"},2:{name:"FauxBold"},3:{name:"FauxItalic"},4:{name:"AutoLeading"},5:{name:"Leading"},6:{name:"HorizontalScale"},7:{name:"VerticalScale"},8:{name:"Tracking"},9:{name:"BaselineShift"},11:{name:"Kerning?"},12:{name:"FontCaps"},13:{name:"FontBaseline"},15:{name:"Strikethrough?"},16:{name:"Underline?"},18:{name:"Ligatures"},19:{name:"DLigatures"},23:{name:"Fractions"},24:{name:"Ordinals"},28:{name:"StylisticAlternates"},30:{name:"OldStyle?"},35:{name:"BaselineDirection"},38:{name:"Language"},52:{name:"NoBreak"},53:{name:"FillColor",children:vb},54:{name:"StrokeColor",children:vb},55:{children:{99:{uproot:!0}}},79:{children:vb}},gb={0:{name:"Justification"},1:{name:"FirstLineIndent"},2:{name:"StartIndent"},3:{name:"EndIndent"},4:{name:"SpaceBefore"},5:{name:"SpaceAfter"},7:{name:"AutoLeading"},9:{name:"AutoHyphenate"},10:{name:"HyphenatedWordSize"},11:{name:"PreHyphen"},12:{name:"PostHyphen"},13:{name:"ConsecutiveHyphens?"},14:{name:"Zone"},15:{name:"HypenateCapitalizedWords"},17:{name:"WordSpacing"},18:{name:"LetterSpacing"},19:{name:"GlyphSpacing"},32:{name:"StyleSheet",children:mb}},yb={name:"StyleSheetData",children:mb},bb={0:{name:"ResourceDict",children:{1:{name:"FontSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},2:{name:"FontType"}}}}}}}}},2:{name:"2",children:{}},3:{name:"MojiKumiSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"InternalName"}}}}}}},4:{name:"KinsokuSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{uproot:!0,children:{0:{name:"NoStart"},1:{name:"NoEnd"},2:{name:"Keep"},3:{name:"Hanging"},4:{name:"Name"}}}}}}}}},5:{name:"StyleSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},6:yb}}}}}},6:{name:"ParagraphSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{name:"Properties",children:gb},6:{name:"DefaultStyleSheet"}}}}}}},8:{name:"TextFrameSet",children:{0:{uproot:!0,children:{0:{name:"path",children:{0:{name:"name"},1:{name:"bezierCurve",children:{0:{name:"controlPoints"}}},2:{name:"data",children:{0:{name:"type"},1:{name:"orientation"},2:{name:"frameMatrix"},4:{name:"4"},6:{name:"textRange"},7:{name:"rowGutter"},8:{name:"columnGutter"},9:{name:"9"},10:{name:"baselineAlignment",children:{0:{name:"flag"},1:{name:"min"}}},11:{name:"pathData",children:{1:{name:"1"},0:{name:"reversed"},2:{name:"2"},3:{name:"3"},4:{name:"spacing"},5:{name:"5"},6:{name:"6"},7:{name:"7"},18:{name:"18"}}},12:{name:"12"},13:{name:"13"}}},3:{name:"3"},97:{name:"uuid"}}}}}}},9:{name:"Predefined",children:{0:{children:{0:{uproot:!0}}},1:{children:{0:{uproot:!0}}}}}}},1:{name:"EngineDict",children:{0:{name:"0",children:{3:{name:"SuperscriptSize"},4:{name:"SuperscriptPosition"},5:{name:"SubscriptSize"},6:{name:"SubscriptPosition"},7:{name:"SmallCapSize"},8:{name:"UseFractionalGlyphWidths"},15:{children:{0:{uproot:!0}}}}},1:{name:"Editors?",children:{0:{name:"Editor",children:{0:{name:"Text"},5:{name:"ParagraphRun",children:{0:{name:"RunArray",children:{0:{name:"ParagraphSheet",children:{0:{uproot:!0,children:{0:{name:"0"},5:{name:"5",children:gb},6:{name:"6"}}}}},1:{name:"RunLength"}}}}},6:{name:"StyleRun",children:{0:{name:"RunArray",children:{0:{name:"StyleSheet",children:{0:{uproot:!0,children:{6:yb}}}},1:{name:"RunLength"}}}}}}},1:{name:"FontVectorData ???"}}},2:{name:"StyleSheet",children:mb},3:{name:"ParagraphSheet",children:gb}}}};function xb(e,t){var r,n;if(null===e)return e;if(Array.isArray(e))return e.map((function(e){return xb(e,t)}));if("object"!=typeof e)return e;for(var i={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(t[s]){if(t[s].uproot){"99"!==s&&(i=xb(e[s],null!==(r=t[s].children)&&void 0!==r?r:{})),e[99]&&(i._type=e[99]);break}i[t[s].name||s]=xb(e[s],null!==(n=t[s].children)&&void 0!==n?n:{})}else"99"===s?i._type=e[s]:i[s]=xb(e[s],{})}return i}function wb(e){return xb(e,bb)}var Eb=function(){return Eb=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Eb.apply(this,arguments)},_b="abcdefghijklmnopqrstuvwxyz",Sb={};function Cb(e,t,r,n){var i={key:e,has:t,read:r,write:n};Sb[i.key]=i}function Tb(e,t){Sb[e]=Sb[t]}function Ab(e){return function(t){return void 0!==t[e]}}function kb(e){if(ty(e))throw new Error("Resource size above 4 GB limit at ".concat(e.offset.toString(16)));return ty(e)}function Mb(e,t){bx(e,0),bx(e,t)}function Ob(e,t,r){var n=oy(e)*r,i=oy(e)*t,o=oy(e)*r,a=oy(e)*t,s=oy(e)*r;return[i,n,a,o,oy(e)*t,s]}function Lb(e,t,r,n){_x(e,t[1]/n),_x(e,t[0]/r),_x(e,t[3]/n),_x(e,t[2]/r),_x(e,t[5]/n),_x(e,t[4]/r)}Cb("TySh",Ab("text"),(function(e,t,r){if(1!==Zg(e))throw new Error("Invalid TySh version");for(var n=[],i=0;i<6;i++)n.push(ny(e));if(50!==Zg(e))throw new Error("Invalid TySh text version");var o=zv(e);if(1!==Zg(e))throw new Error("Invalid TySh warp version");var a=zv(e);if(t.text={transform:n,left:ry(e),top:ry(e),right:ry(e),bottom:ry(e),text:o["Txt "].replace(/\r/g,"\n"),index:o.TextIndex||0,gridding:Em.decode(o.textGridding),antiAlias:Sm.decode(o.AntA),orientation:_m.decode(o.Ornt),warp:{style:Cm.decode(a.warpStyle),value:a.warpValue||0,perspective:a.warpPerspective||0,perspectiveOther:a.warpPerspectiveOther||0,rotate:_m.decode(a.warpRotate)}},o.bounds&&(t.text.bounds=jv(o.bounds)),o.boundingBox&&(t.text.boundingBox=jv(o.boundingBox)),o.EngineData){var s=function(e){for(var t,r,n,i,o,a,s=e.EngineDict,l=e.ResourceDict,c=l.FontSet.map((function(e){return{name:e.Name,script:e.Script,type:e.FontType,synthetic:e.Synthetic}})),u=s.Editor.Text.replace(/\r/g,"\n"),h=0;/\n$/.test(u);)u=u.substring(0,u.length-1),h++;var d={text:u,antiAlias:null!==(t=$y[s.AntiAlias])&&void 0!==t?t:"smooth",useFractionalGlyphWidths:!!s.UseFractionalGlyphWidths,superscriptSize:l.SuperscriptSize,superscriptPosition:l.SuperscriptPosition,subscriptSize:l.SubscriptSize,subscriptPosition:l.SubscriptPosition,smallCapSize:l.SmallCapSize},f=null===(a=null===(o=null===(i=null===(n=null===(r=s.Rendered)||void 0===r?void 0:r.Shapes)||void 0===n?void 0:n.Children)||void 0===i?void 0:i[0])||void 0===o?void 0:o.Cookie)||void 0===a?void 0:a.Photoshop;f&&(d.shapeType=1===f.ShapeType?"box":"point",f.PointBase&&(d.pointBase=f.PointBase),f.BoxBounds&&(d.boxBounds=f.BoxBounds));var p=s.ParagraphRun;d.paragraphStyle={},d.paragraphStyleRuns=[];for(var v=0;v<p.RunArray.length;v++){var m=p.RunArray[v],g=p.RunLengthArray[v],y=cb(m.ParagraphSheet.Properties,c);d.paragraphStyleRuns.push({length:g,style:y})}for(var b=h;d.paragraphStyleRuns.length&&b>0;b--)0==--d.paragraphStyleRuns[d.paragraphStyleRuns.length-1].length&&d.paragraphStyleRuns.pop();fb(d.paragraphStyle,d.paragraphStyleRuns,Jy),d.paragraphStyleRuns.length||delete d.paragraphStyleRuns;var x=s.StyleRun;for(d.style={},d.styleRuns=[],v=0;v<x.RunArray.length;v++){var w=x.RunLengthArray[v];(y=ub(x.RunArray[v].StyleSheet.StyleSheetData,c)).font||(y.font=c[0]),d.styleRuns.push({length:w,style:y})}for(b=h;d.styleRuns.length&&b>0;b--)0==--d.styleRuns[d.styleRuns.length-1].length&&d.styleRuns.pop();return fb(d.style,d.styleRuns,Qy),d.styleRuns.length||delete d.styleRuns,d}(Hy(o.EngineData));t.text=Eb(Eb({},t.text),s)}fy(e,r())}),(function(e,t){var r=t.text,n=r.warp||{},i=r.transform||[1,0,0,1,0,0],o=Eb(Eb(Eb({"Txt ":(r.text||"").replace(/\r?\n/g,"\r"),textGridding:Em.encode(r.gridding),Ornt:_m.encode(r.orientation),AntA:Sm.encode(r.antiAlias)},r.bounds?{bounds:Yv(r.bounds)}:{}),r.boundingBox?{boundingBox:Yv(r.boundingBox)}:{}),{TextIndex:r.index||0,EngineData:Yy(pb(r))});px(e,1);for(var a=0;a<6;a++)wx(e,i[a]);px(e,50),Xv(e,"","TxLr",o,"text"),px(e,1),Xv(e,"","warp",Db(n)),xx(e,r.left),xx(e,r.top),xx(e,r.right),xx(e,r.bottom)})),Cb("SoCo",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"color"===e.vectorFill.type}),(function(e,t){var r=zv(e);t.vectorFill=am(r)}),(function(e,t){Xv(e,"","null",cm(t.vectorFill).descriptor)})),Cb("GdFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&("solid"===e.vectorFill.type||"noise"===e.vectorFill.type)}),(function(e,t,r){var n=zv(e);t.vectorFill=am(n),fy(e,r())}),(function(e,t){Xv(e,"","null",cm(t.vectorFill).descriptor)})),Cb("PtFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"pattern"===e.vectorFill.type}),(function(e,t){var r=zv(e);t.vectorFill=am(r)}),(function(e,t){Xv(e,"","null",cm(t.vectorFill).descriptor)})),Cb("vscg",(function(e){return void 0!==e.vectorFill&&void 0!==e.vectorStroke}),(function(e,t,r){sy(e);var n=zv(e);t.vectorFill=am(n),fy(e,r())}),(function(e,t){var r=cm(t.vectorFill),n=r.descriptor;Tx(e,r.key),Xv(e,"","null",n)}));var Rb=["exclude","combine","subtract","intersect"];Cb("vmsk",Ab("vectorMask"),(function(e,t,r,n){var i=n.width,o=n.height;if(3!==ty(e))throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var a=t.vectorMask,s=ty(e);a.invert=!!(1&s),a.notLink=!!(2&s),a.disable=!!(4&s),function(e,t,r,n,i){for(var o=e.offset+i,a=t.paths,s=void 0;o-e.offset>=26;){var l=Jg(e);switch(l){case 0:case 3:Jg(e);var c=Zg(e),u=Jg(e);fy(e,18),s={open:3===l,knots:[],fillRule:2===u?"non-zero":"even-odd"},-1!==c&&(s.operation=Rb[c]),a.push(s);break;case 1:case 2:case 4:case 5:s.knots.push({linked:1===l||4===l,points:Ob(e,r,n)});break;case 6:fy(e,24);break;case 7:var h=oy(e),d=oy(e),f=oy(e),p=oy(e),v=oy(e);fy(e,4),t.clipboard={top:h,left:d,bottom:f,right:p,resolution:v};break;case 8:t.fillStartsWithAllPixels=!!Jg(e),fy(e,22);break;default:throw new Error("Invalid vmsk section")}}}(e,a,i,o,r()),fy(e,r())}),(function(e,t,r){var n=r.width,i=r.height,o=t.vectorMask,a=(o.invert?1:0)|(o.notLink?2:0)|(o.disable?4:0);bx(e,3),bx(e,a),vx(e,6),Cx(e,24);var s=o.clipboard;s&&(vx(e,7),_x(e,s.top),_x(e,s.left),_x(e,s.bottom),_x(e,s.right),_x(e,s.resolution),Cx(e,4)),void 0!==o.fillStartsWithAllPixels&&(vx(e,8),vx(e,o.fillStartsWithAllPixels?1:0),Cx(e,22));for(var l=0,c=o.paths;l<c.length;l++){var u=c[l];vx(e,u.open?3:0),vx(e,u.knots.length),vx(e,u.operation?Rb.indexOf(u.operation):-1),vx(e,"non-zero"===u.fillRule?2:1),Cx(e,18);for(var h=u.open?4:1,d=u.open?5:2,f=0,p=u.knots;f<p.length;f++){var v=p[f],m=v.linked,g=v.points;vx(e,m?h:d),Lb(e,g,n,i)}}})),Tb("vsms","vmsk"),Cb("vowv",Ab("vowv"),(function(e,t){t.vowv=ty(e)}),(function(e,t){bx(e,t.vowv)})),Cb("vogk",Ab("vectorOrigination"),(function(e,t,r){if(1!==$g(e))throw new Error("Invalid vogk version");var n=zv(e);t.vectorOrigination={keyDescriptorList:[]};for(var i=0,o=n.keyDescriptorList;i<o.length;i++){var a=o[i],s={};null!=a.keyShapeInvalidated&&(s.keyShapeInvalidated=a.keyShapeInvalidated),null!=a.keyOriginType&&(s.keyOriginType=a.keyOriginType),null!=a.keyOriginResolution&&(s.keyOriginResolution=a.keyOriginResolution),a.keyOriginShapeBBox&&(s.keyOriginShapeBoundingBox={top:mm(a.keyOriginShapeBBox["Top "]),left:mm(a.keyOriginShapeBBox.Left),bottom:mm(a.keyOriginShapeBBox.Btom),right:mm(a.keyOriginShapeBBox.Rght)});var l=a.keyOriginRRectRadii;l&&(s.keyOriginRRectRadii={topRight:vm(l.topRight),topLeft:vm(l.topLeft),bottomLeft:vm(l.bottomLeft),bottomRight:vm(l.bottomRight)});var c=a.keyOriginBoxCorners;c&&(s.keyOriginBoxCorners=[{x:c.rectangleCornerA.Hrzn,y:c.rectangleCornerA.Vrtc},{x:c.rectangleCornerB.Hrzn,y:c.rectangleCornerB.Vrtc},{x:c.rectangleCornerC.Hrzn,y:c.rectangleCornerC.Vrtc},{x:c.rectangleCornerD.Hrzn,y:c.rectangleCornerD.Vrtc}]);var u=a.Trnf;u&&(s.transform=[u.xx,u.xy,u.xy,u.yy,u.tx,u.ty]),t.vectorOrigination.keyDescriptorList.push(s)}fy(e,r())}),(function(e,t){for(var r=t.vectorOrigination,n={keyDescriptorList:[]},i=0;i<r.keyDescriptorList.length;i++){var o=r.keyDescriptorList[i];n.keyDescriptorList.push({});var a=n.keyDescriptorList[n.keyDescriptorList.length-1];null!=o.keyOriginType&&(a.keyOriginType=o.keyOriginType),null!=o.keyOriginResolution&&(a.keyOriginResolution=o.keyOriginResolution);var s=o.keyOriginRRectRadii;s&&(a.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:xm(s.topRight,"topRight"),topLeft:xm(s.topLeft,"topLeft"),bottomLeft:xm(s.bottomLeft,"bottomLeft"),bottomRight:xm(s.bottomRight,"bottomRight")});var l=o.keyOriginShapeBoundingBox;l&&(a.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":xm(l.top,"top"),Left:xm(l.left,"left"),Btom:xm(l.bottom,"bottom"),Rght:xm(l.right,"right")});var c=o.keyOriginBoxCorners;c&&4===c.length&&(a.keyOriginBoxCorners={rectangleCornerA:{Hrzn:c[0].x,Vrtc:c[0].y},rectangleCornerB:{Hrzn:c[1].x,Vrtc:c[1].y},rectangleCornerC:{Hrzn:c[2].x,Vrtc:c[2].y},rectangleCornerD:{Hrzn:c[3].x,Vrtc:c[3].y}});var u=o.transform;u&&6===u.length&&(a.Trnf={xx:u[0],xy:u[1],yx:u[2],yy:u[3],tx:u[4],ty:u[5]}),null!=o.keyShapeInvalidated&&(a.keyShapeInvalidated=o.keyShapeInvalidated),a.keyOriginIndex=i}gx(e,1),Xv(e,"","null",n)})),Cb("lmfx",(function(e){return void 0!==e.effects&&dx(e.effects)}),(function(e,t,r){if(0!==ty(e))throw new Error("Invalid lmfx version");var n=zv(e);t.effects=Kv(n,!!e.logMissingFeatures),fy(e,r())}),(function(e,t,r,n){var i=Vv(t.effects,!!n.logMissingFeatures,!0);bx(e,0),Xv(e,"","null",i)})),Cb("lrFX",Ab("effects"),(function(e,t,r){t.effects||(t.effects=function(e){var t=Jg(e);if(0!==t)throw new Error("Invalid effects layer version: ".concat(t));for(var r=Jg(e),n={},i=0;i<r;i++){py(e,"8BIM");var o=sy(e);switch(o){case"cmnS":var a=ty(e),s=ty(e),l=!!Vg(e);if(fy(e,2),7!==a||0!==s||!l)throw new Error("Invalid effects common state");break;case"dsdw":case"isdw":var c=ty(e),u=ty(e);if(41!==c&&51!==c)throw new Error("Invalid shadow size: ".concat(c));if(0!==u&&2!==u)throw new Error("Invalid shadow version: ".concat(u));a=iy(e),iy(e);var h=iy(e),d=iy(e),f=Iy(e),p=Fy(e),v=!!Vg(e),m=!!Vg(e),g=Ny(e);c>=51&&Iy(e);var y={size:{units:"Pixels",value:a},distance:{units:"Pixels",value:d},angle:h,color:f,blendMode:p,enabled:v,useGlobalLight:m,opacity:g};"dsdw"===o?n.dropShadow=[y]:n.innerShadow=[y];break;case"oglw":c=ty(e);var b=ty(e);if(32!==c&&42!==c)throw new Error("Invalid outer glow size: ".concat(c));if(0!==b&&2!==b)throw new Error("Invalid outer glow version: ".concat(b));a=iy(e),iy(e),f=Iy(e),p=Fy(e),v=!!Vg(e),g=Ny(e),c>=42&&Iy(e),n.outerGlow={size:{units:"Pixels",value:a},color:f,blendMode:p,enabled:v,opacity:g};break;case"iglw":c=ty(e);var x=ty(e);if(32!==c&&43!==c)throw new Error("Invalid inner glow size: ".concat(c));if(0!==x&&2!==x)throw new Error("Invalid inner glow version: ".concat(x));a=iy(e),iy(e),f=Iy(e),p=Fy(e),v=!!Vg(e),g=Ny(e),c>=43&&(Vg(e),Iy(e)),n.innerGlow={size:{units:"Pixels",value:a},color:f,blendMode:p,enabled:v,opacity:g};break;case"bevl":c=ty(e);var w=ty(e);if(58!==c&&78!==c)throw new Error("Invalid bevel size: ".concat(c));if(0!==w&&2!==w)throw new Error("Invalid bevel version: ".concat(w));h=iy(e);var E=iy(e),_=(a=iy(e),Fy(e)),S=Fy(e),C=Iy(e),T=Iy(e),A=Py[Vg(e)]||"inner bevel",k=Ny(e),M=Ny(e),O=(v=!!Vg(e),m=!!Vg(e),Vg(e)?"down":"up");c>=78&&(Iy(e),Iy(e)),n.bevel={size:{units:"Pixels",value:a},angle:h,strength:E,highlightBlendMode:_,shadowBlendMode:S,highlightColor:C,shadowColor:T,style:A,highlightOpacity:k,shadowOpacity:M,enabled:v,useGlobalLight:m,direction:O};break;case"sofi":a=ty(e);var L=ty(e);if(34!==a)throw new Error("Invalid effects solid fill info size: ".concat(a));if(2!==L)throw new Error("Invalid effects solid fill info version: ".concat(L));p=Fy(e),f=Iy(e),g=Ny(e),v=!!Vg(e),Iy(e),n.solidFill=[{blendMode:p,color:f,opacity:g,enabled:v}];break;default:throw new Error("Invalid effect type: '".concat(o,"'"))}}return n}(e)),fy(e,r())}),(function(e,t){!function(e,t){var r,n,i,o,a,s,l=null===(r=t.dropShadow)||void 0===r?void 0:r[0],c=null===(n=t.innerShadow)||void 0===n?void 0:n[0],u=t.outerGlow,h=t.innerGlow,d=t.bevel,f=null===(i=t.solidFill)||void 0===i?void 0:i[0],p=1;if(l&&p++,c&&p++,u&&p++,h&&p++,d&&p++,f&&p++,vx(e,0),vx(e,p),Tx(e,"8BIM"),Tx(e,"cmnS"),bx(e,7),bx(e,0),fx(e,1),Cx(e,2),l&&(Tx(e,"8BIM"),Tx(e,"dsdw"),Uy(e,l)),c&&(Tx(e,"8BIM"),Tx(e,"isdw"),Uy(e,c)),u&&(Tx(e,"8BIM"),Tx(e,"oglw"),bx(e,42),bx(e,2),Ex(e,(null===(o=u.size)||void 0===o?void 0:o.value)||0),Ex(e,0),Ix(e,u.color),Dy(e,u.blendMode),fx(e,u.enabled?1:0),By(e,u.opacity||0),Ix(e,u.color)),h&&(Tx(e,"8BIM"),Tx(e,"iglw"),bx(e,43),bx(e,2),Ex(e,(null===(a=h.size)||void 0===a?void 0:a.value)||0),Ex(e,0),Ix(e,h.color),Dy(e,h.blendMode),fx(e,h.enabled?1:0),By(e,h.opacity||0),fx(e,0),Ix(e,h.color)),d){Tx(e,"8BIM"),Tx(e,"bevl"),bx(e,78),bx(e,2),Ex(e,d.angle||0),Ex(e,d.strength||0),Ex(e,(null===(s=d.size)||void 0===s?void 0:s.value)||0),Dy(e,d.highlightBlendMode),Dy(e,d.shadowBlendMode),Ix(e,d.highlightColor),Ix(e,d.shadowColor);var v=Py.indexOf(d.style);fx(e,v<=0?1:v),By(e,d.highlightOpacity||0),By(e,d.shadowOpacity||0),fx(e,d.enabled?1:0),fx(e,d.useGlobalLight?1:0),fx(e,"down"===d.direction?1:0),Ix(e,d.highlightColor),Ix(e,d.shadowColor)}f&&(Tx(e,"8BIM"),Tx(e,"sofi"),bx(e,34),bx(e,2),Dy(e,f.blendMode),Ix(e,f.color),By(e,f.opacity||0),fx(e,f.enabled?1:0),Ix(e,f.color))}(e,t.effects)})),Cb("luni",Ab("name"),(function(e,t,r){if(r()>4){var n=ty(e);r()>=2*n?t.name=hy(e,n):e.logDevFeatures&&e.log("name in luni section is too long")}else e.logDevFeatures&&e.log("empty luni section");fy(e,r())}),(function(e,t){kx(e,t.name)})),Cb("lnsr",Ab("nameSource"),(function(e,t){return t.nameSource=sy(e)}),(function(e,t){return Tx(e,t.nameSource)})),Cb("lyid",Ab("id"),(function(e,t){t.id=ty(e)}),(function(e,t,r,n){for(var i=t.id;n.layerIds.has(i);)i+=100;bx(e,i),n.layerIds.add(i),n.layerToId.set(t,i)})),Cb("lsct",Ab("sectionDivider"),(function(e,t,r){t.sectionDivider={type:ty(e)},r()&&(py(e,"8BIM"),t.sectionDivider.key=sy(e)),r()&&(t.sectionDivider.subType=ty(e))}),(function(e,t){bx(e,t.sectionDivider.type),t.sectionDivider.key&&(Tx(e,"8BIM"),Tx(e,t.sectionDivider.key),void 0!==t.sectionDivider.subType&&bx(e,t.sectionDivider.subType))})),Tb("lsdk","lsct"),Cb("clbl",Ab("blendClippendElements"),(function(e,t){t.blendClippendElements=!!Vg(e),fy(e,3)}),(function(e,t){fx(e,t.blendClippendElements?1:0),Cx(e,3)})),Cb("infx",Ab("blendInteriorElements"),(function(e,t){t.blendInteriorElements=!!Vg(e),fy(e,3)}),(function(e,t){fx(e,t.blendInteriorElements?1:0),Cx(e,3)})),Cb("knko",Ab("knockout"),(function(e,t){t.knockout=!!Vg(e),fy(e,3)}),(function(e,t){fx(e,t.knockout?1:0),Cx(e,3)})),Cb("lmgm",Ab("layerMaskAsGlobalMask"),(function(e,t){t.layerMaskAsGlobalMask=!!Vg(e),fy(e,3)}),(function(e,t){fx(e,t.layerMaskAsGlobalMask?1:0),Cx(e,3)})),Cb("lspf",Ab("protected"),(function(e,t){var r=ty(e);t.protected={transparency:!!(1&r),composite:!!(2&r),position:!!(4&r)},8&r&&(t.protected.artboards=!0)}),(function(e,t){bx(e,(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0))})),Cb("lclr",Ab("layerColor"),(function(e,t){var r=Jg(e);fy(e,6),t.layerColor=Yp[r]}),(function(e,t){var r=Yp.indexOf(t.layerColor);vx(e,-1===r?0:r),Cx(e,6)})),Cb("shmd",(function(e){return void 0!==e.timestamp||void 0!==e.animationFrames||void 0!==e.animationFrameFlags||void 0!==e.timeline||void 0!==e.comps}),(function(e,t,r){for(var n=ty(e),i=function(r){py(e,"8BIM");var n=sy(e);Vg(e),fy(e,3),Ry(e,1,(function(r){if("cust"===n)void 0!==(i=zv(e)).layerTime&&(t.timestamp=i.layerTime);else if("mlst"===n){var i=zv(e);t.animationFrames=[];for(var o=0;o<i.LaSt.length;o++){var a=i.LaSt[o],s={frames:a.FrLs};void 0!==a.enab&&(s.enable=a.enab),a.Ofst&&(s.offset=Hv(a.Ofst)),a.FXRf&&(s.referencePoint=Hv(a.FXRf)),a.Lefx&&(s.effects=Kv(a.Lefx,!!e.logMissingFeatures)),a.blendOptions&&a.blendOptions.Opct&&(s.opacity=fm(a.blendOptions.Opct)),t.animationFrames.push(s)}}else if("mdyn"===n){Jg(e);var l=Vg(e),c=Vg(e);t.animationFrameFlags={propagateFrameOne:!l,unifyLayerPosition:!!(1&c),unifyLayerStyle:!!(2&c),unifyLayerVisibility:!!(4&c)}}else if("tmln"===n){var u=(i=zv(e)).timeScope,h={start:wm(u.Strt),duration:wm(u.duration),inTime:wm(u.inTime),outTime:wm(u.outTime),autoScope:i.autoScope,audioLevel:i.audioLevel};i.trackList&&(h.tracks=Qv(i.trackList,!!e.logMissingFeatures)),t.timeline=h}else if("cmls"===n){i=zv(e);t.comps={settings:[]},i.origFXRefPoint&&(t.comps.originalEffectsReferencePoint={x:i.origFXRefPoint.Hrzn,y:i.origFXRefPoint.Vrtc});for(var d=0,f=i.layerSettings;d<f.length;d++){var p=f[d];t.comps.settings.push({compList:p.compList});var v=t.comps.settings[t.comps.settings.length-1];"enab"in p&&(v.enabled=p.enab),p.Ofst&&(v.offset={x:p.Ofst.Hrzn,y:p.Ofst.Vrtc}),p.FXRefPoint&&(v.effectsReferencePoint={x:p.FXRefPoint.Hrzn,y:p.FXRefPoint.Vrtc})}}else if("extn"===n){i=zv(e);e.logMissingFeatures&&e.log('Unhandled "shmd" section key',n)}else e.logMissingFeatures&&e.log('Unhandled "shmd" section key',n);fy(e,r())}))},o=0;o<n;o++)i();fy(e,r())}),(function(e,t,r,n){var i=t.animationFrames,o=t.animationFrameFlags,a=t.timestamp,s=t.timeline,l=t.comps,c=0;i&&c++,o&&c++,s&&c++,void 0!==a&&c++,l&&c++,bx(e,c),i&&(Tx(e,"8BIM"),Tx(e,"mlst"),fx(e,0),Cx(e,3),Ox(e,2,(function(){for(var r,n={LaID:null!==(r=t.id)&&void 0!==r?r:0,LaSt:[]},o=0;o<i.length;o++){var a=i[o],s={};void 0!==a.enable&&(s.enab=a.enable),s.FrLs=a.frames,a.offset&&(s.Ofst=Gv(a.offset)),a.referencePoint&&(s.FXRf=Gv(a.referencePoint)),a.effects&&(s.Lefx=Vv(a.effects,!1,!1)),void 0!==a.opacity&&(s.blendOptions={Opct:ym(a.opacity)}),n.LaSt.push(s)}Xv(e,"","null",n)}),!0)),o&&(Tx(e,"8BIM"),Tx(e,"mdyn"),fx(e,0),Cx(e,3),Ox(e,2,(function(){vx(e,0),fx(e,o.propagateFrameOne?0:15),fx(e,(o.unifyLayerPosition?1:0)|(o.unifyLayerStyle?2:0)|(o.unifyLayerVisibility?4:0))}))),s&&(Tx(e,"8BIM"),Tx(e,"tmln"),fx(e,0),Cx(e,3),Ox(e,2,(function(){var r={Vrsn:1,timeScope:{Vrsn:1,Strt:s.start,duration:s.duration,inTime:s.inTime,outTime:s.outTime},autoScope:s.autoScope,audioLevel:s.audioLevel};s.tracks&&(r.trackList=$v(s.tracks));var i=n.layerToId.get(t)||t.id;if(!i)throw new Error("You need to provide layer.id value whan writing document with animations");r.LyrI=i,Xv(e,"","null",r,"anim")}),!0)),void 0!==a&&(Tx(e,"8BIM"),Tx(e,"cust"),fx(e,0),Cx(e,3),Ox(e,2,(function(){Xv(e,"","metadata",{layerTime:a})}),!0)),l&&(Tx(e,"8BIM"),Tx(e,"cmls"),fx(e,0),Cx(e,3),Ox(e,2,(function(){var r=n.layerToId.get(t)||t.id;if(!r)throw new Error("You need to provide layer.id value whan writing document with layer comps");var i={};l.originalEffectsReferencePoint&&(i.origFXRefPoint={Hrzn:l.originalEffectsReferencePoint.x,Vrtc:l.originalEffectsReferencePoint.y}),i.LyrI=r,i.layerSettings=[];for(var o=0,a=l.settings;o<a.length;o++){var s=a[o],c={};void 0!==s.enabled&&(c.enab=s.enabled),s.offset&&(c.Ofst={Hrzn:s.offset.x,Vrtc:s.offset.y}),s.effectsReferencePoint&&(c.FXRefPoint={Hrzn:s.effectsReferencePoint.x,Vrtc:s.effectsReferencePoint.y}),c.compList=s.compList,i.layerSettings.push(c)}Xv(e,"","null",i)}),!0))})),Cb("vstk",Ab("vectorStroke"),(function(e,t,r){var n=zv(e);t.vectorStroke={strokeEnabled:n.strokeEnabled,fillEnabled:n.fillEnabled,lineWidth:vm(n.strokeStyleLineWidth),lineDashOffset:vm(n.strokeStyleLineDashOffset),miterLimit:n.strokeStyleMiterLimit,lineCapType:jm.decode(n.strokeStyleLineCapType),lineJoinType:Ym.decode(n.strokeStyleLineJoinType),lineAlignment:Wm.decode(n.strokeStyleLineAlignment),scaleLock:n.strokeStyleScaleLock,strokeAdjust:n.strokeStyleStrokeAdjust,lineDashSet:n.strokeStyleLineDashSet.map(vm),blendMode:Tm.decode(n.strokeStyleBlendMode),opacity:fm(n.strokeStyleOpacity),content:am(n.strokeStyleContent),resolution:n.strokeStyleResolution},fy(e,r())}),(function(e,t){var r,n,i,o=t.vectorStroke;Xv(e,"","strokeStyle",{strokeStyleVersion:2,strokeEnabled:!!o.strokeEnabled,fillEnabled:!!o.fillEnabled,strokeStyleLineWidth:o.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:o.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:null!==(r=o.miterLimit)&&void 0!==r?r:100,strokeStyleLineCapType:jm.encode(o.lineCapType),strokeStyleLineJoinType:Ym.encode(o.lineJoinType),strokeStyleLineAlignment:Wm.encode(o.lineAlignment),strokeStyleScaleLock:!!o.scaleLock,strokeStyleStrokeAdjust:!!o.strokeAdjust,strokeStyleLineDashSet:o.lineDashSet||[],strokeStyleBlendMode:Tm.encode(o.blendMode),strokeStyleOpacity:ym(null!==(n=o.opacity)&&void 0!==n?n:1),strokeStyleContent:cm(o.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:null!==(i=o.resolution)&&void 0!==i?i:72})})),Cb("artb",Ab("artboard"),(function(e,t,r){var n=zv(e),i=n.artboardRect;t.artboard={rect:{top:i["Top "],left:i.Left,bottom:i.Btom,right:i.Rght},guideIndices:n.guideIndeces,presetName:n.artboardPresetName,color:um(n["Clr "]),backgroundType:n.artboardBackgroundType},fy(e,r())}),(function(e,t){var r,n=t.artboard,i=n.rect;Xv(e,"","artboard",{artboardRect:{"Top ":i.top,Left:i.left,Btom:i.bottom,Rght:i.right},guideIndeces:n.guideIndices||[],artboardPresetName:n.presetName||"","Clr ":hm(n.color),artboardBackgroundType:null!==(r=n.backgroundType)&&void 0!==r?r:1})})),Cb("sn2P",Ab("usingAlignedRendering"),(function(e,t){return t.usingAlignedRendering=!!ty(e)}),(function(e,t){return bx(e,t.usingAlignedRendering?1:0)}));var Ib=["unknown","vector","raster","image stack"];function Pb(e){var t,r,n,i,o,a,s=Eb(Eb({style:Cm.decode(e.warpStyle)},e.warpValues?{values:e.warpValues}:{value:e.warpValue||0}),{perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:_m.decode(e.warpRotate),bounds:e.bounds&&{top:mm(e.bounds["Top "]),left:mm(e.bounds.Left),bottom:mm(e.bounds.Btom),right:mm(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder});null==e.deformNumRows&&null==e.deformNumCols||(s.deformNumRows=e.deformNumRows,s.deformNumCols=e.deformNumCols);var l=e.customEnvelopeWarp;if(l){s.customEnvelopeWarp={meshPoints:[]};for(var c=(null===(t=l.meshPoints.find((function(e){return"Hrzn"===e.type})))||void 0===t?void 0:t.values)||[],u=(null===(r=l.meshPoints.find((function(e){return"Vrtc"===e.type})))||void 0===r?void 0:r.values)||[],h=0;h<c.length;h++)s.customEnvelopeWarp.meshPoints.push({x:c[h],y:u[h]});(l.quiltSliceX||l.quiltSliceY)&&(s.customEnvelopeWarp.quiltSliceX=(null===(i=null===(n=l.quiltSliceX)||void 0===n?void 0:n[0])||void 0===i?void 0:i.values)||[],s.customEnvelopeWarp.quiltSliceY=(null===(a=null===(o=l.quiltSliceY)||void 0===o?void 0:o[0])||void 0===a?void 0:a.values)||[])}return s}function Fb(e){var t,r;return null!=e.deformNumCols||null!=e.deformNumRows||(null===(t=e.customEnvelopeWarp)||void 0===t?void 0:t.quiltSliceX)||(null===(r=e.customEnvelopeWarp)||void 0===r?void 0:r.quiltSliceY)}function Db(e){var t=e.bounds,r=Eb(Eb({warpStyle:Cm.encode(e.style)},e.values?{warpValues:e.values}:{warpValue:e.value||0}),{warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:_m.encode(e.rotate),bounds:{"Top ":xm(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:xm(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:xm(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:xm(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0}),n=Fb(e);n&&((o=r).deformNumRows=e.deformNumRows||0,o.deformNumCols=e.deformNumCols||0);var i=e.customEnvelopeWarp;if(i){var o,a=i.meshPoints||[];if(n)(o=r).customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",quiltSliceX:[{type:"quiltSliceX",values:i.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:i.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:a.map((function(e){return e.x}))},{type:"Vrtc",values:a.map((function(e){return e.y}))}]};else r.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",meshPoints:[{type:"Hrzn",values:a.map((function(e){return e.x}))},{type:"Vrtc",values:a.map((function(e){return e.y}))}]}}return r}function Nb(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function Bb(e){for(var t=[],r=0;r<e.length;r+=2)t.push({x:e[r],y:e[r+1]});return t}function Ub(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].x,e[r].y);return t}function zb(e){return Bb(function(e){return new Float32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}(e))}function Xb(e){return{x:vm(e.Hrzn),y:vm(e.Vrtc)}}function Hb(e){return{_name:"",_classID:"Pnt ",Hrzn:xm(e.x,"x"),Vrtc:xm(e.y,"y")}}function Gb(e,t){return{enabled:e.enab,validAtPosition:e.validAtPosition,maskEnabled:e.filterMaskEnable,maskLinked:e.filterMaskLinked,maskExtendWithWhite:e.filterMaskExtendWithWhite,list:e.filterFXList.map((function(e){return function(e,t){var r={name:e["Nm  "],opacity:fm(e.blendOptions.Opct),blendMode:Tm.decode(e.blendOptions["Md  "]),enabled:e.enab,hasOptions:e.hasoptions,foregroundColor:um(e.FrgC),backgroundColor:um(e.BckC)};if("Fltr"in e)switch(e.Fltr._classID){case"boxblur":return Eb(Eb({},r),{type:"box blur",filter:{radius:vm(e.Fltr["Rds "])}});case"GsnB":return Eb(Eb({},r),{type:"gaussian blur",filter:{radius:vm(e.Fltr["Rds "])}});case"MtnB":return Eb(Eb({},r),{type:"motion blur",filter:{angle:e.Fltr.Angl,distance:vm(e.Fltr.Dstn)}});case"RdlB":return Eb(Eb({},r),{type:"radial blur",filter:{amount:e.Fltr.Amnt,method:qm.decode(e.Fltr.BlrM),quality:Vm.decode(e.Fltr.BlrQ)}});case"shapeBlur":return Eb(Eb({},r),{type:"shape blur",filter:{radius:vm(e.Fltr["Rds "]),customShape:{name:e.Fltr.customShape["Nm  "],id:e.Fltr.customShape.Idnt}}});case"SmrB":return Eb(Eb({},r),{type:"smart blur",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh,quality:Zm.decode(e.Fltr.SmBQ),mode:Km.decode(e.Fltr.SmBM)}});case"surfaceBlur":return Eb(Eb({},r),{type:"surface blur",filter:{radius:vm(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dspl":return Eb(Eb({},r),{type:"displace",filter:{horizontalScale:e.Fltr.HrzS,verticalScale:e.Fltr.VrtS,displacementMap:Jm.decode(e.Fltr.DspM),undefinedAreas:Qm.decode(e.Fltr.UndA),displacementFile:{signature:e.Fltr.DspF.sig,path:e.Fltr.DspF.path}}});case"Pnch":return Eb(Eb({},r),{type:"pinch",filter:{amount:e.Fltr.Amnt}});case"Plr ":return Eb(Eb({},r),{type:"polar coordinates",filter:{conversion:$m.decode(e.Fltr.Cnvr)}});case"Rple":return Eb(Eb({},r),{type:"ripple",filter:{amount:e.Fltr.Amnt,size:eg.decode(e.Fltr.RplS)}});case"Shr ":return Eb(Eb({},r),{type:"shear",filter:{shearPoints:e.Fltr.ShrP.map((function(e){return{x:e.Hrzn,y:e.Vrtc}})),shearStart:e.Fltr.ShrS,shearEnd:e.Fltr.ShrE,undefinedAreas:Qm.decode(e.Fltr.UndA)}});case"Sphr":return Eb(Eb({},r),{type:"spherize",filter:{amount:e.Fltr.Amnt,mode:tg.decode(e.Fltr.SphM)}});case"Twrl":return Eb(Eb({},r),{type:"twirl",filter:{angle:e.Fltr.Angl}});case"Wave":return Eb(Eb({},r),{type:"wave",filter:{numberOfGenerators:e.Fltr.NmbG,type:rg.decode(e.Fltr.Wvtp),wavelength:{min:e.Fltr.WLMn,max:e.Fltr.WLMx},amplitude:{min:e.Fltr.AmMn,max:e.Fltr.AmMx},scale:{x:e.Fltr.SclH,y:e.Fltr.SclV},randomSeed:e.Fltr.RndS,undefinedAreas:Qm.decode(e.Fltr.UndA)}});case"ZgZg":return Eb(Eb({},r),{type:"zigzag",filter:{amount:e.Fltr.Amnt,ridges:e.Fltr.NmbR,style:ng.decode(e.Fltr.ZZTy)}});case"AdNs":return Eb(Eb({},r),{type:"add noise",filter:{amount:fm(e.Fltr.Nose),distribution:ig.decode(e.Fltr.Dstr),monochromatic:e.Fltr.Mnch,randomSeed:e.Fltr.FlRs}});case"DstS":return Eb(Eb({},r),{type:"dust and scratches",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh}});case"Mdn ":return Eb(Eb({},r),{type:"median",filter:{radius:vm(e.Fltr["Rds "])}});case"denoise":return Eb(Eb({},r),{type:"reduce noise",filter:{preset:e.Fltr.preset,removeJpegArtifact:e.Fltr.removeJPEGArtifact,reduceColorNoise:fm(e.Fltr.ClNs),sharpenDetails:fm(e.Fltr.Shrp),channelDenoise:e.Fltr.channelDenoise.map((function(e){return Eb({channels:e.Chnl.map((function(e){return og.decode(e)})),amount:e.Amnt},e.EdgF?{preserveDetails:e.EdgF}:{})}))}});case"ClrH":return Eb(Eb({},r),{type:"color halftone",filter:{radius:e.Fltr["Rds "],angle1:e.Fltr.Ang1,angle2:e.Fltr.Ang2,angle3:e.Fltr.Ang3,angle4:e.Fltr.Ang4}});case"Crst":return Eb(Eb({},r),{type:"crystallize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Mztn":return Eb(Eb({},r),{type:"mezzotint",filter:{type:ag.decode(e.Fltr.MztT),randomSeed:e.Fltr.FlRs}});case"Msc ":return Eb(Eb({},r),{type:"mosaic",filter:{cellSize:vm(e.Fltr.ClSz)}});case"Pntl":return Eb(Eb({},r),{type:"pointillize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Clds":return Eb(Eb({},r),{type:"clouds",filter:{randomSeed:e.Fltr.FlRs}});case"DfrC":return Eb(Eb({},r),{type:"difference clouds",filter:{randomSeed:e.Fltr.FlRs}});case"Fbrs":return Eb(Eb({},r),{type:"fibers",filter:{variance:e.Fltr.Vrnc,strength:e.Fltr.Strg,randomSeed:e.Fltr.RndS}});case"LnsF":return Eb(Eb({},r),{type:"lens flare",filter:{brightness:e.Fltr.Brgh,position:{x:e.Fltr.FlrC.Hrzn,y:e.Fltr.FlrC.Vrtc},lensType:sg.decode(e.Fltr["Lns "])}});case"smartSharpen":return Eb(Eb({},r),{type:"smart sharpen",filter:{amount:fm(e.Fltr.Amnt),radius:vm(e.Fltr["Rds "]),threshold:e.Fltr.Thsh,angle:e.Fltr.Angl,moreAccurate:e.Fltr.moreAccurate,blur:lg.decode(e.Fltr.blur),preset:e.Fltr.preset,shadow:{fadeAmount:fm(e.Fltr.sdwM.Amnt),tonalWidth:fm(e.Fltr.sdwM.Wdth),radius:e.Fltr.sdwM["Rds "]},highlight:{fadeAmount:fm(e.Fltr.hglM.Amnt),tonalWidth:fm(e.Fltr.hglM.Wdth),radius:e.Fltr.hglM["Rds "]}}});case"UnsM":return Eb(Eb({},r),{type:"unsharp mask",filter:{amount:fm(e.Fltr.Amnt),radius:vm(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dfs ":return Eb(Eb({},r),{type:"diffuse",filter:{mode:cg.decode(e.Fltr["Md  "]),randomSeed:e.Fltr.FlRs}});case"Embs":return Eb(Eb({},r),{type:"emboss",filter:{angle:e.Fltr.Angl,height:e.Fltr.Hght,amount:e.Fltr.Amnt}});case"Extr":return Eb(Eb({},r),{type:"extrude",filter:{type:ug.decode(e.Fltr.ExtT),size:e.Fltr.ExtS,depth:e.Fltr.ExtD,depthMode:hg.decode(e.Fltr.ExtR),randomSeed:e.Fltr.FlRs,solidFrontFaces:e.Fltr.ExtF,maskIncompleteBlocks:e.Fltr.ExtM}});case"Tls ":return Eb(Eb({},r),{type:"tiles",filter:{numberOfTiles:e.Fltr.TlNm,maximumOffset:e.Fltr.TlOf,fillEmptyAreaWith:dg.decode(e.Fltr.FlCl),randomSeed:e.Fltr.FlRs}});case"TrcC":return Eb(Eb({},r),{type:"trace contour",filter:{level:e.Fltr["Lvl "],edge:fg.decode(e.Fltr["Edg "])}});case"Wnd ":return Eb(Eb({},r),{type:"wind",filter:{method:pg.decode(e.Fltr.WndM),direction:vg.decode(e.Fltr.Drct)}});case"Dntr":return Eb(Eb({},r),{type:"de-interlace",filter:{eliminate:mg.decode(e.Fltr.IntE),newFieldsBy:gg.decode(e.Fltr.IntC)}});case"Cstm":return Eb(Eb({},r),{type:"custom",filter:{scale:e.Fltr["Scl "],offset:e.Fltr.Ofst,matrix:e.Fltr.Mtrx}});case"HghP":return Eb(Eb({},r),{type:"high pass",filter:{radius:vm(e.Fltr["Rds "])}});case"Mxm ":return Eb(Eb({},r),{type:"maximum",filter:{radius:vm(e.Fltr["Rds "])}});case"Mnm ":return Eb(Eb({},r),{type:"minimum",filter:{radius:vm(e.Fltr["Rds "])}});case"Ofst":return Eb(Eb({},r),{type:"offset",filter:{horizontal:e.Fltr.Hrzn,vertical:e.Fltr.Vrtc,undefinedAreas:yg.decode(e.Fltr["Fl  "])}});case"rigidTransform":return Eb(Eb({},r),{type:"puppet",filter:{rigidType:e.Fltr.rigidType,bounds:[{x:e.Fltr.PuX0,y:e.Fltr.PuY0},{x:e.Fltr.PuX1,y:e.Fltr.PuY1},{x:e.Fltr.PuX2,y:e.Fltr.PuY2},{x:e.Fltr.PuX3,y:e.Fltr.PuY3}],puppetShapeList:e.Fltr.puppetShapeList.map((function(e){return{rigidType:e.rigidType,originalVertexArray:zb(e.originalVertexArray),deformedVertexArray:zb(e.deformedVertexArray),indexArray:Array.from((t=e.indexArray,new Uint32Array(t.buffer.slice(t.byteOffset),0,t.byteLength/4))),pinOffsets:Bb(e.pinOffsets),posFinalPins:Bb(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,selectedPin:e.selectedPin,pinPosition:Bb(e.PinP),pinRotation:e.PnRt,pinOverlay:e.PnOv,pinDepth:e.PnDp,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{pathComponents:e.meshBoundaryPath.pathComponents.map((function(e){return{shapeOperation:e.shapeOperation.split(".")[1],paths:e.SbpL.map((function(e){return{closed:e.Clsp,points:e["Pts "].map((function(e){return{anchor:Xb(e.Anch),forward:Xb(e["Fwd "]),backward:Xb(e["Bwd "]),smooth:e.Smoo}}))}}))}}))}};var t}))}});case"PbPl":for(var n=[],i=e.Fltr,o=0;o<_b.length&&i["PN".concat(_b[o],"a")];o++)for(var a=0;a<_b.length&&i["PN".concat(_b[o]).concat(_b[a])];a++)n.push({name:i["PN".concat(_b[o]).concat(_b[a])],value:i["PF".concat(_b[o]).concat(_b[a])]});return Eb(Eb({},r),{type:"oil paint plugin",filter:{name:e.Fltr.KnNm,gpu:e.Fltr.GpuY,lighting:e.Fltr.LIWy,parameters:n}});case"HsbP":return Eb(Eb({},r),{type:"hsb/hsl",filter:{inputMode:Dm.decode(e.Fltr.Inpt),rowOrder:Dm.decode(e.Fltr.Otpt)}});case"oilPaint":return Eb(Eb({},r),{type:"oil paint",filter:{lightingOn:e.Fltr.lightingOn,stylization:e.Fltr.stylization,cleanliness:e.Fltr.cleanliness,brushScale:e.Fltr.brushScale,microBrush:e.Fltr.microBrush,lightDirection:e.Fltr.LghD,specularity:e.Fltr.specularity}});case"LqFy":return Eb(Eb({},r),{type:"liquify",filter:{liquifyMesh:e.Fltr.LqMe}});case"perspectiveWarpTransform":return Eb(Eb({},r),{type:"perspective warp",filter:{vertices:e.Fltr.vertices.map(Xb),warpedVertices:e.Fltr.warpedVertices.map(Xb),quads:e.Fltr.quads.map((function(e){return e.indices}))}});case"Crvs":return Eb(Eb({},r),{type:"curves",filter:{presetKind:bg.decode(e.Fltr.presetKind),adjustments:e.Fltr.Adjs.map((function(e){var t=e.Chnl.map((function(e){return og.decode(e)}));if(e["Crv "])return{channels:t,curve:e["Crv "].map((function(e){var t={x:e.Hrzn,y:e.Vrtc};return e.Cnty&&(t.curved=!0),t}))};if(e.Mpng)return{channels:t,values:e.Mpng};throw new Error("Unknown curve adjustment")}))}});default:if(t.throwForMissingFeatures)throw new Error("Unknown filter classId: ".concat(e.Fltr._classID));return}else switch(e.filterID){case 1098281575:return Eb(Eb({},r),{type:"average"});case 1114403360:return Eb(Eb({},r),{type:"blur"});case 1114403405:return Eb(Eb({},r),{type:"blur more"});case 1148416099:return Eb(Eb({},r),{type:"despeckle"});case 1180922912:return Eb(Eb({},r),{type:"facet"});case 1181902701:return Eb(Eb({},r),{type:"fragment"});case 1399353968:return Eb(Eb({},r),{type:"sharpen"});case 1399353925:return Eb(Eb({},r),{type:"sharpen edges"});case 1399353933:return Eb(Eb({},r),{type:"sharpen more"});case 1181639749:return Eb(Eb({},r),{type:"find edges"});case 1399616122:return Eb(Eb({},r),{type:"solarize"});case 1314149187:return Eb(Eb({},r),{type:"ntsc colors"});default:if(t.throwForMissingFeatures)throw new Error("Unknown filterID: ".concat(e.filterID))}}(e,t)})).filter((function(e){return!!e}))}}function jb(e){return xm(e.radius,"radius")}function Yb(e){if(e.warp)return e.warp;if(!e.width||!e.height)throw new Error("You must provide width and height of the linked image in placedLayer");var t=e.width,r=e.height,n=t/3,i=2*t/3,o=r/3,a=2*r/3;return{style:"custom",value:0,perspective:0,perspectiveOther:0,rotate:"horizontal",bounds:{top:{value:0,units:"Pixels"},left:{value:0,units:"Pixels"},bottom:{value:r,units:"Pixels"},right:{value:t,units:"Pixels"}},uOrder:4,vOrder:4,customEnvelopeWarp:{meshPoints:[{x:0,y:0},{x:n,y:0},{x:i,y:0},{x:t,y:0},{x:0,y:o},{x:n,y:o},{x:i,y:o},{x:t,y:o},{x:0,y:a},{x:n,y:a},{x:i,y:a},{x:t,y:a},{x:0,y:r},{x:n,y:r},{x:i,y:r},{x:t,y:r}]}}}function Wb(e){return{top:$g(e),left:$g(e),bottom:$g(e),right:$g(e)}}function qb(e,t){gx(e,t.top),gx(e,t.left),gx(e,t.bottom),gx(e,t.right)}function Vb(e){Cb(e,(function(t){var r=t;return!(!r.linkedFiles||!r.linkedFiles.length)&&!("lnkE"===e&&!r.linkedFiles.some((function(e){return e.linkedFile})))}),(function(t,r,n,i){var o=r;for(o.linkedFiles=o.linkedFiles||[];n()>8;){var a=kb(t),s=t.offset,l=sy(t),c=$g(t),u=cy(t,1),h=uy(t),d=sy(t).trim(),f=sy(t).trim(),p=kb(t),v=Vg(t)?zv(t):void 0,m="liFE"===l?zv(t):void 0,g={id:u,name:h};if(d&&(g.type=d),f&&(g.creator=f),v&&(g.descriptor={compInfo:{compID:v.compInfo.compID,originalCompID:v.compInfo.originalCompID}}),"liFE"===l&&c>3){var y=$g(t),b=Vg(t),x=Vg(t),w=Vg(t),E=Vg(t),_=ny(t),S=Math.floor(_),C=1e3*(_-S);g.time=new Date(Date.UTC(y,b,x,w,E,S,C)).toISOString()}var T="liFE"===l?kb(t):0;for("liFA"===l&&fy(t,8),"liFD"===l&&(g.data=ay(t,p)),c>=5&&(g.childDocumentID=uy(t)),c>=6&&(g.assetModTime=ny(t)),c>=7&&(g.assetLockedState=Vg(t)),"liFE"===l&&2===c&&(g.data=ay(t,T)),t.skipLinkedFilesData&&(g.data=void 0),"lnkE"===e&&(g.linkedFile={fileSize:T,name:(null==m?void 0:m["Nm  "])||"",fullPath:(null==m?void 0:m.fullPath)||"",originalPath:(null==m?void 0:m.originalPath)||"",relativePath:(null==m?void 0:m.relPath)||""}),o.linkedFiles.push(g);a%4;)a++;t.offset=s+a}fy(t,n())}),(function(t,r){for(var n,i,o,a,s,l,c,u,h,d=0,f=r.linkedFiles;d<f.length;d++){var p=f[d];if("lnkE"===e==!!p.linkedFile){var v=2;null!=p.assetLockedState?v=7:null!=p.assetModTime?v=6:null!=p.childDocumentID?v=5:"lnkE"==e&&(v=3),Mb(t,0);var m=t.offset;if(Tx(t,"lnkE"===e?"liFE":p.data?"liFD":"liFA"),gx(t,v),!p.id||"string"!=typeof p.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(p.id))throw new Error("Linked file ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(Ax(t,p.id,1),Mx(t,p.name||""),Tx(t,p.type?"".concat(p.type,"    ").substring(0,4):"    "),Tx(t,p.creator?"".concat(p.creator,"    ").substring(0,4):"\0\0\0\0"),Mb(t,p.data?p.data.byteLength:0),p.descriptor&&p.descriptor.compInfo){var g={compInfo:{compID:p.descriptor.compInfo.compID,originalCompID:p.descriptor.compInfo.originalCompID}};fx(t,1),Xv(t,"","null",g)}else fx(t,0);if("lnkE"===e){Xv(t,"","ExternalFileLink",g={descVersion:2,"Nm  ":null!==(i=null===(n=p.linkedFile)||void 0===n?void 0:n.name)&&void 0!==i?i:"",fullPath:null!==(a=null===(o=p.linkedFile)||void 0===o?void 0:o.fullPath)&&void 0!==a?a:"",originalPath:null!==(l=null===(s=p.linkedFile)||void 0===s?void 0:s.originalPath)&&void 0!==l?l:"",relPath:null!==(u=null===(c=p.linkedFile)||void 0===c?void 0:c.relativePath)&&void 0!==u?u:""});var y=p.time?new Date(p.time):new Date;gx(t,y.getUTCFullYear()),fx(t,y.getUTCMonth()),fx(t,y.getUTCDate()),fx(t,y.getUTCHours()),fx(t,y.getUTCMinutes()),wx(t,y.getUTCSeconds()+y.getUTCMilliseconds()/1e3)}p.data?Sx(t,p.data):Mb(t,(null===(h=p.linkedFile)||void 0===h?void 0:h.fileSize)||0),v>=5&&Mx(t,p.childDocumentID||""),v>=6&&wx(t,p.assetModTime||0),v>=7&&fx(t,p.assetLockedState||0);var b=t.offset-m;for(t.view.setUint32(m-4,b,!1);b%4;)b++,fx(t,0)}}}))}function Kb(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}function Zb(e){return{shadowInput:Zg(e),highlightInput:Zg(e),shadowOutput:Zg(e),highlightOutput:Zg(e),midtoneInput:Zg(e)/100}}function Jb(e,t){px(e,t.shadowInput),px(e,t.highlightInput),px(e,t.shadowOutput),px(e,t.highlightOutput),px(e,Math.round(100*t.midtoneInput))}function Qb(e){for(var t=Jg(e),r=[],n=0;n<t;n++){var i=Zg(e),o=Zg(e);r.push({input:o,output:i})}return r}function $b(e,t){vx(e,t.length);for(var r=0,n=t;r<n.length;r++){var i=n[r];vx(e,i.output),vx(e,i.input)}}function ex(e){return{a:Zg(e),b:Zg(e),c:Zg(e),d:Zg(e),hue:Zg(e),saturation:Zg(e),lightness:Zg(e)}}function tx(e,t){var r=t||{};px(e,r.a||0),px(e,r.b||0),px(e,r.c||0),px(e,r.d||0),px(e,r.hue||0),px(e,r.saturation||0),px(e,r.lightness||0)}function rx(e){return{cyanRed:Zg(e),magentaGreen:Zg(e),yellowBlue:Zg(e)}}function nx(e,t){px(e,t.cyanRed||0),px(e,t.magentaGreen||0),px(e,t.yellowBlue||0)}function ix(e){var t=Zg(e),r=Zg(e),n=Zg(e);return fy(e,2),{red:t,green:r,blue:n,constant:Zg(e)}}function ox(e,t){var r=t||{};px(e,r.red),px(e,r.green),px(e,r.blue),Cx(e,2),px(e,r.constant)}Cb("PlLd",Ab("placedLayer"),(function(e,t,r){if("plcL"!==sy(e))throw new Error("Invalid PlLd signature");if(3!==$g(e))throw new Error("Invalid PlLd version");var n=cy(e,1),i=$g(e),o=$g(e);$g(e);var a=$g(e);if(!Ib[a])throw new Error("Invalid PlLd type");for(var s=[],l=0;l<8;l++)s.push(ny(e));var c=$g(e);if(0!==c)throw new Error("Invalid Warp version ".concat(c));var u=zv(e);t.placedLayer=t.placedLayer||{id:n,type:Ib[a],pageNumber:i,totalPages:o,transform:s,warp:Pb(u)},fy(e,r())}),(function(e,t){var r=t.placedLayer;if(Tx(e,"plcL"),gx(e,3),!r.id||"string"!=typeof r.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(r.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(Ax(e,r.id,1),gx(e,1),gx(e,1),gx(e,16),-1===Ib.indexOf(r.type))throw new Error("Invalid placedLayer type");gx(e,Ib.indexOf(r.type));for(var n=0;n<8;n++)wx(e,r.transform[n]);gx(e,0);var i=Yb(r),o=Fb(i)?"quiltWarp":"warp";Xv(e,"",o,Db(i),o)})),Cb("SoLd",Ab("placedLayer"),(function(e,t,r){if("soLD"!==sy(e))throw new Error("Invalid SoLd type");var n=$g(e);if(4!==n&&5!==n)throw new Error("Invalid SoLd version");var i=zv(e,!0);t.placedLayer={id:i.Idnt,placed:i.placed,type:Ib[i.Type],pageNumber:i.PgNm,totalPages:i.totalPages,frameStep:wm(i.frameStep),duration:wm(i.duration),frameCount:i.frameCount,transform:i.Trnf,width:i["Sz  "].Wdth,height:i["Sz  "].Hght,resolution:vm(i.Rslt),warp:Pb(i.quiltWarp||i.warp)},i.nonAffineTransform&&i.nonAffineTransform.some((function(e,t){return e!==i.Trnf[t]}))&&(t.placedLayer.nonAffineTransform=i.nonAffineTransform),i.Crop&&(t.placedLayer.crop=i.Crop),i.comp&&(t.placedLayer.comp=i.comp),i.compInfo&&(t.placedLayer.compInfo={compID:i.compInfo.compID,originalCompID:i.compInfo.originalCompID}),i.filterFX&&(t.placedLayer.filter=Gb(i.filterFX,e)),fy(e,r())}),(function(e,t){var r,n;Tx(e,"soLD"),gx(e,4);var i=t.placedLayer;if(!i.id||"string"!=typeof i.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(i.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");var o=Eb(Eb({Idnt:i.id,placed:null!==(r=i.placed)&&void 0!==r?r:i.id,PgNm:i.pageNumber||1,totalPages:i.totalPages||1},i.crop?{Crop:i.crop}:{}),{frameStep:i.frameStep||{numerator:0,denominator:600},duration:i.duration||{numerator:0,denominator:600},frameCount:i.frameCount||0,Annt:16,Type:Ib.indexOf(i.type),Trnf:i.transform,nonAffineTransform:null!==(n=i.nonAffineTransform)&&void 0!==n?n:i.transform,warp:Db(Yb(i)),"Sz  ":{_name:"",_classID:"Pnt ",Wdth:i.width||0,Hght:i.height||0},Rslt:i.resolution?xm(i.resolution,"resolution"):{units:"Density",value:72}});if(i.filter&&(o.filterFX={_name:"",_classID:"filterFXStyle",enab:i.filter.enabled,validAtPosition:i.filter.validAtPosition,filterMaskEnable:i.filter.maskEnabled,filterMaskLinked:i.filter.maskLinked,filterMaskExtendWithWhite:i.filter.maskExtendWithWhite,filterFXList:i.filter.list.map((function(e){return function(e){var t={_name:"",_classID:"filterFX","Nm  ":e.name,blendOptions:{_name:"",_classID:"blendOptions",Opct:bm(e.opacity),"Md  ":Tm.encode(e.blendMode)},enab:e.enabled,hasoptions:e.hasOptions,FrgC:hm(e.foregroundColor),BckC:hm(e.backgroundColor)};switch(e.type){case"average":return Eb(Eb({},t),{filterID:1098281575});case"blur":return Eb(Eb({},t),{filterID:1114403360});case"blur more":return Eb(Eb({},t),{filterID:1114403405});case"box blur":return Eb(Eb({},t),{Fltr:{_name:"Box Blur",_classID:"boxblur","Rds ":jb(e.filter)},filterID:697});case"gaussian blur":return Eb(Eb({},t),{Fltr:{_name:"Gaussian Blur",_classID:"GsnB","Rds ":jb(e.filter)},filterID:1198747202});case"motion blur":return Eb(Eb({},t),{Fltr:{_name:"Motion Blur",_classID:"MtnB",Angl:e.filter.angle,Dstn:xm(e.filter.distance,"distance")},filterID:1299476034});case"radial blur":return Eb(Eb({},t),{Fltr:{_name:"Radial Blur",_classID:"RdlB",Amnt:e.filter.amount,BlrM:qm.encode(e.filter.method),BlrQ:Vm.encode(e.filter.quality)},filterID:1382313026});case"shape blur":return Eb(Eb({},t),{Fltr:{_name:"Shape Blur",_classID:"shapeBlur","Rds ":jb(e.filter),customShape:{_name:"",_classID:"customShape","Nm  ":e.filter.customShape.name,Idnt:e.filter.customShape.id}},filterID:702});case"smart blur":return Eb(Eb({},t),{Fltr:{_name:"Smart Blur",_classID:"SmrB","Rds ":e.filter.radius,Thsh:e.filter.threshold,SmBQ:Zm.encode(e.filter.quality),SmBM:Km.encode(e.filter.mode)},filterID:1399681602});case"surface blur":return Eb(Eb({},t),{Fltr:{_name:"Surface Blur",_classID:"surfaceBlur","Rds ":jb(e.filter),Thsh:e.filter.threshold},filterID:701});case"displace":return Eb(Eb({},t),{Fltr:{_name:"Displace",_classID:"Dspl",HrzS:e.filter.horizontalScale,VrtS:e.filter.verticalScale,DspM:Jm.encode(e.filter.displacementMap),UndA:Qm.encode(e.filter.undefinedAreas),DspF:{sig:e.filter.displacementFile.signature,path:e.filter.displacementFile.path}},filterID:1148416108});case"pinch":return Eb(Eb({},t),{Fltr:{_name:"Pinch",_classID:"Pnch",Amnt:e.filter.amount},filterID:1349411688});case"polar coordinates":return Eb(Eb({},t),{Fltr:{_name:"Polar Coordinates",_classID:"Plr ",Cnvr:$m.encode(e.filter.conversion)},filterID:1349284384});case"ripple":return Eb(Eb({},t),{Fltr:{_name:"Ripple",_classID:"Rple",Amnt:e.filter.amount,RplS:eg.encode(e.filter.size)},filterID:1383099493});case"shear":return Eb(Eb({},t),{Fltr:{_name:"Shear",_classID:"Shr ",ShrP:e.filter.shearPoints.map((function(e){return{_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y}})),UndA:Qm.encode(e.filter.undefinedAreas),ShrS:e.filter.shearStart,ShrE:e.filter.shearEnd},filterID:1399353888});case"spherize":return Eb(Eb({},t),{Fltr:{_name:"Spherize",_classID:"Sphr",Amnt:e.filter.amount,SphM:tg.encode(e.filter.mode)},filterID:1399875698});case"twirl":return Eb(Eb({},t),{Fltr:{_name:"Twirl",_classID:"Twrl",Angl:e.filter.angle},filterID:1417114220});case"wave":return Eb(Eb({},t),{Fltr:{_name:"Wave",_classID:"Wave",Wvtp:rg.encode(e.filter.type),NmbG:e.filter.numberOfGenerators,WLMn:e.filter.wavelength.min,WLMx:e.filter.wavelength.max,AmMn:e.filter.amplitude.min,AmMx:e.filter.amplitude.max,SclH:e.filter.scale.x,SclV:e.filter.scale.y,UndA:Qm.encode(e.filter.undefinedAreas),RndS:e.filter.randomSeed},filterID:1466005093});case"zigzag":return Eb(Eb({},t),{Fltr:{_name:"ZigZag",_classID:"ZgZg",Amnt:e.filter.amount,NmbR:e.filter.ridges,ZZTy:ng.encode(e.filter.style)},filterID:1516722791});case"add noise":return Eb(Eb({},t),{Fltr:{_name:"Add Noise",_classID:"AdNs",Dstr:ig.encode(e.filter.distribution),Nose:bm(e.filter.amount),Mnch:e.filter.monochromatic,FlRs:e.filter.randomSeed},filterID:1097092723});case"despeckle":return Eb(Eb({},t),{filterID:1148416099});case"dust and scratches":return Eb(Eb({},t),{Fltr:{_name:"Dust & Scratches",_classID:"DstS","Rds ":e.filter.radius,Thsh:e.filter.threshold},filterID:1148417107});case"median":return Eb(Eb({},t),{Fltr:{_name:"Median",_classID:"Mdn ","Rds ":jb(e.filter)},filterID:1298427424});case"reduce noise":return Eb(Eb({},t),{Fltr:{_name:"Reduce Noise",_classID:"denoise",ClNs:bm(e.filter.reduceColorNoise),Shrp:bm(e.filter.sharpenDetails),removeJPEGArtifact:e.filter.removeJpegArtifact,channelDenoise:e.filter.channelDenoise.map((function(e){return Eb({_name:"",_classID:"channelDenoiseParams",Chnl:e.channels.map((function(e){return og.encode(e)})),Amnt:e.amount},e.preserveDetails?{EdgF:e.preserveDetails}:{})})),preset:e.filter.preset},filterID:633});case"color halftone":return Eb(Eb({},t),{Fltr:{_name:"Color Halftone",_classID:"ClrH","Rds ":e.filter.radius,Ang1:e.filter.angle1,Ang2:e.filter.angle2,Ang3:e.filter.angle3,Ang4:e.filter.angle4},filterID:1131180616});case"crystallize":return Eb(Eb({},t),{Fltr:{_name:"Crystallize",_classID:"Crst",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1131574132});case"facet":return Eb(Eb({},t),{filterID:1180922912});case"fragment":return Eb(Eb({},t),{filterID:1181902701});case"mezzotint":return Eb(Eb({},t),{Fltr:{_name:"Mezzotint",_classID:"Mztn",MztT:ag.encode(e.filter.type),FlRs:e.filter.randomSeed},filterID:1299870830});case"mosaic":return Eb(Eb({},t),{Fltr:{_name:"Mosaic",_classID:"Msc ",ClSz:xm(e.filter.cellSize,"cellSize")},filterID:1299407648});case"pointillize":return Eb(Eb({},t),{Fltr:{_name:"Pointillize",_classID:"Pntl",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1349416044});case"clouds":return Eb(Eb({},t),{Fltr:{_name:"Clouds",_classID:"Clds",FlRs:e.filter.randomSeed},filterID:1131177075});case"difference clouds":return Eb(Eb({},t),{Fltr:{_name:"Difference Clouds",_classID:"DfrC",FlRs:e.filter.randomSeed},filterID:1147564611});case"fibers":return Eb(Eb({},t),{Fltr:{_name:"Fibers",_classID:"Fbrs",Vrnc:e.filter.variance,Strg:e.filter.strength,RndS:e.filter.randomSeed},filterID:1180856947});case"lens flare":return Eb(Eb({},t),{Fltr:{_name:"Lens Flare",_classID:"LnsF",Brgh:e.filter.brightness,FlrC:{_name:"",_classID:"Pnt ",Hrzn:e.filter.position.x,Vrtc:e.filter.position.y},"Lns ":sg.encode(e.filter.lensType)},filterID:1282306886});case"sharpen":return Eb(Eb({},t),{filterID:1399353968});case"sharpen edges":return Eb(Eb({},t),{filterID:1399353925});case"sharpen more":return Eb(Eb({},t),{filterID:1399353933});case"smart sharpen":return Eb(Eb({},t),{Fltr:{_name:"Smart Sharpen",_classID:"smartSharpen",Amnt:bm(e.filter.amount),"Rds ":jb(e.filter),Thsh:e.filter.threshold,Angl:e.filter.angle,moreAccurate:e.filter.moreAccurate,blur:lg.encode(e.filter.blur),preset:e.filter.preset,sdwM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:bm(e.filter.shadow.fadeAmount),Wdth:bm(e.filter.shadow.tonalWidth),"Rds ":e.filter.shadow.radius},hglM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:bm(e.filter.highlight.fadeAmount),Wdth:bm(e.filter.highlight.tonalWidth),"Rds ":e.filter.highlight.radius}},filterID:698});case"unsharp mask":return Eb(Eb({},t),{Fltr:{_name:"Unsharp Mask",_classID:"UnsM",Amnt:bm(e.filter.amount),"Rds ":jb(e.filter),Thsh:e.filter.threshold},filterID:1433301837});case"diffuse":return Eb(Eb({},t),{Fltr:{_name:"Diffuse",_classID:"Dfs ","Md  ":cg.encode(e.filter.mode),FlRs:e.filter.randomSeed},filterID:1147564832});case"emboss":return Eb(Eb({},t),{Fltr:{_name:"Emboss",_classID:"Embs",Angl:e.filter.angle,Hght:e.filter.height,Amnt:e.filter.amount},filterID:1164796531});case"extrude":return Eb(Eb({},t),{Fltr:{_name:"Extrude",_classID:"Extr",ExtS:e.filter.size,ExtD:e.filter.depth,ExtF:e.filter.solidFrontFaces,ExtM:e.filter.maskIncompleteBlocks,ExtT:ug.encode(e.filter.type),ExtR:hg.encode(e.filter.depthMode),FlRs:e.filter.randomSeed},filterID:1165522034});case"find edges":return Eb(Eb({},t),{filterID:1181639749});case"solarize":return Eb(Eb({},t),{filterID:1399616122});case"tiles":return Eb(Eb({},t),{Fltr:{_name:"Tiles",_classID:"Tls ",TlNm:e.filter.numberOfTiles,TlOf:e.filter.maximumOffset,FlCl:dg.encode(e.filter.fillEmptyAreaWith),FlRs:e.filter.randomSeed},filterID:1416393504});case"trace contour":return Eb(Eb({},t),{Fltr:{_name:"Trace Contour",_classID:"TrcC","Lvl ":e.filter.level,"Edg ":fg.encode(e.filter.edge)},filterID:1416782659});case"wind":return Eb(Eb({},t),{Fltr:{_name:"Wind",_classID:"Wnd ",WndM:pg.encode(e.filter.method),Drct:vg.encode(e.filter.direction)},filterID:1466852384});case"de-interlace":return Eb(Eb({},t),{Fltr:{_name:"De-Interlace",_classID:"Dntr",IntE:mg.encode(e.filter.eliminate),IntC:gg.encode(e.filter.newFieldsBy)},filterID:1148089458});case"ntsc colors":return Eb(Eb({},t),{filterID:1314149187});case"custom":return Eb(Eb({},t),{Fltr:{_name:"Custom",_classID:"Cstm","Scl ":e.filter.scale,Ofst:e.filter.offset,Mtrx:e.filter.matrix},filterID:1131639917});case"high pass":return Eb(Eb({},t),{Fltr:{_name:"High Pass",_classID:"HghP","Rds ":jb(e.filter)},filterID:1214736464});case"maximum":return Eb(Eb({},t),{Fltr:{_name:"Maximum",_classID:"Mxm ","Rds ":jb(e.filter)},filterID:1299737888});case"minimum":return Eb(Eb({},t),{Fltr:{_name:"Minimum",_classID:"Mnm ","Rds ":jb(e.filter)},filterID:1299082528});case"offset":return Eb(Eb({},t),{Fltr:{_name:"Offset",_classID:"Ofst",Hrzn:e.filter.horizontal,Vrtc:e.filter.vertical,"Fl  ":yg.encode(e.filter.undefinedAreas)},filterID:1332114292});case"puppet":return Eb(Eb({},t),{Fltr:{_name:"Rigid Transform",_classID:"rigidTransform",null:["Ordn.Trgt"],rigidType:e.filter.rigidType,puppetShapeList:e.filter.puppetShapeList.map((function(e){return{_name:"",_classID:"puppetShape",rigidType:e.rigidType,VrsM:1,VrsN:0,originalVertexArray:Nb(new Float32Array(Ub(e.originalVertexArray))),deformedVertexArray:Nb(new Float32Array(Ub(e.deformedVertexArray))),indexArray:Nb(new Uint32Array(e.indexArray)),pinOffsets:Ub(e.pinOffsets),posFinalPins:Ub(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,PinP:Ub(e.pinPosition),PnRt:e.pinRotation,PnOv:e.pinOverlay,PnDp:e.pinDepth,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{_name:"",_classID:"pathClass",pathComponents:e.meshBoundaryPath.pathComponents.map((function(e){return{_name:"",_classID:"PaCm",shapeOperation:"shapeOperation.".concat(e.shapeOperation),SbpL:e.paths.map((function(e){return{_name:"",_classID:"Sbpl",Clsp:e.closed,"Pts ":e.points.map((function(e){return{_name:"",_classID:"Pthp",Anch:Hb(e.anchor),"Fwd ":Hb(e.forward),"Bwd ":Hb(e.backward),Smoo:e.smooth}}))}}))}}))},selectedPin:e.selectedPin}})),PuX0:e.filter.bounds[0].x,PuX1:e.filter.bounds[1].x,PuX2:e.filter.bounds[2].x,PuX3:e.filter.bounds[3].x,PuY0:e.filter.bounds[0].y,PuY1:e.filter.bounds[1].y,PuY2:e.filter.bounds[2].y,PuY3:e.filter.bounds[3].y},filterID:991});case"oil paint plugin":for(var r={},n=0;n<e.filter.parameters.length;n++){var i=e.filter.parameters[n],o=i.name,a=i.value,s="".concat(_b[Math.floor(n/_b.length)]).concat(_b[n%_b.length]);r["PN".concat(s)]=o,r["PT".concat(s)]=0,r["PF".concat(s)]=a}return Eb(Eb({},t),{Fltr:Eb({_name:"Oil Paint Plugin",_classID:"PbPl",KnNm:e.filter.name,GpuY:e.filter.gpu,LIWy:e.filter.lighting,FPth:"1"},r),filterID:1348620396});case"oil paint":return Eb(Eb({},t),{Fltr:{_name:"Oil Paint",_classID:"oilPaint",lightingOn:e.filter.lightingOn,stylization:e.filter.stylization,cleanliness:e.filter.cleanliness,brushScale:e.filter.brushScale,microBrush:e.filter.microBrush,LghD:e.filter.lightDirection,specularity:e.filter.specularity},filterID:1122});case"liquify":return Eb(Eb({},t),{Fltr:{_name:"Liquify",_classID:"LqFy",LqMe:e.filter.liquifyMesh},filterID:1282492025});case"perspective warp":return Eb(Eb({},t),{Fltr:{_name:"Perspective Warp",_classID:"perspectiveWarpTransform",vertices:e.filter.vertices.map(Hb),warpedVertices:e.filter.warpedVertices.map(Hb),quads:e.filter.quads.map((function(e){return{indices:e}}))},filterID:442});case"curves":return Eb(Eb({},t),{Fltr:{_name:"Curves",_classID:"Crvs",presetKind:bg.encode(e.filter.presetKind),Adjs:e.filter.adjustments.map((function(e){return"curve"in e?{_name:"",_classID:"CrvA",Chnl:e.channels.map((function(e){return og.encode(e)})),"Crv ":e.curve.map((function(e){return Eb({_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y},e.curved?{Cnty:!0}:{})}))}:{_name:"",_classID:"CrvA",Chnl:e.channels.map((function(e){return og.encode(e)})),Mpng:e.values}}))},filterID:1131574899});default:throw new Error("Unknow filter type: ".concat(e.type))}}(e)}))}),i.warp&&Fb(i.warp)){var a=Db(i.warp);o.quiltWarp=a,o.warp={warpStyle:"warpStyle.warpNone",warpValue:a.warpValue,warpPerspective:a.warpPerspective,warpPerspectiveOther:a.warpPerspectiveOther,warpRotate:a.warpRotate,bounds:a.bounds,uOrder:a.uOrder,vOrder:a.vOrder}}else delete o.quiltWarp;i.comp&&(o.comp=i.comp),i.compInfo&&(o.compInfo=i.compInfo),Xv(e,"","null",o,o.quiltWarp?"quiltWarp":"warp")})),Tb("SoLE","SoLd"),Cb("fxrp",Ab("referencePoint"),(function(e,t){t.referencePoint={x:ny(e),y:ny(e)}}),(function(e,t){wx(e,t.referencePoint.x),wx(e,t.referencePoint.y)})),Cb("Lr16",(function(){return!1}),(function(e,t,r,n,i){yy(e,n,i)}),(function(e,t){})),Cb("Lr32",(function(){return!1}),(function(e,t,r,n,i){yy(e,n,i)}),(function(e,t){})),Cb("LMsk",Ab("userMask"),(function(e,t){if(t.userMask={colorSpace:Iy(e),opacity:Jg(e)/255},128!==Vg(e))throw new Error("Invalid flag value");fy(e,1)}),(function(e,t){var r=t.userMask;Ix(e,r.colorSpace),vx(e,255*Kp(r.opacity,0,1)),fx(e,128),Cx(e,1)})),Cb("Patt",(function(e){return!e}),(function(e,t,r){r()&&fy(e,r())}),(function(e,t){})),Cb("Anno",(function(e){return void 0!==e.annotations}),(function(e,t,r){var n=Jg(e),i=Jg(e);if(2!==n||1!==i)throw new Error("Invalid Anno version");for(var o=ty(e),a=[],s=0;s<o;s++){ty(e);var l=sy(e),c=!!Vg(e);Vg(e),Jg(e);var u=Wb(e),h=Wb(e),d=Iy(e),f=cy(e,2),p=cy(e,2),v=cy(e,2);ty(e),sy(e);var m=ty(e),g=void 0;if("txtA"===l)m>=2&&65279===Jg(e)?g=hy(e,(m-2)/2):(e.offset-=2,g=dy(e,m)),g=g.replace(/\r/g,"\n");else{if("sndA"!==l)throw new Error("Unknown annotation type");g=ay(e,m)}a.push({type:"txtA"===l?"text":"sound",open:c,iconLocation:u,popupLocation:h,color:d,author:f,name:p,date:v,data:g})}t.annotations=a,fy(e,r())}),(function(e,t){var r=t.annotations;vx(e,2),vx(e,1),bx(e,r.length);for(var n=0,i=r;n<i.length;n++){var o=i[n],a="sound"===o.type;if(a&&!(o.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!a&&"string"!=typeof o.data)throw new Error("Text annotation data should be string");var s=e.offset;bx(e,0),Tx(e,a?"sndA":"txtA"),fx(e,o.open?1:0),fx(e,28),vx(e,1),qb(e,o.iconLocation),qb(e,o.popupLocation),Ix(e,o.color),Ax(e,o.author||"",2),Ax(e,o.name||"",2),Ax(e,o.date||"",2);var l=e.offset;bx(e,0),Tx(e,a?"sndM":"txtC"),bx(e,0);var c=e.offset;if(a)Sx(e,o.data);else{vx(e,65279);for(var u=o.data.replace(/\n/g,"\r"),h=0;h<u.length;h++)vx(e,u.charCodeAt(h))}e.view.setUint32(s,e.offset-s,!1),e.view.setUint32(l,e.offset-l,!1),e.view.setUint32(c-4,e.offset-c,!1)}})),Vb("lnk2"),Vb("lnkE"),Tb("lnkD","lnk2"),Tb("lnk3","lnk2"),Cb("pths",Ab("pathList"),(function(e,t){zv(e,!0),t.pathList=[]}),(function(e,t){Xv(e,"","pathsDataClass",{pathList:[]})})),Cb("lyvr",Ab("version"),(function(e,t){return t.version=ty(e)}),(function(e,t){return bx(e,t.version)})),Cb("brit",Kb("brightness/contrast"),(function(e,t,r){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:Zg(e),contrast:Zg(e),meanValue:Zg(e),labColorOnly:!!Vg(e),useLegacy:!0}),fy(e,r())}),(function(e,t){var r,n=t.adjustment;px(e,n.brightness||0),px(e,n.contrast||0),px(e,null!==(r=n.meanValue)&&void 0!==r?r:127),fx(e,n.labColorOnly?1:0),Cx(e,1)})),Cb("levl",Kb("levels"),(function(e,t,r){if(2!==Jg(e))throw new Error("Invalid levl version");t.adjustment=Eb(Eb({},t.adjustment),{type:"levels",rgb:Zb(e),red:Zb(e),green:Zb(e),blue:Zb(e)}),fy(e,r())}),(function(e,t){var r=t.adjustment,n={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};vx(e,2),Jb(e,r.rgb||n),Jb(e,r.red||n),Jb(e,r.blue||n),Jb(e,r.green||n);for(var i=0;i<59;i++)Jb(e,n)})),Cb("curv",Kb("curves"),(function(e,t,r){if(Vg(e),1!==Jg(e))throw new Error("Invalid curv version");Jg(e);var n=Jg(e),i={type:"curves"};1&n&&(i.rgb=Qb(e)),2&n&&(i.red=Qb(e)),4&n&&(i.green=Qb(e)),8&n&&(i.blue=Qb(e)),t.adjustment=Eb(Eb({},t.adjustment),i),fy(e,r())}),(function(e,t){var r=t.adjustment,n=r.rgb,i=r.red,o=r.green,a=r.blue,s=0,l=0;n&&n.length&&(s|=1,l++),i&&i.length&&(s|=2,l++),o&&o.length&&(s|=4,l++),a&&a.length&&(s|=8,l++),fx(e,0),vx(e,1),vx(e,0),vx(e,s),n&&n.length&&$b(e,n),i&&i.length&&$b(e,i),o&&o.length&&$b(e,o),a&&a.length&&$b(e,a),Tx(e,"Crv "),vx(e,4),vx(e,0),vx(e,l),n&&n.length&&(vx(e,0),$b(e,n)),i&&i.length&&(vx(e,1),$b(e,i)),o&&o.length&&(vx(e,2),$b(e,o)),a&&a.length&&(vx(e,3),$b(e,a)),Cx(e,2)})),Cb("expA",Kb("exposure"),(function(e,t,r){if(1!==Jg(e))throw new Error("Invalid expA version");t.adjustment=Eb(Eb({},t.adjustment),{type:"exposure",exposure:ry(e),offset:ry(e),gamma:ry(e)}),fy(e,r())}),(function(e,t){var r=t.adjustment;vx(e,1),xx(e,r.exposure),xx(e,r.offset),xx(e,r.gamma),Cx(e,2)})),Cb("vibA",Kb("vibrance"),(function(e,t,r){var n=zv(e);t.adjustment={type:"vibrance"},void 0!==n.vibrance&&(t.adjustment.vibrance=n.vibrance),void 0!==n.Strt&&(t.adjustment.saturation=n.Strt),fy(e,r())}),(function(e,t){var r=t.adjustment,n={};void 0!==r.vibrance&&(n.vibrance=r.vibrance),void 0!==r.saturation&&(n.Strt=r.saturation),Xv(e,"","null",n)})),Cb("hue2",Kb("hue/saturation"),(function(e,t,r){if(2!==Jg(e))throw new Error("Invalid hue2 version");t.adjustment=Eb(Eb({},t.adjustment),{type:"hue/saturation",master:ex(e),reds:ex(e),yellows:ex(e),greens:ex(e),cyans:ex(e),blues:ex(e),magentas:ex(e)}),fy(e,r())}),(function(e,t){var r=t.adjustment;vx(e,2),tx(e,r.master),tx(e,r.reds),tx(e,r.yellows),tx(e,r.greens),tx(e,r.cyans),tx(e,r.blues),tx(e,r.magentas)})),Cb("blnc",Kb("color balance"),(function(e,t,r){t.adjustment={type:"color balance",shadows:rx(e),midtones:rx(e),highlights:rx(e),preserveLuminosity:!!Vg(e)},fy(e,r())}),(function(e,t){var r=t.adjustment;nx(e,r.shadows||{}),nx(e,r.midtones||{}),nx(e,r.highlights||{}),fx(e,r.preserveLuminosity?1:0),Cx(e,1)})),Cb("blwh",Kb("black & white"),(function(e,t,r){var n=zv(e);t.adjustment={type:"black & white",reds:n["Rd  "],yellows:n.Yllw,greens:n["Grn "],cyans:n["Cyn "],blues:n["Bl  "],magentas:n.Mgnt,useTint:!!n.useTint,presetKind:n.bwPresetKind,presetFileName:n.blackAndWhitePresetFileName},void 0!==n.tintColor&&(t.adjustment.tintColor=um(n.tintColor)),fy(e,r())}),(function(e,t){var r=t.adjustment;Xv(e,"","null",{"Rd  ":r.reds||0,Yllw:r.yellows||0,"Grn ":r.greens||0,"Cyn ":r.cyans||0,"Bl  ":r.blues||0,Mgnt:r.magentas||0,useTint:!!r.useTint,tintColor:hm(r.tintColor),bwPresetKind:r.presetKind||0,blackAndWhitePresetFileName:r.presetFileName||""})})),Cb("phfl",Kb("photo filter"),(function(e,t,r){var n,i=Jg(e);if(2!==i&&3!==i)throw new Error("Invalid phfl version");n=2===i?Iy(e):{l:$g(e)/100,a:$g(e)/100,b:$g(e)/100},t.adjustment={type:"photo filter",color:n,density:ty(e)/100,preserveLuminosity:!!Vg(e)},fy(e,r())}),(function(e,t){var r=t.adjustment;vx(e,2),Ix(e,r.color||{l:0,a:0,b:0}),bx(e,100*(r.density||0)),fx(e,r.preserveLuminosity?1:0),Cx(e,3)})),Cb("mixr",Kb("channel mixer"),(function(e,t,r){if(1!==Jg(e))throw new Error("Invalid mixr version");var n=t.adjustment=Eb(Eb({},t.adjustment),{type:"channel mixer",monochrome:!!Jg(e)});n.monochrome||(n.red=ix(e),n.green=ix(e),n.blue=ix(e)),n.gray=ix(e),fy(e,r())}),(function(e,t){var r=t.adjustment;vx(e,1),vx(e,r.monochrome?1:0),r.monochrome?(ox(e,r.gray),Cx(e,30)):(ox(e,r.red),ox(e,r.green),ox(e,r.blue),ox(e,r.gray))}));var ax=qp("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),sx=qp("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),lx=qp("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});Cb("clrL",Kb("color lookup"),(function(e,t,r){if(1!==Jg(e))throw new Error("Invalid clrL version");var n=zv(e);t.adjustment={type:"color lookup"};var i=t.adjustment;void 0!==n.lookupType&&(i.lookupType=ax.decode(n.lookupType)),void 0!==n["Nm  "]&&(i.name=n["Nm  "]),void 0!==n.Dthr&&(i.dither=n.Dthr),void 0!==n.profile&&(i.profile=n.profile),void 0!==n.LUTFormat&&(i.lutFormat=sx.decode(n.LUTFormat)),void 0!==n.dataOrder&&(i.dataOrder=lx.decode(n.dataOrder)),void 0!==n.tableOrder&&(i.tableOrder=lx.decode(n.tableOrder)),void 0!==n.LUT3DFileData&&(i.lut3DFileData=n.LUT3DFileData),void 0!==n.LUT3DFileName&&(i.lut3DFileName=n.LUT3DFileName),fy(e,r())}),(function(e,t){var r=t.adjustment,n={};void 0!==r.lookupType&&(n.lookupType=ax.encode(r.lookupType)),void 0!==r.name&&(n["Nm  "]=r.name),void 0!==r.dither&&(n.Dthr=r.dither),void 0!==r.profile&&(n.profile=r.profile),void 0!==r.lutFormat&&(n.LUTFormat=sx.encode(r.lutFormat)),void 0!==r.dataOrder&&(n.dataOrder=lx.encode(r.dataOrder)),void 0!==r.tableOrder&&(n.tableOrder=lx.encode(r.tableOrder)),void 0!==r.lut3DFileData&&(n.LUT3DFileData=r.lut3DFileData),void 0!==r.lut3DFileName&&(n.LUT3DFileName=r.lut3DFileName),vx(e,1),Xv(e,"","null",n)})),Cb("nvrt",Kb("invert"),(function(e,t,r){t.adjustment={type:"invert"},fy(e,r())}),(function(){})),Cb("post",Kb("posterize"),(function(e,t,r){t.adjustment={type:"posterize",levels:Jg(e)},fy(e,r())}),(function(e,t){var r;vx(e,null!==(r=t.adjustment.levels)&&void 0!==r?r:4),Cx(e,2)})),Cb("thrs",Kb("threshold"),(function(e,t,r){t.adjustment={type:"threshold",level:Jg(e)},fy(e,r())}),(function(e,t){var r;vx(e,null!==(r=t.adjustment.level)&&void 0!==r?r:128),Cx(e,2)}));var cx=["","","","rgb","hsb","","lab"];function ux(e){return{c:Zg(e),m:Zg(e),y:Zg(e),k:Zg(e)}}function hx(e,t){var r=t||{};px(e,r.c),px(e,r.m),px(e,r.y),px(e,r.k)}function dx(e){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return Array.isArray(e)&&e.length>1}))}Cb("grdm",Kb("gradient map"),(function(e,t,r){if(1!==Jg(e))throw new Error("Invalid grdm version");var n={type:"gradient map",gradientType:"solid"};n.reverse=!!Vg(e),n.dither=!!Vg(e),n.name=uy(e),n.colorStops=[],n.opacityStops=[];for(var i=Jg(e),o=0;o<i;o++)n.colorStops.push({location:ty(e),midpoint:ty(e)/100,color:Iy(e)}),fy(e,2);var a=Jg(e);for(o=0;o<a;o++)n.opacityStops.push({location:ty(e),midpoint:ty(e)/100,opacity:Jg(e)/255});if(2!==Jg(e))throw new Error("Invalid grdm expansion count");var s=Jg(e);if(n.smoothness=s/4096,32!==Jg(e))throw new Error("Invalid grdm length");n.gradientType=Jg(e)?"noise":"solid",n.randomSeed=ty(e),n.addTransparency=!!Jg(e),n.restrictColors=!!Jg(e),n.roughness=ty(e)/4096,n.colorModel=cx[Jg(e)]||"rgb",n.min=[Jg(e)/32768,Jg(e)/32768,Jg(e)/32768,Jg(e)/32768],n.max=[Jg(e)/32768,Jg(e)/32768,Jg(e)/32768,Jg(e)/32768],fy(e,r());for(var l=0,c=n.colorStops;l<c.length;l++){c[l].location/=s}for(var u=0,h=n.opacityStops;u<h.length;u++){h[u].location/=s}t.adjustment=n}),(function(e,t){var r,n,i,o=t.adjustment;vx(e,1),fx(e,o.reverse?1:0),fx(e,o.dither?1:0),Mx(e,o.name||""),vx(e,o.colorStops&&o.colorStops.length||0);for(var a=Math.round(4096*(null!==(r=o.smoothness)&&void 0!==r?r:1)),s=0,l=o.colorStops||[];s<l.length;s++){var c=l[s];bx(e,Math.round(c.location*a)),bx(e,Math.round(100*c.midpoint)),Ix(e,c.color),Cx(e,2)}vx(e,o.opacityStops&&o.opacityStops.length||0);for(var u=0,h=o.opacityStops||[];u<h.length;u++){c=h[u];bx(e,Math.round(c.location*a)),bx(e,Math.round(100*c.midpoint)),vx(e,Math.round(255*c.opacity))}vx(e,2),vx(e,a),vx(e,32),vx(e,"noise"===o.gradientType?1:0),bx(e,o.randomSeed||0),vx(e,o.addTransparency?1:0),vx(e,o.restrictColors?1:0),bx(e,Math.round(4096*(null!==(n=o.roughness)&&void 0!==n?n:1)));var d=cx.indexOf(null!==(i=o.colorModel)&&void 0!==i?i:"rgb");vx(e,-1===d?3:d);for(var f=0;f<4;f++)vx(e,Math.round(32768*(o.min&&o.min[f]||0)));for(f=0;f<4;f++)vx(e,Math.round(32768*(o.max&&o.max[f]||0)));Cx(e,4)})),Cb("selc",Kb("selective color"),(function(e,t){if(1!==Jg(e))throw new Error("Invalid selc version");var r=Jg(e)?"absolute":"relative";fy(e,8),t.adjustment={type:"selective color",mode:r,reds:ux(e),yellows:ux(e),greens:ux(e),cyans:ux(e),blues:ux(e),magentas:ux(e),whites:ux(e),neutrals:ux(e),blacks:ux(e)}}),(function(e,t){var r=t.adjustment;vx(e,1),vx(e,"absolute"===r.mode?1:0),Cx(e,8),hx(e,r.reds),hx(e,r.yellows),hx(e,r.greens),hx(e,r.cyans),hx(e,r.blues),hx(e,r.magentas),hx(e,r.whites),hx(e,r.neutrals),hx(e,r.blacks)})),Cb("CgEd",(function(e){var t=e.adjustment;return!!t&&("brightness/contrast"===t.type&&!t.useLegacy||("levels"===t.type||"curves"===t.type||"exposure"===t.type||"channel mixer"===t.type||"hue/saturation"===t.type)&&void 0!==t.presetFileName)}),(function(e,t,r){var n=zv(e);if(1!==n.Vrsn)throw new Error("Invalid CgEd version");t.adjustment="presetFileName"in n?Eb(Eb({},t.adjustment),{presetKind:n.presetKind,presetFileName:n.presetFileName}):"curvesPresetFileName"in n?Eb(Eb({},t.adjustment),{presetKind:n.curvesPresetKind,presetFileName:n.curvesPresetFileName}):"mixerPresetFileName"in n?Eb(Eb({},t.adjustment),{presetKind:n.mixerPresetKind,presetFileName:n.mixerPresetFileName}):{type:"brightness/contrast",brightness:n.Brgh,contrast:n.Cntr,meanValue:n.means,useLegacy:!!n.useLegacy,labColorOnly:!!n["Lab "],auto:!!n.Auto},fy(e,r())}),(function(e,t){var r,n,i,o,a=t.adjustment;if("levels"===a.type||"exposure"===a.type||"hue/saturation"===a.type)Xv(e,"","null",{Vrsn:1,presetKind:null!==(r=a.presetKind)&&void 0!==r?r:1,presetFileName:a.presetFileName||""});else if("curves"===a.type){Xv(e,"","null",{Vrsn:1,curvesPresetKind:null!==(n=a.presetKind)&&void 0!==n?n:1,curvesPresetFileName:a.presetFileName||""})}else if("channel mixer"===a.type){Xv(e,"","null",{Vrsn:1,mixerPresetKind:null!==(i=a.presetKind)&&void 0!==i?i:1,mixerPresetFileName:a.presetFileName||""})}else{if("brightness/contrast"!==a.type)throw new Error("Unhandled CgEd case");Xv(e,"","null",{Vrsn:1,Brgh:a.brightness||0,Cntr:a.contrast||0,means:null!==(o=a.meanValue)&&void 0!==o?o:127,"Lab ":!!a.labColorOnly,useLegacy:!!a.useLegacy,Auto:!!a.auto})}})),Cb("Txt2",Ab("engineData"),(function(e,t,r,n){var i=ay(e,r());t.engineData=Ee(i);var o=function(e){var t=[];return function e(r){var n;if(r.children)for(var i=0,o=r.children;i<o.length;i++){var a=o[i];void 0!==(null===(n=a.text)||void 0===n?void 0:n.index)&&(t[a.text.index]=a),e(a)}}(e),t}(n),a=wb(Hy(i)).ResourceDict.TextFrameSet;if(a)for(var s=0;s<a.length;s++){var l=o[s];a[s].path&&(null==l?void 0:l.text)&&(l.text.textPath=a[s].path)}}),(function(e,t){Sx(e,we(t.engineData))})),Cb("FEid",Ab("filterEffectsMasks"),(function(e,t,r){var n=$g(e);if(n<1||n>3)throw new Error("Invalid filterEffects version ".concat(n));for(t.filterEffectsMasks=[];r()>8;){if(ty(e))throw new Error("filterEffects: 64 bit length is not supported");var i=ty(e),o=e.offset+i,a=cy(e,1),s=$g(e);if(1!==s)throw new Error("Invalid filterEffect version ".concat(s));if(ty(e))throw new Error("filterEffect: 64 bit length is not supported");ty(e);for(var l=$g(e),c=$g(e),u=$g(e),h=$g(e),d=$g(e),f=$g(e),p=[],v=0;v<f+2;v++){if($g(e)){if(ty(e))throw new Error("filterEffect: 64 bit length is not supported");var m=ty(e);if(!m)throw new Error("filterEffect: Empty channel");var g=Jg(e),y=ay(e,m-2);p.push({compressionMode:g,data:y})}else p.push(void 0)}if(t.filterEffectsMasks.push({id:a,top:l,left:c,bottom:u,right:h,depth:d,channels:p}),e.offset<o&&Vg(e)){var b=$g(e),x=$g(e),w=$g(e),E=$g(e);if(ty(e))throw new Error("filterEffect: 64 bit length is not supported");var _=ty(e);g=Jg(e),y=ay(e,_-2);t.filterEffectsMasks[t.filterEffectsMasks.length-1].extra={top:b,left:x,bottom:w,right:E,compressionMode:g,data:y}}e.offset=o;for(var S=i;S%4;)e.offset++,S++}}),(function(e,t){var r;gx(e,3);for(var n=0,i=t.filterEffectsMasks;n<i.length;n++){var o=i[n];bx(e,0),bx(e,0);var a=e.offset;Ax(e,o.id,1),gx(e,1),bx(e,0),bx(e,0);var s=e.offset;gx(e,o.top),gx(e,o.left),gx(e,o.bottom),gx(e,o.right),gx(e,o.depth);var l=Math.max(0,o.channels.length-2);gx(e,l);for(var c=0;c<l+2;c++){var u=o.channels[c];gx(e,u?1:0),u&&(bx(e,0),bx(e,u.data.length+2),vx(e,u.compressionMode),Sx(e,u.data))}e.view.setUint32(s-4,e.offset-s,!1);var h=null===(r=t.filterEffectsMasks[t.filterEffectsMasks.length-1])||void 0===r?void 0:r.extra;h&&(fx(e,1),gx(e,h.top),gx(e,h.left),gx(e,h.bottom),gx(e,h.right),bx(e,0),bx(e,h.data.byteLength+2),vx(e,h.compressionMode),Sx(e,h.data));var d=e.offset-a;for(e.view.setUint32(a-4,d,!1);d%4;)Cx(e,1),d++}})),Tb("FXid","FEid"),Cb("FMsk",Ab("filterMask"),(function(e,t){t.filterMask={colorSpace:Iy(e),opacity:Jg(e)/255}}),(function(e,t){var r;Ix(e,t.filterMask.colorSpace),vx(e,255*Kp(null!==(r=t.filterMask.opacity)&&void 0!==r?r:1,0,1))})),Cb("artd",(function(e){return void 0!==e.artboards}),(function(e,t,r){var n=zv(e);t.artboards={count:n["Cnt "],autoExpandOffset:{horizontal:n.autoExpandOffset.Hrzn,vertical:n.autoExpandOffset.Vrtc},origin:{horizontal:n.origin.Hrzn,vertical:n.origin.Vrtc},autoExpandEnabled:n.autoExpandEnabled,autoNestEnabled:n.autoNestEnabled,autoPositionEnabled:n.autoPositionEnabled,shrinkwrapOnSaveEnabled:!!n.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:um(n.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:n.docDefaultNewArtboardBackgroundType},fy(e,r())}),(function(e,t){var r,n,i,o,a,s=t.artboards;Xv(e,"","null",{"Cnt ":s.count,autoExpandOffset:s.autoExpandOffset?{Hrzn:s.autoExpandOffset.horizontal,Vrtc:s.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:s.origin?{Hrzn:s.origin.horizontal,Vrtc:s.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:null===(r=s.autoExpandEnabled)||void 0===r||r,autoNestEnabled:null===(n=s.autoNestEnabled)||void 0===n||n,autoPositionEnabled:null===(i=s.autoPositionEnabled)||void 0===i||i,shrinkwrapOnSaveEnabled:null===(o=s.shrinkwrapOnSaveEnabled)||void 0===o||o,docDefaultNewArtboardBackgroundColor:hm(s.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:null!==(a=s.docDefaultNewArtboardBackgroundType)&&void 0!==a?a:1},"artd")})),Cb("lfx2",(function(e){return void 0!==e.effects&&!dx(e.effects)}),(function(e,t,r){if(0!==ty(e))throw new Error("Invalid lfx2 version");var n=zv(e);t.effects=Kv(n,!!e.logMissingFeatures),fy(e,r())}),(function(e,t,r,n){var i=Vv(t.effects,!!n.logMissingFeatures,!0);bx(e,0),Xv(e,"","null",i)})),Cb("cinf",Ab("compositorUsed"),(function(e,t,r){var n=zv(e);function i(e){return e.split(".")[1]}t.compositorUsed={description:n.description,reason:n.reason,engine:i(n.Engn)},n.Vrsn&&(t.compositorUsed.version=n.Vrsn),n.psVersion&&(t.compositorUsed.photoshopVersion=n.psVersion),n.enableCompCore&&(t.compositorUsed.enableCompCore=i(n.enableCompCore)),n.enableCompCoreGPU&&(t.compositorUsed.enableCompCoreGPU=i(n.enableCompCoreGPU)),n.enableCompCoreThreads&&(t.compositorUsed.enableCompCoreThreads=i(n.enableCompCoreThreads)),n.compCoreSupport&&(t.compositorUsed.compCoreSupport=i(n.compCoreSupport)),n.compCoreGPUSupport&&(t.compositorUsed.compCoreGPUSupport=i(n.compCoreGPUSupport)),fy(e,r())}),(function(e,t){var r=t.compositorUsed,n={Vrsn:r.version||{major:1,minor:0,fix:0}};r.photoshopVersion&&(n.psVersion=r.photoshopVersion),n.description=r.description,n.reason=r.reason,n.Engn="Engn.".concat(r.engine),r.enableCompCore&&(n.enableCompCore="enable.".concat(r.enableCompCore)),r.enableCompCoreGPU&&(n.enableCompCoreGPU="enable.".concat(r.enableCompCoreGPU)),r.enableCompCoreThreads&&(n.enableCompCoreThreads="enable.".concat(r.enableCompCoreThreads)),r.compCoreSupport&&(n.compCoreSupport="reason.".concat(r.compCoreSupport)),r.compCoreGPUSupport&&(n.compCoreGPUSupport="reason.".concat(r.compCoreGPUSupport)),Xv(e,"","null",n)})),Cb("extn",(function(e){return void 0!==e._extn}),(function(e,t){zv(e)}),(function(e,t){})),Cb("iOpa",Ab("fillOpacity"),(function(e,t){t.fillOpacity=Vg(e)/255,fy(e,3)}),(function(e,t){fx(e,255*t.fillOpacity),Cx(e,3)})),Cb("brst",Ab("channelBlendingRestrictions"),(function(e,t,r){for(t.channelBlendingRestrictions=[];r()>4;)t.channelBlendingRestrictions.push($g(e))}),(function(e,t){for(var r=0,n=t.channelBlendingRestrictions;r<n.length;r++){gx(e,n[r])}})),Cb("tsly",Ab("transparencyShapesLayer"),(function(e,t){t.transparencyShapesLayer=!!Vg(e),fy(e,3)}),(function(e,t){fx(e,t.transparencyShapesLayer?1:0),Cx(e,3)}));function fx(e,t){var r=Rx(e,1);e.view.setUint8(r,t)}function px(e,t){var r=Rx(e,2);e.view.setInt16(r,t,!1)}function vx(e,t){var r=Rx(e,2);e.view.setUint16(r,t,!1)}function mx(e,t){var r=Rx(e,2);e.view.setUint16(r,t,!0)}function gx(e,t){var r=Rx(e,4);e.view.setInt32(r,t,!1)}function yx(e,t){var r=Rx(e,4);e.view.setInt32(r,t,!0)}function bx(e,t){var r=Rx(e,4);e.view.setUint32(r,t,!1)}function xx(e,t){var r=Rx(e,4);e.view.setFloat32(r,t,!1)}function wx(e,t){var r=Rx(e,8);e.view.setFloat64(r,t,!1)}function Ex(e,t){gx(e,65536*t)}function _x(e,t){gx(e,t*(1<<24))}function Sx(e,t){t&&(Lx(e,e.offset+t.length),new Uint8Array(e.buffer).set(t,e.offset),e.offset+=t.length)}function Cx(e,t){for(var r=0;r<t;r++)fx(e,0)}function Tx(e,t){if(4!==t.length)throw new Error("Invalid signature: '".concat(t,"'"));for(var r=0;r<4;r++)fx(e,t.charCodeAt(r))}function Ax(e,t,r){var n=t.length;if(n>255)throw new Error("String too long");fx(e,n);for(var i=0;i<n;i++){var o=t.charCodeAt(i);fx(e,o<128?o:"?".charCodeAt(0))}for(;++n%r;)fx(e,0)}function kx(e,t){bx(e,t.length),function(e,t){for(var r=0;r<t.length;r++)vx(e,t.charCodeAt(r))}(e,t)}function Mx(e,t){bx(e,t.length+1);for(var r=0;r<t.length;r++)vx(e,t.charCodeAt(r));vx(e,0)}function Ox(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),i&&bx(e,0);var o=e.offset;bx(e,0),r();for(var a=e.offset-o-4,s=a;s%t!=0;)fx(e,0),s++;n&&(a=s),e.view.setUint32(o,a,!1)}function Lx(e,t){t>e.buffer.byteLength&&function(e,t){var r=e.buffer.byteLength;do{r*=2}while(t>r);var n=new ArrayBuffer(r),i=new Uint8Array(n),o=new Uint8Array(e.buffer);i.set(o),e.buffer=n,e.view=new DataView(e.buffer)}(e,t)}function Rx(e,t){var r=e.offset;return Lx(e,e.offset+=t),r}function Ix(e,t){t?"r"in t?(vx(e,0),vx(e,Math.round(257*t.r)),vx(e,Math.round(257*t.g)),vx(e,Math.round(257*t.b)),vx(e,0)):"fr"in t?(vx(e,0),vx(e,Math.round(255*t.fr*257)),vx(e,Math.round(255*t.fg*257)),vx(e,Math.round(255*t.fb*257)),vx(e,0)):"l"in t?(vx(e,7),px(e,Math.round(1e4*t.l)),px(e,Math.round(t.a<0?12800*t.a:12700*t.a)),px(e,Math.round(t.b<0?12800*t.b:12700*t.b)),vx(e,0)):"h"in t?(vx(e,1),vx(e,Math.round(65535*t.h)),vx(e,Math.round(65535*t.s)),vx(e,Math.round(65535*t.b)),vx(e,0)):"c"in t?(vx(e,2),vx(e,Math.round(257*t.c)),vx(e,Math.round(257*t.m)),vx(e,Math.round(257*t.y)),vx(e,Math.round(257*t.k))):(vx(e,8),vx(e,Math.round(1e4*t.k/255)),Cx(e,6)):(vx(e,0),Cx(e,8))}var Px,Fx,Dx,Nx;function Bx(e,t,r){return J(this,void 0,void 0,(function(){var n,i,o,a,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C,T,A,k,M,O,L,R,I,P,F,D,N,B,U,z,X,H,G,j,Y,W,q,V,K,J,ee,te,re,ne,ie,oe,ae,se,le,ce,ue,he,de,fe,pe,ve,me,ge,ye,be,xe,we,Ee,_e,Se,Ce,Te,Ae,ke,Me,Oe,Le,Re,Ie,Pe,Fe,De,Ne,Be,Ue,ze,Xe,He,Ge,je,Ye,We,qe,Ve,Ke,Ze,Je,Qe,$e,et,tt,rt,nt,it,ot,at,st,lt,ct,ut,ht,dt,ft,pt,vt,mt,gt,yt,bt,xt,wt,Et,_t,St,Ct,Tt,At,kt,Mt,Ot,Lt,Rt,It;return Q(this,(function(Q){switch(Q.label){case 0:if(n=e.name,i=e.opacity,o=e.hidden,a=e.top,c=void 0===a?0:a,u=e.left,h=void 0===u?0:u,d=e.bottom,f=void 0===d?0:d,p=e.right,v=void 0===p?0:p,m=e.effects,g=void 0===m?{}:m,y=e.blendMode,b=e.canvas,x=o?"hidden":"visible",w=[],E=[],_=[],S=[],C=[],T=[],A=[],k=[],M=new Promise((function(e){if(!b)return e(void 0);b.toBlob((function(o){if(o)return e({tagName:l.BITMAP,props:{uuid:s(),name:n,style:{left:100*h/t+"%",top:100*c/r+"%",right:100*(t-v)/t+"%",bottom:100*(r-f)/r+"%",opacity:i,visibility:x,shadow:w,shadowEnable:E,innerShadow:_,innerShadowEnable:S,mixBlendMode:y,fill:C,fillEnable:T,fillOpacity:A,fillMode:k},src:URL.createObjectURL(o)}});e(void 0)}))})),g.dropShadow)for(be=g.dropShadow.length-1;be>=0;be--)X=g.dropShadow[be],st=$($([],Xx(X.color),!0),[null!==(ht=X.opacity)&&void 0!==ht?ht:1],!1),L=wc(X.angle||0),$e=(null===(dt=X.distance)||void 0===dt?void 0:dt.value)||0,R=Math.acos(L)*$e||0,I=Math.sin(L)*$e||0,O=(null===(ft=X.size)||void 0===ft?void 0:ft.value)||0,F=(null===(pt=X.choke)||void 0===pt?void 0:pt.value)||0,w.push("".concat(qu(st)," ").concat(R," ").concat(I," ").concat(O*(100-F)*.01," ").concat(O*F*.01)),E.push(!g.disabled&&!!X.enabled);if(g.innerShadow)for(be=g.innerShadow.length-1;be>=0;be--)X=g.innerShadow[be],st=$($([],Xx(X.color),!0),[null!==(vt=X.opacity)&&void 0!==vt?vt:1],!1),L=wc(X.angle||0),$e=(null===(mt=X.distance)||void 0===mt?void 0:mt.value)||0,R=Math.acos(L)*$e||0,I=Math.sin(L)*$e||0,P=(null===(gt=X.size)||void 0===gt?void 0:gt.value)||0,F=(null===(yt=X.choke)||void 0===yt?void 0:yt.value)||0,_.push("".concat(qu(st)," ").concat(R," ").concat(I," ").concat(P*(100-F)*.01," ").concat(P*F*.01)),S.push(!g.disabled&&!!X.enabled);if(g.solidFill)for(be=g.solidFill.length-1;be>=0;be--)X=g.solidFill[be],C.push($($([],Xx(X.color),!0),[null!==(bt=X.opacity)&&void 0!==bt?bt:1],!1)),T.push(!!X.enabled),A.push(null!==(xt=X.opacity)&&void 0!==xt?xt:1),k.push(X.blendMode||"normal");if(void 0===e.opened)return[3,7];if(D=[],!e.children)return[3,6];be=0,N=e.children.length,Q.label=1;case 1:return be<N?[4,Bx(B=e.children[be],t,r)]:[3,6];case 2:return(xe=Q.sent())?B.mask?[4,Ux(B,t,r)]:[3,4]:[3,5];case 3:(z=Q.sent())&&(xe=zx(xe,z)),B.clipping||(xe.props.style.breakMask=!0),Q.label=4;case 4:if(B.clipping&&D.length)for(U=be-1;U>=0;U--)if(!e.children[U].clipping){$e=be-U,(z=D[D.length-$e]).props.style.maskMode="alpha-with";break}D.push(xe),Q.label=5;case 5:return be++,[3,1];case 6:return D.forEach((function(e,t){e.props.index=(t+1)/(D.length+1)})),[2,{tagName:l.GROUP,props:{uuid:s(),name:n,isExpanded:e.opened,style:{left:100*h/t+"%",top:100*c/r+"%",right:100*v/t+"%",bottom:100*f/r+"%",opacity:i,visibility:x,shadow:w,shadowEnable:E,innerShadow:_,innerShadowEnable:S,mixBlendMode:y,fill:C,fillEnable:T,fillOpacity:A,fillMode:k}},children:D}];case 7:if(e.text){if(e.text.textPath&&e.text.textPath.bezierCurve)return[2,M];if(Pe=[],Ie=[],Fe=[],De=[],g.stroke)for(be=g.stroke.length-1;be>=0;be--)"color"===(X=g.stroke[be]).fillType&&(Pe.push(!g.disabled&&!!X.enabled),Ie.push(qu($($([],Xx(X.color),!0),[null!==(wt=X.opacity)&&void 0!==wt?wt:1],!1))),Fe.push((null===(Et=X.size)||void 0===Et?void 0:Et.value)||1),De.push(X.position||"center"));if(H=e.text.transform||[1,0,1,0,0,0],G=[],j=e.text.style||{},Y=j.font,W=(void 0===Y?{}:Y).name,q=void 0===W?fl.defaultFontFamily:W,V=j.fontSize,K=void 0===V?fl.defaultFontSize:V,J=j.fauxBold,ee=j.fauxItalic,te=j.autoKerning,re=j.kerning,ne=void 0===re?0:re,ie=j.autoLeading,oe=j.leading,ae=void 0===oe?0:oe,se=j.fillColor,le=j.underline,ce=j.strikethrough,ue=(e.text.paragraphStyle||{}).justification,he=[],le&&he.push("underline"),ce&&he.push("lineThrough"),de={fontFamily:q,fontSize:K*H[0],fontWeight:J?"bold":"normal",fontStyle:ee?"italic":"normal",letterSpacing:te?0:ne,textAlign:ue||"left",color:qu(se?Xx(se):[0,0,0]),textDecoration:he,lineHeight:ie?0:ae*H[0],paragraphSpacing:0},He=Z(Z({left:100*(h+.5*(v-h))/t+"%",top:100*(c+.5*(f-c))/r+"%",opacity:i,visibility:x,translateX:"-50%",translateY:"-50%"},de),{stroke:Ie,strokeEnable:Pe,strokePosition:De,strokeWidth:Fe,shadow:w,shadowEnable:E,innerShadow:_,innerShadowEnable:S,mixBlendMode:y,fill:C,fillEnable:T,fillOpacity:A,fillMode:k}),fe=e.text,pe=fe.styleRuns,ve=fe.paragraphStyleRuns,pe||ve)for(me=0,ge=(pe||[]).slice(0),ye=(ve||[]).slice(0),be=0;ge.length||ye.length;)xe={location:me,length:1,fontFamily:q,fontSize:K*H[0],fontWeight:de.fontWeight,fontStyle:de.fontStyle,letterSpacing:ne,lineHeight:ie?0:ae*H[0],textAlign:ue?{left:"left","justify-left":"left",center:"center","justify-center":"center",right:"right","justify-right":"right",justify:"justify","justify-all":"justify"}[ue]:"left",color:Wu(de.color),textDecoration:de.textDecoration,paragraphSpacing:0},we=-1,Ee=-1,ge[0]&&(we=ge[0].length),ye[0]&&(Ee=ye[0].length),we===Ee?me+=we:(-1!==we&&-1!==Ee&&(we>Ee?we=-1:Ee=-1),me+=Math.max(we,Ee),we>-1&&ye[0]&&(ye[0].length-=we),Ee>-1&&ge[0]&&(ge[0].length-=Ee)),we>-1&&(_e=ge.shift(),Se=_e.length,Ce=_e.style,xe.length=Se,Ce.font&&(xe.fontFamily=Ce.font.name),void 0!==Ce.fauxBold&&(xe.fontWeight=Ce.fauxBold?"bold":"normal"),void 0!==Ce.fauxItalic&&(xe.fontStyle=Ce.fauxItalic?"italic":"normal"),void 0!==Ce.fontSize&&(xe.fontSize=Ce.fontSize*H[0]),Ce.autoKerning||void 0===Ce.kerning||(xe.letterSpacing=Ce.kerning),Ce.autoLeading||void 0===Ce.leading||(xe.lineHeight=Ce.leading*H[0]),Ce.fillColor&&(xe.color=Xx(Ce.fillColor||se)),void 0===Ce.strikethrough&&void 0===Ce.underline||(Te=[],Ce.strikethrough&&Te.push("lineThrough"),Ce.underline&&Te.push("underline"),xe.textDecoration=Te)),Ee>-1&&(Ae=ye.shift(),ke=Ae.length,Me=Ae.style,xe.length=ke,Me.justification&&(xe.textAlign={left:"left","justify-left":"left",center:"center","justify-center":"center",right:"right","justify-right":"right",justify:"justify","justify-all":"justify"}[Me.justification])),G.push(xe);return[2,{tagName:l.TEXT,props:{uuid:s(),name:n,style:He,content:e.text.text,rich:G}}]}if(e.vectorOrigination&&1===e.vectorOrigination.keyDescriptorList.length&&!e.vectorOrigination.keyDescriptorList[0].keyShapeInvalidated){if(Oe=e.vectorFill,Le=e.vectorStroke,Re=e.vectorOrigination.keyDescriptorList,Ie=[],Pe=[],Fe=[],De=[],Ne=[],Oe){if("color"===Oe.type)C.push(qu(Xx(Oe.color)));else if("solid"===Oe.type){if(Be=Oe.angle,Ue=void 0===Be?0:Be,ze=Oe.colorStops,Xe=Oe.opacityStops,He=Oe.style,Ge=Oe.reverse,je=Oe.align,Ye=null!==(_t=Oe.scale)&&void 0!==_t?_t:1,We="","linear"===He)qe=Ue+90,!1===je&&qe%90!=0||1!==Ye?(Ve=Du(qe,0,0,t,r),Ke=Ve.x1,Ze=Ve.y1,Je=Ve.x2,Qe=Ve.y2,$e=[Lu(Ke/t*Ye),Lu(Ze/r*Ye),Lu(Je/t*Ye),Lu(Qe/r*Ye)],We="linear-gradient(".concat($e.join(" "),", ")):(Ge&&(qe>=0?qe-=180:qe+=180),We="linear-gradient(".concat(qe,"deg, ")),Ye=1;else if("radial"===He)We="radial-gradient(0.5 0.5 ",We+=t>=r?.5*(t+r)/t+" 1, ":"1 "+.5*(t+r)/r+", ";else{if("angle"!==He)return b?[2,M]:[2];We="conic-gradient(",Ye=1}et=[],ze.forEach((function(e,t){var r,n;et.push({color:$($([],Xx(e.color),!0),[null!==(n=null===(r=Xe[t])||void 0===r?void 0:r.opacity)&&void 0!==n?n:1],!1),offset:e.location*Ye})})),"angle"===He&&Ue&&(tt=Ue/360,et.forEach((function(e){e.offset-=tt})),rt=et[0],nt=et[et.length-1],rt.offset>0&&nt.offset>1?(it=et[et.length-2],at=(1-it.offset)/(nt.offset-it.offset),st=nt.color.slice(0),nt.color=sh([it.color[0]+(nt.color[0]-it.color[0])*at,it.color[1]+(nt.color[1]-it.color[1])*at,it.color[2]+(nt.color[2]-it.color[2])*at,null!==(St=it.color[3])&&void 0!==St?St:1+(null!==(Tt=null!==(Ct=nt.color[3])&&void 0!==Ct?Ct:1-it.color[3])&&void 0!==Tt?Tt:1)*at]),nt.offset=1,et.unshift({color:st,offset:Math.max(0,rt.offset-1e-8)})):rt.offset<0&&nt.offset<1&&(ot=et[1],at=-rt.offset/(ot.offset-rt.offset),st=rt.color.slice(0),rt.color=sh([rt.color[0]+(ot.color[0]-rt.color[0])*at,rt.color[1]+(ot.color[1]-rt.color[1])*at,rt.color[2]+(ot.color[2]-rt.color[2])*at,null!==(At=rt.color[3])&&void 0!==At?At:1+(null!==(Mt=null!==(kt=ot.color[3])&&void 0!==kt?kt:1-rt.color[3])&&void 0!==Mt?Mt:1)*at]),rt.offset=1,et.push({color:st,offset:Math.min(1,nt.offset+1e-8)}))),et.forEach((function(e,t){t&&(We+=", "),We+=qu(e.color)+" "+100*e.offset+"%"})),We+=")",C.push(We)}T.push(null===(Ot=null==Le?void 0:Le.fillEnabled)||void 0===Ot||Ot),A.push(1),k.push("normal")}return Le&&(Ie.push(qu($($([],Xx(null===(Lt=Le.content)||void 0===Lt?void 0:Lt.color),!0),[null!==(Rt=Le.opacity)&&void 0!==Rt?Rt:1],!1))),Pe.push(!!Le.strokeEnabled),Fe.push((null===(It=Le.lineWidth)||void 0===It?void 0:It.value)||1),De.push(Le.lineAlignment||"center"),Ne.push(Le.blendMode||"normal")),lt=v-h,ct=f-c,ut=[],Re.forEach((function(e){var t=e.keyOriginRRectRadii,r=e.keyOriginShapeBoundingBox;r&&(ut.push({x:((r.left.value||h)-h)/lt,y:((r.top.value||c)-c)/ct,cornerRadius:(null==t?void 0:t.topLeft.value)||0,curveMode:Ks.STRAIGHT,cornerStyle:Zs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),ut.push({x:(((null==r?void 0:r.right.value)||v)-h)/lt,y:(((null==r?void 0:r.top.value)||c)-c)/ct,cornerRadius:(null==t?void 0:t.topRight.value)||0,curveMode:Ks.STRAIGHT,cornerStyle:Zs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),ut.push({x:(((null==r?void 0:r.right.value)||v)-h)/lt,y:(((null==r?void 0:r.bottom.value)||f)-c)/ct,cornerRadius:(null==t?void 0:t.bottomLeft.value)||0,curveMode:Ks.STRAIGHT,cornerStyle:Zs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),ut.push({x:(((null==r?void 0:r.left.value)||h)-h)/lt,y:(((null==r?void 0:r.bottom.value)||f)-c)/ct,cornerRadius:(null==t?void 0:t.bottomRight.value)||0,curveMode:Ks.STRAIGHT,cornerStyle:Zs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}))})),[2,{tagName:l.POLYLINE,props:{uuid:s(),name:n,style:{left:100*h/t+"%",top:100*c/r+"%",right:100*(t-v)/t+"%",bottom:100*(r-f)/r+"%",opacity:i,visibility:x,fill:C,fillEnable:T,fillOpacity:A,fillMode:k,stroke:Ie,strokeEnable:Pe,strokePosition:De,strokeWidth:Fe,strokeMode:Ne,shadow:w,shadowEnable:E,innerShadow:_,innerShadowEnable:S,mixBlendMode:y},points:ut,isClosed:!0}}]}if(b)return[2,M];Q.label=8;case 8:return[2]}}))}))}function Ux(e,t,r){return J(this,void 0,void 0,(function(){var n,i,o,a,c,u,h,d,f,p,v,m,g,y,b;return Q(this,(function(x){return n=e.mask,i=n.top,o=void 0===i?0:i,a=n.left,c=void 0===a?0:a,u=n.bottom,h=void 0===u?0:u,d=n.right,f=void 0===d?0:d,p=n.canvas,v=n.defaultColor,p?(m=p,(o>e.top||c>e.left||f<e.right||h<e.bottom)&&(y=e.right-e.left,b=e.bottom-e.top,g=fl.getOffscreenCanvas(y,b),m=g.canvas,v&&(g.ctx.fillStyle=qu([v,v,v]),o>e.top&&g.ctx.fillRect(0,0,y,o-e.top),h<e.bottom&&g.ctx.fillRect(0,h-e.top,y,e.bottom-h),c>e.left&&g.ctx.fillRect(0,0,c-e.left,b),f<e.right&&g.ctx.fillRect(f-e.left,0,e.right-f,b)),g.ctx.drawImage(p,c-e.left,o-e.top)),[2,new Promise((function(n){m.toBlob((function(i){if(g&&g.release(),i)return n({tagName:l.BITMAP,props:{uuid:s(),name:e.name+" mask",style:{left:100*e.left/t+"%",top:100*e.top/r+"%",right:100*(t-e.right)/t+"%",bottom:100*(r-e.bottom)/r+"%",maskMode:"gray"},src:URL.createObjectURL(i)}});n(void 0)}))}))]):[2]}))}))}function zx(e,t){var r=e.props.style,n={tagName:l.GROUP,props:{uuid:s(),name:e.props.name,isExpanded:!0,style:{left:r.left,top:r.top,right:r.right,bottom:r.bottom}},children:[t,e]};r.left=0,r.top=0,r.right=0,r.bottom=0,e.props.name+=" origin";var i=t.props.style;return i.left=0,i.top=0,i.right=0,i.bottom=0,r.mixBlendMode&&(i.mixBlendMode=r.mixBlendMode),delete r.mixBlendMode,n}function Xx(e){if(!e)return[0,0,0];if(e.hasOwnProperty("a"))e.r,e.g,e.b,e.a;else if(e.hasOwnProperty("fr"))return[255*e.fr,255*e.fg,255*e.fb];return[e.r,e.g,e.b]}function Hx(e){return e>=Nx.REFLOW}function Gx(e){return"width"===e||"height"===e||"letterSpacing"===e||"paragraphSpacing"===e||"textAlign"===e||"textVerticalAlign"===e||"fontFamily"===e||"fontSize"===e||"fontWeight"===e||"fontStyle"===e||"lineHeight"===e||"left"===e||"top"===e||"right"===e||"bottom"===e}function jx(e){return"pointerEvents"===e||"constrainProportions"===e||"isLocked"===e||"isSelected"===e||"resizesContent"===e||"isRectangle"===e?Nx.NONE:"translateX"===e?Nx.TRANSLATE_X:"translateY"===e?Nx.TRANSLATE_Y:"rotateZ"===e?Nx.ROTATE_Z:"scaleX"===e?Nx.SCALE_X:"scaleY"===e?Nx.SCALE_Y:"transformOrigin"===e||"matrix"===e?Nx.TRANSFORM:"opacity"===e?Nx.OPACITY:"blur"===e||"shadow"===e||"shadowEnable"===e||"hueRotate"===e||"saturate"===e||"brightness"===e||"contrast"===e?Nx.FILTER:"mixBlendMode"===e?Nx.MIX_BLEND_MODE:"maskMode"===e?Nx.MASK:"breakMask"===e?Nx.BREAK_MASK:Gx(e)?Nx.REFLOW:Nx.REPAINT}!function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"}(Px||(Px={})),function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"}(Fx||(Fx={})),function(e){e[e.None=0]="None",e[e.Visibility=1]="Visibility",e[e.Position=2]="Position",e[e.Appearance=4]="Appearance"}(Dx||(Dx={})),function(e){e[e.NONE=0]="NONE",e[e.CACHE=1]="CACHE",e[e.TRANSLATE_X=2]="TRANSLATE_X",e[e.TRANSLATE_Y=4]="TRANSLATE_Y",e[e.TRANSLATE=6]="TRANSLATE",e[e.ROTATE_Z=8]="ROTATE_Z",e[e.SCALE_X=16]="SCALE_X",e[e.SCALE_Y=32]="SCALE_Y",e[e.SCALE=48]="SCALE",e[e.TRANSFORM=64]="TRANSFORM",e[e.TRANSFORM_ALL=126]="TRANSFORM_ALL",e[e.OPACITY=128]="OPACITY",e[e.FILTER=256]="FILTER",e[e.MIX_BLEND_MODE=512]="MIX_BLEND_MODE",e[e.MASK=1024]="MASK",e[e.BREAK_MASK=2048]="BREAK_MASK",e[e.REPAINT=4096]="REPAINT",e[e.REFLOW=8192]="REFLOW",e[e.REFLOW_TRANSFORM=8446]="REFLOW_TRANSFORM",e[e.REFLOW_OPACITY=8320]="REFLOW_OPACITY",e[e.REFLOW_FILTER=8448]="REFLOW_FILTER",e[e.REBUILD=16384]="REBUILD",e[e.FULL=32767]="FULL"}(Nx||(Nx={}));var Yx={RefreshLevel:Nx,isRepaint:function(e){return e<Nx.REFLOW},isReflow:Hx,isReflowKey:Gx};function Wx(e,t,r,n,i){if(void 0===n&&(n=0),void 0===i&&(i=0),t&&t.length){for(var o=-1,a=0,s=t.length;a<s;a++){var l=t[a];if(Array.isArray(l)&&l.length){o=a;break}}if(-1!==o){var c=t[o];4===c.length?e.moveTo(c[2]*r+n,c[3]*r+i):6===c.length?e.moveTo(c[4]*r+n,c[5]*r+i):e.moveTo(c[0]*r+n,c[1]*r+i);for(a=o+1,s=t.length;a<s;a++){l=t[a];Array.isArray(l)&&(2===l.length?e.lineTo(l[0]*r+n,l[1]*r+i):4===l.length?e.quadraticCurveTo(l[0]*r+n,l[1]*r+i,l[2]*r+n,l[3]*r+i):6===l.length&&e.bezierCurveTo(l[0]*r+n,l[1]*r+i,l[2]*r+n,l[3]*r+i,l[4]*r+n,l[5]*r+i))}}}}function qx(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),!e||!e.length)return"";for(var n,i=-1,o=0,a=e.length;o<a;o++){var s=e[o];if(Array.isArray(s)&&s.length){i=o;break}}if(-1===i)return"";var l=e[i];n=4===l.length?"M"+(l[2]+t)+","+(l[3]+r):6===l.length?"M"+(l[4]+t)+","+(l[5]+r):"M"+(l[0]+t)+","+(l[1]+r);for(o=i+1,a=e.length;o<a;o++){s=e[o];Array.isArray(s)&&(2===s.length?n+="L"+(s[0]+t)+","+(s[1]+r):4===s.length?n+="Q"+(s[0]+t)+","+(s[1]+r)+" "+(s[2]+t)+","+(s[3]+r):6===s.length&&(n+="C"+(s[0]+t)+","+(s[1]+r)+" "+(s[2]+t)+","+(s[3]+r)+" "+(s[4]+t)+","+(s[5]+r)))}return n}var Vx,Kx,Zx,Jx={canvasPolygon:Wx,svgPolygon:qx};function Qx(e,t,r){var n=function(e,t,r){var n=$x(e,e.VERTEX_SHADER,t),i=$x(e,e.FRAGMENT_SHADER,r);if(!n||!i)return null;var o=e.createProgram();if(!o)return null;o.vertexShader=n,o.fragmentShader=i,e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o);var a=e.getProgramParameter(o,e.LINK_STATUS);if(!a){var s=e.getProgramInfoLog(o);throw e.deleteProgram(o),e.deleteShader(i),e.deleteShader(n),new Error("Failed to link program: "+s)}return o}(e,t,r);if(!n)throw new Error("Failed to create program");return e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),n}function $x(e,t,r){var n=e.createShader(t);if(null===n)throw new Error("unable to create shader");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error("Failed to compile shader: "+i)}return n}function ew(e,t,r,n,i){var o=e.createTexture();if(tw(e,o,t),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r)e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);else{if(!n||!i)throw new Error("Missing texImageSource or w/h");e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,i,0,e.RGBA,e.UNSIGNED_BYTE,null)}return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),o}function tw(e,t,r){e.activeTexture(e["TEXTURE"+r]),e.bindTexture(e.TEXTURE_2D,t)}function rw(e,t,r,n,i,o,a,s,l,c,u,h){void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=!0),void 0===l&&(l=-1),void 0===c&&(c=-1),void 0===u&&(u=1),void 0===h&&(h=1);var d=i.length;if(d){var f,p,v,m=1===d,g=m?8:12*d,y=m?4:6*d;f=Vx&&Vx.length===g?Vx:Vx=new Float32Array(g),p=Kx&&Kx.length===g?Kx:Kx=new Float32Array(g),v=Zx&&Zx.length===y?Zx:Zx=new Float32Array(y);for(var b=0,x=i.length;b<x;b++){var w=i[b],E=w.opacity,_=w.matrix,S=w.bbox,C=w.coords,T=w.tc;tw(e,w.texture,0);var A=C?vw(C,o,a):pw(S,t,r,o,a,s,_),k=A.t1,M=A.t2,O=A.t3,L=A.t4,R=12*b;f[R]=k.x,f[R+1]=k.y,f[R+2]=L.x,f[R+3]=L.y,f[R+4]=M.x,f[R+5]=M.y,m?(f[R+6]=O.x,f[R+7]=O.y):(f[R+6]=L.x,f[R+7]=L.y,f[R+8]=M.x,f[R+9]=M.y,f[R+10]=O.x,f[R+11]=O.y),T?(p[R]=T.x1,p[R+1]=T.y1,p[R+2]=T.x1,p[R+3]=T.y3,p[R+4]=T.x3,p[R+5]=T.y1,m?(p[R+6]=T.x3,p[R+7]=T.y3):(p[R+6]=T.x1,p[R+7]=T.y3,p[R+8]=T.x3,p[R+9]=T.y1,p[R+10]=T.x3,p[R+11]=T.y3)):(p[R]=0,p[R+1]=0,p[R+2]=0,p[R+3]=1,p[R+4]=1,p[R+5]=0,m?(p[R+6]=1,p[R+7]=1):(p[R+6]=0,p[R+7]=1,p[R+8]=1,p[R+9]=0,p[R+10]=1,p[R+11]=1)),v[R=6*b]=E,v[R+1]=E,v[R+2]=E,v[R+3]=E,m||(v[R+4]=E,v[R+5]=E)}var I=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,I),e.bufferData(e.ARRAY_BUFFER,f,e.STATIC_DRAW);var P=e.getAttribLocation(n,"a_position");e.vertexAttribPointer(P,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(P);var F=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,F),e.bufferData(e.ARRAY_BUFFER,p,e.STATIC_DRAW);var D=e.getAttribLocation(n,"a_texCoords");e.vertexAttribPointer(D,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(D);var N=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,N),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW);var B=e.getAttribLocation(n,"a_opacity");e.vertexAttribPointer(B,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(B);var U=e.getUniformLocation(n,"u_texture");e.uniform1i(U,0);var z=e.getUniformLocation(n,"x1");e.uniform1f(z,l);var X=e.getUniformLocation(n,"y1");e.uniform1f(X,c);var H=e.getUniformLocation(n,"x2");e.uniform1f(H,u);var G=e.getUniformLocation(n,"y2");e.uniform1f(G,h),e.drawArrays(m?e.TRIANGLE_STRIP:e.TRIANGLES,0,y),e.deleteBuffer(I),e.deleteBuffer(F),e.deleteBuffer(N),e.disableVertexAttribArray(P),e.disableVertexAttribArray(D),e.disableVertexAttribArray(B)}}function nw(e,t){var r=function(){var e=new Float32Array(8),t=new Float32Array(8);return e[0]=-1,e[1]=-1,e[2]=-1,e[3]=1,e[4]=1,e[5]=-1,e[6]=1,e[7]=1,t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=1,t[5]=0,t[6]=1,t[7]=1,{vtPoint:e,vtTex:t}}(),n=r.vtPoint,i=r.vtTex,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);var a=e.getAttribLocation(t,"a_position");e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a);var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);var l=e.getAttribLocation(t,"a_texCoords");return e.vertexAttribPointer(l,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(l),{pointBuffer:o,a_position:a,texBuffer:s,a_texCoords:l}}function iw(e,t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var a=nw(e,t),s=a.pointBuffer,l=a.a_position,c=a.texBuffer,u=a.a_texCoords;tw(e,r,0),tw(e,n,1);var h=e.getUniformLocation(t,"u_texture1");e.uniform1i(h,0);var d=e.getUniformLocation(t,"u_texture2");e.uniform1i(d,1);var f=e.getUniformLocation(t,"u_d");e.uniform2f(f,i,o),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(s),e.deleteBuffer(c),e.disableVertexAttribArray(l),e.disableVertexAttribArray(u)}function ow(e,t,r,n,i,o){var a=nw(e,t),s=a.pointBuffer,l=a.a_position,c=a.texBuffer,u=a.a_texCoords,h=e.getUniformLocation(t,"u_texture"),d=e.getUniformLocation(t,"u_pw"),f=e.getUniformLocation(t,"u_ph");e.uniform1f(d,1/n),e.uniform1f(f,1/i);for(var p=e.getUniformLocation(t,"u_direction"),v=e.getUniformLocation(t,"u_r"),m=r,g=ew(e,0,void 0,n,i),y=ew(e,0,void 0,n,i),b=0,x=o.length;b<x;b++){var w=o[b]-1>>1;e.uniform1i(v,w),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),tw(e,m,0),e.uniform1i(h,0),e.uniform1i(p,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,y,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),tw(e,g,0),e.uniform1i(p,1),e.drawArrays(e.TRIANGLE_STRIP,0,4),m=y}return e.deleteBuffer(s),e.deleteBuffer(c),e.disableVertexAttribArray(l),e.disableVertexAttribArray(u),e.deleteTexture(g),y}function aw(e,t,r,n,i,o,a,s){void 0===s&&(s=1);var l=nw(e,t),c=l.pointBuffer,u=l.a_position,h=l.texBuffer,d=l.a_texCoords,f=e.getUniformLocation(t,"u_x"),p=e.getUniformLocation(t,"u_y");e.uniform1f(f,s/n),e.uniform1f(p,s/i);var v=ew(e,0,void 0,o,a),m=e.getUniformLocation(t,"u_texture");return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),tw(e,r,0),e.uniform1i(m,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(c),e.deleteBuffer(h),e.disableVertexAttribArray(u),e.disableVertexAttribArray(d),v}function sw(e,t,r,n,i,o,a){var s=nw(e,t),l=s.pointBuffer,c=s.a_position,u=s.texBuffer,h=s.a_texCoords,d=e.getUniformLocation(t,"u_kernel");e.uniform1i(d,n);var f=Math.sin(i)*n/a,p=Math.cos(i)*n/o,v=e.getUniformLocation(t,"u_velocity");e.uniform2f(v,p,f);for(var m=e.getUniformLocation(t,"u_texture"),g=r,y=ew(e,0,void 0,o,a),b=ew(e,0,void 0,o,a),x=0;x<3;x++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,[y,b,y][x],0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),tw(e,[g,y,b][x],0),e.uniform1i(m,0),e.drawArrays(e.TRIANGLE_STRIP,0,4);return e.deleteBuffer(l),e.deleteBuffer(u),e.disableVertexAttribArray(c),e.disableVertexAttribArray(h),e.deleteTexture(b),y}function lw(e,t,r,n,i,o,a,s){var l=nw(e,t),c=l.pointBuffer,u=l.a_position,h=l.texBuffer,d=l.a_texCoords,f=e.getUniformLocation(t,"u_kernel");e.uniform1i(f,i);var p=e.getUniformLocation(t,"u_center");e.uniform2f(p,o[0],o[1]);var v=e.getUniformLocation(t,"u_ratio");e.uniform1f(v,n);for(var m=r,g=[],y=0;y<1;y++){var b=ew(e,0,void 0,a,s);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0),tw(e,m,0);var x=e.getUniformLocation(t,"u_texture");e.uniform1i(x,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),g.push(m),m=b}return e.deleteBuffer(c),e.deleteBuffer(h),e.disableVertexAttribArray(u),e.disableVertexAttribArray(d),g.forEach((function(t){t!==r&&e.deleteTexture(t)})),m}function cw(e,t,r,n){var i=nw(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;tw(e,r,0);var c=e.getUniformLocation(t,"u_texture");e.uniform1i(c,0);var u=e.getUniformLocation(t,"u_color"),h=n[3];e.uniform4f(u,n[0]*h,n[1]*h,n[2]*h,h),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}var uw=iw;function hw(e,t,r,n,i){var o=nw(e,t),a=o.pointBuffer,s=o.a_position,l=o.texBuffer,c=o.a_texCoords;tw(e,r,0);var u=e.getUniformLocation(t,"u_texture");e.uniform1i(u,0);var h=e.getUniformLocation(t,"u_tint"),d=Zu(n);d[3]*=i,e.uniform4f(h,d[0]*d[3],d[1]*d[3],d[2]*d[3],d[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(a),e.deleteBuffer(l),e.disableVertexAttribArray(s),e.disableVertexAttribArray(c)}function dw(e,t,r,n){var i=nw(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;tw(e,r,0);var c=e.getUniformLocation(t,"u_texture");e.uniform1i(c,0);var u=e.getUniformLocation(t,"u_m[0]");e.uniform1fv(u,new Float32Array(n)),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}function fw(e,t,r,n,i){return void 0===i&&(i=!1),{x:e=e===r?0:(e-r)/r,y:t=t===n?0:i?(n-t)/n:(t-n)/n}}function pw(e,t,r,n,i,o,a){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=!0);var s=bc(e[0],e[1],e[2],e[3],a),l=s.x1,c=s.y1,u=s.x2,h=s.y2,d=s.x3,f=s.y3,p=s.x4,v=s.y4;return{t1:fw(l+n,c+i,t,r,o),t2:fw(u+n,h+i,t,r,o),t3:fw(d+n,f+i,t,r,o),t4:fw(p+n,v+i,t,r,o)}}function vw(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),t||r){var n=e.t1,i=e.t2,o=e.t3,a=e.t4;return{t1:{x:n.x+t,y:n.y+r},t2:{x:i.x+t,y:i.y+r},t3:{x:o.x+t,y:o.y+r},t4:{x:a.x+t,y:a.y+r}}}return e}var mw,gw=512,yw=0,bw=function(){function e(e,t,r,n){this.uuid=yw++,this.available=!1,this.complete=!1,this.count=0,this.needClear=!1,this.nodes=[],this.x=t,this.y=r,this.size=n,this.gl=e,this.bbox=new Float64Array([0,0,0,0]),this.x1=this.y1=-1,this.x2=this.y2=1}return e.prototype.init=function(e){void 0===e&&(e=1),this.available||(this.available=!0,this.complete=!1,this.count=0,this.texture=ew(this.gl,0,void 0,gw*e,gw*e))},e.prototype.clean=function(){var e=this;this.count&&(this.count=0,this.needClear=!0),this.complete=!1;var t=this.nodes.splice(0);return t.forEach((function(t){return t.removeTile(e)})),t},e.prototype.add=function(e){-1===this.nodes.indexOf(e)&&(this.nodes.push(e),e.addTile(this),this.count++)},e.prototype.has=function(e){return this.nodes.indexOf(e)>-1},e.prototype.remove=function(e){var t=this.nodes.indexOf(e);t>-1&&(this.nodes.splice(t,1),e.removeTile(this),this.count--,this.complete=!1)},e.prototype.updateTex=function(e){this.texture&&this.gl.deleteTexture(this.texture),this.texture=e},e.prototype.destroy=function(){this.available=!1,this.complete=!1,this.count=0,this.texture&&(this.gl.deleteTexture(this.texture),this.texture=void 0)},e.prototype.toString=function(){return this.uuid+": "+this.available+","+this.complete+"; "+this.x+","+this.y+","+(this.x+gw)+","+(this.y+gw)+"; "+this.bbox.map((function(e){return Math.round(e)})).join(",")},Object.defineProperty(e,"UNIT",{get:function(){return gw},set:function(e){for(var t=e,r=0;t>0;)t>>=1,r++;for(t=0;r>0;)r--,t<<=1;if(t<32)throw new Error("The UNIT of Tile muse be a power of 2 and the minimum is 32");gw=t},enumerable:!1,configurable:!0}),e.clean=function(e){e.forEach((function(e){return e.clean()}))},e}(),xw=function(){function e(e){this.gl=e,this.hash=new WeakMap,this.data=[]}return e.prototype.setPage=function(e){this.hash.has(e)?this.data=this.hash.get(e):(this.data=[],this.hash.set(e,this.data))},e.prototype.active=function(e,t,r,n,i){if(!n||!i)return[];var o=Math.round(bw.UNIT/e),a=this.getTable(e),s=[];if(a.length){for(var l=a[0][0],c=t-l.x,u=r-l.y,h=Math.round(c/o),d=Math.round(u/o);d<0;)a.unshift([new bw(this.gl,l.x,l.y-o,o)]),l=a[0][0],d++;for(;h<0;){v=0;for(var f=a.length;v<f;v++){if((m=a[v]=a[v]||[]).length){y=m[0];m.unshift(new bw(this.gl,y.x-o,y.y,o))}}h++}l=a[0][0];for(v=d;v<d+i;v++)for(m=a[v]=a[v]||[],g=h;g<h+n;g++)if(m[g])s.push(m[g]);else{y=new bw(this.gl,l.x+g*o,l.y+v*o,o);m[g]=y;for(var p=g-1;p>=0&&!m[p];p--)m[p]=new bw(this.gl,l.x+p*o,l.y+v*o,o);s.push(y)}}else for(var v=0;v<i;v++){for(var m=[],g=0;g<n;g++){var y=new bw(this.gl,t+g*o,r+v*o,o);m.push(y),s.push(y)}a.push(m)}return s},e.prototype.getTable=function(e){for(var t=0,r=this.data.length;t<r;t++){var n=this.data[t];if(n.scale===e)return n.table;if(n.scale>e){var i={scale:e,table:[]};return this.data.splice(t,0,i),i.table}}var o={scale:e,table:[]};return this.data.push(o),o.table},e.prototype.getDowngrade=function(e,t,r){for(var n=0,i=this.data.length;n<i;n++){if(this.data[n].scale===e){for(var o=n-1;o>=0;o--)for(var a=this.data[o],s=a.scale,l=0,c=(f=a.table).length;l<c;l++){if((y=f[l])&&y.length)if((b=y[0]).y===r||b.y<r&&b.y+b.size>r)for(var u=0,h=y.length;u<h;u++){if(((E=y[u]).x===t||E.x<t&&E.x+E.size>t)&&E.available&&E.count)return[{scale:s,tile:E}];if(E.x>t)break}else if(b.y>r)break}for(o=n+1;o<i;o++){for(var d=this.data[o],f=(s=d.scale,d.table),p=bw.UNIT/e,v=[],m=0,g=f.length;m<g;m++){var y,b;if((y=f[m])&&y.length)if((b=y[0]).y>=r&&b.y<r+p)for(var x=0,w=y.length;x<w;x++){var E;if((E=y[x]).x>=t&&E.x<t+p&&E.available&&E.count)v.push({scale:s,tile:E});else if(E.x>=t+p)break}else if(b.y>=r+p)break}if(v.length)return v}break}}},e}(),ww={level:Yx,paint:Jx,Tile:bw,TileManager:xw},Ew={font:jl,transform:Dc,define:gl,css:ch,gradient:Xu},_w=function(){function e(){this.__eHash={}}return e.prototype.on=function(e,t){if(Cs(t)){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)this.on(e[r],t);else{this.__eHash.hasOwnProperty(e)||(this.__eHash[e]=[]);r=0;var i=this.__eHash[e];for(n=i.length;r<n;r++)if(i[r]===t)return this;this.__eHash[e].push(t)}return this}},e.prototype.once=function(e,t){var r=this;if(Cs(t)){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)this.once(e[n],t);else{var o=function(){t.apply(r,Array.prototype.slice.call(arguments)),r.off(e,o)};if(o.__eventCb=t,Array.isArray(e))for(n=0,i=e.length;n<i;n++)this.once(e[n],t);else this.on(e,o)}return this}},e.prototype.off=function(e,t){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)this.off(e[r],t);else if(this.__eHash.hasOwnProperty(e))if(t){r=0;var i=this.__eHash[e];for(n=i.length;r<n;r++)if(i[r]===t||i[r].__eventCb===t){i.splice(r,1);break}}else delete this.__eHash[e];return this},e.prototype.emit=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return Array.isArray(e)||(e=[e]),e.forEach((function(e){if(e&&t.__eHash.hasOwnProperty(e)){var n=t.__eHash[e];if(n.length)for(var i=0,o=(n=n.slice()).length;i<o;i++){var a=n[i];Cs(a)&&a.apply(t,r)}}})),this},e.REFRESH="REFRESH",e.REFRESH_COMPLETE="REFRESH_COMPLETE",e.DID_ADD_DOM="DID_ADD_DOM",e.WILL_REMOVE_DOM="WILL_REMOVE_DOM",e.STYLE_CHANGED="STYLE_CHANGED",e}(),Sw={type:Ds,Event:_w,inject:fl,opentype:Ul,config:bs};var Cw=function(){function e(){this.rootTask=[],this.roots=[],this.task=[],this.now=fl.now(),this.id=0}return e.prototype.init=function(){var e=this,t=this.task;fl.cancelAnimationFrame(this.id);var r=this.now=fl.now(),n=function(){fl.cancelAnimationFrame(e.id),e.id=fl.requestAnimationFrame((function(){var i=e.now=fl.now();if(!mw&&t.length){var o=i-r;o=Math.max(o,0),r=i;var a=t.slice(0),s=a.length;!function(e,t,r){for(var n=0;n<t;n++){var i=e[n];i.before&&i.before(r)}}(a,s,o),function(e,t,r){for(var n=0;n<t;n++)e[n].after(r)}(a,s,o),t.length&&n()}}))};n()},e.prototype.onFrame=function(e){if(e){var t=this.task;t.length||this.init(),Cs(e)&&(e={after:e,ref:e}),t.push(e)}},e.prototype.offFrame=function(e){if(e){for(var t=this.task,r=0,n=t.length;r<n;r++){var i=t[r];if(i===e||i.ref===e){t.splice(r,1);break}}t.length||(fl.cancelAnimationFrame(this.id),this.now=0)}},e.prototype.nextFrame=function(e){var t=this;if(e){var r=Cs(e)?{after:function(n){e(n),t.offFrame(r)}}:{before:e.before,after:function(n){e.after&&e.after(n),t.offFrame(r)}};r.ref=e,this.onFrame(r)}},e.prototype.pause=function(){mw=!0},e.prototype.resume=function(){mw&&(this.init(),mw=!1)},e.prototype.addRoot=function(e){this.roots.push(e)},e.prototype.removeRoot=function(e){var t=this.roots.indexOf(e);t>-1&&this.roots.splice(t,1)},e}(),Tw=new Cw,Aw={frame:Tw};function kw(e){if(e<=0)return 0;var t=Math.floor(3*e*Math.sqrt(2*Math.PI)/4+.5);return t<2&&(t=2),t%2==0&&t++,t}function Mw(e){return 3*Math.floor(.5*e)}function Ow(e,t){void 0===t&&(t=3);var r=Math.sqrt(12*e*e/t+1),n=Math.floor(r);n%2==0&&n--;for(var i=n+2,o=(12*e*e-t*n*n-4*t*n-3*t)/(-4*n-4),a=Math.round(o),s=[],l=0;l<t;l++)s.push(l<a?n:i);return s}var Lw={},Rw=function(){function e(e,t,r){this.gl=e,this.available=!0,this.bbox=t.slice(0);var n=t[2],i=t[3];if(this.list=[],r)for(var o=r.list,a=r.w,s=r.h,l=o.length,c=(t[2]-t[0])/a,u=(t[3]-t[1])/s,h=0;h<l;h++){var d=o[h],f=ew(e,0,d.os.canvas);this.list.push({bbox:new Float64Array([d.x*c,d.y*u,Math.min(n,(d.x+d.w)*c),Math.min(i,(d.y+d.h)*u)]),w:d.w,h:d.h,t:f})}}return e.prototype.release=function(){var e=this;this.available&&(this.available=!1,this.list.splice(0).forEach((function(t){t.t&&e.gl.deleteTexture(t.t)})))},e.prototype.releaseImg=function(e,t){var r=this;if(this.available){this.available=!1;var n=Lw[e],i=n[t];i&&(i.count--,i.count||(delete n[t],this.list.splice(0).forEach((function(e){e.t&&r.gl.deleteTexture(e.t)}))))}},e.getInstance=function(t,r,n){return new e(t,n,r)},e.hasImgInstance=function(e,t){if(Lw.hasOwnProperty(e)&&Lw[e].hasOwnProperty(t))return!0;return!1},e.getImgInstance=function(t,r,n,i,o){if(Lw.hasOwnProperty(t)){var a=Lw[t];if(a.hasOwnProperty(n)){var s=a[n];s.count++;for(var l=new e(r,i),c=i[2]-i[0],u=i[3]-i[1],h=c/s.w,d=u/s.h,f=i[2],p=i[3],v=s.value,m=v.length,g=0;g<m;g++){var y=v[g];l.list.push({bbox:new Float64Array([y.x*h,y.y*d,Math.min(f,(y.x+y.w)*h),Math.min(p,(y.y+y.h)*d)]),w:y.w,h:y.h,t:y.t})}return l}}var b=Lw[t]=Lw[t]||{},x=new e(r,i,o);return b[n]={value:x.list.map((function(e,t){return{x:o.list[t].x,y:o.list[t].y,w:e.w,h:e.h,t:e.t}})),w:o.w,h:o.h,count:1},x},e.getEmptyInstance=function(t,r){return new e(t,r)},e}(),Iw=function(e){function t(t){var r=e.call(this)||this;return r.isGroup=!1,r.isArtBoard=!1,r.isSymbolMaster=!1,r.isSymbolInstance=!1,r.isPage=!1,r.isText=!1,r.isGeom=!1,r.isPolyline=!1,r.isBitmap=!1,r.isShapeGroup=!1,r.isContainer=!1,r.isSlice=!1,r.props=t,r.props.uuid=r.props.uuid||s(),r.style=Hu(d(t.style)),r.computedStyle={},r.width=0,r.height=0,r.minWidth=.5,r.minHeight=.5,r.isDestroyed=!0,r.struct={node:r,num:0,total:0,lv:0,next:0},r.refreshLevel=Nx.REFLOW,r._opacity=1,r.hasCacheOp=!1,r.localOpId=0,r.parentOpId=0,r.transform=ic(),r.matrix=ic(),r._matrixWorld=ic(),r.hasCacheMw=!1,r.localMwId=0,r.parentMwId=0,r.hasContent=!1,r.textureCache=[],r.textureTotal=[],r.textureFilter=[],r.textureMask=[],r.textureTarget=[],r.textureOutline=[],r.tempOpacity=1,r.tempMatrix=ic(),r.tempIndex=0,r.tileList=[],r}return v(t,e),t.prototype.willMount=function(){this.isDestroyed=!1;var e=this.parent;if(e){this.parentOpId=e.localOpId,this.parentMwId=e.localMwId;var t=this.root=e.root;this.isPage||(this.page=e.page),this.isArtBoard||(this.artBoard=e.artBoard),this.isSymbolInstance||(this.symbolInstance=e.symbolInstance);var r=this.props.uuid;r&&(t.refs[r]=this)}},t.prototype.didMount=function(){},t.prototype.lay=function(e){this.refreshLevel=Nx.REFLOW,this.calReflowStyle();var t=this.style,r=this.computedStyle,n=t.left,i=t.top,o=t.right,a=t.bottom,s=t.width,l=t.height,c=!1,u=!1,h=!1,d=!1;n.u!==Xs.AUTO&&(c=!0,r.left=rh(n,e.w)),o.u!==Xs.AUTO&&(h=!0,r.right=rh(o,e.w)),i.u!==Xs.AUTO&&(u=!0,r.top=rh(i,e.h)),a.u!==Xs.AUTO&&(d=!0,r.bottom=rh(a,e.h)),c&&h?this.width=r.width=Math.max(this.minWidth,e.w-r.left-r.right):c?(s.u!==Xs.AUTO?this.width=r.width:this.width=this.minWidth,r.right=e.w-r.left-this.width):h&&(s.u!==Xs.AUTO?this.width=r.width:this.width=this.minWidth,r.left=e.w-r.right-this.width),u&&d?this.height=r.height=Math.max(this.minHeight,e.h-r.top-r.bottom):u?(l.u!==Xs.AUTO?this.height=r.height:this.height=this.minHeight,r.bottom=e.h-r.top-this.height):d&&(l.u!==Xs.AUTO?this.height=r.height:this.height=this.minHeight,r.top=e.h-r.bottom-this.height)},t.prototype.layout=function(e){this.isDestroyed||(this.lay(e),this.calRepaintStyle(Nx.REFLOW),this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this._rect=void 0)},t.prototype.insertAfter=function(e,t){e.remove();var r=this.root,n=this.parent;if(!n)throw new Error("Can not appendSelf without parent");e.parent=n,e.prev=this,this.next?(e.props.index=.5*(this.next.props.index+this.props.index),this.next.prev=e):e.props.index=.5*(this.props.index+1),e.next=this.next,this.next=e,e.root=r;var i=n.children,o=i.indexOf(this);i.splice(o+1,0,e),n.isDestroyed?t&&t(!0):(e.willMount(),n.insertStruct(e,o+1),r.addUpdate(e,[],Nx.REFLOW,!0,!1,(function(r){!r&&e.page&&e.didMount(),t&&t(r)})))},t.prototype.insertBefore=function(e,t){e.remove();var r=this.root,n=this.parent;if(!n)throw new Error("Can not prependBefore without parent");e.parent=n,e.prev=this.prev,this.prev?(e.props.index=.5*(this.prev.props.index+this.props.index),this.prev.next=e):e.props.index=.5*this.props.index,e.next=this,this.prev=e,e.root=r;var i=n.children,o=i.indexOf(this);i.splice(o,0,e),n.isDestroyed?t&&t(!0):(e.willMount(),n.insertStruct(e,o),r.addUpdate(e,[],Nx.REFLOW,!0,!1,(function(r){!r&&e.page&&e.didMount(),t&&t(r)})))},t.prototype.calReflowStyle=function(){var e=this,t=e.style,r=e.computedStyle,n=e.parent;r.fontFamily=t.fontFamily.v,r.fontSize=t.fontSize.v,r.fontWeight=t.fontWeight.v,r.fontStyle=t.fontStyle.v;var i=t.lineHeight;i.u===Xs.AUTO?r.lineHeight=$u(r):r.lineHeight=i.v,this.width=this.height=0;var o=t.width,a=t.height;n&&(o.u!==Xs.AUTO&&(this.width=r.width=Math.max(this.minWidth,rh(o,n.width))),a.u!==Xs.AUTO&&(this.height=r.height=Math.max(this.minHeight,rh(a,n.height)))),r.letterSpacing=t.letterSpacing.v,r.paragraphSpacing=t.paragraphSpacing.v,r.textAlign=t.textAlign.v,r.textVerticalAlign=t.textVerticalAlign.v},t.prototype.calRepaintStyle=function(e){var t=this.style,r=this.computedStyle;r.visibility=t.visibility.v,r.color=t.color.v,r.backgroundColor=t.backgroundColor.v,r.fill=t.fill.map((function(e){var t,r;if(Array.isArray(e.v))return e.v.slice(0);var n=e.v;if(n&&void 0!==n.url)return{url:n.url,type:n.type,scale:.01*(null!==(r=null===(t=n.scale)||void 0===t?void 0:t.v)&&void 0!==r?r:100)};var i=e.v;return{t:i.t,d:i.d.slice(0),stops:i.stops.map((function(e){var t=.01*e.offset.v;return{color:e.color.v.slice(0),offset:t}}))}})),r.fillEnable=t.fillEnable.map((function(e){return e.v})),r.fillOpacity=t.fillOpacity.map((function(e){return e.v})),r.fillMode=t.fillMode.map((function(e){return e.v})),r.fillRule=t.fillRule.v,r.stroke=t.stroke.map((function(e){if(Array.isArray(e.v))return e.v.slice(0);var t=e.v;return{t:t.t,d:t.d.slice(0),stops:t.stops.map((function(e){var t=e.offset?.01*e.offset.v:void 0;return{color:e.color.v.slice(0),offset:t}}))}})),r.strokeEnable=t.strokeEnable.map((function(e){return e.v})),r.strokeWidth=t.strokeWidth.map((function(e){return e.v})),r.strokePosition=t.strokePosition.map((function(e){return e.v})),r.strokeMode=t.strokeMode.map((function(e){return e.v})),r.strokeDasharray=t.strokeDasharray.map((function(e){return e.v})),r.strokeLinecap=t.strokeLinecap.v,r.strokeLinejoin=t.strokeLinejoin.v,r.strokeMiterlimit=t.strokeMiterlimit.v,r.booleanOperation=t.booleanOperation.v,r.mixBlendMode=t.mixBlendMode.v,r.pointerEvents=t.pointerEvents.v,e&(Nx.MASK|Nx.REFLOW|Nx.REPAINT)&&this.calMask(),r.innerShadow=t.innerShadow.map((function(e){var t=e.v;return{x:t.x.v,y:t.y.v,blur:t.blur.v,spread:t.spread.v,color:t.color.v}})),r.innerShadowEnable=t.innerShadowEnable.map((function(e){return e.v})),r.textDecoration=t.textDecoration.map((function(e){return e.v})),e&Nx.REFLOW_TRANSFORM&&this.calMatrix(e),e&Nx.REFLOW_OPACITY&&this.calOpacity(),e&Nx.REFLOW_FILTER&&this.calFilter(e),this.clearCache(!0),this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0},t.prototype.calMask=function(){var e=this.style,t=this.computedStyle;t.maskMode=e.maskMode.v,t.breakMask=e.breakMask.v;var r=this.prev;if(r&&!t.breakMask&&(r.computedStyle.maskMode?this.mask=r:r.mask&&(this.mask=r.mask)),t.maskMode){this.mask=void 0;for(var n=this.next;n;){if(n.computedStyle.maskMode){n.mask=this;break}if(n.computedStyle.breakMask)break;n.mask=this,n=n.next}}else{var i=t.breakMask?void 0:this.mask;this.mask=i;for(n=this.next;n;){if(n.computedStyle.maskMode){n.mask=i;break}if(n.computedStyle.breakMask)break;n.mask=i,n=n.next}}},t.prototype.calFilter=function(e){var t,r,n,i=this.style,o=this.computedStyle,a=i.blur.v;o.blur={t:a.t,radius:(null===(t=a.radius)||void 0===t?void 0:t.v)||0,center:a.center?a.center.map((function(e){return.01*e.v})):[.5,.5],saturation:.01*(null!==(n=null===(r=a.saturation)||void 0===r?void 0:r.v)&&void 0!==n?n:100),angle:a.angle?a.angle.v:0},o.shadow=i.shadow.map((function(e){var t=e.v;return{x:t.x.v,y:t.y.v,blur:t.blur.v,spread:t.spread.v,color:t.color.v}})),o.shadowEnable=i.shadowEnable.map((function(e){return e.v})),o.hueRotate=i.hueRotate.v,o.saturate=.01*i.saturate.v,o.brightness=.01*i.brightness.v,o.contrast=.01*i.contrast.v,e<Nx.REPAINT&&(this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0,this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.resetTextureTarget())},t.prototype.calMatrix=function(e){var t=this,r=this,n=r.style,i=r.computedStyle,o=r.matrix,a=r.transform;!this.hasCacheMw&&this.localMwId||(this.hasCacheMw=!1,this.localMwId++);var s=!0;if((e>=Nx.REFLOW||e&Nx.TRANSFORM||e&Nx.SCALE_X&&!i.scaleX||e&Nx.SCALE_Y&&!i.scaleY)&&(s=!1),s){if(e&Nx.TRANSLATE_X){var l=(c=rh(n.translateX,this.width))-i.translateX;i.translateX=c,a[12]+=l,o[12]+=l}if(e&Nx.TRANSLATE_Y){l=(c=rh(n.translateY,this.height))-i.translateY;i.translateY=c,a[13]+=l,o[13]+=l}if(e&Nx.ROTATE_Z){var c=n.rotateZ.v;i.rotateZ=c;var u=wc(c),h=Math.sin(u),d=Math.cos(u),f=i.scaleX,p=i.scaleY;o[0]=a[0]=d*f,o[1]=a[1]=h*p,o[4]=a[4]=-h*f,o[5]=a[5]=d*p;var v=(x=i.transformOrigin)[0],m=x[1];o[12]=a[12]+v-a[0]*v-m*a[4],o[13]=a[13]+m-a[1]*v-m*a[5]}if(e&Nx.SCALE){if(e&Nx.SCALE_X){f=(c=n.scaleX.v)/i.scaleX;i.scaleX=c,a[0]*=f,a[4]*=f,o[0]*=f,o[4]*=f}if(e&Nx.SCALE_Y){p=(c=n.scaleY.v)/i.scaleY;i.scaleY=c,a[1]*=p,a[5]*=p,o[1]*=p,o[5]*=p}v=(x=i.transformOrigin)[0],m=x[1];o[12]=a[12]+v-a[0]*v-a[4]*m,o[13]=a[13]+m-a[1]*v-a[5]*m,o[14]=a[14]-a[2]*v-a[6]*m}}else{sc(a);var g=n.transformOrigin.map((function(e,r){return rh(e,r?t.height:t.width)}));i.transformOrigin=g;var y=i.left,b=i.top;if(n.matrix)return i.matrix=n.matrix.v.slice(0),cc(o,i.matrix),this.transform=Fc(o,g[0],g[1]),o;i.translateX=rh(n.translateX,this.width),a[12]=y+i.translateX,i.translateY=rh(n.translateY,this.height),a[13]=b+i.translateY;var x,w=n.rotateZ?n.rotateZ.v:0,E=n.scaleX?n.scaleX.v:1,_=n.scaleY?n.scaleY.v:1;i.rotateZ=w,i.scaleX=E,i.scaleY=_,1!==E&&(oc(a)?a[0]=E:pc(a,E)),1!==_&&(oc(a)?a[5]=_:vc(a,_)),oc(a)?Lc(a,w):w&&fc(a,wc(w)),cc(o,x=Ic(a,g[0],g[1]))}return o},t.prototype.calOpacity=function(){var e=this.style,t=this.computedStyle;!this.hasCacheOp&&this.localOpId||(this.hasCacheOp=!1,this.localOpId++),t.opacity=e.opacity.v},t.prototype.calContent=function(){return this.hasContent=!1},t.prototype.renderCanvas=function(e){var t=this.canvasCache;t&&t.available&&e&&t.release()},t.prototype.genTexture=function(e,t,r){var n;this.renderCanvas(t),null===(n=this.textureCache[r])||void 0===n||n.release();var i=this.canvasCache;(null==i?void 0:i.available)?(this.textureTarget[r]=this.textureCache[r]=Rw.getInstance(e,i,(this._bbox2||this.bbox2).slice(0)),i.release()):this.textureTarget[r]=this.textureCache[r]=void 0},t.prototype.resetTextureTarget=function(){for(var e,t,r,n,i=this,o=i.textureMask,a=i.textureFilter,s=i.textureTotal,l=i.textureCache,c=0,u=Math.max(l.length,s.length);c<u;c++)(null===(e=o[c])||void 0===e?void 0:e.available)?this.textureTarget[c]=o[c]:(null===(t=a[c])||void 0===t?void 0:t.available)?this.textureTarget[c]=a[c]:(null===(r=s[c])||void 0===r?void 0:r.available)?this.textureTarget[c]=s[c]:(null===(n=l[c])||void 0===n?void 0:n.available)?this.textureTarget[c]=l[c]:this.textureTarget[c]=void 0},t.prototype.clearCache=function(e){var t=this;void 0===e&&(e=!1),this.textureTarget.splice(0),e?(this.refreshLevel|=Nx.REPAINT,this.textureCache.forEach((function(e){return null==e?void 0:e.release()}))):this.textureCache.forEach((function(e,r){e&&e.available&&(t.textureTarget[r]=e)})),this.textureTotal.forEach((function(e){return null==e?void 0:e.release()})),this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.textureOutline.forEach((function(e){return null==e?void 0:e.release()}))},t.prototype.clearCacheUpward=function(e){void 0===e&&(e=!1);for(var t=this.parent;t;){t.tempBbox=void 0,t.clearCache(e);var r=t.mask;r&&r.clearMask(),t=t.parent}},t.prototype.clearMask=function(e){if(void 0===e&&(e=!0),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.resetTextureTarget(),this.struct.next=0,e)for(var t=this.parent;t&&t!==this.root;)t._rect=void 0,t._bbox=void 0,t._bbox2=void 0,t._filterBbox=void 0,t._filterBbox2=void 0,t.tempBbox=void 0,t=t.parent},t.prototype.remove=function(e){var t=this.root,r=this.parent;if(r){var n=r.children.indexOf(this);if(-1===n)throw new Error("Invalid index of remove()");r.children.splice(n,1);var i=this.prev,o=this.next;i&&(i.next=o),o&&(o.prev=i)}this.prev=this.next=void 0,this.isPage||(this.page=void 0),this.isArtBoard||(this.artBoard=void 0),this.isSymbolInstance||(this.symbolInstance=void 0),this.isDestroyed?e&&e(!0):(null==r||r.deleteStruct(this),t.addUpdate(this,[],Nx.REFLOW,!1,!0,e))},t.prototype.destroy=function(){this.isDestroyed||(this.isDestroyed=!0,this.clearCache(!0),this.parent=this.root=this.mask=void 0)},t.prototype.structure=function(e){var t=this.struct;return t.lv=e,[t]},t.prototype.updateFormatStyleData=function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];Yu(r,e,this.style)||(this.style[r]=n,t.push(r))}return t},t.prototype.updateFormatStyle=function(e,t){var r,n=this.updateFormatStyleData(e);return n.length?{keys:n,lv:null===(r=this.root)||void 0===r?void 0:r.addUpdate(this,n,void 0,!1,!1,t)}:(t&&t(!0),{keys:n,lv:Nx.NONE})},t.prototype.updateStyleData=function(e){var t=Hu(e);return this.updateFormatStyleData(t)},t.prototype.updateStyle=function(e,t){var r=Hu(e);return this.updateFormatStyle(r,t)},t.prototype.updateProps=function(e,t){var r,n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];Fs(o,this.props[i])||(this.props[i]=o,n.push(o))}if(!n.length)return t&&t(!0),n;null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t)},t.prototype.refreshStyle=function(e,t){var r,n,i=this;return Array.isArray(e)?n=e.slice(0):(n=Object.keys(e)).forEach((function(t){i.style[t]=e[t]})),n.length?(null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t),n):(t&&t(!0),n)},t.prototype.refreshProps=function(e,t){var r,n,i=this;return Array.isArray(e)?n=e.slice(0):(n=Object.keys(e)).forEach((function(t){i.props[t]=e[t]})),n.length?(null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t),n):(t&&t(!0),n)},t.prototype.refresh=function(e,t){var r;void 0===e&&(e=Nx.REPAINT),null===(r=this.root)||void 0===r||r.addUpdate(this,[],e,!1,!1,t)},t.prototype.getStyle=function(){return Ps(this.style)},t.prototype.getComputedStyle=function(){var e=Object.assign({},this.computedStyle);return e.color=e.color.slice(0),e.backgroundColor=e.backgroundColor.slice(0),e.fill=Ps(e.fill),e.stroke=Ps(e.stroke),e.shadow=Ps(e.shadow),e.innerShadow=Ps(e.innerShadow),e.fillOpacity=e.fillOpacity.slice(0),e.fillEnable=e.fillEnable.slice(0),e.fillMode=e.fillMode.slice(0),e.strokeEnable=e.strokeEnable.slice(0),e.strokeWidth=e.strokeWidth.slice(0),e.transformOrigin=e.transformOrigin.slice(0),e.strokeDasharray=e.strokeDasharray.slice(0),e.shadowEnable=e.shadowEnable.slice(0),e},t.prototype.getCssStyle=function(){var e=this,t={},r=this.style,n=this.computedStyle;["top","right","bottom","left","width","height","translateX","translateY","scaleX","scaleY","rotateZ"].forEach((function(e){var n=r[e];n.u===Xs.AUTO?t[e]="auto":n.u===Xs.PERCENT?t[e]=n.v+"%":n.u!==Xs.PX&&n.u!==Xs.NUMBER&&n.u!==Xs.DEG||(t[e]=n.v)})),t.opacity=n.opacity,t.visibility=n.visibility===nl.VISIBLE?"visible":"hidden",t.color=qu(n.color),t.backgroundColor=qu(n.backgroundColor),t.fontStyle=["normal","italic","oblique"][n.fontStyle],t.textAlign=["left","center","right","justify"][n.textAlign],t.textVerticalAlign=["top","middle","bottom"][n.textVerticalAlign],t.mixBlendMode=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"][n.mixBlendMode],["shadowEnable","strokeEnable","fillEnable","fillOpacity","strokeWidth"].forEach((function(e){t[e]=n[e].slice(0)})),t.fill=n.fill.map((function(t){return oh(t,e.width,e.height)})),t.fillRule=["nonzero","evenodd"][n.fillRule],t.stroke=n.stroke.map((function(t){return oh(t,e.width,e.height)})),t.strokeLinecap=["butt","round","square"][n.strokeLinecap],t.strokeLinejoin=["miter","round","bevel"][n.strokeLinejoin],t.strokePosition=n.strokePosition.map((function(e){return ah(e)})),t.maskMode=["none","outline","alpha","gray","alpha-with","gray-with"][n.maskMode],t.booleanOperation=["none","union","subtract","intersect","xor"][n.booleanOperation];var i=n.blur;t.blur=nh(i.t,i.radius,i.angle,i.center,i.saturation),t.shadow=n.shadow.map((function(e){return ih(e)}));var o=r.transformOrigin;return t.transformOrigin=n.transformOrigin.map((function(e,t){var r=o[t];return r.u===Xs.PERCENT?r.v+"%":e})),t.hueRotate=n.hueRotate,t.saturate=100*n.saturate+"%",t.brightness=100*n.brightness+"%",t.contrast=100*n.contrast+"%",t},t.prototype.getBoundingClientRect=function(e){var t,r,n=(null==e?void 0:e.includeBbox)?this._bbox||this.bbox:this._rect||this.rect;if((null==e?void 0:e.excludeRotate)&&this.computedStyle.rotateZ){var i=this.parent,o=ic(),a=this.matrix;o[12]=a[12],o[13]=a[13];var s=ac(i.matrixWorld,o);r=bc(n[0],n[1],n[2],n[3],s)}else r=bc(n[0],n[1],n[2],n[3],this.matrixWorld);var l=(null===(t=this.root)||void 0===t?void 0:t.dpi)||1,c=(null==e?void 0:e.excludeDpi)?r.x1/l:r.x1,u=(null==e?void 0:e.excludeDpi)?r.y1/l:r.y1,h=(null==e?void 0:e.excludeDpi)?r.x2/l:r.x2,d=(null==e?void 0:e.excludeDpi)?r.y2/l:r.y2,f=(null==e?void 0:e.excludeDpi)?r.x3/l:r.x3,p=(null==e?void 0:e.excludeDpi)?r.y3/l:r.y3,v=(null==e?void 0:e.excludeDpi)?r.x4/l:r.x4,m=(null==e?void 0:e.excludeDpi)?r.y4/l:r.y4,g=Math.min(c,h,f,v),y=Math.min(u,d,p,m),b=Math.max(c,h,f,v),x=Math.max(u,d,p,m);return{left:g,top:y,right:b,bottom:x,width:b-g,height:x-y,points:[{x:c,y:u},{x:h,y:d},{x:f,y:p},{x:v,y:m}]}},t.prototype.startSizeChange=function(){var e=this,t=e.width,r=e.height,n=e.style,i=e.computedStyle,o=e.parent;if(e.isDestroyed||!o)throw new Error("Can not resize a destroyed Node or Root");var a=n.left,s=n.right,l=n.top,c=n.bottom,u=n.translateX,h=n.translateY,d=o.width,f=o.height;if(u.v&&u.u===Xs.PERCENT){var p=u.v*t*.01;a.u===Xs.PERCENT?a.v+=100*p/d:a.u===Xs.PX&&(a.v+=p),i.left+=p,s.u===Xs.PERCENT?s.v-=100*p/d:s.u===Xs.PX&&(s.v-=p),i.right-=p,u.v=0}if(h.v&&h.u===Xs.PERCENT){p=h.v*r*.01;l.u===Xs.PERCENT?l.v+=100*p/f:l.u===Xs.PX&&(l.v+=p),i.top+=p,c.u===Xs.PERCENT?c.v-=100*p/f:c.u===Xs.PX&&(c.v-=p),i.bottom-=p,h.v=0}},t.prototype.endSizeChange=function(e){var t=e.translateX,r=e.translateY,n=this,i=n.style,o=n.computedStyle,a=n.parent,s=n.width,l=n.height,c=i.left,u=i.right,h=i.top,d=i.bottom,f=a,p=f.width,v=f.height;if(t.v&&t.u===Xs.PERCENT){var m=t.v*s*.01;c.u===Xs.PX?c.v-=m:c.u===Xs.PERCENT&&(c.v-=100*m/p),o.left-=m,u.u===Xs.PX?u.v+=m:u.u===Xs.PERCENT&&(u.v+=100*m/p),o.right+=m,o.translateX+=m}if(r.v&&r.u===Xs.PERCENT){m=r.v*l*.01;h.u===Xs.PX?h.v-=m:i.top.u===Xs.PERCENT&&(h.v-=100*m/v),o.top-=m,d.u===Xs.PX?d.v+=m:d.u===Xs.PERCENT&&(d.v+=100*m/v),o.bottom+=m,o.translateY+=m}i.translateX.v=t.v,i.translateX.u=t.u,i.translateY.v=r.v,i.translateY.u=r.u},t.prototype.endPosChange=function(e,t,r){var n=this,i=n.style,o=n.computedStyle,a=n.parent;if(a){var s=e.translateX,l=e.translateY,c=i.top,u=i.right,h=i.bottom,d=i.left,f=a.width,p=a.height;t&&(d.u===Xs.PX?d.v+=t:d.u===Xs.PERCENT&&(d.v+=100*t/f),o.left+=t,u.u===Xs.PX?u.v-=t:u.u===Xs.PERCENT&&(u.v-=100*t/f),o.right-=t,o.translateX-=t),r&&(c.u===Xs.PX?c.v+=r:c.u===Xs.PERCENT&&(c.v+=100*r/p),o.top+=r,h.u===Xs.PX?h.v-=r:h.u===Xs.PERCENT&&(h.v-=100*r/p),o.bottom-=r,o.translateY-=r),i.translateX.v=s.v,i.translateX.u=s.u,i.translateY.v=l.v,i.translateY.u=l.u}},t.prototype.checkShapeChange=function(){},t.prototype.clearPoints=function(){},t.prototype.adjustPosAndSizeSelf=function(e,t,r,n){var i=this,o=i.style,a=i.computedStyle,s=i.parent,l=i.root;if(s&&l&&(e||t||r||n)){var c=s.width,u=s.height,h=o.top,d=o.right,f=o.bottom,p=o.left,v=o.width,m=o.height;e&&(p.u===Xs.PX?p.v+=e:p.u===Xs.PERCENT&&(p.v+=100*e/c),a.left+=e),r&&(d.u===Xs.PX?d.v-=r:d.u===Xs.PERCENT?d.v-=100*r/c:v.u===Xs.PX?v.v=r+this.width-e:v.u===Xs.PERCENT&&(v.v=100*(r+this.width-e)/s.width),a.right-=r),this.width=a.width=s.width-a.left-a.right,t&&(h.u===Xs.PX?h.v+=t:h.u===Xs.PERCENT&&(h.v+=100*t/u),a.top+=t),n&&(f.u===Xs.PX?f.v-=n:f.u===Xs.PERCENT?f.v-=100*n/u:m.u===Xs.PX?m.v=n+this.height-t:m.u===Xs.PERCENT&&(m.v=100*(n+this.height-t)/s.height),a.bottom-=n),this.height=a.height=s.height-a.top-a.bottom,this.refreshLevel|=Nx.TRANSFORM,l.rl|=Nx.TRANSFORM,this.calMatrix(Nx.TRANSFORM),this._rect=void 0,this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0}},t.prototype.checkPosSizeUpward=function(){for(var e=this.root,t=this.parent;t&&t!==e&&t.adjustPosAndSize();)t=t.parent},t.prototype.adjustPosAndSize=function(){return!1},t.prototype.getZoom=function(e){void 0===e&&(e=!1);for(var t=this.computedStyle.scaleX,r=this.parent;r&&r!==this.page&&!r.isPage;)t*=r.computedStyle.scaleX,r=r.parent;return!e&&this.root?t*this.root.dpi:t},t.prototype.setZoom=function(e,t){void 0===t&&(t=!1),t&&this.root&&(e/=this.root.dpi),this.updateStyle({scaleX:e,scaleY:e})},t.prototype.rename=function(e){this.props.name=e},t.prototype.getStructs=function(){return this.root?[this.struct]:[]},t.prototype.isSibling=function(e){for(var t=this.prev;t;){if(t===e)return!0;t=t.prev}for(var r=this.next;r;){if(r===e)return!0;r=r.next}return!1},t.prototype.toJson=function(){return{tagName:"node",props:Ps(this.props)}},t.prototype.toSketchJson=function(e,t){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,l,c,u,h,d,f,p,v,m,g,y,b,x,w,E,_,S,C,T,A,k,M=this;return Q(this,(function(O){switch(O.label){case 0:return r=(t=this).props,n=t.width,i=t.height,o=t.style,a=t.computedStyle,l=0,o.left.v===Xs.PX&&(l|=lh.LEFT),o.right.v===Xs.PX&&(l|=lh.RIGHT),o.top.v===Xs.PX&&(l|=lh.TOP),o.bottom.v===Xs.PX&&(l|=lh.BOTTOM),o.width.v===Xs.PX&&(l|=lh.WIDTH),o.height.v===Xs.PX&&(l|=lh.HEIGHT),l^=lh.UNSET,c=ee.LineCapStyle.Butt,a.strokeLinecap===$s.ROUND?c=ee.LineCapStyle.Round:a.strokeLinecap===$s.SQUARE&&(c=ee.LineCapStyle.Projecting),u=ee.LineJoinStyle.Miter,a.strokeLinejoin===el.ROUND?u=ee.LineJoinStyle.Round:a.strokeLinejoin===el.BEVEL&&(u=ee.LineJoinStyle.Bevel),h=a.shadow,d=a.shadowEnable,f=a.innerShadow,p=a.innerShadowEnable,v=a.blur,m=a.hueRotate,g=a.brightness,y=a.contrast,b=a.saturate,x=a.opacity,w=a.mixBlendMode,E=a.scaleX,_=a.scaleY,S=[],C=[],h.forEach((function(e,t){S.push({_class:"shadow",isEnabled:d[t],blurRadius:e.blur,color:xh(e.color),contextSettings:{_class:"graphicsContextSettings",blendMode:ee.BlendMode.Normal,opacity:1},offsetX:e.x,offsetY:e.y,spread:e.spread})})),f.forEach((function(e,t){C.push({_class:"innerShadow",isEnabled:p[t],blurRadius:e.blur,color:xh(e.color),contextSettings:{_class:"graphicsContextSettings",blendMode:ee.BlendMode.Normal,opacity:1},offsetX:e.x,offsetY:e.y,spread:e.spread})})),T={booleanOperation:a.booleanOperation-1,clippingMaskMode:a.maskMode===Qs.ALPHA?1:0,do_objectID:r.uuid,exportOptions:{exportFormats:[],includedLayerIds:[],layerOptions:0,shouldTrim:!1,_class:"exportOptions"},frame:{constrainProportions:r.constrainProportions||!1,width:n||0,height:i||0,x:a.left+a.translateX,y:a.top+a.translateY,_class:"rect"},hasClippingMask:a.maskMode!==Qs.NONE,isFixedToViewport:!1,isFlippedHorizontal:-1===E,isFlippedVertical:-1===_,isLocked:r.isLocked||!1,isTemplate:!1,isVisible:a.visibility===nl.VISIBLE,layerListExpandedType:r.isExpanded?ee.LayerListExpanded.Expanded:ee.LayerListExpanded.Collapsed,name:r.name||"",nameIsFixed:r.nameIsFixed||!1,resizingConstraint:l,resizingType:ee.ResizeType.Stretch,rotation:-a.rotateZ,shouldBreakMaskChain:a.breakMask,style:{_class:"style",do_objectID:this.props.styleId||s(),borderOptions:{_class:"borderOptions",isEnabled:!0,dashPattern:a.strokeDasharray,lineCapStyle:c,lineJoinStyle:u},startMarkerType:ee.MarkerType.OpenArrow,endMarkerType:ee.MarkerType.OpenArrow,miterLimit:a.strokeMiterlimit,windingRule:a.fillRule===Js.EVEN_ODD?ee.WindingRule.EvenOdd:ee.WindingRule.NonZero,shadows:S,innerShadows:C,colorControls:{_class:"colorControls",isEnabled:!0,brightness:g-1,contrast:y,hue:wc(m),saturation:b},contextSettings:{_class:"graphicsContextSettings",blendMode:[0,2,5,7,1,4,6,3,9,8,10,11,12,13,14,15][w]||0,opacity:x}}},A=T.style,[4,Promise.all(a.fill.map((function(t,r){return J(M,void 0,void 0,(function(){var n,i,o,l,c,u,h,d,f,p;return Q(this,(function(v){switch(v.label){case 0:return n={_class:"color",alpha:1,red:0,green:0,blue:0},i={_class:"gradient",gradientType:ee.GradientType.Linear,elipseLength:1,from:"",to:"",stops:[]},o=ee.FillType.Color,l=ee.PatternFillType.Tile,c=1,Array.isArray(t)?(xh(t,n),[3,5]):[3,1];case 1:return t.url?(o=ee.FillType.Pattern,l=t.type,c=t.scale,(h=e.folder("images"))?[4,fetch(t.url)]:[3,3]):[3,4];case 2:d=v.sent(),f=d.blob(),p=(this.props.uuid||s())+".png",h.file(p,f),u={_class:"MSJSONFileReference",_ref_class:"MSImageData",_ref:"images/"+p},v.label=3;case 3:return[3,5];case 4:o=ee.FillType.Gradient,i.from="{"+t.d[0]+", "+t.d[1]+"}",i.to="{"+t.d[2]+", "+t.d[3]+"}",t.t===Ws.RADIAL?(i.gradientType=ee.GradientType.Radial,i.elipseLength=t.d[4]):t.t===Ws.CONIC&&(i.gradientType=ee.GradientType.Angular),t.stops.forEach((function(e){i.stops.push({_class:"gradientStop",color:xh(e.color),position:e.offset||0})})),v.label=5;case 5:return[2,{_class:"fill",isEnabled:a.fillEnable[r],color:n,fillType:o,noiseIndex:0,noiseIntensity:0,patternFillType:l,patternTileScale:c,gradient:i,image:u,contextSettings:{_class:"graphicsContextSettings",blendMode:ee.BlendMode.Normal,opacity:a.fillOpacity[r]}}]}}))}))})))];case 1:return A.fills=O.sent(),T.style.borders=a.stroke.map((function(e,t){var r={_class:"color",alpha:1,red:0,green:0,blue:0},n={_class:"gradient",gradientType:ee.GradientType.Linear,elipseLength:1,from:"",to:"",stops:[]},i=ee.FillType.Color;Array.isArray(e)?xh(e,r):(i=ee.FillType.Gradient,n.from="{"+e.d[0]+", "+e.d[1]+"}",n.to="{"+e.d[2]+", "+e.d[3]+"}",e.t===Ws.RADIAL?(n.gradientType=ee.GradientType.Radial,n.elipseLength=e.d[4]):e.t===Ws.CONIC&&(n.gradientType=ee.GradientType.Angular),e.stops.forEach((function(e){n.stops.push({_class:"gradientStop",color:xh(e.color),position:e.offset||0})})));var o=ee.BorderPosition.Center;return a.strokePosition[t]===tl.INSIDE?o=ee.BorderPosition.Inside:a.strokePosition[t]===tl.OUTSIDE&&(o=ee.BorderPosition.Outside),{_class:"border",isEnabled:a.strokeEnable[t],color:r,fillType:i,position:o,thickness:a.strokeWidth[t],gradient:n,contextSettings:{_class:"graphicsContextSettings",blendMode:ee.BlendMode.Normal,opacity:1}}})),v.t!==qs.GAUSSIAN&&v.t!==qs.MOTION&&v.t!==qs.BACKGROUND&&v.t!==qs.RADIAL||(k=void 0,k=v.center?"{"+v.center.join(", ")+"}":"{0.5, 0.5}",T.style.blur={_class:"blur",isEnabled:!0,center:k,motionAngle:wc(v.angle||0),radius:v.radius||0,saturation:v.saturation||0,type:[ee.BlurType.Gaussian,ee.BlurType.Motion,ee.BlurType.Zoom,ee.BlurType.Background][v.t-1]}),[2,T]}}))}))},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r);return n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.addTile=function(e){-1===this.tileList.indexOf(e)&&(this.tileList.push(e),e.add(this))},t.prototype.removeTile=function(e){var t=this.tileList.indexOf(e);t>-1&&this.tileList.splice(t,1)[0].remove(this)},t.prototype.cleanTile=function(){var e=this,t=this.tileList.splice(0);return t.forEach((function(t){t.remove(e)})),t},t.prototype.isParent=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},t.prototype.isChild=function(e){return e.isParent(this)},Object.defineProperty(t.prototype,"opacity",{get:function(){var e,t=this.root;if(!t)return this._opacity;for(var r=this,n=this.hasCacheOp,i=r.parent,o=-1,a=[];i;)a.push(i),i.hasCacheOp&&i.localOpId===r.parentOpId||(n=!1,o=a.length),r=i,i=i.parent;if(!n){if(o>-1){a.splice(o),a.reverse();for(var s=0,l=a.length;s<l;s++){var c=a[s];c.hasCacheOp&&c.localOpId!==(null===(e=c.parent)||void 0===e?void 0:e.parentOpId)&&c.localOpId++,c.hasCacheOp=!0,c===t?c._opacity=c.computedStyle.opacity:(c._opacity=c.parent._opacity*c.computedStyle.opacity,c.parentOpId=c.parent.localOpId)}}this.hasCacheOp&&this.localOpId++,this.hasCacheOp=!0,(i=this.parent)?(this._opacity=i._opacity*this.computedStyle.opacity,this.parentOpId=i.localOpId):this._opacity=this.computedStyle.opacity}return this._opacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"matrixWorld",{get:function(){var e,t=this.root,r=this._matrixWorld;if(!t)return r;for(var n=this,i=this.hasCacheMw,o=n.parent,a=-1,s=[];o;)s.push(o),o.hasCacheMw&&o.localMwId===n.parentMwId||(i=!1,a=s.length),n=o,o=o.parent;if(!i){if(a>-1){s.splice(a),s.reverse();for(var l=0,c=s.length;l<c;l++){var u=s[l];if(u.hasCacheMw&&u.parentMwId!==(null===(e=u.parent)||void 0===e?void 0:e.localMwId)&&u.localMwId++,u.hasCacheMw=!0,u===t)cc(u._matrixWorld,u.matrix);else{var h=ac(u.parent._matrixWorld,u.matrix);cc(u._matrixWorld,h),u.parentMwId=u.parent.localMwId}}}if(this.hasCacheMw&&this.localMwId++,this.hasCacheMw=!0,o=this.parent)cc(r,h=ac(o._matrixWorld,this.matrix)),this.parentMwId=o.localMwId;else cc(r,this.matrix)}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;return e||((e=this._rect=new Float64Array(4))[0]=0,e[1]=0,e[2]=this.width,e[3]=this.height),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===tl.INSIDE||(a=o[t]===tl.OUTSIDE?Math.max(a,e):Math.max(a,.5*e)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterBbox",{get:function(){var e=this._filterBbox;if(!e){var t=this._bbox||this.bbox;e=this._filterBbox=t.slice(0);for(var r=this.computedStyle,n=r.shadow,i=r.shadowEnable,o=r.blur,a=[0,0,0,0],s=0,l=n.length;s<l;s++)if(i[s]){var c=n[s];if(c.color[3]>0){var u=Mw(kw(.5*c.blur));(c.x||c.y||u)&&(a[0]=Math.min(a[0],c.x-u),a[1]=Math.min(a[1],c.y-u),a[2]=Math.max(a[2],c.x+u),a[3]=Math.max(a[3],c.y+u))}}if(e[0]+=a[0],e[1]+=a[1],e[2]+=a[2],e[3]+=a[3],o.t===qs.GAUSSIAN||o.t===qs.MOTION||o.t===qs.BACKGROUND||o.t===qs.RADIAL){var h=o.radius;if(h>0)(u=Mw(kw(h)))&&(e[0]-=u,e[1]-=u,e[2]+=u,e[3]+=u)}}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox2",{get:function(){var e=this._bbox2;return e||((e=(this._bbox||this.bbox).slice(0))[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterBbox2",{get:function(){var e=this._filterBbox2;return e||((e=(this._filterBbox||this.filterBbox).slice(0))[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])),e},enumerable:!1,configurable:!0}),t}(_w),Pw=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this,t)||this;n.children=r;var i=r.length;if(i){var o=r[0];o.parent=n;for(var a=o,s=1;s<i;s++){var l=r[s];l.parent=n,a.next=l,l.prev=a,a=l}}return n.isContainer=!0,n}return v(t,e),t.prototype.willMount=function(){e.prototype.willMount.call(this);var t=this.children,r=t.length;if(r){var n=t[0];n.parent=this,n.willMount();for(var i=n,o=1;o<r;o++){var a=t[o];a.parent=this,a.willMount(),i.next=a,a.prev=i,i=a}}},t.prototype.didMount=function(){for(var t=this.children,r=t.length,n=0;n<r;n++)t[n].didMount();e.prototype.didMount.call(this)},t.prototype.lay=function(t){e.prototype.lay.call(this,t);var r=this.children;this.computedStyle;for(var n=0,i=r.length;n<i;n++){r[n].layout({w:this.width,h:this.height})}},t.prototype.getChildrenRect=function(e){for(var t=this.children,r={minX:0,minY:0,maxX:0,maxY:0},n=!1,i=!0,o=0,a=t.length;o<a;o++){var s=t[o],l=s.computedStyle;if(!n||l.breakMask){if(l.maskMode){n=!0;for(var c=s.next;c&&!c.computedStyle.breakMask;)o++,c=c.next}else l.breakMask&&(n=!1);if(e!==s){var u=s._rect||s.rect,h=bc(u[0],u[1],u[2],u[3],s.matrix),d=h.x1,f=h.y1,p=h.x2,v=h.y2,m=h.x3,g=h.y3,y=h.x4,b=h.y4,x=Math.min(d,p,m,y),w=Math.min(f,v,g,b),E=Math.max(d,p,m,y),_=Math.max(f,v,g,b);i?(i=!1,r.minX=x,r.minY=w,r.maxX=E,r.maxY=_):(r.minX=Math.min(r.minX,x),r.minY=Math.min(r.minY,w),r.maxX=Math.max(r.maxX,E),r.maxY=Math.max(r.maxY,_))}}}return r},t.prototype.appendChild=function(e,t){e.remove();var r=this.root,n=this.children,i=n.length;if(i){var o=n[n.length-1];o.next=e,e.prev=o,e.props.index=.5*(o.props.index+1)}else e.props.index=.5;e.parent=this,e.root=r,n.push(e),this.isDestroyed?t&&t(!0):(e.willMount(),this.insertStruct(e,i),r.addUpdate(e,[],Nx.REFLOW,!0,!1,t))},t.prototype.prependChild=function(e,t){e.remove();var r=this.root,n=this.children;if(n.length){var i=n[0];i.next=e,e.prev=i,e.props.index=.5*i.props.index}else e.props.index=.5;e.parent=this,e.root=r,n.push(e),this.isDestroyed?t&&t(!0):(e.willMount(),this.insertStruct(e,0),r.addUpdate(e,[],Nx.REFLOW,!0,!1,(function(r){!r&&e.page&&e.didMount(),t&&t(r)})))},t.prototype.removeChild=function(e,t){e.parent===this?e.remove(t):fl.error("Invalid parameter of removeChild()")},t.prototype.clearChildren=function(e){var t=this.root,r=this.children;if(r.length){if(this.isDestroyed)return r.splice(0),void(e&&e(!0));for(;r.length;){var n=r.pop();this.deleteStruct(n),n.destroy()}t.addUpdate(this,[],Nx.REFLOW,!1,!1,e)}},t.prototype.destroy=function(){var t=this.isDestroyed,r=this.children;if(!t){for(var n=0,i=r.length;n<i;n++)r[n].destroy();e.prototype.destroy.call(this)}},t.prototype.structure=function(t){var r=e.prototype.structure.call(this,t);return this.children.forEach((function(e){r=r.concat(e.structure(t+1))})),r[0].num=this.children.length,r[0].total=r.length-1,r},t.prototype.insertStruct=function(e,t){var r,n=this.struct,i=this.root,o=e.structure(n.lv+1),a=i.structs;if(t){var s=this.children[t-1].struct,l=s.total;r=a.indexOf(s)+l+1}else r=a.indexOf(n)+1;a.splice.apply(a,$([r,0],o,!1));var c=o[0].total+1;n.num++,n.total+=c;for(var u=this.parent;u;)u.struct.total+=c,u=u.parent},t.prototype.deleteStruct=function(e){var t=e.struct,r=t.total+1,n=this.root.structs,i=n.indexOf(t);n.splice(i,r);var o=this.struct;o.num--,o.total-=r;for(var a=this.parent;a;)a.struct.total-=r,a=a.parent},t.prototype.getStructs=function(){if(!this.root)return[];var e=this.root.structs,t=this.struct,r=e.indexOf(t);return e.slice(r,r+t.total+1)},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.children=this.children.map((function(e){return e.toJson()})),t},t}(Iw),Fw=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.hasBackgroundColor=!!t.hasBackgroundColor,n.resizesContent=!!t.resizesContent,n.includeBackgroundColorInExport=!!t.includeBackgroundColorInExport,n.isArtBoard=!0,n.artBoard=n,n}return v(t,e),t.prototype.calContent=function(){return this.hasContent=this.hasBackgroundColor},t.prototype.rename=function(t){var r,n;e.prototype.rename.call(this,t),null===(n=null===(r=this.root)||void 0===r?void 0:r.overlay)||void 0===n||n.updateArtBoard(this)},t.prototype.renderBgc=function(e,t,r){var n=this.root.programs,i=this,o=i.width,a=i.height,s=i.matrixWorld,l=n.bgColorProgram;e.useProgram(l);var c=bc(0,0,o,a,s),u=new Float32Array(8),h=fw(c.x1,c.y1,t,r,!1),d=fw(c.x2,c.y2,t,r,!1),f=fw(c.x3,c.y3,t,r,!1),p=fw(c.x4,c.y4,t,r,!1);u[0]=h.x,u[1]=h.y,u[2]=p.x,u[3]=p.y,u[4]=d.x,u[5]=d.y,u[6]=f.x,u[7]=f.y;var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW);var m=e.getAttribLocation(l,"a_position");e.vertexAttribPointer(m,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(m);var g=e.getUniformLocation(l,"u_color"),y=Zu(this.computedStyle.backgroundColor);e.uniform4f(g,y[0],y[1],y[2],y[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(v),e.disableVertexAttribArray(m);var b=!0;if((h.x<=-1&&h.y<=-1&&f.x>=1&&f.y>=1||f.x<-1-4/t&&f.y<-1-4/r||h.x>1+4/t&&f.y>1+4/r)&&(b=!1),b){var x=n.bgShadowProgram;e.useProgram(x);var w=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,w),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var E=e.getAttribLocation(x,"a_position");e.vertexAttribPointer(E,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(E);var _=e.getUniformLocation(x,"u_tl");e.uniform2f(_,h.x,h.y);var S=e.getUniformLocation(x,"u_br");e.uniform2f(S,f.x,f.y);var C=e.getUniformLocation(x,"u_color");e.uniform4f(C,0,0,0,.2);var T=e.getUniformLocation(x,"u_radius");e.uniform2f(T,8/t,8/r),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(w),e.disableVertexAttribArray(E)}e.useProgram(n.program)},t.prototype.renderBgcTile=function(e,t,r,n,i,o,a){var s=this.root.programs,l=s.bgColorProgram;e.useProgram(l);var c={x1:a.x1-o.x*i,y1:a.y1-o.y*i,x2:a.x2-o.x*i,y2:a.y2-o.y*i,x3:a.x3-o.x*i,y3:a.y3-o.y*i,x4:a.x4-o.x*i,y4:a.y4-o.y*i},u=new Float32Array(8),h=fw(c.x1,c.y1,t,t,!1),d=fw(c.x2,c.y2,t,t,!1),f=fw(c.x3,c.y3,t,t,!1),p=fw(c.x4,c.y4,t,t,!1);u[0]=h.x,u[1]=h.y,u[2]=p.x,u[3]=p.y,u[4]=d.x,u[5]=d.y,u[6]=f.x,u[7]=f.y;var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW);var m=e.getAttribLocation(l,"a_position");e.vertexAttribPointer(m,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(m);var g=e.getUniformLocation(l,"u_color"),y=Zu(this.computedStyle.backgroundColor);e.uniform4f(g,y[0],y[1],y[2],y[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(v),e.disableVertexAttribArray(m);var b=s.bgShadowProgram;e.useProgram(b);var x=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,x),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var w=e.getAttribLocation(b,"a_position");e.vertexAttribPointer(w,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(w);var E=e.getUniformLocation(b,"u_tl");e.uniform2f(E,h.x,h.y);var _=e.getUniformLocation(b,"u_br");e.uniform2f(_,f.x,f.y);var S=e.getUniformLocation(b,"u_color");e.uniform4f(S,0,0,0,.2);var C=e.getUniformLocation(b,"u_radius");e.uniform2f(C,8/r,8/n),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(x),e.disableVertexAttribArray(w),e.useProgram(s.program)},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.ART_BOARD,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n,i,o;return Q(this,(function(a){switch(a.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=a.sent())._class=ee.ClassValue.Artboard,n.hasClickThrough=!1,n.includeBackgroundColorInExport=!1,n.isFlowHome=!1,n.resizesContent=this.resizesContent,n.includeBackgroundColorInExport=this.includeBackgroundColorInExport,n.horizontalRulerData={_class:"rulerData",base:0,guides:[]},n.verticalRulerData={_class:"rulerData",base:0,guides:[]},i=this.computedStyle,n.backgroundColor={alpha:i.backgroundColor[3],blue:i.backgroundColor[2]/255,green:i.backgroundColor[1]/255,red:i.backgroundColor[0]/255,_class:"color"},n.hasBackgroundColor=this.hasBackgroundColor,[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t,r)})))];case 2:return o=a.sent(),n.layers=o.map((function(e){return e})),[2,n]}}))}))},Object.defineProperty(t.prototype,"filterBbox",{get:function(){var e=this._filterBbox;if(!e){var t=this._bbox||this.bbox;(e=this._filterBbox=t.slice(0))[0]-=8,e[1]-=8,e[2]+=8,e[3]+=8}return e},enumerable:!1,configurable:!0}),t}(Pw),Dw={},Nw=function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this.available=!1,this.w=e,this.h=t,this.dx=r,this.dy=n,this.list=[];for(var i=bs.maxTextureSize,o=0,a=Math.ceil(t/i);o<a;o++)for(var s=0,l=Math.ceil(e/i);s<l;s++){var c=s===l-1?e-s*i:i,u=o===a-1?t-o*i:i;this.list.push({x:s*i-r,y:o*i-n,w:c,h:u,os:fl.getOffscreenCanvas(c,u)})}}return e.prototype.release=function(){this.available&&(this.available=!1,this.list.splice(0).forEach((function(e){return e.os.release()})))},e.prototype.releaseImg=function(e){if(this.available){this.available=!1;var t=Dw[e];t.count--,t.count||(delete Dw[e],this.list.splice(0).forEach((function(e){return e.os.release()})))}},e.prototype.getCount=function(e){var t;return null===(t=Dw[e])||void 0===t?void 0:t.count},e.getInstance=function(t,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),new e(t,r,n,i)},e.getImgInstance=function(t,r,n){if(Dw.hasOwnProperty(n)){var i=Dw[n];return i.count++,i.value}var o=new e(t,r,0,0);return Dw[n]={value:o,count:1},o},e}();function Bw(e){switch(e){case js.MULTIPLY:return"multiply";case js.SCREEN:return"screen";case js.OVERLAY:return"overlay";case js.DARKEN:return"darken";case js.LIGHTEN:return"lighten";case js.COLOR_DODGE:return"color-dodge";case js.COLOR_BURN:return"color-burn";case js.HARD_LIGHT:return"hard-light";case js.SOFT_LIGHT:return"soft-light";case js.DIFFERENCE:return"difference";case js.EXCLUSION:return"exclusion";case js.HUE:return"hue";case js.SATURATION:return"saturation";case js.COLOR:return"color";case js.LUMINOSITY:return"luminosity";default:return"source-over"}}var Uw=function(e){function t(t){var r=e.call(this,t)||this;r.isBitmap=!0,r.onlyImg=!0;var n=r._src=t.src||"";if(r.loader={error:!1,loading:!1,url:n,width:0,height:0},r.loaders=[],n){var i=fl.IMG[n];i&&i.state===fl.LOADED&&(i.success?(r.loader.source=i.source,r.loader.width=i.source.width,r.loader.height=i.source.height):r.loader.error=!0)}else r.loader.error=!0;return r}return v(t,e),t.prototype.loadAndRefresh=function(){var e=this,t=this.loader;if(!t.loading||t.url!==this._src){var r=t.error,n=t.source;if(t.source=void 0,t.error=!1,!this.isDestroyed){var i=this.root,o=fl.IMG[this._src];if(o&&o.state===fl.LOADED)return o.success&&o.source?(t.source=o.source,t.width=o.width,t.height=o.height):t.error=!0,void this.root.addUpdate(this,[],Nx.REPAINT,!1,!1,void 0);t.loading||i.imgLoadingCount++,(r||n)&&i.addUpdate(this,[],Nx.REPAINT,!1,!1,void 0),t.loading=!0,fl.loadImg(this._src,(function(r){r.url===e._src&&(i.imgLoadingCount--,t.loading=!1,r.success?(t.error=!1,t.source=r.source,t.width=r.width,t.height=r.height,e.isDestroyed||e.root.addUpdate(e,[],Nx.REPAINT,!1,!1,void 0)):(t.error=!0,e.isDestroyed||e.root.addUpdate(e,[],Nx.NONE,!1,!1,void 0)))}))}}},t.prototype.checkLoader=function(){var e=this.loader;return!(e.loading||e.source||e.error)},t.prototype.calContent=function(){var e=this.computedStyle,t=e.fill,r=e.fillOpacity,n=e.fillEnable,i=e.stroke,o=e.strokeEnable,a=e.strokeWidth,s=e.innerShadow,l=e.innerShadowEnable;this.onlyImg=!0;for(var c=0,u=t.length;c<u;c++)if(n[c]&&r[c]){this.onlyImg=!1;break}if(this.onlyImg)for(c=0,u=i.length;c<u;c++)if(o[c]&&a[c]){this.onlyImg=!1;break}if(this.onlyImg)for(c=0,u=s.length;c<u;c++)if(l[c]){this.onlyImg=!1;break}return this.hasContent=!!this.loader.source},t.prototype.renderCanvas=function(t){var r,n,i=this,o=this.loader,a=this.computedStyle;if(this.onlyImg){null===(r=this.canvasCache)||void 0===r||r.releaseImg(this._src);var s=o.width,l=o.height;if((p=this.canvasCache=Nw.getImgInstance(s,l,this._src)).available=!0,1===p.getCount(this._src))for(var c=0,u=(D=p.list).length;c<u;c++){var h=D[c],d=h.x,f=h.y;h.os.ctx.drawImage(o.source,-d,-f)}}else{e.prototype.renderCanvas.call(this,t);var p,v=this._bbox2||this.bbox2,m=(d=v[0],f=v[1],s=v[2]-d,l=v[3]-f,this._rect||this.rect),g=m[2]-m[0],y=m[3]-m[1],b=-d*t,x=-f*t;s*=t,l*=t,(p=this.canvasCache=Nw.getInstance(s,l,b,x)).available=!0;var w=a.fill,E=a.fillOpacity,_=a.fillEnable,S=a.fillMode,C=a.stroke,T=a.strokeEnable,A=a.strokeWidth,k=a.strokePosition,M=a.strokeMode,O=a.strokeDasharray,L=a.strokeLinecap,R=a.strokeLinejoin,I=a.strokeMiterlimit,P=a.innerShadow,F=a.innerShadowEnable,D=p.list,N=function(e,r){var a=D[e],c=a.x,u=a.y,h=a.os,d=h.ctx,f=h.canvas,p=-c,v=-u;d.drawImage(o.source,p,v,g*t,y*t),1!==t?d.setLineDash(O.map((function(e){return e*t}))):d.setLineDash(O);var m=[[0,0],[g,0],[g,y],[0,y],[0,0]];d.beginPath(),Wx(d,m,t,p,v),d.closePath();for(var N=function(e,r){if(!_[e]||!E[e])return"continue";var o=void 0,a=w[e],c=void 0,u=S[e];if(u!==js.NORMAL&&(c=fl.getOffscreenCanvas(s,l)),d.globalAlpha=E[e],Array.isArray(a)){if(!a[3])return"continue";d.fillStyle=qu(a)}else{if(a.url){var h=a.url;if(h){var C=B.loaders[e],T=fl.IMG[h];!C&&T&&(C=B.loaders[e]={error:!1,loading:!1,url:h,width:T.width,height:T.height,source:T.source});var A=fl.IMG[h];if(C){if(!C.error&&!C.loading){var k=c||fl.getOffscreenCanvas(s,l),M=k.ctx;if(a.type===rl.TILE)for(var O=null!==(n=a.scale)&&void 0!==n?n:1,L=0,R=Math.ceil(g/O/C.width);L<R;L++)for(var I=0,P=Math.ceil(y/O/C.height);I<P;I++)M.drawImage(A.source,p+L*A.width*t*O,v+I*A.height*t*O,A.width*t*O,A.height*t*O);else if(a.type===rl.FILL){var F=g*t/A.width,D=y*t/A.height,N=Math.max(F,D),U=-.5*(A.width*N-g*t),z=-.5*(A.height*N-y*t);M.drawImage(A.source,0,0,A.width,A.height,U+p,z+v,A.width*N,A.height*N)}else if(a.type===rl.STRETCH)M.drawImage(A.source,p,v,g*t,y*t);else if(a.type===rl.FIT){F=g*t/A.width,D=y*t/A.height,N=Math.min(F,D);var X=-.5*(A.width*N-g*t),H=-.5*(A.height*N-y*t);M.drawImage(A.source,0,0,A.width,A.height,X+p,H+v,A.width*N,A.height*N)}M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),u!==js.NORMAL&&(d.globalCompositeOperation=Bw(u)),d.drawImage(k.canvas,0,0),u!==js.NORMAL&&(d.globalCompositeOperation="source-atop"),k.release()}}else C=B.loaders[e]=B.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},fl.loadImg(h,(function(t){var r;h===(null===(r=w[e])||void 0===r?void 0:r.url)&&(C.loading=!1,t.success?(C.error=!1,C.source=t.source,C.width=t.width,C.height=t.height,i.isDestroyed||i.root.addUpdate(i,[],Nx.REPAINT,!1,!1,void 0)):C.error=!0)}))}return"continue"}if(a.t===Ws.LINEAR){var G=Nu(a.stops,a.d,p,v,s-2*b,l-2*x),j=d.createLinearGradient(G.x1,G.y1,G.x2,G.y2);G.stop.forEach((function(e){j.addColorStop(e.offset,qu(e.color))})),d.fillStyle=j}else if(a.t===Ws.RADIAL){G=Bu(a.stops,a.d,p,v,s-2*b,l-2*x);var Y=d.createRadialGradient(G.cx,G.cy,0,G.cx,G.cy,G.total);G.stop.forEach((function(e){Y.addColorStop(e.offset,qu(e.color))}));var W=G.matrix;if(W)(M=(o=fl.getOffscreenCanvas(s,l)).ctx).beginPath(),Wx(M,m,t,p,v),M.closePath(),M.clip(),M.fillStyle=Y,M.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]),M.fill();else d.fillStyle=Y}else if(a.t===Ws.CONIC){G=Uu(a.stops,a.d,p,v,s-2*b,l-2*x);var q=d.createConicGradient(G.angle,G.cx+p,G.cy+v);G.stop.forEach((function(e){q.addColorStop(e.offset,qu(e.color))})),d.fillStyle=q}}if(o){if(c)(M=c.ctx).drawImage(o.canvas,0,0),M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),d.globalCompositeOperation=Bw(u),d.drawImage(c.canvas,0,0),c.release();else d.globalCompositeOperation="source-atop",d.drawImage(o.canvas,0,0);o.release()}else{if(c)(M=c.ctx).fillStyle=d.fillStyle,M.beginPath(),Wx(M,m,t,p,v),M.closePath(),M.fill(),M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),d.globalCompositeOperation=Bw(u),d.drawImage(c.canvas,0,0),c.release();else d.globalCompositeOperation="source-atop",d.fill()}},U=0,z=w.length;U<z;U++)N(U);if(d.globalAlpha=1,d.globalCompositeOperation="source-atop",P&&P.length){var X=0;P.forEach((function(e,t){if(F[t]){var r=Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread;X=Math.max(X,r+e.blur)}})),d.save(),d.beginPath(),Wx(d,m,t,p,p),d.closePath(),d.clip(),d.fillStyle="#FFF",d.beginPath(),Wx(d,m,t,p,p),Wx(d,[[-X,-X],[s+X,-X],[s+X,l+X],[-X,l+X],[-X,-X]],1,p,p),d.closePath(),P.forEach((function(e,t){F[t]&&(d.shadowOffsetX=e.x,d.shadowOffsetY=e.y,d.shadowColor=qu(e.color),d.shadowBlur=e.blur,d.fill("evenodd"))})),d.restore()}L===$s.ROUND?d.lineCap="round":L===$s.SQUARE?d.lineCap="square":d.lineCap="butt",R===el.ROUND?d.lineJoin="round":R===el.BEVEL?d.lineJoin="bevel":d.lineJoin="miter",d.miterLimit=I*t;for(var H=function(e,r){if(!T[e]||!A[e])return"continue";var n=C[e],i=k[e];if(d.globalCompositeOperation=Bw(M[e]),Array.isArray(n))d.strokeStyle=qu(n);else if(n.t===Ws.LINEAR){var o=Nu(n.stops,n.d,p,v,s-2*b,l-2*x),a=d.createLinearGradient(o.x1,o.y1,o.x2,o.y2);o.stop.forEach((function(e){a.addColorStop(e.offset,qu(e.color))})),d.strokeStyle=a}else if(n.t===Ws.RADIAL){o=Bu(n.stops,n.d,p,v,s-2*b,l-2*x);var c=d.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.total);o.stop.forEach((function(e){c.addColorStop(e.offset,qu(e.color))}));var u=o.matrix;if(u){var h=fl.getOffscreenCanvas(s,l),f=h.ctx;return f.setLineDash(d.getLineDash()),f.lineCap=d.lineCap,f.lineJoin=d.lineJoin,f.miterLimit=d.miterLimit*t,f.lineWidth=A[e]*t,f.strokeStyle="#FFF",f.beginPath(),Wx(f,m,t,p,v),f.closePath(),i===tl.INSIDE?(f.lineWidth=2*A[e]*t,f.save(),f.clip(),f.stroke(),f.restore()):i===tl.OUTSIDE?(f.lineWidth=2*A[e]*t,f.stroke(),f.save(),f.clip(),f.globalCompositeOperation="destination-out",f.strokeStyle="#FFF",f.stroke(),f.restore()):f.stroke(),f.fillStyle=c,f.globalCompositeOperation="source-in",f.setTransform(u[0],u[1],u[4],u[5],u[12],u[13]),f.fillRect(0,0,s,l),d.drawImage(h.canvas,0,0),h.release(),"continue"}d.strokeStyle=c}else if(n.t===Ws.CONIC){o=Uu(n.stops,n.d,p,v,s-2*b,l-2*x);var g=d.createConicGradient(o.angle,o.cx+p,o.cy+v);o.stop.forEach((function(e){g.addColorStop(e.offset,qu(e.color))})),d.strokeStyle=g}var y=void 0,w=void 0;i===tl.INSIDE?d.lineWidth=2*A[e]*t:i===tl.OUTSIDE?((w=(y=fl.getOffscreenCanvas(s,l)).ctx).setLineDash(d.getLineDash()),w.lineCap=d.lineCap,w.lineJoin=d.lineJoin,w.miterLimit=d.miterLimit*t,w.strokeStyle=d.strokeStyle,w.lineWidth=2*A[e]*t,w.beginPath(),Wx(w,m,t,p,v)):d.lineWidth=A[e]*t,w&&w.closePath(),i===tl.INSIDE?(d.save(),d.clip(),d.stroke(),d.restore()):i===tl.OUTSIDE?(w.stroke(),w.save(),w.clip(),w.globalCompositeOperation="destination-out",w.strokeStyle="#FFF",w.stroke(),w.restore(),d.drawImage(y.canvas,p-b,v-x),y.release()):d.stroke()},G=0,j=C.length;G<j;G++)H(G);d.globalCompositeOperation="source-over"},B=this;for(c=0,u=D.length;c<u;c++)N(c)}},t.prototype.genTexture=function(t,r,n){if(this.loader.source)if(this.onlyImg){var i=this.textureCache[0];if(i&&i.available)return void(this.textureCache[n]=this.textureTarget[n]=i);var o=this.root.props.uuid,a=(this._rect||this.rect).slice(0);if(a[0]=Math.floor(a[0]),a[1]=Math.floor(a[1]),a[2]=Math.ceil(a[2]),a[3]=Math.ceil(a[3]),Rw.hasImgInstance(o,this._src))return void(this.textureCache[n]=this.textureTarget[n]=this.textureCache[0]=Rw.getImgInstance(o,t,this._src,a));this.renderCanvas(r);var s=this.canvasCache;(null==s?void 0:s.available)&&(this.textureCache[n]=this.textureTarget[n]=this.textureCache[0]=Rw.getImgInstance(o,t,this._src,a,s),s.releaseImg(this._src))}else e.prototype.genTexture.call(this,t,r,n)},t.prototype.clearCache=function(t){var r=this;void 0===t&&(t=!1),this.onlyImg?(t&&this.textureCache.forEach((function(e){return null==e?void 0:e.releaseImg(r.root.props.uuid,r._src)})),this.textureTarget.splice(0),this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()}))):e.prototype.clearCache.call(this,t)},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid,r.src=this._src;var n=new t(r);return n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.BITMAP,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r,n,i,o,a;return Q(this,(function(l){switch(l.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=l.sent())._class=ee.ClassValue.Bitmap,r.image={_class:"MSJSONFileReference",_ref_class:"MSImageData",_ref:""},r.fillReplacesImage=!1,(n=t.folder("images"))?[4,fetch(this._src)]:[3,3];case 2:i=l.sent(),o=i.blob(),a=this.props.md5||this.props.uuid||s(),n.file(a,o),r.image._ref="images/"+a,l.label=3;case 3:return[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this);var r=this.loader;r.loading&&t&&(t.imgLoadingCount--,r.loading=!1)}},Object.defineProperty(t.prototype,"src",{get:function(){return this._src},set:function(e){this._src!==e&&(this.clearCache(!0),this._src=e,this.loadAndRefresh())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===tl.OUTSIDE?a=Math.max(a,e):o[t]===tl.CENTER&&(a=Math.max(a,.5*e)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),t}(Iw);function zw(e,t,r,n,i){var o=e.slice(0);if(n===el.ROUND)return o[0]-=t,o[1]-=t,o[2]+=t,o[3]+=t,o;if(!r.length)return o;for(var a=[],s=[],l=r[0],c=l[0],u=l[1],h=1,d=r.length;h<d;h++){var f=0,p=0;2===(y=r[h]).length?(f=y[0]-c,p=y[1]-u,c=y[0],u=y[1],a.push([f,p])):4===y.length?(f=2*(c-2*y[0]+y[2])+2*y[0]-2*c,p=2*(u-2*y[1]+y[3])+2*y[1]-2*u,c=y[2],u=y[3],a.push([f,p])):6===y.length&&(f=3*(-c+3*y[0]-3*y[2]+y[4])+2*(3*c-6*y[0]+3*y[2])+3*y[0]-3*c,p=3*(-u+3*y[1]-3*y[3]+y[5])+2*(3*u-6*y[1]+3*y[3])+3*y[1]-3*u,c=y[4],u=y[5],a.push([f,p]));var v=Math.atan(Math.abs(p/f)),m=Math.sin(v)*t,g=Math.cos(v)*t;f>=0?p>=0?s.push([-m,g]):s.push([m,g]):p>=0?s.push([-m,-g]):s.push([m,-g])}for(h=0,d=a.length;h<d;h++){var y=a[h],b=a[(h+1)%d];if(y[0]&&y[1]&&b[0]&&b[1]){var x=ql(y[0],y[1],b[0],b[1]),w=s[h],E=s[(h+1)%d];if(w[0]||w[1]||E[0]||E[1]){var _=0,S=0,C=0,T=0,A=[y[0]+w[0],y[1]+w[1]],k=ql(y[0],y[1],A[0],A[1]);x>=0&&k>=0||x<0&&k<0?(_=-w[0],S=-w[1]):(_=w[0],S=w[1]);var M=[b[0]+E[0],b[1]+E[1]],O=ql(b[0],b[1],M[0],M[1]);x>=0&&O>=0||x<0&&O<0?(C=-E[0],T=-E[1]):(C=E[0],T=E[1]);var L=r[h],R=r[h+1],I=r[(h+2)%d],P=L.length,F=R.length,D=I.length,N=L[P-2]+_,B=L[P-1]+S,U=R[F-2]+_,z=R[F-1]+S,X=R[F-2]+C,H=R[F-1]+T,G=Tu(N,B,U,z,X,H,I[D-2]+C,I[D-1]+T,!1);if(G&&1!==G.toSource&&0!==G.toClip)if(n===el.BEVEL)if((V=2*t/Math.sqrt(Math.pow(X-U,2)+Math.pow(H-z,2)))>=1)o[0]=Math.min(o[0],U,X),o[1]=Math.min(o[1],z,H),o[2]=Math.max(o[2],U,X),o[3]=Math.max(o[3],z,H);else{var j=G.x-(G.x-U)*V,Y=G.y-(G.y-z)*V,W=G.x-(G.x-X)*V,q=G.y-(G.y-H)*V;o[0]=Math.min(o[0],j,W),o[1]=Math.min(o[1],Y,q),o[2]=Math.max(o[2],j,W),o[3]=Math.max(o[3],Y,q)}else if(n===el.MITER){var V;if((V=Math.sqrt(Math.pow(G.x-R[F-2],2)+Math.pow(G.y-R[F-1],2))/t)>i){var K=2*t/Math.sqrt(Math.pow(X-U,2)+Math.pow(H-z,2));if(K>=1)o[0]=Math.min(o[0],U,X),o[1]=Math.min(o[1],z,H),o[2]=Math.max(o[2],U,X),o[3]=Math.max(o[3],z,H);else{j=G.x-(G.x-U)*K,Y=G.y-(G.y-z)*K,W=G.x-(G.x-X)*K,q=G.y-(G.y-H)*K;o[0]=Math.min(o[0],j,W),o[1]=Math.min(o[1],Y,q),o[2]=Math.max(o[2],j,W),o[3]=Math.max(o[3],Y,q)}}else o[0]=Math.min(o[0],G.x),o[1]=Math.min(o[1],G.y),o[2]=Math.max(o[2],G.x),o[3]=Math.max(o[3],G.y)}}}}return o}function Xw(e,t,r,n,i){if(3===arguments.length){var o=t,a=o[0],s=o[1],l=o[2],c=o[3];if(!oc(r)){var u=gc({x:a,y:s},r),h=gc({x:a,y:c},r),d=gc({x:l,y:s},r),f=gc({x:l,y:c},r);a=Math.min(u.x,h.x,d.x,f.x),s=Math.min(u.y,h.y,d.y,f.y),l=Math.max(u.x,h.x,d.x,f.x),c=Math.max(u.y,h.y,d.y,f.y)}e[0]=Math.min(e[0],a),e[1]=Math.min(e[1],s),e[2]=Math.max(e[2],l),e[3]=Math.max(e[3],c)}else 2===arguments.length?(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3])):5===arguments.length&&(e[0]=Math.min(e[0],t),e[1]=Math.min(e[1],r),e[2]=Math.max(e[2],n),e[3]=Math.max(e[3],i))}function Hw(e,t){var r,n;if(6===e.length)r=e[4],n=e[5];else if(4===e.length)r=e[2],n=e[3];else{if(2!==e.length)return void fl.error("Unsupported point data: "+e.join(","));r=e[0],n=e[1]}return t[0]=r,t[1]=n,t[2]=r,t[3]=n,{x:r,y:n}}function Gw(e,t,r,n){var i,o;if(4===e.length)i=e[2],o=e[3],Xw(n,(a=mu.bboxBezier(t,r,e[0],e[1],i,o))[0],a[1],a[2],a[3]);else if(6===e.length){var a;i=e[4],o=e[5],Xw(n,(a=mu.bboxBezier(t,r,e[0],e[1],e[2],e[3],i,o))[0],a[1],a[2],a[3])}else{if(2!==e.length)return void fl.error("Unsupported point data: "+e.join(","));Xw(n,i=e[0],o=e[1],i,o)}return{x:i,y:o}}var jw=function(e){function t(t){var r=e.call(this,t)||this;return r.isGeom=!0,r.loaders=[],r}return v(t,e),t.prototype.lay=function(t){e.prototype.lay.call(this,t),this.coords=void 0},t.prototype.calRepaintStyle=function(t){e.prototype.calRepaintStyle.call(this,t),this.coords=void 0,this._rect=void 0,this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0},t.prototype.buildPoints=function(){this.coords||(this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this.coords=[])},t.prototype.calContent=function(){return this.buildPoints(),this.hasContent=!!this.coords&&this.coords.length>1},t.prototype.isLine=function(){this.buildPoints();var e=this.coords;return!!e&&2===e.length&&2===e[0].length&&2===e[1].length},t.prototype.checkShapeChange=function(){for(var e=this.parent;e&&e.isShapeGroup;)e.clearPoints(),e=e.parent},t.prototype.refresh=function(t,r){void 0===t&&(t=Nx.REPAINT),t>=Nx.REPAINT&&(this.coords=void 0),e.prototype.refresh.call(this,t,r)},t.prototype.toSvg=function(e,t){void 0===t&&(t=!1),this.buildPoints();var r=this.computedStyle,n=this.coords||[],i=new Float64Array(this.matrixWorld),o=[],a=0,s=0,l=0,c=0,u=!0;n.forEach((function(e,t){if(6===e.length){var r=gc({x:e[0],y:e[1]},i),n=gc({x:e[2],y:e[3]},i),h=gc({x:e[4],y:e[5]},i);o.push([r.x,r.y,n.x,n.y,h.x,h.y]),u?(u=!1,a=Math.min(r.x,n.x,h.x),s=Math.min(r.y,n.y,h.y),l=Math.max(r.x,n.x,h.x),c=Math.max(r.y,n.y,h.y)):(a=Math.min(a,r.x,n.x,h.x),s=Math.min(s,r.y,n.y,h.y),l=Math.max(l,r.x,n.x,h.x),c=Math.max(c,r.y,n.y,h.y))}else if(4===e.length){r=gc({x:e[0],y:e[1]},i),n=gc({x:e[2],y:e[3]},i);o.push([r.x,r.y,n.x,n.y]),u?(u=!1,a=Math.min(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.x,n.x),c=Math.max(r.y,n.y)):(a=Math.min(a,r.x,n.x),s=Math.min(s,r.y,n.y),l=Math.max(l,r.x,n.x),c=Math.max(c,r.y,n.y))}else if(2===e.length){var d=gc({x:e[0],y:e[1]},i);o.push([d.x,d.y]),u?(u=!1,a=d.x,s=d.y,l=d.x,c=d.y):(a=Math.min(a,d.x),s=Math.min(s,d.y),l=Math.max(l,d.x),c=Math.max(c,d.y))}}));var h=l-a||1,d=c-s||1,f=1;f=h>=d?e/h:e/d;var p=qx(o.map((function(e){return e.map((function(e){return e*f}))})),-a*f,-s*f);p&&t&&(p+="Z");var v=[["d",p],["fill","#D8D8D8"],["fill-rule",r.fillRule===Js.EVEN_ODD?"evenodd":"nonzero"],["stroke","#979797"],["stroke-width",1]],m='<svg width="'.concat(h*f,'" height="').concat(d*f,'"><path');return v.forEach((function(e){m+=" "+e[0]+'="'+e[1]+'"'})),m+"></path></svg>"},Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;if(!e){e=this._rect=new Float64Array(4),this.buildPoints();var t=this.coords;t&&t.length&&function(e,t){var r=!0;t=t||new Float64Array(4);for(var n=0,i=0,o=0,a=e.length;o<a;o++){var s=e[o];if(r){if(!(l=Hw(s,t))){fl.error("Unsupported point data: "+o+" - "+s.join(","));continue}n=l.x,i=l.y,r=!1}else{var l;if(!(l=Gw(s,n,i,t))){fl.error("Unsupported point data: "+o+" - "+s.join(","));continue}n=l.x,i=l.y}}}(t,e)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.buildPoints();var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=r.strokeLinecap,s=r.strokeLinejoin,l=r.strokeMiterlimit,c=this.props.isClosed,u=0;n.forEach((function(e,t){i[t]&&(o[t]===tl.OUTSIDE&&c?u=Math.max(u,e):o[t]!==tl.CENTER&&c||(u=Math.max(u,.5*e)))}));var h=e[0]-u,d=e[1]-u,f=e[2]+u,p=e[3]+u;e=this._bbox=c?zw(e,u,this.coords||[],s,l):function(e,t,r,n){var i=e.slice(0);if(n===$s.ROUND&&(i[0]-=t,i[1]-=t,i[2]+=t,i[3]+=t),!r.length)return i;for(var o=r[0],a=r[r.length-1],s=a.length,l=[],c=0;c<s;c+=2)l.push({x:a[c],y:a[c+1]});var u=0,h=0;s>2?(u=Math.abs(nu(l,0)),h=Math.abs(nu(l,1))):u=h=Math.abs(a[s-1]-o[1])/Math.abs(a[s-2]-o[0]);var d=Math.atan(u),f=Math.atan(h),p=Math.sin(d),v=Math.cos(d),m=Math.sin(f),g=Math.cos(f),y=p===1/0?t:Math.abs(p*t),b=v===1/0?t:Math.abs(v*t),x=m===1/0?t:Math.abs(m*t),w=g===1/0?t:Math.abs(g*t);return n===$s.BUTT?(i[0]=Math.min(i[0],o[0]-y,a[s-2]-x),i[1]=Math.min(i[1],o[1]-b,a[s-1]-w),i[2]=Math.max(i[2],o[0]+y,a[s-2]+x),i[3]=Math.max(i[3],o[1]+b,a[s-1]+w)):n===$s.SQUARE&&(i[0]=Math.min(i[0],o[0]-y-b,a[s-2]-x-w),i[1]=Math.min(i[1],o[1]-y-b,a[s-1]-x-w),i[2]=Math.max(i[2],o[0]+y+b,a[s-2]+x+w),i[3]=Math.max(i[3],o[1]+y+b,a[s-1]+x+w)),i}(e,u,this.coords||[],a),e[0]=Math.min(e[0],h),e[1]=Math.min(e[1],d),e[2]=Math.max(e[2],f),e[3]=Math.max(e[3],p)}return e},enumerable:!1,configurable:!0}),t}(Iw);function Yw(e){return e.curveMode===Ks.STRAIGHT&&e.cornerRadius>0}function Ww(e,t,r,n,i,o){var a=Cc(e.absX,e.absY,t.absX,t.absY),s=Cc(t.absX,t.absY,r.absX,r.absY),l=Tc(Cc(e.absX,e.absY,r.absX,r.absY),a,s),c=Math.tan(.5*l),u=o/c,h=Math.min(n?.5*a:a,i?.5*s:s);u>h&&(o=(u=h)*c);var d=Ql(e.absX-t.absX,e.absY-t.absY),f=Ql(r.absX-t.absX,r.absY-t.absY),p={x:d.x*u,y:d.y*u};p.x+=t.absX,p.y+=t.absY;var v={x:f.x*u,y:f.y*u};v.x+=t.absX,v.y+=t.absY;var m=4/3*Math.tan((Math.PI-l)/4),g={x:d.x*-o*m,y:d.y*-o*m};g.x+=p.x,g.y+=p.y;var y={x:f.x*-o*m,y:f.y*-o*m};return y.x+=v.x,y.y+=v.y,{prevTangent:p,prevHandle:g,nextTangent:v,nextHandle:y}}function qw(e,t,r,n,i,o){var a,s,l,c;if(n){var u=Math.sqrt(Math.pow(t.absX-e.absX,2)+Math.pow(t.absY-e.absY,2));o=Math.min(o,.5*u)}if(i){u=Math.sqrt(Math.pow(t.absX-r.absX,2)+Math.pow(t.absY-r.absY,2));o=Math.min(o,.5*u)}var h=e.absFx-t.absX,d=e.absFy-t.absY,f=r.absTx-t.absX,p=r.absTy-t.absY,v=e.absX-t.absX,m=e.absY-t.absY,g=r.absX-t.absX,y=r.absY-t.absY,b=ql(h,d,f,p),x=ql(v,m,g,y),w=ql(h,d,v,m),E=ql(f,p,g,y);if(!(Math.abs(b)<1e-6)){var _=[{x:e.absX,y:e.absY},{x:null!==(a=e.absFx)&&void 0!==a?a:e.absX,y:null!==(s=e.absFy)&&void 0!==s?s:e.absY},{x:t.absX,y:t.absY}],S=[{x:t.absX,y:t.absY},{x:null!==(l=r.absTx)&&void 0!==l?l:r.absX,y:null!==(c=r.absTy)&&void 0!==c?c:r.absY},{x:r.absX,y:r.absY}],C=Ou.intersectBezier2Bezier2(_[0].x,_[0].y,_[1].x,_[1].y,_[2].x,_[2].y,S[0].x,S[0].y,S[1].x,S[1].y,S[2].x,S[2].y).filter((function(e){return e.x!==S[0].x&&e.y!==S[0].y})).sort((function(e,t){return e.t1===t.t1?t.t2-e.t2:t.t1-e.t1})),T=C.length;if(!T)return Vw(_,S,t,T,!1,b,x,w,E,o,0,1,0,1);var A=C.map((function(e){return e.t1})),k=C.map((function(e){return ru(S,e.x,e.y)[0]}));if(!k.find((function(e){return void 0===e}))){var M=!1;A.unshift(1),A.push(0),k.unshift(0),k.push(1);for(var O=0;O<=T;O++){var L=Vw(_,S,t,T,M,b,x,w,E,o,A[O+1],A[O],k[O],k[O+1]);if(L)return L;M=!M}}}}function Vw(e,t,r,n,i,o,a,s,l,c,u,h,d,f){var p=Zw(e,n,i,o,a,s,c,!0,u,h),v=Zw(t,n,i,o,a,l,c,!1,d,f);if(!(!p||p.length<2||!v||v.length<2)){var m=function(e,t){var r=$w(e,0),n=$w(t,1),i=function(e){var t={};e.forEach((function(e){var r,n=e.x1,i=e.x2;n>i&&(n=(r=[i,n])[0],i=r[1]),Jw(t,n,e),Jw(t,i,e)}));var r=[];return Object.keys(t).forEach((function(e){return r.push({x:parseFloat(e),arr:t[e]})})),r.sort((function(e,t){return e.x-t.x}))}(r.concat(n)),o=[],a=[],s=[];for(;i.length;){a.length&&a.splice(0).forEach((function(e){var t=o.indexOf(e);o.splice(t,1)}));for(var l=i.shift().arr;l.length;){var c=l.shift();if(!c.isDeleted){var u=c.belong,h=c.bbox;if(c.isVisited)a.push(c);else{if(o.length)for(var d=c.x1,f=c.y1,p=c.x2,v=c.y2,m=c.bbox,g=0;g<o.length;g++){var y=o[g];if(!y.isDeleted&&!c.isDeleted&&y.belong!==u){var b=y.x1,x=y.y1,w=y.x2,E=y.y2;if(Ac(h[0],h[1],h[2],h[3],m[0],m[1],m[2],m[3],!0)){var _=(E-x)*(p-d)-(w-b)*(v-f);if(0!==_){var S=((w-b)*(f-x)-(E-x)*(d-b))/_,C=((p-d)*(f-x)-(v-f)*(d-b))/_;if(S>=0&&S<=1&&C>=0&&C<=1){var T=d+S*(p-d),A=f+S*(v-f);s.push({x:T,y:A,t1:0===u?c.t:y.t,t2:0===u?y.t:c.t}),c.isDeleted=!0;break}}}}}c.isDeleted||(o.push(c),c.isVisited=!0)}}}}return s}(p,v);if(m.length){var g=m[0];if(m.length>1)for(var y=Math.pow(r.absX-g.x,2)+Math.pow(r.absY-g.y,2),b=1,x=m.length;b<x;b++){var w=m[b],E=Math.pow(r.absX-w.x,2)+Math.pow(r.absY-w.y,2);E<y&&(g=w,y=E)}var _=$c(e,g.t1),S=$c(t,g.t2),C=nu(e,g.t1),T=nu(t,g.t2),A=_.y-C*_.x,k=(S.y-T*S.x-A)/(C-T),M=C*k+A;Math.abs(C)<1e-9?(M=_.y,T!==1/0&&T!==-1/0||(k=S.x)):Math.abs(T)<1e-9?(M=S.y,C!==1/0&&C!==-1/0||(k=_.x)):C===1/0||C===-1/0?(k=_.x,M=S.y):T!==1/0&&T!==-1/0||(k=S.x,M=_.y);var O=Cc(_.x,_.y,k,M),L=Cc(k,M,S.x,S.y),R=Tc(Cc(_.x,_.y,S.x,S.y),O,L),I=4/3*Math.tan((Math.PI-R)/4),P=Ql(_.x-k,_.y-M),F=Ql(S.x-k,S.y-M),D={x:P.x*-c*I,y:P.y*-c*I};D.x+=_.x,D.y+=_.y;var N={x:F.x*-c*I,y:F.y*-c*I};return N.x+=S.x,N.y+=S.y,{prevTangent:_,prevHandle:D,nextTangent:S,nextHandle:N,t1:g.t1,t2:g.t2}}}}var Kw={11010:1,11e3:1,11110:1,11100:1,11001:1,11111:1,11012:1,11002:1,11112:1,11102:1,11013:1,11103:1,10010:0,10100:0,10011:0,10001:0,10111:0,10101:0,"00010":0,"00000":0,"00110":0,"00100":0,"00011":0,"00101":0,"00002":0,"00012":0,"00102":0,"00112":0,"00003":0,"00103":0,"01000":1,"01110":1,"01001":1,"01011":1,"01101":1,"01111":1};function Zw(e,t,r,n,i,o,a,s,l,c){var u=(i>=0?"0":"1")+(n>=0?"0":"1")+(s?"0":"1")+(o>=0?"0":"1")+t;if(Kw.hasOwnProperty(u)){for(var h=Math.ceil(Kc(e)),d=[],f=function(t){var n=t/h;if(n<=l||n>c)return"continue";var i,o=2*(e[0].x-2*e[1].x+e[2].x)*n+2*e[1].x-2*e[0].x,s=2*(e[0].y-2*e[1].y+e[2].y)*n+2*e[1].y-2*e[0].y,f=$c(e,n),p=nu(e,n),v=0;v=Math.abs(p)<1e-12?1/0:p===1/0||p===-1/0?0:-1/p,i=v===1/0?f.y:f.y-v*f.x;var m=void 0,g=void 0;v===1/0?(m=[f.x,f.x],g=[f.y-a,f.y+a]):g=(m=Uc([Math.pow(f.x,2)+Math.pow(i,2)-2*f.y*i+Math.pow(f.y,2)-Math.pow(a,2),2*(i*v-f.x-f.y*v),Math.pow(v,2)+1])).map((function(e){return v*e+i}));var y=ql(m[0]-f.x,g[0]-f.y,o,s)>=0?0:1;r&&(y=(y+1)%2),Kw[u]===y?d.push({x:m[0],y:g[0],t:n}):d.push({x:m[1],y:g[1],t:n})},p=0;p<=h;p++)f(p);return d}}function Jw(e,t,r){var n=e[t]=e[t]||[];r.isVisited?(n.unshift(r),r.isVisited=!1):(n.push(r),r.isVisited=!0)}var Qw=0;function $w(e,t){for(var r,n,i=[],o=1,a=e.length;o<a;o++){var s=e[o-1],l=s.x,c=s.y,u=s.t,h=e[o],d=h.x,f=h.y,p=h.t;(d<l||l===d&&f<c)&&(l=(r=[d,l])[0],d=r[1],c=(n=[f,c])[0],f=n[1]);var v=[l,Math.min(c,f),d,Math.max(c,f)];i.push({id:Qw++,x1:l,y1:c,x2:d,y2:f,bbox:v,belong:t,isVisited:!1,isDeleted:!1,t:.5*(u+p)})}return i}var eE=1e-4,tE=function(e){function t(t){var r=e.call(this,t)||this;return r.props=t,r.isPolyline=!0,r}return v(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this),this.checkPointsChange(!0)},t.prototype.buildPoints=function(){if(!this.coords){this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this.coords=[];var e=this.width,t=this.height,r=this.props.points;if(r.length){for(var n=!1,i=0,o=r.length;i<o;i++){(L=r[i]).absX=(L.x||0)*e,L.absY=(L.y||0)*t,L.absTx=L.tx*e,L.absTy=L.ty*t,L.absFx=L.fx*e,L.absFy=L.fy*t,Yw(L)&&(n=!0)}var a=[];if(n){i=0;for(var s=r.length;i<s;i++){var l=r[i];if(Yw(l)){var c=(i+1)%s,u=r[i?i-1:s-1],h=r[c],d=l.cornerRadius,f=Yw(u),p=f||u.curveMode===Ks.STRAIGHT||!u.hasCurveFrom,v=Yw(h),m=v||h.curveMode===Ks.STRAIGHT||!h.hasCurveTo;a[i]=p&&m?Ww(u,l,h,f,v,d):qw(u,l,h,f,v,d)}}}for(var g=Ps(r),y=(i=0,g.length);i<y;i++){var b=a[i];if(b){var x=b.prevTangent,w=b.prevHandle,E=b.nextTangent,_=b.nextHandle,S={x:0,y:0,cornerRadius:0,cornerStyle:0,curveMode:0,hasCurveFrom:!0,fx:0,fy:0,hasCurveTo:!1,tx:0,ty:0,absX:x.x,absY:x.y,absFx:w.x,absFy:w.y,absTx:0,absTy:0},C={x:0,y:0,cornerRadius:0,cornerStyle:0,curveMode:0,hasCurveFrom:!1,fx:0,fy:0,hasCurveTo:!0,tx:0,ty:0,absX:E.x,absY:E.y,absFx:0,absFy:0,absTx:_.x,absTy:_.y};if(b.t1){var T=Qc([{x:(R=g[(i+y-1)%y]).absX,y:R.absY},{x:R.absFx,y:R.absFy},{x:g[i].absX,y:g[i].absY}],0,b.t1);R.absFx=T[1].x,R.absFy=T[1].y}if(b.t2){var A=g[(i+1)%y];T=Qc([{x:A.absX,y:A.absY},{x:A.absTx,y:A.absTy},{x:g[i].absX,y:g[i].absY}],0,1-b.t2);A.absTx=T[1].x,A.absTy=T[1].y}g.splice(i,1,S,C),i++,y++,a.splice(i,0,void 0)}}var k=g[0],M=[k.absX,k.absY];this.coords.push(M);var O=g.length;for(i=1;i<O;i++){var L=g[i],R=g[i-1],I=[L.absX,L.absY];L.hasCurveTo&&I.unshift(L.absTx,L.absTy),R.hasCurveFrom&&I.unshift(R.absFx,R.absFy),this.coords.push(I)}if(this.props.isClosed){var P=g[O-1],F=[k.absX,k.absY];k.hasCurveTo&&F.unshift(k.absTx,k.absTy),P.hasCurveFrom&&F.unshift(P.absFx,P.absFy),this.coords.push(F)}}}},t.prototype.reflectPoints=function(e){void 0===e&&(e=this.props.points);var t=this.width,r=this.height;(Array.isArray(e)?e:[e]).forEach((function(e){e.x=e.absX/t,e.y=e.absY/r,e.tx=e.absTx/t,e.ty=e.absTy/r,e.fx=e.absFx/t,e.fy=e.absFy/r}))},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t),this.buildPoints();var i=this.coords;if(i&&i.length){var o=this._bbox2||this.bbox2,a=o[0],s=o[1],l=o[2]-a,c=o[3]-s,u=-a*t,h=-s*t;l*=t,c*=t;var d=this.canvasCache=Nw.getInstance(l,c,u,h);d.available=!0;for(var f=this.computedStyle,p=f.fill,v=f.fillOpacity,m=f.fillRule,g=f.fillEnable,y=f.fillMode,b=f.stroke,x=f.strokeEnable,w=f.strokeWidth,E=f.strokePosition,_=f.strokeMode,S=f.strokeDasharray,C=f.strokeLinecap,T=f.strokeLinejoin,A=f.strokeMiterlimit,k=d.list,M=function(e,o){var a=k[e],s=a.x,d=a.y,f=a.os.ctx,M=-s,L=-d;1!==t?f.setLineDash(S.map((function(e){return e*t}))):f.setLineDash(S),f.beginPath(),Wx(f,i,t,M,L),O.props.isClosed&&f.closePath();for(var R=function(e,o){if(!g[e]||!v[e])return"continue";var a=p[e],s=void 0,d=y[e];if(f.globalAlpha=v[e],Array.isArray(a)){if(a[3]<=0)return"continue";f.fillStyle=qu(a)}else{if(void 0!==a.url){var b=a.url;if(b){var x=O.loaders[e],w=fl.IMG[b];if(!x&&w&&w.source&&(x=O.loaders[e]={error:!1,loading:!1,width:w.width,height:w.height,source:w.source}),x)if(x.error||x.loading||!x.source)x.error||x.loading||O.root.imgLoadingCount++;else{var E=O.width,_=O.height,S=E*t,C=_*t,T=fl.getOffscreenCanvas(l,c);if((Y=T.ctx).beginPath(),Wx(Y,i,t,M,L),O.props.isClosed&&Y.closePath(),Y.save(),Y.clip(),a.type===rl.TILE)for(var A=null!==(r=a.scale)&&void 0!==r?r:1,k=0,R=Math.ceil(E/A/x.width);k<R;k++)for(var I=0,P=Math.ceil(_/A/x.height);I<P;I++)Y.drawImage(x.source,M+k*x.width*t*A,L+I*x.height*t*A,x.width*t*A,x.height*t*A);else if(a.type===rl.FILL){var F=S/x.width,D=C/x.height,N=Math.max(F,D),B=-.5*(x.width*N-S),U=-.5*(x.height*N-C);Y.drawImage(x.source,0,0,x.width,x.height,B+M,U+L,x.width*N,x.height*N)}else if(a.type===rl.STRETCH)Y.drawImage(x.source,M,L,S,C);else if(a.type===rl.FIT){F=S/x.width,D=C/x.height,N=Math.min(F,D);var z=-.5*(x.width*N-S),X=-.5*(x.height*N-C);Y.drawImage(x.source,0,0,x.width,x.height,z+M,X+L,x.width*N,x.height*N)}Y.restore(),d!==js.NORMAL&&(f.globalCompositeOperation=Bw(d)),f.drawImage(T.canvas,0,0),d!==js.NORMAL&&(f.globalCompositeOperation="source-over"),T.release()}else O.root.imgLoadingCount++,x=O.loaders[e]=O.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},fl.loadImg(b,(function(t){var r;b===(null===(r=p[e])||void 0===r?void 0:r.url)&&(x.loading=!1,t.success?(x.error=!1,x.source=t.source,x.width=t.width,x.height=t.height,n.isDestroyed||n.root.addUpdate(n,[],Nx.REPAINT,!1,!1,void 0)):x.error=!0,n.root.imgLoadingCount--)}))}return"continue"}if(a.t===Ws.LINEAR){var H=Nu(a.stops,a.d,M,L,l-2*u,c-2*h),G=f.createLinearGradient(H.x1,H.y1,H.x2,H.y2);H.stop.forEach((function(e){G.addColorStop(e.offset,qu(e.color))})),f.fillStyle=G}else if(a.t===Ws.RADIAL){H=Bu(a.stops,a.d,M,L,l-2*u,c-2*h);var j=f.createRadialGradient(H.cx,H.cy,0,H.cx,H.cy,H.total);H.stop.forEach((function(e){j.addColorStop(e.offset,qu(e.color))}));var Y,W=H.matrix;if(W)(Y=(s=fl.getOffscreenCanvas(l,c)).ctx).beginPath(),Wx(Y,i,t,M,L),O.props.isClosed&&Y.closePath(),Y.clip(),Y.fillStyle=j,Y.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]),Y.fill(m===Js.EVEN_ODD?"evenodd":"nonzero");else f.fillStyle=j}else if(a.t===Ws.CONIC){H=Uu(a.stops,a.d,M,L,l-2*u,c-2*h);var q=f.createConicGradient(H.angle,H.cx+M,H.cy+L);H.stop.forEach((function(e){q.addColorStop(e.offset,qu(e.color))})),f.fillStyle=q}}d!==js.NORMAL&&(f.globalCompositeOperation=Bw(d)),s?(f.drawImage(s.canvas,0,0),s.release()):f.fill(m===Js.EVEN_ODD?"evenodd":"nonzero"),d!==js.NORMAL&&(f.globalCompositeOperation="source-over")},I=0,P=p.length;I<P;I++)R(I);f.globalAlpha=1,f.globalCompositeOperation="source-over";var F=O.computedStyle,D=F.innerShadow,N=F.innerShadowEnable;if(D&&D.length){var B=!1,U=0;D.forEach((function(e,r){if(N[r]){B=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread)*t;U=Math.max(U,n+e.blur*t)}})),B&&(f.save(),f.beginPath(),Wx(f,i,t,M,L),O.props.isClosed&&f.closePath(),f.clip(),f.fillStyle="#FFF",f.beginPath(),Wx(f,i,t,M,L),Wx(f,[[-U,-U],[l+U,-U],[l+U,c+U],[-U,c+U],[-U,-U]],1,M,L),f.closePath(),D.forEach((function(e,r){N[r]&&(f.shadowOffsetX=e.x*t,f.shadowOffsetY=e.y*t,f.shadowColor=qu(e.color),f.shadowBlur=e.blur*t,f.fill("evenodd"))})),f.restore(),f.beginPath(),Wx(f,i,t,M,L),O.props.isClosed&&f.closePath())}C===$s.ROUND?f.lineCap="round":C===$s.SQUARE?f.lineCap="square":f.lineCap="butt",T===el.ROUND?f.lineJoin="round":T===el.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=A;for(var z=function(e,r){if(!x[e]||!w[e])return"continue";var n=b[e],o=E[e];if(f.globalCompositeOperation=Bw(_[e]),Array.isArray(n))f.strokeStyle=qu(n);else if(n.t===Ws.LINEAR){var a=Nu(n.stops,n.d,M,L,l-2*M,c-2*L),s=f.createLinearGradient(a.x1,a.y1,a.x2,a.y2);a.stop.forEach((function(e){s.addColorStop(e.offset,qu(e.color))})),f.strokeStyle=s}else if(n.t===Ws.RADIAL){a=Bu(n.stops,n.d,M,L,l-2*M,c-2*L);var d=f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.total);a.stop.forEach((function(e){d.addColorStop(e.offset,qu(e.color))}));var p=a.matrix;if(p){var v=fl.getOffscreenCanvas(l,c),m=v.ctx;return m.setLineDash(f.getLineDash()),m.lineCap=f.lineCap,m.lineJoin=f.lineJoin,m.miterLimit=f.miterLimit,m.lineWidth=w[e]*t,m.strokeStyle="#FFF",m.beginPath(),Wx(m,i,t,M,L),O.props.isClosed&&m.closePath(),o===tl.INSIDE&&O.props.isClosed?(m.lineWidth=2*w[e]*t,m.save(),m.clip(),m.stroke(),m.restore()):o===tl.OUTSIDE&&O.props.isClosed?(m.lineWidth=2*w[e]*t,m.stroke(),m.save(),m.clip(),m.globalCompositeOperation="destination-out",m.strokeStyle="#FFF",m.stroke(),m.restore()):m.stroke(),m.fillStyle=d,m.globalCompositeOperation="source-in",m.setTransform(p[0],p[1],p[4],p[5],p[12],p[13]),m.fillRect(0,0,l,c),f.drawImage(v.canvas,0,0),v.release(),"continue"}f.strokeStyle=d}else if(n.t===Ws.CONIC){a=Uu(n.stops,n.d,M,L,l-2*M,c-2*L);var g=f.createConicGradient(a.angle,a.cx+M,a.cy+L);a.stop.forEach((function(e){g.addColorStop(e.offset,qu(e.color))})),f.strokeStyle=g}var y=void 0,S=void 0;o===tl.INSIDE&&O.props.isClosed?f.lineWidth=2*w[e]*t:o===tl.OUTSIDE&&O.props.isClosed?((S=(y=fl.getOffscreenCanvas(l,c)).ctx).setLineDash(f.getLineDash()),S.lineCap=f.lineCap,S.lineJoin=f.lineJoin,S.miterLimit=f.miterLimit,S.strokeStyle=f.strokeStyle,S.lineWidth=2*w[e]*t,S.beginPath(),Wx(S,i,t,M,L)):f.lineWidth=w[e]*t,O.props.isClosed&&S&&S.closePath(),o===tl.INSIDE&&O.props.isClosed?(f.save(),f.clip(),f.stroke(),f.restore()):o===tl.OUTSIDE&&O.props.isClosed?(S.stroke(),S.save(),S.clip(),S.globalCompositeOperation="destination-out",S.strokeStyle="#FFF",S.stroke(),S.restore(),f.drawImage(y.canvas,M-u,L-h),y.release()):f.stroke()},X=0,H=b.length;X<H;X++)z(X);f.globalCompositeOperation="source-over"},O=this,L=0,R=k.length;L<R;L++)M(L)}},t.prototype.checkPointsChange=function(e){void 0===e&&(e=!1);var t=this._rect||this.rect,r=t[0],n=t[1],i=t[2]-this.width,o=t[3]-this.height;if(!this.isLine()&&(Math.abs(r)>eE||Math.abs(n)>eE||Math.abs(i)>eE||Math.abs(o)>eE)){var a=this.style,s=this.computedStyle,l=s.transformOrigin,c=s.rotateZ;if(c){var u=ic();Lc(u,-c);var h=Ic(u,l[0],l[1]),d=gc({x:0,y:0},h=ac(this.matrix,h)),f=gc({x:this.width,y:this.height},h),p=t[2]-t[0],v=t[3]-t[1],m=a.transformOrigin.map((function(e,t){return rh(e,t?v:p)})),g=m[0],y=m[1],b=ic();(t[0]||t[1])&&dc(b,t[0],t[1]),Lc(b,-c);var x=Ic(b,g,y),w=gc({x:0,y:0},x=ac(this.matrix,x)),E=gc({x:p,y:v},x);this.adjustPosAndSizeSelf(w.x-d.x,w.y-d.y,E.x-f.x,E.y-f.y)}else this.adjustPosAndSizeSelf(r,n,i,o);this.adjustPoints(-r,-n),e||this.checkPosSizeUpward(),this.coords=void 0}},t.prototype.adjustPoints=function(e,t){var r=this.width,n=this.height;this.props.points.forEach((function(i){i.absX+=e,i.absY+=t,i.absFx+=e,i.absFy+=t,i.absTx+=e,i.absTy+=t,i.x=i.absX/r,i.y=i.absY/n,i.fx=i.absFx/r,i.fy=i.absFy/n,i.tx=i.absTx/r,i.ty=i.absTy/n}))},t.prototype.toSvg=function(t){return e.prototype.toSvg.call(this,t,this.props.isClosed)},t.prototype.clone=function(e){var r=Ps(this.props),n=r.uuid;r.uuid=s(),r.sourceUuid=this.props.uuid;var i=new t(r);return i.style=Ps(this.style),i.computedStyle=Ps(this.computedStyle),e&&e.hasOwnProperty(n)&&e[n].forEach((function(e){var t=e.key,n=e.value;if("fill"===t[0]){var o=parseInt(t[1])||0;r.style.fill[o]=n,i.style.fill[o]={v:Wu(n),u:Xs.RGBA}}})),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.POLYLINE,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r;return Q(this,(function(n){switch(n.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=n.sent())._class=ee.ClassValue.ShapePath,r.isClosed=this.props.isClosed,r.points=this.props.points.map((function(e){return{_class:"curvePoint",cornerRadius:e.cornerRadius,cornerStyle:[ee.CornerStyle.Rounded,ee.CornerStyle.RoundedInverted,ee.CornerStyle.Angled,ee.CornerStyle.Squared][e.cornerStyle||0],curveMode:[ee.CurveMode.None,ee.CurveMode.Straight,ee.CurveMode.Mirrored,ee.CurveMode.Asymmetric,ee.CurveMode.Disconnected][e.curveMode||0],hasCurveFrom:e.hasCurveFrom,hasCurveTo:e.hasCurveTo,curveFrom:"{"+e.fx+", "+e.fy+"}",curveTo:"{"+e.tx+", "+e.ty+"}",point:"{"+e.x+", "+e.y+"}"}})),[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this),t&&this.loaders.forEach((function(e){e.loading&&(t.imgLoadingCount--,e.loading=!1)}))}},Object.defineProperty(t,"EPS",{get:function(){return eE},enumerable:!1,configurable:!0}),t}(jw),rE=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.toString=function(){return this.x+","+this.y},e.prototype.equal=function(e){return this===e||this.x===e.x&&this.y===e.y},e.prototype.equalEps=function(e,t){return void 0===t&&(t=.01),this===e||Math.abs(100*this.x-100*e.x)<=100*t&&Math.abs(100*this.y-100*e.y)<=100*t},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.minus=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.compare=function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y},e.toPoint=function(e){return{x:e[0],y:e[1]}},e.toPoints=function(t){return t.map((function(t){return e.toPoint(t)}))},e}(),nE=.1;function iE(e){e.sort((function(e,t){return e.x===t.x?e.y-t.y:e.x-t.x}));for(var t=e.length-1;t>=1;t--){var r=e[t],n=e[t-1];r.x=Math.round(r.x),r.y=Math.round(r.y),n.x=Math.round(n.x),n.y=Math.round(n.y),r.x===n.x&&r.y===n.y&&e.splice(t,1)}return e.filter((function(e){return!!(0!==e.t1&&1!==e.t1||0!==e.t2&&1!==e.t2)})).map((function(e){return{point:new rE(Math.round(e.x),Math.round(e.y)),toSource:e.t1,toClip:e.t2}}))}var oE=function(e,t,r,n,i,o,a,s){var l=Ou.intersectLineLine(e,t,r,n,i,o,a,s,!0);if(l)return[{point:new rE(Math.round(l.x),Math.round(l.y)),toSource:l.toSource,toClip:l.toClip}]},aE=function(e,t,r,n,i,o,a,s,l,c){var u=Ou.intersectBezier2Line(e,t,r,n,i,o,a,s,l,c,nE,1,!0);if(u.length)return iE(u)},sE=function(e,t,r,n,i,o,a,s,l,c,u,h){var d=Ou.intersectBezier2Bezier2(e,t,r,n,i,o,a,s,l,c,u,h,nE,1,!0);if(d.length)return iE(d)},lE=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f){var p=Ou.intersectBezier2Bezier3(e,t,r,n,i,o,a,s,l,c,u,h,d,f,nE,1,!0);if(p.length)return iE(p)},cE=function(e,t,r,n,i,o,a,s,l,c,u,h){var d=Ou.intersectBezier3Line(e,t,r,n,i,o,a,s,l,c,u,h,nE,1,!0);if(d.length)return iE(d)},uE=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v){var m=Ou.intersectBezier3Bezier3(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,nE,1,!0);if(m.length)return iE(m)},hE=function(e,t){return e.sort((function(e,r){return t?e.toSource-r.toSource:e.toClip-r.toClip})).map((function(e){return{point:e.point,t:t?e.toSource:e.toClip}}))},dE=0,fE=function(){function e(e,t){this.uuid=dE++;var r=e[0];if(e.length>2){for(var n=!0,i=!0,o=1,a=e.length;o<a;o++){var s=e[o];if(s.x!==r.x&&(n=!1),s.y!==r.y&&(i=!1),!n&&!i)break}if(n||i)e.splice(1,e.length-2);else{var l=((f=e[e.length-1]).y-r.y)/(f.x-r.x),c=!0;for(o=1;o<e.length-1;o++){var u=e[o],h=(u.y-r.y)/(u.x-r.x);if(isNaN(l)||isNaN(h)){if(l!==h){c=!1;break}}else if(l===1/0||l===-1/0){if(l!==h){c=!1;break}}else if(Math.abs(h-l)>1e-9){c=!1;break}}c&&e.splice(1,e.length-2)}}if(e.length>2&&e[1].x===r.x&&e[1].y===r.y&&e.splice(1,1),e.length>2){var d=e.length,f=e[d-1];e[d-2].x===f.x&&e[d-2].y===f.y&&e.splice(d-2,1)}this.coords=e,this.belong=t,this.bbox=this.calBbox(),this.myFill=[!1,!1],this.otherFill=[!1,!1],this.myCoincide=0,this.otherCoincide=0,this.isVisited=!1,this.isDeleted=!1}return e.prototype.calBbox=function(){var e=this.coords,t=e.length,r=e[0],n=e[t-1];return[Math.min(r.x,n.x),Math.min(r.y,n.y),Math.max(r.x,n.x),Math.max(r.y,n.y)]},e.prototype.reverse=function(){this.coords.reverse()},e.prototype.equal=function(e){var t=this.coords,r=e.coords;if(t.length!==r.length)return!1;for(var n=0,i=t.length;n<i;n++)if(!t[n].equal(r[n]))return!1;return!0},e.prototype.toHash=function(){return this.coords.map((function(e){return e.toString()})).join(" ")},e.prototype.toString=function(){return this.uuid+" "+this.belong+" "+this.myCoincide+this.otherCoincide+" "+(this.isVisited?"v":"n")+(this.isDeleted?"d":"n")+" "+this.myFill.map((function(e){return e?1:0})).join("")+this.otherFill.map((function(e){return e?1:0})).join("")+" "+this.toHash()},e}(),pE=oE,vE=aE,mE=sE,gE=lE,yE=cE,bE=uE,xE=hE,wE=function(){function e(e,t){this.index=t;var r=this.segments=[];Array.isArray(e)&&e.forEach((function(e){if(Array.isArray(e)&&!(e.length<2)&&!(2===e.length&&e[1].length<=2)){for(var n,i=new rE(e[0][0],e[0][1]),o=i,a=function(o,a){var s=e[o],l=s.length,c=new rE(s[l-2],s[l-1]),u=void 0;if(2===l){if(i.equal(c))return n=o,"continue";var h=rE.compare(i,c)?[c,i]:[i,c];u=new fE(h,t),r.push(u)}else if(4===l){if(i.equal(c)&&i.x===s[0]&&i.y===s[1])return n=o,"continue";var d=new rE(s[0],s[1]),f=mu.getBezierMonotonicityT([i,d,c],!0)||[];if(null==(x=mu.getBezierMonotonicityT([i,d,c],!1))||x.forEach((function(e){f.includes(e)||f.push(e)})),f.length){var p=[[i.x,i.y],[s[0],s[1]],[c.x,c.y]],v=mu.sliceBezier(rE.toPoints(p),0,f[0]).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),m=mu.sliceBezier(rE.toPoints(p),f[0],1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),g=new rE(v[1].x,v[1].y),y=new rE(v[2].x,v[2].y),b=new rE(m[1].x,m[1].y);h=rE.compare(i,y)?[y,g,i]:[i,g,y];i.equal(y)||r.push(new fE(h,t)),h=rE.compare(y,c)?[c,b,y]:[y,b,c],c.equal(y)||r.push(new fE(h,t))}else{h=rE.compare(i,c)?[c,d,i]:[i,d,c];r.push(new fE(h,t))}}else if(6===l){if(s[0]===s[2]&&s[1]===s[3])return s.splice(2,2),o--,n=o,"continue";if(i.equal(c)&&i.x===s[0]&&i.y===s[1]&&i.x===s[2]&&i.y===s[3])return n=o,"continue";var x,w=new rE(s[0],s[1]),E=new rE(s[2],s[3]),_=mu.getBezierMonotonicityT([i,w,E,c],!0)||[];if(null==(x=mu.getBezierMonotonicityT([i,w,E,c],!1))||x.forEach((function(e){_.includes(e)||_.push(e)})),_.length){var S=[[i.x,i.y],[s[0],s[1]],[s[2],s[3]],[c.x,c.y]],C=i,T=0;_.forEach((function(e){var n=mu.sliceBezier(rE.toPoints(S),T,e).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),i=new rE(n[1].x,n[1].y),o=new rE(n[2].x,n[2].y),a=new rE(n[3].x,n[3].y),s=rE.compare(C,a)?[a,o,i,C]:[C,i,o,a];C.equal(a)||r.push(new fE(s,t)),T=e,C=a}));var A=mu.sliceBezier(rE.toPoints(S),T,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));g=new rE(A[1].x,A[1].y),y=new rE(A[2].x,A[2].y),h=rE.compare(C,c)?[c,y,g,C]:[C,g,y,c];C.equal(c)||r.push(new fE(h,t))}else{h=rE.compare(i,c)?[c,E,w,i]:[i,w,E,c];r.push(new fE(h,t))}}i=c,n=o},s=1,l=e.length;s<l;s++)a(s),s=n;if(!i.equal(o)){var c=rE.compare(i,o)?[o,i]:[i,o];r.push(new fE(c,t))}}}))}return e.prototype.selfIntersect=function(){var e=CE(this.segments);this.segments=EE(e,!1,!1,!1)},e.prototype.toString=function(){return this.segments.map((function(e){return e.toString()}))},e.prototype.reset=function(e){return this.index=e,this.segments.forEach((function(t){t.belong=e,t.otherCoincide=0,t.otherFill[0]=t.otherFill[1]=!1})),this},e.intersect2=function(e,t,r,n){if(e.segments.length&&t.segments.length){var i=EE(CE(e.segments.concat(t.segments)),!0,r,n);e.segments=i.filter((function(e){return 0===e.belong})),t.segments=i.filter((function(e){return 1===e.belong}))}},e.annotate2=function(e,t,r,n){var i=function(e){var t={};e.forEach((function(e){var r=e.coords,n=r.length,i=r[0],o=r[n-1];AE(t,i.x,i.y,e,!0),AE(t,o.x,o.y,e,!1)}));var r=[];Object.keys(t).forEach((function(e){var n=t[e],i=[];Object.keys(n).forEach((function(e){var t=n[e].sort((function(e,t){return e.isStart!==t.isStart?e.isStart?1:-1:e.isStart?ME(e.seg,t.seg)?1:-1:0}));i.push({y:parseFloat(e),arr:t})})),r.push({x:parseFloat(e),arr:i.sort((function(e,t){return e.y-t.y}))})})),r.sort((function(e,t){return e.x-t.x}));var n=[];return r.forEach((function(e){e.arr.forEach((function(e){n=n.concat(e.arr)}))})),n}(e.segments.concat(t.segments)),o=[],a=[],s={},l={};i.forEach((function(e){var t=e.isStart,i=e.seg,c=i.belong;if(!(0===c&&r||1===c&&n)){var u=0===c?o:a,h=0===c?s:l;if(t){if(i.myCoincide){var d=i.toHash();if(h.hasOwnProperty(d))return;h[d]=!0}if(u.length){var f=u.length,p=u[f-1];if(ME(i,p))i.myFill[1]=p.myFill[0],i.myCoincide?i.myFill[0]=i.myCoincide%2==0?!i.myFill[1]:i.myFill[1]:i.myFill[0]=!i.myFill[1],u.push(i);else if(1===f)i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,u.unshift(i);else for(var v=f-2;v>=0;v--){var m=u[v];if(ME(i,m)){i.myFill[1]=m.myFill[0],i.myCoincide?i.myFill[0]=i.myCoincide%2==0?!i.myFill[1]:i.myFill[1]:i.myFill[0]=!i.myFill[1],u.splice(v+1,0,i);break}0===v&&(i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,u.unshift(i))}}else i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,u.push(i)}else{(v=u.indexOf(i))>-1&&u.splice(v,1)}}}));var c=[],u={};i.forEach((function(e){var t=e.isStart,r=e.seg,n=r.belong;if(t){if(r.myCoincide||r.otherCoincide){var i=r.toHash();if(u.hasOwnProperty(i))return;u[i]=!0}var o=!1;if(c.length){var a=c.length,s=c[a-1];if(ME(r,s))o=s.belong===n?s.otherFill[0]:s.myFill[0],c.push(r);else if(1===a)c.unshift(r);else for(var l=a-2;l>=0;l--){var h=c[l];if(ME(r,h)){o=h.belong===n?h.otherFill[0]:h.myFill[0],c.splice(l+1,0,r);break}0===l&&c.unshift(r)}}else o=!1,c.push(r);r.otherCoincide||(r.otherFill[0]=o,r.otherFill[1]=o)}else{(l=c.indexOf(r))>-1&&c.splice(l,1)}}))},e}();function EE(e,t,r,n){for(var i=[],o=[],a=[];e.length;){o.length&&o.splice(0).forEach((function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1),e.isDeleted||a.push(e)}));for(var s=e.shift(),l=s.x,c=s.arr;c.length;){var u=c.shift();if(!u.isDeleted){var h=u.belong,d=u.bbox;if(u.isVisited){if(d[0]!==d[2]||2!==u.coords.length)(w=i.indexOf(u))>-1&&i.splice(w,1),u.isDeleted||a.push(u);else o.push(u);u.isVisited=!1}else{if(i.length)for(var f=u.coords,p=f.length,v=f[0],m=v.x,g=v.y,y=f[1],b=y.x,x=y.y,w=0;w<i.length;w++){var E=i[w];if(!E.isDeleted&&!u.isDeleted&&(!t||E.belong!==h)){var _=E.bbox,S=E.coords,C=S.length,T=!1;if(LE(d,_,p,C)){if(p===C&&u.equal(E)){t?(u.otherCoincide++,E.otherCoincide++,u.otherFill=E.myFill,E.otherFill=u.myFill):(u.myCoincide++,E.myCoincide++,u.myFill=E.myFill);continue}var A=S[0],k=A.x,M=A.y,O=S[1],L=O.x,R=O.y,I=void 0,P=void 0;if(2===p)if(2===C){if(0===(R-M)*(b-m)-(L-k)*(x-g))if(m===b)m===k&&b===L&&(P=RE(m,g,b,x,u,k,M,L,R,E,!0));else{var F=0,D=0;x!==g&&(F=(b-m)/(x-g)),R!==M&&(D=(L-k)/(R-M)),g-F*m===M-D*k&&(P=RE(m,g,b,x,u,k,M,L,R,E,!1))}else I=pE(m,g,b,x,k,M,L,R)}else{var N=S[2],B=N.x,U=N.y;if(3===C)I=vE(k,M,L,R,B,U,m,g,b,x),T=!0;else{var z=S[3],X=z.x,H=z.y;I=yE(k,M,L,R,B,U,X,H,m,g,b,x),T=!0}}else{var G=f[2],j=G.x,Y=G.y;if(3===p)if(2===C)I=vE(m,g,b,x,j,Y,k,M,L,R);else{var W=S[2];B=W.x,U=W.y;if(3===C)(P=IE(u,E))||(I=mE(m,g,b,x,j,Y,k,M,L,R,B,U));else{var q=S[3];X=q.x,H=q.y;I=gE(m,g,b,x,j,Y,k,M,L,R,B,U,X,H)}}else{var V=f[3],K=V.x,Z=V.y;if(2===C)I=yE(m,g,b,x,j,Y,K,Z,k,M,L,R);else{var J=S[2];B=J.x,U=J.y;if(3===C)I=gE(k,M,L,R,B,U,m,g,b,x,j,Y,K,Z),T=!0;else if(!(P=IE(u,E))){var Q=S[3];X=Q.x,H=Q.y;I=bE(m,g,b,x,j,Y,K,Z,k,M,L,R,B,U,X,H)}}}}if(P){u.isDeleted=E.isDeleted=!0,SE(a,e,i,l,P.ra),SE(a,e,i,l,P.rb),i.splice(w,1);break}if(I&&I.length){for(var $=I.length-1;$>=0;$--){var ee=I[$];ee.point.equal(f[0])?ee.point.equal(S[0])||ee.point.equal(S[C-1])?I.splice($,1):ee.point=f[0]:ee.point.equal(f[p-1])?ee.point.equal(S[0])||ee.point.equal(S[C-1])?I.splice($,1):ee.point=f[p-1]:ee.point.equal(S[0])?ee.point=S[0]:ee.point.equal(S[C-1])&&(ee.point=S[C-1])}if(I.length){var te=xE(I,!T),re=xE(I,T),ne=_E(u,te,r&&0===h),ie=_E(E,re,n&&1===h);if(ne.length&&SE(a,e,i,l,ne),ie.length&&(SE(a,e,i,l,ie),i.splice(w--,1)),ne.length)break}}}}}u.isDeleted||(i.push(u),u.isVisited=!0)}}}}return o.forEach((function(e){e.isDeleted||-1!==a.indexOf(e)||a.push(e)})),i.forEach((function(e){e.isDeleted||-1!==a.indexOf(e)||a.push(e)})),a.filter((function(e){return!e.isDeleted}))}function _E(e,t,r){var n=[];if(!t.length)return n;var i,o=e.belong,a=e.coords,s=a.length,l=a[0],c=0;if(t.forEach((function(t){var i=t.point,u=t.t;if(!i.equal(l)){var h;if(2===s)h=rE.compare(l,i)?new fE([i,l],o):new fE([l,i],o);else if(3===s){var d=mu.sliceBezier(a,c,u).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));h=rE.compare(l,i)?new fE([i,new rE(d[1].x,d[1].y),l],o):new fE([l,new rE(d[1].x,d[1].y),i],o)}else if(4===s){d=mu.sliceBezier(a,c,u).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));h=rE.compare(l,i)?new fE([i,new rE(d[2].x,d[2].y),new rE(d[1].x,d[1].y),l],o):new fE([l,new rE(d[1].x,d[1].y),new rE(d[2].x,d[2].y),i],o)}r&&(h.myFill[0]=e.myFill[0],h.myFill[1]=e.myFill[1]),l=i,n.push(h),c=u}})),!l.equal(a[a.length-1])){if(2===s)i=rE.compare(l,a[1])?new fE([a[1],l],o):new fE([l,a[1]],o);else if(3===s){var u=mu.sliceBezier(a,c,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));i=rE.compare(l,a[2])?new fE([a[2],new rE(u[1].x,u[1].y),l],o):new fE([l,new rE(u[1].x,u[1].y),a[2]],o)}else if(4===s){u=mu.sliceBezier(a,c,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));i=rE.compare(l,a[3])?new fE([a[3],new rE(u[2].x,u[2].y),new rE(u[1].x,u[1].y),l],o):new fE([l,new rE(u[1].x,u[1].y),new rE(u[2].x,u[2].y),a[3]],o)}r&&(i.myFill[0]=e.myFill[0],i.myFill[1]=e.myFill[1]),n.push(i)}return n.length>1?(e.isDeleted=!0,n):[]}function SE(e,t,r,n,i){i.forEach((function(i){var o,a=i.coords,s=a[0],l=a[a.length-1],c=s.x,u=l.x;if(c>u&&(c=(o=[u,c])[0],u=o[1]),u<=n&&c!==u)e.push(i);else{if(c===u)for(var h=r.length-1;h>=0;h--){var d=r[h];if(i.equal(d)&&!d.isDeleted)return void(i.belong===d.belong?d.myCoincide++:d.otherCoincide++)}var f=0;if(c<n)i.isVisited=!0,r.push(i);else if(t.length)for(var p=t.length;f<p;f++){if(c===(m=(d=t[f]).x)){d.arr.push(i),c===u&&c===n&&r.push(i);break}if(c<m){var v={x:c,arr:[i]};c===u&&c===n&&r.push(i),t.splice(f,0,v);break}}else r.push(i);for(p=t.length;f<p;f++){var m;if(u===(m=(d=t[f]).x)){d.arr.unshift(i);break}if(u<m){v={x:u,arr:[i]};t.splice(f,0,v);break}}}}))}function CE(e){var t={};e.forEach((function(e){var r,n=e.coords,i=n[0],o=n[n.length-1],a=i.x,s=o.x;a>s&&(a=(r=[s,a])[0],s=r[1]),TE(t,a,e),TE(t,s,e)}));var r=[];return Object.keys(t).forEach((function(e){return r.push({x:parseFloat(e),arr:t[e]})})),r.sort((function(e,t){return e.x-t.x}))}function TE(e,t,r){var n=e[t]=e[t]||[];r.isVisited?(n.unshift(r),r.isVisited=!1):(n.push(r),r.isVisited=!0)}function AE(e,t,r,n,i){var o=e[t]=e[t]||{};(o[r]=o[r]||[]).push({isStart:i,seg:n})}function kE(e,t,r){var n=e.x,i=e.y,o=t.x,a=t.y,s=r.x,l=r.y;return nc.crossProduct(o-n,a-i,s-n,l-i)>=0}function ME(e,t){var r=e.coords,n=t.coords,i=r.length,o=n.length,a=r[0],s=n[0];if(2===i&&2===o){var l=r[1],c=n[1];return a.equal(s)?kE(l,s,c):kE(a,s,c)}if(2===i&&a.x===r[1].x){if(a.equal(s))return!0;if(r[i-1].equal(s))return!0;if(r[i-1].equal(n[o-1]))return!1}if(2===o&&s.x===n[1].x&&a.equal(s))return!1;var u=Math.max(a.x,s.x),h=Math.min(r[i-1].x,n[o-1].x),d=u+.5*(h-u);if(!a.equal(s)){var f=OE(r,u),p=OE(n,u);if(f!==p)return f>p}var v=OE(r,d),m=OE(n,d);if(v!==m)return v>m;if(!r[i-1].equal(n[o-1])){var g=OE(r,h),y=OE(n,h);if(g!==y)return g>y}return!1}function OE(e,t){var r=e.length;if(t===e[0].x)return e[0].y;if(t===e[r-1].x)return e[r-1].y;if(2===r){if(e[0].y===e[1].y)return e[0].y;var n=(t-e[0].x)/(e[1].x-e[0].x);return e[0].y+n*(e[1].y-e[0].y)}if(3===r){var i=Gc.getRoots([e[0].x-t,2*(e[1].x-e[0].x),e[2].x+e[0].x-2*e[1].x]).filter((function(e){return e>=0&&e<=1}));return mu.getPointByT(e,i[0]).y}if(4===r){i=Gc.getRoots([e[0].x-t,3*(e[1].x-e[0].x),3*(e[2].x+e[0].x-2*e[1].x),e[3].x+3*e[1].x-e[0].x-3*e[2].x]).filter((function(e){return e>=0&&e<=1}));return mu.getPointByT(e,i[0]).y}}function LE(e,t,r,n){if(2===r&&2===n){if(e[0]===e[2]&&t[0]===t[2]&&e[0]===e[2])return!(e[1]>=t[3]||t[1]>=e[3]);if(e[1]===e[3]&&t[1]===t[3]&&e[1]===e[3])return!(e[0]>=t[2]||t[0]>=e[2])}return Mc.isRectsOverlap(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3],!0)}function RE(e,t,r,n,i,o,a,s,l,c,u){var h=[],d=[],f=i.coords,p=c.coords;return e<o&&!u||t<a&&u?(h.push(new fE([f[0],p[0]],i.belong)),r<s&&!u||n<l&&u?(h.push(new fE([p[0],f[1]],i.belong)),d.push(new fE([p[0],f[1]],c.belong)),d.push(new fE([f[1],p[1]],c.belong))):r===s&&!u||n===l&&u?(h.push(new fE([p[0],p[1]],i.belong)),d.push(new fE([p[0],p[1]],c.belong))):(h.push(new fE([p[0],p[1]],i.belong)),d.push(new fE([p[0],p[1]],c.belong)),h.push(new fE([p[1],f[1]],i.belong)))):e===o&&!u||t===a&&u?r<s&&!u||n<l&&u?(h.push(new fE([f[0],f[1]],i.belong)),d.push(new fE([f[0],f[1]],c.belong)),d.push(new fE([f[1],p[1]],c.belong))):(h.push(new fE([p[0],p[1]],i.belong)),h.push(new fE([p[1],f[1]],i.belong)),d.push(new fE([p[0],p[1]],c.belong))):(d.push(new fE([p[0],f[0]],c.belong)),r<s&&!u||n<l&&u?(h.push(new fE([f[0],f[1]],i.belong)),d.push(new fE([f[0],f[1]],c.belong)),d.push(new fE([f[1],p[1]],c.belong))):r===s&&!u||n===l&&u?(h.push(new fE([f[0],f[1]],i.belong)),d.push(new fE([f[0],f[1]],c.belong))):(h.push(new fE([f[0],p[1]],i.belong)),d.push(new fE([f[0],p[1]],c.belong)),h.push(new fE([p[1],f[1]],i.belong)))),{ra:h,rb:d}}function IE(e,t){var r=e.coords,n=r.length,i=t.coords,o=i.length,a=r[0],s=i[0],l=r[n-1],c=i[o-1],u=mu.getPointT(r,s.x,s.y),h=mu.getPointT(r,c.x,c.y),d=mu.getPointT(i,a.x,a.y),f=mu.getPointT(i,l.x,l.y),p=u.length,v=h.length,m=d.length,g=f.length;if(1===p&&1===v&&0===m&&0===g||0===p&&0===v&&1===m&&1===g||(1===p&&1===v&&m+g===1||p+v===1&&1===m&&1===g)||p+v===1&&m+g===1){var y=p?u[0]:0,b=v?h[0]:1,x=mu.sliceBezier(r,y,b),w=m?d[0]:0,E=g?f[0]:1;if(function(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r],o=t[r];if(Math.abs(i.x-o.x)>1e-9||Math.abs(i.y-o.y)>1e-9)return!1}return!0}(x,mu.sliceBezier(i,w,E))){var _=x.map((function(e){return new rE(e.x,e.y)})),S=[],C=[];if(y>0){var T=mu.sliceBezier(r,0,y),A=[e.coords[0],new rE(T[1].x,T[1].y),t.coords[0]];4===n&&A.splice(2,0,new rE(T[2].x,T[2].y)),S.push(new fE(A,e.belong))}if(S.push(new fE(_,e.belong)),b<1){T=mu.sliceBezier(r,b,1),A=[t.coords[o-1],new rE(T[1].x,T[1].y),e.coords[n-1]];4===n&&A.splice(2,0,new rE(T[2].x,T[2].y)),S.push(new fE(A,e.belong))}if(w>0){T=mu.sliceBezier(i,0,w),A=[t.coords[0],new rE(T[1].x,T[1].y),e.coords[0]];4===o&&A.splice(2,0,new rE(T[2].x,T[2].y)),C.push(new fE(A,t.belong))}if(C.push(new fE(_,t.belong)),E<1){T=mu.sliceBezier(i,E,1),A=[e.coords[n-1],new rE(T[1].x,T[1].y),t.coords[o-1]];4===o&&A.splice(2,0,new rE(T[2].x,T[2].y)),C.push(new fE(A,t.belong))}return{ra:S,rb:C}}}}function PE(e,t,r,n,i,o){for(var a=0,s=t.length;a<s;a++){var l=t[a];if(l!==r){var c=l.length,u=l[0],h=l[c-1],d=u.coords[0],f=h.coords,p=f[f.length-1];if(i.equal(d))return o?(l=DE(r).concat(l),t[a]=l,t.splice(n,1),FE(e,t,l,a)):(l=r.concat(l),t[a]=l,t.splice(n,1),FE(e,t,l,a));if(i.equal(p))return o?(l=l.concat(r),t[a]=l,t.splice(n,1),FE(e,t,l,a)):(l=l.concat(DE(r)),t[a]=l,t.splice(n,1),FE(e,t,l,a))}}FE(e,t,r,n)}function FE(e,t,r,n){var i=r.length,o=r[0],a=r[i-1],s=o.coords[0],l=a.coords,c=l[l.length-1];s.equal(c)&&(t.splice(n,1),e.push(r))}function DE(e){return e.forEach((function(e){return e.reverse()})),e.reverse()}function NE(e){var t=[],r=[];e.sort((function(e,t){return t.otherFill[0]&&t.otherFill[1]?1:-1}));e:for(;e.length;){for(var n=e.shift(),i=n.coords,o=i.length,a=i[0],s=i[o-1],l=void 0,c=0,u=t.length;c<u;c++){var h=t[c],d=h.length,f=h[0],p=h[d-1],v=f.coords[0],m=p.coords,g=m[m.length-1];if(a.equal(g)){if(n.belong!==p.belong){h.push(n),PE(r,t,h,c,s,!1);continue e}l||(l={i:c,t:0})}else if(a.equal(v)){if(n.belong!==p.belong){n.reverse(),h.unshift(n),PE(r,t,h,c,s,!0);continue e}l||(l={i:c,t:1})}else if(s.equal(g)){if(n.belong!==p.belong){n.reverse(),h.push(n),PE(r,t,h,c,a,!1);continue e}l||(l={i:c,t:2})}else if(s.equal(v)){if(n.belong!==p.belong){h.unshift(n),PE(r,t,h,c,a,!0);continue e}l||(l={i:c,t:3})}}l?0===l.t?(t[l.i].push(n),PE(r,t,t[l.i],l.i,s,!1)):1===l.t?(n.reverse(),t[l.i].unshift(n),PE(r,t,t[l.i],l.i,s,!0)):2===l.t?(n.reverse(),t[l.i].push(n),PE(r,t,t[l.i],l.i,a,!1)):3===l.t&&(t[l.i].unshift(n),PE(r,t,t[l.i],l.i,a,!0)):t.push([n])}var y=r.map((function(e){var t=!0,r=0,n=0,i=0,o=0,a=0,s=0,l=0;e.forEach((function(e,t){var c=e.coords,u=c.length,h=e.bbox;t?(o=Math.min(o,h[0]),a=Math.min(a,h[1]),s=Math.max(s,h[2]),l=Math.max(l,h[3])):(o=h[0],a=h[1],s=h[2],l=h[3]),2===u?(r+=t?n*c[1].y-i*c[1].x:c[0].x*c[1].y-c[0].y*c[1].x,n=c[1].x,i=c[1].y):3===u?(r+=t?n*c[2].y-i*c[2].x:c[0].x*c[1].y-c[0].y*c[2].x,n=c[2].x,i=c[2].y):4===u&&(r+=t?n*c[3].y-i*c[3].x:c[0].x*c[3].y-c[0].y*c[3].x,n=c[3].x,i=c[3].y)}));var c=e[0].coords;return(r+=n*c[0].y-i*c[0].x)<0&&(t=!1),{checked:!1,list:e,clockwise:t,bbox:[o,a,s,l],area:(s-o)*(l-a)}}));return y.forEach((function(e){if(!e.checked){for(var t=e.bbox,r=[e],n=0,i=y.length;n<i;n++){if((c=y[n])!==e){var o=c.bbox;(Mc.isRectsInside(t[0],t[1],t[2],t[3],o[0],o[1],o[2],o[3],!0)||Mc.isRectsInside(o[0],o[1],o[2],o[3],t[0],t[1],t[2],t[3],!0))&&r.push(c)}}if(r.length>1){r.sort((function(e,t){return e.area-t.area}));for(n=1,i=r.length;n<i;n++){var a=r[n];if(a.checked){for(var s=a.clockwise,l=n-1;l>=0;l--){(c=r[l]).checked=!0,c.clockwise===s&&(DE(c.list),c.clockwise=!s),s=!s}s=a.clockwise;for(l=n+1;l<i;l++){var c;(c=r[l]).checked=!0,c.clockwise===s&&(DE(c.list),c.clockwise=!s),s=!s}return}}var u=r[0].clockwise;r[0].checked=!0;for(n=1,i=r.length;n<i;n++){var h=r[n];h.checked=!0,h.clockwise===u&&(DE(h.list),h.clockwise=!u),u=!u}}}})),y.map((function(e){var t=e.list.map((function(e){var t=e.coords,r=t.length;return 3===r?[t[1].x,t[1].y,t[2].x,t[2].y]:4===r?[t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y]:[t[1].x,t[1].y]})),r=e.list[0].coords;return t.unshift([r[0].x,r[0].y]),t}))}function BE(e){return e&&Array.isArray(e)&&Array.isArray(e[0])?Array.isArray(e[0][0])?e:[e]:[]}function UE(e,t){var r,n,i=e instanceof wE,o=t instanceof wE;return i?r=e.reset(0):(r=new wE(BE(e),0)).selfIntersect(),o?n=t.reset(1):(n=new wE(BE(t),1)).selfIntersect(),wE.intersect2(r,n,i,o),wE.annotate2(r,n,i,o),[r,n]}var zE=[0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0],XE=[0,1,1,1,1,0,0,0,1,0,0,0,1,0,0,0],HE=[0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0],GE=[0,1,0,0,1,0,1,1,0,1,0,0,0,1,0,0],jE=[0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0];function YE(e,t){var r=[],n={};return e.forEach((function(e){var i,o=e.belong,a=e.myFill,s=e.otherFill;if(e.otherCoincide){var l=e.toHash();if(n.hasOwnProperty(l))return;n[l]=!0}i=o?(s[0]?8:0)+(a[0]?4:0)+(s[1]?2:0)+(a[1]?1:0):(a[0]?8:0)+(s[0]?4:0)+(a[1]?2:0)+(s[1]?1:0),t[i]&&r.push(e)})),r}var WE={intersect:function(e,t,r){void 0===r&&(r=!1);var n=UE(e,t),i=n[0],o=n[1],a=YE(i.segments.concat(o.segments),zE);return r?(i.segments=a,i):NE(a)},union:function(e,t,r){void 0===r&&(r=!1);var n=UE(e,t),i=n[0],o=n[1],a=YE(i.segments.concat(o.segments),XE);return r?(i.segments=a,i):NE(a)},subtract:function(e,t,r){void 0===r&&(r=!1);var n=UE(e,t),i=n[0],o=n[1],a=YE(i.segments.concat(o.segments),HE);return a.length,r?(i.segments=a,i):NE(a)},subtractRev:function(e,t,r){void 0===r&&(r=!1);var n=UE(e,t),i=n[0],o=n[1],a=YE(i.segments.concat(o.segments),GE);return r?(i.segments=a,i):NE(a)},xor:function(e,t,r){void 0===r&&(r=!1);var n=UE(e,t),i=n[0],o=n[1],a=YE(i.segments.concat(o.segments),jE);return r?(i.segments=a,i):NE(a)},chains:NE},qE=1e-4,VE=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isGroup=!0,n.fixedPosAndSize=!1,n}return v(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this),this.adjustPosAndSize()},t.prototype.adjustPosAndSizeChild=function(e,t,r,n,i,o,a){var s=e.style,l=e.computedStyle,c=e.root;if(c){var u=s.top,h=s.right,d=s.bottom,f=s.left;(t||n)&&(l.left-=t,f.u===Xs.PX?f.v=l.left:f.u===Xs.PERCENT&&o&&(f.v=100*l.left/o),l.right+=n,h.u===Xs.PX?h.v=l.right:h.u===Xs.PERCENT&&o&&(h.v=100*l.right/o)),(r||i)&&(l.top-=r,u.u===Xs.PX?u.v=l.top:u.u===Xs.PERCENT&&a&&(u.v=100*l.top/a),l.bottom+=i,d.u===Xs.PX?d.v=l.bottom:d.u===Xs.PERCENT&&a&&(d.v=100*l.bottom/a)),e.refreshLevel|=Nx.TRANSFORM,c.rl|=Nx.TRANSFORM,e.calMatrix(Nx.TRANSFORM),e._rect=void 0,e._bbox=void 0,e._bbox2=void 0,e._filterBbox=void 0,e._filterBbox2=void 0,e.tempBbox=void 0}},t.prototype.adjustPosAndSize=function(e){if(this.fixedPosAndSize)return!1;var t=this.children;e||(e=this.getChildrenRect());var r=this.width,n=this.height,i=e.minX,o=e.minY,a=e.maxX-r,s=e.maxY-n;if(Math.abs(i)>qE||Math.abs(o)>qE||Math.abs(a)>qE||Math.abs(s)>qE){this.adjustPosAndSizeSelf(i,o,a,s),r=this.width,n=this.height;for(var l=0,c=t.length;l<c;l++){var u=t[l];this.adjustPosAndSizeChild(u,i,o,a,s,r,n)}return!0}return!1},t.prototype.checkPosSizeSelf=function(){this.adjustPosAndSize()&&this.checkPosSizeUpward()},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.GROUP,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n,i;return Q(this,(function(o){switch(o.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(n=o.sent())._class=ee.ClassValue.Group,n.hasClickThrough=!1,[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t)})))];case 2:return i=o.sent(),n.layers=i.map((function(e){return e})),[2,n]}}))}))},Object.defineProperty(t,"EPS",{get:function(){return qE},enumerable:!1,configurable:!0}),t}(Pw),KE={alpha:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,depth:!0,stencil:!0},ZE="#define GLSLIFY 1\nattribute vec2 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=vec4(a_position,0,1);v_texCoords=a_texCoords;}",JE="#define GLSLIFY 1\nattribute vec2 a_position;varying vec4 v_position;void main(){gl_Position=vec4(a_position,0,1);v_position=gl_Position;}",QE=function(e){function t(t){var r=e.call(this,t)||this;return r.isSlice=!0,r}return v(t,e),t.prototype.calContent=function(){return this.hasContent=!1},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SLICE,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n;return Q(this,(function(i){switch(i.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=i.sent())._class=ee.ClassValue.Slice,[2,n]}}))}))},t}(Iw),$E=function(){function e(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),this.x=0,this.y=e,this.w=0,this.h=t,this.index=r,this.list=[],this.startEnter=n,this.endEnter=i}return e.prototype.add=function(e){this.list.push(e),this.w+=e.w},e.prototype.verticalAlign=function(){for(var e=this.baseline,t=this.list,r=0,n=t.length;r<n;r++){var i=t[r],o=i.baseline;if(o!==e){var a=e-o;i.y+=a}}},e.prototype.offsetX=function(e){this.x+=e;for(var t=this.list,r=0,n=t.length;r<n;r++)t[r].x+=e},e.prototype.offsetY=function(e){this.y+=e;for(var t=this.list,r=0,n=t.length;r<n;r++)t[r].y+=e},Object.defineProperty(e.prototype,"size",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){for(var e=0,t=this.list,r=0,n=t.length;r<n;r++)e=Math.max(e,t[r].baseline);return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){var e=this.list;if(e.length){for(var t=0,r=0,n=e.length;r<n;r++)t=Math.max(t,e[r].lineHeight);return t}return this.h},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.ceil(this.w)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.ceil(this.lineHeight)},enumerable:!1,configurable:!0}),e}(),e_=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f){this.x=e,this.y=t,this.w=r,this.lineHeight=n,this.baseline=i,this.contentArea=o,this.index=a,this.str=s,this.font=l,this.fontFamily=c,this.fontSize=u,this.color=h,this.letterSpacing=d,this.textDecoration=f};function t_(e,t,r,n,i,o,a){var s=t,l=r,c=0,u=!1,h=Math.round(i/o);for(h<=0?h=1:h>r-t&&(h=r-t);s<l;){var d=e.measureText(n.slice(t,t+h)).width;if(d===i){c=i,u=!0;break}if(d>i+1e-10){if(u=!0,1===h){c=d;break}if(s===l-1||s-t==h-1){h=s-t;break}l=h+t-1;var f=Math.round((d-i)/o);f<=0&&(f=1),(h-=f)<s-t&&(h=s-t)}else{if(c=d,h===r-t)break;s=h+t;var p=Math.round((i-d)/o);p<=0&&(p=1),(h+=p)>l-t&&(h=l-t)}}for(var v=t,m=t+h;v<m;v++)if("\n"===n.charAt(v))return{hypotheticalNum:h=v-t,rw:c=e.measureText(n.slice(t,t+h)).width,newLine:u=!1};if(t+h<r&&/[\w.-]/.test(n.charAt(t+h-1)))for(var g=t+h-2;g>t;g--)if(!/[\w.-]/.test(n.charAt(g)))return{hypotheticalNum:h=g-t+1,rw:c=e.measureText(n.slice(t,t+h)).width,newLine:u=!0};return"\n"===n.charAt(t+h)&&(u=!1),{hypotheticalNum:h,rw:c,newLine:u}}var r_=function(e){function t(t){var r,n=e.call(this,t)||this;return n.isText=!0,n._content=t.content||"",n.rich=((null===(r=t.rich)||void 0===r?void 0:r.slice(0))||[]).map((function(e){return Gu(e)})),n.lineBoxList=[],n.tempCursorX=0,n.currentCursorX=0,n.cursor={isMulti:!1,startLineBox:0,endLineBox:0,startTextBox:0,endTextBox:0,startString:0,endString:0,start:0,end:0},n.asyncRefresh=!1,n.loaders=[],n}return v(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this);var t=this.props.textBehaviour,r=this,n=r.style,i=r.computedStyle,o=r.width,a=r.height,s=r.lineBoxList;if(t===il.AUTO||t===il.FIXED_W){var l=!1;if(t===il.AUTO&&n.width.u!==Xs.AUTO){var c=0;s.forEach((function(e){c=Math.max(c,e.width)})),(u=c-o)&&(i.textAlign===Hs.LEFT?this.adjustPosAndSizeSelf(.5*u,0,0,0):i.textAlign===Hs.RIGHT&&this.adjustPosAndSizeSelf(.5*-u,0,0,0)),this.updateStyle({width:"auto"}),l=!0}if(this.style.height.u!==Xs.AUTO){var u,h=s[s.length-1];(u=h?h.y+h.height-a:-a)&&(i.textVerticalAlign===Gs.TOP?this.adjustPosAndSizeSelf(0,.5*u,0,0):i.textVerticalAlign===Gs.BOTTOM&&this.adjustPosAndSizeSelf(0,.5*-u,0,0)),this.updateStyle({height:"auto"}),l=!0}l&&this.checkPosSizeUpward()}},t.prototype.lay=function(t){var r=this;e.prototype.lay.call(this,t);var n,i,o,a,s,l,c,u,h,d=this,f=d.rich,p=d.style,v=d.computedStyle,m=d._content,g=d.lineBoxList,y=p.left,b=p.right,x=p.top,w=p.bottom,E=p.width,_=p.height,S=E.u===Xs.AUTO&&(y.u===Xs.AUTO||b.u===Xs.AUTO),C=_.u===Xs.AUTO&&(x.u===Xs.AUTO||w.u===Xs.AUTO),T=0,A=m.length,k=[],M=0,O=0,L=0;this.mergeRich();var R={};if(f.length)for(var I=function(e,t){var n=f[e];R[n.location]=e;var i=n.fontFamily,o=jl.data[i];if(o)for(var a=o.list||[],s=function(t,n){var o=a[t];if(o.postscriptName===i)return!o.loaded&&o.url&&fl.loadFont(i,o.url,(function(t){if(o.loaded=!0,t.success&&f&&f[e]&&f[e].fontFamily===i){if(r.asyncRefresh)return;r.asyncRefresh=!0,fl.requestAnimationFrame((function(){t.success&&f&&f[e]&&f[e].fontFamily===i&&(r.asyncRefresh=!1,r.refresh(Nx.REFLOW))}))}})),"break"},l=0,c=a.length;l<c;l++){if("break"===s(l))break}},P=0,F=f.length;P<F;P++)I(P);else{var D=v.fontFamily,N=jl.data[D];if(N){var B=N.list||[],U=function(e,t){var n=B[e];if(n.postscriptName===D)return!n.loaded&&n.url&&fl.loadFont(D,n.url,(function(e){n.loaded=!0,e.success&&!f.length&&v.fontFamily===D&&r.refresh(Nx.REFLOW)})),"break"},z=0;for(F=B.length;z<F;z++){if("break"===U(z))break}}}var X=fl.getFontCanvas().ctx;if(f.length){var H=f[0];i=H.letterSpacing||0,o=H.paragraphSpacing||0,n=.8*H.fontSize+i,s=eh(H,a=H.lineHeight||$u(H)),l=th(H,a),c=H.fontFamily,u=H.fontSize,h=qu(H.color),k=H.textDecoration||[],X.font=Ju(H),X.letterSpacing=i+"px"}else i=v.letterSpacing,o=v.paragraphSpacing,n=.8*v.fontWeight+i,a=v.lineHeight||$u(v),s=eh(v,a),l=th(v,a),c=v.fontFamily,u=v.fontSize,h=qu(this.style.color.v),k=v.textDecoration||[],X.font=Ju(v),X.letterSpacing=i+"px";var G=new $E(L,a,T,!1);g.splice(0),g.push(G);for(var j=S?Number.MAX_SAFE_INTEGER:this.width;T<A;){var Y=R[T];if(T&&Y){var W=f[Y];i=W.letterSpacing||0,o=W.paragraphSpacing||0,n=.8*W.fontSize+i,s=eh(W,a=W.lineHeight||$u(W)),l=th(W,a),c=W.fontFamily,u=W.fontSize,h=qu(W.color),k=W.textDecoration||[],X.font=Ju(W),X.letterSpacing=i+"px"}if("\n"!==m.charAt(T)){F=A;if(f.length)for(var q=T+1;q<F;q++)if(R[q]){F=q;break}if(X.measureText(m.charAt(T)).width>j-O+1e-10&&O)O=0,L+=G.height+o,T<A&&(G.verticalAlign(),G=new $E(L,a,T,!1),g.push(G));else{var V=t_(X,T,F,m,j-O,n),K=V.hypotheticalNum,Z=V.rw,J=V.newLine,Q=new e_(O,L,Z,a,s,l,T,m.slice(T,T+K),X.font,c,u,h,i,k);G.add(Q),T+=K,M=Math.max(M,Math.ceil(Z+O)),J?(O=0,L+=G.height+o,T<A&&(G.verticalAlign(),G=new $E(L,a,T,!1),g.push(G))):O+=Z}}else T++,O=0,L+=G.height+o,G.verticalAlign(),G.endEnter=!0,G=new $E(L,a,T,!0),g.push(G)}if((G.verticalAlign(),M=Math.max(M,G.width),i&&i<0&&(M-=i),S)&&(he=M-this.width)){this.width=v.width=M;var $=p.left,ee=p.right;$.u!==Xs.AUTO&&ee.u!==Xs.AUTO||($.u!==Xs.AUTO?v.right-=he:ee.u!==Xs.AUTO&&(v.left-=he))}if(C){var te=G.y+G.height;if(he=te-this.height){this.height=v.height=te;var re=p.top,ne=p.bottom;re.u!==Xs.AUTO&&ne.u!==Xs.AUTO||(re.u!==Xs.AUTO?v.bottom-=he:ne.u!==Xs.AUTO&&(v.top-=he))}}if(f&&f.length){var ie={};f.forEach((function(e){ie[e.location]=e}));var oe=f[0].textAlign,ae=0;for(F=g.length;ae<F;ae++){var se=g[ae];if(se.startEnter||!se.index){var le=ie[se.index];le&&(oe=le.textAlign)}if(oe===Hs.CENTER)(he=this.width-se.width)&&se.offsetX(.5*he);else if(oe===Hs.RIGHT){(he=this.width-se.width)&&se.offsetX(he)}}}else if(m&&v.textAlign!==Hs.LEFT){var ce=0;for(F=g.length;ce<F;ce++){var ue=g[ce];if(v.textAlign===Hs.CENTER)(he=this.width-ue.width)&&ue.offsetX(.5*he);else if(v.textAlign===Hs.RIGHT){var he;(he=this.width-ue.width)&&ue.offsetX(he)}}}var de=this.height-G.y-G.height;if(de){var fe=v.textVerticalAlign;if(fe===Gs.MIDDLE){var pe=0;for(F=g.length;pe<F;pe++){g[pe].offsetY(.5*de)}}else if(fe===Gs.BOTTOM){var ve=0;for(F=g.length;ve<F;ve++){g[ve].offsetY(de)}}}},t.prototype.calContent=function(){return this.hasContent=!!this._content},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t);var i=this._bbox2||this.bbox2,o=i[0],a=i[1],s=i[2]-o,l=i[3]-a,c=-o*t,u=-a*t;s*=t,l*=t;var h=this.computedStyle,d=this.lineBoxList,f=this.canvasCache=Nw.getInstance(s,l,c,u);f.available=!0;var p=f.list,v=this.getSortedCursor(),m=v.isMulti,g=v.startLineBox,y=v.startTextBox,b=v.startString,x=v.endLineBox,w=v.endTextBox,E=v.endString,_=v.start,S=v.end;if(m&&_!==S)for(var C=0,T=p.length;C<T;C++){var A=p[C],k=A.x,M=A.y,O=A.os.ctx,L=-k,R=-M;if(O.fillStyle="#f4d3c1",g===x){var I=(D=d[g]).list,P=(N=I[y]).x*t+L;O.font=N.font,O.letterSpacing=N.letterSpacing+"px",P+=O.measureText(N.str.slice(0,b)).width*t;var F=(N=I[w]).x*t+L;O.font=N.font,F+=O.measureText(N.str.slice(0,E)).width*t,O.fillRect(P,D.y*t+R,F-P,D.lineHeight*t)}else{var D,N,B=(D=d[g]).list;if(N=B[y]){P=N.x*t+L;O.font=N.font,O.letterSpacing=N.letterSpacing+"px",P+=O.measureText(N.str.slice(0,b)).width*t,O.fillRect(P,D.y*t+R,D.w*t+L-P,D.lineHeight*t)}for(var U=g+1,z=x;U<z;U++){var X=d[U];X.list.length&&O.fillRect(X.list[0].x*t+L,X.y*t+R,X.w*t,X.lineHeight*t)}if(N=(B=(D=d[x]).list)[w]){P=N.x*t+L;O.font=N.font,O.letterSpacing=N.letterSpacing+"px",P+=O.measureText(N.str.slice(0,E)).width*t,O.fillRect(D.x*t+L,D.y*t+R,P-(D.x+L)*t,D.lineHeight*t)}}}var H=!1,G=h.fill,j=h.fillOpacity,Y=h.fillEnable,W=h.fillMode,q=h.stroke,V=h.strokeEnable,K=h.strokeWidth,Z=h.strokePosition,J=h.strokeMode,Q=h.strokeDasharray,$=h.strokeLinecap,ee=h.strokeLinejoin;for(C=0,T=G.length;C<T;C++)if(Y[C]&&j[C]){H=!0;break}function te(e,r){void 0===r&&(r=!0);for(var n=0,i=d.length;n<i;n++){var o=d[n];if(o.y>=l)break;for(var a=o.list,s=a.length,h=function(n){var i=a[n],o=i.textDecoration;n_(e,i,t),r?e.fillText(i.str,i.x*t+c,(i.y+i.baseline)*t+u):e.strokeText(i.str,i.x*t+c,(i.y+i.baseline)*t+u),o.length&&o.forEach((function(r){if(r===vl.UNDERLINE){var n=Math.min(3*t,.05*i.lineHeight*t);e.strokeRect(i.x*t+c,(i.y+i.contentArea)*t+u-.5*n,i.w*t,n)}else if(r===vl.LINE_THROUGH){var o=Math.min(3*t,.05*i.lineHeight*t);e.strokeRect(i.x*t+c,(i.y+.5*i.lineHeight)*t+u-.5*o,i.w*t,o)}}))},f=0;f<s;f++)h(f)}}var re=function(e,i){var o=p[e],a=o.x,h=o.y,f=o.os.ctx,v=-a,m=-h;if(H)for(var g=function(e,i){if(!Y[e]||!j[e])return"continue";var o=G[e],a=void 0,h=W[e];if(f.globalAlpha=j[e],Array.isArray(o)){if(o[3]<=0)return"continue";f.fillStyle=qu(o)}else{if(void 0!==o.url){var d=o.url;if(d){var p=ne.loaders[e],g=fl.IMG[d];if(!p&&g&&(p=ne.loaders[e]={error:!1,loading:!1,width:g.width,height:g.height,source:g.source}),p){if(!p.error&&!p.loading){var y=ne.width,b=ne.height,x=y*t,w=b*t,E=fl.getOffscreenCanvas(s,l),_=E.ctx;if(o.type===rl.TILE)for(var S=null!==(r=o.scale)&&void 0!==r?r:1,C=0,T=Math.ceil(y/S/p.width);C<T;C++)for(var A=0,k=Math.ceil(b/S/p.height);A<k;A++)_.drawImage(p.source,v+C*p.width*t*S,m+A*p.height*t*S,p.width*t*S,p.height*t*S);else if(o.type===rl.FILL){var M=x/p.width,O=w/p.height,L=Math.max(M,O),R=-.5*(p.width*L-x),I=-.5*(p.height*L-w);_.drawImage(p.source,0,0,p.width,p.height,R+v,I+m,p.width*L,p.height*L)}else if(o.type===rl.STRETCH)_.drawImage(p.source,v,m,x,w);else if(o.type===rl.FIT){M=x/p.width,O=w/p.height,L=Math.min(M,O);var P=-.5*(p.width*L-x),F=-.5*(p.height*L-w);_.drawImage(p.source,0,0,p.width,p.height,P+v,F+m,p.width*L,p.height*L)}_.fillStyle="#FFF",_.globalCompositeOperation="destination-in",te(_,!0),_.globalCompositeOperation="source-over",h!==js.NORMAL&&(f.globalCompositeOperation=Bw(h)),f.drawImage(E.canvas,0,0),h!==js.NORMAL&&(f.globalCompositeOperation="source-over"),E.release()}}else p=ne.loaders[e]=ne.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},fl.loadImg(d,(function(t){var r;d===(null===(r=G[e])||void 0===r?void 0:r.url)&&(p.loading=!1,t.success?(p.error=!1,p.source=t.source,p.width=t.width,p.height=t.height,n.isDestroyed||n.refresh()):p.error=!0)}))}return"continue"}if(o.t===Ws.LINEAR){var D=Nu(o.stops,o.d,v,m,s-2*c,l-2*u),N=f.createLinearGradient(D.x1,D.y1,D.x2,D.y2);D.stop.forEach((function(e){N.addColorStop(e.offset,qu(e.color))})),f.fillStyle=N}else if(o.t===Ws.RADIAL){D=Bu(o.stops,o.d,v,m,s-2*c,l-2*u);var B=f.createRadialGradient(D.cx,D.cy,0,D.cx,D.cy,D.total);D.stop.forEach((function(e){B.addColorStop(e.offset,qu(e.color))}));var U=D.matrix;if(U)(_=(a=fl.getOffscreenCanvas(s,l)).ctx).fillStyle="#FFF",te(_,!0),_.globalCompositeOperation="source-in",_.fillStyle=B,_.setTransform(U[0],U[1],U[4],U[5],U[12],U[13]),_.fillRect(0,0,s,l);else f.fillStyle=B}else if(o.t===Ws.CONIC){D=Uu(o.stops,o.d,v,m,s-2*c,l-2*u);var z=f.createConicGradient(D.angle,D.cx+v,D.cy+m);D.stop.forEach((function(e){z.addColorStop(e.offset,qu(e.color))})),f.fillStyle=z}}h!==js.NORMAL&&(f.globalCompositeOperation=Bw(h)),a?(f.drawImage(a.canvas,0,0),a.release()):te(f,!0),h!==js.NORMAL&&(f.globalCompositeOperation="source-over")},y=0,b=G.length;y<b;y++)g(y);else for(var x=0,w=d.length;x<w;x++){if((F=d[x]).y>=l)break;for(var E=F.list,_=E.length,S=function(e){var r=E[e],n=r.textDecoration;n_(f,r,t),f.fillStyle=r.color,f.fillText(r.str,r.x*t+v,(r.y+r.baseline)*t+m),n.length&&n.forEach((function(e){if(e===vl.UNDERLINE){var n=Math.min(3*t,.05*r.lineHeight*t);f.fillRect(r.x*t+v,(r.y+r.contentArea)*t+m-.5*n,r.w*t,n)}else if(e===vl.LINE_THROUGH){var i=Math.min(3*t,.05*r.lineHeight*t);f.fillRect(r.x*t+v,(r.y+.5*r.lineHeight)*t+m-.5*i,r.w*t,i)}}))},C=0;C<_;C++)S(C)}f.globalAlpha=1,f.globalCompositeOperation="source-over";var T=ne.computedStyle,A=T.innerShadow,k=T.innerShadowEnable;if(A&&A.length){var M=!1,O=fl.getOffscreenCanvas(s,l),L=O.ctx;L.fillStyle="#FFF";var R=0;if(A.forEach((function(e,r){if(k[r]){M=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread)*t;R=Math.max(R,n+e.blur*t)}})),M){for(var I=0,P=d.length;I<P;I++){var F;if((F=d[I]).y>=l)break;for(var D=F.list,N=D.length,B=0;B<N;B++){var U=D[B];n_(L,U,t),L.fillText(U.str,U.x*t+v,(U.y+U.baseline)*t+m)}}L.globalCompositeOperation="source-out",L.fillRect(-R,-R,s+R,l+R);var z=fl.getOffscreenCanvas(s,l),X=z.ctx;A.forEach((function(e,r){k[r]&&(X.shadowOffsetX=e.x*t,X.shadowOffsetY=e.y*t,X.shadowColor=qu(e.color),X.shadowBlur=e.blur*t,X.drawImage(O.canvas,0,0))})),f.globalCompositeOperation="source-atop",f.drawImage(z.canvas,0,0),f.globalCompositeOperation="source-over",O.release(),z.release()}}1!==t?f.setLineDash(Q.map((function(e){return e*t}))):f.setLineDash(Q),$===$s.ROUND?f.lineCap="round":$===$s.SQUARE?f.lineCap="square":f.lineCap="butt",ee===el.ROUND?f.lineJoin="round":ee===el.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=1,f.fillStyle="transparent";for(var re=function(e,r){if(!V[e]||!K[e])return"continue";var n=q[e],i=Z[e];if(f.globalCompositeOperation=Bw(J[e]),Array.isArray(n))f.strokeStyle=qu(n);else if(n.t===Ws.LINEAR){var o=Nu(n.stops,n.d,v,m,s-2*c,l-2*u),a=f.createLinearGradient(o.x1,o.y1,o.x2,o.y2);o.stop.forEach((function(e){a.addColorStop(e.offset,qu(e.color))})),f.strokeStyle=a}else if(n.t===Ws.RADIAL){o=Bu(n.stops,n.d,v,m,s-2*c,l-2*u);var h=f.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.total);o.stop.forEach((function(e){h.addColorStop(e.offset,qu(e.color))}));var d=o.matrix;if(d){var p=fl.getOffscreenCanvas(s,l),g=p.ctx;return g.setLineDash(f.getLineDash()),g.lineCap=f.lineCap,g.lineJoin=f.lineJoin,g.miterLimit=f.miterLimit*t,g.lineWidth=K[e]*t,i===tl.INSIDE||i===tl.OUTSIDE?(g.fillStyle="#FFF",te(g,!0),g.lineWidth=2*K[e]*t,g.strokeStyle="#FFF",i===tl.INSIDE?g.globalCompositeOperation="source-in":g.globalCompositeOperation="source-out",te(g,!1)):(g.lineWidth=K[e]*t,g.strokeStyle="#FFF",te(g,!1)),g.globalCompositeOperation="source-in",g.setTransform(d[0],d[1],d[4],d[5],d[12],d[13]),g.fillStyle=h,g.fillRect(0,0,s,l),f.drawImage(p.canvas,0,0),p.release(),"continue"}f.strokeStyle=h}else if(n.t===Ws.CONIC){o=Uu(n.stops,n.d,v,m,s-2*c,l-2*u);var y=f.createConicGradient(o.angle,o.cx+v,o.cy+m);o.stop.forEach((function(e){y.addColorStop(e.offset,qu(e.color))})),f.strokeStyle=y}var b=void 0,x=void 0;if(i===tl.INSIDE||i===tl.OUTSIDE){(x=(b=fl.getOffscreenCanvas(s,l)).ctx).setLineDash(f.getLineDash()),x.lineCap=f.lineCap,x.lineJoin=f.lineJoin,x.miterLimit=f.miterLimit*t,x.strokeStyle=f.strokeStyle,x.lineWidth=2*K[e]*t,x.lineWidth=2*K[e]*t,x.fillStyle="#FFF",te(x,!1);var w=fl.getOffscreenCanvas(s,l),E=w.ctx;E.fillStyle="#FFF",te(E,!0),i===tl.INSIDE?x.globalCompositeOperation="destination-in":x.globalCompositeOperation="destination-out",x.drawImage(w.canvas,0,0),w.release()}else f.lineWidth=K[e]*t,te(f,!1);b&&(f.drawImage(b.canvas,v-c,m-u),b.release()),f.globalCompositeOperation="source-over"},ie=0,oe=q.length;ie<oe;ie++)re(ie)},ne=this;for(C=0,T=p.length;C<T;C++)re(C)},t.prototype.setCursorStartByAbsCoords=function(e,t){var r=this.matrixWorld,n=gc({x:e,y:t},lc(r)),i=this.lineBoxList,o=this.cursor,a=o.start;o.isMulti=!1;for(var s=i.length,l=0;l<s;l++){var c=i[l];if(n.y>=c.y&&n.y<c.y+c.lineHeight){o.startLineBox=o.endLineBox=l;var u=this.getCursorByLocalX(n.x,c,!1);o.endTextBox=o.startTextBox,o.endString=o.startString,o.end=o.start,this.tempCursorX=this.currentCursorX=u.x,o.start!==a&&(this.inputStyle=void 0);var h=gc({x:u.x,y:u.y},r);return{x:h.x,y:h.y,h:u.h*r[0]}}}var d=i[s-1];o.startLineBox=o.endLineBox=s-1;var f=this.getCursorByLocalX(this.width,d,!1);o.endTextBox=o.startTextBox,o.endString=o.startString,o.end=o.start,this.tempCursorX=this.currentCursorX=f.x,o.start!==a&&(this.inputStyle=void 0);var p=gc({x:f.x,y:f.y},r);return{x:p.x,y:p.y,h:f.h*r[0]}},t.prototype.setCursorEndByAbsCoords=function(e,t){var r=this.matrixWorld,n=gc({x:e,y:t},lc(r)),i=this.lineBoxList,o=this.cursor,a=o.end;o.isMulti=!0;for(var s=i.length,l=0;l<s;l++){var c=i[l];if(n.y>=c.y&&n.y<c.y+c.lineHeight){o.endLineBox=l;var u=this.getCursorByLocalX(n.x,c,!0);o.end!==a&&this.refresh();var h=gc({x:u.x,y:u.y},r);return{x:h.x,y:h.y,h:u.h*r[0]}}}var d=i[s-1];o.endLineBox=s-1;var f=this.getCursorByLocalX(this.width,d,!0);o.end!==a&&this.refresh(),o.end!==o.start&&(this.inputStyle=void 0);var p=gc({x:f.x,y:f.y},r);return{x:p.x,y:p.y,h:f.h*r[0]}},t.prototype.resetCursor=function(){var e=this.cursor;e.isMulti&&(e.isMulti=!1,e.start!==e.end&&(this.refresh(),e.endLineBox=e.startLineBox,e.endTextBox=e.startTextBox,e.endString=e.startString,e.end=e.start))},t.prototype.beforeEdit=function(){var e=this,t=e.style,r=e.computedStyle,n=e.parent,i=e.isDestroyed,o=e.width,a=e.height;if(i||!n)throw new Error("Can not edit a destroyed Text");var s=this.getStyle(),l=t.left,c=t.right,u=t.top,h=t.bottom,d=t.width,f=t.height,p=t.translateX,v=t.translateY,m=t.textAlign,g=t.textVerticalAlign,y=l.u!==Xs.AUTO&&c.u!==Xs.AUTO||d.u!==Xs.AUTO,b=m.v===Hs.LEFT&&!y&&(l.u!==Xs.AUTO&&p.v&&p.u===Xs.PERCENT||c.u!==Xs.AUTO),x=m.v===Hs.CENTER&&!y&&(-50!==p.v||p.u!==Xs.PERCENT),w=m.v===Hs.RIGHT&&c.u===Xs.AUTO,E=u.u!==Xs.AUTO&&h.u!==Xs.AUTO||f.u!==Xs.AUTO,_=g.v===Gs.TOP&&!E&&(u.u!==Xs.AUTO&&v.v&&v.u===Xs.PERCENT||h.u!==Xs.AUTO),S=g.v===Gs.MIDDLE&&!E&&(-50!==v.v||v.u!==Xs.PERCENT),C=g.v===Gs.BOTTOM&&!E&&h.u===Xs.AUTO,T=n.width,A=n.height,k=!1,M=0;if(p.u===Xs.PX?M=p.v:p.u===Xs.PERCENT&&(M=.01*p.v*o),b)l.u!==Xs.AUTO&&p.v&&p.u===Xs.PERCENT?(k=!0,r.left+=M,l.u===Xs.PX?l.v+=M:l.u===Xs.PERCENT&&(l.v+=100*M/T),r.right-=M,c.u===Xs.PX?c.v-=M:c.u===Xs.PERCENT&&(c.v-=100*M/T)):c.u!==Xs.AUTO&&(k=!0,r.left+=M,l.v=r.left,l.u=Xs.PX,r.right-=M,c.v=0,c.u=Xs.AUTO),p.v=0;else if(x){if(p.u===Xs.AUTO||p.u===Xs.PX){k=!0;var O=.5*o-p.v;r.left+=O,r.right-=O,l.u===Xs.PX?(l.v+=O,p.v=-50):l.u===Xs.PERCENT?(l.v+=100*O/T,p.v=-50):c.u===Xs.PX?(c.v+=O,p.v=50):c.u===Xs.PERCENT&&(c.v+=100*O/T,p.v=50),p.u=Xs.PERCENT}else if(p.u===Xs.PERCENT&&-50!==p.v){k=!0;O=.5*o-p.v*o;r.left+=O,r.right-=O,l.u===Xs.PX?(l.v+=O,p.v=-50):l.u===Xs.PERCENT?(l.v+=100*O/T,p.v=-50):c.u===Xs.PX?(c.v+=O,p.v=50):c.u===Xs.PERCENT&&(c.v+=100*O/T,p.v=50)}}else w&&(k=!0,r.left+=M,l.u!==Xs.AUTO&&(l.v=0,l.u=Xs.AUTO),r.right-=M,c.v=r.right,c.u=Xs.PX,p.v=0);var L=0;if(v.u===Xs.PX?L=v.v:v.u===Xs.PERCENT&&(L=.01*v.v*a),_)u.u!==Xs.AUTO&&v.v&&v.u===Xs.PERCENT?(k=!0,r.top+=L,u.u===Xs.PX?u.v+=L:u.u===Xs.PERCENT&&(u.v+=100*L/A),r.bottom-=L,h.u===Xs.PX?h.v-=L:h.u===Xs.PERCENT&&(h.v-=100*L/A)):h.u!==Xs.AUTO&&(k=!0,r.top+=L,u.v=r.top,u.u=Xs.PX,r.bottom-=L,h.v=0,h.u=Xs.AUTO),v.v=0;else if(S){if(v.u===Xs.AUTO||v.u===Xs.PX){k=!0;var R=.5*a-v.v;r.top+=R,r.bottom-=R,u.u===Xs.PX?(u.v+=R,v.v=-50):u.u===Xs.PERCENT?(u.v+=100*R/A,v.v=-50):h.u===Xs.PX?(h.v+=R,v.v=50):h.u===Xs.PERCENT&&(h.v+=100*R/A,v.v=50),v.u=Xs.PERCENT}else if(v.u===Xs.PERCENT&&-50!==v.v){k=!0;R=.5*a-v.v*a;r.top+=R,r.bottom-=R,u.u===Xs.PX?(u.v+=R,v.v=-50):u.u===Xs.PERCENT?(u.v+=100*R/A,v.v=-50):h.u===Xs.PX?(h.v-=R,v.v=50):h.u===Xs.PERCENT&&(h.v-=100*R/A,v.v=50),v.v=-50}}else C&&(k=!0,r.top+=L,u.u!==Xs.AUTO&&(u.v=0,u.u=Xs.AUTO),r.bottom-=L,h.v=r.bottom,h.u=Xs.PX,v.v=0);if(k)return this.editStyle={isLeft:b,isCenter:x,isRight:w,isTop:_,isMiddle:S,isBottom:C,isFixedHeight:E,prev:s}},t.prototype.afterEdit=function(){if(this.editStyle){var e=this.editStyle,t=e.isLeft,r=e.isCenter,n=e.isRight,i=e.isTop,o=e.isMiddle,a=e.isBottom;e.isFixedHeight;var s=e.prev,l=this,c=l.style,u=l.computedStyle,h=l.parent,d=l.width,f=l.height,p=s.left,v=s.right,m=s.top,g=s.bottom;s.height;var y=s.translateX,b=s.translateY,x=h,w=x.width,E=x.height,_=0;if(y.u===Xs.PX?_=y.v:y.u===Xs.PERCENT&&(_=.01*y.v*d),t){if(p.u!==Xs.AUTO&&y.v&&y.u===Xs.PERCENT){if(p.u===Xs.PX)c.left.v-=_,u.left-=_;else if(p.u===Xs.PERCENT){var S=100*_/w;c.left.v-=S,u.left-=_}if(v.u===Xs.PX)c.right.v+=_,u.right+=_;else if(v.u===Xs.PERCENT){S=100*_/w;c.right.v+=S,u.right+=_}u.translateX+=_}else v.u!==Xs.AUTO&&(c.left.v=0,c.left.u=Xs.AUTO,u.left-=_,c.right.v=v.v,c.right.u=v.u,u.right+=_);c.translateX.v=y.v}else if(r){if(y.u===Xs.AUTO||y.u===Xs.PX){var C=.5*d-y.v;p.u===Xs.PX?c.left.v-=C:p.u===Xs.PERCENT?c.left.v-=100*C/w:v.u===Xs.PX?c.right.v-=C:v.u===Xs.PERCENT&&(c.right.v-=100*C/w),c.translateX.v=y.v,c.translateX.u=y.u}else if(y.u===Xs.PERCENT&&-50!==y.v){C=.5*d-y.v*d;p.u===Xs.PX?c.left.v-=C:p.u===Xs.PERCENT&&(c.left.v-=100*C/w),v.u===Xs.PX?c.right.v-=C:v.u===Xs.PERCENT&&(c.right.v-=100*C/w),c.translateX.v=y.v}}else n&&(u.left-=_,p.u===Xs.PX?c.left.v=u.left:p.u===Xs.PERCENT&&(c.left.v=100*u.left/w),c.left.u=p.u,u.right+=_,v.u===Xs.AUTO&&(c.right.v=0,c.right.u=Xs.AUTO),c.translateX.v=y.v,c.translateX.u=y.u);var T=0;if(b.u===Xs.PX?T=b.v:b.u===Xs.PERCENT&&(T=.01*b.v*f),i){if(m.u!==Xs.AUTO&&b.v&&b.u===Xs.PERCENT){if(m.u===Xs.PX)c.top.v-=T,u.top-=T;else if(m.u===Xs.PERCENT){S=100*T/E;c.top.v-=S,u.top-=T}if(g.u===Xs.PX)c.bottom.v+=T,u.bottom+=T;else if(g.u===Xs.PERCENT){S=100*T/E;c.bottom.v+=S,u.bottom+=T}}else g.u!==Xs.AUTO&&(c.top.v=0,c.top.u=Xs.AUTO,u.top-=T,c.bottom.v=g.v,c.bottom.u=g.u,u.bottom+=T);c.translateY.v=b.v,u.translateY+=T}else if(o){if(b.u===Xs.AUTO||b.u===Xs.PX){var A=.5*f-b.v;m.u===Xs.PX?c.top.v-=A:m.u===Xs.PERCENT?c.top.v-=100*A/E:g.u===Xs.PX?c.bottom.v-=A:g.u===Xs.PERCENT&&(c.bottom.v-=100*A/E),c.translateY.v=b.v,c.translateY.u=Xs.PX}else if(b.u===Xs.PERCENT&&-50!==b.v){A=.5*f-b.v*f;m.u===Xs.PX?c.top.v-=A:m.u===Xs.PERCENT?c.top.v-=100*A/E:g.u===Xs.PX?c.bottom.v-=A:g.u===Xs.PERCENT&&(c.bottom.v-=100*A/E),c.translateY.v=b.v}}else a&&(u.top-=T,m.u===Xs.PX?c.top.v=u.top:m.u===Xs.PERCENT&&(c.top.v=100*u.top/E),u.bottom+=T,g.u===Xs.AUTO&&(c.bottom.v=0,c.bottom.u=Xs.AUTO),c.translateY.v=b.v,c.translateY.u=b.u)}},t.prototype.updateCursorByIndex=function(e){var t=this.setCursorByIndex(e,!1),r=t.lineBox,n=t.textBox,i=this.cursor,o=this.matrixWorld;if(n){var a=fl.getFontCanvas().ctx;a.font=n.font,a.letterSpacing=n.letterSpacing+"px";var s=n.str,l=a.measureText(s.slice(0,i.startString)).width;this.tempCursorX=this.currentCursorX=n.x+l}else{var c=this.computedStyle.textAlign;c===Hs.CENTER?this.tempCursorX=this.currentCursorX=.5*this.width:c===Hs.RIGHT?this.tempCursorX=this.currentCursorX=this.width:this.tempCursorX=this.currentCursorX=0}var u=gc({x:this.tempCursorX,y:r.y},o);return{x:u.x,y:u.y,h:r.lineHeight*o[0]}},t.prototype.setCursorByIndex=function(e,t){void 0===t&&(t=!1);var r=this.lineBoxList,n=this.cursor;t?n.end=e:n.start=e;for(var i=0,o=r.length;i<o;i++){var a=r[i],s=a.list;if(!s.length&&a.index===e)return n.startLineBox=i,n.startTextBox=0,n.startString=0,{lineBox:a,textBox:void 0};for(var l=0,c=s.length;l<c;l++){var u=s[l];if(e>=u.index&&(e<u.index+u.str.length||l===c-1&&a.endEnter&&e<=u.index+u.str.length))return t?(n.endLineBox=i,n.endTextBox=l,n.endString=e-u.index):(n.startLineBox=i,n.startTextBox=l,n.startString=e-u.index),{lineBox:a,textBox:u}}}var h=r.length-1,d=r[h],f=d.list;if(t?n.endLineBox=h:n.startLineBox=h,!f||!f.length)return t?(n.endTextBox=0,n.endString=0):(n.startTextBox=0,n.startString=0),{lineBox:d,textBox:void 0};var p=f.length-1,v=f[p];return t?(n.endTextBox=p,n.endString=v.str.length):(n.startTextBox=p,n.startString=v.str.length),{lineBox:d,textBox:v}},t.prototype.checkCursorMulti=function(){var e=this.cursor;return e.isMulti&&e.start===e.end&&(e.isMulti=!1),e.isMulti},t.prototype.getCursorAbsCoords=function(){var e=this.matrixWorld,t=this.lineBoxList,r=this.cursor;if(!r.isMulti){var n=t[r.startLineBox],i=n.list,o=n.lineHeight;if(!i.length){var a=this.computedStyle.textAlign,s=0;a===Hs.CENTER?s=.5*this.width:a===Hs.RIGHT&&(s=this.width);var l=gc({x:s,y:n.y},e);return{x:l.x,y:l.y,h:o*e[0]}}var c=gc({x:this.currentCursorX,y:n.y},e);return{x:c.x,y:c.y,h:o*e[0]}}},t.prototype.moveCursor=function(e,t){void 0===t&&(t=!1);var r=this.matrixWorld,n=this.cursor,i=this.getSortedCursor(),o=t?i.endLineBox:i.startLineBox,a=t?i.endTextBox:i.startTextBox,s=t?i.endString:i.startString,l=this.lineBoxList,c=l[o],u=c.list,h=u[a],d=t?i.end:i.start;if(n.isMulti&&!t){if(n.isMulti=!1,n.start!==n.end&&this.refresh(),39===e||40===e){var f=i.endLineBox,p=i.endTextBox,v=i.endString;d=(h=(u=(c=l[f]).list)[p])?h.index+v:c.index+v}return this.inputStyle=void 0,this.updateCursorByIndex(d)}if(t&&(n.isMulti=!0),37===e){if(0===d)return;0===s?0===a?(t?n.endLineBox=--o:n.startLineBox=--o,(u=(c=l[o]).list).length?(t?n.endTextBox=a=u.length-1:n.startTextBox=a=u.length-1,h=u[a],t?(n.endString=h.str.length-(c.endEnter?0:1),n.end=h.index+n.endString):(n.startString=h.str.length-(c.endEnter?0:1),n.start=h.index+n.startString)):t?(n.endTextBox=0,n.endString=0,n.end=c.index):(n.startTextBox=0,n.startString=0,n.start=c.index)):(t?n.endTextBox=--a:n.startTextBox=--a,h=u[a],t?(n.endString=h.str.length-1,n.end=h.index+n.endString):(n.startString=h.str.length-1,n.start=h.index+n.startString)):t?(n.endString=--s,n.end=h.index+n.endString):(n.startString=--s,n.start=h.index+n.startString)}else if(38===e){if(0===d)return;if(0!==o){c=l[--o],t?n.endLineBox=o:n.startLineBox=o;var m=this.getCursorByLocalX(this.tempCursorX,c,t);t&&this.refresh(),this.inputStyle=void 0;var g=gc({x:m.x,y:m.y},r);return{x:g.x,y:g.y,h:c.lineHeight*r[0]}}t?n.endTextBox=0:n.startTextBox=0,h=u[0],t?(n.endString=0,n.end=0):(n.startString=0,n.start=0)}else if(39===e){if(d===this._content.length)return;!h||a===u.length-1&&s===h.str.length&&c.endEnter?(t?(n.endLineBox=++o,n.endTextBox=0,n.endString=0):(n.startLineBox=++o,n.startTextBox=0,n.startString=0),h=(u=(c=l[o]).list)[0],t?n.end=h.index:n.start=h.index):a===u.length-1&&s===h.str.length?(t?(n.endLineBox=++o,n.endTextBox=0,n.endString=1):(n.startLineBox=++o,n.startTextBox=0,n.startString=1),h=(u=(c=l[o]).list)[0],t?n.end=h.index+1:n.start=h.index+1):s===h.str.length?(t?n.endTextBox=++a:n.startTextBox=++a,h=u[a],t?(n.endString=1,n.end=h.index+1):(n.startString=1,n.start=h.index+1),a===u.length-1&&1===h.str.length&&!c.endEnter&&o<l.length-1&&(t?n.endLineBox=++o:n.startLineBox=++o,u=(c=l[o]).list,t?n.endTextBox=a=0:n.startTextBox=a=0,h=u[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index))):s===h.str.length-1?a===u.length-1?c.endEnter||o===l.length-1?t?(n.endString++,n.end=h.index+n.endString):(n.startString++,n.start=h.index+n.startString):(t?n.endLineBox=++o:n.startLineBox=++o,u=(c=l[o]).list,t?n.endTextBox=a=0:n.startTextBox=a=0,h=u[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index)):(t?n.endTextBox=++a:n.startTextBox=++a,h=u[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index)):t?(n.endString=++s,n.end=h.index+n.endString):(n.startString=++s,n.start=h.index+n.startString)}else if(40===e){if(d===this._content.length)return;if(o!==l.length-1){c=l[++o],t?n.endLineBox=o:n.startLineBox=o;m=this.getCursorByLocalX(this.tempCursorX,c,t);t&&this.refresh(),this.inputStyle=void 0;var y=gc({x:m.x,y:m.y},r);return{x:y.x,y:y.y,h:c.lineHeight*r[0]}}t?n.endTextBox=a=u.length-1:n.startTextBox=a=u.length-1,h=u[a],t?(n.endString=h?h.str.length:0,n.end=h.index+n.endString):(n.startString=h?h.str.length:0,n.start=h.index+n.startString)}if(h){var b=fl.getFontCanvas().ctx;b.font=h.font,b.letterSpacing=h.letterSpacing+"px";var x=h.str,w=b.measureText(x.slice(0,n.startString)).width;this.tempCursorX=this.currentCursorX=h.x+w}else{var E=this.computedStyle.textAlign;E===Hs.CENTER?this.tempCursorX=this.currentCursorX=.5*this.width:E===Hs.RIGHT?this.tempCursorX=this.currentCursorX=this.width:this.tempCursorX=this.currentCursorX=0}t&&this.refresh(),this.inputStyle=void 0;var _=gc({x:this.currentCursorX,y:c.y},r);return{x:_.x,y:_.y,h:c.lineHeight*r[0]}},t.prototype.selectAll=function(){var e=this.lineBoxList,t=e.length,r=e[t-1],n=null==r?void 0:r.list,i=n?n[n.length-1]:void 0;Object.assign(this.cursor,{isMulti:!0,startLineBox:0,startTextBox:0,startString:0,start:0,endLineBox:t-1,endTextBox:n?n.length-1:0,endString:i?i.str.length:0,end:this._content.length}),this.refresh()},t.prototype.input=function(e){var t=this.getSortedCursor(),r=t.isMulti,n=t.start,i=t.end,o=this._content;if(r){var a=this.getCursorRich();this.cursor.isMulti=!1,this._content=o.slice(0,n)+o.slice(i),this.cutRich(n,i),o=this._content,this._content=o.slice(0,n)+e+o.slice(n),this.insertRich(a[0],n,e.length)}else if(this.inputStyle){a=this.getCursorRich();this._content=o.slice(0,n)+e+o.slice(n),this.insertRich(Object.assign({},a[0],this.inputStyle),n,e.length),this.inputStyle=void 0}else this._content=o.slice(0,n)+e+o.slice(n),this.expandRich(n,e.length);this.refresh(Nx.REFLOW),this.updateCursorByIndex(n+e.length)},t.prototype.enter=function(){this.inputStyle=void 0;var e=this.getSortedCursor(),t=e.isMulti,r=e.start,n=e.end;if(t){this.cursor.isMulti=!1,this.cutRich(r,n);var i=this._content;this._content=i.slice(0,r)+i.slice(n)}this.expandRich(r,1);var o=this._content;this._content=o.slice(0,r)+"\n"+o.slice(r),this.refresh(Nx.REFLOW),this.updateCursorByIndex(r+1)},t.prototype.delete=function(e){void 0===e&&(e=!1),this.inputStyle=void 0;var t=this._content;if(t){var r=this.getSortedCursor(),n=r.isMulti,i=r.start,o=r.end;i<1&&!n&&!e||i===t.length&&e||(n?(this.cursor.isMulti=!1,this._content=t.slice(0,i)+t.slice(o),this.cutRich(i,o)):e?(this._content=t.slice(0,i)+t.slice(i+1),this.cutRich(i,i+1)):(this._content=t.slice(0,i-1)+t.slice(i),this.cutRich(i-1,i)),this.refresh(Nx.REFLOW),n||e?this.updateCursorByIndex(i):this.updateCursorByIndex(i-1))}},t.prototype.getCursorByLocalX=function(e,t,r){void 0===r&&(r=!1);var n=t.list,i=this.cursor,o=0,a=t.y,s=t.lineHeight;r?i.endString=i.end=0:i.startString=i.start=0;e:for(var l=0,c=n.length;l<c;l++){var u=(_=n[l]).x,h=_.w,d=_.str,f=_.font,p=_.letterSpacing;if(!l&&e<u||e>=u&&e<u+h||l===c-1){r?i.endTextBox=l:i.startTextBox=l;var v=fl.getFontCanvas().ctx;v.font=f,v.letterSpacing=p+"px";for(var m=0,g=d.length;m<g;){if(m===g-1){var y=v.measureText(d.slice(0,m)).width,b=v.measureText(d.slice(0,g)).width;e-(u+y)>u+b-e?(o=u+b,r?(i.endString=g,i.end=_.index+g):(i.startString=g,i.start=_.index+g)):(o=u+y,r?(i.endString=m,i.end=_.index+m):(i.startString=m,i.start=_.index+m));break e}var x=m+(g-m>>1),w=v.measureText(d.slice(0,x)).width;if(e>u+w)m=x;else{if(!(e<u+w)){r?(i.endString=x,i.end=_.index+x):(i.startString=x,i.start=_.index+x),o=u+w;break e}g=x}}}}var E=r?i.endTextBox:i.startTextBox;if(E<n.length-1){var _=n[E];(r?i.endString:i.startString)===_.str.length&&(r?(i.endTextBox++,i.endString=0,i.end=n[E+1].index):(i.startTextBox++,i.startString=0,i.start=n[E+1].index))}if(!n.length){r?(i.endString=0,i.end=t.index):(i.startString=0,i.start=t.index);var S=this.computedStyle.textAlign;S===Hs.CENTER?o=.5*this.width:S===Hs.RIGHT&&(o=this.width)}return{x:o,y:a,h:s}},t.prototype.getRich=function(){return this.rich.map((function(e){return Object.assign({},e)}))},t.prototype.setRich=function(e){this.rich=e,this.refresh(Nx.REFLOW)},t.prototype.getCursor=function(){return Object.assign({},this.cursor)},t.prototype.updateRangeStyle=function(e,t,r){var n=Nx.NONE;if(0===e){var i=this.style,o=this.computedStyle;void 0!==r.fontFamily&&(i.fontFamily.v=o.fontFamily=r.fontFamily),void 0!==r.fontSize&&(i.fontSize.v=o.fontSize=r.fontSize),void 0!==r.color&&(i.color.v=o.color=Wu(r.color)),void 0!==r.letterSpacing&&(i.letterSpacing.v=o.letterSpacing=r.letterSpacing),void 0!==r.lineHeight&&(0===r.lineHeight?(i.lineHeight.v=0,i.lineHeight.u=Xs.AUTO,o.lineHeight=$u(o)):(i.lineHeight.v=o.lineHeight=r.lineHeight,i.lineHeight.u=Xs.PX)),void 0!==r.paragraphSpacing&&(i.paragraphSpacing.v=o.paragraphSpacing=r.paragraphSpacing),void 0!==r.textAlign&&(i.textAlign.v=o.textAlign=r.textAlign),void 0!==r.textDecoration&&(i.textDecoration=r.textDecoration.map((function(e){return{v:e,u:Xs.NUMBER}})),o.textDecoration=r.textDecoration.slice(0))}for(var a=this.rich,s=0,l=a.length;s<l&&!(t<1);s++){var c=a[s];if(e>=c.location&&e<c.location+c.length){if(e>c.location){var u=Z(Z({},c),{length:e-c.location});a.splice(s,0,u),s++,l++,c.location+=u.length,c.length-=u.length}var h=!1;if(e+t<c.location+c.length){var d=Z(Z({},c),{location:e+t,length:c.location+c.length-e-t});a.splice(s+1,0,d),c.length-=d.length,h=!0}if(n|=this.updateRichItem(c,r),h)break;e+=c.length,t-=c.length}}this.mergeRich(),n&&this.refresh(n)},t.prototype.updateRichItem=function(e,t){var r=Nx.NONE;if(void 0!==t.fontFamily&&t.fontFamily!==e.fontFamily&&(e.fontFamily=t.fontFamily,r|=Nx.REFLOW),void 0!==t.fontSize&&t.fontSize!==e.fontSize&&(e.fontSize=t.fontSize,r|=Nx.REFLOW),void 0!==t.color){var n=Wu(t.color);e.color[0]===n[0]&&e.color[1]===n[1]&&e.color[2]===n[2]&&e.color[3]===n[3]||(e.color=n,r|=Nx.REFLOW)}return void 0!==t.letterSpacing&&t.letterSpacing!==e.letterSpacing&&(e.letterSpacing=t.letterSpacing,r|=Nx.REFLOW),void 0!==t.lineHeight&&t.lineHeight!==e.lineHeight&&(e.lineHeight=t.lineHeight,r|=Nx.REFLOW),void 0!==t.paragraphSpacing&&t.paragraphSpacing!==e.paragraphSpacing&&(e.paragraphSpacing=t.paragraphSpacing,r|=Nx.REFLOW),void 0!==t.textAlign&&t.textAlign!==e.textAlign&&(e.textAlign=t.textAlign,r|=Nx.REFLOW),void 0!==t.textDecoration&&t.textDecoration!==e.textDecoration&&(e.textDecoration=t.textDecoration,r|=Nx.REFLOW),r},t.prototype.cutRich=function(e,t){var r=this.rich;if(r.length){for(var n=t-e,i=0,o=r.length;i<o;i++){var a=r[i];if(a.location<=e&&a.location+a.length>e){if(a.location+a.length>=t){a.length-=n;for(var s=i+1;s<o;s++)r[s].location-=n;a.length||r.splice(i,1)}else{a.length=e-a.location;for(var l=i+1,c=r.length;l<c;l++){var u=r[l];if(u.location<=t&&(u.location+u.length>t||l===c-1)){u.length-=t-u.location,u.location-=n;s=l+1;for(var h=r.length;s<h;s++)r[s].location-=n;i<l-1&&r.splice(i+1,l-i-1),u.length||r.splice(l,1);break}}a.length||r.splice(i,1)}break}}this.mergeRich()}},t.prototype.expandRich=function(e,t){var r=this.rich,n=this._content;if(r.length){e=Math.max(0,e);for(var i=0,o=r.length;i<o;i++){var a=r[i];if(a.location<=e&&a.location+a.length>=e){if(e===a.location+a.length&&"\n"===n.charAt(e-1))continue;a.length+=t;for(var s=i+1;s<o;s++)r[s].location+=t;return}}r[r.length-1].length+=t}else{var l=this.computedStyle;r.push({location:e,length:t,fontFamily:l.fontFamily,fontSize:l.fontSize,fontWeight:400,fontStyle:"normal",letterSpacing:l.letterSpacing,textAlign:[Hs.LEFT,Hs.RIGHT,Hs.CENTER,Hs.JUSTIFY][l.textAlign],textDecoration:l.textDecoration,lineHeight:l.lineHeight,paragraphSpacing:l.paragraphSpacing,color:l.color})}},t.prototype.insertRich=function(e,t,r){var n=this.computedStyle,i=Object.assign({location:t,length:r,fontFamily:n.fontFamily,fontSize:n.fontSize,fontWeight:400,fontStyle:"normal",letterSpacing:n.letterSpacing,textAlign:n.textAlign,textDecoration:n.textDecoration,lineHeight:n.lineHeight,paragraphSpacing:n.paragraphSpacing,color:n.color},e);i.color=Wu(i.color),i.location=t,i.length=r;var o=this.rich;if(o.length){for(var a=0,s=o.length;a<s;a++){var l=o[a];if(l.location<=t&&l.location+l.length>=t){for(var c=a+1;c<s;c++)o[c].location+=r;if(l.location===t)o.splice(a,0,i),l.location+=r;else if(l.location+l.length===t)o.splice(a+1,0,i);else if(l.location+l.length>t){var u=Ps(l);l.length=t-l.location,u.location=t+r,u.length-=l.length,o.splice(a+1,0,i),o.splice(a+2,0,u)}return void this.mergeRich()}}o.push(i),this.mergeRich()}else o.push(i)},t.prototype.mergeRich=function(){var e=this,t=e.rich,r=e._content,n=e.style;if(t.length){this.rich=t=t.filter((function(e){return e.location>-1&&e.length>0})),t.sort((function(e,t){return e.location===t.location?e.length-t.length:e.location-t.location}));var i=!1,o={fontFamily:n.fontFamily.v,fontSize:n.fontSize.v,fontWeight:400,fontStyle:"normal",letterSpacing:n.letterSpacing.v,textAlign:n.textAlign.v,textDecoration:n.textDecoration.map((function(e){return e.v})),lineHeight:n.lineHeight.v,paragraphSpacing:n.paragraphSpacing.v,color:n.color.v.slice(0)};if(r.length){var a=t[t.length-1];(!t.length||a.location+a.length<r.length)&&(t.push(Z({location:a?a.location+a.length:0,length:a?r.length-a.location-a.length:r.length},o)),i=!0),(a=t[t.length-1]).location+a.length>r.length&&(a.length=r.length-a.location,i=!0);var s=t[0];s.location>0&&(t.unshift(Z({location:0,length:s.location},o)),i=!0)}for(var l=t.length-2;l>=0;l--){var c=t[l],u=t[l+1];if(u.length)if(c.length){var h=c.location+c.length;if(h===u.location)Fs(c,u,["color","fontFamily","fontSize","letterSpacing","lineHeight","textDecoration","paragraphSpacing"])?c.textAlign!==u.textAlign&&"\n"===r.charAt(u.location-1)||(c.length+=u.length,t.splice(l+1,1),i=!0):1===u.length&&"\n"===r.charAt(u.location)&&(c.length+=u.length,t.splice(l+1,1),i=!0);else{if(h<u.location)t.splice(l+1,0,Z({location:h,length:u.location-h},o)),l+=2;else{var d=c.location+c.length-u.location;u.location-=d,u.length-=d,l++}i=!0}}else t.splice(l,1),l++;else t.splice(l+1,1)}return i}},t.prototype.setInputStyle=function(e){this.inputStyle=e?Z(Z({},this.inputStyle),e):void 0},t.prototype.getSortedCursor=function(){var e,t=this.cursor,r=t.isMulti,n=t.startLineBox,i=t.startTextBox,o=t.startString,a=t.endLineBox,s=t.endTextBox,l=t.endString,c=t.start,u=t.end,h=!1;return r?c>u&&(n=(e=[a,s,l,u,n,i,o,c])[0],i=e[1],o=e[2],c=e[3],a=e[4],s=e[5],l=e[6],u=e[7],h=!0):(a=n,s=i,l=o,u=c),{isMulti:r,startLineBox:n,startTextBox:i,startString:o,endLineBox:a,endTextBox:s,endString:l,start:c,end:u,isReversed:h}},t.prototype.getCursorRich=function(){var e=this.rich,t=this.lineBoxList,r=[];if(!e.length)return r;function n(t,r,n){for(void 0===r&&(r=0),void 0===n&&(n=e.length-1);r<n;){var i=Math.floor(.5*(r+n)),o=e[i];if(o.location<t&&o.location+o.length>=t)return o;o.location>=t?n=Math.min(i,n-1):r=Math.max(i,r+1)}return e[r]}var i=this.getSortedCursor(),o=i.isMulti,a=i.startLineBox,s=i.startTextBox,l=i.startString,c=i.start,u=i.end;if(o)for(var h=0,d=e.length;h<d;h++){if((f=e[h]).location>=u)break;f.location+f.length>c&&r.push(f)}if(!o||!r.length){var f,p=t[a],v=p.list;if(v.length)(f=n(v[s].index+(s+l===0?1:l)))&&-1===r.indexOf(f)&&r.push(f);else(f=n(p.index))&&-1===r.indexOf(f)&&r.push(f)}return r},t.prototype.clone=function(e){var r=this,n=Ps(this.props),i=n.uuid;e&&e.hasOwnProperty(i)&&e[i].forEach((function(e){var t=e.key,n=e.value;"content"===t[0]&&(r._content=n)})),n.uuid=s(),n.sourceUuid=this.props.uuid,this.rich&&(n.rich=this.rich.map((function(e){return Z(Z({},e),{textAlign:["left","right","center","justify"][e.textAlign]||"left",textDecoration:e.textDecoration.map((function(e){return["none","underline","lineThrough"][e]||"none"})),color:qu(e.color)})}))),n.content=this._content;var o=new t(n);return o.style=Ps(this.style),o.computedStyle=Ps(this.computedStyle),n.textBehaviour===il.AUTO?(o.style.width={v:this.width,u:Xs.PX},o.style.height={v:this.height,u:Xs.PX}):n.textBehaviour===il.FIXED_W&&(o.style.height={v:this.height,u:Xs.PX}),o},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.TEXT,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u,h,d,f;return Q(this,(function(p){switch(p.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=p.sent())._class=ee.ClassValue.Text,n=this.rich.length?this.rich:this._content?[{location:0,length:this._content.length,fontFamily:this.computedStyle.fontFamily,fontSize:this.computedStyle.fontSize,fontWeight:this.computedStyle.fontWeight,letterSpacing:this.computedStyle.letterSpacing,textAlign:this.computedStyle.textAlign,textDecoration:this.computedStyle.textDecoration,lineHeight:this.style.lineHeight.u===Xs.AUTO?0:this.computedStyle.lineHeight,paragraphSpacing:this.computedStyle.paragraphSpacing,color:this.computedStyle.color}]:[],r.attributedString={_class:"attributedString",string:this._content,attributes:n.map((function(e){return{_class:"stringAttribute",location:e.location,length:e.length,attributes:{kerning:e.letterSpacing,MSAttributedStringFontAttribute:{_class:"fontDescriptor",attributes:{name:e.fontFamily,size:e.fontSize}},MSAttributedStringColorAttribute:{_class:"color",alpha:e.color[3],red:e.color[0]/255,green:e.color[1]/255,blue:e.color[2]/255},paragraphStyle:{_class:"paragraphStyle",alignment:[ee.TextHorizontalAlignment.Left,ee.TextHorizontalAlignment.Right,ee.TextHorizontalAlignment.Centered,ee.TextHorizontalAlignment.Justified][e.textAlign||0],minimumLineHeight:e.lineHeight,maximumLineHeight:e.lineHeight,paragraphSpacing:e.paragraphSpacing},underlineStyle:e.textDecoration.indexOf(vl.UNDERLINE)>-1?ee.UnderlineStyle.Underlined:ee.UnderlineStyle.None,strikethroughStyle:e.textDecoration.indexOf(vl.LINE_THROUGH)>-1?ee.StrikethroughStyle.Strikethrough:ee.StrikethroughStyle.None}}}))},i=this.style,o=i.left,a=i.right,s=i.top,l=i.bottom,c=i.width,u=i.height,h=c.u===Xs.AUTO&&(o.u===Xs.AUTO||a.u===Xs.AUTO),d=u.u===Xs.AUTO&&(s.u===Xs.AUTO||l.u===Xs.AUTO),r.textBehaviour=h&&d||h?ee.TextBehaviour.Flexible:d?ee.TextBehaviour.Fixed:ee.TextBehaviour.FixedWidthAndHeight,f=this.computedStyle,r.style.textStyle={_class:"textStyle",verticalAlignment:[ee.TextVerticalAlignment.Top,ee.TextVerticalAlignment.Middle,ee.TextVerticalAlignment.Bottom][f.textVerticalAlign],encodedAttributes:{paragraphStyle:{_class:"paragraphStyle",alignment:[ee.TextHorizontalAlignment.Left,ee.TextHorizontalAlignment.Right,ee.TextHorizontalAlignment.Centered,ee.TextHorizontalAlignment.Justified,ee.TextHorizontalAlignment.Natural][f.textAlign]},underlineStyle:f.textDecoration.includes(vl.UNDERLINE)?ee.UnderlineStyle.Underlined:ee.UnderlineStyle.None,strikethroughStyle:f.textDecoration.includes(vl.LINE_THROUGH)?ee.StrikethroughStyle.Strikethrough:ee.StrikethroughStyle.None,kerning:f.letterSpacing,MSAttributedStringFontAttribute:{_class:"fontDescriptor",attributes:{name:f.fontFamily,size:f.fontSize}}}},[2,r]}}))}))},Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){e!==this._content&&(this._content=e,this.refresh(Nx.REFLOW))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.lineBoxList.forEach((function(t){t.list.forEach((function(t){var r=t.fontFamily,n=t.fontSize,i=t.lineHeight,o=t.str,a=t.font,s=i;if(jl.hasRegister(r)){s=jl.data[r].lhr*n}else{var l=fl.getFontCanvas().ctx;l.font=a;var c=l.measureText(o);s=c.actualBoundingBoxAscent+c.actualBoundingBoxDescent}var u=s-i;if(u>0){var h=.5*u,d=t.y-h,f=t.lineHeight+h;d<0&&(e[1]=Math.min(e[1],d)),e[3]=Math.max(e[3],f)}}))}));var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===tl.INSIDE||(a=o[t]===tl.OUTSIDE?Math.max(a,2*e):Math.max(a,.5*e*2)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),t.setFontAndLetterSpacing=n_,t}(Iw);function n_(e,t,r){1!==r?(e.font=t.font.replace(/([\d.e+-]+)px/gi,(function(e,t){return t*r+"px"})),e.letterSpacing=t.letterSpacing*r+"px"):(e.font=t.font,e.letterSpacing=t.letterSpacing+"px")}function i_(e,t,r,n,i,o,a,s,l){for(var c,u,h,d,f,p,v,m,g=t.structs,y=t.width,b=t.height,x=[],w=[],E=0,_=g.length;E<_;E++){var S=g[E],C=S.node,T=S.lv,A=S.total,k=S.next,M=C.refreshLevel,O=C.computedStyle;C.refreshLevel=Nx.NONE;var L=C.textureTotal,R=C.textureFilter,I=C.textureMask;M&&(M<Nx.REPAINT||C.calContent());var P=O.maskMode,F=O.opacity,D=O.shadow,N=O.shadowEnable,B=O.innerShadow,U=O.innerShadowEnable,z=O.blur,X=O.mixBlendMode,H=O.fill,G=O.fillEnable,j=O.hueRotate,Y=O.saturate,W=O.brightness,q=O.contrast,V=!1;C.isGroup&&G[0]&&H[0]&&Array.isArray(H[0])&&(V=!0);for(var K=(F>0&&F<1||X!==js.NORMAL||V)&&A>0&&!C.isShapeGroup&&(!L[n]||!L[n].available),Z=!1,J=0,Q=D.length;J<Q;J++)if(N[J]&&D[J].color[3]>0){Z=!0;break}for(var $=0,ee=B.length;$<ee;$++)if(U[$]&&B[$].color[3]>0){Z=!0;break}Z&&(null===(c=R[n])||void 0===c?void 0:c.available)&&(Z=!1);var te=(z.t===qs.GAUSSIAN&&z.radius>=1||z.t===qs.BACKGROUND&&(z.radius>=1||1!==z.saturation)&&A||z.t===qs.RADIAL&&z.radius>=1||z.t===qs.MOTION&&z.radius>=1)&&(!R[n]||!(null===(u=R[n])||void 0===u?void 0:u.available)),re=P>0&&(!I[n]||!(null===(h=I[n])||void 0===h?void 0:h.available));if(re&&(P!==Qs.ALPHA||0!==O.opacity&&C.next&&!C.next.computedStyle.breakMask?P!==Qs.OUTLINE||0!==O.opacity&&C.next&&!C.next.computedStyle.breakMask||(re=!1,O.visibility===nl.HIDDEN||0===O.opacity?C.textureTarget[n]=void 0:C.resetTextureTarget()):(re=!1,C.textureTarget[n]=void 0)),K||Z||te||re||(j||1!==Y||1!==W||1!==q)){var ne={i:E,lv:T,total:A,node:C,valid:!1,subList:[],isNew:!1,isTop:!0};x.push(ne),w[E]=ne}(C instanceof LS||(null===(d=L[n])||void 0===d?void 0:d.available))&&(E+=A),(null===(f=I[n])||void 0===f?void 0:f.available)&&(E+=k)}x.length&&x.sort((function(e,t){return e.lv===t.lv?t.i-e.i:t.lv-e.lv}));var ie=0;for(_=x.length;ie<_;ie++){E=(ae=x[ie]).i,A=ae.total,C=ae.node;var oe=ae.isNew=!C.tempBbox;C.tempBbox=o_(g,C,E,A,oe,n,ae,w)}for(ie=0,_=x.length;ie<_;ie++){C=(ae=x[ie]).node;var ae,se=ae.isTop;E=ae.i,T=ae.lv,A=ae.total;if(se&&s_(C.tempBbox,C.matrixWorld,i,o,a-i,s-o)&&(S_(ae),C.computedStyle.maskMode!==Qs.NONE)){l_(C,g,E,T,A);for(var le=ie;le>=0;le--){var ce=x[le];if(ce.i>E+A+C.struct.next)break;S_(ce)}}}var ue,he=!0,de=[];for(ie=0,_=x.length;ie<_;ie++){var fe=x[ie],pe=(E=fe.i,T=fe.lv,A=fe.total,C=fe.node,fe.valid),ve=(oe=fe.isNew,C.computedStyle),me=(P=ve.maskMode,ve.visibility);F=ve.opacity;if(pe){if(!(me===nl.HIDDEN||F<=0)||P){if(!he&&Date.now()-l>bs.deltaTime){ue=x.slice(ie);break}var ge=void 0;if(!(null===(p=C.textureTotal[n])||void 0===p?void 0:p.available))(ne=c_(e,t,C,g,E,A,y,b,r,n))&&(C.textureTotal[n]=C.textureTarget[n]=ne,ge=ne,he=!1);if(C.textureTarget[n]&&!(null===(v=C.textureFilter[n])||void 0===v?void 0:v.available))(ne=d_(e,t,C,y,b,r,n))&&(C.textureFilter[n]=C.textureTarget[n]=ne,ge=ne,he=!1);if(P&&C.textureTarget[n]&&!(null===(m=C.textureMask[n])||void 0===m?void 0:m.available)&&C.next)(ne=b_(e,t,C,P,g,E,T,A,y,b,r,n))&&(C.textureMask[n]=C.textureTarget[n]=ne,ge=ne,he=!1);ge&&!t.firstDraw&&de.push({bbox:ge.bbox,m:C._matrixWorld||C.matrixWorld})}}else oe&&P&&l_(C,g,E,T,A)}return ue&&ue.length&&(t.breakMerge=!0),{mergeRecord:de,breakMerge:ue}}function o_(e,t,r,n,i,o,a,s){var l=(t.tempBbox||t._rect||t.rect).slice(0);sc(t.tempMatrix);for(var c=r+1,u=r+n+1;c<u;c++){var h=e[c],d=h.node,f=h.total,p=h.next,v=d.textureTarget[o];if(i){var m=ac(d.parent.tempMatrix,d.matrix);cc(d.tempMatrix,m);var g=v&&v!==d.textureCache[o]?v.bbox:d._filterBbox2||d.filterBbox2;g[2]-g[0]&&g[3]-g[1]&&Xw(l,g,m)}v&&v.available&&v!==d.textureCache[o]?c+=f+p:d.isShapeGroup&&(c+=f);var y=s[c];y&&(y.isTop=!1,a.subList.push(y))}return l}function a_(e,t,r,n){return s_(e,t,0,0,r,n)}function s_(e,t,r,n,i,o){var a,s,l=bc(e[0],e[1],e[2],e[3],t),c=l.x1,u=l.y1,h=l.x2,d=l.y2,f=l.x3,p=l.y3,v=l.x4,m=l.y4;return c===v&&u===d&&h===f&&p===m?(c>h&&(c=(a=[f,c])[0],f=a[1]),d>p&&(u=(s=[p,u])[0],p=s[1]),Ac(r,n,r+i,n+o,c,u,f,p,!1)):kc(r,n,r+i,n+o,[{x:c,y:u},{x:h,y:d},{x:f,y:p},{x:v,y:m}],!1)}function l_(e,t,r,n,i){for(var o=r+i+1,a=t.length;o<a;o++){var s=t[o],l=s.node,c=s.lv,u=l.computedStyle;if(n>c){e.struct.next=o-r-i-1;break}if(o===a||u.breakMask&&n===c){e.struct.next=o-r-i-1;break}}}function c_(e,t,r,n,i,o,a,s,l,c,u){var h;if(void 0===u&&(u=!1),null===(h=r.textureTotal[c])||void 0===h?void 0:h.available){if(!u)return r.textureTotal[c];if(r.textureTotal[c]!==r.textureCache[c])return r.textureTotal[c]}var d=r.tempBbox;if(r.tempBbox=void 0,d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3]),(!o||r.isShapeGroup)&&!u){var f=r.textureCache[c];return f&&f.available||!r.hasContent||(r.genTexture(e,l,c),f=r.textureCache[c]),f}for(var p,v=t.programs,m=v.program,g=d[0],y=d[1],b=g*l,x=y*l,w=Math.ceil(d[2]-g),E=Math.ceil(d[3]-y),_=w*l,S=E*l,C=Rw.getEmptyInstance(e,d),T=C.list,A=bs.maxTextureSize,k=[],M=0,O=Math.ceil(S/A);M<O;M++)for(var L=0,R=Math.ceil(_/A);L<R;L++){var I=L===R-1?_-L*A:A,P=M===O-1?S-M*A:A,F=g+L*A/l,D=y+M*A/l,N=new Float64Array([F,D,F+I/l,D+P/l]),B=b+L*A,U=x+M*A;k.push({x:B,y:U,w:I,h:P,bbox:N})}for(M=i,O=i+o+1;M<O;M++){var z=n[M],X=z.node,H=z.total,G=z.next,j=X.computedStyle,Y=__(X,j,c),W=Y.shouldIgnore,q=Y.isBgBlur;if(W)M+=H+G;else{X.isBitmap&&X.checkLoader()&&t.imgLoadList.push(X);var V=void 0,K=void 0;if(M===i)V=X.tempOpacity=1,sc(X.tempMatrix),K=mc(X.tempMatrix,l);else{var Z=X.parent;V=X.tempOpacity=j.opacity*Z.tempOpacity,K=ac(Z.tempMatrix,X.matrix)}cc(X.tempMatrix,K);var J=X.textureTarget[c];if(!J&&X.hasContent&&(X.genTexture(e,l,c),J=X.textureTarget[c]),J&&J.available){var Q=j.mixBlendMode,$=j.blur;if(q&&M>i){var ee=X.textureOutline[l]=E_(e,X,n,M,H,J.bbox,l);cc(X.tempMatrix,K),T.splice(0),k.forEach((function(e){if(e.t){var t={bbox:e.bbox,w:e.w,h:e.h,t:e.t};e.ref=t,T.push(t)}})),w_(e,t,C,K,ee,$,v,l,w,E),k.forEach((function(e){e.ref&&(e.t=e.ref.t,e.ref=void 0)})),T.splice(0),p&&e.bindFramebuffer(e.FRAMEBUFFER,p)}for(var te=J.list,re=(L=0,k.length);L<re;L++)for(var ne=k[L],ie=ne.x,oe=ne.y,ae=ne.w,se=ne.h,le=ne.t,ce=.5*ae,ue=.5*se,he=0,de=te.length;he<de;he++){var fe=te[he],pe=fe.bbox,ve=fe.t;if(ve&&s_(pe,K,ie,oe,ae,se)){le||(le=ne.t=ew(e,0,void 0,ae,se)),p?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,le,0),e.viewport(0,0,ae,se)):p=u_(e,le,ae,se);var me=void 0;Q!==js.NORMAL&&M>i&&(me=ew(e,0,void 0,ae,se),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,me,0)),rw(e,ce,ue,m,[{opacity:V,matrix:K,bbox:pe,texture:ve}],-ne.x,-ne.y,!1,-1,-1,1,1),Q!==js.NORMAL&&me&&(le=ne.t=x_(e,le,me,Q,v,ae,se))}}}J&&J.available&&J!==X.textureCache[c]||j.maskMode&&M!==i?M+=H+G:X.isShapeGroup&&(M+=H)}}return p&&h_(e,p,a,s),k.forEach((function(e){T.push({bbox:e.bbox,w:e.w,h:e.h,t:e.t})})),C}function u_(e,t,r,n){var i=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,i),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.viewport(0,0,r,n),i}function h_(e,t,r,n){e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(t),e.viewport(0,0,r,n)}function d_(e,t,r,n,i,o,a){var s,l;if(null===(s=r.textureFilter[a])||void 0===s?void 0:s.available)return r.textureFilter[a];var c=r.computedStyle,u=c.shadow,h=c.shadowEnable,d=c.blur,f=c.fill,p=c.fillEnable,v=c.fillOpacity,m=c.hueRotate,g=c.saturate,y=c.brightness,b=c.contrast,x=r.textureTarget[a];r.isGroup&&p[0]&&f[0]&&Array.isArray(f[0])&&(l=function(e,t,r,n,i,o,a){var s=r.bbox,l=r.list,c=t.programs,u=c.tintProgram;e.useProgram(u);for(var h,d=Rw.getEmptyInstance(e,s),f=d.list,p=0,v=l.length;p<v;p++){var m=l[p],g=m.bbox,y=m.w,b=m.h,x=m.t,w=ew(e,0,void 0,y,b);h?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,w,0),e.viewport(0,0,y,b)):h=u_(e,w,y,b),x&&hw(e,u,x,n,i),f.push({bbox:g.slice(0),w:y,h:b,t:w})}return e.useProgram(c.program),h_(e,h,o,a),d}(e,t,x,f[0],v[0],n,i));var w=[];if(u.forEach((function(e,t){h[t]&&e.color[3]>0&&w.push(e)})),w.length){var E=function(e,t,r,n,i,o,a){for(var s=r.bbox,l=s.slice(0),c=[0,0,0,0],u=[],h=[],d=0,f=n.length;d<f;d++){var p=Mw(kw(.5*(Re=n[d]).blur));if(h.push(p),Re.x||Re.y||p){var v=Re.x-p,m=Re.y-p,g=Re.x+p,y=Re.y+p;u.push([v,m,g+(s[2]-s[0]),y+(s[3]-s[1])]),c[0]=Math.min(c[0],v),c[1]=Math.min(c[1],m),c[2]=Math.max(c[2],g),c[3]=Math.max(c[3],y)}}if(!u.length)return;l[0]+=c[0],l[1]+=c[1],l[2]+=c[2],l[3]+=c[3];var b,x,w=l[0],E=l[1],_=l[2]-l[0],S=l[3]-l[1],C=_*a,T=S*a,A=t.programs,k=A.program,M=A.dropShadowProgram,O=Rw.getEmptyInstance(e,l),L=O.list,R=bs.maxTextureSize;for(d=0,f=Math.ceil(T/R);d<f;d++)for(var I=0,P=Math.ceil(C/R);I<P;I++){for(var F=I===P-1?C-I*R:R,D=d===f-1?T-d*R:R,N=w+I*R/a,B=E+d*R/a,U=F/a,z=D/a,X=!0,H=0,G=u.length;H<G;H++){var j=u[H];if(Ac(s[0],s[1],s[2],s[3],N,B,N+U,B+z)||Ac(j[0],j[1],j[2],j[3],N,B,N+U,B+z)){X=!1;break}}if(!X){var Y=new Float64Array([N,B,N+U,B+z]),W=ew(e,0,void 0,F,D);L.push({bbox:Y,w:F,h:D,t:W})}}1!==a&&mc(b=ic(),a);for(d=0,f=n.length;d<f;d++){p=h[d];var q=n[d],V=q.x,K=q.y,Z=q.blur,J=q.color,Q=s.slice(0);Q[0]-=p,Q[1]-=p,Q[2]+=p,Q[3]+=p;var $=Q[0],ee=Q[1],te=Q[2]-Q[0],re=Q[3]-Q[1],ne=te*a,ie=re*a,oe=Rw.getEmptyInstance(e,Q),ae=oe.list,se=f_(e,k,r,oe,$,ee,a,ne,ie),le=Rw.getEmptyInstance(e,Q),ce=le.list;e.useProgram(M);for(var ue=0,he=ae.length;ue<he;ue++){var de=ae[ue],fe=(Y=de.bbox,de.w),pe=de.h;W=de.t;e.viewport(0,0,fe,pe);var ve=Y.slice(0);ve[0]+=V,ve[1]+=K,ve[2]+=V,ve[3]+=K;var me=ew(e,0,void 0,fe,pe);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,me,0),W&&cw(e,M,W,Zu(J)),ce.push({bbox:ve,w:fe,h:pe,t:me})}if(oe.release(),Z){var ge=.5*Z,ye=ge*a,be=Mw(kw(ge)),xe=Ow(.5*ye),we=A.boxProgram;e.useProgram(we);for(var Ee=Rw.getEmptyInstance(e,Q),_e=Ee.list,Se=0,Ce=ce.length;Se<Ce;Se++){var Te=ce[Se],Ae=(Y=Te.bbox,Te.w),ke=Te.h;W=Te.t;e.viewport(0,0,Ae,ke);me=W&&ow(e,we,W,Ae,ke,xe);_e.push({bbox:Y.slice(0),w:Ae,h:ke,t:me})}if(ce.length>1){for(var Me=p_(e,Ee,$,ee,te,re,a,be),Oe=0,Le=Me.length;Oe<Le;Oe++){Y=(Re=Me[Oe]).bbox;var Re,Ie=Re.w,Pe=Re.h;W=Re.t;e.useProgram(k),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W,0),e.viewport(0,0,Ie,Pe);for(var Fe=.5*Ie,De=.5*Pe,Ne=!1,Be=(I=0,ce.length);I<Be;I++){var Ue=ce[I],ze=Ue.bbox,Xe=Ue.w,He=Ue.h;(nt=Ue.t)&&s_(Y,void 0,ze[0],ze[1],Xe,He)&&(rw(e,Fe,De,k,[{opacity:1,bbox:ze,texture:nt}],-Y[0],-Y[1],!1,-1,-1,1,1),Ne=!0)}Ne&&(e.useProgram(we),Re.t=ow(e,we,W,Ie,Pe,xe)),e.deleteTexture(W)}v_(e,k,a,le,Me,Q,be)}le.release(),ce=(le=Ee).list}e.useProgram(k);for(var Ge=0,je=L.length;Ge<je;Ge++){var Ye=L[Ge],We=(Y=Ye.bbox,Ye.w),qe=Ye.h;W=Ye.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W,0),e.viewport(0,0,We,qe);Fe=.5*We,De=.5*qe,I=0;for(var Ve=ce.length;I<Ve;I++){var Ke=ce[I],Ze=(ze=Ke.bbox,Ke.w),Je=Ke.h;(nt=Ke.t)&&s_(Y,void 0,ze[0],ze[1],Ze,Je)&&rw(e,Fe,De,k,[{opacity:1,matrix:b,bbox:ze,texture:nt}],-Y[0]*a,-Y[1]*a,!1,-1,-1,1,1)}}le.release(),se&&h_(e,se,i,o)}var Qe=r.list;for(d=0,f=L.length;d<f;d++){var $e=L[d],et=(Y=$e.bbox,$e.w),tt=$e.h;W=$e.t;x?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W,0),e.viewport(0,0,et,tt)):x=u_(e,W,et,tt);Fe=.5*et,De=.5*tt,I=0;for(var rt=Qe.length;I<rt;I++){var nt,it=Qe[I],ot=(ze=it.bbox,it.w),at=it.h;(nt=it.t)&&s_(Y,void 0,ze[0],ze[1],ot,at)&&rw(e,Fe,De,k,[{opacity:1,matrix:b,bbox:ze,texture:nt}],-Y[0]*a,-Y[1]*a,!1,-1,-1,1,1)}}x&&h_(e,x,i,o);return O}(e,t,l||x,w,n,i,o);l&&l.release(),l=E}if(d.t===qs.GAUSSIAN&&d.radius>=1){E=m_(e,t,l||x,d.radius,n,i,o);l&&l.release(),l=E}else if(d.t===qs.RADIAL&&d.radius>=1){E=function(e,t,r,n,i,o,a,s){var l=r.bbox,c=Mw(kw(n)),u=l.slice(0),h=u[2]-u[0],d=u[3]-u[1],f=i[0]*h,p=i[1]*d,v=Math.sqrt(h*h+d*d),m=2*c/v,g=Math.ceil(m*f),y=Math.ceil(m*(h-f)),b=Math.ceil(m*p),x=Math.ceil(m*(d-p));u[0]-=g,u[1]-=b,u[2]+=y,u[3]+=x;var w=u[0],E=u[1],_=u[2]-u[0],S=u[3]-u[1],C=_*s,T=S*s,A=t.programs,k=A.program,M=Rw.getEmptyInstance(e,u),O=M.list,L=f_(e,k,r,M,w,E,s,C,T),R=A.radialProgram;e.useProgram(R);for(var I=Rw.getEmptyInstance(e,u),P=I.list,F=f+g,D=p+b,N=0,B=O.length;N<B;N++){var U=O[N],z=U.bbox,X=U.w,H=U.h,G=U.t;e.viewport(0,0,X,H);var j=z[2]-z[0],Y=z[3]-z[1],W=[(F-z[0]+u[0])/j,(D-z[1]+u[1])/Y],q=G&&lw(e,R,G,m,c*s,W,X,H);P.push({bbox:z.slice(0),w:X,h:H,t:q})}if(O.length>1){var V=p_(e,I,w,E,_,S,s,c);for(N=0,B=V.length;N<B;N++){var K=V[N],Z=(z=K.bbox,K.w),J=K.h;G=K.t;e.useProgram(k),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,G,0),e.viewport(0,0,Z,J);W=[(F-z[0]+u[0])/(z[2]-z[0]),(D-z[1]+u[0])/(z[3]-z[1])];for(var Q=.5*Z,$=.5*J,ee=!1,te=0,re=O.length;te<re;te++){var ne=O[te],ie=ne.bbox,oe=ne.t,ae=ie[2]-ie[0],se=ie[3]-ie[1];oe&&s_(z,void 0,ie[0],ie[1],ae,se)&&(rw(e,Q,$,k,[{opacity:1,bbox:new Float64Array([ie[0]*s,ie[1]*s,ie[2]*s,ie[3]*s]),texture:oe}],-z[0]*s,-z[1]*s,!1,-1,-1,1,1),ee=!0)}ee&&(e.useProgram(R),K.t=lw(e,R,G,m,c*s,W,Z,J)),e.deleteTexture(G)}v_(e,k,s,I,V,u,c)}return M.release(),e.useProgram(k),h_(e,L,o,a),I}(e,t,l||x,d.radius,d.center,n,i,o);l&&l.release(),l=E}else if(d.t===qs.MOTION&&d.radius>=1){E=function(e,t,r,n,i,o,a,s){var l=wc(i),c=Mw(kw(n)),u=r.bbox.slice(0),h=Math.sin(l),d=Math.cos(l),f=Math.abs(Math.ceil(h*c)),p=Math.abs(Math.ceil(d*c));u[0]-=p,u[1]-=f,u[2]+=p,u[3]+=f;var v=u[0],m=u[1],g=u[2]-u[0],y=u[3]-u[1],b=g*s,x=y*s,w=t.programs,E=w.program,_=Rw.getEmptyInstance(e,u),S=_.list,C=f_(e,E,r,_,v,m,s,b,x),T=n*s,A=kw(T),k=w.motionProgram;e.useProgram(k);for(var M=Rw.getEmptyInstance(e,u),O=M.list,L=0,R=S.length;L<R;L++){var I=S[L],P=I.bbox,F=I.w,D=I.h,N=I.t;e.viewport(0,0,F,D);var B=N&&sw(e,k,N,A,l,F,D);O.push({bbox:P.slice(0),w:F,h:D,t:B})}if(S.length>1){var U=p_(e,M,v,m,g,y,s,c);for(L=0,R=U.length;L<R;L++){var z=U[L],X=(P=z.bbox,z.w),H=z.h;N=z.t;e.useProgram(E),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,N,0),e.viewport(0,0,X,H);for(var G=.5*X,j=.5*H,Y=!1,W=0,q=S.length;W<q;W++){var V=S[W],K=V.bbox,Z=V.t,J=K[2]-K[0],Q=K[3]-K[1];Z&&s_(P,void 0,K[0],K[1],J,Q)&&(rw(e,G,j,E,[{opacity:1,bbox:new Float64Array([K[0]*s,K[1]*s,K[2]*s,K[3]*s]),texture:Z}],-P[0]*s,-P[1]*s,!1,-1,-1,1,1),Y=!0)}Y&&(e.useProgram(k),z.t=sw(e,k,N,A,l,X,H)),e.deleteTexture(N)}v_(e,E,s,M,U,u,c)}return _.release(),e.useProgram(E),h_(e,C,o,a),M}(e,t,l||x,d.radius,d.angle,n,i,o);l&&l.release(),l=E}if(m||1!==g||1!==y||1!==b){E=y_(e,t,l||x,m,g,y,b,n,i);l&&l.release(),l=E}return l}function f_(e,t,r,n,i,o,a,s,l){for(var c,u=bs.maxTextureSize,h=r.list,d=n.list,f=0,p=Math.ceil(l/u);f<p;f++)for(var v=0,m=Math.ceil(s/u);v<m;v++){var g=v===m-1?s-v*u:u,y=f===p-1?l-f*u:u,b=ew(e,0,void 0,g,y),x=i+v*u/a,w=o+f*u/a,E=g/a,_=y/a,S={bbox:new Float64Array([x,w,x+E,w+_]),w:g,h:y,t:b};d.push(S),c?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0),e.viewport(0,0,g,y)):c=u_(e,b,g,y);for(var C=.5*g,T=.5*y,A=0,k=h.length;A<k;A++){var M=h[A],O=M.bbox,L=M.t;L&&s_(O,void 0,x,w,E,_)&&rw(e,C,T,t,[{opacity:1,bbox:new Float64Array([O[0]*a,O[1]*a,O[2]*a,O[3]*a]),texture:L}],-x*a,-w*a,!1,-1,-1,1,1)}}return c}function p_(e,t,r,n,i,o,a,s){for(var l=bs.maxTextureSize,c=l-s*a*2,u=[],h=t.bbox,d=i*a,f=o*a,p=0,v=Math.ceil(f/c);p<v;p++)for(var m=1,g=Math.ceil(d/l);m<g;m++){var y=Math.max(h[0],r+m*l/a-2*s),b=Math.max(h[1],n+p*c/a-s),x=Math.min(h[2],y+4*s),w=Math.min(h[3],b+c/a+2*s),E=new Float64Array([y,b,x,w]);y>h[2]-2*s&&(y=E[0]=Math.max(h[0],h[2]-2*s),x=E[2]=h[2]),b>h[3]-2*s&&(b=E[1]=Math.max(h[1],h[3]-2*s),w=E[3]=h[3]);var _=(E[2]-E[0])*a,S=(E[3]-E[1])*a;u.push({bbox:E,w:_,h:S,t:ew(e,0,void 0,_,S),x1:Math.max(h[0],y+s),y1:Math.max(h[1],p?b+s:b),x2:Math.min(h[2],x-s),y2:Math.min(h[3],p===v-1?w:b+c+s)})}for(p=1,v=Math.ceil(f/l);p<v;p++)for(m=0,g=Math.ceil(d/c);m<g;m++){y=Math.max(h[0],r+m*c/a-s),b=Math.max(h[1],n+p*l/a-2*s),x=Math.min(h[2],y+c/a+2*s),w=Math.min(h[3],b+4*s),E=new Float64Array([y,b,x,w]);y>h[2]-2*s&&(y=E[0]=Math.max(h[0],h[2]-2*s),x=E[2]=h[2]),b>h[3]-2*s&&(b=E[1]=Math.max(h[1],h[3]-2*s),w=E[3]=h[3]);var C=(E[2]-E[0])*a,T=(E[3]-E[1])*a;u.push({bbox:E,w:C,h:T,t:ew(e,0,void 0,C,T),x1:Math.max(h[0],m?y+s:y),y1:Math.max(h[1],b+s),x2:Math.min(h[2],m===g-1?x:y+c+s),y2:Math.min(h[3],w-s)})}return u}function v_(e,t,r,n,i,o,a){e.useProgram(t),e.blendFunc(e.ONE,e.ZERO);for(var s=n.list,l=0,c=s.length;l<c;l++){var u=s[l],h=u.bbox,d=u.w,f=u.h,p=u.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,p,0),e.viewport(0,0,d,f);for(var v=.5*d,m=.5*f,g=0,y=i.length;g<y;g++){var b=i[g],x=b.bbox,w=b.w,E=b.h,_=b.t,S=x.slice(0);S[0]!==o[0]&&(S[0]+=a),S[1]!==o[1]&&(S[1]+=a),S[2]!==o[2]&&(S[2]-=a),S[3]!==o[3]&&(S[3]-=a);var C=S[2]-S[0],T=S[3]-S[1];s_(h,void 0,S[0],S[1],C,T)&&rw(e,v,m,t,[{opacity:1,bbox:new Float64Array([S[0]*r,S[1]*r,S[2]*r,S[3]*r]),texture:_,tc:{x1:(S[0]===o[0]?0:a*r)/w,y1:(S[1]===o[1]?0:a*r)/E,x3:(S[2]===o[2]?w:w-a*r)/w,y3:(S[3]===o[3]?E:E-a*r)/E}}],-h[0]*r,-h[1]*r,!1,-1,-1,1,1)}}e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),i.forEach((function(t){return e.deleteTexture(t.t)}))}function m_(e,t,r,n,i,o,a){var s=Mw(kw(n)),l=r.bbox.slice(0);l[0]-=s,l[1]-=s,l[2]+=s,l[3]+=s;var c=l[0],u=l[1],h=l[2]-l[0],d=l[3]-l[1],f=h*a,p=d*a,v=t.programs.program,m=Rw.getEmptyInstance(e,l),g=m.list,y=f_(e,v,r,m,c,u,a,f,p),b=n*a,x=0;b>=256?x=4:b>=64?x=3:b>=16?x=2:b>=4&&(x=1);for(var w=Ow(b*Math.pow(.5,x)),E=Rw.getEmptyInstance(e,l),_=E.list,S=0,C=g.length;S<C;S++){var T=g[S],A=T.bbox,k=T.w,M=T.h,O=T.t;_.push({bbox:A.slice(0),w:k,h:M,t:O&&g_(e,t,w,x,O,k,M)})}if(g.length>1){var L=p_(e,E,c,u,h,d,a,s);for(S=0,C=L.length;S<C;S++){var R=L[S],I=(A=R.bbox,R.w),P=R.h;O=R.t;e.useProgram(v),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,O,0),e.viewport(0,0,I,P);for(var F=.5*I,D=.5*P,N=!1,B=0,U=g.length;B<U;B++){var z=g[B],X=z.bbox,H=z.t,G=X[2]-X[0],j=X[3]-X[1];H&&s_(A,void 0,X[0],X[1],G,j)&&(rw(e,F,D,v,[{opacity:1,bbox:new Float64Array([X[0]*a,X[1]*a,X[2]*a,X[3]*a]),texture:H}],-A[0]*a,-A[1]*a,!1,-1,-1,1,1),N=!0)}N&&(R.t=g_(e,t,w,x,O,I,P),e.deleteTexture(O))}v_(e,v,a,E,L,l,s)}return m.release(),e.useProgram(v),h_(e,y,i,o),E}function g_(e,t,r,n,i,o,a){var s=t.programs,l=s.boxProgram,c=s.dualDownProgram,u=s.dualUpProgram,h=o,d=a,f=void 0;if(n){e.useProgram(c),f=i;for(var p=1;p<=n;p++){var v=Math.ceil(o*Math.pow(.5,p)),m=Math.ceil(a*Math.pow(.5,p));e.viewport(0,0,v,m),f=aw(e,c,y=f,h,d,v,m),y!==i&&e.deleteTexture(y),h=v,d=m}}e.useProgram(l),e.viewport(0,0,h,d);var g=ow(e,l,f||i,h,d,r);if(n){e.useProgram(u),f=g;for(p=n-1;p>=0;p--){var y;v=Math.ceil(o*Math.pow(.5,p)),m=Math.ceil(a*Math.pow(.5,p));e.viewport(0,0,v,m),f=aw(e,u,y=f,h,d,v,m),e.deleteTexture(y),h=v,d=m}g=f}return e.viewport(0,0,o,a),g}function y_(e,t,r,n,i,o,a,s,l){var c=t.programs,u=c.cmProgram;e.useProgram(u);var h,d=r;if(n||1!==i||1!==o||1!==a){var f=wc(n%360),p=Math.cos(f),v=Math.sin(f),m=.213*(1-i),g=.715*(1-i),y=.072*(1-i),b=o-1,x=a,w=.5*(1-x),E=ac(n?new Float64Array([.213+.787*p-.213*v,.715-.715*p-.715*v,.072-.072*p+.928*v,0,.213-.213*p+.143*v,.715+.285*p+.14*v,.072-.072*p-.283*v,0,.213-.213*p-.787*v,.715-.715*p+.715*v,.072+.928*p+.072*v,0,0,0,0,1]):ic(),1!==i?new Float64Array([m+i,g,y,0,m,g+i,y,0,m,g,y+i,0,0,0,0,1]):ic());1!==x&&(E[0]*=x,E[1]*=x,E[2]*=x,E[4]*=x,E[5]*=x,E[6]*=x,E[8]*=x,E[9]*=x,E[10]*=x);var _=d,S=function(e,t,r,n,i){for(var o=Rw.getEmptyInstance(e,r.bbox),a=r.list,s=o.list,l=0,c=a.length;l<c;l++){var u=a[l],h=u.bbox,d=u.w,f=u.h,p=u.t,v=ew(e,0,void 0,d,f);i?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),e.viewport(0,0,d,f)):i=u_(e,v,d,f),p&&dw(e,t,p,n),s.push({bbox:h.slice(0),w:d,h:f,t:v})}return{res:o,frameBuffer:i}}(e,u,_,[E[0],E[1],E[2],E[3],b+w,E[4],E[5],E[6],E[7],b+w,E[8],E[9],E[10],E[11],b+w,0,0,0,1],h);d=S.res,h=S.frameBuffer,_!==r&&_.release()}if(e.useProgram(c.program),h)return h_(e,h,s,l),d;e.viewport(0,0,s,l)}function b_(e,t,r,n,i,o,a,s,l,c,u,h){var d,f;if(null===(d=r.textureMask[h])||void 0===d?void 0:d.available)return r.textureMask[h];var p=r.textureTarget[h];if(!r.next)return p;var v=p.list,m=t.programs,g=m.program;e.useProgram(g);var y,b,x=p.bbox,w=r.matrix,E=r.computedStyle,_=x[0],S=x[1],C=_*u,T=S*u,A=x[2]-_,k=x[3]-S,M=A*u,O=k*u,L=Rw.getEmptyInstance(e,x),R=L.list,I=bs.maxTextureSize;r instanceof Uw&&r.onlyImg&&p===r.textureCache[h]&&(r.tempBbox=(r.tempBbox||r._rect||r.rect).slice(0),v=(b=c_(e,t,r,i,o,s,l,c,u,h,!0)).list);var P=ic();cc(P,w),mc(P,1/u);for(var F=yc(P),D=0,N=Math.ceil(O/I);D<N;D++)for(var B=0,U=Math.ceil(M/I);B<U;B++){var z=B===U-1?M-B*I:I,X=D===N-1?O-D*I:I,H=ew(e,0,void 0,z,X),G=_+B*I/u,j=S+D*I/u,Y={bbox:new Float64Array([G,j,G+z/u,j+X/u]),w:z,h:X,t:H};R.push(Y);var W=C+B*I,q=T+D*I;y?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,H,0),e.viewport(0,0,z,X)):y=u_(e,H,z,X);var V=.5*z,K=.5*X;if([Qs.ALPHA_WITH,Qs.GRAY_WITH].includes(n)&&E.visibility===nl.VISIBLE&&E.opacity>0&&p.available){var Z=null===(f=v[D*U+B])||void 0===f?void 0:f.t;Z&&rw(e,V,K,g,[{opacity:1,bbox:new Float64Array([0,0,z,X]),texture:Z}],0,0,!1,-1,-1,1,1)}for(var J=!D&&!B,Q=o+s+1,$=i.length;Q<$;Q++){var ee=i[Q],te=ee.node,re=ee.lv,ne=ee.total,ie=ee.next,oe=te.computedStyle;if(a>re){r.struct.next=Q-o-s-1;break}if(Q===$||oe.breakMask&&a===re){r.struct.next=Q-o-s-1;break}var ae=__(te,oe,h),se=ae.shouldIgnore,le=ae.isBgBlur;if(se)Q+=ne+ie;else{J&&te.isBitmap&&te.checkLoader()&&t.imgLoadList.push(te);var ce=void 0,ue=void 0;if(J){if(a===re)ce=te.tempOpacity=oe.opacity,ue=ac(F,te.matrix);else{var he=te.parent;ce=te.tempOpacity=oe.opacity*he.tempOpacity,ue=ac(he.tempMatrix,te.matrix)}cc(te.tempMatrix,ue)}else ce=te.tempOpacity,ue=te.tempMatrix;var de=te.textureTarget[h];if(!de&&te.hasContent&&(te.genTexture(e,u,h),de=te.textureTarget[h]),de&&de.available){var fe=oe.mixBlendMode,pe=oe.blur;if(!s_(de.bbox,ue,W,q,z,X))continue;if(le&&Q>o+s+1){var ve=te.textureOutline[u]=E_(e,te,i,Q,ne,de.bbox,u);cc(te.tempMatrix,ue),w_(e,t,L,ue,ve,pe,m,u,A,k),e.bindFramebuffer(e.FRAMEBUFFER,y),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Y.t,0),e.viewport(0,0,z,X)}for(var me=de.list,ge=0,ye=me.length;ge<ye;ge++){var be=me[ge],xe=be.bbox,we=be.t;if(we&&s_(xe,ue,W,q,z,X)){var Ee=void 0;fe!==js.NORMAL&&(Q>o+s+1&&[Qs.OUTLINE,Qs.ALPHA,Qs.GRAY].includes(n)||Q>o+s&&[Qs.ALPHA_WITH,Qs.GRAY_WITH].includes(n))&&(Ee=ew(e,0,void 0,z,X),y?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Ee,0),e.viewport(0,0,z,X)):y=u_(e,Ee,z,X)),rw(e,V,K,g,[{opacity:ce,matrix:ue,bbox:xe,texture:we}],-W,-q,!1,-1,-1,1,1),fe!==js.NORMAL&&Ee&&(Y.t=x_(e,Y.t,Ee,fe,m,z,X))}}}de&&de.available&&de!==te.textureCache[h]||oe.maskMode?Q+=ne+ie:te.isShapeGroup&&(Q+=ne)}}}var _e,Se=Rw.getEmptyInstance(e,x),Ce=Se.list;n===Qs.OUTLINE&&(_e=(ve=r.textureOutline[u]=E_(e,r,i,o,s,x,u)).list);if(n===Qs.GRAY||n===Qs.GRAY_WITH){var Te=m.maskGrayProgram;e.useProgram(Te);for(D=0,N=R.length;D<N;D++){var Ae=R[D],ke=Ae.bbox,Me=Ae.w,Oe=Ae.h;H=Ae.t,Ee=void 0;v[D]&&v[D].t&&H&&(Ee=ew(e,0,void 0,Me,Oe),y?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Ee,0),e.viewport(0,0,Me,Oe)):y=u_(e,Ee,Me,Oe),v[D]&&v[D].t&&iw(e,Te,v[D].t,H)),Ce.push({bbox:ke.slice(0),w:Me,h:Oe,t:Ee})}}else{var Le=m.maskProgram;m.clipProgram;for(D=0,N=R.length;D<N;D++){var Re=R[D],Ie=Re.bbox,Pe=Re.w,Fe=Re.h;H=Re.t,Ee=ew(e,0,void 0,Pe,Fe);y?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Ee,0),e.viewport(0,0,Pe,Fe)):y=u_(e,Ee,Pe,Fe),[Qs.OUTLINE].includes(n)&&(e.useProgram(g),rw(e,.5*Pe,.5*Fe,g,[{opacity:1,bbox:new Float64Array([0,0,Pe,Fe]),texture:v[D].t}],0,0,!1,-1,-1,1,1)),e.useProgram(Le),iw(e,Le,_e?_e[D].t:v[D].t,H),Ce.push({bbox:Ie.slice(0),w:Pe,h:Fe,t:Ee})}}return e.useProgram(g),L.release(),b&&b.release(),y?h_(e,y,l,c):e.viewport(0,0,l,c),Se}function x_(e,t,r,n,i,o,a){var s;n===js.MULTIPLY?s=i.multiplyProgram:n===js.SCREEN?s=i.screenProgram:n===js.OVERLAY?s=i.overlayProgram:n===js.DARKEN?s=i.darkenProgram:n===js.LIGHTEN?s=i.lightenProgram:n===js.COLOR_DODGE?s=i.colorDodgeProgram:n===js.COLOR_BURN?s=i.colorBurnProgram:n===js.HARD_LIGHT?s=i.hardLightProgram:n===js.SOFT_LIGHT?s=i.softLightProgram:n===js.DIFFERENCE?s=i.differenceProgram:n===js.EXCLUSION?s=i.exclusionProgram:n===js.HUE?s=i.hueProgram:n===js.SATURATION?s=i.saturationProgram:n===js.COLOR?s=i.colorProgram:n===js.LUMINOSITY?s=i.luminosityProgram:(fl.error("Unknown mixBlendMode: "+n),s=i.program),e.useProgram(s);var l=ew(e,0,void 0,o,a);return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,l,0),uw(e,s,t,r),e.deleteTexture(t),e.deleteTexture(r),e.useProgram(i.program),l}function w_(e,t,r,n,i,o,a,s,l,c){for(var u,h=a.program,d=m_(e,t,r,o.radius,l,c,s),f=d.list,p=i.list,v=[],m=0,g=f.length;m<g;m++){var y=f[m],b=y.bbox,x=.5*(k=y.w),w=.5*(M=y.h),E=ew(e,0,void 0,k,M);v.push(E),u?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,E,0),e.viewport(0,0,k,M)):u=u_(e,E,k,M);for(var _=0,S=p.length;_<S;_++){var C=p[_],T=C.bbox;(X=C.t)&&s_(T,n,b[0]*s,b[1]*s,(b[2]-b[0])*s,(b[3]-b[1])*s)&&rw(e,x,w,h,[{opacity:1,matrix:n,bbox:T,texture:X}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}var A=a.maskProgram;e.useProgram(A);for(m=0,g=f.length;m<g;m++){var k=(N=f[m]).w,M=N.h,O=N.t;E=ew(e,0,void 0,k,M);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,E,0),e.viewport(0,0,k,M),O&&(iw(e,A,v[m],O),e.deleteTexture(O)),e.deleteTexture(v[m]),N.t=E}if(void 0!==o.saturation&&1!==o.saturation&&(O=y_(e,t,d||r,0,o.saturation,1,1,l,c))){for(m=0,g=f.length;m<g;m++)f[m].t&&e.deleteTexture(f[m].t),f[m].t=O.list[m].t;u&&e.bindFramebuffer(e.FRAMEBUFFER,u)}e.useProgram(h);var L=[],R=r.list;for(m=0,g=R.length;m<g;m++){var I=R[m];b=I.bbox,x=.5*(k=I.w),w=.5*(M=I.h),E=ew(e,0,void 0,k,M);L.push(E),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,E,0),e.viewport(0,0,k,M);_=0;for(var P=p.length;_<P;_++){var F=p[_];T=F.bbox;(X=F.t)&&s_(T,n,b[0]*s,b[1]*s,(b[2]-b[0])*s,(b[3]-b[1])*s)&&rw(e,x,w,h,[{opacity:1,matrix:n,bbox:T,texture:X}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}var D=a.clipProgram;e.useProgram(D);for(m=0,g=R.length;m<g;m++){var N;k=(N=R[m]).w,M=N.h,O=N.t,E=ew(e,0,void 0,k,M);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,E,0),e.viewport(0,0,k,M),O&&(iw(e,D,L[m],O),e.deleteTexture(O)),e.deleteTexture(L[m]),N.t=E}e.useProgram(h);var B=ic();1!==s&&mc(B,s),e.blendFunc(e.ONE,e.ONE);for(m=0,g=R.length;m<g;m++){var U=R[m];b=U.bbox,k=U.w,M=U.h,O=U.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,O,0),e.viewport(0,0,k,M);_=0;for(var z=f.length;_<z;_++){var X,H=f[_];T=H.bbox;(X=H.t)&&s_(T,void 0,b[0],b[1],b[2]-b[0],b[3]-b[1])&&rw(e,.5*k,.5*M,h,[{opacity:1,matrix:B,bbox:T,texture:X}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),u?h_(e,u,l,c):e.viewport(0,0,l,c)}function E_(e,t,r,n,i,o,a){var s;if(null===(s=t.textureOutline[a])||void 0===s?void 0:s.available)return t.textureOutline[a];var l=o[0],c=o[1],u=o[2]-l,h=o[3]-c,d=-l*a,f=-c*a,p=u*a,v=h*a,m=Nw.getInstance(p,v,d,f);m.available=!0;for(var g=m.list,y=function(e,t){var o=g[e],s=o.x,l=o.y,c=o.os.ctx,u=-s,d=-l;c.fillStyle="#FFF";for(var f=n,p=n+i+1;f<p;f++){var v=r[f],m=v.node,y=v.total,b=v.next,x=void 0;if(f===n)x=sc(m.tempMatrix);else x=ac(m.parent.tempMatrix,m.matrix),cc(m.tempMatrix,x);var w=m.computedStyle.fillRule===Js.EVEN_ODD?"evenodd":"nonzero";if(c.setTransform(x[0],x[1],x[4],x[5],x[12],x[13]),m instanceof tE){var E=m.coords;c.beginPath(),Wx(c,E,a,u,d),c.closePath(),c.fill(w)}else if(m instanceof LS){E=m.coords;c.beginPath(),E.forEach((function(e){Wx(c,e,a,u,d)})),c.closePath(),c.fill(w),f+=y+b}else if(m instanceof r_)for(var _=m.lineBoxList,S=0,C=_.length;S<C;S++){var T=_[S];if(T.y>=h)break;for(var A=T.list,k=A.length,M=0;M<k;M++){var O=A[M];r_.setFontAndLetterSpacing(c,O,a),c.fillText(O.str,O.x*a+u,(O.y+O.baseline)*a+d)}}else c.fillRect(u,d,m.width*a,m.height*a),m instanceof VE&&(f+=y+b)}},b=0,x=g.length;b<x;b++)y(b);var w=Rw.getInstance(e,m,o);return m.release(),w}function __(e,t,r){var n=t.blur,i=n.t===qs.BACKGROUND&&(n.radius>0||1!==n.saturation)&&(e instanceof LS||e instanceof jw||e instanceof Uw||e instanceof r_),o=t.visibility===nl.HIDDEN||t.opacity<=0;if(o&&t.maskMode&&e.next&&(o=!1),o&&t.maskMode&&t.opacity>0){var a=e.textureTarget[r];t.maskMode===Qs.OUTLINE?(t.visibility===nl.VISIBLE||a!==e.textureTotal[r]&&a!==e.textureCache[r])&&(o=!1):t.maskMode===Qs.ALPHA&&e.next&&a!==e.textureTotal[r]&&a!==e.textureCache[r]&&(o=!1)}return o&&i&&t.visibility===nl.VISIBLE&&(o=!1),{shouldIgnore:o,isBgBlur:i}}function S_(e){e.valid=!0;for(var t=e.subList;t.length;){var r=t.pop();r.valid=!0;for(var n=r.subList;n.length;)t.push(n.pop())}}function C_(e,t){var r=t.getCurPageZoom(),n=0;if(r<=1)1===r?(r=2,n=1):r=1;else{for(var i=1;r>1;)r*=.5,i<<=1,n++;r=i}t.scale=r,t.scaleIndex=n;var o=t.imgLoadList,a=t.lastPage;bs.tile&&a?function(e,t,r,n){var i=t.structs,o=t.lastPage,a=t.width,s=t.height,l=t.dpi,c=t.imgLoadList,u=t.tileRecord,h=o.computedStyle.scaleX,d=o.matrixWorld,f=h,p=1;if(f<.5)for(;f<.5;)f*=2,p*=.5;else p=r/l;var v=h/p,m=t.tileManager;m.setPage(o);var g=gc({x:0,y:0},d),y=g.x,b=g.y,x=bw.UNIT*v*l,w=0,E=0,_=y%x,S=b%x,C=Math.floor(-y/x),T=Math.floor(-b/x);w=_>0?Math.ceil((a-_)/x)+1:Math.ceil((a-_)/x);E=S>0?Math.ceil((s-S)/x)+1:Math.ceil((s-S)/x);var A=Math.round(bw.UNIT/p),k=m.active(p,C*A,T*A,w,E),M=.5*a,O=.5*s,L=t.programs,R=L.program;e.useProgram(L.program);for(var I=[],P=new Float64Array([0,0,a,s]),F=!0,D=0,N=k.length;D<N;D++){(dt=k[D]).init(l),dt.complete||(F=!1);var B=dt.x,U=dt.y,z=bc(B,U,B+A,U+A,d);dt.bbox[0]=z.x1,dt.bbox[1]=z.y1,dt.bbox[2]=z.x3,dt.bbox[3]=z.y3}var X=0,H=0,G=a,j=s;if(k.length){var Y=k[0],W=k[k.length-1];X=Y.bbox[0],H=Y.bbox[1],G=W.bbox[2],j=W.bbox[3]}var q=Date.now(),V=i_(e,t,r,n,X,H,G,j,q),K=V.mergeRecord,Z=V.breakMerge,J=Object.keys(u);for(D=0,N=J.length;D<N;D++){if((ge=u[J[D]])&&ge.hasContent&&ge.computedStyle.maskMode!==Qs.ALPHA){var Q=ge.matrixWorld;if(s_(z=ge.filterBbox,Q,X,H,G-X,j-H))for(var $=bc(z[0],z[1],z[2],z[3],Q),ee=0,te=k.length;ee<te;ee++){var re=(dt=k[ee]).bbox;kc(re[0],re[1],re[2],re[3],[{x:$.x1,y:$.y1},{x:$.x2,y:$.y2},{x:$.x3,y:$.y3},{x:$.x4,y:$.y4}])&&(dt.clean(),F=!1)}}}t.tileRecord={};for(D=0,N=K.length;D<N;D++){var ne=K[D];if(s_(z=ne.bbox,Q=ne.m,X,H,G-X,j-H)){$=bc(z[0],z[1],z[2],z[3],Q),ee=0;for(var ie=k.length;ee<ie;ee++){var oe=(dt=k[ee]).bbox;dt.count&&kc(oe[0],oe[1],oe[2],oe[3],[{x:$.x1,y:$.y1},{x:$.x2,y:$.y2},{x:$.x3,y:$.y3},{x:$.x4,y:$.y4}])&&(dt.clean(),F=!1)}}}var ae=t.overlay,se=!1;if(!F){var le=!0,ce=void 0,ue=yc(d),he=bw.UNIT*l,de=.5*he;if(t.tileLastIndex){var fe=(ge=i[t.tileLastIndex].node).artBoard;if(fe&&ge!==fe){var pe=fe.struct;if((ye=pe.total)+(be=pe.next)){I[(D=i.indexOf(fe.struct))+ye+be]=fe;var ve=bc((z=fe._bbox||fe.bbox)[0],z[1],z[2],z[3],fe.matrixWorld);P[0]=ve.x1,P[1]=ve.y1,P[2]=ve.x3,P[3]=ve.y3}}}for(D=0,N=k.length;D<N;D++){!(dt=k[D]).count&&!dt.complete&&dt.texture&&dt.needClear&&(dt.needClear=!1,ce?e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,dt.texture,0):ce=u_(e,dt.texture,he,he),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT))}for(D=t.tileLastIndex,N=i.length;D<N;D++){var me=i[D],ge=me.node,ye=me.total,be=me.next;if(ae===ge)break;var xe=ge.computedStyle,we=__(ge,xe,n),Ee=we.shouldIgnore;if(we.isBgBlur,Ee)I[D+=ye+be]&&(T_(k),P[0]=0,P[1]=0,P[2]=a,P[3]=s);else{var _e=ge.parent,Se=ge.textureTarget;k_(ge,D,_e);var Ce=ge._opacity,Te=ge._matrixWorld,Ae=Se[n],ke=!1;if(Ae&&Ae.available?ke=s_(Ae.bbox,Te,X,H,G-X,j-H):(ke=s_(ge._filterBbox||ge.filterBbox,Te,X,H,G-X,j-H))&&ge.hasContent&&ge.computedStyle.maskMode!==Qs.ALPHA&&(ge.genTexture(e,r,n),Ae=Se[n]),ke)if(ge.isArtBoard&&ge instanceof Fw){if(ye+be){ve=bc((z=ge._bbox||ge.bbox)[0],z[1],z[2],z[3],Te);P[0]=ve.x1,P[1]=ve.y1,P[2]=ve.x3,P[3]=ve.y3}}else 0===P[0]&&0===P[1]&&P[2]===a&&P[3]===s||(ke=Ae&&Ae.available?s_(Ae.bbox,Te,P[0],P[1],P[2]-P[0],P[3]-P[1]):s_(ge._filterBbox||ge.filterBbox,Te,P[0],P[1],P[2]-P[0],P[3]-P[1]));else if(ge.isArtBoard&&ge instanceof Fw){T_(k),P[0]=0,P[1]=0,P[2]=a,P[3]=s;continue}if(ke&&ge.isBitmap&&ge.checkLoader()&&c.push(ge),ke){if(!le&&Date.now()-q>bs.deltaTime){se=!0,t.tileLastIndex=D;break}var Me=Ae&&Ae.available||!1,Oe=xe.mixBlendMode,Le=($=bc((z=Me?Ae.bbox:ge._filterBbox||ge.filterBbox)[0],z[1],z[2],z[3],Te),Q=ac(ue,Te),p*l);if(1!==Le)mc(Ye=ic(),Le),Q=ac(Ye,Q);var Re=Me&&1===Ae.list.length?pw(z,de,de,0,0,!1,Q):void 0,Ie=[],Pe=(ve=void 0,ge.isArtBoard&&ge instanceof Fw);if(Pe){var Fe=ge._bbox||ge.bbox;ve=bc(Fe[0],Fe[1],Fe[2],Fe[3],Q),I[D+ye+be]=ge;var De=bc(Fe[0],Fe[1],Fe[2],Fe[3],ge.matrixWorld);P[0]=De.x1,P[1]=De.y1,P[2]=De.x3,P[3]=De.y3}ee=0;for(var Ne=k.length;ee<Ne;ee++){var Be=(dt=k[ee]).bbox;if(Pe&&(dt.x1=(ve.x1-dt.x*Le-de)/de,dt.y1=(ve.y1-dt.y*Le-de)/de,dt.x2=(ve.x3-dt.x*Le-de)/de,dt.y2=(ve.y3-dt.y*Le-de)/de),(ge.hasContent||Pe)&&!dt.complete&&!dt.has(ge)&&kc(Be[0],Be[1],Be[2],Be[3],[{x:$.x1,y:$.y1},{x:$.x2,y:$.y2},{x:$.x3,y:$.y3},{x:$.x4,y:$.y4}])&&(ge.addTile(dt),dt.add(ge),(Me||Pe)&&!(dt.x1>1||dt.y1>1||dt.x2<-1||dt.y2<-1))){le&&(le=!1),ce?e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,dt.texture,0):ce=u_(e,dt.texture,he,he),0===dt.count&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),Pe&&ge.renderBgcTile(e,de,M,O,Le,dt,ve);var Ue=null==Ae?void 0:Ae.list;if(Ue&&Ue.length){var ze=void 0;if(Oe!==js.NORMAL&&(ze=ew(e,0,void 0,he,he),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ze,0)),1===Ue.length)Ue[0].t&&rw(e,de,de,R,[{opacity:Ce,bbox:z,coords:Re,texture:Ue[0].t}],-dt.x*Le/de,-dt.y*Le/de,!1,dt.x1,dt.y1,dt.x2,dt.y2);else if(Ue.length>1)for(var Xe=0,He=Ue.length;Xe<He;Xe++){var Ge=Ue[Xe],je=Ge.bbox,Ye=Ge.t,We=bc(je[0],je[1],je[2],je[3],Te);kc(Be[0],Be[1],Be[2],Be[3],[{x:We.x1,y:We.y1},{x:We.x2,y:We.y2},{x:We.x3,y:We.y3},{x:We.x4,y:We.y4}])&&(Ie[Xe]=Ie[Xe]||pw(je,de,de,0,0,!1,Q),Ye&&rw(e,de,de,R,[{opacity:Ce,bbox:je,coords:Ie[Xe],texture:Ye}],-dt.x*Le/de,-dt.y*Le/de,!1,dt.x1,dt.y1,dt.x2,dt.y2))}if(Oe!==js.NORMAL){Ye=x_(e,dt.texture,ze,Oe,L,he,he);dt.updateTex(Ye)}}}}}Ae&&Ae.available&&Ae!==ge.textureCache[n]||xe.maskMode?D+=ye+be:ge.isShapeGroup&&(D+=ye),I[D]&&(T_(k),P[0]=0,P[1]=0,P[2]=a,P[3]=s)}}ce&&h_(e,ce,a,s)}for(D=0,N=k.length;D<N;D++){if((dt=k[D]).available&&dt.count)rw(e,M,O,R,[{opacity:1,bbox:dt.bbox,texture:dt.texture}],0,0,!0,-1,-1,1,1);else{var qe=dt.x,Ve=dt.y,Ke=m.getDowngrade(p,qe,Ve);if(Ke&&Ke.length){ee=0;for(var Ze=Ke.length;ee<Ze;ee++){var Je=Ke[ee],Qe=Je.scale/p;if(Qe<1){var $e=(qe-Je.tile.x)/Je.tile.size,et=(Ve-Je.tile.y)/Je.tile.size;rw(e,M,O,R,[{opacity:1,bbox:dt.bbox,texture:Je.tile.texture,tc:{x1:$e,y1:et,x3:$e+Qe,y3:et+Qe}}],0,0,!0,-1,-1,1,1)}else if(Qe>1){var tt=(Je.tile.x-qe)/dt.size,rt=(Je.tile.y-Ve)/dt.size,nt=(z=dt.bbox)[2]-z[0],it=z[3]-z[1],ot=z[0]+tt*nt,at=z[1]+rt*it;rw(e,M,O,R,[{opacity:1,bbox:new Float64Array([ot,at,ot+nt/Qe,at+it/Qe]),texture:Je.tile.texture}],0,0,!0,-1,-1,1,1)}}}}se||(dt.complete=!0)}if(bs.debug){var st=L.tileProgram;e.useProgram(st);var lt=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,lt),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var ct=e.getAttribLocation(st,"a_position");e.vertexAttribPointer(ct,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(ct);var ut=e.getUniformLocation(st,"u_width");e.uniform1f(ut,1/M);var ht=e.getUniformLocation(st,"u_height");e.uniform1f(ht,1/O);for(D=0,N=k.length;D<N;D++){var dt=k[D],ft=e.getUniformLocation(st,"u_x1");e.uniform1f(ft,(dt.bbox[0]-M)/M);var pt=e.getUniformLocation(st,"u_y1");e.uniform1f(pt,(O-dt.bbox[3])/O);var vt=e.getUniformLocation(st,"u_x2");e.uniform1f(vt,(dt.bbox[2]-M)/M);var mt=e.getUniformLocation(st,"u_y2");e.uniform1f(mt,(O-dt.bbox[1])/O);var gt=e.getUniformLocation(st,"u_count");e.uniform1i(gt,dt.count),e.drawArrays(e.TRIANGLE_STRIP,0,4)}e.deleteBuffer(lt),e.disableVertexAttribArray(ct),e.useProgram(R)}O_(e,M,O,a,s,t,!0),se&&(t.tileRemain=!0,t.addUpdate(t,[],Nx.CACHE,!1,!1,void 0));Z&&Z.length&&(t.tileLastIndex=0);if(Z&&Z.length)for(D=0,N=Z.length;D<N;D++)t.addUpdate(Z[D].node,[],Nx.CACHE,!1,!1,void 0)}(e,t,r,n):A_(e,t,r,n);for(var s=0,l=o.length;s<l;s++)o[s].loadAndRefresh();o.splice(0)}function T_(e){e.forEach((function(e){e.x1=e.y1=-1,e.x2=e.y2=1}))}function A_(e,t,r,n){var i,o=t.structs,a=t.width,s=t.height,l=t.imgLoadList,c=i_(e,t,r,n,0,0,a,s,Date.now()).breakMerge,u=.5*a,h=.5*s,d=t.programs,f=[],p=t.pageTexture||ew(e,0,void 0,a,s),v=p,m=u_(e,v,a,s);e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);var g=t.overlay,y=d.program;e.useProgram(d.program);for(var b=-1,x=-1,w=1,E=1,_=new Float64Array([0,0,a,s]),S=0,C=o.length;S<C;S++){var T=o[S],A=T.node,k=T.total,M=T.next;if(g===A)break;var O=A.computedStyle,L=__(A,O,n),R=L.shouldIgnore,I=L.isBgBlur;if(R)f[S+=k+M]&&(_[0]=0,_[1]=0,_[2]=a,_[3]=s,b=x=-1,w=E=1,v=M_(e,y,u,h,a,s,p,v));else{var P=A.parent,F=A.textureTarget;k_(A,S,P);var D=A._opacity,N=A._matrixWorld,B=F[n],U=!1;if(B&&B.available?U=a_(B.bbox,N,a,s):(U=a_(A._filterBbox||A.filterBbox,N,a,s))&&A.hasContent&&A.computedStyle.maskMode!==Qs.ALPHA&&(A.genTexture(e,r,n),B=F[n]),U)if(A.isArtBoard&&A instanceof Fw){if(A.renderBgc(e,u,h),k+M){f[S+k+M]=A;var z=bc(($=A._bbox||A.bbox)[0],$[1],$[2],$[3],N);_[0]=z.x1,_[1]=z.y1,_[2]=z.x3,_[3]=z.y3,b=(z.x1-u)/u,x=(z.y1-h)/h,w=(z.x3-u)/u,E=(z.y3-h)/h,i=ew(e,0,void 0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),v=i}}else 0===_[0]&&0===_[1]&&_[2]===a&&_[3]===s||(U=B&&B.available?s_(B.bbox,N,_[0],_[1],_[2]-_[0],_[3]-_[1]):s_(A._filterBbox||A.filterBbox,N,_[0],_[1],_[2]-_[0],_[3]-_[1]));else if(A.isArtBoard&&A instanceof Fw){S+=k+M;continue}if(U&&A.isBitmap&&A.checkLoader()&&l.push(A),U&&B&&B.available){var X=O.mixBlendMode,H=O.blur;if(I&&S){var G=A.textureOutline[r]=E_(e,A,o,S,k,B.bbox,r),j=a/t.dpi,Y=s/t.dpi,W=Rw.getEmptyInstance(e,new Float64Array([0,0,j,Y]));W.list.push({bbox:new Float64Array([0,0,j,Y]),w:a,h:s,t:v});var q=v===p;w_(e,t,W,N,G,H,d,r,a,s),v=W.list[0].t,q&&(p=v),e.bindFramebuffer(e.FRAMEBUFFER,m),e.viewport(0,0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0)}var V=void 0;X!==js.NORMAL&&(V=ew(e,0,void 0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,V,0));for(var K=B.list,Z=0,J=K.length;Z<J;Z++){var Q=K[Z],$=Q.bbox,ee=Q.t;ee&&rw(e,u,h,y,[{opacity:D,matrix:N,bbox:$,texture:ee}],0,0,!1,b,x,w,E)}X!==js.NORMAL&&(v=x_(e,v,V,X,d,a,s))}(null==B?void 0:B.available)&&B!==A.textureCache[n]||O.maskMode?S+=k+M:A.isShapeGroup&&(S+=k),f[S]&&(_[0]=0,_[1]=0,_[2]=a,_[3]=s,b=x=-1,w=E=1,v=M_(e,y,u,h,a,s,p,v))}}if(O_(e,u,h,a,s,t,!1),h_(e,m,a,s),rw(e,u,h,y,[{opacity:1,bbox:new Float64Array([0,0,a,s]),texture:v}],0,0,!0,-1,-1,1,1),t.pageTexture=v,c&&c.length)for(S=0,C=c.length;S<C;S++)t.addUpdate(c[S].node,[],Nx.CACHE,!1,!1,void 0)}function k_(e,t,r){var n=!1,i=!1;t?(n=e.hasCacheOp&&e.parentOpId===r.localOpId,i=e.hasCacheMw&&e.parentMwId===r.localMwId):(n=e.hasCacheOp,i=e.hasCacheMw),n||(e._opacity=r?r._opacity*e.computedStyle.opacity:e.computedStyle.opacity,r&&(e.parentOpId=r.localOpId),e.hasCacheOp=!0),i||(cc(e._matrixWorld,r?ac(r._matrixWorld,e.matrix):e.matrix),r&&(e.parentMwId=r.localMwId),e.hasCacheMw&&e.localMwId++,e.hasCacheMw=!0)}function M_(e,t,r,n,i,o,a,s){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),rw(e,r,n,t,[{opacity:1,bbox:new Float64Array([0,0,i,o]),texture:s}],0,0,!1,-1,-1,1,1),e.deleteTexture(s),a}function O_(e,t,r,n,i,o,a){var s=o.overlay,l=o.structs,c=o.programs;s.update();for(var u=l.indexOf(s.struct),h=c.program,d=u,f=l.length;d<f;d++){var p=(O=l[d].node).parent,v=O.textureTarget;k_(O,d,p);var m=O._opacity,g=O._matrixWorld,y=v[0];if(!y&&O.hasContent&&(O.genTexture(e,1,0),y=v[0]),y&&y.available)if(a_(y.bbox,g,n,i))for(var b=y.list,x=0,w=b.length;x<w;x++){var E=b[x],_=E.bbox,S=E.t;S&&rw(e,t,r,h,[{opacity:m,matrix:g,bbox:_,texture:S}],0,0,a,-1,-1,1,1)}}var C=c.sliceProgram;e.useProgram(C);var T=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,T),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var A=e.getAttribLocation(C,"a_position");e.vertexAttribPointer(A,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(A);var k=e.getUniformLocation(C,"u_width");e.uniform1f(k,1/t);var M=e.getUniformLocation(C,"u_height");e.uniform1f(M,1/r);for(d=0;d<u;d++){var O;if((O=l[d].node).isSlice&&O instanceof QE){g=O._matrixWorld;if(a_(_=O._rect||O.rect,g,n,i)){var L=O.getBoundingClientRect({excludeRotate:!0}),R=e.getUniformLocation(C,"u_x1");e.uniform1f(R,(L.left-t)/t);var I=e.getUniformLocation(C,"u_x2");e.uniform1f(I,(L.right-t)/t);var P=e.getUniformLocation(C,"u_y1"),F=e.getUniformLocation(C,"u_y2");a?(e.uniform1f(F,(r-L.top)/r),e.uniform1f(P,(r-L.bottom)/r)):(e.uniform1f(P,(L.top-r)/r),e.uniform1f(F,(L.bottom-r)/r)),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}}e.deleteBuffer(T),e.disableVertexAttribArray(A),e.useProgram(h)}var L_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isSymbolMaster=!0,n.symbolInstances=[],n}return v(t,e),t.prototype.addSymbolInstance=function(e){-1===this.symbolInstances.indexOf(e)&&this.symbolInstances.push(e)},t.prototype.removeSymbolInstance=function(e){var t=this.symbolInstances.indexOf(e);t>-1&&this.symbolInstances.splice(t,1)},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.symbolInstances=[],n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SYMBOL_MASTER,t},t}(Fw),R_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.artBoards=new Pw({name:"overlay-artBoards",uuid:"",index:0,style:{width:"100%",height:"100%",pointerEvents:!1}},[]),n.appendChild(n.artBoards),n.artBoardList=[],n}return v(t,e),t.prototype.setArtBoard=function(e){this.artBoards.clearChildren(),this.artBoardList.splice(0);for(var t=0,r=e.length;t<r;t++){var n=e[t],i="overlay-"+(n.props.name||"画板"),o=new r_({name:i,uuid:"",index:0,style:{fontSize:24,color:n instanceof L_?"#b6e":"#777"},content:n.props.name||"画板"});this.artBoards.appendChild(o),this.artBoardList.push({artBoard:n,text:o})}},t.prototype.updateArtBoard=function(e){for(var t=this.artBoardList,r=0,n=t.length;r<n;r++)if(t[r].artBoard===e){t[r].text.content=e.props.name||"画板";break}},t.prototype.removeArtBoard=function(e){for(var t=this.artBoardList,r=0,n=t.length;r<n;r++)if(t[r].artBoard===e){t.splice(r,1),this.artBoards.removeChild(this.artBoards.children[r]);break}},t.prototype.update=function(){for(var e=this.artBoardList,t=0,r=e.length;t<r;t++){var n=e[t],i=n.artBoard,o=n.text,a=i._rect||i.rect,s=gc({x:a[0],y:a[1]},i.matrixWorld);o.updateStyleData({translateX:s.x,translateY:s.y-32}).length&&o.calMatrix(Nx.TRANSLATE)}},t}(Pw),I_=function(e){function t(t,r){var n=this,i=t.overrideValues||{};return(n=e.call(this,t,r.children.map((function(e){return e.clone(i)})))||this).isSymbolInstance=!0,n.symbolMaster=r,n.symbolInstance=n,r.addSymbolInstance(n),n}return v(t,e),t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=this.symbolMaster.clone(e),i=new t(r,n);return n.addSymbolInstance(i),i.style=Ps(this.style),i.computedStyle=Ps(this.computedStyle),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SYMBOL_INSTANCE,t},t}(VE);function P_(e,t){var r=e.tagName;if(r===l.ART_BOARD||r===l.SYMBOL_MASTER){for(var n=[],i=0,o=e.children.length;i<o;i++){(h=P_(e.children[i],t))&&n.push(h)}if(r===l.SYMBOL_MASTER){var a=(s=e.props).symbolId;return(null==t?void 0:t.symbolMasters[a])||new L_(s,n)}return new Fw(e.props,n)}if(r===l.SYMBOL_INSTANCE){a=(s=e.props).symbolId;var s,c=null==t?void 0:t.symbolMasters[a];if(c)return new I_(s,c)}else{if(r===l.GROUP){n=[];var u=e.children||[];for(i=0,o=u.length;i<o;i++){(h=P_(u[i],t))&&n.push(h)}return new VE(e.props,n)}if(r===l.BITMAP)return new Uw(e.props);if(r===l.TEXT)return new r_(e.props);if(r===l.POLYLINE)return new tE(e.props);if(r===l.SHAPE_GROUP){for(n=[],i=0,o=e.children.length;i<o;i++){var h;(h=P_(e.children[i],t))&&n.push(h)}return new LS(e.props,n)}if(r===l.SLICE)return new QE(e.props)}}function F_(e){var t={};return e.forEach((function(e){D_(e.props.symbolId,e.children||[],t)})),e.sort((function(e,r){var n=e.props.symbolId,i=r.props.symbolId;return t[n]===i?-1:t[i]===n?1:0})),e}function D_(e,t,r){t.forEach((function(t){if(t.tagName===l.SYMBOL_MASTER){var n=t.props.symbolId;r[n]=e,D_(n,t.children||[],r)}else if(t.tagName===l.SYMBOL_INSTANCE)r[t.props.symbolId]=e;else if(t.tagName===l.GROUP){var i=t.children||[];D_(e,i,r)}}))}var N_={parse:P_,sortSymbolMasters:F_},B_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isPage=!0,n.page=n,n}return v(t,e),t.prototype.initIfNot=function(){if(this.json){for(var e=0,t=this.json.children,r=t.length;e<r;e++){var n=P_(t[e],this.root);n&&this.appendChild(n)}return this.json=void 0,!0}return!1},t.prototype.zoomTo=function(e,t,r){if(void 0===t&&(t=.5),void 0===r&&(r=.5),this.root&&!this.isDestroyed){var n=this.getComputedStyle(),i=n.translateX,o=n.translateY;if(n.scaleX!==e){var a=lc(this.matrixWorld),s=this.root,l=s.width,c=s.height,u=s.dpi,h={x:t*l/u*u,y:r*c/u*u},d=gc(h,a),f=gc(d,Pc(Hu({translateX:i,translateY:o,scaleX:e,scaleY:e}))),p=f.x-h.x/u,v=f.y-h.y/u;this.updateStyle({translateX:i-p,translateY:o-v,scaleX:e,scaleY:e})}}else this.updateStyle({scaleX:e,scaleY:e})},t.prototype.zoomActual=function(){return this.updateStyle({scaleX:1,scaleY:1}).keys.length>0},t.prototype.zoomFit=function(){var e=this.children;if(e.length&&this.root){for(var t=e[0],r=t.rect,n=r[0],i=r[1],o=r[2],a=r[3],s=t.matrix,l=gc({x:n,y:i},s),c=gc({x:n,y:a},s),u=gc({x:o,y:i},s),h=gc({x:o,y:a},s),d=Math.min(l.x,c.x,u.x,h.x),f=Math.min(l.y,c.y,u.y,h.y),p=Math.max(l.x,c.x,u.x,h.x),v=Math.max(l.y,c.y,u.y,h.y),m=1,g=e.length;m<g;m++){var y=e[m],b=y.rect,x=b[0],w=b[1],E=b[2],_=b[3],S=y.matrix,C=gc({x:x,y:w},S),T=gc({x:x,y:_},S),A=gc({x:E,y:w},S),k=gc({x:E,y:_},S);d=Math.min(d,C.x,T.x,A.x,k.x),f=Math.min(f,C.y,T.y,A.y,k.y),p=Math.max(p,C.x,T.x,A.x,k.x),v=Math.max(v,C.y,T.y,A.y,k.y)}var M=p-d,O=v-f;if(M&&O){var L=d-.05*M,R=f-.05*O;M*=1.1,O*=1.1;var I=this.root,P=I.width,F=I.height,D=I.dpi,N=(P=Math.max(P,100)/D)/M,B=(F=Math.max(F,100)/D)/O;return N>=B?this.updateStyle({translateX:-L*B-.5*(M*B-P),translateY:-R*B,scaleX:B,scaleY:B}):this.updateStyle({translateX:-L*N,translateY:-R*N-.5*(O*N-F),scaleX:N,scaleY:N}),!0}}},t.prototype.getZoom=function(e){void 0===e&&(e=!1);var t=this.computedStyle.scaleX;return!e&&this.root?t*this.root.dpi:t},t.prototype.clone=function(e){var r=Ps(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Ps(this.style),n.computedStyle=Ps(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.PAGE,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n,i;return Q(this,(function(o){switch(o.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=o.sent())._class=ee.ClassValue.Page,n.hasClickThrough=!0,n.horizontalRulerData={_class:"rulerData",base:0,guides:[]},n.verticalRulerData={_class:"rulerData",base:0,guides:[]},[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t,r)})))];case 2:return i=o.sent(),n.layers=i.map((function(e){return e})),[2,n]}}))}))},t}(Pw);function U_(e,t,r){var n=e.parent;r?(e.checkPosSizeUpward(),e.clearCacheUpward(!1),e.destroy()):(e.layout({w:n.width,h:n.height}),t&&e.didMount(),e.checkPosSizeUpward(),e.clearCacheUpward(!1))}var z_,X_={checkReflow:U_},H_=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this,t,r)||this;return n.ani=[],n.aniChange=!1,n.dpi=t.dpi,n.root=n,n.programs={},n.refs={},n.symbolMasters={},n.structs=[],n.isAsyncDraw=!1,n.task=[],n.taskClone=[],n.rl=Nx.REBUILD,n.imgLoadingCount=0,n.imgLoadList=[],n.firstDraw=!0,n.tileRecord={},n.tileLastIndex=0,n.tileRemain=!1,n.breakMerge=!1,n.scale=1,n.scaleIndex=0,n.pageContainer=new Pw({name:"pageContainer",uuid:"pageContainer",index:0,style:{width:"100%",height:"100%",pointerEvents:!1,scaleX:n.dpi,scaleY:n.dpi,transformOrigin:[0,0]}},[]),n.overlay=new R_({name:"overlay",uuid:"overlay",index:1,style:{width:"100%",height:"100%",pointerEvents:!1}},[]),n.appendChild(n.pageContainer),n.appendChild(n.overlay),n}return v(t,e),t.prototype.appendTo=function(e){this.canvas=e;var t=Object.assign(KE,this.props.contextAttributes),r=e.getContext("webgl2",t);if(r?this.isWebgl2=!0:(r=e.getContext("webgl",t),this.isWebgl2=!1),!r)throw new Error("Webgl unsupported!");this.appendToGl(r)},t.prototype.appendToGl=function(e){this.ctx?fl.error("Duplicate appendToGl"):(this.ctx=e,bs.init(e.getParameter(e.MAX_TEXTURE_SIZE),e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),e.getParameter(e.MAX_VARYING_VECTORS)),this.initShaders(e),this.tileManager=new xw(e),this.willMount(),this.structs=this.structure(0),Tw.addRoot(this),this.reLayout(),this.didMount(),this.addUpdate(this,[],Nx.REFLOW))},t.prototype.initShaders=function(e){var t=this.programs.program=Qx(e,"#define GLSLIFY 1\nattribute vec2 a_position;varying vec4 v_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;attribute float a_opacity;varying float v_opacity;void main(){gl_Position=vec4(a_position,0,1);v_position=gl_Position;v_texCoords=a_texCoords;v_opacity=a_opacity;}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;varying vec2 v_texCoords;varying float v_opacity;uniform float x1;uniform float y1;uniform float x2;uniform float y2;uniform sampler2D u_texture;void main(){if(v_position.x<x1||v_position.x>x2||v_position.y<y1||v_position.y>y2){discard;}float opacity=v_opacity;if(opacity<=0.0){discard;}opacity=clamp(opacity,0.0,1.0);vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color*opacity;}");this.programs.bgColorProgram=Qx(e,"#define GLSLIFY 1\nattribute vec2 a_position;void main(){gl_Position=vec4(a_position,0,1);}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nuniform vec4 u_color;void main(){gl_FragColor=u_color;}"),this.programs.bgShadowProgram=Qx(e,"#define GLSLIFY 1\nattribute vec2 a_position;varying vec2 v_position;void main(){gl_Position=vec4(a_position,0,1);v_position=a_position;}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nuniform vec2 u_tl;uniform vec2 u_br;uniform vec2 u_radius;uniform vec4 u_color;varying vec2 v_position;void main(){if(v_position.x<u_tl.x&&v_position.y<u_tl.y){float dx=abs(v_position.x-u_tl.x);float dy=abs(v_position.y-u_tl.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x<u_tl.x&&v_position.y>u_br.y){float dx=abs(v_position.x-u_tl.x);float dy=abs(v_position.y-u_br.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x>u_br.x&&v_position.y>u_br.y){float dx=abs(v_position.x-u_br.x);float dy=abs(v_position.y-u_br.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x>u_br.x&&v_position.y<u_tl.y){float dx=abs(v_position.x-u_br.x);float dy=abs(v_position.y-u_tl.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x<u_tl.x){float d=abs(v_position.x-u_tl.x);if(d<=u_radius.x){float a=(u_radius.x-d)/u_radius.x;gl_FragColor=u_color*a*a;}}else if(v_position.y>u_br.y){float d=abs(v_position.y-u_br.y);if(d<=u_radius.y){float a=(u_radius.y-d)/u_radius.y;gl_FragColor=u_color*a*a;}}else if(v_position.x>u_br.x){float d=abs(v_position.x-u_br.x);if(d<=u_radius.x){float a=(u_radius.x-d)/u_radius.x;gl_FragColor=u_color*a*a;}}else if(v_position.y<u_tl.y){float d=abs(v_position.y-u_tl.y);if(d<=u_radius.y){float a=(u_radius.y-d)/u_radius.y;gl_FragColor=u_color*a*a;}}}"),this.programs.simpleProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color;}"),this.programs.maskProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a<=0.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}gl_FragColor=color2*color1.a;}"),this.programs.maskGrayProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;uniform vec2 u_d;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a<=0.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords+u_d);if(color2.a<=0.0){discard;}float gray=max(color1.r,max(color1.g,color1.b));gl_FragColor=color2*color1.a*gray;}"),this.programs.clipProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a>=1.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}gl_FragColor=color2*(1.0-color1.a);}"),this.programs.multiplyProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return((1.0-a2/a3)*c1*255.0+a2/a3*((1.0-a1)*c2*255.0+a1*c3*255.0))/255.0;}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=bottom*top;float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.screenProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.overlayProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(top.r,bottom.r),op(top.g,bottom.g),op(top.b,bottom.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.darkenProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return min(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.lightenProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return max(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorDodgeProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==1.0){return a==0.0 ? a : 1.0;}return min(1.0,a/(1.0-b));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorBurnProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==0.0){return a==1.0 ? a : 0.0;}return 1.0-min(1.0,(1.0-a)/b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.hardLightProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.softLightProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5? a-(1.0-2.0*b)*a*(1.0-a): a+(2.0*b-1.0)*((a<=0.25?((16.0*a-12.0)*a+4.0)*a: sqrt(a))-a);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.differenceProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return abs(a-b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.exclusionProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-2.0*a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.hueProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(a);float l=getLuminosity(a);return setLuminosity(setSaturation(b,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.saturationProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(b);float l=getLuminosity(a);return setLuminosity(setSaturation(a,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(a);return setLuminosity(b,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.luminosityProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(b);return setLuminosity(a,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.dropShadowProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_color;void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a<=0.0){discard;}gl_FragColor=u_color*c.a;}"),this.programs.innerShadowProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_color;void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){discard;}gl_FragColor=u_color;}"),this.programs.tintProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_tint;void main(){vec4 color=texture2D(u_texture,v_texCoords);if(color.a<=0.0){discard;}gl_FragColor=u_tint*color.a;}"),this.programs.cmProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_m[20];void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){c.rgb/=c.a;}vec4 result;result.r=(u_m[0]*c.r);result.r+=(u_m[1]*c.g);result.r+=(u_m[2]*c.b);result.r+=(u_m[3]*c.a);result.r+=u_m[4];result.g=(u_m[5]*c.r);result.g+=(u_m[6]*c.g);result.g+=(u_m[7]*c.b);result.g+=(u_m[8]*c.a);result.g+=u_m[9];result.b=(u_m[10]*c.r);result.b+=(u_m[11]*c.g);result.b+=(u_m[12]*c.b);result.b+=(u_m[13]*c.a);result.b+=u_m[14];result.a=(u_m[15]*c.r);result.a+=(u_m[16]*c.g);result.a+=(u_m[17]*c.b);result.a+=(u_m[18]*c.a);result.a+=u_m[19];gl_FragColor=vec4(result.rgb*result.a,result.a);}"),this.programs.boxProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_pw;uniform float u_ph;uniform int u_r;uniform int u_direction;const int MAX_KERNEL_SIZE=2048;void main(){vec4 color=texture2D(u_texture,v_texCoords);float total=1.0;if(u_r==0){if(u_direction==0){color+=texture2D(u_texture,vec2(v_texCoords.x+u_pw,v_texCoords.y))*0.125;color+=texture2D(u_texture,vec2(v_texCoords.x-u_pw,v_texCoords.y))*0.125;}else{color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y+u_ph))*0.125;color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y-u_ph))*0.125;}total+=0.25;}else{for(int i=1;i<MAX_KERNEL_SIZE;i++){if(u_direction==0){float offset=float(i)*u_pw;color+=texture2D(u_texture,vec2(v_texCoords.x+offset,v_texCoords.y));color+=texture2D(u_texture,vec2(v_texCoords.x-offset,v_texCoords.y));}else{float offset=float(i)*u_ph;color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y+offset));color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y-offset));}total+=2.0;if(i>=u_r){break;}}}gl_FragColor=color/total;}"),this.programs.dualDownProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform float u_x;uniform float u_y;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords)*4.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,u_y));color+=texture2D(u_texture,v_texCoords+vec2(u_x,-u_y));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,u_y));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,-u_y));gl_FragColor=color*0.125;}"),this.programs.dualUpProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform float u_x;uniform float u_y;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords+vec2(u_x,u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,-u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(-u_x,u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(-u_x,-u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,0.0));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,0.0));color+=texture2D(u_texture,v_texCoords+vec2(0.0,u_y));color+=texture2D(u_texture,v_texCoords+vec2(0.0,-u_y));gl_FragColor=color/12.0;}"),this.programs.motionProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform int u_kernel;uniform vec2 u_velocity;const int MAX_KERNEL_SIZE=2048;void main(void){vec4 color=texture2D(u_texture,v_texCoords);int k=u_kernel-1;for(int i=1;i<MAX_KERNEL_SIZE-1;i++){if(i==k){break;}vec2 bias=u_velocity*(float(i)/float(k)-0.5);color+=texture2D(u_texture,v_texCoords+bias);}gl_FragColor=color/float(k);}"),this.programs.radialProgram=Qx(e,ZE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform int u_kernel;uniform vec2 u_center;uniform float u_ratio;const int MAX_KERNEL_SIZE=2048;void main(void){if(v_texCoords.x==u_center.x&&v_texCoords.y==u_center.y){gl_FragColor=texture2D(u_texture,v_texCoords);return;}vec4 color=texture2D(u_texture,v_texCoords);int k=u_kernel-1;float total=1.0;for(int i=1;i<MAX_KERNEL_SIZE-1;i++){if(i==k){break;}total++;vec2 velocity=-(v_texCoords-u_center)*u_ratio;vec2 bias=velocity*(float(i)/float(k));color+=texture2D(u_texture,v_texCoords+bias);}gl_FragColor=color/total;}"),this.programs.tileProgram=Qx(e,JE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;uniform float u_x1;uniform float u_y1;uniform float u_x2;uniform float u_y2;uniform float u_width;uniform float u_height;uniform int u_count;void main(){if(v_position.x>u_x1+u_width&&v_position.x<u_x2-u_width&&v_position.y>u_y1+u_height&&v_position.y<u_y2-u_height){if(u_count==0){gl_FragColor+=vec4(0.0,0.0,0.5,0.1);}else{gl_FragColor+=vec4(0.0,0.0,0.0,0.1);}}if(v_position.x>=u_x1-u_width&&v_position.x<=u_x1+u_width&&v_position.y>=u_y1&&v_position.y<=u_y2){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.x>=u_x2-u_width&&v_position.x<=u_x2+u_width&&v_position.y>=u_y1&&v_position.y<=u_y2){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.y>=u_y1-u_height&&v_position.y<=u_y1+u_height&&v_position.x>=u_x1+u_width&&v_position.x<=u_x2-u_width){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.y>=u_y2-u_height&&v_position.y<=u_y2+u_height&&v_position.x>=u_x1+u_width&&v_position.x<=u_x2-u_width){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}}"),this.programs.sliceProgram=Qx(e,JE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;uniform float u_x1;uniform float u_y1;uniform float u_x2;uniform float u_y2;uniform float u_width;uniform float u_height;void main(){if(v_position.x>=u_x1&&v_position.x<=u_x1+u_width*2.0&&v_position.y>=u_y1&&v_position.y<=u_y2){if(v_position.y<=u_y1+u_height*2.0||v_position.y>=u_y2-u_height*2.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int y=int((v_position.y-u_y1+u_height)/u_height);int p=int(y/12);if(y-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.x>=u_x2-u_width*2.0&&v_position.x<=u_x2&&v_position.y>=u_y1&&v_position.y<=u_y2){if(v_position.y<u_y1+u_height*2.0||v_position.y>u_y2-u_height*2.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int y=int((v_position.y-u_y1+u_height)/u_height);int p=int(y/12);if(y-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.y>=u_y1&&v_position.y<=u_y1+u_height*2.0&&v_position.x>=u_x1+u_width*2.0&&v_position.x<=u_x2-u_width*2.0){if(v_position.x<u_x1+u_width*4.0||v_position.x>u_x2-u_width*4.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int x=int((v_position.x-u_x1+u_width)/u_width);int p=int(x/12);if(x-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.y>=u_y2-u_height*2.0&&v_position.y<=u_y2&&v_position.x>=u_x1+u_width*2.0&&v_position.x<=u_x2-u_width*2.0){if(v_position.x<u_x1+u_width*4.0||v_position.x>u_x2-u_width*4.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int x=int((v_position.x-u_x1+u_width)/u_width);int p=int(x/12);if(x-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}}"),e.useProgram(t)},t.prototype.checkRoot=function(){var e,t=this.style,r=t.width,n=t.height,i=this.canvas;r.u===Xs.AUTO?i&&(r.u=Xs.PX,this.width=this.computedStyle.width=r.v=Math.max(1,i.width)):this.width=this.computedStyle.width=Math.max(1,this.style.width.v),n.u===Xs.AUTO?i&&(n.u=Xs.PX,this.height=this.computedStyle.height=n.v=Math.max(1,i.height)):this.height=this.computedStyle.height=Math.max(1,this.style.height.v),null===(e=this.ctx)||void 0===e||e.viewport(0,0,this.width,this.height)},t.prototype.setJPages=function(e){var t=this;this.pageContainer.clearChildren(),this.lastPage=void 0,e.forEach((function(e){var r=new B_(e.props,[]);r.json=e,t.pageContainer.appendChild(r)}))},t.prototype.setPages=function(e){var t=this;this.pageContainer.clearChildren(),this.lastPage=void 0,e.forEach((function(e){return t.pageContainer.appendChild(e)}))},t.prototype.getPageIndex=function(){for(var e=this.pageContainer.children,t=0,r=e.length;t<r;t++)if(this.lastPage===e[t])return t;return-1},t.prototype.setPageIndex=function(e){if(!(e<0||e>=this.pageContainer.children.length)){if(this.lastPage){if(this.lastPage===this.pageContainer.children[e])return;this.lastPage.updateStyle({visibility:"hidden"})}this.lastPage=void 0;var t=this.pageContainer.children[e];t.initIfNot(),t.updateStyle({visibility:"visible"}),this.lastPage=t;var r=[];return t.children.forEach((function(e){e instanceof Fw&&r.push(e)})),this.overlay.setArtBoard(r),t}},t.prototype.addUpdate=function(e,t,r,n,i,o){if(void 0===r&&(r=Nx.NONE),void 0===n&&(n=!1),void 0===i&&(i=!1),this.isDestroyed)return Nx.NONE;e===this&&this.pageTexture&&(t.indexOf("width")>-1||t.indexOf("height")>-1)&&(this.ctx.deleteTexture(this.pageTexture),this.pageTexture=void 0);var a=r;if(t&&t.length)for(var s=0,l=t.length;s<l;s++){a|=jx(t[s])}if(i){e instanceof Fw&&this.overlay.removeArtBoard(e),this.emit(_w.WILL_REMOVE_DOM,e);var c=e.props.uuid;c&&this.tileRecord[c]&&delete this.tileRecord[c]}return(n||i)&&(a|=Nx.REFLOW|Nx.REBUILD),this.calUpdate(e,a,n,i)?this.asyncDraw(o):(o&&o(!0),this.imgLoadingCount||this.breakMerge||this.tileRemain||this.emit(_w.REFRESH_COMPLETE,Nx.NONE)),this.lastPage&&e.page&&(n?this.emit(_w.DID_ADD_DOM,e):!i&&t.length&&this.emit(_w.STYLE_CHANGED,e,t)),a},t.prototype.calUpdate=function(e,t,r,n){if(t===Nx.NONE||this.isDestroyed)return!1;var i=bs.tile&&!this.firstDraw&&!e.isPage;if(i&&t>Nx.CACHE&&bw.clean(e.cleanTile()),Hx(t))e===this?this.reLayout():(U_(e,r,n),i&&r&&(this.tileRecord[e.props.uuid]=e));else{if(t>=Nx.REPAINT)e.calRepaintStyle(t);else{var o=e.style,a=e.computedStyle;t&Nx.TRANSFORM_ALL&&e.calMatrix(t),t&(Nx.TRANSLATE|Nx.ROTATE_Z)&&(e.checkPosSizeUpward(),i&&(this.tileRecord[e.props.uuid]=e)),t&Nx.OPACITY&&e.calOpacity(),t&Nx.FILTER&&(e.calFilter(t),i&&(this.tileRecord[e.props.uuid]=e)),t&Nx.MIX_BLEND_MODE&&(a.mixBlendMode=o.mixBlendMode.v);var s=!1;if(t&Nx.MASK&&(a.maskMode=o.maskMode.v,e.clearMask(!0),s=!0,e.checkPosSizeUpward(),e.calMask(),i))for(var l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Qs.NONE;)a.maskMode!==Qs.NONE?bw.clean(l.cleanTile()):this.tileRecord[l.props.uuid]=l,l=l.next;if(t&Nx.BREAK_MASK){a.breakMask=o.breakMask.v;var c=e.mask;e.calMask();var u=e.mask;if(a.breakMask&&c){if(c.clearMask(!0),c.checkPosSizeUpward(),i&&!a.maskMode){this.tileRecord[e.props.uuid]=e;for(l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Qs.NONE;)this.tileRecord[l.props.uuid]=l,l=l.next}}else if(!a.breakMask&&u){if(i&&!a.maskMode){bw.clean(e.cleanTile());for(l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Qs.NONE;)bw.clean(l.cleanTile()),l=l.next}}else t&=Nx.FULL^Nx.BREAK_MASK;if(!a.breakMask||c)for(var h=e.prev;h;){if(h.computedStyle.maskMode){h.clearMask(!0);break}if(h.computedStyle.breakMask)break;h=h.prev}}a.maskMode&&!s&&t>Nx.CACHE&&e.clearMask(!0)}e.clearCacheUpward(!1)}var d=e.mask;if(!(d&&t>Nx.CACHE)||t&Nx.MASK||t&Nx.BREAK_MASK||(d.checkPosSizeUpward(),d.clearMask()),e.refreshLevel|=t,this.rl|=t,t&Nx.CACHE)return!0;for(var f=e.parent;f;){if(f.computedStyle.visibility===nl.HIDDEN)return!1;f=f.parent}return t>Nx.NONE},t.prototype.asyncDraw=function(e){this.isAsyncDraw||(Tw.onFrame(this),this.isAsyncDraw=!0),this.task.push(e)},t.prototype.cancelAsyncDraw=function(e){if(e){var t=this.task,r=t.indexOf(e);r>-1&&(t.splice(r,1),t.length||(Tw.offFrame(this),this.isAsyncDraw=!1))}},t.prototype.draw=function(){if(!this.isDestroyed){this.tileRemain=!1,this.breakMerge=!1;var e=this.rl;e>Nx.NONE&&(e>Nx.CACHE&&(this.tileLastIndex=0),this.clear(),this.rl=Nx.NONE,C_(this.ctx,this),this.emit(_w.REFRESH,e),this.firstDraw=!1),this.imgLoadingCount||this.breakMerge||this.tileRemain||this.emit(_w.REFRESH_COMPLETE,e)}},t.prototype.reLayout=function(){this.checkRoot(),this.layout({w:this.width,h:this.height})},t.prototype.clear=function(){var e=this.ctx;e&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT))},t.prototype.destroy=function(){var t;e.prototype.destroy.call(this),Tw.removeRoot(this),this.task.splice(0),this.taskClone.splice(0);var r=this.ctx,n=this.programs;if(r){for(var i in r.deleteProgram(n.program),r.deleteProgram(n.bgColorProgram),r.deleteProgram(n.bgShadowProgram),r.deleteProgram(n.simpleProgram),r.deleteProgram(n.maskProgram),r.deleteProgram(n.maskGrayProgram),r.deleteProgram(n.clipProgram),r.deleteProgram(n.multiplyProgram),r.deleteProgram(n.screenProgram),r.deleteProgram(n.overlayProgram),r.deleteProgram(n.darkenProgram),r.deleteProgram(n.lightenProgram),r.deleteProgram(n.colorDodgeProgram),r.deleteProgram(n.colorBurnProgram),r.deleteProgram(n.hardLightProgram),r.deleteProgram(n.softLightProgram),r.deleteProgram(n.differenceProgram),r.deleteProgram(n.exclusionProgram),r.deleteProgram(n.hueProgram),r.deleteProgram(n.saturationProgram),r.deleteProgram(n.colorProgram),r.deleteProgram(n.luminosityProgram),r.deleteProgram(n.dropShadowProgram),r.deleteProgram(n.innerShadowProgram),r.deleteProgram(n.gaussBlurProgram),r.deleteProgram(n.tintProgram),r.deleteProgram(n.cmProgram),r.deleteProgram(n.boxProgram),r.deleteProgram(n.dualDownProgram),r.deleteProgram(n.dualUpProgram),r.deleteProgram(n.motionProgram),r.deleteProgram(n.radialProgram),r.deleteProgram(n.tileProgram),r.deleteProgram(n.sliceProgram),r)if(0===i.indexOf("programGauss,")){var o=n[i];r.deleteProgram(o)}r.bindTexture(r.TEXTURE_2D,null),null===(t=r.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext()}},t.prototype.before=function(){var e=this.ani,t=this.taskClone=this.task.splice(0);e.length;var r=t.length;this.aniChange=!1,(this.aniChange||r)&&this.draw()},t.prototype.after=function(){for(var e=this.ani,t=this.taskClone.splice(0),r=e.length,n=t.length,i=0;i<r;i++);for(i=0;i<n;i++){var o=t[i];o&&o(!1)}r=e.length,n=this.task.length,r||n||(Tw.offFrame(this),this.isAsyncDraw=!1)},t.prototype.getPages=function(){return this.pageContainer.children},t.prototype.getCurPage=function(){return this.lastPage},t.prototype.getCurPageWithCreate=function(){if(this.lastPage)return this.lastPage;if(this.pageContainer.children.length){var e=this.pageContainer.children[0];return this.setCurPage(e),e}var t=this.addNewPage();return this.setCurPage(t),t},t.prototype.addNewPage=function(e){var t=this.pageContainer;return e||(e=new B_({uuid:s(),index:t.children.length,name:"页面 "+(t.children.length+1),style:{width:100,height:100,visibility:"hidden",transformOrigin:[0,0],pointerEvents:!1},rule:{baseX:0,baseY:0},isLocked:!1,isExpanded:!1},[])),t.appendChild(e),e},t.prototype.setCurPage=function(e){var t=this.pageContainer.children.indexOf(e);this.setPageIndex(t)},t.prototype.getCurPageStructs=function(){var e=this.structs,t=this.lastPage;if(t){var r=t.struct,n=e.indexOf(r);if(-1===n)throw new Error("Unknown index error");return e.slice(n,n+r.total+1)}},t.prototype.getCurPageZoom=function(e){return void 0===e&&(e=!1),this.lastPage?this.lastPage.getZoom(e):this.dpi},t.prototype.zoomTo=function(e,t,r){var n;null===(n=this.lastPage)||void 0===n||n.zoomTo(e,t,r)},t.prototype.zoomActual=function(){var e;return null===(e=this.lastPage)||void 0===e?void 0:e.zoomActual()},t.prototype.zoomFit=function(){var e;return null===(e=this.lastPage)||void 0===e?void 0:e.zoomFit()},t.prototype.toSketchFile=function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,l,c,u,h,d,f;return Q(this,(function(p){switch(p.label){case 0:return this.isDestroyed&&(this.willMount(),this.reLayout(),this.didMount()),t=new ms,r=t.folder("pages"),n=t.folder("images"),i=this.props,o={},a=[],l={document:{pageListHeight:100,pageListCollapsed:0}},this.pageContainer.children.forEach((function(e){var t=e,r=t.props.uuid;a.push({_class:"MSJSONFileReference",_ref_class:"MSImmutablePage",_ref:"pages/"+r}),l[r]={scrollOrigin:"{"+t.computedStyle.translateX+", "+t.computedStyle.translateY+"}",zoomValue:t.getZoom(!0)},o[r]={name:t.props.name||"",artboards:{}},t.children.forEach((function(e){if(e instanceof Fw){var t=e.props.uuid;o[r].artboards[t]={name:e.props.name||""}}}))})),r&&n?[4,Promise.all(this.pageContainer.children.map((function(r){return r.toSketchJson(t,e)})))]:[3,2];case 1:p.sent().forEach((function(e){r.file(e.do_objectID+".json",JSON.stringify(e))})),p.label=2;case 2:return c={commit:"",pagesAndArtboards:o,version:146,compatibilityVersion:99,app:ee.BundleId.PublicRelease,autosaved:0,variant:"NONAPPSTORE",created:{commit:"",appVersion:"99.1",build:0,app:ee.BundleId.PublicRelease,coeditCompatibilityVersion:145,compatibilityVersion:99,version:146,variant:"NONAPPSTORE"},saveHistory:[],appVersion:"99.1",build:0},u={_class:"document",do_objectID:i.uuid||s(),assets:{_class:"assetCollection",do_objectID:(null===(h=i.assets)||void 0===h?void 0:h.uuid)||s(),colorAssets:[],gradientAssets:[],images:[],colors:[],gradients:[],exportPresets:[]},colorSpace:ee.ColorSpace.Unmanaged,currentPageIndex:this.getPageIndex(),foreignLayerStyles:[],foreignSymbols:[],foreignTextStyles:[],foreignSwatches:[],layerStyles:{_class:"sharedStyleContainer",do_objectID:(null===(d=i.layerStyles)||void 0===d?void 0:d.uuid)||s(),objects:[]},layerTextStyles:{_class:"sharedTextStyleContainer",do_objectID:(null===(f=i.layerTextStyles)||void 0===f?void 0:f.uuid)||s(),objects:[]},perDocumentLibraries:[],pages:a},t.file("meta.json",JSON.stringify(c)),t.file("user.json",JSON.stringify(l)),t.file("document.json",JSON.stringify(u)),[2,t]}}))}))},t}(Pw);function G_(e,t,r){if(void 0===r&&(r=z_.APPEND),e.length)if(e.indexOf(t)>-1)fl.error("Can not moveTo self");else{var n=t.parent,i=t.artBoard;n instanceof VE&&(n.fixedPosAndSize=!0);for(var o=0,a=e.length;o<a;o++){var s=e[o];if(r===z_.BEFORE){n&&V_(n,s),t.insertBefore(s);var l=t.prev;s.props.index=.5*(((null==l?void 0:l.props.index)||0)+t.props.index)}else if(r===z_.AFTER){n&&V_(n,s),t.insertAfter(s);var c=t.next;s.props.index=.5*(((null==c?void 0:c.props.index)||1)+t.props.index)}else if(t instanceof Pw)if(V_(t,s),r===z_.PREPEND){t.prependChild(s);c=s.next;s.props.index=.5*((null==c?void 0:c.props.index)||1)}else{t.appendChild(s);l=s.prev;s.props.index=.5*(((null==l?void 0:l.props.index)||0)+1)}s.artBoard=i}n instanceof VE&&(n.fixedPosAndSize=!1,n.checkPosSizeSelf())}}function j_(e,t){G_(e,t,z_.APPEND)}function Y_(e,t){G_(e,t,z_.AFTER)}function W_(e){var t=e.computedStyle,r=t.scaleX,n=t.scaleY,i=t.rotateZ,o=t.transformOrigin;if(r>=0||n>=0)return e.matrix;var a=ic(),s=e.transform;return a[12]=s[12],a[13]=s[13],i&&fc(a,wc(i)),Ic(a,o[0],o[1])}function q_(e,t){if(void 0===t&&(t=!1),!e.page)throw new Error("Node not on a Page");if(e.isPage&&e instanceof B_)return ic();for(var r=e.page,n=e.parent,i=[];n&&n!==r;)i.push(n),n=n.parent;for(var o=ic();i.length;){var a=i.pop();o=ac(o,t?W_(a):a.matrix)}return o=ac(o,t?W_(e):e.matrix)}function V_(e,t){if(t.parent!==e){var r=e.width,n=e.height,i=q_(e),o=e.computedStyle,a=o.scaleX,s=o.scaleY,l=0;if(-1===a){var c=ic();pc(c,a);var u=e.computedStyle.transformOrigin,h=ac(i,Ic(c,u[0],u[1]));l=Math.acos(h[0])}else l=Math.acos(i[0]);var d=gc({x:0,y:0},i),f=gc({x:e.width,y:0},i),p=gc({x:0,y:e.height},i),v={x:f.x-d.x,y:f.y-d.y},m={x:p.x-d.x,y:p.y-d.y},g=ic(),y=function(e){if(!e.page)throw new Error("Node not on a Page");if(e.isPage&&e instanceof B_)return{x:1,y:1};for(var t=e.computedStyle.scaleX,r=e.computedStyle.scaleY,n=e.page,i=e.parent;i&&i!==n;)t*=i.computedStyle.scaleX,r*=i.computedStyle.scaleY,i=i.parent;return{x:t,y:r}}(t);1!==y.x&&pc(g,y.x),1!==y.y&&pc(g,y.y);var b=q_(t,!0),x=Math.acos(b[0])-l;fc(g,-x),-1===a&&pc(g,a),-1===s&&vc(g,s);var w=t.computedStyle.transformOrigin,E=ac(b,Ic(g,w[0],w[1])),_=gc({x:-t.computedStyle.translateX,y:-t.computedStyle.translateY},E),S={x:_.x-d.x,y:_.y-d.y},C=Vl(S.x,S.y,v.x,v.y),T=Vl(S.x,S.y,m.x,m.y),A=Zl(C.x,C.y),k=Zl(T.x,T.y),M=Kl(S.x,S.y,v.x,v.y),O=Kl(S.x,S.y,m.x,m.y),L=.5*Math.PI;M<=L&&O<=L||(M<=L?k=-k:O<=L?A=-A:(A=-A,k=-k));var R=t.style,I=R.left.u===Xs.PX,P=R.right.u===Xs.PX,F=R.top.u===Xs.PX,D=R.bottom.u===Xs.PX,N=R.width.u===Xs.PX,B=R.height.u===Xs.PX;I?(R.left.v=A,P?R.right.v=r-A-t.width:N||(R.right.v=100*(r-A-t.width)/r)):P?(R.right.v=r-A-t.width,N||(R.left.v=100*(r-R.right.v-t.width)/r)):N||R.left.u===Xs.PERCENT&&R.right.u===Xs.AUTO?R.left.v=100*A/r:(R.left.v=100*A/r,R.right.v=100*(r-A-t.width)/r),F?(R.top.v=k,D?R.bottom.v=n-k-t.height:B||(R.bottom.v=100*(n-k-t.height)/n)):D?(R.bottom.v=n-k-t.height,B||(R.top.v=100*(n-R.bottom.v-t.height)/n)):B||R.top.u===Xs.PERCENT&&R.bottom.u===Xs.AUTO?R.top.v=100*k/n:(R.top.v=100*k/n,R.bottom.v=100*(n-k-t.height)/n),R.rotateZ.v=Ec(x),R.scaleX.v=y.x*(-1===a?-1:1),R.scaleY.v=y.y*(-1===s?-1:1)}}function K_(e){if(e.length&&e[0].root){for(var t=e[0].root.structs,r=0,n=e.length;r<n;r++){var i=e[r];if(i.isDestroyed)throw new Error("Can not group a destroyed Node");i.tempIndex=t.indexOf(i.struct)}e.sort((function(e,t){return e.tempIndex-t.tempIndex}))}}function Z_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r>t.height){r-=t.height,r=Math.max(r,1),i.top.u===Xs.PX?o.top=t.top+t.height:i.left.u===Xs.PERCENT&&(o.top=100*(t.top+t.height)/e.parent.height+"%");var a=Object.assign({},t);a.height=0,Object.assign(o,J_(e,a,r)),o.scaleY=-1*t.scaleY}else r=Math.min(r,t.height-1),o.scaleY=t.scaleY,i.top.u===Xs.PX||i.top.u===Xs.PERCENT?(i.top.u===Xs.PX?o.top=t.top+r:o.top=100*(t.top+r)/e.parent.height+"%",i.height.u===Xs.PX||i.height.u===Xs.AUTO&&i.bottom.u===Xs.AUTO?o.height=t.height-r:i.height.u===Xs.PERCENT&&(o.height=100*(t.height-r)/e.parent.height+"%")):i.height.u!==Xs.PX&&i.height.u!==Xs.PERCENT&&i.height.u!==Xs.AUTO||(i.height.u===Xs.PX||i.height.u===Xs.AUTO?o.height=t.height-r:o.height=100*(t.height-r)/e.parent.height+"%");if(n){var s=J_(e,t,-r);s.height&&("number"==typeof s.height?s.height=t.height-2*r:s.height=100*(t.height-2*r)/e.parent.height+"%"),Object.assign(o,s)}return o}function J_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r<-t.height){r+=t.height,r=Math.min(r,-1),i.bottom.u===Xs.PX?o.bottom=t.bottom+t.height:i.bottom.u===Xs.PERCENT&&(o.bottom=100*(t.bottom+t.height)/e.parent.height+"%");var a=Object.assign({},t);a.height=0,Object.assign(o,Z_(e,a,r)),o.scaleY=-1*t.scaleY}else r=Math.max(r,1-t.height),o.scaleY=t.scaleY,i.bottom.u===Xs.PX||i.bottom.u===Xs.PERCENT?(i.bottom.u===Xs.PX?o.bottom=t.bottom-r:o.bottom=100*(t.bottom-r)/e.parent.height+"%",i.height.u===Xs.PX||i.height.u===Xs.AUTO&&i.top.u===Xs.AUTO?o.height=t.height+r:i.height.u===Xs.PERCENT&&(o.height=100*(t.height+r)/e.parent.height+"%")):i.height.u!==Xs.PX&&i.height.u!==Xs.PERCENT&&i.height.u!==Xs.AUTO||(i.height.u===Xs.PX||i.height.u===Xs.AUTO?o.height=t.height+r:o.height=100*(t.height+r)/e.parent.height+"%");if(n){var s=Z_(e,t,-r);s.height&&("number"==typeof s.height?s.height=t.height+2*r:s.height=100*(t.height+2*r)/e.parent.height+"%"),Object.assign(o,s)}return o}function Q_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r>t.width){r-=t.width,r=Math.max(r,1),i.left.u===Xs.PX?o.left=t.left+t.width:i.left.u===Xs.PERCENT&&(o.left=100*(t.left+t.width)/e.parent.width+"%");var a=Object.assign({},t);a.width=0,Object.assign(o,$_(e,a,r)),o.scaleX=-1*t.scaleX}else r=Math.min(r,t.width-1),o.scaleX=t.scaleX,i.left.u===Xs.PX||i.left.u===Xs.PERCENT?(i.left.u===Xs.PX?o.left=t.left+r:o.left=100*(t.left+r)/e.parent.width+"%",i.width.u===Xs.PX||i.width.u===Xs.AUTO&&i.right.u===Xs.AUTO?o.width=t.width-r:i.width.u===Xs.PERCENT&&(o.width=100*(t.width-r)/e.parent.width+"%")):i.width.u!==Xs.PX&&i.width.u!==Xs.PERCENT&&i.width.u!==Xs.AUTO||(i.width.u===Xs.PX||i.width.u===Xs.AUTO?o.width=t.width-r:o.width=100*(t.width-r)/e.parent.width+"%");if(n){var s=$_(e,t,-r);s.width&&("number"==typeof s.width?s.width=t.width-2*r:s.width=100*(t.width-2*r)/e.parent.width+"%"),Object.assign(o,s)}return o}function $_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r<-t.width){r+=t.width,r=Math.min(r,-1),i.right.u===Xs.PX?o.right=t.right+t.width:i.right.u===Xs.PERCENT&&(o.right=100*(t.right+t.width)/e.parent.width+"%");var a=Object.assign({},t);a.width=0,Object.assign(o,Q_(e,a,r)),o.scaleX=-1*t.scaleX}else r=Math.max(r,1-t.width),o.scaleX=t.scaleX,i.right.u===Xs.PX||i.right.u===Xs.PERCENT?(i.right.u===Xs.PX?o.right=t.right-r:o.right=100*(t.right-r)/e.parent.width+"%",i.width.u===Xs.PX||i.width.u===Xs.AUTO&&i.left.u===Xs.AUTO?o.width=t.width+r:i.width.u===Xs.PERCENT&&(o.width=100*(t.width+r)/e.parent.width+"%")):i.width.u!==Xs.PX&&i.width.u!==Xs.PERCENT&&i.width.u!==Xs.AUTO||(i.width.u===Xs.PX||i.width.u===Xs.AUTO?o.width=t.width+r:o.width=100*(t.width+r)/e.parent.width+"%");if(n){var s=Q_(e,t,-r);s.width&&("number"==typeof s.width?s.width=t.width+2*r:s.width=100*(t.width+2*r)/e.parent.width+"%"),Object.assign(o,s)}return o}function eS(e,t,r){var n=r*(t.width/t.height),i=Q_(e,t,.5*-n),o=$_(e,t,.5*n),a=Object.assign({},i,o);if(a.width)if("number"==typeof a.width){var s=a.width-t.width;a.width=t.width+2*s}else{var l=e.parent.width;s=parseFloat(a.width)*l*.01-t.width;a.width=100*(t.width+2*s)/l+"%"}return a}function tS(e,t,r,n){void 0===n&&(n=!1);var i=Z_(e,t,r);if(n){var o=J_(e,t,-r);o.height&&("number"==typeof o.height?o.height=t.height-2*r:o.height=100*(t.height-2*r)/e.parent.height+"%"),Object.assign(i,o)}var a=eS(e,t,n?2*-r:-r);return Object.assign(i,a)}function rS(e,t,r,n){void 0===n&&(n=!1);var i=J_(e,t,r);if(n){var o=Z_(e,t,-r);o.height&&("number"==typeof o.height?o.height=t.height+2*r:o.height=100*(t.height+2*r)/e.parent.height+"%"),Object.assign(i,o)}var a=eS(e,t,n?2*r:r);return Object.assign(i,a)}function nS(e,t,r){var n=r/(t.width/t.height),i=Z_(e,t,.5*-n),o=J_(e,t,.5*n),a=Object.assign({},i,o);if(a.height)if("number"==typeof a.height){var s=a.height-t.height;a.height=t.height+2*s}else{var l=e.parent.height;s=parseFloat(a.height)*l*.01-t.height;a.height=100*(t.height+2*s)/l+"%"}return a}function iS(e,t,r,n){void 0===n&&(n=!1);var i=Q_(e,t,r);if(n){var o=$_(e,t,-r);o.width&&("number"==typeof o.width?o.width=t.width-2*r:o.width=100*(t.width-2*r)/e.parent.width+"%"),Object.assign(i,o)}var a=nS(e,t,n?2*-r:-r);return Object.assign(i,a)}function oS(e,t,r,n){void 0===n&&(n=!1);var i=$_(e,t,r);if(n){var o=Q_(e,t,-r);o.width&&("number"==typeof o.width?o.width=t.width+2*r:o.width=100*(t.width+2*r)/e.parent.width+"%"),Object.assign(i,o)}var a=nS(e,t,n?2*r:r);return Object.assign(i,a)}function aS(e,t,r,n){void 0===n&&(n=!0);var i=e.width,o=e.height,a=o/i;n||(a*=-1);var s=-1/a,l=i+t,c=o+r,u=(c-o+a*i-s*l)/(a-s);return{x:u,y:s*u-s*l+c}}function sS(e,t,r,n,i){void 0===i&&(i=!1);var o=aS(t,r,n,!0),a=o.x,s=o.y,l=Q_(e,t,a-t.width,i);return Object.assign(l,Z_(e,t,s-t.height,i)),l}function lS(e,t,r,n,i){void 0===i&&(i=!1);var o=aS(t,r,n,!1),a=o.x,s=o.y,l=$_(e,t,a-t.width,i);return Object.assign(l,Z_(e,t,s-t.height,i)),l}function cS(e,t,r,n,i){void 0===i&&(i=!1);var o=aS(t,r,n,!1),a=o.x,s=o.y,l=Q_(e,t,a-t.width,i);return Object.assign(l,J_(e,t,s-t.height,i)),l}function uS(e,t,r,n,i){void 0===i&&(i=!1);var o=aS(t,r,n,!0),a=o.x,s=o.y,l=$_(e,t,a-t.width,i);return Object.assign(l,J_(e,t,s-t.height,i)),l}function hS(e,t,r,n){n&&(e.left?"number"==typeof e.left?e.left+=n:e.left=parseFloat(e.left)+n/t.parent.width*100+"%":e.width||(t.style.left.u===Xs.PERCENT?e.left=100*(r.left+n)/t.parent.width+"%":t.style.left.u===Xs.PX&&(e.left=r.left+n)),e.right?"number"==typeof e.right?e.right-=n:e.right=parseFloat(e.right)-n/t.parent.width*100+"%":e.width||(t.style.right.u===Xs.PERCENT?e.right=100*(r.right-n)/t.parent.width+"%":t.style.right.u===Xs.PX&&(e.right=r.right-n)))}function dS(e,t,r,n){n&&(e.top?"number"==typeof e.top?e.top+=n:e.top=parseFloat(e.top)+n/t.parent.height*100+"%":e.height||(t.style.top.u===Xs.PERCENT?e.top=100*(r.top+n)/t.parent.height+"%":t.style.top.u===Xs.PX&&(e.top=r.top+n)),e.bottom?"number"==typeof e.bottom?e.bottom-=n:e.bottom=parseFloat(e.bottom)-n/t.parent.height*100+"%":e.height||(t.style.bottom.u===Xs.PERCENT?e.bottom=100*(r.bottom-n)/t.parent.height+"%":t.style.bottom.u===Xs.PX&&(e.bottom=r.bottom-n)))}function fS(e,t,r){var n=e*r.h/r.w,i=r.y+.5*r.h;return(t.y+.5*t.h-i)*n/r.h}function pS(e,t,r){var n=e*r.w/r.h,i=r.x+.5*r.w;return(t.x+.5*t.w-i)*n/r.w}function vS(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?tS(e,t,r*n.h/i.h,a):Z_(e,t,r*n.h/i.h,a),l=pS(r,n,i);a&&(l*=2),hS(s,e,t,-l);return dS(s,e,t,a?-r*(n.y+.5*n.h-i.y-.5*i.h)*2/i.h:r*(i.y+i.h-n.y-n.h)/i.h),s}function mS(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?rS(e,t,r*n.h/i.h,a):J_(e,t,r*n.h/i.h,a);if(o){var l=pS(r,n,i);a&&(l*=2),hS(s,e,t,l)}var c=0;return c=a?r*(n.y+.5*n.h-i.y-.5*i.h)*2/i.h:r*(n.y-i.y)/i.h,n.y,i.y,i.h,dS(s,e,t,c),s}function gS(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?iS(e,t,r*n.w/i.w,a):Q_(e,t,r*n.w/i.w,a);if(o){var l=fS(r,n,i);a&&(l*=2),dS(s,e,t,-l)}return hS(s,e,t,a?-r*(n.x+.5*n.w-i.x-.5*i.w)*2/i.w:r*(i.x+i.w-n.x-n.w)/i.w),s}function yS(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?oS(e,t,r*n.w/i.w,a):$_(e,t,r*n.w/i.w,a);if(o){var l=fS(r,n,i);a&&(l*=2),dS(s,e,t,l)}return hS(s,e,t,a?r*(n.x+.5*n.w-i.x-.5*i.w)*2/i.w:r*(n.x-i.x)/i.w),s}function bS(e,t,r,n,i,o){var a=vS(e,t,r,n,i);delete o.top,delete o.height,delete o.bottom,void 0!==a.top&&(o.top=a.top),void 0!==a.height&&(o.height=a.height),void 0!==a.bottom&&(o.bottom=a.bottom)}function xS(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=gS(e,t,r,i,o,a,s);if(s)return l;if(a)bS(e,t,n,i,o,l);else{var c=vS(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function wS(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=yS(e,t,r,i,o,a,s);if(s)return l;if(a)bS(e,t,n,i,o,l);else{var c=vS(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function ES(e,t,r,n,i,o){var a=mS(e,t,r,n,i);delete o.top,delete o.height,delete o.bottom,void 0!==a.top&&(o.top=a.top),void 0!==a.height&&(o.height=a.height),void 0!==a.bottom&&(o.bottom=a.bottom)}function _S(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=gS(e,t,r,i,o,a,s);if(s)return l;if(a)ES(e,t,n,i,o,l);else{var c=mS(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function SS(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=yS(e,t,r,i,o,a,s);if(s)return l;if(a)ES(e,t,n,i,o,l);else{var c=mS(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function CS(e){var t=[e],r=e.artBoard||e.page;if(e!==r)for(var n=e.parent;n&&n!==r;)t.unshift(n),n=n.parent;for(var i=ic(),o=0,a=t.length;o<a;o++)i=ac(i,t[o].matrix);return i}function TS(e){var t,r,n,i,o=0,a=0;return e.artBoard||(o=(null===(r=(null===(t=e.page)||void 0===t?void 0:t.props).rule)||void 0===r?void 0:r.baseX)||0,a=(null===(i=(null===(n=e.page)||void 0===n?void 0:n.props).rule)||void 0===i?void 0:i.baseY)||0),{baseX:o,baseY:a}}function AS(e){var t=CS(e),r=e._rect||e.rect,n=bc(r[0],r[1],r[2],r[3],t),i=n.x1,o=n.y1,a=n.x2,s=n.y2,l=n.x3,c=n.y3,u=n.x4,h=n.y4,d=e.computedStyle,f=TS(e),p=f.baseX,v=f.baseY;return{baseX:p,baseY:v,x:Math.min(i,a,l,u)-p,y:Math.min(o,s,c,h)-v,w:r[2]-r[0],h:r[3]-r[1],isFlippedHorizontal:-1===d.scaleX,isFlippedVertical:-1===d.scaleY,rotation:d.rotateZ,opacity:d.opacity,mixBlendMode:d.mixBlendMode,constrainProportions:!!e.props.constrainProportions,matrix:t}}!function(e){e[e.APPEND=0]="APPEND",e[e.PREPEND=1]="PREPEND",e[e.BEFORE=2]="BEFORE",e[e.AFTER=3]="AFTER"}(z_||(z_={}));var kS={moveAppend:j_,movePrepend:function(e,t){G_(e,t,z_.PREPEND)},moveAfter:Y_,moveBefore:function(e,t){G_(e,t,z_.BEFORE)},move:function(e,t,r){var n=e.getStyle();(t||r)&&(e.updateStyle({translateX:e.computedStyle.translateX+t,translateY:e.computedStyle.translateY+r}),e.endPosChange(n,t,r),e.checkPosSizeUpward())},migrate:V_,sortTempIndex:K_,getWholeBoundingClientRect:function(e,t){if(e.length){for(var r=e[0].getBoundingClientRect(t),n=1,i=e.length;n<i;n++){var o=e[n].getBoundingClientRect(t);r.left=Math.min(r.left,o.left),r.right=Math.max(r.right,o.right),r.top=Math.min(r.top,o.top),r.bottom=Math.max(r.bottom,o.bottom)}return r}},resizeTopOperate:Z_,resizeBottomOperate:J_,resizeLeftOperate:Q_,resizeRightOperate:$_,resizeTop:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=Z_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeBottom:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=J_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeLeft:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=Q_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeRight:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=$_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeTopAspectRatioOperate:tS,resizeBottomAspectRatioOperate:rS,resizeLeftAspectRatioOperate:iS,resizeRightAspectRatioOperate:oS,resizeTopLeftAspectRatioOperate:sS,resizeTopRightAspectRatioOperate:lS,resizeBottomLeftAspectRatioOperate:cS,resizeBottomRightAspectRatioOperate:uS,resizeTopMultiArOperate:vS,resizeBottomMultiArOperate:mS,resizeRightMultiArOperate:yS,resizeLeftMultiArOperate:gS,resizeTopLeftMultiArOperate:xS,resizeTopRightMultiArOperate:wS,resizeBottomLeftMultiArOperate:_S,resizeBottomRightMultiArOperate:SS,getBasicMatrix:CS,getBaseCoords:TS,getBasicInfo:AS,toPngBlob:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s;return Q(this,(function(l){return e.isDestroyed?[2]:(t=e.root,e===t?[2,new Promise((function(e,r){t.canvas&&t.canvas.toBlob((function(t){t?e(t):r()}))}))]:(r=e._filterBbox2||e.filterBbox2,n=r[2]-r[0],i=r[3]-r[1],(o=document.createElement("canvas")).width=n,o.height=i,o.style.position="fixed",o.style.left="100%",o.style.top="100%",document.body.appendChild(o),(a=new H_({dpi:1,uuid:"",index:0,style:{width:n,height:i}})).appendTo(o),(s=e.clone()).updateStyle({left:-r[0],top:-r[1],right:"auto",bottom:"auto",width:e.width,height:e.height,translateX:0,translateY:0}),a.getCurPageWithCreate().appendChild(s),[2,new Promise((function(e,t){a.on("REFRESH_COMPLETE",(function(){o.toBlob((function(r){r?e(r):t()}))}))}))]))}))}))}};function MS(e){return e.map((function(e){return e.map((function(e){return Math.round(100*e)}))}))}function OS(e,t){if(t&&!oc(t)){var r=t[0],n=t[1],i=t[4],o=t[5],a=t[12],s=t[13];return e.map((function(e){var t=(1===r?e[0]:e[0]*r)+(i?e[1]*i:0)+a,l=(1===n?e[0]:e[0]*n)+(o?e[1]*o:0)+s;if(4===e.length||6===e.length){var c=(1===r?e[2]:e[2]*r)+(i?e[3]*i:0)+a,u=(1===n?e[2]:e[2]*n)+(o?e[3]*o:0)+s;return 6===e.length?[t,l,c,u,(1===r?e[4]:e[4]*r)+(i?e[5]*i:0)+a,(1===n?e[4]:e[4]*n)+(o?e[5]*o:0)+s]:[t,l,c,u]}return[t,l]}))}return e.map((function(e){return e.slice(0)}))}var LS=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.props=t,n.loaders=[],n.isShapeGroup=!0,n}return v(t,e),t.prototype.didMount=function(){for(var e,t=this.children,r=t.length,n=0;n<r;n++)t[n].didMount();if(this.buildPoints(),null===(e=this.coords)||void 0===e?void 0:e.length){var i=this._rect||this.rect,o=this.width,a=this.height,s=VE.EPS;(Math.abs(i[0])>s||Math.abs(i[1])>s||Math.abs(o-i[2])>s||Math.abs(a-i[3])>s)&&this.adjustPosAndSize({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]})}},t.prototype.lay=function(t){e.prototype.lay.call(this,t),this.coords=void 0},t.prototype.clearPoints=function(){this.coords=void 0,this._rect=void 0,this._bbox=void 0,this.clearCache(!0)},t.prototype.checkShapeChange=function(){for(var e=this.parent;e&&e.isShapeGroup;)e.clearPoints(),e=e.parent},t.prototype.calContent=function(){return this.buildPoints(),this.hasContent=!!this.coords&&this.coords.length>0},t.prototype.buildPoints=function(){var e=this;if(!this.coords){this.coords=[],this.textureOutline.forEach((function(e){return null==e?void 0:e.release()}));for(var r=this.children,n=[],i=!0,o=function(e,o){var a=r[e];if(a.computedStyle.visibility===nl.HIDDEN)return"continue";var s=void 0;if(a instanceof tE||a instanceof t)a.buildPoints(),s=a.coords;else{var l=a.width,c=a.height;s=[[0,0],[l,0],[l,c],[0,c],[0,0]]}var u=a.matrix;if(s&&s.length){var h=void 0;h=a instanceof t?s.map((function(e){return MS(OS(e,u))})):[MS(OS(s,u))];var d=a.computedStyle.booleanOperation;if(i||!d)n=n.concat(h),i=!1;else if(d===Vs.INTERSECT){var f=WE.intersect(n,h);n=f||[]}else if(d===Vs.UNION){var p=[],v=[];if(h.forEach((function(e){e.length<=2?v.push(e):p.push(e)})),p.length){f=WE.union(n,p);n=f||[]}v.length&&(n=n.concat(v))}else if(d===Vs.SUBTRACT){f=WE.subtract(n,h);n=f||[]}else if(d===Vs.XOR){f=WE.xor(n,h);n=f||[]}}},a=0,s=r.length;a<s;a++)o(a);n.forEach((function(t){if(t.length>1){var r=t.map((function(e){return e.map((function(e){return.01*e}))}));e.coords.push(r)}}))}},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t),this.buildPoints();var i=this.coords;if(i&&i.length){var o=this._bbox2||this.bbox2,a=o[0],s=o[1],l=o[2]-a,c=o[3]-s,u=-a*t,h=-s*t;l*=t,c*=t;var d=this.canvasCache=Nw.getInstance(l,c,u,h);d.available=!0;for(var f=this.computedStyle,p=f.fill,v=f.fillOpacity,m=f.fillRule,g=f.fillEnable,y=f.fillMode,b=f.stroke,x=f.strokeEnable,w=f.strokeWidth,E=f.strokePosition,_=f.strokeMode,S=f.strokeDasharray,C=f.strokeLinecap,T=f.strokeLinejoin,A=f.strokeMiterlimit,k=d.list,M=function(e,o){var a=k[e],s=a.x,d=a.y,f=a.os.ctx,M=-s,L=-d;1!==t?f.setLineDash(S.map((function(e){return e*t}))):f.setLineDash(S),f.beginPath(),i.forEach((function(e){Wx(f,e,t,M,L)})),f.closePath();for(var R=function(e,o){if(!g[e]||!v[e])return"continue";var a=p[e],s=void 0,d=y[e];if(f.globalAlpha=v[e],Array.isArray(a)){if(!a[3])return"continue";f.fillStyle=qu(a)}else{if(void 0!==a.url){var b=a.url;if(b){var x=O.loaders[e],w=fl.IMG[b];if(!x&&w&&(x=O.loaders[e]={error:!1,loading:!1,width:w.width,height:w.height,source:w.source}),x)if(x.error||x.loading||!x.source)x.error||x.loading||O.root.imgLoadingCount++;else{var E=O.width,_=O.height,S=E*t,C=_*t,T=fl.getOffscreenCanvas(l,c),A=T.ctx;if(A.beginPath(),i.forEach((function(e){Wx(f,e,t,M,L)})),A.closePath(),A.save(),A.clip(),a.type===rl.TILE)for(var k=null!==(r=a.scale)&&void 0!==r?r:1,R=0,I=Math.ceil(E/k/x.width);R<I;R++)for(var P=0,F=Math.ceil(_/k/x.height);P<F;P++)A.drawImage(x.source,M+R*x.width*t*k,L+P*x.height*t*k,x.width*t*k,x.height*t*k);else if(a.type===rl.FILL){var D=S/x.width,N=C/x.height,B=Math.max(D,N),U=-.5*(x.width*B-S),z=-.5*(x.height*B-C);A.drawImage(x.source,0,0,x.width,x.height,U+M,z+L,x.width*B,x.height*B)}else if(a.type===rl.STRETCH)A.drawImage(x.source,M,L,S,C);else if(a.type===rl.FIT){D=S/x.width,N=C/x.height,B=Math.min(D,N);var X=-.5*(x.width*B-S),H=-.5*(x.height*B-C);A.drawImage(x.source,0,0,x.width,x.height,X+M,H+L,x.width*B,x.height*B)}d!==js.NORMAL&&(f.globalCompositeOperation=Bw(d)),f.drawImage(T.canvas,0,0),d!==js.NORMAL&&(f.globalCompositeOperation="source-over"),T.release()}else O.root.imgLoadingCount++,x=O.loaders[e]=O.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},fl.loadImg(b,(function(t){b===p[e].url&&(x.loading=!1,t.success?(x.error=!1,x.source=t.source,x.width=t.width,x.height=t.height,n.isDestroyed||n.root.addUpdate(n,[],Nx.REPAINT,!1,!1,void 0)):x.error=!0,n.root.imgLoadingCount--)}))}return"continue"}if(a.t===Ws.LINEAR){var G=Nu(a.stops,a.d,M,L,l-2*u,c-2*h),j=f.createLinearGradient(G.x1,G.y1,G.x2,G.y2);G.stop.forEach((function(e){j.addColorStop(e.offset,qu(e.color))})),f.fillStyle=j}else if(a.t===Ws.RADIAL){G=Bu(a.stops,a.d,M,L,l-2*u,c-2*h);var Y=f.createRadialGradient(G.cx,G.cy,0,G.cx,G.cy,G.total);G.stop.forEach((function(e){Y.addColorStop(e.offset,qu(e.color))}));var W=G.matrix;if(W){var q=(s=fl.getOffscreenCanvas(l,c)).ctx;q.beginPath(),i.forEach((function(e){Wx(q,e,t,M,L)})),q.closePath(),q.clip(),q.fillStyle=Y,q.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]),q.fill(m===Js.EVEN_ODD?"evenodd":"nonzero")}else f.fillStyle=Y}else if(a.t===Ws.CONIC){G=Uu(a.stops,a.d,M,L,l-2*u,c-2*h);var V=f.createConicGradient(G.angle,G.cx+M,G.cy+L);G.stop.forEach((function(e){V.addColorStop(e.offset,qu(e.color))})),f.fillStyle=V}}d!==js.NORMAL&&(f.globalCompositeOperation=Bw(d)),s?(f.drawImage(s.canvas,0,0),s.release()):f.fill(m===Js.EVEN_ODD?"evenodd":"nonzero"),d!==js.NORMAL&&(f.globalCompositeOperation="source-over")},I=0,P=p.length;I<P;I++)R(I);f.globalAlpha=1,f.globalCompositeOperation="source-over";var F=O.computedStyle,D=F.innerShadow,N=F.innerShadowEnable;if(D&&D.length){var B=0,U=!1;D.forEach((function(e,r){if(N[r]){U=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.x))+e.spread)*t;B=Math.max(B,n+e.blur*t)}})),U&&(f.save(),f.beginPath(),i.forEach((function(e){Wx(f,e,t,M,L)})),f.closePath(),f.clip(),f.fillStyle="#FFF",f.beginPath(),i.forEach((function(e){Wx(f,e,t,M,L)})),Wx(f,[[-B,-B],[l+B,-B],[l+B,c+B],[-B,c+B],[-B,-B]],1,0,0),f.closePath(),D.forEach((function(e,r){N[r]&&(f.shadowOffsetX=e.x*t,f.shadowOffsetY=e.y*t,f.shadowColor=qu(e.color),f.shadowBlur=e.blur*t,f.fill("evenodd"))})),f.restore(),f.beginPath(),i.forEach((function(e){Wx(f,e,t,M,L)})),f.closePath())}C===$s.ROUND?f.lineCap="round":C===$s.SQUARE?f.lineCap="square":f.lineCap="butt",T===el.ROUND?f.lineJoin="round":T===el.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=A;for(var z=function(e,r){if(!x[e]||!w[e])return"continue";var n=b[e],o=E[e];if(f.globalCompositeOperation=Bw(_[e]),Array.isArray(n))f.strokeStyle=qu(n),f.lineWidth=w[e];else if(n.t===Ws.LINEAR){var a=Nu(n.stops,n.d,M,L,l-2*u,c-2*h),s=f.createLinearGradient(a.x1,a.y1,a.x2,a.y2);a.stop.forEach((function(e){s.addColorStop(e.offset,qu(e.color))})),f.strokeStyle=s}else if(n.t===Ws.RADIAL){a=Bu(n.stops,n.d,M,L,l-2*u,c-2*h);var d=f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.total);a.stop.forEach((function(e){d.addColorStop(e.offset,qu(e.color))}));var p=a.matrix;if(p){var v=fl.getOffscreenCanvas(l,c),m=v.ctx;return m.setLineDash(S),m.lineCap=f.lineCap,m.lineJoin=f.lineJoin,m.miterLimit=f.miterLimit,m.lineWidth=w[e]*t,m.strokeStyle="#F00",m.beginPath(),i.forEach((function(e){Wx(m,e,t,M,L)})),m.closePath(),o===tl.INSIDE?(m.lineWidth=2*w[e]*t,m.save(),m.clip(),m.stroke(),m.restore()):o===tl.OUTSIDE?(m.lineWidth=2*w[e]*t,m.stroke(),m.save(),m.clip(),m.globalCompositeOperation="destination-out",m.strokeStyle="#FFF",m.stroke(),m.restore()):m.stroke(),m.fillStyle=d,m.globalCompositeOperation="source-in",m.setTransform(p[0],p[1],p[4],p[5],p[12],p[13]),m.fillRect(0,0,l,c),f.drawImage(v.canvas,0,0),v.release(),"continue"}f.strokeStyle=d}else if(n.t===Ws.CONIC){a=Uu(n.stops,n.d,M,L,l-2*u,c-2*h);var g=f.createConicGradient(a.angle,a.cx+M,a.cy+L);a.stop.forEach((function(e){g.addColorStop(e.offset,qu(e.color))})),f.strokeStyle=g}var y,C=void 0;o===tl.INSIDE?f.lineWidth=2*w[e]*t:o===tl.OUTSIDE?(C=fl.getOffscreenCanvas(l,c),(y=C.ctx).setLineDash(S),y.lineCap=f.lineCap,y.lineJoin=f.lineJoin,y.miterLimit=f.miterLimit,y.strokeStyle=f.strokeStyle,y.lineWidth=2*w[e]*t,y.beginPath(),i.forEach((function(e){Wx(y,e,t,M,L)}))):f.lineWidth=w[e]*t,y&&y.closePath(),o===tl.INSIDE?(f.save(),f.clip(),f.stroke(),f.restore()):o===tl.OUTSIDE?(y.stroke(),y.save(),y.clip(),y.globalCompositeOperation="destination-out",y.strokeStyle="#FFF",y.stroke(),y.restore(),f.drawImage(C.canvas,M-u,L-h),C.release()):f.stroke()},X=0,H=b.length;X<H;X++)z(X);f.globalCompositeOperation="source-over"},O=this,L=0,R=k.length;L<R;L++)M(L)}},t.prototype.refresh=function(t,r){void 0===t&&(t=Nx.REPAINT),t>=Nx.REPAINT&&(this.coords=void 0),e.prototype.refresh.call(this,t,r)},t.prototype.toSvg=function(e){this.buildPoints();var t=this.computedStyle,r=this.coords||[],n=new Float64Array(this.matrixWorld),i=[],o=0,a=0,s=0,l=0,c=!0;r.forEach((function(e,t){var r=[];e.forEach((function(e,t){if(6===e.length){var i=gc({x:e[0],y:e[1]},n),u=gc({x:e[2],y:e[3]},n),h=gc({x:e[4],y:e[5]},n);r.push([i.x,i.y,u.x,u.y,h.x,h.y]),c?(c=!1,o=Math.min(i.x,u.x,h.x),a=Math.min(i.y,u.y,h.y),s=Math.max(i.x,u.x,h.x),l=Math.max(i.y,u.y,h.y)):(o=Math.min(o,i.x,u.x,h.x),a=Math.min(a,i.y,u.y,h.y),s=Math.max(s,i.x,u.x,h.x),l=Math.max(l,i.y,u.y,h.y))}else if(4===e.length){i=gc({x:e[0],y:e[1]},n),u=gc({x:e[2],y:e[3]},n);r.push([i.x,i.y,u.x,u.y]),c?(c=!1,o=Math.min(i.x,u.x),a=Math.min(i.y,u.y),s=Math.max(i.x,u.x),l=Math.max(i.y,u.y)):(o=Math.min(o,i.x,u.x),a=Math.min(a,i.y,u.y),s=Math.max(s,i.x,u.x),l=Math.max(l,i.y,u.y))}else if(2===e.length){var d=gc({x:e[0],y:e[1]},n);r.push([d.x,d.y]),c?(c=!1,o=d.x,a=d.y,s=d.x,l=d.y):(o=Math.min(o,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),l=Math.max(l,d.y))}})),r.length&&i.push(r)}));var u=s-o,h=l-a,d=1;d=u>=h?e/u:e/h;var f=t.fillRule===Js.EVEN_ODD?"evenodd":"nonzero",p='<svg width="'.concat(u*d,'" height="').concat(h*d,'"><path');if(i.length){var v=[["d",""],["fill","#D8D8D8"],["fill-rule",f],["stroke","#979797"],["stroke-width",1]];i.forEach((function(e){var t=qx(e.map((function(e){return e.map((function(e){return e*d}))})),-o*d,-a*d)+"Z";v[0][1]+=t})),v.forEach((function(e){p+=" "+e[0]+'="'+e[1]+'"'})),p+="></path>"}return p+"</svg>"},t.prototype.clone=function(e){var r=Ps(this.props),n=r.uuid;r.uuid=s(),r.sourceUuid=this.props.uuid;var i=new t(r,this.children.map((function(t){return t.clone(e)})));return i.style=Ps(this.style),e&&e.hasOwnProperty(n)&&e[n].forEach((function(e){var t=e.key,n=e.value;if("fill"===t[0]){var o=parseInt(t[1])||0;r.style.fill[o]=n,i.style.fill[o]={v:Wu(n),u:Xs.RGBA}}})),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SHAPE_GROUP,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r;return Q(this,(function(n){switch(n.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=n.sent())._class=ee.ClassValue.ShapeGroup,[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this),t&&this.loaders.forEach((function(e){e.loading&&(t.imgLoadingCount--,e.loading=!1)}))}},Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;if(!e){e=this._rect=new Float64Array(4),this.buildPoints();var t=this.coords;t&&t.length&&function(e,t){var r=!0;t=t||new Float64Array(4);for(var n=0,i=0,o=0,a=e.length;o<a;o++)for(var s=e[o],l=0,c=s.length;l<c;l++){var u=s[l];if(r){if(!(h=Hw(u,t))){fl.error("Unsupported point data: "+o+":"+l+" - "+u.join(","));continue}n=h.x,i=h.y,r=!1}else{var h;if(!(h=Gw(u,n,i,t))){fl.error("Unsupported point data: "+o+":"+l+" - "+u.join(","));continue}n=h.x,i=h.y}}}(t,e)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.buildPoints();var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=r.strokeLinejoin,s=r.strokeMiterlimit,l=0;n.forEach((function(e,t){i[t]&&(o[t]===tl.INSIDE||(l=o[t]===tl.OUTSIDE?Math.max(l,4*e):Math.max(l,.5*e*4)))}));var c=e[0]-l,u=e[1]-l,h=e[2]+l,d=e[3]+l;(this.coords||[]).forEach((function(t){var r=zw(e,l,t,a,s);e[0]=Math.min(e[0],r[0]),e[1]=Math.min(e[1],r[1]),e[2]=Math.min(e[2],r[2]),e[3]=Math.min(e[3],r[3])})),e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],u),e[2]=Math.max(e[2],h),e[3]=Math.max(e[3],d)}return e},enumerable:!1,configurable:!0}),t.groupAsShape=function(e,r,n){if(void 0===r&&(r=Vs.NONE),e.length){K_(e);var i,o=e[0],a=o.parent;a instanceof VE&&(a.fixedPosAndSize=!0);for(var l=0,c=e.length;l<c;l++){V_(a,u=e[l]),u.style.booleanOperation={v:r,u:Xs.NUMBER}}for(l=0,c=e.length;l<c;l++){var u;if((u=e[l])instanceof tE||u instanceof t){i=u.getCssStyle();break}}i||(i=d());var h=new t(Object.assign({uuid:s(),name:"形状结合",style:{left:"0%",top:"0%",right:"0%",bottom:"0%",fill:i.fill,fillEnable:i.fillEnable,fillRule:i.fillRule,stroke:i.stroke,strokeEnable:i.strokeEnable,strokeWidth:i.strokeWidth,strokePosition:i.strokePosition,strokeDasharray:i.strokeDasharray,strokeLinecap:i.strokeLinecap,strokeLinejoin:i.strokeLinejoin,strokeMiterlimit:i.strokeMiterlimit}},n),[]);h.fixedPosAndSize=!0,o.insertAfter(h);for(l=0,c=e.length;l<c;l++)h.appendChild(e[l]);return h.fixedPosAndSize=!1,a instanceof VE&&(a.fixedPosAndSize=!1),h.checkPosSizeSelf(),h}},t}(VE),RS={ArtBoard:Fw,Bitmap:Uw,Container:Pw,Group:VE,Node:Iw,Page:B_,Root:H_,Slice:QE,SymbolInstance:I_,SymbolMaster:L_,Text:r_,Geom:jw,Polyline:tE,ShapeGroup:LS,reflow:X_,parser:N_};function IS(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,m){void 0===m&&(m=!1);var g=v.fontFamily,y=v.color,b=v.fontSize,x=v.letterSpacing,w=v.lineHeight,E=v.paragraphSpacing,_=v.textAlign;n.includes(g)||n.push(g);var S=jl.data[g];if(S){i.includes(S.family)||(i.push(S.family),o.push(S.name)),r.includes(!0)||r.push(!0);for(var C=S.list,T=0,A=C.length;T<A;T++){var k=C[T];if(k.postscriptName===g){l.includes(k.style)||l.push(k.style);break}}}else i.includes(g)||(i.push(g),o.push(g)),r.includes(!1)||r.push(!1);var M=Ku(y);a.includes(M)||a.push(M),s.includes(b)||s.push(b),c.includes(x)||c.push(x);var O=m?!w:t.u===Xs.AUTO;if(h.includes(O)||h.push(O),O&&S){var L=b*S.lhr;u.includes(L)||u.push(L)}else u.includes(w)||u.push(w);d.includes(E)||d.push(E),f.includes(_)||f.push(_);var R=PS(e);p.includes(R)||p.push(R)}function PS(e){var t=e.style,r=t.left,n=t.right,i=t.top,o=t.bottom,a=t.width,s=t.height,l=il.AUTO,c=a.u===Xs.AUTO&&(r.u===Xs.AUTO||n.u===Xs.AUTO),u=s.u===Xs.AUTO&&(i.u===Xs.AUTO||o.u===Xs.AUTO);return c&&u||(l=u?il.FIXED_W:il.FIXED_W_H),l}function FS(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],c=[],u=[],h=[],d=[],f=[],p=[],v=0,m=e.length;v<m;v++){var g=e[v],y=g.rich,b=g.style,x=g.computedStyle;d.includes(x.textVerticalAlign)||d.push(x.textVerticalAlign);var w=b.lineHeight;if(y&&y.length)for(var E=0,_=y.length;E<_;E++)IS(g,w,t,r,n,i,o,a,p,s,l,c,u,h,f,y[E],!0);else IS(g,w,t,r,n,i,o,a,p,s,l,c,u,h,f,x)}var S=[];return 1===n.length&&(S=DS(n[0])),{valid:t,postscriptName:r,fontFamily:n,name:i,fontWeight:p,fontWeightList:S,color:o,fontSize:a,autoLineHeight:c,lineHeight:l,letterSpacing:s,paragraphSpacing:u,textAlign:h,textVerticalAlign:d,textBehaviour:f}}function DS(e){var t=jl.data[e];return t?t.list.map((function(e){return{label:e.style,value:e.postscriptName}})):[]}function NS(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],c=[],u=[],h=[],d=[e.computedStyle.textVerticalAlign],f=[],p=[],v=e.getCursorRich(),m=e.style.lineHeight,g=0,y=v.length;g<y;g++)IS(e,m,t,r,n,i,o,a,p,s,l,c,u,h,f,v[g],!0);var b=[];return 1===n.length&&(b=DS(n[0])),{valid:t,postscriptName:r,fontFamily:n,name:i,fontWeight:p,fontWeightList:b,color:o,fontSize:a,autoLineHeight:c,lineHeight:l,letterSpacing:s,paragraphSpacing:u,textAlign:h,textVerticalAlign:d,textBehaviour:f}}function BS(e,t){var r={},n=e.getStyle(),i=n.left,o=n.right,a=n.top,s=n.bottom,l=n.width,c=n.height;t===il.AUTO?(l.u!==Xs.AUTO&&(r.width="auto"),c.u!==Xs.AUTO&&(r.height="auto"),i.u!==Xs.AUTO&&o.u!==Xs.AUTO&&(i.u===Xs.PX?r.right="auto":o.u===Xs.PX?r.left="auto":r.right="auto"),a.u!==Xs.AUTO&&s.u!==Xs.AUTO&&(a.u===Xs.PX?r.bottom="auto":s.u===Xs.PX?r.top="auto":r.bottom="auto")):t===il.FIXED_W?(l.u===Xs.PX||i.u===Xs.PX&&o.u===Xs.PX||(r.width=e.width),c.u!==Xs.AUTO&&(r.height="auto"),i.u===Xs.AUTO||o.u===Xs.AUTO||i.u===Xs.PX&&o.u===Xs.PX||(i.u===Xs.PX?o.u===Xs.PERCENT&&(r.right="auto"):o.u===Xs.PX?i.u===Xs.PERCENT&&(r.left="auto"):r.right="auto"),a.u!==Xs.AUTO&&s.u!==Xs.AUTO&&(a.u===Xs.PX?r.bottom="auto":s.u===Xs.PX?r.top="auto":r.bottom="auto")):t===il.FIXED_W_H&&(l.u===Xs.PX||i.u===Xs.PX&&o.u===Xs.PX||(r.width=e.width),c.u===Xs.PX||a.u===Xs.PX&&s.u===Xs.PX||(r.height=e.height),i.u===Xs.AUTO||o.u===Xs.AUTO||i.u===Xs.PX&&o.u===Xs.PX||(i.u===Xs.PX?o.u===Xs.PERCENT&&(r.right="auto"):o.u===Xs.PX?i.u===Xs.PERCENT&&(r.left="auto"):r.right="auto"),a.u===Xs.AUTO||s.u===Xs.AUTO||a.u===Xs.PX&&s.u===Xs.PX||(a.u===Xs.PX?s.u===Xs.PERCENT&&(r.bottom="auto"):s.u===Xs.PX?a.u===Xs.PERCENT&&(r.top="auto"):r.bottom="auto")),e.startSizeChange(),e.updateStyle(r),e.endSizeChange(n),e.checkPosSizeUpward()}function US(e){for(var t,r=e.root,n=e.parent;n&&n!==r&&n instanceof LS;)t=n,n=n.parent;return t}function zS(e,t,r,n,i){var o,a,s=i.getBoundingClientRect();return e>r&&(e=(o=[r,e])[0],r=o[1]),t>n&&(t=(a=[n,t])[0],n=a[1]),s.left>e&&s.top>t&&s.right<r&&s.bottom<n}function XS(e,t,r){for(var n=e.children,i=n.length-1;i>=0;i--){var o=n[i];if(!o.props.isLocked&&o.computedStyle.visibility!==nl.HIDDEN){var a=o.computedStyle,s=o.matrixWorld,l=o._rect||o.rect;if(o instanceof tE){var c=l[2]-l[0],u=l[3]-l[1];(c<2||u<2)&&(l=l.slice(0),c<2&&(l[0]-=.5*(2-c),l[2]+=.5*(2-c)),u<2&&(l[1]-=.5*(2-u),l[3]+=.5*(2-u)))}if(Sc(t,r,l[0],l[1],l[2],l[3],s,!0))if(o instanceof Pw){var h=XS(o,t,r);if(h)return h;if(o instanceof Fw)return o}else if(a.pointerEvents)return o}}}function HS(e,t,r,n,i){for(var o=e.children,a=[],s=0,l=o.length;s<l;s++){var c=o[s];if(!c.props.isLocked&&c.computedStyle.visibility!==nl.HIDDEN){var u=c.matrixWorld,h=c._rect||c.rect,d=bc(h[0],h[1],h[2],h[3],u);if(kc(t,r,n,i,[{x:d.x1,y:d.y1},{x:d.x2,y:d.y2},{x:d.x3,y:d.y3},{x:d.x4,y:d.y4}]))if(c instanceof Pw){var f=HS(c,t,r,n,i);f.length?a.push.apply(a,f):c.computedStyle.pointerEvents&&a.push(c)}else c.computedStyle.pointerEvents&&a.push(c)}}return a}function GS(e,t,r,n,i,o){if(void 0===n&&(n=!1),void 0===i&&(i=[]),void 0===o&&(o=!1),!e.isDestroyed){var a=e.lastPage;if(a){var s=XS(a,t,r);if(s){if(n){if(s instanceof VE){for(var l=s.parent;l&&l!==e;){if(l instanceof Fw)return l;l=l.parent}return}if(s instanceof jw||s instanceof LS){var c=US(s);if(c)return c}return s}if(s instanceof VE&&!(s instanceof LS))return;if(i.length){if(o){for(m=s;m.struct&&m.struct.lv>3;){for(var u=0;u<i.length;u++){var h=i[u];if(m.parent===h)return m;if(m===h&&!(h instanceof Pw))return m}if((l=m.parent)instanceof Fw)break;m=l}return m}var d=s,f=i.slice(0),p=d.struct.lv,v=p;if(f.forEach((function(e,t){if(e.struct.lv>p)for(;e.struct.lv>p;)e=e.parent,f[t]=e;else v=Math.max(v,e.struct.lv)})),v<p)for(;d.struct.lv>v;)d=d.parent;for(;d&&d.struct.lv>3;){for(u=0;u<f.length;u++){h=f[u];if(d.isSibling(h)||d===h)return d}if((l=d.parent)instanceof Fw)break;d=l,f.forEach((function(e,t){e.struct.lv>d.struct.lv&&(f[t]=e.parent)}))}return d}for(var m=s;m&&m.struct.lv>3;){if((l=m.parent)instanceof Fw)break;m=l}return m}}}}function jS(e,t,r){if(!e.isDestroyed){var n=e.lastPage;if(n)for(var i=n.children,o=i.length-1;o>=0;o--){var a=i[o];if(!a.props.isLocked&&a.computedStyle.visibility!==nl.HIDDEN&&a instanceof Fw){var s=a.computedStyle,l=a.matrixWorld,c=a._rect||a.rect;if(s.pointerEvents&&Sc(t,r,c[0],c[1],c[2],c[3],l,!0))return a}}}}function YS(e,t,r){return XS(e.overlay,t,r)}function WS(e,t,r){var n=YS(e,t,r);if(n&&n instanceof r_)for(var i=e.overlay.artBoardList,o=0,a=i.length;o<a;o++){var s=i[o];if(s.text===n)return s.artBoard}}function qS(e,t,r,n,i,o){if(void 0===o&&(o=!1),e.isDestroyed||t===n||r===i)return[];var a=e.lastPage;if(a){var s=HS(a,t,r,n,i);if(s.length){for(var l=[],c=0,u=s.length;c<u;c++){if((f=s[c])instanceof jw||f instanceof LS){var h=US(f);h?-1===l.indexOf(h)&&l.push(h):l.push(f)}else l.push(f)}if(o)return l.filter((function(e){return(!(e instanceof VE)||e instanceof LS)&&!(e instanceof Fw)}));var d=[];e:for(c=0,u=l.length;c<u;c++){var f;if(!((f=l[c])instanceof VE)||f instanceof LS)if(f instanceof Fw)zS(t,r,n,i,f)&&-1===d.indexOf(f)&&d.push(f);else{for(var p=f;p&&p.struct.lv>3;){var v=p.parent;if(v instanceof Fw){if(zS(t,r,n,i,v)){-1===d.indexOf(v)&&d.push(v);continue e}break}p=v}-1===d.indexOf(p)&&d.push(p)}}return d}}return[]}function VS(e,t,r,n,i,o,a,s){var l=e.getBoundingClientRect({excludeDpi:!0}),c=l.left,u=l.right,h=l.top,d=l.bottom;if(!(c>=i||u<=0||h>=o||d<=0)){var f=!1;if(s&&e instanceof VE)for(var p=0,v=s.length;p<v;p++)for(var m=s[p].parent;m&&!m.isPage&&!(m instanceof B_);){if(m===e){f=!0;break}m=m.parent}if(!f){var g=.5*(c+u),y=.5*(h+d),b={left:c,right:u,top:h,bottom:d,center:g,middle:y};if(c>=0&&c<=i){var x=KS(c,t);x>-1&&(!t[x-1]||Math.abs(t[x-1].n-c)>=n)&&(!t[x]||Math.abs(t[x].n-c)>=n)&&t.splice(x,0,{node:e,n:c,r:b})}if(u>=0&&u<=i){var w=KS(u,t);w>-1&&(!t[w-1]||Math.abs(t[w-1].n-u)>=n)&&(!t[w]||Math.abs(t[w].n-u)>=n)&&t.splice(w,0,{node:e,n:u,r:b})}if(g>=0&&g<=i){var E=KS(g,t);E>-1&&(!t[E-1]||Math.abs(t[E-1].n-g)>=n)&&(!t[E]||Math.abs(t[E].n-g)>=n)&&t.splice(E,0,{node:e,n:g,r:b})}if(h>=0&&h<=o){var _=KS(h,r);_>-1&&(!r[_-1]||Math.abs(r[_-1].n-h)>=n)&&(!r[_]||Math.abs(r[_].n-h)>=n)&&r.splice(_,0,{node:e,n:h,r:b})}if(d>=0&&d<=o){var S=KS(d,r);S>-1&&(!r[S-1]||Math.abs(r[S-1].n-d)>=n)&&(!r[S]||Math.abs(r[S].n-d)>=n)&&r.splice(S,0,{node:e,n:d,r:b})}if(y>=0&&y<=o){var C=KS(y,r);C>-1&&(!r[C-1]||Math.abs(r[C-1].n-y)>=n)&&(!r[C]||Math.abs(r[C].n-y)>=n)&&r.splice(C,0,{node:e,n:y,r:b})}}e instanceof VE&&e.children.forEach((function(e){s&&s.includes(e)||VS(e,t,r,n,i,o,a,s)}))}}function KS(e,t){if(!t.length)return 0;if(e<t[0].n)return 0;var r=t.length;if(e>t[r-1].n)return r;for(var n=0,i=r;n<i;){if(n===i-1)return i;var o=Math.round(.5*(n+i));if(e===t[o].n)return o+1;e>t[o].n?n=o:i=o}return n}function ZS(e,t){var r={x:[],y:[]};if(e.isDestroyed)return r;var n=e.lastPage;if(n){var i=Math.max(0,bs.guidesSnap);n.children.forEach((function(n){t&&t.includes(n)||VS(n,r.x,r.y,i,e.width/e.dpi,e.height/e.dpi,e.dpi,t)}))}return r}function JS(e,t,r){void 0===r&&(r=!1);var n=e.style,i=e.computedStyle,o=t.x,a=t.y,s=t.parent,l=Ps(n.top),c=Ps(n.right),u=Ps(n.bottom),h=Ps(n.left),d=Ps(n.width),f=Ps(n.height);n.left={v:o,u:Xs.PX},n.right={v:0,u:Xs.AUTO},n.top={v:a,u:Xs.PX},n.bottom={v:0,u:Xs.AUTO},n.width={v:i.width,u:Xs.PX},n.height={v:i.height,u:Xs.PX},QS(s,e,r),h.u===Xs.PERCENT?n.left={v:100*i.left/s.width,u:Xs.PERCENT}:h.u===Xs.PX?n.left={v:i.left,u:Xs.PX}:h.u===Xs.AUTO&&(n.left={v:0,u:Xs.AUTO}),c.u===Xs.PERCENT?n.right={v:100*i.right/s.width,u:Xs.PERCENT}:c.u===Xs.PX?n.right={v:i.right,u:Xs.PX}:c.u===Xs.AUTO&&(n.right={v:0,u:Xs.AUTO}),l.u===Xs.PERCENT?n.top={v:100*i.top/s.height,u:Xs.PERCENT}:l.u===Xs.PX?n.top={v:i.top,u:Xs.PX}:l.u===Xs.AUTO&&(n.top={v:0,u:Xs.AUTO}),u.u===Xs.PERCENT?n.bottom={v:100*i.bottom/s.height,u:Xs.PERCENT}:u.u===Xs.PX?n.bottom={v:i.bottom,u:Xs.PX}:u.u===Xs.AUTO&&(n.bottom={v:0,u:Xs.AUTO}),d.u===Xs.PERCENT?n.width={v:100*i.width/s.width,u:Xs.PERCENT}:d.u===Xs.PX?n.width={v:i.width,u:Xs.PX}:d.u===Xs.AUTO&&(n.width={v:0,u:Xs.AUTO}),f.u===Xs.PERCENT?n.height={v:100*i.height/s.height,u:Xs.PERCENT}:f.u===Xs.PX?n.height={v:i.height,u:Xs.PX}:f.u===Xs.AUTO&&(n.height={v:0,u:Xs.AUTO})}function QS(e,t,r){var n,i;void 0===r&&(r=!1);var o=e.children;if(o.length)for(var a=0,s=o.length;a<s;a++){var l=o[a];if(t.props.index<l.props.index){l.insertBefore(t),r&&(t.props.index=.5*(l.props.index+((null===(n=o[a+1])||void 0===n?void 0:n.props.index)||1)));break}if(a===s-1){e.appendChild(t),r&&(t.props.index=.5*(((null===(i=o[a-1])||void 0===i?void 0:i.props.index)||0)+1));break}}else e.appendChild(t),r&&(t.props.index=.5)}function $S(e,t,r,n,i){var o=[];if(t===n||r===i)return o;e.buildPoints();var a=e.matrixWorld,s=e._rect||e.rect,l=[{x:s[0],y:s[1]},{x:s[2],y:s[1]},{x:s[2],y:s[3]},{x:s[0],y:s[3]}].map((function(e){return gc(e,a)}));return kc(t,r,n,i,l)?(e.props.points.forEach((function(e,s){var l=gc({x:e.absX,y:e.absY},a);Sc(l.x,l.y,t,r,n,i)&&o.push(s)})),o):o}function eC(e,t){var r=CS(e);t||(t=e.props.points);var n=TS(e),i=n.baseX,o=n.baseY;(Array.isArray(t)?t:[t]).forEach((function(e){var t=gc({x:e.absX-i,y:e.absY-o},r),n=gc({x:e.absFx-i,y:e.absFy-o},r),a=gc({x:e.absTx-i,y:e.absTy-o},r);e.dspX=t.x,e.dspY=t.y,e.dspFx=n.x,e.dspFy=n.y,e.dspTx=a.x,e.dspTy=a.y}))}function tC(e,t){var r=CS(e);t||(t=e.props.points);var n=lc(r),i=TS(e),o=i.baseX,a=i.baseY;(Array.isArray(t)?t:[t]).forEach((function(e){var t=gc({x:e.dspX+o,y:e.dspY+a},n),r=gc({x:e.dspFx+o,y:e.dspFy+a},n),i=gc({x:e.dspTx+o,y:e.dspTy+a},n);e.absX=t.x,e.absY=t.y,e.absFx=r.x,e.absFy=r.y,e.absTx=i.x,e.absTy=i.y}))}function rC(e,t){if(e.length){K_(e);var r=e[0],n=r.parent;if(n instanceof VE&&(n.fixedPosAndSize=!0),!t){var i=Object.assign({uuid:s(),name:"编组",style:{left:"0%",top:"0%",right:"0%",bottom:"0%"}});t=new VE(i,[])}t.fixedPosAndSize=!0,r.insertAfter(t);for(var o=0,a=e.length;o<a;o++){V_(t,e[o])}for(o=0,a=e.length;o<a;o++)t.appendChild(e[o]);return t.fixedPosAndSize=!1,n instanceof VE&&(n.fixedPosAndSize=!1),t.checkPosSizeSelf(),t}}function nC(e){if(!e.isDestroyed&&e.parent){e.fixedPosAndSize=!0;var t=e.parent;t instanceof VE&&(t.fixedPosAndSize=!0);for(var r=e,n=e.children.slice(0),i=0,o=n.length;i<o;i++){var a=n[i];V_(t,a),r.insertAfter(a),r=a}return t instanceof VE&&(t.fixedPosAndSize=!1),e.fixedPosAndSize=!1,e.remove(),{children:n,parent:t}}fl.error("Can not unGroup a destroyed Node")}var iC,oC={node:kS,text:{TEXT_BEHAVIOUR:il,SIZE_LIST:[6,7,8,9,10,11,12,14,16,18,20,21,24,36,48,60,72],getTextInfo:FS,getEditTextInfo:NS,getTextBehaviour:PS,setTextBehaviour:BS,getFontWeightList:DS},root:{getNodeByPoint:GS,getArtBoardByPoint:jS,getOverlayNodeByPoint:YS,getOverlayArtBoardByPoint:WS,getFrameNodes:qS,getGuidesNodes:ZS,search2:KS},container:{appendWithPosAndSize:JS,appendWithIndex:QS},polyline:{getFrameVertexes:$S,getPointsDspByAbs:eC,getPointsAbsByDsp:tC},group:{group:rC,unGroup:nC}},aC=function(){function e(e,t){this.root=e,this.dom=t;var r=this.frame=document.createElement("div");r.className="frame",r.style.display="none",t.appendChild(r);var n=this.hover=document.createElement("div");n.className="hover",n.style.display="none",t.appendChild(n);var i=this.select=document.createElement("div");i.className="select",i.style.display="none",i.innerHTML='\n  <div class="sub"></div>\n  <span class="l">\n    <b></b>\n  </span>\n  <span class="t">\n    <b></b>\n  </span>\n  <span class="r">\n    <b></b>\n  </span>\n  <span class="b">\n    <b></b>\n  </span>\n  <span class="tl">\n    <b></b>\n  </span>\n  <span class="tr">\n    <b></b>\n  </span>\n  <span class="br">\n    <b></b>\n  </span>\n  <span class="bl">\n    <b></b>\n  </span>\n',t.appendChild(i)}return e.prototype.showFrame=function(e,t,r,n){this.frame.style.left=e+"px",this.frame.style.top=t+"px",this.updateFrame(r,n),this.frame.style.display="block"},e.prototype.updateFrame=function(e,t){this.frame.style.width=Math.abs(e)+"px",this.frame.style.height=Math.abs(t)+"px",this.frame.style.transform="scale(".concat(e>=0?1:-1,", ").concat(t>=0?1:-1,")")},e.prototype.hideFrame=function(){this.frame.style.display="none"},e.prototype.showHover=function(e){this.hoverNode=e,this.updateHover(e),this.hover.style.display="block"},e.prototype.hideHover=function(){this.hoverNode=void 0,this.hover.style.display="none"},e.prototype.calRect=function(e){var t,r,n,i,o,a,s,l,c=this.root.dpi,u=e.computedStyle,h=e._rect||e.rect,d=e.matrixWorld;if(1!==c){var f=ic();mc(f,1/c),d=ac(f,d)}e instanceof tE&&e.isLine();var p=bc(h[0],h[1],h[2],h[3],d),v=p.x1,m=p.y1,g=p.x2,y=p.y2,b=p.x3,x=p.y3,w=p.x4,E=p.y4;-1===u.scaleX&&(v=(t=[g,v])[0],g=t[1],m=(r=[y,m])[0],y=r[1],b=(n=[w,b])[0],w=n[1],x=(i=[E,x])[0],E=i[1]),-1===u.scaleY&&(v=(o=[w,v])[0],w=o[1],m=(a=[E,m])[0],E=a[1],g=(s=[b,g])[0],b=s[1],y=(l=[x,y])[0],x=l[1]);var _={left:v,top:m,width:Math.sqrt(Math.pow(v-g,2)+Math.pow(m-y,2)),height:Math.sqrt(Math.pow(g-b,2)+Math.pow(y-x,2)),transform:""};if(g>v){if(y!==m){var S=Ec(Math.atan((y-m)/(g-v)));_.transform="rotateZ(".concat(S,"deg)")}}else if(g<v){S=Ec(Math.atan((y-m)/(g-v)));_.transform="rotateZ(".concat(S+180,"deg)")}else y>m?_.transform="rotateZ(90deg)":y<m&&(_.transform="rotateZ(-90deg)");return _},e.prototype.updateHover=function(e){var t=this.calRect(e);this.hover.style.left=t.left+"px",this.hover.style.top=t.top+"px",this.hover.style.width=t.width+"px",this.hover.style.height=t.height+"px",this.hover.style.transform=t.transform},e.prototype.showSelect=function(e){this.updateSelect(e),this.showSelectNotUpdate()},e.prototype.showSelectNotUpdate=function(){this.select.style.display="block"},e.prototype.updateSelect=function(e){var t=this.select.querySelector(".sub");if(1===e.length){t.innerHTML="",this.select.classList.remove("multi"),e[0].computedStyle.visibility===nl.VISIBLE?this.select.classList.remove("hide"):this.select.classList.add("hide");var r=this.calRect(e[0]);this.select.style.left=r.left+"px",this.select.style.top=r.top+"px",this.select.style.width=r.width+"px",this.select.style.height=r.height+"px",this.select.style.transform=r.transform}else if(e.length>1){this.select.classList.add("multi");var n=0,i=0,o=0,a=0,s=[];e.forEach((function(e,t){var r=e.getBoundingClientRect();s.push({left:r.left,top:r.top,right:r.right,bottom:r.bottom,visible:e.computedStyle.visibility===nl.VISIBLE}),t?(n=Math.min(n,r.left),i=Math.min(i,r.top),o=Math.max(o,r.right),a=Math.max(a,r.bottom)):(n=r.left,i=r.top,o=r.right,a=r.bottom)}));var l=this.root.dpi,c=this.select.style;c.left=n/l+"px",c.top=i/l+"px",c.width=(o-n)/l+"px",c.height=(a-i)/l+"px",c.transform="";var u="";s.forEach((function(e){u+='<div style="left:'.concat((e.left-n)/l,"px;top:").concat((e.top-i)/l,"px;width:").concat((e.right-e.left)/l,"px;height:").concat((e.bottom-e.top)/l,"px;").concat(e.visible?"":"border-style:dashed;",'"></div>')}));var h=this.select.querySelector(".sub");h.innerHTML!==u&&(h.innerHTML=u)}},e.prototype.hideSelect=function(){this.select.style.display="none"},e.prototype.isSelectControlDom=function(e){return e.parentElement===this.select},e.prototype.destroy=function(){this.hover.remove(),this.select.remove(),this.frame.remove()},e.prototype.metaKey=function(e){e?this.select.classList.add("rotate"):this.select.classList.remove("rotate")},e.prototype.getAspectRatio=function(){var e=this.select.style;return{x:parseFloat(e.left),y:parseFloat(e.top),w:parseFloat(e.width),h:parseFloat(e.height)}},e}();!function(e){e[e.NORMAL=0]="NORMAL",e[e.HAND=1]="HAND",e[e.RESIZE=2]="RESIZE",e[e.EDIT_TEXT=3]="EDIT_TEXT",e[e.EDIT_GRADIENT=4]="EDIT_GRADIENT",e[e.EDIT_GEOM=5]="EDIT_GEOM",e[e.ADD_TEXT=6]="ADD_TEXT"}(iC||(iC={}));var sC,lC,cC,uC,hC,dC,fC=iC,pC=function(e){this.nodes=e},vC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.beforeEdit(),e.cursor=t[r].next.cursor,e.content=t[r].next.content,e.setRich(t[r].next.rich),e.afterEdit()}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.beforeEdit(),e.cursor=t[r].prev.cursor,e.content=t[r].prev.content,e.setRich(t[r].prev.rich),e.afterEdit()}))},t}(pC),mC=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.ignoreBlur=[],this.hasBlur=!0;var i=this.containerEl=document.createElement("div");i.className="input",i.style.position="absolute",i.style.pointerEvents="none",i.style.opacity="0",t.appendChild(i);var o=this.inputEl=document.createElement("input");o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.width="10px",o.style.height="100%",o.style.boxSizing="content-box",o.style.border="none",o.style.pointerEvents="none",o.style.opacity="0",o.type="text",o.autocomplete="off",o.spellcheck=!1,i.appendChild(o);var a=function(e){if(n.node){var t=n.node._content,i=n.node.getRich(),a=n.node.getCursor();e(),n.updateCursor(),n.showCursor(),o.value="",n.listener.select.updateSelect([n.node]),r.emit([iT.TEXT_CONTENT_NODE,iT.CURSOR_NODE],[n.node]),n.listener.history.addCommand(new vC([n.node],[{prev:{content:t,rich:i,cursor:a},next:{content:n.node._content,rich:n.node.getRich(),cursor:n.node.getCursor()}}]),n.hasBlur),n.hasBlur=!1}},s=function(e){e&&a((function(){var t;null===(t=n.node)||void 0===t||t.input(e)}))},l=!1;o.addEventListener("keydown",(function(e){var t=e.keyCode,i=e.code;if(n.node)if(13===t||"Enter"===i)a((function(){var e;null===(e=n.node)||void 0===e||e.enter()}));else if(8===t||46===t||"Backspace"===i||"Delete"===i)e.stopPropagation(),a((function(){var e;null===(e=n.node)||void 0===e||e.delete(46===t||"Delete"===i)}));else if(t>=37&&t<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(i)){e.stopPropagation();var o=n.node.moveCursor(t,e.shiftKey);e.shiftKey?n.hideCursor():(n.showCursor(),n.updateCursor(o)),r.emit(iT.CURSOR_NODE,[n.node])}})),o.addEventListener("input",(function(e){if(!l){var t=e.data;t&&s(t)}})),o.addEventListener("paste",(function(e){var t;e.stopPropagation();var r=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");r&&s(r)})),o.addEventListener("compositionstart",(function(e){l=!0})),o.addEventListener("compositionend",(function(e){l=!1;var t=e.data;t&&s(t)}));var c=this.cursorEl=document.createElement("div");c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width="10px",c.style.height="100%",c.style.borderLeft="1px solid #000",c.style.pointerEvents="none",i.appendChild(c),c.animate([{visibility:"visible",borderColor:"#000"},{visibility:"visible",borderColor:"#FFF"},{visibility:"hidden"},{visibility:"hidden"}],{duration:800,iterations:1/0}),document.addEventListener("click",(function(e){if(r.state===fC.EDIT_TEXT){for(var t=e.target,i=t;i;){if(i===r.dom||n.ignoreBlur.includes(i))return void(["INPUT","SELECT"].includes(t.tagName.toUpperCase())||n.focus());i=i.parentElement}r.state=fC.NORMAL;var o=n.node;o.resetCursor(),o.afterEdit(),o.inputStyle=void 0,n.hide()}}))}return e.prototype.show=function(e,t,r){this.node=e,this.update(t,r),this.focus(),this.showCursor()},e.prototype.update=function(e,t){var r=this.root.dpi,n=this.node.setCursorStartByAbsCoords(e*r,t*r);this.containerEl.style.left=n.x/r+"px",this.containerEl.style.top=n.y/r+"px",this.containerEl.style.height=n.h/r+"px"},e.prototype.hide=function(){if(this.hideCursor(),this.blur(),!this.node._content.length){var e=this.listener.history.commands[0];e&&e instanceof vC&&e.nodes[0]===this.node&&e.undo(),this.listener.remove()}this.node=void 0},e.prototype.focus=function(){this.inputEl.focus()},e.prototype.blur=function(){this.inputEl.blur(),this.hasBlur=!0},e.prototype.showCursor=function(){this.containerEl.style.opacity="1"},e.prototype.hideCursor=function(){this.containerEl.style.opacity="0"},e.prototype.updateCursor=function(e){if(e=e||this.node.getCursorAbsCoords()){var t=this.root.dpi;this.containerEl.style.left=e.x/t+"px",this.containerEl.style.top=e.y/t+"px",this.containerEl.style.height=e.h/t+"px"}},e.prototype.destroy=function(){this.hide(),this.containerEl.remove()},e}(),gC=0,yC={keep:!1,show:function(e,t,r,n,i,o){var a,s,l,c,u,h=this;cC=r,uC&&(uC(),uC=void 0),uC=i,Array.isArray(t)?hC=t:t.stops&&(dC=t);var d=e.getBoundingClientRect(),f=!sC;f&&((sC=document.createElement("div")).innerHTML='\n<span class="arrow">\n  <b></b>\n</span>\n<ul class="type">\n  <li class="color" title="纯色"></li>\n  <li class="linear" title="线性渐变"></li>\n  <li class="radial" title="径向渐变"></li>\n  <li class="conic" title="圆锥渐变"></li>\n</ul>\n<div class="line">\n  <div class="bg"></div>\n  <div class="con"></div>\n</div>\n',document.body.appendChild(sC));var p=sC.querySelector(".type");null===(a=p.querySelector(".cur"))||void 0===a||a.classList.remove("cur");var v=sC.querySelector(".line");v.removeAttribute("style");var m=v.querySelector(".bg"),g=v.querySelector(".con");if(f){p.addEventListener("click",(function(e){var r=e.target;if("LI"===r.tagName.toUpperCase()){var i=r.classList;if(!i.contains("cur"))if(p.querySelector(".cur").classList.remove("cur"),i.add("cur"),i.contains("color")){v.style.display="none";var o=[0,0,0,1];hC?o=hC.slice(0):t.stops?(o=t.stops[0].color,n(o,!1,!0)):n(o,!1,!0),lC.setColor(o,!0)}else{if(v.style.display="block",i.contains("linear"))if(dC){if(dC.t===Ws.RADIAL||dC.t===Ws.CONIC){var a=dC.d[2]-dC.d[0],s=dC.d[3]-dC.d[1];dC.d[0]-=a,dC.d[1]-=s}dC.t=Ws.LINEAR}else dC={t:Ws.LINEAR,d:[0,.5,1,.5],stops:[{color:hC?hC.slice(0):[0,0,0,1],offset:0},{color:hC?hC.slice(0):[255,255,255,1],offset:1}]};else if(i.contains("radial"))if(dC){if(dC.t===Ws.LINEAR){a=dC.d[2]-dC.d[0],s=dC.d[3]-dC.d[1];dC.d[0]+=.5*a,dC.d[1]+=.5*s}else dC.t===Ws.CONIC&&(dC.d.length||dC.d.push(.5,.5,1,1));dC.t=Ws.RADIAL}else dC={t:Ws.RADIAL,d:[.5,.5,1,1],stops:[{color:hC?hC.slice(0):[0,0,0,1],offset:0},{color:hC?hC.slice(0):[255,255,255,1],offset:1}]};else if(i.contains("conic"))if(dC){if(dC.t===Ws.LINEAR){a=dC.d[2]-dC.d[0],s=dC.d[3]-dC.d[1];dC.d[0]+=.5*a,dC.d[1]+=.5*s}dC.t=Ws.CONIC}else dC={t:Ws.CONIC,d:[],stops:[{color:hC?hC.slice(0):[0,0,0,1],offset:0},{color:hC?hC.slice(0):[255,255,255,1],offset:1}]};dC&&n(dC,!1,!0)}}}));var y=m.clientWidth,b=!1,x=0,w=0,E=g.querySelector(".cur");g.addEventListener("mousedown",(function(e){var r,i,a;e.preventDefault();var s=e.target,l=s.tagName.toUpperCase();if(y=m.clientWidth,"SPAN"===l)g.querySelector(".cur").classList.remove("cur"),(E=s).classList.add("cur"),gC=parseInt(E.title),b=!0,x=e.pageX,w=.01*parseFloat(E.style.left),lC.setColor(t.stops[gC].color,!0),o.gradient.setCur(gC);else if("DIV"===l){g.querySelector(".cur").classList.remove("cur");var c=e.offsetX/y,u=document.createElement("span");u.style.left=100*c+"%";var h=g.querySelectorAll(".con span");g.appendChild(u);for(var d={color:[0,0,0,0],offset:c},f=0,p=h.length;f<p;f++){var v=h[f],_=.01*parseFloat(v.style.left);if(_>=c){if(f){var S=t.stops[f-1].color,C=t.stops[f].color,T=.01*parseFloat(h[f-1].style.left),A=(c-T)/(_-T);d.color=[S[0]+(C[0]-S[0])*A,S[1]+(C[1]-S[1])*A,S[2]+(C[2]-S[2])*A,(null!==(r=S[3])&&void 0!==r?r:1)+((null!==(i=C[3])&&void 0!==i?i:1)-(null!==(a=S[3])&&void 0!==a?a:1))*A]}else d.color=t.stops[f].color.slice(0);gC=f;break}f===p-1&&(d.color=t.stops[f].color.slice(0),gC=p)}for(f=gC,p=h.length;f<p;f++)h[f].title=(gC+1).toString();u.title=gC.toString(),t.stops.splice(gC,0,d),(E=u).classList.add("cur"),b=!0,x=e.pageX,w=.01*parseFloat(E.style.left),lC.setColor(d.color,!0),o.gradient.setCur(gC),n(t)}})),sC.addEventListener("mousedown",(function(){h.keep=!0,o.state===fC.EDIT_GRADIENT&&(o.gradient.keep=!0)})),document.addEventListener("mousemove",(function(e){if(b){e.preventDefault();var r=e.pageX-x,i=Math.min(1,Math.max(0,w+r/y));t.stops[gC].offset=i,E.style.left=100*i+"%",m.style.background=oh(t,m.clientWidth,m.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),n(t)}})),document.addEventListener("click",(function(e){b&&(t.stops.sort((function(e,t){return e.offset-t.offset})),sC.querySelectorAll(".line .con span").forEach((function(e,t){e.title=t.toString()})),b=!1),h.keep?h.keep=!1:(h.hide(),o.state===fC.EDIT_GRADIENT&&(o.state=fC.NORMAL,o.select.showSelectNotUpdate()))}))}if(sC.className="sketch-editor-picker",sC.classList.add(r),sC.style.left=d.left+.5*(d.right-d.left)+"px",sC.style.top=d.bottom+10+"px",sC.style.display="block",lC||((lC=new window.Picker({parent:sC,popup:!1})).onDone=function(){h.hide(),o.state===fC.EDIT_GRADIENT&&(o.state=fC.NORMAL,o.select.showSelectNotUpdate())},lC.onChange=function(e){p.querySelector(".cur").classList.contains("color")?n(e.rgba):(t.stops[gC].color=e.rgba,m.style.background=oh(t,m.clientWidth,m.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),n(t))}),Array.isArray(t)){var _=qu(t);lC.setColor(_,!0),null===(s=p.querySelector(".color"))||void 0===s||s.classList.add("cur"),v.style.display="none"}else void 0!==t.url?v.style.display="none":(lC.setColor(qu(t.stops[0].color),!0),this.updateLineBg(t),v.style.display="block",function(e,t){var r=t.querySelector(".con");r.innerHTML="";var n=document.createDocumentFragment();e.stops.forEach((function(e,t){var r=document.createElement("span");t||r.classList.add("cur"),r.style.left=100*e.offset+"%",r.title=t.toString(),n.appendChild(r)})),r.appendChild(n)}(t,v),lC.setColor(qu(t.stops[0].color),!0),t.t===Ws.LINEAR?null===(l=p.querySelector(".linear"))||void 0===l||l.classList.add("cur"):t.t===Ws.RADIAL?null===(c=p.querySelector(".radial"))||void 0===c||c.classList.add("cur"):t.t===Ws.CONIC&&(null===(u=p.querySelector(".conic"))||void 0===u||u.classList.add("cur")));return lC.show(),lC},hide:function(){sC&&"block"===sC.style.display&&(sC.style.display="none",uC&&(uC(),uC=void 0))},isShow:function(){return!!sC&&"block"===sC.style.display},isShowFrom:function(e){return this.isShow()&&cC===e},setLineCur:function(e){var t,r;sC&&(null===(t=sC.querySelector(".line .con .cur"))||void 0===t||t.classList.remove("cur"),null===(r=sC.querySelector('.line .con span[title="'.concat(e,'"]')))||void 0===r||r.classList.add("cur"),gC=e)},addLineItem:function(e,t){if(sC){var r=sC.querySelector(".line .con"),n=document.createElement("span");n.title=e.toString(),n.style.left=100*t+"%";for(var i=r.querySelectorAll("span"),o=0,a=i.length;o<a;o++){var s=i[o];if(e<=parseInt(s.title)){r.insertBefore(n,s);for(var l=o;l<a;l++){var c=i[l];c.title=(parseInt(c.title)+1).toString()}break}o===a-1&&r.appendChild(n)}gC=e}},updateLinePos:function(e,t,r){sC&&(sC.querySelector('.line .con span[title="'.concat(e,'"]')).style.left=100*t+"%",this.updateLineBg(r))},updateLineBg:function(e){if(sC){var t=Object.assign({},e);t.t=Ws.LINEAR;var r=sC.querySelector(".line .bg");r.style.background=zu(t,r.clientWidth,r.clientHeight,!0).replace(/\([^,]*,/,"(to right,")}}};var bC,xC="0.12.16",wC='\n  <div class="item group">编组选择对象</div>\n  <div class="item un-group">解除编组</div>\n  <div class="item select-all">选择全部</div>\n  <div class="split"></div>\n  <div class="item cut">剪切</div>\n  <div class="item copy">复制</div>\n  <div class="item paste">粘贴</div>\n  <div class="split"></div>\n  <div class="item remove">删除</div>\n  <div class="split"></div>\n  <div class="item lock">锁定<span></span>个图层</div>\n  <div class="item un-lock">解锁<span></span>个图层</div>\n  <div class="item hide">隐藏<span></span>个图层</div>\n  <div class="item show">显示<span></span>个图层</div>\n  <div class="split"></div>\n  <div class="item mask">\n    <span class="checked">✅</span>用作蒙版 <b class="arrow"></b>\n    <div class="sub">\n      <div class="item outline-mask"><span class="checked">✅</span>轮廓模版</div>\n      <div class="item alpha-mask"><span class="checked">✅</span>透明度模版</div>\n    </div>\n  </div>\n  <div class="item break-mask"><span class="checked">✅</span>忽略底层蒙版</div>\n  <div class="split"></div>\n  <div class="item scale-up">放大</div>\n  <div class="item scale-down">缩小</div>\n  <div class="split"></div>\n  <div class="item ok">确定</div>\n  <div class="item version">版本 '.concat(xC,"</div>\n");function EC(e){bC||(bC=document.createElement("div"),document.body.appendChild(bC),document.addEventListener("click",(function(t){CC.keep?CC.keep=!1:_C()&&e.emit(iT.CONTEXT_MENU,!1,bC)})),document.addEventListener("visibilitychange",(function(t){"hidden"===document.visibilityState&&_C()&&e.emit(iT.CONTEXT_MENU,!1,bC)})),bC.addEventListener("click",(function(t){var r,n=t.target,i=n.classList;n===bC?CC.keep=!0:i.contains("group")?e.group():i.contains("un-group")?e.unGroup():i.contains("select-all")?e.selectAll():i.contains("scale-up")||i.contains("scale-down")?e.zoom(i.contains("scale-up")?2:.5):i.contains("mask")||i.contains("outline-mask")?bC.classList.contains("outline")?e.mask("none"):e.mask("outline"):i.contains("alpha-mask")?bC.classList.contains("alpha")?e.mask("none"):e.mask("alpha"):i.contains("break-mask")?bC.classList.contains("break")?e.breakMask(!1):e.breakMask(!0):i.contains("lock")?e.lock(!0):i.contains("un-lock")?e.lock(!1):i.contains("hide")?e.visible("hidden"):i.contains("show")?e.visible("visible"):i.contains("remove")?e.remove():i.contains("cut")||i.contains("copy")?(e.clone(),i.contains("cut")&&!(null===(r=e.options.disabled)||void 0===r?void 0:r.remove)&&e.remove()):i.contains("paste")?e.paste():i.contains("ok")&&(e.state===fC.EDIT_GEOM?e.cancelEditGeom():e.state===fC.EDIT_GRADIENT&&e.cancelEditGradient(),e.state=fC.NORMAL)}))),bC.innerHTML=wC,bC.className="sketch-editor-context-menu"}function _C(){return!(!bC||"block"!==bC.style.display)&&(bC.style.display="none",!0)}var SC,CC={keep:!1,showCanvas:function(e,t,r){EC(r);var n=bC.classList,i=r.selected;if(i.length>1)n.add("multi");else if(1===i.length){i[0]instanceof VE?n.add("single-group"):n.add("single")}else n.add("empty");(r.clones.length?n.remove("no-clone"):n.add("no-clone"),i.filter((function(e){return e.computedStyle.maskMode})).length)&&(i.filter((function(e){return e.computedStyle.maskMode===Qs.OUTLINE})).length?n.add("outline"):n.add("alpha"));i.filter((function(e){return e.computedStyle.breakMask})).length&&n.add("break");var o=i.filter((function(e){return e.props.isLocked}));o.length===i.length?(n.add("locked"),bC.querySelector(".un-lock span").innerHTML=o.length.toString()):bC.querySelector(".lock span").innerHTML=i.length.toString();var a=i.filter((function(e){return e.computedStyle.visibility===nl.HIDDEN}));a.length===i.length?(n.add("hidden"),bC.querySelector(".show span").innerHTML=a.length.toString()):bC.querySelector(".hide span").innerHTML=i.length.toString(),bC.style.left=e+"px",bC.style.top=t+"px",bC.style.display="block",r.emit(iT.CONTEXT_MENU,!0,bC)},showTree:function(e,t,r){this.showCanvas(e,t,r)},showOk:function(e,t,r){EC(r),bC.classList.add("only-ok"),bC.style.left=e+"px",bC.style.top=t+"px",bC.style.display="block",r.emit(iT.CONTEXT_MENU,!0,bC)},hide:_C},TC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=e.getStyle(),l=e.computedStyle;t.update(e,l,o,a),e.endPosChange(s,o,a),e.checkPosSizeUpward()}))},t.prototype.undo=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=e.getStyle(),l=e.computedStyle;t.update(e,l,-o,-a),e.endPosChange(s,-o,-a),e.checkPosSizeUpward()}))},t.update=function(e,t,r,n){var i=e.artBoard;e.updateStyle({translateX:t.translateX+r,translateY:t.translateY+n});var o=e.getBoundingClientRect();if(i&&kc((c=i.getBoundingClientRect()).left,c.top,c.right,c.bottom,o.points))return i;var a=e.page;if(a)for(var s=a.children,l=s.length-1;l>=0;l--){var c,u=s[l];if(u!==i&&u instanceof Fw)if(kc((c=u.getBoundingClientRect()).left,c.top,c.right,c.bottom,o.points))return j_([e],u),u}i&&(Y_([e],i),e.artBoard=void 0)},t}(pC),AC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.updateStyle(t[r].next)}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.updateStyle(t[r].prev)}))},t}(pC);!function(e){e[e.T=0]="T",e[e.R=1]="R",e[e.B=2]="B",e[e.L=3]="L",e[e.TL=4]="TL",e[e.TR=5]="TR",e[e.BL=6]="BL",e[e.BR=7]="BR"}(SC||(SC={}));var kC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=i.controlType,l=i.aspectRatio,c=i.clientRect,u=i.selectRect,h=i.fromCenter,d=i.widthToAuto,f=i.heightToAuto;i.flipX,i.flipY;var p=e.getStyle();e.startSizeChange();var v=e.getComputedStyle(),m=e.getCssStyle();c?t.updateStyleMultiAr(e,v,m,o,a,s,c,u,l,h,d,f):t.updateStyle(e,v,m,o,a,s,l,h,d,f),e.endSizeChange(p),e.checkPosSizeUpward()}))},t.prototype.undo=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=i.controlType,l=i.aspectRatio,c=i.clientRect,u=i.selectRect,h=i.fromCenter,d=i.widthFromAuto,f=i.heightFromAuto,p=i.flipX,v=i.flipY,m=e.getStyle();e.startSizeChange();var g=e.getComputedStyle(),y=e.getCssStyle();s=function(e,t,r){t&&(e===SC.L?e=SC.R:e===SC.R?e=SC.L:e===SC.TL?e=SC.TR:e===SC.TR&&(e=SC.TL));r&&(e===SC.T?e=SC.B:e===SC.B?e=SC.T:e===SC.BL?e=SC.BR:e===SC.BR&&(e=SC.BL));return e}(s,p,v),c?t.updateStyleMultiAr(e,g,y,-o,-a,s,c,u,l,h,d,f):t.updateStyle(e,g,y,-o,-a,s,l,h,d,f),e.endSizeChange(m),e.checkPosSizeUpward()}))},t.updateStyle=function(e,t,r,n,i,o,a,s,l,c){void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===c&&(c=!1);var u={left:r.left,right:r.right,top:r.top,bottom:r.bottom,width:r.width,height:r.height,scaleX:r.scaleX,scaleY:r.scaleY};a?o===SC.T?Object.assign(u,tS(e,t,i,s)):o===SC.R?Object.assign(u,oS(e,t,n,s)):o===SC.B?Object.assign(u,rS(e,t,i,s)):o===SC.L?Object.assign(u,iS(e,t,n,s)):o===SC.TL?Object.assign(u,sS(e,t,n,i,s)):o===SC.TR?Object.assign(u,lS(e,t,n,i,s)):o===SC.BL?Object.assign(u,cS(e,t,n,i,s)):o===SC.BR&&Object.assign(u,uS(e,t,n,i,s)):(o===SC.T||o===SC.TL||o===SC.TR?Object.assign(u,Z_(e,t,i,s)):o!==SC.B&&o!==SC.BL&&o!==SC.BR||Object.assign(u,J_(e,t,i,s)),o===SC.L||o===SC.TL||o===SC.BL?Object.assign(u,Q_(e,t,n,s)):o!==SC.R&&o!==SC.TR&&o!==SC.BR||Object.assign(u,$_(e,t,n,s))),l&&(u.width="auto"),c&&(u.height="auto"),e.updateStyle(u)},t.updateStyleMultiAr=function(e,t,r,n,i,o,a,s,l,c,u,h){var d;void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===h&&(h=!1);var f={left:r.left,right:r.right,top:r.top,bottom:r.bottom,width:r.width,height:r.height,scaleX:r.scaleX,scaleY:r.scaleY};if(o===SC.T)Object.assign(f,vS(e,t,i,a,s,l,c));else if(o===SC.R)Object.assign(f,yS(e,t,n,a,s,l,c));else if(o===SC.B)Object.assign(f,mS(e,t,i,a,s,l,c));else if(o===SC.L)Object.assign(f,gS(e,t,n,a,s,l,c));else{if(l){var p=(null===(d=e.root)||void 0===d?void 0:d.dpi)||1,v={width:s.w*p,height:s.h*p},m=aS(v,n,i,[SC.TL,SC.BR].includes(o)),g=m.x,y=m.y;n=g-v.width,i=y-v.height}o===SC.TL?Object.assign(f,xS(e,t,n,i,a,s,l,c)):o===SC.TR?Object.assign(f,wS(e,t,n,i,a,s,l,c)):o===SC.BL?Object.assign(f,_S(e,t,n,i,a,s,l,c)):o===SC.BR&&Object.assign(f,SS(e,t,n,i,a,s,l,c))}u&&(f.width="auto"),h&&(f.height="auto"),e.updateStyle(f)},t}(pC);var MC,OC=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.data=r,i.type=n,i}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.setRich(t[r].next)}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.setRich(t[r].prev)}))},t.FONT_FAMILY="FONT_FAMILY",t.FONT_SIZE="FONT_SIZE",t.LETTER_SPACING="LETTER_SPACING",t.LINE_HEIGHT="LINE_HEIGHT",t.PARAGRAPH_SPACING="PARAGRAPH_SPACING",t.COLOR="COLOR",t.TEXT_ALIGN="TEXT_ALIGN",t}(pC);var LC=function(){function e(e){void 0===e&&(e=100),this.commands=[],this.commandsR=[],this.size=Math.max(1,e),this.lastTime=0}return e.prototype.addCommand=function(e,t){void 0===t&&(t=!1),this.commandsR.splice(0);var r=this.commands.length;if(!t&&r>0){var n=this.commands[r-1];if((Date.now()-this.lastTime<bs.historyTime||n instanceof vC&&e instanceof vC)&&function(e,t){if(e.constructor!==t.constructor)return!1;var r=e.nodes,n=t.nodes;if(r.length!==n.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;if(e instanceof kC){var a=e.data,s=t.data;for(i=0,o=a.length;i<o;i++){var l=a[i],c=s[i];if(l.controlType!==c.controlType||l.aspectRatio!==c.aspectRatio||l.fromCenter!==c.fromCenter||l.widthFromAuto!==c.widthFromAuto||l.heightFromAuto!==c.heightFromAuto||l.widthToAuto!==c.widthToAuto||l.heightToAuto!==c.heightToAuto)return!1}}if(e instanceof OC){if(e.type!==t.type)return!1;for(a=e.data,s=t.data,i=0,o=a.length;i<o;i++){if(l=a[i],c=s[i],l.prev.length!==c.prev.length)return!1;for(var u=0;u<l.prev.length;u++){var h=l.prev[u],d=c.prev[u];if(h.location!==d.location||h.length!==d.length)return!1}}}return!0}(n,e)){var i=!0;if(n instanceof TC){var o=e.data;n.data.forEach((function(e,t){e.dx+=o[t].dx,e.dy+=o[t].dy}))}else if(n instanceof AC){var a=e.data;n.data.forEach((function(e,t){e.next=a[t].next}))}else if(n instanceof kC){var s=e.data;n.data.forEach((function(e,t){e.dx+=s[t].dx,e.dy+=s[t].dy}))}else if(n instanceof OC){var l=e.data;n.data.forEach((function(e,t){e.next=l[t].next}))}else if(n instanceof vC){var c=e.data;n.data.forEach((function(e,t){e.next=c[t].next}))}else i=!1;if(i)return void(this.lastTime=Date.now())}}this.lastTime=Date.now(),r>=this.size&&this.commands.slice(0,r-this.size+1),this.commands.push(e)},e.prototype.undo=function(){if(this.commands.length){var e=this.commands.pop();return e.undo(),this.commandsR.push(e),e}},e.prototype.redo=function(){if(this.commandsR.length){var e=this.commandsR.pop();return e.execute(),this.commands.push(e),e}},e.getInstance=function(){return MC||(MC=new e),MC},e}(),RC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){this.nodes.forEach((function(e){e.remove()}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){JS(e,t[r])}))},t.operate=function(e){var t=e.parent,r={x:e.computedStyle.left,y:e.computedStyle.top,parent:t};if(t.isGroup&&t instanceof VE){var n=t.getChildrenRect(e);r.x-=n.minX,r.y-=n.minY}return e.remove(),r},t}(pC),IC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),PC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),FC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),DC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),NC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),BC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),UC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),zC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),XC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),HC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),GC=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.data=r,i.group=n,i}return v(t,e),t.prototype.execute=function(){t.operate(this.nodes,this.group)},t.prototype.undo=function(){var e=this;this.nodes.forEach((function(t,r){var n=e.data[r],i=n.parent,o=n.index;i instanceof VE&&(i.fixedPosAndSize=!0),V_(i,t),t.props.index=o,QS(i,t)})),this.data.forEach((function(e){var t=e.parent;t instanceof VE&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())})),this.group.remove()},t.operate=function(e,t){return{data:e.map((function(e){return{parent:e.parent,index:e.props.index}})),group:rC(e,t)}},t}(pC),jC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){t.operate(this.nodes)},t.prototype.undo=function(){var e=this;this.nodes.forEach((function(t,r){var n=t;n.fixedPosAndSize=!0;var i=e.data[r],o=i.parent,a=i.children;o instanceof VE&&(o.fixedPosAndSize=!0),QS(o,n),a.filter((function(e){V_(n,e),n.appendChild(e)})),n.fixedPosAndSize=!1,n.checkPosSizeSelf(),n instanceof LS&&n.refresh()})),this.data.forEach((function(e){var t=e.parent;t instanceof VE&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())}))},t.operate=function(e){return e.map((function(e){return nC(e)}))},t}(pC),YC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.name=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.name=t[r].prev}))},t}(pC),WC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.isLocked=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.isLocked=t[r].prev}))},t}(pC),qC=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(AC),VC=function(){function e(e,t,r){this.root=e,this.dom=t,this.listener=r,this.xs=[],this.ys=[],this.move={left:0,right:0,top:0,bottom:0,center:0,middle:0},this.lineH=[],this.lineV=[],this.distanceH=document.createElement("div"),this.distanceH.className="distance-h",this.distanceH.style.display="none",this.distanceH.innerHTML="<span></span>",this.dom.appendChild(this.distanceH),this.distanceV=document.createElement("div"),this.distanceV.className="distance-v",this.distanceV.style.display="none",this.distanceV.innerHTML="<span></span>",this.dom.appendChild(this.distanceV)}return e.prototype.initMove=function(e,t){var r=ZS(this.root,t),n=r.x,i=r.y;this.xs=n,this.ys=i;var o=parseFloat(e.style.left),a=parseFloat(e.style.top),s=o+parseFloat(e.style.width),l=.5*(o+s),c=a+parseFloat(e.style.height),u=.5*(a+c);this.move={left:o,right:s,top:a,bottom:c,center:l,middle:u}},e.prototype.snapMove=function(e,t,r){var n,i,o=0,a=0,s=!1,l=this.xs,c=this.ys,u=Math.max(0,bs.guidesSnap),h=this.move,d=h.left,f=h.right,p=h.top,v=h.bottom,m=h.center,g=h.middle;f+=e,m+=e,p+=t,v+=t,g+=t;var y=KS(d+=e,l),b=KS(m,l),x=KS(f,l),w=[KC(d,u,l,y),KC(m,u,l,b),KC(f,u,l,x)].filter((function(e){return e}));if(w.length){s=!0,w.sort((function(e,t){return Math.abs(e.d)-Math.abs(t.d)}));var E=w[0];d+=o=O=E.d,f+=o,n=L=E.ng,this.showLineV(L.n,Math.min(p,L.r.top),Math.max(v,L.r.bottom),0);for(var _=1,S=w.length;_<S;_++){var C=w[_];if(!(Math.abs(C.d-O)<1e-9))break;this.showLineV(C.ng.n,Math.min(p,C.ng.r.top),Math.max(v,C.ng.r.bottom),_)}}else this.hideLineV();var T=KS(p,c),A=KS(g,c),k=KS(v,c),M=[KC(p,u,c,T),KC(g,u,c,A),KC(v,u,c,k)].filter((function(e){return e}));if(M.length){s=!0,M.sort((function(e,t){return Math.abs(e.d)-Math.abs(t.d)}));var O,L,R=M[0];p+=a=O=R.d,v+=a,i=L=R.ng,this.showLineH(L.n,Math.min(d,L.r.left),Math.max(f,L.r.right),0);for(_=1,S=M.length;_<S;_++){if((C=M[_]).d!==O)break;this.showLineH(C.ng.n,Math.min(d,C.ng.r.left),Math.max(f,C.ng.r.right),_)}}else this.hideLineH();if(n?p>n.r.bottom?this.showDistanceV(n.r.bottom,p,r):v<n.r.top?this.showDistanceV(v,n.r.top,r):this.hideDistanceV():this.hideDistanceV(),i?d>i.r.right?this.showDistanceH(i.r.right,d,r):f<i.r.left?this.showDistanceH(f,i.r.left,r):this.hideDistanceH():this.hideDistanceH(),s)return{x:o,y:a}},e.prototype.showLineH=function(e,t,r,n){if(!this.lineH[n]){var i=this.lineH[n]=document.createElement("div");i.className="line-h",this.dom.appendChild(i)}var o=this.lineH[n].style;o.top=e+"px",o.left=t+"px",o.width=r-t+"px",o.display="block"},e.prototype.showLineV=function(e,t,r,n){if(!this.lineV[n]){var i=this.lineV[n]=document.createElement("div");i.className="line-v",this.dom.appendChild(i)}var o=this.lineV[n].style;o.left=e+"px",o.top=t+"px",o.height=r-t+"px",o.display="block"},e.prototype.showDistanceH=function(e,t,r){var n=this.distanceH.style,i=Math.abs(e-t);this.distanceH.querySelector("span").innerHTML=Lu(i*r,2).toString();var o=this.lineH.length;n.top=3===o?this.lineH[1].style.top:o>1?.5*(parseFloat(this.lineH[0].style.top)+parseFloat(this.lineH[o-1].style.top))+"px":this.lineH[0].style.top,n.left=Math.min(e,t)+"px",n.width=i+"px",n.display="block"},e.prototype.showDistanceV=function(e,t,r){var n=this.distanceV.style,i=Math.abs(e-t);this.distanceV.querySelector("span").innerHTML=Lu(i*r,2).toString();var o=this.lineV.length;n.left=3===o?this.lineV[1].style.left:o>1?.5*(parseFloat(this.lineV[0].style.left)+parseFloat(this.lineV[o-1].style.left))+"px":this.lineV[0].style.left,n.top=Math.min(e,t)+"px",n.height=i+"px",n.display="block"},e.prototype.hideLineH=function(){this.lineH.splice(0).forEach((function(e){e.style.display="none",e.remove()}))},e.prototype.hideLineV=function(){this.lineV.splice(0).forEach((function(e){e.style.display="none",e.remove()}))},e.prototype.hideDistanceH=function(){this.distanceH.style.display="none"},e.prototype.hideDistanceV=function(){this.distanceV.style.display="none"},e.prototype.hide=function(){this.hideLineH(),this.hideLineV(),this.hideDistanceH(),this.hideDistanceV()},e}();function KC(e,t,r,n){var i=r[n-1],o=r[n];if(i&&o){var a=Math.abs(i.n-e),s=Math.abs(o.n-e);if(a<=t&&s<=t)return a<=s?{d:i.n-e,ng:i}:{d:o.n-e,ng:o};if(a<=t)return{d:i.n-e,ng:i};if(s<=t)return{d:o.n-e,ng:o}}else if(i){if(Math.abs(e-i.n)<=t)return{d:i.n-e,ng:i}}else if(o&&Math.abs(e-o.n)<=t)return{d:o.n-e,ng:o}}var ZC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){JS(e,t[r])}))},t.prototype.undo=function(){this.nodes.forEach((function(e){e.remove()}))},t}(pC),JC=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r;var i=this.panel=document.createElement("div");i.className="gradient",i.style.display="none",t.appendChild(i);var o,a=!1,s=!1,l=0,c=0,u=0,h=1,d=1,f=1,p=0,v=0,m=1,g=1;i.addEventListener("mousedown",(function(e){var t=n.data;if(t&&(n.keep=!0,yC.keep=!0,0===e.button&&!r.spaceKey)){var y=(o=e.target).classList,b=o.tagName.toUpperCase(),x=i.getBoundingClientRect();l=x.left,c=x.top,h=i.clientWidth,d=i.clientHeight;var w=i.querySelector('span[title="0"]').getBoundingClientRect();p=w.left+.5*w.width,v=w.top+.5*w.height,m=t.d[2]-t.d[0],g=t.d[3]-t.d[1];var E=n.node.computedStyle,_=E.scaleX,S=E.scaleY;if(y.contains("c2")){for(var C=e.offsetX,T=e.offsetY,A=.5*Math.max(h,d),k=QC(A,A,C,T,_,S),M=void 0,O=void 0,L=0,R=(P=t.stops).length;L<R;L++){if(k<(D=P[L]).offset){O=D,u=L;break}M=D}if(M&&O){N=(k-M.offset)/(O.offset-M.offset);P.splice(u,0,{color:$C(M,O,N),offset:k}),i.innerHTML+="<span></span>",i.querySelectorAll("span").forEach((function(e,t){e.title=t.toString(),t===u&&(o=e)}))}else{M=M||P[0];var I={color:$C(O=O||P[P.length-1],M,N=Math.abs(k-M.offset)/Math.abs(M.offset-O.offset)),offset:k};k<M.offset?(P.unshift(I),u=0):(P.push(I),u=P.length-1)}n.updateConicStops(t),yC.addLineItem(u,k),n.setCur(u,!0),n.onInput(t,!0),a=!0}else if(y.contains("e"))f=i.querySelector(".l").clientWidth,s=!0;else if("SPAN"===b)u=parseInt(o.title),n.setCur(u,!0),a=!0;else if("DIV"===b){for(var P=t.stops,F=(k=Math.sqrt(Math.pow(e.pageX-p,2)+Math.pow(e.pageY-v,2))/o.clientWidth,L=0,P.length);L<F;L++){var D;if(k<(D=P[L]).offset){var N=(k-(M=P[L-1]).offset)/(D.offset-M.offset);P.splice(L,0,{color:$C(M,D,N),offset:k}),u=L;break}}i.innerHTML+="<span></span>",i.querySelectorAll("span").forEach((function(e,t){e.title=t.toString(),t===u&&(o=e)})),n.updateLinearStops(t),yC.addLineItem(u,k),n.setCur(u,!0),n.onInput(t,!0),a=!0}}})),document.addEventListener("mousemove",(function(e){if(s){if(i=n.data){var t=i.d,r=Math.sqrt(Math.pow(e.pageX-p,2)+Math.pow(e.pageY-v,2));t[4]=r/f,n.updateRadialD(i),n.updateRadialStops(i),n.onInput(i,!0)}}else if(a){var i,y=(e.pageX-l)/h,b=(e.pageY-c)/d;if(i=n.data){t=i.d;var x=i.stops,w=n.node.computedStyle,E=w.scaleX,_=w.scaleY,S=-1===E?1-t[0]:t[0],C=-1===_?1-t[1]:t[1];if(0!==u&&u!==x.length-1||i.t===Ws.CONIC){if(i.t===Ws.CONIC){var T=QC(l+.5*h,c+.5*d,e.pageX,e.pageY,E,_);x[u].offset=T,n.updateConicStops(i),yC.updateLinePos(u,T,i)}else{var A=y-S,k=b-C,M=(A<0?-1:1)*(t[2]<t[0]?-1:1)*E,O=(k<0?-1:1)*(t[3]<t[1]?-1:1)*_,L=Math.pow(A,2)*M+Math.pow(k,2)*O;T=Math.sqrt(Math.max(0,L))/Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(t[3]-t[1],2));T=Math.max(0,Math.min(1,T)),x[u].offset=T;var R=100*(S+(t[2]-t[0])*T*E)+"%",I=100*(C+(t[3]-t[1])*T*_)+"%";o.style.left=R,o.style.top=I,yC.updateLinePos(u,T,i)}n.onInput(i,!0)}else 0===u?(t[0]=-1===E?1-y:y,t[1]=-1===_?1-b:b,[Ws.RADIAL].includes(i.t)&&(t[2]=t[0]+m,t[3]=t[1]+g)):(t[2]=-1===E?1-y:y,t[3]=-1===_?1-b:b),i.t===Ws.LINEAR?(n.updateLinearD(i),n.updateLinearStops(i)):i.t===Ws.RADIAL&&(n.updateLinearD(i),n.updateRadialD(i),n.updateLinearStops(i),n.updateRadialStops(i)),n.onInput(i,!0)}}})),document.addEventListener("mouseup",(function(){s?s=!1:a&&(n.data&&(n.data.stops.sort((function(e,t){return e.offset-t.offset})),i.querySelectorAll("span").forEach((function(e,t){e.title=t.toString()}))),a=!1,n.onChange&&n.onChange())})),i.addEventListener("wheel",(function(e){a&&e.stopPropagation()})),document.addEventListener("click",(function(){n.keep?n.keep=!1:n.hide()}))}return e.prototype.show=function(e,t,r,n){Array.isArray(t)||t.url||(this.node=e,this.onInput=r,this.onChange=n,this.data=t,this.updateSize(e),t.t===Ws.LINEAR?this.genLinear(t):t.t===Ws.RADIAL?this.genRadial(t):t.t===Ws.CONIC&&this.genConic(t))},e.prototype.update=function(e,t,r){var n,i,o;void 0===r&&(r=!1),Array.isArray(t)||t.url||(this.node=e,this.updateSize(e),this.data=t,t.t===Ws.LINEAR?r||t.stops.length!==(null===(n=this.data)||void 0===n?void 0:n.stops.length)?this.genLinear(t):(this.updateLinearD(t),this.updateLinearStops(t)):t.t===Ws.RADIAL?r||t.stops.length!==(null===(i=this.data)||void 0===i?void 0:i.stops.length)?this.genRadial(t):(this.updateLinearD(t),this.updateRadialD(t),this.updateLinearStops(t),this.updateLinearStops(t)):t.t===Ws.CONIC&&(r||t.stops.length!==(null===(o=this.data)||void 0===o?void 0:o.stops.length)?this.genConic(t):(this.updateConicD(t),this.updateConicStops(t))))},e.prototype.updateSize=function(e){var t=this.panel,r=this.listener.select.calRect(e);t.style.left=r.left+"px",t.style.top=r.top+"px",t.style.width=r.width+"px",t.style.height=r.height+"px",t.style.transform=r.transform,t.style.display="block"},e.prototype.genLinear=function(e){var t=this.panel,r=e.stops;t.innerHTML="";var n='<div class="l"></div>';r.forEach((function(e,t){n+='<span title="'.concat(t,'"></span>')})),t.innerHTML=n,this.updateLinearD(e),this.updateLinearStops(e),this.setCur(0)},e.prototype.updateLinearD=function(e){var t=this.panel,r=t.querySelector(".l"),n=t.clientWidth,i=t.clientHeight,o=this.node.computedStyle,a=o.scaleX,s=o.scaleY,l=e.d,c=l[2]-l[0],u=l[3]-l[1],h=100*(-1===a?1-l[0]:l[0])+"%",d=100*(-1===s?1-l[1]:l[1])+"%",f=Math.sqrt(Math.pow(c*n,2)+Math.pow(u*i,2))+"px";if(r.style.left=h,r.style.top=d,r.style.width=f,l[0]===l[2])l[3]>=l[1]?r.style.transform="translateY(-50%) rotateZ(90deg) scale(".concat(a,", ").concat(s,")"):r.style.transform="translateY(-50%) rotateZ(-90deg) scale(".concat(a,", ").concat(s,")");else if(l[1]===l[3])l[2]>=l[0]?r.style.transform="translateY(-50%) scale(".concat(a,", ").concat(s,")"):r.style.transform="translateY(-50%) rotateZ(180deg) scale(".concat(a,", ").concat(s,")");else{var p=Lu(Ec(Math.atan(u*i/c/n)));r.style.transform=c>=0?"translateY(-50%) rotateZ(".concat(p,"deg) scale(").concat(a,", ").concat(s,")"):"translateY(-50%) rotateZ(".concat(p+180,"deg) scale(").concat(a,", ").concat(s,")")}},e.prototype.updateLinearStops=function(e){var t=this.panel.querySelectorAll("span"),r=this.node.computedStyle,n=r.scaleX,i=r.scaleY,o=e.d,a=e.stops,s=o[2]-o[0],l=o[3]-o[1];a.forEach((function(e,r){var a=e.color,c=e.offset,u=100*(-1===n?1-o[0]:o[0])+c*s*100*n+"%",h=100*(-1===i?1-o[1]:o[1])+c*l*100*i+"%",d=qu(a),f=t[r];f&&(f.style.left=u,f.style.top=h,f.style.background=d)}))},e.prototype.genRadial=function(e){var t=this.panel,r=e.stops;t.innerHTML="";var n='<div class="l"></div><div class="c"></div><div class="e"></div>';r.forEach((function(e,t){n+='<span title="'.concat(t,'"></span>')})),t.innerHTML=n,this.updateLinearD(e),this.updateRadialD(e),this.updateLinearStops(e),this.updateRadialStops(e),this.setCur(0)},e.prototype.updateRadialD=function(e){var t=this.panel,r=t.querySelector(".c"),n=t.clientWidth,i=t.clientHeight,o=this.node.computedStyle,a=o.scaleX,s=o.scaleY,l=e.d,c=100*(-1===a?1-l[0]:l[0])+"%",u=100*(-1===s?1-l[1]:l[1])+"%",h=l[2]-l[0],d=l[3]-l[1],f=Math.sqrt(Math.pow(h*n,2)+Math.pow(d*i,2));if(r.style.left=c,r.style.top=u,r.style.width=r.style.height=2*f+"px",l[0]===l[2])l[3]>=l[1]?r.style.transform="translate(-50%, -50%) rotateZ(90deg) scale(".concat(a,", ").concat(s*(l[4]||1),")"):r.style.transform="translate(-50%, -50%) rotateZ(-90deg) scale(".concat(a,", ").concat(s*(l[4]||1),")");else if(l[1]===l[3])l[2]>=l[0]?r.style.transform="translate(-50%, -50%) scale(".concat(a,", ").concat(s*(l[4]||1),")"):r.style.transform="translate(-50%, -50%) rotateZ(180deg) scale(".concat(a,", ").concat(s*(l[4]||1),")");else{var p=Lu(Ec(Math.atan(d*i/h/n)));r.style.transform=h>=0?"translate(-50%, -50%) rotateZ(".concat(p,"deg) scale(").concat(a,", ").concat(s*(l[4]||1),")"):"translate(-50%, -50%) rotateZ(".concat(p+180,"deg) scale(").concat(a,", ").concat(s*(l[4]||1),")")}},e.prototype.updateRadialStops=function(e){var t=this.panel,r=t.clientWidth,n=t.clientHeight,i=this.node.computedStyle,o=i.scaleX,a=i.scaleY,s=t.querySelector(".e"),l=e.d,c=-1===o?1-l[0]:l[0],u=-1===a?1-l[1]:l[1],h=l[2]-l[0],d=l[3]-l[1],f=Math.sqrt(Math.pow(h*r,2)+Math.pow(d*n,2)),p=f/r*(l[4]||1),v=f/n*(l[4]||1);if(l[0]===l[2])s.style.top=100*u+"%",l[3]>=l[1]?s.style.left=100*(-1===o?l[0]+p:l[0]-p)+"%":s.style.left=100*(-1===o?l[0]-p:l[0]+p)+"%";else if(l[1]===l[3])s.style.left=100*c+"%",l[2]>=l[0]?s.style.top=100*(-1===a?l[1]-v:l[1]+v)+"%":s.style.top=100*(-1===a?l[1]+v:l[1]-v)+"%";else{var m=Math.atan(d*n/h/r)+.5*Math.PI,g=Math.sin(m),y=Math.cos(m);h>=0?(s.style.left=100*(y*p*o+c)+"%",s.style.top=100*(g*v*a+u)+"%"):(s.style.left=100*(-y*p*o+c)+"%",s.style.top=100*(-g*v*a+u)+"%")}},e.prototype.genConic=function(e){var t=this.panel,r=e.stops;t.innerHTML="";var n='<div class="c2"><b></b></div>';r.forEach((function(e,t){n+='<span title="'.concat(t,'"></span>')})),t.innerHTML=n,this.updateConicD(e),this.updateConicStops(e),this.setCur(0)},e.prototype.updateConicD=function(e){var t,r,n,i,o=this.panel,a=o.querySelector(".c2"),s=o.clientWidth,l=o.clientHeight,c=this.node.computedStyle,u=c.scaleX,h=c.scaleY,d=e.d,f=100*(-1===u?1-(null!==(t=d[0])&&void 0!==t?t:.5):null!==(r=d[0])&&void 0!==r?r:.5)+"%",p=100*(-1===h?1-(null!==(n=d[1])&&void 0!==n?n:.5):null!==(i=d[1])&&void 0!==i?i:.5)+"%";a.style.left=f,a.style.top=p,a.style.width=a.style.height=Math.max(s,l)+"px"},e.prototype.updateConicStops=function(e){var t,r,n,i,o=this.panel,a=o.clientWidth,s=o.clientHeight,l=this.node.computedStyle,c=l.scaleX,u=l.scaleY,h=.5*Math.max(a,s),d=o.querySelectorAll("span"),f=o.querySelector(".c2"),p=f.clientWidth/a,v=f.clientHeight/s,m=e.d,g=e.stops,y=100*(-1===c?1-(null!==(t=m[0])&&void 0!==t?t:.5):null!==(r=m[0])&&void 0!==r?r:.5),b=100*(-1===u?1-(null!==(n=m[1])&&void 0!==n?n:.5):null!==(i=m[1])&&void 0!==i?i:.5),x={},w=12;g.forEach((function(e,t){var r=e.color,n=e.offset,i=qu(r),o=d[t];if(o){o.style.background=i;var l=Lu(n||1),m=x[l]||0;if(o.style.transform="",0===n||1===n)o.style.left=100*h/f.clientWidth*p*c+y+"%",o.style.top=b+"%",m&&(o.style.transform="translate(-50%, -50%) translateX(".concat(m*w*c,"px)"));else if(.25===n)o.style.left=y+"%",o.style.top=100*h/f.clientHeight*v*u+b+"%",m&&(o.style.transform="translate(-50%, -50%) translateY(".concat(m*w*u,"px)"));else if(.5===n)o.style.left=100*-h/f.clientWidth*p*c+y+"%",o.style.top=b+"%",m&&(o.style.transform="translate(-50%, -50%) translateX(".concat(-m*w*c,"px)"));else if(.75===n)o.style.left=y+"%",o.style.top=100*-h/f.clientHeight*v*u+b+"%",m&&(o.style.transform="translate(-50%, -50%) translateY(".concat(-m*w*u,"px)"));else{var g=n*Math.PI*2,E=Math.sin(g),_=Math.cos(g),S=h*_,C=h*E;o.style.left=y+100*S*c/a+"%",o.style.top=b+100*C*u/s+"%",m&&(o.style.transform="translate(-50%, -50%) translate(".concat(m*w*_,"px, ").concat(m*w*E,"px)"))}x[l]=m+1}}))},e.prototype.setCur=function(e,t){var r,n;void 0===t&&(t=!1);var i=this.panel;null===(r=i.querySelector(".cur"))||void 0===r||r.classList.remove("cur"),null===(n=i.querySelector('span[title="'.concat(e,'"]')))||void 0===n||n.classList.add("cur"),t&&yC.setLineCur(e)},e.prototype.hide=function(){this.panel.style.display="none",this.data=void 0,this.node=void 0,this.keep=!1},e.prototype.updatePos=function(){this.node&&this.updateSize(this.node)},e}();function QC(e,t,r,n,i,o){void 0===i&&(i=1),void 0===o&&(o=1);var a=0;if(r===e)a=n>=t?-1===o?.75:.25:-1===o?.25:.75;else if(n===t)a=r>=e?-1===i?.5:0:-1===i?0:.5;else if(r>e)if(n>=t){var s=(n-t)/(r-e);a=.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a+=.5:-1===i?a=.5-a:o&&(a=1-a)}else{s=(t-n)/(r-e);a=1-.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a-=.5:-1===i?a=1.5-a:o&&(a=1-a)}else if(n>=t){s=(n-t)/(e-r);a=.5-.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a+=.5:-1===i?a=.5-a:o&&(a=1-a)}else{s=(t-n)/(e-r);a=.5+.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a-=.5:-1===i?a=1.5-a:o&&(a=1-a)}return a}function $C(e,t,r){var n,i,o;return sh([e.color[0]+(t.color[0]-e.color[0])*r,e.color[1]+(t.color[1]-e.color[1])*r,e.color[2]+(t.color[2]-e.color[2])*r,(null!==(n=e.color[3])&&void 0!==n?n:1)+((null!==(i=t.color[3])&&void 0!==i?i:1)-(null!==(o=e.color[3])&&void 0!==o?o:1))*r])}var eT=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){t[r]&&(e.props.points=Ps(t[r].next),tC(e),e.reflectPoints(),e.refresh(),e.checkPointsChange())}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){t[r]&&(e.props.points=Ps(t[r].prev),tC(e),e.reflectPoints(),e.refresh(),e.checkPointsChange())}))},t}(pC),tT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.nodes=[],this.idxes=[],this.clonePoints=[];var i=this.panel=document.createElement("div");i.className="geometry",i.style.display="none",t.appendChild(i);var o,a=-1,s=-1,l=!1,c=!1,u=!1,h=!1,d=!1,f=!1,p=0,v=0,m={td:0,fd:0};i.addEventListener("mousedown",(function(t){var g,b,x,w,E,_,S,C;if(0===t.button&&!r.spaceKey&&n.nodes.length){var T;n.keep=!0;var A=(o=t.target).tagName.toUpperCase(),k=o.classList;if(l=c=u=h=!1,d=!1,f=!1,p=t.clientX,v=t.clientY,"DIV"===A&&k.contains("vt")){n.keepVertPath=!0,a=+o.parentElement.getAttribute("idx"),s=parseInt(o.title);var M=n.idxes[a];r.shiftKey||r.metaKey?(f=!0,M.includes(s)?d=!0:M.push(s),k.add("cur"),null===(g=o.nextElementSibling)||void 0===g||g.classList.add("t"),null===(b=o.previousElementSibling)||void 0===b||b.classList.add("f")):M.includes(s)?d=!0:(M.splice(0),M.push(s),n.clearCur(M),k.add("cur"),null===(x=o.nextElementSibling)||void 0===x||x.classList.add("t"),null===(w=o.previousElementSibling)||void 0===w||w.classList.add("f")),l=!0,n.setClonePoints(),n.emitSelectPoint()}else if("PATH"===A){a=+o.parentElement.parentElement.getAttribute("idx"),T=n.nodes[a];var O=o.getAttribute("title");if(s=parseInt(O),isNaN(s))n.clearCur(),r.emit(iT.SELECT_POINT,[],[]);else{var L=t.offsetX,R=t.offsetY,I=e.getCurPageZoom(!0),P=rT(T,+o.getAttribute("idx"),I);if((re=cu(P,L,R))&&re.d<=5){n.keepVertPath=!0;var F=(te=i.querySelector('div.item[idx="'.concat(a,'"]'))).clientWidth,D=te.clientHeight,N=Ps(T.props.points),B=Qc(P,0,re.t).map((function(e){return{x:e.x/F,y:e.y/D}})),U=Qc(P,re.t,1).map((function(e){return{x:e.x/F,y:e.y/D}})),z=parseInt(/\d+/.exec(O)[0]),X=T.props.points,H=X[z],G=X[z+1]||X[0],j=re.x/F,Y=re.y/D,W={x:j,y:Y,absX:re.x,absY:re.y,cornerRadius:0,cornerStyle:Zs.ROUNDED,curveMode:2===B.length?Ks.STRAIGHT:Ks.ASYMMETRIC,fx:j,fy:Y,absFx:re.x,absFy:re.y,tx:j,ty:Y,absTx:re.x,absTy:re.y,hasCurveFrom:!1,hasCurveTo:!1};if(4===B.length?(H.fx=B[1].x,H.fy=B[1].y,H.absFx=H.fx*F,H.absFy=H.fy*D,W.hasCurveTo=!0,W.tx=B[2].x,W.ty=B[2].y,W.absTx=W.tx*F,W.absTy=W.ty*D,eC(T,[H,W])):3===B.length&&(H.hasCurveFrom&&H.curveMode!==Ks.NONE&&H.curveMode!==Ks.STRAIGHT?(H.fx=B[1].x,H.fy=B[1].y,H.absFx=H.fx*F,H.absFy=H.fy*D,eC(T,H)):(W.hasCurveTo=!0,W.tx=B[1].x,W.ty=B[1].y,W.absTx=W.tx*F,W.absTy=W.ty*D,eC(T,W))),4===U.length?(G.tx=U[2].x,G.ty=U[2].y,G.absTx=G.tx*F,G.absTy=G.ty*D,W.hasCurveFrom=!0,W.fx=U[1].x,W.fy=U[1].y,W.absFx=W.fx*F,W.absFy=W.fy*D,eC(T,[G,W])):3===U.length&&(G.hasCurveTo&&G.curveMode!==Ks.NONE&&G.curveMode!==Ks.STRAIGHT?(G.tx=U[1].x,G.ty=U[1].y,G.absTx=G.tx*F,G.absTy=G.ty*D,eC(T,G)):(W.hasCurveFrom=!0,W.fx=U[1].x,W.fy=U[1].y,W.absFx=W.fx*F,W.absFy=W.fy*D,eC(T,W))),W.hasCurveTo&&W.hasCurveFrom){var q=W.fx-W.x,V=W.fy-W.y,K=W.x-W.tx,Z=W.y-W.ty,J=Math.sqrt(Math.pow(q,2)+Math.pow(V,2)),Q=Math.sqrt(Math.pow(K,2)+Math.pow(Z,2));Math.abs(Q-J)<1e-6&&Math.abs(q-K)<1e-6&&Math.abs(V-Z)<1e-6&&(W.curveMode=Ks.MIRRORED)}else(W.hasCurveTo||W.hasCurveFrom)&&(W.curveMode=Ks.DISCONNECTED);X.splice(z+1,0,W),T.refresh(),T.checkPointsChange(),eC(T,W),n.clearCur(),n.idxes[a].splice(0),n.idxes[a].push(z+1),n.update(T,!0);var $=te.querySelector('.vt[title="'.concat(z+1,'"]'));$.classList.add("cur"),null===(E=$.nextElementSibling)||void 0===E||E.classList.add("t"),null===(_=$.previousElementSibling)||void 0===_||_.classList.add("f");var ee=n.nodes.map((function(e){if(e===T)return{prev:N,next:Ps(T.props.points)}}));r.history.addCommand(new eT(n.nodes.slice(0),ee),!0),r.emit(iT.POINT_NODE,[T],[[W]]),n.emitSelectPoint(),y=-1}else n.clearCur(),r.emit(iT.SELECT_POINT,[],[])}}else if("SPAN"===A){n.keepVertPath=!0;var te=o.parentNode;a=+te.parentElement.title,T=n.nodes[a];M=n.idxes[a];n.clearCur(M),te.classList.add("cur"),null===(S=te.nextElementSibling)||void 0===S||S.classList.add("t"),null===(C=te.previousElementSibling)||void 0===C||C.classList.add("f"),s=parseInt(te.title),M.splice(0),M.push(s);var re=T.props.points[s];o.classList.contains("f")?c=!0:u=!0,n.setClonePoints(),m.td=Math.sqrt(Math.pow(re.dspX-re.dspTx,2)+Math.pow(re.dspY-re.dspTy,2)),m.fd=Math.sqrt(Math.pow(re.dspX-re.dspFx,2)+Math.pow(re.dspY-re.dspFy,2))}else n.clearCur(),r.emit(iT.SELECT_POINT,[],[])}})),document.addEventListener("mousemove",(function(t){var i=n.nodes[a];if(i){var o=e.getCurPage();if(o){var d=e.dpi,f=o.getZoom(),g=Math.round(t.clientX-p),y=Math.round(t.clientY-v),b=Math.round(g*d/f),x=Math.round(y*d/f);if(r.shiftKey&&(Math.abs(b)>=Math.abs(x)?y=x=0:g=b=0),l){var w=[],E=[];n.nodes.forEach((function(e,t){var r=n.idxes[t].map((function(r){var i=e.props.points[r],o=n.clonePoints[t][r];return i.dspX=o.dspX+b,i.dspY=o.dspY+x,i.dspFx=o.dspFx+b,i.dspFy=o.dspFy+x,i.dspTx=o.dspTx+b,i.dspTy=o.dspTy+x,i}));r.length&&(tC(e,r),e.reflectPoints(r),e.refresh(),n.updateVertex(e),w.push(e),E.push(r))})),r.emit(iT.POINT_NODE,w,E)}else if(c||u){var _=i.props.points[s];if(c?(_.dspFx=n.clonePoints[a][s].dspFx+b,_.dspFy=n.clonePoints[a][s].dspFy+x):(_.dspTx=n.clonePoints[a][s].dspTx+b,_.dspTy=n.clonePoints[a][s].dspTy+x),_.curveMode===Ks.MIRRORED||_.curveMode===Ks.ASYMMETRIC){var S=1;if(c){_.curveMode===Ks.ASYMMETRIC&&(S=m.fd/m.td);var C=_.dspFx-_.dspX,T=_.dspFy-_.dspY;_.dspTx=_.dspX-C*S,_.dspTy=_.dspY-T*S}else{_.curveMode===Ks.ASYMMETRIC&&(S=m.fd/m.td);var A=_.dspTx-_.dspX,k=_.dspTy-_.dspY;_.dspFx=_.dspX-A*S,_.dspFy=_.dspY-k*S}}tC(i,_),i.reflectPoints(_),i.refresh(),n.updateVertex(i),r.emit(iT.POINT_NODE,[i],[[_]])}h=!0}}})),document.addEventListener("mouseup",(function(){var e,t,o,p;if(n.nodes[a]){if(l&&!h&&d)if(f){null===(e=i.querySelector('div.item[idx="'.concat(a,'"]')).querySelector('div.vt[title="'.concat(s,'"]')))||void 0===e||e.classList.remove("cur");var v=(m=n.idxes[a]).indexOf(s);v>-1&&(m.splice(v,1),n.emitSelectPoint())}else{var m;null===(t=i.querySelectorAll("div.item"))||void 0===t||t.forEach((function(e,t){e.querySelectorAll("div.vt.cur").forEach((function(e){var r=+e.title;t===a&&r===s||e.classList.remove("cur")}))})),(m=n.idxes[a]).splice(0),m.push(s),n.clearCur(m);var g=i.querySelector('div.item[idx="'.concat(a,'"]')).querySelector('div.vt[title="'.concat(s,'"]'));g.classList.add("cur"),null===(o=g.nextElementSibling)||void 0===o||o.classList.add("t"),null===(p=g.previousElementSibling)||void 0===p||p.classList.add("f"),n.emitSelectPoint()}if(h&&(l||c||u)){var y=[],b=[];n.nodes.forEach((function(e,t){var r=n.clonePoints[t],i=e.props.points;y.push(e),Fs(r,i,["x","y","cornerRadius","cornerStyle","curveMode","fx","fy","tx","ty","hasCurveTo","hasCurveFrom"])?b.push(void 0):b.push({prev:r,next:Ps(i)})})),y.length&&(y.forEach((function(e,t){b[t]&&(e.checkPointsChange(),n.update(e,!1))})),r.history.addCommand(new eT(y,b),!0))}l=c=u=h=!1}}));var g,y=-1;i.addEventListener("mouseover",(function(e){if(!r.isMouseDown){var t=e.target;"PATH"===t.tagName.toUpperCase()?(a=+t.parentElement.parentElement.getAttribute("idx"),y=+t.getAttribute("title"),y=isNaN(y)?-1:+t.getAttribute("idx")):y=-1,g=i.querySelector('.item[idx="'.concat(a,'"] .pj'))}})),i.addEventListener("mousemove",(function(t){var r,o,s,l,c,u=n.nodes[a];if(y>-1&&u){var h=t.offsetX,d=t.offsetY,f=e.getCurPageZoom(!0),p=cu(rT(u,y,f),h,d);null===(r=i.querySelector("svg.stroke .cur"))||void 0===r||r.classList.remove("cur"),null===(o=i.querySelector("svg.interactive .cur"))||void 0===o||o.classList.remove("cur"),null===(s=i.querySelector(".pt.cur"))||void 0===s||s.classList.remove("cur"),p&&p.d<=5?(null===(l=i.querySelector('.item[idx="'.concat(a,'"] svg.stroke path[idx="').concat(y,'"]')))||void 0===l||l.classList.add("cur"),null===(c=i.querySelector('.item[idx="'.concat(a,'"] svg.interactive path[idx="').concat(y,'"]')))||void 0===c||c.classList.add("cur"),g.style.left=p.x+"px",g.style.top=p.y+"px",g.classList.add("cur")):null==g||g.classList.remove("cur")}})),i.addEventListener("mouseout",(function(e){var t,r;"PATH"===e.target.tagName.toUpperCase()&&(null===(t=i.querySelector("svg.stroke .cur"))||void 0===t||t.classList.remove("cur"),null===(r=i.querySelector("svg.interactive .cur"))||void 0===r||r.classList.remove("cur")),y=-1,null==g||g.classList.remove("cur")})),i.addEventListener("wheel",(function(e){(l||c||u)&&e.stopPropagation()})),document.addEventListener("click",(function(e){if(n.keep||n.keepVertPath)return n.keep=!1,void(n.keepVertPath=!1)}))}return e.prototype.show=function(e){var t,r=this;this.nodes.splice(0),(t=this.nodes).push.apply(t,e),this.idxes.splice(0),e.forEach((function(){r.idxes.push([])})),this.panel.innerHTML="",this.nodes.forEach((function(e){eC(e),r.update(e,!0)})),this.panel.style.display="block"},e.prototype.hide=function(){this.panel.style.display="none",this.panel.innerHTML="",this.nodes.splice(0),this.idxes.splice(0),this.keep=!1,this.keepVertPath=!1},e.prototype.update=function(e,t){void 0===t&&(t=!1),-1!==this.nodes.indexOf(e)&&(this.updatePosSize(e),t&&this.genVertex(e),this.updateVertex(e))},e.prototype.updateAll=function(e){var t=this;void 0===e&&(e=!1),this.nodes.forEach((function(r){t.update(r,e)}))},e.prototype.updatePosSize=function(e){var t=this.nodes.indexOf(e);if(-1!==t){var r=this.panel,n=r.querySelector('div.item[idx="'.concat(t,'"]'));n||((n=document.createElement("div")).className="item",n.setAttribute("idx",t.toString()),r.appendChild(n));var i=this.listener.select.calRect(e);n.style.left=i.left+"px",n.style.top=i.top+"px",n.style.width=i.width+"px",n.style.height=i.height+"px",n.style.transform=i.transform}},e.prototype.genVertex=function(e){var t=this.nodes.indexOf(e);if(-1!==t){var r=this.panel,n=e.props.points,i=r.querySelector('div.item[idx="'.concat(t,'"]'));i.innerHTML='<svg class="stroke"></svg><svg class="interactive"></svg>';var o=i.querySelector("svg.stroke"),a=i.querySelector("svg.interactive"),s="",l="",c=n.length,u=0;n.forEach((function(t,r){var n=t.curveMode===Ks.NONE||t.curveMode===Ks.STRAIGHT;l+='<div class="vt" title="'.concat(r,'">'),l+='<span class="t '.concat(n?"hide":"",'"><b></b></span>'),l+='<span class="f '.concat(n?"hide":"",'"><b></b></span>'),l+="</div>",t.curveMode===Ks.NONE||t.curveMode===Ks.STRAIGHT?(t.cornerRadius&&(r<c||e.props.isClosed)&&(s+='<path title="cr'.concat(r,'" idx="').concat(u++,'" d=""></path>')),(r<c||e.props.isClosed)&&(s+='<path title="'.concat(r,'" idx="').concat(u++,'" d=""></path>'))):(r<c||e.props.isClosed)&&(s+='<path title="'.concat(r,'" idx="').concat(u++,'" d=""></path>'))})),o.innerHTML=s,a.innerHTML=s,i.innerHTML+=l+'<div class="pj"></div>',r.appendChild(i)}},e.prototype.updateVertex=function(e){var t=this.nodes.indexOf(e);if(-1!==t){e.buildPoints();var r=this.panel.querySelector('div.item[idx="'.concat(t,'"]')),n=e.root.getCurPageZoom(!0),i=e.props.points,o=e.coords,a=r.querySelectorAll(".vt"),s=r.querySelectorAll("svg.stroke path"),l=r.querySelectorAll("svg.interactive path");i.forEach((function(e,t){var r=a[t];if(r){r.style.transform="translate(".concat(e.absX*n,"px, ").concat(e.absY*n,"px)");var i=r.querySelectorAll("span"),o=i[0],s=i[1];if(o.classList.add("hide"),s.classList.add("hide"),e.curveMode!==Ks.NONE&&e.curveMode!==Ks.STRAIGHT){var l=[];e.hasCurveTo&&o&&(o.classList.remove("hide"),l.push({el:o,cx:e.absTx,cy:e.absTy})),e.hasCurveFrom&&s&&(s.classList.remove("hide"),l.push({el:s,cx:e.absFx,cy:e.absFy})),l.forEach((function(t){var r=t.el,i=t.cx,o=t.cy,a=(i-e.absX)*n,s=(o-e.absY)*n;r.style.transform="translate(".concat(a,"px, ").concat(s,"px)");var l=Math.sqrt(a*a+s*s),c=r.firstElementChild;c.style.width=l+"px",c.style.transform="rotateZ(".concat(function(e,t){if(0===e)return t>=0?90:-90;if(0===t)return e>=0?0:180;var r=Math.atan(t/e),n=Ec(r);if(e>0)return n;if(e<0)return 180+n}(-a,-s)||0,"deg)")}))}}})),o.forEach((function(e,t){if(s[t]&&l[t]){var r="M"+e.slice(-2).map((function(e){return e*n})).join(","),a=o[t+1]||o[0],c=s[t].getAttribute("title")||"",u=parseInt(c);if(isNaN(u)){r+="L";var h=parseInt(/\d+/.exec(c)[0]);r+=i[h].absX*n+","+i[h].absY*n,r+="L",r+=a.slice(-2).map((function(e){return e*n})).join(",")}else a&&(6===a.length?r+="C":4===a.length?r+="Q":2===a.length&&(r+="L"),r+=a.map((function(e){return e*n})).join(","));s[t].setAttribute("d",r),l[t].setAttribute("d",r)}}))}},e.prototype.updateCurPosSize=function(){var e=this;this.nodes.forEach((function(t,r){e.idxes[r].length&&e.updatePosSize(t)}))},e.prototype.clearCur=function(e){var t,r,n,i=this.panel;null===(t=i.querySelectorAll("div.cur"))||void 0===t||t.forEach((function(e){e.classList.remove("cur")})),null===(r=i.querySelectorAll("div.f"))||void 0===r||r.forEach((function(e){e.classList.remove("f")})),null===(n=i.querySelectorAll("div.t"))||void 0===n||n.forEach((function(e){e.classList.remove("t")})),this.idxes.forEach((function(t){t!==e&&t.splice(0)}))},e.prototype.hasEditPoint=function(){for(var e=0,t=this.idxes.length;e<t;e++)if(this.idxes[e].length)return!0;return!1},e.prototype.delVertex=function(){var e=this,t=[],r=[];this.nodes.forEach((function(n,i){t.push(n);var o=e.idxes[i];if(o.length){var a=Ps(n.props.points);o.sort((function(e,t){return t-e})),o.forEach((function(e){n.props.points.splice(e,1)})),n.refresh(),n.checkPointsChange(),e.update(n,!0),r.push({prev:a,next:Ps(n.props.points)})}else r.push(void 0)})),t.length&&this.listener.history.addCommand(new eT(t,r),!0)},e.prototype.setClonePoints=function(){this.clonePoints=this.nodes.map((function(e){return Ps(e.props.points)}))},e.prototype.emitSelectPoint=function(){var e=this,t=[];this.nodes.map((function(r,n){var i=e.idxes[n];if(i.length){var o=[];i.forEach((function(e){o.push(r.props.points[e])})),t.push(o)}})),this.listener.emit(iT.SELECT_POINT,[],t)},e}();function rT(e,t,r){var n=e.coords,i=n[t].slice(-2),o=n[t+1]||n[0],a=[];a.push({x:i[0]*r,y:i[1]*r});for(var s=0,l=o.length;s<l;s+=2)a.push({x:o[s]*r,y:o[s+1]*r});return a}var nT="undefined"!=typeof navigator&&/win/i.test(navigator.platform),iT=function(e){function t(t,r,n){void 0===n&&(n={});var i=e.call(this)||this;return i.isWin=nT,i.options=n,i.state=fC.NORMAL,i.root=t,i.dom=r,i.history=new LC,i.metaKey=!1,i.shiftKey=!1,i.ctrlKey=!1,i.altKey=!1,i.spaceKey=!1,i.middleKey=!1,i.isMouseDown=!1,i.isMouseMove=!1,i.button=0,i.isControl=!1,i.isRotate=!1,i.controlType=SC.T,i.originX=0,i.originY=0,i.startX=0,i.startY=0,i.pageTx=0,i.pageTy=0,i.centerX=0,i.centerY=0,i.dx=0,i.dy=0,i.isFrame=!1,i.selected=[],i.abcStyle=[],i.computedStyle=[],i.originStyle=[],i.cssStyle=[],i.updateOrigin(),i.select=new aC(t,r),i.input=new mC(t,r,i),i.guides=new VC(t,r,i),i.gradient=new JC(t,r,i),i.geometry=new tT(t,r,i),i.clones=[],r.addEventListener("mousedown",i.onMouseDown.bind(i)),r.addEventListener("mousemove",i.onMouseMove.bind(i)),r.addEventListener("mouseup",i.onMouseUp.bind(i)),r.addEventListener("mouseleave",i.onMouseLeave.bind(i)),r.addEventListener("touchstart",i.onTouchStart.bind(i)),r.addEventListener("touchmove",i.onTouchMove.bind(i)),r.addEventListener("touchend",i.onTouchEnd.bind(i)),r.addEventListener("click",i.onClick.bind(i)),r.addEventListener("dblclick",i.onDblClick.bind(i)),r.addEventListener("wheel",i.onWheel.bind(i)),r.addEventListener("contextmenu",i.onContextMenu.bind(i)),document.addEventListener("keydown",i.onKeyDown.bind(i)),document.addEventListener("keyup",i.onKeyUp.bind(i)),i}return v(t,e),t.prototype.updateOrigin=function(){var e=this.dom.getBoundingClientRect();this.originX=e.left,this.originY=e.top},t.prototype.active=function(e){var r;if(this.selected.splice(0),(r=this.selected).push.apply(r,e),this.state===fC.EDIT_GEOM){for(var n=!!e.length,i=0,o=e.length;i<o;i++){if(!(e[i]instanceof tE)){n=!1;break}}n?(this.select.hideSelect(),this.geometry.show(this.selected)):(this.cancelEditGeom(),this.updateActive())}else this.updateActive();this.emit(t.SELECT_NODE,this.selected.slice(0))},t.prototype.updateActive=function(){this.computedStyle=this.selected.map((function(e){return e.getComputedStyle()})),this.selected.length?this.select.showSelect(this.selected):(this.select.hideSelect(),this.cancelEditGeom(),this.cancelEditGradient(),this.cancelEditText())},t.prototype.prepare=function(){var e=this,t=this.selected;t.forEach((function(t){e.toggleGroup(t,!0)})),this.computedStyle=t.map((function(e){return e.getComputedStyle()})),this.originStyle=t.map((function(e){return e.getStyle()}))},t.prototype.toggleGroup=function(e,t){void 0===t&&(t=!1);var r=e.parent;r&&r.isGroup&&r instanceof VE&&(r.fixedPosAndSize=t)},t.prototype.getNode=function(e,t,r){var n;void 0===r&&(r=!1);var i=this.metaKey||nT&&this.ctrlKey;(null===(n=this.options.enabled)||void 0===n?void 0:n.selectWithMeta)&&(i=!i);var o=GS(this.root,e,t,i,this.selected,r);return o instanceof Fw&&o.children.length&&!i&&!this.selected.includes(o)&&(o=void 0),o},t.prototype.beforeResize=function(){this.selected.length>1?(this.selectRect=this.select.getAspectRatio(),this.clientRect=this.selected.map((function(e){var t=e.getBoundingClientRect({excludeDpi:!0});return{x:t.left,y:t.top,w:t.width,h:t.height}}))):(this.selectRect=void 0,this.clientRect=void 0)},t.prototype.onDown=function(e,r){var n,i,o=this.selected,a=this.select.isSelectControlDom(e);this.updateOrigin();var l=this.root,c=l.dpi;this.originStyle.splice(0),this.cssStyle.splice(0),this.computedStyle.splice(0),this.dx=this.dy=0;var u=r instanceof MouseEvent&&2===r.button;if(a&&!u){if(null===(n=this.options.disabled)||void 0===n?void 0:n.resize)return;this.isControl=a;var h=this.controlType={t:SC.T,r:SC.R,b:SC.B,l:SC.L,tl:SC.TL,tr:SC.TR,bl:SC.BL,br:SC.BR}[e.className];if(this.prepare(),this.state===fC.EDIT_TEXT&&this.cancelEditText(),1===o.length&&(this.metaKey||nT&&this.ctrlKey)&&!o[0].isSlice&&!(o[0]instanceof QE)&&[SC.TL,SC.TR,SC.BL,SC.BR].indexOf(h)>-1){var d=o[0].getBoundingClientRect().points,f=Tu(d[0].x,d[0].y,d[2].x,d[2].y,d[1].x,d[1].y,d[3].x,d[3].y);this.centerX=f.x/c+this.originX,this.centerY=f.y/c+this.originY,this.isRotate=!0}else this.abcStyle=o.map((function(e){return e.isArtBoard&&e instanceof Fw&&!e.props.resizesContent?e.children.map((function(e){var t=e.computedStyle,r=e.style,n={left:Ps(r.left),right:Ps(r.right),top:Ps(r.top),bottom:Ps(r.bottom),width:Ps(r.width),height:Ps(r.height)};return h===SC.T||h===SC.TL||h===SC.TR?(r.bottom.u!==Xs.PX&&(r.bottom.v=t.bottom,r.bottom.u=Xs.PX),r.top.u!==Xs.AUTO&&(r.top.u=Xs.AUTO)):h!==SC.B&&h!==SC.BL&&h!==SC.BR||(r.top.u!==Xs.PX&&(r.top.v=t.top,r.top.u=Xs.PX),r.bottom.u!==Xs.AUTO&&(r.bottom.u=Xs.AUTO)),h===SC.L||h===SC.TL||h===SC.BL?(r.right.u!==Xs.PX&&(r.right.v=t.right,r.right.u=Xs.PX),r.left.u!==Xs.AUTO&&(r.left.u=Xs.AUTO)):h!==SC.R&&h!==SC.TR&&h!==SC.BR||(r.left.u!==Xs.PX&&(r.left.v=t.left,r.left.u=Xs.PX),r.right.u!==Xs.AUTO&&(r.right.u=Xs.AUTO)),r.width.u!==Xs.PX&&(r.width.v=t.width,r.width.u=Xs.PX),r.height.u!==Xs.PX&&(r.height.v=t.height,r.height.u=Xs.PX),n})):[]})),this.beforeResize()}else if(this.state===fC.ADD_TEXT){var p=this.root.getCurPage(),v=p.getZoom(),m=(r.clientX-this.originX)*c,g=(r.clientY-this.originY)*c,y="输入文本",b=new r_({uuid:s(),name:y,index:0,style:{fontFamily:"Arial",fontStyle:"normal",fontWeight:400,fontSize:16,lineHeight:0,textAlign:"left",textDecoration:[],letterSpacing:0,paragraphSpacing:0,color:"#000",translateY:"-50%"},content:y,rich:[{location:0,length:4,fontFamily:"Arial",fontStyle:"normal",fontWeight:400,fontSize:16,lineHeight:0,textAlign:"left",textDecoration:[],letterSpacing:0,paragraphSpacing:0,color:"#000"}]}),x=jS(this.root,m,g);if(x){var w=(m-(S=x.getBoundingClientRect()).left)/v,E=(g-S.top)/v;b.updateStyle({left:100*w/x.width+"%",top:100*E/x.height+"%"}),x.appendChild(b);var _=b.width;b.updateStyle({left:100*(b.computedStyle.left+.5*_)/x.width+"%",translateX:"-50%"})}else{var S;w=(m-(S=p.getBoundingClientRect()).left)/v,E=(g-S.top)/v;b.updateStyle({left:100*w/p.width+"%",top:100*E/p.height+"%"}),p.appendChild(b);_=b.width;b.updateStyle({left:100*(b.computedStyle.left+.5*_)/p.width+"%",translateX:"-50%"})}this.selected.splice(0),this.selected.push(b),this.select.showSelect(this.selected),this.input.show(b,r.clientX-this.originX,r.clientY-this.originY),this.input.node.selectAll(),this.input.hideCursor(),b.beforeEdit(),this.select.select.classList.add("text"),this.dom.classList.remove("text"),this.history.addCommand(new ZC([b],[{x:b.computedStyle.left,y:b.computedStyle.top,parent:b.parent}])),this.emit(t.ADD_NODE,[b]),this.state=fC.EDIT_TEXT,this.emit(t.STATE_CHANGE,fC.NORMAL,this.state)}else{if(o.length>1&&!(this.metaKey||nT&&this.ctrlKey)&&!this.shiftKey){var C=r.clientX,T=r.clientY,A=this.select.select.getBoundingClientRect();if(C>=A.left&&T>=A.top&&C<=A.right&&T<=A.bottom)return this.prepare(),void this.guides.initMove(this.select.select,o)}if(this.state===fC.EDIT_GEOM)return void(this.geometry.keep&&this.geometry.keepVertPath||(this.isFrame=!0));m=(r.clientX-this.originX)*c,g=(r.clientY-this.originY)*c;var k=this.metaKey||nT&&this.ctrlKey;(null===(i=this.options.enabled)||void 0===i?void 0:i.selectWithMeta)&&(k=!k);var M=this.getNode(m,g);if(M instanceof Fw&&M.children.length&&!o.includes(M))if(k){for(var O=!1,L=(f=0,o.length);f<L;f++){if((B=o[f])===M||B.artBoard===M){O=!0;break}}O||(this.mouseDownArtBoard=M,M=void 0)}else M=void 0;else M?M.artBoard&&o.includes(M.artBoard)&&(this.mouseDown2ArtBoard=M,M=M.artBoard):M=WS(l,m,g);this.isFrame=!M;var R=o.slice(0);if(M)if((f=o.indexOf(M))>-1)if(!this.shiftKey||this.state===fC.EDIT_TEXT&&o[0]===M){if(this.state===fC.EDIT_TEXT){b=o[0];if(this.shiftKey)b.setCursorEndByAbsCoords(m,g),b.inputStyle=void 0,this.input.hideCursor();else{var I=b.cursor,P=I.isMulti,F=I.start;b.resetCursor();var D=b.setCursorStartByAbsCoords(m,g);if(this.input.updateCursor(D),this.input.showCursor(),b.cursor.isMulti===P&&b.cursor.start===F)return}return void this.emit(t.CURSOR_NODE,o.slice(0))}if(1===o.length&&o[0]===M)return this.prepare(),this.guides.initMove(this.select.select,o),void(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)));o.splice(0),o.push(M)}else 1===o.length&&o[0]===M||o.splice(f,1);else{if(this.shiftKey)for(var N=o.length-1;N>=0;N--){var B=o[N];if(M.isArtBoard&&B.artBoard===M&&M!==B)return;B.isArtBoard&&M.artBoard===B&&M!==B&&o.splice(N,1)}else o.splice(0);o.push(M)}else this.state===fC.EDIT_TEXT||([fC.EDIT_GRADIENT,fC.EDIT_GEOM].includes(this.state)?this.emit(t.SELECT_POINT,[],[]):this.shiftKey||o.splice(0));if(this.state===fC.EDIT_TEXT&&this.cancelEditText(R[0]),this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)),o.length?this.select.showSelect(o):this.select.hideSelect(),0===R.length&&0===o.length)return;(this.metaKey||nT&&this.ctrlKey)&&1===o.length&&this.select.metaKey(!0),this.prepare(),this.guides.initMove(this.select.select,o),this.emit(t.SELECT_NODE,o.slice(0))}},t.prototype.onMouseDown=function(e){var t,r;if(!(null===(t=this.options.disabled)||void 0===t?void 0:t.select)&&!this.isMouseDown){var n=this.root.getCurPage();if(n){if(this.button=e.button,2===e.button){if([fC.EDIT_GRADIENT,fC.EDIT_GEOM].includes(this.state))return void CC.showOk(e.pageX,e.pageY,this);if(this.metaKey||nT&&this.ctrlKey||this.state===fC.EDIT_TEXT||(null===(r=this.options.disabled)||void 0===r?void 0:r.contextMenu))return;var i=e.target;return this.onDown(i,e),void CC.showCanvas(e.pageX,e.pageY,this)}if([fC.EDIT_GRADIENT,fC.EDIT_GEOM].includes(this.state))if(0!==e.button||this.spaceKey)(1===e.button||0===e.button&&this.spaceKey)&&(this.state===fC.EDIT_GRADIENT?(this.gradient.keep=!0,yC.keep=!0):this.geometry.keep=!0);else if(this.state===fC.EDIT_GRADIENT)return void(this.gradient.keep||this.cancelEditGradient());this.isMouseDown=!0,this.isMouseMove=!1,this.startX=e.clientX,this.startY=e.clientY,1===e.button&&(this.middleKey=!0);var o=n.getComputedStyle();if(this.pageTx=o.translateX,this.pageTy=o.translateY,0===e.button&&this.spaceKey||this.middleKey||this.state===fC.HAND)this.dom.classList.add("handing");else if(!this.spaceKey){i=e.target;this.onDown(i,e)}}}},t.prototype.onMove=function(e,r){var n,i,o,a,s,l=this,c=this.root,u=c.getCurPage();if(u&&![fC.EDIT_GRADIENT].includes(this.state)){var h=c.dpi,d=e.clientX-this.startX,f=e.clientY-this.startY,p=u.getZoom(),v=this.dx=Math.round(d*h/p),m=this.dy=Math.round(f*h/p),g=this.selected;if(this.isControl)if(this.isRotate){var y=this.centerX-this.originX,b=this.centerY-this.originY,x=this.startX-this.originX,w=this.startY-this.originY,E=e.clientX-this.originX,_=e.clientY-this.originY,S=Ec(Tc(Math.sqrt(Math.pow(x-E,2)+Math.pow(w-_,2)),Math.sqrt(Math.pow(y-E,2)+Math.pow(b-_,2)),Math.sqrt(Math.pow(x-y,2)+Math.pow(w-b,2)))),C=ql(x-y,w-b,E-y,_-b);if(this.shiftKey)for(var T=0;T<=180;T+=15)if(Math.abs(S-T)<=7.5){S=T;break}var A=g[0],k=(this.computedStyle[0].rotateZ+S*(C>=0?1:-1))%360;A.updateStyle({rotateZ:k}),this.select.updateSelect(g),this.emit(t.ROTATE_NODE,g.slice(0))}else{var M=this.shiftKey;if(!M){T=0;for(var O=g.length;T<O;T++)if(g[T].props.constrainProportions){M=!0;break}}var L=this.altKey;(null===(n=this.options.enabled)||void 0===n?void 0:n.resizeWithAlt)&&(L=!L);var R=this.controlType;g.forEach((function(e,t){l.isMouseMove||(e.startSizeChange(),l.computedStyle[t]=e.getComputedStyle(),l.cssStyle[t]=e.getCssStyle());var r=l.computedStyle[t],n=l.cssStyle[t];l.selectRect&&l.clientRect&&l.clientRect[t]?kC.updateStyleMultiAr(e,r,n,v,m,R,l.clientRect[t],l.selectRect,M,L):kC.updateStyle(e,r,n,v,m,R,M,L)})),this.isMouseMove=!0,this.select.updateSelect(g),this.emit(t.RESIZE_NODE,g.slice(0))}else if(this.isMouseDown){if(this.state===fC.EDIT_TEXT){var I=(e.clientX-this.originX)*h,P=(e.clientY-this.originY)*h,F=g[0],D=F.cursor,N=D.isMulti,B=D.start,U=D.end;F.setCursorEndByAbsCoords(I,P),this.input.hideCursor();var z=F.cursor;N===z.isMulti&&B===z.start&&U===z.end||this.emit(t.CURSOR_NODE,g.slice(0))}else{if(null===(i=this.options.disabled)||void 0===i?void 0:i.move)return;if(this.isFrame){this.isMouseMove?this.select.updateFrame(d,f):this.select.showFrame(this.startX-this.originX,this.startY-this.originY,d,f),this.isMouseMove=!0;var X=(this.startX-this.originX)*h,H=(this.startY-this.originY)*h,G=this.metaKey||nT&&this.ctrlKey;if((null===(o=this.options.enabled)||void 0===o?void 0:o.selectWithMeta)&&(G=!G),this.state===fC.EDIT_GEOM){var j=this.geometry;if(d&&f||j.keep){j.keep=!0;var Y=!1;j.nodes.forEach((function(e,t){var r,n,i,o=$S(e,X,H,X+d*h,H+f*h);if(o.length){j.nodes.includes(e)||j.nodes.push(e);var a=j.nodes.indexOf(e),s=j.idxes[a];if(o.join(",")!==s.sort((function(e,t){return e-t})).join(",")){s.splice(0),s.push.apply(s,o);var l=j.panel.querySelector('div.item[idx="'.concat(a,'"]'));null===(r=l.querySelectorAll("div.cur"))||void 0===r||r.forEach((function(e){e.classList.remove("cur")})),null===(n=l.querySelectorAll("div.f"))||void 0===n||n.forEach((function(e){e.classList.remove("f")})),null===(i=l.querySelectorAll("div.t"))||void 0===i||i.forEach((function(e){e.classList.remove("t")})),o.forEach((function(e){var t,r,n=l.querySelector('div.vt[title="'.concat(e,'"]'));n.classList.add("cur"),null===(t=n.nextElementSibling)||void 0===t||t.classList.add("t"),null===(r=n.previousElementSibling)||void 0===r||r.classList.add("f")})),Y=!0}}})),Y&&this.geometry.emitSelectPoint()}return}var W=qS(c,X,H,X+d*h,H+f*h,G),q=g.splice(0);g.push.apply(g,W);var V=q.length!==g.length;if(!V)for(T=0,O=q.length;T<O;T++)q[T]!==g[T]&&(V=!0);V&&(W.length?this.select.showSelect(g):this.select.hideSelect(),this.emit(t.SELECT_NODE,g.slice(0)))}else{if(this.state===fC.EDIT_GEOM)return;if(this.select.select.classList.add("move"),this.shiftKey&&(Math.abs(v)>=Math.abs(m)?this.dy=f=m=0:this.dx=d=v=0),!(null===(a=this.options.disabled)||void 0===a?void 0:a.guides))if(G=this.metaKey||nT&&this.ctrlKey)this.guides.hide();else{var K=this.guides.snapMove(d,f,h/p);K&&(this.dx=v+=K.x*h/p,this.dy=m+=K.y*h/p)}g.forEach((function(e,r){var n=l.computedStyle[r];e.artBoard!==TC.update(e,n,v,m)&&l.emit(t.ART_BOARD_NODE,[e])})),this.select.updateSelect(g),this.emit(t.MOVE_NODE,g.slice(0))}}this.isMouseMove=!0}else if(!r&&this.state===fC.NORMAL){if(null===(s=this.options.disabled)||void 0===s?void 0:s.hover)return;var Z=e.target;if(this.select.isSelectControlDom(Z))return void(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)));this.startX=e.clientX-this.originX,this.startY=e.clientY-this.originY;I=this.startX*h,P=this.startY*h;this.hover(I,P)}}},t.prototype.onMouseMove=function(e){var r,n,i=this.root,o=i.dpi,a=this.selected;if(!this.spaceKey&&!this.middleKey&&this.state!==fC.HAND||this.isFrame)this.onMove(e,!1);else if(this.isMouseDown){if(null===(r=this.options.disabled)||void 0===r?void 0:r.drag)return;this.dom.classList.add("handing"),this.select.hideHover(),this.isMouseMove=!0;var s=i.getCurPage();if(s){var l=e.clientX-this.startX,c=e.clientY-this.startY;s.updateStyle({translateX:this.pageTx+l,translateY:this.pageTy+c}),a.length&&this.select.updateSelect(a),this.state===fC.EDIT_GRADIENT?this.gradient.updatePos():this.state===fC.EDIT_GEOM&&this.geometry.updateCurPosSize()}}else{if(null===(n=this.options.disabled)||void 0===n?void 0:n.hover)return;if("CANVAS"!==e.target.tagName.toUpperCase())return;var u=this.getNode(e.offsetX*o,e.offsetY*o);u?(-1===a.indexOf(u)&&this.select.showHover(u),this.emit(t.HOVER_NODE,u)):this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE))}},t.prototype.onMouseUp=function(e){var r,n,i=this;if(!e||e.button===this.button){var o=this.selected;if(o.forEach((function(e){i.toggleGroup(e,!1)})),this.isControl)if(this.isControl=!1,this.isRotate){this.isRotate=!1;var a=o[0];this.history.addCommand(new IC([a],[{prev:{rotateZ:this.computedStyle[0].rotateZ},next:{rotateZ:a.computedStyle.rotateZ}}]),!0),this.metaKey||nT&&this.ctrlKey||this.select.metaKey(!1)}else{var s=this.dx,l=this.dy;if(this.abcStyle.forEach((function(e,t){if(e.length){var r=o[t].children;e.forEach((function(e,t){var n=r[t].style;["left","right","top","bottom","width","height"].forEach((function(t){var r=e[t];n[t].v=r.v,n[t].u=r.u}))}))}})),this.isMouseMove){var c=this.shiftKey;if(!c)for(var u=0,h=o.length;u<h;u++)if(o[u].props.constrainProportions){c=!0;break}var d=this.altKey;(null===(r=this.options.enabled)||void 0===r?void 0:r.resizeWithAlt)&&(d=!d);var f=this.controlType,p=[];o.forEach((function(e,t){if(e.endSizeChange(i.originStyle[t]),s||l){e.checkPosSizeUpward();var r={dx:s,dy:l,controlType:f,aspectRatio:c,clientRect:i.clientRect&&i.clientRect[t],selectRect:i.selectRect,fromCenter:d},n=i.originStyle[t];n.width.u===Xs.AUTO&&(r.widthFromAuto=!0),n.height.u===Xs.AUTO&&(r.heightFromAuto=!0),i.computedStyle[t].scaleX!==e.computedStyle.scaleX&&(r.flipX=!0),i.computedStyle[t].scaleY!==e.computedStyle.scaleY&&(r.flipY=!0),p.push(r)}})),p.length&&this.history.addCommand(new kC(o.slice(0),p))}}else if(this.isMouseMove)if(this.state===fC.EDIT_TEXT){if(null===(n=this.options.disabled)||void 0===n?void 0:n.inputText)return;o[0].checkCursorMulti()?this.input.hideCursor():(this.input.updateCursor(),this.input.showCursor()),this.input.focus()}else if([fC.EDIT_GRADIENT].includes(this.state));else if(this.isFrame)this.select.hideFrame();else{this.guides.hide(),this.select.select.classList.remove("move");var v=this.dx,m=this.dy,g=[];o.forEach((function(e,t){e.endPosChange(i.originStyle[t],v,m),(v||m)&&(e.checkPosSizeUpward(),g.push({dx:v,dy:m}))})),g.length&&this.history.addCommand(new TC(o.slice(0),g),!0)}else this.mouseDownArtBoard?(this.shiftKey||o.splice(0),o.push(this.mouseDownArtBoard),this.select.hideHover(),this.select.showSelect(o),this.prepare(),this.emit(t.SELECT_NODE,o.slice(0))):this.mouseDown2ArtBoard&&!this.shiftKey&&(o.splice(0),o.push(this.mouseDown2ArtBoard),this.select.hideHover(),this.select.showSelect(o),this.prepare(),this.emit(t.SELECT_NODE,o.slice(0)));this.state===fC.EDIT_GEOM&&(this.geometry.keep||this.cancelEditGeom()),this.isMouseDown=!1,this.isMouseMove=!1,this.mouseDownArtBoard=void 0,this.mouseDown2ArtBoard=void 0,this.isFrame=!1,this.middleKey=!1,this.dom.classList.remove("handing"),this.spaceKey||this.middleKey||this.state===fC.HAND||this.dom.classList.remove("hand")}},t.prototype.onMouseLeave=function(){this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)),(this.isMouseDown||this.isControl)&&this.onMouseUp()},t.prototype.onTouchStart=function(e){if(1===e.touches.length){var t=e.touches[0];this.isMouseDown=!0,this.isMouseMove=!1,this.startX=t.clientX,this.startY=t.clientY;var r=e.target;this.onDown(r,t)}},t.prototype.onTouchMove=function(e){1===e.touches.length&&this.onMove(e.touches[0],!0)},t.prototype.onTouchEnd=function(){this.onMouseUp()},t.prototype.onClick=function(e){},t.prototype.onDblClick=function(e){var r,n,i,o=this.root;if(o.getCurPage()){var a=this.selected.slice(0),s=o.dpi,l=this.getNode((e.clientX-this.originX)*s,(e.clientY-this.originY)*s,!0);if(l&&!(l instanceof Fw)){if(1!==this.selected.length||l!==this.selected[0]){if(null===(r=this.options.disabled)||void 0===r?void 0:r.select)return;this.selected.splice(0),this.selected.push(l),this.select.showSelect(this.selected)}if(l instanceof r_){if(null===(n=this.options.disabled)||void 0===n?void 0:n.editText)return;this.input.show(l,e.clientX-this.originX,e.clientY-this.originY),l.beforeEdit(),this.state=fC.EDIT_TEXT,this.select.select.classList.add("text"),this.emit(t.STATE_CHANGE,fC.NORMAL,this.state)}else if(l instanceof tE&&a.includes(l)){if(null===(i=this.options.disabled)||void 0===i?void 0:i.editGeom)return;this.select.hideSelect(),this.geometry.show([l]),this.state=fC.EDIT_GEOM,this.emit(t.STATE_CHANGE,fC.NORMAL,this.state)}this.emit(t.SELECT_NODE,this.selected.slice(0))}}},t.prototype.onWheel=function(e){var r,n;e.preventDefault();var i=this.root,o=i.dpi,a=i.width,s=i.height,l=i.getCurPage();if(l){if(this.select.hideHover(),e.ctrlKey||e.metaKey){if(null===(r=this.options.disabled)||void 0===r?void 0:r.scale)return;var c=e.deltaY;e.ctrlKey&&!e.metaKey&&(c*=50);var u=0;c<0?u=c<-300?.2:c<-200?.1:c<-100?.05:c<-50?.02:.01:c>0&&(u=c>300?-.2:c>200?-.1:c>100?-.05:c>50?-.02:-.01);var h=(e.clientX-this.originX)*o/a,d=(e.clientY-this.originY)*o/s,f=l.getZoom(!0);f<1&&(u*=f),u<0&&u>-.01?u=-.01:u>0&&u<.01&&(u=.01),(f+=u)>32?f=32:f<.01&&(f=.01),f=Lu(f),i.zoomTo(f,h,d),this.emit(t.ZOOM_PAGE,f)}else{if(null===(n=this.options.disabled)||void 0===n?void 0:n.drag)return;var p=l.getComputedStyle(),v=p.translateX,m=p.translateY;l.updateStyle({translateX:v-e.deltaX,translateY:m-e.deltaY})}this.updateSelected(),this.updateInput(),this.updateGradient(),this.updateGeom()}},t.prototype.zoom=function(e){var r=this.root,n=r.getCurPage();if(n){var i=n.getZoom(!0);(i*=e)>32?i=32:i<.01&&(i=.01),i=Lu(i),r.zoomTo(i,.5,.5),this.updateSelected(),this.updateInput(),this.updateGradient(),this.updateGeom(),this.emit(t.ZOOM_PAGE,i)}},t.prototype.zoomTo=function(e,r,n){void 0===r&&(r=.5),void 0===n&&(n=.5);var i=this.root.getCurPage();i&&(i.zoomTo(e,r,n),this.updateSelected(),this.updateInput(),this.updateGradient(),this.updateGeom(),this.emit(t.ZOOM_PAGE,e))},t.prototype.zoomActual=function(){this.root.zoomActual()&&this.emit(t.ZOOM_PAGE,this.root.getCurPageZoom())},t.prototype.zoomFit=function(){this.root.zoomFit()&&this.emit(t.ZOOM_PAGE,this.root.getCurPageZoom())},t.prototype.selectAll=function(){var e,r=this.root;if(r.getCurPage()){var n=this.metaKey||nT&&this.ctrlKey;(null===(e=this.options.enabled)||void 0===e?void 0:e.selectWithMeta)&&(n=!n);var i=qS(r,0,0,r.width,r.height,n);this.active(i),this.emit(t.SELECT_NODE,i.slice(0))}},t.prototype.group=function(e){if(void 0===e&&(e=this.selected),e.length){var r=GC.operate(e),n=r.data,i=r.group;if(i){var o=this.selected.slice(0);this.selected.splice(0),this.selected.push(i),this.select.updateSelect(this.selected),this.history.addCommand(new GC(o,n,i)),this.emit(t.GROUP_NODE,[i],[o.slice(0)])}}},t.prototype.unGroup=function(e){var r=this;void 0===e&&(e=this.selected);var n=e.filter((function(e){return e instanceof VE}));if(n.length){var i=jC.operate(n);this.selected.splice(0),i.forEach((function(e){var t;(t=r.selected).push.apply(t,e.children)})),this.select.updateSelect(this.selected),this.history.addCommand(new jC(n.slice(0),i.map((function(e){return{parent:e.parent,children:e.children}})))),this.emit(t.UN_GROUP_NODE,i.map((function(e){return e.children.slice(0)})),n)}},t.prototype.mask=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){var r=["none","outline","alpha","gray","alpha-with","gray-with"][t.computedStyle.maskMode];n.push({maskMode:r}),t.updateStyle({maskMode:e})})),this.history.addCommand(new XC(r.slice(0),n.map((function(t){return{prev:t,next:{maskMode:e}}})))),this.emit(t.MASK_NODE,r.slice(0))}},t.prototype.breakMask=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){n.push({breakMask:t.computedStyle.breakMask}),t.updateStyle({breakMask:e})})),this.history.addCommand(new HC(r.slice(0),n.map((function(t){return{prev:t,next:{breakMask:e}}})))),this.emit(t.BREAK_MASK_NODE,r.slice(0))}},t.prototype.lock=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t,r){n.push(!!t.props.isLocked),t.props.isLocked=e})),this.history.addCommand(new WC(r.slice(0),n.map((function(t){return{prev:t,next:e}})))),this.emit(t.LOCK_NODE,r.slice(0))}},t.prototype.visible=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){n.push(t.computedStyle.visibility===nl.VISIBLE?"visible":"hidden"),t.updateStyle({visibility:e})})),this.history.addCommand(new qC(r.slice(0),n.map((function(t){return{prev:{visibility:t},next:{visibility:e}}})))),this.updateActive(),this.emit(t.VISIBLE_NODE,r.slice(0))}},t.prototype.rename=function(e,r){void 0===e&&(e=this.selected),this.history.addCommand(new YC(e.slice(0),e.map((function(e,t){var n=e.props.name||"",i=r[t];return e.props.name=i,e.props.nameIsFixed=!0,{prev:n,next:i}})))),this.emit(t.RENAME_NODE,e.slice(0))},t.prototype.remove=function(e){if(void 0===e&&(e=this.selected),e.length){var r=e.slice(0),n=e.splice(0).map((function(e){for(var t=e;t&&t.parent&&t.parent.isGroup&&t.parent instanceof VE&&1===t.parent.children.length;)t=t.parent;return t})),i=[];n.forEach((function(e,t){var n=RC.operate(e);e!==r[t]?i.push(Z(Z({},n),{selected:r[t]})):i.push(n)})),this.select.hideSelect(),this.history.addCommand(new RC(n,i)),this.emit(t.REMOVE_NODE,n.slice(0))}},t.prototype.clone=function(e){void 0===e&&(e=this.selected),e.length&&(this.clones=e.map((function(e){return{parent:e.parent,node:e.clone()}})))},t.prototype.paste=function(e){if(void 0===e&&(e=this.clones),e.length){var r=[],n=[];e.forEach((function(e){var t={x:e.node.computedStyle.left,y:e.node.computedStyle.top,parent:e.parent};JS(e.node,t,!0),r.push(e.node),n.push(t)})),r.length&&(this.history.addCommand(new ZC(r,n)),this.selected=r.slice(0),this.updateActive(),this.emit(t.ADD_NODE,r.slice(0)))}},t.prototype.hover=function(e,r){var n=this.getNode(e,r);n||(n=WS(this.root,e,r)),n?-1===this.selected.indexOf(n)&&this.select.hoverNode!==n?(this.select.showHover(n),this.emit(t.HOVER_NODE,n)):this.selected.indexOf(n)>-1&&this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)):this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE))},t.prototype.onKeyDown=function(e){var r,n,i,o,a,s,l,c,u=this,h=this.metaKey,d=this.ctrlKey;if(this.metaKey=e.metaKey,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.root.getCurPage()){var f=this.metaKey||nT&&this.ctrlKey;if(!f||1!==this.selected.length||this.selected[0].isSlice||this.selected[0]instanceof QE||this.select.metaKey(!0),(h!==this.metaKey||nT&&d!==this.ctrlKey)&&!this.isMouseDown){var p=this.root.dpi,v=this.startX*p,m=this.startY*p;this.hover(v,m)}var g=e.keyCode,y=e.code,b=e.target,x=["INPUT","TEXTAREA"].includes(b.tagName.toUpperCase());if(8===g||46===g||"Backspace"===y||"Delete"===y)this.state===fC.EDIT_GEOM?this.geometry.hasEditPoint()?this.geometry.delVertex():this.cancelEditGeom():this.state===fC.EDIT_GRADIENT?this.cancelEditGradient():x||(null===(s=this.options.disabled)||void 0===s?void 0:s.remove)||this.remove();else if(32===g||"Space"===y)this.spaceKey=!0,(null===(l=this.options.disabled)||void 0===l?void 0:l.drag)||this.isFrame||this.state===fC.EDIT_GEOM&&this.geometry.hasEditPoint()||this.dom.classList.add("hand");else if(27!==g&&"Escape"!==y||!this.altKey)if(27===g||"Escape"===y)if(CC.hide(),yC.isShow())yC.hide(),this.state===fC.EDIT_GRADIENT?(this.select.showSelectNotUpdate(),this.state=fC.NORMAL,this.emit(t.STATE_CHANGE,fC.EDIT_GRADIENT,this.state)):this.state===fC.EDIT_GEOM?(this.select.showSelect(this.selected),this.state=fC.NORMAL,this.emit(t.STATE_CHANGE,fC.EDIT_GEOM,this.state)):this.state===fC.EDIT_TEXT&&this.input.focus();else if(this.state===fC.EDIT_TEXT)this.cancelEditText();else if(this.state===fC.ADD_TEXT)this.dom.classList.remove("text"),this.state=fC.NORMAL,this.emit(t.STATE_CHANGE,fC.ADD_TEXT,this.state);else if(this.state===fC.EDIT_GEOM)this.geometry.hasEditPoint()?(this.geometry.clearCur(),this.emit(t.SELECT_POINT,[],[])):this.cancelEditGeom();else{var w=this.selected.filter((function(e){return e instanceof tE||e instanceof LS}));if(w.length){var E=w.map((function(e){var t=e.parent;if(t instanceof LS)return t})).filter((function(e){return e}));if(E.length){var _=[];return E.forEach((function(e){for(var t=_.length-1;t>=0;t--){var r=_[t];if(e.isParent(r))return void _.splice(t,1,e);if(e.isChild(r))return}_.push(e)})),this.selected.splice(0),(r=this.selected).push.apply(r,_),this.select.showSelect(this.selected),void this.emit(t.SELECT_NODE,this.selected.slice(0))}}this.selected.splice(0),this.select.hideSelect(),this.select.hideHover(),this.emit(t.SELECT_NODE,this.selected.slice(0))}else if(g>=37&&g<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(y)){var S=e.target;if(S&&!["INPUT","SELECT","TEXTAREA"].includes(S.tagName.toUpperCase())){e.preventDefault();var C=0,T=0;if(37===g?C=this.shiftKey?-10:this.altKey?-.1:-1:38===g?T=this.shiftKey?-10:this.altKey?-.1:-1:39===g?C=this.shiftKey?10:this.altKey?.1:1:40===g&&(T=this.shiftKey?10:this.altKey?.1:1),this.state===fC.EDIT_GEOM){var A=this.geometry,k=[],M=[],O=[];A.nodes.forEach((function(e,t){var r=A.idxes[t];if(r.length){k.push(e);var n=Ps(e.props.points),i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){e.dspX+=C,e.dspY+=T,e.dspFx+=C,e.dspFy+=T,e.dspTx+=C,e.dspTy+=T})),tC(e,i),e.reflectPoints(i),e.refresh(),A.updateVertex(e),M.push({prev:n,next:Ps(e.props.points)}),O.push(i)}})),k.length&&(this.emit(t.POINT_NODE,k,O),this.history.addCommand(new eT(k,M)))}else{var L=this.selected.slice(0),R=[],I=[];L.forEach((function(e){var t=e.getStyle();e.artBoard!==TC.update(e,e.computedStyle,C,T)&&I.push(e),e.endPosChange(t,C,T),R.push({dx:C,dy:T}),e.checkPosSizeUpward()})),I.length&&this.emit(t.ART_BOARD_NODE,I),L.length&&(this.select.updateSelect(L),this.emit(t.MOVE_NODE,L.slice(0)),this.history.addCommand(new TC(L,R)))}}}else if(65!==g&&"KeyA"!==y||!f)if(67!==g&&"KeyC"!==y&&88!==g&&"KeyX"!==y||!f)if(86!==g&&"KeyV"!==y||!f)if(187!==g&&"Equal"!==y||!f)if(189!==g&&"Minus"!==y||!f){if((90===g||"KeyZ"===y)&&f){var P;if(e.target&&x&&e.preventDefault(),P=this.shiftKey?this.history.redo():this.history.undo()){L=P.nodes.slice(0);if(!(P instanceof RC||P instanceof GC||P instanceof eT)){var F=this.selected.slice(0);if(this.selected.splice(0),(n=this.selected).push.apply(n,L),P instanceof UC||this.state===fC.EDIT_GRADIENT||this.updateActive(),!(P instanceof ZC))if(L.length!==F.length)this.emit(t.SELECT_NODE,L);else for(var D=0,N=L.length;D<N;D++)if(L[D]!==F[D]){this.emit(t.SELECT_NODE,L);break}}if(P instanceof TC)this.emit(t.MOVE_NODE,L);else if(P instanceof kC)this.emit(t.RESIZE_NODE,L);else if(P instanceof RC)this.shiftKey?(this.selected.splice(0),this.select.hideSelect(),this.emit(t.REMOVE_NODE,L)):(this.selected=L.map((function(e,t){return P.data[t].selected||e})),this.updateActive(),this.emit(t.ADD_NODE,L,this.selected.slice(0)));else if(P instanceof ZC)this.shiftKey?(this.selected=L.slice(0),this.updateActive(),this.emit(t.ADD_NODE,L)):(this.selected.splice(0),this.select.hideSelect(),this.emit(t.REMOVE_NODE,L),this.state===fC.EDIT_TEXT&&(this.state=fC.NORMAL,this.input.hide(),this.emit(t.STATE_CHANGE,fC.ADD_TEXT,this.state)));else if(P instanceof IC)this.emit(t.ROTATE_NODE,L);else if(P instanceof PC)this.emit(t.OPACITY_NODE,L);else if(P instanceof DC)this.emit(t.SHADOW_NODE,L);else if(P instanceof NC)this.emit(t.BLUR_NODE,L);else if(P instanceof BC)this.emit(t.COLOR_ADJUST_NODE,L);else if(P instanceof FC)this.emit(t.TEXT_VERTICAL_ALIGN_NODE,L);else if(P instanceof UC)this.emit(t.FILL_NODE,L,P.data);else if(P instanceof zC)this.emit(t.STROKE_NODE,L);else if(P instanceof GC)this.shiftKey?(this.selected.splice(0),this.selected.push(P.group),this.updateActive(),this.emit(t.GROUP_NODE,[P.group],[L])):(this.selected.splice(0),(i=this.selected).push.apply(i,L),this.updateActive(),this.emit(t.UN_GROUP_NODE,[L],[P.group]));else if(P instanceof jC)this.shiftKey?(this.selected.splice(0),L.forEach((function(e,t){var r;(r=u.selected).push.apply(r,P.data[t].children)})),this.updateActive(),this.emit(t.UN_GROUP_NODE,L.map((function(e,t){return P.data[t].children.slice(0)})),P.nodes.slice(0))):(this.selected.splice(0),(o=this.selected).push.apply(o,L),this.updateActive(),this.emit(t.GROUP_NODE,L,P.data.map((function(e){return e.children.slice(0)}))));else if(P instanceof XC){var B=["none","outline","alpha","gray","alpha-with","gray-with"][L[0].computedStyle.maskMode];this.emit(t.MASK_NODE,L,B)}else if(P instanceof HC){var U=L[0].computedStyle.breakMask;this.emit(t.BREAK_MASK_NODE,L,U)}else if(P instanceof OC){if(P.type===OC.TEXT_ALIGN?this.emit(t.TEXT_ALIGN_NODE,L):P.type===OC.COLOR?this.emit(t.COLOR_NODE,L):P.type===OC.FONT_FAMILY?this.emit(t.FONT_FAMILY_NODE,L):P.type===OC.FONT_SIZE?this.emit(t.FONT_SIZE_NODE,L):P.type===OC.LINE_HEIGHT?this.emit(t.LINE_HEIGHT_NODE,L):P.type===OC.PARAGRAPH_SPACING?this.emit(t.PARAGRAPH_SPACING_NODE,L):P.type===OC.LETTER_SPACING&&this.emit(t.LETTER_SPACING_NODE,L),this.state===fC.EDIT_TEXT){var z=(W=L[0]).getSortedCursor(),X=z.isMulti,H=z.start;if(X)this.input.hideCursor();else{var G=W.updateCursorByIndex(H);this.input.updateCursor(G),this.input.showCursor()}this.input.focus()}}else if(P instanceof vC){if(this.state===fC.EDIT_TEXT){var j=(W=L[0]).getSortedCursor();X=j.isMulti,H=j.start;if(X)this.input.hideCursor();else{G=W.updateCursorByIndex(H);this.input.updateCursor(G),this.input.showCursor()}this.input.focus()}}else P instanceof eT?(this.state===fC.EDIT_GEOM?this.geometry.show(L):(this.selected.splice(0),(a=this.selected).push.apply(a,L),this.updateActive()),this.emit(t.POINT_NODE,L)):P instanceof YC?this.emit(t.RENAME_NODE,L):P instanceof WC?this.emit(t.LOCK_NODE,L):P instanceof qC&&this.emit(t.VISIBLE_NODE,L)}}}else e.preventDefault(),this.zoom(.5);else e.preventDefault(),this.zoom(2);else!x&&this.clones.length&&this.paste();else x||(this.clone(),88!==g&&"KeyX"!==y||(null===(c=this.options.disabled)||void 0===c?void 0:c.remove)||this.remove());else{var Y=e.target;this.state===fC.EDIT_TEXT&&Y===this.input.inputEl?(e.preventDefault(),this.input.node.selectAll(),this.input.hideCursor()):Y&&!x&&(e.preventDefault(),this.selectAll())}else if(this.selected.length){var W;if((W=this.selected[0])instanceof B_||W instanceof H_||W instanceof Fw)return;W=W.parent,this.selected.splice(0),this.selected.push(W),this.select.updateSelect(this.selected),this.emit(t.SELECT_NODE,this.selected.slice(0))}}},t.prototype.onKeyUp=function(e){var t=this.metaKey,r=this.ctrlKey;if(this.metaKey=e.metaKey,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.metaKey||nT&&this.ctrlKey||this.isRotate||this.select.metaKey(!1),(t!==this.metaKey||nT&&r!==this.ctrlKey)&&!this.isMouseDown){var n=this.root.dpi,i=this.startX*n,o=this.startY*n;this.hover(i,o)}32===e.keyCode&&(this.spaceKey=!1,this.state!==fC.HAND&&(this.dom.classList.remove("hand"),this.dom.classList.remove("handing")))},t.prototype.updateSelected=function(){this.selected.length&&this.select.updateSelect(this.selected)},t.prototype.updateInput=function(){this.state===fC.EDIT_TEXT&&this.input.updateCursor()},t.prototype.updateGradient=function(){this.state===fC.EDIT_GRADIENT&&this.gradient.updatePos()},t.prototype.updateGeom=function(){this.state===fC.EDIT_GEOM&&this.geometry.updateAll()},t.prototype.cancelEditText=function(e){if(this.state===fC.EDIT_TEXT){var r=e||this.selected[0];r&&(r.resetCursor(),r.afterEdit(),r.inputStyle=void 0),this.input.hide(),this.state=fC.NORMAL,this.select.select.classList.remove("text"),this.emit(t.STATE_CHANGE,fC.EDIT_TEXT,this.state)}},t.prototype.cancelEditGradient=function(){this.state===fC.EDIT_GRADIENT&&(this.select.showSelectNotUpdate(),this.state=fC.NORMAL,this.emit(t.STATE_CHANGE,fC.EDIT_GRADIENT,this.state))},t.prototype.cancelEditGeom=function(){this.state===fC.EDIT_GEOM&&(this.geometry.hide(),this.select.showSelect(this.selected),this.state=fC.NORMAL,this.emit(t.STATE_CHANGE,fC.EDIT_GEOM,this.state))},t.prototype.onContextMenu=function(e){e.preventDefault()},t.prototype.destroy=function(){this.dom.removeEventListener("mousedown",this.onMouseDown),this.dom.removeEventListener("mousemove",this.onMouseMove),this.dom.removeEventListener("mouseup",this.onMouseUp),this.dom.removeEventListener("mouseleave",this.onMouseLeave),this.dom.removeEventListener("click",this.onClick),this.dom.removeEventListener("dblclick",this.onDblClick),this.dom.removeEventListener("wheel",this.onWheel),this.dom.removeEventListener("contextmenu",this.onContextMenu),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.selected.splice(0),this.abcStyle.splice(0),this.computedStyle.splice(0),this.originStyle.splice(0),this.cssStyle.splice(0),this.select.destroy()},t.HOVER_NODE="HOVER_NODE",t.UN_HOVER_NODE="UN_HOVER_NODE",t.SELECT_NODE="SELECT_NODE",t.RESIZE_NODE="RESIZE_NODE",t.MOVE_NODE="MOVE_NODE",t.ROTATE_NODE="ROTATE_NODE",t.OPACITY_NODE="OPACITY_NODE",t.FLIP_H_NODE="FLIP_H_NODE",t.FLIP_V_NODE="FLIP_V_NODE",t.FILL_NODE="FILL_NODE",t.STROKE_NODE="STROKE_NODE",t.FONT_FAMILY_NODE="FONT_FAMILY_NODE",t.FONT_SIZE_NODE="FONT_SIZE_NODE",t.LINE_HEIGHT_NODE="LINE_HEIGHT_NODE",t.LETTER_SPACING_NODE="LETTER_SPACING_NODE",t.PARAGRAPH_SPACING_NODE="PARAGRAPH_SPACING_NODE",t.COLOR_NODE="COLOR_NODE",t.TEXT_ALIGN_NODE="TEXT_ALIGN_NODE",t.TEXT_VERTICAL_ALIGN_NODE="TEXT_VERTICAL_ALIGN_NODE",t.TEXT_CONTENT_NODE="TEXT_CONTENT_NODE",t.CURSOR_NODE="CURSOR_NODE",t.SHADOW_NODE="SHADOW_NODE",t.BLUR_NODE="BLUR_NODE",t.COLOR_ADJUST_NODE="COLOR_ADJUST_NODE",t.REMOVE_NODE="REMOVE_NODE",t.ADD_NODE="ADD_NODE",t.GROUP_NODE="GROUP_NODE",t.UN_GROUP_NODE="UN_GROUP_NODE",t.MASK_NODE="MASK_NODE",t.BREAK_MASK_NODE="BREAK_MASK_NODE",t.RENAME_NODE="RENAME_NODE",t.LOCK_NODE="LOCK_NODE",t.VISIBLE_NODE="VISIBLE_NODE",t.ART_BOARD_NODE="ART_BOARD_NODE",t.CONSTRAIN_PROPORTION_NODE="CONSTRAIN_PROPORTION_NODE",t.POINT_NODE="POINT_NODE",t.SELECT_POINT="SELECT_POINT",t.ZOOM_PAGE="ZOOM_PAGE",t.CONTEXT_MENU="CONTEXT_MENU",t.STATE_CHANGE="STATE_CHANGE",t}(_w);function oT(e,t,r){void 0===r&&(r=!1);var n=function(e){var t="default";e instanceof I_?t="symbol-instance":e instanceof L_?t="symbol-master":e instanceof Fw?t="art-board":e instanceof VE?t="group":e instanceof Uw?t="bitmap":e instanceof r_?t="text":e instanceof jw?t="geom":e instanceof LS?t="shape-group":e instanceof QE&&(t="slice");return t}(e),i=document.createElement("dl"),o=["layer"];e instanceof I_&&o.push("symbol-instance"),e instanceof L_&&o.push("symbol-master"),e.props.isExpanded&&o.push("expand");var a="";e instanceof Pw&&(o.push("container"),a+='<span class="arrow"></span>'),e.mask&&(a+='<span class="mask"></span>'),i.className=o.join(" "),i.setAttribute("uuid",e.props.uuid),i.setAttribute("lv",t.toString());var s=document.createElement("dt");(t>3&&(s.style.paddingLeft=(t-3)*bs.treeLvPadding+"px"),e instanceof jw||e instanceof LS)?a+='<span class="type geom">'+e.toSvg(12)+"</span>":a+='<span class="type '.concat(n,'"></span>');if(a+='<span class="name" title="'.concat(e.props.name||"",'">').concat(e.props.name||"","</span>"),e instanceof Fw||(e.props.isLocked&&(a+='<span class="lock"></span>'),a+='<span class="visible '.concat(e.computedStyle.visibility===nl.VISIBLE?"t":"",'"></span>')),s.innerHTML=a,i.appendChild(s),r)return i;if(e instanceof Pw){var l=e.children;if(l.length)for(var c=l.length-1;c>=0;c--){var u=document.createElement("dd");u.appendChild(oT(l[c],t+1)),i.appendChild(u)}}return i}var aT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.silence=!1,e.getCurPage()&&this.init(),r.on(iT.HOVER_NODE,(function(e){n.hover(e)})),r.on(iT.UN_HOVER_NODE,(function(){n.unHover()})),r.on(iT.SELECT_NODE,(function(e){n.select(e)})),r.on(iT.REMOVE_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));n&&n.parentElement.remove()}}))})),r.on(iT.ADD_NODE,(function(e,r){e.forEach((function(e){var r,n=oT(e,e.struct.lv),i=document.createElement("dd");i.appendChild(n);var o=null===(r=e.prev)||void 0===r?void 0:r.props.uuid;if(o){if(a=t.querySelector('dl[uuid="'.concat(o,'"]')))a.parentElement.before(i)}else{var a,s=e.parent.props.uuid;(a=t.querySelector('dl[uuid="'.concat(s,'"]')))&&a.appendChild(i)}})),n.select(r||e)})),r.on(iT.GROUP_NODE,(function(e,r){e.forEach((function(e,n){var i,o=oT(e,e.struct.lv,!0),a=document.createElement("dd");a.appendChild(o),r[n].reverse().forEach((function(e){var r=e.props.uuid,n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*bs.treeLvPadding+"px",n.querySelectorAll("dl").forEach((function(e){var t=e.firstChild,r=e.getAttribute("lv");e.setAttribute("lv",(+r+1).toString()),t.style.paddingLeft=(+r+1-3)*bs.treeLvPadding+"px"})),o.appendChild(n.parentElement)}}));var s=null===(i=e.prev)||void 0===i?void 0:i.props.uuid;if(s){if(l=t.querySelector('dl[uuid="'.concat(s,'"]')))l.parentElement.before(a)}else{var l,c=e.parent.props.uuid;(l=t.querySelector('dl[uuid="'.concat(c,'"]')))&&l.appendChild(a)}})),n.select(e)})),r.on(iT.UN_GROUP_NODE,(function(e,r){e.forEach((function(e,n){var i=r[n].props.uuid;if(i){var o=t.querySelector('dl[uuid="'.concat(i,'"]'));if(o){var a=o.parentElement,s=document.createDocumentFragment();e.reverse().forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*bs.treeLvPadding+"px",n.querySelectorAll("dl").forEach((function(e){var t=e.firstChild,r=e.getAttribute("lv");e.setAttribute("lv",(+r-1).toString()),t.style.paddingLeft=(+r-1-3)*bs.treeLvPadding+"px"})),s.appendChild(n.parentElement)}}})),a.before(s),a.remove()}}}));var i=[];e.forEach((function(e){i.push.apply(i,e)})),n.select(i)})),r.on(iT.MASK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n)for(var i=n.parentElement,o=e.next;o&&!o.computedStyle.breakMask&&!o.computedStyle.maskMode;){var a=(i=i.previousElementSibling).firstElementChild.firstElementChild,s=a.querySelector(".mask");if(e.computedStyle.maskMode===Qs.NONE)s&&s.remove();else if(!s){var l=document.createElement("span");l.classList.add("mask"),a.prepend(l)}o=o.next}}}))})),r.on(iT.BREAK_MASK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.firstElementChild,o=i.querySelector(".mask");if(e.computedStyle.breakMask)o&&o.remove();else if(e.mask){if(!o)(l=document.createElement("span")).classList.add("mask"),i.prepend(l)}for(var a=n.parentElement,s=e.next;s&&!s.computedStyle.breakMask&&!s.computedStyle.maskMode;){var l,c=(a=a.previousElementSibling).firstElementChild.firstElementChild,u=c.querySelector(".mask");e.computedStyle.breakMask?u&&u.remove():u||((l=document.createElement("span")).classList.add("mask"),c.prepend(l)),s=s.next}}}}))})),r.on(iT.RENAME_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"] .name'));n&&(n.title=n.innerText=e.props.name||"")}}))})),r.on(iT.LOCK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.firstElementChild,o=i.querySelector(".lock");if(e.props.isLocked){if(!o){var a=document.createElement("span");a.classList.add("lock"),i.querySelector(".name").after(a)}}else o&&o.remove()}}}))})),r.on(iT.VISIBLE_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.querySelector(".visible").classList;e.computedStyle.visibility===nl.VISIBLE?i.add("t"):i.remove("t")}}}))})),r.on(iT.ART_BOARD_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*bs.treeLvPadding+"px";var o=n.parentElement;o.remove();var a=e.prev,s=e.next;if(a){if(l=a.props.uuid)(c=t.querySelector('dl[uuid="'.concat(l,'"]')))&&c.parentElement.before(o)}else if(s){if(l=s.props.uuid)(c=t.querySelector('dl[uuid="'.concat(l,'"]')))&&c.parentElement.after(o)}else{var l,c;if(l=e.parent.props.uuid)(c=t.querySelector('dl[uuid="'.concat(l,'"]')))&&c.parentElement.appendChild(o)}}}}))})),r.on(iT.TEXT_CONTENT_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"] dt .name'));if(n){var i=e.props.nameIsFixed,o=e.content;i||(n.innerText=o,n.title=o)}}}))})),t.addEventListener("selectstart",(function(e){e.preventDefault()}));var i=function(n,i){void 0===i&&(i=!1);var o=n.querySelector("dt"),a=t.querySelectorAll("dt.active");if(1!==a.length||a[0]!==o){var s=n.getAttribute("uuid");if(s){var l=e.refs[s];if(l)if(i)-1===(u=(c=r.selected.slice(0)).indexOf(l))&&(c.splice(0),c.push(l)),r.active(c);else if(r.metaKey){var c,u;if((u=(c=r.selected.slice(0)).indexOf(l))>-1)c.splice(u,1);else{for(var h=c.length-1;h>=0;h--){var d=c[h];if(l.isParent(d))c.splice(h,1);else if(l.isChild(d))return}c.push(l)}r.active(c)}else r.active([l])}a.forEach((function(e){e.classList.remove("active")})),r.selected.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"] dt'));n&&n.classList.add("active")}}))}};t.addEventListener("click",(function(t){n.silence=!0;var o=t.target,a=o.classList,s="DT"===o.tagName.toUpperCase();if(a.contains("arrow"))(l=(u=o.parentElement.parentElement).getAttribute("uuid"))&&(c=e.refs[l])&&((c.props.isExpanded=!c.props.isExpanded)?u.classList.add("expand"):u.classList.remove("expand"));else if(a.contains("visible")){if(l=(u=o.parentElement.parentElement).getAttribute("uuid"))(c=e.refs[l])&&r.visible(a.contains("t")?"hidden":"visible",[c])}else if(a.contains("lock")){var l;if(l=(u=o.parentElement.parentElement).getAttribute("uuid")){var c=e.refs[l];r.lock(!1,[c])}o.remove()}else if(a.contains("name")||a.contains("type")||s){var u=s?o.parentElement:o.parentElement.parentElement;i(u)}else r.active([]);n.silence=!1}));var o=function(t){var n=t.value,i=t.parentElement.parentElement.getAttribute("uuid"),o=e.refs[i],a=t.nextSibling;t.remove(),a.style.display="block",o&&r.rename([o],[n])};t.addEventListener("dblclick",(function(e){var t=e.target;if(t.classList.contains("name")){t.style.display="none";var r=document.createElement("input");r.type="text",r.value=t.innerText,t.parentElement.insertBefore(r,t),r.focus();var n=!1;r.onblur=function(){n||(n=!0,o(r))},r.onkeydown=function(e){var t=e.keyCode,i=e.code;27===t||"Escape"===i?(e.stopPropagation(),n||(n=!0,o(r))):13!==t&&"Enter"!==i||n||(n=!0,o(r))},r.onchange=function(){n||(n=!0,o(r))}}})),t.addEventListener("mousemove",(function(t){var n=t.target;"SPAN"===n.nodeName&&(n=n.parentElement);var i=n.parentElement.getAttribute("uuid");if(i){var o=e.refs[i];if(o)return void r.select.showHover(o)}r.select.hideHover()})),t.addEventListener("mouseleave",(function(){r.select.hideHover()})),t.addEventListener("contextmenu",(function(e){var t;if(!(null===(t=r.options.disabled)||void 0===t?void 0:t.contextMenu)){e.preventDefault(),n.silence=!0;var o=e.target,a=o.classList,s="DT"===o.tagName.toUpperCase();if(a.contains("name")||a.contains("type")||s){var l=s?o.parentElement:o.parentElement.parentElement;i(l,!0)}n.silence=!1,CC.showTree(e.pageX,e.pageY,n.listener)}}))}return e.prototype.init=function(){this.dom.innerHTML="";var e=document.createElement("dl");this.dom.appendChild(e);var t=this.root.getCurPage();if(t){e.setAttribute("uuid",t.props.uuid);var r=t.children;if(!r.length)return;for(var n=new DocumentFragment,i=r.length-1;i>=0;i--){var o=r[i],a=oT(o,o.struct.lv),s=document.createElement("dd");s.appendChild(a),n.appendChild(s)}e.appendChild(n)}},e.prototype.hover=function(e){var t=this.dom.querySelector("dt.hover"),r=e.props.uuid;if(r){var n=this.dom.querySelector('dl[uuid="'.concat(r,'"] dt'));n&&(n.classList.add("hover"),n!==t&&t&&t.classList.remove("hover"))}},e.prototype.unHover=function(){var e=this.dom.querySelector("dt.hover");e&&e.classList.remove("hover")},e.prototype.select=function(e){var t=this;this.dom.querySelectorAll("dt.active").forEach((function(e){e.classList.remove("active")})),e.forEach((function(e){var r=t.dom.querySelector('dl[uuid="'.concat(e.props.uuid,'"] dt'));if(r){for(var n=r.parentElement;n;){if("DL"===n.nodeName){n.classList.add("expand");var i=n.getAttribute("uuid");if(i){var o=t.root.refs[i];o&&(o.props.isExpanded=!0)}}if(n===t.dom)break;n=n.parentElement}r.classList.add("active"),t.silence||(r.scrollIntoViewIfNeeded?r.scrollIntoViewIfNeeded():r.scrollIntoView())}}))},e}(),sT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.nodes=[],this.silence=!1,r.on([iT.SELECT_NODE,iT.ADD_NODE,iT.GROUP_NODE],(function(e){n.silence||n.show(e)})),r.on([iT.UN_GROUP_NODE],(function(e){var t=[];e.forEach((function(e){t.push.apply(t,e)})),n.show(t)})),r.on(iT.REMOVE_NODE,(function(){n.silence||n.show([])}))}return e.prototype.show=function(e){this.nodes=e},e}(),lT=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.constrainProportions=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.constrainProportions=t[r].prev}))},t}(pC),cT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.data=[];var o=i.panel=document.createElement("div");o.className="basic-panel",o.innerHTML='\n  <div class="line">\n    <div class="input-unit">\n      <input type="number" class="x" step="1"/>\n      <span class="unit">X</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="y" step="1"/>\n      <span class="unit">Y</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="r" step="1"/>\n      <span class="unit">°</span>\n    </div>\n  </div>\n  <div class="line">\n    <div class="input-unit">\n      <input type="number" class="w" step="1"/>\n      <span class="unit">W</span>\n    </div>\n    <div class="cp"></div>\n    <div class="input-unit">\n      <input type="number" class="h" step="1"/>\n      <span class="unit">H</span>\n    </div>\n    <span class="fh" title="水平翻转"></span>\n    <span class="fv" title="垂直翻转"></span>\n  </div>\n',r.appendChild(o);var a=o.querySelector(".x"),s=o.querySelector(".y"),l=o.querySelector(".r"),c=o.querySelector(".w"),u=o.querySelector(".h"),h=o.querySelector(".cp"),d=o.querySelector(".fh"),f=o.querySelector(".fv"),p=[],v=[],m=[],g=[],y=[],b=[],x=function(e,t){void 0===t&&(t=!0),i.silence=!0;var r=!p.length;r&&(v=[],m=[],y=[]),b=[];var o=parseFloat(t?a.value:s.value)||0,l=e instanceof InputEvent;i.nodes.forEach((function(e,c){r&&(p.push(e),v.push(e.getStyle()),m.push(e.getComputedStyle()),y.push(t?i.data[c].x:i.data[c].y));var u=y[c],h=o,d=0;l?d=h-u:(d=(t?a.placeholder:s.placeholder)?h:h-u,n.shiftKey?d=d>0?10:-10:n.altKey&&(d=d>0?.1:-.1),h=u+d),b.push(h),e.artBoard!==(t?TC.update(e,m[c],d,0):TC.update(e,m[c],0,d))&&n.emit(iT.ART_BOARD_NODE,[e])})),p.length&&(n.select.updateSelect(i.nodes),n.emit(iT.MOVE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1},w=function(e){if(void 0===e&&(e=!0),p.length){var t=[];p.forEach((function(r,n){var i=b[n]-y[n];e?(r.endPosChange(v[n],i,0),t.push({dx:i,dy:0})):(r.endPosChange(v[n],0,i),t.push({dx:0,dy:i})),r.checkPosSizeUpward()})),n.history.addCommand(new TC(p,t)),p=[],v=[],m=[],y=[],b=[]}};a.addEventListener("input",(function(e){x(e,!0)})),a.addEventListener("change",(function(e){w(!0)})),s.addEventListener("input",(function(e){x(e,!1)})),s.addEventListener("change",(function(e){w(!1)})),l.addEventListener("input",(function(e){i.silence=!0;var t=!p.length;t&&(m=[],y=[]),b=[];var r=e instanceof InputEvent;i.nodes.forEach((function(e,o){t&&(p.push(e),m.push(e.getComputedStyle()),y.push(i.data[o].rotation));var a=y[o],s=parseFloat(l.value)||0,c=0;r?c=s-a:(c=l.placeholder?s:s-a,n.shiftKey?c=c>0?10:-10:n.altKey&&(c=c>0?.1:-.1),s=a+c),b.push(s),e.updateStyle({rotateZ:m[o].rotateZ+c})})),p.length&&(n.select.updateSelect(i.nodes),n.emit(iT.ROTATE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1})),l.addEventListener("change",(function(e){p.length&&(n.history.addCommand(new IC(p,y.map((function(e,t){return{prev:{rotateZ:e},next:{rotateZ:b[t]}}})))),p=[],m=[],y=[],b=[])}));var E=function(e,t){void 0===t&&(t=!0),i.silence=!0,n.beforeResize();var r=!1;if(!r)for(var o=0,a=n.selected.length;o<a;o++)if(n.selected[o].props.constrainProportions){r=!0;break}var s=!p.length;s&&(v=[],m=[],g=[],y=[]),b=[];var l=parseFloat(t?c.value:u.value)||0,h=e instanceof InputEvent;i.nodes.forEach((function(e,o){if(s){p.push(e),v.push(e.getStyle()),e.startSizeChange(),m.push(e.getComputedStyle()),g.push(e.getCssStyle()),y.push(t?i.data[o].w:i.data[o].h);var a=e.parent;a&&a.isGroup&&a instanceof VE&&(a.fixedPosAndSize=!0)}var d=y[o],f=l,x=0;h?x=f-d:(x=(t?c.placeholder:u.placeholder)?f:f-d,n.shiftKey?x=x>0?10:-10:n.altKey&&(x=x>0?.1:-.1),f=d+x),b.push(f),kC.updateStyle(e,m[o],g[o],t?x:0,t?0:x,t?SC.R:SC.B,r)})),p.length&&(n.select.updateSelect(i.nodes),n.emit(iT.RESIZE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1},_=function(e){if(void 0===e&&(e=!0),p.length){var t=n.shiftKey;if(!t)for(var r=0,i=n.selected.length;r<i;r++)if(n.selected[r].props.constrainProportions){t=!0;break}var o=[];p.forEach((function(r,n){var i=r.parent;i&&i.isGroup&&i instanceof VE&&(i.fixedPosAndSize=!1),r.endSizeChange(v[n]),r.checkPosSizeUpward();var a=b[n]-y[n],s={dx:e?a:0,dy:e?0:a,controlType:e?SC.R:SC.B,aspectRatio:t,fromCenter:!1};v[n].width.u===Xs.AUTO&&(s.widthFromAuto=!0),v[n].height.u===Xs.AUTO&&(s.heightFromAuto=!0),m[n].scaleX!==r.computedStyle.scaleX&&(s.flipX=!0),m[n].scaleY!==r.computedStyle.scaleY&&(s.flipY=!0),o.push(s)})),p.length&&o.length&&n.history.addCommand(new kC(p,o)),p=[],v=[],m=[],y=[],b=[]}};return c.addEventListener("input",(function(e){E(e,!0)})),c.addEventListener("change",(function(e){_(!0)})),u.addEventListener("input",(function(e){E(e,!1)})),u.addEventListener("change",(function(e){_(!1)})),h.addEventListener("click",(function(e){i.silence=!0,h.classList.contains("active")?h.classList.remove("active"):h.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e){var n=!!e.props.constrainProportions,i=h.classList.contains("active");n!==i&&(e.props.constrainProportions=i,t.push(e),r.push({prev:n,next:i}))})),t.length&&(n.history.addCommand(new lT(t,r)),n.emit(iT.CONSTRAIN_PROPORTION_NODE,t.slice(0))),i.silence=!1})),d.addEventListener("click",(function(e){i.silence=!0,d.classList.contains("active")?d.classList.remove("active"):d.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e,n){var i=e.computedStyle.scaleX,o=d.classList.contains("active")?-1:1;i!==o&&(e.updateStyle({scaleX:o}),t.push(e),r.push({prev:{scaleX:i},next:{scaleX:o}}))})),t.length&&(n.history.addCommand(new AC(t,r)),n.select.updateSelect(i.nodes),n.emit(iT.FLIP_H_NODE,t.slice(0))),i.silence=!1})),f.addEventListener("click",(function(e){i.silence=!0,f.classList.contains("active")?f.classList.remove("active"):f.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e,n){var i=e.computedStyle.scaleY,o=f.classList.contains("active")?-1:1;i!==o&&(e.updateStyle({scaleY:o}),t.push(e),r.push({prev:{scaleX:i},next:{scaleX:o}}))})),t.length&&(n.history.addCommand(new AC(t,r)),n.select.updateSelect(i.nodes),n.emit(iT.FLIP_V_NODE,t.slice(0))),i.silence=!1})),n.on([iT.MOVE_NODE,iT.RESIZE_NODE,iT.ROTATE_NODE,iT.FLIP_H_NODE,iT.FLIP_V_NODE,iT.CONSTRAIN_PROPORTION_NODE],(function(e){i.silence||i.show(e)})),n.on(iT.STATE_CHANGE,(function(e,t){t!==fC.EDIT_GEOM&&t!==fC.NORMAL||i.show(n.selected)})),i}return v(t,e),t.prototype.show=function(t){var r=this;e.prototype.show.call(this,t),this.data=[];var n=this.panel;if(this.listener.state!==fC.EDIT_GEOM){if(n.style.display="block",!t.length)return n.querySelectorAll(".input-unit,.cp,.fh,.fv").forEach((function(e){e.classList.add("disabled"),e.classList.remove("active")})),void n.querySelectorAll("input").forEach((function(e){e.disabled=!0,e.placeholder="",e.value=""}));n.querySelectorAll(".input-unit,.cp,.fh,.fv").forEach((function(e){e.classList.remove("disabled")})),n.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder="",e.value=""}));var i=[],o=[],a=[],s=[],l=[],c=[],u=[],h=[];t.forEach((function(e){var t=AS(e),n=t.x,d=t.y,f=t.rotation,p=t.w,v=t.h,m=t.isFlippedHorizontal,g=t.isFlippedVertical,y=t.constrainProportions;r.data.push(t),i.includes(n)||i.push(n),o.includes(d)||o.push(d),a.includes(f)||a.push(f),s.includes(p)||s.push(p),l.includes(v)||l.push(v),c.includes(y)||c.push(y),u.includes(m)||u.push(m),h.includes(g)||h.push(g)}));var d=n.querySelector(".x"),f=n.querySelector(".y"),p=n.querySelector(".r"),v=n.querySelector(".w"),m=n.querySelector(".h"),g=n.querySelector(".cp"),y=n.querySelector(".fh"),b=n.querySelector(".fv");i.length>1?d.placeholder="多个":d.value=Lu(i[0]).toString(),o.length>1?f.placeholder="多个":f.value=Lu(o[0]).toString(),p.disabled=t.filter((function(e){return e.isSlice&&e instanceof QE})).length>0,a.length>1?p.placeholder="多个":p.value=Lu(a[0]).toString(),s.length>1?v.placeholder="多个":v.value=Lu(s[0]).toString(),l.length>1?m.placeholder="多个":m.value=Lu(l[0]).toString(),c.length>1||c[0]?g.classList.add("active"):g.classList.remove("active"),u.includes(!0)?y.classList.add("active"):y.classList.remove("active"),h.includes(!0)?b.classList.add("active"):b.classList.remove("active")}else n.style.display="none"},t}(sT),uT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="opacity-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">不透明度</h4>\n  <div class="line">\n    <input type="range" min="0" max="100" step="1"/>\n    <div class="input-unit">\n      <input type="number" min="0" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n',r.appendChild(o);var a=o.querySelector("input[type=range]"),s=o.querySelector("input[type=number]"),l=[],c=[],u=[];return a.addEventListener("input",(function(e){var t=!l.length;t&&(c=[]),u=[],i.nodes.forEach((function(e){var r=e.computedStyle.opacity,n=.01*parseFloat(a.value);r!==n&&(e.updateStyle({opacity:n}),t&&(l.push(e),c.push(r)),u.push(n))})),a.style.setProperty("--p",a.value),s.value=a.value,s.placeholder=""})),a.addEventListener("change",(function(e){l.length&&(n.history.addCommand(new PC(l,c.map((function(e,t){return{prev:{opacity:e},next:{opacity:u[t]}}})))),n.emit(iT.OPACITY_NODE,l.slice(0)),l=[],c=[],u=[])})),s.addEventListener("input",(function(e){i.silence=!0;var t=!l.length;t&&(c=[]),u=[];var r=e instanceof InputEvent,o=Math.min(100,Math.max(0,parseFloat(s.value)||0));i.nodes.forEach((function(e,i){var a=100*e.computedStyle.opacity,h=o,d=0;r?(d=h-a,i||(s.placeholder="")):(0===h&&(h=-1),d=s.placeholder?h:h-a,n.shiftKey&&(d=d>0?10:-10),h=a+d,h=Math.max(h,0),h=Math.min(h,100),i||(s.value=s.placeholder?"":h.toString())),d&&a!==h&&(e.updateStyle({opacity:.01*h}),t&&(l.push(e),c.push(.01*a)),u.push(.01*h))})),a.value=s.value||"0",a.style.setProperty("--p",a.value),l.length&&n.emit(iT.OPACITY_NODE,l.slice(0)),i.silence=!1})),s.addEventListener("change",(function(e){l.length&&(n.history.addCommand(new PC(l,c.map((function(e,t){return{prev:{opacity:e},next:{opacity:u[t]}}})))),l=[],c=[],u=[])})),n.on([iT.OPACITY_NODE],(function(e){i.silence||i.show(e)})),n.on(iT.STATE_CHANGE,(function(e,t){t!==fC.EDIT_GEOM&&t!==fC.NORMAL||i.show(n.selected)})),i}return v(t,e),t.prototype.show=function(t){e.prototype.show.call(this,t);var r=this.panel;if(t.length&&this.listener.state!==fC.EDIT_GEOM){r.style.display="block",r.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder="",e.value=""}));var n=[];t.forEach((function(e){var t=e.computedStyle.opacity;n.includes(t)||n.push(t)}));var i=r.querySelector("input[type=range]"),o=r.querySelector("input[type=number]");if(n.length>1)i.value="0",i.style.setProperty("--p","0"),o.placeholder="多个";else{var a=Math.round(100*n[0]).toString();i.value=a,i.style.setProperty("--p",a),o.value=a}}else r.style.display="none"},t}(sT),hT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.nodes=[];var o=i.panel=document.createElement("div");o.className="point-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">锚点</h4>\n  <div class="line coords">\n    <div class="input-unit">\n      <input type="number" class="x" step="1"/>\n      <span class="unit">X</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="y" step="1"/>\n      <span class="unit">Y</span>\n    </div>\n  </div>\n  <div class="intro">类型</div>\n  <ul class="line type">\n    <li class="straight" title="直线"></li>\n    <li class="mirrored" title="对称曲线"></li>\n    <li class="disconnected" title="断开连接"></li>\n    <li class="asymmetric" title="不对称曲线"></li>\n  </ul>\n  <div class="intro">半径</div>\n  <div class="line num">\n    <input type="range" min="0" max="100" step="1" value="0"/>\n    <div class="input-unit">\n      <input type="number" class="r" min="0" max="100" step="1" value=""/>\n    </div>\n  </div>\n',r.appendChild(o);var a=[],s=[];o.addEventListener("click",(function(e){var t;i.silence=!0;var r=e.target,c=r.tagName.toUpperCase(),u=r.classList,h=n.geometry,d=h.nodes,f=h.idxes;d.forEach((function(e,t){f[t].length&&(a.push(e),s.push(Ps(e.props.points)))})),"LI"!==c||u.contains("cur")||(null===(t=o.querySelector(".type .cur"))||void 0===t||t.classList.remove("cur"),u.add("cur"),a.splice(0),s.splice(0),d.forEach((function(e,t){var r=f[t];if(r.length){a.push(e),s.push(Ps(e.props.points));var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){if(e.hasCurveTo=e.hasCurveFrom=!0,u.contains("mirrored")){if(e.curveMode=Ks.MIRRORED,e.hasCurveTo){var r=e.tx-e.x,n=e.ty-e.y;e.fx=e.x-r,e.fy=e.y-n}else if(e.hasCurveFrom){r=e.fx-e.x,n=e.fy-e.y;e.tx=e.x-r,e.ty=e.y-n}else{var o=i[t-1]||i[i.length-1];e.tx=.5*(o.x+e.x),e.ty=.5*(o.y+e.y);r=e.tx-e.x,n=e.ty-e.y;e.fx=e.x-r,e.fy=e.y-n}e.hasCurveFrom=!0,e.hasCurveTo=!0}else if(u.contains("disconnected"))e.curveMode=Ks.DISCONNECTED;else if(u.contains("asymmetric")){e.curveMode=Ks.ASYMMETRIC;var a=Math.sqrt(Math.pow(e.tx-e.x,2)+Math.pow(e.ty-e.y,2)),s=Math.sqrt(Math.pow(e.fx-e.x,2)+Math.pow(e.fy-e.y,2));if(e.hasCurveTo||!e.hasCurveFrom&&!e.hasCurveTo){r=e.tx-e.x,n=e.ty-e.y;e.fx=e.x-r*s/a,e.fy=e.y-n*s/a}else if(e.hasCurveFrom){r=e.fx-e.x,n=e.fy-e.y;e.tx=e.x-r*a/s,e.ty=e.y-n*a/s}e.hasCurveFrom=!0,e.hasCurveTo=!0}else e.curveMode=Ks.STRAIGHT,e.hasCurveTo=e.hasCurveFrom=!1})),e.refresh()}n.geometry.updateVertex(e)})),l()),n.geometry.keep=!0,i.silence=!1}));var l=function(e){void 0===e&&(e=!1),a.length&&(a.forEach((function(e){return e.checkPointsChange()})),n.geometry.updateAll(e),n.history.addCommand(new eT(a.slice(0),a.map((function(e,t){return{prev:s[t],next:Ps(e.props.points)}})))),a.splice(0),s.splice(0))},c=o.querySelector("input.x"),u=o.querySelector("input.y"),h=function(e,t){void 0===t&&(t=!0),i.silence=!0;var r=n.geometry,o=r.nodes,l=r.idxes,h=parseFloat(t?c.value:u.value)||0,d=e instanceof InputEvent,f=!a.length,p=[];o.forEach((function(e,r){var i=l[r];if(i.length){f&&(a.push(e),s.push(Ps(e.props.points)));var o=i.map((function(t){return e.props.points[t]}));o.forEach((function(e,i){if(d)t?e.dspX=h:e.dspY=h,r||i||(t?c.placeholder="":u.placeholder="");else{var o=0;o=t?c.placeholder?h:h-e.dspX:u.placeholder?h:h-e.dspY,n.shiftKey?o=o>0?10:-10:n.altKey&&(o=o>0?.1:-.1),t?(e.dspX+=o,e.dspFx+=o,e.dspTx+=o):(e.dspY+=o,e.dspFy+=o,e.dspTy+=o),r||i||(t?c.placeholder?c.value="":c.value=Lu(e.dspX).toString():u.placeholder?u.value="":u.value=Lu(e.dspY).toString())}})),tC(e,o),e.reflectPoints(o),e.refresh(),n.geometry.updateVertex(e),p.push(o)}})),n.emit(iT.POINT_NODE,a.slice(0),p),i.silence=!1};c.addEventListener("input",(function(e){h(e,!0)})),c.addEventListener("change",(function(){return l()})),u.addEventListener("input",(function(e){h(e,!1)})),u.addEventListener("change",(function(){return l()}));var d=o.querySelector('input[type="range"]'),f=o.querySelector("input.r"),p=!1;return d.addEventListener("input",(function(e){i.silence=!0;var t=n.geometry,r=t.nodes,o=t.idxes,l=parseFloat(d.value)||0;p=!1;var c=!a.length,u=[];r.forEach((function(e,t){var r=o[t];if(r.length){c&&(a.push(e),s.push(Ps(e.props.points)));var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){(e.cornerRadius&&!l||!e.cornerRadius&&l)&&(p=!0),e.cornerRadius=l})),e.refresh(),n.geometry.updateVertex(e),u.push(i)}})),d.placeholder=f.placeholder="",f.value=d.value,n.emit(iT.POINT_NODE,a.slice(0),u),i.silence=!1})),d.addEventListener("change",(function(){return l(p)})),f.addEventListener("input",(function(e){i.silence=!0;var t=n.geometry,r=t.nodes,o=t.idxes,l=parseFloat(f.value)||0,c=e instanceof InputEvent,u=!a.length,h=[];r.forEach((function(e,t){var r=o[t];if(r.length){u&&(a.push(e),s.push(Ps(e.props.points)));var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e,r){if(c)e.cornerRadius=l,t||r||(d.placeholder=f.placeholder="",d.value=f.value);else{var i=0;i=f.placeholder?l:l-e.cornerRadius,n.shiftKey?i=i>0?10:-10:n.altKey&&(i=i>0?.1:-.1),e.cornerRadius+=i,t||r||(f.placeholder?f.value="":f.value=Lu(e.cornerRadius).toString())}})),e.refresh(),n.geometry.updateVertex(e),h.push(i)}})),n.emit(iT.POINT_NODE,a.slice(0),h),i.silence=!1})),f.addEventListener("change",(function(){return l()})),n.on(iT.STATE_CHANGE,(function(e,t){t!==fC.EDIT_GEOM&&e!==fC.EDIT_GEOM||(a.splice(0),s.splice(0),i.show())})),n.on([iT.SELECT_POINT,iT.POINT_NODE],(function(){i.silence||(a.splice(0),s.splice(0),i.updateCoords(),i.updateType(),i.updateRange())})),i}return v(t,e),t.prototype.show=function(){var e=this.listener.selected.filter((function(e){return e instanceof tE})),t=this.panel;e.length&&this.listener.state===fC.EDIT_GEOM?(t.style.display="block",this.updateCoords(),this.updateType(),this.updateRange()):t.style.display="none"},t.prototype.updateCoords=function(){var e=this.panel,t=this.listener.geometry,r=t.nodes,n=t.idxes,i=e.querySelector(".coords"),o=i.querySelector("input.x"),a=i.querySelector("input.y"),s=[],l=[];r.forEach((function(e,t){var r=n[t];if(r.length){var i=r.map((function(t){return e.props.points[t]}));eC(e,i),i.forEach((function(e){s.includes(e.dspX)||s.push(e.dspX),l.includes(e.dspY)||l.push(e.dspY)}))}})),i.classList.remove("enable"),o.value=a.value="",o.placeholder=a.placeholder="",o.disabled=a.disabled=!0,s.length&&(i.classList.add("enable"),o.disabled=a.disabled=!1,s.length>1?o.placeholder="多个":o.value=Lu(s[0]).toString(),l.length>1?a.placeholder="多个":a.value=Lu(l[0]).toString())},t.prototype.updateType=function(){var e,t,r=this.panel,n=this.listener.geometry,i=n.nodes,o=n.idxes,a=r.querySelector(".type"),s=[];if(i.forEach((function(e,t){var r=o[t];if(r.length){var n=r.map((function(t){return e.props.points[t]}));n.forEach((function(e){var t=e.curveMode;t===Ks.NONE&&(t=Ks.STRAIGHT),s.includes(t)||s.push(t)}))}})),a.classList.remove("enable"),null===(e=a.querySelector(".cur"))||void 0===e||e.classList.remove("cur"),s.length&&(a.classList.add("enable"),1===s.length)){var l="straight";s[0]===Ks.MIRRORED?l="mirrored":s[0]===Ks.DISCONNECTED?l="disconnected":s[0]===Ks.ASYMMETRIC&&(l="asymmetric"),null===(t=r.querySelector(".type .".concat(l)))||void 0===t||t.classList.add("cur")}},t.prototype.updateRange=function(){var e=this.panel,t=this.listener.geometry,r=t.nodes,n=t.idxes,i=e.querySelector(".num"),o=i.querySelector('input[type="range"]'),a=i.querySelector("input.r"),s=[];r.forEach((function(e,t){var r=n[t];if(r.length){var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){if(e.curveMode===Ks.NONE||e.curveMode===Ks.STRAIGHT){var t=e.cornerRadius;s.includes(t)||s.push(t)}}))}})),i.classList.remove("enable"),o.value="0",a.value="",o.placeholder=a.placeholder="",o.disabled=a.disabled=!0,s.length&&(i.classList.add("enable"),o.disabled=a.disabled=!1,s.length>1?o.placeholder=a.placeholder="多个":o.value=a.value=Lu(s[0]).toString())},t}(sT);var dT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="fill-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">填充</h4>\n',r.appendChild(o);var a=[],s=[],l=[],c=[],u=function(){l.length&&n.history.addCommand(new UC(a,s.map((function(e,t){return{prev:e,next:l[t],index:c[t]}})))),a=[],s=[],l=[],c=[],n.gradient.hide()};return o.addEventListener("click",(function(e){var t=e.target,r=t.classList;if(r.contains("pick")){if(t.parentElement.classList.contains("read-only"))return;if(yC.isShowFrom("fillPanel"))return void yC.hide();yC.keep=!0,n.gradient.keep=!0,a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.fill,n=t.fillEnable,i=t.fillOpacity,o=r.map((function(t){return oh(t,e.width,e.height)}));s.push({fill:o,fillOpacity:i,fillEnable:n})}));var h=t.parentElement.parentElement.parentElement,d=parseInt(h.title),f=i.nodes[0].computedStyle.fill[d],p=function(e,t,r){var s,u,p;void 0===t&&(t=!1),void 0===r&&(r=!1),i.silence=!0;var v=h.querySelector(".pick").style;if(Array.isArray(e)){null===(s=o.querySelector(".value .hex"))||void 0===s||s.classList.remove("hide"),null===(u=o.querySelector(".value .gradient"))||void 0===u||u.classList.add("hide"),null===(p=o.querySelector(".value .multi-type"))||void 0===p||p.classList.add("hide");var m=Ku(e);h.querySelector(".hex input").value=m.slice(1),v.background=qu(e)}else{if(void 0!==e.url);else o.querySelector(".value .hex").classList.add("hide"),o.querySelector(".value .gradient").classList.remove("hide"),o.querySelector(".value .multi-type").classList.add("hide"),o.querySelector(".value .gradient select").value=e.t.toString(),v.background=oh(e,i.nodes[0].width,i.nodes[0].height,!0)}l=[],c=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.fill,i=r.fillEnable,o=r.fillOpacity,a=n.map((function(t,r){return oh(r===d?e:t)})),s={fill:a,fillOpacity:o,fillEnable:i};l.push(s),c.push(d),t.updateStyle(s)})),t||n.gradient.update(i.nodes[0],f,r),a.length&&n.emit(iT.FILL_NODE,a.slice(0)),i.silence=!1};n.cancelEditGeom(),yC.show(t,f,"fillPanel",p,u,n),n.select.hideSelect(),n.gradient.show(i.nodes[0],f,p,(function(){l.length&&(n.history.addCommand(new UC(a,s.map((function(e,t){return{prev:e,next:l[t],index:d}}))),!0),s=l.slice(0),l=[])})),Array.isArray(f)||(n.state=fC.EDIT_GRADIENT)}else if(r.contains("enabled")){i.silence=!0;var v=t.parentElement,m=parseInt(v.title),g=i.nodes.slice(0),y=[],b=[],x=[],w=!1;(r.contains("multi-checked")||r.contains("un-checked"))&&(w=!0),g.forEach((function(e){var t=e.getComputedStyle(),r=t.fill,n=t.fillEnable,i=t.fillOpacity,o=r.map((function(t){return oh(t,e.width,e.height)}));y.push({fill:o,fillOpacity:i,fillEnable:n});var a=o.slice(0),s=n.slice(0),l=i.slice(0);void 0!==s[m]&&(s[m]=w);var c={fill:a,fillEnable:s,fillOpacity:l};b.push(c),x.push(m),e.updateStyle(c)})),r.remove("multi-checked"),w?(r.remove("un-checked"),r.add("checked"),v.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(r.remove("checked"),r.add("un-checked"),v.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),g.length&&(n.emit(iT.FILL_NODE,g.slice(0)),n.history.addCommand(new UC(g,y.map((function(e,t){return{prev:e,next:b[t],index:x[t]}}))))),i.silence=!1}})),o.addEventListener("keydown",(function(e){var t=e.target;if("INPUT"===t.tagName.toUpperCase()&&"text"===t.type){var r=e.keyCode,i=e.code;e.metaKey||n.isWin&&e.ctrlKey||e.shiftKey||e.altKey||r>=48&&r<=57||/Digit\d/.test(i)||r>=37&&r<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(i)||r>=65&&r<=90||/Key[A-Z]/.test(i)||8===r||"Backspace"===i||46===r||"Delete"===i||27===r||"Escape"===i||13===r||"Enter"===i||20===r||"CapsLock"===i||e.preventDefault()}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=t.parentElement.parentElement.parentElement,o=parseInt(r.title),c=!a.length;if(c&&(s=[]),l=[],"text"===t.type){var u=Wu(t.value);i.nodes.forEach((function(e,t){if(c){a.push(e);var r=e.getComputedStyle(),n=r.fill,i=r.fillEnable,h=r.fillOpacity,d=n.map((function(t){return oh(t,e.width,e.height)}));s.push({fill:d,fillOpacity:h,fillEnable:i})}var f={fill:s[t].fill.slice(0),fillOpacity:s[t].fillOpacity.slice(0),fillEnable:s[t].fillEnable.slice(0)};l.push(f),f.fill[o]=u,e.updateStyle(f)})),t.placeholder="";var h=r.querySelector(".picker-btn b");h.title=h.style.background=qu(u)}else if("number"===t.type){var d=Math.min(100,Math.max(0,parseFloat(t.value)||0)),f=e instanceof InputEvent;i.nodes.forEach((function(e,r){if(c){a.push(e);var i=e.getComputedStyle(),u=i.fill,h=i.fillEnable,p=i.fillOpacity,v=u.map((function(t){return oh(t,e.width,e.height)}));s.push({fill:v,fillOpacity:p,fillEnable:h})}var m={fill:s[r].fill.slice(0),fillOpacity:s[r].fillOpacity.slice(0),fillEnable:s[r].fillEnable.slice(0)};l.push(m);var g=100*s[r].fillOpacity[o],y=d,b=0;f?(b=y-g,r||(t.placeholder="")):(0===y&&(y=-1),b=t.placeholder?y:y-g,n.shiftKey&&(b=b>0?10:-10),y=g+b,y=Math.max(y,0),y=Math.min(y,100),r||(t.value=t.placeholder?"":y.toString())),b&&(m.fillOpacity[o]=.01*y,e.updateStyle(m))}))}a.length&&n.emit(iT.FILL_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",(function(e){var t=e.target,r=t.tagName.toUpperCase();if("SELECT"===r)if(t.parentElement.classList.contains("pattern"));else{var o=t.parentElement.parentElement.parentElement,c=parseInt(o.title);a=i.nodes.slice(0),s=[],l=[],a.forEach((function(e){var r=e.getComputedStyle(),n=r.fill,i=r.fillEnable,o=r.fillOpacity,a=n.map((function(t){return oh(t,e.width,e.height)}));s.push({fill:a,fillOpacity:o,fillEnable:i});var u=n.map((function(r,n){return n===c?(r.t=parseInt(t.value),oh(r,e.width,e.height)):oh(r,e.width,e.height)})),h={fill:u,fillOpacity:o,fillEnable:i};l.push(h),e.updateStyle(h)})),u(),a.length&&n.emit(iT.FILL_NODE,a.slice(0))}else"INPUT"===r&&u()})),n.on([iT.FILL_NODE],(function(e,t){if(!i.silence&&(i.show(e),n.state===fC.EDIT_GRADIENT)){var r=n.gradient.node;n.gradient.update(r,r.computedStyle.fill[t[0].index])}})),i}return v(t,e),t.prototype.show=function(e){var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),this.nodes=e.filter((function(e){return e instanceof tE||e instanceof LS||e instanceof r_||e instanceof Uw})),this.nodes.length){t.style.display="block";var r=[],n=[],i=[];this.nodes.forEach((function(e){var t=e.getComputedStyle(),o=t.fill,a=t.fillEnable,s=t.fillOpacity;o.forEach((function(e,t){(r[t]=r[t]||[]).push(e)})),a.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),s.forEach((function(e,t){var r=i[t]=i[t]||[];r.includes(e)||r.push(e)}))}));for(var o=function(e){var o=r[e],s=n[e],l=i[e],c=[],u=[],h=[];o.forEach((function(e){if(Array.isArray(e)){var t=qu(e);c.includes(t)||c.push(t)}else{var r=e;if(void 0===r.url){var n=e;var i=0;e:for(d=h.length;i<d;i++){if((f=h[i]).t===n.t&&f.d.length===n.d.length){for(var o=f.d.length-1;o>=0;o--)if(f.d[o]!==n.d[o])continue e;if(f.stops.length===n.stops.length){for(o=f.stops.length-1;o>=0;o--){var a=f.stops[o],s=n.stops[o];if(a.color[0]!==s.color[0]||a.color[1]!==s.color[1]||a.color[2]!==s.color[2]||a.color[3]!==s.color[3]||a.offset!==s.offset)continue e}return}}}h.push(n)}else{for(var l=0,d=u.length;l<d;l++){var f;if((f=u[l]).url===r.url&&f.type===r.type&&f.scale===r.scale)return}u.push(r)}}})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,c){var u,h,d,f,p,v,m,g=o.length>1,y=a.length>1,b=s.length>1,x=(o.length?1:0)+(a.length?1:0)+(s.length?1:0)>1,w=x||g||y||b,E=t||!r||x||y||b||a.length?'readonly="readonly"':"",_="",S=" ",C=" ",T="多种";if(x)S="多个";else if(o.length)S="颜色",C="Hex",1===o.length&&(_=o[0]);else if(a.length){if(S="图像",C="显示",T=["填充","适应","拉伸","平铺"][a[0].type],1===a.length)_=oh(a[0],l,c,!0);else for(var A=1,k=a.length;A<k;A++)if(a[A].type!==a[0].type){T="多个";break}}else if(s.length)if(S="渐变",C="类型",T=["线性","径向","角度"][s[0].t],1===s.length)_=oh(s[0],l,c,!0);else for(A=1,k=s.length;A<k;A++)if(s[A].t!==s[0].t){T="多个";break}return'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(E?"read-only":"",'">\n        <b class="pick ').concat(w?"multi":"",'" style="').concat(w?"":"background:".concat(_),'">○○○</b>\n      </span>\n      <span class="txt">').concat(S,'</span>\n    </div>\n    <div class="value">\n      <div class="hex ').concat(a.length||s.length?"hide":"",'">\n        <span>#</span>\n        <input type="text" value="').concat(g?"":Ku(o[0]).slice(1),'" placeholder="').concat(g?"多个":"",'" maxlength="8"/>\n      </div>\n      <div class="pattern ').concat(o.length||s.length||y?"hide":"",'">\n        <select disabled="disabled">\n          <option value="').concat(rl.FILL,'" ').concat((null===(u=a[0])||void 0===u?void 0:u.type)===rl.FILL?'selected="selected"':"",'>填充</option>\n          <option value="').concat(rl.FIT,'" ').concat((null===(h=a[0])||void 0===h?void 0:h.type)===rl.FIT?'selected="selected"':"",'>适应</option>\n          <option value="').concat(rl.STRETCH,'" ').concat((null===(d=a[0])||void 0===d?void 0:d.type)===rl.STRETCH?'selected="selected"':"",'>拉伸</option>\n          <option value="').concat(rl.TILE,'" ').concat((null===(f=a[0])||void 0===f?void 0:f.type)===rl.TILE?'selected="selected"':"",'>平铺</option>\n        </select>\n      </div>\n      <div class="gradient ').concat(o.length||a.length||b?"hide":"",'">\n        <select>\n          <option value="').concat(Ws.LINEAR,'" ').concat((null===(p=s[0])||void 0===p?void 0:p.t)===Ws.LINEAR?'selected="selected"':"",'>线性</option>\n          <option value="').concat(Ws.RADIAL,'" ').concat((null===(v=s[0])||void 0===v?void 0:v.t)===Ws.RADIAL?'selected="selected"':"",'>径向</option>\n          <option value="').concat(Ws.CONIC,'" ').concat((null===(m=s[0])||void 0===m?void 0:m.t)===Ws.CONIC?'selected="selected"':"",'>角度</option>\n        </select>\n      </div>\n      <div class="multi-type ').concat(x||y||b?"":"hide",'">\n        <select disabled="disabled">\n          <option>').concat(T,'</option>\n        </select>\n      </div>\n      <span class="txt">').concat(C,'</span>\n    </div>\n    <div class="opacity">\n      <div class="input-unit">\n        <input type="number" min="0" max="100" step="1" value="').concat(n?"":100*i,'" placeholder="').concat(n?"多个":"",'"/>\n        <span class="unit">%</span>\n      </div>\n      <span class="txt">不透明度</span>\n    </div>\n  </div>')}(e,s.length>1,s[0],l.length>1,l[0],c,u,h,a.nodes[0].width,a.nodes[0].height)},a=this,s=r.length-1;s>=0;s--)o(s)}else t.style.display="none"},t}(sT);var fT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="stroke-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">描边</h4>\n',r.appendChild(o);var a=[],s=[],l=[],c=function(){l&&l.length&&n.history.addCommand(new zC(a.slice(0),s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[],n.gradient.hide()};return o.addEventListener("click",(function(e){var t,r=e.target,u=r.classList;if(u.contains("pick")){if(r.parentElement.classList.contains("read-only"))return;if(yC.isShowFrom("strokePanel"))return void yC.hide();yC.keep=!0,a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return oh(t,e.width,e.height)}));s.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return ah(e)})),strokeWidth:o})}));var h=r.parentElement.parentElement.parentElement,d=parseInt(h.title),f=i.nodes[0].computedStyle.stroke[0],p=function(e,t){var r,s,c;void 0===t&&(t=!1),i.silence=!0;var u=h.querySelector(".pick").style;Array.isArray(e)?(null===(r=o.querySelector(".value .hex"))||void 0===r||r.classList.remove("hide"),null===(s=o.querySelector(".value .gradient"))||void 0===s||s.classList.add("hide"),null===(c=o.querySelector(".value .multi-type"))||void 0===c||c.classList.add("hide"),u.background=qu(e)):void 0!==e.url||(o.querySelector(".value .hex").classList.add("hide"),o.querySelector(".value .gradient").classList.remove("hide"),o.querySelector(".value .multi-type").classList.add("hide"),o.querySelector(".value .gradient select").value=e.t.toString(),u.background=oh(e,i.nodes[0].width,i.nodes[0].height,!0));l=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.stroke,i=r.strokeEnable,o=r.strokePosition,a=r.strokeWidth,s=n.map((function(t,r){return oh(r===d?e:t)})),c={stroke:s,strokeEnable:i,strokePosition:o.map((function(e){return ah(e)})),strokeWidth:a};l.push(c),t.updateStyle(c)})),t||n.gradient.update(i.nodes[0],f),a.length&&n.emit(iT.STROKE_NODE,a.slice(0)),i.silence=!1};n.cancelEditGeom(),yC.show(r,f,"strokePanel",p,c,n),n.select.hideSelect(),n.gradient.show(i.nodes[0],f,p),n.state=fC.EDIT_GRADIENT}else if(u.contains("enabled")){i.silence=!0;var v=r.parentElement,m=parseInt(v.title),g=i.nodes.slice(0),y=[],b=[],x=!1;(u.contains("multi-checked")||u.contains("un-checked"))&&(x=!0),g.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return oh(t,e.width,e.height)}));y.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return ah(e)})),strokeWidth:o});var s=a.slice(0),l=n.slice(0),c=i.map((function(e){return ah(e)})),u=o.slice(0);void 0!==l[m]&&(l[m]=x);var h={stroke:s,strokeEnable:l,strokePosition:c,strokeWidth:u};b.push(h),e.updateStyle(h)})),u.remove("multi-checked"),x?(u.remove("un-checked"),u.add("checked"),v.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(u.remove("checked"),u.add("un-checked"),v.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),g.length&&(n.emit(iT.STROKE_NODE,g.slice(0)),n.history.addCommand(new zC(g.slice(0),y.map((function(e,t){return{prev:e,next:b[t]}}))))),i.silence=!1}else if(u.contains("p")&&!u.contains("cur")){i.silence=!0,null===(t=r.parentElement.querySelector(".cur"))||void 0===t||t.classList.remove("cur"),r.classList.add("cur");v=r.parentElement.parentElement.parentElement;var w=parseInt(v.title),E=i.nodes.slice(0),_=[],S=[],C="inside";u.contains("center")?C="center":u.contains("outside")&&(C="outside"),E.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return oh(t,e.width,e.height)}));_.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return ah(e)})),strokeWidth:o});var s=a.slice(0),l=n.slice(0),c=i.map((function(e){return ah(e)})),u=o.slice(0);void 0!==c[w]&&(c[w]=C);var h={stroke:s,strokeEnable:l,strokePosition:c,strokeWidth:u};S.push(h),e.updateStyle(h)})),E.length&&(n.emit(iT.STROKE_NODE,E.slice(0)),n.history.addCommand(new zC(E.slice(0),_.map((function(e,t){return{prev:e,next:S[t]}}))))),i.silence=!1}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=t.parentElement.parentElement.parentElement,o=parseInt(r.title),c=!a.length;c&&(s=[]),l=[];var u=Math.min(100,Math.max(0,parseFloat(t.value)||0)),h=e instanceof InputEvent;i.nodes.forEach((function(e,r){if(c){a.push(e);var i=e.getComputedStyle(),d=i.stroke,f=i.strokeEnable,p=i.strokePosition,v=i.strokeWidth,m=d.map((function(t){return oh(t,e.width,e.height)}));s.push({stroke:m,strokeEnable:f,strokePosition:p.map((function(e){return ah(e)})),strokeWidth:v})}var g={stroke:s[r].stroke.slice(0),strokeEnable:s[r].strokeEnable.slice(0),strokePosition:s[r].strokePosition.slice(0),strokeWidth:s[r].strokeWidth.slice(0)};l.push(g);var y=s[r].strokeWidth[o],b=u,x=0;h?(x=b-y,r||(t.placeholder="")):(0===b&&(b=-1),x=t.placeholder?b:b-y,n.shiftKey?x=x>0?10:-10:n.altKey&&(x=x>0?.1:-.1),b=y+x,b=Math.max(b,0),b=Math.min(b,100),r||(t.value=t.placeholder?"":b.toString())),x&&(g.strokeWidth[o]=b,e.updateStyle(g))})),a.length&&n.emit(iT.STROKE_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",c),n.on([iT.STROKE_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),this.nodes=e.filter((function(e){return e instanceof tE||e instanceof LS||e instanceof r_||e instanceof Uw})),this.nodes.length){t.style.display="block";var r=[],n=[],i=[],o=[];this.nodes.forEach((function(e){var t=e.getComputedStyle(),a=t.stroke,s=t.strokeEnable,l=t.strokePosition,c=t.strokeWidth;a.forEach((function(e,t){(r[t]=r[t]||[]).push(e)})),s.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),l.forEach((function(e,t){var r=i[t]=i[t]||[],n=ah(e);r.includes(n)||r.push(n)})),c.forEach((function(e,t){var r=o[t]=o[t]||[];r.includes(e)||r.push(e)}))}));for(var a=function(e){var a=r[e],l=n[e],c=i[e],u=o[e],h=[],d=[],f=[];a.forEach((function(e){if(Array.isArray(e)){var t=qu(e);h.includes(t)||h.push(t)}else{var r=e;if(void 0===r.url){var n=e;var i=0;e:for(c=f.length;i<c;i++){if((u=f[i]).t===n.t&&u.d.length===n.d.length){for(var o=u.d.length-1;o>=0;o--)if(u.d[o]!==n.d[o])continue e;if(u.stops.length===n.stops.length){for(o=u.stops.length-1;o>=0;o--){var a=u.stops[o],s=n.stops[o];if(a.color[0]!==s.color[0]||a.color[1]!==s.color[1]||a.color[2]!==s.color[2]||a.color[3]!==s.color[3]||a.offset!==s.offset)continue e}return}}}f.push(n)}else{for(var l=0,c=d.length;l<c;l++){var u;if((u=d[l]).url===r.url&&u.type===r.type&&u.scale===r.scale)return}d.push(r)}}})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,c,u,h){var d=s.length>1,f=l.length>1,p=c.length>1,v=(s.length?1:0)+(l.length?1:0)+(c.length?1:0)>1,m=v||d||f||p,g=t||!r||v||f||p||l.length||c.length?'readonly="readonly"':"",y="",b=" ";v?b="多个":s.length?(b="颜色",1===s.length&&(y=s[0])):l.length?(b="图像",1===l.length&&(y=oh(l[0],u,h,!0))):c.length&&(b="渐变",1===c.length&&(y=oh(c[0],u,h,!0)));var x=" ";return x=n?"多种":{inside:"内部",center:"中间",outside:"外部"}[i],'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(g?"read-only":"",'">\n        <b class="pick ').concat(m?"multi":"",'" style="').concat(m?"":"background:".concat(y),'">○○○</b>\n      </span>\n      <span class="txt">').concat(b,'</span>\n    </div>\n    <div class="pos">\n      <div>\n        <span class="p inside ').concat(n||"inside"!==i?"":"cur",'" title="内部"></span>\n        <span class="p center ').concat(n||"center"!==i?"":"cur",'" title="中间"></span>\n        <span class="p outside ').concat(n||"outside"!==i?"":"cur",'" title="外部"></span>\n      </div>\n      <span class="txt">').concat(x,'</span>\n    </div>\n    <div class="width">\n      <div class="input-unit">\n        <input type="number" min="0" max="100" step="1" value="').concat(o?"":a,'" placeholder="').concat(o?"多个":"",'"/>\n      </div>\n      <span class="txt">宽度</span>\n    </div>\n  </div>')}(e,l.length>1,l[0],c.length>1,c[0],u.length>1,u[0],h,d,f,s.nodes[0].width,s.nodes[0].height)},s=this,l=r.length-1;l>=0;l--)a(l)}else t.style.display="none"},t}(sT),pT="textPanelFold",vT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.nodes=[];var o=i.panel=document.createElement("div");o.className="text-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">字符<b class="btn arrow"></b></h4>\n  <div class="line ff">\n    <select>\n      <option value="arial">Arial</option>\n    </select>\n    <span class="multi">多种字体</span>\n  </div>\n  <div class="line wc">\n    <div class="weight">\n      <select></select>\n      <span class="multi">多种字重</span>\n    </div>\n    <div class="color">\n      <span class="picker-btn"><b class="pick">○○○</b></span>\n    </div>\n  </div>\n  <div class="line num">\n    <div class="fs">\n      <input type="number" min="0" step="1"/>\n      <span>字号</span>\n    </div>\n    <div class="ls">\n      <input type="number" step="1"/>\n      <span>字距</span>\n    </div>\n    <div class="lh">\n      <input type="number" min="0" step="1"/>\n      <span>行高</span>\n    </div>\n    <div class="ps">\n      <input type="number" step="1"/>\n      <span>段落</span>\n    </div>\n  </div>\n  <div class="line wh">\n    <div>\n      <span class="auto" title="自动宽度"></span>\n      <span class="fw" title="自动高度"></span>\n      <span class="fwh" title="固定尺寸"></span>\n    </div>\n    <span class="txt"></span>\n  </div>\n  <div class="line al">\n    <span class="left" title="水平左对齐"></span>\n    <span class="center" title="水平居中对齐"></span>\n    <span class="right" title="水平右对齐"></span>\n    <span class="justify" title="水平两端对齐"></span>\n  </div> \n  <div class="line va">\n    <span class="top" title="垂直上对齐"></span>\n    <span class="middle" title="垂直居中对齐"></span>\n    <span class="bottom" title="垂直下对齐"></span>\n  </div> \n',r.appendChild(o),n.input.ignoreBlur.push(o),i.initFontList(),"1"===localStorage.getItem(pT)&&o.classList.add("fold");var a=o.querySelector(".fs input"),s=o.querySelector(".ls input"),l=o.querySelector(".lh input"),c=o.querySelector(".ps input"),u=o.querySelector(".ff select"),h=o.querySelector(".weight select"),d=[],f=[],p=[],v=function(){d.length&&p.length&&n.history.addCommand(new OC(d,f.map((function(e,t){return{prev:e,next:p[t]}})),OC.COLOR)),d=[],f=[],p=[]},m=function(e,t){var r,o;i.silence=!0;var a=e.target,s=parseFloat(a.value)||0,l=!d.length;l&&(f=[]),p=[];var c=e instanceof InputEvent;if(n.state===fC.EDIT_TEXT&&1===i.nodes.length){var u=i.nodes[0],h=u.getSortedCursor(),v=h.isMulti,m=h.start,g=h.end;v?(l&&(d.push(u),f.push(u.getRich())),c?u.updateRangeStyle(m,g-m,((r={})[t]=s,r)):u.rich.forEach((function(e,r){var i;if(e.location<g&&e.location+e.length>m){var o=0;a.placeholder?(o=s>0?1:-1,n.shiftKey?o*=10:n.altKey&&(o*=.1)):(o=s-f[0][r][t],n.shiftKey?o*=10:n.altKey&&(o*=.1));var l=Math.max(e.location,m),c=Math.min(e.length,g-e.location)-(l-e.location),h=mT(e,t,o);u.updateRangeStyle(l,c,((i={})[t]=h,i))}})),p.push(u.getRich()),u.setCursorByIndex(m),u.setCursorByIndex(g,!0)):u.setInputStyle(((o={})[t]=s,o))}else i.nodes.forEach((function(e){var r;if(l&&(d.push(e),f.push(e.getRich())),c)e.updateRangeStyle(0,e._content.length,((r={})[t]=s,r));else{var i=0;a.placeholder?(i=s>0?1:-1,n.shiftKey?i*=10:n.altKey&&(i*=.1)):(i=s-f[0][0][t],n.shiftKey?i*=10:n.altKey&&(i*=.1)),e.rich.forEach((function(r){var n;e.updateRangeStyle(r.location,r.length,((n={})[t]=mT(r,t,i),n))}))}p.push(e.getRich())}));d.length&&(n.select.updateSelect(d),"fontSize"===t?n.emit(iT.FONT_SIZE_NODE,d.slice(0)):"letterSpacing"===t?n.emit(iT.LETTER_SPACING_NODE,d.slice(0)):"paragraphSpacing"===t?n.emit(iT.PARAGRAPH_SPACING_NODE,d.slice(0)):"lineHeight"===t&&n.emit(iT.LINE_HEIGHT_NODE,d.slice(0)),i.show(i.nodes)),i.silence=!1},g=function(e){if(d.length){var t="";"fontSize"==e?t=OC.FONT_SIZE:"letterSpacing"===e?t=OC.LETTER_SPACING:"lineHeight"===e?t=OC.LINE_HEIGHT:"paragraphSpacing"===e&&(t=OC.PARAGRAPH_SPACING),n.history.addCommand(new OC(d,f.map((function(e,t){return{prev:e,next:p[t]}})),t)),d=[],f=[],p=[]}},y=function(){n.state===fC.EDIT_TEXT&&n.input.focus()};a.addEventListener("input",(function(e){m(e,"fontSize")})),s.addEventListener("input",(function(e){m(e,"letterSpacing")})),l.addEventListener("input",(function(e){m(e,"lineHeight")})),c.addEventListener("input",(function(e){m(e,"paragraphSpacing")})),a.addEventListener("change",(function(e){g("fontSize")})),s.addEventListener("change",(function(e){g("letterSpacing")})),l.addEventListener("change",(function(e){g("lineHeight")})),c.addEventListener("change",(function(e){g("paragraphSpacing")})),a.addEventListener("blur",y),s.addEventListener("blur",y),l.addEventListener("blur",y),c.addEventListener("blur",y);var b=function(e,t){i.silence=!0;var r=e.target,a=r.value,s=i.nodes.slice(0);if("fontFamily"===t){o.querySelector(".ff .multi").style.display="none";var l=DS(a),c=o.querySelector(".wc select"),u="";l.forEach((function(e){u+='<option value="'.concat(e.value,'">').concat(e.label,"</option>")})),c.innerHTML=u;for(var h=l.length?l[0].value:a,d=0,f=l.length;d<f;d++){var p=l[d];if("regular"===p.label.toLowerCase()){h=p.value;break}}c.disabled=!1;var v=[];if(n.state===fC.EDIT_TEXT&&1===i.nodes.length){var m=(_=s[0]).getSortedCursor(),g=m.isMulti,y=m.start,b=m.end;if(g){var x=_.getRich();_.updateRangeStyle(y,b-y,{fontFamily:h}),v.push({prev:x,next:_.getRich()}),_.setCursorByIndex(y),_.setCursorByIndex(b,!0)}else _.setInputStyle({fontFamily:h})}else s.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{fontFamily:h}),v.push({prev:t,next:e.getRich()})}));v.length&&(n.history.addCommand(new OC(s,v,OC.FONT_FAMILY)),n.select.updateSelect(s),n.emit(iT.FONT_FAMILY_NODE,s.slice(0)),i.show(i.nodes))}else if("fontWeight"===t){o.querySelector(".wc .multi").style.display="none";var w=r.querySelector(":disabled");w&&w.remove();var E=[];if(n.state===fC.EDIT_TEXT&&1===i.nodes.length){var _,S=(_=s[0]).getSortedCursor();g=S.isMulti,y=S.start,b=S.end;if(g){x=_.getRich();_.updateRangeStyle(y,b-y,{fontFamily:a}),E.push({prev:x,next:_.getRich()}),_.setCursorByIndex(y),_.setCursorByIndex(b,!0)}else _.setInputStyle({fontFamily:a})}else s.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{fontFamily:a}),E.push({prev:t,next:e.getRich()})}));E.length&&(n.history.addCommand(new OC(s,E,OC.FONT_FAMILY)),n.select.updateSelect(s),n.emit(iT.FONT_FAMILY_NODE,s.slice(0)))}i.silence=!1};return u.addEventListener("change",(function(e){b(e,"fontFamily")})),h.addEventListener("change",(function(e){b(e,"fontWeight")})),o.addEventListener("click",(function(e){var t,a,s,l=e.target,c=l.classList;if(c.contains("pick")){if(l.parentElement.classList.contains("read-only"))return;if(yC.isShowFrom("textPanel"))return void yC.hide();yC.keep=!0,d=i.nodes.slice(0),f=d.map((function(e){return e.getRich()}));var u=i.nodes[0].computedStyle.color,h=yC.show(l,u,"textPanel",(function(e){if(i.silence=!0,p=[],n.state===fC.EDIT_TEXT&&1===d.length){var t=d[0],r=t.getSortedCursor(),a=r.isMulti,s=r.start,l=r.end;a?(t.updateRangeStyle(s,l-s,{color:e}),p.push(t.getRich()),t.setCursorByIndex(s),t.setCursorByIndex(l,!0)):t.setInputStyle({color:e})}else d.forEach((function(t){t.updateRangeStyle(0,t._content.length,{color:e}),p.push(t.getRich())}));o.querySelector(".pick").style.background=qu(e),d.length&&n.emit(iT.COLOR_NODE,d.slice(0)),i.silence=!1}),v,n),m=h.domElement.parentElement;n.input.ignoreBlur.includes(m)||n.input.ignoreBlur.push(m)}else if(c.contains("arrow"))o.classList.contains("fold")?(o.classList.remove("fold"),localStorage.removeItem(pT)):(o.classList.add("fold"),localStorage.setItem(pT,"1"));else if((c.contains("auto")||c.contains("fw")||c.contains("fwh"))&&!c.contains("cur")){d=i.nodes.slice(0);var g=il.AUTO;c.contains("fw")?g=il.FIXED_W:c.contains("fwh")&&(g=il.FIXED_W_H);var y=[];d.map((function(e){var t=e.width,r=e.height,n=PS(e);BS(e,g);var i={dx:e.width-t,dy:e.height-r,controlType:SC.BR,aspectRatio:!1,fromCenter:!1};n===il.AUTO?(i.widthFromAuto=!0,i.heightFromAuto=!0):n===il.FIXED_W&&(i.heightFromAuto=!0),g===il.AUTO?(i.widthToAuto=!0,i.heightToAuto=!0):g===il.FIXED_W&&(i.heightToAuto=!0),y.push(i)})),n.history.addCommand(new kC(d,y)),n.select.updateSelect(d),n.emit(iT.RESIZE_NODE,d.slice(0)),null===(t=r.querySelector(".wh .cur"))||void 0===t||t.classList.remove("cur"),c.add("cur"),r.querySelector(".wh .txt").innerHTML=l.title}else if((c.contains("left")||c.contains("right")||c.contains("center")||l.classList.contains("justify"))&&!c.contains("cur")){var b=i.nodes.slice(0),x=Hs.LEFT;c.contains("right")?x=Hs.RIGHT:c.contains("center")?x=Hs.CENTER:c.contains("justify")&&(x=Hs.JUSTIFY);var w=[];if(1===b.length&&n.state===fC.EDIT_TEXT){var E=b[0],_=E.content,S=E.getSortedCursor(),C=S.isMulti,T=S.start,A=S.end;(T="\n"===_.charAt(T)?_.lastIndexOf("\n",T-1):_.lastIndexOf("\n",T))<0?T=0:T++,(A=_.indexOf("\n",A))<0?A=_.length:A++;var k=E.getRich();if(E.updateRangeStyle(T,A-T,{textAlign:x}),w.push({prev:k,next:E.getRich()}),C)E.setCursorByIndex(T),E.setCursorByIndex(A,!0);else{h=E.updateCursorByIndex(S.start);n.input.updateCursor(h)}}else b.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{textAlign:x}),w.push({prev:t,next:e.getRich()})}));w.length&&(n.history.addCommand(new OC(b,w,OC.TEXT_ALIGN)),n.emit(iT.TEXT_ALIGN_NODE,b.slice(0))),null===(a=r.querySelector(".al .cur"))||void 0===a||a.classList.remove("cur"),c.add("cur")}else if((c.contains("top")||c.contains("bottom")||c.contains("middle"))&&!c.contains("cur")){v();var M=i.nodes.slice(0),O="top";c.contains("middle")?O="middle":c.contains("bottom")&&(O="bottom");var L=[];M.forEach((function(e){var t=e.computedStyle.textVerticalAlign,r="top";t===Gs.MIDDLE?r="middle":t===Gs.BOTTOM&&(r="bottom"),e.updateStyle({textVerticalAlign:O}),L.push({prev:{textVerticalAlign:r},next:{textVerticalAlign:O}})})),n.history.addCommand(new FC(M,L)),n.emit(iT.TEXT_VERTICAL_ALIGN_NODE,M.slice(0)),null===(s=r.querySelector(".va .cur"))||void 0===s||s.classList.remove("cur"),c.add("cur")}})),n.on([iT.RESIZE_NODE,iT.FONT_SIZE_NODE,iT.FONT_FAMILY_NODE,iT.LETTER_SPACING_NODE,iT.LINE_HEIGHT_NODE,iT.PARAGRAPH_SPACING_NODE,iT.COLOR_NODE,iT.TEXT_ALIGN_NODE,iT.TEXT_VERTICAL_ALIGN_NODE,iT.CURSOR_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.initFontList=function(e){var t=Ew.font.info,r="";if(e&&e.length){var n=t.Arial;e.forEach((function(e){jl.registerData(Z(Z({},n),e)),r+='<option value="'.concat(e.family,'">').concat(e.name,"</option>")}))}else for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];r+='<option value="'.concat(i,'">').concat(o.name||i,"</option>")}this.panel.querySelector("select").innerHTML=r},t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){if(e[n]instanceof r_){r=!0;break}}if(r){t.style.display="block",t.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder=""}));var o=e.filter((function(e){return e instanceof r_}));this.nodes=o;var a,s,l=this.listener.state===fC.EDIT_TEXT&&1===e.length&&o[0]._content?NS(o[0]):FS(o);(s=(a=t.querySelector(".ff select")).querySelector(":disabled"))&&s.remove();var c=t.querySelector(".ff .multi");for(n=0,i=(f=a.querySelectorAll("option")).length;n<i;n++){var u=f[n];if(u.selected){u.selected=!1;break}}if(l.fontFamily.length>1){c.innerText="多种字体",c.style.display="block",c.classList.remove("invalid");a.innerHTML+='<option value="" selected="selected" disabled>多种字体</option>'}else if(l.valid[0]){if(c.style.display="none",c.classList.remove("invalid"),!a.querySelector('option[value="'.concat(l.fontFamily[0],'"]'))){h='<option value="'.concat(l.fontFamily[0],'">').concat(l.name[0],"</option>");a.innerHTML+=h}a.value=l.fontFamily[0]}else{if(c.innerText=l.fontFamily[0],c.classList.add("invalid"),c.style.display="block",a.querySelector('option[value="'.concat(l.postscriptName[0],'"]')))a.value=l.postscriptName[0];else{var h='<option value="'.concat(l.postscriptName[0],'" selected="selected" disabled>').concat(l.fontFamily[0],"</option>");a.innerHTML+=h}}(s=(a=t.querySelector(".wc select")).querySelector(":disabled"))&&s.remove();var d="";l.fontWeightList.forEach((function(e){d+='<option value="'.concat(e.value,'">').concat(e.label,"</option>")})),a.innerHTML=d;c=t.querySelector(".wc .multi");if(l.fontWeight.length>1){c.style.display="block";a.innerHTML+='<option value="" selected="selected" disabled>多种字体</option>'}else{c.style.display="none";var f;for(n=0,i=(f=a.querySelectorAll("option")).length;n<i;n++){var p=f[n];if(p.innerHTML===l.fontWeight[0]){p.selected=!0;break}}}a.disabled=!(1===l.valid.length&&l.valid[0]);var v=t.querySelector(".color .pick");l.color.length>1?(v.style.background="",v.classList.add("multi")):(v.style.background=l.color[0],v.classList.remove("multi"));var m=t.querySelector(".fs input");l.fontSize.length>1?(m.value="",m.placeholder="多个"):(m.value=Lu(l.fontSize[0]||0,2).toString(),m.placeholder="");m=t.querySelector(".ls input");l.letterSpacing.length>1?(m.value="",m.placeholder="多个"):(m.value=Lu(l.letterSpacing[0]||0,2).toString(),m.placeholder="");m=t.querySelector(".lh input");l.lineHeight.length>1?(m.value="",m.placeholder="多个"):l.autoLineHeight[0]?(m.value="",m.placeholder=Lu(l.lineHeight[0]||0,2).toString()):(m.value=Lu(l.lineHeight[0]||0,2).toString(),m.placeholder="");m=t.querySelector(".ps input");l.paragraphSpacing.length>1?(m.value="",m.placeholder="多个"):(m.value=Lu(l.paragraphSpacing[0]||0,2).toString(),m.placeholder=""),(g=t.querySelector(".wh .cur"))&&g.classList.remove("cur");var g,y=t.querySelector(".wh .txt");if(1===l.textBehaviour.length){var b=l.textBehaviour[0];b===il.AUTO?(t.querySelector(".wh .auto").classList.add("cur"),y.innerHTML="自动宽度"):b===il.FIXED_W?(t.querySelector(".wh .fw").classList.add("cur"),y.innerHTML="自动高度"):b===il.FIXED_W_H&&(t.querySelector(".wh .fwh").classList.add("cur"),y.innerHTML="固定尺寸")}else y.innerHTML="多种";if((g=t.querySelector(".al .cur"))&&g.classList.remove("cur"),1===l.textAlign.length){var x=l.textAlign[0];x===Hs.LEFT?t.querySelector(".al .left").classList.add("cur"):x===Hs.CENTER?t.querySelector(".al .center").classList.add("cur"):x===Hs.RIGHT?t.querySelector(".al .right").classList.add("cur"):x===Hs.JUSTIFY&&t.querySelector(".al .justify").classList.add("cur")}if((g=t.querySelector(".va .cur"))&&g.classList.remove("cur"),1===l.textVerticalAlign.length){var w=l.textVerticalAlign[0];w===Gs.TOP?t.querySelector(".va .top").classList.add("cur"):w===Gs.MIDDLE?t.querySelector(".va .middle").classList.add("cur"):w===Gs.BOTTOM&&t.querySelector(".va .bottom").classList.add("cur")}}else t.style.display="none"},t}(sT);function mT(e,t,r){var n=e[t];if(!n&&"lineHeight"===t){var i=jl.data[e.fontFamily];n=i?e.fontSize*i.lhr:e.fontSize*(jl.data[fl.defaultFontFamily]||jl.data.arial).lhr}var o=n+r;return"fontSize"!==t&&"lineHeight"!==t||(o=Math.max(0,o)),o}var gT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");return o.className="align-panel",o.innerHTML='\n  <div class="line">\n    <span class="left" title="居左"></span>\n    <span class="center" title="左右居中"></span>\n    <span class="right" title="居右"></span>\n    <span class="top" title="居上"></span>\n    <span class="middle" title="上下居中"></span>\n    <span class="bottom" title="居下"></span>\n  </div>\n',r.appendChild(o),o.addEventListener("click",(function(e){var t=e.target;if("SPAN"===t.tagName.toUpperCase()&&t.parentElement.classList.contains("disabled"))return;var r=t.classList,o=[],a=[];i.nodes.forEach((function(e){var t=0,n=0,i=e.parent,s=i.width,l=i.height,c=e.computedStyle;if(r.contains("left")?t=-c.left-c.translateX:r.contains("center")?t=.5*s-c.left-c.translateX-.5*c.width:r.contains("right")?t=s-c.left-c.translateX-c.width:r.contains("top")?n=-c.top-c.translateY:r.contains("middle")?n=.5*l-c.top-c.translateY-.5*c.height:r.contains("bottom")&&(n=l-c.top-c.translateY-c.height),t||n){var u=e.getStyle();e.updateStyle({translateX:c.translateX+t,translateY:c.translateY+n}),e.endPosChange(u,t,n),e.checkPosSizeUpward(),o.push(e),a.push({dx:t,dy:n})}})),o.length&&(n.select.updateSelect(o),n.emit(iT.MOVE_NODE,o.slice(0)),n.history.addCommand(new TC(o,a)))})),i}return v(t,e),t.prototype.show=function(e){var t=this.panel,r=[];e.forEach((function(e){var t=e.parent;t&&(t instanceof VE||t instanceof Fw)&&r.push(e)})),this.nodes=r,r.length?t.querySelector(".line").classList.remove("disabled"):t.querySelector(".line").classList.add("disabled")},t}(sT),yT=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=e.getCurPage(),i=e.pageContainer,o=document.createElement("ul");i.children.forEach((function(e){var t=document.createElement("li");t.title=e.props.name||"",t.setAttribute("uuid",e.props.uuid),t.innerHTML=e.props.name||"",n&&e===n&&(t.className="active"),o.appendChild(t)})),t.innerHTML="",t.appendChild(o),t.addEventListener("click",(function(t){var n,a=t.target,s=a.classList;if(!s.contains("active")){null===(n=o.querySelector(".active"))||void 0===n||n.classList.remove("active"),s.add("active");var l=a.getAttribute("uuid");if(l){var c=e.refs[l];if(c){var u=i.children.indexOf(c);u>-1&&(e.setPageIndex(u),r.active([]))}}}}))};var bT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="shadow-panel",o.style.display="none",o.innerHTML='\n  <div class="panel-title">阴影<b class="btn del"></b><b class="btn add"></b></div>\n',r.appendChild(o);var a=[],s=[],l=[],c=function(){l.length&&n.history.addCommand(new DC(a,s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[]};return o.addEventListener("click",(function(e){var t=e.target,r=t.classList;if(r.contains("pick")){if(t.parentElement.classList.contains("read-only"))return;if(yC.isShowFrom("shadowPanel"))return void yC.hide();yC.keep=!0,a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return ih(e)}));s.push({shadow:i,shadowEnable:n})}));var u=t.parentElement.parentElement.parentElement,h=parseInt(u.title),d=i.nodes[0].computedStyle.shadow[0].color;yC.show(t,d,"shadowPanel",(function(e){i.silence=!0,l=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.shadow,i=r.shadowEnable,o=n.map((function(t,r){return ih(r===h?Object.assign(t,{color:e}):t)})),a={shadow:o,shadowEnable:i};l.push(a),t.updateStyle(a)})),u.querySelector(".pick").style.background=qu(e),a.length&&n.emit(iT.SHADOW_NODE,a.slice(0)),i.silence=!1}),c,n)}else if(r.contains("add")){i.silence=!0;var f=i.nodes.slice(0),p=[],v=[];f.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return ih(e)}));p.push({shadow:i,shadowEnable:n});var o=i.slice(0),a=n.slice(0);o.push("rgba(0,0,0,0.5) 0 2 4 0"),a.push(!0);var s={shadow:o,shadowEnable:a};v.push(s),e.updateStyle(s)})),i.show(f),n.emit(iT.SHADOW_NODE,f.slice(0)),n.history.addCommand(new DC(f.slice(0),p.map((function(e,t){return{prev:e,next:v[t]}})))),i.silence=!1}else if(r.contains("del")){i.silence=!0;var m=i.nodes.slice(0),g=[],y=[],b=0;m.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return ih(e)}));b=Math.max(b,n.length),g.push({shadow:i,shadowEnable:n}),y.push({shadow:i.slice(0),shadowEnable:n.slice(0)})}));for(var x=function(e){for(var t=0,r=y.length;t<r;t++){if(y[t].shadowEnable[e])return"continue-outer"}y.forEach((function(t){t.shadow.splice(e,1),t.shadowEnable.splice(e,1)}))},w=b-1;w>=0;w--)x(w);m.forEach((function(e,t){e.updateStyle(y[t])})),i.show(m),n.emit(iT.SHADOW_NODE,m.slice(0)),n.history.addCommand(new DC(m.slice(0),g.map((function(e,t){return{prev:e,next:y[t]}})))),i.silence=!1}else if(r.contains("enabled")){i.silence=!0;var E=t.parentElement,_=parseInt(E.title),S=i.nodes.slice(0),C=[],T=[],A=!1;(r.contains("multi-checked")||r.contains("un-checked"))&&(A=!0),S.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return ih(e)}));C.push({shadow:i,shadowEnable:n});var o=i.slice(0),a=n.slice(0);void 0!==a[_]&&(a[_]=A);var s={shadow:o,shadowEnable:a};T.push(s),e.updateStyle(s)})),r.remove("multi-checked"),A?(r.remove("un-checked"),r.add("checked"),E.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(r.remove("checked"),r.add("un-checked"),E.querySelectorAll("input").forEach((function(e){e.readOnly=!0})));var k=o.querySelector(".un-checked");o.querySelector(".del").style.display=k?"block":"none",n.emit(iT.SHADOW_NODE,S.slice(0)),n.history.addCommand(new DC(S.slice(0),C.map((function(e,t){return{prev:e,next:T[t]}})))),i.silence=!1}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=parseInt(t.parentElement.parentElement.title),o=t.classList,c=1;o.contains("y")?c=2:o.contains("blur")?c=3:o.contains("spread")&&(c=4);var u=Math.min(5e5,Math.max(-5e5,parseFloat(t.value)||0)),h=!a.length;h&&(s=[]),l=[];var d=e instanceof InputEvent;i.nodes.forEach((function(e,i){if(h){a.push(e);var o=e.getComputedStyle(),f=o.shadow,p=o.shadowEnable,v=f.map((function(e){return ih(e)}));s.push({shadow:v,shadowEnable:p})}var m={shadow:s[i].shadow.slice(0),shadowEnable:s[i].shadowEnable.slice(0)};l.push(m);var g=parseFloat(s[i].shadow[r].split(" ")[c]),y=u;if(d)t.placeholder="";else{var b=0;t.placeholder?(b=u>0?1:-1,n.shiftKey?b*=10:n.altKey&&(b*=.1)):(b=u-g,n.shiftKey?b*=10:n.altKey&&(b*=.1)),y=g+b,t.placeholder?t.value="":t.value=Math.round(y).toString()}if(m.shadow[r]){var x=m.shadow[r].split(" ");x[c]=y.toString(),m.shadow[r]=x.join(" "),e.updateStyle(m)}})),a.length&&n.emit(iT.SHADOW_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",c),n.on([iT.SHADOW_NODE],(function(e){i.silence||i.show(e)})),n.on(iT.STATE_CHANGE,(function(e,t){t!==fC.EDIT_GEOM&&t!==fC.NORMAL||i.show(n.selected)})),i}return v(t,e),t.prototype.show=function(t){e.prototype.show.call(this,t);var r=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),t.length&&this.listener.state!==fC.EDIT_GEOM){r.style.display="block";var n=[],i=[];t.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow;t.shadowEnable.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),r.forEach((function(e,t){(i[t]=i[t]||[]).push(e)}))}));for(var o=!1,a=function(e){var t=i[e],a=n[e],s=[],l=[],c=[],u=[],h=[];t.forEach((function(e){var t=qu(e.color);s.includes(t)||s.push(t),l.includes(e.x)||l.push(e.x),c.includes(e.y)||c.push(e.y),u.includes(e.blur)||u.push(e.blur),h.includes(e.spread)||h.push(e.spread)})),r.innerHTML+=function(e,t,r,n,i,o,a,s,l,c,u,h,d){var f=t||!r?'readonly="readonly"':"";return'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(f?"read-only":"",'">\n        <b class="pick ').concat(n?"multi":"",'" style="').concat(n?"":"background:".concat(i),'">○○○</b>\n      </span>\n      <span class="txt">颜色</span>\n    </div>\n    <div>\n      <input class="x" type="number" min="-500000" max="500000" step="1" value="').concat(o?"":a,'" placeholder="').concat(o?"多个":"",'" ').concat(f,'/>\n      <span class="txt">X</span>\n    </div>\n    <div>\n      <input class="y" type="number" min="-500000" max="500000" step="1" value="').concat(s?"":l,'" placeholder="').concat(s?"多个":"",'" ').concat(f,'/>\n      <span class="txt">Y</span>\n    </div>\n    <div>\n      <input class="blur" type="number" min="0" max="50" step="1" value="').concat(c?"":u,'" placeholder="').concat(c?"多个":"",'" ').concat(f,'/>\n      <span class="txt">模糊</span>\n    </div>\n  </div>')}(e,a.length>1,a[0],s.length>1,s[0],l.length>1,l[0],c.length>1,c[0],u.length>1,u[0]),1!==a.length||a[0]||(o=!0)},s=i.length-1;s>=0;s--)a(s);this.panel.querySelector(".del").style.display=o?"block":"none"}else r.style.display="none"},t}(sT),xT='\n  <div class="panel-title">模糊<b class="btn"></b></div>\n  <select>\n    <option value="'.concat(qs.GAUSSIAN,'">高斯模糊</option>\n    <option value="').concat(qs.MOTION,'">动感模糊</option>\n    <option value="').concat(qs.RADIAL,'">缩放模糊</option>\n    <option value="').concat(qs.BACKGROUND,'">背景模糊</option>\n    <option value="').concat(qs.NONE,'" disabled="disabled" style="display:none">多个</option>\n  </select>\n  <div class="type radius">\n    <div class="con">\n      <input class="range" type="range" min="0" max="50" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="0" max="50" step="1"/>\n      </div>\n    </div>\n  </div>\n  <div class="type t').concat(qs.MOTION,' angle">\n    <div class="intro">角度</div>\n    <div class="con">\n      <input class="range" type="range" min="-180" max="180" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="-180" max="180" step="1"/>\n        <span class="unit">°</span>\n      </div>\n    </div>\n  </div>\n  <div class="type t').concat(qs.RADIAL,' center">\n    <button disabled="disabled">编辑原点</button>\n  </div>\n  <div class="type t').concat(qs.BACKGROUND,' saturation">\n    <div class="intro">饱和度</div>\n    <div class="con">\n      <input class="range" type="range" min="-100" max="100" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="-100" max="100" step="1"/>\n        <span class="unit">%</span>\n      </div>\n    </div>\n  </div>\n'),wT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="blur-panel",o.style.display="none",o.innerHTML=xT,r.appendChild(o);var a=i.btn=o.querySelector(".btn"),s=i.select=o.querySelector("select"),l=i.radiusRange=o.querySelector(".radius .range"),c=i.radiusNumber=o.querySelector(".radius .number"),u=i.angleRange=o.querySelector(".angle .range"),h=i.angleNumber=o.querySelector(".angle .number"),d=i.saturationRange=o.querySelector(".saturation .range"),f=i.saturationNumber=o.querySelector(".saturation .number"),p=[],v=[],m=[];a.addEventListener("click",(function(){var e=a.classList.contains("add");e?(a.classList.remove("add"),a.classList.add("del")):(a.classList.add("add"),a.classList.remove("del")),p=[],v=[],m=[],i.nodes.forEach((function(t){p.push(t),v.push({blur:t.getCssStyle().blur});var r={blur:"none"};e&&(r.blur=nh(qs.GAUSSIAN,4,0,[.5,.5],1)),m.push(r),t.updateStyle(r)})),i.show(i.nodes),b()})),s.addEventListener("change",(function(){i.silence=!0;var e=parseInt(s.value);o.querySelectorAll("div.t2,div.t3,div.t4").forEach((function(e){e.style.display="none"}));var t=o.querySelector("div.t".concat(e));t&&(t.style.display="block"),p=[],v=[],m=[],i.nodes.forEach((function(t){p.push(t),v.push({blur:t.getCssStyle().blur});var r=t.computedStyle.blur,n={blur:nh(e,r.radius,r.angle,r.center,r.saturation)};m.push(n),t.updateStyle(n)})),n.emit(iT.BLUR_NODE,p.slice(0)),b(),i.show(i.nodes),i.silence=!1}));var g=function(e,t,r){i.silence=!0;var o=e.value,a=parseFloat(o),s=!p.length;s&&(v=[]),m=[],i.nodes.forEach((function(e){s&&(p.push(e),v.push({blur:e.getCssStyle().blur}));var t,n=e.computedStyle.blur;"radius"===r?t={blur:nh(n.t,a,n.angle,n.center,n.saturation)}:"angle"===r?t={blur:nh(n.t,n.radius,a,n.center,n.saturation)}:"saturation"===r&&(t={blur:nh(n.t,n.radius,n.angle,n.center,.01*(a+100))}),m.push(t),e.updateStyle(t)})),"radius"===r?e.style.setProperty("--p",(2*a).toString()):"angle"===r?e.style.setProperty("--p",(100*(a+180)/360).toString()):"saturation"===r&&e.style.setProperty("--p",(.5*(a+100)).toString()),t.value=o,t.placeholder="",p.length&&n.emit(iT.BLUR_NODE,p.slice(0)),i.silence=!1},y=function(e,t,r,o,a,s){i.silence=!0;var l=!p.length;l&&(v=[]),m=[];var c=parseFloat(t.value)||0;if(i.nodes.forEach((function(e,i){var u=e.computedStyle.blur;if(u.t!==qs.NONE){l&&(p.push(e),v.push({blur:e.getCssStyle().blur}));var h=u.radius;"angle"===r?h=u.angle:"saturation"===r&&(h=100*u.saturation-100);var d,f=c;if(o)i||(t.placeholder="");else{var g=0;t.placeholder?(g=f>0?1:-1,n.shiftKey?g*=10:n.altKey&&(g*=.1),f=Math.min(a,Math.max(s,Math.round(h+g))),t.value=""):(g=f-h,n.shiftKey?g*=10:n.altKey&&(g*=.1),f=Math.min(a,Math.max(s,Math.round(h+g))),i||(t.value=f.toString()))}"radius"===r?d={blur:nh(u.t,f,u.angle,u.center,u.saturation)}:"angle"===r?d={blur:nh(u.t,u.radius,f,u.center,u.saturation)}:"saturation"===r&&(d={blur:nh(u.t,u.radius,u.angle,u.center,.01*(f+100))}),m.push(d),e.updateStyle(d)}})),e.value=t.value||"0",!t.placeholder){var u=parseFloat(e.value);"radius"===r?e.style.setProperty("--p",(2*u).toString()):"angle"===r?e.style.setProperty("--p",(100*(u+180)/360).toString()):"saturation"===r&&e.style.setProperty("--p",(.5*(u+100)).toString())}p.length&&n.emit(iT.BLUR_NODE,p.slice(0)),i.silence=!1},b=function(){p.length&&n.history.addCommand(new NC(p,v.map((function(e,t){return{prev:e,next:m[t]}})))),p=[],v=[],m=[]};return l.addEventListener("input",(function(){g(l,c,"radius")})),l.addEventListener("change",b),c.addEventListener("input",(function(e){y(l,c,"radius",e instanceof InputEvent,50,0)})),c.addEventListener("change",b),u.addEventListener("input",(function(){g(u,h,"angle")})),u.addEventListener("change",b),h.addEventListener("input",(function(e){y(u,h,"angle",e instanceof InputEvent,180,-180)})),h.addEventListener("change",b),d.addEventListener("input",(function(){g(d,f,"saturation")})),d.addEventListener("change",b),f.addEventListener("input",(function(e){y(d,f,"saturation",e instanceof InputEvent,100,-100)})),f.addEventListener("change",b),n.on([iT.BLUR_NODE],(function(e){i.silence||i.show(e)})),n.on(iT.STATE_CHANGE,(function(e,t){t!==fC.EDIT_GEOM&&t!==fC.NORMAL||i.show(n.selected)})),i}return v(t,e),t.prototype.show=function(t){e.prototype.show.call(this,t);var r=this.panel;if(t.length&&this.listener.state!==fC.EDIT_GEOM){r.style.display="block";var n=r.querySelector("select"),i=n.querySelector(":disabled"),o=[],a=[],s=[],l=[];if(t.forEach((function(e){var t=e.computedStyle.blur;t.t!==qs.NONE&&(o.includes(t.t)||o.push(t.t),a.includes(t.radius)||a.push(t.radius),void 0===t.angle||s.includes(t.angle)||s.push(t.angle),void 0===t.saturation||l.includes(t.saturation)||l.push(t.saturation))})),r.querySelectorAll("select,div.type").forEach((function(e){e.style.display="none"})),!o.length)return this.btn.classList.remove("del"),void this.btn.classList.add("add");if(this.btn.classList.remove("add"),this.btn.classList.add("del"),this.select.style.display="block",r.querySelector("div.radius").style.display="block",o.length>1)i.style.display="block",n.value=qs.NONE.toString();else{i.style.display="none",n.value=o[0].toString();var c=r.querySelector("div.t".concat(o[0]));c&&(c.style.display="block")}if(a.length>1)this.radiusRange.value="0",this.radiusRange.style.setProperty("--p","0"),this.radiusNumber.value="",this.radiusNumber.placeholder="多个";else{var u=(h=Math.round(a[0]||0)).toString();this.radiusRange.style.setProperty("--p",(2*h).toString()),this.radiusRange.value=u,this.radiusNumber.value=u,this.radiusNumber.placeholder=""}if(s.length>1)this.angleRange.value="0",this.radiusRange.style.setProperty("--p","50"),this.angleNumber.value="",this.angleNumber.placeholder="多个";else{u=(h=Math.round(s[0]||0)).toString();this.angleRange.value=u,this.angleRange.style.setProperty("--p",(100*(h+180)/360).toString()),this.angleNumber.value=u,this.angleNumber.placeholder=""}if(l.length>1)this.saturationRange.value="0",this.saturationRange.style.setProperty("--p","50"),this.saturationNumber.value="",this.saturationNumber.placeholder="多个";else{var h;u=(h=Math.round(100*(l[0]||0)-100)).toString();this.saturationRange.value=u,this.saturationRange.style.setProperty("--p",(.5*(h+100)).toString()),this.saturationNumber.value=u,this.saturationNumber.placeholder=""}}else r.style.display="none"},t}(sT),ET=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="color-adjust-panel",o.style.display="none",o.innerHTML='\n  <div class="panel-title">颜色调整</div>\n  <div class="line hue">\n    <div class="intro">色相</div>\n    <input class="range" type="range" min="-180" max="180" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-180" max="180" step="1"/>\n      <span class="unit">°</span>\n    </div>\n  </div>\n  <div class="line saturate">\n    <div class="intro">饱和度</div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n  <div class="line brightness">\n    <div class="intro">亮度</div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n  <div class="line contrast">\n    <div class="intro">对比度</div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n',r.appendChild(o);var a=i.hueRotateRange=o.querySelector(".hue .range"),s=i.hueRotateNumber=o.querySelector(".hue .number"),l=i.saturateRange=o.querySelector(".saturate .range"),c=i.saturateNumber=o.querySelector(".saturate .number"),u=i.brightnessRange=o.querySelector(".brightness .range"),h=i.brightnessNumber=o.querySelector(".brightness .number"),d=i.contrastRange=o.querySelector(".contrast .range"),f=i.contrastNumber=o.querySelector(".contrast .number"),p=[],v=[],m=[],g=function(e,t,r){i.silence=!0;var o=e.value,a=parseFloat(o),s=!p.length;s&&(v=[]),m=[],i.nodes.forEach((function(e){var t=e.getCssStyle(),n=t.hueRotate,i=t.saturate,o=t.brightness,l=t.contrast;s&&(p.push(e),v.push({hueRotate:n,saturate:i,brightness:o,contrast:l}));var c={hueRotate:"hueRotate"===r?a:n,saturate:"saturate"===r?a+100+"%":i,brightness:"brightness"===r?a+100+"%":o,contrast:"contrast"===r?(a>0?3*a+100:a+100)+"%":l};m.push(c),e.updateStyle(c)})),"hueRotate"===r?e.style.setProperty("--p",(100*(a+180)/360).toString()):("saturate"===r||"brightness"===r||"contrast"===r)&&e.style.setProperty("--p",(.5*(a+100)).toString()),t.value=o,t.placeholder="",p.length&&n.emit(iT.COLOR_ADJUST_NODE,p.slice(0)),i.silence=!1},y=function(e,t,r,o,a,s){i.silence=!0;var l=!p.length;l&&(v=[]),m=[];var c=parseFloat(t.value)||0;if(i.nodes.forEach((function(e,i){var u=e.getCssStyle(),h=u.hueRotate,d=u.saturate,f=u.brightness,g=u.contrast;l&&(p.push(e),v.push({hueRotate:h,saturate:d,brightness:f,contrast:g}));var y=e.computedStyle,b=0;"hueRotate"===r?b=y.hueRotate:"saturate"===r?b=100*y.saturate-100:"brightness"===r?b=100*y.brightness-100:"contrast"===r&&(b=100*y.contrast-100)>0&&(b/=3);var x=c;if(o)i||(t.placeholder="");else{var w=0;t.placeholder?(w=x>0?1:-1,n.shiftKey&&(w*=10),x=Math.min(a,Math.max(s,Math.round(b+w))),t.value=""):(w=x-b,n.shiftKey&&(w*=10),x=Math.min(a,Math.max(s,Math.round(b+w))),i||(t.value=x.toString()))}var E={hueRotate:"hueRotate"===r?x:h,saturate:"saturate"===r?x+100+"%":d,brightness:"brightness"===r?x+100+"%":f,contrast:"contrast"===r?(x>0?3*x+100:x+100)+"%":g};m.push(E),e.updateStyle(E)})),e.value=t.value||"0",!t.placeholder){var u=parseFloat(e.value);"hueRotate"===r?e.style.setProperty("--p",(100*(u+180)/360).toString()):("saturate"===r||"brightness"===r||"contrast"===r)&&e.style.setProperty("--p",(.5*(u+100)).toString())}p.length&&n.emit(iT.COLOR_ADJUST_NODE,p.slice(0)),i.silence=!1},b=function(){p.length&&n.history.addCommand(new BC(p,v.map((function(e,t){return{prev:e,next:m[t]}})))),p=[],v=[],m=[]};return a.addEventListener("input",(function(){g(a,s,"hueRotate")})),a.addEventListener("change",b),s.addEventListener("input",(function(e){y(a,s,"hueRotate",e instanceof InputEvent,180,-180)})),s.addEventListener("change",b),l.addEventListener("input",(function(){g(l,c,"saturate")})),l.addEventListener("change",b),c.addEventListener("input",(function(e){y(l,c,"saturate",e instanceof InputEvent,100,-100)})),c.addEventListener("change",b),u.addEventListener("input",(function(){g(u,h,"brightness")})),u.addEventListener("change",b),h.addEventListener("input",(function(e){y(u,h,"brightness",e instanceof InputEvent,100,-100)})),h.addEventListener("change",b),d.addEventListener("input",(function(){g(d,f,"contrast")})),d.addEventListener("change",b),f.addEventListener("input",(function(e){y(d,f,"contrast",e instanceof InputEvent,100,-100)})),f.addEventListener("change",b),n.on([iT.COLOR_ADJUST_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){if(e[n]instanceof Uw){r=!0;break}}if(r){t.style.display="block";var o=[],a=[],s=[],l=[];if(this.nodes=e.filter((function(e){return e instanceof Uw})),this.nodes.forEach((function(e){var t=e.computedStyle,r=t.hueRotate,n=t.saturate,i=t.brightness,c=t.contrast;o.includes(r)||o.push(r),a.includes(n)||a.push(n),s.includes(i)||s.push(i),l.includes(c)||l.push(c)})),o.length>1)this.hueRotateRange.value="0",this.hueRotateRange.style.setProperty("--p","50"),this.hueRotateNumber.value="",this.hueRotateNumber.placeholder="多个";else{var c=(u=Math.round(o[0]||0)).toString();this.hueRotateRange.value=c,this.hueRotateRange.style.setProperty("--p",(100*(u+180)/360).toString()),this.hueRotateNumber.value=c,this.hueRotateNumber.placeholder=""}if(a.length>1)this.saturateRange.value="0",this.saturateRange.style.setProperty("--p","50"),this.saturateNumber.value="",this.saturateNumber.placeholder="多个";else{c=(u=Math.round(100*(a[0]||0)-100)).toString();this.saturateRange.value=c,this.saturateRange.style.setProperty("--p",(.5*(u+100)).toString()),this.saturateNumber.value=c,this.saturateNumber.placeholder=""}if(s.length>1)this.brightnessRange.value="0",this.brightnessRange.style.setProperty("--p","50"),this.brightnessNumber.value="",this.brightnessNumber.placeholder="多个";else{c=(u=Math.round(100*(s[0]||0)-100)).toString();this.brightnessRange.value=c,this.brightnessRange.style.setProperty("--p",(.5*(u+100)).toString()),this.brightnessNumber.value=c,this.brightnessNumber.placeholder=""}if(l.length>1)this.contrastRange.value="0",this.contrastRange.style.setProperty("--p","50"),this.contrastNumber.value="",this.contrastNumber.placeholder="多个";else{var u=100*(l[0]||0)-100;c=Math.round(u>0?u/3:u).toString();this.contrastRange.value=c,u>0?this.contrastRange.style.setProperty("--p",(u/3*.5+50).toString()):this.contrastRange.style.setProperty("--p",(.5*(u+100)).toString()),this.contrastNumber.value=c,this.contrastNumber.placeholder=""}}else t.style.display="none"},t}(sT),_T=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=document.createElement("select");n.innerHTML='\n      <option value="" disabled="disabled">请选择</option>\n      <option value="up">放大</option>\n      <option value="down">缩小</option>\n      <option value="actual">实际尺寸</option>\n      <option value="fit">适应画布</option>\n    ',n.selectedIndex=-1,t.appendChild(n);var i=document.createElement("div");i.innerText=Lu(100*e.getCurPageZoom(!0),0).toString()+"%",t.appendChild(i),n.addEventListener("change",(function(e){"up"===n.value?r.zoom(2):"down"===n.value?r.zoom(.5):"actual"===n.value?r.zoomActual():"fit"===n.value&&r.zoomFit(),n.value=""})),r.on(iT.ZOOM_PAGE,(function(e){i.innerText=Lu(100*e,0).toString()+"%"}))},ST=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=document.createElement("div");n.className="sel item active",n.innerHTML='\n<div class="ti" title="select"><b class="select"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="select" class="cur"><b class="select"></b><span class="name">选择</span><span class="key">V</span></li>\n  <li title="hand"><b class="hand"></b><span class="name">平移画布</span><span class="key">H</span></li>\n</ul>\n',t.appendChild(n);var i=document.createElement("div");i.className="geom item",i.innerHTML='\n<div class="ti" title="square"><b class="square"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="square"><b class="square"></b><span class="name">矩形</span><span class="key">R</span></li>\n  <li title="ellipse"><b class="ellipse"></b><span class="name">椭圆形</span><span class="key">O</span></li>\n  <li title="line"><b class="line"></b><span class="name">直线</span><span class="key">L</span></li>\n  <li title="arrow"><b class="arrow"></b><span class="name">箭头</span></li>\n  <li title="star"><b class="star"></b><span class="name">星形</span></li>\n  <li class="split"></li>\n  <li title="pen"><b class="pen"></b><span class="name">钢笔</span><span class="key">P</span></li>\n</ul>\n',t.appendChild(i);var o=document.createElement("div");o.className="text item",o.innerHTML='<div class="ti" title="text"><b class="text"></b></div>',t.appendChild(o);var a=document.createElement("div");a.className="img item",a.innerHTML='<div class="ti" title="image"><b class="image"></b></div>',t.appendChild(a);var s=document.createElement("div");s.className="mask item",s.innerHTML='\n<div class="ti disable" title="alpha"><b class="alpha"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="alpha" class="disable"><b class="alpha"></b><span class="name">透明度蒙版</span><span class="key">⌃</span><span class="key">⌘</span><span class="key">M</span></li>\n  <li title="outline" class="disable"><b class="outline"></b><span class="name">轮廓蒙版</span></li>\n</ul>\n',t.appendChild(s);var l=document.createElement("div");l.className="bool item",l.innerHTML='\n<div class="ti" title="union"><b class="union"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="union"><b class="union"></b><span class="name">联集</span></li>\n  <li title="subtract"><b class="subtract"></b><span class="name">减去顶层</span></li>\n  <li title="intersect"><b class="intersect"></b><span class="name">交集</span></li>\n  <li title="xor"><b class="xor"></b><span class="name">差集</span></li>\n  <li class="split"></li>\n  <li title="flatten"><b class="flatten"></b><span class="name">拼合</span></li>\n</ul>\n',t.appendChild(l);var c=!1;t.addEventListener("click",(function(e){var n,i,o,a=e.target,s=a.tagName.toUpperCase(),l=a.classList;if(l.contains("drop"))return(h=a.parentElement).classList.contains("show")?h.classList.remove("show"):(null===(n=t.querySelector(".show"))||void 0===n||n.classList.remove("show"),h.classList.add("show")),void(c=!0);if(l.contains("name")||l.contains("key")?(s="LI",l=(a=a.parentElement).classList):"B"===s&&(s=(a=a.parentElement).tagName.toUpperCase(),l=a.classList),!("DIV"===s&&a.parentElement.classList.contains("active")||l.contains("cur")))if(l.contains("disable")||a.parentElement.classList.contains("disable"))c=!0;else{l.contains("item")&&(s=(a=a.querySelector("div")).tagName.toUpperCase(),l=a.classList);var u="";if(null===(i=t.querySelector(".active"))||void 0===i||i.classList.remove("active"),null===(o=t.querySelector(".cur"))||void 0===o||o.classList.remove("cur"),"DIV"===s)(h=a.parentElement).classList.add("active"),u=a.title;else if("LI"===s){var h;l.add("cur"),(h=a.parentElement.parentElement).classList.add("active"),u=a.title;var d=h.querySelector(".ti");d.title=u,d.querySelector("b").className=u}if(console.log(u),r.dom.classList.remove("hand"),r.dom.classList.remove("text"),"select"===u)r.state=fC.NORMAL;else if("hand"===u)r.state=fC.HAND,r.dom.classList.add("hand");else if("text"===u){var f=r.state;r.state=fC.ADD_TEXT,r.dom.classList.add("text"),r.emit(iT.STATE_CHANGE,f,r.state)}}})),document.addEventListener("click",(function(e){var r;c?c=!1:null===(r=t.querySelector(".show"))||void 0===r||r.classList.remove("show")})),r.on(iT.STATE_CHANGE,(function(e,r){var n,i,o;r===fC.NORMAL&&(null===(n=t.querySelector(".active"))||void 0===n||n.classList.remove("active"),null===(i=t.querySelector(".sel.item"))||void 0===i||i.classList.add("active"),null===(o=t.querySelector('.sel.item li[title="select"]'))||void 0===o||o.classList.add("cur"))}))};var CT={initCanvasControl:function(e,t,r){return new iT(e,t,r)},initPageList:function(e,t,r){return new yT(e,t,r)},initTree:function(e,t,r){return new aT(e,t,r)},initPanel:function(e,t,r){var n=new gT(e,t,r);n.show(r.selected);var i=new cT(e,t,r);i.show(r.selected);var o=new uT(e,t,r);o.show(r.selected),new hT(e,t,r).show();var a=new dT(e,t,r);a.show(r.selected);var s=new fT(e,t,r);s.show(r.selected);var l=new vT(e,t,r);l.show(r.selected);var c=new bT(e,t,r);c.show(r.selected);var u=new wT(e,t,r);u.show(r.selected);var h=new ET(e,t,r);return h.show(r.selected),{alignPanel:n,basicPanel:i,opacityPanel:o,fillPanel:a,strokePanel:s,textPanel:l,shadowPanel:c,blurPanel:u,colorAdjustPanel:h}},initZoom:function(e,t,r){return new _T(e,t,r)},initToolbar:function(e,t,r){return new ST(e,t,r)},Listener:iT,PageList:yT,Tree:aT,Select:aC,Input:mC,Panel:sT,BasicPanel:cT,OpacityPanel:uT,PointPanel:hT,FillPanel:dT,StrokePanel:fT,TextPanel:vT,ShadowPanel:bT,BlurPanel:wT,AlignPanel:gT,ColorAdjustPanel:ET,Zoom:_T,picker:yC,contextMenu:CC,Guides:VC,state:fC},TT=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.prevs=r,i.nexts=n,i}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.nexts;e.forEach((function(e,r){e.updateFormatStyle(t[r])}))},t.prototype.undo=function(){var e=this.nodes,t=this.prevs;e.forEach((function(e,r){e.updateFormatStyle(t[r])}))},t}(pC),AT={ca:KE},kT={version:xC,parse:function(e,t){var r,n,i,o;void 0===t&&(t={});var a=t.width,c=void 0===a?0:a,u=t.height,h=void 0===u?0:u,d=t.dpi,f=void 0===d?1:d,p=t.canvas,v={width:c,height:h};(!c||c<1)&&(v.width="auto"),(!h||h<1)&&(v.height="auto");var m=new RS.Root({dpi:f,uuid:(null===(r=e.document)||void 0===r?void 0:r.uuid)||s(),index:0,assets:null===(n=e.document)||void 0===n?void 0:n.assets,layerStyles:null===(i=e.document)||void 0===i?void 0:i.layerStyles,layerTextStyles:null===(o=e.document)||void 0===o?void 0:o.layerTextStyles,style:v,contextAttributes:Object.assign({},AT.ca,t.contextAttributes)});p&&m.appendTo(p);var g=[];return(e.pages||[]).forEach((function(e){e.children.forEach((function(e){e.tagName===l.SYMBOL_MASTER&&g.push(e)}))})),(e.symbolMasters||[]).forEach((function(e){g.push(e)})),F_(g).forEach((function(e){m.symbolMasters[e.props.symbolId]=P_(e,m)})),m.setJPages(e.pages||[]),m.setPageIndex(e.currentPageIndex||0),m},openAndConvertSketchBuffer:function(e){return J(this,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return[4,ms.loadAsync(e)];case 1:return[2,uh(t.sent())]}}))}))},openAndConvertSketchZip:uh,convertSketch:dh,openAndConvertPsdBuffer:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,h,d,f,p,v,m;return Q(this,(function(g){switch(g.label){case 0:if(t=function(e,t){return gy("buffer"in e?Wg(e.buffer,e.byteOffset,e.byteLength):Wg(e),t)}(e,{useImageData:!1}),r=[],n={tagName:l.ART_BOARD,props:{uuid:s(),name:"画板",style:{width:t.width,height:t.height},isExpanded:!0},children:r},i={tagName:l.PAGE,props:{uuid:s(),name:"页面 1",index:0,rule:{baseX:0,baseY:0},style:{width:c,height:u,visibility:"hidden",scaleX:.5,scaleY:.5,transformOrigin:[0,0],pointerEvents:!1}},children:[n]},!t.children)return[3,7];o=0,a=t.children.length,g.label=1;case 1:return o<a?[4,Bx(h=t.children[o],t.width,t.height)]:[3,6];case 2:return(d=g.sent())?h.mask?[4,Ux(h,t.width,t.height)]:[3,4]:[3,5];case 3:(v=g.sent())&&(d=zx(d,v)),h.clipping||(d.props.style.breakMask=!0),g.label=4;case 4:if(h.clipping&&r.length)for(f=o-1;f>=0;f--)if(!t.children[f].clipping){p=o-f,(v=r[r.length-p]).props.style.maskMode="alpha-with";break}r.push(d),g.label=5;case 5:return o++,[3,1];case 6:return[3,9];case 7:return t.canvas?[4,new Promise((function(e){t.canvas.toBlob((function(t){if(t)return e({tagName:l.BITMAP,props:{uuid:s(),name:"截图",style:{left:"0%",top:"0%",right:"0%",bottom:"0%"},src:URL.createObjectURL(t)}});e(void 0)}))}))]:[3,9];case 8:(m=g.sent())&&r.push(m),g.label=9;case 9:return[2,{pages:[i],currentPageIndex:0}]}}))}))},node:RS,refresh:ww,style:Ew,math:Ru,util:Sw,animation:Aw,tools:oC,config:bs,control:CT,history:{History:LC,AbstractCommand:pC,MoveCommand:TC,ResizeCommand:kC,AddCommand:ZC,RemoveCommand:RC,RotateCommand:IC,BlurCommand:NC,ShadowCommand:DC,ColorAdjustCommand:BC,FillCommand:UC,MaskModeCommand:XC,BreakMaskCommand:HC,VisibleCommand:qC,UpdateStyleCommand:AC,UpdateFormatStyleCommand:TT,RichCommand:OC,TextCommand:vC,GroupCommand:GC,UnGroupCommand:jC,RenameCommand:YC,LockCommand:WC,ConstrainProportionCommand:lT,PointCommand:eT},gl:AT,format:f};return kT}));
//# sourceMappingURL=index.min.js.map
