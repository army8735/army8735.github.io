!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("stream")):"function"==typeof define&&define.amd?define(["stream"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).sketchEditor=t(e.require$$0)}(this,(function(e){"use strict";let t;const r=new Uint8Array(16);function n(){if(!t&&(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!t))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(r)}const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));var o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function a(e,t,r){if(o.randomUUID&&!e)return o.randomUUID();const a=(e=e||{}).random||(e.rng||n)();return a[6]=15&a[6]|64,a[8]=63&a[8]|128,function(e,t=0){return i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]}(a)}var s,l=100,c=100,u={left:0,top:0,right:"auto",bottom:"auto",width:"auto",height:"auto",lineHeight:"normal",fontFamily:"arial",fontSize:16,fontWeight:400,fontStyle:"normal",visibility:"visible",backgroundColor:[0,0,0,0],color:[0,0,0,1],opacity:1,fill:[],fillOpacity:[],fillEnable:[],fillMode:[],fillRule:"nonzero",stroke:[],strokeEnable:[],strokeWidth:[],strokePosition:[],strokeMode:[],strokeDasharray:[],strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:0,letterSpacing:0,paragraphSpacing:0,textAlign:"left",textVerticalAlign:"top",textDecoration:[],translateX:0,translateY:0,scaleX:1,scaleY:1,rotateZ:0,transformOrigin:["center","center"],booleanOperation:"none",mixBlendMode:"normal",pointerEvents:!0,maskMode:"none",breakMask:!1,blur:"none",shadow:[],shadowEnable:[],innerShadow:[],innerShadowEnable:[],hueRotate:0,saturate:1,brightness:1,contrast:1};function h(e){return Object.assign({},u,e)}!function(e){e.PAGE="page",e.ART_BOARD="artBoard",e.SYMBOL_MASTER="symbolMaster",e.SYMBOL_INSTANCE="symbolInstance",e.GROUP="group",e.BITMAP="bitmap",e.TEXT="text",e.SLICE="slice",e.SHAPE_GROUP="$shapeGroup",e.POLYLINE="$polyline"}(s||(s={}));var d={TAG_NAME:s,getDefaultStyle:h},f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},f(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var v,y,g,m,b,x,E,w,S,_,C,A,T,O,M,k,L,R,I,P,F,D,N,B,U,z,G,X,H,j,W,Y,q,V,K=function(){return K=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},K.apply(this,arguments)};function Z(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function J(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function $(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError,function(e){e[e.Linear=0]="Linear",e[e.Radial=1]="Radial",e[e.Angular=2]="Angular"}(v||(v={})),function(e){e[e.Unmanaged=0]="Unmanaged",e[e.SRGB=1]="SRGB",e[e.P3=2]="P3"}(y||(y={})),function(e){e[e.Color=0]="Color",e[e.Gradient=1]="Gradient",e[e.Pattern=4]="Pattern"}(g||(g={})),function(e){e[e.Center=0]="Center",e[e.Inside=1]="Inside",e[e.Outside=2]="Outside"}(m||(m={})),function(e){e[e.Normal=0]="Normal",e[e.Darken=1]="Darken",e[e.Multiply=2]="Multiply",e[e.ColorBurn=3]="ColorBurn",e[e.Lighten=4]="Lighten",e[e.Screen=5]="Screen",e[e.ColorDodge=6]="ColorDodge",e[e.Overlay=7]="Overlay",e[e.SoftLight=8]="SoftLight",e[e.HardLight=9]="HardLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e[e.PlusDarker=16]="PlusDarker",e[e.PlusLighter=17]="PlusLighter"}(b||(b={})),function(e){e[e.Butt=0]="Butt",e[e.Round=1]="Round",e[e.Projecting=2]="Projecting"}(x||(x={})),function(e){e[e.Miter=0]="Miter",e[e.Round=1]="Round",e[e.Bevel=2]="Bevel"}(E||(E={})),function(e){e[e.Gaussian=0]="Gaussian",e[e.Motion=1]="Motion",e[e.Zoom=2]="Zoom",e[e.Background=3]="Background"}(w||(w={})),function(e){e[e.Tile=0]="Tile",e[e.Fill=1]="Fill",e[e.Stretch=2]="Stretch",e[e.Fit=3]="Fit"}(S||(S={})),function(e){e[e.OpenArrow=0]="OpenArrow",e[e.FilledArrow=1]="FilledArrow",e[e.Line=2]="Line",e[e.OpenCircle=3]="OpenCircle",e[e.FilledCircle=4]="FilledCircle",e[e.OpenSquare=5]="OpenSquare",e[e.FilledSquare=6]="FilledSquare"}(_||(_={})),function(e){e[e.NonZero=0]="NonZero",e[e.EvenOdd=1]="EvenOdd"}(C||(C={})),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(A||(A={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Centered=2]="Centered",e[e.Justified=3]="Justified",e[e.Natural=4]="Natural"}(T||(T={})),function(e){e[e.None=0]="None",e[e.Uppercase=1]="Uppercase",e[e.Lowercase=2]="Lowercase"}(O||(O={})),function(e){e[e.None=0]="None",e[e.Underlined=1]="Underlined"}(M||(M={})),function(e){e[e.None=0]="None",e[e.Strikethrough=1]="Strikethrough"}(k||(k={})),function(e){e[e.None=-1]="None",e[e.Union=0]="Union",e[e.Subtract=1]="Subtract",e[e.Intersection=2]="Intersection",e[e.Difference=3]="Difference"}(L||(L={})),function(e){e.PNG="png",e.JPG="jpg",e.TIFF="tiff",e.EPS="eps",e.PDF="pdf",e.WEBP="webp",e.SVG="svg"}(R||(R={})),function(e){e[e.Suffix=0]="Suffix",e[e.SecondaryPrefix=1]="SecondaryPrefix",e[e.PrimaryPrefix=2]="PrimaryPrefix"}(I||(I={})),function(e){e[e.Scale=0]="Scale",e[e.Width=1]="Width",e[e.Height=2]="Height"}(P||(P={})),function(e){e[e.None=0]="None",e[e.SlideFromLeft=1]="SlideFromLeft",e[e.SlideFromRight=2]="SlideFromRight",e[e.SlideFromBottom=3]="SlideFromBottom",e[e.SlideFromTop=4]="SlideFromTop"}(F||(F={})),function(e){e[e.Undecided=0]="Undecided",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"}(D||(D={})),function(e){e[e.Stretch=0]="Stretch",e[e.PinToEdge=1]="PinToEdge",e[e.Resize=2]="Resize",e[e.Float=3]="Float"}(N||(N={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(B||(B={})),function(e){e[e.Min=0]="Min",e[e.Middle=1]="Middle",e[e.Max=2]="Max"}(U||(U={})),function(e){e[e.Disabled=-1]="Disabled",e[e.Legacy=0]="Legacy",e[e.Rounded=1]="Rounded",e[e.Smooth=2]="Smooth"}(z||(z={})),function(e){e[e.Rounded=0]="Rounded",e[e.RoundedInverted=1]="RoundedInverted",e[e.Angled=2]="Angled",e[e.Squared=3]="Squared"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Straight=1]="Straight",e[e.Mirrored=2]="Mirrored",e[e.Asymmetric=3]="Asymmetric",e[e.Disconnected=4]="Disconnected"}(X||(X={})),function(e){e[e.None=0]="None",e[e.Legacy=1]="Legacy",e[e.ConsistentBaseline=2]="ConsistentBaseline"}(H||(H={})),function(e){e[e.Flexible=0]="Flexible",e[e.Fixed=1]="Fixed",e[e.FixedWidthAndHeight=2]="FixedWidthAndHeight"}(j||(j={})),function(e){e[e.Local=0]="Local",e[e.Workspace=1]="Workspace",e[e.ThirdParty=2]="ThirdParty"}(W||(W={})),function(e){e.PublicRelease="com.bohemiancoding.sketch3",e.Beta="com.bohemiancoding.sketch3.beta",e.Private="com.bohemiancoding.sketch3.private",e.FeaturePreview="com.bohemiancoding.sketch3.feature-preview",e.Internal="com.bohemiancoding.sketch3.internal",e.Experimental="com.bohemiancoding.sketch3.experimental",e.Testing="com.bohemiancoding.sketch3.testing"}(Y||(Y={})),function(e){e[e.True=0]="True",e[e.False=1]="False"}(q||(q={})),function(e){e.MSImmutableColorAsset="MSImmutableColorAsset",e.MSImmutableDocumentLibraryInfo="MSImmutableDocumentLibraryInfo",e.MSImmutableFlowConnection="MSImmutableFlowConnection",e.MSImmutableForeignLayerStyle="MSImmutableForeignLayerStyle",e.MSImmutableForeignSwatch="MSImmutableForeignSwatch",e.MSImmutableForeignSymbol="MSImmutableForeignSymbol",e.MSImmutableForeignTextStyle="MSImmutableForeignTextStyle",e.MSImmutableFreeformGroupLayout="MSImmutableFreeformGroupLayout",e.MSImmutableGradientAsset="MSImmutableGradientAsset",e.MSImmutableHotspotLayer="MSImmutableHotspotLayer",e.MSImmutableInferredGroupLayout="MSImmutableInferredGroupLayout",e.MSImmutableOverrideProperty="MSImmutableOverrideProperty",e.MSImmutablePatchInfo="MSImmutablePatchInfo",e.MSImmutablePrototypeViewport="MSImmutablePrototypeViewport",e.MSJSONFileReference="MSJSONFileReference",e.MSJSONOriginalDataReference="MSJSONOriginalDataReference",e.Artboard="artboard",e.AssetCollection="assetCollection",e.AttributedString="attributedString",e.Bitmap="bitmap",e.Blur="blur",e.Border="border",e.BorderOptions="borderOptions",e.Color="color",e.ColorControls="colorControls",e.CurvePoint="curvePoint",e.ExportFormat="exportFormat",e.ExportOptions="exportOptions",e.Fill="fill",e.FontDescriptor="fontDescriptor",e.FontReference="fontReference",e.Gradient="gradient",e.GradientStop="gradientStop",e.GraphicsContextSettings="graphicsContextSettings",e.Group="group",e.ImageCollection="imageCollection",e.InnerShadow="innerShadow",e.LayoutGrid="layoutGrid",e.Oval="oval",e.OverrideValue="overrideValue",e.Page="page",e.ParagraphStyle="paragraphStyle",e.Polygon="polygon",e.Rect="rect",e.Rectangle="rectangle",e.RulerData="rulerData",e.Shadow="shadow",e.ShapeGroup="shapeGroup",e.ShapePath="shapePath",e.SharedStyle="sharedStyle",e.SharedStyleContainer="sharedStyleContainer",e.SharedTextStyleContainer="sharedTextStyleContainer",e.SimpleGrid="simpleGrid",e.Slice="slice",e.Star="star",e.StringAttribute="stringAttribute",e.Style="style",e.Swatch="swatch",e.SwatchContainer="swatchContainer",e.SymbolContainer="symbolContainer",e.SymbolInstance="symbolInstance",e.SymbolMaster="symbolMaster",e.Text="text",e.TextStyle="textStyle",e.Triangle="triangle"}(V||(V={}));var Q=Object.freeze({__proto__:null,get AnimationType(){return F},get BlendMode(){return b},get BlurType(){return w},get BooleanOperation(){return L},get BorderPosition(){return m},get BundleId(){return Y},get ClassValue(){return V},get ColorSpace(){return y},get CornerStyle(){return G},get CurveMode(){return X},get DocumentLibraryType(){return W},get ExportFileFormat(){return R},get ExportFormatNamingScheme(){return I},get FillType(){return g},get GradientType(){return v},get InferredLayoutAnchor(){return U},get InferredLayoutAxis(){return B},get LayerListExpanded(){return D},get LineCapStyle(){return x},get LineJoinStyle(){return E},get LineSpacingBehaviour(){return H},get MarkerType(){return _},get NumericalBool(){return q},get PatternFillType(){return S},get PointsRadiusBehaviour(){return z},get ResizeType(){return N},get StrikethroughStyle(){return k},get TextBehaviour(){return j},get TextHorizontalAlignment(){return T},get TextTransform(){return O},get TextVerticalAlignment(){return A},get UnderlineStyle(){return M},get VisibleScaleType(){return P},get WindingRule(){return C}}),ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function te(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var re,ne,ie,oe={},ae={},se={},le={exports:{}},ce={exports:{}};function ue(){if(re)return ce.exports;return re=1,"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?ce.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,a=arguments.length;switch(a){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function(){e.call(null,t)}));case 3:return process.nextTick((function(){e.call(null,t,r)}));case 4:return process.nextTick((function(){e.call(null,t,r,n)}));default:for(i=new Array(a-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick((function(){e.apply(null,i)}))}}}:ce.exports=process,ce.exports}var he,de,fe,pe={exports:{}};function ve(){if(he)return pe.exports;he=1;var e,t="object"==typeof Reflect?Reflect:null,r=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}pe.exports=i,pe.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}p(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,r)}(e,i,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,o,l,c;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),l=o[t]),void 0===l)l=o[t]=r,++e._eventsCount;else if("function"==typeof l?l=o[t]=n?[r,l]:[l,r]:n?l.unshift(r):l.push(r),(i=s(e))>0&&l.length>i&&!l.warned){l.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=l.length,c=u,console&&console.warn&&console.warn(c)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=c.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)r(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},pe.exports}function ye(){return fe?de:(fe=1,de=e)}for(var ge={exports:{}},me={},be={byteLength:function(e){var t=Te(e),r=t[0],n=t[1];return 3*(r+n)/4-n}},xe=be.toByteArray=function(e){var t,r,n=Te(e),i=n[0],o=n[1],a=new _e(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=Se[e.charCodeAt(r)]<<18|Se[e.charCodeAt(r+1)]<<12|Se[e.charCodeAt(r+2)]<<6|Se[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=Se[e.charCodeAt(r)]<<2|Se[e.charCodeAt(r+1)]>>4,a[s++]=255&t);1===o&&(t=Se[e.charCodeAt(r)]<<10|Se[e.charCodeAt(r+1)]<<4|Se[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},Ee=be.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(Oe(e,a,a+o>s?s:a+o));1===n?(t=e[r-1],i.push(we[t>>2]+we[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(we[t>>10]+we[t>>4&63]+we[t<<2&63]+"="));return i.join("")},we=[],Se=[],_e="undefined"!=typeof Uint8Array?Uint8Array:Array,Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=0;Ae<64;++Ae)we[Ae]=Ce[Ae],Se[Ce.charCodeAt(Ae)]=Ae;function Te(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Oe(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(we[(i=n)>>18&63]+we[i>>12&63]+we[i>>6&63]+we[63&i]);return o.join("")}Se["-".charCodeAt(0)]=62,Se["_".charCodeAt(0)]=63;var Me,ke,Le,Re={};
  /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ie(){return ke||(ke=1,function(e){var t=be,r=(Me||(Me=1,Re.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=c}return(f?-1:1)*a*Math.pow(2,o-n)},Re.write=function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+f]=255&a,f+=p,a/=256,c-=8);e[r+f-p]|=128*v}),Re),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|f(e,t),n=o(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(U(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(U(e,ArrayBuffer)||e&&U(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(U(e,SharedArrayBuffer)||e&&U(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=function(e){if(a.isBuffer(e)){var t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||z(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),o(e<0?0:0|d(e))}function u(e){for(var t=e.length<0?0:0|d(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,a.prototype),n}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||U(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(i)return n?-1:D(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function m(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(z(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return B(D(t,e.length-r),e,r,n)}function x(e,t,r,n){return B(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return B(N(t),e,r,n)}function w(e,t,r,n){return B(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function S(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function _(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,c=e[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),U(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(U(o,Uint8Array))i+o.length>n.length?a.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),l=Math.min(o,s),c=this.slice(n,i),u=e.slice(t,r),h=0;h<l;++h)if(c[h]!==u[h]){o=c[h],s=u[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return m(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return x(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function O(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=G[e[o]];return i}function M(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function k(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(e,t,n,i,o){return t=+t,n>>>=0,o||R(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function P(e,t,n,i,o){return t=+t,n>>>=0,o||R(e,0,n,8),r.write(e,t,n,i,52,8),n+8}a.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||k(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||k(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||k(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||k(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||k(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||k(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||k(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||k(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||k(e,8,this.length),r.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%l]}return this};var F=/[^+/0-9A-Za-z-_]/g;function D(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function N(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function U(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function z(e){return e!=e}var G=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()}(me)),me}function Pe(){return Le||(Le=1,function(e,t){var r=Ie(),n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(ge,ge.exports)),ge.exports}var Fe,De={};function Ne(){if(Fe)return De;function e(e){return Object.prototype.toString.call(e)}return Fe=1,De.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},De.isBoolean=function(e){return"boolean"==typeof e},De.isNull=function(e){return null===e},De.isNullOrUndefined=function(e){return null==e},De.isNumber=function(e){return"number"==typeof e},De.isString=function(e){return"string"==typeof e},De.isSymbol=function(e){return"symbol"==typeof e},De.isUndefined=function(e){return void 0===e},De.isRegExp=function(t){return"[object RegExp]"===e(t)},De.isObject=function(e){return"object"==typeof e&&null!==e},De.isDate=function(t){return"[object Date]"===e(t)},De.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},De.isFunction=function(e){return"function"==typeof e},De.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},De.isBuffer=Ie().Buffer.isBuffer,De}var Be,Ue,ze,Ge,Xe,He,je,We,Ye,qe,Ve,Ke,Ze,Je,$e,Qe,et,tt,rt,nt,it,ot,at,st,lt,ct,ut,ht,dt,ft,pt,vt,yt,gt,mt,bt,xt,Et,wt,St,_t,Ct,At,Tt,Ot,Mt,kt,Lt,Rt,It,Pt,Ft,Dt,Nt,Bt,Ut,zt,Gt,Xt,Ht,jt,Wt,Yt,qt,Vt,Kt,Zt,Jt,$t,Qt,er,tr,rr,nr,ir,or,ar,sr,lr,cr,ur,hr,dr,fr,pr,vr,yr,gr,mr,br,xr={exports:{}},Er={},wr={};function Sr(){return Ue?Be:(Ue=1,Be=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0})}function _r(){if(Ge)return ze;Ge=1;var e=Sr();return ze=function(){return e()&&!!Symbol.toStringTag}}function Cr(){return He?Xe:(He=1,Xe=Object)}function Ar(){return We?je:(We=1,je=Error)}function Tr(){return qe?Ye:(qe=1,Ye=EvalError)}function Or(){return Ke?Ve:(Ke=1,Ve=RangeError)}function Mr(){return Je?Ze:(Je=1,Ze=ReferenceError)}function kr(){return Qe?$e:(Qe=1,$e=SyntaxError)}function Lr(){return tt?et:(tt=1,et=TypeError)}function Rr(){return nt?rt:(nt=1,rt=URIError)}function Ir(){return ot?it:(ot=1,it=Math.abs)}function Pr(){return st?at:(st=1,at=Math.floor)}function Fr(){return ht?ut:(ht=1,ut=Math.min)}function Dr(){return ft?dt:(ft=1,dt=Math.pow)}function Nr(){return vt?pt:(vt=1,pt=Math.round)}function Br(){if(bt)return mt;bt=1;var e=gt?yt:(gt=1,yt=Number.isNaN||function(e){return e!=e});return mt=function(t){return e(t)||0===t?t:t<0?-1:1}}function Ur(){if(St)return wt;St=1;var e=Et?xt:(Et=1,xt=Object.getOwnPropertyDescriptor);if(e)try{e([],"length")}catch(t){e=null}return wt=e}function zr(){if(Ct)return _t;Ct=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch(t){e=!1}return _t=e}function Gr(){if(Mt)return Ot;Mt=1;var e="undefined"!=typeof Symbol&&Symbol,t=Tt?At:(Tt=1,At=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(var n in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0});return Ot=function(){return"function"==typeof e&&("function"==typeof Symbol&&("symbol"==typeof e("foo")&&("symbol"==typeof Symbol("bar")&&t())))}}function Xr(){return Lt?kt:(Lt=1,kt="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null)}function Hr(){if(It)return Rt;It=1;var e=Cr();return Rt=e.getPrototypeOf||null}function jr(){if(Ft)return Pt;Ft=1;var e=Object.prototype.toString,t=Math.max,r=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r};return Pt=function(n){var i=this;if("function"!=typeof i||"[object Function]"!==e.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,a=function(e,t){for(var r=[],n=t,i=0;n<e.length;n+=1,i+=1)r[i]=e[n];return r}(arguments,1),s=t(0,i.length-a.length),l=[],c=0;c<s;c++)l[c]="$"+c;if(o=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r}(l,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var e=i.apply(this,r(a,arguments));return Object(e)===e?e:this}return i.apply(n,r(a,arguments))})),i.prototype){var u=function(){};u.prototype=i.prototype,o.prototype=new u,u.prototype=null}return o},Pt}function Wr(){if(Nt)return Dt;Nt=1;var e=jr();return Dt=Function.prototype.bind||e}function Yr(){return Ut?Bt:(Ut=1,Bt=Function.prototype.call)}function qr(){return Gt?zt:(Gt=1,zt=Function.prototype.apply)}function Vr(){if(Wt)return jt;Wt=1;var e=Wr(),t=qr(),r=Yr(),n=Ht?Xt:(Ht=1,Xt="undefined"!=typeof Reflect&&Reflect&&Reflect.apply);return jt=n||e.call(r,t)}function Kr(){if(qt)return Yt;qt=1;var e=Wr(),t=Lr(),r=Yr(),n=Vr();return Yt=function(i){if(i.length<1||"function"!=typeof i[0])throw new t("a function is required");return n(e,r,i)}}function Zr(){if(Jt)return Zt;Jt=1;var e=Xr(),t=Hr(),r=function(){if(Kt)return Vt;Kt=1;var e,t=Kr(),r=Ur();try{e=[].__proto__===Array.prototype}catch(e){if(!e||"object"!=typeof e||!("code"in e)||"ERR_PROTO_ACCESS"!==e.code)throw e}var n=!!e&&r&&r(Object.prototype,"__proto__"),i=Object,o=i.getPrototypeOf;return Vt=n&&"function"==typeof n.get?t([n.get]):"function"==typeof o&&function(e){return o(null==e?e:i(e))}}();return Zt=e?function(t){return e(t)}:t?function(e){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("getProto: not an object");return t(e)}:r?function(e){return r(e)}:null}function Jr(){if(Qt)return $t;Qt=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=Wr();return $t=r.call(e,t)}function $r(){if(tr)return er;var e;tr=1;var t=Cr(),r=Ar(),n=Tr(),i=Or(),o=Mr(),a=kr(),s=Lr(),l=Rr(),c=Ir(),u=Pr(),h=ct?lt:(ct=1,lt=Math.max),d=Fr(),f=Dr(),p=Nr(),v=Br(),y=Function,g=function(e){try{return y('"use strict"; return ('+e+").constructor;")()}catch(e){}},m=Ur(),b=zr(),x=function(){throw new s},E=m?function(){try{return x}catch(e){try{return m(arguments,"callee").get}catch(e){return x}}}():x,w=Gr()(),S=Zr(),_=Hr(),C=Xr(),A=qr(),T=Yr(),O={},M="undefined"!=typeof Uint8Array&&S?S(Uint8Array):e,k={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?e:ArrayBuffer,"%ArrayIteratorPrototype%":w&&S?S([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":O,"%AsyncGenerator%":O,"%AsyncGeneratorFunction%":O,"%AsyncIteratorPrototype%":O,"%Atomics%":"undefined"==typeof Atomics?e:Atomics,"%BigInt%":"undefined"==typeof BigInt?e:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?e:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":"undefined"==typeof Float16Array?e:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?e:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?e:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?e:FinalizationRegistry,"%Function%":y,"%GeneratorFunction%":O,"%Int8Array%":"undefined"==typeof Int8Array?e:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?e:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":w&&S?S(S([][Symbol.iterator]())):e,"%JSON%":"object"==typeof JSON?JSON:e,"%Map%":"undefined"==typeof Map?e:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&w&&S?S((new Map)[Symbol.iterator]()):e,"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":m,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?e:Promise,"%Proxy%":"undefined"==typeof Proxy?e:Proxy,"%RangeError%":i,"%ReferenceError%":o,"%Reflect%":"undefined"==typeof Reflect?e:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?e:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&w&&S?S((new Set)[Symbol.iterator]()):e,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":w&&S?S(""[Symbol.iterator]()):e,"%Symbol%":w?Symbol:e,"%SyntaxError%":a,"%ThrowTypeError%":E,"%TypedArray%":M,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?e:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?e:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?e:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?e:Uint32Array,"%URIError%":l,"%WeakMap%":"undefined"==typeof WeakMap?e:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?e:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?e:WeakSet,"%Function.prototype.call%":T,"%Function.prototype.apply%":A,"%Object.defineProperty%":b,"%Object.getPrototypeOf%":_,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":h,"%Math.min%":d,"%Math.pow%":f,"%Math.round%":p,"%Math.sign%":v,"%Reflect.getPrototypeOf%":C};if(S)try{null.error}catch(e){var L=S(S(e));k["%Error.prototype%"]=L}var R=function e(t){var r;if("%AsyncFunction%"===t)r=g("async function () {}");else if("%GeneratorFunction%"===t)r=g("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=g("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&S&&(r=S(i.prototype))}return k[t]=r,r},I={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},P=Wr(),F=Jr(),D=P.call(T,Array.prototype.concat),N=P.call(A,Array.prototype.splice),B=P.call(T,String.prototype.replace),U=P.call(T,String.prototype.slice),z=P.call(T,RegExp.prototype.exec),G=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,X=/\\(\\)?/g,H=function(e,t){var r,n=e;if(F(I,n)&&(n="%"+(r=I[n])[0]+"%"),F(k,n)){var i=k[n];if(i===O&&(i=R(n)),void 0===i&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new a("intrinsic "+e+" does not exist!")};return er=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===z(/^%?[^%]*%?$/,e))throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=U(e,0,1),r=U(e,-1);if("%"===t&&"%"!==r)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new a("invalid intrinsic syntax, expected opening `%`");var n=[];return B(e,G,(function(e,t,r,i){n[n.length]=r?B(i,X,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=H("%"+n+"%",t),o=i.name,l=i.value,c=!1,u=i.alias;u&&(n=u[0],N(r,D([0,1],u)));for(var h=1,d=!0;h<r.length;h+=1){var f=r[h],p=U(f,0,1),v=U(f,-1);if(('"'===p||"'"===p||"`"===p||'"'===v||"'"===v||"`"===v)&&p!==v)throw new a("property names with quotes must have matching quotes");if("constructor"!==f&&d||(c=!0),F(k,o="%"+(n+="."+f)+"%"))l=k[o];else if(null!=l){if(!(f in l)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(m&&h+1>=r.length){var y=m(l,f);l=(d=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:l[f]}else d=F(l,f),l=l[f];d&&!c&&(k[o]=l)}}return l},er}function Qr(){if(nr)return rr;nr=1;var e=$r(),t=Kr(),r=t([e("%String.prototype.indexOf%")]);return rr=function(n,i){var o=e(n,!!i);return"function"==typeof o&&r(n,".prototype.")>-1?t([o]):o}}function en(){if(cr)return lr;cr=1;var e=Qr(),t=function(){if(sr)return ar;sr=1;var e,t=Qr(),r=_r()(),n=Jr(),i=Ur();if(r){var o=t("RegExp.prototype.exec"),a={},s=function(){throw a},l={toString:s,valueOf:s};"symbol"==typeof Symbol.toPrimitive&&(l[Symbol.toPrimitive]=s),e=function(e){if(!e||"object"!=typeof e)return!1;var t=i(e,"lastIndex");if(!t||!n(t,"value"))return!1;try{o(e,l)}catch(e){return e===a}}}else{var c=t("Object.prototype.toString");e=function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===c(e)}}return ar=e}(),r=e("RegExp.prototype.exec"),n=Lr();return lr=function(e){if(!t(e))throw new n("`regex` must be a RegExp");return function(t){return null!==r(e,t)}}}function tn(){if(hr)return ur;hr=1;var e,t=Qr(),r=en()(/^\s*(?:function)?\*/),n=_r()(),i=Zr(),o=t("Object.prototype.toString"),a=t("Function.prototype.toString");return ur=function(t){if("function"!=typeof t)return!1;if(r(a(t)))return!0;if(!n)return"[object GeneratorFunction]"===o(t);if(!i)return!1;if(void 0===e){var s=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch(e){}}();e=!!s&&i(s)}return i(t)===e}}function rn(){if(vr)return pr;vr=1;var e=function(){if(fr)return dr;fr=1;var e,t,r=Function.prototype.toString,n="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof n&&"function"==typeof Object.defineProperty)try{e=Object.defineProperty({},"length",{get:function(){throw t}}),t={},n((function(){throw 42}),null,e)}catch(e){e!==t&&(n=null)}else n=null;var i=/^\s*class\b/,o=function(e){try{var t=r.call(e);return i.test(t)}catch(e){return!1}},a=function(e){try{return!o(e)&&(r.call(e),!0)}catch(e){return!1}},s=Object.prototype.toString,l="function"==typeof Symbol&&!!Symbol.toStringTag,c=!(0 in[,]),u=function(){return!1};if("object"==typeof document){var h=document.all;s.call(h)===s.call(document.all)&&(u=function(e){if((c||!e)&&(void 0===e||"object"==typeof e))try{var t=s.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}return dr=n?function(r){if(u(r))return!0;if(!r)return!1;if("function"!=typeof r&&"object"!=typeof r)return!1;try{n(r,null,e)}catch(e){if(e!==t)return!1}return!o(r)&&a(r)}:function(e){if(u(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(l)return a(e);if(o(e))return!1;var t=s.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}}(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty;return pr=function(n,i,o){if(!e(i))throw new TypeError("iterator must be a function");var a,s;arguments.length>=3&&(a=o),s=n,"[object Array]"===t.call(s)?function(e,t,n){for(var i=0,o=e.length;i<o;i++)r.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(n,i,a):"string"==typeof n?function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)}(n,i,a):function(e,t,n){for(var i in e)r.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(n,i,a)},pr}function nn(){if(br)return mr;br=1;var e=gr?yr:(gr=1,yr=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),t="undefined"==typeof globalThis?ee:globalThis;return mr=function(){for(var r=[],n=0;n<e.length;n++)"function"==typeof t[e[n]]&&(r[r.length]=e[n]);return r},mr}var on,an,sn,ln,cn,un,hn,dn,fn,pn,vn,yn,gn,mn,bn,xn,En,wn,Sn,_n,Cn,An,Tn,On,Mn,kn,Ln,Rn={exports:{}};function In(){if(un)return cn;var e;un=1;var t=Ar(),r=Tr(),n=Or(),i=Mr(),o=kr(),a=Lr(),s=Rr(),l=Function,c=function(e){try{return l('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var h=function(){throw new a},d=u?function(){try{return h}catch(e){try{return u(arguments,"callee").get}catch(e){return h}}}():h,f=function(){if(an)return on;an=1;var e="undefined"!=typeof Symbol&&Symbol,t=Sr();return on=function(){return"function"==typeof e&&"function"==typeof Symbol&&"symbol"==typeof e("foo")&&"symbol"==typeof Symbol("bar")&&t()}}()(),p=function(){if(ln)return sn;ln=1;var e={__proto__:null,foo:{}},t=Object;return sn=function(){return{__proto__:e}.foo===e.foo&&!(e instanceof t)}}()(),v=Object.getPrototypeOf||(p?function(e){return e.__proto__}:null),y={},g="undefined"!=typeof Uint8Array&&v?v(Uint8Array):e,m={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?e:ArrayBuffer,"%ArrayIteratorPrototype%":f&&v?v([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":y,"%AsyncGenerator%":y,"%AsyncGeneratorFunction%":y,"%AsyncIteratorPrototype%":y,"%Atomics%":"undefined"==typeof Atomics?e:Atomics,"%BigInt%":"undefined"==typeof BigInt?e:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?e:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float32Array%":"undefined"==typeof Float32Array?e:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?e:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?e:FinalizationRegistry,"%Function%":l,"%GeneratorFunction%":y,"%Int8Array%":"undefined"==typeof Int8Array?e:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?e:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":f&&v?v(v([][Symbol.iterator]())):e,"%JSON%":"object"==typeof JSON?JSON:e,"%Map%":"undefined"==typeof Map?e:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&f&&v?v((new Map)[Symbol.iterator]()):e,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?e:Promise,"%Proxy%":"undefined"==typeof Proxy?e:Proxy,"%RangeError%":n,"%ReferenceError%":i,"%Reflect%":"undefined"==typeof Reflect?e:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?e:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&f&&v?v((new Set)[Symbol.iterator]()):e,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":f&&v?v(""[Symbol.iterator]()):e,"%Symbol%":f?Symbol:e,"%SyntaxError%":o,"%ThrowTypeError%":d,"%TypedArray%":g,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?e:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?e:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?e:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?e:Uint32Array,"%URIError%":s,"%WeakMap%":"undefined"==typeof WeakMap?e:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?e:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?e:WeakSet};if(v)try{null.error}catch(e){var b=v(v(e));m["%Error.prototype%"]=b}var x=function e(t){var r;if("%AsyncFunction%"===t)r=c("async function () {}");else if("%GeneratorFunction%"===t)r=c("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=c("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&v&&(r=v(i.prototype))}return m[t]=r,r},E={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},w=Wr(),S=Jr(),_=w.call(Function.call,Array.prototype.concat),C=w.call(Function.apply,Array.prototype.splice),A=w.call(Function.call,String.prototype.replace),T=w.call(Function.call,String.prototype.slice),O=w.call(Function.call,RegExp.prototype.exec),M=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g,L=function(e,t){var r,n=e;if(S(E,n)&&(n="%"+(r=E[n])[0]+"%"),S(m,n)){var i=m[n];if(i===y&&(i=x(n)),void 0===i&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new o("intrinsic "+e+" does not exist!")};return cn=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a('"allowMissing" argument must be a boolean');if(null===O(/^%?[^%]*%?$/,e))throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=T(e,0,1),r=T(e,-1);if("%"===t&&"%"!==r)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var n=[];return A(e,M,(function(e,t,r,i){n[n.length]=r?A(i,k,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=L("%"+n+"%",t),s=i.name,l=i.value,c=!1,h=i.alias;h&&(n=h[0],C(r,_([0,1],h)));for(var d=1,f=!0;d<r.length;d+=1){var p=r[d],v=T(p,0,1),y=T(p,-1);if(('"'===v||"'"===v||"`"===v||'"'===y||"'"===y||"`"===y)&&v!==y)throw new o("property names with quotes must have matching quotes");if("constructor"!==p&&f||(c=!0),S(m,s="%"+(n+="."+p)+"%"))l=m[s];else if(null!=l){if(!(p in l)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&d+1>=r.length){var g=u(l,p);l=(f=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:l[p]}else f=S(l,p),l=l[p];f&&!c&&(m[s]=l)}}return l},cn}function Pn(){if(dn)return hn;dn=1;var e=In()("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch(t){e=!1}return hn=e}function Fn(){if(pn)return fn;pn=1;var e=In()("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch(t){e=null}return fn=e}function Dn(){if(xn)return bn;xn=1;var e=In(),t=function(){if(yn)return vn;yn=1;var e=Pn(),t=kr(),r=Lr(),n=Fn();return vn=function(i,o,a){if(!i||"object"!=typeof i&&"function"!=typeof i)throw new r("`obj` must be an object or a function`");if("string"!=typeof o&&"symbol"!=typeof o)throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new r("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],h=!!n&&n(i,o);if(e)e(i,o,{configurable:null===c&&h?h.configurable:!c,enumerable:null===s&&h?h.enumerable:!s,value:a,writable:null===l&&h?h.writable:!l});else{if(!u&&(s||l||c))throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");i[o]=a}},vn}(),r=function(){if(mn)return gn;mn=1;var e=Pn(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return 1!==e([],"length",{value:1}).length}catch(e){return!0}},gn=t}()(),n=Fn(),i=Lr(),o=e("%Math.floor%");return bn=function(e,a){if("function"!=typeof e)throw new i("`fn` is not a function");if("number"!=typeof a||a<0||a>4294967295||o(a)!==a)throw new i("`length` must be a positive 32-bit integer");var s=arguments.length>2&&!!arguments[2],l=!0,c=!0;if("length"in e&&n){var u=n(e,"length");u&&!u.configurable&&(l=!1),u&&!u.writable&&(c=!1)}return(l||c||!s)&&(r?t(e,"length",a,!0,!0):t(e,"length",a)),e},bn}function Nn(){if(wn)return En;wn=1;var e=Wr(),t=qr(),r=Vr();return En=function(){return r(e,t,arguments)},En}function Bn(){if(Cn)return _n;Cn=1;var e=rn(),t=nn(),r=(Sn||(Sn=1,function(e){var t=Dn(),r=zr(),n=Kr(),i=Nn();e.exports=function(e){var r=n(arguments),i=e.length-(arguments.length-1);return t(r,1+(i>0?i:0),!0)},r?r(e.exports,"apply",{value:i}):e.exports.apply=i}(Rn)),Rn.exports),n=Qr(),i=Ur(),o=Zr(),a=n("Object.prototype.toString"),s=_r()(),l="undefined"==typeof globalThis?ee:globalThis,c=t(),u=n("String.prototype.slice"),h=n("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},d={__proto__:null};e(c,s&&i&&o?function(e){var t=new l[e];if(Symbol.toStringTag in t&&o){var n=o(t),a=i(n,Symbol.toStringTag);if(!a&&n){var s=o(n);a=i(s,Symbol.toStringTag)}d["$"+e]=r(a.get)}}:function(e){var t=new l[e],n=t.slice||t.set;n&&(d["$"+e]=r(n))});return _n=function(t){if(!t||"object"!=typeof t)return!1;if(!s){var r=u(a(t),8,-1);return h(c,r)>-1?r:"Object"===r&&function(t){var r=!1;return e(d,(function(e,n){if(!r)try{e(t),r=u(n,1)}catch(e){}})),r}(t)}return i?function(t){var r=!1;return e(d,(function(e,n){if(!r)try{"$"+e(t)===n&&(r=u(n,1))}catch(e){}})),r}(t):null}}function Un(){return On||(On=1,function(e){var t=function(){if(or)return ir;or=1;var e=_r()(),t=Qr()("Object.prototype.toString"),r=function(r){return!(e&&r&&"object"==typeof r&&Symbol.toStringTag in r)&&"[object Arguments]"===t(r)},n=function(e){return!!r(e)||null!==e&&"object"==typeof e&&"length"in e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==t(e)&&"callee"in e&&"[object Function]"===t(e.callee)},i=function(){return r(arguments)}();return r.isLegacyArguments=n,ir=i?r:n}(),r=tn(),n=Bn(),i=function(){if(Tn)return An;Tn=1;var e=Bn();return An=function(t){return!!e(t)}}();function o(e){return e.call.bind(e)}var a="undefined"!=typeof BigInt,s="undefined"!=typeof Symbol,l=o(Object.prototype.toString),c=o(Number.prototype.valueOf),u=o(String.prototype.valueOf),h=o(Boolean.prototype.valueOf);if(a)var d=o(BigInt.prototype.valueOf);if(s)var f=o(Symbol.prototype.valueOf);function p(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function v(e){return"[object Map]"===l(e)}function y(e){return"[object Set]"===l(e)}function g(e){return"[object WeakMap]"===l(e)}function m(e){return"[object WeakSet]"===l(e)}function b(e){return"[object ArrayBuffer]"===l(e)}function x(e){return"undefined"!=typeof ArrayBuffer&&(b.working?b(e):e instanceof ArrayBuffer)}function E(e){return"[object DataView]"===l(e)}function w(e){return"undefined"!=typeof DataView&&(E.working?E(e):e instanceof DataView)}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=i,e.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},e.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):i(e)||w(e)},e.isUint8Array=function(e){return"Uint8Array"===n(e)},e.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===n(e)},e.isUint16Array=function(e){return"Uint16Array"===n(e)},e.isUint32Array=function(e){return"Uint32Array"===n(e)},e.isInt8Array=function(e){return"Int8Array"===n(e)},e.isInt16Array=function(e){return"Int16Array"===n(e)},e.isInt32Array=function(e){return"Int32Array"===n(e)},e.isFloat32Array=function(e){return"Float32Array"===n(e)},e.isFloat64Array=function(e){return"Float64Array"===n(e)},e.isBigInt64Array=function(e){return"BigInt64Array"===n(e)},e.isBigUint64Array=function(e){return"BigUint64Array"===n(e)},v.working="undefined"!=typeof Map&&v(new Map),e.isMap=function(e){return"undefined"!=typeof Map&&(v.working?v(e):e instanceof Map)},y.working="undefined"!=typeof Set&&y(new Set),e.isSet=function(e){return"undefined"!=typeof Set&&(y.working?y(e):e instanceof Set)},g.working="undefined"!=typeof WeakMap&&g(new WeakMap),e.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(g.working?g(e):e instanceof WeakMap)},m.working="undefined"!=typeof WeakSet&&m(new WeakSet),e.isWeakSet=function(e){return m(e)},b.working="undefined"!=typeof ArrayBuffer&&b(new ArrayBuffer),e.isArrayBuffer=x,E.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&E(new DataView(new ArrayBuffer(1),0,1)),e.isDataView=w;var S="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function _(e){return"[object SharedArrayBuffer]"===l(e)}function C(e){return void 0!==S&&(void 0===_.working&&(_.working=_(new S)),_.working?_(e):e instanceof S)}function A(e){return p(e,c)}function T(e){return p(e,u)}function O(e){return p(e,h)}function M(e){return a&&p(e,d)}function k(e){return s&&p(e,f)}e.isSharedArrayBuffer=C,e.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},e.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},e.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},e.isGeneratorObject=function(e){return"[object Generator]"===l(e)},e.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},e.isNumberObject=A,e.isStringObject=T,e.isBooleanObject=O,e.isBigIntObject=M,e.isSymbolObject=k,e.isBoxedPrimitive=function(e){return A(e)||T(e)||O(e)||M(e)||k(e)},e.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(x(e)||C(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(t){Object.defineProperty(e,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})}))}(wr)),wr}function zn(){return Ln||(Ln=1,function(e){var t=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},r=/%[sdj%]/g;e.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,s=String(e).replace(r,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}})),l=i[n];n<o;l=i[++n])p(l)||!b(l)?s+=" "+l:s+=" "+a(l);return s},e.deprecate=function(t,r){if("undefined"!=typeof process&&!0===process.noDeprecation)return t;if("undefined"==typeof process)return function(){return e.deprecate(t,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return t.apply(this,arguments)}};var n={},i=/^$/;if(process.env.NODE_DEBUG){var o=process.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+o+"$","i")}function a(t,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(r)?n.showHidden=r:r&&e._extend(n,r),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),c(n,t,n.depth)}function s(e,t){var r=a.styles[t];return r?"["+a.colors[r][0]+"m"+e+"["+a.colors[r][1]+"m":e}function l(e,t){return e}function c(t,r,n){if(t.customInspect&&r&&w(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return y(i)||(i=c(t,i,n)),i}var o=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(v(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(p(t))return e.stylize("null","null")}(t,r);if(o)return o;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),E(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(r);if(0===a.length){if(w(r)){var l=r.name?": "+r.name:"";return t.stylize("[Function"+l+"]","special")}if(m(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return t.stylize(Date.prototype.toString.call(r),"date");if(E(r))return u(r)}var b,S="",_=!1,C=["{","}"];(d(r)&&(_=!0,C=["[","]"]),w(r))&&(S=" [Function"+(r.name?": "+r.name:"")+"]");return m(r)&&(S=" "+RegExp.prototype.toString.call(r)),x(r)&&(S=" "+Date.prototype.toUTCString.call(r)),E(r)&&(S=" "+u(r)),0!==a.length||_&&0!=r.length?n<0?m(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),b=_?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)A(t,String(a))?o.push(h(e,t,r,n,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(h(e,t,r,n,i,!0))})),o}(t,r,n,s,a):a.map((function(e){return h(t,r,n,s,e,_)})),t.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(b,S,C)):C[0]+S+C[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,n,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),A(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(l.value)<0?(s=p(r)?c(e,l.value,null):c(e,l.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.slice(1,-1),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function d(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function p(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function g(e){return void 0===e}function m(e){return b(e)&&"[object RegExp]"===S(e)}function b(e){return"object"==typeof e&&null!==e}function x(e){return b(e)&&"[object Date]"===S(e)}function E(e){return b(e)&&("[object Error]"===S(e)||e instanceof Error)}function w(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}e.debuglog=function(t){if(t=t.toUpperCase(),!n[t])if(i.test(t)){var r=process.pid;n[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else n[t]=function(){};return n[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.types=Un(),e.isArray=d,e.isBoolean=f,e.isNull=p,e.isNullOrUndefined=function(e){return null==e},e.isNumber=v,e.isString=y,e.isSymbol=function(e){return"symbol"==typeof e},e.isUndefined=g,e.isRegExp=m,e.types.isRegExp=m,e.isObject=b,e.isDate=x,e.types.isDate=x,e.isError=E,e.types.isNativeError=E,e.isFunction=w,e.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},e.isBuffer=kn?Mn:(kn=1,Mn=function(e){return e instanceof Buffer});var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.log=function(){var t,r;console.log("%s - %s",(t=new Date,r=[_(t.getHours()),_(t.getMinutes()),_(t.getSeconds())].join(":"),[t.getDate(),C[t.getMonth()],r].join(" ")),e.format.apply(e,arguments))},e.inherits=jn(),e._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}e.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(T&&e[T]){var r;if("function"!=typeof(r=e[T]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,T,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),T&&Object.defineProperty(r,T,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,t(e))},e.promisify.custom=T,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};e.apply(this,t).then((function(e){process.nextTick(o.bind(null,null,e))}),(function(e){process.nextTick(O.bind(null,e,o))}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,t(e)),r}}(Er)),Er}var Gn,Xn,Hn={exports:{}};function jn(){if(Xn)return xr.exports;Xn=1;try{var e=zn();if("function"!=typeof e.inherits)throw"";xr.exports=e.inherits}catch(e){xr.exports=(Gn||(Gn=1,"function"==typeof Object.create?Hn.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Hn.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),Hn.exports)}return xr.exports}var Wn,Yn,qn,Vn,Kn,Zn,Jn,$n,Qn,ei={exports:{}};function ti(){return Wn||(Wn=1,function(e){var t=Pe().Buffer,r=zn();e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return t.alloc(0);for(var r,n,i,o=t.allocUnsafe(e>>>0),a=this.head,s=0;a;)r=a.data,n=o,i=s,r.copy(n,i),s+=a.data.length,a=a.next;return o},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})}(ei)),ei.exports}function ri(){if(qn)return Yn;qn=1;var e=ue();function t(e,t){e.emit("error",t)}return Yn={destroy:function(r,n){var i=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(n?n(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(t,this,r)):e.nextTick(t,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,(function(r){!n&&r?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,e.nextTick(t,i,r)):e.nextTick(t,i,r):n&&n(r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},Yn}function ni(){if(Jn)return Zn;Jn=1;var e=ue();function t(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}Zn=f;var r,n=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:e.nextTick;f.WritableState=d;var i=Object.create(Ne());i.inherits=jn();var o={deprecate:Kn?Vn:(Kn=1,Vn=zn().deprecate)},a=ye(),s=Pe().Buffer,l=(void 0!==ee?ee:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,u=ri();function h(){}function d(i,o){r=r||ii(),i=i||{};var a=o instanceof r;this.objectMode=!!i.objectMode,a&&(this.objectMode=this.objectMode||!!i.writableObjectMode);var s=i.highWaterMark,l=i.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:a&&(l||0===l)?l:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===i.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=i.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,r){var i=t._writableState,o=i.sync,a=i.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),r)!function(t,r,n,i,o){--r.pendingcb,n?(e.nextTick(o,i),e.nextTick(b,t,r),t._writableState.errorEmitted=!0,t.emit("error",i)):(o(i),t._writableState.errorEmitted=!0,t.emit("error",i),b(t,r))}(t,i,o,r,a);else{var s=g(i);s||i.corked||i.bufferProcessing||!i.bufferedRequest||y(t,i),o?n(v,t,i,s,a):v(t,i,s,a)}}(o,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}function f(e){if(r=r||ii(),!(c.call(f,this)||this instanceof r))return new f(e);this._writableState=new d(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function p(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function v(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),b(e,t)}function y(e,r){r.bufferProcessing=!0;var n=r.bufferedRequest;if(e._writev&&n&&n.next){var i=r.bufferedRequestCount,o=new Array(i),a=r.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,p(e,r,!0,r.length,o,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new t(r),r.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(p(e,r,!1,r.objectMode?1:c.length,c,u,h),n=n.next,r.bufferedRequestCount--,r.writing)break}null===n&&(r.lastBufferedRequest=null)}r.bufferedRequest=n,r.bufferProcessing=!1}function g(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function m(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),b(e,t)}))}function b(t,r){var n=g(r);return n&&(!function(t,r){r.prefinished||r.finalCalled||("function"==typeof t._final?(r.pendingcb++,r.finalCalled=!0,e.nextTick(m,t,r)):(r.prefinished=!0,t.emit("prefinish")))}(t,r),0===r.pendingcb&&(r.finished=!0,t.emit("finish"))),n}return i.inherits(f,a),d.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(d.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(f,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===f&&(e&&e._writableState instanceof d)}})):c=function(e){return e instanceof this},f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},f.prototype.write=function(t,r,n){var i,o=this._writableState,a=!1,c=!o.objectMode&&(i=t,s.isBuffer(i)||i instanceof l);return c&&!s.isBuffer(t)&&(t=function(e){return s.from(e)}(t)),"function"==typeof r&&(n=r,r=null),c?r="buffer":r||(r=o.defaultEncoding),"function"!=typeof n&&(n=h),o.ended?function(t,r){var n=new Error("write after end");t.emit("error",n),e.nextTick(r,n)}(this,n):(c||function(t,r,n,i){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||r.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),e.nextTick(i,a),o=!1),o}(this,o,t,n))&&(o.pendingcb++,a=function(e,t,r,n,i,o){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=s.from(t,r));return t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var l=t.objectMode?1:n.length;t.length+=l;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else p(e,t,!1,l,n,i,o);return c}(this,o,c,t,r,n)),a},f.prototype.cork=function(){this._writableState.corked++},f.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||y(this,e))},f.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),f.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},f.prototype._writev=null,f.prototype.end=function(t,r,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,r=null):"function"==typeof r&&(n=r,r=null),null!=t&&this.write(t,r),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,r,n){r.ending=!0,b(t,r),n&&(r.finished?e.nextTick(n):t.once("finish",n));r.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),f.prototype.destroy=u.destroy,f.prototype._undestroy=u.undestroy,f.prototype._destroy=function(e,t){this.end(),t(e)},Zn}function ii(){if(Qn)return $n;Qn=1;var e=ue(),t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};$n=l;var r=Object.create(Ne());r.inherits=jn();var n=vi(),i=ni();r.inherits(l,n);for(var o=t(i.prototype),a=0;a<o.length;a++){var s=o[a];l.prototype[s]||(l.prototype[s]=i.prototype[s])}function l(e){if(!(this instanceof l))return new l(e);n.call(this,e),i.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||e.nextTick(u,this)}function u(e){e.end()}return Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),l.prototype._destroy=function(t,r){this.push(null),this.end(),e.nextTick(r,t)},$n}var oi,ai,si,li,ci,ui,hi,di,fi={};function pi(){if(oi)return fi;oi=1;var e=Pe().Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(r){var n;switch(this.encoding=function(r){var n=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(r);if("string"!=typeof n&&(e.isEncoding===t||!t(r)))throw new Error("Unknown encoding: "+r);return n||r}(r),this.encoding){case"utf16le":this.text=o,this.end=a,n=4;break;case"utf8":this.fillLast=i,n=4;break;case"base64":this.text=s,this.end=l,n=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(n)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function o(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function a(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function s(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function c(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}return fi.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},r.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var o=n(t[i]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(e.lastNeed=o-2),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},fi}function vi(){if(si)return ai;si=1;var e=ue();ai=v;var t,r=function(){if(ie)return ne;ie=1;var e={}.toString;return ne=Array.isArray||function(t){return"[object Array]"==e.call(t)}}();v.ReadableState=p,ve().EventEmitter;var n=function(e,t){return e.listeners(t).length},i=ye(),o=Pe().Buffer,a=(void 0!==ee?ee:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var s=Object.create(Ne());s.inherits=jn();var l=zn(),c=void 0;c=l&&l.debuglog?l.debuglog("stream"):function(){};var u,h=ti(),d=ri();s.inherits(v,i);var f=["error","close","destroy","pause","resume"];function p(e,r){e=e||{};var n=r instanceof(t=t||ii());this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u||(u=pi().StringDecoder),this.decoder=new u(e.encoding),this.encoding=e.encoding)}function v(e){if(t=t||ii(),!(this instanceof v))return new v(e);this._readableState=new p(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),i.call(this)}function y(e,t,r,n,i){var s,l=e._readableState;null===t?(l.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,x(e)}(e,l)):(i||(s=function(e,t){var r;n=t,o.isBuffer(n)||n instanceof a||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(l,t)),s?e.emit("error",s):l.objectMode||t&&t.length>0?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),n?l.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):g(e,l,t,!0):l.ended?e.emit("error",new Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?g(e,l,t,!1):w(e,l)):g(e,l,t,!1))):n||(l.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(l)}function g(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&x(e)),w(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=d.destroy,v.prototype._undestroy=d.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=o.from(e,t),t=""),r=!0),y(this,e,t,!1,r)},v.prototype.unshift=function(e){return y(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return u||(u=pi().StringDecoder),this._readableState.decoder=new u(e),this._readableState.encoding=e,this};var m=8388608;function b(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=m?e=m:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(t){var r=t._readableState;r.needReadable=!1,r.emittedReadable||(c("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?e.nextTick(E,t):E(t))}function E(e){c("emit readable"),e.emit("readable"),A(e)}function w(t,r){r.readingMore||(r.readingMore=!0,e.nextTick(S,t,r))}function S(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(c("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function _(e){c("readable nexttick read 0"),e.read(0)}function C(e,t){t.reading||(c("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function T(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=o.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var a=n.data,s=e>a.length?a.length:e;if(a.copy(r,r.length-e,0,s),0===(e-=s)){s===a.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(s));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function O(t){var r=t._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,e.nextTick(M,r,t))}function M(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function k(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}return v.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?O(this):x(this),null;if(0===(e=b(e,t))&&t.ended)return 0===t.length&&O(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=b(r,t))),null===(n=e>0?T(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&O(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(t,i){var o=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,c("pipe count=%d opts=%j",a.pipesCount,i);var s=(!i||!1!==i.end)&&t!==process.stdout&&t!==process.stderr?u:m;function l(e,r){c("onunpipe"),e===o&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",h),t.removeListener("error",v),t.removeListener("unpipe",l),o.removeListener("end",u),o.removeListener("end",m),o.removeListener("data",p),d=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}function u(){c("onend"),t.end()}a.endEmitted?e.nextTick(s):o.once("end",s),t.on("unpipe",l);var h=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&n(e,"data")&&(t.flowing=!0,A(e))}}(o);t.on("drain",h);var d=!1;var f=!1;function p(e){c("ondata"),f=!1,!1!==t.write(e)||f||((1===a.pipesCount&&a.pipes===t||a.pipesCount>1&&-1!==k(a.pipes,t))&&!d&&(c("false write response, pause",a.awaitDrain),a.awaitDrain++,f=!0),o.pause())}function v(e){c("onerror",e),m(),t.removeListener("error",v),0===n(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",g),m()}function g(){c("onfinish"),t.removeListener("close",y),m()}function m(){c("unpipe"),o.unpipe(t)}return o.on("data",p),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?r(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(t,"error",v),t.once("close",y),t.once("finish",g),t.emit("pipe",o),a.flowing||(c("pipe resume"),o.resume()),t},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=k(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},v.prototype.on=function(t,r){var n=i.prototype.on.call(this,t,r);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var o=this._readableState;o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.emittedReadable=!1,o.reading?o.length&&x(this):e.nextTick(_,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var t=this._readableState;return t.flowing||(c("resume"),t.flowing=!0,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(C,t,r))}(this,t)),this},v.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<f.length;o++)e.on(f[o],this.emit.bind(this,f[o]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=T,ai}function yi(){if(ci)return li;ci=1,li=n;var e=ii(),t=Object.create(Ne());function r(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(t){if(!(this instanceof n))return new n(t);e.call(this,t),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",i)}function i(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){o(e,t,r)})):o(this,null,null)}function o(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}return t.inherits=jn(),t.inherits(n,e),n.prototype.push=function(t,r){return this._transformState.needTransform=!1,e.prototype.push.call(this,t,r)},n.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},n.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},n.prototype._destroy=function(t,r){var n=this;e.prototype._destroy.call(this,t,(function(e){r(e),n.emit("close")}))},li}function gi(){return di||(di=1,function(t,r){var n=e;"disable"===process.env.READABLE_STREAM&&n?(t.exports=n,(r=t.exports=n.Readable).Readable=n.Readable,r.Writable=n.Writable,r.Duplex=n.Duplex,r.Transform=n.Transform,r.PassThrough=n.PassThrough,r.Stream=n):((r=t.exports=vi()).Stream=n||r,r.Readable=r,r.Writable=ni(),r.Duplex=ii(),r.Transform=yi(),r.PassThrough=function(){if(hi)return ui;hi=1,ui=r;var e=yi(),t=Object.create(Ne());function r(t){if(!(this instanceof r))return new r(t);e.call(this,t)}return t.inherits=jn(),t.inherits(r,e),r.prototype._transform=function(e,t,r){r(null,e)},ui}())}(le,le.exports)),le.exports}if(se.base64=!0,se.array=!0,se.string=!0,se.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,se.nodebuffer="undefined"!=typeof Buffer,se.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)se.blob=!1;else{var mi=new ArrayBuffer(0);try{se.blob=0===new Blob([mi],{type:"application/zip"}).size}catch(e){try{var bi=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);bi.append(mi),se.blob=0===bi.getBlob("application/zip").size}catch(e){se.blob=!1}}}try{se.nodestream=!!gi().Readable}catch(e){se.nodestream=!1}var xi,Ei={};function wi(){if(xi)return Ei;xi=1;var e=Li(),t=se,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return Ei.encode=function(t){for(var n,i,o,a,s,l,c,u=[],h=0,d=t.length,f=d,p="string"!==e.getTypeOf(t);h<t.length;)f=d-h,p?(n=t[h++],i=h<d?t[h++]:0,o=h<d?t[h++]:0):(n=t.charCodeAt(h++),i=h<d?t.charCodeAt(h++):0,o=h<d?t.charCodeAt(h++):0),a=n>>2,s=(3&n)<<4|i>>4,l=f>1?(15&i)<<2|o>>6:64,c=f>2?63&o:64,u.push(r.charAt(a)+r.charAt(s)+r.charAt(l)+r.charAt(c));return u.join("")},Ei.decode=function(e){var n,i,o,a,s,l,c=0,u=0,h="data:";if(e.substr(0,5)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&f--,e.charAt(e.length-2)===r.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=t.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)n=r.indexOf(e.charAt(c++))<<2|(a=r.indexOf(e.charAt(c++)))>>4,i=(15&a)<<4|(s=r.indexOf(e.charAt(c++)))>>2,o=(3&s)<<6|(l=r.indexOf(e.charAt(c++))),d[u++]=n,64!==s&&(d[u++]=i),64!==l&&(d[u++]=o);return d},Ei}var Si,_i,Ci,Ai,Ti={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}};var Oi=null;Oi="undefined"!=typeof Promise?Promise:function(){if(Ai)return Ci;Ai=1;var e=function(){if(_i)return Si;_i=1;var e,t,r=ee.MutationObserver||ee.WebKitMutationObserver;if(process.browser)if(r){var n=0,i=new r(l),o=ee.document.createTextNode("");i.observe(o,{characterData:!0}),e=function(){o.data=n=++n%2}}else if(ee.setImmediate||void 0===ee.MessageChannel)e="document"in ee&&"onreadystatechange"in ee.document.createElement("script")?function(){var e=ee.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},ee.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var a=new ee.MessageChannel;a.port1.onmessage=l,e=function(){a.port2.postMessage(0)}}else e=function(){process.nextTick(l)};var s=[];function l(){var e,r;t=!0;for(var n=s.length;n;){for(r=s,s=[],e=-1;++e<n;)r[e]();n=s.length}t=!1}return Si=function(r){1!==s.push(r)||t||e()}}();function t(){}var r={},n=["REJECTED"],i=["FULFILLED"],o=["PENDING"];if(!process.browser)var a=["UNHANDLED"];function s(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=o,this.queue=[],this.outcome=void 0,process.browser||(this.handled=a),e!==t&&h(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function c(t,n,i){e((function(){var e;try{e=n(i)}catch(e){return r.reject(t,e)}e===t?r.reject(t,new TypeError("Cannot resolve promise with itself")):r.resolve(t,e)}))}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function i(t){n||(n=!0,r.reject(e,t))}function o(t){n||(n=!0,r.resolve(e,t))}var a=d((function(){t(o,i)}));"error"===a.status&&i(a.value)}function d(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}return Ci=s,s.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,r){if("function"!=typeof e&&this.state===i||"function"!=typeof r&&this.state===n)return this;var s=new this.constructor(t);return process.browser||this.handled===a&&(this.handled=null),this.state!==o?c(s,this.state===i?e:r,this.outcome):this.queue.push(new l(s,e,r)),s},l.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){c(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){r.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){c(this.promise,this.onRejected,e)},r.resolve=function(e,t){var n=d(u,t);if("error"===n.status)return r.reject(e,n.value);var o=n.value;if(o)h(e,o);else{e.state=i,e.outcome=t;for(var a=-1,s=e.queue.length;++a<s;)e.queue[a].callFulfilled(t)}return e},r.reject=function(t,r){t.state=n,t.outcome=r,process.browser||t.handled===a&&e((function(){t.handled===a&&process.emit("unhandledRejection",r,t)}));for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callRejected(r);return t},s.resolve=function(e){return e instanceof this?e:r.resolve(new this(t),e)},s.reject=function(e){var n=new this(t);return r.reject(n,e)},s.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var a=new Array(i),s=0,l=-1,c=new this(t);++l<i;)u(e[l],l);return c;function u(e,t){n.resolve(e).then((function(e){a[t]=e,++s!==i||o||(o=!0,r.resolve(c,a))}),(function(e){o||(o=!0,r.reject(c,e))}))}},s.race=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var a,s=-1,l=new this(t);++s<i;)a=e[s],n.resolve(a).then((function(e){o||(o=!0,r.resolve(l,e))}),(function(e){o||(o=!0,r.reject(l,e))}));return l},Ci}();var Mi,ki={Promise:Oi};function Li(){return Mi||(Mi=1,function(e){var t=se,r=wi(),n=Ti,i=ki;function o(e){return e}function a(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e.newBlob=function(t,r){e.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(e,t,r){var n=[],i=0,o=e.length;if(o<=r)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,o)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,o)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return t.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return t.nodebuffer&&1===String.fromCharCode.apply(null,n.allocBuffer(1)).length}catch(e){return!1}}()}};function l(t){var r=65536,n=e.getTypeOf(t),i=!0;if("uint8array"===n?i=s.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=s.applyCanBeUsed.nodebuffer),i)for(;r>1;)try{return s.stringifyByChunk(t,n,r)}catch(e){r=Math.floor(r/2)}return s.stringifyByChar(t)}function c(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}e.applyFromCharCode=l;var u={};u.string={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,n.allocBuffer(e.length))}},u.array={string:l,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(e)}},u.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return c(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return n.newBufferFrom(e)}},u.nodebuffer={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:o},e.transformTo=function(t,r){if(r||(r=""),!t)return r;e.checkSupport(t);var n=e.getTypeOf(r);return u[n][t](r)},e.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},e.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":t.nodebuffer&&n.isBuffer(e)?"nodebuffer":t.uint8array&&e instanceof Uint8Array?"uint8array":t.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},e.checkSupport=function(e){if(!t[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},e.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},e.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r},e.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},e.prepareContent=function(n,o,s,l,c){var u=i.Promise.resolve(o).then((function(e){return t.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new i.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e}));return u.then((function(o){var u,h=e.getTypeOf(o);return h?("arraybuffer"===h?o=e.transformTo("uint8array",o):"string"===h&&(c?o=r.decode(o):s&&!0!==l&&(o=a(u=o,t.uint8array?new Uint8Array(u.length):new Array(u.length)))),o):i.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}}(ae)),ae}function Ri(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}!function(e,t){if(!e.setImmediate){var r,n,i,o,a=1,s={},l=!1,c=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(i="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&d(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){d(e.data)},r=function(e){n.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?function(){var e=c.documentElement;r=function(t){var r=c.createElement("script");r.onreadystatechange=function(){d(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():r=function(e){setTimeout(d,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return s[a]=i,r(a),a++},u.clearImmediate=h}function h(e){delete s[e]}function d(e){if(l)setTimeout(d,0,e);else{var r=s[e];if(r){l=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{h(e),l=!1}}}}}("undefined"==typeof self?ee:self),Ri.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};var Ii=Ri;!function(e){for(var t=Li(),r=se,n=Ti,i=Ii,o=new Array(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1;function s(){i.call(this,"utf-8 decode"),this.leftOver=null}function l(){i.call(this,"utf-8 encode")}e.utf8encode=function(e){return r.nodebuffer?n.newBufferFrom(e,"utf-8"):function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},e.utf8decode=function(e){return r.nodebuffer?t.transformTo("nodebuffer",e).toString("utf-8"):function(e){var r,n,i,a,s=e.length,l=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)l[n++]=i;else if((a=o[i])>4)l[n++]=65533,r+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&r<s;)i=i<<6|63&e[r++],a--;a>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),t.applyFromCharCode(l)}(e=t.transformTo(r.uint8array?"uint8array":"array",e))},t.inherits(s,i),s.prototype.processChunk=function(n){var i=t.transformTo(r.uint8array?"uint8array":"array",n.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=i;(i=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),i.set(a,this.leftOver.length)}else i=this.leftOver.concat(i);this.leftOver=null}var s=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}(i),l=i;s!==i.length&&(r.uint8array?(l=i.subarray(0,s),this.leftOver=i.subarray(s,i.length)):(l=i.slice(0,s),this.leftOver=i.slice(s,i.length))),this.push({data:e.utf8decode(l),meta:n.meta})},s.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=s,t.inherits(l,i),l.prototype.processChunk=function(t){this.push({data:e.utf8encode(t.data),meta:t.meta})},e.Utf8EncodeWorker=l}(oe);var Pi=Ii,Fi=Li();function Di(e){Pi.call(this,"ConvertWorker to "+e),this.destType=e}Fi.inherits(Di,Pi),Di.prototype.processChunk=function(e){this.push({data:Fi.transformTo(this.destType,e.data),meta:e.meta})};var Ni,Bi,Ui=Di;var zi=Li(),Gi=Ui,Xi=Ii,Hi=wi(),ji=ki,Wi=null;if(se.nodestream)try{Wi=function(){if(Bi)return Ni;Bi=1;var e=gi().Readable;function t(t,r,n){e.call(this,r),this._helper=t;var i=this;t.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}return Li().inherits(t,e),t.prototype._read=function(){this._helper.resume()},Ni=t}()}catch(e){}function Yi(e,t){return new ji.Promise((function(r,n){var i=[],o=e._internalType,a=e._outputType,s=e._mimeType;e.on("data",(function(e,r){i.push(e),t&&t(r)})).on("error",(function(e){i=[],n(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return zi.newBlob(zi.transformTo("arraybuffer",t),r);case"base64":return Hi.encode(t);default:return zi.transformTo(e,t)}}(a,function(e,t){var r,n=0,i=null,o=0;for(r=0;r<t.length;r++)o+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,i),s);r(e)}catch(e){n(e)}i=[]})).resume()}))}function qi(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=t,this._mimeType=r,zi.checkSupport(n),this._worker=e.pipe(new Gi(n)),e.lock()}catch(e){this._worker=new Xi("error"),this._worker.error(e)}}qi.prototype={accumulate:function(e){return Yi(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){zi.delay(t,arguments,r)})),this},resume:function(){return zi.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(zi.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Wi(this,{objectMode:"nodebuffer"!==this._outputType},e)}};var Vi=qi,Ki={base64:!1,binary:!1,dir:!1,createFolders:!0,date:null,compression:null,compressionOptions:null,comment:null,unixPermissions:null,dosPermissions:null},Zi=Li(),Ji=Ii;function $i(e){Ji.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=Zi.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}Zi.inherits($i,Ji),$i.prototype.cleanUp=function(){Ji.prototype.cleanUp.call(this),this.data=null},$i.prototype.resume=function(){return!!Ji.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Zi.delay(this._tickAndRepeat,[],this)),!0)},$i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(Zi.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},$i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};var Qi=$i,eo=Li();var to=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var ro=function(e,t){return void 0!==e&&e.length?"string"!==eo.getTypeOf(e)?function(e,t,r,n){var i=to,o=n+r;e=~e;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return~e}(0|t,e,e.length,0):function(e,t,r,n){var i=to,o=n+r;e=~e;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length,0):0},no=Ii,io=ro;function oo(){no.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}Li().inherits(oo,no),oo.prototype.processChunk=function(e){this.streamInfo.crc32=io(e.data,this.streamInfo.crc32||0),this.push(e)};var ao=oo,so=Li(),lo=Ii;function co(e){lo.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}so.inherits(co,lo),co.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}lo.prototype.processChunk.call(this,e)};var uo=ki,ho=Qi,fo=ao,po=co;function vo(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}vo.prototype={getContentWorker:function(){var e=new ho(uo.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new po("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new ho(uo.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},vo.createWorkerFrom=function(e,t,r){return e.pipe(new fo).pipe(new po("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new po("compressedSize")).withStreamInfo("compression",t)};var yo=vo,go=Vi,mo=Qi,bo=oe,xo=yo,Eo=Ii,wo=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};wo.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(t=t.pipe(new bo.Utf8EncodeWorker)),!i&&n&&(t=t.pipe(new bo.Utf8DecodeWorker))}catch(e){(t=new Eo("error")).error(e)}return new go(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof xo&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new bo.Utf8EncodeWorker)),xo.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof xo?this._data.getContentWorker():this._data instanceof Eo?this._data:new mo(this._data)}};for(var So=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_o=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Co=0;Co<So.length;Co++)wo.prototype[So[Co]]=_o;var Ao=wo,To={},Oo={},Mo={},ko={};!function(e){var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(ko);var Lo={},Ro={},Io={},Po=ko,Fo=0,Do=1;function No(e){for(var t=e.length;--t>=0;)e[t]=0}var Bo=0,Uo=29,zo=256,Go=zo+1+Uo,Xo=30,Ho=19,jo=2*Go+1,Wo=15,Yo=16,qo=7,Vo=256,Ko=16,Zo=17,Jo=18,$o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Qo=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ea=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ta=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ra=new Array(2*(Go+2));No(ra);var na=new Array(2*Xo);No(na);var ia=new Array(512);No(ia);var oa=new Array(256);No(oa);var aa=new Array(Uo);No(aa);var sa,la,ca,ua=new Array(Xo);function ha(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function da(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function fa(e){return e<256?ia[e]:ia[256+(e>>>7)]}function pa(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function va(e,t,r){e.bi_valid>Yo-r?(e.bi_buf|=t<<e.bi_valid&65535,pa(e,e.bi_buf),e.bi_buf=t>>Yo-e.bi_valid,e.bi_valid+=r-Yo):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function ya(e,t,r){va(e,r[2*t],r[2*t+1])}function ga(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function ma(e,t,r){var n,i,o=new Array(Wo+1),a=0;for(n=1;n<=Wo;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=ga(o[s]++,s))}}function ba(e){var t;for(t=0;t<Go;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Xo;t++)e.dyn_dtree[2*t]=0;for(t=0;t<Ho;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Vo]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function xa(e){e.bi_valid>8?pa(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Ea(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function wa(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&Ea(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Ea(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function Sa(e,t,r){var n,i,o,a,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?ya(e,i,t):(ya(e,(o=oa[i])+zo+1,t),0!==(a=$o[o])&&va(e,i-=aa[o],a),ya(e,o=fa(--n),r),0!==(a=Qo[o])&&va(e,n-=ua[o],a))}while(s<e.last_lit);ya(e,Vo,t)}function _a(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=jo,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)wa(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],wa(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,wa(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,v=0;for(o=0;o<=Wo;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<jo;r++)(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(o=p,v++),l[2*n+1]=o,n>c||(e.bl_count[o]++,a=0,n>=f&&(a=d[n-f]),s=l[2*n],e.opt_len+=s*(o+a),h&&(e.static_len+=s*(u[2*n+1]+a)));if(0!==v){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,v-=2}while(v>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>c||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),ma(o,c,e.bl_count)}function Ca(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*Ko]++):s<=10?e.bl_tree[2*Zo]++:e.bl_tree[2*Jo]++,s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))}function Aa(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)do{ya(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(ya(e,i,e.bl_tree),s--),ya(e,Ko,e.bl_tree),va(e,s-3,2)):s<=10?(ya(e,Zo,e.bl_tree),va(e,s-3,3)):(ya(e,Jo,e.bl_tree),va(e,s-11,7));s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}}No(ua);var Ta=!1;function Oa(e,t,r,n){va(e,(Bo<<1)+(n?1:0),3),function(e,t,r,n){xa(e),pa(e,r),pa(e,~r),Po.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}Io._tr_init=function(e){Ta||(!function(){var e,t,r,n,i,o=new Array(Wo+1);for(r=0,n=0;n<Uo-1;n++)for(aa[n]=r,e=0;e<1<<$o[n];e++)oa[r++]=n;for(oa[r-1]=n,i=0,n=0;n<16;n++)for(ua[n]=i,e=0;e<1<<Qo[n];e++)ia[i++]=n;for(i>>=7;n<Xo;n++)for(ua[n]=i<<7,e=0;e<1<<Qo[n]-7;e++)ia[256+i++]=n;for(t=0;t<=Wo;t++)o[t]=0;for(e=0;e<=143;)ra[2*e+1]=8,e++,o[8]++;for(;e<=255;)ra[2*e+1]=9,e++,o[9]++;for(;e<=279;)ra[2*e+1]=7,e++,o[7]++;for(;e<=287;)ra[2*e+1]=8,e++,o[8]++;for(ma(ra,Go+1,o),e=0;e<Xo;e++)na[2*e+1]=5,na[2*e]=ga(e,5);sa=new ha(ra,$o,zo+1,Go,Wo),la=new ha(na,Qo,0,Xo,Wo),ca=new ha(new Array(0),ea,0,Ho,qo)}(),Ta=!0),e.l_desc=new da(e.dyn_ltree,sa),e.d_desc=new da(e.dyn_dtree,la),e.bl_desc=new da(e.bl_tree,ca),e.bi_buf=0,e.bi_valid=0,ba(e)},Io._tr_stored_block=Oa,Io._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return Fo;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Do;for(t=32;t<zo;t++)if(0!==e.dyn_ltree[2*t])return Do;return Fo}(e)),_a(e,e.l_desc),_a(e,e.d_desc),a=function(e){var t;for(Ca(e,e.dyn_ltree,e.l_desc.max_code),Ca(e,e.dyn_dtree,e.d_desc.max_code),_a(e,e.bl_desc),t=Ho-1;t>=3&&0===e.bl_tree[2*ta[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?Oa(e,t,r,n):4===e.strategy||o===i?(va(e,2+(n?1:0),3),Sa(e,ra,na)):(va(e,4+(n?1:0),3),function(e,t,r,n){var i;for(va(e,t-257,5),va(e,r-1,5),va(e,n-4,4),i=0;i<n;i++)va(e,e.bl_tree[2*ta[i]+1],3);Aa(e,e.dyn_ltree,t-1),Aa(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Sa(e,e.dyn_ltree,e.dyn_dtree)),ba(e),n&&xa(e)},Io._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(oa[r]+zo+1)]++,e.dyn_dtree[2*fa(t)]++),e.last_lit===e.lit_bufsize-1},Io._tr_align=function(e){va(e,2,3),ya(e,Vo,ra),function(e){16===e.bi_valid?(pa(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)};var Ma=function(e,t,r,n){for(var i=65535&e,o=e>>>16&65535,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16};var ka=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var La,Ra=function(e,t,r,n){var i=ka,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return~e},Ia={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Pa=ko,Fa=Io,Da=Ma,Na=Ra,Ba=Ia,Ua=0,za=4,Ga=0,Xa=-2,Ha=-1,ja=4,Wa=2,Ya=8,qa=9,Va=286,Ka=30,Za=19,Ja=2*Va+1,$a=15,Qa=3,es=258,ts=es+Qa+1,rs=42,ns=103,is=113,os=666,as=1,ss=2,ls=3,cs=4;function us(e,t){return e.msg=Ba[t],t}function hs(e){return(e<<1)-(e>4?9:0)}function ds(e){for(var t=e.length;--t>=0;)e[t]=0}function fs(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(Pa.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function ps(e,t){Fa._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,fs(e.strm)}function vs(e,t){e.pending_buf[e.pending++]=t}function ys(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function gs(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,Pa.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=Da(e.adler,t,i,r):2===e.state.wrap&&(e.adler=Na(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function ms(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-ts?e.strstart-(e.w_size-ts):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+es,f=c[o+a-1],p=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===p&&c[r+a-1]===f&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<d);if(n=es-(d-o),o=d-es,n>a){if(e.match_start=t,a=n,n>=s)break;f=c[o+a-1],p=c[o+a]}}}while((t=h[t&u])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function bs(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-ts)){Pa.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);t=r=a;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=gs(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=Qa)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+Qa-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<Qa)););}while(e.lookahead<ts&&0!==e.strm.avail_in)}function xs(e,t){for(var r,n;;){if(e.lookahead<ts){if(bs(e),e.lookahead<ts&&t===Ua)return as;if(0===e.lookahead)break}if(r=0,e.lookahead>=Qa&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qa-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-ts&&(e.match_length=ms(e,r)),e.match_length>=Qa)if(n=Fa._tr_tally(e,e.strstart-e.match_start,e.match_length-Qa),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Qa){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qa-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=Fa._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(ps(e,!1),0===e.strm.avail_out))return as}return e.insert=e.strstart<Qa-1?e.strstart:Qa-1,t===za?(ps(e,!0),0===e.strm.avail_out?ls:cs):e.last_lit&&(ps(e,!1),0===e.strm.avail_out)?as:ss}function Es(e,t){for(var r,n,i;;){if(e.lookahead<ts){if(bs(e),e.lookahead<ts&&t===Ua)return as;if(0===e.lookahead)break}if(r=0,e.lookahead>=Qa&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qa-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Qa-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-ts&&(e.match_length=ms(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===Qa&&e.strstart-e.match_start>4096)&&(e.match_length=Qa-1)),e.prev_length>=Qa&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Qa,n=Fa._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-Qa),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Qa-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=Qa-1,e.strstart++,n&&(ps(e,!1),0===e.strm.avail_out))return as}else if(e.match_available){if((n=Fa._tr_tally(e,0,e.window[e.strstart-1]))&&ps(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return as}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Fa._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Qa-1?e.strstart:Qa-1,t===za?(ps(e,!0),0===e.strm.avail_out?ls:cs):e.last_lit&&(ps(e,!1),0===e.strm.avail_out)?as:ss}function ws(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function Ss(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ya,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Pa.Buf16(2*Ja),this.dyn_dtree=new Pa.Buf16(2*(2*Ka+1)),this.bl_tree=new Pa.Buf16(2*(2*Za+1)),ds(this.dyn_ltree),ds(this.dyn_dtree),ds(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Pa.Buf16($a+1),this.heap=new Pa.Buf16(2*Va+1),ds(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Pa.Buf16(2*Va+1),ds(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _s(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Wa,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?rs:is,e.adler=2===t.wrap?0:1,t.last_flush=Ua,Fa._tr_init(t),Ga):us(e,Xa)}function Cs(e){var t,r=_s(e);return r===Ga&&((t=e.state).window_size=2*t.w_size,ds(t.head),t.max_lazy_match=La[t.level].max_lazy,t.good_match=La[t.level].good_length,t.nice_match=La[t.level].nice_length,t.max_chain_length=La[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Qa-1,t.match_available=0,t.ins_h=0),r}function As(e,t,r,n,i,o){if(!e)return Xa;var a=1;if(t===Ha&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>qa||r!==Ya||n<8||n>15||t<0||t>9||o<0||o>ja)return us(e,Xa);8===n&&(n=9);var s=new Ss;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Qa-1)/Qa),s.window=new Pa.Buf8(2*s.w_size),s.head=new Pa.Buf16(s.hash_size),s.prev=new Pa.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Pa.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,Cs(e)}La=[new ws(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(bs(e),0===e.lookahead&&t===Ua)return as;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,ps(e,!1),0===e.strm.avail_out))return as;if(e.strstart-e.block_start>=e.w_size-ts&&(ps(e,!1),0===e.strm.avail_out))return as}return e.insert=0,t===za?(ps(e,!0),0===e.strm.avail_out?ls:cs):(e.strstart>e.block_start&&(ps(e,!1),e.strm.avail_out),as)})),new ws(4,4,8,4,xs),new ws(4,5,16,8,xs),new ws(4,6,32,32,xs),new ws(4,4,16,16,Es),new ws(8,16,32,32,Es),new ws(8,16,128,128,Es),new ws(8,32,128,256,Es),new ws(32,128,258,1024,Es),new ws(32,258,258,4096,Es)],Ro.deflateInit=function(e,t){return As(e,t,Ya,15,8,0)},Ro.deflateInit2=As,Ro.deflateReset=Cs,Ro.deflateResetKeep=_s,Ro.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?Xa:(e.state.gzhead=t,Ga):Xa},Ro.deflate=function(e,t){var r,n,i,o;if(!e||!e.state||t>5||t<0)return e?us(e,Xa):Xa;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===os&&t!==za)return us(e,0===e.avail_out?-5:Xa);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===rs)if(2===n.wrap)e.adler=0,vs(n,31),vs(n,139),vs(n,8),n.gzhead?(vs(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),vs(n,255&n.gzhead.time),vs(n,n.gzhead.time>>8&255),vs(n,n.gzhead.time>>16&255),vs(n,n.gzhead.time>>24&255),vs(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),vs(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(vs(n,255&n.gzhead.extra.length),vs(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Na(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(vs(n,0),vs(n,0),vs(n,0),vs(n,0),vs(n,0),vs(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),vs(n,3),n.status=is);else{var a=Ya+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=is,ys(n,a),0!==n.strstart&&(ys(n,e.adler>>>16),ys(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=Na(e.adler,n.pending_buf,n.pending-i,i)),fs(e),i=n.pending,n.pending!==n.pending_buf_size));)vs(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=Na(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Na(e.adler,n.pending_buf,n.pending-i,i)),fs(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,vs(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Na(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Na(e.adler,n.pending_buf,n.pending-i,i)),fs(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,vs(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Na(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=ns)}else n.status=ns;if(n.status===ns&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&fs(e),n.pending+2<=n.pending_buf_size&&(vs(n,255&e.adler),vs(n,e.adler>>8&255),e.adler=0,n.status=is)):n.status=is),0!==n.pending){if(fs(e),0===e.avail_out)return n.last_flush=-1,Ga}else if(0===e.avail_in&&hs(t)<=hs(r)&&t!==za)return us(e,-5);if(n.status===os&&0!==e.avail_in)return us(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==Ua&&n.status!==os){var s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(bs(e),0===e.lookahead)){if(t===Ua)return as;break}if(e.match_length=0,r=Fa._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(ps(e,!1),0===e.strm.avail_out))return as}return e.insert=0,t===za?(ps(e,!0),0===e.strm.avail_out?ls:cs):e.last_lit&&(ps(e,!1),0===e.strm.avail_out)?as:ss}(n,t):3===n.strategy?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=es){if(bs(e),e.lookahead<=es&&t===Ua)return as;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=Qa&&e.strstart>0&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=e.strstart+es;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=es-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Qa?(r=Fa._tr_tally(e,1,e.match_length-Qa),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Fa._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(ps(e,!1),0===e.strm.avail_out))return as}return e.insert=0,t===za?(ps(e,!0),0===e.strm.avail_out?ls:cs):e.last_lit&&(ps(e,!1),0===e.strm.avail_out)?as:ss}(n,t):La[n.level].func(n,t);if(s!==ls&&s!==cs||(n.status=os),s===as||s===ls)return 0===e.avail_out&&(n.last_flush=-1),Ga;if(s===ss&&(1===t?Fa._tr_align(n):5!==t&&(Fa._tr_stored_block(n,0,0,!1),3===t&&(ds(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),fs(e),0===e.avail_out))return n.last_flush=-1,Ga}return t!==za?Ga:n.wrap<=0?1:(2===n.wrap?(vs(n,255&e.adler),vs(n,e.adler>>8&255),vs(n,e.adler>>16&255),vs(n,e.adler>>24&255),vs(n,255&e.total_in),vs(n,e.total_in>>8&255),vs(n,e.total_in>>16&255),vs(n,e.total_in>>24&255)):(ys(n,e.adler>>>16),ys(n,65535&e.adler)),fs(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Ga:1)},Ro.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==rs&&69!==t&&73!==t&&91!==t&&t!==ns&&t!==is&&t!==os?us(e,Xa):(e.state=null,t===is?us(e,-3):Ga):Xa},Ro.deflateSetDictionary=function(e,t){var r,n,i,o,a,s,l,c,u=t.length;if(!e||!e.state)return Xa;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==rs||r.lookahead)return Xa;for(1===o&&(e.adler=Da(e.adler,t,u,0)),r.wrap=0,u>=r.w_size&&(0===o&&(ds(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new Pa.Buf8(r.w_size),Pa.arraySet(c,t,u-r.w_size,r.w_size,0),t=c,u=r.w_size),a=e.avail_in,s=e.next_in,l=e.input,e.avail_in=u,e.next_in=0,e.input=t,bs(r);r.lookahead>=Qa;){n=r.strstart,i=r.lookahead-(Qa-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+Qa-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=Qa-1,bs(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Qa-1,r.match_available=0,e.next_in=s,e.input=l,e.avail_in=a,r.wrap=o,Ga},Ro.deflateInfo="pako deflate (from Nodeca project)";var Ts={},Os=ko,Ms=!0,ks=!0;try{String.fromCharCode.apply(null,[0])}catch(e){Ms=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){ks=!1}for(var Ls=new Os.Buf8(256),Rs=0;Rs<256;Rs++)Ls[Rs]=Rs>=252?6:Rs>=248?5:Rs>=240?4:Rs>=224?3:Rs>=192?2:1;function Is(e,t){if(t<65534&&(e.subarray&&ks||!e.subarray&&Ms))return String.fromCharCode.apply(null,Os.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}Ls[254]=Ls[254]=1,Ts.string2buf=function(e){var t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Os.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},Ts.buf2binstring=function(e){return Is(e,e.length)},Ts.binstring2buf=function(e){for(var t=new Os.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},Ts.buf2string=function(e,t){var r,n,i,o,a=t||e.length,s=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)s[n++]=i;else if((o=Ls[i])>4)s[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<a;)i=i<<6|63&e[r++],o--;o>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return Is(s,n)},Ts.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Ls[e[r]]>t?r:t};var Ps=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Fs=Ro,Ds=ko,Ns=Ts,Bs=Ia,Us=Ps,zs=Object.prototype.toString,Gs=0,Xs=-1,Hs=0,js=8;function Ws(e){if(!(this instanceof Ws))return new Ws(e);this.options=Ds.assign({level:Xs,method:js,chunkSize:16384,windowBits:15,memLevel:8,strategy:Hs,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Us,this.strm.avail_out=0;var r=Fs.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Gs)throw new Error(Bs[r]);if(t.header&&Fs.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?Ns.string2buf(t.dictionary):"[object ArrayBuffer]"===zs.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=Fs.deflateSetDictionary(this.strm,n))!==Gs)throw new Error(Bs[r]);this._dict_set=!0}}function Ys(e,t){var r=new Ws(t);if(r.push(e,!0),r.err)throw r.msg||Bs[r.err];return r.result}Ws.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=Ns.string2buf(e):"[object ArrayBuffer]"===zs.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new Ds.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=Fs.deflate(i,n))&&r!==Gs)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(Ns.buf2binstring(Ds.shrinkBuf(i.output,i.next_out))):this.onData(Ds.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=Fs.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Gs):2!==n||(this.onEnd(Gs),i.avail_out=0,!0)},Ws.prototype.onData=function(e){this.chunks.push(e)},Ws.prototype.onEnd=function(e){e===Gs&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ds.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Lo.Deflate=Ws,Lo.deflate=Ys,Lo.deflateRaw=function(e,t){return(t=t||{}).raw=!0,Ys(e,t)},Lo.gzip=function(e,t){return(t=t||{}).gzip=!0,Ys(e,t)};var qs={},Vs={},Ks=ko,Zs=15,Js=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],$s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Qs=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],el=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],tl=ko,rl=Ma,nl=Ra,il=function(e,t){var r,n,i,o,a,s,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C,A;r=e.state,n=e.next_in,C=e.input,i=n+(e.avail_in-5),o=e.next_out,A=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,v=r.lencode,y=r.distcode,g=(1<<r.lenbits)-1,m=(1<<r.distbits)-1;e:do{p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=v[f&g];t:for(;;){if(f>>>=x=b>>>24,p-=x,0===(x=b>>>16&255))A[o++]=65535&b;else{if(!(16&x)){if(64&x){if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}b=v[(65535&b)+(f&(1<<x)-1)];continue t}for(E=65535&b,(x&=15)&&(p<x&&(f+=C[n++]<<p,p+=8),E+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=y[f&m];;){if(f>>>=x=b>>>24,p-=x,16&(x=b>>>16&255)){if(w=65535&b,p<(x&=15)&&(f+=C[n++]<<p,(p+=8)<x&&(f+=C[n++]<<p,p+=8)),(w+=f&(1<<x)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=x,p-=x,w>(x=o-a)){if((x=w-x)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=0,_=d,0===h){if(S+=c-x,x<E){E-=x;do{A[o++]=d[S++]}while(--x);S=o-w,_=A}}else if(h<x){if(S+=c+h-x,(x-=h)<E){E-=x;do{A[o++]=d[S++]}while(--x);if(S=0,h<E){E-=x=h;do{A[o++]=d[S++]}while(--x);S=o-w,_=A}}}else if(S+=h-x,x<E){E-=x;do{A[o++]=d[S++]}while(--x);S=o-w,_=A}for(;E>2;)A[o++]=_[S++],A[o++]=_[S++],A[o++]=_[S++],E-=3;E&&(A[o++]=_[S++],E>1&&(A[o++]=_[S++]))}else{S=o-w;do{A[o++]=A[S++],A[o++]=A[S++],A[o++]=A[S++],E-=3}while(E>2);E&&(A[o++]=A[S++],E>1&&(A[o++]=A[S++]))}break}if(64&x){e.msg="invalid distance code",r.mode=30;break e}b=y[(65535&b)+(f&(1<<x)-1)]}}break}}while(n<i&&o<s);n-=E=p>>3,f&=(1<<(p-=E<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=f,r.bits=p},ol=function(e,t,r,n,i,o,a,s){var l,c,u,h,d,f,p,v,y,g=s.bits,m=0,b=0,x=0,E=0,w=0,S=0,_=0,C=0,A=0,T=0,O=null,M=0,k=new Ks.Buf16(16),L=new Ks.Buf16(16),R=null,I=0;for(m=0;m<=Zs;m++)k[m]=0;for(b=0;b<n;b++)k[t[r+b]]++;for(w=g,E=Zs;E>=1&&0===k[E];E--);if(w>E&&(w=E),0===E)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(x=1;x<E&&0===k[x];x++);for(w<x&&(w=x),C=1,m=1;m<=Zs;m++)if(C<<=1,(C-=k[m])<0)return-1;if(C>0&&(0===e||1!==E))return-1;for(L[1]=0,m=1;m<Zs;m++)L[m+1]=L[m]+k[m];for(b=0;b<n;b++)0!==t[r+b]&&(a[L[t[r+b]]++]=b);if(0===e?(O=R=a,f=19):1===e?(O=Js,M-=257,R=$s,I-=257,f=256):(O=Qs,R=el,f=-1),T=0,b=0,m=x,d=o,S=w,_=0,u=-1,h=(A=1<<w)-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){p=m-_,a[b]<f?(v=0,y=a[b]):a[b]>f?(v=R[I+a[b]],y=O[M+a[b]]):(v=96,y=0),l=1<<m-_,x=c=1<<S;do{i[d+(T>>_)+(c-=l)]=p<<24|v<<16|y}while(0!==c);for(l=1<<m-1;T&l;)l>>=1;if(0!==l?(T&=l-1,T+=l):T=0,b++,0==--k[m]){if(m===E)break;m=t[r+a[b]]}if(m>w&&(T&h)!==u){for(0===_&&(_=w),d+=x,C=1<<(S=m-_);S+_<E&&!((C-=k[S+_])<=0);)S++,C<<=1;if(A+=1<<S,1===e&&A>852||2===e&&A>592)return 1;i[u=T&h]=w<<24|S<<16|d-o}}return 0!==T&&(i[d+T]=m-_<<24|64<<16),s.bits=w,0},al=1,sl=2,ll=0,cl=-2,ul=1,hl=12,dl=30,fl=852,pl=592;function vl(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function yl(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new tl.Buf16(320),this.work=new tl.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function gl(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=ul,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new tl.Buf32(fl),t.distcode=t.distdyn=new tl.Buf32(pl),t.sane=1,t.back=-1,ll):cl}function ml(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,gl(e)):cl}function bl(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?cl:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,ml(e))):cl}function xl(e,t){var r,n;return e?(n=new yl,e.state=n,n.window=null,(r=bl(e,t))!==ll&&(e.state=null),r):cl}var El,wl,Sl=!0;function _l(e){if(Sl){var t;for(El=new tl.Buf32(512),wl=new tl.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ol(al,e.lens,0,288,El,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ol(sl,e.lens,0,32,wl,0,e.work,{bits:5}),Sl=!1}e.lencode=El,e.lenbits=9,e.distcode=wl,e.distbits=5}function Cl(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new tl.Buf8(o.wsize)),n>=o.wsize?(tl.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),tl.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(tl.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}Vs.inflateReset=ml,Vs.inflateReset2=bl,Vs.inflateResetKeep=gl,Vs.inflateInit=function(e){return xl(e,15)},Vs.inflateInit2=xl,Vs.inflate=function(e,t){var r,n,i,o,a,s,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C,A=0,T=new tl.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return cl;(r=e.state).mode===hl&&(r.mode=13),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,h=s,d=l,S=ll;e:for(;;)switch(r.mode){case ul:if(0===r.wrap){r.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===c){r.check=0,T[0]=255&c,T[1]=c>>>8&255,r.check=nl(r.check,T,2,0),c=0,u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=dl;break}if(8!=(15&c)){e.msg="unknown compression method",r.mode=dl;break}if(u-=4,w=8+(15&(c>>>=4)),0===r.wbits)r.wbits=w;else if(w>r.wbits){e.msg="invalid window size",r.mode=dl;break}r.dmax=1<<w,e.adler=r.check=1,r.mode=512&c?10:hl,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=dl;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=dl;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,r.check=nl(r.check,T,2,0)),c=0,u=0,r.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,T[2]=c>>>16&255,T[3]=c>>>24&255,r.check=nl(r.check,T,4,0)),c=0,u=0,r.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,r.check=nl(r.check,T,2,0)),c=0,u=0,r.mode=5;case 5:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,r.check=nl(r.check,T,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((f=r.length)>s&&(f=s),f&&(r.head&&(w=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),tl.arraySet(r.head.extra,n,o,f,w)),512&r.flags&&(r.check=nl(r.check,n,f,o)),s-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;f=0;do{w=n[o+f++],r.head&&w&&r.length<65536&&(r.head.name+=String.fromCharCode(w))}while(w&&f<s);if(512&r.flags&&(r.check=nl(r.check,n,f,o)),s-=f,o+=f,w)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;f=0;do{w=n[o+f++],r.head&&w&&r.length<65536&&(r.head.comment+=String.fromCharCode(w))}while(w&&f<s);if(512&r.flags&&(r.check=nl(r.check,n,f,o)),s-=f,o+=f,w)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=dl;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=hl;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=vl(c),c=0,u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,2;e.adler=r.check=1,r.mode=hl;case hl:if(5===t||6===t)break e;case 13:if(r.last){c>>>=7&u,u-=7&u,r.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=1&c,u-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(_l(r),r.mode=20,6===t){c>>>=2,u-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=dl}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=dl;break}if(r.length=65535&c,c=0,u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(f=r.length){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;tl.arraySet(i,n,o,f,a),s-=f,o+=f,l-=f,a+=f,r.length-=f;break}r.mode=hl;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=dl;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.lens[O[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,_={bits:r.lenbits},S=ol(0,r.lens,0,19,r.lencode,0,r.work,_),r.lenbits=_.bits,S){e.msg="invalid code lengths set",r.mode=dl;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(A=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,m=65535&A,!((y=A>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(m<16)c>>>=y,u-=y,r.lens[r.have++]=m;else{if(16===m){for(C=y+2;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=y,u-=y,0===r.have){e.msg="invalid bit length repeat",r.mode=dl;break}w=r.lens[r.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===m){for(C=y+3;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=y,w=0,f=3+(7&(c>>>=y)),c>>>=3,u-=3}else{for(C=y+7;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}u-=y,w=0,f=11+(127&(c>>>=y)),c>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=dl;break}for(;f--;)r.lens[r.have++]=w}}if(r.mode===dl)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=dl;break}if(r.lenbits=9,_={bits:r.lenbits},S=ol(al,r.lens,0,r.nlen,r.lencode,0,r.work,_),r.lenbits=_.bits,S){e.msg="invalid literal/lengths set",r.mode=dl;break}if(r.distbits=6,r.distcode=r.distdyn,_={bits:r.distbits},S=ol(sl,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,_),r.distbits=_.bits,S){e.msg="invalid distances set",r.mode=dl;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,il(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===hl&&(r.back=-1);break}for(r.back=0;g=(A=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,m=65535&A,!((y=A>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(g&&!(240&g)){for(b=y,x=g,E=m;g=(A=r.lencode[E+((c&(1<<b+x)-1)>>b)])>>>16&255,m=65535&A,!(b+(y=A>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=y,u-=y,r.back+=y,r.length=m,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=hl;break}if(64&g){e.msg="invalid literal/length code",r.mode=dl;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(C=r.extra;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(A=r.distcode[c&(1<<r.distbits)-1])>>>16&255,m=65535&A,!((y=A>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(!(240&g)){for(b=y,x=g,E=m;g=(A=r.distcode[E+((c&(1<<b+x)-1)>>b)])>>>16&255,m=65535&A,!(b+(y=A>>>24)<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=y,u-=y,r.back+=y,64&g){e.msg="invalid distance code",r.mode=dl;break}r.offset=m,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(C=r.extra;u<C;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=dl;break}r.mode=25;case 25:if(0===l)break e;if(f=d-l,r.offset>f){if((f=r.offset-f)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=dl;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),v=r.window}else v=i,p=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{i[a++]=v[p++]}while(--f);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;i[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[o++]<<u,u+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?nl(r.check,i,d,a-d):rl(r.check,i,d,a-d)),d=l,(r.flags?c:vl(c))!==r.check){e.msg="incorrect data check",r.mode=dl;break}c=0,u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=dl;break}c=0,u=0}r.mode=29;case 29:S=1;break e;case dl:S=-3;break e;case 31:return-4;default:return cl}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<dl&&(r.mode<27||4!==t))&&Cl(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?nl(r.check,i,d,e.next_out-d):rl(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===hl?128:0)+(20===r.mode||15===r.mode?256:0),(0===h&&0===d||4===t)&&S===ll&&(S=-5),S},Vs.inflateEnd=function(e){if(!e||!e.state)return cl;var t=e.state;return t.window&&(t.window=null),e.state=null,ll},Vs.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?(r.head=t,t.done=!1,ll):cl},Vs.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?cl:11===r.mode&&rl(1,t,n,0)!==r.check?-3:Cl(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,ll):cl},Vs.inflateInfo="pako inflate (from Nodeca project)";var Al={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Tl=Vs,Ol=ko,Ml=Ts,kl=Al,Ll=Ia,Rl=Ps,Il=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Pl=Object.prototype.toString;function Fl(e){if(!(this instanceof Fl))return new Fl(e);this.options=Ol.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Rl,this.strm.avail_out=0;var r=Tl.inflateInit2(this.strm,t.windowBits);if(r!==kl.Z_OK)throw new Error(Ll[r]);if(this.header=new Il,Tl.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Ml.string2buf(t.dictionary):"[object ArrayBuffer]"===Pl.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Tl.inflateSetDictionary(this.strm,t.dictionary))!==kl.Z_OK))throw new Error(Ll[r])}function Dl(e,t){var r=new Fl(t);if(r.push(e,!0),r.err)throw r.msg||Ll[r.err];return r.result}Fl.prototype.push=function(e,t){var r,n,i,o,a,s=this.strm,l=this.options.chunkSize,c=this.options.dictionary,u=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?kl.Z_FINISH:kl.Z_NO_FLUSH,"string"==typeof e?s.input=Ml.binstring2buf(e):"[object ArrayBuffer]"===Pl.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new Ol.Buf8(l),s.next_out=0,s.avail_out=l),(r=Tl.inflate(s,kl.Z_NO_FLUSH))===kl.Z_NEED_DICT&&c&&(r=Tl.inflateSetDictionary(this.strm,c)),r===kl.Z_BUF_ERROR&&!0===u&&(r=kl.Z_OK,u=!1),r!==kl.Z_STREAM_END&&r!==kl.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0!==s.avail_out&&r!==kl.Z_STREAM_END&&(0!==s.avail_in||n!==kl.Z_FINISH&&n!==kl.Z_SYNC_FLUSH)||("string"===this.options.to?(i=Ml.utf8border(s.output,s.next_out),o=s.next_out-i,a=Ml.buf2string(s.output,i),s.next_out=o,s.avail_out=l-o,o&&Ol.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(Ol.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(u=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==kl.Z_STREAM_END);return r===kl.Z_STREAM_END&&(n=kl.Z_FINISH),n===kl.Z_FINISH?(r=Tl.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===kl.Z_OK):n!==kl.Z_SYNC_FLUSH||(this.onEnd(kl.Z_OK),s.avail_out=0,!0)},Fl.prototype.onData=function(e){this.chunks.push(e)},Fl.prototype.onEnd=function(e){e===kl.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ol.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},qs.Inflate=Fl,qs.inflate=Dl,qs.inflateRaw=function(e,t){return(t=t||{}).raw=!0,Dl(e,t)},qs.ungzip=Dl;var Nl={};(0,ko.assign)(Nl,Lo,qs,Al);var Bl="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,Ul=Nl,zl=Li(),Gl=Ii,Xl=Bl?"uint8array":"array";function Hl(e,t){Gl.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}Mo.magic="\b\0",zl.inherits(Hl,Gl),Hl.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(zl.transformTo(Xl,e.data),!1)},Hl.prototype.flush=function(){Gl.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Hl.prototype.cleanUp=function(){Gl.prototype.cleanUp.call(this),this._pako=null},Hl.prototype._createPako=function(){this._pako=new Ul[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},Mo.compressWorker=function(e){return new Hl("Deflate",e)},Mo.uncompressWorker=function(){return new Hl("Inflate",{})};var jl=Ii;Oo.STORE={magic:"\0\0",compressWorker:function(){return new jl("STORE compression")},uncompressWorker:function(){return new jl("STORE decompression")}},Oo.DEFLATE=Mo;var Wl={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},Yl=Li(),ql=Ii,Vl=oe,Kl=ro,Zl=Wl,Jl=function(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},$l=function(e,t,r,n,i,o){var a,s,l=e.file,c=e.compression,u=o!==Vl.utf8encode,h=Yl.transformTo("string",o(l.name)),d=Yl.transformTo("string",Vl.utf8encode(l.name)),f=l.comment,p=Yl.transformTo("string",o(f)),v=Yl.transformTo("string",Vl.utf8encode(f)),y=d.length!==l.name.length,g=v.length!==f.length,m="",b="",x="",E=l.dir,w=l.date,S={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(S.crc32=e.crc32,S.compressedSize=e.compressedSize,S.uncompressedSize=e.uncompressedSize);var _=0;t&&(_|=8),u||!y&&!g||(_|=2048);var C,A,T,O=0,M=0;E&&(O|=16),"UNIX"===i?(M=798,O|=(C=l.unixPermissions,A=E,T=C,C||(T=A?16893:33204),(65535&T)<<16)):(M=20,O|=63&(l.dosPermissions||0)),a=w.getUTCHours(),a<<=6,a|=w.getUTCMinutes(),a<<=5,a|=w.getUTCSeconds()/2,s=w.getUTCFullYear()-1980,s<<=4,s|=w.getUTCMonth()+1,s<<=5,s|=w.getUTCDate(),y&&(b=Jl(1,1)+Jl(Kl(h),4)+d,m+="up"+Jl(b.length,2)+b),g&&(x=Jl(1,1)+Jl(Kl(p),4)+v,m+="uc"+Jl(x.length,2)+x);var k="";return k+="\n\0",k+=Jl(_,2),k+=c.magic,k+=Jl(a,2),k+=Jl(s,2),k+=Jl(S.crc32,4),k+=Jl(S.compressedSize,4),k+=Jl(S.uncompressedSize,4),k+=Jl(h.length,2),k+=Jl(m.length,2),{fileRecord:Zl.LOCAL_FILE_HEADER+k+h+m,dirRecord:Zl.CENTRAL_FILE_HEADER+Jl(M,2)+k+Jl(p.length,2)+"\0\0\0\0"+Jl(O,4)+Jl(n,4)+h+m+p}},Ql=function(e){return Zl.DATA_DESCRIPTOR+Jl(e.crc32,4)+Jl(e.compressedSize,4)+Jl(e.uncompressedSize,4)};function ec(e,t,r,n){ql.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}Yl.inherits(ec,ql),ec.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,ql.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},ec.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=$l(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ec.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=$l(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:Ql(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ec.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,i){var o=Yl.transformTo("string",i(n));return Zl.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Jl(e,2)+Jl(e,2)+Jl(t,4)+Jl(r,4)+Jl(o.length,2)+o}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},ec.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ec.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},ec.prototype.resume=function(){return!!ql.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ec.prototype.error=function(e){var t=this._sources;if(!ql.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},ec.prototype.lock=function(){ql.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()};var tc=Oo,rc=ec;To.generateWorker=function(e,t,r){var n=new rc(t.streamFiles,r,t.platform,t.encodeFileName),i=0;try{e.forEach((function(e,r){i++;var o=function(e,t){var r=e||t,n=tc[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,t.compression),a=r.options.compressionOptions||t.compressionOptions||{},s=r.dir,l=r.date;r._compressWorker(o,a).withStreamInfo("file",{name:e,dir:s,date:l,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(n)})),n.entriesCount=i}catch(e){n.error(e)}return n};var nc=Li(),ic=Ii;function oc(e,t){ic.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}nc.inherits(oc,ic),oc.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},oc.prototype.pause=function(){return!!ic.prototype.pause.call(this)&&(this._stream.pause(),!0)},oc.prototype.resume=function(){return!!ic.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};var ac=oc,sc=oe,lc=Li(),cc=Ii,uc=Vi,hc=Ki,dc=yo,fc=Ao,pc=To,vc=Ti,yc=ac,gc=function(e,t,r){var n,i=lc.getTypeOf(t),o=lc.extend(r||{},hc);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=bc(e)),o.createFolders&&(n=mc(e))&&xc.call(this,n,!0);var a="string"===i&&!1===o.binary&&!1===o.base64;r&&void 0!==r.binary||(o.binary=!a),(t instanceof dc&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",i="string");var s=null;s=t instanceof dc||t instanceof cc?t:vc.isNode&&vc.isStream(t)?new yc(e,t):lc.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var l=new fc(e,s,o);this.files[e]=l},mc=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},bc=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},xc=function(e,t){return t=void 0!==t?t:hc.createFolders,e=bc(e),this.files[e]||gc.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function Ec(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var wc={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t},file:function(e,t,r){if(1===arguments.length){if(Ec(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,gc.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(Ec(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=xc.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=lc.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:sc.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");lc.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=pc.generateWorker(this,r,n)}catch(e){(t=new cc("error")).error(e)}return new uc(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}},Sc=wc,_c=Li();function Cc(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}Cc.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return _c.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}};var Ac=Cc,Tc=Ac;function Oc(e){Tc.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}Li().inherits(Oc,Tc),Oc.prototype.byteAt=function(e){return this.data[this.zero+e]},Oc.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o-this.zero;return-1},Oc.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&r===o[1]&&n===o[2]&&i===o[3]},Oc.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Mc=Oc,kc=Ac;function Lc(e){kc.call(this,e)}Li().inherits(Lc,kc),Lc.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},Lc.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},Lc.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},Lc.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Rc=Lc,Ic=Mc;function Pc(e){Ic.call(this,e)}Li().inherits(Pc,Ic),Pc.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Fc=Pc,Dc=Fc;function Nc(e){Dc.call(this,e)}Li().inherits(Nc,Dc),Nc.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Bc=Nc,Uc=Li(),zc=se,Gc=Mc,Xc=Rc,Hc=Bc,jc=Fc,Wc=function(e){var t=Uc.getTypeOf(e);return Uc.checkSupport(t),"string"!==t||zc.uint8array?"nodebuffer"===t?new Hc(e):zc.uint8array?new jc(Uc.transformTo("uint8array",e)):new Gc(Uc.transformTo("array",e)):new Xc(e)},Yc=Wc,qc=Li(),Vc=yo,Kc=ro,Zc=oe,Jc=Oo,$c=se;function Qc(e,t){this.options=e,this.loadOptions=t}Qc.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in Jc)if(Object.prototype.hasOwnProperty.call(Jc,t)&&Jc[t].magic===e)return Jc[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+qc.pretty(this.compressionMethod)+" unknown (inner file : "+qc.transformTo("string",this.fileName)+")");this.decompressed=new Vc(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=Yc(this.extraFields[1].value);this.uncompressedSize===qc.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===qc.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===qc.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===qc.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=$c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Zc.utf8decode(this.fileName),this.fileCommentStr=Zc.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=qc.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=qc.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=Yc(e.value);return 1!==t.readInt(1)||Kc(this.fileName)!==t.readInt(4)?null:Zc.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=Yc(e.value);return 1!==t.readInt(1)||Kc(this.fileComment)!==t.readInt(4)?null:Zc.utf8decode(t.readData(e.length-5))}return null}};var eu=Qc,tu=Wc,ru=Li(),nu=Wl,iu=eu,ou=se;function au(e){this.files=[],this.loadOptions=e}au.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+ru.pretty(t)+", expected "+ru.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=ou.uint8array?"uint8array":"array",r=ru.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(nu.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(nu.CENTRAL_FILE_HEADER);)(e=new iu({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(nu.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,nu.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(nu.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===ru.MAX_VALUE_16BITS||this.diskWithCentralDirStart===ru.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===ru.MAX_VALUE_16BITS||this.centralDirRecords===ru.MAX_VALUE_16BITS||this.centralDirSize===ru.MAX_VALUE_32BITS||this.centralDirOffset===ru.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(nu.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(nu.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,nu.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(nu.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(nu.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(n>0)this.isSignature(t,nu.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=tu(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var su=au,lu=Li(),cu=ki,uu=oe,hu=su,du=ao,fu=Ti;function pu(e){return new cu.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new du);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}function vu(){if(!(this instanceof vu))return new vu;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new vu;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}vu.prototype=Sc,vu.prototype.loadAsync=function(e,t){var r=this;return t=lu.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:uu.utf8decode}),fu.isNode&&fu.isStream(e)?cu.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):lu.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new hu(t);return r.load(e),r})).then((function(e){var r=[cu.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var i=0;i<n.length;i++)r.push(pu(n[i]));return cu.Promise.all(r)})).then((function(e){for(var n=e.shift(),i=n.files,o=0;o<i.length;o++){var a=i[o],s=a.fileNameStr,l=lu.resolve(a.fileNameStr);r.file(l,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(r.file(l).unsafeOriginalName=s)}return n.zipComment.length&&(r.comment=n.zipComment),r}))},vu.support=se,vu.defaults=Ki,vu.version="3.10.1",vu.loadAsync=function(e,t){return(new vu).loadAsync(e,t)},vu.external=ki;var yu=te(vu),gu=2048,mu=!1,bu={debug:!1,offscreenCanvas:!1,tile:!1,deltaTime:8,maxTextureSize:gu,get MAX_TEXTURE_SIZE(){return this.maxTextureSize},set MAX_TEXTURE_SIZE(e){this.maxTextureSize=e,mu=!0},MAX_TEXTURE_UNITS:8,MAX_VARYING_VECTORS:15,init:function(e,t,r){mu?e<this.maxTextureSize&&(this.maxTextureSize=e):this.maxTextureSize=Math.min(gu,e),gu=e,this.MAX_TEXTURE_UNITS=t,this.MAX_VARYING_VECTORS=r},treeLvPadding:16,historyTime:1e3,guidesSnap:8},xu={}.toString;function Eu(e){return function(t){return xu.call(t)==="[object "+e+"]"}}var wu=Eu("Object"),Su=Eu("String"),_u=function(e){return function(t){for(var r=xu.call(t),n=0,i=e.length;n<i;n++)if(r==="[object "+e[n]+"]")return!0;return!1}}(["Function","AsyncFunction","GeneratorFunction"]),Cu=Eu("Number"),Au=Eu("Boolean"),Tu=Eu("Date"),Ou={}.hasOwnProperty,Mu=Ou.toString,ku=Mu.call(Object);function Lu(e){return null==e}function Ru(e){if(!e||"[object Object]"!==xu.call(e))return!1;var t=Object.getPrototypeOf(e);if(!t)return!0;var r=Ou.call(t,"constructor")&&t.constructor;return"function"==typeof r&&Mu.call(r)===ku}function Iu(e){if(Lu(e)||"object"!=typeof e)return e;if(Tu(e))return new Date(e);if(!Ru(e)&&!Array.isArray(e))return e;var t=Array.isArray(e)?[]:{};return Object.keys(e).forEach((function(r){t[r]=Iu(e[r])})),t}function Pu(e,t,r){if(e===t)return!0;if(wu(e)&&wu(t)){for(var n={},i=r||Object.keys(e),o=0,a=i.length;o<a;o++){var s=i[o];if(!t.hasOwnProperty(s)||!Pu(e[s],t[s]))return!1;n[s]=!0}for(o=0,a=(i=r||Object.keys(t)).length;o<a;o++){s=i[o];if(!n.hasOwnProperty(s))return!1}return!0}if(Tu(e)&&Tu(t))return e.getTime()===t.getTime();if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(o=0,a=e.length;o<a;o++)if(!Pu(e[o],t[o]))return!1;return!0}return e===t}var Fu={isNil:Lu,isString:Su,isNumber:Cu,isObject:wu,isBoolean:Au,isDate:Tu,isFunction:_u,isPlainObject:Ru,equal:Pu,extend:function(e,t,r){if(null===t||"object"!=typeof t)return e;r||(r=Object.keys(t));for(var n=0,i=r.length;n<i;){var o=r[n];e[o]=t[o],n++}return e},clone:Iu},Du=1e3/60,Nu={},Bu="function"==typeof OffscreenCanvas&&OffscreenCanvas.prototype.getContext;var Uu,zu,Gu,Xu,Hu,ju,Wu,Yu,qu,Vu,Ku,Zu,Ju,$u,Qu,eh,th,rh,nh,ih={},oh={},ah={},sh=0,lh=0,ch=[],uh=0,hh=[],dh={requestAnimationFrame:function(e){return e?("undefined"!=typeof requestAnimationFrame?(dh.requestAnimationFrame=requestAnimationFrame.bind(null),t=requestAnimationFrame(e)):(t=setTimeout(e,Du),dh.requestAnimationFrame=function(e){return setTimeout(e,Du)}),t):-1;var t},cancelAnimationFrame:function(e){var t;return"undefined"!=typeof cancelAnimationFrame?(dh.cancelAnimationFrame=cancelAnimationFrame.bind(null),t=cancelAnimationFrame(e)):(t=clearTimeout(e),dh.cancelAnimationFrame=function(e){return clearTimeout(e)}),t},now:function(){return"undefined"!=typeof performance?(dh.now=function(){return Math.floor(performance.now())},Math.floor(performance.now())):(dh.now=Date.now.bind(Date),Date.now())},hasOffscreenCanvas:function(e){return e&&Nu.hasOwnProperty(e)},getOffscreenCanvas:function(e,t,r,n){return function(e,t,r,n){var i;i=r?Nu[r]?Nu[r]:Nu[r]=!bu.debug&&bu.offscreenCanvas&&Bu?new OffscreenCanvas(e,t):document.createElement("canvas"):!bu.debug&&bu.offscreenCanvas&&Bu?new OffscreenCanvas(e,t):document.createElement("canvas"),e=Math.ceil(e),t=Math.ceil(t),i.width=e,i.height=t,i.style.position="fixed",i.style.left="9999px",i.style.top="0px",i.style.webkitFontSmoothing="antialiased",i.style.mozOsxFontSmoothing="grayscale",bu.debug&&(i.style.width=e+"px",i.style.height=t+"px"),i instanceof HTMLCanvasElement&&(document.body.appendChild(i),r&&i.setAttribute("key",r));var o=i.getContext("2d",n);return o||dh.error("Total canvas memory use exceeds the maximum limit"),{canvas:i,ctx:o,available:!0,release:function(){this.available&&!bu.debug&&(this.available=!1,o.globalAlpha=1,o.globalCompositeOperation="source-over",o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,e,t),i.width=i.height=0,i instanceof HTMLCanvasElement&&document.body.removeChild(i),i=null)}}}(e,t,r,n)},isWebGLTexture:function(e){if(e&&"undefined"!=typeof WebGLTexture)return e instanceof WebGLTexture},defaultFontFamily:"Arial",defaultFontSize:16,getFontCanvas:function(){return dh.getOffscreenCanvas(16,16,"__$$CHECK_SUPPORT_FONT_FAMILY$$__",{willReadFrequently:!0})},checkSupportFontFamily:function(e){if(e===this.defaultFontFamily)return!0;if(ih.hasOwnProperty(e))return ih[e];var t=dh.getFontCanvas().ctx;t.textAlign="center",t.fillStyle="#000",t.textBaseline="middle",Uu||(t.clearRect(0,0,16,16),t.font="16px "+this.defaultFontFamily,t.fillText("a",8,8),Uu=t.getImageData(0,0,16,16).data),t.clearRect(0,0,16,16),/\s/.test(e)&&(e='"'+e.replace(/"/g,'\\"')+'"'),t.font="16px "+e+","+this.defaultFontFamily,t.fillText("a",8,8);for(var r=t.getImageData(0,0,16,16).data,n=0,i=r.length;n<i;n++)if(Uu[n]!==r[n])return ih[e]=!0;return ih[e]=!1},FONT:ah,loadFont:function(e,t,r){if(_u(t)&&(r=t,t=e),Array.isArray(t)){if(!t.length)return r&&r(null);var n=0,i=t.length,o=[];t.forEach((function(e,t){dh.loadFont(e.fontFamily,e.url,(function(e){o[t]=e,++n===i&&r&&r(o)}))}))}else{if(!t||!Su(t))return dh.error("Load font invalid: "+t),void(r&&r({state:2,success:!1,url:t}));var a=ah[t]=ah[t]||{state:0,task:[]};if(2===a.state)r&&r(a);else if(1===a.state)r&&a.task.push(r);else{if(a.state=1,r&&a.task.push(r),sh>0&&uh>=sh)return void hh.push({fontFamily:e,url:t});function s(e,t,r){if(t instanceof ArrayBuffer)i(t);else{var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){n.response?i(n.response):o()},n.onerror=o,n.send()}function i(n){var i=new FontFace(e,n);if(i.load().then((function(){"undefined"!=typeof document&&document.fonts.add(i),r.state=2,r.success=!0,r.url=t,r.arrayBuffer=n,r.task.splice(0).forEach((function(e){return e(r)}))})).catch(o),uh++,hh.length){var a=hh.shift();s(a.fontFamily,a.url,ah[a.url])}}function o(){if(r.state=2,r.success=!1,r.url=t,r.task.splice(0).forEach((function(e){return e(r)})),uh--,hh.length){var e=hh.shift();s(e.fontFamily,e.url,ah[e.url])}}}uh++,s(e,t,a)}}},addArrayBufferFont:function(e,t){if("undefined"!=typeof document&&"undefined"!=typeof FontFace){var r=new FontFace(e,t);document.fonts.add(r)}},addLocalFont:function(e){if("undefined"!=typeof document&&"undefined"!=typeof FontFace){var t=new FontFace(e,"local(".concat(e));document.fonts.add(t)}},IMG:oh,INIT:0,LOADED:2,LOADING:1,get MAX_LOAD_NUM(){return sh},set MAX_LOAD_NUM(e){sh=parseInt(e)||0},loadImg:function(e,t){if(Array.isArray(e)){if(!e.length)return t&&t([]);var r=0,n=e.length,i=[];e.forEach((function(e,o){dh.loadImg(e,(function(e){i[o]=e,++r===n&&t&&t(i)}))}))}else{if(!e||!Su(e))return dh.error("Loadimg failed: "+e),void(t&&t({state:2,success:!1,url:e}));var o=oh[e]=oh[e]||{state:0,task:[]};if(2===o.state)t&&t(o);else if(1===o.state)t&&o.task.push(t);else{if(o.state=1,t&&o.task.push(t),sh>0&&lh>=sh)return void ch.push(e);function a(e,t){var r=new Image;if(r.onload=function(){if(t.state=2,t.success=!0,t.width=r.width,t.height=r.height,t.source=r,t.url=e,t.task.splice(0).forEach((function(e){e(t)})),lh--,ch.length){var n=ch.shift();a(n,oh[n])}},r.onerror=function(){(t.state=2,t.success=!1,t.url=e,t.task.splice(0).forEach((function(e){return e(t)})),lh--,ch.length)&&a(ch.shift(),t)},"data:"!==e.substr(0,5)){var n=/^(?:\w+:)?\/\/([^/:]+)/.exec(e);n&&("undefined"!=typeof location&&location.hostname===n[1]||(r.crossOrigin="anonymous"))}r.src=e}lh++,a(e,o)}}},loadArrayBufferImg:function(e){return Z(this,void 0,void 0,(function(){var t,r;return J(this,(function(n){return t=new Blob([e]),r=new Image,[2,new Promise((function(e,n){r.onload=function(){e(r)},r.onerror=function(e){n(e)},r.src=URL.createObjectURL(t)}))]}))}))},pdfjsLibWorkerSrc:"https://gw.alipayobjects.com/os/lib/pdfjs-dist/3.11.174/build/pdf.worker.min.js",loadArrayBufferPdf:function(e){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,c;return J(this,(function(u){switch(u.label){case 0:return(t=window.pdfjsLib).GlobalWorkerOptions.workerSrc=dh.pdfjsLibWorkerSrc,r=new Blob([e]),n=URL.createObjectURL(r),[4,t.getDocument(n).promise];case 1:return[4,u.sent().getPage(1)];case 2:return i=u.sent(),o=i.getViewport({scale:1}),(a=document.createElement("canvas")).width=o.width,a.height=o.height,s=a.getContext("2d"),[4,i.render({viewport:o,canvasContext:s,background:"transparent"}).promise];case 3:return u.sent(),[4,new Promise((function(e,t){a.toBlob((function(r){r?e(r):t()}))}))];case 4:return l=u.sent(),c=new Image,[2,new Promise((function(e,t){c.onload=function(){e(c)},c.onerror=function(e){t(e)},c.src=URL.createObjectURL(l)}))]}}))}))},loadLocalFonts:function(){return Z(this,void 0,void 0,(function(){var e;return J(this,(function(t){switch(t.label){case 0:if("undefined"==typeof navigator)return[3,5];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,navigator.permissions.query({name:"local-fonts"})];case 2:return"denied"===t.sent().state?(dh.error("No Permission."),[2,[]]):[4,window.queryLocalFonts()];case 3:return[2,t.sent()];case 4:return e=t.sent(),dh.error(e),[2,[]];case 5:return[2,[]]}}))}))},log:function(e){console.log(e)},warn:function(e){console.warn(e)},error:function(e){console.error(e)}};function fh(e,t){if(void 0===t&&(t=!1),"auto"===e)return{v:0,u:zu.AUTO};var r=parseFloat(e)||0;return/%$/.test(e)?{v:r,u:zu.PERCENT}:/px$/i.test(e)?{v:r,u:zu.PX}:/deg$/i.test(e)?{v:r,u:t?zu.PX:zu.DEG}:{v:r,u:t?zu.PX:zu.NUMBER}}!function(e){e[e.AUTO=0]="AUTO",e[e.PX=1]="PX",e[e.PERCENT=2]="PERCENT",e[e.NUMBER=3]="NUMBER",e[e.DEG=4]="DEG",e[e.RGBA=5]="RGBA",e[e.BOOLEAN=6]="BOOLEAN",e[e.STRING=7]="STRING",e[e.GRADIENT=8]="GRADIENT",e[e.BLUR=9]="BLUR",e[e.PATTERN=10]="PATTERN",e[e.SHADOW=11]="SHADOW",e[e.MATRIX=12]="MATRIX"}(zu||(zu={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.CENTER=2]="CENTER",e[e.JUSTIFY=3]="JUSTIFY"}(Gu||(Gu={})),function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM"}(Xu||(Xu={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.MULTIPLY=1]="MULTIPLY",e[e.SCREEN=2]="SCREEN",e[e.OVERLAY=3]="OVERLAY",e[e.DARKEN=4]="DARKEN",e[e.LIGHTEN=5]="LIGHTEN",e[e.COLOR_DODGE=6]="COLOR_DODGE",e[e.COLOR_BURN=7]="COLOR_BURN",e[e.HARD_LIGHT=8]="HARD_LIGHT",e[e.SOFT_LIGHT=9]="SOFT_LIGHT",e[e.DIFFERENCE=10]="DIFFERENCE",e[e.EXCLUSION=11]="EXCLUSION",e[e.HUE=12]="HUE",e[e.SATURATION=13]="SATURATION",e[e.COLOR=14]="COLOR",e[e.LUMINOSITY=15]="LUMINOSITY"}(Hu||(Hu={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ITALIC=1]="ITALIC",e[e.OBLIQUE=2]="OBLIQUE"}(ju||(ju={})),function(e){e[e.LINEAR=0]="LINEAR",e[e.RADIAL=1]="RADIAL",e[e.CONIC=2]="CONIC"}(Wu||(Wu={})),function(e){e[e.NONE=0]="NONE",e[e.GAUSSIAN=1]="GAUSSIAN",e[e.MOTION=2]="MOTION",e[e.RADIAL=3]="RADIAL",e[e.BACKGROUND=4]="BACKGROUND"}(Yu||(Yu={})),function(e){e[e.NONE=0]="NONE",e[e.UNION=1]="UNION",e[e.SUBTRACT=2]="SUBTRACT",e[e.INTERSECT=3]="INTERSECT",e[e.XOR=4]="XOR"}(qu||(qu={})),function(e){e[e.NONE=0]="NONE",e[e.STRAIGHT=1]="STRAIGHT",e[e.MIRRORED=2]="MIRRORED",e[e.ASYMMETRIC=3]="ASYMMETRIC",e[e.DISCONNECTED=4]="DISCONNECTED"}(Vu||(Vu={})),function(e){e[e.ROUNDED=0]="ROUNDED",e[e.ROUNDED_INVERTED=1]="ROUNDED_INVERTED",e[e.ANGLED=2]="ANGLED",e[e.SQUARED=3]="SQUARED"}(Ku||(Ku={})),function(e){e[e.NON_ZERO=0]="NON_ZERO",e[e.EVEN_ODD=1]="EVEN_ODD"}(Zu||(Zu={})),function(e){e[e.NONE=0]="NONE",e[e.OUTLINE=1]="OUTLINE",e[e.ALPHA=2]="ALPHA",e[e.GRAY=3]="GRAY",e[e.ALPHA_WITH=4]="ALPHA_WITH",e[e.GRAY_WITH=5]="GRAY_WITH"}(Ju||(Ju={})),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE"}($u||($u={})),function(e){e[e.MITER=0]="MITER",e[e.ROUND=1]="ROUND",e[e.BEVEL=2]="BEVEL"}(Qu||(Qu={})),function(e){e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.OUTSIDE=2]="OUTSIDE"}(eh||(eh={})),function(e){e[e.TILE=0]="TILE",e[e.FILL=1]="FILL",e[e.STRETCH=2]="STRETCH",e[e.FIT=3]="FIT"}(th||(th={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN"}(rh||(rh={})),function(e){e[e.AUTO=0]="AUTO",e[e.FIXED_W=1]="FIXED_W",e[e.FIXED_W_H=2]="FIXED_W_H"}(nh||(nh={}));var ph,vh,yh={StyleUnit:zu,calUnit:fh,TEXT_ALIGN:Gu,TEXT_VERTICAL_ALIGN:Xu,MIX_BLEND_MODE:Hu,FONT_STYLE:ju,GRADIENT:Wu,BLUR:Yu,BOOLEAN_OPERATION:qu,CURVE_MODE:Vu,CORNER_STYLE:Ku,FILL_RULE:Zu,MASK:Ju,STROKE_LINE_CAP:$u,STROKE_LINE_JOIN:Qu,STROKE_POSITION:eh,PATTERN_FILL_TYPE:th,TEXT_BEHAVIOUR:nh,VISIBILITY:rh};!function(e){e[e.NONE=0]="NONE",e[e.UNDERLINE=1]="UNDERLINE",e[e.LINE_THROUGH=2]="LINE_THROUGH"}(ph||(ph={})),function(e){e[e.DISABLED=-1]="DISABLED",e[e.LEGACY=0]="LEGACY",e[e.ROUNDED=1]="ROUNDED",e[e.SMOOTH=2]="SMOOTH"}(vh||(vh={}));var gh=function(){var e=0,t=-3;function r(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new r,this.dtree=new r}var i=new r,o=new r,a=new Uint8Array(30),s=new Uint16Array(30),l=new Uint8Array(30),c=new Uint16Array(30),u=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new r,d=new Uint8Array(320);function f(e,t,r,n){var i,o;for(i=0;i<r;++i)e[i]=0;for(i=0;i<30-r;++i)e[i+r]=i/r|0;for(o=n,i=0;i<30;++i)t[i]=o,o+=1<<e[i]}var p=new Uint16Array(16);function v(e,t,r,n){var i,o;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<n;++i)e.table[t[r+i]]++;for(e.table[0]=0,o=0,i=0;i<16;++i)p[i]=o,o+=e.table[i];for(i=0;i<n;++i)t[r+i]&&(e.trans[p[t[r+i]]++]=i)}function y(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function g(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,n+r}function m(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=0,n=0,i=0,o=e.tag;do{n=2*n+(1&o),o>>>=1,++i,r+=t.table[i],n-=t.table[i]}while(n>=0);return e.tag=o,e.bitcount-=i,t.trans[r+n]}function b(e,t,r){var n,i,o,a,s,l;for(n=g(e,5,257),i=g(e,5,1),o=g(e,4,4),a=0;a<19;++a)d[a]=0;for(a=0;a<o;++a){var c=g(e,3,0);d[u[a]]=c}for(v(h,d,0,19),s=0;s<n+i;){var f=m(e,h),p=void 0;switch(f){case 16:for(p=d[s-1],l=g(e,2,3);l;--l)d[s++]=p;break;case 17:for(l=g(e,3,3);l;--l)d[s++]=0;break;case 18:for(l=g(e,7,11);l;--l)d[s++]=0;break;default:d[s++]=f}}v(t,d,0,n),v(r,d,n,i)}function x(t,r,n){for(;;){var i=m(t,r);if(256===i)return e;if(i<256)t.dest[t.destLen++]=i;else{var o,u,h,d=void 0;for(o=g(t,a[i-=257],s[i]),u=m(t,n),d=h=t.destLen-g(t,l[u],c[u]);d<h+o;++d)t.dest[t.destLen++]=t.dest[d]}}}function E(r){for(var n,i;r.bitcount>8;)r.sourceIndex--,r.bitcount-=8;if((n=256*(n=r.source[r.sourceIndex+1])+r.source[r.sourceIndex])!==(65535&~(256*r.source[r.sourceIndex+3]+r.source[r.sourceIndex+2])))return t;for(r.sourceIndex+=4,i=n;i;--i)r.dest[r.destLen++]=r.source[r.sourceIndex++];return r.bitcount=0,e}return function(e,t){var r;for(r=0;r<7;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;r<24;++r)e.trans[r]=256+r;for(r=0;r<144;++r)e.trans[24+r]=r;for(r=0;r<8;++r)e.trans[168+r]=280+r;for(r=0;r<112;++r)e.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}(i,o),f(a,s,4,3),f(l,c,2,1),a[28]=0,s[28]=258,function(r,a){var s,l,c=new n(r,a);do{switch(s=y(c),g(c,2,0)){case 0:l=E(c);break;case 1:l=x(c,i,o);break;case 2:b(c,c.ltree,c.dtree),l=x(c,c.ltree,c.dtree);break;default:l=t}if(l!==e)throw new Error("Data error")}while(!s);return c.destLen<c.dest.length?"function"==typeof c.dest.slice?c.dest.slice(0,c.destLen):c.dest.subarray(0,c.destLen):c.dest}}(),mh={UTF16:function(e,t,r){for(var n=[],i=r/2,o=0;o<i;o++,t+=2)n[o]=e.getUint16(t);return String.fromCharCode.apply(null,n)}},bh={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};function xh(e,t){for(var r="",n=t;n<t+4;n++)r+=String.fromCharCode(e.getInt8(n));return r}function Eh(e,t){return e.getUint16(t,!1)}function wh(e,t){return e.getUint32(t,!1)}mh.MACSTRING=function(e,t,r,n){var i=bh[n];if(void 0!==i){for(var o="",a=0;a<r;a++){var s=e.getUint8(t+a);o+=s<=127?String.fromCharCode(s):i[127&s]}return o}};var Sh={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function _h(e,t){for(var r=[],n=12,i=0;i<t;i+=1){var o=xh(e,n),a=wh(e,n+4),s=wh(e,n+8),l=wh(e,n+12);r.push({tag:o,checksum:a,offset:s,length:l,compression:!1}),n+=16}return r}function Ch(e,t){if("WOFF"===t.compression){var r=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),n=new Uint8Array(t.length);return gh(r,n),n.byteLength!==t.length&&dh.error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length"),{data:new DataView(n.buffer,0),offset:0}}return{data:e,offset:t.offset}}var Ah=function(){function e(e,t){this.data=e,this.offset=t,this.relativeOffset=0}return e.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},e.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},e.prototype.parseULong=function(){var e=wh(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},e.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},e.prototype.parseFixed=function(){var e,t,r=(e=this.data,t=this.offset+this.relativeOffset,e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535);return this.relativeOffset+=4,r},e.prototype.parseVersion=function(e){var t=Eh(this.data,this.offset+this.relativeOffset),r=Eh(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+r/e/10},e.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=Sh[e]*t},e}(),Th=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Oh={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Mh={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},kh={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Lh={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Rh(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return Oh[t];case 3:return Mh[t]}}var Ih="utf-16";function Ph(e,t,r){switch(e){case 0:return Ih;case 1:return Lh[r]||kh[t];case 3:if(1===t||10===t)return Ih}}var Fh={0:"unicode",1:"macintosh",2:"reserved",3:"windows"};function Dh(e){return Fh[e]}function Nh(e,t){var r,n=new Ah(e,t),i=n.parseULong();r="Unsupported ltag table version.",1===i||fail(r),n.skip("uLong",1);for(var o=n.parseULong(),a=[],s=0;s<o;s++){for(var l="",c=t+n.parseUShort(),u=n.parseUShort(),h=c;h<c+u;++h)l+=String.fromCharCode(e.getInt8(h));a.push(l)}return a}var Bh={parse:function(e){var t,r,n=new DataView(e,0),i=xh(n,0),o=!1;if(i===String.fromCharCode(0,1,0,0)||"true"===i||"typ1"===i)r=_h(n,t=Eh(n,4));else if("OTTO"===i)r=_h(n,t=Eh(n,4)),o=!0;else if("wOFF"===i){var a=xh(n,4);if(a===String.fromCharCode(0,1,0,0));else if("OTTO"!==a)return void dh.error("Unsupported OpenType flavor "+i);r=function(e,t){for(var r=[],n=44,i=0;i<t;i+=1){var o=xh(e,n),a=wh(e,n+4),s=wh(e,n+8),l=wh(e,n+12),c=void 0;c=s<l&&"WOFF",r.push({tag:o,offset:a,compression:c,compressedLength:s,length:l}),n+=20}return r}(n,t=Eh(n,12))}else if("wOF2"===i){dh.error("WOFF2 require an external decompressor library, see examples at: https://github.com/opentypejs/opentype.js/issues/183#issuecomment-1147228025")}else dh.error("Unsupported OpenType signature "+i);for(var s,l,c,u,h=2048,d=0,f=!1,p=0;p<t;p++){var v=r[p];if("head"===v.tag){var y=Ch(n,v);(g=new Ah(y.data,y.offset)).parseVersion(),g.parseFixed(),g.parseULong(),g.parseULong(),g.parseUShort(),h=g.parseUShort()}else if("hhea"===v.tag){if(!f){y=Ch(n,v);(g=new Ah(y.data,y.offset)).parseVersion(),s=Math.abs(g.parseShort()),l=Math.abs(g.parseShort()),d=Math.abs(g.parseShort()||0)}}else if("ltag"===v.tag){u=Nh((y=Ch(n,v)).data,y.offset)}else if("name"===v.tag)c=Ch(n,v);else if("OS/2"===v.tag){y=Ch(n,v);var g,m=(g=new Ah(y.data,y.offset)).parseUShort();g.parseShort(),g.parseUShort(),g.parseUShort(),g.parseUShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort(),g.parseShort();for(var b=0;b<10;b++)g.parseByte();g.parseULong(),g.parseULong(),g.parseULong(),g.parseULong(),g.parseByte(),g.parseByte(),g.parseByte(),g.parseByte();var x=g.parseUShort(),E=m>=4&&(128&x||o);(E||void 0===s)&&(g.parseUShort(),g.parseUShort(),s=Math.abs(g.parseShort()),l=Math.abs(g.parseShort()),d=Math.abs(g.parseShort()||0),E&&(f=!0))}}var w=c?function(e,t,r){for(var n={},i=new Ah(e,t),o=i.parseUShort(),a=i.parseUShort(),s=i.offset+i.parseUShort(),l=0;l<a;l++){var c=i.parseUShort(),u=i.parseUShort(),h=i.parseUShort(),d=i.parseUShort(),f=Th[d]||d,p=i.parseUShort(),v=i.parseUShort(),y=Rh(c,h,r),g=Ph(c,u,h),m=Dh(c);if(void 0!==g&&void 0!==y&&void 0!==m){var b=void 0;if(b=g===Ih?mh.UTF16(e,s+v,p):mh.MACSTRING(e,s+v,p,g)){var x=n[m];void 0===x&&(x=n[m]={});var E=x[f];void 0===E&&(E=x[f]={}),E[y]=b}}}return 1===o&&i.parseUShort(),n}(c.data,c.offset,u):{},S={};return w.macintosh&&Object.assign(S,w.macintosh),w.windows&&Object.assign(S,w.windows),{name:S,emSquare:h,ascent:s,descent:l,lineGap:d}}},Uh={name:"Arial",family:"Arial",lhr:1.14990234375,car:1.1171875,blr:.9052734375,lgr:.03271484375,list:[{style:"Regular",postscriptName:"Arial",loaded:!0}]},zh="localFonts",Gh={Arial:Uh},Xh={Arial:Uh},Hh={KEY_INFO:zh,info:Gh,data:Xh,hasRegister:function(e){return Xh.hasOwnProperty(e)},registerLocalFonts:function(e){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,y;return J(this,(function(g){switch(g.label){case 0:return e?[3,2]:[4,dh.loadLocalFonts()];case 1:e=g.sent()||[],g.label=2;case 2:t={},"undefined"!=typeof localStorage&&(t=JSON.parse(localStorage.getItem(zh)||"{}")),r=t.data||{},(!t.version||t.version<2)&&(r={}),n=0,i=e.length,g.label=3;case 3:return n<i?(o=e[n],a=o.postscriptName,s=o.family,l=o.style,dh.addLocalFont(a),r.hasOwnProperty(s)&&(c=r[s],Gh[s]=Gh[s]||{name:c.name,family:s,lhr:c.lhr,car:c.car,blr:c.blr,lgr:c.lgr,list:[]}),Gh.hasOwnProperty(s)?[3,6]:(u=Gh[s]={name:"",family:"",lhr:0,car:0,blr:0,lgr:0,list:[]},[4,o.blob()])):[3,8];case 4:return[4,g.sent().arrayBuffer()];case 5:h=g.sent(),(d=Bh.parse(h))&&d.name&&(u.name=(null===(p=d.name.preferredFamily)||void 0===p?void 0:p.zh)||(null===(v=d.name.preferredFamily)||void 0===v?void 0:v.en)||(null===(y=d.name.fontFamily)||void 0===y?void 0:y.zh)),u.name=u.name||s,u.family=s,f=this._cal(s,d),Object.assign(u,f),g.label=6;case 6:this._register(s,l,a,!0),g.label=7;case 7:return n++,[3,3];case 8:return this.updateLocalStorage(),[2]}}))}))},registerAb:function(e){var t,r,n,i,o,a,s,l,c={},u=Bh.parse(e);u&&u.name&&(c.family=(null===(t=u.name.preferredFamily)||void 0===t?void 0:t.en)||(null===(r=u.name.fontFamily)||void 0===r?void 0:r.en),c.name=(null===(n=u.name.preferredFamily)||void 0===n?void 0:n.zh)||(null===(i=u.name.preferredFamily)||void 0===i?void 0:i.en)||(null===(o=u.name.fontFamily)||void 0===o?void 0:o.zh)||c.family);var h=c.family,d=(null===(a=u.name.preferredSubfamily)||void 0===a?void 0:a.en)||(null===(s=u.name.fontSubfamily)||void 0===s?void 0:s.en),f=null===(l=u.name.postScriptName)||void 0===l?void 0:l.en;if(h&&d&&f){if(!Gh.hasOwnProperty(h)){var p=this._cal(h,u);Object.assign(c,p),c.list=[],Gh[h]=Xh[h]=c}return this._register(h,d,f,!0),dh.addArrayBufferFont(f,e),this.data[h]}},_cal:function(e,t){var r=0;return["times","helvetica","courier"].indexOf(e.toLowerCase())>-1&&(r=Math.round(.15*(t.ascent+t.descent))),{lhr:(t.ascent+r+t.descent+t.lineGap)/t.emSquare,car:(t.ascent+r+t.descent)/t.emSquare,blr:(t.ascent+r)/t.emSquare,lgr:t.lineGap/t.emSquare}},_register:function(e,t,r,n,i){for(var o=Gh[e],a=o.list=o.list||[],s=!1,l=0,c=a.length;l<c;l++){var u=a[l];if(u.postscriptName===r){s=!0,n&&(u.loaded=!0);break}}return s||a.push({style:t,postscriptName:r,loaded:n,url:i}),{family:e,postscriptName:r,data:Xh[e]=Xh[r]=o}},registerData:function(e){var t=this,r=e.family;Gh.hasOwnProperty(r)||(Gh[r]=Xh[r]=e),e.list.forEach((function(e){t._register(r,e.style,e.postscriptName,e.loaded,e.url)}))},updateLocalStorage:function(){var e={};for(var t in Gh)if(Gh.hasOwnProperty(t)){var r=Gh[t];e[t]={name:r.name,lhr:r.lhr,car:r.car,blr:r.blr,lgr:r.lgr}}"undefined"!=typeof localStorage&&localStorage.setItem(zh,JSON.stringify({version:2,data:e}))}};function jh(e,t,r,n){return e*r+t*n}function Wh(e,t,r,n,i,o){return e*n+t*i+r*o}function Yh(e,t,r,n){return e*n-r*t}function qh(e,t,r,n){var i=jh(e,t,r,n),o=Math.pow(r,2)+Math.pow(n,2);return{x:i*r/o,y:i*n/o}}function Vh(e,t,r,n,i){void 0===i&&(i=!1);var o=0;if(t===n)if(r>e)o=1;else{if(!(r<e))return 0;o=-1}else e===r?n>t?o=1/0:n<t&&(o=-1/0):o=jh(e,t,r,n)/(Kh(e,t)*Kh(r,n));return i?o:Math.acos(o)||0}function Kh(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function Zh(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function Jh(e,t){var r=Kh(e,t);return{x:e/r,y:t/r}}function $h(e,t,r,n){return Math.abs(e)<1e-9&&Math.abs(t)<1e-9&&Math.abs(r)<1e-9&&Math.abs(n)<1e-9}function Qh(e,t,r,n,i,o){return Math.abs(e)<1e-9&&Math.abs(t)<1e-9&&Math.abs(r)<1e-9&&Math.abs(n)<1e-9&&Math.abs(i)<1e-9&&Math.abs(o)<1e-9}function ed(e,t,r,n){var i=jh(e,t,r,n)/(Kh(e,t)*Kh(r,n));return i<-1?i=-1:i>1&&(i=1),Math.acos(i)}function td(e,t,r,n,i,o){var a=Wh(e,t,r,n,i,o)/(Zh(e,t,r)*Zh(n,i,o));return a<-1?a=-1:a>1&&(a=1),Math.acos(a)}var rd={dotProduct:jh,dotProduct3:Wh,crossProduct:Yh,crossProduct3:function(e,t,r,n,i,o){return{x:t*o-i*r,y:r*n-o*e,z:e*i-n*t}},projection:qh,includedAngle:Vh,length:Kh,length3:Zh,unitize:Jh,unitize3:function(e,t,r){var n=Zh(e,t,r);return{x:e/n,y:t/n,z:r/n}},angle:ed,angle3:td,isParallel:function(e,t,r,n){if($h(e,t,r,n))return!0;var i=ed(e,t,r,n);return Math.abs(i)<1e-9||Math.PI-Math.abs(i)<1e-9},isParallel3:function(e,t,r,n,i,o){if(Qh(e,t,r,n,i,o))return!0;var a=td(e,t,r,n,i,o);return Math.abs(a)<1e-9||Math.PI-Math.abs(a)<1e-9},isZero:$h,isZero3:Qh};function nd(){return new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function id(e){return!e||!e.length||1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]}function od(e,t){if(id(e))return new Float64Array(t);if(id(t))return new Float64Array(e);for(var r=nd(),n=0;n<4;n++){var i=e[n],o=e[n+4],a=e[n+8],s=e[n+12];r[n]=i*t[0]+o*t[1]+a*t[2]+s*t[3],r[n+4]=i*t[4]+o*t[5]+a*t[6]+s*t[7],r[n+8]=i*t[8]+o*t[9]+a*t[10]+s*t[11],r[n+12]=i*t[12]+o*t[13]+a*t[14]+s*t[15]}return r}function ad(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function sd(e){if(id(e))return nd();var t=new Float64Array(16);t[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],t[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],t[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],t[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],t[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],t[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],t[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],t[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],t[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],t[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],t[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],t[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],t[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],t[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];var r=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12];if(0===r)return nd();r=1/r;for(var n=new Float64Array(16),i=0;i<16;i++)n[i]=t[i]*r;return n}function ld(e,t){return e&&t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e}function cd(e,t,r){return t||r?(e[12]+=e[0]*t+e[4]*r,e[13]+=e[1]*t+e[5]*r,e[14]+=e[2]*t+e[6]*r,e[15]+=e[3]*t+e[7]*r,e):e}function ud(e,t,r){if(!e&&!t)return r;var n=r[3],i=r[7],o=r[11],a=r[15];return r[0]+=n*e,r[1]+=n*t,r[4]+=i*e,r[5]+=i*t,r[8]+=o*e,r[9]+=o*t,r[12]+=a*e,r[13]+=a*t,r}function hd(e,t,r){return t||r?(e[12]+=e[0]*t+e[4]*r,e[13]+=e[1]*t+e[5]*r,e[14]+=e[2]*t+e[6]*r,e[15]+=e[3]*t+e[7]*r,e):e}function dd(e,t){if(!t)return e;var r=Math.sin(t),n=Math.cos(t),i=e[0],o=e[1],a=e[2],s=e[3],l=e[4],c=e[5],u=e[6],h=e[7];return e[0]=i*n+l*r,e[1]=o*n+c*r,e[2]=a*n+u*r,e[3]=s*n+h*r,e[4]=i*-r+l*n,e[5]=o*-r+c*n,e[6]=a*-r+u*n,e[7]=s*-r+h*n,e}function fd(e,t){return 1===t||(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t),e}function pd(e,t){return 1===t||(e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t),e}function vd(e,t){return 1===t||(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t),e}function yd(e,t){if(t&&!id(t)){var r=e.x,n=e.y,i=t[0],o=t[1],a=t[4],s=t[5];return{x:(1===i?r:r*i)+(a?n*a:0)+t[12],y:(1===o?r:r*o)+(s?n*s:0)+t[13]}}return e}function gd(e){if(16===e.length)return sd(e);var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5];if(1===t&&0===r&&0===n&&1===i&&0===o&&0===a)return e;var s=t*i-r*n;return 0===s?e:new Float64Array([i/s,-r/s,-n/s,t/s,(n*a-i*o)/s,(r*o-t*a)/s])}function md(e,t,r,n,i){var o,a,s,l,c=yd({x:e,y:t},i),u=c.x,h=c.y,d=yd({x:r,y:n},i),f=d.x,p=d.y;if(i&&i.length&&(i[1]||i[2]||i[4]||i[6]||i[7]||i[8])){var v=yd({x:r,y:t},i);o=v.x,a=v.y,s=(v=yd({x:e,y:n},i)).x,l=v.y}else o=f,a=h,s=u,l=p;return{x1:u,y1:h,x2:o,y2:a,x3:f,y3:p,x4:s,y4:l}}var bd={identity:nd,isE:id,toE:ad,assignMatrix:ld,inverse:gd,inverse4:sd,calPoint:yd,calRectPoints:md,tfoMultiply:ud,multiplyTfo:cd,multiply:od,multiplyRef:function(e,t){if(id(e))return t;if(id(t))return ld(t,e),t;for(var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],v=t[13],y=t[14],g=t[15],m=0;m<4;m++){var b=e[m],x=e[m+4],E=e[m+8],w=e[m+12];t[m]=b*r+x*n+E*i+w*o,t[m+4]=b*a+x*s+E*l+w*c,t[m+8]=b*u+x*h+E*d+w*f,t[m+12]=b*p+x*v+E*y+w*g}return t},multiplyTranslate:hd,multiplyTranslateX:function(e,t){return t?(e[12]+=e[0]*t,e[13]+=e[1]*t,e[14]+=e[2]*t,e[15]+=e[3]*t,e):e},multiplyTranslateY:function(e,t){return t?(e[12]+=e[4]*t,e[13]+=e[5]*t,e[14]+=e[6]*t,e[15]+=e[7]*t,e):e},multiplyRotateZ:dd,multiplyScale:vd,multiplyScaleX:fd,multiplyScaleY:pd};function xd(e){return e*Math.PI/180}function Ed(e){return 180*e/Math.PI}function wd(e,t,r,n){void 0===n&&(n=!1);for(var i,o=r[0],a=o.x,s=o.y,l=r[0],c=l.x,u=l.y,h=r.length,d=1;d<h;d++){var f=r[d],p=f.x,v=f.y;a=Math.max(a,p),s=Math.max(s,v),c=Math.min(c,p),u=Math.min(u,v)}if(e<c||t<u||e>a||t>s)return!1;if((e<=c||t<=u||e>=a||t>=s)&&!n)return!1;d=0;for(var y=r.length;d<y;d++){var g=r[d],m=g.x,b=g.y,x=r[(d+1)%y],E=x.x,w=x.y,S=Yh(E-m,w-b,e-m,t-b);if(0!==S){if(S=S>0?1:0,void 0===i)i=S;else if(i^S)return!1}else if(n){if(e===m&&t===b||e===E&&t===w)return!0;var _=e-m,C=E-e,A=t-b,T=w-t;if(0===_||0===C){if(A^T)return!0}else if(0===A||0===T){if(_^C)return!0}else if(_^C&&A^T)return!0}}return!0}function Sd(e,t,r,n,i,o,a,s){var l,c;if(void 0===s&&(s=!1),r>=i&&(r=(l=[i,r])[0],i=l[1]),n>=o&&(n=(c=[o,n])[0],o=c[1]),a&&!id(a)){var u=yd({x:r,y:n},a),h=yd({x:i,y:n},a),d=yd({x:i,y:o},a),f=yd({x:r,y:o},a);return wd(e,t,[{x:u.x,y:u.y},{x:h.x,y:h.y},{x:d.x,y:d.y},{x:f.x,y:f.y}])}return s?e>=r&&t>=n&&e<=i&&t<=o:e>r&&t>n&&e<i&&t<o}function _d(e,t,r,n){return Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2))}function Cd(e,t,r){var n=(Math.pow(t,2)+Math.pow(r,2)-Math.pow(e,2))/(2*t*r);return Math.acos(n)||0}function Ad(e,t,r,n,i,o,a,s,l){if(void 0===l&&(l=!1),l){if(e>a||t>s||i>r||o>n)return!1;if((r===i||e===a)&&(n<o||t>s))return!1;if((n===t||t===n)&&(r<i||e>a))return!1}else if(e>=a||t>=s||i>=r||o>=n)return!1;return!0}function Td(e,t,r,n,i,o){var a,s;void 0===o&&(o=!1),e>r&&(e=(a=[r,e])[0],r=a[1]),t>n&&(t=(s=[n,t])[0],n=s[1]);for(var l=0,c=0,u=0,h=0,d=0,f=i.length;d<f;d++){var p=i[d],v=p.x,y=p.y;if(d?(l=Math.min(l,v),c=Math.min(c,y),u=Math.max(u,v),h=Math.max(h,y)):(l=v,c=y,u=v,h=y),o){if(v>=e&&v<=r&&y>=t&&y<=n)return!0}else if(v>e&&v<r&&y>t&&y<n)return!0;var g=i[(d+1)%f],m=g.x,b=g.y;if(v===m){if(v>=e&&v<=r)if(y>=b){if(y>=n&&b<=t)return!0}else if(y<=t&&b>=n)return!0}else if(y===b){if(y>=t&&y<=n)if(v>=m){if(v>=r&&m<=e)return!0}else if(v<=e&&m>=r)return!0}else{var x=m-v,E=b-y,w=(e-v)/x;if(w>=0&&w<=1){var S=y+w*E;if(o&&S>=t&&S<=n||!o&&S>t&&S<n)return!0}var _=(r-v)/x;if(_>=0&&_<=1){S=y+_*E;if(o&&S>=t&&S<=n||!o&&S>t&&S<n)return!0}}}return l<=e&&c<=t&&u>=r&&h>=n}var Od={d2r:xd,r2d:Ed,H:4*(Math.sqrt(2)-1)/3,h:function(e){return e*=.5,(1-Math.cos(e))/Math.sin(e)*4/3},pointInConvexPolygon:wd,pointInRect:Sd,pointsDistance:_d,angleBySides:Cd,isRectsOverlap:Ad,isRectsInside:function(e,t,r,n,i,o,a,s,l){if(void 0===l&&(l=!1),l){if(e<=i&&t<=o&&r>=a&&n>=s)return!0}else if(e<i&&t<o&&r>a&&n>s)return!0;return!1},isConvexPolygonsOverlap:function(e,t,r){void 0===r&&(r=!1);for(var n=0,i=0,o=0,a=0,s=0,l=e.length;s<l;s++){var c=e[s],u=c.x,h=c.y;s?(n=Math.min(n,u),i=Math.min(i,h),o=Math.max(o,u),a=Math.max(a,h)):(n=u,i=h,o=u,a=h)}var d=0,f=0,p=0,v=0;for(s=0,l=t.length;s<l;s++){var y=t[s];u=y.x,h=y.y;s?(d=Math.min(d,u),f=Math.min(f,h),p=Math.max(p,u),v=Math.max(v,h)):(d=u,f=h,p=u,v=h)}if(r){if(n>p||i>v||o<d||a<f)return!1}else if(n>=p||i>=v||o<=d||a<=f)return!1;var g=!0;e:for(s=0,l=e.length;s<l;s++)for(var m=e[s],b=(u=m.x,h=m.y,void 0),x=0,E=t.length;x<E-1;x++){var w=t[x],S=w.x,_=w.y,C=t[(x+1)%E];if(0!==(I=Yh((L=C.x)-S,(R=C.y)-_,u-S,h-_))){if(I=I>0?1:0,void 0===b)b=I;else if(b^I){g=!1;continue e}}else if(r){if(u===S&&h===_||u===L&&h===R)return!0;var A=L-u,T=h-_,O=R-h;if(0===(D=u-S)||0===A){if(T^O)return!0}else if(0===T||0===O){if(D^A)return!0}else if(D^A&&T^O)return!0;g=!1}}if(g)return!0;e:for(s=0,l=t.length;s<l-1;s++)for(var M=t[s],k=(u=M.x,h=M.y,b=void 0,x=0,e.length);x<k-1;x++){var L,R,I,P=e[x],F=(S=P.x,_=P.y,e[(x+1)%k]);if(0!==(I=Yh((L=F.x)-S,(R=F.y)-_,u-S,h-_))){if(I=I>0?1:0,void 0===b)b=I;else if(b^I){g=!1;continue e}}else if(r){if(u===S&&h===_||u===L&&h===R)return!0;var D;A=L-u,T=h-_,O=R-h;if(0===(D=u-S)||0===A){if(T^O)return!0}else if(0===T||0===O){if(D^A)return!0}else if(D^A&&T^O)return!0;g=!1}}return!!g},isConvexPolygonOverlapRect:Td},Md={position:/(([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-?gradient\s*\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i,blur:/(gauss|motion|radial|background)\s*\((.+)\)/i,color:/(?:#[a-f\d]{3,8})|(?:rgba?\s*\(.+?\))/i,number:/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)[pxremvwhina%]*/gi};function kd(e,t){return Ld(e,xd(t))}function Ld(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=e[5]=n,e[1]=r,e[4]=-r,e}function Rd(e,t,r){var n=e.slice(0);return 0===t&&0===r||id(e)?n:n=cd(n=ud(t,r,n),-t,-r)}function Id(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0);var n=nd();n[12]=e.translateX?ap(e.translateX,t):0,n[13]=e.translateY?ap(e.translateY,r):0;var i=e.rotateZ?e.rotateZ.v:0,o=e.scaleX?e.scaleX.v:1,a=e.scaleY?e.scaleY.v:1;return id(n)?kd(n,i):i&&dd(n,xd(i)),1!==o&&(id(n)?n[0]=o:fd(n,o)),1!==a&&(id(n)?n[5]=a:pd(n,a)),n}function Pd(e,t,r){var n=e.slice(0);return n=ud(-t,-r,n=cd(n,t,r))}var Fd={calRotateZ:kd,calRotateZRadian:Ld,calMatrix:Id,calMatrixByOrigin:Rd,calTransformByMatrixAndOrigin:Pd},Dd=1e-9;function Nd(e){var t=[],r=e[3],n=e[2]/r,i=e[1]/r,o=(3*i-n*n)/3,a=(2*n*n*n-9*i*n+27*(e[0]/r))/27,s=n/3,l=a*a/4+o*o*o/27,c=a/2;if(Math.abs(l)<=Dd&&(l=0),l>0){var u=Math.sqrt(l),h=void 0,d=void 0;d=(h=-c+u)>=0?Math.pow(h,1/3):-Math.pow(-h,1/3),(h=-c-u)>=0?d+=Math.pow(h,1/3):d-=Math.pow(-h,1/3),t.push(d-s)}else if(l<0){var f=Math.sqrt(-o/3),p=Math.atan2(Math.sqrt(-l),-c)/3,v=Math.cos(p),y=Math.sin(p),g=Math.sqrt(3);t.push(2*f*v-s),t.push(-f*(v+g*y)-s),t.push(-f*(v-g*y)-s)}else{h=void 0;h=c>=0?-Math.pow(c,1/3):Math.pow(-c,1/3),t.push(2*h-s),t.push(-h-s)}return t}function Bd(e){for(var t=e.length-1,r=t;r>=0&&0===e[r];r--)t--;var n=[];switch(t){case 1:n=function(e){var t=[],r=e[1];return 0!==r&&t.push(-e[0]/r),t}(e);break;case 2:n=function(e){var t=[],r=e[2],n=e[1]/r,i=n*n-e[0]/r*4;if(i>0){var o=Math.sqrt(i);t.push(.5*(-n+o)),t.push(.5*(-n-o))}else 0===i&&t.push(.5*-n);return t}(e);break;case 3:n=Nd(e);break;case 4:n=function(e){var t=[],r=e[4],n=e[3]/r,i=e[2]/r,o=e[1]/r,a=e[0]/r,s=Nd([1,-i,n*o-4*a,-n*n*a+4*i*a-o*o].reverse())[0],l=n*n/4-i+s;if(Math.abs(l)<=Dd&&(l=0),l>0){var c=Math.sqrt(l),u=(p=3*n*n/4-c*c-2*i)+(f=(4*n*i-8*o-n*n*n)/(4*c)),h=p-f;if(Math.abs(u)<=Dd&&(u=0),Math.abs(h)<=Dd&&(h=0),u>=0){var d=Math.sqrt(u);t.push(-n/4+(c+d)/2),t.push(-n/4+(c-d)/2)}h>=0&&(d=Math.sqrt(h),t.push(-n/4+(d-c)/2),t.push(-n/4-(d+c)/2))}else if(l<0);else{var f;if((f=s*s-4*a)>=-1e-9){var p;if(f<0&&(f=0),(p=3*n*n/4-2*i)+(f=2*Math.sqrt(f))>=Dd){var v=Math.sqrt(p+f);t.push(-n/4+v/2),t.push(-n/4-v/2)}p-f>=Dd&&(v=Math.sqrt(p-f),t.push(-n/4+v/2),t.push(-n/4-v/2))}}return t}(e)}return n}function Ud(e,t,r,n){return[n-t,e-r,t*(r-e)-e*(n-t)]}function zd(e,t,r){return[r,-1,t-r*e]}function Gd(e,t,r,n){return t===n?0:e===r?n>t?1/0:-1/0:(n-t)/(r-e)}var Xd={getRoots:Bd,twoPoint2General:Ud,pointSlope2General:zd,lineSlope:Gd};function Hd(e,t,r,n,i,o){var a=Math.min(e,i),s=Math.min(t,o),l=Math.max(e,i),c=Math.max(t,o);if(r<a||n<s||r>l||n>c){var u=(e-r)/(e-2*r+i);isNaN(u)||u<0?u=0:u>1&&(u=1);var h=(t-n)/(t-2*n+o);isNaN(h)||h<0?h=0:h>1&&(h=1);var d=1-u,f=1-h,p=d*d*e+2*d*u*r+u*u*i,v=f*f*t+2*f*h*n+h*h*o;a=Math.min(a,p),s=Math.min(s,v),l=Math.max(l,p),c=Math.max(c,v)}return[a,s,l,c]}function jd(e,t,r,n,i,o,a,s){Array.isArray(e)&&(a=e[3].x,s=e[3].y,i=e[2].x,o=e[2].y,r=e[1].x,n=e[1].y,t=e[0].y,e=e[0].x);var l=Math.min(e,a),c=Math.min(t,s),u=Math.max(e,a),h=Math.max(t,s);(r<l||n<c||r>u||n>h||i<l||o<c||i>u||o>h)&&af(e,t,r,n,i,o,a,s).forEach((function(d){var f=$d([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],d);l=Math.min(l,f.x),c=Math.min(c,f.y),u=Math.max(u,f.x),h=Math.max(h,f.y)}));return[l,c,u,h]}function Wd(e,t,r,n,i,o,a,s){var l=arguments.length;if(Array.isArray(e)){if((l=e.length)<2||l>4)throw new Error("Unsupported order");return 4===l?jd(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y):3===l?Hd(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y):[Math.min(e[0].x,e[1].x),Math.min(e[0].y,e[1].y),Math.max(e[0].x,e[1].x),Math.max(e[0].y,e[1].y)]}if(4===l||void 0===i||void 0===o)return[Math.min(e,r),Math.min(t,n),Math.max(e,r),Math.max(t,n)];if(6===l||void 0===a||void 0===s)return Hd(e,t,r,n,i,o);if(8===l)return jd(e,t,r,n,i,o,a,s);throw new Error("Unsupported order")}function Yd(e,t,r){var n=e,i=(2*t+r)/3,o=(t+2*r)/3;return(n(t)+3*n(i)+3*n(o)+n(r))*(r-t)/8}function qd(e,t,r,n){void 0===n&&(n=1e-9);var i=e,o=(t+r)/2,a=Yd(i,t,r),s=Yd(i,t,o),l=Yd(i,o,r),c=s+l-a;return Math.abs(c)<=15*n?s+l+c/15:qd(i,t,o,n/2)+qd(i,o,r,n/2)}function Vd(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=1),2===e.length){var n=e[0],i=n.x,o=n.y,a=e[1],s=a.x,l=a.y;return Math.sqrt(Math.pow(s-i,2)+Math.pow(l-o,2))}if(e.length>4)throw new Error("Unsupported order");return qd((function(t){var r=Kd(t,e);return Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))}),t,r)}function Kd(e,t,r){if(void 0===r&&(r=1),4===t.length)return function(e,t,r){void 0===r&&(r=1);var n=t[0],i=n.x,o=n.y,a=t[1],s=a.x,l=a.y,c=t[2],u=c.x,h=c.y,d=t[3],f=d.x,p=d.y,v=0,y=0;return 0===r?(v=Math.pow(1-e,3)*i+3*e*Math.pow(1-e,2)*s+3*(1-e)*Math.pow(e,2)*u+Math.pow(e,3)*f,y=Math.pow(1-e,3)*o+3*e*Math.pow(1-e,2)*l+3*(1-e)*Math.pow(e,2)*h+Math.pow(e,3)*p):1===r?(v=3*((1-e)*(1-e)*(s-i)+2*(1-e)*e*(u-s)+e*e*(f-u)),y=3*((1-e)*(1-e)*(l-o)+2*(1-e)*e*(h-l)+e*e*(p-h))):2===r?(v=6*(u-2*s+i)*(1-e)+6*(f-2*u+s)*e,y=6*(h-2*l+o)*(1-e)+6*(p-2*h+l)*e):3===r&&(v=6*(f-3*u+3*s-i),y=6*(p-3*h+3*l-o)),{x:v,y:y}}(e,t,r);if(3===t.length)return function(e,t,r){void 0===r&&(r=1);var n=t[0],i=n.x,o=n.y,a=t[1],s=a.x,l=a.y,c=t[2],u=c.x,h=c.y,d=0,f=0;return 0===r?(d=Math.pow(1-e,2)*i+2*e*(1-e)*s+Math.pow(e,2)*u,f=Math.pow(1-e,2)*o+2*e*(1-e)*l+Math.pow(e,2)*h):1===r?(d=2*(1-e)*(s-i)+2*e*(u-s),f=2*(1-e)*(l-o)+2*e*(h-l)):2===r&&(d=2*(u-2*s+i),f=2*(h-2*l+o)),{x:d,y:f}}(e,t,r);throw new Error("Unsupported order")}function Zd(e,t){var r=e[0],n=r.x,i=r.y,o=e[1],a=o.x,s=o.y,l=(a-n)*t+n,c=(s-i)*t+i;if(2===e.length)return[{x:n,y:i},{x:l,y:c}];var u=e[2],h=u.x,d=u.y,f=(h-a)*t+a,p=(d-s)*t+s,v=(f-l)*t+l,y=(p-c)*t+c;if(4===e.length){var g=e[3];return[{x:n,y:i},{x:l,y:c},{x:v,y:y},{x:(((g.x-h)*t+h-f)*t+f-v)*t+v,y:(((g.y-d)*t+d-p)*t+p-y)*t+y}]}if(3===e.length)return[{x:n,y:i},{x:l,y:c},{x:v,y:y}];throw new Error("Unsupported order")}function Jd(e,t,r){var n;void 0===t&&(t=0),void 0===r&&(r=1),t=Math.max(t,0),t=Math.min(t,1),r=Math.max(r,0),r=Math.min(r,1);var i=e.slice(0);if(0===t&&1===r)return i;var o=r<t;return o&&(t=(n=[r,t])[0],r=n[1]),r<1&&(i=Zd(e,r)),t>0&&(r<1&&(t/=r),i=Zd(i.reverse(),1-t).reverse()),o&&i.reverse(),i}function $d(e,t){if(void 0===t&&(t=0),0===t)return e[0];if(1===t)return e[e.length-1];if(4===e.length)return ef(e,t);if(3===e.length)return Qd(e,t);if(2===e.length)return{x:e[0].x+(e[1].x-e[0].x)*t,y:e[0].y+(e[1].y-e[0].y)*t};throw new Error("Unsupported order")}function Qd(e,t){return{x:e[0].x*(1-t)*(1-t)+2*e[1].x*t*(1-t)+e[2].x*t*t,y:e[0].y*(1-t)*(1-t)+2*e[1].y*t*(1-t)+e[2].y*t*t}}function ef(e,t){return{x:e[0].x*(1-t)*(1-t)*(1-t)+3*e[1].x*t*(1-t)*(1-t)+3*e[2].x*t*t*(1-t)+e[3].x*t*t*t,y:e[0].y*(1-t)*(1-t)*(1-t)+3*e[1].y*t*(1-t)*(1-t)+3*e[2].y*t*t*(1-t)+e[3].y*t*t*t}}function tf(e,t,r,n){if(void 0===n&&(n=1e-9),4===e.length)return function(e,t,r,n){void 0===n&&(n=1e-9);for(var i=vf(e,t,!0),o=vf(e,r,!1),a=[],s=0,l=i.length;s<l;s++)for(var c=i[s],u=0,h=o.length;u<h;u++){var d=o[u],f=Math.abs(c-d);f<=n&&a.push({x:c,y:d,diff:f})}a.sort((function(e,t){return e.diff-t.diff})),a.length>3&&a.splice(3);a=a.map((function(e){return.5*(e.x+e.y)}));var p=[];return a.forEach((function(i){var o=pf(e,i,!0),a=pf(e,i,!1);Math.abs(o-t)<=n&&Math.abs(a-r)<=n&&p.push(i)})),p}(e,t,r,n);if(3===e.length)return function(e,t,r,n){void 0===n&&(n=1e-9);for(var i=vf(e,t,!0),o=vf(e,r,!1),a=[],s=0,l=i.length;s<l;s++)for(var c=i[s],u=0,h=o.length;u<h;u++){var d=o[u],f=Math.abs(c-d);f<=n&&a.push({x:c,y:d,diff:f})}a.sort((function(e,t){return e.diff-t.diff})),a.length>2&&a.splice(2);a=a.map((function(e){return.5*(e.x+e.y)}));var p=[];return a.forEach((function(i){var o=pf(e,i,!0),a=pf(e,i,!1);Math.abs(o-t)<=n&&Math.abs(a-r)<=n&&p.push(i)})),p}(e,t,r,n);if(2===e.length)return function(e,t,r,n){void 0===n&&(n=1e-9);var i=(t-e[0].x)/(e[1].x-e[0].x),o=(r-e[0].y)/(e[1].y-e[0].y);if(Math.abs(i-o)<=n)return[.5*(i+o)];return[]}(e,t,r,n);throw new Error("Unsupported order")}function rf(e,t){if(void 0===t&&(t=0),2===e.length){var r=e[0],n=r.x,i=r.y,o=e[1];return Gd(n,i,o.x,o.y)}if(3===e.length)return nf(e,t);if(4===e.length)return of(e,t);throw new Error("Unsupported order")}function nf(e,t){void 0===t&&(t=0);var r=df(e,t,!0);return 0===r?1/0:df(e,t,!1)/r}function of(e,t){var r=df(e,t,!0);return 0===r?1/0:df(e,t,!1)/r}function af(e,t,r,n,i,o,a,s){var l=arguments.length;if(4===l)return[0,1];if(6===l)return function(e,t,r,n,i,o){var a=(e-r)/(e-2*r+i);isNaN(a)||a<0?a=0:a>1&&(a=1);var s=(t-n)/(t-2*n+o);isNaN(s)||s<0?s=0:s>1&&(s=1);var l=[a];return s!==a&&l.push(s),l.sort((function(e,t){return e-t})),l[0]>0&&l.unshift(0),l[l.length-1]<1&&l.push(1),l}(e,t,r,n,i,o);if(8===l)return function(e,t,r,n,i,o,a,s){var l=-3*t+3*n,c=6*t-12*n+6*o,u=-3*t+9*n-9*o+3*s,h=Bd([-3*e+3*r,6*e-12*r+6*i,-3*e+9*r-9*i+3*a]).filter((function(e){return e>=0&&e<=1})),d=Bd([l,c,u]).filter((function(e){return e>=0&&e<=1})),f=h.concat(d);f.sort((function(e,t){return e-t}));for(var p=f.length-1;p>0;p--)f[p]===f[p-1]&&f.splice(p,1);return f}(e,t,r,n,i,o,a,s);throw new Error("Unsupported order")}function sf(e,t,r){if(void 0===t&&(t=!0),void 0===r&&(r=1e-9),e.length<3||e.length>4)throw new Error("Unsupported order");var n=t?e[0].x:e[0].y,i=t?e[1].x:e[1].y,o=t?e[2].x:e[2].y;if(4===e.length){var a=Bd([3*i-3*n,2*(3*n-6*i+3*o),3*(3*i-n-3*o+(t?e[3].x:e[3].y))]).filter((function(e){return e>r&&e<1-r}));return a.sort((function(e,t){return e-t}))}if(3===e.length){a=Bd([2*(i-n),2*(n-2*i+o)]).filter((function(e){return e>r&&e<1-r}));return a}}function lf(e,t,r){if(void 0===t&&(t=!0),void 0===r&&(r=1e-9),e.length<3||e.length>4)throw new Error("Unsupported order");var n=t?e[0].x:e[0].y,i=t?e[1].x:e[1].y,o=t?e[2].x:e[2].y;if(4===e.length){var a=Bd([2*(3*n-6*i+3*o),6*(3*i-n-3*o+(t?e[3].x:e[3].y))]).filter((function(e){return e>r&&e<1-r}));return console.log(a),a.sort((function(e,t){return e-t}))}if(3===e.length)return(a=2*(n-2*i+o))>r&&a<1-r?[a]:[]}function cf(e,t,r,n){if(void 0===n&&(n=1e-9),e.length<2||e.length>4)throw new Error("Unsupported order");if(2===e.length){var i=e[1].x-e[0].x,o=e[1].y-e[0].y,a=t-e[0].x,s=r-e[0].y,l=Math.sqrt(Math.pow(i,2)+Math.pow(o,2)),c=Math.sqrt(Math.pow(a,2)+Math.pow(s,2)),u=Vh(i,o,a,s,!0),h=void 0,d=i*(h=1===u?-a/l:-1===u?a/l:u===1/0?-s/l:u===-1/0?s/l:c*u/l),f=o*h;return{x:d+=e[0].x,y:f+=e[0].y,d:Math.sqrt(Math.pow(d-t,2)+Math.pow(f-r,2)),t:h}}var p=sf(e,!0),v=sf(e,!1),y=lf(e,!0),g=lf(e,!1),m=[];p&&m.push.apply(m,p),v&&v.forEach((function(e){m.includes(e)||m.push(e)})),y&&y.forEach((function(e){m.includes(e)||m.push(e)})),g&&g.forEach((function(e){m.includes(e)||m.push(e)})),m.sort((function(e,t){return e-t}));var b=[];if(m.forEach((function(i,o){if(!o){var a=uf(e,0,i,t,r,n);void 0!==a&&b.push(a)}var s=uf(e,i,m[o+1]||1,t,r,n);void 0!==s&&b.push(s)})),!m.length){var x=uf(e,0,1,t,r,n);void 0!==x&&b.push(x)}if(b.sort((function(e,t){return e.d-t.d})),b.length)return{x:b[0].x,y:b[0].y,t:b[0].t,d:b[0].d}}function uf(e,t,r,n,i,o,a,s){void 0===o&&(o=1e-9),void 0===a&&(a=3),void 0===s&&(s=30);var l=[],c=hf(e,t,r,t,n,i,o,a,s);if(c&&l.push(c),1===r){var u=hf(e,t,r,r,n,i,o,a,s);u&&l.push(u)}var h=hf(e,t,r,.5*(t+r),n,i,o,a,s);if(h&&l.push(h),l.length)return l.sort((function(e,t){return e.d-t.d})),l[0]}function hf(e,t,r,n,i,o,a,s,l){void 0===a&&(a=1e-9),void 0===s&&(s=5),void 0===l&&(l=30);for(var c=n,u=0;u++<l;){var h=pf(e,n,!0)-i,d=pf(e,n,!1)-o,f=df(e,n,!0),p=df(e,n,!1),v=ff(e,n,!0),y=ff(e,n,!1),g=h*f+d*p,m=Math.pow(f,2)+h*v+Math.pow(p,2)+d*y;if(m<0)return;if((n-=g/m)>r?n=r:n<t&&(n=t),u>s){var b=pf(e,n,!0),x=pf(e,n,!1),E=pf(e,c,!0),w=pf(e,c,!1),S=Math.sqrt(Math.pow(b-E,2)+Math.pow(x-w,2));if(Math.abs(S)<a)break}c=n}var _=pf(e,n,!0),C=pf(e,n,!1);return{x:_,y:C,t:n,d:Math.sqrt(Math.pow(i-_,2)+Math.pow(o-C,2))}}function df(e,t,r){if(void 0===r&&(r=!0),e.length<3||e.length>4)throw new Error("Unsupported order");var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y,o=r?e[2].x:e[2].y;return 3===e.length?2*(n-2*i+o)*t+2*(i-n):4===e.length?3*(3*i-n-3*o+(r?e[3].x:e[3].y))*t*t+2*(3*n-6*i+3*o)*t+3*i-3*n:void 0}function ff(e,t,r){if(void 0===r&&(r=!0),e.length<2||e.length>4)throw new Error("Unsupported order");if(2===e.length)return 0;var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y,o=r?e[2].x:e[2].y;return 3===e.length?2*(n-2*i+o):4===e.length?6*(3*i-n-3*o+(r?e[3].x:e[3].y))*t+2*(3*n-6*i+3*o):void 0}function pf(e,t,r){if(void 0===r&&(r=!0),e.length<2||e.length>4)throw new Error("Unsupported order");var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y;if(2===e.length)return n+(i-n)*t;var o=r?e[2].x:e[2].y;if(3===e.length)return Math.pow(1-t,2)*n+2*t*(1-t)*i+Math.pow(t,2)*o;if(4===e.length){var a=r?e[3].x:e[3].y;return Math.pow(1-t,3)*n+3*Math.pow(1-t,2)*t*i+3*Math.pow(t,2)*(1-t)*o+Math.pow(t,3)*a}}function vf(e,t,r){void 0===r&&(r=!0);var n=r?e[0].x:e[0].y,i=r?e[1].x:e[1].y,o=r?e[2].x:e[2].y;return 4===e.length?Bd([n-t,3*(i-n),3*(o+n-2*i),(r?e[3].x:e[3].y)-n+3*i-3*o]).filter((function(e){return e>=0&&e<=1})):Bd([n-t,2*(i-n),o+n-2*i]).filter((function(e){return e>=0&&e<=1}))}var yf={bboxBezier:Wd,bezierLength:Vd,bezierAt:Kd,sliceBezier:Jd,getPointByT:$d,getT:vf,getPointT:tf,getPointWithDByApprox:cf,bezierSlope:rf,bezierExtremaT:af,bezierTangent:function(e,t){if(void 0===t&&(t=0),2===e.length)return Ud(e[0].x,e[0].y,e[1].x,e[1].y);if(3===e.length)return function(e,t){void 0===t&&(t=0);var r=nf(e,t),n=Qd(e,t);return zd(n.x,n.y,r)}(e,t);if(4===e.length)return function(e,t){void 0===t&&(t=0);var r=of(e,t),n=ef(e,t);return zd(n.x,n.y,r)}(e,t);throw new Error("Unsupported order")},splitBezierT:function(e,t,r,n){if(void 0===r&&(r=5),t<2)return[];if(e.length>4||e.length<2)throw new Error("Unsupported order");for(var i=e[0],o=e[e.length-1],a=[{x:i.x,y:i.y,t:0}],s=1/t,l=1;l<t;l++){var c=s*l,u=$d(e,c);a.push({x:u.x,y:u.y,t:c})}if(a.push({x:o.x,y:o.y,t:1}),2===e.length)return a;var h=(n=n||Vd(e))/t;for(l=0;l<r;l++){for(var d=[0],f=1;f<t;f++)d[f]=Math.sqrt(Math.pow(a[f].x-a[f-1].x,2)+Math.pow(a[f].y-a[f-1].y,2));var p=0;for(f=1;f<t;f++){p+=d[f]-h;var v=a[f],y=Kd(v.t,e,1),g=Math.sqrt(Math.pow(y.x,2)+Math.pow(y.y,2)),m=Kd(v.t,e,2),b=p*g,x=p*Math.sqrt(Math.pow(m.x,2)+Math.pow(m.y,2))+g*g;v.t=v.t-b/x;u=$d(e,v.t);v.x=u.x,v.y=u.y}}return a},getBezierMonotonicityT:sf,getBezierMonotonicityT2:lf,bezierDerivative:df,bezierDerivative2:ff,bezierValue:pf},gf=rd.unitize3,mf=rd.crossProduct3,bf=rd.dotProduct3,xf=rd.isParallel3,Ef=rd.length3;function wf(e){var t=e[0],r=e[e.length-1];return[Math.min(t.x,r.x),Math.min(t.y,r.y),Math.max(t.x,r.x),Math.max(t.y,r.y)]}function Sf(e,t,r,n,i,o){var a,s,l,c,u,h,d,f,p=[{a:e,b:t,t1:0,t2:1,t3:0,t4:1}],v=e.length,y=t.length;if(2===v&&2===y){var g=Af(e[0].x,e[0].y,e[1].x,e[1].y,t[0].x,t[0].y,t[1].x,t[1].y,!0,r);return g&&o.push({x:g.x,y:g.y,t1:g.toSource,t2:g.toClip}),o}for(var m=function(){var e=p.pop(),t=e.a,n=e.b,g=e.t1,m=e.t2,b=e.t3,x=e.t4,E=i?wf(t):Wd(t[0].x,t[0].y,t[1].x,t[1].y,null===(a=t[2])||void 0===a?void 0:a.x,null===(s=t[2])||void 0===s?void 0:s.y,null===(l=t[3])||void 0===l?void 0:l.x,null===(c=t[3])||void 0===c?void 0:c.y),w=i?wf(n):Wd(n[0].x,n[0].y,n[1].x,n[1].y,null===(u=n[2])||void 0===u?void 0:u.x,null===(h=n[2])||void 0===h?void 0:h.y,null===(d=n[3])||void 0===d?void 0:d.x,null===(f=n[3])||void 0===f?void 0:f.y);if(i){if(t[0].x===n[0].x&&t[0].y===n[0].y)return o.push({x:t[0].x,y:t[0].y,t1:g,t2:b}),"continue";if(t[0].x===n[y-1].x&&t[0].y===n[y-1].y)return o.push({x:t[0].x,y:t[0].y,t1:g,t2:x}),"continue";if(t[v-1].x===n[0].x&&t[v-1].y===n[0].y)return o.push({x:n[0].x,y:n[0].y,t1:m,t2:b}),"continue";if(t[v-1].x===n[y-1].x&&t[v-1].y===n[y-1].y)return o.push({x:t[v-1].x,y:t[v-1].y,t1:m,t2:x}),"continue";if((E[0]===w[2]||E[2]===w[0])&&E[1]<=w[3]&&E[3]>=w[1]){var S=E[2]===w[0];if(2===v){if(A=Cf(t,n,E,S)){var _=g+A.tl*(m-g),C=b+A.tb*(x-b);o.push({x:A.x,y:A.y,t1:_,t2:C})}}else if(2===y){if(A=Cf(n,t,w,!S)){_=b+A.tl*(x-b),C=g+A.tb*(m-g);o.push({x:A.x,y:A.y,t1:C,t2:_})}}else{var A=function(e,t,r,n){var i,o,a,s,l,c;void 0===n&&(n=!0);var u=e.length,h=t.length,d=n?r[2]:r[0];if(e[0].x===d||e[u-1].x===d)if(t[0].x===d||t[h-1].x===d){if(e[0].x===d&&t[0].x===d&&e[0].y===t[0].y)return{x:d,y:e[0].y,ta:0,tb:0};if(e[0].x===d&&t[h-1].x===d&&e[0].y===t[h-1].y)return{x:d,y:e[0].y,ta:0,tb:1};if(e[u-1].x===d&&t[h-1].x===d&&e[u-1].y===t[h-1].y)return{x:d,y:e[u-1].y,ta:1,tb:1};if(e[u-1].x===d&&t[0].x===d&&e[u-1].y===t[0].y)return{x:d,y:e[u-1].y,ta:1,tb:0}}else{var f=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1})),p=$d(t,f[0]);if(e[0].x===d&&e[0].y===p.y)return{x:d,y:p.y,ta:0,tb:f[0]};if(e[u-1].x===d&&e[u-1].y===p.y)return{x:d,y:p.y,ta:1,tb:f[0]}}else{var v=af(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,null===(a=e[3])||void 0===a?void 0:a.x,null===(s=e[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1})),y=$d(e,v[0]);if(t[0].x===d||t[h-1].x===d){if(t[0].x===d&&t[0].y===y.y)return{x:d,y:y.y,ta:v[0],tb:0};if(t[h-1].x===d&&t[h-1].y===y.y)return{x:d,y:y.y,ta:v[0],tb:1}}else{var g=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(l=t[3])||void 0===l?void 0:l.x,null===(c=t[3])||void 0===c?void 0:c.y).filter((function(e){return e>0&&e<1})),m=$d(t,g[0]);if(y.y===m.y)return{x:d,y:y.y,ta:v[0],tb:g[0]}}}}(t,n,E,S);if(A){var T=g+A.ta*(m-g);C=b+A.tb*(x-b);o.push({x:A.x,y:A.y,t1:T,t2:C})}}return"continue"}if((E[1]===w[3]||E[3]===w[1])&&E[0]<=w[2]&&E[2]>=w[0]){var O=E[3]===w[1];if(2===v){if(A=_f(t,n,E,O)){_=g+A.tl*(m-g),C=b+A.tb*(x-b);o.push({x:A.x,y:A.y,t1:_,t2:C})}}else if(2===y){if(A=_f(n,t,w,!O)){_=b+A.tl*(x-b),C=g+A.tb*(m-g);o.push({x:A.x,y:A.y,t1:C,t2:_})}}else{A=function(e,t,r,n){var i,o,a,s,l,c;void 0===n&&(n=!0);var u=e.length,h=t.length,d=n?r[3]:r[1];if(e[0].y===d||e[u-1].y===d)if(t[0].y===d||t[h-1].y===d){if(e[0].y===d&&t[0].y===d&&e[0].x===t[0].x)return{x:e[0].x,y:d,ta:0,tb:0};if(e[0].y===d&&t[h-1].y===d&&e[0].x===t[h-1].x)return{x:e[0].x,y:d,ta:0,tb:1};if(e[u-1].y===d&&t[h-1].y===d&&e[u-1].x===t[h-1].x)return{x:e[u-1].x,y:d,ta:1,tb:1};if(e[u-1].y===d&&t[0].y===d&&e[u-1].x===t[0].x)return{x:e[u-1].x,y:d,ta:1,tb:0}}else{var f=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1})),p=$d(t,f[0]);if(e[0].y===d&&e[0].x===p.x)return{x:p.x,y:d,ta:0,tb:f[0]};if(e[u-1].y===d&&e[u-1].x===p.x)return{x:p.x,y:d,ta:1,tb:f[0]}}else{var v=af(e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,null===(a=e[3])||void 0===a?void 0:a.x,null===(s=e[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1})),y=$d(e,v[0]);if(t[0].y===d||t[h-1].y===d){if(t[0].y===d&&t[0].x===y.x)return{x:y.x,y:d,ta:v[0],tb:0};if(t[h-1].y===d&&t[h-1].x===y.x)return{x:y.x,y:d,ta:v[0],tb:1}}else{var g=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(l=t[3])||void 0===l?void 0:l.x,null===(c=t[3])||void 0===c?void 0:c.y).filter((function(e){return e>0&&e<1})),m=$d(t,g[0]);if(y.x===m.x)return{x:y.x,y:d,ta:v[0],tb:g[0]}}}}(t,n,E,O);if(A){T=g+A.ta*(m-g),C=b+A.tb*(x-b);o.push({x:A.x,y:A.y,t1:T,t2:C})}}return"continue"}if(2===v){if(t[0].x===t[1].x)return vf(n,t[0].x,!0).forEach((function(e){if(!(e<0||e>1)){var r=$d(n,e),i=(r.y-t[0].y)/(t[1].y-t[0].y);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:i,t2:e})}})),"continue";if(t[0].y===t[1].y)return vf(n,t[0].y,!1).forEach((function(e){if(!(e<0||e>1)){var r=$d(n,e),i=(r.x-t[0].x)/(t[1].x-t[0].x);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:i,t2:e})}})),"continue"}else if(2===y){if(n[0].x===n[1].x)return vf(t,n[0].x,!0).forEach((function(e){if(!(e<0||e>1)){var r=$d(t,e),i=(r.y-n[0].y)/(n[1].y-n[0].y);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:e,t2:i})}})),"continue";if(n[0].y===n[1].y)return vf(t,n[0].y,!1).forEach((function(e){if(!(e<0||e>1)){var r=$d(t,e),i=(r.x-n[0].x)/(n[1].x-n[0].x);i>=0&&i<=1&&o.push({x:r.x,y:r.y,t1:e,t2:i})}})),"continue"}}if(function(e,t,r,n,i){if(e[0]>t[2]||e[1]>t[3]||t[0]>e[2]||t[1]>e[3])return!1;if((e[2]===t[0]||e[0]===t[2])&&(t[3]<e[1]||e[1]>t[3]))return!1;if((e[3]===t[1]||e[1]===t[3])&&(t[2]<e[0]||e[0]>t[2]))return!1;var o=r.length,a=n.length;if(i){if(o===a){for(var s=r[0].x-n[0].x,l=r[0].y-n[0].y,c=!0,u=!0,h=0;h<o&&(r[h].x-n[h].x!==s&&(c=!1),r[h].y-n[h].y!==l&&(u=!1),c||u);h++);if(c&&u)return!1;if(c){for(var d=r[0].y-n[0].y,f=lf(r.map((function(e,t){return{x:e.x-n[t].x,y:e.y-n[t].y}})),!1)||[],p=(h=0,f.length);h<p;h++){var v=$d(r,f[h]),y=$d(n,f[h]);if(d>0&&v.y-y.y<=0||d<0&&v.y-y.y>=0)return!0}return!1}if(u){for(d=r[0].x-n[0].x,f=lf(r.map((function(e,t){return{x:e.x-n[t].x,y:e.y-n[t].y}})),!0)||[],h=0,p=f.length;h<p;h++){v=$d(r,f[h]),y=$d(n,f[h]);if(d>0&&v.x-y.x<=0||d<0&&v.x-y.x>=0)return!0}return!1}}}else{if(e[1]===t[3]||e[3]===t[1]){var g=e[1]===t[3]?e[1]:e[3];return 2===o?e[1]===e[3]||(n[1].y===g||n[a-2].y===g):2===a?t[1]===t[3]||(r[1].y===g||r[o-2].y===g):r[1].y===g||r[o-2].y===g||n[1].y===g||n[a-2].y===g}if(e[0]===t[2]||e[2]===t[0]){var m=e[0]===t[2]?e[0]:e[2];return 2===o?e[0]===e[2]||(n[1].x===m||n[a-2].y===m):2===a?t[0]===t[2]||(r[1].x===m||r[o-2].x===m):r[1].x===m||r[o-2].x===m||n[1].x===m||n[a-2].x===m}}return!0}(E,w,t,n,i)){if(v===y){for(var M=!0,k=0;k<v;k++)if(Math.abs(t[k].x-n[k].x)>.1*r||Math.abs(t[k].y-n[k].y)>.1*r){M=!1;break}if(M)return o.push({x:.5*(t[0].x+n[0].x),y:.5*(t[0].y+n[0].y),t1:g,t2:b}),o.push({x:.5*(t[v-1].x+n[y-1].x),y:.5*(t[v-1].y+n[y-1].y),t1:m,t2:x}),"continue"}var L=E[2]-E[0]||Number.EPSILON,R=E[3]-E[1]||Number.EPSILON,I=w[2]-w[0]||Number.EPSILON,P=w[3]-w[1]||Number.EPSILON;if(L<=r&&R<=r&&I<=r&&P<=r){T=.5*(g+m),C=.5*(b+x);if(0===g)((F=t[0]).x===n[0].x&&F.y===n[0].y||F.x===n[y-1].x&&F.y===n[y-1].y)&&(T=0);else if(1===m){((F=t[v-1]).x===n[0].x&&F.y===n[0].y||F.x===n[y-1].x&&F.y===n[y-1].y)&&(T=1)}if(0===b)((F=n[0]).x===t[0].x&&F.y===t[0].y||F.x===t[v-1].x&&F.y===t[v-1].y)&&(C=0);else if(1===x){var F;((F=n[y-1]).x===t[0].x&&F.y===t[0].y||F.x===t[v-1].x&&F.y===t[v-1].y)&&(C=1)}var D=$d(t,T),N=$d(n,C);o.push({x:.5*(D.x+N.x),y:.5*(D.y+N.y),t1:T,t2:C})}else if((L>r||R>r)&&(I>r||P>r)){var B=Jd(t,0,.5),U=Jd(t,.5,1),z=Jd(n,0,.5),G=Jd(n,.5,1);p.push({a:B,b:z,t1:g,t2:g+.5*(m-g),t3:b,t4:b+.5*(x-b)}),p.push({a:B,b:G,t1:g,t2:g+.5*(m-g),t3:b+.5*(x-b),t4:x}),p.push({a:U,b:z,t1:g+.5*(m-g),t2:m,t3:b,t4:b+.5*(x-b)}),p.push({a:U,b:G,t1:g+.5*(m-g),t2:m,t3:b+.5*(x-b),t4:x})}else if(L>r||R>r){B=Jd(t,0,.5),U=Jd(t,.5,1);p.push({a:B,b:n,t1:g,t2:g+.5*(m-g),t3:b,t4:x}),p.push({a:U,b:n,t1:g+.5*(m-g),t2:m,t3:b,t4:x})}else if(I>r||P>r){z=Jd(n,0,.5),G=Jd(n,.5,1);p.push({a:t,b:z,t1:g,t2:m,t3:b,t4:b+.5*(x-b)}),p.push({a:t,b:G,t1:g,t2:m,t3:b+.5*(x-b),t4:x})}}};p.length;)m();o.sort((function(e,t){return e.t1===t.t1?e.t2-t.t2:e.t1-t.t1}));for(var b=o.length-1;b>0;b--){var x=o[b],E=o[b-1];if(Math.abs(x.x-E.x)<=n&&Math.abs(x.y-E.y)<=n)if(1===b)0===x.t1||1===x.t1||0===x.t2||1===x.t2?o.shift():o.splice(1,1);else for(var w=b-1;w>0;w--){var S=o[w],_=o[w-1],C=Math.abs(S.x-_.x)>n&&Math.abs(S.y-_.y)>n;if(C||1===w){var A=C?w:w-1,T=o[A];if(Math.abs(x.x-T.x)<=n&&Math.abs(x.y-T.y)<=n)if(0===x.t1||1===x.t1||0===x.t2||1===x.t2)o.splice(A,b-A);else if(0===T.t1||1===T.t1||0===T.t2||1===T.t2)o.splice(A+1,b-A);else{var O=o[A+b>>1];o.splice(A,b-A+1,O)}else o.splice(A+1,b-A-1);b=A;break}}}return o}function _f(e,t,r,n){var i,o,a,s;void 0===n&&(n=!0);var l=t.length,c=n?r[3]:r[1];if(r[1]===r[3])if(t[0].y===c||t[l-1].y===c){if((u=((d=t[0].y===c?t[0].x:t[l-1].x)-r[0])/(r[2]-r[0]))>=0&&u<=1)return{x:d,y:c,tl:u,tb:t[0].y===c?0:1}}else{var u,h=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1}));if((u=((f=$d(t,h[0])).x-r[0])/(r[2]-r[0]))>=0&&u<=1)return{x:f.x,y:c,tl:u,tb:h[0]}}else if(t[0].y===c||t[l-1].y===c){var d=t[0].y===c?t[0].x:t[l-1].x;if(e[0].x===d&&e[0].y===c||e[1].x===d&&e[1].y===c)return{x:d,y:c,tl:e[0].y===c?0:1,tb:t[0].y===c?0:1}}else{var f;h=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(a=t[3])||void 0===a?void 0:a.x,null===(s=t[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1}));if((f=$d(t,h[0])).x===e[0].x&&e[0].y===c||f.x===e[1].x&&e[1].y===c)return{x:f.x,y:c,tl:f.x===e[0].x?0:1,tb:h[0]}}}function Cf(e,t,r,n){var i,o,a,s;void 0===n&&(n=!0);var l=t.length,c=n?r[2]:r[0];if(r[0]===r[2])if(t[0].x===c||t[l-1].x===c){if((u=((d=t[0].x===c?t[0].y:t[l-1].y)-r[1])/(r[3]-r[1]))>=0&&u<=1)return{x:c,y:d,tl:u,tb:t[0].x===c?0:1}}else{var u,h=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(i=t[3])||void 0===i?void 0:i.x,null===(o=t[3])||void 0===o?void 0:o.y).filter((function(e){return e>0&&e<1}));if((u=((f=$d(t,h[0])).y-r[1])/(r[3]-r[1]))>=0&&u<=1)return{x:c,y:f.y,tl:(f.y-r[1])/(r[3]-r[1]),tb:h[0]}}else if(t[0].x===c||t[l-1].x===c){var d=t[0].x===c?t[0].x:t[l-1].x;if(e[0].x===c&&e[0].y===d||e[1].x===c&&e[1].y===d)return{x:c,y:d,tl:e[0].x===c?0:1,tb:t[0].x===c?0:1}}else{var f;h=af(t[0].x,t[0].y,t[1].x,t[1].y,t[2].x,t[2].y,null===(a=t[3])||void 0===a?void 0:a.x,null===(s=t[3])||void 0===s?void 0:s.y).filter((function(e){return e>0&&e<1}));if((f=$d(t,h[0])).y===e[0].y&&e[0].x===c||f.y===e[1].y&&e[1].x===c)return{x:c,y:f.y,tl:f.y===e[0].y?0:1,tb:h[0]}}}function Af(e,t,r,n,i,o,a,s,l,c){void 0===l&&(l=!0),void 0===c&&(c=0);var u=(s-o)*(r-e)-(a-i)*(n-t);if(0!==u){var h=((a-i)*(t-o)-(s-o)*(e-i))/u,d=((r-e)*(t-o)-(n-t)*(e-i))/u,f=1-c;if(l&&(h<c||h>f||d<c||d>f))return;return{x:e+h*(r-e),y:t+h*(n-t),toSource:h,toClip:d}}}function Tf(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}}function Of(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function Mf(e,t,r){var n=Tf(e,t),i=Tf(r,t),o=bf(i.x,i.y,i.z,i.x,i.y,i.z);return bf(i.x,i.y,i.z,n.x,n.y,n.z)/o}var kf={intersectLineLine:Af,intersectBezier2Line:function(e,t,r,n,i,o,a,s,l,c,u,h,d){void 0===u&&(u=.1),void 0===h&&(h=.5),void 0===d&&(d=!1);var f=[];return Sf([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:c}],u,h,d,f),f},intersectBezier3Line:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p){void 0===d&&(d=.1),void 0===f&&(f=.5),void 0===p&&(p=!1);var v=[];return Sf([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],[{x:l,y:c},{x:u,y:h}],d,f,p,v),v},intersectBezier2Bezier2:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p){void 0===d&&(d=.1),void 0===f&&(f=.5),void 0===p&&(p=!1);var v=[];return Sf([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:c},{x:u,y:h}],d,f,p,v),v},intersectBezier3Bezier3:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,y,g,m){void 0===y&&(y=.1),void 0===g&&(g=.5),void 0===m&&(m=!1);var b=[];return Sf([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],[{x:l,y:c},{x:u,y:h},{x:d,y:f},{x:p,y:v}],y,g,m,b),b},intersectBezier2Bezier3:function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,y){void 0===p&&(p=.1),void 0===v&&(v=.5),void 0===y&&(y=!1);var g=[];return Sf([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:c},{x:u,y:h},{x:d,y:f}],p,v,y,g),g},intersectLineLine3:function(e,t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1e-9);var a=Tf(e,r),s=Tf(n,r),l=Tf(t,e),c=a.x*s.x+a.y*s.y+a.z*s.z,u=s.x*l.x+s.y*l.y+s.z*l.z,h=a.x*l.x+a.y*l.y+a.z*l.z,d=s.x*s.x+s.y*s.y+s.z*s.z,f=(l.x*l.x+l.y*l.y+l.z*l.z)*d-u*u;if(!(Math.abs(f)<o)){var p,v,y=(c*u-h*d)/f,g=(c+u*y)/d,m={x:e.x+y*l.x,y:e.y+y*l.y,z:e.z+y*l.z},b={x:r.x+g*s.x,y:r.y+g*s.y,z:r.z+g*s.z};if(!((p=m,v=b,Math.sqrt(Math.pow(p.x-v.x,2)+Math.pow(p.y-v.y,2)+Math.pow(p.z-v.z,2)))>o)){var x,E,w=(x=Of(m,b),E=1/2,{x:x.x*E,y:x.y*E,z:x.z*E});if(!i)return w;var S=Mf(w,e,t),_=Mf(w,r,n);return S<0&&Math.abs(S)<1e-9?S=0:S>1&&S-1<1e-9&&(S=1),_<0&&Math.abs(_)<1e-9?_=0:_>1&&_-1<1e-9&&(_=1),w.pa=S,w.pb=_,1===i&&S>=0&&S<=1||2===i&&_>=0&&_<=1||3===i&&S>=0&&S<=1&&_>=0&&_<=1?w:void 0}}},intersectPlanePlane:function(e,t,r,n,i,o){var a=gf(t.x-e.x,t.y-e.y,t.z-e.z),s=gf(r.x-e.x,r.y-e.y,r.z-e.z),l=gf(i.x-n.x,i.y-n.y,i.z-n.z),c=gf(o.x-n.x,o.y-n.y,o.z-n.z),u=mf(a.x,a.y,a.z,s.x,s.y,s.z),h=gf(u.x,u.y,u.z),d=mf(l.x,l.y,l.z,c.x,c.y,c.z),f=gf(d.x,d.y,d.z);if(xf(h.x,h.y,h.z,f.x,f.y,f.z))return null;var p=mf(f.x,f.y,f.z,h.x,h.y,h.z),v=Of(a,l),y=gf(p.x,p.y,p.z),g=h.x,m=h.y,b=h.z,x=-g*e.x-m*e.y-b*e.z,E=f.x,w=f.y,S=f.z,_=-E*n.x-w*n.y-S*n.z,C=y.x,A=y.y,T=y.z,O=[-x,-_,-(-C*v.x-A*v.y-T*v.z)],M=g*(w*T-S*A)-m*(E*T-S*C)+b*(E*A-w*C);if(Math.abs(M)<1e-9)return null;var k=1/M,L={x:k*(w*T-S*A)*O[0]+k*(b*A-m*T)*O[1]+k*(m*S-b*w)*O[2],y:k*(S*C-E*T)*O[0]+k*(g*T-b*C)*O[1]+k*(b*E-g*S)*O[2],z:k*(E*A-w*C)*O[0]+k*(m*C-g*A)*O[1]+k*(g*w-m*E)*O[2]};return[L,Of(L,y)]},pointOnLine3:function(e,t,r,n){void 0===n&&(n=1e-9);var i=t.x-e.x,o=t.y-e.y,a=t.z-e.z,s=r.x-e.x,l=r.y-e.y,c=r.z-e.z,u=mf(i,o,a,s,l,c);return Ef(u.x,u.y,u.z)<n}};function Lf(e){if(e<=0)return 0;var t=Math.floor(3*e*Math.sqrt(2*Math.PI)/4+.5);return t<2&&(t=2),t%2==0&&t++,t}function Rf(e){return 3*Math.floor(.5*e)}function If(e,t){void 0===t&&(t=3);var r=Math.sqrt(12*e*e/t+1),n=Math.floor(r);n%2==0&&n--;for(var i=n+2,o=(12*e*e-t*n*n-4*t*n-3*t)/(-4*n-4),a=Math.round(o),s=[],l=0;l<t;l++)s.push(l<a?n:i);return s}var Pf={kernelSize:Lf,outerSize:function(e){return Rf(Lf(e))},outerSizeByD:Rf,gaussianWeight:function(e,t){if(e<=0||t<=0)return[1];for(var r=[],n=Math.floor(.5*t),i=0,o=n;o>=0;o--){var a=Math.pow(Math.E,-Math.pow(o,2)/(2*Math.pow(e,2)))/(e*Math.sqrt(2*Math.PI));r.push(a),i+=a}for(o=1;o<=n;o++){a=r[n-o];r.push(a),i+=a}if(1!==i)for(o=0;o<t;o++)r[o]/=i;return r},boxesForGauss:If,dualKawase:function(e){var t=Math.max(1,Math.round(4/3*Math.log(e)));return{passes:t,distance:Math.pow(.4538,t)*e}}};function Ff(e,t){void 0===t&&(t=2);var r=Math.pow(10,t);return Math.round(e*r)/r}var Df={geom:Od,matrix:bd,vector:rd,isec:kf,bezier:yf,toPrecision:Ff,blur:Pf};function Nf(e,t,r){void 0===r&&(r=!1);for(var n=[],i=e[0].color,o=0,a=e.length;o<a;o++)n.push(e[o]);(1===n.length&&n.push(Iu(n[0])),void 0===n[0].offset&&(n[0].offset=0),n.length>1)&&(void 0===n[o=n.length-1].offset&&(n[o].offset=1));var s=n[0].offset;for(o=1,a=n.length;o<a-1;o++){if(void 0!==(b=n[o]).offset)s=b.offset;else{for(var l=o+1,c=n[n.length-1].offset;l<a-1;l++){var u=n[l];if(void 0!==u.offset){c=u.offset;break}}for(var h=(c-s)/(l-o+1),d=o;d<l;d++){n[d].offset=s+h*(d+1-o)}o=l}}n.sort((function(e,t){return e.offset-t.offset}));for(o=0,a=n.length;o<a;o++){if((b=n[o]).offset>1){n.splice(o);var f=n[o-1];if(f&&f.offset<1){var p=b.color[0]-f.color[0],v=b.color[1]-f.color[1],y=b.color[2]-f.color[2],g=b.color[3]-f.color[3],m=(1-f.offset)/(b.offset-f.offset);n.push({color:[b.color[0]+p*m,b.color[1]+v*m,b.color[2]+y*m,b.color[3]+g*m],offset:1})}break}}for(o=n.length-1;o>=0;o--){var b;if((b=n[o]).offset<0){n.splice(0,o+1);var x=n[o];if(x&&x.offset>0){p=x.color[0]-b.color[0],v=x.color[1]-b.color[1],y=x.color[2]-b.color[2],g=x.color[3]-b.color[3],m=-b.offset/(x.offset-b.offset);n.unshift({color:[b.color[0]+p*m,b.color[1]+v*m,b.color[2]+y*m,b.color[3]+g*m],offset:0})}break}}if(n.forEach((function(e){e.offset<0?e.offset=0:e.offset>1&&(e.offset=1)})),n.length||n.push({color:i,offset:0},{color:i,offset:1}),r){var E=n[0],w=n[n.length-1];if(E.offset>0||w.offset<1){p=w.color[0]-E.color[0],v=w.color[1]-E.color[1],y=w.color[2]-E.color[2],g=w.color[3]-E.color[3];var S=E.offset+(1-w.offset);if(E.offset>0){m=E.offset/S;n.unshift({color:[E.color[0]+p*m,E.color[1]+v*m,E.color[2]+y*m,E.color[3]+g*m],offset:0})}if(w.offset<1){m=(1-w.offset)/S;n.push({color:[w.color[0]-p*m,w.color[1]-v*m,w.color[2]-y*m,w.color[3]-g*m],offset:1})}}}return n}function Bf(e){if(Md.gradient.test(e)){var t=Md.gradient.exec(e);if(t&&["linear","radial","conic"].indexOf(t[1].toLowerCase())>-1)return!0}return!1}function Uf(e){var t=Md.gradient.exec(e);if(t){var r={linear:Wu.LINEAR,radial:Wu.RADIAL,conic:Wu.CONIC}[t[1].toLowerCase()],n=void 0;if(r===Wu.LINEAR)if(o=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)/.exec(t[2]))n=[parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]),parseFloat(o[4])];else{var i=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)/.exec(t[2]);n=i?[xd(parseFloat(i[1]))]:[]}else if(r===Wu.RADIAL){var o;n=(o=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)(\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?))?/.exec(t[2]))?[parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]),parseFloat(o[4]),parseFloat(o[5])||0]:[.5,.5,1,1]}else r===Wu.CONIC&&(n=[]);var a=t[2].match(/(([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)?\s*((#[0-9a-f]{3,8})|(rgba?\s*\(.+?\)))\s*([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)?)|(transparent)/gi)||[],s=a.map((function(e,t){var r,n=/(?:#[0-9a-f]{3,8})|(?:rgba?\s*\(.+?\))|(?:transparent)/i.exec(e),i=/[-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?(?:(?:px)|%)?/.exec(e.replace(n[0],""));if(i){var o=fh(i[0]);o.u!==zu.PERCENT&&(o.v*=100,o.u=zu.PERCENT),r=o}else t?t===a.length-1&&(r={v:100,u:zu.PERCENT}):r={v:0,u:zu.PERCENT};return{color:{v:n?Zf(n[0]):[0,0,0,1],u:zu.RGBA},offset:r}}));s.sort((function(e,t){return e.offset&&t.offset?e.offset.v-t.offset.v:0}));for(var l=s.length-2;l>0;l--){if(!s[l].offset){for(var c=s[l+1].offset.v,u=s[0].offset.v,h=l,d=l-1;d>=0;d--){if(0===d){l=d;break}if(s[d].offset){l=d,u=s[d].offset.v;break}}for(var f=(c-u)/(h-l+1),p=l+1;p<=h;p++)s[l].offset={v:u+(p-l)*f,u:zu.PERCENT}}}return{t:r,d:n,stops:s}}}function zf(e,t,r,n,i){var o,a,s,l;if(e%(2*Math.PI)==0)o=s=.5*n,a=0,l=i;else if(e%Math.PI==0)o=s=.5*n,a=i,l=0;else if(e%(.5*Math.PI)==0)o=0,s=n,a=l=.5*i;else if(e%(1.5*Math.PI)==0)o=n,s=0,a=l=.5*i;else{var c=.5*n,u=.5*i,h=Math.min(c,u),d=Math.sin(e%360),f=Math.cos(e%360);o=c-h*d,a=u-h*f,s=c+h*d,l=u+h*f}return{x1:o+=t,y1:a+=r,x2:s+=t,y2:l+=r}}function Gf(e,t,r,n,i,o){var a,s,l,c,u;if(t.length<=1){var h=zf(null!==(a=t[0])&&void 0!==a?a:Math.PI,r,n,i,o);s=h.x1,l=h.y1,c=h.x2,u=h.y2}else s=r+t[0]*i,l=n+t[1]*o,c=r+t[2]*i,u=n+t[3]*o;var d=Math.sqrt(Math.pow(c-s,2)+Math.pow(u-l,2));return{x1:s,y1:l,x2:c,y2:u,total:d,stop:Nf(e,0,!1)}}function Xf(e,t,r,n,i,o){var a,s=r+t[0]*i,l=n+t[1]*o,c=r+t[2]*i,u=n+t[3]*o,h=t[4],d=Math.sqrt(Math.pow(c-s,2)+Math.pow(u-l,2)),f=Nf(e,0,!1);if(h&&1!==h){if(a=nd(),u!==l)if(c===s)dd(a,xd(u>=l?90:270));else dd(a,Math.atan((u-l)/(c-s)));pd(a,h),a=Rd(a,s,l)}return{cx:s,cy:l,tx:c,ty:u,ellipseLength:h,matrix:a,total:d,stop:f}}function Hf(e,t,r,n,i,o){var a=Math.floor(r+.5*i),s=Math.floor(n+.5*o),l=Math.floor(r+.5*i)-a,c=Math.floor(n+.5*o)-s;a%2==0&&a++,s%2==0&&s++;var u=0;u=0===l?c>=0?0:Math.PI:Math.atan(c/l);Math.sqrt(Math.pow(l,2)+Math.pow(c,2));return{angle:u,cx:a,cy:s,stop:Nf(e,0,!0)}}function jf(e,t,r,n){var i,o,a,s;void 0===t&&(t=100),void 0===r&&(r=100),void 0===n&&(n=!1);var l=e.t,c=e.d,u=e.stops,h=c[0],d=c[1],f=c[2],p=c[3];h*=t,f*=t,d*=r,p*=r;var v=0;1===c.length?v=c[0]:h===f?d<p&&(v=180):v=f>h?p>=d?90+Ed(Math.atan((p-d)/(f-h))):Ed(Math.atan((f-h)/(d-p))):p>=d?180+Ed(Math.atan((h-f)/(p-d))):360-Ed(Math.atan((h-f)/(d-p)));var y=u.slice(0);if(y.sort((function(e,t){return e.offset-t.offset})),l===Wu.LINEAR){var g=void 0,m=void 0;v<=90?(g={x:0,y:r},m={x:t,y:0}):v<=180?(g={x:0,y:0},m={x:t,y:r}):v<=270?(g={x:t,y:0},m={x:0,y:r}):(g={x:t,y:r},m={x:0,y:0});var b=Iu(y).sort((function(e,t){return e.offset-t.offset}));if(n){var x=Math.sqrt(Math.pow(p-g.y,2)+Math.pow(f-g.x,2)),E=Math.sqrt(Math.pow(d-g.y,2)+Math.pow(h-g.x,2)),w=Math.sqrt(Math.pow(p-d,2)+Math.pow(f-h,2)),S=Cd(x,E,w),_=S?E*Math.cos(S):E,C=(S=Cd(x=Math.sqrt(Math.pow(d-m.y,2)+Math.pow(h-m.x,2)),E=Math.sqrt(Math.pow(p-m.y,2)+Math.pow(f-m.x,2)),w))?E*Math.cos(S):E;if(b[0].offset>0&&b.unshift({color:b[0].color.slice(0),offset:0}),b[b.length-1].offset<1&&b.push({color:b[b.length-1].color.slice(0),offset:1}),_>1e-9)for(var A=_/w,T=function(e,t){var r=b[e];if(r.offset>=A){var n=b[e-1]||{color:r.color,offset:0};if(b.splice(0,e),r.offset>A){var i=w*(r.offset-n.offset),o=(_-n.offset*w)/i,a=n.color.map((function(e,t){return 3===t?e+(r.color[t]-e)*o:e+Math.floor((r.color[t]-e)*o)})),s={color:a,offset:0};b.unshift(s)}return"break"}},O=0,M=b.length;O<M;O++){if("break"===T(O))break}else _<-1e-9&&b.forEach((function(e){e.offset=(e.offset*w-_)/(w-_)}));if(C>1e-9){A=(w-C)/w;var k=function(e){var t=b[e];if(t.offset<=A){var r=b[e+1]||{color:t.color,offset:1};if(b.splice(e+1),t.offset<A){var n=w*(r.offset-t.offset),i=(C-(1-r.offset)*w)/n,o=r.color.map((function(e,r){return 3===r?e+(t.color[r]-e)*i:e+Math.floor((t.color[r]-e)*i)})),a={color:o,offset:1};b.push(a)}return"break"}};for(O=b.length-1;O>=0;O--){if("break"===k(O))break}}else C<-1e-9&&b.forEach((function(e){e.offset=e.offset*(w-_)/(w-_-C)}))}var L="linear-gradient(";return L+=n?Ff(v)+"deg":c.join(" "),b.forEach((function(e){L+=", ",e.color[3]=Ff(e.color[3]),L+=Jf(e.color)+" "+Ff(100*e.offset)+"%"})),L+")"}if(l===Wu.RADIAL){var R=1;if(n){var I=Math.sqrt(Math.pow(f-h,2)+Math.pow(p-d,2)),P=Math.sqrt(Math.pow(h,2)+Math.pow(d,2)),F=Math.sqrt(Math.pow(h-t,2)+Math.pow(d,2)),D=Math.sqrt(Math.pow(h-t,2)+Math.pow(d-r,2)),N=Math.sqrt(Math.pow(h,2)+Math.pow(d-r,2)),B=Math.max(P,F,D,N);R=B/I}var U="radial-gradient(";return U+=n?"circle at ".concat(100*Ff(c[0]),"% ").concat(100*Ff(c[1]),"%, "):c.join(" ")+", ",y.forEach((function(e,t){t&&(U+=", ");var r=e.color.map((function(e,t){return 3===t?Ff(e):Math.min(255,Math.floor(e*R))}));U+=Jf(r)+" "+Ff(100*e.offset)+"%"})),U+")"}if(l===Wu.CONIC){var z="conic-gradient(";n&&(z+="from 90deg, ");var G=y[0],X=y[y.length-1];if(n&&(G.offset>0||X.offset<1)){var H=[G.color[0]-X.color[0],G.color[1]-X.color[1],G.color[2]-X.color[2],null!==(o=null!==(i=G.color[3])&&void 0!==i?i:1-X.color[3])&&void 0!==o?o:1],j=1-X.offset+G.offset;if(G.offset>0){var W=G.offset/j;y.unshift({color:[Math.min(255,Math.max(0,Math.round(G.color[0]-H[0]*W))),Math.min(255,Math.max(0,Math.round(G.color[1]-H[1]*W))),Math.min(255,Math.max(0,Math.round(G.color[2]-H[2]*W))),Math.min(1,Math.max(0,null!==(a=G.color[3])&&void 0!==a?a:1-H[3]*W))],offset:0})}if(X.offset<1){W=(1-X.offset)/j;y.push({color:[Math.min(255,Math.max(0,Math.round(X.color[0]+H[0]*W))),Math.min(255,Math.max(0,Math.round(X.color[1]+H[1]*W))),Math.min(255,Math.max(0,Math.round(X.color[2]+H[2]*W))),Math.min(1,Math.max(0,null!==(s=X.color[3])&&void 0!==s?s:1+H[3]*W))],offset:1})}}return y.forEach((function(e,t){t&&(z+=", "),e.color[3]=Ff(e.color[3]),z+=Jf(e.color)+" "+Ff(100*e.offset)+"%"})),z+")"}return""}var Wf={isGradient:Bf,parseGradient:Uf,getColorStop:Nf,getLinear:Gf,getRadial:Xf,getConic:Hf,convert2Css:jf,getLinearCoords:zf};function Yf(e){var t={};if(["left","top","right","bottom","width","height"].forEach((function(r){if(e.hasOwnProperty(r)){var n=fh(e[r]||0,!0);"width"!==r&&"height"!==r||n.v<0&&(n.v=0),t[r]=n}})),e.hasOwnProperty("lineHeight")){var r=e.lineHeight;if(Lu(r)||"normal"===r)t.lineHeight={v:0,u:zu.AUTO};else(M=fh(r||0,!0)).v<=0&&(M={v:0,u:zu.AUTO}),t.lineHeight=M}(e.hasOwnProperty("visibility")&&(t.visibility={v:/hidden/i.test(e.visibility)?rh.HIDDEN:rh.VISIBLE,u:zu.NUMBER}),e.hasOwnProperty("fontFamily")&&(t.fontFamily={v:(e.fontFamily||"").toString().trim().replace(/['"]/g,"").replace(/\s*,\s*/g,","),u:zu.STRING}),e.hasOwnProperty("fontSize"))&&((M=fh(e.fontSize||dh.defaultFontSize,!0)).v<=0&&(M.v=dh.defaultFontSize),t.fontSize=M);if(e.hasOwnProperty("fontWeight")){var n=e.fontWeight;Su(n)?/thin/i.test(n)?t.fontWeight={v:100,u:zu.NUMBER}:/lighter/i.test(n)?t.fontWeight={v:200,u:zu.NUMBER}:/light/i.test(n)?t.fontWeight={v:300,u:zu.NUMBER}:/medium/i.test(n)?t.fontWeight={v:500,u:zu.NUMBER}:/semiBold/i.test(n)?t.fontWeight={v:600,u:zu.NUMBER}:/bold/i.test(n)?t.fontWeight={v:700,u:zu.NUMBER}:/extraBold/i.test(n)?t.fontWeight={v:800,u:zu.NUMBER}:/black/i.test(n)?t.fontWeight={v:900,u:zu.NUMBER}:t.fontWeight={v:400,u:zu.NUMBER}:t.fontWeight={v:Math.min(900,Math.max(100,parseInt(n)||400)),u:zu.NUMBER}}if(e.hasOwnProperty("fontStyle")){var i=e.fontStyle,o=ju.NORMAL;/italic/i.test(i)?o=ju.ITALIC:/oblique/i.test(i)&&(o=ju.OBLIQUE),t.fontStyle={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("color")&&(t.color={v:Zf(e.color),u:zu.RGBA}),e.hasOwnProperty("backgroundColor")){var a=e.backgroundColor;t.backgroundColor={v:Zf(a),u:zu.RGBA}}if(e.hasOwnProperty("opacity")){var s=parseFloat(e.opacity);isNaN(s)&&(s=1),t.opacity={v:Math.max(0,Math.min(1,s)),u:zu.NUMBER}}if(e.hasOwnProperty("fill")){var l=e.fill;Array.isArray(l)?t.fill=l.map((function(e){if(Su(e))if(Bf(e)){if(t=Uf(e))return{v:t,u:zu.GRADIENT}}else if(Md.img.test(e)){var t;if(t=Md.img.exec(e)){var r=th.TILE,n=e.replace(t[0],"");n.indexOf("fill")>-1?r=th.FILL:n.indexOf("stretch")>-1?r=th.STRETCH:n.indexOf("fit")>-1&&(r=th.FIT);var i=void 0,o=/([\d.]+)%/.exec(n);return o&&(i={v:parseFloat(o[1]),u:zu.PERCENT}),{v:{url:t[2],type:r,scale:i},u:zu.PATTERN}}}return{v:Zf(e),u:zu.RGBA}})):t.fill=[]}if(e.hasOwnProperty("fillEnable")){var c=e.fillEnable;Array.isArray(c)?t.fillEnable=c.map((function(e){return{v:e,u:zu.BOOLEAN}})):t.fillEnable=t.fill.map((function(){return{v:!0,u:zu.BOOLEAN}}))}if(e.hasOwnProperty("fillOpacity")){var u=e.fillOpacity;Array.isArray(u)?t.fillOpacity=u.map((function(e){return{v:Math.max(0,Math.min(1,e)),u:zu.NUMBER}})):t.fillOpacity=t.fill.map((function(){return{v:1,u:zu.NUMBER}}))}if(e.hasOwnProperty("fillMode")){var h=e.fillMode;Array.isArray(h)?t.fillMode=h.map((function(e){return{v:Vf(e),u:zu.NUMBER}})):t.fillMode=t.fill.map((function(){return{v:Hu.NORMAL,u:zu.NUMBER}}))}if(e.hasOwnProperty("fillRule")){var d=e.fillRule;t.fillRule={v:"evenodd"===d?Zu.EVEN_ODD:Zu.NON_ZERO,u:zu.NUMBER}}if(e.hasOwnProperty("stroke")){var f=e.stroke;Array.isArray(f)?t.stroke=f.map((function(e){if(Su(e))if(Bf(e)){if(t=Uf(e))return{v:t,u:zu.GRADIENT}}else if(Md.img.test(e)){var t;if(t=Md.img.exec(e)){var r=th.TILE,n=e.replace(t[0],"");n.indexOf("fill")>-1?r=th.FILL:n.indexOf("stretch")>-1?r=th.STRETCH:n.indexOf("fit")>-1&&(r=th.FIT);var i=void 0,o=/([\d.]+)%/.exec(n);return o&&(i={v:parseFloat(o[1]),u:zu.PERCENT}),{v:{url:t[2],type:r,scale:i},u:zu.PATTERN}}}return{v:Zf(e),u:zu.RGBA}})):t.stroke=[]}if(e.hasOwnProperty("strokeEnable")){var p=e.strokeEnable;Array.isArray(p)?t.strokeEnable=p.map((function(e){return{v:e,u:zu.BOOLEAN}})):t.strokeEnable=t.stroke.map((function(){return{v:!0,u:zu.BOOLEAN}}))}if(e.hasOwnProperty("strokeWidth")){var v=e.strokeWidth;Array.isArray(v)?t.strokeWidth=v.map((function(e){return{v:Math.max(0,e),u:zu.PX}})):t.strokeWidth=t.stroke.map((function(){return{v:1,u:zu.NUMBER}}))}if(e.hasOwnProperty("strokePosition")){var y=e.strokePosition;Array.isArray(y)?t.strokePosition=y.map((function(e){var t=eh.CENTER;return"inside"===e?t=eh.INSIDE:"outside"===e&&(t=eh.OUTSIDE),{v:t,u:zu.NUMBER}})):t.strokePosition=t.stroke.map((function(){return{v:eh.CENTER,u:zu.NUMBER}}))}if(e.hasOwnProperty("strokeMode")){var g=e.strokeMode;Array.isArray(g)?t.strokeMode=g.map((function(e){return{v:Vf(e),u:zu.NUMBER}})):t.strokeMode=t.stroke.map((function(){return{v:Hu.NORMAL,u:zu.NUMBER}}))}if(e.hasOwnProperty("strokeDasharray")){var m=e.strokeDasharray;Array.isArray(m)?t.strokeDasharray=m.map((function(e){return{v:Math.max(0,e),u:zu.PX}})):t.strokeDasharray=[]}if(e.hasOwnProperty("strokeLinecap")){var b=e.strokeLinecap;o=$u.BUTT;"round"===b?o=$u.ROUND:"square"===b&&(o=$u.SQUARE),t.strokeLinecap={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("strokeLinejoin")){var x=e.strokeLinejoin;o=Qu.MITER;"round"===x?o=Qu.ROUND:"bevel"===x&&(o=Qu.BEVEL),t.strokeLinejoin={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("strokeMiterlimit")&&(t.strokeMiterlimit={v:parseFloat(e.strokeMiterlimit)||0,u:zu.NUMBER}),["translateX","translateY","scaleX","scaleY","rotateZ"].forEach((function(r){if(e.hasOwnProperty(r)){var n=fh(e[r],!1);!function(e,t){"scaleX"===e||"scaleY"===e?t.u=zu.NUMBER:"translateX"===e||"translateY"===e?t.u===zu.NUMBER&&(t.u=zu.PX):t.u===zu.NUMBER&&(t.u=zu.DEG)}(r,n),t[r]=n}})),e.hasOwnProperty("letterSpacing")&&(t.letterSpacing=fh(e.letterSpacing||0,!0)),e.hasOwnProperty("paragraphSpacing")&&(t.paragraphSpacing=fh(e.paragraphSpacing||0,!0)),e.hasOwnProperty("textAlign")){var E=e.textAlign;o=Gu.LEFT;"center"===E?o=Gu.CENTER:"right"===E?o=Gu.RIGHT:"justify"===E&&(o=Gu.JUSTIFY),t.textAlign={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("textVerticalAlign")){var w=e.textVerticalAlign;o=Xu.TOP;"middle"===w?o=Xu.MIDDLE:"bottom"===w&&(o=Xu.BOTTOM),t.textVerticalAlign={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("textDecoration")){var S=e.textDecoration;Array.isArray(S)?t.textDecoration=S.map((function(e){var t=ph.NONE;return"underline"===e?t=ph.UNDERLINE:"line-through"!==e&&"lineThrough"!==e||(t=ph.LINE_THROUGH),{v:t,u:zu.NUMBER}})):t.textDecoration=[]}if(e.hasOwnProperty("transformOrigin")){var _=e.transformOrigin,C=void 0;(C=Array.isArray(_)?_:(_||"").toString().match(Md.position))&&C.length?1===C.length&&(C[1]=C[0]):C=[50,50];for(var A=[],T=0;T<2;T++){var O=C[T];if(/^[-+]?[\d.]/.test(O)){var M=fh(O,!0);A.push(M)}else A.push({v:{top:0,left:0,center:50,right:100,bottom:100}[O],u:zu.PERCENT}),Lu(A[T].v)&&(A[T].v=50)}t.transformOrigin=A}if(e.hasOwnProperty("booleanOperation")){var k=e.booleanOperation;o=qu.NONE;"union"===k?o=qu.UNION:"subtract"===k?o=qu.SUBTRACT:"intersect"===k?o=qu.INTERSECT:"xor"===k&&(o=qu.XOR),t.booleanOperation={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("mixBlendMode")&&(t.mixBlendMode={v:Vf(e.mixBlendMode),u:zu.NUMBER}),e.hasOwnProperty("pointerEvents")&&(t.pointerEvents={v:!!e.pointerEvents,u:zu.BOOLEAN}),e.hasOwnProperty("maskMode")){var L=e.maskMode;o=Ju.NONE;"outline"===L?o=Ju.OUTLINE:"alpha"===L?o=Ju.ALPHA:"gray"===L?o=Ju.GRAY:"alpha-with"===L?o=Ju.ALPHA_WITH:"gray-with"===L&&(o=Ju.GRAY_WITH),t.maskMode={v:o,u:zu.NUMBER}}if(e.hasOwnProperty("breakMask")&&(t.breakMask={v:!!e.breakMask,u:zu.BOOLEAN}),e.hasOwnProperty("blur")){var R=e.blur;if(o=Md.blur.exec(R)){var I=o[1].toLowerCase();if("gauss"===I)t.blur={v:{t:Yu.GAUSSIAN,radius:{v:parseFloat(o[2])||0,u:zu.PX}},u:zu.BLUR};else if("background"===I){var P=0;(F=/saturation\s*\((.+)\)/i.exec(R))&&(P=parseInt(F[1])||0),t.blur={v:{t:Yu.BACKGROUND,radius:{v:parseInt(o[2])||0,u:zu.PX},saturation:{v:P,u:zu.PERCENT}},u:zu.BLUR}}else if("radial"===I){var F=/center\s*\((.+)\)/i.exec(R),D=[{v:50,u:zu.PERCENT},{v:50,u:zu.PERCENT}];if(F){var N=F[1].match(Md.number);N&&(D[0]={v:parseFloat(N[0]),u:zu.PERCENT},D[1]={v:parseFloat(N[1]),u:zu.PERCENT})}t.blur={v:{t:Yu.RADIAL,radius:{v:parseFloat(o[2])||0,u:zu.PX},center:D},u:zu.BLUR}}else if("motion"===I){F=/angle\s*\((.+)\)/i.exec(R);var B={v:0,u:zu.DEG};F&&(B.v=parseFloat(F[1])),t.blur={v:{t:Yu.MOTION,radius:{v:parseFloat(o[2])||0,u:zu.PX},angle:B},u:zu.BLUR}}else t.blur={v:{t:Yu.NONE},u:zu.BLUR}}else t.blur={v:{t:Yu.NONE},u:zu.BLUR}}if(e.hasOwnProperty("shadow")){var U=e.shadow;Array.isArray(U)?t.shadow=U.map((function(e){var t=Md.color.exec(e),r=e;t&&(r=r.slice(0,t.index)+r.slice(t.index+t[0].length));var n=r.match(Md.number),i=fh(n?n[0]:"0px",!0),o=fh(n?n[1]:"0px",!0),a=fh(n?n[2]:"0px",!0);return a.v=Math.max(0,a.v),{v:{x:i,y:o,blur:a,spread:fh(n?n[3]:"0px",!0),color:{v:Zf(t?t[0]:"#000"),u:zu.RGBA}},u:zu.SHADOW}})):t.shadow=[]}if(e.hasOwnProperty("shadowEnable")){var z=e.shadowEnable;Array.isArray(z)?t.shadowEnable=z.map((function(e){return{v:e,u:zu.BOOLEAN}})):t.shadowEnable=t.shadow.map((function(){return{v:!0,u:zu.BOOLEAN}}))}if(e.hasOwnProperty("innerShadow")){var G=e.innerShadow;Array.isArray(G)?t.innerShadow=G.map((function(e){var t=Md.color.exec(e),r=e;t&&(r=r.slice(0,t.index)+r.slice(t.index+t[0].length));var n=r.match(Md.number),i=fh(n?n[0]:"0px",!0),o=fh(n?n[1]:"0px",!0),a=fh(n?n[2]:"0px",!0);a.v=Math.max(0,a.v);var s=fh(n?n[3]:"0px",!0);return s.v=Math.max(0,s.v),{v:{x:i,y:o,blur:a,spread:s,color:{v:Zf(t?t[0]:"#000"),u:zu.RGBA}},u:zu.SHADOW}})):t.innerShadow=[]}if(e.hasOwnProperty("innerShadowEnable")){var X=e.innerShadowEnable;Array.isArray(X)?t.innerShadowEnable=X.map((function(e){return{v:e,u:zu.BOOLEAN}})):t.innerShadowEnable=t.innerShadow.map((function(){return{v:!0,u:zu.BOOLEAN}}))}if(["hueRotate","saturate","brightness","contrast"].forEach((function(r){if(e.hasOwnProperty(r)){var n=fh(e[r]);"hueRotate"===r?n.u!==zu.DEG&&(n.u=zu.DEG):n.u!==zu.PERCENT&&(n.v*=100,n.u=zu.PERCENT),t[r]=n}})),e.hasOwnProperty("matrix")){var H=e.matrix;Array.isArray(H)&&(t.matrix={v:H,u:zu.MATRIX})}return t}function qf(e){return K(K({},e),{color:Zf(e.color),textAlign:{left:Gu.LEFT,center:Gu.CENTER,right:Gu.RIGHT,justify:Gu.JUSTIFY}[e.textAlign],textDecoration:e.textDecoration.map((function(e){return{none:ph.NONE,underline:ph.UNDERLINE,lineThrough:ph.LINE_THROUGH,"line-through":ph.LINE_THROUGH}[e]}))})}function Vf(e){var t=Hu.NORMAL;return/multiply/i.test(e)?t=Hu.MULTIPLY:/screen/i.test(e)?t=Hu.SCREEN:/overlay/i.test(e)?t=Hu.OVERLAY:/darken/i.test(e)?t=Hu.DARKEN:/lighten/i.test(e)?t=Hu.LIGHTEN:/color[\-\s]dodge/i.test(e)||/colorDodge/.test(e)?t=Hu.COLOR_DODGE:/color[\-\s]burn/i.test(e)||/colorBurn/.test(e)?t=Hu.COLOR_BURN:/hard[\-\s]light/i.test(e)||/hardLight/.test(e)?t=Hu.HARD_LIGHT:/soft[\-\s]light/i.test(e)||/softLight/.test(e)?t=Hu.SOFT_LIGHT:/difference/i.test(e)?t=Hu.DIFFERENCE:/exclusion/i.test(e)?t=Hu.EXCLUSION:/hue/i.test(e)?t=Hu.HUE:/saturation/i.test(e)?t=Hu.SATURATION:/color/i.test(e)?t=Hu.COLOR:/luminosity/i.test(e)&&(t=Hu.LUMINOSITY),t}function Kf(e,t,r){var n=t[e],i=r[e];if("transformOrigin"===e)return n[0].v===i[0].v&&n[0].u===i[0].u&&n[1].v===i[1].v&&n[1].u===i[1].u;if("color"===e||"backgroundColor"===e)return n.v[0]===i.v[0]&&n.v[1]===i.v[1]&&n.v[2]===i.v[2]&&n.v[3]===i.v[3];if("fill"===e||"stroke"===e){if(n.length!==i.length)return!1;for(var o=0,a=n.length;o<a;o++){var s=n[o],l=i[o];if(s.u!==l.u)return!1;if(s.u===zu.RGBA){if(s.v[0]!==l.v[0]||s.v[1]!==l.v[1]||s.v[2]!==l.v[2]||s.v[3]!==l.v[3])return!1}else if(s.u===zu.GRADIENT){if(s.v.t!==l.v.t)return!1;if(s.v.d.length!==l.v.d.length)return!1;for(var c=0,u=s.v.d.length;c<u;c++)if(s.v.d[c]!==l.v.d[c])return!1;if(s.v.stops.length!==l.v.stops.length)return!1;for(var h=0,d=s.v.stops.length;h<d;h++){var f=s.v.stops[h],p=l.v.stops[h];if(f.color.v[0]!==p.color.v[0]||f.color.v[1]!==p.color.v[1]||f.color.v[2]!==p.color.v[2]||f.color.v[3]!==p.color.v[3])return!1;if(f.offset&&!p.offset||!f.offset&&p.offset)return!1;if(f.offset.u!==p.offset.u||f.offset.v!==p.offset.v)return!1}}}return!0}if("fillEnable"===e||"fillRule"===e||"fillOpacity"===e||"strokeEnable"===e||"strokeWidth"===e||"strokePosition"===e||"strokeDasharray"===e||"shadowEnable"===e||"innerShadowEnable"===e){if(n.length!==i.length)return!1;for(o=0,a=n.length;o<a;o++){s=n[o],l=i[o];if(s.u!==l.u||s.v!==l.v)return!1}return!0}if("matrix"===e){if(n&&!i||!n&&i)return!1;var v=n.v,y=i.v;if(v.length!==y.length)return!1;for(o=0,a=v.length;o<a;o++)if(v[o]!==y[o])return!1;return!0}if("shadow"===e||"innerShadow"===e){if(n.length!==i.length)return!1;for(o=0,a=n.length;o<a;o++){s=n[o].v,l=i[o].v;if(s.x.v!==l.x.v||s.x.u!==l.x.u||s.y.v!==l.y.v||s.y.u!==l.y.u||s.blur.v!==l.blur.v||s.blur.u!==l.blur.u||s.spread.v!==l.spread.v||s.spread.u!==l.spread.u)return!1;var g=s.color.v,m=l.color.v;if(g[0]!==m[0]||g[1]!==m[1]||g[2]!==m[2]||g[3]!==m[3])return!1}return!0}return n.v===i.v&&n.u===i.u}function Zf(e){if(Array.isArray(e))return e;var t=[];if(!e||/transparent/i.test(e))t=[0,0,0,0];else if(/^#?[a-f\d]{3,8}$/i.test(e))3===(e=e.replace("#","")).length||4===e.length?(t.push(parseInt(e.charAt(0)+e.charAt(0),16)),t.push(parseInt(e.charAt(1)+e.charAt(1),16)),t.push(parseInt(e.charAt(2)+e.charAt(2),16)),4===e.length?t[3]=parseInt(e.charAt(3)+e.charAt(3),16):t[3]=1):6===e.length?(t.push(parseInt(e.slice(0,2),16)),t.push(parseInt(e.slice(2,4),16)),t.push(parseInt(e.slice(4),16)),t[3]=1):8===e.length?(t.push(parseInt(e.slice(0,2),16)),t.push(parseInt(e.slice(2,4),16)),t.push(parseInt(e.slice(4,6),16)),t.push(parseInt(e.slice(6),16)/255)):(t[0]=t[1]=t[2]=0,t[3]=1);else{var r=e.match(/rgba?\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)(?:\s*,\s*([\d.]+))?\s*\)/i);r?(t=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],Lu(r[4])?t[3]=1:t[3]=parseFloat(r[4])):t=[0,0,0,0]}return t}function Jf(e){var t=Zf(e);return Array.isArray(t)&&(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),3===t.length||4===t.length)?4===t.length?(t[3]=Math.max(t[3],0),"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"):"rgba("+t[0]+","+t[1]+","+t[2]+",1)":e||"rgba(0,0,0,0)"}function $f(e){var t=e.toString(16).toUpperCase();return 1===t.length&&(t="0"+t),t}function Qf(e){var t=Zf(e);return!Array.isArray(t)||3!==t.length&&4!==t.length?e||"#000":(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),4===t.length&&t[3]<1?(t[3]=Math.max(t[3],0),"#"+$f(t[0])+$f(t[1])+$f(t[2])+$f(Math.floor(255*t[3]))):"#"+$f(t[0])+$f(t[1])+$f(t[2]))}function ep(e){return Array.isArray(e)||(e=Zf(e)),[e[0]/255,e[1]/255,e[2]/255,3===e.length?1:e[3]]}function tp(e){var t=e.fontSize||dh.defaultFontSize,r=e.fontFamily||dh.defaultFontFamily;/[\s.,/\\]/.test(r)&&(r='"'+r.replace(/"/g,'\\"')+'"');var n="";e.fontStyle===ju.ITALIC&&(n="italic ");var i="";return 400!==e.fontWeight&&(i=e.fontWeight+" "),n+i+t+"px "+r}function rp(e){for(var t=e.split(/\s*,\s*/),r=0,n=t.length;r<n;r++){var i=t[r].replace(/^['"]/,"").replace(/['"]$/,"");if(Hh.hasRegister(i)||dh.checkSupportFontFamily(i))return i}return dh.defaultFontFamily}function np(e,t){t||(t=rp(e.fontFamily));var r=(Hh.data[t]||Hh.data[dh.defaultFontFamily]||Hh.data.Arial||{}).lhr;return e.fontSize*r}function ip(e,t){var r=e.fontSize,n=rp(e.fontFamily),i=np(e,n),o=(Hh.data[n]||Hh.data[dh.defaultFontFamily]||Hh.data.Arial||{}).blr||1;return.5*((null!=t?t:e.lineHeight)-i)+r*o}function op(e,t){var r=e.fontSize,n=rp(e.fontFamily),i=np(e,n),o=(Hh.data[n]||Hh.data[dh.defaultFontFamily]||Hh.data.Arial||{}).car||1;return.5*((null!=t?t:e.lineHeight)-i)+r*o}function ap(e,t){return e.u===zu.PX?e.v:e.u===zu.PERCENT?e.v*t*.01:0}function sp(e,t,r,n,i){if(e===Yu.NONE)return"none";var o=["none","gauss","motion","radial","background"][e]+"(".concat(t,")");if(e===Yu.MOTION)o+=" angle(".concat(r||0,")");else if(e===Yu.RADIAL){for(var a=(n||[]).map((function(e){return 100*e+"%"}));a.length<2;)a.push("50%");o+=" center(".concat(a.join(", "),")")}else e===Yu.BACKGROUND&&(o+=" saturation(".concat(100*(void 0===i?1:i),"%)"));return o}function lp(e){return"".concat(Jf(e.color)," ").concat(e.x," ").concat(e.y," ").concat(e.blur," ").concat(e.spread)}function cp(e,t,r,n){if(void 0===n&&(n=!1),Array.isArray(e))return Jf(e);var i=e;if(void 0!==i.url){var o=["tile","fill","stretch","fit"][i.type];return"url(".concat(i.url,") ").concat(o," ").concat(i.scale)}return jf(e,t,r,n)}function up(e){return["center","inside","outside"][e]||"inside"}function hp(e){return e[0]=Math.min(255,Math.max(0,Math.round(e[0]))),e[1]=Math.min(255,Math.max(0,Math.round(e[1]))),e[2]=Math.min(255,Math.max(0,Math.round(e[2]))),e.length>3&&(e[3]=Math.min(1,Math.max(0,e[3]))),e}var dp,fp={normalize:Yf,normalizeRich:qf,normalizeColor:hp,equalStyle:Kf,color2rgbaInt:Zf,color2rgbaStr:Jf,color2hexStr:Qf,color2gl:ep,calFontFamily:rp,calNormalLineHeight:np,getBaseline:ip,getContentArea:op,calSize:ap,getCssBlur:sp,getCssShadow:lp,getCssFillStroke:cp,getCssStrokePosition:up};function pp(e){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,a,s;return J(this,(function(l){switch(l.label){case 0:return[4,vp(e,"document.json")];case 1:if(t=l.sent(),r=[],!t.pages)return[3,5];n=0,i=t.pages.length,l.label=2;case 2:return n<i?(o=r,a=n,[4,vp(e,t.pages[n]._ref+".json")]):[3,5];case 3:o[a]=l.sent(),l.label=4;case 4:return n++,[3,2];case 5:return[4,vp(e,"meta.json")];case 6:return l.sent(),[4,vp(e,"user.json")];case 7:return s=l.sent(),[4,yp({document:t,pages:r,user:s},e)];case 8:return[2,l.sent()]}}))}))}function vp(e,t){return Z(this,void 0,void 0,(function(){var r,n;return J(this,(function(i){switch(i.label){case 0:return[4,null===(n=e.file(t))||void 0===n?void 0:n.async("string")];case 1:return(r=i.sent())?[2,JSON.parse(r)]:[2,{}]}}))}))}function yp(e,t){return Z(this,void 0,void 0,(function(){var r,n,i,o,a,s,u,h,d,f,p,v,y,g,m;return J(this,(function(b){switch(b.label){case 0:return(r=((null===(y=e.document)||void 0===y?void 0:y.fontReferences)||[]).filter((function(e){if(!e.fontData||!e.fontData._ref)return!1;var t=e.fontFamilyName;return!Hh.hasRegister(t)&&!!e.postscriptNames[0]}))).length?[4,Promise.all(r.map((function(e){return"MSFontData"===e.fontData._ref_class&&t?function(e,t){return Z(this,void 0,void 0,(function(){var r,n;return J(this,(function(i){switch(i.label){case 0:return(r=t.file(e))?[4,r.async("arraybuffer")]:(dh.error("font not exist: >>>".concat(e,"<<<")),[2]);case 1:return n=i.sent(),Hh.registerAb(n),[2]}}))}))}(e.fontData._ref,t):"MSNetFontData"===e.fontData._ref_class?function(e,t){return Z(this,void 0,void 0,(function(){return J(this,(function(r){return Hh.hasRegister(t)?[2]:[2,new Promise((function(t,r){fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){Hh.registerAb(e),t()})).catch((function(){r()}))}))]}))}))}(e.fontData._ref,e.postscriptNames[0]):void 0})))]:[3,2];case 1:b.sent(),b.label=2;case 2:n={zipFile:t,user:e.user,imgSrcRecord:{}},i=[],o=(null===(g=e.document)||void 0===g?void 0:g.foreignSymbols)||[],h=0,d=o.length,b.label=3;case 3:return h<d?(a=i,s=h,[4,mp(o[h].symbolMaster,(h+1)/(d+1),n,l,c)]):[3,6];case 4:a[s]=b.sent(),b.label=5;case 5:return h++,[3,3];case 6:if(u=[],!e.pages)return[3,10];h=0,d=e.pages.length,b.label=7;case 7:return h<d?(f=u,p=h,[4,gp(e.pages[h],(h+1)/(d+1),n)]):[3,10];case 8:f[p]=b.sent(),b.label=9;case 9:return h++,[3,7];case 10:return[2,{document:{uuid:(v=e.document).do_objectID,assets:{uuid:v.assets.do_objectID},layerStyles:{uuid:v.layerStyles.do_objectID},layerTextStyles:{uuid:v.layerTextStyles.do_objectID}},pages:u,currentPageIndex:(null===(m=e.document)||void 0===m?void 0:m.currentPageIndex)||0,symbolMasters:i}]}}))}))}function gp(e,t,r){return Z(this,void 0,void 0,(function(){var n,i,o,a,u,h,d,f,p,v,y;return J(this,(function(g){switch(g.label){case 0:n=[],i=0,o=e.layers.length,g.label=1;case 1:return i<o?[4,mp(e.layers[i],(i+1)/(o+1),r,l,c)]:[3,4];case 2:(a=g.sent())&&n.push(a),g.label=3;case 3:return i++,[3,1];case 4:return u=0,h=0,d=1,(f=r.user[e.do_objectID])&&(p=f.scrollOrigin,v=f.zoomValue,p&&(y=/\{([+-.\d]+),\s*([+-.\d]+)}/.exec(p))&&(u=parseFloat(y[1])||0,h=parseFloat(y[2])||0),v&&(d=v)),[2,{tagName:s.PAGE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:e.frame.constrainProportions,rule:{baseX:e.horizontalRulerData.base,baseY:e.verticalRulerData.base},style:{width:l,height:c,visibility:"hidden",translateX:u,translateY:h,scaleX:d,scaleY:d,transformOrigin:[0,0],pointerEvents:!1},isLocked:!1,isExpanded:!1},children:n.filter((function(e){return e}))}]}}))}))}function mp(e,t,r,n,i){return Z(this,void 0,void 0,(function(){var o,a,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C,A,T,O,M,k,L,R,I,P,F,D,N,B,U,z,G,X,H,j,W,Y,q,V,K,Z,$,ee,te,re,ne,ie,oe,ae,se,le,ce,ue,he,de,fe,pe,ve,ye,ge,me,be,xe,Ee,we,Se,_e,Ce,Ae,Te,Oe,Me,ke,Le,Re,Ie,Pe,Fe,De,Ne,Be,Ue,ze,Ge,Xe,He,je,We,Ye,qe,Ve,Ke,Ze,Je,$e,Qe,et,tt,rt,nt,it,ot,at,st,lt,ct,ut,ht,dt,ft,pt,vt,yt,gt,mt,bt,xt,Et,wt,St,_t,Ct,At,Tt;return J(this,(function(J){switch(J.label){case 0:if(o=e.frame.width||.5,a=e.frame.height||.5,l=e.frame.x||0,c=e.frame.y||0,n<0&&(n=0),i<0&&(i=0),o<0&&(l+=o,o=Math.abs(o)),a<0&&(c+=a,a=Math.abs(a)),u=e.isVisible?"visible":"hidden",h=null!==(it=null===(nt=null===(rt=e.style)||void 0===rt?void 0:rt.contextSettings)||void 0===nt?void 0:nt.opacity)&&void 0!==it?it:1,d=-e.rotation,f=e.isFlippedHorizontal?-1:1,p=e.isFlippedVertical?-1:1,e._class===Q.ClassValue.SymbolInstance&&e.scale&&1!==e.scale&&(f*=e.scale,p*=e.scale,v=o/e.scale,y=a/e.scale,l-=.5*(v-o),c-=.5*(y-a),o/=e.scale,a/=e.scale),g=e.isLocked,m=e.layerListExpandedType===Q.LayerListExpanded.Expanded,b=e.frame.constrainProportions,e._class!==Q.ClassValue.Artboard&&e._class!==Q.ClassValue.SymbolMaster)return[3,5];$e=[],Qe=0,et=e.layers.length,J.label=1;case 1:return Qe<et?[4,mp(e.layers[Qe],(Qe+1)/(et+1),r,o,a)]:[3,4];case 2:(tt=J.sent())&&$e.push(tt),J.label=3;case 3:return Qe++,[3,1];case 4:return x=e.hasBackgroundColor,E=x?[Math.floor(255*e.backgroundColor.red),Math.floor(255*e.backgroundColor.green),Math.floor(255*e.backgroundColor.blue),e.backgroundColor.alpha]:[255,255,255,1],e._class===Q.ClassValue.SymbolMaster?(w=e.symbolID,S=e.includeBackgroundColorInInstance,[2,{tagName:s.SYMBOL_MASTER,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,constrainProportions:b,hasBackgroundColor:x,resizesContent:e.resizesContent,symbolId:w,includeBackgroundColorInInstance:S,style:{width:o,height:a,visibility:u,opacity:h,translateX:l,translateY:c,rotateZ:d,backgroundColor:E},isLocked:g,isExpanded:m},children:$e.filter((function(e){return e}))}]):[2,{tagName:s.ART_BOARD,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,constrainProportions:b,hasBackgroundColor:x,resizesContent:e.resizesContent,style:{width:o,height:a,visibility:u,opacity:h,translateX:l,translateY:c,rotateZ:d,backgroundColor:E},isLocked:g,isExpanded:m},children:$e.filter((function(e){return e}))}];case 5:return _=e.resizingConstraint^dp.UNSET,C=0,A=0,T="auto",O="auto",_&dp.LEFT?(C=l,_&dp.RIGHT?(T=n-l-o,o="auto"):_&dp.WIDTH||(T=100*(n-l-o)/n+"%",o="auto"),l=0):_&dp.RIGHT?(T=n-l-o,_&dp.WIDTH?C="auto":(C=100*l/n+"%",o="auto"),l=0):_&dp.WIDTH?(C=100*(l+.5*o)/n+"%",l="-50%"):(C=100*l/n+"%",T=100*(n-l-o)/n+"%",l=0,o="auto"),_&dp.TOP?(A=c,_&dp.BOTTOM?(O=i-c-a,a="auto"):_&dp.HEIGHT||(O=100*(i-c-a)/i+"%",a="auto"),c=0):_&dp.BOTTOM?(O=i-c-a,_&dp.HEIGHT?A="auto":(A=100*c/i+"%",a="auto"),c=0):_&dp.HEIGHT?(A=100*(c+.5*a)/i+"%",c="-50%"):(A=100*c/i+"%",O=100*(i-c-a)/i+"%",c=0,a="auto"),(!n||n<0)&&("auto"!==C&&(C="0%"),"auto"!==T&&(T="0%")),(!i||i<0)&&("auto"!==A&&(A="0%"),"auto"!==O&&(O="0%")),M="none",k=e.hasClippingMask,L=e.clippingMaskMode,k&&(M=L?"alpha":"outline"),R=e.shouldBreakMaskChain,I="none",(null===(at=null===(ot=e.style)||void 0===ot?void 0:ot.blur)||void 0===at?void 0:at.isEnabled)&&(P=e.style.blur,(F=P.type)===Q.BlurType.Gaussian?I="gauss(".concat(P.radius,"px)"):F===Q.BlurType.Background?I="background(".concat(P.radius,"px) saturation(").concat(100*(P.saturation||0),"%)"):F===Q.BlurType.Zoom?(D=P.center.match(Md.number)||["0.5","0.5"],N=D.map((function(e){return 100*parseFloat(e)+"%"})),I="radial(".concat(P.radius,"px) center(").concat(N[0],", ").concat(N[1],")")):F===Q.BlurType.Motion&&(I="motion(".concat(P.radius,"px) angle(").concat(-1*(P.motionAngle||0),")"))),B=0,U=1,z=1,G=1,(X=null===(st=e.style)||void 0===st?void 0:st.colorControls)&&X.isEnabled&&(X.hue&&(B=Ed(X.hue)),U=X.saturation,X.brightness&&(z=X.brightness+1),G=X.contrast),H=null===(ct=null===(lt=e.style)||void 0===lt?void 0:lt.contextSettings)||void 0===ct?void 0:ct.blendMode,j=Sp(H),W=[],Y=[],q=[],V=[],(K=null===(ut=e.style)||void 0===ut?void 0:ut.shadows)&&K.forEach((function(e){var t=[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha];W.push("".concat(Jf(t)," ").concat(e.offsetX," ").concat(e.offsetY," ").concat(e.blurRadius," ").concat(e.spread," ")),Y.push(e.isEnabled)})),(Z=null===(ht=e.style)||void 0===ht?void 0:ht.innerShadows)&&Z.forEach((function(e){var t=[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha];q.push("".concat(Jf(t)," ").concat(e.offsetX," ").concat(e.offsetY," ").concat(e.blurRadius," ").concat(e.spread)),V.push(e.isEnabled)})),e._class!==Q.ClassValue.SymbolInstance?[3,8]:[4,xp(e,r)];case 6:return $=J.sent(),Ne=$.fill,Be=$.fillEnable,Ue=$.fillOpacity,[4,Cp(e.overrideValues,r)];case 7:return ee=J.sent(),[2,{tagName:s.SYMBOL_INSTANCE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,symbolId:e.symbolID,overrideValues:ee,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:W,shadowEnable:Y,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:m}}];case 8:if(e._class!==Q.ClassValue.Group)return[3,14];$e=[],Qe=0,et=e.layers.length,J.label=9;case 9:return Qe<et?[4,mp(e.layers[Qe],(Qe+1)/(et+1),r,e.frame.width,e.frame.height)]:[3,12];case 10:(tt=J.sent())&&$e.push(tt),J.label=11;case 11:return Qe++,[3,9];case 12:return[4,xp(e,r)];case 13:return te=J.sent(),Ne=te.fill,Be=te.fillEnable,Ue=te.fillOpacity,[2,{tagName:s.GROUP,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:W,shadowEnable:Y,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:m},children:$e.filter((function(e){return e}))}];case 14:return e._class!==Q.ClassValue.Bitmap?[3,19]:(re="",ne="","MSImageData"!==e.image._ref_class?[3,16]:(ne=e.image._ref.replace(/^images\//,""),[4,wp(e.image._ref,r)]));case 15:return re=J.sent(),[3,17];case 16:"MSNetworkImage"===e.image._ref_class&&(re=e.image._ref),J.label=17;case 17:return[4,xp(e,r)];case 18:return ie=J.sent(),Ne=ie.fill,Be=ie.fillEnable,Ue=ie.fillOpacity,ze=ie.fillMode,Xe=ie.stroke,He=ie.strokeEnable,je=ie.strokeWidth,We=ie.strokePosition,Ye=ie.strokeMode,qe=ie.strokeDasharray,Ve=ie.strokeLinecap,Ke=ie.strokeLinejoin,Ze=ie.strokeMiterlimit,[2,{tagName:s.BITMAP,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,stroke:Xe,strokeEnable:He,strokeWidth:je,strokePosition:We,strokeMode:Ye,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:W,shadowEnable:Y,innerShadow:q,innerShadowEnable:V,hueRotate:B,saturate:U,brightness:z,contrast:G},isLocked:g,isExpanded:m,src:re,md5:ne}}];case 19:return e._class!==Q.ClassValue.Text?[3,21]:(oe=e.textBehaviour,ae=void 0,oe===Q.TextBehaviour.Flexible?(ae=nh.AUTO,"auto"!==C&&"auto"!==T&&(T="auto",se=parseFloat(C.toString()),C=/%$/.test(C.toString())?se+50*e.frame.width/n+"%":se+.5*e.frame.width,l="-50%"),o=e.frame.width,"auto"!==A&&"auto"!==O&&(O="auto",le=parseFloat(A.toString()),A=/%$/.test(A.toString())?le+50*e.frame.height/i+"%":le+.5*e.frame.height,c="-50%"),a=e.frame.height):oe===Q.TextBehaviour.Fixed?(ae=nh.FIXED_W,"auto"!==A&&"auto"!==O&&(O="auto",le=parseFloat(A.toString()),A=/%$/.test(A.toString())?le+50*e.frame.height/i+"%":le+.5*e.frame.height,c="-50%"),a=e.frame.height):ae=nh.FIXED_W_H,ce=e.attributedString,ue=ce.string,he=ce.attributes,de=he.length?he.map((function(e){var t=e.location,r=e.length,n=e.attributes,i=n.MSAttributedStringFontAttribute,o=(void 0===i?{}:i).attributes,a=void 0===o?{}:o,s=a.name,l=void 0===s?dh.defaultFontFamily:s,c=a.size,u=void 0===c?dh.defaultFontSize:c,h=n.MSAttributedStringColorAttribute,d=void 0===h?{}:h,f=d.red,p=void 0===f?0:f,v=d.green,y=void 0===v?0:v,g=d.blue,m=void 0===g?0:g,b=d.alpha,x=void 0===b?1:b,E=n.kerning,w=void 0===E?0:E,S=n.underlineStyle,_=void 0===S?Q.UnderlineStyle.None:S,C=n.strikethroughStyle,A=void 0===C?Q.StrikethroughStyle.None:C,T=n.paragraphStyle,O=void 0===T?{}:T,M=O.alignment,k=void 0===M?0:M,L=O.maximumLineHeight,R=void 0===L?0:L,I=O.paragraphSpacing,P=void 0===I?0:I,F=[];return _!==Q.UnderlineStyle.None&&F.push("underline"),A!==Q.StrikethroughStyle.None&&F.push("lineThrough"),{location:parseInt(t)||0,length:parseInt(r)||0,fontFamily:l,fontSize:u,fontWeight:400,fontStyle:"normal",letterSpacing:w,textAlign:["left","right","center","justify"][k||0],textDecoration:F,lineHeight:R,paragraphSpacing:P,color:[Math.floor(255*p),Math.floor(255*y),Math.floor(255*m),x]}})):[],fe=null===(vt=null===(pt=null===(ft=null===(dt=e.style)||void 0===dt?void 0:dt.textStyle)||void 0===ft?void 0:ft.encodedAttributes)||void 0===pt?void 0:pt.MSAttributedStringFontAttribute)||void 0===vt?void 0:vt.attributes,pe=(null==fe?void 0:fe.size)||(null===(yt=de[0])||void 0===yt?void 0:yt.fontSize)||dh.defaultFontSize,ve=(null==fe?void 0:fe.name)||(null===(gt=de[0])||void 0===gt?void 0:gt.fontFamily)||dh.defaultFontFamily,ye=null===(xt=null===(bt=null===(mt=e.style)||void 0===mt?void 0:mt.textStyle)||void 0===bt?void 0:bt.encodedAttributes)||void 0===xt?void 0:xt.paragraphStyle,ge=(null==ye?void 0:ye.maximumLineHeight)||"normal",me=(null===(wt=null===(Et=e.style)||void 0===Et?void 0:Et.textStyle)||void 0===wt?void 0:wt.encodedAttributes)||{},be=me.underlineStyle,xe=void 0===be?0:be,Ee=me.strikethroughStyle,we=void 0===Ee?0:Ee,Se=me.kerning,_e=void 0===Se?0:Se,Ce=me.MSAttributedStringColorAttribute,Ae=void 0!==(null==ye?void 0:ye.alignment)?["left","right","center","justify"][ye.alignment||0]:null!==(_t=null===(St=de[0])||void 0===St?void 0:St.textAlign)&&void 0!==_t?_t:"left",Te=null===(At=null===(Ct=e.style)||void 0===Ct?void 0:Ct.textStyle)||void 0===At?void 0:At.verticalAlignment,Oe=["top","middle","bottom"][Te||0],Me=[],xe!==Q.UnderlineStyle.None&&Me.push("underline"),xe&&we!==Q.StrikethroughStyle.None&&Me.push("lineThrough"),ke=(null==ye?void 0:ye.paragraphSpacing)||0,Le=Ce?[Math.floor(255*Ce.red),Math.floor(255*Ce.green),Math.floor(255*Ce.blue),Ce.alpha]:(null===(Tt=de[0])||void 0===Tt?void 0:Tt.color)||[0,0,0,1],de[0]&&de[0].textAlign!==Ae&&(Ae=de[0].textAlign),[4,xp(e,r)]);case 20:return Re=J.sent(),Ne=Re.fill,Be=Re.fillEnable,Ue=Re.fillOpacity,ze=Re.fillMode,Xe=Re.stroke,He=Re.strokeEnable,je=Re.strokeWidth,We=Re.strokePosition,Ye=Re.strokeMode,qe=Re.strokeDasharray,Ve=Re.strokeLinecap,Ke=Re.strokeLinejoin,Ze=Re.strokeMiterlimit,Je=Re.styleId,[2,{tagName:s.TEXT,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,textBehaviour:ae,styleId:Je,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,stroke:Xe,strokeEnable:He,strokeWidth:je,strokePosition:We,strokeMode:Ye,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,fontSize:pe,fontFamily:ve,color:Le,textAlign:Ae,textVerticalAlign:Oe,textDecoration:Me,letterSpacing:_e,lineHeight:ge,paragraphSpacing:ke,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:W,shadowEnable:Y,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:m,content:ue,rich:de}}];case 21:return e._class!==Q.ClassValue.Rectangle&&e._class!==Q.ClassValue.Oval&&e._class!==Q.ClassValue.Star&&e._class!==Q.ClassValue.Triangle&&e._class!==Q.ClassValue.Polygon&&e._class!==Q.ClassValue.ShapePath?[3,23]:(Ie=e.points.map((function(e){var t=Ep(e.point),r=Ep(e.curveFrom),n=Ep(e.curveTo);return{x:t.x,y:t.y,cornerRadius:e.cornerRadius,cornerStyle:e.cornerStyle,curveMode:e.curveMode,hasCurveFrom:e.hasCurveFrom,hasCurveTo:e.hasCurveTo,fx:r.x,fy:r.y,tx:n.x,ty:n.y}})),[4,xp(e,r)]);case 22:return Pe=J.sent(),Ne=Pe.fill,Be=Pe.fillEnable,Ue=Pe.fillOpacity,ze=Pe.fillMode,Ge=Pe.fillRule,Xe=Pe.stroke,He=Pe.strokeEnable,je=Pe.strokeWidth,We=Pe.strokePosition,Ye=Pe.strokeMode,qe=Pe.strokeDasharray,Ve=Pe.strokeLinecap,Ke=Pe.strokeLinejoin,Ze=Pe.strokeMiterlimit,Je=Pe.styleId,Fe=vh.DISABLED,e.pointRadiusBehaviour===Q.PointsRadiusBehaviour.Legacy?Fe=vh.LEGACY:e.pointRadiusBehaviour===Q.PointsRadiusBehaviour.Rounded?Fe=vh.ROUNDED:e.pointRadiusBehaviour===Q.PointsRadiusBehaviour.Smooth&&(Fe=vh.SMOOTH),[2,{tagName:s.POLYLINE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,points:Ie,isClosed:e.isClosed,fixedRadius:e.fixedRadius||0,pointRadiusBehaviour:Fe,isRectangle:"rectangle"===e._class,isOval:"oval"===e._class,styleId:Je,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,fillRule:Ge,stroke:Xe,strokeEnable:He,strokeWidth:je,strokePosition:We,strokeMode:Ye,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,booleanOperation:["union","subtract","intersect","xor"][e.booleanOperation]||"none",mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:W,shadowEnable:Y,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:m}}];case 23:return e._class!==Q.ClassValue.ShapeGroup?[3,29]:[4,xp(e,r)];case 24:De=J.sent(),Ne=De.fill,Be=De.fillEnable,Ue=De.fillOpacity,ze=De.fillMode,Ge=De.fillRule,Xe=De.stroke,He=De.strokeEnable,je=De.strokeWidth,We=De.strokePosition,Ye=De.strokeMode,qe=De.strokeDasharray,Ve=De.strokeLinecap,Ke=De.strokeLinejoin,Ze=De.strokeMiterlimit,Je=De.styleId,$e=[],Qe=0,et=e.layers.length,J.label=25;case 25:return Qe<et?[4,mp(e.layers[Qe],(Qe+1)/(et+1),r,e.frame.width,e.frame.height)]:[3,28];case 26:(tt=J.sent())&&$e.push(tt),J.label=27;case 27:return Qe++,[3,25];case 28:return[2,{tagName:s.SHAPE_GROUP,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,styleId:Je,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,fill:Ne,fillEnable:Be,fillOpacity:Ue,fillMode:ze,fillRule:Ge,stroke:Xe,strokeEnable:He,strokeWidth:je,strokePosition:We,strokeMode:Ye,strokeDasharray:qe,strokeLinecap:Ve,strokeLinejoin:Ke,strokeMiterlimit:Ze,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,booleanOperation:["union","subtract","intersect","xor"][e.booleanOperation]||"none",mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:W,shadowEnable:Y,innerShadow:q,innerShadowEnable:V},isLocked:g,isExpanded:m},children:$e}];case 29:return e._class===Q.ClassValue.Slice?[2,{tagName:s.SLICE,props:{uuid:e.do_objectID,name:e.name,nameIsFixed:e.nameIsFixed,index:t,constrainProportions:b,style:{left:C,top:A,right:T,bottom:O,width:o,height:a,visibility:u,opacity:h,translateX:l,translateY:c,scaleX:f,scaleY:p,rotateZ:d,breakMask:R},isLocked:g}}]:(dh.error(e),[2])}}))}))}function bp(e,t){return Z(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u;return J(this,(function(h){switch(h.label){case 0:return e.fillType!==Q.FillType.Pattern?[3,4]:(r="","MSImageData"!==(n=e.image)._ref_class?[3,2]:[4,wp(n._ref,t)]);case 1:return r=h.sent(),[3,3];case 2:"MSNetworkImage"===n._ref_class&&(r=n._ref),h.label=3;case 3:return i=["tile","fill","stretch","fit"][e.patternFillType],o=e.patternTileScale,[2,"url(".concat(r,") ").concat(i," ").concat(100*o,"%")];case 4:if(e.fillType===Q.FillType.Gradient){if(a=e.gradient,s=Ep(a.from),l=Ep(a.to),c=a.stops.map((function(e){return Jf([Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha])+" "+100*e.position+"%"})),a.gradientType===Q.GradientType.Linear)return[2,"linearGradient(".concat(s.x," ").concat(s.y," ").concat(l.x," ").concat(l.y,",").concat(c.join(","),")")];if(a.gradientType===Q.GradientType.Radial)return u=a.elipseLength,[2,"radialGradient(".concat(s.x," ").concat(s.y," ").concat(l.x," ").concat(l.y," ").concat(u,",").concat(c.join(","),")")];if(a.gradientType===Q.GradientType.Angular)return[2,"conicGradient(".concat(.5," ").concat(.5," ").concat(.5," ").concat(.5,",").concat(c.join(","),")")];throw new Error("Unknown gradient")}return[2,[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha]];case 5:return[2]}}))}))}function xp(e,t){return Z(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C,A,T,O,M,k,L,R,I,P;return J(this,(function(F){switch(F.label){case 0:if(r=e.style||{},n=r.borders,i=r.borderOptions,o=r.fills,a=r.windingRule,s=r.miterLimit,l=r.do_objectID,c=[],u=[],h=[],d=[],!o)return[3,4];b=0,x=o.length,F.label=1;case 1:return b<x?[4,bp(E=o[b],t)]:[3,4];case 2:f=F.sent(),c.push(f),u.push(E.isEnabled),h.push(null!==(R=null===(L=E.contextSettings)||void 0===L?void 0:L.opacity)&&void 0!==R?R:1),T=null===(I=E.contextSettings)||void 0===I?void 0:I.blendMode,d.push(Sp(T)),F.label=3;case 3:return b++,[3,1];case 4:if(p=[],v=[],y=[],g=[],m=[],n)for(b=0,x=n.length;b<x;b++){if((E=n[b]).fillType===Q.FillType.Gradient)if(w=E.gradient,S=Ep(w.from),_=Ep(w.to),C=w.stops.map((function(e){return Jf([Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha])+" "+100*e.position+"%"})),w.gradientType===Q.GradientType.Linear)p.push("linearGradient(".concat(S.x," ").concat(S.y," ").concat(_.x," ").concat(_.y,",").concat(C.join(","),")"));else if(w.gradientType===Q.GradientType.Radial)A=w.elipseLength,p.push("radialGradient(".concat(S.x," ").concat(S.y," ").concat(_.x," ").concat(_.y," ").concat(A,",").concat(C.join(","),")"));else{if(w.gradientType!==Q.GradientType.Angular)throw new Error("Unknown gradient");p.push("conicGradient(".concat(S.x," ").concat(S.y," ").concat(_.x," ").concat(_.y,",").concat(C.join(","),")"))}else p.push([Math.floor(255*E.color.red),Math.floor(255*E.color.green),Math.floor(255*E.color.blue),E.color.alpha]);v.push(E.isEnabled),y.push(E.thickness||0),E.position===Q.BorderPosition.Inside?g.push("inside"):E.position===Q.BorderPosition.Outside?g.push("outside"):g.push("center"),T=null===(P=E.contextSettings)||void 0===P?void 0:P.blendMode,m.push(Sp(T))}return O=[],M="butt",k="miter",i&&(i.dashPattern.forEach((function(e){O.push(e)})),i.lineCapStyle===Q.LineCapStyle.Round?M="round":i.lineCapStyle===Q.LineCapStyle.Projecting&&(M="square"),i.lineJoinStyle===Q.LineJoinStyle.Round?k="round":i.lineJoinStyle===Q.LineJoinStyle.Bevel&&(k="bevel")),[2,{fill:c,fillEnable:u,fillOpacity:h,fillMode:d,fillRule:a===Q.WindingRule.EvenOdd?"evenodd":"nonzero",stroke:p,strokeEnable:v,strokeWidth:y,strokePosition:g,strokeMode:m,strokeDasharray:O,strokeLinecap:M,strokeLinejoin:k,strokeMiterlimit:s,styleId:l}]}}))}))}function Ep(e){var t=/{(.+),\s*(.+)}/.exec(e||"");return t?{x:parseFloat(t[1])||0,y:parseFloat(t[2])||0}:{x:0,y:0}}function wp(e,t){return Z(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c;return J(this,(function(u){switch(u.label){case 0:return e&&t.zipFile?t.imgSrcRecord.hasOwnProperty(e)?[2,t.imgSrcRecord[e]]:(r=t.zipFile.file(e))||(r=t.zipFile.file(e))?[4,r.async("arraybuffer")]:(dh.error("image not exist: >>>".concat(e,"<<<")),[2,""]):[2,""];case 1:if(n=u.sent(),i=new Uint8Array(n),o=!1,37===i[0]&&80===i[1]&&68===i[2]&&70===i[3]&&(o=!0),!n.byteLength)return dh.error("image is empty: >>>".concat(e,"<<<")),[2,""];if(!o)return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,dh.loadArrayBufferPdf(n)];case 3:return a=u.sent(),[3,5];case 4:return s=u.sent(),dh.error(s),[2,""];case 5:return[3,9];case 6:return u.trys.push([6,8,,9]),[4,dh.loadArrayBufferImg(n)];case 7:return a=u.sent(),[3,9];case 8:return l=u.sent(),dh.error(l),[2,""];case 9:return c=a.src||"blob:file://"+e,dh.IMG[c]={success:!0,state:dh.LOADED,width:a.width,height:a.height,source:a,url:c},t.imgSrcRecord[e]=c,[2,c]}}))}))}function Sp(e){void 0===e&&(e=Q.BlendMode.Normal);var t="normal";return e===Q.BlendMode.Darken?t="darken":e===Q.BlendMode.Multiply?t="multiply":e===Q.BlendMode.ColorBurn?t="color-burn":e===Q.BlendMode.Lighten?t="lighten":e===Q.BlendMode.Screen?t="screen":e===Q.BlendMode.ColorDodge?t="color-dodge":e===Q.BlendMode.Overlay?t="overlay":e===Q.BlendMode.SoftLight?t="soft-light":e===Q.BlendMode.HardLight?t="hard-light":e===Q.BlendMode.Difference?t="difference":e===Q.BlendMode.Exclusion?t="exclusion":e===Q.BlendMode.Hue?t="hue":e===Q.BlendMode.Saturation?t="saturation":e===Q.BlendMode.Color?t="color":e===Q.BlendMode.Luminosity?t="luminosity":e===Q.BlendMode.PlusDarker||Q.BlendMode.PlusLighter,t}function _p(e,t){return t?(t.alpha=e[3],t.red=e[0]/255,t.green=e[1]/255,t.blue=e[2]/255,t):{_class:"color",alpha:e[3],red:e[0]/255,green:e[1]/255,blue:e[2]/255}}function Cp(e,t){return Z(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u,h,d,f;return J(this,(function(p){switch(p.label){case 0:r={},n=0,i=e.length,p.label=1;case 1:return n<i?(o=e[n],a=o.overrideName.split("_"),s=a[0],l=a[1],c=l.split(":"),u=c[0],h=c[1],d=(h||u).split("-"),f=o.value,"stringValue"!==d[0]?[3,2]:(d[0]="content",[3,4])):[3,6];case 2:return"fill"!==d[0]||"color"!==u?[3,4]:[4,bp({color:f},t)];case 3:f=Jf(f=p.sent()),p.label=4;case 4:(r[s]=r[s]||[]).push({key:d,value:f}),p.label=5;case 5:return n++,[3,1];case 6:return[2,r]}}))}))}function Ap(e){let t=e.length;for(;--t>=0;)e[t]=0}!function(e){e[e.UNSET=63]="UNSET",e[e.RIGHT=1]="RIGHT",e[e.WIDTH=2]="WIDTH",e[e.LEFT=4]="LEFT",e[e.BOTTOM=8]="BOTTOM",e[e.HEIGHT=16]="HEIGHT",e[e.TOP=32]="TOP"}(dp||(dp={}));Ap(new Array(576));Ap(new Array(60));Ap(new Array(512));Ap(new Array(256));Ap(new Array(29));Ap(new Array(30));var Tp=(e,t,r,n)=>{let i=65535&e,o=e>>>16&65535,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do{i=i+t[n++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16};const Op=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var Mp=(e,t,r,n)=>{const i=Op,o=n+r;e^=-1;for(let r=n;r<o;r++)e=e>>>8^i[255&(e^t[r])];return~e},kp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Lp={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Rp=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Ip={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const t in r)Rp(r,t)&&(e[t]=r[t])}}return e},flattenChunks:e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,i=e.length;t<i;t++){let i=e[t];r.set(i,n),n+=i.length}return r}};let Pp=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Pp=!1}const Fp=new Uint8Array(256);for(let e=0;e<256;e++)Fp[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Fp[254]=Fp[254]=1;var Dp={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},buf2string:(e,t)=>{const r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,i;const o=new Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){o[i++]=t;continue}let a=Fp[t];if(a>4)o[i++]=65533,n+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&n<r;)t=t<<6|63&e[n++],a--;a>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Pp)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Fp[e[r]]>t?r:t}};var Np=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Bp=16209;var Up=function(e,t){let r,n,i,o,a,s,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C;const A=e.state;r=e.next_in,_=e.input,n=r+(e.avail_in-5),i=e.next_out,C=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),s=A.dmax,l=A.wsize,c=A.whave,u=A.wnext,h=A.window,d=A.hold,f=A.bits,p=A.lencode,v=A.distcode,y=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;e:do{f<15&&(d+=_[r++]<<f,f+=8,d+=_[r++]<<f,f+=8),m=p[d&y];t:for(;;){if(b=m>>>24,d>>>=b,f-=b,b=m>>>16&255,0===b)C[i++]=65535&m;else{if(!(16&b)){if(64&b){if(32&b){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=Bp;break e}m=p[(65535&m)+(d&(1<<b)-1)];continue t}for(x=65535&m,b&=15,b&&(f<b&&(d+=_[r++]<<f,f+=8),x+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=_[r++]<<f,f+=8,d+=_[r++]<<f,f+=8),m=v[d&g];;){if(b=m>>>24,d>>>=b,f-=b,b=m>>>16&255,16&b){if(E=65535&m,b&=15,f<b&&(d+=_[r++]<<f,f+=8,f<b&&(d+=_[r++]<<f,f+=8)),E+=d&(1<<b)-1,E>s){e.msg="invalid distance too far back",A.mode=Bp;break e}if(d>>>=b,f-=b,b=i-o,E>b){if(b=E-b,b>c&&A.sane){e.msg="invalid distance too far back",A.mode=Bp;break e}if(w=0,S=h,0===u){if(w+=l-b,b<x){x-=b;do{C[i++]=h[w++]}while(--b);w=i-E,S=C}}else if(u<b){if(w+=l+u-b,b-=u,b<x){x-=b;do{C[i++]=h[w++]}while(--b);if(w=0,u<x){b=u,x-=b;do{C[i++]=h[w++]}while(--b);w=i-E,S=C}}}else if(w+=u-b,b<x){x-=b;do{C[i++]=h[w++]}while(--b);w=i-E,S=C}for(;x>2;)C[i++]=S[w++],C[i++]=S[w++],C[i++]=S[w++],x-=3;x&&(C[i++]=S[w++],x>1&&(C[i++]=S[w++]))}else{w=i-E;do{C[i++]=C[w++],C[i++]=C[w++],C[i++]=C[w++],x-=3}while(x>2);x&&(C[i++]=C[w++],x>1&&(C[i++]=C[w++]))}break}if(64&b){e.msg="invalid distance code",A.mode=Bp;break e}m=v[(65535&m)+(d&(1<<b)-1)]}}break}}while(r<n&&i<a);x=f>>3,r-=x,f-=x<<3,d&=(1<<f)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<a?a-i+257:257-(i-a),A.hold=d,A.bits=f};const zp=15,Gp=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Xp=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Hp=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jp=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Wp=(e,t,r,n,i,o,a,s)=>{const l=s.bits;let c,u,h,d,f,p,v=0,y=0,g=0,m=0,b=0,x=0,E=0,w=0,S=0,_=0,C=null;const A=new Uint16Array(16),T=new Uint16Array(16);let O,M,k,L=null;for(v=0;v<=zp;v++)A[v]=0;for(y=0;y<n;y++)A[t[r+y]]++;for(b=l,m=zp;m>=1&&0===A[m];m--);if(b>m&&(b=m),0===m)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(g=1;g<m&&0===A[g];g++);for(b<g&&(b=g),w=1,v=1;v<=zp;v++)if(w<<=1,w-=A[v],w<0)return-1;if(w>0&&(0===e||1!==m))return-1;for(T[1]=0,v=1;v<zp;v++)T[v+1]=T[v]+A[v];for(y=0;y<n;y++)0!==t[r+y]&&(a[T[t[r+y]]++]=y);if(0===e?(C=L=a,p=20):1===e?(C=Gp,L=Xp,p=257):(C=Hp,L=jp,p=0),_=0,y=0,v=g,f=o,x=b,E=0,h=-1,S=1<<b,d=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){O=v-E,a[y]+1<p?(M=0,k=a[y]):a[y]>=p?(M=L[a[y]-p],k=C[a[y]-p]):(M=96,k=0),c=1<<v-E,u=1<<x,g=u;do{u-=c,i[f+(_>>E)+u]=O<<24|M<<16|k}while(0!==u);for(c=1<<v-1;_&c;)c>>=1;if(0!==c?(_&=c-1,_+=c):_=0,y++,0==--A[v]){if(v===m)break;v=t[r+a[y]]}if(v>b&&(_&d)!==h){for(0===E&&(E=b),f+=g,x=v-E,w=1<<x;x+E<m&&(w-=A[x+E],!(w<=0));)x++,w<<=1;if(S+=1<<x,1===e&&S>852||2===e&&S>592)return 1;h=_&d,i[h]=b<<24|x<<16|f-o}}return 0!==_&&(i[f+_]=v-E<<24|64<<16),s.bits=b,0};const{Z_FINISH:Yp,Z_BLOCK:qp,Z_TREES:Vp,Z_OK:Kp,Z_STREAM_END:Zp,Z_NEED_DICT:Jp,Z_STREAM_ERROR:$p,Z_DATA_ERROR:Qp,Z_MEM_ERROR:ev,Z_BUF_ERROR:tv,Z_DEFLATED:rv}=Lp,nv=16180,iv=16190,ov=16191,av=16192,sv=16194,lv=16199,cv=16200,uv=16206,hv=16209,dv=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function fv(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pv=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<nv||t.mode>16211?1:0},vv=e=>{if(pv(e))return $p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=nv,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Kp},yv=e=>{if(pv(e))return $p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,vv(e)},gv=(e,t)=>{let r;if(pv(e))return $p;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?$p:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,yv(e))},mv=(e,t)=>{if(!e)return $p;const r=new fv;e.state=r,r.strm=e,r.window=null,r.mode=nv;const n=gv(e,t);return n!==Kp&&(e.state=null),n};let bv,xv,Ev=!0;const wv=e=>{if(Ev){bv=new Int32Array(512),xv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Wp(1,e.lens,0,288,bv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Wp(2,e.lens,0,32,xv,0,e.work,{bits:5}),Ev=!1}e.lencode=bv,e.lenbits=9,e.distcode=xv,e.distbits=5},Sv=(e,t,r,n)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var _v=(e,t)=>{let r,n,i,o,a,s,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_=0;const C=new Uint8Array(4);let A,T;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pv(e)||!e.output||!e.input&&0!==e.avail_in)return $p;r=e.state,r.mode===ov&&(r.mode=av),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,h=s,d=l,S=Kp;e:for(;;)switch(r.mode){case nv:if(0===r.wrap){r.mode=av;break}for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,C[0]=255&c,C[1]=c>>>8&255,r.check=Mp(r.check,C,2,0),c=0,u=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=hv;break}if((15&c)!==rv){e.msg="unknown compression method",r.mode=hv;break}if(c>>>=4,u-=4,w=8+(15&c),0===r.wbits&&(r.wbits=w),w>15||w>r.wbits){e.msg="invalid window size",r.mode=hv;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:ov,c=0,u=0;break;case 16181:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.flags=c,(255&r.flags)!==rv){e.msg="unknown compression method",r.mode=hv;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=hv;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Mp(r.check,C,2,0)),c=0,u=0,r.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,r.check=Mp(r.check,C,4,0)),c=0,u=0,r.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Mp(r.check,C,2,0)),c=0,u=0,r.mode=16184;case 16184:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Mp(r.check,C,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>s&&(f=s),f&&(r.head&&(w=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+f),w)),512&r.flags&&4&r.wrap&&(r.check=Mp(r.check,n,f,o)),s-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break e;f=0;do{w=n[o+f++],r.head&&w&&r.length<65536&&(r.head.name+=String.fromCharCode(w))}while(w&&f<s);if(512&r.flags&&4&r.wrap&&(r.check=Mp(r.check,n,f,o)),s-=f,o+=f,w)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break e;f=0;do{w=n[o+f++],r.head&&w&&r.length<65536&&(r.head.comment+=String.fromCharCode(w))}while(w&&f<s);if(512&r.flags&&4&r.wrap&&(r.check=Mp(r.check,n,f,o)),s-=f,o+=f,w)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=hv;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=ov;break;case 16189:for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}e.adler=r.check=dv(c),c=0,u=0,r.mode=iv;case iv:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,Jp;e.adler=r.check=1,r.mode=ov;case ov:if(t===qp||t===Vp)break e;case av:if(r.last){c>>>=7&u,u-=7&u,r.mode=uv;break}for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}switch(r.last=1&c,c>>>=1,u-=1,3&c){case 0:r.mode=16193;break;case 1:if(wv(r),r.mode=lv,t===Vp){c>>>=2,u-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=hv}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=hv;break}if(r.length=65535&c,c=0,u=0,r.mode=sv,t===Vp)break e;case sv:r.mode=16195;case 16195:if(f=r.length,f){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;i.set(n.subarray(o,o+f),a),s-=f,o+=f,l-=f,a+=f,r.length-=f;break}r.mode=ov;break;case 16196:for(;u<14;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=hv;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.lens[O[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},S=Wp(0,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,S){e.msg="invalid code lengths set",r.mode=hv;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;_=r.lencode[c&(1<<r.lenbits)-1],y=_>>>24,g=_>>>16&255,m=65535&_,!(y<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(m<16)c>>>=y,u-=y,r.lens[r.have++]=m;else{if(16===m){for(T=y+2;u<T;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(c>>>=y,u-=y,0===r.have){e.msg="invalid bit length repeat",r.mode=hv;break}w=r.lens[r.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===m){for(T=y+3;u<T;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=y,u-=y,w=0,f=3+(7&c),c>>>=3,u-=3}else{for(T=y+7;u<T;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=y,u-=y,w=0,f=11+(127&c),c>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=hv;break}for(;f--;)r.lens[r.have++]=w}}if(r.mode===hv)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=hv;break}if(r.lenbits=9,A={bits:r.lenbits},S=Wp(1,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,S){e.msg="invalid literal/lengths set",r.mode=hv;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},S=Wp(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,S){e.msg="invalid distances set",r.mode=hv;break}if(r.mode=lv,t===Vp)break e;case lv:r.mode=cv;case cv:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,Up(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===ov&&(r.back=-1);break}for(r.back=0;_=r.lencode[c&(1<<r.lenbits)-1],y=_>>>24,g=_>>>16&255,m=65535&_,!(y<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(g&&!(240&g)){for(b=y,x=g,E=m;_=r.lencode[E+((c&(1<<b+x)-1)>>b)],y=_>>>24,g=_>>>16&255,m=65535&_,!(b+y<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=y,u-=y,r.back+=y,r.length=m,0===g){r.mode=16205;break}if(32&g){r.back=-1,r.mode=ov;break}if(64&g){e.msg="invalid literal/length code",r.mode=hv;break}r.extra=15&g,r.mode=16201;case 16201:if(r.extra){for(T=r.extra;u<T;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;_=r.distcode[c&(1<<r.distbits)-1],y=_>>>24,g=_>>>16&255,m=65535&_,!(y<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(!(240&g)){for(b=y,x=g,E=m;_=r.distcode[E+((c&(1<<b+x)-1)>>b)],y=_>>>24,g=_>>>16&255,m=65535&_,!(b+y<=u);){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=y,u-=y,r.back+=y,64&g){e.msg="invalid distance code",r.mode=hv;break}r.offset=m,r.extra=15&g,r.mode=16203;case 16203:if(r.extra){for(T=r.extra;u<T;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=hv;break}r.mode=16204;case 16204:if(0===l)break e;if(f=d-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=hv;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),v=r.window}else v=i,p=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{i[a++]=v[p++]}while(--f);0===r.length&&(r.mode=cv);break;case 16205:if(0===l)break e;i[a++]=r.length,l--,r.mode=cv;break;case uv:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[o++]<<u,u+=8}if(d-=l,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?Mp(r.check,i,d,a-d):Tp(r.check,i,d,a-d)),d=l,4&r.wrap&&(r.flags?c:dv(c))!==r.check){e.msg="incorrect data check",r.mode=hv;break}c=0,u=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[o++]<<u,u+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=hv;break}c=0,u=0}r.mode=16208;case 16208:S=Zp;break e;case hv:S=Qp;break e;case 16210:return ev;default:return $p}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<hv&&(r.mode<uv||t!==Yp))&&Sv(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?Mp(r.check,i,d,e.next_out-d):Tp(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===ov?128:0)+(r.mode===lv||r.mode===sv?256:0),(0===h&&0===d||t===Yp)&&S===Kp&&(S=tv),S},Cv=e=>{if(pv(e))return $p;let t=e.state;return t.window&&(t.window=null),e.state=null,Kp},Av=(e,t)=>{if(pv(e))return $p;const r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,Kp):$p},Tv=(e,t)=>{const r=t.length;let n,i,o;return pv(e)?$p:(n=e.state,0!==n.wrap&&n.mode!==iv?$p:n.mode===iv&&(i=1,i=Tp(i,t,r,0),i!==n.check)?Qp:(o=Sv(e,t,r,r),o?(n.mode=16210,ev):(n.havedict=1,Kp)))},Ov={inflateReset:yv,inflateReset2:gv,inflateResetKeep:vv,inflateInit:e=>mv(e,15),inflateInit2:mv,inflate:_v,inflateEnd:Cv,inflateGetHeader:Av,inflateSetDictionary:Tv,inflateInfo:"pako inflate (from Nodeca project)"};var Mv=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const kv=Object.prototype.toString,{Z_NO_FLUSH:Lv,Z_FINISH:Rv,Z_OK:Iv,Z_STREAM_END:Pv,Z_NEED_DICT:Fv,Z_STREAM_ERROR:Dv,Z_DATA_ERROR:Nv,Z_MEM_ERROR:Bv}=Lp;function Uv(e){this.options=Ip.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Np,this.strm.avail_out=0;let r=Ov.inflateInit2(this.strm,t.windowBits);if(r!==Iv)throw new Error(kp[r]);if(this.header=new Mv,Ov.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Dp.string2buf(t.dictionary):"[object ArrayBuffer]"===kv.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Ov.inflateSetDictionary(this.strm,t.dictionary),r!==Iv)))throw new Error(kp[r])}Uv.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Rv:Lv,"[object ArrayBuffer]"===kv.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Ov.inflate(r,a),o===Fv&&i&&(o=Ov.inflateSetDictionary(r,i),o===Iv?o=Ov.inflate(r,a):o===Nv&&(o=Fv));r.avail_in>0&&o===Pv&&r.state.wrap>0&&0!==e[r.next_in];)Ov.inflateReset(r),o=Ov.inflate(r,a);switch(o){case Dv:case Nv:case Fv:case Bv:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(0===r.avail_out||o===Pv))if("string"===this.options.to){let e=Dp.utf8border(r.output,r.next_out),t=r.next_out-e,i=Dp.buf2string(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==Iv||0!==s){if(o===Pv)return o=Ov.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Uv.prototype.onData=function(e){this.chunks.push(e)},Uv.prototype.onEnd=function(e){e===Iv&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ip.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var zv={inflate:function(e,t){const r=new Uv(t);if(r.push(e),r.err)throw r.msg||kp[r.err];return r.result}};const{inflate:Gv}=zv;var Xv=Gv,Hv={},jv={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"};Object.keys(jv).forEach((function(e){return Hv[jv[e]]=e}));var Wv,Yv,qv,Vv,Kv,Zv=["none","red","orange","yellow","green","blue","violet","gray"],Jv=["LMsk","Lr16","Lr32","Layr","Mt16","Mt32","Mtrn","Alph","FMsk","lnk2","FEid","FXid","PxSD","cinf"];function $v(e,t,r){var n=function(e){var t={};return Object.keys(e).forEach((function(r){return t[e[r]]=r})),t}(r);return{decode:function(e){var r=e.split(".")[1];if(r&&!n[r])throw new Error("Unrecognized value for enum: '".concat(e,"'"));return n[r]||t},encode:function(n){if(n&&!r[n])throw new Error("Invalid value for enum: '".concat(n,"'"));return"".concat(e,".").concat(r[n]||r[t])}}}function Qv(e,t){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return t?3:e+1;case-1:return t?4:3;default:return e+1}}function ey(e,t,r){return e<t?t:e>r?r:e}function ty(e){for(var t=e.data,r=t instanceof Float32Array?1:t instanceof Uint16Array?65535:255,n=0,i=0|t.length;n<i;n=n+4|0)t[n+0]=0,t[n+1]=0,t[n+2]=0,t[n+3]=r}function ry(e){var t,r=ny(e.width,e.height);if(e.data instanceof Uint8ClampedArray)t=e;else{t=ay(e.width,e.height);var n=e.data,i=t.data;if(n instanceof Float32Array)for(var o=0,a=n.length;o<a;o+=4)i[o+0]=Math.round(255*Math.pow(n[o+0],1/2.2)),i[o+1]=Math.round(255*Math.pow(n[o+1],1/2.2)),i[o+2]=Math.round(255*Math.pow(n[o+2],1/2.2)),i[o+3]=Math.round(255*n[o+3]);else{var s=n instanceof Uint16Array?8:0;for(o=0,a=n.length;o<a;o++)i[o]=n[o]>>>s}}return r.getContext("2d").putImageData(t,0,0),r}!function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"}(Wv||(Wv={})),function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"}(Yv||(Yv={})),function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"}(qv||(qv={})),function(e){e[e.Color0=0]="Color0",e[e.Color1=1]="Color1",e[e.Color2=2]="Color2",e[e.Color3=3]="Color3",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"}(Vv||(Vv={})),function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"}(Kv||(Kv={}));var ny=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")},iy=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvasFromData method")},oy=void 0,ay=function(e,t){return oy||(oy=ny(1,1)),oy.getContext("2d").createImageData(e,t)};function sy(e){return 4294967168&e?4294965248&e?4294901760&e?4:3:2:1}function ly(e,t,r){var n=sy(r);switch(n){case 1:e[t]=r;break;case 2:e[t]=r>>6&31|192,e[t+1]=63&r|128;break;case 3:e[t]=r>>12&15|224,e[t+1]=r>>6&63|128,e[t+2]=63&r|128;break;default:e[t]=r>>18&7|240,e[t+1]=r>>12&63|128,e[t+2]=r>>6&63|128,e[t+3]=63&r|128}return n}function cy(e){if(e.length>1e3&&"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);var t=new Uint8Array(function(e){for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>=55296&&n<=56319){if(r+1<e.length){var i=e.charCodeAt(r+1);56320==(64512&i)&&(r++,t+=sy(((1023&n)<<10)+(1023&i)+65536))}}else t+=sy(n)}return t}(e));return function(e,t,r){for(var n=0;n<r.length;n++){var i=r.charCodeAt(n);if(i>=55296&&i<=56319){if(n+1<r.length){var o=r.charCodeAt(n+1);56320==(64512&o)&&(n++,t+=ly(e,t,((1023&i)<<10)+(1023&o)+65536))}}else t+=ly(e,t,i)}}(t,0,e),t}function uy(e,t){if(t>=e.length)throw Error("Invalid byte index");var r=e[t];if(128==(192&r))return 63&r;throw Error("Invalid continuation byte")}function hy(e){if(e.byteLength>1e3&&"undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t=[],r=0;r<e.length;){var n=e[r++],i=void 0;if(128&n)if(192==(224&n)){if((i=(31&n)<<6|uy(e,r++))<128)throw Error("Invalid continuation byte")}else if(224==(240&n)){if((i=(15&n)<<12|uy(e,r++)<<6|uy(e,r++))<2048)throw Error("Invalid continuation byte");if(i>=55296&&i<=57343)throw Error("Lone surrogate U+".concat(i.toString(16).toUpperCase()," is not a scalar value"))}else{if(240!=(248&n))throw Error("Invalid UTF-8 detected");if((i=(15&n)<<18|uy(e,r++)<<12|uy(e,r++)<<6|uy(e,r++))<65536||i>1114111)throw Error("Invalid continuation byte")}else i=n;i>65535&&(i-=65536,t.push(String.fromCharCode(i>>>10&1023|55296)),i=56320|1023&i),t.push(String.fromCharCode(i))}return t.join("")}"undefined"!=typeof document&&(ny=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},iy=function(e){var t=new Image;t.src="data:image/jpeg;base64,"+Ee(e);var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0),r});var dy=function(){return dy=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},dy.apply(this,arguments)};var fy,py,vy={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},yy=(fy=vy,py={},Object.keys(fy).forEach((function(e){return py[fy[e]]=e})),py);function gy(e,t){return{name:e,classID:t}}for(var my=gy("","null"),by={strokeStyleContent:gy("","solidColorLayer"),printProofSetup:gy("Proof Setup","proofSetup"),Grad:gy("Gradient","Grdn"),Trnf:gy("Transform","Trnf"),patternFill:gy("","patternFill"),ebbl:gy("","ebbl"),SoFi:gy("","SoFi"),GrFl:gy("","GrFl"),sdwC:gy("","RGBC"),hglC:gy("","RGBC"),"Clr ":gy("","RGBC"),tintColor:gy("","RGBC"),Ofst:gy("","Pnt "),ChFX:gy("","ChFX"),MpgS:gy("","ShpC"),DrSh:gy("","DrSh"),IrSh:gy("","IrSh"),OrGl:gy("","OrGl"),IrGl:gy("","IrGl"),TrnS:gy("","ShpC"),Ptrn:gy("","Ptrn"),FrFX:gy("","FrFX"),phase:gy("","Pnt "),frameStep:my,duration:my,workInTime:my,workOutTime:my,audioClipGroupList:my,bounds:gy("","Rctn"),customEnvelopeWarp:gy("","customEnvelopeWarp"),warp:gy("","warp"),"Sz  ":gy("","Pnt "),origin:gy("","Pnt "),autoExpandOffset:gy("","Pnt "),keyOriginShapeBBox:gy("","unitRect"),Vrsn:my,psVersion:my,docDefaultNewArtboardBackgroundColor:gy("","RGBC"),artboardRect:gy("","classFloatRect"),keyOriginRRectRadii:gy("","radii"),keyOriginBoxCorners:my,rectangleCornerA:gy("","Pnt "),rectangleCornerB:gy("","Pnt "),rectangleCornerC:gy("","Pnt "),rectangleCornerD:gy("","Pnt "),compInfo:my,quiltWarp:gy("","quiltWarp"),generatorSettings:my,crema:my,FrIn:my,blendOptions:my,FXRf:my,Lefx:my,time:my,animKey:my,timeScope:my,inTime:my,outTime:my,sheetStyle:my,translation:my,Skew:my,boundingBox:gy("","boundingBox"),"Lnk ":gy("","ExternalFileLink"),frameReader:gy("","FrameReader"),effectParams:gy("","motionTrackEffectParams"),Impr:gy("None","none"),Anch:gy("","Pnt "),"Fwd ":gy("","Pnt "),"Bwd ":gy("","Pnt "),FlrC:gy("","Pnt "),meshBoundaryPath:gy("","pathClass"),filterFX:gy("","filterFXStyle"),Fltr:gy("","rigidTransform"),FrgC:gy("","RGBC"),BckC:gy("","RGBC"),sdwM:gy("Parameters","adaptCorrectTones"),hglM:gy("Parameters","adaptCorrectTones"),customShape:gy("","customShape"),origFXRefPoint:my,FXRefPoint:my,ClMg:gy("","ClMg")},xy={"Crv ":gy("","CrPt"),Clrs:gy("","Clrt"),Trns:gy("","TrnS"),keyDescriptorList:my,solidFillMulti:gy("","SoFi"),gradientFillMulti:gy("","GrFl"),dropShadowMulti:gy("","DrSh"),innerShadowMulti:gy("","IrSh"),frameFXMulti:gy("","FrFX"),FrIn:my,FSts:my,LaSt:my,sheetTimelineOptions:my,trackList:gy("","animationTrack"),globalTrackList:gy("","animationTrack"),keyList:my,audioClipGroupList:my,audioClipList:my,countObjectList:gy("","countObject"),countGroupList:gy("","countGroup"),slices:gy("","slice"),"Pts ":gy("","Pthp"),SbpL:gy("","SbpL"),pathComponents:gy("","PaCm"),filterFXList:gy("","filterFX"),puppetShapeList:gy("","puppetShape"),channelDenoise:gy("","channelDenoiseParams"),ShrP:gy("","Pnt "),layerSettings:my,list:my,Adjs:gy("","CrvA")},Ey={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName","placed","description","reason","artboardPresetName","json","clipID","relPath","fullPath","mediaDescriptor","Msge","altTag","url","cellText","preset","KnNm","FPth","comment","originalPath"],tdta:["EngineData","LUT3DFileData","indexArray","originalVertexArray","deformedVertexArray","LqMe"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Cnt ","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","comp","compID","originalCompID","curvesPresetKind","mixerPresetKind","uOrder","vOrder","PgNm","totalPages","Crop","numerator","denominator","frameCount","Annt","keyOriginType","unitValueQuadVersion","keyOriginIndex","major","minor","fix","docDefaultNewArtboardBackgroundType","artboardBackgroundType","numModifyingFX","deformNumRows","deformNumCols","FrID","FrDl","FsID","LCnt","AFrm","AFSt","numBefore","numAfter","Spcn","minOpacity","maxOpacity","BlnM","sheetID","gblA","globalAltitude","descVersion","frameReaderType","LyrI","zoomOrigin","fontSize","Rds ","sliceID","topOutset","leftOutset","bottomOutset","rightOutset","filterID","meshQuality","meshExpansion","meshRigidity","VrsM","VrsN","NmbG","WLMn","WLMx","AmMn","AmMx","SclH","SclV","Lvl ","TlNm","TlOf","FlRs","Thsh","ShrS","ShrE","FlRs","Vrnc","Strg","ExtS","ExtD","HrzS","VrtS","NmbR","EdgF","Ang1","Ang2","Ang3","Ang4","lastAppliedComp","capturedInfo"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","BlrQ","bvlT","bvlS","bvlD","Md  ","glwS","GrdF","GlwT","RplS","BlrM","SmBM","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder","enableCompCore","enableCompCoreGPU","compCoreSupport","compCoreGPUSupport","Engn","enableCompCoreThreads","gs99","FrDs","trackID","animInterpStyle","horzAlign","vertAlign","bgColorType","shapeOperation","UndA","Wvtp","Drct","WndM","Edg ","FlCl","IntE","IntC","Cnvr","Fl  ","Dstr","MztT","Lns ","ExtT","DspM","ExtR","ZZTy","SphM","SmBQ","placedLayerOCIOConversion","gradientsInterpolationMethod"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","uglg","antialiasGloss","useShape","Vsbl","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint","keyShapeInvalidated","autoExpandEnabled","autoNestEnabled","autoPositionEnabled","shrinkwrapOnSaveEnabled","present","showInDialog","overprint","sheetDisclosed","lightsDisclosed","meshesDisclosed","materialsDisclosed","hasMotion","muted","Effc","selected","autoScope","fillCanvas","cellTextIsHTML","Smoo","Clsp","validAtPosition","rigidType","hasoptions","filterMaskEnable","filterMaskLinked","filterMaskExtendWithWhite","removeJPEGArtifact","Mnch","ExtF","ExtM","moreAccurate","GpuY","LIWy","Cnty"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","Wdth","Hght","strokeStyleMiterLimit","strokeStyleResolution","layerTime","keyOriginResolution","xx","xy","yx","yy","tx","ty","FrGA","frameRate","audioLevel","rotation","X   ","Y   ","redFloat","greenFloat","blueFloat","imageResolution","PuX0","PuX1","PuX2","PuX3","PuY0","PuY1","PuY2","PuY3"],UntF:["sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","H   ","Top ","Left","Btom","Rght","Rslt","topRight","topLeft","bottomLeft","bottomRight","ClNs","Shrp"],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","slices","LaSt","Trnf","nonAffineTransform","keyDescriptorList","guideIndeces","gradientFillMulti","solidFillMulti","frameFXMulti","innerShadowMulti","dropShadowMulti","FrIn","FSts","FsFr","sheetTimelineOptions","audioClipList","trackList","globalTrackList","keyList","audioClipList","warpValues","selectedPin","Pts ","SbpL","pathComponents","pinOffsets","posFinalPins","pinVertexIndices","PinP","PnRt","PnOv","PnDp","filterFXList","puppetShapeList","ShrP","channelDenoise","Mtrx","layerSettings","list","compList","Adjs"],ObAr:["meshPoints","quiltSliceX","quiltSliceY"],"obj ":["null","Chnl"],"Pth ":["DspF"]},wy=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],Sy={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF",Trnf:"doub",nonAffineTransform:"doub",keyDescriptorList:"Objc",gradientFillMulti:"Objc",solidFillMulti:"Objc",frameFXMulti:"Objc",innerShadowMulti:"Objc",dropShadowMulti:"Objc",LaSt:"Objc",FrIn:"Objc",FSts:"Objc",FsFr:"long",blendOptions:"Objc",sheetTimelineOptions:"Objc",keyList:"Objc",warpValues:"doub",selectedPin:"long","Pts ":"Objc",SbpL:"Objc",pathComponents:"Objc",pinOffsets:"doub",posFinalPins:"doub",pinVertexIndices:"long",PinP:"doub",PnRt:"long",PnOv:"bool",PnDp:"doub",filterFXList:"Objc",puppetShapeList:"Objc",ShrP:"Objc",channelDenoise:"Objc",Mtrx:"long",compList:"long",Chnl:"enum"},_y={},Cy=0,Ay=Object.keys(Ey);Cy<Ay.length;Cy++)for(var Ty=Ay[Cy],Oy=0,My=Ey[Ty];Oy<My.length;Oy++){var ky=My[Oy];_y[ky]=Ty}for(var Ly=0,Ry=Object.keys(by);Ly<Ry.length;Ly++){ky=Ry[Ly];_y[ky]||(_y[ky]="Objc")}for(var Iy=0,Py=Object.keys(xy);Iy<Py.length;Iy++){ky=Py[Iy];Sy[ky]="Objc"}function Fy(e,t,r,n){return"presetKind"===e?"string"==typeof t?"enum":"long":"null"===e&&"slices"===r?"TEXT":"groupID"===e?"slices"===r?"long":"TEXT":"Sz  "===e?"Wdth"in t?"Objc":"units"in t?"UntF":"doub":"Type"===e?"string"==typeof t?"enum":"long":"AntA"===e?"string"==typeof t?"enum":"bool":"Hrzn"!==e&&"Vrtc"!==e||"keyType.Pstn"!==n.Type&&"Ofst"!==n._classID?"Hrzn"===e||"Vrtc"===e||"Top "===e||"Left"===e||"Btom"===e||"Rght"===e?"slices"===r?"long":"number"==typeof t?"doub":"UntF":"Vrsn"===e?"number"==typeof t?"long":"Objc":"Rd  "===e||"Grn "===e||"Bl  "===e?"artd"===r?"long":"doub":"Trnf"===e?Array.isArray(t)?"VlLs":"Objc":_y[e]:"long"}function Dy(e){return gb(e,ib(e)||4)}function Ny(e,t){if(4===t.length&&"warp"!==t&&"time"!==t&&"hold"!==t&&"list"!==t)wE(e,0),LE(e,t);else{wE(e,t.length);for(var r=0;r<t.length;r++)mE(e,t.charCodeAt(r))}}function By(e,t){for(var r=Hy(e),n=t?{_name:r.name,_classID:r.classID}:{},i=ab(e),o=0;o<i;o++){var a=Dy(e),s=zy(e,db(e),t);n[a]=s}return n}function Uy(e,t,r,n,i){PE(e,t),Ny(e,r);var o=Object.keys(n),a=o.length;"_name"in n&&a--,"_classID"in n&&a--,_E(e,a);for(var s=0,l=o;s<l.length;s++){var c=l[s];if("_name"!==c&&"_classID"!==c){var u=Fy(c,n[c],i,n),h=by[c];"bounds"===c&&"text"===i?h=gy("","bounds"):"origin"===c?u="slices"===i?"enum":"Objc":"Cyn "!==c&&"Mgnt"!==c&&"Ylw "!==c&&"Blck"!==c||"CMYC"!==n._classID?/^PN[a-z][a-z]$/.test(c)?u="TEXT":/^PT[a-z][a-z]$/.test(c)?u="long":/^PF[a-z][a-z]$/.test(c)?u="doub":"Rds "!==c&&"Thsh"!==c||"number"!=typeof n[c]||"SmrB"!==n._classID?"ClSz"===c||"Rds "===c||"Amnt"===c?u="number"==typeof n[c]?"long":"UntF":"sdwM"!==c&&"hglM"!==c||"string"!=typeof n[c]?"blur"===c&&"string"==typeof n[c]?u="enum":"Hght"===c&&"number"==typeof n[c]&&"Embs"===n._classID?u="long":"Angl"!==c||"number"!=typeof n[c]||"Embs"!==n._classID&&"smartSharpen"!==n._classID&&"Twrl"!==n._classID&&"MtnB"!==n._classID?"Angl"===c&&"number"==typeof n[c]?u="doub":"bounds"===c&&"slices"===i?(u="Objc",h=gy("","Rct1")):"Scl "===c?"object"==typeof n[c]&&"Hrzn"in n[c]?(u="Objc",h=my):u="number"==typeof n[c]?"long":"UntF":"audioClipGroupList"===c&&1===o.length?u="VlLs":"Strt"!==c&&"Brgh"!==c||!("H   "in n)?"Wdth"===c&&"object"==typeof n[c]?u="UntF":"Ofst"===c&&"number"==typeof n[c]?u="long":"Strt"===c&&"object"==typeof n[c]?(u="Objc",h=my):-1!==wy.indexOf(c)?u="RGBC"===r&&"artd"!==i?"doub":"long":"profile"===c?u="printOutput"===r?"TEXT":"tdta":"strokeStyleContent"===c?n[c]["Clr "]?h=gy("","solidColorLayer"):n[c].Grad?h=gy("","gradientLayer"):n[c].Ptrn&&(h=gy("","patternLayer")):"bounds"===c&&"quiltWarp"===i&&(h=gy("","classFloatRect")):u="doub":u="long":u="enum":u="doub":u="doub",h&&"RGBC"===h.classID&&"H   "in n[c]&&(h={classID:"HSBC",name:""}),Ny(e,c),LE(e,u||"long"),Xy(e,u||"long",n[c],c,h,i)}}}function zy(e,t,r){switch(t){case"obj ":return function(e){for(var t=ib(e),r=[],n=0;n<t;n++){var i=db(e);switch(i){case"prop":Hy(e);var o=Dy(e);r.push(o);break;case"Clss":r.push(Hy(e));break;case"Enmr":Hy(e);var a=Dy(e),s=Dy(e);r.push("".concat(a,".").concat(s));break;case"rele":Hy(e),r.push(ab(e));break;case"Idnt":case"indx":r.push(ib(e));break;case"name":Hy(e),r.push(vb(e));break;default:throw new Error("Invalid descriptor reference type: ".concat(i))}}return r}(e);case"Objc":case"GlbO":return By(e,r);case"VlLs":for(var n=ib(e),i=[],o=0;o<n;o++){var a=db(e);i.push(zy(e,a,r))}return i;case"doub":return lb(e);case"UntF":var s=db(e),l=lb(e);if(!vy[s])throw new Error("Invalid units: ".concat(s));return{units:vy[s],value:l};case"UnFl":s=db(e),l=sb(e);if(!vy[s])throw new Error("Invalid units: ".concat(s));return{units:vy[s],value:l};case"TEXT":return vb(e);case"enum":var c=Dy(e);l=Dy(e);return"".concat(c,".").concat(l);case"long":return ib(e);case"comp":return{low:ab(e),high:ab(e)};case"bool":return!!Qm(e);case"type":case"GlbC":return Hy(e);case"alis":return gb(e,ib(e));case"tdta":return hb(e,ib(e));case"ObAr":ib(e),vb(e),Dy(e);var u=ib(e);for(i=[],o=0;o<u;o++){var h=Dy(e);db(e),db(e);for(var d=ib(e),f=[],p=0;p<d;p++)f.push(lb(e));i.push({type:h,values:f})}return i;case"Pth ":ib(e);var v=db(e);ob(e);var y=function(e,t){var r="";for(;t--;){var n=nb(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}(e,ob(e));return{sig:v,path:y};default:throw new Error("Invalid TySh descriptor OSType: ".concat(t," at ").concat(e.offset.toString(16)))}}var Gy={meshPoints:"rationalPoint",quiltSliceX:"UntF",quiltSliceY:"UntF"};function Xy(e,t,r,n,i,o){switch(t){case"obj ":!function(e,t,r){wE(e,r.length);for(var n=0;n<r.length;n++){var i=r[n],o="unknown";switch("string"==typeof i&&(o=/^[a-z ]+\.[a-z ]+$/i.test(i)?"Enmr":"name"),LE(e,o),o){case"Enmr":var a=i.split("."),s=a[0],l=a[1];jy(e,"\0",s),Ny(e,s),Ny(e,l);break;case"name":jy(e,"\0","Lyr "),IE(e,i+"\0");break;default:throw new Error("Invalid descriptor reference type: ".concat(o))}}}(e,0,r);break;case"Objc":case"GlbO":if("object"!=typeof r)throw new Error("Invalid struct value: ".concat(JSON.stringify(r),", key: ").concat(n));if(!i)throw new Error("Missing ext type for: '".concat(n,"' (").concat(JSON.stringify(r),")"));Uy(e,r._name||i.name,r._classID||i.classID,r,o);break;case"VlLs":if(!Array.isArray(r))throw new Error("Invalid list value: ".concat(JSON.stringify(r),", key: ").concat(n));wE(e,r.length);for(var a=0;a<r.length;a++){var s=Sy[n];LE(e,s||"long"),Xy(e,s||"long",r[a],"".concat(n,"[]"),xy[n],o)}break;case"doub":if("number"!=typeof r)throw new Error("Invalid number value: ".concat(JSON.stringify(r),", key: ").concat(n));AE(e,r);break;case"UntF":if(!yy[r.units])throw new Error("Invalid units: ".concat(r.units," in ").concat(n));LE(e,yy[r.units]),AE(e,r.value);break;case"UnFl":if(!yy[r.units])throw new Error("Invalid units: ".concat(r.units," in ").concat(n));LE(e,yy[r.units]),CE(e,r.value);break;case"TEXT":PE(e,r);break;case"enum":if("string"!=typeof r)throw new Error("Invalid enum value: ".concat(JSON.stringify(r),", key: ").concat(n));var l=r.split("."),c=l[0],u=l[1];Ny(e,c),Ny(e,u);break;case"long":if("number"!=typeof r)throw new Error("Invalid integer value: ".concat(JSON.stringify(r),", key: ").concat(n));wE(e,r);break;case"bool":if("boolean"!=typeof r)throw new Error("Invalid boolean value: ".concat(JSON.stringify(r),", key: ").concat(n));mE(e,r?1:0);break;case"tdta":wE(e,r.byteLength),ME(e,r);break;case"ObAr":wE(e,16),PE(e,"");var h=Gy[n];if(!h)throw new Error("Not implemented ObArType for: ".concat(n));Ny(e,h),wE(e,r.length);for(a=0;a<r.length;a++){Ny(e,r[a].type),LE(e,"UnFl"),LE(e,"#Pxl"),wE(e,r[a].values.length);for(var d=0;d<r[a].values.length;d++)AE(e,r[a].values[d])}break;case"Pth ":var f=12+2*r.path.length;wE(e,f),LE(e,r.sig),SE(e,f),SE(e,r.path.length),function(e,t){for(var r=0;r<t.length;r++)EE(e,t.charCodeAt(r))}(e,r.path);break;default:throw new Error("Not implemented descriptor OSType: ".concat(t))}}function Hy(e){return{name:vb(e),classID:Dy(e)}}function jy(e,t,r){IE(e,t),Ny(e,r)}function Wy(e,t){void 0===t&&(t=!1);var r=ab(e);if(16!==r)throw new Error("Invalid descriptor version: ".concat(r));return By(e,t)}function Yy(e,t,r,n,i){void 0===i&&(i=""),_E(e,16),Uy(e,t,r,n,i)}function qy(e){return{x:e.Hrzn,y:e.Vrtc}}function Vy(e){return{Hrzn:e.x,Vrtc:e.y}}function Ky(e){return{top:xg(e["Top "]),left:xg(e.Left),right:xg(e.Rght),bottom:xg(e.Btom)}}function Zy(e){var t;return(t={Left:Cg(e.left,"bounds.left")})["Top "]=Cg(e.top,"bounds.top"),t.Rght=Cg(e.right,"bounds.right"),t.Btom=Cg(e.bottom,"bounds.bottom"),t}function Jy(e){var t={enabled:!!e.enab,position:Xg.decode(e.Styl),fillType:Hg.decode(e.PntT),blendMode:Lg.decode(e["Md  "]),opacity:mg(e.Opct),size:xg(e["Sz  "])};return void 0!==e.present&&(t.present=e.present),void 0!==e.showInDialog&&(t.showInDialog=e.showInDialog),void 0!==e.overprint&&(t.overprint=e.overprint),e["Clr "]&&(t.color=vg(e["Clr "])),e.Grad&&(t.gradient=cg(e)),e.Ptrn&&(t.pattern=ug(e)),t}function $y(e){var t={};return t.enab=!!e.enabled,void 0!==e.present&&(t.present=!!e.present),void 0!==e.showInDialog&&(t.showInDialog=!!e.showInDialog),t.Styl=Xg.encode(e.position),t.PntT=Hg.encode(e.fillType),t["Md  "]=Lg.encode(e.blendMode),t.Opct=Sg(e.opacity),t["Sz  "]=Cg(e.size,"size"),e.color&&(t["Clr "]=yg(e.color)),e.gradient&&(t=dy(dy({},t),dg(e.gradient))),e.pattern&&(t=dy(dy({},t),fg(e.pattern))),void 0!==e.overprint&&(t.overprint=!!e.overprint),t}function Qy(e,t,r){for(var n,i,o,a=r?{"Scl ":_g(null!==(n=e.scale)&&void 0!==n?n:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":_g(null!==(i=e.scale)&&void 0!==i?i:1)},s=0,l=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"];s<l.length;s++){if(e[f=l[s]]&&!Array.isArray(e[f]))throw new Error("".concat(f," should be an array"))}var c=function(e){return!!e&&e.length>1&&r},u=function(e){return!!e&&e.length>=1&&(!r||1===e.length)};if(u(e.dropShadow)&&(a.DrSh=ag(e.dropShadow[0],"dropShadow",t)),c(e.dropShadow)&&(a.dropShadowMulti=e.dropShadow.map((function(e){return ag(e,"dropShadow",t)}))),u(e.innerShadow)&&(a.IrSh=ag(e.innerShadow[0],"innerShadow",t)),c(e.innerShadow)&&(a.innerShadowMulti=e.innerShadow.map((function(e){return ag(e,"innerShadow",t)}))),e.outerGlow&&(a.OrGl=ag(e.outerGlow,"outerGlow",t)),c(e.solidFill)&&(a.solidFillMulti=e.solidFill.map((function(e){return ag(e,"solidFill",t)}))),c(e.gradientOverlay)&&(a.gradientFillMulti=e.gradientOverlay.map((function(e){return ag(e,"gradientOverlay",t)}))),c(e.stroke)&&(a.frameFXMulti=e.stroke.map((function(e){return $y(e)}))),e.innerGlow&&(a.IrGl=ag(e.innerGlow,"innerGlow",t)),e.bevel&&(a.ebbl=ag(e.bevel,"bevel",t)),u(e.solidFill)&&(a.SoFi=ag(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(a.patternFill=ag(e.patternOverlay,"patternOverlay",t)),u(e.gradientOverlay)&&(a.GrFl=ag(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(a.ChFX=ag(e.satin,"satin",t)),u(e.stroke)&&(a.FrFX=$y(null===(o=e.stroke)||void 0===o?void 0:o[0])),r){a.numModifyingFX=0;for(var h=0,d=Object.keys(e);h<d.length;h++){var f,p=e[f=d[h]];if(Array.isArray(p))for(var v=0,y=p;v<y.length;v++){y[v].enabled&&a.numModifyingFX++}else p.enabled&&a.numModifyingFX++}}return a}function eg(e,t){var r={};return e.masterFXSwitch||(r.disabled=!0),e["Scl "]&&(r.scale=mg(e["Scl "])),e.DrSh&&(r.dropShadow=[og(e.DrSh,t)]),e.dropShadowMulti&&(r.dropShadow=e.dropShadowMulti.map((function(e){return og(e,t)}))),e.IrSh&&(r.innerShadow=[og(e.IrSh,t)]),e.innerShadowMulti&&(r.innerShadow=e.innerShadowMulti.map((function(e){return og(e,t)}))),e.OrGl&&(r.outerGlow=og(e.OrGl,t)),e.IrGl&&(r.innerGlow=og(e.IrGl,t)),e.ebbl&&(r.bevel=og(e.ebbl,t)),e.SoFi&&(r.solidFill=[og(e.SoFi,t)]),e.solidFillMulti&&(r.solidFill=e.solidFillMulti.map((function(e){return og(e,t)}))),e.patternFill&&(r.patternOverlay=og(e.patternFill,t)),e.GrFl&&(r.gradientOverlay=[og(e.GrFl,t)]),e.gradientFillMulti&&(r.gradientOverlay=e.gradientFillMulti.map((function(e){return og(e,t)}))),e.ChFX&&(r.satin=og(e.ChFX,t)),e.FrFX&&(r.stroke=[Jy(e.FrFX)]),e.frameFXMulti&&(r.stroke=e.frameFXMulti.map((function(e){return Jy(e)}))),r}function tg(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.time,a=o.denominator,s=o.numerator,l=i.selected,c=i.animKey,u={numerator:s,denominator:a},h=Bg.decode(i.animInterpStyle);switch(c.Type){case"keyType.Opct":r.push({interpolation:h,time:u,selected:l,type:"opacity",value:mg(c.Opct)});break;case"keyType.Pstn":r.push({interpolation:h,time:u,selected:l,type:"position",x:c.Hrzn,y:c.Vrtc});break;case"keyType.Trnf":r.push({interpolation:h,time:u,selected:l,type:"transform",scale:qy(c["Scl "]),skew:qy(c.Skew),rotation:c.rotation,translation:qy(c.translation)});break;case"keyType.sheetStyle":var d={interpolation:h,time:u,selected:l,type:"style"};c.sheetStyle.Lefx&&(d.style=eg(c.sheetStyle.Lefx,t)),r.push(d);break;case"keyType.globalLighting":r.push({interpolation:h,time:u,selected:l,type:"globalLighting",globalAngle:c.gblA,globalAltitude:c.globalAltitude});break;default:throw new Error("Unsupported keyType value")}}return r}function rg(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=n.time,o=n.selected,a=void 0!==o&&o,s=n.interpolation,l=Bg.encode(s),c=void 0;switch(n.type){case"opacity":c={Type:"keyType.Opct",Opct:Sg(n.value)};break;case"position":c={Type:"keyType.Pstn",Hrzn:n.x,Vrtc:n.y};break;case"transform":c={Type:"keyType.Trnf","Scl ":Vy(n.scale),Skew:Vy(n.skew),rotation:n.rotation,translation:Vy(n.translation)};break;case"style":c={Type:"keyType.sheetStyle",sheetStyle:{Vrsn:1,blendOptions:{}}},n.style&&(c.sheetStyle={Vrsn:1,Lefx:Qy(n.style,!1,!1),blendOptions:{}});break;case"globalLighting":c={Type:"keyType.globalLighting",gblA:n.globalAngle,globalAltitude:n.globalAltitude};break;default:throw new Error("Unsupported keyType value")}t.push({Vrsn:1,animInterpStyle:l,time:i,animKey:c,selected:a})}return t}function ng(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o={type:Ug.decode(i.trackID),enabled:i.enab,keys:tg(i.keyList,t)};i.effectParams&&(o.effectParams={fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin,keys:tg(i.effectParams.keyList,t)}),r.push(o)}return r}function ig(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(dy(dy({trackID:Ug.encode(n.type),Vrsn:1,enab:!!n.enabled,Effc:!!n.effectParams},n.effectParams?{effectParams:{keyList:rg(n.keys),fillCanvas:n.effectParams.fillCanvas,zoomOrigin:n.effectParams.zoomOrigin}}:{}),{keyList:rg(n.keys)}))}return t}function og(e,t){for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],a=e[o];switch(o){case"enab":r.enabled=!!a;break;case"uglg":r.useGlobalLight=!!a;break;case"AntA":r.antialiased=!!a;break;case"Algn":r.align=!!a;break;case"Dthr":r.dither=!!a;break;case"Invr":r.invert=!!a;break;case"Rvrs":r.reverse=!!a;break;case"Clr ":r.color=vg(a);break;case"hglC":r.highlightColor=vg(a);break;case"sdwC":r.shadowColor=vg(a);break;case"Styl":r.position=Xg.decode(a);break;case"Md  ":r.blendMode=Lg.decode(a);break;case"hglM":r.highlightBlendMode=Lg.decode(a);break;case"sdwM":r.shadowBlendMode=Lg.decode(a);break;case"bvlS":r.style=Rg.decode(a);break;case"bvlD":r.direction=Pg.decode(a);break;case"bvlT":r.technique=Ig.decode(a);break;case"GlwT":r.technique=Fg.decode(a);break;case"glwS":r.source=Dg.decode(a);break;case"Type":r.type=Ng.decode(a);break;case"gs99":r.interpolationMethod=zg.decode(a);break;case"Opct":r.opacity=mg(a);break;case"hglO":r.highlightOpacity=mg(a);break;case"sdwO":r.shadowOpacity=mg(a);break;case"lagl":case"Angl":r.angle=gg(a);break;case"Lald":r.altitude=gg(a);break;case"Sftn":r.soften=xg(a);break;case"srgR":r.strength=mg(a);break;case"blur":r.size=xg(a);break;case"Nose":r.noise=mg(a);break;case"Inpr":r.range=mg(a);break;case"Ckmt":r.choke=xg(a);break;case"ShdN":r.jitter=mg(a);break;case"Dstn":r.distance=xg(a);break;case"Scl ":r.scale=mg(a);break;case"Ptrn":r.pattern={name:a["Nm  "],id:a.Idnt};break;case"phase":r.phase={x:a.Hrzn,y:a.Vrtc};break;case"Ofst":r.offset={x:mg(a.Hrzn),y:mg(a.Vrtc)};break;case"MpgS":case"TrnS":r.contour={name:a["Nm  "],curve:a["Crv "].map((function(e){return{x:e.Hrzn,y:e.Vrtc}}))};break;case"Grad":r.gradient=sg(a);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[o]=a;break;case"_name":case"_classID":break;default:t&&console.log("Invalid effect key: '".concat(o,"', value:"),a)}}return r}function ag(e,t,r){for(var n={},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=e[a];switch(a){case"enabled":n.enab=!!s;break;case"useGlobalLight":n.uglg=!!s;break;case"antialiased":n.AntA=!!s;break;case"align":n.Algn=!!s;break;case"dither":n.Dthr=!!s;break;case"invert":n.Invr=!!s;break;case"reverse":n.Rvrs=!!s;break;case"color":n["Clr "]=yg(s);break;case"highlightColor":n.hglC=yg(s);break;case"shadowColor":n.sdwC=yg(s);break;case"position":n.Styl=Xg.encode(s);break;case"blendMode":n["Md  "]=Lg.encode(s);break;case"highlightBlendMode":n.hglM=Lg.encode(s);break;case"shadowBlendMode":n.sdwM=Lg.encode(s);break;case"style":n.bvlS=Rg.encode(s);break;case"direction":n.bvlD=Pg.encode(s);break;case"technique":"bevel"===t?n.bvlT=Ig.encode(s):n.GlwT=Fg.encode(s);break;case"source":n.glwS=Dg.encode(s);break;case"type":n.Type=Ng.encode(s);break;case"interpolationMethod":n.gs99=zg.encode(s);break;case"opacity":n.Opct=Sg(s);break;case"highlightOpacity":n.hglO=Sg(s);break;case"shadowOpacity":n.sdwO=Sg(s);break;case"angle":"gradientOverlay"===t||"patternFill"===t?n.Angl=wg(s):n.lagl=wg(s);break;case"altitude":n.Lald=wg(s);break;case"soften":n.Sftn=Cg(s,a);break;case"strength":n.srgR=Sg(s);break;case"size":n.blur=Cg(s,a);break;case"noise":n.Nose=Sg(s);break;case"range":n.Inpr=Sg(s);break;case"choke":n.Ckmt=Cg(s,a);break;case"jitter":n.ShdN=Sg(s);break;case"distance":n.Dstn=Cg(s,a);break;case"scale":n["Scl "]=Sg(s);break;case"pattern":n.Ptrn={"Nm  ":s.name,Idnt:s.id};break;case"phase":n.phase={Hrzn:s.x,Vrtc:s.y};break;case"offset":n.Ofst={Hrzn:Sg(s.x),Vrtc:Sg(s.y)};break;case"contour":n["satin"===t?"MpgS":"TrnS"]={"Nm  ":s.name,"Crv ":s.curve.map((function(e){return{Hrzn:e.x,Vrtc:e.y}}))};break;case"gradient":n.Grad=lg(s);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[a]=s;break;default:r&&console.log("Invalid effect key: '".concat(a,"', value:"),s)}}return n}function sg(e){if("GrdF.CstS"===e.GrdF){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map((function(e){return{color:vg(e["Clr "]),location:e.Lctn/t,midpoint:e.Mdpn/100}})),opacityStops:e.Trns.map((function(e){return{opacity:mg(e.Opct),location:e.Lctn/t,midpoint:e.Mdpn/100}}))}}return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:Gg.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map((function(e){return e/100})),max:e["Mxm "].map((function(e){return e/100}))}}function lg(e){var t,r;if("solid"===e.type){var n=Math.round(4096*(null!==(t=e.smoothness)&&void 0!==t?t:1));return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:n,Clrs:e.colorStops.map((function(e){var t;return{"Clr ":yg(e.color),Type:"Clry.UsrS",Lctn:Math.round(e.location*n),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}})),Trns:e.opacityStops.map((function(e){var t;return{Opct:Sg(e.opacity),Lctn:Math.round(e.location*n),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}}))}}return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:Gg.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(4096*(null!==(r=e.roughness)&&void 0!==r?r:1)),"Mnm ":(e.min||[0,0,0,0]).map((function(e){return 100*e})),"Mxm ":(e.max||[1,1,1,1]).map((function(e){return 100*e}))}}function cg(e){var t=sg(e.Grad);return t.style=Ng.decode(e.Type),void 0!==e.Dthr&&(t.dither=e.Dthr),void 0!==e.gradientsInterpolationMethod&&(t.interpolationMethod=zg.decode(e.gradientsInterpolationMethod)),void 0!==e.Rvrs&&(t.reverse=e.Rvrs),void 0!==e.Angl&&(t.angle=gg(e.Angl)),void 0!==e["Scl "]&&(t.scale=mg(e["Scl "])),void 0!==e.Algn&&(t.align=e.Algn),void 0!==e.Ofst&&(t.offset={x:mg(e.Ofst.Hrzn),y:mg(e.Ofst.Vrtc)}),t}function ug(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return void 0!==e.Lnkd&&(t.linked=e.Lnkd),void 0!==e.phase&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function hg(e){if("Grad"in e)return cg(e);if("Ptrn"in e)return dy({type:"pattern"},ug(e));if("Clr "in e)return{type:"color",color:vg(e["Clr "])};throw new Error("Invalid vector content")}function dg(e){var t={};return void 0!==e.dither&&(t.Dthr=e.dither),void 0!==e.interpolationMethod&&(t.gradientsInterpolationMethod=zg.encode(e.interpolationMethod)),void 0!==e.reverse&&(t.Rvrs=e.reverse),void 0!==e.angle&&(t.Angl=wg(e.angle)),t.Type=Ng.encode(e.style),void 0!==e.align&&(t.Algn=e.align),void 0!==e.scale&&(t["Scl "]=Sg(e.scale)),e.offset&&(t.Ofst={Hrzn:Sg(e.offset.x),Vrtc:Sg(e.offset.y)}),t.Grad=lg(e),t}function fg(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return void 0!==e.linked&&(t.Lnkd=!!e.linked),void 0!==e.phase&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function pg(e){return"color"===e.type?{key:"SoCo",descriptor:{"Clr ":yg(e.color)}}:"pattern"===e.type?{key:"PtFl",descriptor:fg(e)}:{key:"GdFl",descriptor:dg(e)}}function vg(e){if("H   "in e)return{h:bg(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};if("redFloat"in e)return{fr:e.redFloat,fg:e.greenFloat,fb:e.blueFloat};throw new Error("Unsupported color descriptor")}function yg(e){if(e){if("r"in e)return{_name:"",_classID:"RGBC","Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("fr"in e)return{_name:"",_classID:"RGBC",redFloat:e.fr,greenFloat:e.fg,blueFloat:e.fb};if("h"in e)return{_name:"",_classID:"HSBC","H   ":wg(360*e.h),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{_name:"",_classID:"CMYC","Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{_name:"",_classID:"LABC",Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{_name:"",_classID:"GRYC","Gry ":e.k};throw new Error("Invalid color value")}return{_name:"",_classID:"RGBC","Rd  ":0,"Grn ":0,"Bl  ":0}}function gg(e){if(void 0===e)return 0;if("Angle"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value}function mg(e){if(void 0===e)return 1;if("Percent"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value/100}function bg(e){if(void 0===e)return 1;if("Percent"===e.units)return e.value/100;if("Angle"===e.units)return e.value/360;throw new Error("Invalid units: ".concat(e.units))}function xg(e){var t=e.units,r=e.value;if("Pixels"!==t&&"Millimeters"!==t&&"Points"!==t&&"None"!==t&&"Picas"!==t&&"Inches"!==t&&"Centimeters"!==t&&"Density"!==t)throw new Error("Invalid units: ".concat(JSON.stringify({units:t,value:r})));return{value:r,units:t}}function Eg(e,t){return void 0===t&&(t="Pixels"),"number"==typeof e?{value:e,units:t}:xg(e)}function wg(e){return{units:"Angle",value:e||0}}function Sg(e){return{units:"Percent",value:Math.round(100*(e||0))}}function _g(e){return{units:"Percent",value:100*(e||0)}}function Cg(e,t){if(null==e)return{units:"Pixels",value:0};if("object"!=typeof e)throw new Error("Invalid value: ".concat(JSON.stringify(e)," (key: ").concat(t,") (should have value and units)"));var r=e.units,n=e.value;if("number"!=typeof n)throw new Error("Invalid value in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));if("Pixels"!==r&&"Millimeters"!==r&&"Points"!==r&&"None"!==r&&"Picas"!==r&&"Inches"!==r&&"Centimeters"!==r&&"Density"!==r)throw new Error("Invalid units in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));return{units:r,value:n}}function Ag(e){return{numerator:e.numerator,denominator:e.denominator}}var Tg=$v("textGridding","none",{none:"None",round:"Rnd "}),Og=$v("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"}),Mg=$v("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm",platform:"antiAliasPlatformGray",platformLCD:"antiAliasPlatformLCD"}),kg=$v("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist",cylinder:"warpCylinder",custom:"warpCustom"}),Lg=$v("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns","linear height":"linearHeight",height:"Hght",subtraction:"Sbtr"}),Rg=$v("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"}),Ig=$v("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"}),Pg=$v("BESs","up",{up:"In  ",down:"Out "}),Fg=$v("BETE","softer",{softer:"SfBL",precise:"PrBL"}),Dg=$v("IGSr","edge",{edge:"SrcE",center:"SrcC"}),Ng=$v("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"}),Bg=$v("animInterpStyle","linear",{linear:"Lnr ",hold:"hold"}),Ug=$v("stdTrackID","opacity",{opacity:"opacityTrack",style:"styleTrack",sheetTransform:"sheetTransformTrack",sheetPosition:"sheetPositionTrack",globalLighting:"globalLightingTrack"}),zg=$v("gradientInterpolationMethodType","perceptual",{perceptual:"Perc",linear:"Lnr ",classic:"Gcls",smooth:"Smoo"}),Gg=$v("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl",hsl:"HSLC"}),Xg=$v("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"}),Hg=$v("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"}),jg=$v("ESliceType","image",{image:"Img ",noImage:"noImage"}),Wg=$v("ESliceHorzAlign","default",{default:"default"}),Yg=$v("ESliceVertAlign","default",{default:"default"}),qg=$v("ESliceOrigin","userGenerated",{userGenerated:"userGenerated",autoGenerated:"autoGenerated",layer:"layer"}),Vg=$v("ESliceBGColorType","none",{none:"None",matte:"matte",color:"Clr "}),Kg=$v("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"}),Zg=$v("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"}),Jg=$v("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"}),$g=$v("BlrM","ispinmage",{spin:"Spn ",zoom:"Zm  "}),Qg=$v("BlrQ","good",{draft:"Drft",good:"Gd  ",best:"Bst "}),em=$v("SmBM","normal",{normal:"SBMN","edge only":"SBME","overlay edge":"SBMO"}),tm=$v("SmBQ","medium",{low:"SBQL",medium:"SBQM",high:"SBQH"}),rm=$v("DspM","stretch to fit",{"stretch to fit":"StrF",tile:"Tile"}),nm=$v("UndA","repeat edge pixels",{"wrap around":"WrpA","repeat edge pixels":"RptE"}),im=$v("Cnvr","rectangular to polar",{"rectangular to polar":"RctP","polar to rectangular":"PlrR"}),om=$v("RplS","medium",{small:"Sml ",medium:"Mdm ",large:"Lrg "}),am=$v("SphM","normal",{normal:"Nrml","horizontal only":"HrzO","vertical only":"VrtO"}),sm=$v("Wvtp","sine",{sine:"WvSn",triangle:"WvTr",square:"WvSq"}),lm=$v("ZZTy","pond ripples",{"around center":"ArnC","out from center":"OtFr","pond ripples":"PndR"}),cm=$v("Dstr","uniform",{uniform:"Unfr",gaussian:"Gsn "}),um=$v("Chnl","composite",{red:"Rd  ",green:"Grn ",blue:"Bl  ",composite:"Cmps"}),hm=$v("MztT","fine dots",{"fine dots":"FnDt","medium dots":"MdmD","grainy dots":"GrnD","coarse dots":"CrsD","short lines":"ShrL","medium lines":"MdmL","long lines":"LngL","short strokes":"ShSt","medium strokes":"MdmS","long strokes":"LngS"}),dm=$v("Lns ","50-300mm zoom",{"50-300mm zoom":"Zm  ","32mm prime":"Nkn ","105mm prime":"Nkn1","movie prime":"PnVs"}),fm=$v("blurType","gaussian blur",{"gaussian blur":"GsnB","lens blur":"lensBlur","motion blur":"MtnB"}),pm=$v("DfsM","normal",{normal:"Nrml","darken only":"DrkO","lighten only":"LghO",anisotropic:"anisotropic"}),vm=$v("ExtT","blocks",{blocks:"Blks",pyramids:"Pyrm"}),ym=$v("ExtR","random",{random:"Rndm","level-based":"LvlB"}),gm=$v("FlCl","background color",{"background color":"FlBc","foreground color":"FlFr","inverse image":"FlIn","unaltered image":"FlSm"}),mm=$v("CntE","upper",{lower:"Lwr ",upper:"Upr "}),bm=$v("WndM","wind",{wind:"Wnd ",blast:"Blst",stagger:"Stgr"}),xm=$v("Drct","from the right",{left:"Left",right:"Rght"}),Em=$v("IntE","odd lines",{"odd lines":"ElmO","even lines":"ElmE"}),wm=$v("IntC","interpolation",{duplication:"CrtD",interpolation:"CrtI"}),Sm=$v("FlMd","wrap around",{"set to transparent":"Bckg","repeat edge pixels":"Rpt ","wrap around":"Wrp "});$v("prjM","fisheye",{fisheye:"fisP",perspective:"perP",auto:"auto","full spherical":"fusP"});var _m=$v("presetKindType","presetKindCustom",{custom:"presetKindCustom",default:"presetKindDefault"}),Cm=function(){return Cm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Cm.apply(this,arguments)},Am={};function Tm(e,t,r,n){var i={key:e,has:t,read:r,write:n};Am[i.key]=i}var Om=[void 0,"PPI","PPCM"],Mm=[void 0,"Inches","Centimeters","Points","Picas","Columns"],km="0123456789abcdef";function Lm(e){return e<=57?e-48:e-87}function Rm(e,t){return Lm(e.charCodeAt(t))<<4|Lm(e.charCodeAt(t+1))}function Im(e,t){return hy(hb(e,t))}function Pm(e,t){ME(e,cy(t))}function Fm(e){for(var t=hb(e,Qm(e)),r=!1,n=0;n<t.byteLength;n++)if(128&t[n]){r=!0;break}return r?new TextDecoder("gbk").decode(t):hy(t)}function Dm(e,t){for(var r="",n=0,i=t.codePointAt(n++);void 0!==i;i=t.codePointAt(n++))r+=i>127?"?":String.fromCodePoint(i);var o=cy(r);mE(e,o.byteLength),ME(e,o)}Tm(1061,(function(e){return void 0!==e.captionDigest}),(function(e,t){for(var r="",n=0;n<16;n++){var i=Qm(e);r+=km[i>>4],r+=km[15&i]}t.captionDigest=r}),(function(e,t){for(var r=0;r<16;r++)mE(e,Rm(t.captionDigest,2*r))})),Tm(1060,(function(e){return void 0!==e.xmpMetadata}),(function(e,t,r){t.xmpMetadata=Im(e,r())}),(function(e,t){Pm(e,t.xmpMetadata)}));var Nm=$v("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});Tm(1082,(function(e){return void 0!==e.printInformation}),(function(e,t){var r,n,i=Wy(e);t.printInformation={printerName:i.printerName||"",renderingIntent:Nm.decode(null!==(r=i.Inte)&&void 0!==r?r:"Inte.Img ")};var o=t.printInformation;void 0!==i.PstS&&(o.printerManagesColors=i.PstS),void 0!==i["Nm  "]&&(o.printerProfile=i["Nm  "]),void 0!==i.MpBl&&(o.blackPointCompensation=i.MpBl),void 0!==i.printSixteenBit&&(o.printSixteenBit=i.printSixteenBit),void 0!==i.hardProof&&(o.hardProof=i.hardProof),i.printProofSetup&&("Bltn"in i.printProofSetup?o.proofSetup={builtin:i.printProofSetup.Bltn.split(".")[1]}:o.proofSetup={profile:i.printProofSetup.profile,renderingIntent:Nm.decode(null!==(n=i.printProofSetup.Inte)&&void 0!==n?n:"Inte.Img "),blackPointCompensation:!!i.printProofSetup.MpBl,paperWhite:!!i.printProofSetup.paperWhite})}),(function(e,t){var r,n,i=t.printInformation,o={};i.printerManagesColors?o.PstS=!0:(void 0!==i.hardProof&&(o.hardProof=!!i.hardProof),o.ClrS="ClrS.RGBC",o["Nm  "]=null!==(r=i.printerProfile)&&void 0!==r?r:"CIE RGB"),o.Inte=Nm.encode(i.renderingIntent),i.printerManagesColors||(o.MpBl=!!i.blackPointCompensation),o.printSixteenBit=!!i.printSixteenBit,o.printerName=i.printerName||"",i.proofSetup&&"profile"in i.proofSetup?o.printProofSetup={profile:i.proofSetup.profile||"",Inte:Nm.encode(i.proofSetup.renderingIntent),MpBl:!!i.proofSetup.blackPointCompensation,paperWhite:!!i.proofSetup.paperWhite}:o.printProofSetup={Bltn:(null===(n=i.proofSetup)||void 0===n?void 0:n.builtin)?"builtinProof.".concat(i.proofSetup.builtin):"builtinProof.proofCMYK"},Yy(e,"","printOutput",o)})),Tm(1005,(function(e){return void 0!==e.resolutionInfo}),(function(e,t){var r=cb(e),n=rb(e),i=rb(e),o=cb(e),a=rb(e),s=rb(e);t.resolutionInfo={horizontalResolution:r,horizontalResolutionUnit:Om[n]||"PPI",widthUnit:Mm[i]||"Inches",verticalResolution:o,verticalResolutionUnit:Om[a]||"PPI",heightUnit:Mm[s]||"Inches"}}),(function(e,t){var r=t.resolutionInfo;TE(e,r.horizontalResolution||0),xE(e,Math.max(1,Om.indexOf(r.horizontalResolutionUnit))),xE(e,Math.max(1,Mm.indexOf(r.widthUnit))),TE(e,r.verticalResolution||0),xE(e,Math.max(1,Om.indexOf(r.verticalResolutionUnit))),xE(e,Math.max(1,Mm.indexOf(r.heightUnit)))}));var Bm=["centered","size to fit","user defined"];Tm(1062,(function(e){return void 0!==e.printScale}),(function(e,t){t.printScale={style:Bm[tb(e)],x:sb(e),y:sb(e),scale:sb(e)}}),(function(e,t){var r=t.printScale,n=r.style,i=r.x,o=r.y,a=r.scale;bE(e,Math.max(0,Bm.indexOf(n))),CE(e,i||0),CE(e,o||0),CE(e,a||0)})),Tm(1006,(function(e){return void 0!==e.alphaChannelNames}),(function(e,t,r){if(t.alphaChannelNames)mb(e,r());else for(t.alphaChannelNames=[];r()>0;){var n=Fm(e);t.alphaChannelNames.push(n)}}),(function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){Dm(e,n[r])}})),Tm(1045,(function(e){return void 0!==e.alphaChannelNames}),(function(e,t,r){for(t.alphaChannelNames=[];r()>0;)t.alphaChannelNames.push(vb(e))}),(function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){PE(e,n[r])}})),Tm(1053,(function(e){return void 0!==e.alphaIdentifiers}),(function(e,t,r){for(t.alphaIdentifiers=[];r()>=4;)t.alphaIdentifiers.push(ab(e))}),(function(e,t){for(var r=0,n=t.alphaIdentifiers;r<n.length;r++){_E(e,n[r])}})),Tm(1010,(function(e){return void 0!==e.backgroundColor}),(function(e,t){return t.backgroundColor=Bb(e)}),(function(e,t){return BE(e,t.backgroundColor)})),Tm(1037,(function(e){return void 0!==e.globalAngle}),(function(e,t){return t.globalAngle=ib(e)}),(function(e,t){return wE(e,t.globalAngle)})),Tm(1049,(function(e){return void 0!==e.globalAltitude}),(function(e,t){return t.globalAltitude=ab(e)}),(function(e,t){return _E(e,t.globalAltitude)})),Tm(1011,(function(e){return void 0!==e.printFlags}),(function(e,t){t.printFlags={labels:!!Qm(e),cropMarks:!!Qm(e),colorBars:!!Qm(e),registrationMarks:!!Qm(e),negative:!!Qm(e),flip:!!Qm(e),interpolate:!!Qm(e),caption:!!Qm(e),printFlags:!!Qm(e)}}),(function(e,t){var r=t.printFlags;mE(e,r.labels?1:0),mE(e,r.cropMarks?1:0),mE(e,r.colorBars?1:0),mE(e,r.registrationMarks?1:0),mE(e,r.negative?1:0),mE(e,r.flip?1:0),mE(e,r.interpolate?1:0),mE(e,r.caption?1:0),mE(e,r.printFlags?1:0)})),Tm(1080,(function(e){return void 0!==e.countInformation}),(function(e,t){var r=Wy(e);t.countInformation=r.countGroupList.map((function(e){return{color:{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]},name:e["Nm  "],size:e["Rds "],fontSize:e.fontSize,visible:e.Vsbl,points:e.countObjectList.map((function(e){return{x:e["X   "],y:e["Y   "]}}))}}))}),(function(e,t){Yy(e,"","Cnt ",{Vrsn:1,countGroupList:t.countInformation.map((function(e){return{"Rd  ":e.color.r,"Grn ":e.color.g,"Bl  ":e.color.b,"Nm  ":e.name,"Rds ":e.size,fontSize:e.fontSize,Vsbl:e.visible,countObjectList:e.points.map((function(e){return{"X   ":e.x,"Y   ":e.y}}))}}))})})),Tm(1024,(function(e){return void 0!==e.layerState}),(function(e,t){return t.layerState=rb(e)}),(function(e,t){return xE(e,t.layerState)})),Tm(1026,(function(e){return void 0!==e.layersGroup}),(function(e,t,r){for(t.layersGroup=[];r()>0;)t.layersGroup.push(rb(e))}),(function(e,t){for(var r=0,n=t.layersGroup;r<n.length;r++){xE(e,n[r])}})),Tm(1072,(function(e){return void 0!==e.layerGroupsEnabledId}),(function(e,t,r){for(t.layerGroupsEnabledId=[];r()>0;)t.layerGroupsEnabledId.push(Qm(e))}),(function(e,t){for(var r=0,n=t.layerGroupsEnabledId;r<n.length;r++){mE(e,n[r])}})),Tm(1069,(function(e){return void 0!==e.layerSelectionIds}),(function(e,t){var r=rb(e);for(t.layerSelectionIds=[];r--;)t.layerSelectionIds.push(ab(e))}),(function(e,t){xE(e,t.layerSelectionIds.length);for(var r=0,n=t.layerSelectionIds;r<n.length;r++){_E(e,n[r])}})),Tm(1032,(function(e){return void 0!==e.gridAndGuidesInformation}),(function(e,t){var r=ab(e),n=ab(e),i=ab(e),o=ab(e);if(1!==r)throw new Error("Invalid 1032 resource version: ".concat(r));t.gridAndGuidesInformation={grid:{horizontal:n,vertical:i},guides:[]};for(var a=0;a<o;a++)t.gridAndGuidesInformation.guides.push({location:ab(e)/32,direction:Qm(e)?"horizontal":"vertical"})}),(function(e,t){var r=t.gridAndGuidesInformation,n=r.grid||{horizontal:576,vertical:576},i=r.guides||[];_E(e,1),_E(e,n.horizontal),_E(e,n.vertical),_E(e,i.length);for(var o=0,a=i;o<a.length;o++){var s=a[o];_E(e,32*s.location),mE(e,"horizontal"===s.direction?1:0)}})),Tm(1065,(function(e){return void 0!==e.layerComps}),(function(e,t){var r=Wy(e,!0);t.layerComps={list:[]};for(var n=0,i=r.list;n<i.length;n++){var o=i[n];t.layerComps.list.push({id:o.compID,name:o["Nm  "],capturedInfo:o.capturedInfo}),"comment"in o&&(t.layerComps.list[t.layerComps.list.length-1].comment=o.comment)}"lastAppliedComp"in r&&(t.layerComps.lastApplied=r.lastAppliedComp)}),(function(e,t){for(var r=t.layerComps,n={list:[]},i=0,o=r.list;i<o.length;i++){var a=o[i],s={_classID:"Comp"};s["Nm  "]=a.name,"comment"in a&&(s.comment=a.comment),s.compID=a.id,s.capturedInfo=a.capturedInfo,n.list.push(s)}"lastApplied"in r&&(n.lastAppliedComp=r.lastApplied),Yy(e,"","CompList",n)}));var Um=["normal",void 0,void 0,void 0,void 0,void 0,void 0,"multiply","screen",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"difference"];function zm(e){return{"Top ":e.top,Left:e.left,Btom:e.bottom,Rght:e.right}}function Gm(e){return{top:e["Top "],left:e.Left,bottom:e.Btom,right:e.Rght}}function Xm(e,t){return e[Math.max(0,Math.min(e.length-1,t))]}Tm(1078,(function(e){return void 0!==e.onionSkins}),(function(e,t){var r=Wy(e);t.onionSkins={enabled:r.enab,framesBefore:r.numBefore,framesAfter:r.numAfter,frameSpacing:r.Spcn,minOpacity:r.minOpacity/100,maxOpacity:r.maxOpacity/100,blendMode:Um[r.BlnM]||"normal"}}),(function(e,t){var r=t.onionSkins;Yy(e,"","null",{Vrsn:1,enab:r.enabled,numBefore:r.framesBefore,numAfter:r.framesAfter,Spcn:r.frameSpacing,minOpacity:100*r.minOpacity|0,maxOpacity:100*r.maxOpacity|0,BlnM:Math.max(0,Um.indexOf(r.blendMode))})})),Tm(1075,(function(e){return void 0!==e.timelineInformation}),(function(e,t){var r,n,i=Wy(e);t.timelineInformation={enabled:i.enab,frameStep:Ag(i.frameStep),frameRate:i.frameRate,time:Ag(i.time),duration:Ag(i.duration),workInTime:Ag(i.workInTime),workOutTime:Ag(i.workOutTime),repeats:i.LCnt,hasMotion:i.hasMotion,globalTracks:ng(i.globalTrackList,!!e.logMissingFeatures)},(null===(n=null===(r=i.audioClipGroupList)||void 0===r?void 0:r.audioClipGroupList)||void 0===n?void 0:n.length)&&(t.timelineInformation.audioClipGroups=i.audioClipGroupList.audioClipGroupList.map((function(e){return{id:e.groupID,muted:e.muted,audioClips:e.audioClipList.map((function(e){var t=e.clipID,r=e.timeScope,n=e.muted,i=e.audioLevel,o=e.frameReader;return{id:t,start:Ag(r.Strt),duration:Ag(r.duration),inTime:Ag(r.inTime),outTime:Ag(r.outTime),muted:n,audioLevel:i,frameReader:{type:o.frameReaderType,mediaDescriptor:o.mediaDescriptor,link:{name:o["Lnk "]["Nm  "],fullPath:o["Lnk "].fullPath,relativePath:o["Lnk "].relPath}}}}))}})))}),(function(e,t){var r,n=t.timelineInformation,i={Vrsn:1,enab:n.enabled,frameStep:n.frameStep,frameRate:n.frameRate,time:n.time,duration:n.duration,workInTime:n.workInTime,workOutTime:n.workOutTime,LCnt:n.repeats,globalTrackList:ig(n.globalTracks),audioClipGroupList:{audioClipGroupList:null===(r=n.audioClipGroups)||void 0===r?void 0:r.map((function(e){return{groupID:e.id,muted:e.muted,audioClipList:e.audioClips.map((function(e){return{clipID:e.id,timeScope:{Vrsn:1,Strt:e.start,duration:e.duration,inTime:e.inTime,outTime:e.outTime},frameReader:{frameReaderType:e.frameReader.type,descVersion:1,"Lnk ":{descVersion:1,"Nm  ":e.frameReader.link.name,fullPath:e.frameReader.link.fullPath,relPath:e.frameReader.link.relativePath},mediaDescriptor:e.frameReader.mediaDescriptor},muted:e.muted,audioLevel:e.audioLevel}}))}}))},hasMotion:n.hasMotion};Yy(e,"","null",i,"anim")})),Tm(1076,(function(e){return void 0!==e.sheetDisclosure}),(function(e,t){var r=Wy(e);t.sheetDisclosure={},r.sheetTimelineOptions&&(t.sheetDisclosure.sheetTimelineOptions=r.sheetTimelineOptions.map((function(e){return{sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}})))}),(function(e,t){var r=t.sheetDisclosure,n={Vrsn:1};r.sheetTimelineOptions&&(n.sheetTimelineOptions=r.sheetTimelineOptions.map((function(e){return{Vrsn:2,sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}}))),Yy(e,"","null",n)})),Tm(1054,(function(e){return void 0!==e.urlsList}),(function(e,t){var r=ab(e);t.urlsList=[];for(var n=0;n<r;n++){if("slic"!==db(e)&&e.throwForMissingFeatures)throw new Error("Unknown long");var i=ab(e),o=vb(e);t.urlsList.push({id:i,url:o,ref:"slice"})}}),(function(e,t){var r=t.urlsList;_E(e,r.length);for(var n=0;n<r.length;n++)LE(e,"slic"),_E(e,r[n].id),IE(e,r[n].url)}));var Hm=["autoGenerated","layer","userGenerated"],jm=["noImage","image"],Wm=["default"];Tm(1050,(function(e){return e.slices?e.slices.length:0}),(function(e,t){var r=ab(e);if(6===r){t.slices||(t.slices=[]);var n=ib(e),i=ib(e),o=ib(e),a=ib(e),s=vb(e),l=ab(e);t.slices.push({bounds:{top:n,left:i,bottom:o,right:a},groupName:s,slices:[]});for(var c=t.slices[t.slices.length-1].slices,u=0;u<l;u++){var h=ab(e),d=ab(e),f=Xm(Hm,ab(e)),p="layer"==f?ab(e):0,v=vb(e),y=Xm(jm,ab(e)),g=ib(e),m=ib(e),b=ib(e),x=ib(e),E=vb(e),w=vb(e),S=vb(e),_=vb(e),C=!!Qm(e),A=vb(e),T=Xm(Wm,ab(e)),O=Xm(Wm,ab(e)),M=Qm(e),k=Qm(e),L=Qm(e),R=Qm(e),I=M+k+L+R===0?"none":0===M?"matte":"color";c.push({id:h,groupId:d,origin:f,associatedLayerId:p,name:v,target:w,message:S,altTag:_,cellTextIsHTML:C,cellText:A,horizontalAlignment:T,verticalAlignment:O,type:y,url:E,bounds:{top:m,left:g,bottom:x,right:b},backgroundColorType:I,backgroundColor:{r:k,g:L,b:R,a:M}})}(P=Wy(e)).slices.forEach((function(e){var t=c.find((function(t){return e.sliceID==t.id}));t&&(t.topOutset=e.topOutset,t.leftOutset=e.leftOutset,t.bottomOutset=e.bottomOutset,t.rightOutset=e.rightOutset)}))}else{if(7!==r&&8!==r)throw new Error("Invalid slices version (".concat(r,")"));var P=Wy(e);t.slices||(t.slices=[]),t.slices.push({groupName:P.baseName,bounds:Gm(P.bounds),slices:P.slices.map((function(e){return Cm(Cm({},e["Nm  "]?{name:e["Nm  "]}:{}),{id:e.sliceID,groupId:e.groupID,associatedLayerId:0,origin:qg.decode(e.origin),type:jg.decode(e.Type),bounds:Gm(e.bounds),url:e.url,target:e.null,message:e.Msge,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horizontalAlignment:Wg.decode(e.horzAlign),verticalAlignment:Yg.decode(e.vertAlign),backgroundColorType:Vg.decode(e.bgColorType),backgroundColor:e.bgColor?{r:e.bgColor["Rd  "],g:e.bgColor["Grn "],b:e.bgColor["Bl  "],a:e.bgColor.alpha}:{r:0,g:0,b:0,a:0},topOutset:e.topOutset||0,leftOutset:e.leftOutset||0,bottomOutset:e.bottomOutset||0,rightOutset:e.rightOutset||0})}))})}}),(function(e,t,r){var n=t.slices[r],i=n.bounds,o=n.groupName,a=n.slices;_E(e,6),wE(e,i.top),wE(e,i.left),wE(e,i.bottom),wE(e,i.right),IE(e,o),_E(e,a.length);for(var s=0;s<a.length;s++){var l=a[s],c=l.backgroundColor,u=c.a,h=c.r,d=c.g,f=c.b;"none"===l.backgroundColorType?u=h=d=f=0:"matte"===l.backgroundColorType&&(u=0,h=d=f=255),_E(e,l.id),_E(e,l.groupId),_E(e,Hm.indexOf(l.origin)),"layer"===l.origin&&_E(e,l.associatedLayerId),IE(e,l.name||""),_E(e,jm.indexOf(l.type)),wE(e,l.bounds.left),wE(e,l.bounds.top),wE(e,l.bounds.right),wE(e,l.bounds.bottom),IE(e,l.url),IE(e,l.target),IE(e,l.message),IE(e,l.altTag),mE(e,l.cellTextIsHTML?1:0),IE(e,l.cellText),_E(e,Wm.indexOf(l.horizontalAlignment)),_E(e,Wm.indexOf(l.verticalAlignment)),mE(e,u),mE(e,h),mE(e,d),mE(e,f)}var p={bounds:zm(i),slices:[]};a.forEach((function(e){var t=Cm(Cm({sliceID:e.id,groupID:e.groupId,origin:qg.encode(e.origin),Type:jg.encode(e.type),bounds:zm(e.bounds)},e.name?{"Nm  ":e.name}:{}),{url:e.url,null:e.target,Msge:e.message,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horzAlign:Wg.encode(e.horizontalAlignment),vertAlign:Yg.encode(e.verticalAlignment),bgColorType:Vg.encode(e.backgroundColorType)});if("color"===e.backgroundColorType){var r=e.backgroundColor,n=r.r,i=r.g,o=r.b,a=r.a;t.bgColor={"Rd  ":n,"Grn ":i,"Bl  ":o,alpha:a}}t.topOutset=e.topOutset||0,t.leftOutset=e.leftOutset||0,t.bottomOutset=e.bottomOutset||0,t.rightOutset=e.rightOutset||0,p.slices.push(t)})),Yy(e,"","null",p,"slices")})),Tm(1064,(function(e){return void 0!==e.pixelAspectRatio}),(function(e,t){if(ab(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:lb(e)}}),(function(e,t){_E(e,2),AE(e,t.pixelAspectRatio.aspect)})),Tm(1041,(function(e){return void 0!==e.iccUntaggedProfile}),(function(e,t){t.iccUntaggedProfile=!!Qm(e)}),(function(e,t){mE(e,t.iccUntaggedProfile?1:0)})),Tm(1044,(function(e){return void 0!==e.idsSeedNumber}),(function(e,t){return t.idsSeedNumber=ab(e)}),(function(e,t){return _E(e,t.idsSeedNumber)})),Tm(1036,(function(e){return void 0!==e.thumbnail||void 0!==e.thumbnailRaw}),(function(e,t,r){var n=ab(e),i=ab(e),o=ab(e);ab(e),ab(e),ab(e);var a=rb(e),s=rb(e);if(1!==n||24!==a||1!==s)return e.logMissingFeatures&&e.log("Invalid thumbnail data (format: ".concat(n,", bitsPerPixel: ").concat(a,", planes: ").concat(s,")")),void mb(e,r());var l=hb(e,r());e.useRawThumbnail?t.thumbnailRaw={width:i,height:o,data:l}:l.byteLength&&(t.thumbnail=iy(l))}),(function(e,t){var r,n=0,i=0,o=new Uint8Array(0);if(t.thumbnailRaw)n=t.thumbnailRaw.width,i=t.thumbnailRaw.height,o=t.thumbnailRaw.data;else try{var a=null===(r=t.thumbnail.toDataURL("image/jpeg",1))||void 0===r?void 0:r.substring(23);a&&(o=xe(a),n=t.thumbnail.width,i=t.thumbnail.height)}catch(e){}var s=4*Math.floor((24*n+31)/32),l=s*i*1,c=o.length;_E(e,1),_E(e,n),_E(e,i),_E(e,s),_E(e,l),_E(e,c),xE(e,24),xE(e,1),ME(e,o)})),Tm(1057,(function(e){return void 0!==e.versionInfo}),(function(e,t,r){if(1!==ab(e))throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!Qm(e),writerName:vb(e),readerName:vb(e),fileVersion:ab(e)},mb(e,r())}),(function(e,t){var r=t.versionInfo;_E(e,1),mE(e,r.hasRealMergedData?1:0),IE(e,r.writerName),IE(e,r.readerName),_E(e,r.fileVersion)})),Tm(7e3,(function(e){return void 0!==e.imageReadyVariables}),(function(e,t,r){t.imageReadyVariables=Im(e,r())}),(function(e,t){Pm(e,t.imageReadyVariables)})),Tm(7001,(function(e){return void 0!==e.imageReadyDataSets}),(function(e,t,r){t.imageReadyDataSets=Im(e,r())}),(function(e,t){Pm(e,t.imageReadyDataSets)})),Tm(1088,(function(e){return void 0!==e.pathSelectionState}),(function(e,t,r){var n=Wy(e);t.pathSelectionState=n.null}),(function(e,t){Yy(e,"","null",{null:t.pathSelectionState})}));var Ym=$v("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"});Tm(4e3,(function(e){return void 0!==e.animations}),(function(e,t,r){var n=db(e);if("mani"===n)bb(e,"IRFR"),Nb(e,1,(function(r){for(var n=function(){bb(e,"8BIM");var r=db(e);Nb(e,1,(function(n){if("AnDs"===r){var i=Wy(e);t.animations={frames:i.FrIn.map((function(e){return{id:e.FrID,delay:(e.FrDl||0)/100,dispose:e.FrDs?Ym.decode(e.FrDs):"auto"}})),animations:i.FSts.map((function(e){return{id:e.FsID,frames:e.FsFr,repeats:e.LCnt,activeFrame:e.AFrm||0}}))}}else if("Roll"===r){var o=hb(e,n());e.logDevFeatures&&e.log("#4000 Roll",o)}else e.logMissingFeatures&&e.log("Unhandled subsection in #4000",r)}))};r()>0;)n()}));else if("mopt"===n){var i=hb(e,r());e.logDevFeatures&&e.log("#4000 mopt",i)}else e.logMissingFeatures&&e.log("Unhandled key in #4000:",n)}),(function(e,t){t.animations&&(LE(e,"mani"),LE(e,"IRFR"),FE(e,1,(function(){LE(e,"8BIM"),LE(e,"AnDs"),FE(e,1,(function(){for(var r={FrIn:[],FSts:[]},n=0;n<t.animations.frames.length;n++){var i=t.animations.frames[n],o={FrID:i.id};i.delay&&(o.FrDl=100*i.delay|0),o.FrDs=Ym.encode(i.dispose),r.FrIn.push(o)}for(n=0;n<t.animations.animations.length;n++){var a=t.animations.animations[n],s={FsID:a.id,AFrm:0|a.activeFrame,FsFr:a.frames,LCnt:0|a.repeats};r.FSts.push(s)}Yy(e,"","null",r)}))})))}));var qm=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},Vm=[0,1,3,2],Km=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"];function Zm(e){for(var t=e.width*e.height*4,r=0;r<t;r+=4)e.data[r+1]=e.data[r],e.data[r+2]=e.data[r]}function Jm(e,t,r){return{view:new DataView(e,t,r),offset:0,strict:!1,debug:!1,large:!1,globalAlpha:!1,log:console.log}}function $m(e,t){if(e.strict)throw new Error(t);e.debug&&e.log(t)}function Qm(e){return e.offset+=1,e.view.getUint8(e.offset-1)}function eb(e){return e.view.getUint8(e.offset)}function tb(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}function rb(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}function nb(e){return e.offset+=2,e.view.getUint16(e.offset-2,!0)}function ib(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}function ob(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)}function ab(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}function sb(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)}function lb(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}function cb(e){return ib(e)/65536}function ub(e){return ib(e)/(1<<24)}function hb(e,t){var r=e.view.byteOffset+e.offset;if(e.offset+=t,r+t>e.view.buffer.byteLength){if($m(e,"Reading bytes exceeding buffer length"),t>104857600)throw new Error("Reading past end of file");var n=new Uint8Array(t),i=Math.min(t,e.view.byteLength-r);return i>0&&n.set(new Uint8Array(e.view.buffer,r,i)),n}return new Uint8Array(e.view.buffer,r,t)}function db(e){return xb(e,4)}function fb(e,t){var r=String.fromCharCode(e.view.getUint8(t))+String.fromCharCode(e.view.getUint8(t+1))+String.fromCharCode(e.view.getUint8(t+2))+String.fromCharCode(e.view.getUint8(t+3));return"8BIM"==r||"8B64"==r}function pb(e,t){for(var r=Qm(e),n=r?xb(e,r):"";++r%t;)e.offset++;return n}function vb(e){return yb(e,ab(e))}function yb(e,t){for(var r="";t--;){var n=rb(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}function gb(e,t){for(var r="";t--;)r+=String.fromCharCode(Qm(e));return r}function mb(e,t){e.offset+=t}function bb(e,t,r){var n=e.offset,i=db(e);if(i!==t&&i!==r)throw new Error("Invalid signature: '".concat(i,"' at 0x").concat(n.toString(16)))}function xb(e,t){for(var r=hb(e,t),n="",i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return n}function Eb(e){return"8BIM"===e||"MeSa"===e||"AgHg"===e||"PHUT"===e||"DCSR"===e}function wb(e,t){var r;void 0===t&&(t={}),bb(e,"8BPS");var n=rb(e);if(1!==n&&2!==n)throw new Error("Invalid PSD file version: ".concat(n));mb(e,6);var i=rb(e),o=ab(e),a=ab(e),s=rb(e),l=rb(e),c=1===n?3e4:3e5;if(a>c||o>c)throw new Error("Invalid size: ".concat(a,"x").concat(o));if(i>16)throw new Error("Invalid channel count: ".concat(i));if(![1,8,16,32].includes(s))throw new Error("Invalid bitsPerChannel: ".concat(s));if(-1===Vm.indexOf(l))throw new Error("Color mode not supported: ".concat(null!==(r=Km[l])&&void 0!==r?r:l));var u={width:a,height:o,channels:i,bitsPerChannel:s,colorMode:l};Object.assign(e,t),e.large=2===n,e.globalAlpha=!1;var h=[0,1,-1,2,-2,3,-3,4,-4];Nb(e,1,(function(t){if(t()){if(2===l){if(768!=t())throw new Error("Invalid color palette size");u.palette=[];for(var r=0;r<256;r++)u.palette.push({r:Qm(e),g:0,b:0});for(r=0;r<256;r++)u.palette[r].g=Qm(e);for(r=0;r<256;r++)u.palette[r].b=Qm(e)}mb(e,t())}}));var d={};Nb(e,1,(function(t){for(var r=function(){for(var t=e.offset,r="",n=0,i=h;n<i.length;n++){var o=i[n];try{e.offset=t+o,r=db(e)}catch(e){}if(Eb(r))break}if(!Eb(r))throw new Error("Invalid signature: '".concat(r,"' at 0x").concat(t.toString(16)));var a=rb(e);pb(e,2),Nb(e,2,(function(t){var r=Am[a],n=1036===a&&!!e.skipThumbnail;if(r&&!n)try{r.read(e,d,t)}catch(r){if(e.throwForMissingFeatures)throw r;mb(e,t())}else mb(e,t())}))};t()>0;)r()}));var f=qm(d,["layersGroup","layerGroupsEnabledId"]);Object.keys(f)&&(u.imageResources=f),Nb(e,1,(function(t){if(Nb(e,2,(function(t){Sb(e,u,d),mb(e,t())}),void 0,e.large),t()>0){var r=function(e){return Nb(e,1,(function(t){if(t()){var r=rb(e),n=rb(e),i=rb(e),o=rb(e),a=rb(e),s=rb(e)/255,l=Qm(e);return mb(e,t()),{overlayColorSpace:r,colorSpace1:n,colorSpace2:i,colorSpace3:o,colorSpace4:a,opacity:s,kind:l}}}))}(e);r&&(u.globalLayerMaskInfo=r)}else mb(e,t());for(;t()>0;){for(;t()&&0===eb(e);)mb(e,1);t()>=12?Ob(e,u,u,d):mb(e,t())}}),void 0,e.large);var p=u.children&&u.children.length;return e.skipCompositeImageData&&(e.skipLayerImageData||p)||function(e,t){var r,n=rb(e),i=null!==(r=t.bitsPerChannel)&&void 0!==r?r:8;if(-1===Vm.indexOf(t.colorMode))throw new Error("Color mode not supported: ".concat(t.colorMode));if(0!==n&&1!==n)throw new Error("Compression type not supported: ".concat(n));var o=Mb(t.width,t.height,i);switch(ty(o),t.colorMode){case 0:if(1!==i)throw new Error("Invalid bitsPerChannel for bitmap color mode");var a=void 0;if(0===n)a=hb(e,Math.ceil(t.width/8)*t.height);else{if(1!==n)throw new Error("Bitmap compression not supported: ".concat(n));Db(e,{data:a=new Uint8Array(t.width*t.height),width:t.width,height:t.height},t.width,t.height,8,1,[0],e.large)}!function(e,t,r,n){if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("Invalid bit depth");for(var i=0,o=0,a=0;i<n;i++)for(var s=0;s<r;)for(var l=e[a++],c=0;c<8&&s<r;c++,s++,o+=4){var u=128&l?0:255;l<<=1,t[o+0]=u,t[o+1]=u,t[o+2]=u,t[o+3]=255}}(a,o.data,t.width,t.height);break;case 3:case 1:var s=1===t.colorMode?[0]:[0,1,2];if(t.channels&&t.channels>3)for(var l=3;l<t.channels;l++)s.push(l);else e.globalAlpha&&s.push(3);if(0===n)for(l=0;l<s.length;l++)Ib(e,o,t.width,t.height,i,4,s[l]);else 1===n&&(e.offset,Db(e,o,t.width,t.height,i,4,s,e.large));1===t.colorMode&&Zm(o);break;case 2:if(8!==i)throw new Error("bitsPerChannel Not supproted");if(1!==t.channels)throw new Error("Invalid channel count");if(!t.palette)throw new Error("Missing color palette");if(0===n)throw new Error("Not implemented");if(1!==n)throw new Error("Not implemented");var c={width:o.width,height:o.height,data:new Uint8Array(o.width*o.height)};Db(e,c,t.width,t.height,i,1,[0],e.large),function(e,t,r){for(var n=e.width*e.height,i=e.data,o=t.data,a=0,s=0;a<n;a++,s+=4){var l=r[i[a]];o[s+0]=l.r,o[s+1]=l.g,o[s+2]=l.b,o[s+3]=255}}(c,o,t.palette);break;case 4:if(8!==i)throw new Error("bitsPerChannel Not supproted");if(4!==t.channels)throw new Error("Invalid channel count");s=[0,1,2,3];if(e.globalAlpha&&s.push(4),0===n)throw new Error("Not implemented");if(1!==n)throw new Error("Not implemented");var u={width:o.width,height:o.height,data:new Uint8Array(o.width*o.height*5)};e.offset,Db(e,u,t.width,t.height,i,5,s,e.large),kb(u,o,!0);break;default:throw new Error("Color mode not supported: ".concat(t.colorMode))}if(e.globalAlpha){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");var h=o.data,d=o.width*o.height*4;for(l=0;l<d;l+=4){var f=h[l+3];if(0!=f&&255!=f){var p=1/(f/255),v=255*(1-p);h[l+0]=h[l+0]*p+v,h[l+1]=h[l+1]*p+v,h[l+2]=h[l+2]*p+v}}}e.useImageData?t.imageData=o:t.canvas=ry(o)}(e,u),u}function Sb(e,t,r){var n,i,o=r.layersGroup,a=void 0===o?[]:o,s=r.layerGroupsEnabledId,l=void 0===s?[]:s,c=tb(e);c<0&&(e.globalAlpha=!0,c=-c);for(var u=[],h=[],d=0;d<c;d++){var f=_b(e,t,r),p=f.layer,v=f.channels;void 0!==a[d]&&(p.linkGroup=a[d]),void 0!==l[d]&&(p.linkGroupEnabled=!!l[d]),u.push(p),h.push(v)}if(!e.skipLayerImageData)for(d=0;d<c;d++)Ab(e,t,u[d],h[d]);t.children||(t.children=[]);var y=[t];for(d=u.length-1;d>=0;d--){var g=u[d],m=g.sectionDivider?g.sectionDivider.type:0;1===m||2===m?(g.opened=1===m,g.children=[],(null===(n=g.sectionDivider)||void 0===n?void 0:n.key)&&(g.blendMode=null!==(i=jv[g.sectionDivider.key])&&void 0!==i?i:g.blendMode),y[y.length-1].children.unshift(g),y.push(g)):3===m?y.pop():y[y.length-1].children.unshift(g)}}function _b(e,t,r){var n={};n.top=ib(e),n.left=ib(e),n.bottom=ib(e),n.right=ib(e);for(var i=rb(e),o=[],a=0;a<i;a++){var s=tb(e),l=ab(e);if(e.large){if(0!==l)throw new Error("Sizes larger than 4GB are not supported");l=ab(e)}o.push({id:s,length:l})}bb(e,"8BIM");var c=db(e);if(!jv[c])throw new Error("Invalid blend mode: '".concat(c,"'"));n.blendMode=jv[c],n.opacity=Qm(e)/255,n.clipping=1===Qm(e);var u=Qm(e);return n.transparencyProtected=!!(1&u),n.hidden=!!(2&u),32&u&&(n.effectsOpen=!0),mb(e,1),Nb(e,1,(function(i){!function(e,t){Nb(e,1,(function(r){if(r()){var n={};t.mask=n,n.top=ib(e),n.left=ib(e),n.bottom=ib(e),n.right=ib(e),n.defaultColor=Qm(e);var i=Qm(e);if(n.positionRelativeToLayer=!!(1&i),n.disabled=!!(2&i),n.fromVectorData=!!(8&i),r()>=18){var o={};t.realMask=o;var a=Qm(e);o.positionRelativeToLayer=!!(1&a),o.disabled=!!(2&a),o.fromVectorData=!!(8&a),o.defaultColor=Qm(e),o.top=ib(e),o.left=ib(e),o.bottom=ib(e),o.right=ib(e)}if(16&i){var s=Qm(e);1&s&&(n.userMaskDensity=Qm(e)/255),2&s&&(n.userMaskFeather=lb(e)),4&s&&(n.vectorMaskDensity=Qm(e)/255),8&s&&(n.vectorMaskFeather=lb(e))}mb(e,r())}}))}(e,n);var o=function(e){return Nb(e,1,(function(t){for(var r=Cb(e),n=Cb(e),i=[];t()>0;){var o=Cb(e),a=Cb(e);i.push({sourceRange:o,destRange:a})}return{compositeGrayBlendSource:r,compositeGraphBlendDestinationRange:n,ranges:i}}))}(e);for(o&&(n.blendingRanges=o),n.name=pb(e,1);i()>4&&!fb(e,e.offset);)e.offset++;for(;i()>=12;)Ob(e,n,t,r);mb(e,i())})),{layer:n,channels:o}}function Cb(e){return[Qm(e),Qm(e),Qm(e),Qm(e)]}function Ab(e,t,r,n){var i,o,a,s,l,c=(r.right||0)-(r.left||0),u=(r.bottom||0)-(r.top||0),h=4===t.colorMode;if(c&&u)if(h){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");l={width:c,height:u,data:new Uint8ClampedArray(c*u*5)};for(var d=4;d<l.data.byteLength;d+=5)l.data[d]=255}else ty(l=Mb(c,u,null!==(i=t.bitsPerChannel)&&void 0!==i?i:8));for(var f=0,p=n;f<p.length;f++){var v=p[f];if(0!==v.length){if(v.length<2)throw new Error("Invalid channel length");var y=e.offset,g=rb(e);if(g>3&&(e.offset-=1,g=rb(e)),g>3&&(e.offset-=3,g=rb(e)),g>3)throw new Error("Invalid compression: ".concat(g));if(-2===v.id||-3===v.id){var m=-2===v.id?r.mask:r.realMask;if(!m)throw new Error("Missing layer ".concat(-2===v.id?"mask":"real mask"," data"));var b=(m.right||0)-(m.left||0),x=(m.bottom||0)-(m.top||0);if(b<0||x<0||b>3e4||x>3e4)throw new Error("Invalid mask size");if(b&&x){var E=Mb(b,x,null!==(o=t.bitsPerChannel)&&void 0!==o?o:8);ty(E),e.offset,Tb(e,v.length,E,g,b,x,null!==(a=t.bitsPerChannel)&&void 0!==a?a:8,0,e.large,4),Zm(E),e.useImageData?m.imageData=E:m.canvas=ry(E)}}else{var w=Qv(v.id,h),S=l;if(w<0&&(S=void 0,e.throwForMissingFeatures))throw new Error("Channel not supported: ".concat(v.id));Tb(e,v.length,S,g,c,u,null!==(s=t.bitsPerChannel)&&void 0!==s?s:8,w,e.large,h?5:4),e.offset=y+v.length,S&&1===t.colorMode&&Zm(S)}}}if(l){if(h){var _=l;kb(_,l=ay(_.width,_.height),!1)}e.useImageData?r.imageData=l:r.canvas=ry(l)}}function Tb(e,t,r,n,i,o,a,s,l,c){if(0===n)Ib(e,r,i,o,a,c,s);else if(1===n)Db(e,r,i,o,a,c,[s],l);else if(2===n)Fb(e,t,r,i,o,a,c,s,!1);else{if(3!==n)throw new Error("Invalid Compression type: ".concat(n));Fb(e,t,r,i,o,a,c,s,!0)}}function Ob(e,t,r,n){var i=db(e);if("8BIM"!==i&&"8B64"!==i)throw new Error("Invalid signature: '".concat(i,"' at 0x").concat((e.offset-4).toString(16)));var o=db(e),a="8B64"===i||e.large&&-1!==Jv.indexOf(o);Nb(e,2,(function(i){var a=Mx[o];if(a)try{a.read(e,t,i,r,n)}catch(t){if(e.throwForMissingFeatures)throw t}else e.logMissingFeatures&&e.log("Unhandled additional info: ".concat(o)),mb(e,i());i()&&(e.logMissingFeatures&&e.log("Unread ".concat(i()," bytes left for additional info: ").concat(o)),mb(e,i()))}),!1,a)}function Mb(e,t,r,n){if(void 0===n&&(n=4),1===r||8===r)return 4===n?ay(e,t):{width:e,height:t,data:new Uint8ClampedArray(e*t*n)};if(16===r)return{width:e,height:t,data:new Uint16Array(e*t*n)};if(32===r)return{width:e,height:t,data:new Float32Array(e*t*n)};throw new Error("Invalid bitDepth (".concat(r,")"))}function kb(e,t,r){for(var n=t.width*t.height*4,i=e.data,o=t.data,a=0,s=0;s<n;a+=5,s+=4){var l=i[a],c=i[a+1],u=i[a+2],h=i[a+3];o[s]=(l*h|0)/255|0,o[s+1]=(c*h|0)/255|0,o[s+2]=(u*h|0)/255|0,o[s+3]=r?255-i[a+4]:i[a+4]}}function Lb(e,t){if(8===t)return e;if(16===t){if(e.byteOffset%2){var r=new Uint16Array(e.byteLength/2);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(e),r}return new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2)}if(32===t){if(e.byteOffset%4){r=new Float32Array(e.byteLength/4);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(e),r}return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}throw new Error("Invalid bitDepth (".concat(t,")"))}function Rb(e,t,r,n){!function(e,t){if(e.byteLength/e.length!=t.byteLength/t.length)throw new Error("Invalid array types")}(e.data,t);for(var i=e.width*e.height,o=e.data,a=0,s=0|r;a<i;a++,s=s+n|0)o[s]=t[a]}function Ib(e,t,r,n,i,o,a){var s=hb(e,r*n*Math.floor(i/8));if(32==i)for(var l=0;l<s.byteLength;l+=4){var c=s[l+0],u=s[l+1],h=s[l+2],d=s[l+3];s[l+0]=d,s[l+1]=h,s[l+2]=u,s[l+3]=c}var f=Lb(s,i);t&&a<o&&Rb(t,f,a,o)}function Pb(e,t,r,n){for(var i=0;i<r;i++)for(var o=1,a=i*t+1;o<t;o++,a++)e[a]=(e[a-1]+e[a])%n}function Fb(e,t,r,n,i,o,a,s,l){var c=hb(e,t),u=Xv(c);if(r&&s<a){var h=Lb(u,o);if(8===o)l&&Pb(u,n,i,256),Rb(r,u,s,a);else if(16===o)l&&Pb(h,n,i,65536),Rb(r,h,s,a);else{if(32!==o)throw new Error("Invalid bitDepth");l&&Pb(u,4*n,i,256);for(var d=s,f=new Uint32Array(r.data.buffer,r.data.byteOffset,r.data.length),p=0;p<i;p++)for(var v=4*n*p,y=0;y<n;y++,v++,d+=a){var g=v+n,m=g+n,b=m+n;f[d]=(u[v]<<24|u[g]<<16|u[m]<<8|u[b])>>>0}}}}function Db(e,t,r,n,i,o,a,s){var l,c=t&&t.data;if(s){l=new Uint32Array(a.length*n);for(var u=0,h=0;u<a.length;u++)for(var d=0;d<n;d++,h++)l[h]=ab(e)}else{l=new Uint16Array(a.length*n);for(u=0,h=0;u<a.length;u++)for(d=0;d<n;d++,h++)l[h]=rb(e)}if(1!==i&&8!==i)throw new Error("Invalid bit depth (".concat(i,")"));var f=o-1|0,p=0;for(h=0;p<a.length;p++){var v=0|a[p];if(!c||(p>f||v>f))for(d=0;d<n;d++,h++)mb(e,l[h]);else{d=0;for(var y=0|v;d<n;d++,h++)for(var g=l[h],m=hb(e,g),b=0,x=0;b<g;b++){var E=m[b];if(E>128){var w=m[++b];E=256-E|0;for(var S=0;S<=E&&x<r;S=S+1|0,x=x+1|0)c[y]=w,y=y+o|0}else if(E<128)for(S=0;S<=E&&x<r;S=S+1|0,x=x+1|0)c[y]=m[++b],y=y+o|0}}}}function Nb(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!1);var o=ab(e);if(i){if(0!==o)throw new Error("Sizes larger than 4GB are not supported");o=ab(e)}if(!(o<=0&&n)){var a=e.offset+o;if(a>e.view.byteLength)throw new Error("Section exceeds file size");var s=r((function(){return a-e.offset}));for(e.offset!==a&&(e.offset>a?$m(e,"Exceeded section limits"):$m(e,"Unread section data"));a%t;)a++;return e.offset=a,s}}function Bb(e){switch(rb(e)){case 0:var t=rb(e)/257,r=rb(e)/257,n=rb(e)/257;return mb(e,2),{r:t,g:r,b:n};case 1:var i=rb(e)/65535,o=rb(e)/65535;n=rb(e)/65535;return mb(e,2),{h:i,s:o,b:n};case 2:return{c:rb(e)/257,m:rb(e)/257,y:rb(e)/257,k:u=rb(e)/257};case 7:var a=tb(e)/1e4,s=tb(e),l=tb(e),c=s<0?s/12800:s/12700;n=l<0?l/12800:l/12700;return mb(e,2),{l:a,a:c,b:n};case 8:var u=255*rb(e)/1e4;return mb(e,6),{k:u};default:throw new Error("Invalid color space")}}var Ub=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function zb(e){return bb(e,"8BIM"),jv[db(e)]||"normal"}function Gb(e,t){LE(e,"8BIM"),LE(e,Hv[t]||"norm")}function Xb(e){return Qm(e)/255}function Hb(e,t){mE(e,0|Math.round(255*t))}function jb(e,t){var r;_E(e,51),_E(e,2),TE(e,t.size&&t.size.value||0),TE(e,0),TE(e,t.angle||0),TE(e,t.distance&&t.distance.value||0),BE(e,t.color),Gb(e,t.blendMode),mE(e,t.enabled?1:0),mE(e,t.useGlobalLight?1:0),Hb(e,null!==(r=t.opacity)&&void 0!==r?r:1),BE(e,t.color)}function Wb(e){return 32===e||10===e||13===e||9===e}function Yb(e){return e>=48&&e<=57||46===e||45===e}function qb(e){var t=0;function r(){for(;t<e.length&&Wb(e[t]);)t++}function n(){var r=e[t];return t++,92===r&&(r=e[t],t++),r}function i(){var r="";if(41===e[t])return t++,r;if(254!==e[t]||255!==e[t+1])throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&41!==e[t];){var i=n()<<8|n();r+=String.fromCharCode(i)}return t++,r}var o=null,a=[];function s(e){a.length?(l(e),a.push(e)):(a.push(e),o=e)}function l(e){if(!a.length)throw new Error("Invalid data");var t=a[a.length-1];if("string"==typeof t)a[a.length-2][t]=e,u();else{if(!Array.isArray(t))throw new Error("Invalid data");t.push(e)}}function c(e){a.length||s({});var t=a[a.length-1];if(t&&"string"==typeof t)l("nil"===e?null:"/".concat(e));else{if(!t||"object"!=typeof t)throw new Error("Invalid data");a.push(e)}}function u(){if(!a.length)throw new Error("Invalid data");a.pop()}r();for(var h=e.length;h>0&&0===e[h-1];)h--;for(;t<h;){var d=t,f=e[d];if(60===f&&60===e[d+1])t+=2,s({});else if(62===f&&62===e[d+1])t+=2,u();else if(47===f){for(var p=t+=1;t<e.length&&!Wb(e[t]);)t++;for(var v="",y=p;y<t;y++)v+=String.fromCharCode(e[y]);c(v)}else if(40===f)t+=1,l(i());else if(91===f)t+=1,s([]);else if(93===f)t+=1,u();else if(110===f&&117===e[d+1]&&108===e[d+2]&&108===e[d+3])t+=4,l(null);else if(116===f&&114===e[d+1]&&117===e[d+2]&&101===e[d+3])t+=4,l(!0);else if(102===f&&97===e[d+1]&&108===e[d+2]&&115===e[d+3]&&101===e[d+4])t+=5,l(!1);else if(Yb(f)){for(var g="";t<e.length&&Yb(e[t]);)g+=String.fromCharCode(e[t]),t++;l(parseFloat(g))}else t+=1,console.log("Invalid token '".concat(String.fromCharCode(f),"' (").concat(f,") at ").concat(t));r()}return o}var Vb=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth","AutoLeading"],Kb=["RunLengthArray"];function Zb(e,t){void 0===t&&(t=!1);var r=new Uint8Array(1024),n=0,i=0;function o(e){if(n>=r.length){var t=new Uint8Array(2*r.length);t.set(r),r=t}r[n]=e,n++}function a(e){for(var t=0;t<e.length;t++)o(e.charCodeAt(t))}function s(){if(t)a(" ");else for(var e=0;e<i;e++)a("\t")}function l(e,r){s(),a("/".concat(e)),f(r,e,!0),t||a("\n")}function c(e){return e.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function u(e,t){return t&&-1!==Vb.indexOf(t)||(0|e)!==e?c(e):function(e){return e.toString()}(e)}function h(e){var t=Object.keys(e);return-1!==t.indexOf("98")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),-1!==t.indexOf("99")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),t}function d(e){40!==e&&41!==e&&92!==e||o(92),o(e)}function f(e,r,n){function p(){n?a(" "):s()}if(void 0===n&&(n=!1),null===e)p(),a(t?"/nil":"null");else if("number"==typeof e)p(),a(u(e,r));else if("boolean"==typeof e)p(),a(e?"true":"false");else if("string"==typeof e)if(p(),"99"!==r&&"98"!==r||"/"!==e.charAt(0)){a("("),o(254),o(255);for(var v=0;v<e.length;v++){var y=e.charCodeAt(v);d(y>>8&255),d(255&y)}a(")")}else a(e);else if(Array.isArray(e))if(p(),e.every((function(e){return"number"==typeof e}))){a("[");for(var g=-1!==Kb.indexOf(r),m=0,b=e;m<b.length;m++){var x=b[m];a(" "),a(g?u(x):c(x))}a(" ]")}else{a("["),t||a("\n");for(var E=0,w=e;E<w.length;E++){f(x=w[E],r),t||a("\n")}s(),a("]")}else if("object"==typeof e){n&&!t&&a("\n"),s(),a("<<"),t||a("\n"),i++;for(var S=0,_=h(e);S<_.length;S++){var C=_[S];l(C,e[C])}i--,s(),a(">>")}}if(t){if("object"==typeof e)for(var p=0,v=h(e);p<v.length;p++){var y=v[p];l(y,e[y])}}else a("\n\n"),f(e);return r.slice(0,n)}var Jb=function(){return Jb=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Jb.apply(this,arguments)},$b={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},Qb={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},ex={font:$b,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},tx={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},rx=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],nx=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],ix=["none","crisp","strong","smooth","sharp"],ox=["left","right","center","justify-left","justify-right","justify-center","justify-all"];function ax(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function sx(e){var t=e.Values;switch(e.Type){case 0:return{k:255*t[1]};case 1:return 1===t[0]?{r:255*t[1],g:255*t[2],b:255*t[3]}:{r:255*t[1],g:255*t[2],b:255*t[3],a:255*t[0]};case 2:return{c:255*t[1],m:255*t[2],y:255*t[3],k:255*t[4]};default:throw new Error("Unknown color type in text layer")}}function lx(e){if(e){if("r"in e)return{Type:1,Values:["a"in e?e.a/255:1,e.r/255,e.g/255,e.b/255]};if("c"in e)return{Type:2,Values:[1,e.c/255,e.m/255,e.y/255,e.k/255]};if("k"in e)return{Type:0,Values:[1,e.k/255]};throw new Error("Invalid color type in text layer")}return{Type:1,Values:[0,0,0,0]}}function cx(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ux(e,t){if(!e||!t)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){if(e[a=n[r]]!==t[a])return!1}for(var i=0,o=Object.keys(t);i<o.length;i++){var a;if(e[a=o[i]]!==t[a])return!1}return!0}function hx(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t.name)return r;return e.push(t),e.length-1}function dx(e,t,r){for(var n={},i=0,o=t;i<o.length;i++){var a=o[i],s=ax(a);void 0!==e[s]&&(n[a]="justification"===a?ox[e[s]]:"font"===a?r[e[s]]:"fillColor"===a||"strokeColor"===a?sx(e[s]):e[s])}return n}function fx(e,t,r){for(var n,i={},o=0,a=t;o<a.length;o++){var s=a[o],l=ax(s);void 0!==e[s]&&(i[l]="justification"===s?ox.indexOf(null!==(n=e[s])&&void 0!==n?n:"left"):"font"===s?hx(r,e[s]):"fillColor"===s||"strokeColor"===s?lx(e[s]):e[s])}return i}function px(e,t){return dx(e,rx,t)}function vx(e,t){return dx(e,nx,t)}function yx(e,t){return fx(e,rx,t)}function gx(e,t){return fx(e,nx,t)}function mx(e,t,r){if(t.length){for(var n=function(r){var n=t[0].style[r];if(void 0!==n){var i=!1;i=Array.isArray(n)?t.every((function(e){return cx(e.style[r],n)})):"object"==typeof n?t.every((function(e){return ux(e.style[r],n)})):t.every((function(e){return e.style[r]===n})),i&&(e[r]=n)}if(void 0!==e[r])for(var o=0,a=t;o<a.length;o++){var s=a[o];(Array.isArray(n)?cx(s.style[r],n):"object"==typeof n?ux(s.style[r],n):s.style[r]===n)&&delete s.style[r]}},i=0,o=r;i<o.length;i++){n(o[i])}t.every((function(e){return 0===Object.keys(e.style).length}))&&(t.length=0)}}function bx(e){var t,r,n,i,o,a,s,l,c,u,h,d,f="".concat((e.text||"").replace(/\r?\n/g,"\r"),"\r"),p=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],v=(null===(t=e.style)||void 0===t?void 0:t.font)||(null===(n=null===(r=e.styleRuns)||void 0===r?void 0:r.find((function(e){return e.style.font})))||void 0===n?void 0:n.style.font)||$b,y=[],g=[],m=e.paragraphStyleRuns;if(m&&m.length){for(var b=f.length,x=0,E=m;x<E.length;x++){var w=E[x];b-=R=Math.min(w.length,b),R&&(1===b&&w===m[m.length-1]&&(R++,b--),g.push(R),y.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:yx(Jb(Jb(Jb({},Qb),e.paragraphStyle),w.style),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}b&&(g.push(b),y.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:yx(Jb(Jb({},Qb),e.paragraphStyle),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}else for(var S=0,_=0;S<f.length;S++)13===f.charCodeAt(S)&&(g.push(S-_+1),y.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:yx(Jb(Jb({},Qb),e.paragraphStyle),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),_=S+1);for(var C=gx(Jb(Jb({},ex),{font:v}),p),A=e.styleRuns||[{length:f.length,style:e.style||{}}],T=[],O=[],M=f.length,k=0,L=A;k<L.length;k++){var R,I=L[k];M-=R=Math.min(I.length,M),R&&(1===M&&I===A[A.length-1]&&(R++,M--),O.push(R),T.push({StyleSheet:{StyleSheetData:gx(Jb(Jb({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),I.style),p)}}))}M&&A.length&&(O.push(M),T.push({StyleSheet:{StyleSheetData:gx(Jb({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),p)}}));var P=Jb(Jb({},tx),e.gridInfo),F="vertical"===e.orientation?2:0,D="vertical"===e.orientation?1:0,N="box"===e.shapeType?1:0,B={ShapeType:N};0===N?B.PointBase=e.pointBase||[0,0]:B.BoxBounds=e.boxBounds||[0,0,0,0],B.Base={ShapeType:N,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var U={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"、。，．・：；？！ー―’”）〕］｝〉》」』】ヽヾゝゞ々ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ゛゜?!)]},.:;℃℉¢％‰",NoEnd:"‘“（〔［｛〈《「『【([{￥＄£＠§〒＃",Keep:"―‥",Hanging:"、。.,"},{Name:"PhotoshopKinsokuSoft",NoStart:"、。，．・：；？！’”）〕］｝〉》」』】ヽヾゝゞ々",NoEnd:"‘“（〔［｛〈《「『【",Keep:"―‥",Hanging:"、。.,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:yx(Jb(Jb({},Qb),e.paragraphStyle),p)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:C}],FontSet:p.map((function(e){return{Name:e.name,Script:e.script||0,FontType:e.type||0,Synthetic:e.synthetic||0}})),SuperscriptSize:null!==(i=e.superscriptSize)&&void 0!==i?i:.583,SuperscriptPosition:null!==(o=e.superscriptPosition)&&void 0!==o?o:.333,SubscriptSize:null!==(a=e.subscriptSize)&&void 0!==a?a:.583,SubscriptPosition:null!==(s=e.subscriptPosition)&&void 0!==s?s:.333,SmallCapSize:null!==(l=e.smallCapSize)&&void 0!==l?l:.7};return{EngineDict:{Editor:{Text:f},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:y,RunLengthArray:g,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:T,RunLengthArray:O,IsJoinable:2},GridInfo:{GridIsOn:!!P.isOn,ShowGrid:!!P.show,GridSize:null!==(c=P.size)&&void 0!==c?c:18,GridLeading:null!==(u=P.leading)&&void 0!==u?u:22,GridColor:lx(P.color),GridLeadingFillColor:lx(P.color),AlignLineHeightToGridFlags:!!P.alignLineHeightToGridFlags},AntiAlias:ix.indexOf(null!==(h=e.antiAlias)&&void 0!==h?h:"sharp"),UseFractionalGlyphWidths:null===(d=e.useFractionalGlyphWidths)||void 0===d||d,Rendered:{Version:1,Shapes:{WritingDirection:F,Children:[{ShapeType:N,Procession:D,Lines:{WritingDirection:F,Children:[]},Cookie:{Photoshop:B}}]}}},ResourceDict:Jb({},U),DocumentResources:Jb({},U)}}var xx={0:{uproot:!0,children:{0:{name:"Type"},1:{name:"Values"}}}},Ex={0:{name:"Font"},1:{name:"FontSize"},2:{name:"FauxBold"},3:{name:"FauxItalic"},4:{name:"AutoLeading"},5:{name:"Leading"},6:{name:"HorizontalScale"},7:{name:"VerticalScale"},8:{name:"Tracking"},9:{name:"BaselineShift"},11:{name:"Kerning?"},12:{name:"FontCaps"},13:{name:"FontBaseline"},15:{name:"Strikethrough?"},16:{name:"Underline?"},18:{name:"Ligatures"},19:{name:"DLigatures"},23:{name:"Fractions"},24:{name:"Ordinals"},28:{name:"StylisticAlternates"},30:{name:"OldStyle?"},35:{name:"BaselineDirection"},38:{name:"Language"},52:{name:"NoBreak"},53:{name:"FillColor",children:xx},54:{name:"StrokeColor",children:xx},55:{children:{99:{uproot:!0}}},79:{children:xx}},wx={0:{name:"Justification"},1:{name:"FirstLineIndent"},2:{name:"StartIndent"},3:{name:"EndIndent"},4:{name:"SpaceBefore"},5:{name:"SpaceAfter"},7:{name:"AutoLeading"},9:{name:"AutoHyphenate"},10:{name:"HyphenatedWordSize"},11:{name:"PreHyphen"},12:{name:"PostHyphen"},13:{name:"ConsecutiveHyphens?"},14:{name:"Zone"},15:{name:"HypenateCapitalizedWords"},17:{name:"WordSpacing"},18:{name:"LetterSpacing"},19:{name:"GlyphSpacing"},32:{name:"StyleSheet",children:Ex}},Sx={name:"StyleSheetData",children:Ex},_x={0:{name:"ResourceDict",children:{1:{name:"FontSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},2:{name:"FontType"}}}}}}}}},2:{name:"2",children:{}},3:{name:"MojiKumiSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"InternalName"}}}}}}},4:{name:"KinsokuSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{uproot:!0,children:{0:{name:"NoStart"},1:{name:"NoEnd"},2:{name:"Keep"},3:{name:"Hanging"},4:{name:"Name"}}}}}}}}},5:{name:"StyleSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},6:Sx}}}}}},6:{name:"ParagraphSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{name:"Properties",children:wx},6:{name:"DefaultStyleSheet"}}}}}}},8:{name:"TextFrameSet",children:{0:{uproot:!0,children:{0:{name:"path",children:{0:{name:"name"},1:{name:"bezierCurve",children:{0:{name:"controlPoints"}}},2:{name:"data",children:{0:{name:"type"},1:{name:"orientation"},2:{name:"frameMatrix"},4:{name:"4"},6:{name:"textRange"},7:{name:"rowGutter"},8:{name:"columnGutter"},9:{name:"9"},10:{name:"baselineAlignment",children:{0:{name:"flag"},1:{name:"min"}}},11:{name:"pathData",children:{1:{name:"1"},0:{name:"reversed"},2:{name:"2"},3:{name:"3"},4:{name:"spacing"},5:{name:"5"},6:{name:"6"},7:{name:"7"},18:{name:"18"}}},12:{name:"12"},13:{name:"13"}}},3:{name:"3"},97:{name:"uuid"}}}}}}},9:{name:"Predefined",children:{0:{children:{0:{uproot:!0}}},1:{children:{0:{uproot:!0}}}}}}},1:{name:"EngineDict",children:{0:{name:"0",children:{3:{name:"SuperscriptSize"},4:{name:"SuperscriptPosition"},5:{name:"SubscriptSize"},6:{name:"SubscriptPosition"},7:{name:"SmallCapSize"},8:{name:"UseFractionalGlyphWidths"},15:{children:{0:{uproot:!0}}}}},1:{name:"Editors?",children:{0:{name:"Editor",children:{0:{name:"Text"},5:{name:"ParagraphRun",children:{0:{name:"RunArray",children:{0:{name:"ParagraphSheet",children:{0:{uproot:!0,children:{0:{name:"0"},5:{name:"5",children:wx},6:{name:"6"}}}}},1:{name:"RunLength"}}}}},6:{name:"StyleRun",children:{0:{name:"RunArray",children:{0:{name:"StyleSheet",children:{0:{uproot:!0,children:{6:Sx}}}},1:{name:"RunLength"}}}}}}},1:{name:"FontVectorData ???"}}},2:{name:"StyleSheet",children:Ex},3:{name:"ParagraphSheet",children:wx}}}};function Cx(e,t){var r,n;if(null===e)return e;if(Array.isArray(e))return e.map((function(e){return Cx(e,t)}));if("object"!=typeof e)return e;for(var i={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(t[s]){if(t[s].uproot){"99"!==s&&(i=Cx(e[s],null!==(r=t[s].children)&&void 0!==r?r:{})),e[99]&&(i._type=e[99]);break}i[t[s].name||s]=Cx(e[s],null!==(n=t[s].children)&&void 0!==n?n:{})}else"99"===s?i._type=e[s]:i[s]=Cx(e[s],{})}return i}function Ax(e){return Cx(e,_x)}var Tx=function(){return Tx=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Tx.apply(this,arguments)},Ox="abcdefghijklmnopqrstuvwxyz",Mx={};function kx(e,t,r,n){var i={key:e,has:t,read:r,write:n};Mx[i.key]=i}function Lx(e,t){Mx[e]=Mx[t]}function Rx(e){return function(t){return void 0!==t[e]}}function Ix(e){if(ab(e))throw new Error("Resource size above 4 GB limit at ".concat(e.offset.toString(16)));return ab(e)}function Px(e,t){_E(e,0),_E(e,t)}function Fx(e,t,r){var n=ub(e)*r,i=ub(e)*t,o=ub(e)*r,a=ub(e)*t,s=ub(e)*r;return[i,n,a,o,ub(e)*t,s]}function Dx(e,t,r,n){OE(e,t[1]/n),OE(e,t[0]/r),OE(e,t[3]/n),OE(e,t[2]/r),OE(e,t[5]/n),OE(e,t[4]/r)}kx("TySh",Rx("text"),(function(e,t,r){if(1!==tb(e))throw new Error("Invalid TySh version");for(var n=[],i=0;i<6;i++)n.push(lb(e));if(50!==tb(e))throw new Error("Invalid TySh text version");var o=Wy(e);if(1!==tb(e))throw new Error("Invalid TySh warp version");var a=Wy(e);if(t.text={transform:n,left:sb(e),top:sb(e),right:sb(e),bottom:sb(e),text:o["Txt "].replace(/\r/g,"\n"),index:o.TextIndex||0,gridding:Tg.decode(o.textGridding),antiAlias:Mg.decode(o.AntA),orientation:Og.decode(o.Ornt),warp:{style:kg.decode(a.warpStyle),value:a.warpValue||0,perspective:a.warpPerspective||0,perspectiveOther:a.warpPerspectiveOther||0,rotate:Og.decode(a.warpRotate)}},o.bounds&&(t.text.bounds=Ky(o.bounds)),o.boundingBox&&(t.text.boundingBox=Ky(o.boundingBox)),o.EngineData){var s=function(e){for(var t,r,n,i,o,a,s=e.EngineDict,l=e.ResourceDict,c=l.FontSet.map((function(e){return{name:e.Name,script:e.Script,type:e.FontType,synthetic:e.Synthetic}})),u=s.Editor.Text.replace(/\r/g,"\n"),h=0;/\n$/.test(u);)u=u.substring(0,u.length-1),h++;var d={text:u,antiAlias:null!==(t=ix[s.AntiAlias])&&void 0!==t?t:"smooth",useFractionalGlyphWidths:!!s.UseFractionalGlyphWidths,superscriptSize:l.SuperscriptSize,superscriptPosition:l.SuperscriptPosition,subscriptSize:l.SubscriptSize,subscriptPosition:l.SubscriptPosition,smallCapSize:l.SmallCapSize},f=null===(a=null===(o=null===(i=null===(n=null===(r=s.Rendered)||void 0===r?void 0:r.Shapes)||void 0===n?void 0:n.Children)||void 0===i?void 0:i[0])||void 0===o?void 0:o.Cookie)||void 0===a?void 0:a.Photoshop;f&&(d.shapeType=1===f.ShapeType?"box":"point",f.PointBase&&(d.pointBase=f.PointBase),f.BoxBounds&&(d.boxBounds=f.BoxBounds));var p=s.ParagraphRun;d.paragraphStyle={},d.paragraphStyleRuns=[];for(var v=0;v<p.RunArray.length;v++){var y=p.RunArray[v],g=p.RunLengthArray[v],m=px(y.ParagraphSheet.Properties,c);d.paragraphStyleRuns.push({length:g,style:m})}for(var b=h;d.paragraphStyleRuns.length&&b>0;b--)0==--d.paragraphStyleRuns[d.paragraphStyleRuns.length-1].length&&d.paragraphStyleRuns.pop();mx(d.paragraphStyle,d.paragraphStyleRuns,rx),d.paragraphStyleRuns.length||delete d.paragraphStyleRuns;var x=s.StyleRun;for(d.style={},d.styleRuns=[],v=0;v<x.RunArray.length;v++){var E=x.RunLengthArray[v];(m=vx(x.RunArray[v].StyleSheet.StyleSheetData,c)).font||(m.font=c[0]),d.styleRuns.push({length:E,style:m})}for(b=h;d.styleRuns.length&&b>0;b--)0==--d.styleRuns[d.styleRuns.length-1].length&&d.styleRuns.pop();return mx(d.style,d.styleRuns,nx),d.styleRuns.length||delete d.styleRuns,d}(qb(o.EngineData));t.text=Tx(Tx({},t.text),s)}mb(e,r())}),(function(e,t){var r=t.text,n=r.warp||{},i=r.transform||[1,0,0,1,0,0],o=Tx(Tx(Tx({"Txt ":(r.text||"").replace(/\r?\n/g,"\r"),textGridding:Tg.encode(r.gridding),Ornt:Og.encode(r.orientation),AntA:Mg.encode(r.antiAlias)},r.bounds?{bounds:Zy(r.bounds)}:{}),r.boundingBox?{boundingBox:Zy(r.boundingBox)}:{}),{TextIndex:r.index||0,EngineData:Zb(bx(r))});bE(e,1);for(var a=0;a<6;a++)AE(e,i[a]);bE(e,50),Yy(e,"","TxLr",o,"text"),bE(e,1),Yy(e,"","warp",Gx(n)),CE(e,r.left),CE(e,r.top),CE(e,r.right),CE(e,r.bottom)})),kx("SoCo",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"color"===e.vectorFill.type}),(function(e,t){var r=Wy(e);t.vectorFill=hg(r)}),(function(e,t){Yy(e,"","null",pg(t.vectorFill).descriptor)})),kx("GdFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&("solid"===e.vectorFill.type||"noise"===e.vectorFill.type)}),(function(e,t,r){var n=Wy(e);t.vectorFill=hg(n),mb(e,r())}),(function(e,t){Yy(e,"","null",pg(t.vectorFill).descriptor)})),kx("PtFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"pattern"===e.vectorFill.type}),(function(e,t){var r=Wy(e);t.vectorFill=hg(r)}),(function(e,t){Yy(e,"","null",pg(t.vectorFill).descriptor)})),kx("vscg",(function(e){return void 0!==e.vectorFill&&void 0!==e.vectorStroke}),(function(e,t,r){db(e);var n=Wy(e);t.vectorFill=hg(n),mb(e,r())}),(function(e,t){var r=pg(t.vectorFill),n=r.descriptor;LE(e,r.key),Yy(e,"","null",n)}));var Nx=["exclude","combine","subtract","intersect"];kx("vmsk",Rx("vectorMask"),(function(e,t,r,n){var i=n.width,o=n.height;if(3!==ab(e))throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var a=t.vectorMask,s=ab(e);a.invert=!!(1&s),a.notLink=!!(2&s),a.disable=!!(4&s),function(e,t,r,n,i){for(var o=e.offset+i,a=t.paths,s=void 0;o-e.offset>=26;){var l=rb(e);switch(l){case 0:case 3:rb(e);var c=tb(e),u=rb(e);mb(e,18),s={open:3===l,knots:[],fillRule:2===u?"non-zero":"even-odd"},-1!==c&&(s.operation=Nx[c]),a.push(s);break;case 1:case 2:case 4:case 5:s.knots.push({linked:1===l||4===l,points:Fx(e,r,n)});break;case 6:mb(e,24);break;case 7:var h=ub(e),d=ub(e),f=ub(e),p=ub(e),v=ub(e);mb(e,4),t.clipboard={top:h,left:d,bottom:f,right:p,resolution:v};break;case 8:t.fillStartsWithAllPixels=!!rb(e),mb(e,22);break;default:throw new Error("Invalid vmsk section")}}}(e,a,i,o,r()),mb(e,r())}),(function(e,t,r){var n=r.width,i=r.height,o=t.vectorMask,a=(o.invert?1:0)|(o.notLink?2:0)|(o.disable?4:0);_E(e,3),_E(e,a),xE(e,6),kE(e,24);var s=o.clipboard;s&&(xE(e,7),OE(e,s.top),OE(e,s.left),OE(e,s.bottom),OE(e,s.right),OE(e,s.resolution),kE(e,4)),void 0!==o.fillStartsWithAllPixels&&(xE(e,8),xE(e,o.fillStartsWithAllPixels?1:0),kE(e,22));for(var l=0,c=o.paths;l<c.length;l++){var u=c[l];xE(e,u.open?3:0),xE(e,u.knots.length),xE(e,u.operation?Nx.indexOf(u.operation):-1),xE(e,"non-zero"===u.fillRule?2:1),kE(e,18);for(var h=u.open?4:1,d=u.open?5:2,f=0,p=u.knots;f<p.length;f++){var v=p[f],y=v.linked,g=v.points;xE(e,y?h:d),Dx(e,g,n,i)}}})),Lx("vsms","vmsk"),kx("vowv",Rx("vowv"),(function(e,t){t.vowv=ab(e)}),(function(e,t){_E(e,t.vowv)})),kx("vogk",Rx("vectorOrigination"),(function(e,t,r){if(1!==ib(e))throw new Error("Invalid vogk version");var n=Wy(e);t.vectorOrigination={keyDescriptorList:[]};for(var i=0,o=n.keyDescriptorList;i<o.length;i++){var a=o[i],s={};null!=a.keyShapeInvalidated&&(s.keyShapeInvalidated=a.keyShapeInvalidated),null!=a.keyOriginType&&(s.keyOriginType=a.keyOriginType),null!=a.keyOriginResolution&&(s.keyOriginResolution=a.keyOriginResolution),a.keyOriginShapeBBox&&(s.keyOriginShapeBoundingBox={top:Eg(a.keyOriginShapeBBox["Top "]),left:Eg(a.keyOriginShapeBBox.Left),bottom:Eg(a.keyOriginShapeBBox.Btom),right:Eg(a.keyOriginShapeBBox.Rght)});var l=a.keyOriginRRectRadii;l&&(s.keyOriginRRectRadii={topRight:xg(l.topRight),topLeft:xg(l.topLeft),bottomLeft:xg(l.bottomLeft),bottomRight:xg(l.bottomRight)});var c=a.keyOriginBoxCorners;c&&(s.keyOriginBoxCorners=[{x:c.rectangleCornerA.Hrzn,y:c.rectangleCornerA.Vrtc},{x:c.rectangleCornerB.Hrzn,y:c.rectangleCornerB.Vrtc},{x:c.rectangleCornerC.Hrzn,y:c.rectangleCornerC.Vrtc},{x:c.rectangleCornerD.Hrzn,y:c.rectangleCornerD.Vrtc}]);var u=a.Trnf;u&&(s.transform=[u.xx,u.xy,u.xy,u.yy,u.tx,u.ty]),t.vectorOrigination.keyDescriptorList.push(s)}mb(e,r())}),(function(e,t){for(var r=t.vectorOrigination,n={keyDescriptorList:[]},i=0;i<r.keyDescriptorList.length;i++){var o=r.keyDescriptorList[i];n.keyDescriptorList.push({});var a=n.keyDescriptorList[n.keyDescriptorList.length-1];null!=o.keyOriginType&&(a.keyOriginType=o.keyOriginType),null!=o.keyOriginResolution&&(a.keyOriginResolution=o.keyOriginResolution);var s=o.keyOriginRRectRadii;s&&(a.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:Cg(s.topRight,"topRight"),topLeft:Cg(s.topLeft,"topLeft"),bottomLeft:Cg(s.bottomLeft,"bottomLeft"),bottomRight:Cg(s.bottomRight,"bottomRight")});var l=o.keyOriginShapeBoundingBox;l&&(a.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":Cg(l.top,"top"),Left:Cg(l.left,"left"),Btom:Cg(l.bottom,"bottom"),Rght:Cg(l.right,"right")});var c=o.keyOriginBoxCorners;c&&4===c.length&&(a.keyOriginBoxCorners={rectangleCornerA:{Hrzn:c[0].x,Vrtc:c[0].y},rectangleCornerB:{Hrzn:c[1].x,Vrtc:c[1].y},rectangleCornerC:{Hrzn:c[2].x,Vrtc:c[2].y},rectangleCornerD:{Hrzn:c[3].x,Vrtc:c[3].y}});var u=o.transform;u&&6===u.length&&(a.Trnf={xx:u[0],xy:u[1],yx:u[2],yy:u[3],tx:u[4],ty:u[5]}),null!=o.keyShapeInvalidated&&(a.keyShapeInvalidated=o.keyShapeInvalidated),a.keyOriginIndex=i}wE(e,1),Yy(e,"","null",n)})),kx("lmfx",(function(e){return void 0!==e.effects&&gE(e.effects)}),(function(e,t,r){if(0!==ab(e))throw new Error("Invalid lmfx version");var n=Wy(e);t.effects=eg(n,!!e.logMissingFeatures),mb(e,r())}),(function(e,t,r,n){var i=Qy(t.effects,!!n.logMissingFeatures,!0);_E(e,0),Yy(e,"","null",i)})),kx("lrFX",Rx("effects"),(function(e,t,r){t.effects||(t.effects=function(e){var t=rb(e);if(0!==t)throw new Error("Invalid effects layer version: ".concat(t));for(var r=rb(e),n={},i=0;i<r;i++){bb(e,"8BIM");var o=db(e);switch(o){case"cmnS":var a=ab(e),s=ab(e),l=!!Qm(e);if(mb(e,2),7!==a||0!==s||!l)throw new Error("Invalid effects common state");break;case"dsdw":case"isdw":var c=ab(e),u=ab(e);if(41!==c&&51!==c)throw new Error("Invalid shadow size: ".concat(c));if(0!==u&&2!==u)throw new Error("Invalid shadow version: ".concat(u));a=cb(e),cb(e);var h=cb(e),d=cb(e),f=Bb(e),p=zb(e),v=!!Qm(e),y=!!Qm(e),g=Xb(e);c>=51&&Bb(e);var m={size:{units:"Pixels",value:a},distance:{units:"Pixels",value:d},angle:h,color:f,blendMode:p,enabled:v,useGlobalLight:y,opacity:g};"dsdw"===o?n.dropShadow=[m]:n.innerShadow=[m];break;case"oglw":c=ab(e);var b=ab(e);if(32!==c&&42!==c)throw new Error("Invalid outer glow size: ".concat(c));if(0!==b&&2!==b)throw new Error("Invalid outer glow version: ".concat(b));a=cb(e),cb(e),f=Bb(e),p=zb(e),v=!!Qm(e),g=Xb(e),c>=42&&Bb(e),n.outerGlow={size:{units:"Pixels",value:a},color:f,blendMode:p,enabled:v,opacity:g};break;case"iglw":c=ab(e);var x=ab(e);if(32!==c&&43!==c)throw new Error("Invalid inner glow size: ".concat(c));if(0!==x&&2!==x)throw new Error("Invalid inner glow version: ".concat(x));a=cb(e),cb(e),f=Bb(e),p=zb(e),v=!!Qm(e),g=Xb(e),c>=43&&(Qm(e),Bb(e)),n.innerGlow={size:{units:"Pixels",value:a},color:f,blendMode:p,enabled:v,opacity:g};break;case"bevl":c=ab(e);var E=ab(e);if(58!==c&&78!==c)throw new Error("Invalid bevel size: ".concat(c));if(0!==E&&2!==E)throw new Error("Invalid bevel version: ".concat(E));h=cb(e);var w=cb(e),S=(a=cb(e),zb(e)),_=zb(e),C=Bb(e),A=Bb(e),T=Ub[Qm(e)]||"inner bevel",O=Xb(e),M=Xb(e),k=(v=!!Qm(e),y=!!Qm(e),Qm(e)?"down":"up");c>=78&&(Bb(e),Bb(e)),n.bevel={size:{units:"Pixels",value:a},angle:h,strength:w,highlightBlendMode:S,shadowBlendMode:_,highlightColor:C,shadowColor:A,style:T,highlightOpacity:O,shadowOpacity:M,enabled:v,useGlobalLight:y,direction:k};break;case"sofi":a=ab(e);var L=ab(e);if(34!==a)throw new Error("Invalid effects solid fill info size: ".concat(a));if(2!==L)throw new Error("Invalid effects solid fill info version: ".concat(L));p=zb(e),f=Bb(e),g=Xb(e),v=!!Qm(e),Bb(e),n.solidFill=[{blendMode:p,color:f,opacity:g,enabled:v}];break;default:throw new Error("Invalid effect type: '".concat(o,"'"))}}return n}(e)),mb(e,r())}),(function(e,t){!function(e,t){var r,n,i,o,a,s,l=null===(r=t.dropShadow)||void 0===r?void 0:r[0],c=null===(n=t.innerShadow)||void 0===n?void 0:n[0],u=t.outerGlow,h=t.innerGlow,d=t.bevel,f=null===(i=t.solidFill)||void 0===i?void 0:i[0],p=1;if(l&&p++,c&&p++,u&&p++,h&&p++,d&&p++,f&&p++,xE(e,0),xE(e,p),LE(e,"8BIM"),LE(e,"cmnS"),_E(e,7),_E(e,0),mE(e,1),kE(e,2),l&&(LE(e,"8BIM"),LE(e,"dsdw"),jb(e,l)),c&&(LE(e,"8BIM"),LE(e,"isdw"),jb(e,c)),u&&(LE(e,"8BIM"),LE(e,"oglw"),_E(e,42),_E(e,2),TE(e,(null===(o=u.size)||void 0===o?void 0:o.value)||0),TE(e,0),BE(e,u.color),Gb(e,u.blendMode),mE(e,u.enabled?1:0),Hb(e,u.opacity||0),BE(e,u.color)),h&&(LE(e,"8BIM"),LE(e,"iglw"),_E(e,43),_E(e,2),TE(e,(null===(a=h.size)||void 0===a?void 0:a.value)||0),TE(e,0),BE(e,h.color),Gb(e,h.blendMode),mE(e,h.enabled?1:0),Hb(e,h.opacity||0),mE(e,0),BE(e,h.color)),d){LE(e,"8BIM"),LE(e,"bevl"),_E(e,78),_E(e,2),TE(e,d.angle||0),TE(e,d.strength||0),TE(e,(null===(s=d.size)||void 0===s?void 0:s.value)||0),Gb(e,d.highlightBlendMode),Gb(e,d.shadowBlendMode),BE(e,d.highlightColor),BE(e,d.shadowColor);var v=Ub.indexOf(d.style);mE(e,v<=0?1:v),Hb(e,d.highlightOpacity||0),Hb(e,d.shadowOpacity||0),mE(e,d.enabled?1:0),mE(e,d.useGlobalLight?1:0),mE(e,"down"===d.direction?1:0),BE(e,d.highlightColor),BE(e,d.shadowColor)}f&&(LE(e,"8BIM"),LE(e,"sofi"),_E(e,34),_E(e,2),Gb(e,f.blendMode),BE(e,f.color),Hb(e,f.opacity||0),mE(e,f.enabled?1:0),BE(e,f.color))}(e,t.effects)})),kx("luni",Rx("name"),(function(e,t,r){if(r()>4){var n=ab(e);r()>=2*n?t.name=yb(e,n):e.logDevFeatures&&e.log("name in luni section is too long")}else e.logDevFeatures&&e.log("empty luni section");mb(e,r())}),(function(e,t){IE(e,t.name)})),kx("lnsr",Rx("nameSource"),(function(e,t){return t.nameSource=db(e)}),(function(e,t){return LE(e,t.nameSource)})),kx("lyid",Rx("id"),(function(e,t){t.id=ab(e)}),(function(e,t,r,n){for(var i=t.id;n.layerIds.has(i);)i+=100;_E(e,i),n.layerIds.add(i),n.layerToId.set(t,i)})),kx("lsct",Rx("sectionDivider"),(function(e,t,r){t.sectionDivider={type:ab(e)},r()&&(bb(e,"8BIM"),t.sectionDivider.key=db(e)),r()&&(t.sectionDivider.subType=ab(e))}),(function(e,t){_E(e,t.sectionDivider.type),t.sectionDivider.key&&(LE(e,"8BIM"),LE(e,t.sectionDivider.key),void 0!==t.sectionDivider.subType&&_E(e,t.sectionDivider.subType))})),Lx("lsdk","lsct"),kx("clbl",Rx("blendClippendElements"),(function(e,t){t.blendClippendElements=!!Qm(e),mb(e,3)}),(function(e,t){mE(e,t.blendClippendElements?1:0),kE(e,3)})),kx("infx",Rx("blendInteriorElements"),(function(e,t){t.blendInteriorElements=!!Qm(e),mb(e,3)}),(function(e,t){mE(e,t.blendInteriorElements?1:0),kE(e,3)})),kx("knko",Rx("knockout"),(function(e,t){t.knockout=!!Qm(e),mb(e,3)}),(function(e,t){mE(e,t.knockout?1:0),kE(e,3)})),kx("lmgm",Rx("layerMaskAsGlobalMask"),(function(e,t){t.layerMaskAsGlobalMask=!!Qm(e),mb(e,3)}),(function(e,t){mE(e,t.layerMaskAsGlobalMask?1:0),kE(e,3)})),kx("lspf",Rx("protected"),(function(e,t){var r=ab(e);t.protected={transparency:!!(1&r),composite:!!(2&r),position:!!(4&r)},8&r&&(t.protected.artboards=!0)}),(function(e,t){_E(e,(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0))})),kx("lclr",Rx("layerColor"),(function(e,t){var r=rb(e);mb(e,6),t.layerColor=Zv[r]}),(function(e,t){var r=Zv.indexOf(t.layerColor);xE(e,-1===r?0:r),kE(e,6)})),kx("shmd",(function(e){return void 0!==e.timestamp||void 0!==e.animationFrames||void 0!==e.animationFrameFlags||void 0!==e.timeline||void 0!==e.comps}),(function(e,t,r){for(var n=ab(e),i=function(r){bb(e,"8BIM");var n=db(e);Qm(e),mb(e,3),Nb(e,1,(function(r){if("cust"===n)void 0!==(i=Wy(e)).layerTime&&(t.timestamp=i.layerTime);else if("mlst"===n){var i=Wy(e);t.animationFrames=[];for(var o=0;o<i.LaSt.length;o++){var a=i.LaSt[o],s={frames:a.FrLs};void 0!==a.enab&&(s.enable=a.enab),a.Ofst&&(s.offset=qy(a.Ofst)),a.FXRf&&(s.referencePoint=qy(a.FXRf)),a.Lefx&&(s.effects=eg(a.Lefx,!!e.logMissingFeatures)),a.blendOptions&&a.blendOptions.Opct&&(s.opacity=mg(a.blendOptions.Opct)),t.animationFrames.push(s)}}else if("mdyn"===n){rb(e);var l=Qm(e),c=Qm(e);t.animationFrameFlags={propagateFrameOne:!l,unifyLayerPosition:!!(1&c),unifyLayerStyle:!!(2&c),unifyLayerVisibility:!!(4&c)}}else if("tmln"===n){var u=(i=Wy(e)).timeScope,h={start:Ag(u.Strt),duration:Ag(u.duration),inTime:Ag(u.inTime),outTime:Ag(u.outTime),autoScope:i.autoScope,audioLevel:i.audioLevel};i.trackList&&(h.tracks=ng(i.trackList,!!e.logMissingFeatures)),t.timeline=h}else if("cmls"===n){i=Wy(e);t.comps={settings:[]},i.origFXRefPoint&&(t.comps.originalEffectsReferencePoint={x:i.origFXRefPoint.Hrzn,y:i.origFXRefPoint.Vrtc});for(var d=0,f=i.layerSettings;d<f.length;d++){var p=f[d];t.comps.settings.push({compList:p.compList});var v=t.comps.settings[t.comps.settings.length-1];"enab"in p&&(v.enabled=p.enab),p.Ofst&&(v.offset={x:p.Ofst.Hrzn,y:p.Ofst.Vrtc}),p.FXRefPoint&&(v.effectsReferencePoint={x:p.FXRefPoint.Hrzn,y:p.FXRefPoint.Vrtc})}}else if("extn"===n){i=Wy(e);e.logMissingFeatures&&e.log('Unhandled "shmd" section key',n)}else e.logMissingFeatures&&e.log('Unhandled "shmd" section key',n);mb(e,r())}))},o=0;o<n;o++)i();mb(e,r())}),(function(e,t,r,n){var i=t.animationFrames,o=t.animationFrameFlags,a=t.timestamp,s=t.timeline,l=t.comps,c=0;i&&c++,o&&c++,s&&c++,void 0!==a&&c++,l&&c++,_E(e,c),i&&(LE(e,"8BIM"),LE(e,"mlst"),mE(e,0),kE(e,3),FE(e,2,(function(){for(var r,n={LaID:null!==(r=t.id)&&void 0!==r?r:0,LaSt:[]},o=0;o<i.length;o++){var a=i[o],s={};void 0!==a.enable&&(s.enab=a.enable),s.FrLs=a.frames,a.offset&&(s.Ofst=Vy(a.offset)),a.referencePoint&&(s.FXRf=Vy(a.referencePoint)),a.effects&&(s.Lefx=Qy(a.effects,!1,!1)),void 0!==a.opacity&&(s.blendOptions={Opct:Sg(a.opacity)}),n.LaSt.push(s)}Yy(e,"","null",n)}),!0)),o&&(LE(e,"8BIM"),LE(e,"mdyn"),mE(e,0),kE(e,3),FE(e,2,(function(){xE(e,0),mE(e,o.propagateFrameOne?0:15),mE(e,(o.unifyLayerPosition?1:0)|(o.unifyLayerStyle?2:0)|(o.unifyLayerVisibility?4:0))}))),s&&(LE(e,"8BIM"),LE(e,"tmln"),mE(e,0),kE(e,3),FE(e,2,(function(){var r={Vrsn:1,timeScope:{Vrsn:1,Strt:s.start,duration:s.duration,inTime:s.inTime,outTime:s.outTime},autoScope:s.autoScope,audioLevel:s.audioLevel};s.tracks&&(r.trackList=ig(s.tracks));var i=n.layerToId.get(t)||t.id;if(!i)throw new Error("You need to provide layer.id value whan writing document with animations");r.LyrI=i,Yy(e,"","null",r,"anim")}),!0)),void 0!==a&&(LE(e,"8BIM"),LE(e,"cust"),mE(e,0),kE(e,3),FE(e,2,(function(){Yy(e,"","metadata",{layerTime:a})}),!0)),l&&(LE(e,"8BIM"),LE(e,"cmls"),mE(e,0),kE(e,3),FE(e,2,(function(){var r=n.layerToId.get(t)||t.id;if(!r)throw new Error("You need to provide layer.id value whan writing document with layer comps");var i={};l.originalEffectsReferencePoint&&(i.origFXRefPoint={Hrzn:l.originalEffectsReferencePoint.x,Vrtc:l.originalEffectsReferencePoint.y}),i.LyrI=r,i.layerSettings=[];for(var o=0,a=l.settings;o<a.length;o++){var s=a[o],c={};void 0!==s.enabled&&(c.enab=s.enabled),s.offset&&(c.Ofst={Hrzn:s.offset.x,Vrtc:s.offset.y}),s.effectsReferencePoint&&(c.FXRefPoint={Hrzn:s.effectsReferencePoint.x,Vrtc:s.effectsReferencePoint.y}),c.compList=s.compList,i.layerSettings.push(c)}Yy(e,"","null",i)}),!0))})),kx("vstk",Rx("vectorStroke"),(function(e,t,r){var n=Wy(e);t.vectorStroke={strokeEnabled:n.strokeEnabled,fillEnabled:n.fillEnabled,lineWidth:xg(n.strokeStyleLineWidth),lineDashOffset:xg(n.strokeStyleLineDashOffset),miterLimit:n.strokeStyleMiterLimit,lineCapType:Kg.decode(n.strokeStyleLineCapType),lineJoinType:Zg.decode(n.strokeStyleLineJoinType),lineAlignment:Jg.decode(n.strokeStyleLineAlignment),scaleLock:n.strokeStyleScaleLock,strokeAdjust:n.strokeStyleStrokeAdjust,lineDashSet:n.strokeStyleLineDashSet.map(xg),blendMode:Lg.decode(n.strokeStyleBlendMode),opacity:mg(n.strokeStyleOpacity),content:hg(n.strokeStyleContent),resolution:n.strokeStyleResolution},mb(e,r())}),(function(e,t){var r,n,i,o=t.vectorStroke;Yy(e,"","strokeStyle",{strokeStyleVersion:2,strokeEnabled:!!o.strokeEnabled,fillEnabled:!!o.fillEnabled,strokeStyleLineWidth:o.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:o.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:null!==(r=o.miterLimit)&&void 0!==r?r:100,strokeStyleLineCapType:Kg.encode(o.lineCapType),strokeStyleLineJoinType:Zg.encode(o.lineJoinType),strokeStyleLineAlignment:Jg.encode(o.lineAlignment),strokeStyleScaleLock:!!o.scaleLock,strokeStyleStrokeAdjust:!!o.strokeAdjust,strokeStyleLineDashSet:o.lineDashSet||[],strokeStyleBlendMode:Lg.encode(o.blendMode),strokeStyleOpacity:Sg(null!==(n=o.opacity)&&void 0!==n?n:1),strokeStyleContent:pg(o.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:null!==(i=o.resolution)&&void 0!==i?i:72})})),kx("artb",Rx("artboard"),(function(e,t,r){var n=Wy(e),i=n.artboardRect;t.artboard={rect:{top:i["Top "],left:i.Left,bottom:i.Btom,right:i.Rght},guideIndices:n.guideIndeces,presetName:n.artboardPresetName,color:vg(n["Clr "]),backgroundType:n.artboardBackgroundType},mb(e,r())}),(function(e,t){var r,n=t.artboard,i=n.rect;Yy(e,"","artboard",{artboardRect:{"Top ":i.top,Left:i.left,Btom:i.bottom,Rght:i.right},guideIndeces:n.guideIndices||[],artboardPresetName:n.presetName||"","Clr ":yg(n.color),artboardBackgroundType:null!==(r=n.backgroundType)&&void 0!==r?r:1})})),kx("sn2P",Rx("usingAlignedRendering"),(function(e,t){return t.usingAlignedRendering=!!ab(e)}),(function(e,t){return _E(e,t.usingAlignedRendering?1:0)}));var Bx=["unknown","vector","raster","image stack"];function Ux(e){var t,r,n,i,o,a,s=Tx(Tx({style:kg.decode(e.warpStyle)},e.warpValues?{values:e.warpValues}:{value:e.warpValue||0}),{perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:Og.decode(e.warpRotate),bounds:e.bounds&&{top:Eg(e.bounds["Top "]),left:Eg(e.bounds.Left),bottom:Eg(e.bounds.Btom),right:Eg(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder});null==e.deformNumRows&&null==e.deformNumCols||(s.deformNumRows=e.deformNumRows,s.deformNumCols=e.deformNumCols);var l=e.customEnvelopeWarp;if(l){s.customEnvelopeWarp={meshPoints:[]};for(var c=(null===(t=l.meshPoints.find((function(e){return"Hrzn"===e.type})))||void 0===t?void 0:t.values)||[],u=(null===(r=l.meshPoints.find((function(e){return"Vrtc"===e.type})))||void 0===r?void 0:r.values)||[],h=0;h<c.length;h++)s.customEnvelopeWarp.meshPoints.push({x:c[h],y:u[h]});(l.quiltSliceX||l.quiltSliceY)&&(s.customEnvelopeWarp.quiltSliceX=(null===(i=null===(n=l.quiltSliceX)||void 0===n?void 0:n[0])||void 0===i?void 0:i.values)||[],s.customEnvelopeWarp.quiltSliceY=(null===(a=null===(o=l.quiltSliceY)||void 0===o?void 0:o[0])||void 0===a?void 0:a.values)||[])}return s}function zx(e){var t,r;return null!=e.deformNumCols||null!=e.deformNumRows||(null===(t=e.customEnvelopeWarp)||void 0===t?void 0:t.quiltSliceX)||(null===(r=e.customEnvelopeWarp)||void 0===r?void 0:r.quiltSliceY)}function Gx(e){var t=e.bounds,r=Tx(Tx({warpStyle:kg.encode(e.style)},e.values?{warpValues:e.values}:{warpValue:e.value||0}),{warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:Og.encode(e.rotate),bounds:{"Top ":Cg(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:Cg(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:Cg(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:Cg(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0}),n=zx(e);n&&((o=r).deformNumRows=e.deformNumRows||0,o.deformNumCols=e.deformNumCols||0);var i=e.customEnvelopeWarp;if(i){var o,a=i.meshPoints||[];if(n)(o=r).customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",quiltSliceX:[{type:"quiltSliceX",values:i.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:i.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:a.map((function(e){return e.x}))},{type:"Vrtc",values:a.map((function(e){return e.y}))}]};else r.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",meshPoints:[{type:"Hrzn",values:a.map((function(e){return e.x}))},{type:"Vrtc",values:a.map((function(e){return e.y}))}]}}return r}function Xx(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function Hx(e){for(var t=[],r=0;r<e.length;r+=2)t.push({x:e[r],y:e[r+1]});return t}function jx(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].x,e[r].y);return t}function Wx(e){return Hx(function(e){return new Float32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}(e))}function Yx(e){return{x:xg(e.Hrzn),y:xg(e.Vrtc)}}function qx(e){return{_name:"",_classID:"Pnt ",Hrzn:Cg(e.x,"x"),Vrtc:Cg(e.y,"y")}}function Vx(e,t){return{enabled:e.enab,validAtPosition:e.validAtPosition,maskEnabled:e.filterMaskEnable,maskLinked:e.filterMaskLinked,maskExtendWithWhite:e.filterMaskExtendWithWhite,list:e.filterFXList.map((function(e){return function(e,t){var r={name:e["Nm  "],opacity:mg(e.blendOptions.Opct),blendMode:Lg.decode(e.blendOptions["Md  "]),enabled:e.enab,hasOptions:e.hasoptions,foregroundColor:vg(e.FrgC),backgroundColor:vg(e.BckC)};if("Fltr"in e)switch(e.Fltr._classID){case"boxblur":return Tx(Tx({},r),{type:"box blur",filter:{radius:xg(e.Fltr["Rds "])}});case"GsnB":return Tx(Tx({},r),{type:"gaussian blur",filter:{radius:xg(e.Fltr["Rds "])}});case"MtnB":return Tx(Tx({},r),{type:"motion blur",filter:{angle:e.Fltr.Angl,distance:xg(e.Fltr.Dstn)}});case"RdlB":return Tx(Tx({},r),{type:"radial blur",filter:{amount:e.Fltr.Amnt,method:$g.decode(e.Fltr.BlrM),quality:Qg.decode(e.Fltr.BlrQ)}});case"shapeBlur":return Tx(Tx({},r),{type:"shape blur",filter:{radius:xg(e.Fltr["Rds "]),customShape:{name:e.Fltr.customShape["Nm  "],id:e.Fltr.customShape.Idnt}}});case"SmrB":return Tx(Tx({},r),{type:"smart blur",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh,quality:tm.decode(e.Fltr.SmBQ),mode:em.decode(e.Fltr.SmBM)}});case"surfaceBlur":return Tx(Tx({},r),{type:"surface blur",filter:{radius:xg(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dspl":return Tx(Tx({},r),{type:"displace",filter:{horizontalScale:e.Fltr.HrzS,verticalScale:e.Fltr.VrtS,displacementMap:rm.decode(e.Fltr.DspM),undefinedAreas:nm.decode(e.Fltr.UndA),displacementFile:{signature:e.Fltr.DspF.sig,path:e.Fltr.DspF.path}}});case"Pnch":return Tx(Tx({},r),{type:"pinch",filter:{amount:e.Fltr.Amnt}});case"Plr ":return Tx(Tx({},r),{type:"polar coordinates",filter:{conversion:im.decode(e.Fltr.Cnvr)}});case"Rple":return Tx(Tx({},r),{type:"ripple",filter:{amount:e.Fltr.Amnt,size:om.decode(e.Fltr.RplS)}});case"Shr ":return Tx(Tx({},r),{type:"shear",filter:{shearPoints:e.Fltr.ShrP.map((function(e){return{x:e.Hrzn,y:e.Vrtc}})),shearStart:e.Fltr.ShrS,shearEnd:e.Fltr.ShrE,undefinedAreas:nm.decode(e.Fltr.UndA)}});case"Sphr":return Tx(Tx({},r),{type:"spherize",filter:{amount:e.Fltr.Amnt,mode:am.decode(e.Fltr.SphM)}});case"Twrl":return Tx(Tx({},r),{type:"twirl",filter:{angle:e.Fltr.Angl}});case"Wave":return Tx(Tx({},r),{type:"wave",filter:{numberOfGenerators:e.Fltr.NmbG,type:sm.decode(e.Fltr.Wvtp),wavelength:{min:e.Fltr.WLMn,max:e.Fltr.WLMx},amplitude:{min:e.Fltr.AmMn,max:e.Fltr.AmMx},scale:{x:e.Fltr.SclH,y:e.Fltr.SclV},randomSeed:e.Fltr.RndS,undefinedAreas:nm.decode(e.Fltr.UndA)}});case"ZgZg":return Tx(Tx({},r),{type:"zigzag",filter:{amount:e.Fltr.Amnt,ridges:e.Fltr.NmbR,style:lm.decode(e.Fltr.ZZTy)}});case"AdNs":return Tx(Tx({},r),{type:"add noise",filter:{amount:mg(e.Fltr.Nose),distribution:cm.decode(e.Fltr.Dstr),monochromatic:e.Fltr.Mnch,randomSeed:e.Fltr.FlRs}});case"DstS":return Tx(Tx({},r),{type:"dust and scratches",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh}});case"Mdn ":return Tx(Tx({},r),{type:"median",filter:{radius:xg(e.Fltr["Rds "])}});case"denoise":return Tx(Tx({},r),{type:"reduce noise",filter:{preset:e.Fltr.preset,removeJpegArtifact:e.Fltr.removeJPEGArtifact,reduceColorNoise:mg(e.Fltr.ClNs),sharpenDetails:mg(e.Fltr.Shrp),channelDenoise:e.Fltr.channelDenoise.map((function(e){return Tx({channels:e.Chnl.map((function(e){return um.decode(e)})),amount:e.Amnt},e.EdgF?{preserveDetails:e.EdgF}:{})}))}});case"ClrH":return Tx(Tx({},r),{type:"color halftone",filter:{radius:e.Fltr["Rds "],angle1:e.Fltr.Ang1,angle2:e.Fltr.Ang2,angle3:e.Fltr.Ang3,angle4:e.Fltr.Ang4}});case"Crst":return Tx(Tx({},r),{type:"crystallize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Mztn":return Tx(Tx({},r),{type:"mezzotint",filter:{type:hm.decode(e.Fltr.MztT),randomSeed:e.Fltr.FlRs}});case"Msc ":return Tx(Tx({},r),{type:"mosaic",filter:{cellSize:xg(e.Fltr.ClSz)}});case"Pntl":return Tx(Tx({},r),{type:"pointillize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Clds":return Tx(Tx({},r),{type:"clouds",filter:{randomSeed:e.Fltr.FlRs}});case"DfrC":return Tx(Tx({},r),{type:"difference clouds",filter:{randomSeed:e.Fltr.FlRs}});case"Fbrs":return Tx(Tx({},r),{type:"fibers",filter:{variance:e.Fltr.Vrnc,strength:e.Fltr.Strg,randomSeed:e.Fltr.RndS}});case"LnsF":return Tx(Tx({},r),{type:"lens flare",filter:{brightness:e.Fltr.Brgh,position:{x:e.Fltr.FlrC.Hrzn,y:e.Fltr.FlrC.Vrtc},lensType:dm.decode(e.Fltr["Lns "])}});case"smartSharpen":return Tx(Tx({},r),{type:"smart sharpen",filter:{amount:mg(e.Fltr.Amnt),radius:xg(e.Fltr["Rds "]),threshold:e.Fltr.Thsh,angle:e.Fltr.Angl,moreAccurate:e.Fltr.moreAccurate,blur:fm.decode(e.Fltr.blur),preset:e.Fltr.preset,shadow:{fadeAmount:mg(e.Fltr.sdwM.Amnt),tonalWidth:mg(e.Fltr.sdwM.Wdth),radius:e.Fltr.sdwM["Rds "]},highlight:{fadeAmount:mg(e.Fltr.hglM.Amnt),tonalWidth:mg(e.Fltr.hglM.Wdth),radius:e.Fltr.hglM["Rds "]}}});case"UnsM":return Tx(Tx({},r),{type:"unsharp mask",filter:{amount:mg(e.Fltr.Amnt),radius:xg(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dfs ":return Tx(Tx({},r),{type:"diffuse",filter:{mode:pm.decode(e.Fltr["Md  "]),randomSeed:e.Fltr.FlRs}});case"Embs":return Tx(Tx({},r),{type:"emboss",filter:{angle:e.Fltr.Angl,height:e.Fltr.Hght,amount:e.Fltr.Amnt}});case"Extr":return Tx(Tx({},r),{type:"extrude",filter:{type:vm.decode(e.Fltr.ExtT),size:e.Fltr.ExtS,depth:e.Fltr.ExtD,depthMode:ym.decode(e.Fltr.ExtR),randomSeed:e.Fltr.FlRs,solidFrontFaces:e.Fltr.ExtF,maskIncompleteBlocks:e.Fltr.ExtM}});case"Tls ":return Tx(Tx({},r),{type:"tiles",filter:{numberOfTiles:e.Fltr.TlNm,maximumOffset:e.Fltr.TlOf,fillEmptyAreaWith:gm.decode(e.Fltr.FlCl),randomSeed:e.Fltr.FlRs}});case"TrcC":return Tx(Tx({},r),{type:"trace contour",filter:{level:e.Fltr["Lvl "],edge:mm.decode(e.Fltr["Edg "])}});case"Wnd ":return Tx(Tx({},r),{type:"wind",filter:{method:bm.decode(e.Fltr.WndM),direction:xm.decode(e.Fltr.Drct)}});case"Dntr":return Tx(Tx({},r),{type:"de-interlace",filter:{eliminate:Em.decode(e.Fltr.IntE),newFieldsBy:wm.decode(e.Fltr.IntC)}});case"Cstm":return Tx(Tx({},r),{type:"custom",filter:{scale:e.Fltr["Scl "],offset:e.Fltr.Ofst,matrix:e.Fltr.Mtrx}});case"HghP":return Tx(Tx({},r),{type:"high pass",filter:{radius:xg(e.Fltr["Rds "])}});case"Mxm ":return Tx(Tx({},r),{type:"maximum",filter:{radius:xg(e.Fltr["Rds "])}});case"Mnm ":return Tx(Tx({},r),{type:"minimum",filter:{radius:xg(e.Fltr["Rds "])}});case"Ofst":return Tx(Tx({},r),{type:"offset",filter:{horizontal:e.Fltr.Hrzn,vertical:e.Fltr.Vrtc,undefinedAreas:Sm.decode(e.Fltr["Fl  "])}});case"rigidTransform":return Tx(Tx({},r),{type:"puppet",filter:{rigidType:e.Fltr.rigidType,bounds:[{x:e.Fltr.PuX0,y:e.Fltr.PuY0},{x:e.Fltr.PuX1,y:e.Fltr.PuY1},{x:e.Fltr.PuX2,y:e.Fltr.PuY2},{x:e.Fltr.PuX3,y:e.Fltr.PuY3}],puppetShapeList:e.Fltr.puppetShapeList.map((function(e){return{rigidType:e.rigidType,originalVertexArray:Wx(e.originalVertexArray),deformedVertexArray:Wx(e.deformedVertexArray),indexArray:Array.from((t=e.indexArray,new Uint32Array(t.buffer.slice(t.byteOffset),0,t.byteLength/4))),pinOffsets:Hx(e.pinOffsets),posFinalPins:Hx(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,selectedPin:e.selectedPin,pinPosition:Hx(e.PinP),pinRotation:e.PnRt,pinOverlay:e.PnOv,pinDepth:e.PnDp,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{pathComponents:e.meshBoundaryPath.pathComponents.map((function(e){return{shapeOperation:e.shapeOperation.split(".")[1],paths:e.SbpL.map((function(e){return{closed:e.Clsp,points:e["Pts "].map((function(e){return{anchor:Yx(e.Anch),forward:Yx(e["Fwd "]),backward:Yx(e["Bwd "]),smooth:e.Smoo}}))}}))}}))}};var t}))}});case"PbPl":for(var n=[],i=e.Fltr,o=0;o<Ox.length&&i["PN".concat(Ox[o],"a")];o++)for(var a=0;a<Ox.length&&i["PN".concat(Ox[o]).concat(Ox[a])];a++)n.push({name:i["PN".concat(Ox[o]).concat(Ox[a])],value:i["PF".concat(Ox[o]).concat(Ox[a])]});return Tx(Tx({},r),{type:"oil paint plugin",filter:{name:e.Fltr.KnNm,gpu:e.Fltr.GpuY,lighting:e.Fltr.LIWy,parameters:n}});case"HsbP":return Tx(Tx({},r),{type:"hsb/hsl",filter:{inputMode:Gg.decode(e.Fltr.Inpt),rowOrder:Gg.decode(e.Fltr.Otpt)}});case"oilPaint":return Tx(Tx({},r),{type:"oil paint",filter:{lightingOn:e.Fltr.lightingOn,stylization:e.Fltr.stylization,cleanliness:e.Fltr.cleanliness,brushScale:e.Fltr.brushScale,microBrush:e.Fltr.microBrush,lightDirection:e.Fltr.LghD,specularity:e.Fltr.specularity}});case"LqFy":return Tx(Tx({},r),{type:"liquify",filter:{liquifyMesh:e.Fltr.LqMe}});case"perspectiveWarpTransform":return Tx(Tx({},r),{type:"perspective warp",filter:{vertices:e.Fltr.vertices.map(Yx),warpedVertices:e.Fltr.warpedVertices.map(Yx),quads:e.Fltr.quads.map((function(e){return e.indices}))}});case"Crvs":return Tx(Tx({},r),{type:"curves",filter:{presetKind:_m.decode(e.Fltr.presetKind),adjustments:e.Fltr.Adjs.map((function(e){var t=e.Chnl.map((function(e){return um.decode(e)}));if(e["Crv "])return{channels:t,curve:e["Crv "].map((function(e){var t={x:e.Hrzn,y:e.Vrtc};return e.Cnty&&(t.curved=!0),t}))};if(e.Mpng)return{channels:t,values:e.Mpng};throw new Error("Unknown curve adjustment")}))}});default:if(t.throwForMissingFeatures)throw new Error("Unknown filter classId: ".concat(e.Fltr._classID));return}else switch(e.filterID){case 1098281575:return Tx(Tx({},r),{type:"average"});case 1114403360:return Tx(Tx({},r),{type:"blur"});case 1114403405:return Tx(Tx({},r),{type:"blur more"});case 1148416099:return Tx(Tx({},r),{type:"despeckle"});case 1180922912:return Tx(Tx({},r),{type:"facet"});case 1181902701:return Tx(Tx({},r),{type:"fragment"});case 1399353968:return Tx(Tx({},r),{type:"sharpen"});case 1399353925:return Tx(Tx({},r),{type:"sharpen edges"});case 1399353933:return Tx(Tx({},r),{type:"sharpen more"});case 1181639749:return Tx(Tx({},r),{type:"find edges"});case 1399616122:return Tx(Tx({},r),{type:"solarize"});case 1314149187:return Tx(Tx({},r),{type:"ntsc colors"});default:if(t.throwForMissingFeatures)throw new Error("Unknown filterID: ".concat(e.filterID))}}(e,t)})).filter((function(e){return!!e}))}}function Kx(e){return Cg(e.radius,"radius")}function Zx(e){if(e.warp)return e.warp;if(!e.width||!e.height)throw new Error("You must provide width and height of the linked image in placedLayer");var t=e.width,r=e.height,n=t/3,i=2*t/3,o=r/3,a=2*r/3;return{style:"custom",value:0,perspective:0,perspectiveOther:0,rotate:"horizontal",bounds:{top:{value:0,units:"Pixels"},left:{value:0,units:"Pixels"},bottom:{value:r,units:"Pixels"},right:{value:t,units:"Pixels"}},uOrder:4,vOrder:4,customEnvelopeWarp:{meshPoints:[{x:0,y:0},{x:n,y:0},{x:i,y:0},{x:t,y:0},{x:0,y:o},{x:n,y:o},{x:i,y:o},{x:t,y:o},{x:0,y:a},{x:n,y:a},{x:i,y:a},{x:t,y:a},{x:0,y:r},{x:n,y:r},{x:i,y:r},{x:t,y:r}]}}}function Jx(e){return{top:ib(e),left:ib(e),bottom:ib(e),right:ib(e)}}function $x(e,t){wE(e,t.top),wE(e,t.left),wE(e,t.bottom),wE(e,t.right)}function Qx(e){kx(e,(function(t){var r=t;return!(!r.linkedFiles||!r.linkedFiles.length)&&!("lnkE"===e&&!r.linkedFiles.some((function(e){return e.linkedFile})))}),(function(t,r,n,i){var o=r;for(o.linkedFiles=o.linkedFiles||[];n()>8;){var a=Ix(t),s=t.offset,l=db(t),c=ib(t),u=pb(t,1),h=vb(t),d=db(t).trim(),f=db(t).trim(),p=Ix(t),v=Qm(t)?Wy(t):void 0,y="liFE"===l?Wy(t):void 0,g={id:u,name:h};if(d&&(g.type=d),f&&(g.creator=f),v&&(g.descriptor={compInfo:{compID:v.compInfo.compID,originalCompID:v.compInfo.originalCompID}}),"liFE"===l&&c>3){var m=ib(t),b=Qm(t),x=Qm(t),E=Qm(t),w=Qm(t),S=lb(t),_=Math.floor(S),C=1e3*(S-_);g.time=new Date(Date.UTC(m,b,x,E,w,_,C)).toISOString()}var A="liFE"===l?Ix(t):0;for("liFA"===l&&mb(t,8),"liFD"===l&&(g.data=hb(t,p)),c>=5&&(g.childDocumentID=vb(t)),c>=6&&(g.assetModTime=lb(t)),c>=7&&(g.assetLockedState=Qm(t)),"liFE"===l&&2===c&&(g.data=hb(t,A)),t.skipLinkedFilesData&&(g.data=void 0),"lnkE"===e&&(g.linkedFile={fileSize:A,name:(null==y?void 0:y["Nm  "])||"",fullPath:(null==y?void 0:y.fullPath)||"",originalPath:(null==y?void 0:y.originalPath)||"",relativePath:(null==y?void 0:y.relPath)||""}),o.linkedFiles.push(g);a%4;)a++;t.offset=s+a}mb(t,n())}),(function(t,r){for(var n,i,o,a,s,l,c,u,h,d=0,f=r.linkedFiles;d<f.length;d++){var p=f[d];if("lnkE"===e==!!p.linkedFile){var v=2;null!=p.assetLockedState?v=7:null!=p.assetModTime?v=6:null!=p.childDocumentID?v=5:"lnkE"==e&&(v=3),Px(t,0);var y=t.offset;if(LE(t,"lnkE"===e?"liFE":p.data?"liFD":"liFA"),wE(t,v),!p.id||"string"!=typeof p.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(p.id))throw new Error("Linked file ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(RE(t,p.id,1),PE(t,p.name||""),LE(t,p.type?"".concat(p.type,"    ").substring(0,4):"    "),LE(t,p.creator?"".concat(p.creator,"    ").substring(0,4):"\0\0\0\0"),Px(t,p.data?p.data.byteLength:0),p.descriptor&&p.descriptor.compInfo){var g={compInfo:{compID:p.descriptor.compInfo.compID,originalCompID:p.descriptor.compInfo.originalCompID}};mE(t,1),Yy(t,"","null",g)}else mE(t,0);if("lnkE"===e){Yy(t,"","ExternalFileLink",g={descVersion:2,"Nm  ":null!==(i=null===(n=p.linkedFile)||void 0===n?void 0:n.name)&&void 0!==i?i:"",fullPath:null!==(a=null===(o=p.linkedFile)||void 0===o?void 0:o.fullPath)&&void 0!==a?a:"",originalPath:null!==(l=null===(s=p.linkedFile)||void 0===s?void 0:s.originalPath)&&void 0!==l?l:"",relPath:null!==(u=null===(c=p.linkedFile)||void 0===c?void 0:c.relativePath)&&void 0!==u?u:""});var m=p.time?new Date(p.time):new Date;wE(t,m.getUTCFullYear()),mE(t,m.getUTCMonth()),mE(t,m.getUTCDate()),mE(t,m.getUTCHours()),mE(t,m.getUTCMinutes()),AE(t,m.getUTCSeconds()+m.getUTCMilliseconds()/1e3)}p.data?ME(t,p.data):Px(t,(null===(h=p.linkedFile)||void 0===h?void 0:h.fileSize)||0),v>=5&&PE(t,p.childDocumentID||""),v>=6&&AE(t,p.assetModTime||0),v>=7&&mE(t,p.assetLockedState||0);var b=t.offset-y;for(t.view.setUint32(y-4,b,!1);b%4;)b++,mE(t,0)}}}))}function eE(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}function tE(e){return{shadowInput:tb(e),highlightInput:tb(e),shadowOutput:tb(e),highlightOutput:tb(e),midtoneInput:tb(e)/100}}function rE(e,t){bE(e,t.shadowInput),bE(e,t.highlightInput),bE(e,t.shadowOutput),bE(e,t.highlightOutput),bE(e,Math.round(100*t.midtoneInput))}function nE(e){for(var t=rb(e),r=[],n=0;n<t;n++){var i=tb(e),o=tb(e);r.push({input:o,output:i})}return r}function iE(e,t){xE(e,t.length);for(var r=0,n=t;r<n.length;r++){var i=n[r];xE(e,i.output),xE(e,i.input)}}function oE(e){return{a:tb(e),b:tb(e),c:tb(e),d:tb(e),hue:tb(e),saturation:tb(e),lightness:tb(e)}}function aE(e,t){var r=t||{};bE(e,r.a||0),bE(e,r.b||0),bE(e,r.c||0),bE(e,r.d||0),bE(e,r.hue||0),bE(e,r.saturation||0),bE(e,r.lightness||0)}function sE(e){return{cyanRed:tb(e),magentaGreen:tb(e),yellowBlue:tb(e)}}function lE(e,t){bE(e,t.cyanRed||0),bE(e,t.magentaGreen||0),bE(e,t.yellowBlue||0)}function cE(e){var t=tb(e),r=tb(e),n=tb(e);return mb(e,2),{red:t,green:r,blue:n,constant:tb(e)}}function uE(e,t){var r=t||{};bE(e,r.red),bE(e,r.green),bE(e,r.blue),kE(e,2),bE(e,r.constant)}kx("PlLd",Rx("placedLayer"),(function(e,t,r){if("plcL"!==db(e))throw new Error("Invalid PlLd signature");if(3!==ib(e))throw new Error("Invalid PlLd version");var n=pb(e,1),i=ib(e),o=ib(e);ib(e);var a=ib(e);if(!Bx[a])throw new Error("Invalid PlLd type");for(var s=[],l=0;l<8;l++)s.push(lb(e));var c=ib(e);if(0!==c)throw new Error("Invalid Warp version ".concat(c));var u=Wy(e);t.placedLayer=t.placedLayer||{id:n,type:Bx[a],pageNumber:i,totalPages:o,transform:s,warp:Ux(u)},mb(e,r())}),(function(e,t){var r=t.placedLayer;if(LE(e,"plcL"),wE(e,3),!r.id||"string"!=typeof r.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(r.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(RE(e,r.id,1),wE(e,1),wE(e,1),wE(e,16),-1===Bx.indexOf(r.type))throw new Error("Invalid placedLayer type");wE(e,Bx.indexOf(r.type));for(var n=0;n<8;n++)AE(e,r.transform[n]);wE(e,0);var i=Zx(r),o=zx(i)?"quiltWarp":"warp";Yy(e,"",o,Gx(i),o)})),kx("SoLd",Rx("placedLayer"),(function(e,t,r){if("soLD"!==db(e))throw new Error("Invalid SoLd type");var n=ib(e);if(4!==n&&5!==n)throw new Error("Invalid SoLd version");var i=Wy(e,!0);t.placedLayer={id:i.Idnt,placed:i.placed,type:Bx[i.Type],pageNumber:i.PgNm,totalPages:i.totalPages,frameStep:Ag(i.frameStep),duration:Ag(i.duration),frameCount:i.frameCount,transform:i.Trnf,width:i["Sz  "].Wdth,height:i["Sz  "].Hght,resolution:xg(i.Rslt),warp:Ux(i.quiltWarp||i.warp)},i.nonAffineTransform&&i.nonAffineTransform.some((function(e,t){return e!==i.Trnf[t]}))&&(t.placedLayer.nonAffineTransform=i.nonAffineTransform),i.Crop&&(t.placedLayer.crop=i.Crop),i.comp&&(t.placedLayer.comp=i.comp),i.compInfo&&(t.placedLayer.compInfo={compID:i.compInfo.compID,originalCompID:i.compInfo.originalCompID}),i.filterFX&&(t.placedLayer.filter=Vx(i.filterFX,e)),mb(e,r())}),(function(e,t){var r,n;LE(e,"soLD"),wE(e,4);var i=t.placedLayer;if(!i.id||"string"!=typeof i.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(i.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");var o=Tx(Tx({Idnt:i.id,placed:null!==(r=i.placed)&&void 0!==r?r:i.id,PgNm:i.pageNumber||1,totalPages:i.totalPages||1},i.crop?{Crop:i.crop}:{}),{frameStep:i.frameStep||{numerator:0,denominator:600},duration:i.duration||{numerator:0,denominator:600},frameCount:i.frameCount||0,Annt:16,Type:Bx.indexOf(i.type),Trnf:i.transform,nonAffineTransform:null!==(n=i.nonAffineTransform)&&void 0!==n?n:i.transform,warp:Gx(Zx(i)),"Sz  ":{_name:"",_classID:"Pnt ",Wdth:i.width||0,Hght:i.height||0},Rslt:i.resolution?Cg(i.resolution,"resolution"):{units:"Density",value:72}});if(i.filter&&(o.filterFX={_name:"",_classID:"filterFXStyle",enab:i.filter.enabled,validAtPosition:i.filter.validAtPosition,filterMaskEnable:i.filter.maskEnabled,filterMaskLinked:i.filter.maskLinked,filterMaskExtendWithWhite:i.filter.maskExtendWithWhite,filterFXList:i.filter.list.map((function(e){return function(e){var t={_name:"",_classID:"filterFX","Nm  ":e.name,blendOptions:{_name:"",_classID:"blendOptions",Opct:_g(e.opacity),"Md  ":Lg.encode(e.blendMode)},enab:e.enabled,hasoptions:e.hasOptions,FrgC:yg(e.foregroundColor),BckC:yg(e.backgroundColor)};switch(e.type){case"average":return Tx(Tx({},t),{filterID:1098281575});case"blur":return Tx(Tx({},t),{filterID:1114403360});case"blur more":return Tx(Tx({},t),{filterID:1114403405});case"box blur":return Tx(Tx({},t),{Fltr:{_name:"Box Blur",_classID:"boxblur","Rds ":Kx(e.filter)},filterID:697});case"gaussian blur":return Tx(Tx({},t),{Fltr:{_name:"Gaussian Blur",_classID:"GsnB","Rds ":Kx(e.filter)},filterID:1198747202});case"motion blur":return Tx(Tx({},t),{Fltr:{_name:"Motion Blur",_classID:"MtnB",Angl:e.filter.angle,Dstn:Cg(e.filter.distance,"distance")},filterID:1299476034});case"radial blur":return Tx(Tx({},t),{Fltr:{_name:"Radial Blur",_classID:"RdlB",Amnt:e.filter.amount,BlrM:$g.encode(e.filter.method),BlrQ:Qg.encode(e.filter.quality)},filterID:1382313026});case"shape blur":return Tx(Tx({},t),{Fltr:{_name:"Shape Blur",_classID:"shapeBlur","Rds ":Kx(e.filter),customShape:{_name:"",_classID:"customShape","Nm  ":e.filter.customShape.name,Idnt:e.filter.customShape.id}},filterID:702});case"smart blur":return Tx(Tx({},t),{Fltr:{_name:"Smart Blur",_classID:"SmrB","Rds ":e.filter.radius,Thsh:e.filter.threshold,SmBQ:tm.encode(e.filter.quality),SmBM:em.encode(e.filter.mode)},filterID:1399681602});case"surface blur":return Tx(Tx({},t),{Fltr:{_name:"Surface Blur",_classID:"surfaceBlur","Rds ":Kx(e.filter),Thsh:e.filter.threshold},filterID:701});case"displace":return Tx(Tx({},t),{Fltr:{_name:"Displace",_classID:"Dspl",HrzS:e.filter.horizontalScale,VrtS:e.filter.verticalScale,DspM:rm.encode(e.filter.displacementMap),UndA:nm.encode(e.filter.undefinedAreas),DspF:{sig:e.filter.displacementFile.signature,path:e.filter.displacementFile.path}},filterID:1148416108});case"pinch":return Tx(Tx({},t),{Fltr:{_name:"Pinch",_classID:"Pnch",Amnt:e.filter.amount},filterID:1349411688});case"polar coordinates":return Tx(Tx({},t),{Fltr:{_name:"Polar Coordinates",_classID:"Plr ",Cnvr:im.encode(e.filter.conversion)},filterID:1349284384});case"ripple":return Tx(Tx({},t),{Fltr:{_name:"Ripple",_classID:"Rple",Amnt:e.filter.amount,RplS:om.encode(e.filter.size)},filterID:1383099493});case"shear":return Tx(Tx({},t),{Fltr:{_name:"Shear",_classID:"Shr ",ShrP:e.filter.shearPoints.map((function(e){return{_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y}})),UndA:nm.encode(e.filter.undefinedAreas),ShrS:e.filter.shearStart,ShrE:e.filter.shearEnd},filterID:1399353888});case"spherize":return Tx(Tx({},t),{Fltr:{_name:"Spherize",_classID:"Sphr",Amnt:e.filter.amount,SphM:am.encode(e.filter.mode)},filterID:1399875698});case"twirl":return Tx(Tx({},t),{Fltr:{_name:"Twirl",_classID:"Twrl",Angl:e.filter.angle},filterID:1417114220});case"wave":return Tx(Tx({},t),{Fltr:{_name:"Wave",_classID:"Wave",Wvtp:sm.encode(e.filter.type),NmbG:e.filter.numberOfGenerators,WLMn:e.filter.wavelength.min,WLMx:e.filter.wavelength.max,AmMn:e.filter.amplitude.min,AmMx:e.filter.amplitude.max,SclH:e.filter.scale.x,SclV:e.filter.scale.y,UndA:nm.encode(e.filter.undefinedAreas),RndS:e.filter.randomSeed},filterID:1466005093});case"zigzag":return Tx(Tx({},t),{Fltr:{_name:"ZigZag",_classID:"ZgZg",Amnt:e.filter.amount,NmbR:e.filter.ridges,ZZTy:lm.encode(e.filter.style)},filterID:1516722791});case"add noise":return Tx(Tx({},t),{Fltr:{_name:"Add Noise",_classID:"AdNs",Dstr:cm.encode(e.filter.distribution),Nose:_g(e.filter.amount),Mnch:e.filter.monochromatic,FlRs:e.filter.randomSeed},filterID:1097092723});case"despeckle":return Tx(Tx({},t),{filterID:1148416099});case"dust and scratches":return Tx(Tx({},t),{Fltr:{_name:"Dust & Scratches",_classID:"DstS","Rds ":e.filter.radius,Thsh:e.filter.threshold},filterID:1148417107});case"median":return Tx(Tx({},t),{Fltr:{_name:"Median",_classID:"Mdn ","Rds ":Kx(e.filter)},filterID:1298427424});case"reduce noise":return Tx(Tx({},t),{Fltr:{_name:"Reduce Noise",_classID:"denoise",ClNs:_g(e.filter.reduceColorNoise),Shrp:_g(e.filter.sharpenDetails),removeJPEGArtifact:e.filter.removeJpegArtifact,channelDenoise:e.filter.channelDenoise.map((function(e){return Tx({_name:"",_classID:"channelDenoiseParams",Chnl:e.channels.map((function(e){return um.encode(e)})),Amnt:e.amount},e.preserveDetails?{EdgF:e.preserveDetails}:{})})),preset:e.filter.preset},filterID:633});case"color halftone":return Tx(Tx({},t),{Fltr:{_name:"Color Halftone",_classID:"ClrH","Rds ":e.filter.radius,Ang1:e.filter.angle1,Ang2:e.filter.angle2,Ang3:e.filter.angle3,Ang4:e.filter.angle4},filterID:1131180616});case"crystallize":return Tx(Tx({},t),{Fltr:{_name:"Crystallize",_classID:"Crst",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1131574132});case"facet":return Tx(Tx({},t),{filterID:1180922912});case"fragment":return Tx(Tx({},t),{filterID:1181902701});case"mezzotint":return Tx(Tx({},t),{Fltr:{_name:"Mezzotint",_classID:"Mztn",MztT:hm.encode(e.filter.type),FlRs:e.filter.randomSeed},filterID:1299870830});case"mosaic":return Tx(Tx({},t),{Fltr:{_name:"Mosaic",_classID:"Msc ",ClSz:Cg(e.filter.cellSize,"cellSize")},filterID:1299407648});case"pointillize":return Tx(Tx({},t),{Fltr:{_name:"Pointillize",_classID:"Pntl",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1349416044});case"clouds":return Tx(Tx({},t),{Fltr:{_name:"Clouds",_classID:"Clds",FlRs:e.filter.randomSeed},filterID:1131177075});case"difference clouds":return Tx(Tx({},t),{Fltr:{_name:"Difference Clouds",_classID:"DfrC",FlRs:e.filter.randomSeed},filterID:1147564611});case"fibers":return Tx(Tx({},t),{Fltr:{_name:"Fibers",_classID:"Fbrs",Vrnc:e.filter.variance,Strg:e.filter.strength,RndS:e.filter.randomSeed},filterID:1180856947});case"lens flare":return Tx(Tx({},t),{Fltr:{_name:"Lens Flare",_classID:"LnsF",Brgh:e.filter.brightness,FlrC:{_name:"",_classID:"Pnt ",Hrzn:e.filter.position.x,Vrtc:e.filter.position.y},"Lns ":dm.encode(e.filter.lensType)},filterID:1282306886});case"sharpen":return Tx(Tx({},t),{filterID:1399353968});case"sharpen edges":return Tx(Tx({},t),{filterID:1399353925});case"sharpen more":return Tx(Tx({},t),{filterID:1399353933});case"smart sharpen":return Tx(Tx({},t),{Fltr:{_name:"Smart Sharpen",_classID:"smartSharpen",Amnt:_g(e.filter.amount),"Rds ":Kx(e.filter),Thsh:e.filter.threshold,Angl:e.filter.angle,moreAccurate:e.filter.moreAccurate,blur:fm.encode(e.filter.blur),preset:e.filter.preset,sdwM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:_g(e.filter.shadow.fadeAmount),Wdth:_g(e.filter.shadow.tonalWidth),"Rds ":e.filter.shadow.radius},hglM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:_g(e.filter.highlight.fadeAmount),Wdth:_g(e.filter.highlight.tonalWidth),"Rds ":e.filter.highlight.radius}},filterID:698});case"unsharp mask":return Tx(Tx({},t),{Fltr:{_name:"Unsharp Mask",_classID:"UnsM",Amnt:_g(e.filter.amount),"Rds ":Kx(e.filter),Thsh:e.filter.threshold},filterID:1433301837});case"diffuse":return Tx(Tx({},t),{Fltr:{_name:"Diffuse",_classID:"Dfs ","Md  ":pm.encode(e.filter.mode),FlRs:e.filter.randomSeed},filterID:1147564832});case"emboss":return Tx(Tx({},t),{Fltr:{_name:"Emboss",_classID:"Embs",Angl:e.filter.angle,Hght:e.filter.height,Amnt:e.filter.amount},filterID:1164796531});case"extrude":return Tx(Tx({},t),{Fltr:{_name:"Extrude",_classID:"Extr",ExtS:e.filter.size,ExtD:e.filter.depth,ExtF:e.filter.solidFrontFaces,ExtM:e.filter.maskIncompleteBlocks,ExtT:vm.encode(e.filter.type),ExtR:ym.encode(e.filter.depthMode),FlRs:e.filter.randomSeed},filterID:1165522034});case"find edges":return Tx(Tx({},t),{filterID:1181639749});case"solarize":return Tx(Tx({},t),{filterID:1399616122});case"tiles":return Tx(Tx({},t),{Fltr:{_name:"Tiles",_classID:"Tls ",TlNm:e.filter.numberOfTiles,TlOf:e.filter.maximumOffset,FlCl:gm.encode(e.filter.fillEmptyAreaWith),FlRs:e.filter.randomSeed},filterID:1416393504});case"trace contour":return Tx(Tx({},t),{Fltr:{_name:"Trace Contour",_classID:"TrcC","Lvl ":e.filter.level,"Edg ":mm.encode(e.filter.edge)},filterID:1416782659});case"wind":return Tx(Tx({},t),{Fltr:{_name:"Wind",_classID:"Wnd ",WndM:bm.encode(e.filter.method),Drct:xm.encode(e.filter.direction)},filterID:1466852384});case"de-interlace":return Tx(Tx({},t),{Fltr:{_name:"De-Interlace",_classID:"Dntr",IntE:Em.encode(e.filter.eliminate),IntC:wm.encode(e.filter.newFieldsBy)},filterID:1148089458});case"ntsc colors":return Tx(Tx({},t),{filterID:1314149187});case"custom":return Tx(Tx({},t),{Fltr:{_name:"Custom",_classID:"Cstm","Scl ":e.filter.scale,Ofst:e.filter.offset,Mtrx:e.filter.matrix},filterID:1131639917});case"high pass":return Tx(Tx({},t),{Fltr:{_name:"High Pass",_classID:"HghP","Rds ":Kx(e.filter)},filterID:1214736464});case"maximum":return Tx(Tx({},t),{Fltr:{_name:"Maximum",_classID:"Mxm ","Rds ":Kx(e.filter)},filterID:1299737888});case"minimum":return Tx(Tx({},t),{Fltr:{_name:"Minimum",_classID:"Mnm ","Rds ":Kx(e.filter)},filterID:1299082528});case"offset":return Tx(Tx({},t),{Fltr:{_name:"Offset",_classID:"Ofst",Hrzn:e.filter.horizontal,Vrtc:e.filter.vertical,"Fl  ":Sm.encode(e.filter.undefinedAreas)},filterID:1332114292});case"puppet":return Tx(Tx({},t),{Fltr:{_name:"Rigid Transform",_classID:"rigidTransform",null:["Ordn.Trgt"],rigidType:e.filter.rigidType,puppetShapeList:e.filter.puppetShapeList.map((function(e){return{_name:"",_classID:"puppetShape",rigidType:e.rigidType,VrsM:1,VrsN:0,originalVertexArray:Xx(new Float32Array(jx(e.originalVertexArray))),deformedVertexArray:Xx(new Float32Array(jx(e.deformedVertexArray))),indexArray:Xx(new Uint32Array(e.indexArray)),pinOffsets:jx(e.pinOffsets),posFinalPins:jx(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,PinP:jx(e.pinPosition),PnRt:e.pinRotation,PnOv:e.pinOverlay,PnDp:e.pinDepth,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{_name:"",_classID:"pathClass",pathComponents:e.meshBoundaryPath.pathComponents.map((function(e){return{_name:"",_classID:"PaCm",shapeOperation:"shapeOperation.".concat(e.shapeOperation),SbpL:e.paths.map((function(e){return{_name:"",_classID:"Sbpl",Clsp:e.closed,"Pts ":e.points.map((function(e){return{_name:"",_classID:"Pthp",Anch:qx(e.anchor),"Fwd ":qx(e.forward),"Bwd ":qx(e.backward),Smoo:e.smooth}}))}}))}}))},selectedPin:e.selectedPin}})),PuX0:e.filter.bounds[0].x,PuX1:e.filter.bounds[1].x,PuX2:e.filter.bounds[2].x,PuX3:e.filter.bounds[3].x,PuY0:e.filter.bounds[0].y,PuY1:e.filter.bounds[1].y,PuY2:e.filter.bounds[2].y,PuY3:e.filter.bounds[3].y},filterID:991});case"oil paint plugin":for(var r={},n=0;n<e.filter.parameters.length;n++){var i=e.filter.parameters[n],o=i.name,a=i.value,s="".concat(Ox[Math.floor(n/Ox.length)]).concat(Ox[n%Ox.length]);r["PN".concat(s)]=o,r["PT".concat(s)]=0,r["PF".concat(s)]=a}return Tx(Tx({},t),{Fltr:Tx({_name:"Oil Paint Plugin",_classID:"PbPl",KnNm:e.filter.name,GpuY:e.filter.gpu,LIWy:e.filter.lighting,FPth:"1"},r),filterID:1348620396});case"oil paint":return Tx(Tx({},t),{Fltr:{_name:"Oil Paint",_classID:"oilPaint",lightingOn:e.filter.lightingOn,stylization:e.filter.stylization,cleanliness:e.filter.cleanliness,brushScale:e.filter.brushScale,microBrush:e.filter.microBrush,LghD:e.filter.lightDirection,specularity:e.filter.specularity},filterID:1122});case"liquify":return Tx(Tx({},t),{Fltr:{_name:"Liquify",_classID:"LqFy",LqMe:e.filter.liquifyMesh},filterID:1282492025});case"perspective warp":return Tx(Tx({},t),{Fltr:{_name:"Perspective Warp",_classID:"perspectiveWarpTransform",vertices:e.filter.vertices.map(qx),warpedVertices:e.filter.warpedVertices.map(qx),quads:e.filter.quads.map((function(e){return{indices:e}}))},filterID:442});case"curves":return Tx(Tx({},t),{Fltr:{_name:"Curves",_classID:"Crvs",presetKind:_m.encode(e.filter.presetKind),Adjs:e.filter.adjustments.map((function(e){return"curve"in e?{_name:"",_classID:"CrvA",Chnl:e.channels.map((function(e){return um.encode(e)})),"Crv ":e.curve.map((function(e){return Tx({_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y},e.curved?{Cnty:!0}:{})}))}:{_name:"",_classID:"CrvA",Chnl:e.channels.map((function(e){return um.encode(e)})),Mpng:e.values}}))},filterID:1131574899});default:throw new Error("Unknow filter type: ".concat(e.type))}}(e)}))}),i.warp&&zx(i.warp)){var a=Gx(i.warp);o.quiltWarp=a,o.warp={warpStyle:"warpStyle.warpNone",warpValue:a.warpValue,warpPerspective:a.warpPerspective,warpPerspectiveOther:a.warpPerspectiveOther,warpRotate:a.warpRotate,bounds:a.bounds,uOrder:a.uOrder,vOrder:a.vOrder}}else delete o.quiltWarp;i.comp&&(o.comp=i.comp),i.compInfo&&(o.compInfo=i.compInfo),Yy(e,"","null",o,o.quiltWarp?"quiltWarp":"warp")})),Lx("SoLE","SoLd"),kx("fxrp",Rx("referencePoint"),(function(e,t){t.referencePoint={x:lb(e),y:lb(e)}}),(function(e,t){AE(e,t.referencePoint.x),AE(e,t.referencePoint.y)})),kx("Lr16",(function(){return!1}),(function(e,t,r,n,i){Sb(e,n,i)}),(function(e,t){})),kx("Lr32",(function(){return!1}),(function(e,t,r,n,i){Sb(e,n,i)}),(function(e,t){})),kx("LMsk",Rx("userMask"),(function(e,t){if(t.userMask={colorSpace:Bb(e),opacity:rb(e)/255},128!==Qm(e))throw new Error("Invalid flag value");mb(e,1)}),(function(e,t){var r=t.userMask;BE(e,r.colorSpace),xE(e,255*ey(r.opacity,0,1)),mE(e,128),kE(e,1)})),kx("Patt",(function(e){return!e}),(function(e,t,r){r()&&mb(e,r())}),(function(e,t){})),kx("Anno",(function(e){return void 0!==e.annotations}),(function(e,t,r){var n=rb(e),i=rb(e);if(2!==n||1!==i)throw new Error("Invalid Anno version");for(var o=ab(e),a=[],s=0;s<o;s++){ab(e);var l=db(e),c=!!Qm(e);Qm(e),rb(e);var u=Jx(e),h=Jx(e),d=Bb(e),f=pb(e,2),p=pb(e,2),v=pb(e,2);ab(e),db(e);var y=ab(e),g=void 0;if("txtA"===l)y>=2&&65279===rb(e)?g=yb(e,(y-2)/2):(e.offset-=2,g=gb(e,y)),g=g.replace(/\r/g,"\n");else{if("sndA"!==l)throw new Error("Unknown annotation type");g=hb(e,y)}a.push({type:"txtA"===l?"text":"sound",open:c,iconLocation:u,popupLocation:h,color:d,author:f,name:p,date:v,data:g})}t.annotations=a,mb(e,r())}),(function(e,t){var r=t.annotations;xE(e,2),xE(e,1),_E(e,r.length);for(var n=0,i=r;n<i.length;n++){var o=i[n],a="sound"===o.type;if(a&&!(o.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!a&&"string"!=typeof o.data)throw new Error("Text annotation data should be string");var s=e.offset;_E(e,0),LE(e,a?"sndA":"txtA"),mE(e,o.open?1:0),mE(e,28),xE(e,1),$x(e,o.iconLocation),$x(e,o.popupLocation),BE(e,o.color),RE(e,o.author||"",2),RE(e,o.name||"",2),RE(e,o.date||"",2);var l=e.offset;_E(e,0),LE(e,a?"sndM":"txtC"),_E(e,0);var c=e.offset;if(a)ME(e,o.data);else{xE(e,65279);for(var u=o.data.replace(/\n/g,"\r"),h=0;h<u.length;h++)xE(e,u.charCodeAt(h))}e.view.setUint32(s,e.offset-s,!1),e.view.setUint32(l,e.offset-l,!1),e.view.setUint32(c-4,e.offset-c,!1)}})),Qx("lnk2"),Qx("lnkE"),Lx("lnkD","lnk2"),Lx("lnk3","lnk2"),kx("pths",Rx("pathList"),(function(e,t){Wy(e,!0),t.pathList=[]}),(function(e,t){Yy(e,"","pathsDataClass",{pathList:[]})})),kx("lyvr",Rx("version"),(function(e,t){return t.version=ab(e)}),(function(e,t){return _E(e,t.version)})),kx("brit",eE("brightness/contrast"),(function(e,t,r){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:tb(e),contrast:tb(e),meanValue:tb(e),labColorOnly:!!Qm(e),useLegacy:!0}),mb(e,r())}),(function(e,t){var r,n=t.adjustment;bE(e,n.brightness||0),bE(e,n.contrast||0),bE(e,null!==(r=n.meanValue)&&void 0!==r?r:127),mE(e,n.labColorOnly?1:0),kE(e,1)})),kx("levl",eE("levels"),(function(e,t,r){if(2!==rb(e))throw new Error("Invalid levl version");t.adjustment=Tx(Tx({},t.adjustment),{type:"levels",rgb:tE(e),red:tE(e),green:tE(e),blue:tE(e)}),mb(e,r())}),(function(e,t){var r=t.adjustment,n={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};xE(e,2),rE(e,r.rgb||n),rE(e,r.red||n),rE(e,r.blue||n),rE(e,r.green||n);for(var i=0;i<59;i++)rE(e,n)})),kx("curv",eE("curves"),(function(e,t,r){if(Qm(e),1!==rb(e))throw new Error("Invalid curv version");rb(e);var n=rb(e),i={type:"curves"};1&n&&(i.rgb=nE(e)),2&n&&(i.red=nE(e)),4&n&&(i.green=nE(e)),8&n&&(i.blue=nE(e)),t.adjustment=Tx(Tx({},t.adjustment),i),mb(e,r())}),(function(e,t){var r=t.adjustment,n=r.rgb,i=r.red,o=r.green,a=r.blue,s=0,l=0;n&&n.length&&(s|=1,l++),i&&i.length&&(s|=2,l++),o&&o.length&&(s|=4,l++),a&&a.length&&(s|=8,l++),mE(e,0),xE(e,1),xE(e,0),xE(e,s),n&&n.length&&iE(e,n),i&&i.length&&iE(e,i),o&&o.length&&iE(e,o),a&&a.length&&iE(e,a),LE(e,"Crv "),xE(e,4),xE(e,0),xE(e,l),n&&n.length&&(xE(e,0),iE(e,n)),i&&i.length&&(xE(e,1),iE(e,i)),o&&o.length&&(xE(e,2),iE(e,o)),a&&a.length&&(xE(e,3),iE(e,a)),kE(e,2)})),kx("expA",eE("exposure"),(function(e,t,r){if(1!==rb(e))throw new Error("Invalid expA version");t.adjustment=Tx(Tx({},t.adjustment),{type:"exposure",exposure:sb(e),offset:sb(e),gamma:sb(e)}),mb(e,r())}),(function(e,t){var r=t.adjustment;xE(e,1),CE(e,r.exposure),CE(e,r.offset),CE(e,r.gamma),kE(e,2)})),kx("vibA",eE("vibrance"),(function(e,t,r){var n=Wy(e);t.adjustment={type:"vibrance"},void 0!==n.vibrance&&(t.adjustment.vibrance=n.vibrance),void 0!==n.Strt&&(t.adjustment.saturation=n.Strt),mb(e,r())}),(function(e,t){var r=t.adjustment,n={};void 0!==r.vibrance&&(n.vibrance=r.vibrance),void 0!==r.saturation&&(n.Strt=r.saturation),Yy(e,"","null",n)})),kx("hue2",eE("hue/saturation"),(function(e,t,r){if(2!==rb(e))throw new Error("Invalid hue2 version");t.adjustment=Tx(Tx({},t.adjustment),{type:"hue/saturation",master:oE(e),reds:oE(e),yellows:oE(e),greens:oE(e),cyans:oE(e),blues:oE(e),magentas:oE(e)}),mb(e,r())}),(function(e,t){var r=t.adjustment;xE(e,2),aE(e,r.master),aE(e,r.reds),aE(e,r.yellows),aE(e,r.greens),aE(e,r.cyans),aE(e,r.blues),aE(e,r.magentas)})),kx("blnc",eE("color balance"),(function(e,t,r){t.adjustment={type:"color balance",shadows:sE(e),midtones:sE(e),highlights:sE(e),preserveLuminosity:!!Qm(e)},mb(e,r())}),(function(e,t){var r=t.adjustment;lE(e,r.shadows||{}),lE(e,r.midtones||{}),lE(e,r.highlights||{}),mE(e,r.preserveLuminosity?1:0),kE(e,1)})),kx("blwh",eE("black & white"),(function(e,t,r){var n=Wy(e);t.adjustment={type:"black & white",reds:n["Rd  "],yellows:n.Yllw,greens:n["Grn "],cyans:n["Cyn "],blues:n["Bl  "],magentas:n.Mgnt,useTint:!!n.useTint,presetKind:n.bwPresetKind,presetFileName:n.blackAndWhitePresetFileName},void 0!==n.tintColor&&(t.adjustment.tintColor=vg(n.tintColor)),mb(e,r())}),(function(e,t){var r=t.adjustment;Yy(e,"","null",{"Rd  ":r.reds||0,Yllw:r.yellows||0,"Grn ":r.greens||0,"Cyn ":r.cyans||0,"Bl  ":r.blues||0,Mgnt:r.magentas||0,useTint:!!r.useTint,tintColor:yg(r.tintColor),bwPresetKind:r.presetKind||0,blackAndWhitePresetFileName:r.presetFileName||""})})),kx("phfl",eE("photo filter"),(function(e,t,r){var n,i=rb(e);if(2!==i&&3!==i)throw new Error("Invalid phfl version");n=2===i?Bb(e):{l:ib(e)/100,a:ib(e)/100,b:ib(e)/100},t.adjustment={type:"photo filter",color:n,density:ab(e)/100,preserveLuminosity:!!Qm(e)},mb(e,r())}),(function(e,t){var r=t.adjustment;xE(e,2),BE(e,r.color||{l:0,a:0,b:0}),_E(e,100*(r.density||0)),mE(e,r.preserveLuminosity?1:0),kE(e,3)})),kx("mixr",eE("channel mixer"),(function(e,t,r){if(1!==rb(e))throw new Error("Invalid mixr version");var n=t.adjustment=Tx(Tx({},t.adjustment),{type:"channel mixer",monochrome:!!rb(e)});n.monochrome||(n.red=cE(e),n.green=cE(e),n.blue=cE(e)),n.gray=cE(e),mb(e,r())}),(function(e,t){var r=t.adjustment;xE(e,1),xE(e,r.monochrome?1:0),r.monochrome?(uE(e,r.gray),kE(e,30)):(uE(e,r.red),uE(e,r.green),uE(e,r.blue),uE(e,r.gray))}));var hE=$v("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),dE=$v("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),fE=$v("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});kx("clrL",eE("color lookup"),(function(e,t,r){if(1!==rb(e))throw new Error("Invalid clrL version");var n=Wy(e);t.adjustment={type:"color lookup"};var i=t.adjustment;void 0!==n.lookupType&&(i.lookupType=hE.decode(n.lookupType)),void 0!==n["Nm  "]&&(i.name=n["Nm  "]),void 0!==n.Dthr&&(i.dither=n.Dthr),void 0!==n.profile&&(i.profile=n.profile),void 0!==n.LUTFormat&&(i.lutFormat=dE.decode(n.LUTFormat)),void 0!==n.dataOrder&&(i.dataOrder=fE.decode(n.dataOrder)),void 0!==n.tableOrder&&(i.tableOrder=fE.decode(n.tableOrder)),void 0!==n.LUT3DFileData&&(i.lut3DFileData=n.LUT3DFileData),void 0!==n.LUT3DFileName&&(i.lut3DFileName=n.LUT3DFileName),mb(e,r())}),(function(e,t){var r=t.adjustment,n={};void 0!==r.lookupType&&(n.lookupType=hE.encode(r.lookupType)),void 0!==r.name&&(n["Nm  "]=r.name),void 0!==r.dither&&(n.Dthr=r.dither),void 0!==r.profile&&(n.profile=r.profile),void 0!==r.lutFormat&&(n.LUTFormat=dE.encode(r.lutFormat)),void 0!==r.dataOrder&&(n.dataOrder=fE.encode(r.dataOrder)),void 0!==r.tableOrder&&(n.tableOrder=fE.encode(r.tableOrder)),void 0!==r.lut3DFileData&&(n.LUT3DFileData=r.lut3DFileData),void 0!==r.lut3DFileName&&(n.LUT3DFileName=r.lut3DFileName),xE(e,1),Yy(e,"","null",n)})),kx("nvrt",eE("invert"),(function(e,t,r){t.adjustment={type:"invert"},mb(e,r())}),(function(){})),kx("post",eE("posterize"),(function(e,t,r){t.adjustment={type:"posterize",levels:rb(e)},mb(e,r())}),(function(e,t){var r;xE(e,null!==(r=t.adjustment.levels)&&void 0!==r?r:4),kE(e,2)})),kx("thrs",eE("threshold"),(function(e,t,r){t.adjustment={type:"threshold",level:rb(e)},mb(e,r())}),(function(e,t){var r;xE(e,null!==(r=t.adjustment.level)&&void 0!==r?r:128),kE(e,2)}));var pE=["","","","rgb","hsb","","lab"];function vE(e){return{c:tb(e),m:tb(e),y:tb(e),k:tb(e)}}function yE(e,t){var r=t||{};bE(e,r.c),bE(e,r.m),bE(e,r.y),bE(e,r.k)}function gE(e){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return Array.isArray(e)&&e.length>1}))}kx("grdm",eE("gradient map"),(function(e,t,r){if(1!==rb(e))throw new Error("Invalid grdm version");var n={type:"gradient map",gradientType:"solid"};n.reverse=!!Qm(e),n.dither=!!Qm(e),n.name=vb(e),n.colorStops=[],n.opacityStops=[];for(var i=rb(e),o=0;o<i;o++)n.colorStops.push({location:ab(e),midpoint:ab(e)/100,color:Bb(e)}),mb(e,2);var a=rb(e);for(o=0;o<a;o++)n.opacityStops.push({location:ab(e),midpoint:ab(e)/100,opacity:rb(e)/255});if(2!==rb(e))throw new Error("Invalid grdm expansion count");var s=rb(e);if(n.smoothness=s/4096,32!==rb(e))throw new Error("Invalid grdm length");n.gradientType=rb(e)?"noise":"solid",n.randomSeed=ab(e),n.addTransparency=!!rb(e),n.restrictColors=!!rb(e),n.roughness=ab(e)/4096,n.colorModel=pE[rb(e)]||"rgb",n.min=[rb(e)/32768,rb(e)/32768,rb(e)/32768,rb(e)/32768],n.max=[rb(e)/32768,rb(e)/32768,rb(e)/32768,rb(e)/32768],mb(e,r());for(var l=0,c=n.colorStops;l<c.length;l++){c[l].location/=s}for(var u=0,h=n.opacityStops;u<h.length;u++){h[u].location/=s}t.adjustment=n}),(function(e,t){var r,n,i,o=t.adjustment;xE(e,1),mE(e,o.reverse?1:0),mE(e,o.dither?1:0),PE(e,o.name||""),xE(e,o.colorStops&&o.colorStops.length||0);for(var a=Math.round(4096*(null!==(r=o.smoothness)&&void 0!==r?r:1)),s=0,l=o.colorStops||[];s<l.length;s++){var c=l[s];_E(e,Math.round(c.location*a)),_E(e,Math.round(100*c.midpoint)),BE(e,c.color),kE(e,2)}xE(e,o.opacityStops&&o.opacityStops.length||0);for(var u=0,h=o.opacityStops||[];u<h.length;u++){c=h[u];_E(e,Math.round(c.location*a)),_E(e,Math.round(100*c.midpoint)),xE(e,Math.round(255*c.opacity))}xE(e,2),xE(e,a),xE(e,32),xE(e,"noise"===o.gradientType?1:0),_E(e,o.randomSeed||0),xE(e,o.addTransparency?1:0),xE(e,o.restrictColors?1:0),_E(e,Math.round(4096*(null!==(n=o.roughness)&&void 0!==n?n:1)));var d=pE.indexOf(null!==(i=o.colorModel)&&void 0!==i?i:"rgb");xE(e,-1===d?3:d);for(var f=0;f<4;f++)xE(e,Math.round(32768*(o.min&&o.min[f]||0)));for(f=0;f<4;f++)xE(e,Math.round(32768*(o.max&&o.max[f]||0)));kE(e,4)})),kx("selc",eE("selective color"),(function(e,t){if(1!==rb(e))throw new Error("Invalid selc version");var r=rb(e)?"absolute":"relative";mb(e,8),t.adjustment={type:"selective color",mode:r,reds:vE(e),yellows:vE(e),greens:vE(e),cyans:vE(e),blues:vE(e),magentas:vE(e),whites:vE(e),neutrals:vE(e),blacks:vE(e)}}),(function(e,t){var r=t.adjustment;xE(e,1),xE(e,"absolute"===r.mode?1:0),kE(e,8),yE(e,r.reds),yE(e,r.yellows),yE(e,r.greens),yE(e,r.cyans),yE(e,r.blues),yE(e,r.magentas),yE(e,r.whites),yE(e,r.neutrals),yE(e,r.blacks)})),kx("CgEd",(function(e){var t=e.adjustment;return!!t&&("brightness/contrast"===t.type&&!t.useLegacy||("levels"===t.type||"curves"===t.type||"exposure"===t.type||"channel mixer"===t.type||"hue/saturation"===t.type)&&void 0!==t.presetFileName)}),(function(e,t,r){var n=Wy(e);if(1!==n.Vrsn)throw new Error("Invalid CgEd version");t.adjustment="presetFileName"in n?Tx(Tx({},t.adjustment),{presetKind:n.presetKind,presetFileName:n.presetFileName}):"curvesPresetFileName"in n?Tx(Tx({},t.adjustment),{presetKind:n.curvesPresetKind,presetFileName:n.curvesPresetFileName}):"mixerPresetFileName"in n?Tx(Tx({},t.adjustment),{presetKind:n.mixerPresetKind,presetFileName:n.mixerPresetFileName}):{type:"brightness/contrast",brightness:n.Brgh,contrast:n.Cntr,meanValue:n.means,useLegacy:!!n.useLegacy,labColorOnly:!!n["Lab "],auto:!!n.Auto},mb(e,r())}),(function(e,t){var r,n,i,o,a=t.adjustment;if("levels"===a.type||"exposure"===a.type||"hue/saturation"===a.type)Yy(e,"","null",{Vrsn:1,presetKind:null!==(r=a.presetKind)&&void 0!==r?r:1,presetFileName:a.presetFileName||""});else if("curves"===a.type){Yy(e,"","null",{Vrsn:1,curvesPresetKind:null!==(n=a.presetKind)&&void 0!==n?n:1,curvesPresetFileName:a.presetFileName||""})}else if("channel mixer"===a.type){Yy(e,"","null",{Vrsn:1,mixerPresetKind:null!==(i=a.presetKind)&&void 0!==i?i:1,mixerPresetFileName:a.presetFileName||""})}else{if("brightness/contrast"!==a.type)throw new Error("Unhandled CgEd case");Yy(e,"","null",{Vrsn:1,Brgh:a.brightness||0,Cntr:a.contrast||0,means:null!==(o=a.meanValue)&&void 0!==o?o:127,"Lab ":!!a.labColorOnly,useLegacy:!!a.useLegacy,Auto:!!a.auto})}})),kx("Txt2",Rx("engineData"),(function(e,t,r,n){var i=hb(e,r());t.engineData=Ee(i);var o=function(e){var t=[];return function e(r){var n;if(r.children)for(var i=0,o=r.children;i<o.length;i++){var a=o[i];void 0!==(null===(n=a.text)||void 0===n?void 0:n.index)&&(t[a.text.index]=a),e(a)}}(e),t}(n),a=Ax(qb(i)).ResourceDict.TextFrameSet;if(a)for(var s=0;s<a.length;s++){var l=o[s];a[s].path&&(null==l?void 0:l.text)&&(l.text.textPath=a[s].path)}}),(function(e,t){ME(e,xe(t.engineData))})),kx("FEid",Rx("filterEffectsMasks"),(function(e,t,r){var n=ib(e);if(n<1||n>3)throw new Error("Invalid filterEffects version ".concat(n));for(t.filterEffectsMasks=[];r()>8;){if(ab(e))throw new Error("filterEffects: 64 bit length is not supported");var i=ab(e),o=e.offset+i,a=pb(e,1),s=ib(e);if(1!==s)throw new Error("Invalid filterEffect version ".concat(s));if(ab(e))throw new Error("filterEffect: 64 bit length is not supported");ab(e);for(var l=ib(e),c=ib(e),u=ib(e),h=ib(e),d=ib(e),f=ib(e),p=[],v=0;v<f+2;v++){if(ib(e)){if(ab(e))throw new Error("filterEffect: 64 bit length is not supported");var y=ab(e);if(!y)throw new Error("filterEffect: Empty channel");var g=rb(e),m=hb(e,y-2);p.push({compressionMode:g,data:m})}else p.push(void 0)}if(t.filterEffectsMasks.push({id:a,top:l,left:c,bottom:u,right:h,depth:d,channels:p}),e.offset<o&&Qm(e)){var b=ib(e),x=ib(e),E=ib(e),w=ib(e);if(ab(e))throw new Error("filterEffect: 64 bit length is not supported");var S=ab(e);g=rb(e),m=hb(e,S-2);t.filterEffectsMasks[t.filterEffectsMasks.length-1].extra={top:b,left:x,bottom:E,right:w,compressionMode:g,data:m}}e.offset=o;for(var _=i;_%4;)e.offset++,_++}}),(function(e,t){var r;wE(e,3);for(var n=0,i=t.filterEffectsMasks;n<i.length;n++){var o=i[n];_E(e,0),_E(e,0);var a=e.offset;RE(e,o.id,1),wE(e,1),_E(e,0),_E(e,0);var s=e.offset;wE(e,o.top),wE(e,o.left),wE(e,o.bottom),wE(e,o.right),wE(e,o.depth);var l=Math.max(0,o.channels.length-2);wE(e,l);for(var c=0;c<l+2;c++){var u=o.channels[c];wE(e,u?1:0),u&&(_E(e,0),_E(e,u.data.length+2),xE(e,u.compressionMode),ME(e,u.data))}e.view.setUint32(s-4,e.offset-s,!1);var h=null===(r=t.filterEffectsMasks[t.filterEffectsMasks.length-1])||void 0===r?void 0:r.extra;h&&(mE(e,1),wE(e,h.top),wE(e,h.left),wE(e,h.bottom),wE(e,h.right),_E(e,0),_E(e,h.data.byteLength+2),xE(e,h.compressionMode),ME(e,h.data));var d=e.offset-a;for(e.view.setUint32(a-4,d,!1);d%4;)kE(e,1),d++}})),Lx("FXid","FEid"),kx("FMsk",Rx("filterMask"),(function(e,t){t.filterMask={colorSpace:Bb(e),opacity:rb(e)/255}}),(function(e,t){var r;BE(e,t.filterMask.colorSpace),xE(e,255*ey(null!==(r=t.filterMask.opacity)&&void 0!==r?r:1,0,1))})),kx("artd",(function(e){return void 0!==e.artboards}),(function(e,t,r){var n=Wy(e);t.artboards={count:n["Cnt "],autoExpandOffset:{horizontal:n.autoExpandOffset.Hrzn,vertical:n.autoExpandOffset.Vrtc},origin:{horizontal:n.origin.Hrzn,vertical:n.origin.Vrtc},autoExpandEnabled:n.autoExpandEnabled,autoNestEnabled:n.autoNestEnabled,autoPositionEnabled:n.autoPositionEnabled,shrinkwrapOnSaveEnabled:!!n.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:vg(n.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:n.docDefaultNewArtboardBackgroundType},mb(e,r())}),(function(e,t){var r,n,i,o,a,s=t.artboards;Yy(e,"","null",{"Cnt ":s.count,autoExpandOffset:s.autoExpandOffset?{Hrzn:s.autoExpandOffset.horizontal,Vrtc:s.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:s.origin?{Hrzn:s.origin.horizontal,Vrtc:s.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:null===(r=s.autoExpandEnabled)||void 0===r||r,autoNestEnabled:null===(n=s.autoNestEnabled)||void 0===n||n,autoPositionEnabled:null===(i=s.autoPositionEnabled)||void 0===i||i,shrinkwrapOnSaveEnabled:null===(o=s.shrinkwrapOnSaveEnabled)||void 0===o||o,docDefaultNewArtboardBackgroundColor:yg(s.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:null!==(a=s.docDefaultNewArtboardBackgroundType)&&void 0!==a?a:1},"artd")})),kx("lfx2",(function(e){return void 0!==e.effects&&!gE(e.effects)}),(function(e,t,r){if(0!==ab(e))throw new Error("Invalid lfx2 version");var n=Wy(e);t.effects=eg(n,!!e.logMissingFeatures),mb(e,r())}),(function(e,t,r,n){var i=Qy(t.effects,!!n.logMissingFeatures,!0);_E(e,0),Yy(e,"","null",i)})),kx("cinf",Rx("compositorUsed"),(function(e,t,r){var n=Wy(e);function i(e){return e.split(".")[1]}t.compositorUsed={description:n.description,reason:n.reason,engine:i(n.Engn)},n.Vrsn&&(t.compositorUsed.version=n.Vrsn),n.psVersion&&(t.compositorUsed.photoshopVersion=n.psVersion),n.enableCompCore&&(t.compositorUsed.enableCompCore=i(n.enableCompCore)),n.enableCompCoreGPU&&(t.compositorUsed.enableCompCoreGPU=i(n.enableCompCoreGPU)),n.enableCompCoreThreads&&(t.compositorUsed.enableCompCoreThreads=i(n.enableCompCoreThreads)),n.compCoreSupport&&(t.compositorUsed.compCoreSupport=i(n.compCoreSupport)),n.compCoreGPUSupport&&(t.compositorUsed.compCoreGPUSupport=i(n.compCoreGPUSupport)),mb(e,r())}),(function(e,t){var r=t.compositorUsed,n={Vrsn:r.version||{major:1,minor:0,fix:0}};r.photoshopVersion&&(n.psVersion=r.photoshopVersion),n.description=r.description,n.reason=r.reason,n.Engn="Engn.".concat(r.engine),r.enableCompCore&&(n.enableCompCore="enable.".concat(r.enableCompCore)),r.enableCompCoreGPU&&(n.enableCompCoreGPU="enable.".concat(r.enableCompCoreGPU)),r.enableCompCoreThreads&&(n.enableCompCoreThreads="enable.".concat(r.enableCompCoreThreads)),r.compCoreSupport&&(n.compCoreSupport="reason.".concat(r.compCoreSupport)),r.compCoreGPUSupport&&(n.compCoreGPUSupport="reason.".concat(r.compCoreGPUSupport)),Yy(e,"","null",n)})),kx("extn",(function(e){return void 0!==e._extn}),(function(e,t){Wy(e)}),(function(e,t){})),kx("iOpa",Rx("fillOpacity"),(function(e,t){t.fillOpacity=Qm(e)/255,mb(e,3)}),(function(e,t){mE(e,255*t.fillOpacity),kE(e,3)})),kx("brst",Rx("channelBlendingRestrictions"),(function(e,t,r){for(t.channelBlendingRestrictions=[];r()>4;)t.channelBlendingRestrictions.push(ib(e))}),(function(e,t){for(var r=0,n=t.channelBlendingRestrictions;r<n.length;r++){wE(e,n[r])}})),kx("tsly",Rx("transparencyShapesLayer"),(function(e,t){t.transparencyShapesLayer=!!Qm(e),mb(e,3)}),(function(e,t){mE(e,t.transparencyShapesLayer?1:0),kE(e,3)}));function mE(e,t){var r=NE(e,1);e.view.setUint8(r,t)}function bE(e,t){var r=NE(e,2);e.view.setInt16(r,t,!1)}function xE(e,t){var r=NE(e,2);e.view.setUint16(r,t,!1)}function EE(e,t){var r=NE(e,2);e.view.setUint16(r,t,!0)}function wE(e,t){var r=NE(e,4);e.view.setInt32(r,t,!1)}function SE(e,t){var r=NE(e,4);e.view.setInt32(r,t,!0)}function _E(e,t){var r=NE(e,4);e.view.setUint32(r,t,!1)}function CE(e,t){var r=NE(e,4);e.view.setFloat32(r,t,!1)}function AE(e,t){var r=NE(e,8);e.view.setFloat64(r,t,!1)}function TE(e,t){wE(e,65536*t)}function OE(e,t){wE(e,t*(1<<24))}function ME(e,t){t&&(DE(e,e.offset+t.length),new Uint8Array(e.buffer).set(t,e.offset),e.offset+=t.length)}function kE(e,t){for(var r=0;r<t;r++)mE(e,0)}function LE(e,t){if(4!==t.length)throw new Error("Invalid signature: '".concat(t,"'"));for(var r=0;r<4;r++)mE(e,t.charCodeAt(r))}function RE(e,t,r){var n=t.length;if(n>255)throw new Error("String too long");mE(e,n);for(var i=0;i<n;i++){var o=t.charCodeAt(i);mE(e,o<128?o:"?".charCodeAt(0))}for(;++n%r;)mE(e,0)}function IE(e,t){_E(e,t.length),function(e,t){for(var r=0;r<t.length;r++)xE(e,t.charCodeAt(r))}(e,t)}function PE(e,t){_E(e,t.length+1);for(var r=0;r<t.length;r++)xE(e,t.charCodeAt(r));xE(e,0)}function FE(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),i&&_E(e,0);var o=e.offset;_E(e,0),r();for(var a=e.offset-o-4,s=a;s%t!=0;)mE(e,0),s++;n&&(a=s),e.view.setUint32(o,a,!1)}function DE(e,t){t>e.buffer.byteLength&&function(e,t){var r=e.buffer.byteLength;do{r*=2}while(t>r);var n=new ArrayBuffer(r),i=new Uint8Array(n),o=new Uint8Array(e.buffer);i.set(o),e.buffer=n,e.view=new DataView(e.buffer)}(e,t)}function NE(e,t){var r=e.offset;return DE(e,e.offset+=t),r}function BE(e,t){t?"r"in t?(xE(e,0),xE(e,Math.round(257*t.r)),xE(e,Math.round(257*t.g)),xE(e,Math.round(257*t.b)),xE(e,0)):"fr"in t?(xE(e,0),xE(e,Math.round(255*t.fr*257)),xE(e,Math.round(255*t.fg*257)),xE(e,Math.round(255*t.fb*257)),xE(e,0)):"l"in t?(xE(e,7),bE(e,Math.round(1e4*t.l)),bE(e,Math.round(t.a<0?12800*t.a:12700*t.a)),bE(e,Math.round(t.b<0?12800*t.b:12700*t.b)),xE(e,0)):"h"in t?(xE(e,1),xE(e,Math.round(65535*t.h)),xE(e,Math.round(65535*t.s)),xE(e,Math.round(65535*t.b)),xE(e,0)):"c"in t?(xE(e,2),xE(e,Math.round(257*t.c)),xE(e,Math.round(257*t.m)),xE(e,Math.round(257*t.y)),xE(e,Math.round(257*t.k))):(xE(e,8),xE(e,Math.round(1e4*t.k/255)),kE(e,6)):(xE(e,0),kE(e,8))}var UE,zE,GE,XE;function HE(e,t,r){return Z(this,void 0,void 0,(function(){var n,i,o,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C,A,T,O,M,k,L,R,I,P,F,D,N,B,U,z,G,X,H,j,W,Y,q,V,Z,Q,ee,te,re,ne,ie,oe,ae,se,le,ce,ue,he,de,fe,pe,ve,ye,ge,me,be,xe,Ee,we,Se,_e,Ce,Ae,Te,Oe,Me,ke,Le,Re,Ie,Pe,Fe,De,Ne,Be,Ue,ze,Ge,Xe,He,je,We,Ye,qe,Ve,Ke,Ze,Je,$e,Qe,et,tt,rt,nt,it,ot,at,st,lt,ct,ut,ht,dt,ft,pt,vt,yt,gt,mt,bt,xt,Et,wt,St,_t,Ct,At,Tt,Ot,Mt,kt,Lt,Rt,It;return J(this,(function(J){switch(J.label){case 0:if(n=e.name,i=e.opacity,o=e.hidden,l=e.top,c=void 0===l?0:l,u=e.left,h=void 0===u?0:u,d=e.bottom,f=void 0===d?0:d,p=e.right,v=void 0===p?0:p,y=e.effects,g=void 0===y?{}:y,m=e.blendMode,b=e.canvas,x=o?"hidden":"visible",E=[],w=[],S=[],_=[],C=[],A=[],T=[],O=[],M=new Promise((function(e){if(!b)return e(void 0);b.toBlob((function(o){if(o)return e({tagName:s.BITMAP,props:{uuid:a(),name:n,style:{left:100*h/t+"%",top:100*c/r+"%",right:100*(t-v)/t+"%",bottom:100*(r-f)/r+"%",opacity:i,visibility:x,shadow:E,shadowEnable:w,innerShadow:S,innerShadowEnable:_,mixBlendMode:m,fill:C,fillEnable:A,fillOpacity:T,fillMode:O},src:URL.createObjectURL(o)}});e(void 0)}))})),g.dropShadow)for(be=g.dropShadow.length-1;be>=0;be--)G=g.dropShadow[be],st=$($([],YE(G.color),!0),[null!==(ht=G.opacity)&&void 0!==ht?ht:1],!1),L=xd(G.angle||0),Qe=(null===(dt=G.distance)||void 0===dt?void 0:dt.value)||0,R=Math.acos(L)*Qe||0,I=Math.sin(L)*Qe||0,k=(null===(ft=G.size)||void 0===ft?void 0:ft.value)||0,F=(null===(pt=G.choke)||void 0===pt?void 0:pt.value)||0,E.push("".concat(Jf(st)," ").concat(R," ").concat(I," ").concat(k*(100-F)*.01," ").concat(k*F*.01)),w.push(!g.disabled&&!!G.enabled);if(g.innerShadow)for(be=g.innerShadow.length-1;be>=0;be--)G=g.innerShadow[be],st=$($([],YE(G.color),!0),[null!==(vt=G.opacity)&&void 0!==vt?vt:1],!1),L=xd(G.angle||0),Qe=(null===(yt=G.distance)||void 0===yt?void 0:yt.value)||0,R=Math.acos(L)*Qe||0,I=Math.sin(L)*Qe||0,P=(null===(gt=G.size)||void 0===gt?void 0:gt.value)||0,F=(null===(mt=G.choke)||void 0===mt?void 0:mt.value)||0,S.push("".concat(Jf(st)," ").concat(R," ").concat(I," ").concat(P*(100-F)*.01," ").concat(P*F*.01)),_.push(!g.disabled&&!!G.enabled);if(g.solidFill)for(be=g.solidFill.length-1;be>=0;be--)G=g.solidFill[be],C.push($($([],YE(G.color),!0),[null!==(bt=G.opacity)&&void 0!==bt?bt:1],!1)),A.push(!!G.enabled),T.push(null!==(xt=G.opacity)&&void 0!==xt?xt:1),O.push(G.blendMode||"normal");if(void 0===e.opened)return[3,7];if(D=[],!e.children)return[3,6];be=0,N=e.children.length,J.label=1;case 1:return be<N?[4,HE(B=e.children[be],t,r)]:[3,6];case 2:return(xe=J.sent())?B.mask?[4,jE(B,t,r)]:[3,4]:[3,5];case 3:(z=J.sent())&&(xe=WE(xe,z)),B.clipping||(xe.props.style.breakMask=!0),J.label=4;case 4:if(B.clipping&&D.length)for(U=be-1;U>=0;U--)if(!e.children[U].clipping){Qe=be-U,(z=D[D.length-Qe]).props.style.maskMode="alpha-with";break}D.push(xe),J.label=5;case 5:return be++,[3,1];case 6:return D.forEach((function(e,t){e.props.index=(t+1)/(D.length+1)})),[2,{tagName:s.GROUP,props:{uuid:a(),name:n,isExpanded:e.opened,style:{left:100*h/t+"%",top:100*c/r+"%",right:100*v/t+"%",bottom:100*f/r+"%",opacity:i,visibility:x,shadow:E,shadowEnable:w,innerShadow:S,innerShadowEnable:_,mixBlendMode:m,fill:C,fillEnable:A,fillOpacity:T,fillMode:O}},children:D}];case 7:if(e.text){if(e.text.textPath&&e.text.textPath.bezierCurve)return[2,M];if(Pe=[],Ie=[],Fe=[],De=[],g.stroke)for(be=g.stroke.length-1;be>=0;be--)"color"===(G=g.stroke[be]).fillType&&(Pe.push(!g.disabled&&!!G.enabled),Ie.push(Jf($($([],YE(G.color),!0),[null!==(Et=G.opacity)&&void 0!==Et?Et:1],!1))),Fe.push((null===(wt=G.size)||void 0===wt?void 0:wt.value)||1),De.push(G.position||"center"));if(X=e.text.transform||[1,0,1,0,0,0],H=[],j=e.text.style||{},W=j.font,Y=(void 0===W?{}:W).name,q=void 0===Y?dh.defaultFontFamily:Y,V=j.fontSize,Z=void 0===V?dh.defaultFontSize:V,Q=j.fauxBold,ee=j.fauxItalic,te=j.autoKerning,re=j.kerning,ne=void 0===re?0:re,ie=j.autoLeading,oe=j.leading,ae=void 0===oe?0:oe,se=j.fillColor,le=j.underline,ce=j.strikethrough,ue=(e.text.paragraphStyle||{}).justification,he=[],le&&he.push("underline"),ce&&he.push("lineThrough"),de={fontFamily:q,fontSize:Z*X[0],fontWeight:Q?"bold":"normal",fontStyle:ee?"italic":"normal",letterSpacing:te?0:ne,textAlign:ue||"left",color:Jf(se?YE(se):[0,0,0]),textDecoration:he,lineHeight:ie?0:ae*X[0],paragraphSpacing:0},Xe=K(K({left:100*(h+.5*(v-h))/t+"%",top:100*(c+.5*(f-c))/r+"%",opacity:i,visibility:x,translateX:"-50%",translateY:"-50%"},de),{stroke:Ie,strokeEnable:Pe,strokePosition:De,strokeWidth:Fe,shadow:E,shadowEnable:w,innerShadow:S,innerShadowEnable:_,mixBlendMode:m,fill:C,fillEnable:A,fillOpacity:T,fillMode:O}),fe=e.text,pe=fe.styleRuns,ve=fe.paragraphStyleRuns,pe||ve)for(ye=0,ge=(pe||[]).slice(0),me=(ve||[]).slice(0),be=0;ge.length||me.length;)xe={location:ye,length:1,fontFamily:q,fontSize:Z*X[0],fontWeight:de.fontWeight,fontStyle:de.fontStyle,letterSpacing:ne,lineHeight:ie?0:ae*X[0],textAlign:ue?{left:"left","justify-left":"left",center:"center","justify-center":"center",right:"right","justify-right":"right",justify:"justify","justify-all":"justify"}[ue]:"left",color:Zf(de.color),textDecoration:de.textDecoration,paragraphSpacing:0},Ee=-1,we=-1,ge[0]&&(Ee=ge[0].length),me[0]&&(we=me[0].length),Ee===we?ye+=Ee:(-1!==Ee&&-1!==we&&(Ee>we?Ee=-1:we=-1),ye+=Math.max(Ee,we),Ee>-1&&me[0]&&(me[0].length-=Ee),we>-1&&ge[0]&&(ge[0].length-=we)),Ee>-1&&(Se=ge.shift(),_e=Se.length,Ce=Se.style,xe.length=_e,Ce.font&&(xe.fontFamily=Ce.font.name),void 0!==Ce.fauxBold&&(xe.fontWeight=Ce.fauxBold?"bold":"normal"),void 0!==Ce.fauxItalic&&(xe.fontStyle=Ce.fauxItalic?"italic":"normal"),void 0!==Ce.fontSize&&(xe.fontSize=Ce.fontSize*X[0]),Ce.autoKerning||void 0===Ce.kerning||(xe.letterSpacing=Ce.kerning),Ce.autoLeading||void 0===Ce.leading||(xe.lineHeight=Ce.leading*X[0]),Ce.fillColor&&(xe.color=YE(Ce.fillColor||se)),void 0===Ce.strikethrough&&void 0===Ce.underline||(Ae=[],Ce.strikethrough&&Ae.push("lineThrough"),Ce.underline&&Ae.push("underline"),xe.textDecoration=Ae)),we>-1&&(Te=me.shift(),Oe=Te.length,Me=Te.style,xe.length=Oe,Me.justification&&(xe.textAlign={left:"left","justify-left":"left",center:"center","justify-center":"center",right:"right","justify-right":"right",justify:"justify","justify-all":"justify"}[Me.justification])),H.push(xe);return[2,{tagName:s.TEXT,props:{uuid:a(),name:n,style:Xe,content:e.text.text,rich:H}}]}if(e.vectorOrigination&&1===e.vectorOrigination.keyDescriptorList.length&&!e.vectorOrigination.keyDescriptorList[0].keyShapeInvalidated){if(ke=e.vectorFill,Le=e.vectorStroke,Re=e.vectorOrigination.keyDescriptorList,Ie=[],Pe=[],Fe=[],De=[],Ne=[],ke){if("color"===ke.type)C.push(Jf(YE(ke.color)));else if("solid"===ke.type){if(Be=ke.angle,Ue=void 0===Be?0:Be,ze=ke.colorStops,Ge=ke.opacityStops,Xe=ke.style,He=ke.reverse,je=ke.align,We=null!==(St=ke.scale)&&void 0!==St?St:1,Ye="","linear"===Xe)qe=Ue+90,!1===je&&qe%90!=0||1!==We?(Ve=zf(qe,0,0,t,r),Ke=Ve.x1,Ze=Ve.y1,Je=Ve.x2,$e=Ve.y2,Qe=[Ff(Ke/t*We),Ff(Ze/r*We),Ff(Je/t*We),Ff($e/r*We)],Ye="linear-gradient(".concat(Qe.join(" "),", ")):(He&&(qe>=0?qe-=180:qe+=180),Ye="linear-gradient(".concat(qe,"deg, ")),We=1;else if("radial"===Xe)Ye="radial-gradient(0.5 0.5 ",Ye+=t>=r?.5*(t+r)/t+" 1, ":"1 "+.5*(t+r)/r+", ";else{if("angle"!==Xe)return b?[2,M]:[2];Ye="conic-gradient(",We=1}et=[],ze.forEach((function(e,t){var r,n;et.push({color:$($([],YE(e.color),!0),[null!==(n=null===(r=Ge[t])||void 0===r?void 0:r.opacity)&&void 0!==n?n:1],!1),offset:e.location*We})})),"angle"===Xe&&Ue&&(tt=Ue/360,et.forEach((function(e){e.offset-=tt})),rt=et[0],nt=et[et.length-1],rt.offset>0&&nt.offset>1?(it=et[et.length-2],at=(1-it.offset)/(nt.offset-it.offset),st=nt.color.slice(0),nt.color=hp([it.color[0]+(nt.color[0]-it.color[0])*at,it.color[1]+(nt.color[1]-it.color[1])*at,it.color[2]+(nt.color[2]-it.color[2])*at,null!==(_t=it.color[3])&&void 0!==_t?_t:1+(null!==(At=null!==(Ct=nt.color[3])&&void 0!==Ct?Ct:1-it.color[3])&&void 0!==At?At:1)*at]),nt.offset=1,et.unshift({color:st,offset:Math.max(0,rt.offset-1e-8)})):rt.offset<0&&nt.offset<1&&(ot=et[1],at=-rt.offset/(ot.offset-rt.offset),st=rt.color.slice(0),rt.color=hp([rt.color[0]+(ot.color[0]-rt.color[0])*at,rt.color[1]+(ot.color[1]-rt.color[1])*at,rt.color[2]+(ot.color[2]-rt.color[2])*at,null!==(Tt=rt.color[3])&&void 0!==Tt?Tt:1+(null!==(Mt=null!==(Ot=ot.color[3])&&void 0!==Ot?Ot:1-rt.color[3])&&void 0!==Mt?Mt:1)*at]),rt.offset=1,et.push({color:st,offset:Math.min(1,nt.offset+1e-8)}))),et.forEach((function(e,t){t&&(Ye+=", "),Ye+=Jf(e.color)+" "+100*e.offset+"%"})),Ye+=")",C.push(Ye)}A.push(null===(kt=null==Le?void 0:Le.fillEnabled)||void 0===kt||kt),T.push(1),O.push("normal")}return Le&&(Ie.push(Jf($($([],YE(null===(Lt=Le.content)||void 0===Lt?void 0:Lt.color),!0),[null!==(Rt=Le.opacity)&&void 0!==Rt?Rt:1],!1))),Pe.push(!!Le.strokeEnabled),Fe.push((null===(It=Le.lineWidth)||void 0===It?void 0:It.value)||1),De.push(Le.lineAlignment||"center"),Ne.push(Le.blendMode||"normal")),lt=v-h,ct=f-c,ut=[],Re.forEach((function(e){var t=e.keyOriginRRectRadii,r=e.keyOriginShapeBoundingBox;r&&(ut.push({x:((r.left.value||h)-h)/lt,y:((r.top.value||c)-c)/ct,cornerRadius:(null==t?void 0:t.topLeft.value)||0,curveMode:Vu.STRAIGHT,cornerStyle:Ku.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),ut.push({x:(((null==r?void 0:r.right.value)||v)-h)/lt,y:(((null==r?void 0:r.top.value)||c)-c)/ct,cornerRadius:(null==t?void 0:t.topRight.value)||0,curveMode:Vu.STRAIGHT,cornerStyle:Ku.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),ut.push({x:(((null==r?void 0:r.right.value)||v)-h)/lt,y:(((null==r?void 0:r.bottom.value)||f)-c)/ct,cornerRadius:(null==t?void 0:t.bottomLeft.value)||0,curveMode:Vu.STRAIGHT,cornerStyle:Ku.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),ut.push({x:(((null==r?void 0:r.left.value)||h)-h)/lt,y:(((null==r?void 0:r.bottom.value)||f)-c)/ct,cornerRadius:(null==t?void 0:t.bottomRight.value)||0,curveMode:Vu.STRAIGHT,cornerStyle:Ku.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}))})),[2,{tagName:s.POLYLINE,props:{uuid:a(),name:n,style:{left:100*h/t+"%",top:100*c/r+"%",right:100*(t-v)/t+"%",bottom:100*(r-f)/r+"%",opacity:i,visibility:x,fill:C,fillEnable:A,fillOpacity:T,fillMode:O,stroke:Ie,strokeEnable:Pe,strokePosition:De,strokeWidth:Fe,strokeMode:Ne,shadow:E,shadowEnable:w,innerShadow:S,innerShadowEnable:_,mixBlendMode:m},points:ut,isClosed:!0}}]}if(b)return[2,M];J.label=8;case 8:return[2]}}))}))}function jE(e,t,r){return Z(this,void 0,void 0,(function(){var n,i,o,l,c,u,h,d,f,p,v,y,g,m,b;return J(this,(function(x){return n=e.mask,i=n.top,o=void 0===i?0:i,l=n.left,c=void 0===l?0:l,u=n.bottom,h=void 0===u?0:u,d=n.right,f=void 0===d?0:d,p=n.canvas,v=n.defaultColor,p?(y=p,(o>e.top||c>e.left||f<e.right||h<e.bottom)&&(m=e.right-e.left,b=e.bottom-e.top,g=dh.getOffscreenCanvas(m,b),y=g.canvas,v&&(g.ctx.fillStyle=Jf([v,v,v]),o>e.top&&g.ctx.fillRect(0,0,m,o-e.top),h<e.bottom&&g.ctx.fillRect(0,h-e.top,m,e.bottom-h),c>e.left&&g.ctx.fillRect(0,0,c-e.left,b),f<e.right&&g.ctx.fillRect(f-e.left,0,e.right-f,b)),g.ctx.drawImage(p,c-e.left,o-e.top)),[2,new Promise((function(n){y.toBlob((function(i){if(g&&g.release(),i)return n({tagName:s.BITMAP,props:{uuid:a(),name:e.name+" mask",style:{left:100*e.left/t+"%",top:100*e.top/r+"%",right:100*(t-e.right)/t+"%",bottom:100*(r-e.bottom)/r+"%",maskMode:"gray"},src:URL.createObjectURL(i)}});n(void 0)}))}))]):[2]}))}))}function WE(e,t){var r=e.props.style,n={tagName:s.GROUP,props:{uuid:a(),name:e.props.name,isExpanded:!0,style:{left:r.left,top:r.top,right:r.right,bottom:r.bottom}},children:[t,e]};r.left=0,r.top=0,r.right=0,r.bottom=0,e.props.name+=" origin";var i=t.props.style;return i.left=0,i.top=0,i.right=0,i.bottom=0,r.mixBlendMode&&(i.mixBlendMode=r.mixBlendMode),delete r.mixBlendMode,n}function YE(e){if(!e)return[0,0,0];if(e.hasOwnProperty("a"))e.r,e.g,e.b,e.a;else if(e.hasOwnProperty("fr"))return[255*e.fr,255*e.fg,255*e.fb];return[e.r,e.g,e.b]}function qE(e){return e>=XE.REFLOW}function VE(e){return"width"===e||"height"===e||"letterSpacing"===e||"paragraphSpacing"===e||"textAlign"===e||"textVerticalAlign"===e||"fontFamily"===e||"fontSize"===e||"fontWeight"===e||"fontStyle"===e||"lineHeight"===e||"left"===e||"top"===e||"right"===e||"bottom"===e}function KE(e){return"pointerEvents"===e||"constrainProportions"===e||"isLocked"===e||"isSelected"===e||"resizesContent"===e||"isRectangle"===e?XE.NONE:"translateX"===e?XE.TRANSLATE_X:"translateY"===e?XE.TRANSLATE_Y:"rotateZ"===e?XE.ROTATE_Z:"scaleX"===e?XE.SCALE_X:"scaleY"===e?XE.SCALE_Y:"transformOrigin"===e||"matrix"===e?XE.TRANSFORM:"opacity"===e?XE.OPACITY:"blur"===e||"shadow"===e||"shadowEnable"===e||"hueRotate"===e||"saturate"===e||"brightness"===e||"contrast"===e?XE.FILTER:"mixBlendMode"===e?XE.MIX_BLEND_MODE:"maskMode"===e?XE.MASK:"breakMask"===e?XE.BREAK_MASK:VE(e)?XE.REFLOW:XE.REPAINT}!function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"}(UE||(UE={})),function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"}(zE||(zE={})),function(e){e[e.None=0]="None",e[e.Visibility=1]="Visibility",e[e.Position=2]="Position",e[e.Appearance=4]="Appearance"}(GE||(GE={})),function(e){e[e.NONE=0]="NONE",e[e.CACHE=1]="CACHE",e[e.TRANSLATE_X=2]="TRANSLATE_X",e[e.TRANSLATE_Y=4]="TRANSLATE_Y",e[e.TRANSLATE=6]="TRANSLATE",e[e.ROTATE_Z=8]="ROTATE_Z",e[e.SCALE_X=16]="SCALE_X",e[e.SCALE_Y=32]="SCALE_Y",e[e.SCALE=48]="SCALE",e[e.TRANSFORM=64]="TRANSFORM",e[e.TRANSFORM_ALL=126]="TRANSFORM_ALL",e[e.OPACITY=128]="OPACITY",e[e.FILTER=256]="FILTER",e[e.MIX_BLEND_MODE=512]="MIX_BLEND_MODE",e[e.MASK=1024]="MASK",e[e.BREAK_MASK=2048]="BREAK_MASK",e[e.REPAINT=4096]="REPAINT",e[e.REFLOW=8192]="REFLOW",e[e.REFLOW_TRANSFORM=8446]="REFLOW_TRANSFORM",e[e.REFLOW_OPACITY=8320]="REFLOW_OPACITY",e[e.REFLOW_FILTER=8448]="REFLOW_FILTER",e[e.REBUILD=16384]="REBUILD",e[e.FULL=32767]="FULL"}(XE||(XE={}));var ZE={RefreshLevel:XE,isRepaint:function(e){return e<XE.REFLOW},isReflow:qE,isReflowKey:VE};function JE(e,t,r,n,i){if(void 0===n&&(n=0),void 0===i&&(i=0),t&&t.length){for(var o=-1,a=0,s=t.length;a<s;a++){var l=t[a];if(Array.isArray(l)&&l.length){o=a;break}}if(-1!==o){var c=t[o];4===c.length?e.moveTo(c[2]*r+n,c[3]*r+i):6===c.length?e.moveTo(c[4]*r+n,c[5]*r+i):e.moveTo(c[0]*r+n,c[1]*r+i);for(a=o+1,s=t.length;a<s;a++){l=t[a];Array.isArray(l)&&(2===l.length?e.lineTo(l[0]*r+n,l[1]*r+i):4===l.length?e.quadraticCurveTo(l[0]*r+n,l[1]*r+i,l[2]*r+n,l[3]*r+i):6===l.length&&e.bezierCurveTo(l[0]*r+n,l[1]*r+i,l[2]*r+n,l[3]*r+i,l[4]*r+n,l[5]*r+i))}}}}function $E(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),!e||!e.length)return"";for(var n,i=-1,o=0,a=e.length;o<a;o++){var s=e[o];if(Array.isArray(s)&&s.length){i=o;break}}if(-1===i)return"";var l=e[i];n=4===l.length?"M"+(l[2]+t)+","+(l[3]+r):6===l.length?"M"+(l[4]+t)+","+(l[5]+r):"M"+(l[0]+t)+","+(l[1]+r);for(o=i+1,a=e.length;o<a;o++){s=e[o];Array.isArray(s)&&(2===s.length?n+="L"+(s[0]+t)+","+(s[1]+r):4===s.length?n+="Q"+(s[0]+t)+","+(s[1]+r)+" "+(s[2]+t)+","+(s[3]+r):6===s.length&&(n+="C"+(s[0]+t)+","+(s[1]+r)+" "+(s[2]+t)+","+(s[3]+r)+" "+(s[4]+t)+","+(s[5]+r)))}return n}var QE,ew,tw,rw={canvasPolygon:JE,svgPolygon:$E};function nw(e,t,r){var n=function(e,t,r){var n=iw(e,e.VERTEX_SHADER,t),i=iw(e,e.FRAGMENT_SHADER,r);if(!n||!i)return null;var o=e.createProgram();if(!o)return null;o.vertexShader=n,o.fragmentShader=i,e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o);var a=e.getProgramParameter(o,e.LINK_STATUS);if(!a){var s=e.getProgramInfoLog(o);throw e.deleteProgram(o),e.deleteShader(i),e.deleteShader(n),new Error("Failed to link program: "+s)}return o}(e,t,r);if(!n)throw new Error("Failed to create program");return e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),n}function iw(e,t,r){var n=e.createShader(t);if(null===n)throw new Error("unable to create shader");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error("Failed to compile shader: "+i)}return n}function ow(e,t,r,n,i){var o=e.createTexture();if(aw(e,o,t),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r)e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);else{if(!n||!i)throw new Error("Missing texImageSource or w/h");e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,i,0,e.RGBA,e.UNSIGNED_BYTE,null)}return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),o}function aw(e,t,r){e.activeTexture(e["TEXTURE"+r]),e.bindTexture(e.TEXTURE_2D,t)}function sw(e,t,r,n,i,o,a,s,l,c,u,h){void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=!0),void 0===l&&(l=-1),void 0===c&&(c=-1),void 0===u&&(u=1),void 0===h&&(h=1);var d=i.length;if(d){var f,p,v,y=1===d,g=y?8:12*d,m=y?4:6*d;f=QE&&QE.length===g?QE:QE=new Float32Array(g),p=ew&&ew.length===g?ew:ew=new Float32Array(g),v=tw&&tw.length===m?tw:tw=new Float32Array(m);for(var b=0,x=i.length;b<x;b++){var E=i[b],w=E.opacity,S=E.matrix,_=E.bbox,C=E.coords,A=E.tc;aw(e,E.texture,0);var T=C?xw(C,o,a):bw(_,t,r,o,a,s,S),O=T.t1,M=T.t2,k=T.t3,L=T.t4,R=12*b;f[R]=O.x,f[R+1]=O.y,f[R+2]=L.x,f[R+3]=L.y,f[R+4]=M.x,f[R+5]=M.y,y?(f[R+6]=k.x,f[R+7]=k.y):(f[R+6]=L.x,f[R+7]=L.y,f[R+8]=M.x,f[R+9]=M.y,f[R+10]=k.x,f[R+11]=k.y),A?(p[R]=A.x1,p[R+1]=A.y1,p[R+2]=A.x1,p[R+3]=A.y3,p[R+4]=A.x3,p[R+5]=A.y1,y?(p[R+6]=A.x3,p[R+7]=A.y3):(p[R+6]=A.x1,p[R+7]=A.y3,p[R+8]=A.x3,p[R+9]=A.y1,p[R+10]=A.x3,p[R+11]=A.y3)):(p[R]=0,p[R+1]=0,p[R+2]=0,p[R+3]=1,p[R+4]=1,p[R+5]=0,y?(p[R+6]=1,p[R+7]=1):(p[R+6]=0,p[R+7]=1,p[R+8]=1,p[R+9]=0,p[R+10]=1,p[R+11]=1)),v[R=6*b]=w,v[R+1]=w,v[R+2]=w,v[R+3]=w,y||(v[R+4]=w,v[R+5]=w)}var I=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,I),e.bufferData(e.ARRAY_BUFFER,f,e.STATIC_DRAW);var P=e.getAttribLocation(n,"a_position");e.vertexAttribPointer(P,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(P);var F=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,F),e.bufferData(e.ARRAY_BUFFER,p,e.STATIC_DRAW);var D=e.getAttribLocation(n,"a_texCoords");e.vertexAttribPointer(D,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(D);var N=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,N),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW);var B=e.getAttribLocation(n,"a_opacity");e.vertexAttribPointer(B,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(B);var U=e.getUniformLocation(n,"u_texture");e.uniform1i(U,0);var z=e.getUniformLocation(n,"x1");e.uniform1f(z,l);var G=e.getUniformLocation(n,"y1");e.uniform1f(G,c);var X=e.getUniformLocation(n,"x2");e.uniform1f(X,u);var H=e.getUniformLocation(n,"y2");e.uniform1f(H,h),e.drawArrays(y?e.TRIANGLE_STRIP:e.TRIANGLES,0,m),e.deleteBuffer(I),e.deleteBuffer(F),e.deleteBuffer(N),e.disableVertexAttribArray(P),e.disableVertexAttribArray(D),e.disableVertexAttribArray(B)}}function lw(e,t){var r=function(){var e=new Float32Array(8),t=new Float32Array(8);return e[0]=-1,e[1]=-1,e[2]=-1,e[3]=1,e[4]=1,e[5]=-1,e[6]=1,e[7]=1,t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=1,t[5]=0,t[6]=1,t[7]=1,{vtPoint:e,vtTex:t}}(),n=r.vtPoint,i=r.vtTex,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);var a=e.getAttribLocation(t,"a_position");e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a);var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);var l=e.getAttribLocation(t,"a_texCoords");return e.vertexAttribPointer(l,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(l),{pointBuffer:o,a_position:a,texBuffer:s,a_texCoords:l}}function cw(e,t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var a=lw(e,t),s=a.pointBuffer,l=a.a_position,c=a.texBuffer,u=a.a_texCoords;aw(e,r,0),aw(e,n,1);var h=e.getUniformLocation(t,"u_texture1");e.uniform1i(h,0);var d=e.getUniformLocation(t,"u_texture2");e.uniform1i(d,1);var f=e.getUniformLocation(t,"u_d");e.uniform2f(f,i,o),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(s),e.deleteBuffer(c),e.disableVertexAttribArray(l),e.disableVertexAttribArray(u)}function uw(e,t,r,n,i,o){var a=lw(e,t),s=a.pointBuffer,l=a.a_position,c=a.texBuffer,u=a.a_texCoords,h=e.getUniformLocation(t,"u_texture"),d=e.getUniformLocation(t,"u_pw"),f=e.getUniformLocation(t,"u_ph");e.uniform1f(d,1/n),e.uniform1f(f,1/i);for(var p=e.getUniformLocation(t,"u_direction"),v=e.getUniformLocation(t,"u_r"),y=r,g=ow(e,0,void 0,n,i),m=ow(e,0,void 0,n,i),b=0,x=o.length;b<x;b++){var E=o[b]-1>>1;e.uniform1i(v,E),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),aw(e,y,0),e.uniform1i(h,0),e.uniform1i(p,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,m,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),aw(e,g,0),e.uniform1i(p,1),e.drawArrays(e.TRIANGLE_STRIP,0,4),y=m}return e.deleteBuffer(s),e.deleteBuffer(c),e.disableVertexAttribArray(l),e.disableVertexAttribArray(u),e.deleteTexture(g),m}function hw(e,t,r,n,i,o,a,s){void 0===s&&(s=1);var l=lw(e,t),c=l.pointBuffer,u=l.a_position,h=l.texBuffer,d=l.a_texCoords,f=e.getUniformLocation(t,"u_x"),p=e.getUniformLocation(t,"u_y");e.uniform1f(f,s/n),e.uniform1f(p,s/i);var v=ow(e,0,void 0,o,a),y=e.getUniformLocation(t,"u_texture");return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),aw(e,r,0),e.uniform1i(y,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(c),e.deleteBuffer(h),e.disableVertexAttribArray(u),e.disableVertexAttribArray(d),v}function dw(e,t,r,n,i,o,a){var s=lw(e,t),l=s.pointBuffer,c=s.a_position,u=s.texBuffer,h=s.a_texCoords,d=e.getUniformLocation(t,"u_kernel");e.uniform1i(d,n);var f=Math.sin(i)*n/a,p=Math.cos(i)*n/o,v=e.getUniformLocation(t,"u_velocity");e.uniform2f(v,p,f);for(var y=e.getUniformLocation(t,"u_texture"),g=r,m=ow(e,0,void 0,o,a),b=ow(e,0,void 0,o,a),x=0;x<3;x++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,[m,b,m][x],0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),aw(e,[g,m,b][x],0),e.uniform1i(y,0),e.drawArrays(e.TRIANGLE_STRIP,0,4);return e.deleteBuffer(l),e.deleteBuffer(u),e.disableVertexAttribArray(c),e.disableVertexAttribArray(h),e.deleteTexture(b),m}function fw(e,t,r,n,i,o,a,s){var l=lw(e,t),c=l.pointBuffer,u=l.a_position,h=l.texBuffer,d=l.a_texCoords,f=e.getUniformLocation(t,"u_kernel");e.uniform1i(f,i);var p=e.getUniformLocation(t,"u_center");e.uniform2f(p,o[0],o[1]);var v=e.getUniformLocation(t,"u_ratio");e.uniform1f(v,n);for(var y=r,g=[],m=0;m<1;m++){var b=ow(e,0,void 0,a,s);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0),aw(e,y,0);var x=e.getUniformLocation(t,"u_texture");e.uniform1i(x,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),g.push(y),y=b}return e.deleteBuffer(c),e.deleteBuffer(h),e.disableVertexAttribArray(u),e.disableVertexAttribArray(d),g.forEach((function(t){t!==r&&e.deleteTexture(t)})),y}function pw(e,t,r,n){var i=lw(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;aw(e,r,0);var c=e.getUniformLocation(t,"u_texture");e.uniform1i(c,0);var u=e.getUniformLocation(t,"u_color"),h=n[3];e.uniform4f(u,n[0]*h,n[1]*h,n[2]*h,h),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}var vw=cw;function yw(e,t,r,n,i){var o=lw(e,t),a=o.pointBuffer,s=o.a_position,l=o.texBuffer,c=o.a_texCoords;aw(e,r,0);var u=e.getUniformLocation(t,"u_texture");e.uniform1i(u,0);var h=e.getUniformLocation(t,"u_tint"),d=ep(n);d[3]*=i,e.uniform4f(h,d[0]*d[3],d[1]*d[3],d[2]*d[3],d[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(a),e.deleteBuffer(l),e.disableVertexAttribArray(s),e.disableVertexAttribArray(c)}function gw(e,t,r,n){var i=lw(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;aw(e,r,0);var c=e.getUniformLocation(t,"u_texture");e.uniform1i(c,0);var u=e.getUniformLocation(t,"u_m[0]");e.uniform1fv(u,new Float32Array(n)),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}function mw(e,t,r,n,i){return void 0===i&&(i=!1),{x:e=e===r?0:(e-r)/r,y:t=t===n?0:i?(n-t)/n:(t-n)/n}}function bw(e,t,r,n,i,o,a){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=!0);var s=md(e[0],e[1],e[2],e[3],a),l=s.x1,c=s.y1,u=s.x2,h=s.y2,d=s.x3,f=s.y3,p=s.x4,v=s.y4;return{t1:mw(l+n,c+i,t,r,o),t2:mw(u+n,h+i,t,r,o),t3:mw(d+n,f+i,t,r,o),t4:mw(p+n,v+i,t,r,o)}}function xw(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),t||r){var n=e.t1,i=e.t2,o=e.t3,a=e.t4;return{t1:{x:n.x+t,y:n.y+r},t2:{x:i.x+t,y:i.y+r},t3:{x:o.x+t,y:o.y+r},t4:{x:a.x+t,y:a.y+r}}}return e}var Ew=512,ww=0,Sw=function(){function e(e,t,r,n){this.uuid=ww++,this.available=!1,this.complete=!1,this.count=0,this.needClear=!1,this.nodes=[],this.x=t,this.y=r,this.size=n,this.gl=e,this.bbox=new Float64Array([0,0,0,0]),this.x1=this.y1=-1,this.x2=this.y2=1}return e.prototype.init=function(e){void 0===e&&(e=1),this.available||(this.available=!0,this.complete=!1,this.count=0,this.texture=ow(this.gl,0,void 0,Ew*e,Ew*e))},e.prototype.clean=function(){var e=this;this.count&&(this.count=0,this.needClear=!0),this.complete=!1;var t=this.nodes.splice(0);return t.forEach((function(t){return t.removeTile(e)})),t},e.prototype.add=function(e){-1===this.nodes.indexOf(e)&&(this.nodes.push(e),e.addTile(this),this.count++)},e.prototype.has=function(e){return this.nodes.indexOf(e)>-1},e.prototype.remove=function(e){var t=this.nodes.indexOf(e);t>-1&&(this.nodes.splice(t,1),e.removeTile(this),this.count--,this.complete=!1)},e.prototype.updateTex=function(e){this.texture&&this.gl.deleteTexture(this.texture),this.texture=e},e.prototype.destroy=function(){this.available=!1,this.complete=!1,this.count=0,this.texture&&(this.gl.deleteTexture(this.texture),this.texture=void 0)},e.prototype.toString=function(){return this.uuid+": "+this.available+","+this.complete+"; "+this.x+","+this.y+","+(this.x+Ew)+","+(this.y+Ew)+"; "+this.bbox.map((function(e){return Math.round(e)})).join(",")},Object.defineProperty(e,"UNIT",{get:function(){return Ew},set:function(e){for(var t=e,r=0;t>0;)t>>=1,r++;for(t=0;r>0;)r--,t<<=1;if(t<32)throw new Error("The UNIT of Tile muse be a power of 2 and the minimum is 32");Ew=t},enumerable:!1,configurable:!0}),e.clean=function(e){e.forEach((function(e){return e.clean()}))},e}(),_w=function(){function e(e){this.gl=e,this.hash=new WeakMap,this.data=[]}return e.prototype.setPage=function(e){this.hash.has(e)?this.data=this.hash.get(e):(this.data=[],this.hash.set(e,this.data))},e.prototype.active=function(e,t,r,n,i){if(!n||!i)return[];var o=Math.round(Sw.UNIT/e),a=this.getTable(e),s=[];if(a.length){for(var l=a[0][0],c=t-l.x,u=r-l.y,h=Math.round(c/o),d=Math.round(u/o);d<0;)a.unshift([new Sw(this.gl,l.x,l.y-o,o)]),l=a[0][0],d++;for(;h<0;){v=0;for(var f=a.length;v<f;v++){if((y=a[v]=a[v]||[]).length){m=y[0];y.unshift(new Sw(this.gl,m.x-o,m.y,o))}}h++}l=a[0][0];for(v=d;v<d+i;v++)for(y=a[v]=a[v]||[],g=h;g<h+n;g++)if(y[g])s.push(y[g]);else{m=new Sw(this.gl,l.x+g*o,l.y+v*o,o);y[g]=m;for(var p=g-1;p>=0&&!y[p];p--)y[p]=new Sw(this.gl,l.x+p*o,l.y+v*o,o);s.push(m)}}else for(var v=0;v<i;v++){for(var y=[],g=0;g<n;g++){var m=new Sw(this.gl,t+g*o,r+v*o,o);y.push(m),s.push(m)}a.push(y)}return s},e.prototype.getTable=function(e){for(var t=0,r=this.data.length;t<r;t++){var n=this.data[t];if(n.scale===e)return n.table;if(n.scale>e){var i={scale:e,table:[]};return this.data.splice(t,0,i),i.table}}var o={scale:e,table:[]};return this.data.push(o),o.table},e.prototype.getDowngrade=function(e,t,r){for(var n=0,i=this.data.length;n<i;n++){if(this.data[n].scale===e){for(var o=n-1;o>=0;o--)for(var a=this.data[o],s=a.scale,l=0,c=(f=a.table).length;l<c;l++){if((m=f[l])&&m.length)if((b=m[0]).y===r||b.y<r&&b.y+b.size>r)for(var u=0,h=m.length;u<h;u++){if(((w=m[u]).x===t||w.x<t&&w.x+w.size>t)&&w.available&&w.count)return[{scale:s,tile:w}];if(w.x>t)break}else if(b.y>r)break}for(o=n+1;o<i;o++){for(var d=this.data[o],f=(s=d.scale,d.table),p=Sw.UNIT/e,v=[],y=0,g=f.length;y<g;y++){var m,b;if((m=f[y])&&m.length)if((b=m[0]).y>=r&&b.y<r+p)for(var x=0,E=m.length;x<E;x++){var w;if((w=m[x]).x>=t&&w.x<t+p&&w.available&&w.count)v.push({scale:s,tile:w});else if(w.x>=t+p)break}else if(b.y>=r+p)break}if(v.length)return v}break}}},e}(),Cw={},Aw=function(){function e(e,t,r){this.gl=e,this.available=!0,this.bbox=t.slice(0);var n=t[2],i=t[3];if(this.list=[],r)for(var o=r.list,a=r.w,s=r.h,l=o.length,c=(t[2]-t[0])/a,u=(t[3]-t[1])/s,h=0;h<l;h++){var d=o[h],f=ow(e,0,d.os.canvas);this.list.push({bbox:new Float64Array([d.x*c,d.y*u,Math.min(n,(d.x+d.w)*c),Math.min(i,(d.y+d.h)*u)]),w:d.w,h:d.h,t:f})}}return e.prototype.release=function(){var e=this;this.available&&(this.available=!1,this.list.splice(0).forEach((function(t){t.t&&e.gl.deleteTexture(t.t)})))},e.prototype.releaseImg=function(e,t){var r=this;if(this.available){this.available=!1;var n=Cw[e],i=n[t];i&&(i.count--,i.count||(delete n[t],this.list.splice(0).forEach((function(e){e.t&&r.gl.deleteTexture(e.t)}))))}},e.getInstance=function(t,r,n){return new e(t,n,r)},e.hasImgInstance=function(e,t){if(Cw.hasOwnProperty(e)&&Cw[e].hasOwnProperty(t))return!0;return!1},e.getImgInstance=function(t,r,n,i,o){if(Cw.hasOwnProperty(t)){var a=Cw[t];if(a.hasOwnProperty(n)){var s=a[n];s.count++;for(var l=new e(r,i),c=i[2]-i[0],u=i[3]-i[1],h=c/s.w,d=u/s.h,f=i[2],p=i[3],v=s.value,y=v.length,g=0;g<y;g++){var m=v[g];l.list.push({bbox:new Float64Array([m.x*h,m.y*d,Math.min(f,(m.x+m.w)*h),Math.min(p,(m.y+m.h)*d)]),w:m.w,h:m.h,t:m.t})}return l}}var b=Cw[t]=Cw[t]||{},x=new e(r,i,o);return b[n]={value:x.list.map((function(e,t){return{x:o.list[t].x,y:o.list[t].y,w:e.w,h:e.h,t:e.t}})),w:o.w,h:o.h,count:1},x},e.getEmptyInstance=function(t,r){return new e(t,r)},e}(),Tw=function(){function e(){this.__eHash={}}return e.prototype.on=function(e,t){if(_u(t)){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)this.on(e[r],t);else{this.__eHash.hasOwnProperty(e)||(this.__eHash[e]=[]);r=0;var i=this.__eHash[e];for(n=i.length;r<n;r++)if(i[r]===t)return this;this.__eHash[e].push(t)}return this}},e.prototype.once=function(e,t){var r=this;if(_u(t)){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)this.once(e[n],t);else{var o=function(){t.apply(r,Array.prototype.slice.call(arguments)),r.off(e,o)};if(o.__eventCb=t,Array.isArray(e))for(n=0,i=e.length;n<i;n++)this.once(e[n],t);else this.on(e,o)}return this}},e.prototype.off=function(e,t){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)this.off(e[r],t);else if(this.__eHash.hasOwnProperty(e))if(t){r=0;var i=this.__eHash[e];for(n=i.length;r<n;r++)if(i[r]===t||i[r].__eventCb===t){i.splice(r,1);break}}else delete this.__eHash[e];return this},e.prototype.emit=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return Array.isArray(e)||(e=[e]),e.forEach((function(e){if(e&&t.__eHash.hasOwnProperty(e)){var n=t.__eHash[e];if(n.length)for(var i=0,o=(n=n.slice()).length;i<o;i++){var a=n[i];_u(a)&&a.apply(t,r)}}})),this},e.REFRESH="REFRESH",e.REFRESH_COMPLETE="REFRESH_COMPLETE",e.DID_ADD_DOM="DID_ADD_DOM",e.WILL_REMOVE_DOM="WILL_REMOVE_DOM",e.STYLE_CHANGED="STYLE_CHANGED",e}(),Ow=function(e){function t(t){var r=e.call(this)||this;return r.isGroup=!1,r.isArtBoard=!1,r.isSymbolMaster=!1,r.isSymbolInstance=!1,r.isPage=!1,r.isText=!1,r.isGeom=!1,r.isPolyline=!1,r.isBitmap=!1,r.isShapeGroup=!1,r.isContainer=!1,r.isSlice=!1,r.props=t,r.props.uuid=r.props.uuid||a(),r.style=Yf(h(t.style)),r.computedStyle={},r.width=0,r.height=0,r.minWidth=.5,r.minHeight=.5,r.isDestroyed=!0,r.struct={node:r,num:0,total:0,lv:0,next:0},r.refreshLevel=XE.REFLOW,r._opacity=1,r.hasCacheOp=!1,r.localOpId=0,r.parentOpId=0,r.transform=nd(),r.matrix=nd(),r._matrixWorld=nd(),r.hasCacheMw=!1,r.localMwId=0,r.parentMwId=0,r.hasContent=!1,r.textureCache=[],r.textureTotal=[],r.textureFilter=[],r.textureMask=[],r.textureTarget=[],r.textureOutline=[],r.tempOpacity=1,r.tempMatrix=nd(),r.tempIndex=0,r.tileList=[],r}return p(t,e),t.prototype.willMount=function(){this.isDestroyed=!1;var e=this.parent;if(e){this.parentOpId=e.localOpId,this.parentMwId=e.localMwId;var t=this.root=e.root;this.isPage||(this.page=e.page),this.isArtBoard||(this.artBoard=e.artBoard),this.isSymbolInstance||(this.symbolInstance=e.symbolInstance);var r=this.props.uuid;r&&(t.refs[r]=this)}},t.prototype.didMount=function(){},t.prototype.lay=function(e){this.refreshLevel=XE.REFLOW,this.calReflowStyle();var t=this.style,r=this.computedStyle,n=t.left,i=t.top,o=t.right,a=t.bottom,s=t.width,l=t.height,c=!1,u=!1,h=!1,d=!1;n.u!==zu.AUTO&&(c=!0,r.left=ap(n,e.w)),o.u!==zu.AUTO&&(h=!0,r.right=ap(o,e.w)),i.u!==zu.AUTO&&(u=!0,r.top=ap(i,e.h)),a.u!==zu.AUTO&&(d=!0,r.bottom=ap(a,e.h)),c&&h?this.width=r.width=Math.max(this.minWidth,e.w-r.left-r.right):c?(s.u!==zu.AUTO?this.width=r.width:this.width=this.minWidth,r.right=e.w-r.left-this.width):h&&(s.u!==zu.AUTO?this.width=r.width:this.width=this.minWidth,r.left=e.w-r.right-this.width),u&&d?this.height=r.height=Math.max(this.minHeight,e.h-r.top-r.bottom):u?(l.u!==zu.AUTO?this.height=r.height:this.height=this.minHeight,r.bottom=e.h-r.top-this.height):d&&(l.u!==zu.AUTO?this.height=r.height:this.height=this.minHeight,r.top=e.h-r.bottom-this.height)},t.prototype.layout=function(e){this.isDestroyed||(this.lay(e),this.calRepaintStyle(XE.REFLOW),this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this._rect=void 0)},t.prototype.insertAfter=function(e,t){e.remove();var r=this.root,n=this.parent;if(!n)throw new Error("Can not appendSelf without parent");e.parent=n,e.prev=this,this.next?(e.props.index=.5*(this.next.props.index+this.props.index),this.next.prev=e):e.props.index=.5*(this.props.index+1),e.next=this.next,this.next=e,e.root=r;var i=n.children,o=i.indexOf(this);if(i.splice(o+1,0,e),n.isDestroyed)t&&t(!0);else{e.willMount(),n.insertStruct(e,o+1);var a=!1;r.addUpdate(e,[],XE.REFLOW,!0,!1,(function(r){a||(a=!0,e.didMount()),t&&t(r)})),a||(a=!0,e.didMount())}},t.prototype.insertBefore=function(e,t){e.remove();var r=this.root,n=this.parent;if(!n)throw new Error("Can not prependBefore without parent");e.parent=n,e.prev=this.prev,this.prev?(e.props.index=.5*(this.prev.props.index+this.props.index),this.prev.next=e):e.props.index=.5*this.props.index,e.next=this,this.prev=e,e.root=r;var i=n.children,o=i.indexOf(this);if(i.splice(o,0,e),n.isDestroyed)t&&t(!0);else{e.willMount(),n.insertStruct(e,o);var a=!1;r.addUpdate(e,[],XE.REFLOW,!0,!1,(function(r){a||(a=!0,e.didMount()),t&&t(r)})),a||(a=!0,e.didMount())}},t.prototype.calReflowStyle=function(){var e=this,t=e.style,r=e.computedStyle,n=e.parent;r.fontFamily=t.fontFamily.v,r.fontSize=t.fontSize.v,r.fontWeight=t.fontWeight.v,r.fontStyle=t.fontStyle.v;var i=t.lineHeight;i.u===zu.AUTO?r.lineHeight=np(r):r.lineHeight=i.v,this.width=this.height=0;var o=t.width,a=t.height;n&&(o.u!==zu.AUTO&&(this.width=r.width=Math.max(this.minWidth,ap(o,n.width))),a.u!==zu.AUTO&&(this.height=r.height=Math.max(this.minHeight,ap(a,n.height)))),r.letterSpacing=t.letterSpacing.v,r.paragraphSpacing=t.paragraphSpacing.v,r.textAlign=t.textAlign.v,r.textVerticalAlign=t.textVerticalAlign.v},t.prototype.calRepaintStyle=function(e){var t=this.style,r=this.computedStyle;r.visibility=t.visibility.v,r.color=t.color.v,r.backgroundColor=t.backgroundColor.v,r.fill=t.fill.map((function(e){var t,r;if(Array.isArray(e.v))return e.v.slice(0);var n=e.v;if(n&&void 0!==n.url)return{url:n.url,type:n.type,scale:.01*(null!==(r=null===(t=n.scale)||void 0===t?void 0:t.v)&&void 0!==r?r:100)};var i=e.v;return{t:i.t,d:i.d.slice(0),stops:i.stops.map((function(e){var t=.01*e.offset.v;return{color:e.color.v.slice(0),offset:t}}))}})),r.fillEnable=t.fillEnable.map((function(e){return e.v})),r.fillOpacity=t.fillOpacity.map((function(e){return e.v})),r.fillMode=t.fillMode.map((function(e){return e.v})),r.fillRule=t.fillRule.v,r.stroke=t.stroke.map((function(e){if(Array.isArray(e.v))return e.v.slice(0);var t=e.v;return{t:t.t,d:t.d.slice(0),stops:t.stops.map((function(e){var t=e.offset?.01*e.offset.v:void 0;return{color:e.color.v.slice(0),offset:t}}))}})),r.strokeEnable=t.strokeEnable.map((function(e){return e.v})),r.strokeWidth=t.strokeWidth.map((function(e){return e.v})),r.strokePosition=t.strokePosition.map((function(e){return e.v})),r.strokeMode=t.strokeMode.map((function(e){return e.v})),r.strokeDasharray=t.strokeDasharray.map((function(e){return e.v})),r.strokeLinecap=t.strokeLinecap.v,r.strokeLinejoin=t.strokeLinejoin.v,r.strokeMiterlimit=t.strokeMiterlimit.v,r.booleanOperation=t.booleanOperation.v,r.mixBlendMode=t.mixBlendMode.v,r.pointerEvents=t.pointerEvents.v,e&(XE.MASK|XE.REFLOW|XE.REPAINT)&&this.calMask(),r.innerShadow=t.innerShadow.map((function(e){var t=e.v;return{x:t.x.v,y:t.y.v,blur:t.blur.v,spread:t.spread.v,color:t.color.v}})),r.innerShadowEnable=t.innerShadowEnable.map((function(e){return e.v})),r.textDecoration=t.textDecoration.map((function(e){return e.v})),e&XE.REFLOW_TRANSFORM&&this.calMatrix(e),e&XE.REFLOW_OPACITY&&this.calOpacity(),e&XE.REFLOW_FILTER&&this.calFilter(e),this.clearCache(!0),this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0},t.prototype.calMask=function(){var e=this.style,t=this.computedStyle;t.maskMode=e.maskMode.v,t.breakMask=e.breakMask.v;var r=this.prev;if(r&&!t.breakMask&&(r.computedStyle.maskMode?this.mask=r:r.mask&&(this.mask=r.mask)),t.maskMode){this.mask=void 0;for(var n=this.next;n;){if(n.computedStyle.maskMode){n.mask=this;break}if(n.computedStyle.breakMask)break;n.mask=this,n=n.next}}else{var i=t.breakMask?void 0:this.mask;this.mask=i;for(n=this.next;n;){if(n.computedStyle.maskMode){n.mask=i;break}if(n.computedStyle.breakMask)break;n.mask=i,n=n.next}}},t.prototype.calFilter=function(e){var t,r,n,i=this.style,o=this.computedStyle,a=i.blur.v;o.blur={t:a.t,radius:(null===(t=a.radius)||void 0===t?void 0:t.v)||0,center:a.center?a.center.map((function(e){return.01*e.v})):[.5,.5],saturation:.01*(null!==(n=null===(r=a.saturation)||void 0===r?void 0:r.v)&&void 0!==n?n:100),angle:a.angle?a.angle.v:0},o.shadow=i.shadow.map((function(e){var t=e.v;return{x:t.x.v,y:t.y.v,blur:t.blur.v,spread:t.spread.v,color:t.color.v}})),o.shadowEnable=i.shadowEnable.map((function(e){return e.v})),o.hueRotate=i.hueRotate.v,o.saturate=.01*i.saturate.v,o.brightness=.01*i.brightness.v,o.contrast=.01*i.contrast.v,e<XE.REPAINT&&(this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0,this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.resetTextureTarget())},t.prototype.calMatrix=function(e){var t=this,r=this,n=r.style,i=r.computedStyle,o=r.matrix,a=r.transform;!this.hasCacheMw&&this.localMwId||(this.hasCacheMw=!1,this.localMwId++);var s=!0;if((e>=XE.REFLOW||e&XE.TRANSFORM||e&XE.SCALE_X&&!i.scaleX||e&XE.SCALE_Y&&!i.scaleY)&&(s=!1),s){if(e&XE.TRANSLATE_X){var l=(c=ap(n.translateX,this.width))-i.translateX;i.translateX=c,a[12]+=l,o[12]+=l}if(e&XE.TRANSLATE_Y){l=(c=ap(n.translateY,this.height))-i.translateY;i.translateY=c,a[13]+=l,o[13]+=l}if(e&XE.ROTATE_Z){var c=n.rotateZ.v;i.rotateZ=c;var u=xd(c),h=Math.sin(u),d=Math.cos(u),f=i.scaleX,p=i.scaleY;o[0]=a[0]=d*f,o[1]=a[1]=h*p,o[4]=a[4]=-h*f,o[5]=a[5]=d*p;var v=(x=i.transformOrigin)[0],y=x[1];o[12]=a[12]+v-a[0]*v-y*a[4],o[13]=a[13]+y-a[1]*v-y*a[5]}if(e&XE.SCALE){if(e&XE.SCALE_X){f=(c=n.scaleX.v)/i.scaleX;i.scaleX=c,a[0]*=f,a[4]*=f,o[0]*=f,o[4]*=f}if(e&XE.SCALE_Y){p=(c=n.scaleY.v)/i.scaleY;i.scaleY=c,a[1]*=p,a[5]*=p,o[1]*=p,o[5]*=p}v=(x=i.transformOrigin)[0],y=x[1];o[12]=a[12]+v-a[0]*v-a[4]*y,o[13]=a[13]+y-a[1]*v-a[5]*y,o[14]=a[14]-a[2]*v-a[6]*y}}else{ad(a);var g=n.transformOrigin.map((function(e,r){return ap(e,r?t.height:t.width)}));i.transformOrigin=g;var m=i.left,b=i.top;if(n.matrix)return i.matrix=n.matrix.v.slice(0),ld(o,i.matrix),this.transform=Pd(o,g[0],g[1]),o;i.translateX=ap(n.translateX,this.width),a[12]=m+i.translateX,i.translateY=ap(n.translateY,this.height),a[13]=b+i.translateY;var x,E=n.rotateZ?n.rotateZ.v:0,w=n.scaleX?n.scaleX.v:1,S=n.scaleY?n.scaleY.v:1;i.rotateZ=E,i.scaleX=w,i.scaleY=S,1!==w&&(id(a)?a[0]=w:fd(a,w)),1!==S&&(id(a)?a[5]=S:pd(a,S)),id(a)?kd(a,E):E&&dd(a,xd(E)),ld(o,x=Rd(a,g[0],g[1]))}return o},t.prototype.calOpacity=function(){var e=this.style,t=this.computedStyle;!this.hasCacheOp&&this.localOpId||(this.hasCacheOp=!1,this.localOpId++),t.opacity=e.opacity.v},t.prototype.calContent=function(){return this.hasContent=!1},t.prototype.renderCanvas=function(e){var t=this.canvasCache;t&&t.available&&e&&t.release()},t.prototype.genTexture=function(e,t,r){var n;this.renderCanvas(t),null===(n=this.textureCache[r])||void 0===n||n.release();var i=this.canvasCache;(null==i?void 0:i.available)?(this.textureTarget[r]=this.textureCache[r]=Aw.getInstance(e,i,(this._bbox2||this.bbox2).slice(0)),i.release()):this.textureTarget[r]=this.textureCache[r]=void 0},t.prototype.resetTextureTarget=function(){for(var e,t,r,n,i=this,o=i.textureMask,a=i.textureFilter,s=i.textureTotal,l=i.textureCache,c=0,u=Math.max(l.length,s.length);c<u;c++)(null===(e=o[c])||void 0===e?void 0:e.available)?this.textureTarget[c]=o[c]:(null===(t=a[c])||void 0===t?void 0:t.available)?this.textureTarget[c]=a[c]:(null===(r=s[c])||void 0===r?void 0:r.available)?this.textureTarget[c]=s[c]:(null===(n=l[c])||void 0===n?void 0:n.available)?this.textureTarget[c]=l[c]:this.textureTarget[c]=void 0},t.prototype.clearCache=function(e){var t=this;void 0===e&&(e=!1),this.textureTarget.splice(0),e?(this.refreshLevel|=XE.REPAINT,this.textureCache.forEach((function(e){return null==e?void 0:e.release()}))):this.textureCache.forEach((function(e,r){e&&e.available&&(t.textureTarget[r]=e)})),this.textureTotal.forEach((function(e){return null==e?void 0:e.release()})),this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.textureOutline.forEach((function(e){return null==e?void 0:e.release()}))},t.prototype.clearCacheUpward=function(e){void 0===e&&(e=!1);for(var t=this.parent;t;){t.tempBbox=void 0,t.clearCache(e);var r=t.mask;r&&r.clearMask(),t=t.parent}},t.prototype.clearMask=function(e){if(void 0===e&&(e=!0),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.resetTextureTarget(),this.struct.next=0,e)for(var t=this.parent;t&&t!==this.root;)t._rect=void 0,t._bbox=void 0,t._bbox2=void 0,t._filterBbox=void 0,t._filterBbox2=void 0,t.tempBbox=void 0,t=t.parent},t.prototype.remove=function(e){var t=this.root,r=this.parent;if(r){var n=r.children.indexOf(this);if(-1===n)throw new Error("Invalid index of remove()");r.children.splice(n,1);var i=this.prev,o=this.next;i&&(i.next=o),o&&(o.prev=i)}this.prev=this.next=void 0,this.isPage||(this.page=void 0),this.isArtBoard||(this.artBoard=void 0),this.isSymbolInstance||(this.symbolInstance=void 0),this.isDestroyed?e&&e(!0):(null==r||r.deleteStruct(this),t.addUpdate(this,[],XE.REFLOW,!1,!0,e))},t.prototype.destroy=function(){this.isDestroyed||(this.isDestroyed=!0,this.clearCache(!0),this.parent=this.root=this.mask=void 0)},t.prototype.structure=function(e){var t=this.struct;return t.lv=e,[t]},t.prototype.updateFormatStyleData=function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];Kf(r,e,this.style)||(this.style[r]=n,t.push(r))}return t},t.prototype.updateFormatStyle=function(e,t){var r,n=this.updateFormatStyleData(e);return n.length?{keys:n,lv:null===(r=this.root)||void 0===r?void 0:r.addUpdate(this,n,void 0,!1,!1,t)}:(t&&t(!0),{keys:n,lv:XE.NONE})},t.prototype.updateStyleData=function(e){var t=Yf(e);return this.updateFormatStyleData(t)},t.prototype.updateStyle=function(e,t){var r=Yf(e);return this.updateFormatStyle(r,t)},t.prototype.updateProps=function(e,t){var r,n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];Pu(o,this.props[i])||(this.props[i]=o,n.push(o))}if(!n.length)return t&&t(!0),n;null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t)},t.prototype.refreshStyle=function(e,t){var r,n,i=this;return Array.isArray(e)?n=e.slice(0):(n=Object.keys(e)).forEach((function(t){i.style[t]=e[t]})),n.length?(null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t),n):(t&&t(!0),n)},t.prototype.refreshProps=function(e,t){var r,n,i=this;return Array.isArray(e)?n=e.slice(0):(n=Object.keys(e)).forEach((function(t){i.props[t]=e[t]})),n.length?(null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t),n):(t&&t(!0),n)},t.prototype.refresh=function(e,t){var r;void 0===e&&(e=XE.REPAINT),null===(r=this.root)||void 0===r||r.addUpdate(this,[],e,!1,!1,t)},t.prototype.getStyle=function(){return Iu(this.style)},t.prototype.getComputedStyle=function(){var e=Object.assign({},this.computedStyle);return e.color=e.color.slice(0),e.backgroundColor=e.backgroundColor.slice(0),e.fill=Iu(e.fill),e.stroke=Iu(e.stroke),e.shadow=Iu(e.shadow),e.innerShadow=Iu(e.innerShadow),e.fillOpacity=e.fillOpacity.slice(0),e.fillEnable=e.fillEnable.slice(0),e.fillMode=e.fillMode.slice(0),e.strokeEnable=e.strokeEnable.slice(0),e.strokeWidth=e.strokeWidth.slice(0),e.transformOrigin=e.transformOrigin.slice(0),e.strokeDasharray=e.strokeDasharray.slice(0),e.shadowEnable=e.shadowEnable.slice(0),e},t.prototype.getCssStyle=function(){var e=this,t={},r=this.style,n=this.computedStyle;["top","right","bottom","left","width","height","translateX","translateY","scaleX","scaleY","rotateZ"].forEach((function(e){var n=r[e];n.u===zu.AUTO?t[e]="auto":n.u===zu.PERCENT?t[e]=n.v+"%":n.u!==zu.PX&&n.u!==zu.NUMBER&&n.u!==zu.DEG||(t[e]=n.v)})),t.opacity=n.opacity,t.visibility=n.visibility===rh.VISIBLE?"visible":"hidden",t.color=Jf(n.color),t.backgroundColor=Jf(n.backgroundColor),t.fontStyle=["normal","italic","oblique"][n.fontStyle],t.textAlign=["left","center","right","justify"][n.textAlign],t.textVerticalAlign=["top","middle","bottom"][n.textVerticalAlign],t.mixBlendMode=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"][n.mixBlendMode],["shadowEnable","strokeEnable","fillEnable","fillOpacity","strokeWidth"].forEach((function(e){t[e]=n[e].slice(0)})),t.fill=n.fill.map((function(t){return cp(t,e.width,e.height)})),t.fillRule=["nonzero","evenodd"][n.fillRule],t.fillMode=n.fillMode,t.stroke=n.stroke.map((function(t){return cp(t,e.width,e.height)})),t.strokeLinecap=["butt","round","square"][n.strokeLinecap],t.strokeLinejoin=["miter","round","bevel"][n.strokeLinejoin],t.strokePosition=n.strokePosition.map((function(e){return up(e)})),t.strokeMiterlimit=n.strokeMiterlimit,t.strokeDasharray=n.strokeDasharray,t.maskMode=["none","outline","alpha","gray","alpha-with","gray-with"][n.maskMode],t.booleanOperation=["none","union","subtract","intersect","xor"][n.booleanOperation];var i=n.blur;t.blur=sp(i.t,i.radius,i.angle,i.center,i.saturation),t.shadow=n.shadow.map((function(e){return lp(e)}));var o=r.transformOrigin;return t.transformOrigin=n.transformOrigin.map((function(e,t){var r=o[t];return r.u===zu.PERCENT?r.v+"%":e})),t.hueRotate=n.hueRotate,t.saturate=100*n.saturate+"%",t.brightness=100*n.brightness+"%",t.contrast=100*n.contrast+"%",t},t.prototype.getBoundingClientRect=function(e){var t,r,n=(null==e?void 0:e.includeBbox)?this._bbox||this.bbox:this._rect||this.rect;if((null==e?void 0:e.excludeRotate)&&this.computedStyle.rotateZ){var i=this.parent,o=nd(),a=this.matrix;o[12]=a[12],o[13]=a[13];var s=od(i.matrixWorld,o);r=md(n[0],n[1],n[2],n[3],s)}else r=md(n[0],n[1],n[2],n[3],this.matrixWorld);var l=(null===(t=this.root)||void 0===t?void 0:t.dpi)||1,c=(null==e?void 0:e.excludeDpi)?r.x1/l:r.x1,u=(null==e?void 0:e.excludeDpi)?r.y1/l:r.y1,h=(null==e?void 0:e.excludeDpi)?r.x2/l:r.x2,d=(null==e?void 0:e.excludeDpi)?r.y2/l:r.y2,f=(null==e?void 0:e.excludeDpi)?r.x3/l:r.x3,p=(null==e?void 0:e.excludeDpi)?r.y3/l:r.y3,v=(null==e?void 0:e.excludeDpi)?r.x4/l:r.x4,y=(null==e?void 0:e.excludeDpi)?r.y4/l:r.y4,g=Math.min(c,h,f,v),m=Math.min(u,d,p,y),b=Math.max(c,h,f,v),x=Math.max(u,d,p,y);return{left:g,top:m,right:b,bottom:x,width:b-g,height:x-m,points:[{x:c,y:u},{x:h,y:d},{x:f,y:p},{x:v,y:y}]}},t.prototype.startSizeChange=function(){var e=this,t=e.width,r=e.height,n=e.style,i=e.computedStyle,o=e.parent;if(e.isDestroyed||!o)throw new Error("Can not resize a destroyed Node or Root");var a=n.left,s=n.right,l=n.top,c=n.bottom,u=n.translateX,h=n.translateY,d=o.width,f=o.height;if(u.v&&u.u===zu.PERCENT){var p=u.v*t*.01;a.u===zu.PERCENT?a.v+=100*p/d:a.u===zu.PX&&(a.v+=p),i.left+=p,s.u===zu.PERCENT?s.v-=100*p/d:s.u===zu.PX&&(s.v-=p),i.right-=p,u.v=0}if(h.v&&h.u===zu.PERCENT){p=h.v*r*.01;l.u===zu.PERCENT?l.v+=100*p/f:l.u===zu.PX&&(l.v+=p),i.top+=p,c.u===zu.PERCENT?c.v-=100*p/f:c.u===zu.PX&&(c.v-=p),i.bottom-=p,h.v=0}},t.prototype.endSizeChange=function(e){var t=e.translateX,r=e.translateY,n=this,i=n.style,o=n.computedStyle,a=n.parent,s=n.width,l=n.height,c=i.left,u=i.right,h=i.top,d=i.bottom,f=a,p=f.width,v=f.height;if(t.v&&t.u===zu.PERCENT){var y=t.v*s*.01;c.u===zu.PX?c.v-=y:c.u===zu.PERCENT&&(c.v-=100*y/p),o.left-=y,u.u===zu.PX?u.v+=y:u.u===zu.PERCENT&&(u.v+=100*y/p),o.right+=y,o.translateX+=y}if(r.v&&r.u===zu.PERCENT){y=r.v*l*.01;h.u===zu.PX?h.v-=y:i.top.u===zu.PERCENT&&(h.v-=100*y/v),o.top-=y,d.u===zu.PX?d.v+=y:d.u===zu.PERCENT&&(d.v+=100*y/v),o.bottom+=y,o.translateY+=y}i.translateX.v=t.v,i.translateX.u=t.u,i.translateY.v=r.v,i.translateY.u=r.u},t.prototype.endPosChange=function(e,t,r){var n=this,i=n.style,o=n.computedStyle,a=n.parent;if(a){var s=e.translateX,l=e.translateY,c=i.top,u=i.right,h=i.bottom,d=i.left,f=a.width,p=a.height;t&&(d.u===zu.PX?d.v+=t:d.u===zu.PERCENT&&(d.v+=100*t/f),o.left+=t,u.u===zu.PX?u.v-=t:u.u===zu.PERCENT&&(u.v-=100*t/f),o.right-=t,o.translateX-=t),r&&(c.u===zu.PX?c.v+=r:c.u===zu.PERCENT&&(c.v+=100*r/p),o.top+=r,h.u===zu.PX?h.v-=r:h.u===zu.PERCENT&&(h.v-=100*r/p),o.bottom-=r,o.translateY-=r),i.translateX.v=s.v,i.translateX.u=s.u,i.translateY.v=l.v,i.translateY.u=l.u}},t.prototype.adjustPosAndSizeSelf=function(e,t,r,n){var i=this,o=i.style,a=i.computedStyle,s=i.parent,l=i.root;if(s&&l&&(e||t||r||n)){var c=s.width,u=s.height,h=o.top,d=o.right,f=o.bottom,p=o.left,v=o.width,y=o.height;e&&(p.u===zu.PX?p.v+=e:p.u===zu.PERCENT&&(p.v+=100*e/c),a.left+=e),r&&(d.u===zu.PX?d.v-=r:d.u===zu.PERCENT?d.v-=100*r/c:v.u===zu.PX?v.v=r+this.width-e:v.u===zu.PERCENT&&(v.v=100*(r+this.width-e)/s.width),a.right-=r),this.width=a.width=s.width-a.left-a.right,t&&(h.u===zu.PX?h.v+=t:h.u===zu.PERCENT&&(h.v+=100*t/u),a.top+=t),n&&(f.u===zu.PX?f.v-=n:f.u===zu.PERCENT?f.v-=100*n/u:y.u===zu.PX?y.v=n+this.height-t:y.u===zu.PERCENT&&(y.v=100*(n+this.height-t)/s.height),a.bottom-=n),this.height=a.height=s.height-a.top-a.bottom,this.refreshLevel|=XE.TRANSFORM,l.rl|=XE.TRANSFORM,this.calMatrix(XE.TRANSFORM),this._rect=void 0,this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0}},t.prototype.checkPosSizeUpward=function(){for(var e=this.root,t=this.parent;t&&t!==e&&t.adjustPosAndSize();)t=t.parent},t.prototype.adjustPosAndSize=function(){return!1},t.prototype.getZoom=function(e){void 0===e&&(e=!1);for(var t=this.computedStyle.scaleX,r=this.parent;r&&r!==this.page&&!r.isPage;)t*=r.computedStyle.scaleX,r=r.parent;return!e&&this.root?t*this.root.dpi:t},t.prototype.setZoom=function(e,t){void 0===t&&(t=!1),t&&this.root&&(e/=this.root.dpi),this.updateStyle({scaleX:e,scaleY:e})},t.prototype.rename=function(e){this.props.name=e},t.prototype.getStructs=function(){return this.root?[this.struct]:[]},t.prototype.isSibling=function(e){for(var t=this.prev;t;){if(t===e)return!0;t=t.prev}for(var r=this.next;r;){if(r===e)return!0;r=r.next}return!1},t.prototype.toJson=function(){return{tagName:"node",props:Iu(this.props)}},t.prototype.toSketchJson=function(e,t){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,s,l,c,u,h,d,f,p,v,y,g,m,b,x,E,w,S,_,C,A,T,O,M=this;return J(this,(function(k){switch(k.label){case 0:return r=(t=this).props,n=t.width,i=t.height,o=t.style,s=t.computedStyle,l=0,o.left.v===zu.PX&&(l|=dp.LEFT),o.right.v===zu.PX&&(l|=dp.RIGHT),o.top.v===zu.PX&&(l|=dp.TOP),o.bottom.v===zu.PX&&(l|=dp.BOTTOM),o.width.v===zu.PX&&(l|=dp.WIDTH),o.height.v===zu.PX&&(l|=dp.HEIGHT),l^=dp.UNSET,c=Q.LineCapStyle.Butt,s.strokeLinecap===$u.ROUND?c=Q.LineCapStyle.Round:s.strokeLinecap===$u.SQUARE&&(c=Q.LineCapStyle.Projecting),u=Q.LineJoinStyle.Miter,s.strokeLinejoin===Qu.ROUND?u=Q.LineJoinStyle.Round:s.strokeLinejoin===Qu.BEVEL&&(u=Q.LineJoinStyle.Bevel),h=s.shadow,d=s.shadowEnable,f=s.innerShadow,p=s.innerShadowEnable,v=s.blur,y=s.hueRotate,g=s.brightness,m=s.contrast,b=s.saturate,x=s.opacity,E=s.mixBlendMode,w=s.scaleX,S=s.scaleY,_=[],C=[],h.forEach((function(e,t){_.push({_class:"shadow",isEnabled:d[t],blurRadius:e.blur,color:_p(e.color),contextSettings:{_class:"graphicsContextSettings",blendMode:Q.BlendMode.Normal,opacity:1},offsetX:e.x,offsetY:e.y,spread:e.spread})})),f.forEach((function(e,t){C.push({_class:"innerShadow",isEnabled:p[t],blurRadius:e.blur,color:_p(e.color),contextSettings:{_class:"graphicsContextSettings",blendMode:Q.BlendMode.Normal,opacity:1},offsetX:e.x,offsetY:e.y,spread:e.spread})})),A={booleanOperation:s.booleanOperation-1,clippingMaskMode:s.maskMode===Ju.ALPHA?1:0,do_objectID:r.uuid,exportOptions:{exportFormats:[],includedLayerIds:[],layerOptions:0,shouldTrim:!1,_class:"exportOptions"},frame:{constrainProportions:r.constrainProportions||!1,width:n||0,height:i||0,x:s.left+s.translateX,y:s.top+s.translateY,_class:"rect"},hasClippingMask:s.maskMode!==Ju.NONE,isFixedToViewport:!1,isFlippedHorizontal:-1===w,isFlippedVertical:-1===S,isLocked:r.isLocked||!1,isTemplate:!1,isVisible:s.visibility===rh.VISIBLE,layerListExpandedType:r.isExpanded?Q.LayerListExpanded.Expanded:Q.LayerListExpanded.Collapsed,name:r.name||"",nameIsFixed:r.nameIsFixed||!1,resizingConstraint:l,resizingType:Q.ResizeType.Stretch,rotation:-s.rotateZ,shouldBreakMaskChain:s.breakMask,style:{_class:"style",do_objectID:this.props.styleId||a(),borderOptions:{_class:"borderOptions",isEnabled:!0,dashPattern:s.strokeDasharray,lineCapStyle:c,lineJoinStyle:u},startMarkerType:Q.MarkerType.OpenArrow,endMarkerType:Q.MarkerType.OpenArrow,miterLimit:s.strokeMiterlimit,windingRule:s.fillRule===Zu.EVEN_ODD?Q.WindingRule.EvenOdd:Q.WindingRule.NonZero,shadows:_,innerShadows:C,colorControls:{_class:"colorControls",isEnabled:!0,brightness:g-1,contrast:m,hue:xd(y),saturation:b},contextSettings:{_class:"graphicsContextSettings",blendMode:[0,2,5,7,1,4,6,3,9,8,10,11,12,13,14,15][E]||0,opacity:x}}},T=A.style,[4,Promise.all(s.fill.map((function(t,r){return Z(M,void 0,void 0,(function(){var n,i,o,l,c,u,h,d,f,p;return J(this,(function(v){switch(v.label){case 0:return n={_class:"color",alpha:1,red:0,green:0,blue:0},i={_class:"gradient",gradientType:Q.GradientType.Linear,elipseLength:1,from:"",to:"",stops:[]},o=Q.FillType.Color,l=Q.PatternFillType.Tile,c=1,Array.isArray(t)?(_p(t,n),[3,5]):[3,1];case 1:return t.url?(o=Q.FillType.Pattern,l=t.type,c=t.scale,(h=e.folder("images"))?[4,fetch(t.url)]:[3,3]):[3,4];case 2:d=v.sent(),f=d.blob(),p=(this.props.uuid||a())+".png",h.file(p,f),u={_class:"MSJSONFileReference",_ref_class:"MSImageData",_ref:"images/"+p},v.label=3;case 3:return[3,5];case 4:o=Q.FillType.Gradient,i.from="{"+t.d[0]+", "+t.d[1]+"}",i.to="{"+t.d[2]+", "+t.d[3]+"}",t.t===Wu.RADIAL?(i.gradientType=Q.GradientType.Radial,i.elipseLength=t.d[4]):t.t===Wu.CONIC&&(i.gradientType=Q.GradientType.Angular),t.stops.forEach((function(e){i.stops.push({_class:"gradientStop",color:_p(e.color),position:e.offset||0})})),v.label=5;case 5:return[2,{_class:"fill",isEnabled:s.fillEnable[r],color:n,fillType:o,noiseIndex:0,noiseIntensity:0,patternFillType:l,patternTileScale:c,gradient:i,image:u,contextSettings:{_class:"graphicsContextSettings",blendMode:Q.BlendMode.Normal,opacity:s.fillOpacity[r]}}]}}))}))})))];case 1:return T.fills=k.sent(),A.style.borders=s.stroke.map((function(e,t){var r={_class:"color",alpha:1,red:0,green:0,blue:0},n={_class:"gradient",gradientType:Q.GradientType.Linear,elipseLength:1,from:"",to:"",stops:[]},i=Q.FillType.Color;Array.isArray(e)?_p(e,r):(i=Q.FillType.Gradient,n.from="{"+e.d[0]+", "+e.d[1]+"}",n.to="{"+e.d[2]+", "+e.d[3]+"}",e.t===Wu.RADIAL?(n.gradientType=Q.GradientType.Radial,n.elipseLength=e.d[4]):e.t===Wu.CONIC&&(n.gradientType=Q.GradientType.Angular),e.stops.forEach((function(e){n.stops.push({_class:"gradientStop",color:_p(e.color),position:e.offset||0})})));var o=Q.BorderPosition.Center;return s.strokePosition[t]===eh.INSIDE?o=Q.BorderPosition.Inside:s.strokePosition[t]===eh.OUTSIDE&&(o=Q.BorderPosition.Outside),{_class:"border",isEnabled:s.strokeEnable[t],color:r,fillType:i,position:o,thickness:s.strokeWidth[t],gradient:n,contextSettings:{_class:"graphicsContextSettings",blendMode:Q.BlendMode.Normal,opacity:1}}})),v.t!==Yu.GAUSSIAN&&v.t!==Yu.MOTION&&v.t!==Yu.BACKGROUND&&v.t!==Yu.RADIAL||(O=void 0,O=v.center?"{"+v.center.join(", ")+"}":"{0.5, 0.5}",A.style.blur={_class:"blur",isEnabled:!0,center:O,motionAngle:xd(v.angle||0),radius:v.radius||0,saturation:v.saturation||0,type:[Q.BlurType.Gaussian,Q.BlurType.Motion,Q.BlurType.Zoom,Q.BlurType.Background][v.t-1]}),[2,A]}}))}))},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=new t(r);return n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.addTile=function(e){-1===this.tileList.indexOf(e)&&(this.tileList.push(e),e.add(this))},t.prototype.removeTile=function(e){var t=this.tileList.indexOf(e);t>-1&&this.tileList.splice(t,1)[0].remove(this)},t.prototype.cleanTile=function(){var e=this,t=this.tileList.splice(0);return t.forEach((function(t){t.remove(e)})),t},t.prototype.isParent=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},t.prototype.isChild=function(e){return e.isParent(this)},Object.defineProperty(t.prototype,"opacity",{get:function(){var e,t=this.root;if(!t)return this._opacity;for(var r=this,n=this.hasCacheOp,i=r.parent,o=-1,a=[];i;)a.push(i),i.hasCacheOp&&i.localOpId===r.parentOpId||(n=!1,o=a.length),r=i,i=i.parent;if(!n){if(o>-1){a.splice(o),a.reverse();for(var s=0,l=a.length;s<l;s++){var c=a[s];c.hasCacheOp&&c.localOpId!==(null===(e=c.parent)||void 0===e?void 0:e.parentOpId)&&c.localOpId++,c.hasCacheOp=!0,c===t?c._opacity=c.computedStyle.opacity:(c._opacity=c.parent._opacity*c.computedStyle.opacity,c.parentOpId=c.parent.localOpId)}}this.hasCacheOp&&this.localOpId++,this.hasCacheOp=!0,(i=this.parent)?(this._opacity=i._opacity*this.computedStyle.opacity,this.parentOpId=i.localOpId):this._opacity=this.computedStyle.opacity}return this._opacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"matrixWorld",{get:function(){var e,t=this.root,r=this._matrixWorld;if(!t)return r;for(var n=this,i=this.hasCacheMw,o=n.parent,a=-1,s=[];o;)s.push(o),o.hasCacheMw&&o.localMwId===n.parentMwId||(i=!1,a=s.length),n=o,o=o.parent;if(!i){if(a>-1){s.splice(a),s.reverse();for(var l=0,c=s.length;l<c;l++){var u=s[l];if(u.hasCacheMw&&u.parentMwId!==(null===(e=u.parent)||void 0===e?void 0:e.localMwId)&&u.localMwId++,u.hasCacheMw=!0,u===t)ld(u._matrixWorld,u.matrix);else{var h=od(u.parent._matrixWorld,u.matrix);ld(u._matrixWorld,h),u.parentMwId=u.parent.localMwId}}}if(this.hasCacheMw&&this.localMwId++,this.hasCacheMw=!0,o=this.parent)ld(r,h=od(o._matrixWorld,this.matrix)),this.parentMwId=o.localMwId;else ld(r,this.matrix)}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;return e||((e=this._rect=new Float64Array(4))[0]=0,e[1]=0,e[2]=this.width,e[3]=this.height),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===eh.INSIDE||(a=o[t]===eh.OUTSIDE?Math.max(a,e):Math.max(a,.5*e)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterBbox",{get:function(){var e=this._filterBbox;if(!e){var t=this._bbox||this.bbox;e=this._filterBbox=t.slice(0);for(var r=this.computedStyle,n=r.shadow,i=r.shadowEnable,o=r.blur,a=[0,0,0,0],s=0,l=n.length;s<l;s++)if(i[s]){var c=n[s];if(c.color[3]>0){var u=Rf(Lf(.5*c.blur));(c.x||c.y||u)&&(a[0]=Math.min(a[0],c.x-u),a[1]=Math.min(a[1],c.y-u),a[2]=Math.max(a[2],c.x+u),a[3]=Math.max(a[3],c.y+u))}}if(e[0]+=a[0],e[1]+=a[1],e[2]+=a[2],e[3]+=a[3],o.t===Yu.GAUSSIAN||o.t===Yu.MOTION||o.t===Yu.BACKGROUND||o.t===Yu.RADIAL){var h=o.radius;if(h>0)(u=Rf(Lf(h)))&&(e[0]-=u,e[1]-=u,e[2]+=u,e[3]+=u)}}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox2",{get:function(){var e=this._bbox2;return e||((e=(this._bbox||this.bbox).slice(0))[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterBbox2",{get:function(){var e=this._filterBbox2;return e||((e=(this._filterBbox||this.filterBbox).slice(0))[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])),e},enumerable:!1,configurable:!0}),t}(Tw),Mw=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this,t)||this;n.children=r;var i=r.length;if(i){var o=r[0];o.parent=n;for(var a=o,s=1;s<i;s++){var l=r[s];l.parent=n,a.next=l,l.prev=a,a=l}}return n.isContainer=!0,n}return p(t,e),t.prototype.willMount=function(){e.prototype.willMount.call(this);var t=this.children,r=t.length;if(r){var n=t[0];n.parent=this,n.willMount();for(var i=n,o=1;o<r;o++){var a=t[o];a.parent=this,a.willMount(),i.next=a,a.prev=i,i=a}}},t.prototype.didMount=function(){for(var t=this.children,r=t.length,n=0;n<r;n++)t[n].didMount();e.prototype.didMount.call(this)},t.prototype.lay=function(t){e.prototype.lay.call(this,t);var r=this.children;this.computedStyle;for(var n=0,i=r.length;n<i;n++){r[n].layout({w:this.width,h:this.height})}},t.prototype.getChildrenRect=function(e){for(var t=this.children,r={minX:0,minY:0,maxX:0,maxY:0},n=!1,i=!0,o=0,a=t.length;o<a;o++){var s=t[o],l=s.computedStyle;if(!n||l.breakMask){if(l.maskMode){n=!0;for(var c=s.next;c&&!c.computedStyle.breakMask;)o++,c=c.next}else l.breakMask&&(n=!1);if(e!==s){var u=s._rect||s.rect,h=md(u[0],u[1],u[2],u[3],s.matrix),d=h.x1,f=h.y1,p=h.x2,v=h.y2,y=h.x3,g=h.y3,m=h.x4,b=h.y4,x=Math.min(d,p,y,m),E=Math.min(f,v,g,b),w=Math.max(d,p,y,m),S=Math.max(f,v,g,b);i?(i=!1,r.minX=x,r.minY=E,r.maxX=w,r.maxY=S):(r.minX=Math.min(r.minX,x),r.minY=Math.min(r.minY,E),r.maxX=Math.max(r.maxX,w),r.maxY=Math.max(r.maxY,S))}}}return r},t.prototype.appendChild=function(e,t){e.remove();var r=this.root,n=this.children,i=n.length;if(i){var o=n[n.length-1];o.next=e,e.prev=o,e.props.index=.5*(o.props.index+1)}else e.props.index=.5;if(e.parent=this,e.root=r,n.push(e),this.isDestroyed)t&&t(!0);else{e.willMount(),this.insertStruct(e,i);var a=!1;r.addUpdate(e,[],XE.REFLOW,!0,!1,(function(r){a||(a=!0,e.didMount()),t&&t(r)})),a||(a=!0,e.didMount())}},t.prototype.prependChild=function(e,t){e.remove();var r=this.root,n=this.children;if(n.length){var i=n[0];i.next=e,e.prev=i,e.props.index=.5*i.props.index}else e.props.index=.5;if(e.parent=this,e.root=r,n.push(e),this.isDestroyed)t&&t(!0);else{e.willMount(),this.insertStruct(e,0);var o=!1;r.addUpdate(e,[],XE.REFLOW,!0,!1,(function(r){o||(o=!0,e.didMount()),t&&t(r)})),o||(o=!0,e.didMount())}},t.prototype.removeChild=function(e,t){e.parent===this?e.remove(t):dh.error("Invalid parameter of removeChild()")},t.prototype.clearChildren=function(e){var t=this.root,r=this.children;if(r.length){if(this.isDestroyed)return r.splice(0),void(e&&e(!0));for(;r.length;){var n=r.pop();this.deleteStruct(n),n.destroy()}t.addUpdate(this,[],XE.REFLOW,!1,!1,e)}},t.prototype.destroy=function(){var t=this.isDestroyed,r=this.children;if(!t){for(var n=0,i=r.length;n<i;n++)r[n].destroy();e.prototype.destroy.call(this)}},t.prototype.structure=function(t){var r=e.prototype.structure.call(this,t);return this.children.forEach((function(e){r=r.concat(e.structure(t+1))})),r[0].num=this.children.length,r[0].total=r.length-1,r},t.prototype.insertStruct=function(e,t){var r,n=this.struct,i=this.root,o=e.structure(n.lv+1),a=i.structs;if(t){var s=this.children[t-1].struct,l=s.total;r=a.indexOf(s)+l+1}else r=a.indexOf(n)+1;a.splice.apply(a,$([r,0],o,!1));var c=o[0].total+1;n.num++,n.total+=c;for(var u=this.parent;u;)u.struct.total+=c,u=u.parent},t.prototype.deleteStruct=function(e){var t=e.struct,r=t.total+1,n=this.root.structs,i=n.indexOf(t);n.splice(i,r);var o=this.struct;o.num--,o.total-=r;for(var a=this.parent;a;)a.struct.total-=r,a=a.parent},t.prototype.getStructs=function(){if(!this.root)return[];var e=this.root.structs,t=this.struct,r=e.indexOf(t);return e.slice(r,r+t.total+1)},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.children=this.children.map((function(e){return e.toJson()})),t},t}(Ow),kw=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.hasBackgroundColor=!!t.hasBackgroundColor,n.resizesContent=!!t.resizesContent,n.includeBackgroundColorInExport=!!t.includeBackgroundColorInExport,n.isArtBoard=!0,n.artBoard=n,n}return p(t,e),t.prototype.calContent=function(){return this.hasContent=this.hasBackgroundColor},t.prototype.rename=function(t){var r,n;e.prototype.rename.call(this,t),null===(n=null===(r=this.root)||void 0===r?void 0:r.overlay)||void 0===n||n.updateArtBoard(this)},t.prototype.renderBgc=function(e,t,r){var n=this.root.programs,i=this,o=i.width,a=i.height,s=i.matrixWorld,l=n.bgColorProgram;e.useProgram(l);var c=md(0,0,o,a,s),u=new Float32Array(8),h=mw(c.x1,c.y1,t,r,!1),d=mw(c.x2,c.y2,t,r,!1),f=mw(c.x3,c.y3,t,r,!1),p=mw(c.x4,c.y4,t,r,!1);u[0]=h.x,u[1]=h.y,u[2]=p.x,u[3]=p.y,u[4]=d.x,u[5]=d.y,u[6]=f.x,u[7]=f.y;var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW);var y=e.getAttribLocation(l,"a_position");e.vertexAttribPointer(y,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(y);var g=e.getUniformLocation(l,"u_color"),m=ep(this.computedStyle.backgroundColor);e.uniform4f(g,m[0],m[1],m[2],m[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(v),e.disableVertexAttribArray(y);var b=!0;if((h.x<=-1&&h.y<=-1&&f.x>=1&&f.y>=1||f.x<-1-4/t&&f.y<-1-4/r||h.x>1+4/t&&f.y>1+4/r)&&(b=!1),b){var x=n.bgShadowProgram;e.useProgram(x);var E=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,E),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var w=e.getAttribLocation(x,"a_position");e.vertexAttribPointer(w,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(w);var S=e.getUniformLocation(x,"u_tl");e.uniform2f(S,h.x,h.y);var _=e.getUniformLocation(x,"u_br");e.uniform2f(_,f.x,f.y);var C=e.getUniformLocation(x,"u_color");e.uniform4f(C,0,0,0,.2);var A=e.getUniformLocation(x,"u_radius");e.uniform2f(A,8/t,8/r),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(E),e.disableVertexAttribArray(w)}e.useProgram(n.program)},t.prototype.renderBgcTile=function(e,t,r,n,i,o,a){var s=this.root.programs,l=s.bgColorProgram;e.useProgram(l);var c={x1:a.x1-o.x*i,y1:a.y1-o.y*i,x2:a.x2-o.x*i,y2:a.y2-o.y*i,x3:a.x3-o.x*i,y3:a.y3-o.y*i,x4:a.x4-o.x*i,y4:a.y4-o.y*i},u=new Float32Array(8),h=mw(c.x1,c.y1,t,t,!1),d=mw(c.x2,c.y2,t,t,!1),f=mw(c.x3,c.y3,t,t,!1),p=mw(c.x4,c.y4,t,t,!1);u[0]=h.x,u[1]=h.y,u[2]=p.x,u[3]=p.y,u[4]=d.x,u[5]=d.y,u[6]=f.x,u[7]=f.y;var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW);var y=e.getAttribLocation(l,"a_position");e.vertexAttribPointer(y,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(y);var g=e.getUniformLocation(l,"u_color"),m=ep(this.computedStyle.backgroundColor);e.uniform4f(g,m[0],m[1],m[2],m[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(v),e.disableVertexAttribArray(y);var b=s.bgShadowProgram;e.useProgram(b);var x=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,x),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var E=e.getAttribLocation(b,"a_position");e.vertexAttribPointer(E,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(E);var w=e.getUniformLocation(b,"u_tl");e.uniform2f(w,h.x,h.y);var S=e.getUniformLocation(b,"u_br");e.uniform2f(S,f.x,f.y);var _=e.getUniformLocation(b,"u_color");e.uniform4f(_,0,0,0,.2);var C=e.getUniformLocation(b,"u_radius");e.uniform2f(C,8/r,8/n),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(x),e.disableVertexAttribArray(E),e.useProgram(s.program)},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.ART_BOARD,t},t.prototype.toSketchJson=function(t,r){return Z(this,void 0,void 0,(function(){var n,i,o;return J(this,(function(a){switch(a.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=a.sent())._class=Q.ClassValue.Artboard,n.hasClickThrough=!1,n.includeBackgroundColorInExport=!1,n.isFlowHome=!1,n.resizesContent=this.resizesContent,n.includeBackgroundColorInExport=this.includeBackgroundColorInExport,n.horizontalRulerData={_class:"rulerData",base:0,guides:[]},n.verticalRulerData={_class:"rulerData",base:0,guides:[]},i=this.computedStyle,n.backgroundColor={alpha:i.backgroundColor[3],blue:i.backgroundColor[2]/255,green:i.backgroundColor[1]/255,red:i.backgroundColor[0]/255,_class:"color"},n.hasBackgroundColor=this.hasBackgroundColor,[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t,r)})))];case 2:return o=a.sent(),n.layers=o.map((function(e){return e})),[2,n]}}))}))},Object.defineProperty(t.prototype,"filterBbox",{get:function(){var e=this._filterBbox;if(!e){var t=this._bbox||this.bbox;(e=this._filterBbox=t.slice(0))[0]-=8,e[1]-=8,e[2]+=8,e[3]+=8}return e},enumerable:!1,configurable:!0}),t}(Mw),Lw=function(e){function t(t){var r=e.call(this,t)||this;return r.isSlice=!0,r}return p(t,e),t.prototype.calContent=function(){return this.hasContent=!1},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.SLICE,t},t.prototype.toSketchJson=function(t,r){return Z(this,void 0,void 0,(function(){var n;return J(this,(function(i){switch(i.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=i.sent())._class=Q.ClassValue.Slice,[2,n]}}))}))},t}(Ow),Rw={},Iw=function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this.available=!1,this.w=e,this.h=t,this.dx=r,this.dy=n,this.list=[];for(var i=bu.maxTextureSize,o=0,a=Math.ceil(t/i);o<a;o++)for(var s=0,l=Math.ceil(e/i);s<l;s++){var c=s===l-1?e-s*i:i,u=o===a-1?t-o*i:i;this.list.push({x:s*i-r,y:o*i-n,w:c,h:u,os:dh.getOffscreenCanvas(c,u)})}}return e.prototype.release=function(){this.available&&(this.available=!1,this.list.splice(0).forEach((function(e){return e.os.release()})))},e.prototype.releaseImg=function(e){if(this.available){this.available=!1;var t=Rw[e];t.count--,t.count||(delete Rw[e],this.list.splice(0).forEach((function(e){return e.os.release()})))}},e.prototype.getCount=function(e){var t;return null===(t=Rw[e])||void 0===t?void 0:t.count},e.getInstance=function(t,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),new e(t,r,n,i)},e.getImgInstance=function(t,r,n){if(Rw.hasOwnProperty(n)){var i=Rw[n];return i.count++,i.value}var o=new e(t,r,0,0);return Rw[n]={value:o,count:1},o},e}();function Pw(e){switch(e){case Hu.MULTIPLY:return"multiply";case Hu.SCREEN:return"screen";case Hu.OVERLAY:return"overlay";case Hu.DARKEN:return"darken";case Hu.LIGHTEN:return"lighten";case Hu.COLOR_DODGE:return"color-dodge";case Hu.COLOR_BURN:return"color-burn";case Hu.HARD_LIGHT:return"hard-light";case Hu.SOFT_LIGHT:return"soft-light";case Hu.DIFFERENCE:return"difference";case Hu.EXCLUSION:return"exclusion";case Hu.HUE:return"hue";case Hu.SATURATION:return"saturation";case Hu.COLOR:return"color";case Hu.LUMINOSITY:return"luminosity";default:return"source-over"}}var Fw=function(e){function t(t){var r=e.call(this,t)||this;r.isBitmap=!0,r.onlyImg=!0;var n=r._src=t.src||"";if(r.loader={error:!1,loading:!1,url:n,width:0,height:0},r.loaders=[],n){var i=dh.IMG[n];i&&i.state===dh.LOADED&&(i.success?(r.loader.source=i.source,r.loader.width=i.source.width,r.loader.height=i.source.height):r.loader.error=!0)}else r.loader.error=!0;return r}return p(t,e),t.prototype.loadAndRefresh=function(){var e=this,t=this.loader;if(!t.loading||t.url!==this._src){var r=t.error,n=t.source;if(t.source=void 0,t.error=!1,!this.isDestroyed){var i=this.root,o=dh.IMG[this._src];if(o&&o.state===dh.LOADED)return o.success&&o.source?(t.source=o.source,t.width=o.width,t.height=o.height):t.error=!0,void this.root.addUpdate(this,[],XE.REPAINT,!1,!1,void 0);t.loading||i.imgLoadingCount++,(r||n)&&i.addUpdate(this,[],XE.REPAINT,!1,!1,void 0),t.loading=!0,dh.loadImg(this._src,(function(r){r.url===e._src&&(i.imgLoadingCount--,t.loading=!1,r.success?(t.error=!1,t.source=r.source,t.width=r.width,t.height=r.height,e.isDestroyed||e.root.addUpdate(e,[],XE.REPAINT,!1,!1,void 0)):(t.error=!0,e.isDestroyed||e.root.addUpdate(e,[],XE.NONE,!1,!1,void 0)))}))}}},t.prototype.checkLoader=function(){var e=this.loader;return!(e.loading||e.source||e.error)},t.prototype.calContent=function(){var e=this.computedStyle,t=e.fill,r=e.fillOpacity,n=e.fillEnable,i=e.stroke,o=e.strokeEnable,a=e.strokeWidth,s=e.innerShadow,l=e.innerShadowEnable;this.onlyImg=!0;for(var c=0,u=t.length;c<u;c++)if(n[c]&&r[c]){this.onlyImg=!1;break}if(this.onlyImg)for(c=0,u=i.length;c<u;c++)if(o[c]&&a[c]){this.onlyImg=!1;break}if(this.onlyImg)for(c=0,u=s.length;c<u;c++)if(l[c]){this.onlyImg=!1;break}return this.hasContent=!!this.loader.source},t.prototype.renderCanvas=function(t){var r,n,i=this,o=this.loader,a=this.computedStyle;if(this.onlyImg){null===(r=this.canvasCache)||void 0===r||r.releaseImg(this._src);var s=o.width,l=o.height;if((p=this.canvasCache=Iw.getImgInstance(s,l,this._src)).available=!0,1===p.getCount(this._src))for(var c=0,u=(D=p.list).length;c<u;c++){var h=D[c],d=h.x,f=h.y;h.os.ctx.drawImage(o.source,-d,-f)}}else{e.prototype.renderCanvas.call(this,t);var p,v=this._bbox2||this.bbox2,y=(d=v[0],f=v[1],s=v[2]-d,l=v[3]-f,this._rect||this.rect),g=y[2]-y[0],m=y[3]-y[1],b=-d*t,x=-f*t;s*=t,l*=t,(p=this.canvasCache=Iw.getInstance(s,l,b,x)).available=!0;var E=a.fill,w=a.fillOpacity,S=a.fillEnable,_=a.fillMode,C=a.stroke,A=a.strokeEnable,T=a.strokeWidth,O=a.strokePosition,M=a.strokeMode,k=a.strokeDasharray,L=a.strokeLinecap,R=a.strokeLinejoin,I=a.strokeMiterlimit,P=a.innerShadow,F=a.innerShadowEnable,D=p.list,N=function(e,r){var a=D[e],c=a.x,u=a.y,h=a.os,d=h.ctx,f=h.canvas,p=-c,v=-u;d.drawImage(o.source,p,v,g*t,m*t),1!==t?d.setLineDash(k.map((function(e){return e*t}))):d.setLineDash(k);var y=[[0,0],[g,0],[g,m],[0,m],[0,0]];d.beginPath(),JE(d,y,t,p,v),d.closePath();for(var N=function(e,r){if(!S[e]||!w[e])return"continue";var o=void 0,a=E[e],c=void 0,u=_[e];if(u!==Hu.NORMAL&&(c=dh.getOffscreenCanvas(s,l)),d.globalAlpha=w[e],Array.isArray(a)){if(!a[3])return"continue";d.fillStyle=Jf(a)}else{if(a.url){var h=a.url;if(h){var C=B.loaders[e],A=dh.IMG[h];!C&&A&&(C=B.loaders[e]={error:!1,loading:!1,url:h,width:A.width,height:A.height,source:A.source});var T=dh.IMG[h];if(C){if(!C.error&&!C.loading){var O=c||dh.getOffscreenCanvas(s,l),M=O.ctx;if(a.type===th.TILE)for(var k=null!==(n=a.scale)&&void 0!==n?n:1,L=0,R=Math.ceil(g/k/C.width);L<R;L++)for(var I=0,P=Math.ceil(m/k/C.height);I<P;I++)M.drawImage(T.source,p+L*T.width*t*k,v+I*T.height*t*k,T.width*t*k,T.height*t*k);else if(a.type===th.FILL){var F=g*t/T.width,D=m*t/T.height,N=Math.max(F,D),U=-.5*(T.width*N-g*t),z=-.5*(T.height*N-m*t);M.drawImage(T.source,0,0,T.width,T.height,U+p,z+v,T.width*N,T.height*N)}else if(a.type===th.STRETCH)M.drawImage(T.source,p,v,g*t,m*t);else if(a.type===th.FIT){F=g*t/T.width,D=m*t/T.height,N=Math.min(F,D);var G=-.5*(T.width*N-g*t),X=-.5*(T.height*N-m*t);M.drawImage(T.source,0,0,T.width,T.height,G+p,X+v,T.width*N,T.height*N)}M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),u!==Hu.NORMAL&&(d.globalCompositeOperation=Pw(u)),d.drawImage(O.canvas,0,0),u!==Hu.NORMAL&&(d.globalCompositeOperation="source-atop"),O.release()}}else C=B.loaders[e]=B.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},dh.loadImg(h,(function(t){var r;h===(null===(r=E[e])||void 0===r?void 0:r.url)&&(C.loading=!1,t.success?(C.error=!1,C.source=t.source,C.width=t.width,C.height=t.height,i.isDestroyed||i.root.addUpdate(i,[],XE.REPAINT,!1,!1,void 0)):C.error=!0)}))}return"continue"}if(a.t===Wu.LINEAR){var H=Gf(a.stops,a.d,p,v,s-2*b,l-2*x),j=d.createLinearGradient(H.x1,H.y1,H.x2,H.y2);H.stop.forEach((function(e){j.addColorStop(e.offset,Jf(e.color))})),d.fillStyle=j}else if(a.t===Wu.RADIAL){H=Xf(a.stops,a.d,p,v,s-2*b,l-2*x);var W=d.createRadialGradient(H.cx,H.cy,0,H.cx,H.cy,H.total);H.stop.forEach((function(e){W.addColorStop(e.offset,Jf(e.color))}));var Y=H.matrix;if(Y)(M=(o=dh.getOffscreenCanvas(s,l)).ctx).beginPath(),JE(M,y,t,p,v),M.closePath(),M.clip(),M.fillStyle=W,M.setTransform(Y[0],Y[1],Y[4],Y[5],Y[12],Y[13]),M.fill();else d.fillStyle=W}else if(a.t===Wu.CONIC){H=Hf(a.stops,a.d,p,v,s-2*b,l-2*x);var q=d.createConicGradient(H.angle,H.cx+p,H.cy+v);H.stop.forEach((function(e){q.addColorStop(e.offset,Jf(e.color))})),d.fillStyle=q}}if(o){if(c)(M=c.ctx).drawImage(o.canvas,0,0),M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),d.globalCompositeOperation=Pw(u),d.drawImage(c.canvas,0,0),c.release();else d.globalCompositeOperation="source-atop",d.drawImage(o.canvas,0,0);o.release()}else{if(c)(M=c.ctx).fillStyle=d.fillStyle,M.beginPath(),JE(M,y,t,p,v),M.closePath(),M.fill(),M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),d.globalCompositeOperation=Pw(u),d.drawImage(c.canvas,0,0),c.release();else d.globalCompositeOperation="source-atop",d.fill()}},U=0,z=E.length;U<z;U++)N(U);if(d.globalAlpha=1,d.globalCompositeOperation="source-atop",P&&P.length){var G=0;P.forEach((function(e,t){if(F[t]){var r=Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread;G=Math.max(G,r+e.blur)}})),d.save(),d.beginPath(),JE(d,y,t,p,p),d.closePath(),d.clip(),d.fillStyle="#FFF",d.beginPath(),JE(d,y,t,p,p),JE(d,[[-G,-G],[s+G,-G],[s+G,l+G],[-G,l+G],[-G,-G]],1,p,p),d.closePath(),P.forEach((function(e,t){F[t]&&(d.shadowOffsetX=e.x,d.shadowOffsetY=e.y,d.shadowColor=Jf(e.color),d.shadowBlur=e.blur,d.fill("evenodd"))})),d.restore()}L===$u.ROUND?d.lineCap="round":L===$u.SQUARE?d.lineCap="square":d.lineCap="butt",R===Qu.ROUND?d.lineJoin="round":R===Qu.BEVEL?d.lineJoin="bevel":d.lineJoin="miter",d.miterLimit=I*t;for(var X=function(e,r){if(!A[e]||!T[e])return"continue";var n=C[e],i=O[e];if(d.globalCompositeOperation=Pw(M[e]),Array.isArray(n))d.strokeStyle=Jf(n);else if(n.t===Wu.LINEAR){var o=Gf(n.stops,n.d,p,v,s-2*b,l-2*x),a=d.createLinearGradient(o.x1,o.y1,o.x2,o.y2);o.stop.forEach((function(e){a.addColorStop(e.offset,Jf(e.color))})),d.strokeStyle=a}else if(n.t===Wu.RADIAL){o=Xf(n.stops,n.d,p,v,s-2*b,l-2*x);var c=d.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.total);o.stop.forEach((function(e){c.addColorStop(e.offset,Jf(e.color))}));var u=o.matrix;if(u){var h=dh.getOffscreenCanvas(s,l),f=h.ctx;return f.setLineDash(d.getLineDash()),f.lineCap=d.lineCap,f.lineJoin=d.lineJoin,f.miterLimit=d.miterLimit*t,f.lineWidth=T[e]*t,f.strokeStyle="#FFF",f.beginPath(),JE(f,y,t,p,v),f.closePath(),i===eh.INSIDE?(f.lineWidth=2*T[e]*t,f.save(),f.clip(),f.stroke(),f.restore()):i===eh.OUTSIDE?(f.lineWidth=2*T[e]*t,f.stroke(),f.save(),f.clip(),f.globalCompositeOperation="destination-out",f.strokeStyle="#FFF",f.stroke(),f.restore()):f.stroke(),f.fillStyle=c,f.globalCompositeOperation="source-in",f.setTransform(u[0],u[1],u[4],u[5],u[12],u[13]),f.fillRect(0,0,s,l),d.drawImage(h.canvas,0,0),h.release(),"continue"}d.strokeStyle=c}else if(n.t===Wu.CONIC){o=Hf(n.stops,n.d,p,v,s-2*b,l-2*x);var g=d.createConicGradient(o.angle,o.cx+p,o.cy+v);o.stop.forEach((function(e){g.addColorStop(e.offset,Jf(e.color))})),d.strokeStyle=g}var m=void 0,E=void 0;i===eh.INSIDE?d.lineWidth=2*T[e]*t:i===eh.OUTSIDE?((E=(m=dh.getOffscreenCanvas(s,l)).ctx).setLineDash(d.getLineDash()),E.lineCap=d.lineCap,E.lineJoin=d.lineJoin,E.miterLimit=d.miterLimit*t,E.strokeStyle=d.strokeStyle,E.lineWidth=2*T[e]*t,E.beginPath(),JE(E,y,t,p,v)):d.lineWidth=T[e]*t,E&&E.closePath(),i===eh.INSIDE?(d.save(),d.clip(),d.stroke(),d.restore()):i===eh.OUTSIDE?(E.stroke(),E.save(),E.clip(),E.globalCompositeOperation="destination-out",E.strokeStyle="#FFF",E.stroke(),E.restore(),d.drawImage(m.canvas,p-b,v-x),m.release()):d.stroke()},H=0,j=C.length;H<j;H++)X(H);d.globalCompositeOperation="source-over"},B=this;for(c=0,u=D.length;c<u;c++)N(c)}},t.prototype.genTexture=function(t,r,n){if(this.loader.source)if(this.onlyImg){var i=this.textureCache[0];if(i&&i.available)return void(this.textureCache[n]=this.textureTarget[n]=i);var o=this.root.props.uuid,a=(this._rect||this.rect).slice(0);if(a[0]=Math.floor(a[0]),a[1]=Math.floor(a[1]),a[2]=Math.ceil(a[2]),a[3]=Math.ceil(a[3]),Aw.hasImgInstance(o,this._src))return void(this.textureCache[n]=this.textureTarget[n]=this.textureCache[0]=Aw.getImgInstance(o,t,this._src,a));this.renderCanvas(r);var s=this.canvasCache;(null==s?void 0:s.available)&&(this.textureCache[n]=this.textureTarget[n]=this.textureCache[0]=Aw.getImgInstance(o,t,this._src,a,s),s.releaseImg(this._src))}else e.prototype.genTexture.call(this,t,r,n)},t.prototype.clearCache=function(t){var r=this;void 0===t&&(t=!1),this.onlyImg?(t&&this.textureCache.forEach((function(e){return null==e?void 0:e.releaseImg(r.root.props.uuid,r._src)})),this.textureTarget.splice(0),this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()}))):e.prototype.clearCache.call(this,t)},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid,r.src=this._src;var n=new t(r);return n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.BITMAP,t},t.prototype.toSketchJson=function(t){return Z(this,void 0,void 0,(function(){var r,n,i,o,s;return J(this,(function(l){switch(l.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=l.sent())._class=Q.ClassValue.Bitmap,r.image={_class:"MSJSONFileReference",_ref_class:"MSImageData",_ref:""},r.fillReplacesImage=!1,(n=t.folder("images"))?[4,fetch(this._src)]:[3,3];case 2:i=l.sent(),o=i.blob(),s=this.props.md5||this.props.uuid||a(),n.file(s,o),r.image._ref="images/"+s,l.label=3;case 3:return[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this);var r=this.loader;r.loading&&t&&(t.imgLoadingCount--,r.loading=!1)}},Object.defineProperty(t.prototype,"src",{get:function(){return this._src},set:function(e){this._src!==e&&(this.clearCache(!0),this._src=e,this.loadAndRefresh())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===eh.OUTSIDE?a=Math.max(a,e):o[t]===eh.CENTER&&(a=Math.max(a,.5*e)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),t}(Ow);function Dw(e,t,r,n,i){var o=e.slice(0);if(n===Qu.ROUND)return o[0]-=t,o[1]-=t,o[2]+=t,o[3]+=t,o;if(!r.length)return o;for(var a=[],s=[],l=r[0],c=l[0],u=l[1],h=1,d=r.length;h<d;h++){var f=0,p=0;2===(m=r[h]).length?(f=m[0]-c,p=m[1]-u,c=m[0],u=m[1],a.push([f,p])):4===m.length?(f=2*(c-2*m[0]+m[2])+2*m[0]-2*c,p=2*(u-2*m[1]+m[3])+2*m[1]-2*u,c=m[2],u=m[3],a.push([f,p])):6===m.length&&(f=3*(-c+3*m[0]-3*m[2]+m[4])+2*(3*c-6*m[0]+3*m[2])+3*m[0]-3*c,p=3*(-u+3*m[1]-3*m[3]+m[5])+2*(3*u-6*m[1]+3*m[3])+3*m[1]-3*u,c=m[4],u=m[5],a.push([f,p]));var v=Math.atan(Math.abs(p/f)),y=Math.sin(v)*t,g=Math.cos(v)*t;f>=0?p>=0?s.push([-y,g]):s.push([y,g]):p>=0?s.push([-y,-g]):s.push([y,-g])}for(h=0,d=a.length;h<d;h++){var m=a[h],b=a[(h+1)%d];if(m[0]&&m[1]&&b[0]&&b[1]){var x=Yh(m[0],m[1],b[0],b[1]),E=s[h],w=s[(h+1)%d];if(E[0]||E[1]||w[0]||w[1]){var S=0,_=0,C=0,A=0,T=[m[0]+E[0],m[1]+E[1]],O=Yh(m[0],m[1],T[0],T[1]);x>=0&&O>=0||x<0&&O<0?(S=-E[0],_=-E[1]):(S=E[0],_=E[1]);var M=[b[0]+w[0],b[1]+w[1]],k=Yh(b[0],b[1],M[0],M[1]);x>=0&&k>=0||x<0&&k<0?(C=-w[0],A=-w[1]):(C=w[0],A=w[1]);var L=r[h],R=r[h+1],I=r[(h+2)%d],P=L.length,F=R.length,D=I.length,N=L[P-2]+S,B=L[P-1]+_,U=R[F-2]+S,z=R[F-1]+_,G=R[F-2]+C,X=R[F-1]+A,H=Af(N,B,U,z,G,X,I[D-2]+C,I[D-1]+A,!1);if(H&&1!==H.toSource&&0!==H.toClip)if(n===Qu.BEVEL)if((V=2*t/Math.sqrt(Math.pow(G-U,2)+Math.pow(X-z,2)))>=1)o[0]=Math.min(o[0],U,G),o[1]=Math.min(o[1],z,X),o[2]=Math.max(o[2],U,G),o[3]=Math.max(o[3],z,X);else{var j=H.x-(H.x-U)*V,W=H.y-(H.y-z)*V,Y=H.x-(H.x-G)*V,q=H.y-(H.y-X)*V;o[0]=Math.min(o[0],j,Y),o[1]=Math.min(o[1],W,q),o[2]=Math.max(o[2],j,Y),o[3]=Math.max(o[3],W,q)}else if(n===Qu.MITER){var V;if((V=Math.sqrt(Math.pow(H.x-R[F-2],2)+Math.pow(H.y-R[F-1],2))/t)>i){var K=2*t/Math.sqrt(Math.pow(G-U,2)+Math.pow(X-z,2));if(K>=1)o[0]=Math.min(o[0],U,G),o[1]=Math.min(o[1],z,X),o[2]=Math.max(o[2],U,G),o[3]=Math.max(o[3],z,X);else{j=H.x-(H.x-U)*K,W=H.y-(H.y-z)*K,Y=H.x-(H.x-G)*K,q=H.y-(H.y-X)*K;o[0]=Math.min(o[0],j,Y),o[1]=Math.min(o[1],W,q),o[2]=Math.max(o[2],j,Y),o[3]=Math.max(o[3],W,q)}}else o[0]=Math.min(o[0],H.x),o[1]=Math.min(o[1],H.y),o[2]=Math.max(o[2],H.x),o[3]=Math.max(o[3],H.y)}}}}return o}function Nw(e,t,r,n,i){if(3===arguments.length){var o=t,a=o[0],s=o[1],l=o[2],c=o[3];if(!id(r)){var u=yd({x:a,y:s},r),h=yd({x:a,y:c},r),d=yd({x:l,y:s},r),f=yd({x:l,y:c},r);a=Math.min(u.x,h.x,d.x,f.x),s=Math.min(u.y,h.y,d.y,f.y),l=Math.max(u.x,h.x,d.x,f.x),c=Math.max(u.y,h.y,d.y,f.y)}e[0]=Math.min(e[0],a),e[1]=Math.min(e[1],s),e[2]=Math.max(e[2],l),e[3]=Math.max(e[3],c)}else 2===arguments.length?(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3])):5===arguments.length&&(e[0]=Math.min(e[0],t),e[1]=Math.min(e[1],r),e[2]=Math.max(e[2],n),e[3]=Math.max(e[3],i))}function Bw(e,t){var r,n;if(6===e.length)r=e[4],n=e[5];else if(4===e.length)r=e[2],n=e[3];else{if(2!==e.length)return void dh.error("Unsupported point data: "+e.join(","));r=e[0],n=e[1]}return t[0]=r,t[1]=n,t[2]=r,t[3]=n,{x:r,y:n}}function Uw(e,t,r,n){var i,o;if(4===e.length)i=e[2],o=e[3],Nw(n,(a=yf.bboxBezier(t,r,e[0],e[1],i,o))[0],a[1],a[2],a[3]);else if(6===e.length){var a;i=e[4],o=e[5],Nw(n,(a=yf.bboxBezier(t,r,e[0],e[1],e[2],e[3],i,o))[0],a[1],a[2],a[3])}else{if(2!==e.length)return void dh.error("Unsupported point data: "+e.join(","));Nw(n,i=e[0],o=e[1],i,o)}return{x:i,y:o}}var zw=function(e){function t(t){var r=e.call(this,t)||this;return r.isGeom=!0,r.loaders=[],r}return p(t,e),t.prototype.lay=function(t){e.prototype.lay.call(this,t),this.coords=void 0},t.prototype.calRepaintStyle=function(t){e.prototype.calRepaintStyle.call(this,t),this.coords=void 0,this._rect=void 0,this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0},t.prototype.buildPoints=function(){this.coords||(this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this.coords=[])},t.prototype.calContent=function(){return this.buildPoints(),this.hasContent=!!this.coords&&this.coords.length>1},t.prototype.isLine=function(){this.buildPoints();var e=this.coords;return!!e&&2===e.length&&2===e[0].length&&2===e[1].length},t.prototype.refresh=function(t,r){void 0===t&&(t=XE.REPAINT),t>=XE.REPAINT&&(this.coords=void 0),e.prototype.refresh.call(this,t,r)},t.prototype.toSvg=function(e,t){void 0===t&&(t=!1),this.buildPoints();var r=this.computedStyle,n=this.coords||[],i=new Float64Array(this.matrixWorld),o=[],a=0,s=0,l=0,c=0,u=!0;n.forEach((function(e,t){if(6===e.length){var r=yd({x:e[0],y:e[1]},i),n=yd({x:e[2],y:e[3]},i),h=yd({x:e[4],y:e[5]},i);o.push([r.x,r.y,n.x,n.y,h.x,h.y]),u?(u=!1,a=Math.min(r.x,n.x,h.x),s=Math.min(r.y,n.y,h.y),l=Math.max(r.x,n.x,h.x),c=Math.max(r.y,n.y,h.y)):(a=Math.min(a,r.x,n.x,h.x),s=Math.min(s,r.y,n.y,h.y),l=Math.max(l,r.x,n.x,h.x),c=Math.max(c,r.y,n.y,h.y))}else if(4===e.length){r=yd({x:e[0],y:e[1]},i),n=yd({x:e[2],y:e[3]},i);o.push([r.x,r.y,n.x,n.y]),u?(u=!1,a=Math.min(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.x,n.x),c=Math.max(r.y,n.y)):(a=Math.min(a,r.x,n.x),s=Math.min(s,r.y,n.y),l=Math.max(l,r.x,n.x),c=Math.max(c,r.y,n.y))}else if(2===e.length){var d=yd({x:e[0],y:e[1]},i);o.push([d.x,d.y]),u?(u=!1,a=d.x,s=d.y,l=d.x,c=d.y):(a=Math.min(a,d.x),s=Math.min(s,d.y),l=Math.max(l,d.x),c=Math.max(c,d.y))}}));var h=l-a||1,d=c-s||1,f=1;f=h>=d?e/h:e/d;var p=$E(o.map((function(e){return e.map((function(e){return e*f}))})),-a*f,-s*f);p&&t&&(p+="Z");var v=[["d",p],["fill","#D8D8D8"],["fill-rule",r.fillRule===Zu.EVEN_ODD?"evenodd":"nonzero"],["stroke","#979797"],["stroke-width",1]],y='<svg width="'.concat(h*f,'" height="').concat(d*f,'"><path');return v.forEach((function(e){y+=" "+e[0]+'="'+e[1]+'"'})),y+"></path></svg>"},Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;if(!e){e=this._rect=new Float64Array(4),this.buildPoints();var t=this.coords;t&&t.length&&function(e,t){var r=!0;t=t||new Float64Array(4);for(var n=0,i=0,o=0,a=e.length;o<a;o++){var s=e[o];if(r){if(!(l=Bw(s,t))){dh.error("Unsupported point data: "+o+" - "+s.join(","));continue}n=l.x,i=l.y,r=!1}else{var l;if(!(l=Uw(s,n,i,t))){dh.error("Unsupported point data: "+o+" - "+s.join(","));continue}n=l.x,i=l.y}}}(t,e)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.buildPoints();var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=r.strokeLinecap,s=r.strokeLinejoin,l=r.strokeMiterlimit,c=this.props.isClosed,u=0;n.forEach((function(e,t){i[t]&&(o[t]===eh.OUTSIDE&&c?u=Math.max(u,e):o[t]!==eh.CENTER&&c||(u=Math.max(u,.5*e)))}));var h=e[0]-u,d=e[1]-u,f=e[2]+u,p=e[3]+u;e=this._bbox=c?Dw(e,u,this.coords||[],s,l):function(e,t,r,n){var i=e.slice(0);if(n===$u.ROUND&&(i[0]-=t,i[1]-=t,i[2]+=t,i[3]+=t),!r.length)return i;for(var o=r[0],a=r[r.length-1],s=a.length,l=[],c=0;c<s;c+=2)l.push({x:a[c],y:a[c+1]});var u=0,h=0;s>2?(u=Math.abs(rf(l,0)),h=Math.abs(rf(l,1))):u=h=Math.abs(a[s-1]-o[1])/Math.abs(a[s-2]-o[0]);var d=Math.atan(u),f=Math.atan(h),p=Math.sin(d),v=Math.cos(d),y=Math.sin(f),g=Math.cos(f),m=p===1/0?t:Math.abs(p*t),b=v===1/0?t:Math.abs(v*t),x=y===1/0?t:Math.abs(y*t),E=g===1/0?t:Math.abs(g*t);return n===$u.BUTT?(i[0]=Math.min(i[0],o[0]-m,a[s-2]-x),i[1]=Math.min(i[1],o[1]-b,a[s-1]-E),i[2]=Math.max(i[2],o[0]+m,a[s-2]+x),i[3]=Math.max(i[3],o[1]+b,a[s-1]+E)):n===$u.SQUARE&&(i[0]=Math.min(i[0],o[0]-m-b,a[s-2]-x-E),i[1]=Math.min(i[1],o[1]-m-b,a[s-1]-x-E),i[2]=Math.max(i[2],o[0]+m+b,a[s-2]+x+E),i[3]=Math.max(i[3],o[1]+m+b,a[s-1]+x+E)),i}(e,u,this.coords||[],a),e[0]=Math.min(e[0],h),e[1]=Math.min(e[1],d),e[2]=Math.max(e[2],f),e[3]=Math.max(e[3],p)}return e},enumerable:!1,configurable:!0}),t}(Ow);function Gw(e){return e.curveMode===Vu.STRAIGHT&&e.cornerRadius>0}function Xw(e,t,r,n,i,o){var a=_d(e.absX,e.absY,t.absX,t.absY),s=_d(t.absX,t.absY,r.absX,r.absY),l=Cd(_d(e.absX,e.absY,r.absX,r.absY),a,s),c=Math.tan(.5*l),u=o/c,h=Math.min(n?.5*a:a,i?.5*s:s);u>h&&(o=(u=h)*c);var d=Jh(e.absX-t.absX,e.absY-t.absY),f=Jh(r.absX-t.absX,r.absY-t.absY),p={x:d.x*u,y:d.y*u};p.x+=t.absX,p.y+=t.absY;var v={x:f.x*u,y:f.y*u};v.x+=t.absX,v.y+=t.absY;var y=4/3*Math.tan((Math.PI-l)/4),g={x:d.x*-o*y,y:d.y*-o*y};g.x+=p.x,g.y+=p.y;var m={x:f.x*-o*y,y:f.y*-o*y};return m.x+=v.x,m.y+=v.y,{prevTangent:p,prevHandle:g,nextTangent:v,nextHandle:m}}function Hw(e,t,r,n,i,o){var a,s,l,c;if(n){var u=Math.sqrt(Math.pow(t.absX-e.absX,2)+Math.pow(t.absY-e.absY,2));o=Math.min(o,.5*u)}if(i){u=Math.sqrt(Math.pow(t.absX-r.absX,2)+Math.pow(t.absY-r.absY,2));o=Math.min(o,.5*u)}var h=e.absFx-t.absX,d=e.absFy-t.absY,f=r.absTx-t.absX,p=r.absTy-t.absY,v=e.absX-t.absX,y=e.absY-t.absY,g=r.absX-t.absX,m=r.absY-t.absY,b=Yh(h,d,f,p),x=Yh(v,y,g,m),E=Yh(h,d,v,y),w=Yh(f,p,g,m);if(!(Math.abs(b)<1e-6)){var S=[{x:e.absX,y:e.absY},{x:null!==(a=e.absFx)&&void 0!==a?a:e.absX,y:null!==(s=e.absFy)&&void 0!==s?s:e.absY},{x:t.absX,y:t.absY}],_=[{x:t.absX,y:t.absY},{x:null!==(l=r.absTx)&&void 0!==l?l:r.absX,y:null!==(c=r.absTy)&&void 0!==c?c:r.absY},{x:r.absX,y:r.absY}],C=kf.intersectBezier2Bezier2(S[0].x,S[0].y,S[1].x,S[1].y,S[2].x,S[2].y,_[0].x,_[0].y,_[1].x,_[1].y,_[2].x,_[2].y).filter((function(e){return e.x!==_[0].x&&e.y!==_[0].y})).sort((function(e,t){return e.t1===t.t1?t.t2-e.t2:t.t1-e.t1})),A=C.length;if(!A)return jw(S,_,t,A,!1,b,x,E,w,o,0,1,0,1);var T=C.map((function(e){return e.t1})),O=C.map((function(e){return tf(_,e.x,e.y)[0]}));if(!O.find((function(e){return void 0===e}))){var M=!1;T.unshift(1),T.push(0),O.unshift(0),O.push(1);for(var k=0;k<=A;k++){var L=jw(S,_,t,A,M,b,x,E,w,o,T[k+1],T[k],O[k],O[k+1]);if(L)return L;M=!M}}}}function jw(e,t,r,n,i,o,a,s,l,c,u,h,d,f){var p=Yw(e,n,i,o,a,s,c,!0,u,h),v=Yw(t,n,i,o,a,l,c,!1,d,f);if(!(!p||p.length<2||!v||v.length<2)){var y=function(e,t){var r=Kw(e,0),n=Kw(t,1),i=function(e){var t={};e.forEach((function(e){var r,n=e.x1,i=e.x2;n>i&&(n=(r=[i,n])[0],i=r[1]),qw(t,n,e),qw(t,i,e)}));var r=[];return Object.keys(t).forEach((function(e){return r.push({x:parseFloat(e),arr:t[e]})})),r.sort((function(e,t){return e.x-t.x}))}(r.concat(n)),o=[],a=[],s=[];for(;i.length;){a.length&&a.splice(0).forEach((function(e){var t=o.indexOf(e);o.splice(t,1)}));for(var l=i.shift().arr;l.length;){var c=l.shift();if(!c.isDeleted){var u=c.belong,h=c.bbox;if(c.isVisited)a.push(c);else{if(o.length)for(var d=c.x1,f=c.y1,p=c.x2,v=c.y2,y=c.bbox,g=0;g<o.length;g++){var m=o[g];if(!m.isDeleted&&!c.isDeleted&&m.belong!==u){var b=m.x1,x=m.y1,E=m.x2,w=m.y2;if(Ad(h[0],h[1],h[2],h[3],y[0],y[1],y[2],y[3],!0)){var S=(w-x)*(p-d)-(E-b)*(v-f);if(0!==S){var _=((E-b)*(f-x)-(w-x)*(d-b))/S,C=((p-d)*(f-x)-(v-f)*(d-b))/S;if(_>=0&&_<=1&&C>=0&&C<=1){var A=d+_*(p-d),T=f+_*(v-f);s.push({x:A,y:T,t1:0===u?c.t:m.t,t2:0===u?m.t:c.t}),c.isDeleted=!0;break}}}}}c.isDeleted||(o.push(c),c.isVisited=!0)}}}}return s}(p,v);if(y.length){var g=y[0];if(y.length>1)for(var m=Math.pow(r.absX-g.x,2)+Math.pow(r.absY-g.y,2),b=1,x=y.length;b<x;b++){var E=y[b],w=Math.pow(r.absX-E.x,2)+Math.pow(r.absY-E.y,2);w<m&&(g=E,m=w)}var S=$d(e,g.t1),_=$d(t,g.t2),C=rf(e,g.t1),A=rf(t,g.t2),T=S.y-C*S.x,O=(_.y-A*_.x-T)/(C-A),M=C*O+T;Math.abs(C)<1e-9?(M=S.y,A!==1/0&&A!==-1/0||(O=_.x)):Math.abs(A)<1e-9?(M=_.y,C!==1/0&&C!==-1/0||(O=S.x)):C===1/0||C===-1/0?(O=S.x,M=_.y):A!==1/0&&A!==-1/0||(O=_.x,M=S.y);var k=_d(S.x,S.y,O,M),L=_d(O,M,_.x,_.y),R=Cd(_d(S.x,S.y,_.x,_.y),k,L),I=4/3*Math.tan((Math.PI-R)/4),P=Jh(S.x-O,S.y-M),F=Jh(_.x-O,_.y-M),D={x:P.x*-c*I,y:P.y*-c*I};D.x+=S.x,D.y+=S.y;var N={x:F.x*-c*I,y:F.y*-c*I};return N.x+=_.x,N.y+=_.y,{prevTangent:S,prevHandle:D,nextTangent:_,nextHandle:N,t1:g.t1,t2:g.t2}}}}var Ww={11010:1,11e3:1,11110:1,11100:1,11001:1,11111:1,11012:1,11002:1,11112:1,11102:1,11013:1,11103:1,10010:0,10100:0,10011:0,10001:0,10111:0,10101:0,"00010":0,"00000":0,"00110":0,"00100":0,"00011":0,"00101":0,"00002":0,"00012":0,"00102":0,"00112":0,"00003":0,"00103":0,"01000":1,"01110":1,"01001":1,"01011":1,"01101":1,"01111":1};function Yw(e,t,r,n,i,o,a,s,l,c){var u=(i>=0?"0":"1")+(n>=0?"0":"1")+(s?"0":"1")+(o>=0?"0":"1")+t;if(Ww.hasOwnProperty(u)){for(var h=Math.ceil(Vd(e)),d=[],f=function(t){var n=t/h;if(n<=l||n>c)return"continue";var i,o=2*(e[0].x-2*e[1].x+e[2].x)*n+2*e[1].x-2*e[0].x,s=2*(e[0].y-2*e[1].y+e[2].y)*n+2*e[1].y-2*e[0].y,f=$d(e,n),p=rf(e,n),v=0;v=Math.abs(p)<1e-12?1/0:p===1/0||p===-1/0?0:-1/p,i=v===1/0?f.y:f.y-v*f.x;var y=void 0,g=void 0;v===1/0?(y=[f.x,f.x],g=[f.y-a,f.y+a]):g=(y=Bd([Math.pow(f.x,2)+Math.pow(i,2)-2*f.y*i+Math.pow(f.y,2)-Math.pow(a,2),2*(i*v-f.x-f.y*v),Math.pow(v,2)+1])).map((function(e){return v*e+i}));var m=Yh(y[0]-f.x,g[0]-f.y,o,s)>=0?0:1;r&&(m=(m+1)%2),Ww[u]===m?d.push({x:y[0],y:g[0],t:n}):d.push({x:y[1],y:g[1],t:n})},p=0;p<=h;p++)f(p);return d}}function qw(e,t,r){var n=e[t]=e[t]||[];r.isVisited?(n.unshift(r),r.isVisited=!1):(n.push(r),r.isVisited=!0)}var Vw=0;function Kw(e,t){for(var r,n,i=[],o=1,a=e.length;o<a;o++){var s=e[o-1],l=s.x,c=s.y,u=s.t,h=e[o],d=h.x,f=h.y,p=h.t;(d<l||l===d&&f<c)&&(l=(r=[d,l])[0],d=r[1],c=(n=[f,c])[0],f=n[1]);var v=[l,Math.min(c,f),d,Math.max(c,f)];i.push({id:Vw++,x1:l,y1:c,x2:d,y2:f,bbox:v,belong:t,isVisited:!1,isDeleted:!1,t:.5*(u+p)})}return i}var Zw=1e-4,Jw=function(e){function t(t){var r=e.call(this,t)||this;return r.props=t,r.isPolyline=!0,r}return p(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this),this.checkPointsChange(!0)},t.prototype.buildPoints=function(){if(!this.coords){this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this.coords=[];var e=this.width,t=this.height,r=this.props.points;if(r.length){for(var n=!1,i=0,o=r.length;i<o;i++){(L=r[i]).absX=(L.x||0)*e,L.absY=(L.y||0)*t,L.absTx=L.tx*e,L.absTy=L.ty*t,L.absFx=L.fx*e,L.absFy=L.fy*t,Gw(L)&&(n=!0)}var a=[];if(n){i=0;for(var s=r.length;i<s;i++){var l=r[i];if(Gw(l)){var c=(i+1)%s,u=r[i?i-1:s-1],h=r[c],d=l.cornerRadius,f=Gw(u),p=f||u.curveMode===Vu.STRAIGHT||!u.hasCurveFrom,v=Gw(h),y=v||h.curveMode===Vu.STRAIGHT||!h.hasCurveTo;a[i]=p&&y?Xw(u,l,h,f,v,d):Hw(u,l,h,f,v,d)}}}for(var g=Iu(r),m=(i=0,g.length);i<m;i++){var b=a[i];if(b){var x=b.prevTangent,E=b.prevHandle,w=b.nextTangent,S=b.nextHandle,_={x:0,y:0,cornerRadius:0,cornerStyle:0,curveMode:0,hasCurveFrom:!0,fx:0,fy:0,hasCurveTo:!1,tx:0,ty:0,absX:x.x,absY:x.y,absFx:E.x,absFy:E.y,absTx:0,absTy:0},C={x:0,y:0,cornerRadius:0,cornerStyle:0,curveMode:0,hasCurveFrom:!1,fx:0,fy:0,hasCurveTo:!0,tx:0,ty:0,absX:w.x,absY:w.y,absFx:0,absFy:0,absTx:S.x,absTy:S.y};if(b.t1){var A=Jd([{x:(R=g[(i+m-1)%m]).absX,y:R.absY},{x:R.absFx,y:R.absFy},{x:g[i].absX,y:g[i].absY}],0,b.t1);R.absFx=A[1].x,R.absFy=A[1].y}if(b.t2){var T=g[(i+1)%m];A=Jd([{x:T.absX,y:T.absY},{x:T.absTx,y:T.absTy},{x:g[i].absX,y:g[i].absY}],0,1-b.t2);T.absTx=A[1].x,T.absTy=A[1].y}g.splice(i,1,_,C),i++,m++,a.splice(i,0,void 0)}}var O=g[0],M=[O.absX,O.absY];this.coords.push(M);var k=g.length;for(i=1;i<k;i++){var L=g[i],R=g[i-1],I=[L.absX,L.absY];L.hasCurveTo&&I.unshift(L.absTx,L.absTy),R.hasCurveFrom&&I.unshift(R.absFx,R.absFy),this.coords.push(I)}if(this.props.isClosed){var P=g[k-1],F=[O.absX,O.absY];O.hasCurveTo&&F.unshift(O.absTx,O.absTy),P.hasCurveFrom&&F.unshift(P.absFx,P.absFy),this.coords.push(F)}}}},t.prototype.reflectPoints=function(e){void 0===e&&(e=this.props.points);var t=this.width,r=this.height;(Array.isArray(e)?e:[e]).forEach((function(e){e.x=e.absX/t,e.y=e.absY/r,e.tx=e.absTx/t,e.ty=e.absTy/r,e.fx=e.absFx/t,e.fy=e.absFy/r}))},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t),this.buildPoints();var i=this.coords;if(i&&i.length){var o=this._bbox2||this.bbox2,a=o[0],s=o[1],l=o[2]-a,c=o[3]-s,u=-a*t,h=-s*t;l*=t,c*=t;var d=this.canvasCache=Iw.getInstance(l,c,u,h);d.available=!0;for(var f=this.computedStyle,p=f.fill,v=f.fillOpacity,y=f.fillRule,g=f.fillEnable,m=f.fillMode,b=f.stroke,x=f.strokeEnable,E=f.strokeWidth,w=f.strokePosition,S=f.strokeMode,_=f.strokeDasharray,C=f.strokeLinecap,A=f.strokeLinejoin,T=f.strokeMiterlimit,O=d.list,M=function(e,o){var a=O[e],s=a.x,d=a.y,f=a.os.ctx,M=-s,L=-d;1!==t?f.setLineDash(_.map((function(e){return e*t}))):f.setLineDash(_),f.beginPath(),JE(f,i,t,M,L),k.props.isClosed&&f.closePath();for(var R=function(e,o){if(!g[e]||!v[e])return"continue";var a=p[e],s=void 0,d=m[e];if(f.globalAlpha=v[e],Array.isArray(a)){if(a[3]<=0)return"continue";f.fillStyle=Jf(a)}else{if(void 0!==a.url){var b=a.url;if(b){var x=k.loaders[e],E=dh.IMG[b];if(!x&&E&&E.source&&(x=k.loaders[e]={error:!1,loading:!1,width:E.width,height:E.height,source:E.source}),x)if(x.error||x.loading||!x.source)x.error||x.loading||k.root.imgLoadingCount++;else{var w=k.width,S=k.height,_=w*t,C=S*t,A=dh.getOffscreenCanvas(l,c);if((W=A.ctx).beginPath(),JE(W,i,t,M,L),k.props.isClosed&&W.closePath(),W.save(),W.clip(),a.type===th.TILE)for(var T=null!==(r=a.scale)&&void 0!==r?r:1,O=0,R=Math.ceil(w/T/x.width);O<R;O++)for(var I=0,P=Math.ceil(S/T/x.height);I<P;I++)W.drawImage(x.source,M+O*x.width*t*T,L+I*x.height*t*T,x.width*t*T,x.height*t*T);else if(a.type===th.FILL){var F=_/x.width,D=C/x.height,N=Math.max(F,D),B=-.5*(x.width*N-_),U=-.5*(x.height*N-C);W.drawImage(x.source,0,0,x.width,x.height,B+M,U+L,x.width*N,x.height*N)}else if(a.type===th.STRETCH)W.drawImage(x.source,M,L,_,C);else if(a.type===th.FIT){F=_/x.width,D=C/x.height,N=Math.min(F,D);var z=-.5*(x.width*N-_),G=-.5*(x.height*N-C);W.drawImage(x.source,0,0,x.width,x.height,z+M,G+L,x.width*N,x.height*N)}W.restore(),d!==Hu.NORMAL&&(f.globalCompositeOperation=Pw(d)),f.drawImage(A.canvas,0,0),d!==Hu.NORMAL&&(f.globalCompositeOperation="source-over"),A.release()}else k.root.imgLoadingCount++,x=k.loaders[e]=k.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},dh.loadImg(b,(function(t){var r;b===(null===(r=p[e])||void 0===r?void 0:r.url)&&(x.loading=!1,t.success?(x.error=!1,x.source=t.source,x.width=t.width,x.height=t.height,n.isDestroyed||n.root.addUpdate(n,[],XE.REPAINT,!1,!1,void 0)):x.error=!0,n.root.imgLoadingCount--)}))}return"continue"}if(a.t===Wu.LINEAR){var X=Gf(a.stops,a.d,M,L,l-2*u,c-2*h),H=f.createLinearGradient(X.x1,X.y1,X.x2,X.y2);X.stop.forEach((function(e){H.addColorStop(e.offset,Jf(e.color))})),f.fillStyle=H}else if(a.t===Wu.RADIAL){X=Xf(a.stops,a.d,M,L,l-2*u,c-2*h);var j=f.createRadialGradient(X.cx,X.cy,0,X.cx,X.cy,X.total);X.stop.forEach((function(e){j.addColorStop(e.offset,Jf(e.color))}));var W,Y=X.matrix;if(Y)(W=(s=dh.getOffscreenCanvas(l,c)).ctx).beginPath(),JE(W,i,t,M,L),k.props.isClosed&&W.closePath(),W.clip(),W.fillStyle=j,W.setTransform(Y[0],Y[1],Y[4],Y[5],Y[12],Y[13]),W.fill(y===Zu.EVEN_ODD?"evenodd":"nonzero");else f.fillStyle=j}else if(a.t===Wu.CONIC){X=Hf(a.stops,a.d,M,L,l-2*u,c-2*h);var q=f.createConicGradient(X.angle,X.cx+M,X.cy+L);X.stop.forEach((function(e){q.addColorStop(e.offset,Jf(e.color))})),f.fillStyle=q}}d!==Hu.NORMAL&&(f.globalCompositeOperation=Pw(d)),s?(f.drawImage(s.canvas,0,0),s.release()):f.fill(y===Zu.EVEN_ODD?"evenodd":"nonzero"),d!==Hu.NORMAL&&(f.globalCompositeOperation="source-over")},I=0,P=p.length;I<P;I++)R(I);f.globalAlpha=1,f.globalCompositeOperation="source-over";var F=k.computedStyle,D=F.innerShadow,N=F.innerShadowEnable;if(D&&D.length){var B=!1,U=0;D.forEach((function(e,r){if(N[r]){B=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread)*t;U=Math.max(U,n+e.blur*t)}})),B&&(f.save(),f.beginPath(),JE(f,i,t,M,L),k.props.isClosed&&f.closePath(),f.clip(),f.fillStyle="#FFF",f.beginPath(),JE(f,i,t,M,L),JE(f,[[-U,-U],[l+U,-U],[l+U,c+U],[-U,c+U],[-U,-U]],1,M,L),f.closePath(),D.forEach((function(e,r){N[r]&&(f.shadowOffsetX=e.x*t,f.shadowOffsetY=e.y*t,f.shadowColor=Jf(e.color),f.shadowBlur=e.blur*t,f.fill("evenodd"))})),f.restore(),f.beginPath(),JE(f,i,t,M,L),k.props.isClosed&&f.closePath())}C===$u.ROUND?f.lineCap="round":C===$u.SQUARE?f.lineCap="square":f.lineCap="butt",A===Qu.ROUND?f.lineJoin="round":A===Qu.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=T;for(var z=function(e,r){if(!x[e]||!E[e])return"continue";var n=b[e],o=w[e];if(f.globalCompositeOperation=Pw(S[e]),Array.isArray(n))f.strokeStyle=Jf(n);else if(n.t===Wu.LINEAR){var a=Gf(n.stops,n.d,M,L,l-2*M,c-2*L),s=f.createLinearGradient(a.x1,a.y1,a.x2,a.y2);a.stop.forEach((function(e){s.addColorStop(e.offset,Jf(e.color))})),f.strokeStyle=s}else if(n.t===Wu.RADIAL){a=Xf(n.stops,n.d,M,L,l-2*M,c-2*L);var d=f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.total);a.stop.forEach((function(e){d.addColorStop(e.offset,Jf(e.color))}));var p=a.matrix;if(p){var v=dh.getOffscreenCanvas(l,c),y=v.ctx;return y.setLineDash(f.getLineDash()),y.lineCap=f.lineCap,y.lineJoin=f.lineJoin,y.miterLimit=f.miterLimit,y.lineWidth=E[e]*t,y.strokeStyle="#FFF",y.beginPath(),JE(y,i,t,M,L),k.props.isClosed&&y.closePath(),o===eh.INSIDE&&k.props.isClosed?(y.lineWidth=2*E[e]*t,y.save(),y.clip(),y.stroke(),y.restore()):o===eh.OUTSIDE&&k.props.isClosed?(y.lineWidth=2*E[e]*t,y.stroke(),y.save(),y.clip(),y.globalCompositeOperation="destination-out",y.strokeStyle="#FFF",y.stroke(),y.restore()):y.stroke(),y.fillStyle=d,y.globalCompositeOperation="source-in",y.setTransform(p[0],p[1],p[4],p[5],p[12],p[13]),y.fillRect(0,0,l,c),f.drawImage(v.canvas,0,0),v.release(),"continue"}f.strokeStyle=d}else if(n.t===Wu.CONIC){a=Hf(n.stops,n.d,M,L,l-2*M,c-2*L);var g=f.createConicGradient(a.angle,a.cx+M,a.cy+L);a.stop.forEach((function(e){g.addColorStop(e.offset,Jf(e.color))})),f.strokeStyle=g}var m=void 0,_=void 0;o===eh.INSIDE&&k.props.isClosed?f.lineWidth=2*E[e]*t:o===eh.OUTSIDE&&k.props.isClosed?((_=(m=dh.getOffscreenCanvas(l,c)).ctx).setLineDash(f.getLineDash()),_.lineCap=f.lineCap,_.lineJoin=f.lineJoin,_.miterLimit=f.miterLimit,_.strokeStyle=f.strokeStyle,_.lineWidth=2*E[e]*t,_.beginPath(),JE(_,i,t,M,L)):f.lineWidth=E[e]*t,k.props.isClosed&&_&&_.closePath(),o===eh.INSIDE&&k.props.isClosed?(f.save(),f.clip(),f.stroke(),f.restore()):o===eh.OUTSIDE&&k.props.isClosed?(_.stroke(),_.save(),_.clip(),_.globalCompositeOperation="destination-out",_.strokeStyle="#FFF",_.stroke(),_.restore(),f.drawImage(m.canvas,M-u,L-h),m.release()):f.stroke()},G=0,X=b.length;G<X;G++)z(G);f.globalCompositeOperation="source-over"},k=this,L=0,R=O.length;L<R;L++)M(L)}},t.prototype.checkPointsChange=function(e){void 0===e&&(e=!1);var t=this._rect||this.rect,r=t[0],n=t[1],i=t[2]-this.width,o=t[3]-this.height;if(!this.isLine()&&(Math.abs(r)>Zw||Math.abs(n)>Zw||Math.abs(i)>Zw||Math.abs(o)>Zw)){var a=this.style,s=this.computedStyle,l=s.transformOrigin,c=s.rotateZ;if(c){var u=nd();kd(u,-c);var h=Rd(u,l[0],l[1]),d=yd({x:0,y:0},h=od(this.matrix,h)),f=yd({x:this.width,y:this.height},h),p=t[2]-t[0],v=t[3]-t[1],y=a.transformOrigin.map((function(e,t){return ap(e,t?v:p)})),g=y[0],m=y[1],b=nd();(t[0]||t[1])&&hd(b,t[0],t[1]),kd(b,-c);var x=Rd(b,g,m),E=yd({x:0,y:0},x=od(this.matrix,x)),w=yd({x:p,y:v},x);this.adjustPosAndSizeSelf(E.x-d.x,E.y-d.y,w.x-f.x,w.y-f.y)}else this.adjustPosAndSizeSelf(r,n,i,o);this.adjustPoints(-r,-n),e||this.checkPosSizeUpward(),this.coords=void 0}},t.prototype.adjustPoints=function(e,t){var r=this.width,n=this.height;this.props.points.forEach((function(i){i.absX+=e,i.absY+=t,i.absFx+=e,i.absFy+=t,i.absTx+=e,i.absTy+=t,i.x=i.absX/r,i.y=i.absY/n,i.fx=i.absFx/r,i.fy=i.absFy/n,i.tx=i.absTx/r,i.ty=i.absTy/n}))},t.prototype.toSvg=function(t){return e.prototype.toSvg.call(this,t,this.props.isClosed)},t.prototype.clone=function(e){var r=Iu(this.props),n=r.uuid;r.uuid=a(),r.sourceUuid=this.props.uuid;var i=new t(r);return i.style=Iu(this.style),i.computedStyle=Iu(this.computedStyle),e&&e.hasOwnProperty(n)&&e[n].forEach((function(e){var t=e.key,n=e.value;if("fill"===t[0]){var o=parseInt(t[1])||0;r.style.fill[o]=n,i.style.fill[o]={v:Zf(n),u:zu.RGBA}}})),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.POLYLINE,t},t.prototype.toSketchJson=function(t){return Z(this,void 0,void 0,(function(){var r;return J(this,(function(n){switch(n.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=n.sent())._class=Q.ClassValue.ShapePath,r.isClosed=this.props.isClosed,r.points=this.props.points.map((function(e){return{_class:"curvePoint",cornerRadius:e.cornerRadius,cornerStyle:[Q.CornerStyle.Rounded,Q.CornerStyle.RoundedInverted,Q.CornerStyle.Angled,Q.CornerStyle.Squared][e.cornerStyle||0],curveMode:[Q.CurveMode.None,Q.CurveMode.Straight,Q.CurveMode.Mirrored,Q.CurveMode.Asymmetric,Q.CurveMode.Disconnected][e.curveMode||0],hasCurveFrom:e.hasCurveFrom,hasCurveTo:e.hasCurveTo,curveFrom:"{"+e.fx+", "+e.fy+"}",curveTo:"{"+e.tx+", "+e.ty+"}",point:"{"+e.x+", "+e.y+"}"}})),[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this),t&&this.loaders.forEach((function(e){e.loading&&(t.imgLoadingCount--,e.loading=!1)}))}},Object.defineProperty(t,"EPS",{get:function(){return Zw},enumerable:!1,configurable:!0}),t}(zw),$w=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.toString=function(){return this.x+","+this.y},e.prototype.equal=function(e){return this===e||this.x===e.x&&this.y===e.y},e.prototype.equalEps=function(e,t){return void 0===t&&(t=.01),this===e||Math.abs(100*this.x-100*e.x)<=100*t&&Math.abs(100*this.y-100*e.y)<=100*t},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.minus=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.compare=function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y},e.toPoint=function(e){return{x:e[0],y:e[1]}},e.toPoints=function(t){return t.map((function(t){return e.toPoint(t)}))},e}(),Qw=.1;function eS(e){e.sort((function(e,t){return e.x===t.x?e.y-t.y:e.x-t.x}));for(var t=e.length-1;t>=1;t--){var r=e[t],n=e[t-1];r.x=Math.round(r.x),r.y=Math.round(r.y),n.x=Math.round(n.x),n.y=Math.round(n.y),r.x===n.x&&r.y===n.y&&e.splice(t,1)}return e.filter((function(e){return!!(0!==e.t1&&1!==e.t1||0!==e.t2&&1!==e.t2)})).map((function(e){return{point:new $w(Math.round(e.x),Math.round(e.y)),toSource:e.t1,toClip:e.t2}}))}var tS=function(e,t,r,n,i,o,a,s){var l=kf.intersectLineLine(e,t,r,n,i,o,a,s,!0);if(l)return[{point:new $w(Math.round(l.x),Math.round(l.y)),toSource:l.toSource,toClip:l.toClip}]},rS=function(e,t,r,n,i,o,a,s,l,c){var u=kf.intersectBezier2Line(e,t,r,n,i,o,a,s,l,c,Qw,1,!0);if(u.length)return eS(u)},nS=function(e,t,r,n,i,o,a,s,l,c,u,h){var d=kf.intersectBezier2Bezier2(e,t,r,n,i,o,a,s,l,c,u,h,Qw,1,!0);if(d.length)return eS(d)},iS=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f){var p=kf.intersectBezier2Bezier3(e,t,r,n,i,o,a,s,l,c,u,h,d,f,Qw,1,!0);if(p.length)return eS(p)},oS=function(e,t,r,n,i,o,a,s,l,c,u,h){var d=kf.intersectBezier3Line(e,t,r,n,i,o,a,s,l,c,u,h,Qw,1,!0);if(d.length)return eS(d)},aS=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v){var y=kf.intersectBezier3Bezier3(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,Qw,1,!0);if(y.length)return eS(y)},sS=function(e,t){return e.sort((function(e,r){return t?e.toSource-r.toSource:e.toClip-r.toClip})).map((function(e){return{point:e.point,t:t?e.toSource:e.toClip}}))},lS=0,cS=function(){function e(e,t){this.uuid=lS++;var r=e[0];if(e.length>2){for(var n=!0,i=!0,o=1,a=e.length;o<a;o++){var s=e[o];if(s.x!==r.x&&(n=!1),s.y!==r.y&&(i=!1),!n&&!i)break}if(n||i)e.splice(1,e.length-2);else{var l=((f=e[e.length-1]).y-r.y)/(f.x-r.x),c=!0;for(o=1;o<e.length-1;o++){var u=e[o],h=(u.y-r.y)/(u.x-r.x);if(isNaN(l)||isNaN(h)){if(l!==h){c=!1;break}}else if(l===1/0||l===-1/0){if(l!==h){c=!1;break}}else if(Math.abs(h-l)>1e-9){c=!1;break}}c&&e.splice(1,e.length-2)}}if(e.length>2&&e[1].x===r.x&&e[1].y===r.y&&e.splice(1,1),e.length>2){var d=e.length,f=e[d-1];e[d-2].x===f.x&&e[d-2].y===f.y&&e.splice(d-2,1)}this.coords=e,this.belong=t,this.bbox=this.calBbox(),this.myFill=[!1,!1],this.otherFill=[!1,!1],this.myCoincide=0,this.otherCoincide=0,this.isVisited=!1,this.isDeleted=!1}return e.prototype.calBbox=function(){var e=this.coords,t=e.length,r=e[0],n=e[t-1];return[Math.min(r.x,n.x),Math.min(r.y,n.y),Math.max(r.x,n.x),Math.max(r.y,n.y)]},e.prototype.reverse=function(){this.coords.reverse()},e.prototype.equal=function(e){var t=this.coords,r=e.coords;if(t.length!==r.length)return!1;for(var n=0,i=t.length;n<i;n++)if(!t[n].equal(r[n]))return!1;return!0},e.prototype.toHash=function(){return this.coords.map((function(e){return e.toString()})).join(" ")},e.prototype.toString=function(){return this.uuid+" "+this.belong+" "+this.myCoincide+this.otherCoincide+" "+(this.isVisited?"v":"n")+(this.isDeleted?"d":"n")+" "+this.myFill.map((function(e){return e?1:0})).join("")+this.otherFill.map((function(e){return e?1:0})).join("")+" "+this.toHash()},e}(),uS=tS,hS=rS,dS=nS,fS=iS,pS=oS,vS=aS,yS=sS,gS=function(){function e(e,t){this.index=t;var r=this.segments=[];Array.isArray(e)&&e.forEach((function(e){if(Array.isArray(e)&&!(e.length<2)&&!(2===e.length&&e[1].length<=2)){for(var n,i=new $w(e[0][0],e[0][1]),o=i,a=function(o,a){var s=e[o],l=s.length,c=new $w(s[l-2],s[l-1]),u=void 0;if(2===l){if(i.equal(c))return n=o,"continue";var h=$w.compare(i,c)?[c,i]:[i,c];u=new cS(h,t),r.push(u)}else if(4===l){if(i.equal(c)&&i.x===s[0]&&i.y===s[1])return n=o,"continue";var d=new $w(s[0],s[1]),f=yf.getBezierMonotonicityT([i,d,c],!0)||[];if(null==(x=yf.getBezierMonotonicityT([i,d,c],!1))||x.forEach((function(e){f.includes(e)||f.push(e)})),f.length){var p=[[i.x,i.y],[s[0],s[1]],[c.x,c.y]],v=yf.sliceBezier($w.toPoints(p),0,f[0]).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),y=yf.sliceBezier($w.toPoints(p),f[0],1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),g=new $w(v[1].x,v[1].y),m=new $w(v[2].x,v[2].y),b=new $w(y[1].x,y[1].y);h=$w.compare(i,m)?[m,g,i]:[i,g,m];i.equal(m)||r.push(new cS(h,t)),h=$w.compare(m,c)?[c,b,m]:[m,b,c],c.equal(m)||r.push(new cS(h,t))}else{h=$w.compare(i,c)?[c,d,i]:[i,d,c];r.push(new cS(h,t))}}else if(6===l){if(s[0]===s[2]&&s[1]===s[3])return s.splice(2,2),o--,n=o,"continue";if(i.equal(c)&&i.x===s[0]&&i.y===s[1]&&i.x===s[2]&&i.y===s[3])return n=o,"continue";var x,E=new $w(s[0],s[1]),w=new $w(s[2],s[3]),S=yf.getBezierMonotonicityT([i,E,w,c],!0)||[];if(null==(x=yf.getBezierMonotonicityT([i,E,w,c],!1))||x.forEach((function(e){S.includes(e)||S.push(e)})),S.length){var _=[[i.x,i.y],[s[0],s[1]],[s[2],s[3]],[c.x,c.y]],C=i,A=0;S.forEach((function(e){var n=yf.sliceBezier($w.toPoints(_),A,e).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),i=new $w(n[1].x,n[1].y),o=new $w(n[2].x,n[2].y),a=new $w(n[3].x,n[3].y),s=$w.compare(C,a)?[a,o,i,C]:[C,i,o,a];C.equal(a)||r.push(new cS(s,t)),A=e,C=a}));var T=yf.sliceBezier($w.toPoints(_),A,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));g=new $w(T[1].x,T[1].y),m=new $w(T[2].x,T[2].y),h=$w.compare(C,c)?[c,m,g,C]:[C,g,m,c];C.equal(c)||r.push(new cS(h,t))}else{h=$w.compare(i,c)?[c,w,E,i]:[i,E,w,c];r.push(new cS(h,t))}}i=c,n=o},s=1,l=e.length;s<l;s++)a(s),s=n;if(!i.equal(o)){var c=$w.compare(i,o)?[o,i]:[i,o];r.push(new cS(c,t))}}}))}return e.prototype.selfIntersect=function(){var e=ES(this.segments);this.segments=mS(e,!1,!1,!1)},e.prototype.toString=function(){return this.segments.map((function(e){return e.toString()}))},e.prototype.reset=function(e){return this.index=e,this.segments.forEach((function(t){t.belong=e,t.otherCoincide=0,t.otherFill[0]=t.otherFill[1]=!1})),this},e.intersect2=function(e,t,r,n){if(e.segments.length&&t.segments.length){var i=mS(ES(e.segments.concat(t.segments)),!0,r,n);e.segments=i.filter((function(e){return 0===e.belong})),t.segments=i.filter((function(e){return 1===e.belong}))}},e.annotate2=function(e,t,r,n){var i=function(e){var t={};e.forEach((function(e){var r=e.coords,n=r.length,i=r[0],o=r[n-1];SS(t,i.x,i.y,e,!0),SS(t,o.x,o.y,e,!1)}));var r=[];Object.keys(t).forEach((function(e){var n=t[e],i=[];Object.keys(n).forEach((function(e){var t=n[e].sort((function(e,t){return e.isStart!==t.isStart?e.isStart?1:-1:e.isStart?CS(e.seg,t.seg)?1:-1:0}));i.push({y:parseFloat(e),arr:t})})),r.push({x:parseFloat(e),arr:i.sort((function(e,t){return e.y-t.y}))})})),r.sort((function(e,t){return e.x-t.x}));var n=[];return r.forEach((function(e){e.arr.forEach((function(e){n=n.concat(e.arr)}))})),n}(e.segments.concat(t.segments)),o=[],a=[],s={},l={};i.forEach((function(e){var t=e.isStart,i=e.seg,c=i.belong;if(!(0===c&&r||1===c&&n)){var u=0===c?o:a,h=0===c?s:l;if(t){if(i.myCoincide){var d=i.toHash();if(h.hasOwnProperty(d))return;h[d]=!0}if(u.length){var f=u.length,p=u[f-1];if(CS(i,p))i.myFill[1]=p.myFill[0],i.myCoincide?i.myFill[0]=i.myCoincide%2==0?!i.myFill[1]:i.myFill[1]:i.myFill[0]=!i.myFill[1],u.push(i);else if(1===f)i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,u.unshift(i);else for(var v=f-2;v>=0;v--){var y=u[v];if(CS(i,y)){i.myFill[1]=y.myFill[0],i.myCoincide?i.myFill[0]=i.myCoincide%2==0?!i.myFill[1]:i.myFill[1]:i.myFill[0]=!i.myFill[1],u.splice(v+1,0,i);break}0===v&&(i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,u.unshift(i))}}else i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,u.push(i)}else{(v=u.indexOf(i))>-1&&u.splice(v,1)}}}));var c=[],u={};i.forEach((function(e){var t=e.isStart,r=e.seg,n=r.belong;if(t){if(r.myCoincide||r.otherCoincide){var i=r.toHash();if(u.hasOwnProperty(i))return;u[i]=!0}var o=!1;if(c.length){var a=c.length,s=c[a-1];if(CS(r,s))o=s.belong===n?s.otherFill[0]:s.myFill[0],c.push(r);else if(1===a)c.unshift(r);else for(var l=a-2;l>=0;l--){var h=c[l];if(CS(r,h)){o=h.belong===n?h.otherFill[0]:h.myFill[0],c.splice(l+1,0,r);break}0===l&&c.unshift(r)}}else o=!1,c.push(r);r.otherCoincide||(r.otherFill[0]=o,r.otherFill[1]=o)}else{(l=c.indexOf(r))>-1&&c.splice(l,1)}}))},e}();function mS(e,t,r,n){for(var i=[],o=[],a=[];e.length;){o.length&&o.splice(0).forEach((function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1),e.isDeleted||a.push(e)}));for(var s=e.shift(),l=s.x,c=s.arr;c.length;){var u=c.shift();if(!u.isDeleted){var h=u.belong,d=u.bbox;if(u.isVisited){if(d[0]!==d[2]||2!==u.coords.length)(E=i.indexOf(u))>-1&&i.splice(E,1),u.isDeleted||a.push(u);else o.push(u);u.isVisited=!1}else{if(i.length)for(var f=u.coords,p=f.length,v=f[0],y=v.x,g=v.y,m=f[1],b=m.x,x=m.y,E=0;E<i.length;E++){var w=i[E];if(!w.isDeleted&&!u.isDeleted&&(!t||w.belong!==h)){var S=w.bbox,_=w.coords,C=_.length,A=!1;if(TS(d,S,p,C)){if(p===C&&u.equal(w)){t?(u.otherCoincide++,w.otherCoincide++,u.otherFill=w.myFill,w.otherFill=u.myFill):(u.myCoincide++,w.myCoincide++,u.myFill=w.myFill);continue}var T=_[0],O=T.x,M=T.y,k=_[1],L=k.x,R=k.y,I=void 0,P=void 0;if(2===p)if(2===C){if(0===(R-M)*(b-y)-(L-O)*(x-g))if(y===b)y===O&&b===L&&(P=OS(y,g,b,x,u,O,M,L,R,w,!0));else{var F=0,D=0;x!==g&&(F=(b-y)/(x-g)),R!==M&&(D=(L-O)/(R-M)),g-F*y===M-D*O&&(P=OS(y,g,b,x,u,O,M,L,R,w,!1))}else I=uS(y,g,b,x,O,M,L,R)}else{var N=_[2],B=N.x,U=N.y;if(3===C)I=hS(O,M,L,R,B,U,y,g,b,x),A=!0;else{var z=_[3],G=z.x,X=z.y;I=pS(O,M,L,R,B,U,G,X,y,g,b,x),A=!0}}else{var H=f[2],j=H.x,W=H.y;if(3===p)if(2===C)I=hS(y,g,b,x,j,W,O,M,L,R);else{var Y=_[2];B=Y.x,U=Y.y;if(3===C)(P=MS(u,w))||(I=dS(y,g,b,x,j,W,O,M,L,R,B,U));else{var q=_[3];G=q.x,X=q.y;I=fS(y,g,b,x,j,W,O,M,L,R,B,U,G,X)}}else{var V=f[3],K=V.x,Z=V.y;if(2===C)I=pS(y,g,b,x,j,W,K,Z,O,M,L,R);else{var J=_[2];B=J.x,U=J.y;if(3===C)I=fS(O,M,L,R,B,U,y,g,b,x,j,W,K,Z),A=!0;else if(!(P=MS(u,w))){var $=_[3];G=$.x,X=$.y;I=vS(y,g,b,x,j,W,K,Z,O,M,L,R,B,U,G,X)}}}}if(P){u.isDeleted=w.isDeleted=!0,xS(a,e,i,l,P.ra),xS(a,e,i,l,P.rb),i.splice(E,1);break}if(I&&I.length){for(var Q=I.length-1;Q>=0;Q--){var ee=I[Q];ee.point.equal(f[0])?ee.point.equal(_[0])||ee.point.equal(_[C-1])?I.splice(Q,1):ee.point=f[0]:ee.point.equal(f[p-1])?ee.point.equal(_[0])||ee.point.equal(_[C-1])?I.splice(Q,1):ee.point=f[p-1]:ee.point.equal(_[0])?ee.point=_[0]:ee.point.equal(_[C-1])&&(ee.point=_[C-1])}if(I.length){var te=yS(I,!A),re=yS(I,A),ne=bS(u,te,r&&0===h),ie=bS(w,re,n&&1===h);if(ne.length&&xS(a,e,i,l,ne),ie.length&&(xS(a,e,i,l,ie),i.splice(E--,1)),ne.length)break}}}}}u.isDeleted||(i.push(u),u.isVisited=!0)}}}}return o.forEach((function(e){e.isDeleted||-1!==a.indexOf(e)||a.push(e)})),i.forEach((function(e){e.isDeleted||-1!==a.indexOf(e)||a.push(e)})),a.filter((function(e){return!e.isDeleted}))}function bS(e,t,r){var n=[];if(!t.length)return n;var i,o=e.belong,a=e.coords,s=a.length,l=a[0],c=0;if(t.forEach((function(t){var i=t.point,u=t.t;if(!i.equal(l)){var h;if(2===s)h=$w.compare(l,i)?new cS([i,l],o):new cS([l,i],o);else if(3===s){var d=yf.sliceBezier(a,c,u).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));h=$w.compare(l,i)?new cS([i,new $w(d[1].x,d[1].y),l],o):new cS([l,new $w(d[1].x,d[1].y),i],o)}else if(4===s){d=yf.sliceBezier(a,c,u).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));h=$w.compare(l,i)?new cS([i,new $w(d[2].x,d[2].y),new $w(d[1].x,d[1].y),l],o):new cS([l,new $w(d[1].x,d[1].y),new $w(d[2].x,d[2].y),i],o)}r&&(h.myFill[0]=e.myFill[0],h.myFill[1]=e.myFill[1]),l=i,n.push(h),c=u}})),!l.equal(a[a.length-1])){if(2===s)i=$w.compare(l,a[1])?new cS([a[1],l],o):new cS([l,a[1]],o);else if(3===s){var u=yf.sliceBezier(a,c,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));i=$w.compare(l,a[2])?new cS([a[2],new $w(u[1].x,u[1].y),l],o):new cS([l,new $w(u[1].x,u[1].y),a[2]],o)}else if(4===s){u=yf.sliceBezier(a,c,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));i=$w.compare(l,a[3])?new cS([a[3],new $w(u[2].x,u[2].y),new $w(u[1].x,u[1].y),l],o):new cS([l,new $w(u[1].x,u[1].y),new $w(u[2].x,u[2].y),a[3]],o)}r&&(i.myFill[0]=e.myFill[0],i.myFill[1]=e.myFill[1]),n.push(i)}return n.length>1?(e.isDeleted=!0,n):[]}function xS(e,t,r,n,i){i.forEach((function(i){var o,a=i.coords,s=a[0],l=a[a.length-1],c=s.x,u=l.x;if(c>u&&(c=(o=[u,c])[0],u=o[1]),u<=n&&c!==u)e.push(i);else{if(c===u)for(var h=r.length-1;h>=0;h--){var d=r[h];if(i.equal(d)&&!d.isDeleted)return void(i.belong===d.belong?d.myCoincide++:d.otherCoincide++)}var f=0;if(c<n)i.isVisited=!0,r.push(i);else if(t.length)for(var p=t.length;f<p;f++){if(c===(y=(d=t[f]).x)){d.arr.push(i),c===u&&c===n&&r.push(i);break}if(c<y){var v={x:c,arr:[i]};c===u&&c===n&&r.push(i),t.splice(f,0,v);break}}else r.push(i);for(p=t.length;f<p;f++){var y;if(u===(y=(d=t[f]).x)){d.arr.unshift(i);break}if(u<y){v={x:u,arr:[i]};t.splice(f,0,v);break}}}}))}function ES(e){var t={};e.forEach((function(e){var r,n=e.coords,i=n[0],o=n[n.length-1],a=i.x,s=o.x;a>s&&(a=(r=[s,a])[0],s=r[1]),wS(t,a,e),wS(t,s,e)}));var r=[];return Object.keys(t).forEach((function(e){return r.push({x:parseFloat(e),arr:t[e]})})),r.sort((function(e,t){return e.x-t.x}))}function wS(e,t,r){var n=e[t]=e[t]||[];r.isVisited?(n.unshift(r),r.isVisited=!1):(n.push(r),r.isVisited=!0)}function SS(e,t,r,n,i){var o=e[t]=e[t]||{};(o[r]=o[r]||[]).push({isStart:i,seg:n})}function _S(e,t,r){var n=e.x,i=e.y,o=t.x,a=t.y,s=r.x,l=r.y;return rd.crossProduct(o-n,a-i,s-n,l-i)>=0}function CS(e,t){var r=e.coords,n=t.coords,i=r.length,o=n.length,a=r[0],s=n[0];if(2===i&&2===o){var l=r[1],c=n[1];return a.equal(s)?_S(l,s,c):_S(a,s,c)}if(2===i&&a.x===r[1].x){if(a.equal(s))return!0;if(r[i-1].equal(s))return!0;if(r[i-1].equal(n[o-1]))return!1}if(2===o&&s.x===n[1].x&&a.equal(s))return!1;var u=Math.max(a.x,s.x),h=Math.min(r[i-1].x,n[o-1].x),d=u+.5*(h-u);if(!a.equal(s)){var f=AS(r,u),p=AS(n,u);if(f!==p)return f>p}var v=AS(r,d),y=AS(n,d);if(v!==y)return v>y;if(!r[i-1].equal(n[o-1])){var g=AS(r,h),m=AS(n,h);if(g!==m)return g>m}return!1}function AS(e,t){var r=e.length;if(t===e[0].x)return e[0].y;if(t===e[r-1].x)return e[r-1].y;if(2===r){if(e[0].y===e[1].y)return e[0].y;var n=(t-e[0].x)/(e[1].x-e[0].x);return e[0].y+n*(e[1].y-e[0].y)}if(3===r){var i=Xd.getRoots([e[0].x-t,2*(e[1].x-e[0].x),e[2].x+e[0].x-2*e[1].x]).filter((function(e){return e>=0&&e<=1}));return yf.getPointByT(e,i[0]).y}if(4===r){i=Xd.getRoots([e[0].x-t,3*(e[1].x-e[0].x),3*(e[2].x+e[0].x-2*e[1].x),e[3].x+3*e[1].x-e[0].x-3*e[2].x]).filter((function(e){return e>=0&&e<=1}));return yf.getPointByT(e,i[0]).y}}function TS(e,t,r,n){if(2===r&&2===n){if(e[0]===e[2]&&t[0]===t[2]&&e[0]===e[2])return!(e[1]>=t[3]||t[1]>=e[3]);if(e[1]===e[3]&&t[1]===t[3]&&e[1]===e[3])return!(e[0]>=t[2]||t[0]>=e[2])}return Od.isRectsOverlap(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3],!0)}function OS(e,t,r,n,i,o,a,s,l,c,u){var h=[],d=[],f=i.coords,p=c.coords;return e<o&&!u||t<a&&u?(h.push(new cS([f[0],p[0]],i.belong)),r<s&&!u||n<l&&u?(h.push(new cS([p[0],f[1]],i.belong)),d.push(new cS([p[0],f[1]],c.belong)),d.push(new cS([f[1],p[1]],c.belong))):r===s&&!u||n===l&&u?(h.push(new cS([p[0],p[1]],i.belong)),d.push(new cS([p[0],p[1]],c.belong))):(h.push(new cS([p[0],p[1]],i.belong)),d.push(new cS([p[0],p[1]],c.belong)),h.push(new cS([p[1],f[1]],i.belong)))):e===o&&!u||t===a&&u?r<s&&!u||n<l&&u?(h.push(new cS([f[0],f[1]],i.belong)),d.push(new cS([f[0],f[1]],c.belong)),d.push(new cS([f[1],p[1]],c.belong))):(h.push(new cS([p[0],p[1]],i.belong)),h.push(new cS([p[1],f[1]],i.belong)),d.push(new cS([p[0],p[1]],c.belong))):(d.push(new cS([p[0],f[0]],c.belong)),r<s&&!u||n<l&&u?(h.push(new cS([f[0],f[1]],i.belong)),d.push(new cS([f[0],f[1]],c.belong)),d.push(new cS([f[1],p[1]],c.belong))):r===s&&!u||n===l&&u?(h.push(new cS([f[0],f[1]],i.belong)),d.push(new cS([f[0],f[1]],c.belong))):(h.push(new cS([f[0],p[1]],i.belong)),d.push(new cS([f[0],p[1]],c.belong)),h.push(new cS([p[1],f[1]],i.belong)))),{ra:h,rb:d}}function MS(e,t){var r=e.coords,n=r.length,i=t.coords,o=i.length,a=r[0],s=i[0],l=r[n-1],c=i[o-1],u=yf.getPointT(r,s.x,s.y),h=yf.getPointT(r,c.x,c.y),d=yf.getPointT(i,a.x,a.y),f=yf.getPointT(i,l.x,l.y),p=u.length,v=h.length,y=d.length,g=f.length;if(1===p&&1===v&&0===y&&0===g||0===p&&0===v&&1===y&&1===g||(1===p&&1===v&&y+g===1||p+v===1&&1===y&&1===g)||p+v===1&&y+g===1){var m=p?u[0]:0,b=v?h[0]:1,x=yf.sliceBezier(r,m,b),E=y?d[0]:0,w=g?f[0]:1;if(function(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r],o=t[r];if(Math.abs(i.x-o.x)>1e-9||Math.abs(i.y-o.y)>1e-9)return!1}return!0}(x,yf.sliceBezier(i,E,w))){var S=x.map((function(e){return new $w(e.x,e.y)})),_=[],C=[];if(m>0){var A=yf.sliceBezier(r,0,m),T=[e.coords[0],new $w(A[1].x,A[1].y),t.coords[0]];4===n&&T.splice(2,0,new $w(A[2].x,A[2].y)),_.push(new cS(T,e.belong))}if(_.push(new cS(S,e.belong)),b<1){A=yf.sliceBezier(r,b,1),T=[t.coords[o-1],new $w(A[1].x,A[1].y),e.coords[n-1]];4===n&&T.splice(2,0,new $w(A[2].x,A[2].y)),_.push(new cS(T,e.belong))}if(E>0){A=yf.sliceBezier(i,0,E),T=[t.coords[0],new $w(A[1].x,A[1].y),e.coords[0]];4===o&&T.splice(2,0,new $w(A[2].x,A[2].y)),C.push(new cS(T,t.belong))}if(C.push(new cS(S,t.belong)),w<1){A=yf.sliceBezier(i,w,1),T=[e.coords[n-1],new $w(A[1].x,A[1].y),t.coords[o-1]];4===o&&T.splice(2,0,new $w(A[2].x,A[2].y)),C.push(new cS(T,t.belong))}return{ra:_,rb:C}}}}function kS(e,t,r,n,i,o){for(var a=0,s=t.length;a<s;a++){var l=t[a];if(l!==r){var c=l.length,u=l[0],h=l[c-1],d=u.coords[0],f=h.coords,p=f[f.length-1];if(i.equal(d))return o?(l=RS(r).concat(l),t[a]=l,t.splice(n,1),LS(e,t,l,a)):(l=r.concat(l),t[a]=l,t.splice(n,1),LS(e,t,l,a));if(i.equal(p))return o?(l=l.concat(r),t[a]=l,t.splice(n,1),LS(e,t,l,a)):(l=l.concat(RS(r)),t[a]=l,t.splice(n,1),LS(e,t,l,a))}}LS(e,t,r,n)}function LS(e,t,r,n){var i=r.length,o=r[0],a=r[i-1],s=o.coords[0],l=a.coords,c=l[l.length-1];s.equal(c)&&(t.splice(n,1),e.push(r))}function RS(e){return e.forEach((function(e){return e.reverse()})),e.reverse()}function IS(e){var t=[],r=[];e.sort((function(e,t){return t.otherFill[0]&&t.otherFill[1]?1:-1}));e:for(;e.length;){for(var n=e.shift(),i=n.coords,o=i.length,a=i[0],s=i[o-1],l=void 0,c=0,u=t.length;c<u;c++){var h=t[c],d=h.length,f=h[0],p=h[d-1],v=f.coords[0],y=p.coords,g=y[y.length-1];if(a.equal(g)){if(n.belong!==p.belong){h.push(n),kS(r,t,h,c,s,!1);continue e}l||(l={i:c,t:0})}else if(a.equal(v)){if(n.belong!==p.belong){n.reverse(),h.unshift(n),kS(r,t,h,c,s,!0);continue e}l||(l={i:c,t:1})}else if(s.equal(g)){if(n.belong!==p.belong){n.reverse(),h.push(n),kS(r,t,h,c,a,!1);continue e}l||(l={i:c,t:2})}else if(s.equal(v)){if(n.belong!==p.belong){h.unshift(n),kS(r,t,h,c,a,!0);continue e}l||(l={i:c,t:3})}}l?0===l.t?(t[l.i].push(n),kS(r,t,t[l.i],l.i,s,!1)):1===l.t?(n.reverse(),t[l.i].unshift(n),kS(r,t,t[l.i],l.i,s,!0)):2===l.t?(n.reverse(),t[l.i].push(n),kS(r,t,t[l.i],l.i,a,!1)):3===l.t&&(t[l.i].unshift(n),kS(r,t,t[l.i],l.i,a,!0)):t.push([n])}var m=r.map((function(e){var t=!0,r=0,n=0,i=0,o=0,a=0,s=0,l=0;e.forEach((function(e,t){var c=e.coords,u=c.length,h=e.bbox;t?(o=Math.min(o,h[0]),a=Math.min(a,h[1]),s=Math.max(s,h[2]),l=Math.max(l,h[3])):(o=h[0],a=h[1],s=h[2],l=h[3]),2===u?(r+=t?n*c[1].y-i*c[1].x:c[0].x*c[1].y-c[0].y*c[1].x,n=c[1].x,i=c[1].y):3===u?(r+=t?n*c[2].y-i*c[2].x:c[0].x*c[1].y-c[0].y*c[2].x,n=c[2].x,i=c[2].y):4===u&&(r+=t?n*c[3].y-i*c[3].x:c[0].x*c[3].y-c[0].y*c[3].x,n=c[3].x,i=c[3].y)}));var c=e[0].coords;return(r+=n*c[0].y-i*c[0].x)<0&&(t=!1),{checked:!1,list:e,clockwise:t,bbox:[o,a,s,l],area:(s-o)*(l-a)}}));return m.forEach((function(e){if(!e.checked){for(var t=e.bbox,r=[e],n=0,i=m.length;n<i;n++){if((c=m[n])!==e){var o=c.bbox;(Od.isRectsInside(t[0],t[1],t[2],t[3],o[0],o[1],o[2],o[3],!0)||Od.isRectsInside(o[0],o[1],o[2],o[3],t[0],t[1],t[2],t[3],!0))&&r.push(c)}}if(r.length>1){r.sort((function(e,t){return e.area-t.area}));for(n=1,i=r.length;n<i;n++){var a=r[n];if(a.checked){for(var s=a.clockwise,l=n-1;l>=0;l--){(c=r[l]).checked=!0,c.clockwise===s&&(RS(c.list),c.clockwise=!s),s=!s}s=a.clockwise;for(l=n+1;l<i;l++){var c;(c=r[l]).checked=!0,c.clockwise===s&&(RS(c.list),c.clockwise=!s),s=!s}return}}var u=r[0].clockwise;r[0].checked=!0;for(n=1,i=r.length;n<i;n++){var h=r[n];h.checked=!0,h.clockwise===u&&(RS(h.list),h.clockwise=!u),u=!u}}}})),m.map((function(e){var t=e.list.map((function(e){var t=e.coords,r=t.length;return 3===r?[t[1].x,t[1].y,t[2].x,t[2].y]:4===r?[t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y]:[t[1].x,t[1].y]})),r=e.list[0].coords;return t.unshift([r[0].x,r[0].y]),t}))}function PS(e){return e&&Array.isArray(e)&&Array.isArray(e[0])?Array.isArray(e[0][0])?e:[e]:[]}function FS(e,t){var r,n,i=e instanceof gS,o=t instanceof gS;return i?r=e.reset(0):(r=new gS(PS(e),0)).selfIntersect(),o?n=t.reset(1):(n=new gS(PS(t),1)).selfIntersect(),gS.intersect2(r,n,i,o),gS.annotate2(r,n,i,o),[r,n]}var DS=[0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0],NS=[0,1,1,1,1,0,0,0,1,0,0,0,1,0,0,0],BS=[0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0],US=[0,1,0,0,1,0,1,1,0,1,0,0,0,1,0,0],zS=[0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0];function GS(e,t){var r=[],n={};return e.forEach((function(e){var i,o=e.belong,a=e.myFill,s=e.otherFill;if(e.otherCoincide){var l=e.toHash();if(n.hasOwnProperty(l))return;n[l]=!0}i=o?(s[0]?8:0)+(a[0]?4:0)+(s[1]?2:0)+(a[1]?1:0):(a[0]?8:0)+(s[0]?4:0)+(a[1]?2:0)+(s[1]?1:0),t[i]&&r.push(e)})),r}var XS,HS={intersect:function(e,t,r){void 0===r&&(r=!1);var n=FS(e,t),i=n[0],o=n[1],a=GS(i.segments.concat(o.segments),DS);return r?(i.segments=a,i):IS(a)},union:function(e,t,r){void 0===r&&(r=!1);var n=FS(e,t),i=n[0],o=n[1],a=GS(i.segments.concat(o.segments),NS);return r?(i.segments=a,i):IS(a)},subtract:function(e,t,r){void 0===r&&(r=!1);var n=FS(e,t),i=n[0],o=n[1],a=GS(i.segments.concat(o.segments),BS);return a.length,r?(i.segments=a,i):IS(a)},subtractRev:function(e,t,r){void 0===r&&(r=!1);var n=FS(e,t),i=n[0],o=n[1],a=GS(i.segments.concat(o.segments),US);return r?(i.segments=a,i):IS(a)},xor:function(e,t,r){void 0===r&&(r=!1);var n=FS(e,t),i=n[0],o=n[1],a=GS(i.segments.concat(o.segments),zS);return r?(i.segments=a,i):IS(a)},chains:IS},jS=1e-4,WS=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isGroup=!0,n.fixedPosAndSize=!1,n}return p(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this),this.adjustPosAndSize()},t.prototype.adjustPosAndSizeChild=function(e,t,r,n,i,o,a){var s=e.style,l=e.computedStyle,c=e.root;if(c){var u=s.top,h=s.right,d=s.bottom,f=s.left;(t||n)&&(l.left-=t,f.u===zu.PX?f.v=l.left:f.u===zu.PERCENT&&o&&(f.v=100*l.left/o),l.right+=n,h.u===zu.PX?h.v=l.right:h.u===zu.PERCENT&&o&&(h.v=100*l.right/o)),(r||i)&&(l.top-=r,u.u===zu.PX?u.v=l.top:u.u===zu.PERCENT&&a&&(u.v=100*l.top/a),l.bottom+=i,d.u===zu.PX?d.v=l.bottom:d.u===zu.PERCENT&&a&&(d.v=100*l.bottom/a)),e.refreshLevel|=XE.TRANSFORM,c.rl|=XE.TRANSFORM,e.calMatrix(XE.TRANSFORM),e._rect=void 0,e._bbox=void 0,e._bbox2=void 0,e._filterBbox=void 0,e._filterBbox2=void 0,e.tempBbox=void 0}},t.prototype.adjustPosAndSize=function(e){if(this.fixedPosAndSize)return!1;var t=this.children;e||(e=this.getChildrenRect());var r=this.width,n=this.height,i=e.minX,o=e.minY,a=e.maxX-r,s=e.maxY-n;if(Math.abs(i)>jS||Math.abs(o)>jS||Math.abs(a)>jS||Math.abs(s)>jS){this.adjustPosAndSizeSelf(i,o,a,s),r=this.width,n=this.height;for(var l=0,c=t.length;l<c;l++){var u=t[l];this.adjustPosAndSizeChild(u,i,o,a,s,r,n)}return!0}return!1},t.prototype.checkPosSizeSelf=function(){this.adjustPosAndSize()&&this.checkPosSizeUpward()},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.GROUP,t},t.prototype.toSketchJson=function(t,r){return Z(this,void 0,void 0,(function(){var n,i;return J(this,(function(o){switch(o.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(n=o.sent())._class=Q.ClassValue.Group,n.hasClickThrough=!1,[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t)})))];case 2:return i=o.sent(),n.layers=i.map((function(e){return e})),[2,n]}}))}))},Object.defineProperty(t,"EPS",{get:function(){return jS},enumerable:!1,configurable:!0}),t}(Mw);var YS=function(){function e(){this.rootTask=[],this.roots=[],this.task=[],this.now=dh.now(),this.id=0}return e.prototype.init=function(){var e=this,t=this.task;dh.cancelAnimationFrame(this.id);var r=this.now=dh.now(),n=function(){dh.cancelAnimationFrame(e.id),e.id=dh.requestAnimationFrame((function(){var i=e.now=dh.now();if(!XS&&t.length){var o=i-r;o=Math.max(o,0),r=i;var a=t.slice(0),s=a.length;!function(e,t,r){for(var n=0;n<t;n++){var i=e[n];i.before&&i.before(r)}}(a,s,o),function(e,t,r){for(var n=0;n<t;n++)e[n].after(r)}(a,s,o),t.length&&n()}}))};n()},e.prototype.onFrame=function(e){if(e){var t=this.task;t.length||this.init(),_u(e)&&(e={after:e,ref:e}),t.push(e)}},e.prototype.offFrame=function(e){if(e){for(var t=this.task,r=0,n=t.length;r<n;r++){var i=t[r];if(i===e||i.ref===e){t.splice(r,1);break}}t.length||(dh.cancelAnimationFrame(this.id),this.now=0)}},e.prototype.nextFrame=function(e){var t=this;if(e){var r=_u(e)?{after:function(n){e(n),t.offFrame(r)}}:{before:e.before,after:function(n){e.after&&e.after(n),t.offFrame(r)}};r.ref=e,this.onFrame(r)}},e.prototype.pause=function(){XS=!0},e.prototype.resume=function(){XS&&(this.init(),XS=!1)},e.prototype.addRoot=function(e){this.roots.push(e)},e.prototype.removeRoot=function(e){var t=this.roots.indexOf(e);t>-1&&this.roots.splice(t,1)},e}(),qS=new YS,VS={alpha:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,depth:!0,stencil:!0},KS="#define GLSLIFY 1\nattribute vec2 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=vec4(a_position,0,1);v_texCoords=a_texCoords;}",ZS="#define GLSLIFY 1\nattribute vec2 a_position;varying vec4 v_position;void main(){gl_Position=vec4(a_position,0,1);v_position=gl_Position;}",JS=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isSymbolMaster=!0,n.symbolInstances=[],n}return p(t,e),t.prototype.addSymbolInstance=function(e){-1===this.symbolInstances.indexOf(e)&&this.symbolInstances.push(e)},t.prototype.removeSymbolInstance=function(e){var t=this.symbolInstances.indexOf(e);t>-1&&this.symbolInstances.splice(t,1)},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.symbolInstances=[],n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.SYMBOL_MASTER,t},t}(kw),$S=function(){function e(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),this.x=0,this.y=e,this.w=0,this.h=t,this.index=r,this.list=[],this.startEnter=n,this.endEnter=i}return e.prototype.add=function(e){this.list.push(e),this.w+=e.w},e.prototype.verticalAlign=function(){for(var e=this.baseline,t=this.list,r=0,n=t.length;r<n;r++){var i=t[r],o=i.baseline;if(o!==e){var a=e-o;i.y+=a}}},e.prototype.offsetX=function(e){this.x+=e;for(var t=this.list,r=0,n=t.length;r<n;r++)t[r].x+=e},e.prototype.offsetY=function(e){this.y+=e;for(var t=this.list,r=0,n=t.length;r<n;r++)t[r].y+=e},Object.defineProperty(e.prototype,"size",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){for(var e=0,t=this.list,r=0,n=t.length;r<n;r++)e=Math.max(e,t[r].baseline);return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){var e=this.list;if(e.length){for(var t=0,r=0,n=e.length;r<n;r++)t=Math.max(t,e[r].lineHeight);return t}return this.h},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.ceil(this.w)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.ceil(this.lineHeight)},enumerable:!1,configurable:!0}),e}(),QS=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f){this.x=e,this.y=t,this.w=r,this.lineHeight=n,this.baseline=i,this.contentArea=o,this.index=a,this.str=s,this.font=l,this.fontFamily=c,this.fontSize=u,this.color=h,this.letterSpacing=d,this.textDecoration=f};function e_(e,t,r,n,i,o,a){var s=t,l=r,c=0,u=!1,h=Math.round(i/o);for(h<=0?h=1:h>r-t&&(h=r-t);s<l;){var d=e.measureText(n.slice(t,t+h)).width;if(d===i){c=i,u=!0;break}if(d>i+1e-10){if(u=!0,1===h){c=d;break}if(s===l-1||s-t==h-1){h=s-t;break}l=h+t-1;var f=Math.round((d-i)/o);f<=0&&(f=1),(h-=f)<s-t&&(h=s-t)}else{if(c=d,h===r-t)break;s=h+t;var p=Math.round((i-d)/o);p<=0&&(p=1),(h+=p)>l-t&&(h=l-t)}}for(var v=t,y=t+h;v<y;v++)if("\n"===n.charAt(v))return{hypotheticalNum:h=v-t,rw:c=e.measureText(n.slice(t,t+h)).width,newLine:u=!1};if(t+h<r&&/[\w.-]/.test(n.charAt(t+h-1)))for(var g=t+h-2;g>t;g--)if(!/[\w.-]/.test(n.charAt(g)))return{hypotheticalNum:h=g-t+1,rw:c=e.measureText(n.slice(t,t+h)).width,newLine:u=!0};return"\n"===n.charAt(t+h)&&(u=!1),{hypotheticalNum:h,rw:c,newLine:u}}var t_=function(e){function t(t){var r,n=e.call(this,t)||this;return n.isText=!0,n._content=t.content||"",n.rich=((null===(r=t.rich)||void 0===r?void 0:r.slice(0))||[]).map((function(e){return qf(e)})),n.lineBoxList=[],n.tempCursorX=0,n.currentCursorX=0,n.cursor={isMulti:!1,startLineBox:0,endLineBox:0,startTextBox:0,endTextBox:0,startString:0,endString:0,start:0,end:0},n.asyncRefresh=!1,n.loaders=[],n}return p(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this);var t=this.props.textBehaviour,r=this,n=r.style,i=r.computedStyle,o=r.width,a=r.height,s=r.lineBoxList;if(t===nh.AUTO||t===nh.FIXED_W){var l=!1;if(t===nh.AUTO&&n.width.u!==zu.AUTO){var c=0;s.forEach((function(e){c=Math.max(c,e.width)})),(u=c-o)&&(i.textAlign===Gu.LEFT?this.adjustPosAndSizeSelf(.5*u,0,0,0):i.textAlign===Gu.RIGHT&&this.adjustPosAndSizeSelf(.5*-u,0,0,0)),this.updateStyle({width:"auto"}),l=!0}if(this.style.height.u!==zu.AUTO){var u,h=s[s.length-1];(u=h?h.y+h.height-a:-a)&&(i.textVerticalAlign===Xu.TOP?this.adjustPosAndSizeSelf(0,.5*u,0,0):i.textVerticalAlign===Xu.BOTTOM&&this.adjustPosAndSizeSelf(0,.5*-u,0,0)),this.updateStyle({height:"auto"}),l=!0}l&&this.checkPosSizeUpward()}},t.prototype.lay=function(t){var r=this;e.prototype.lay.call(this,t);var n,i,o,a,s,l,c,u,h,d=this,f=d.rich,p=d.style,v=d.computedStyle,y=d._content,g=d.lineBoxList,m=p.left,b=p.right,x=p.top,E=p.bottom,w=p.width,S=p.height,_=w.u===zu.AUTO&&(m.u===zu.AUTO||b.u===zu.AUTO),C=S.u===zu.AUTO&&(x.u===zu.AUTO||E.u===zu.AUTO),A=0,T=y.length,O=[],M=0,k=0,L=0;this.mergeRich();var R={};if(f.length)for(var I=function(e,t){var n=f[e];R[n.location]=e;var i=n.fontFamily,o=Hh.data[i];if(o)for(var a=o.list||[],s=function(t,n){var o=a[t];if(o.postscriptName===i)return!o.loaded&&o.url&&dh.loadFont(i,o.url,(function(t){if(o.loaded=!0,t.success&&f&&f[e]&&f[e].fontFamily===i){if(r.asyncRefresh)return;r.asyncRefresh=!0,dh.requestAnimationFrame((function(){t.success&&f&&f[e]&&f[e].fontFamily===i&&(r.asyncRefresh=!1,r.refresh(XE.REFLOW))}))}})),"break"},l=0,c=a.length;l<c;l++){if("break"===s(l))break}},P=0,F=f.length;P<F;P++)I(P);else{var D=v.fontFamily,N=Hh.data[D];if(N){var B=N.list||[],U=function(e,t){var n=B[e];if(n.postscriptName===D)return!n.loaded&&n.url&&dh.loadFont(D,n.url,(function(e){n.loaded=!0,e.success&&!f.length&&v.fontFamily===D&&r.refresh(XE.REFLOW)})),"break"},z=0;for(F=B.length;z<F;z++){if("break"===U(z))break}}}var G=dh.getFontCanvas().ctx;if(f.length){var X=f[0];i=X.letterSpacing||0,o=X.paragraphSpacing||0,n=.8*X.fontSize+i,s=ip(X,a=X.lineHeight||np(X)),l=op(X,a),c=X.fontFamily,u=X.fontSize,h=Jf(X.color),O=X.textDecoration||[],G.font=tp(X),G.letterSpacing=i+"px"}else i=v.letterSpacing,o=v.paragraphSpacing,n=.8*v.fontWeight+i,a=v.lineHeight||np(v),s=ip(v,a),l=op(v,a),c=v.fontFamily,u=v.fontSize,h=Jf(this.style.color.v),O=v.textDecoration||[],G.font=tp(v),G.letterSpacing=i+"px";var H=new $S(L,a,A,!1);g.splice(0),g.push(H);for(var j=_?Number.MAX_SAFE_INTEGER:this.width;A<T;){var W=R[A];if(A&&W){var Y=f[W];i=Y.letterSpacing||0,o=Y.paragraphSpacing||0,n=.8*Y.fontSize+i,s=ip(Y,a=Y.lineHeight||np(Y)),l=op(Y,a),c=Y.fontFamily,u=Y.fontSize,h=Jf(Y.color),O=Y.textDecoration||[],G.font=tp(Y),G.letterSpacing=i+"px"}if("\n"!==y.charAt(A)){F=T;if(f.length)for(var q=A+1;q<F;q++)if(R[q]){F=q;break}if(G.measureText(y.charAt(A)).width>j-k+1e-10&&k)k=0,L+=H.height+o,A<T&&(H.verticalAlign(),H=new $S(L,a,A,!1),g.push(H));else{var V=e_(G,A,F,y,j-k,n),K=V.hypotheticalNum,Z=V.rw,J=V.newLine,$=new QS(k,L,Z,a,s,l,A,y.slice(A,A+K),G.font,c,u,h,i,O);H.add($),A+=K,M=Math.max(M,Math.ceil(Z+k)),J?(k=0,L+=H.height+o,A<T&&(H.verticalAlign(),H=new $S(L,a,A,!1),g.push(H))):k+=Z}}else A++,k=0,L+=H.height+o,H.verticalAlign(),H.endEnter=!0,H=new $S(L,a,A,!0),g.push(H)}if((H.verticalAlign(),M=Math.max(M,H.width),i&&i<0&&(M-=i),_)&&(he=M-this.width)){this.width=v.width=M;var Q=p.left,ee=p.right;Q.u!==zu.AUTO&&ee.u!==zu.AUTO||(Q.u!==zu.AUTO?v.right-=he:ee.u!==zu.AUTO&&(v.left-=he))}if(C){var te=H.y+H.height;if(he=te-this.height){this.height=v.height=te;var re=p.top,ne=p.bottom;re.u!==zu.AUTO&&ne.u!==zu.AUTO||(re.u!==zu.AUTO?v.bottom-=he:ne.u!==zu.AUTO&&(v.top-=he))}}if(f&&f.length){var ie={};f.forEach((function(e){ie[e.location]=e}));var oe=f[0].textAlign,ae=0;for(F=g.length;ae<F;ae++){var se=g[ae];if(se.startEnter||!se.index){var le=ie[se.index];le&&(oe=le.textAlign)}if(oe===Gu.CENTER)(he=this.width-se.width)&&se.offsetX(.5*he);else if(oe===Gu.RIGHT){(he=this.width-se.width)&&se.offsetX(he)}}}else if(y&&v.textAlign!==Gu.LEFT){var ce=0;for(F=g.length;ce<F;ce++){var ue=g[ce];if(v.textAlign===Gu.CENTER)(he=this.width-ue.width)&&ue.offsetX(.5*he);else if(v.textAlign===Gu.RIGHT){var he;(he=this.width-ue.width)&&ue.offsetX(he)}}}var de=this.height-H.y-H.height;if(de){var fe=v.textVerticalAlign;if(fe===Xu.MIDDLE){var pe=0;for(F=g.length;pe<F;pe++){g[pe].offsetY(.5*de)}}else if(fe===Xu.BOTTOM){var ve=0;for(F=g.length;ve<F;ve++){g[ve].offsetY(de)}}}},t.prototype.calContent=function(){return this.hasContent=!!this._content},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t);var i=this._bbox2||this.bbox2,o=i[0],a=i[1],s=i[2]-o,l=i[3]-a,c=-o*t,u=-a*t;s*=t,l*=t;var h=this.computedStyle,d=this.lineBoxList,f=this.canvasCache=Iw.getInstance(s,l,c,u);f.available=!0;var p=f.list,v=this.getSortedCursor(),y=v.isMulti,g=v.startLineBox,m=v.startTextBox,b=v.startString,x=v.endLineBox,E=v.endTextBox,w=v.endString,S=v.start,_=v.end;if(y&&S!==_)for(var C=0,A=p.length;C<A;C++){var T=p[C],O=T.x,M=T.y,k=T.os.ctx,L=-O,R=-M;if(k.fillStyle="#f4d3c1",g===x){var I=(D=d[g]).list,P=(N=I[m]).x*t+L;k.font=N.font,k.letterSpacing=N.letterSpacing+"px",P+=k.measureText(N.str.slice(0,b)).width*t;var F=(N=I[E]).x*t+L;k.font=N.font,F+=k.measureText(N.str.slice(0,w)).width*t,k.fillRect(P,D.y*t+R,F-P,D.lineHeight*t)}else{var D,N,B=(D=d[g]).list;if(N=B[m]){P=N.x*t+L;k.font=N.font,k.letterSpacing=N.letterSpacing+"px",P+=k.measureText(N.str.slice(0,b)).width*t,k.fillRect(P,D.y*t+R,D.w*t+L-P,D.lineHeight*t)}for(var U=g+1,z=x;U<z;U++){var G=d[U];G.list.length&&k.fillRect(G.list[0].x*t+L,G.y*t+R,G.w*t,G.lineHeight*t)}if(N=(B=(D=d[x]).list)[E]){P=N.x*t+L;k.font=N.font,k.letterSpacing=N.letterSpacing+"px",P+=k.measureText(N.str.slice(0,w)).width*t,k.fillRect(D.x*t+L,D.y*t+R,P-(D.x+L)*t,D.lineHeight*t)}}}var X=!1,H=h.fill,j=h.fillOpacity,W=h.fillEnable,Y=h.fillMode,q=h.stroke,V=h.strokeEnable,K=h.strokeWidth,Z=h.strokePosition,J=h.strokeMode,$=h.strokeDasharray,Q=h.strokeLinecap,ee=h.strokeLinejoin;for(C=0,A=H.length;C<A;C++)if(W[C]&&j[C]){X=!0;break}function te(e,r){void 0===r&&(r=!0);for(var n=0,i=d.length;n<i;n++){var o=d[n];if(o.y>=l)break;for(var a=o.list,s=a.length,h=function(n){var i=a[n],o=i.textDecoration;r_(e,i,t),r?e.fillText(i.str,i.x*t+c,(i.y+i.baseline)*t+u):e.strokeText(i.str,i.x*t+c,(i.y+i.baseline)*t+u),o.length&&o.forEach((function(r){if(r===ph.UNDERLINE){var n=Math.min(3*t,.05*i.lineHeight*t);e.strokeRect(i.x*t+c,(i.y+i.contentArea)*t+u-.5*n,i.w*t,n)}else if(r===ph.LINE_THROUGH){var o=Math.min(3*t,.05*i.lineHeight*t);e.strokeRect(i.x*t+c,(i.y+.5*i.lineHeight)*t+u-.5*o,i.w*t,o)}}))},f=0;f<s;f++)h(f)}}var re=function(e,i){var o=p[e],a=o.x,h=o.y,f=o.os.ctx,v=-a,y=-h;if(X)for(var g=function(e,i){if(!W[e]||!j[e])return"continue";var o=H[e],a=void 0,h=Y[e];if(f.globalAlpha=j[e],Array.isArray(o)){if(o[3]<=0)return"continue";f.fillStyle=Jf(o)}else{if(void 0!==o.url){var d=o.url;if(d){var p=ne.loaders[e],g=dh.IMG[d];if(!p&&g&&(p=ne.loaders[e]={error:!1,loading:!1,width:g.width,height:g.height,source:g.source}),p){if(!p.error&&!p.loading){var m=ne.width,b=ne.height,x=m*t,E=b*t,w=dh.getOffscreenCanvas(s,l),S=w.ctx;if(o.type===th.TILE)for(var _=null!==(r=o.scale)&&void 0!==r?r:1,C=0,A=Math.ceil(m/_/p.width);C<A;C++)for(var T=0,O=Math.ceil(b/_/p.height);T<O;T++)S.drawImage(p.source,v+C*p.width*t*_,y+T*p.height*t*_,p.width*t*_,p.height*t*_);else if(o.type===th.FILL){var M=x/p.width,k=E/p.height,L=Math.max(M,k),R=-.5*(p.width*L-x),I=-.5*(p.height*L-E);S.drawImage(p.source,0,0,p.width,p.height,R+v,I+y,p.width*L,p.height*L)}else if(o.type===th.STRETCH)S.drawImage(p.source,v,y,x,E);else if(o.type===th.FIT){M=x/p.width,k=E/p.height,L=Math.min(M,k);var P=-.5*(p.width*L-x),F=-.5*(p.height*L-E);S.drawImage(p.source,0,0,p.width,p.height,P+v,F+y,p.width*L,p.height*L)}S.fillStyle="#FFF",S.globalCompositeOperation="destination-in",te(S,!0),S.globalCompositeOperation="source-over",h!==Hu.NORMAL&&(f.globalCompositeOperation=Pw(h)),f.drawImage(w.canvas,0,0),h!==Hu.NORMAL&&(f.globalCompositeOperation="source-over"),w.release()}}else p=ne.loaders[e]=ne.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},dh.loadImg(d,(function(t){var r;d===(null===(r=H[e])||void 0===r?void 0:r.url)&&(p.loading=!1,t.success?(p.error=!1,p.source=t.source,p.width=t.width,p.height=t.height,n.isDestroyed||n.refresh()):p.error=!0)}))}return"continue"}if(o.t===Wu.LINEAR){var D=Gf(o.stops,o.d,v,y,s-2*c,l-2*u),N=f.createLinearGradient(D.x1,D.y1,D.x2,D.y2);D.stop.forEach((function(e){N.addColorStop(e.offset,Jf(e.color))})),f.fillStyle=N}else if(o.t===Wu.RADIAL){D=Xf(o.stops,o.d,v,y,s-2*c,l-2*u);var B=f.createRadialGradient(D.cx,D.cy,0,D.cx,D.cy,D.total);D.stop.forEach((function(e){B.addColorStop(e.offset,Jf(e.color))}));var U=D.matrix;if(U)(S=(a=dh.getOffscreenCanvas(s,l)).ctx).fillStyle="#FFF",te(S,!0),S.globalCompositeOperation="source-in",S.fillStyle=B,S.setTransform(U[0],U[1],U[4],U[5],U[12],U[13]),S.fillRect(0,0,s,l);else f.fillStyle=B}else if(o.t===Wu.CONIC){D=Hf(o.stops,o.d,v,y,s-2*c,l-2*u);var z=f.createConicGradient(D.angle,D.cx+v,D.cy+y);D.stop.forEach((function(e){z.addColorStop(e.offset,Jf(e.color))})),f.fillStyle=z}}h!==Hu.NORMAL&&(f.globalCompositeOperation=Pw(h)),a?(f.drawImage(a.canvas,0,0),a.release()):te(f,!0),h!==Hu.NORMAL&&(f.globalCompositeOperation="source-over")},m=0,b=H.length;m<b;m++)g(m);else for(var x=0,E=d.length;x<E;x++){if((F=d[x]).y>=l)break;for(var w=F.list,S=w.length,_=function(e){var r=w[e],n=r.textDecoration;r_(f,r,t),f.fillStyle=r.color,f.fillText(r.str,r.x*t+v,(r.y+r.baseline)*t+y),n.length&&n.forEach((function(e){if(e===ph.UNDERLINE){var n=Math.min(3*t,.05*r.lineHeight*t);f.fillRect(r.x*t+v,(r.y+r.contentArea)*t+y-.5*n,r.w*t,n)}else if(e===ph.LINE_THROUGH){var i=Math.min(3*t,.05*r.lineHeight*t);f.fillRect(r.x*t+v,(r.y+.5*r.lineHeight)*t+y-.5*i,r.w*t,i)}}))},C=0;C<S;C++)_(C)}f.globalAlpha=1,f.globalCompositeOperation="source-over";var A=ne.computedStyle,T=A.innerShadow,O=A.innerShadowEnable;if(T&&T.length){var M=!1,k=dh.getOffscreenCanvas(s,l),L=k.ctx;L.fillStyle="#FFF";var R=0;if(T.forEach((function(e,r){if(O[r]){M=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread)*t;R=Math.max(R,n+e.blur*t)}})),M){for(var I=0,P=d.length;I<P;I++){var F;if((F=d[I]).y>=l)break;for(var D=F.list,N=D.length,B=0;B<N;B++){var U=D[B];r_(L,U,t),L.fillText(U.str,U.x*t+v,(U.y+U.baseline)*t+y)}}L.globalCompositeOperation="source-out",L.fillRect(-R,-R,s+R,l+R);var z=dh.getOffscreenCanvas(s,l),G=z.ctx;T.forEach((function(e,r){O[r]&&(G.shadowOffsetX=e.x*t,G.shadowOffsetY=e.y*t,G.shadowColor=Jf(e.color),G.shadowBlur=e.blur*t,G.drawImage(k.canvas,0,0))})),f.globalCompositeOperation="source-atop",f.drawImage(z.canvas,0,0),f.globalCompositeOperation="source-over",k.release(),z.release()}}1!==t?f.setLineDash($.map((function(e){return e*t}))):f.setLineDash($),Q===$u.ROUND?f.lineCap="round":Q===$u.SQUARE?f.lineCap="square":f.lineCap="butt",ee===Qu.ROUND?f.lineJoin="round":ee===Qu.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=1,f.fillStyle="transparent";for(var re=function(e,r){if(!V[e]||!K[e])return"continue";var n=q[e],i=Z[e];if(f.globalCompositeOperation=Pw(J[e]),Array.isArray(n))f.strokeStyle=Jf(n);else if(n.t===Wu.LINEAR){var o=Gf(n.stops,n.d,v,y,s-2*c,l-2*u),a=f.createLinearGradient(o.x1,o.y1,o.x2,o.y2);o.stop.forEach((function(e){a.addColorStop(e.offset,Jf(e.color))})),f.strokeStyle=a}else if(n.t===Wu.RADIAL){o=Xf(n.stops,n.d,v,y,s-2*c,l-2*u);var h=f.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.total);o.stop.forEach((function(e){h.addColorStop(e.offset,Jf(e.color))}));var d=o.matrix;if(d){var p=dh.getOffscreenCanvas(s,l),g=p.ctx;return g.setLineDash(f.getLineDash()),g.lineCap=f.lineCap,g.lineJoin=f.lineJoin,g.miterLimit=f.miterLimit*t,g.lineWidth=K[e]*t,i===eh.INSIDE||i===eh.OUTSIDE?(g.fillStyle="#FFF",te(g,!0),g.lineWidth=2*K[e]*t,g.strokeStyle="#FFF",i===eh.INSIDE?g.globalCompositeOperation="source-in":g.globalCompositeOperation="source-out",te(g,!1)):(g.lineWidth=K[e]*t,g.strokeStyle="#FFF",te(g,!1)),g.globalCompositeOperation="source-in",g.setTransform(d[0],d[1],d[4],d[5],d[12],d[13]),g.fillStyle=h,g.fillRect(0,0,s,l),f.drawImage(p.canvas,0,0),p.release(),"continue"}f.strokeStyle=h}else if(n.t===Wu.CONIC){o=Hf(n.stops,n.d,v,y,s-2*c,l-2*u);var m=f.createConicGradient(o.angle,o.cx+v,o.cy+y);o.stop.forEach((function(e){m.addColorStop(e.offset,Jf(e.color))})),f.strokeStyle=m}var b=void 0,x=void 0;if(i===eh.INSIDE||i===eh.OUTSIDE){(x=(b=dh.getOffscreenCanvas(s,l)).ctx).setLineDash(f.getLineDash()),x.lineCap=f.lineCap,x.lineJoin=f.lineJoin,x.miterLimit=f.miterLimit*t,x.strokeStyle=f.strokeStyle,x.lineWidth=2*K[e]*t,x.lineWidth=2*K[e]*t,x.fillStyle="#FFF",te(x,!1);var E=dh.getOffscreenCanvas(s,l),w=E.ctx;w.fillStyle="#FFF",te(w,!0),i===eh.INSIDE?x.globalCompositeOperation="destination-in":x.globalCompositeOperation="destination-out",x.drawImage(E.canvas,0,0),E.release()}else f.lineWidth=K[e]*t,te(f,!1);b&&(f.drawImage(b.canvas,v-c,y-u),b.release()),f.globalCompositeOperation="source-over"},ie=0,oe=q.length;ie<oe;ie++)re(ie)},ne=this;for(C=0,A=p.length;C<A;C++)re(C)},t.prototype.setCursorStartByAbsCoords=function(e,t){var r=this.matrixWorld,n=yd({x:e,y:t},sd(r)),i=this.lineBoxList,o=this.cursor,a=o.start;o.isMulti=!1;for(var s=i.length,l=0;l<s;l++){var c=i[l];if(n.y>=c.y&&n.y<c.y+c.lineHeight){o.startLineBox=o.endLineBox=l;var u=this.getCursorByLocalX(n.x,c,!1);o.endTextBox=o.startTextBox,o.endString=o.startString,o.end=o.start,this.tempCursorX=this.currentCursorX=u.x,o.start!==a&&(this.inputStyle=void 0);var h=yd({x:u.x,y:u.y},r);return{x:h.x,y:h.y,h:u.h*r[0]}}}var d=i[s-1];o.startLineBox=o.endLineBox=s-1;var f=this.getCursorByLocalX(this.width,d,!1);o.endTextBox=o.startTextBox,o.endString=o.startString,o.end=o.start,this.tempCursorX=this.currentCursorX=f.x,o.start!==a&&(this.inputStyle=void 0);var p=yd({x:f.x,y:f.y},r);return{x:p.x,y:p.y,h:f.h*r[0]}},t.prototype.setCursorEndByAbsCoords=function(e,t){var r=this.matrixWorld,n=yd({x:e,y:t},sd(r)),i=this.lineBoxList,o=this.cursor,a=o.end;o.isMulti=!0;for(var s=i.length,l=0;l<s;l++){var c=i[l];if(n.y>=c.y&&n.y<c.y+c.lineHeight){o.endLineBox=l;var u=this.getCursorByLocalX(n.x,c,!0);o.end!==a&&this.refresh();var h=yd({x:u.x,y:u.y},r);return{x:h.x,y:h.y,h:u.h*r[0]}}}var d=i[s-1];o.endLineBox=s-1;var f=this.getCursorByLocalX(this.width,d,!0);o.end!==a&&this.refresh(),o.end!==o.start&&(this.inputStyle=void 0);var p=yd({x:f.x,y:f.y},r);return{x:p.x,y:p.y,h:f.h*r[0]}},t.prototype.resetCursor=function(){var e=this.cursor;e.isMulti&&(e.isMulti=!1,e.start!==e.end&&(this.refresh(),e.endLineBox=e.startLineBox,e.endTextBox=e.startTextBox,e.endString=e.startString,e.end=e.start))},t.prototype.beforeEdit=function(){var e=this,t=e.style,r=e.computedStyle,n=e.parent,i=e.isDestroyed,o=e.width,a=e.height;if(i||!n)throw new Error("Can not edit a destroyed Text");var s=this.getStyle(),l=t.left,c=t.right,u=t.top,h=t.bottom,d=t.width,f=t.height,p=t.translateX,v=t.translateY,y=t.textAlign,g=t.textVerticalAlign,m=l.u!==zu.AUTO&&c.u!==zu.AUTO||d.u!==zu.AUTO,b=y.v===Gu.LEFT&&!m&&(l.u!==zu.AUTO&&p.v&&p.u===zu.PERCENT||c.u!==zu.AUTO),x=y.v===Gu.CENTER&&!m&&(-50!==p.v||p.u!==zu.PERCENT),E=y.v===Gu.RIGHT&&c.u===zu.AUTO,w=u.u!==zu.AUTO&&h.u!==zu.AUTO||f.u!==zu.AUTO,S=g.v===Xu.TOP&&!w&&(u.u!==zu.AUTO&&v.v&&v.u===zu.PERCENT||h.u!==zu.AUTO),_=g.v===Xu.MIDDLE&&!w&&(-50!==v.v||v.u!==zu.PERCENT),C=g.v===Xu.BOTTOM&&!w&&h.u===zu.AUTO,A=n.width,T=n.height,O=!1,M=0;if(p.u===zu.PX?M=p.v:p.u===zu.PERCENT&&(M=.01*p.v*o),b)l.u!==zu.AUTO&&p.v&&p.u===zu.PERCENT?(O=!0,r.left+=M,l.u===zu.PX?l.v+=M:l.u===zu.PERCENT&&(l.v+=100*M/A),r.right-=M,c.u===zu.PX?c.v-=M:c.u===zu.PERCENT&&(c.v-=100*M/A)):c.u!==zu.AUTO&&(O=!0,r.left+=M,l.v=r.left,l.u=zu.PX,r.right-=M,c.v=0,c.u=zu.AUTO),p.v=0;else if(x){if(p.u===zu.AUTO||p.u===zu.PX){O=!0;var k=.5*o-p.v;r.left+=k,r.right-=k,l.u===zu.PX?(l.v+=k,p.v=-50):l.u===zu.PERCENT?(l.v+=100*k/A,p.v=-50):c.u===zu.PX?(c.v+=k,p.v=50):c.u===zu.PERCENT&&(c.v+=100*k/A,p.v=50),p.u=zu.PERCENT}else if(p.u===zu.PERCENT&&-50!==p.v){O=!0;k=.5*o-p.v*o;r.left+=k,r.right-=k,l.u===zu.PX?(l.v+=k,p.v=-50):l.u===zu.PERCENT?(l.v+=100*k/A,p.v=-50):c.u===zu.PX?(c.v+=k,p.v=50):c.u===zu.PERCENT&&(c.v+=100*k/A,p.v=50)}}else E&&(O=!0,r.left+=M,l.u!==zu.AUTO&&(l.v=0,l.u=zu.AUTO),r.right-=M,c.v=r.right,c.u=zu.PX,p.v=0);var L=0;if(v.u===zu.PX?L=v.v:v.u===zu.PERCENT&&(L=.01*v.v*a),S)u.u!==zu.AUTO&&v.v&&v.u===zu.PERCENT?(O=!0,r.top+=L,u.u===zu.PX?u.v+=L:u.u===zu.PERCENT&&(u.v+=100*L/T),r.bottom-=L,h.u===zu.PX?h.v-=L:h.u===zu.PERCENT&&(h.v-=100*L/T)):h.u!==zu.AUTO&&(O=!0,r.top+=L,u.v=r.top,u.u=zu.PX,r.bottom-=L,h.v=0,h.u=zu.AUTO),v.v=0;else if(_){if(v.u===zu.AUTO||v.u===zu.PX){O=!0;var R=.5*a-v.v;r.top+=R,r.bottom-=R,u.u===zu.PX?(u.v+=R,v.v=-50):u.u===zu.PERCENT?(u.v+=100*R/T,v.v=-50):h.u===zu.PX?(h.v+=R,v.v=50):h.u===zu.PERCENT&&(h.v+=100*R/T,v.v=50),v.u=zu.PERCENT}else if(v.u===zu.PERCENT&&-50!==v.v){O=!0;R=.5*a-v.v*a;r.top+=R,r.bottom-=R,u.u===zu.PX?(u.v+=R,v.v=-50):u.u===zu.PERCENT?(u.v+=100*R/T,v.v=-50):h.u===zu.PX?(h.v-=R,v.v=50):h.u===zu.PERCENT&&(h.v-=100*R/T,v.v=50),v.v=-50}}else C&&(O=!0,r.top+=L,u.u!==zu.AUTO&&(u.v=0,u.u=zu.AUTO),r.bottom-=L,h.v=r.bottom,h.u=zu.PX,v.v=0);if(O)return this.editStyle={isLeft:b,isCenter:x,isRight:E,isTop:S,isMiddle:_,isBottom:C,isFixedHeight:w,prev:s}},t.prototype.afterEdit=function(){if(this.editStyle){var e=this.editStyle,t=e.isLeft,r=e.isCenter,n=e.isRight,i=e.isTop,o=e.isMiddle,a=e.isBottom;e.isFixedHeight;var s=e.prev,l=this,c=l.style,u=l.computedStyle,h=l.parent,d=l.width,f=l.height,p=s.left,v=s.right,y=s.top,g=s.bottom;s.height;var m=s.translateX,b=s.translateY,x=h,E=x.width,w=x.height,S=0;if(m.u===zu.PX?S=m.v:m.u===zu.PERCENT&&(S=.01*m.v*d),t){if(p.u!==zu.AUTO&&m.v&&m.u===zu.PERCENT){if(p.u===zu.PX)c.left.v-=S,u.left-=S;else if(p.u===zu.PERCENT){var _=100*S/E;c.left.v-=_,u.left-=S}if(v.u===zu.PX)c.right.v+=S,u.right+=S;else if(v.u===zu.PERCENT){_=100*S/E;c.right.v+=_,u.right+=S}u.translateX+=S}else v.u!==zu.AUTO&&(c.left.v=0,c.left.u=zu.AUTO,u.left-=S,c.right.v=v.v,c.right.u=v.u,u.right+=S);c.translateX.v=m.v}else if(r){if(m.u===zu.AUTO||m.u===zu.PX){var C=.5*d-m.v;p.u===zu.PX?c.left.v-=C:p.u===zu.PERCENT?c.left.v-=100*C/E:v.u===zu.PX?c.right.v-=C:v.u===zu.PERCENT&&(c.right.v-=100*C/E),c.translateX.v=m.v,c.translateX.u=m.u}else if(m.u===zu.PERCENT&&-50!==m.v){C=.5*d-m.v*d;p.u===zu.PX?c.left.v-=C:p.u===zu.PERCENT&&(c.left.v-=100*C/E),v.u===zu.PX?c.right.v-=C:v.u===zu.PERCENT&&(c.right.v-=100*C/E),c.translateX.v=m.v}}else n&&(u.left-=S,p.u===zu.PX?c.left.v=u.left:p.u===zu.PERCENT&&(c.left.v=100*u.left/E),c.left.u=p.u,u.right+=S,v.u===zu.AUTO&&(c.right.v=0,c.right.u=zu.AUTO),c.translateX.v=m.v,c.translateX.u=m.u);var A=0;if(b.u===zu.PX?A=b.v:b.u===zu.PERCENT&&(A=.01*b.v*f),i){if(y.u!==zu.AUTO&&b.v&&b.u===zu.PERCENT){if(y.u===zu.PX)c.top.v-=A,u.top-=A;else if(y.u===zu.PERCENT){_=100*A/w;c.top.v-=_,u.top-=A}if(g.u===zu.PX)c.bottom.v+=A,u.bottom+=A;else if(g.u===zu.PERCENT){_=100*A/w;c.bottom.v+=_,u.bottom+=A}}else g.u!==zu.AUTO&&(c.top.v=0,c.top.u=zu.AUTO,u.top-=A,c.bottom.v=g.v,c.bottom.u=g.u,u.bottom+=A);c.translateY.v=b.v,u.translateY+=A}else if(o){if(b.u===zu.AUTO||b.u===zu.PX){var T=.5*f-b.v;y.u===zu.PX?c.top.v-=T:y.u===zu.PERCENT?c.top.v-=100*T/w:g.u===zu.PX?c.bottom.v-=T:g.u===zu.PERCENT&&(c.bottom.v-=100*T/w),c.translateY.v=b.v,c.translateY.u=zu.PX}else if(b.u===zu.PERCENT&&-50!==b.v){T=.5*f-b.v*f;y.u===zu.PX?c.top.v-=T:y.u===zu.PERCENT?c.top.v-=100*T/w:g.u===zu.PX?c.bottom.v-=T:g.u===zu.PERCENT&&(c.bottom.v-=100*T/w),c.translateY.v=b.v}}else a&&(u.top-=A,y.u===zu.PX?c.top.v=u.top:y.u===zu.PERCENT&&(c.top.v=100*u.top/w),u.bottom+=A,g.u===zu.AUTO&&(c.bottom.v=0,c.bottom.u=zu.AUTO),c.translateY.v=b.v,c.translateY.u=b.u)}},t.prototype.updateCursorByIndex=function(e){var t=this.setCursorByIndex(e,!1),r=t.lineBox,n=t.textBox,i=this.cursor,o=this.matrixWorld;if(n){var a=dh.getFontCanvas().ctx;a.font=n.font,a.letterSpacing=n.letterSpacing+"px";var s=n.str,l=a.measureText(s.slice(0,i.startString)).width;this.tempCursorX=this.currentCursorX=n.x+l}else{var c=this.computedStyle.textAlign;c===Gu.CENTER?this.tempCursorX=this.currentCursorX=.5*this.width:c===Gu.RIGHT?this.tempCursorX=this.currentCursorX=this.width:this.tempCursorX=this.currentCursorX=0}var u=yd({x:this.tempCursorX,y:r.y},o);return{x:u.x,y:u.y,h:r.lineHeight*o[0]}},t.prototype.setCursorByIndex=function(e,t){void 0===t&&(t=!1);var r=this.lineBoxList,n=this.cursor;t?n.end=e:n.start=e;for(var i=0,o=r.length;i<o;i++){var a=r[i],s=a.list;if(!s.length&&a.index===e)return n.startLineBox=i,n.startTextBox=0,n.startString=0,{lineBox:a,textBox:void 0};for(var l=0,c=s.length;l<c;l++){var u=s[l];if(e>=u.index&&(e<u.index+u.str.length||l===c-1&&a.endEnter&&e<=u.index+u.str.length))return t?(n.endLineBox=i,n.endTextBox=l,n.endString=e-u.index):(n.startLineBox=i,n.startTextBox=l,n.startString=e-u.index),{lineBox:a,textBox:u}}}var h=r.length-1,d=r[h],f=d.list;if(t?n.endLineBox=h:n.startLineBox=h,!f||!f.length)return t?(n.endTextBox=0,n.endString=0):(n.startTextBox=0,n.startString=0),{lineBox:d,textBox:void 0};var p=f.length-1,v=f[p];return t?(n.endTextBox=p,n.endString=v.str.length):(n.startTextBox=p,n.startString=v.str.length),{lineBox:d,textBox:v}},t.prototype.checkCursorMulti=function(){var e=this.cursor;return e.isMulti&&e.start===e.end&&(e.isMulti=!1),e.isMulti},t.prototype.getCursorAbsCoords=function(){var e=this.matrixWorld,t=this.lineBoxList,r=this.cursor;if(!r.isMulti){var n=t[r.startLineBox],i=n.list,o=n.lineHeight;if(!i.length){var a=this.computedStyle.textAlign,s=0;a===Gu.CENTER?s=.5*this.width:a===Gu.RIGHT&&(s=this.width);var l=yd({x:s,y:n.y},e);return{x:l.x,y:l.y,h:o*e[0]}}var c=yd({x:this.currentCursorX,y:n.y},e);return{x:c.x,y:c.y,h:o*e[0]}}},t.prototype.moveCursor=function(e,t){void 0===t&&(t=!1);var r=this.matrixWorld,n=this.cursor,i=this.getSortedCursor(),o=t?i.endLineBox:i.startLineBox,a=t?i.endTextBox:i.startTextBox,s=t?i.endString:i.startString,l=this.lineBoxList,c=l[o],u=c.list,h=u[a],d=t?i.end:i.start;if(n.isMulti&&!t){if(n.isMulti=!1,n.start!==n.end&&this.refresh(),39===e||40===e){var f=i.endLineBox,p=i.endTextBox,v=i.endString;d=(h=(u=(c=l[f]).list)[p])?h.index+v:c.index+v}return this.inputStyle=void 0,this.updateCursorByIndex(d)}if(t&&(n.isMulti=!0),37===e){if(0===d)return;0===s?0===a?(t?n.endLineBox=--o:n.startLineBox=--o,(u=(c=l[o]).list).length?(t?n.endTextBox=a=u.length-1:n.startTextBox=a=u.length-1,h=u[a],t?(n.endString=h.str.length-(c.endEnter?0:1),n.end=h.index+n.endString):(n.startString=h.str.length-(c.endEnter?0:1),n.start=h.index+n.startString)):t?(n.endTextBox=0,n.endString=0,n.end=c.index):(n.startTextBox=0,n.startString=0,n.start=c.index)):(t?n.endTextBox=--a:n.startTextBox=--a,h=u[a],t?(n.endString=h.str.length-1,n.end=h.index+n.endString):(n.startString=h.str.length-1,n.start=h.index+n.startString)):t?(n.endString=--s,n.end=h.index+n.endString):(n.startString=--s,n.start=h.index+n.startString)}else if(38===e){if(0===d)return;if(0!==o){c=l[--o],t?n.endLineBox=o:n.startLineBox=o;var y=this.getCursorByLocalX(this.tempCursorX,c,t);t&&this.refresh(),this.inputStyle=void 0;var g=yd({x:y.x,y:y.y},r);return{x:g.x,y:g.y,h:c.lineHeight*r[0]}}t?n.endTextBox=0:n.startTextBox=0,h=u[0],t?(n.endString=0,n.end=0):(n.startString=0,n.start=0)}else if(39===e){if(d===this._content.length)return;!h||a===u.length-1&&s===h.str.length&&c.endEnter?(t?(n.endLineBox=++o,n.endTextBox=0,n.endString=0):(n.startLineBox=++o,n.startTextBox=0,n.startString=0),h=(u=(c=l[o]).list)[0],t?n.end=h.index:n.start=h.index):a===u.length-1&&s===h.str.length?(t?(n.endLineBox=++o,n.endTextBox=0,n.endString=1):(n.startLineBox=++o,n.startTextBox=0,n.startString=1),h=(u=(c=l[o]).list)[0],t?n.end=h.index+1:n.start=h.index+1):s===h.str.length?(t?n.endTextBox=++a:n.startTextBox=++a,h=u[a],t?(n.endString=1,n.end=h.index+1):(n.startString=1,n.start=h.index+1),a===u.length-1&&1===h.str.length&&!c.endEnter&&o<l.length-1&&(t?n.endLineBox=++o:n.startLineBox=++o,u=(c=l[o]).list,t?n.endTextBox=a=0:n.startTextBox=a=0,h=u[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index))):s===h.str.length-1?a===u.length-1?c.endEnter||o===l.length-1?t?(n.endString++,n.end=h.index+n.endString):(n.startString++,n.start=h.index+n.startString):(t?n.endLineBox=++o:n.startLineBox=++o,u=(c=l[o]).list,t?n.endTextBox=a=0:n.startTextBox=a=0,h=u[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index)):(t?n.endTextBox=++a:n.startTextBox=++a,h=u[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index)):t?(n.endString=++s,n.end=h.index+n.endString):(n.startString=++s,n.start=h.index+n.startString)}else if(40===e){if(d===this._content.length)return;if(o!==l.length-1){c=l[++o],t?n.endLineBox=o:n.startLineBox=o;y=this.getCursorByLocalX(this.tempCursorX,c,t);t&&this.refresh(),this.inputStyle=void 0;var m=yd({x:y.x,y:y.y},r);return{x:m.x,y:m.y,h:c.lineHeight*r[0]}}t?n.endTextBox=a=u.length-1:n.startTextBox=a=u.length-1,h=u[a],t?(n.endString=h?h.str.length:0,n.end=h.index+n.endString):(n.startString=h?h.str.length:0,n.start=h.index+n.startString)}if(h){var b=dh.getFontCanvas().ctx;b.font=h.font,b.letterSpacing=h.letterSpacing+"px";var x=h.str,E=b.measureText(x.slice(0,n.startString)).width;this.tempCursorX=this.currentCursorX=h.x+E}else{var w=this.computedStyle.textAlign;w===Gu.CENTER?this.tempCursorX=this.currentCursorX=.5*this.width:w===Gu.RIGHT?this.tempCursorX=this.currentCursorX=this.width:this.tempCursorX=this.currentCursorX=0}t&&this.refresh(),this.inputStyle=void 0;var S=yd({x:this.currentCursorX,y:c.y},r);return{x:S.x,y:S.y,h:c.lineHeight*r[0]}},t.prototype.selectAll=function(){var e=this.lineBoxList,t=e.length,r=e[t-1],n=null==r?void 0:r.list,i=n?n[n.length-1]:void 0;Object.assign(this.cursor,{isMulti:!0,startLineBox:0,startTextBox:0,startString:0,start:0,endLineBox:t-1,endTextBox:n?n.length-1:0,endString:i?i.str.length:0,end:this._content.length}),this.refresh()},t.prototype.input=function(e){var t=this.getSortedCursor(),r=t.isMulti,n=t.start,i=t.end,o=this._content;if(r){var a=this.getCursorRich();this.cursor.isMulti=!1,this._content=o.slice(0,n)+o.slice(i),this.cutRich(n,i),o=this._content,this._content=o.slice(0,n)+e+o.slice(n),this.insertRich(a[0],n,e.length)}else if(this.inputStyle){a=this.getCursorRich();this._content=o.slice(0,n)+e+o.slice(n),this.insertRich(Object.assign({},a[0],this.inputStyle),n,e.length),this.inputStyle=void 0}else this._content=o.slice(0,n)+e+o.slice(n),this.expandRich(n,e.length);this.refresh(XE.REFLOW),this.updateCursorByIndex(n+e.length)},t.prototype.enter=function(){this.inputStyle=void 0;var e=this.getSortedCursor(),t=e.isMulti,r=e.start,n=e.end;if(t){this.cursor.isMulti=!1,this.cutRich(r,n);var i=this._content;this._content=i.slice(0,r)+i.slice(n)}this.expandRich(r,1);var o=this._content;this._content=o.slice(0,r)+"\n"+o.slice(r),this.refresh(XE.REFLOW),this.updateCursorByIndex(r+1)},t.prototype.delete=function(e){void 0===e&&(e=!1),this.inputStyle=void 0;var t=this._content;if(t){var r=this.getSortedCursor(),n=r.isMulti,i=r.start,o=r.end;i<1&&!n&&!e||i===t.length&&e||(n?(this.cursor.isMulti=!1,this._content=t.slice(0,i)+t.slice(o),this.cutRich(i,o)):e?(this._content=t.slice(0,i)+t.slice(i+1),this.cutRich(i,i+1)):(this._content=t.slice(0,i-1)+t.slice(i),this.cutRich(i-1,i)),this.refresh(XE.REFLOW),n||e?this.updateCursorByIndex(i):this.updateCursorByIndex(i-1))}},t.prototype.getCursorByLocalX=function(e,t,r){void 0===r&&(r=!1);var n=t.list,i=this.cursor,o=0,a=t.y,s=t.lineHeight;r?i.endString=i.end=0:i.startString=i.start=0;e:for(var l=0,c=n.length;l<c;l++){var u=(S=n[l]).x,h=S.w,d=S.str,f=S.font,p=S.letterSpacing;if(!l&&e<u||e>=u&&e<u+h||l===c-1){r?i.endTextBox=l:i.startTextBox=l;var v=dh.getFontCanvas().ctx;v.font=f,v.letterSpacing=p+"px";for(var y=0,g=d.length;y<g;){if(y===g-1){var m=v.measureText(d.slice(0,y)).width,b=v.measureText(d.slice(0,g)).width;e-(u+m)>u+b-e?(o=u+b,r?(i.endString=g,i.end=S.index+g):(i.startString=g,i.start=S.index+g)):(o=u+m,r?(i.endString=y,i.end=S.index+y):(i.startString=y,i.start=S.index+y));break e}var x=y+(g-y>>1),E=v.measureText(d.slice(0,x)).width;if(e>u+E)y=x;else{if(!(e<u+E)){r?(i.endString=x,i.end=S.index+x):(i.startString=x,i.start=S.index+x),o=u+E;break e}g=x}}}}var w=r?i.endTextBox:i.startTextBox;if(w<n.length-1){var S=n[w];(r?i.endString:i.startString)===S.str.length&&(r?(i.endTextBox++,i.endString=0,i.end=n[w+1].index):(i.startTextBox++,i.startString=0,i.start=n[w+1].index))}if(!n.length){r?(i.endString=0,i.end=t.index):(i.startString=0,i.start=t.index);var _=this.computedStyle.textAlign;_===Gu.CENTER?o=.5*this.width:_===Gu.RIGHT&&(o=this.width)}return{x:o,y:a,h:s}},t.prototype.getRich=function(){return this.rich.map((function(e){return Object.assign({},e)}))},t.prototype.setRich=function(e){this.rich=e,this.refresh(XE.REFLOW)},t.prototype.getCursor=function(){return Object.assign({},this.cursor)},t.prototype.updateRangeStyle=function(e,t,r){var n=XE.NONE;if(0===e){var i=this.style,o=this.computedStyle;void 0!==r.fontFamily&&(i.fontFamily.v=o.fontFamily=r.fontFamily),void 0!==r.fontSize&&(i.fontSize.v=o.fontSize=r.fontSize),void 0!==r.color&&(i.color.v=o.color=Zf(r.color)),void 0!==r.letterSpacing&&(i.letterSpacing.v=o.letterSpacing=r.letterSpacing),void 0!==r.lineHeight&&(0===r.lineHeight?(i.lineHeight.v=0,i.lineHeight.u=zu.AUTO,o.lineHeight=np(o)):(i.lineHeight.v=o.lineHeight=r.lineHeight,i.lineHeight.u=zu.PX)),void 0!==r.paragraphSpacing&&(i.paragraphSpacing.v=o.paragraphSpacing=r.paragraphSpacing),void 0!==r.textAlign&&(i.textAlign.v=o.textAlign=r.textAlign),void 0!==r.textDecoration&&(i.textDecoration=r.textDecoration.map((function(e){return{v:e,u:zu.NUMBER}})),o.textDecoration=r.textDecoration.slice(0))}for(var a=this.rich,s=0,l=a.length;s<l&&!(t<1);s++){var c=a[s];if(e>=c.location&&e<c.location+c.length){if(e>c.location){var u=K(K({},c),{length:e-c.location});a.splice(s,0,u),s++,l++,c.location+=u.length,c.length-=u.length}var h=!1;if(e+t<c.location+c.length){var d=K(K({},c),{location:e+t,length:c.location+c.length-e-t});a.splice(s+1,0,d),c.length-=d.length,h=!0}if(n|=this.updateRichItem(c,r),h)break;e+=c.length,t-=c.length}}this.mergeRich(),n&&this.refresh(n)},t.prototype.updateRichItem=function(e,t){var r=XE.NONE;if(void 0!==t.fontFamily&&t.fontFamily!==e.fontFamily&&(e.fontFamily=t.fontFamily,r|=XE.REFLOW),void 0!==t.fontSize&&t.fontSize!==e.fontSize&&(e.fontSize=t.fontSize,r|=XE.REFLOW),void 0!==t.color){var n=Zf(t.color);e.color[0]===n[0]&&e.color[1]===n[1]&&e.color[2]===n[2]&&e.color[3]===n[3]||(e.color=n,r|=XE.REFLOW)}return void 0!==t.letterSpacing&&t.letterSpacing!==e.letterSpacing&&(e.letterSpacing=t.letterSpacing,r|=XE.REFLOW),void 0!==t.lineHeight&&t.lineHeight!==e.lineHeight&&(e.lineHeight=t.lineHeight,r|=XE.REFLOW),void 0!==t.paragraphSpacing&&t.paragraphSpacing!==e.paragraphSpacing&&(e.paragraphSpacing=t.paragraphSpacing,r|=XE.REFLOW),void 0!==t.textAlign&&t.textAlign!==e.textAlign&&(e.textAlign=t.textAlign,r|=XE.REFLOW),void 0!==t.textDecoration&&t.textDecoration!==e.textDecoration&&(e.textDecoration=t.textDecoration,r|=XE.REFLOW),r},t.prototype.cutRich=function(e,t){var r=this.rich;if(r.length){for(var n=t-e,i=0,o=r.length;i<o;i++){var a=r[i];if(a.location<=e&&a.location+a.length>e){if(a.location+a.length>=t){a.length-=n;for(var s=i+1;s<o;s++)r[s].location-=n;a.length||r.splice(i,1)}else{a.length=e-a.location;for(var l=i+1,c=r.length;l<c;l++){var u=r[l];if(u.location<=t&&(u.location+u.length>t||l===c-1)){u.length-=t-u.location,u.location-=n;s=l+1;for(var h=r.length;s<h;s++)r[s].location-=n;i<l-1&&r.splice(i+1,l-i-1),u.length||r.splice(l,1);break}}a.length||r.splice(i,1)}break}}this.mergeRich()}},t.prototype.expandRich=function(e,t){var r=this.rich,n=this._content;if(r.length){e=Math.max(0,e);for(var i=0,o=r.length;i<o;i++){var a=r[i];if(a.location<=e&&a.location+a.length>=e){if(e===a.location+a.length&&"\n"===n.charAt(e-1))continue;a.length+=t;for(var s=i+1;s<o;s++)r[s].location+=t;return}}r[r.length-1].length+=t}else{var l=this.computedStyle;r.push({location:e,length:t,fontFamily:l.fontFamily,fontSize:l.fontSize,fontWeight:400,fontStyle:"normal",letterSpacing:l.letterSpacing,textAlign:[Gu.LEFT,Gu.RIGHT,Gu.CENTER,Gu.JUSTIFY][l.textAlign],textDecoration:l.textDecoration,lineHeight:l.lineHeight,paragraphSpacing:l.paragraphSpacing,color:l.color})}},t.prototype.insertRich=function(e,t,r){var n=this.computedStyle,i=Object.assign({location:t,length:r,fontFamily:n.fontFamily,fontSize:n.fontSize,fontWeight:400,fontStyle:"normal",letterSpacing:n.letterSpacing,textAlign:n.textAlign,textDecoration:n.textDecoration,lineHeight:n.lineHeight,paragraphSpacing:n.paragraphSpacing,color:n.color},e);i.color=Zf(i.color),i.location=t,i.length=r;var o=this.rich;if(o.length){for(var a=0,s=o.length;a<s;a++){var l=o[a];if(l.location<=t&&l.location+l.length>=t){for(var c=a+1;c<s;c++)o[c].location+=r;if(l.location===t)o.splice(a,0,i),l.location+=r;else if(l.location+l.length===t)o.splice(a+1,0,i);else if(l.location+l.length>t){var u=Iu(l);l.length=t-l.location,u.location=t+r,u.length-=l.length,o.splice(a+1,0,i),o.splice(a+2,0,u)}return void this.mergeRich()}}o.push(i),this.mergeRich()}else o.push(i)},t.prototype.mergeRich=function(){var e=this,t=e.rich,r=e._content,n=e.style;if(t.length){this.rich=t=t.filter((function(e){return e.location>-1&&e.length>0})),t.sort((function(e,t){return e.location===t.location?e.length-t.length:e.location-t.location}));var i=!1,o={fontFamily:n.fontFamily.v,fontSize:n.fontSize.v,fontWeight:400,fontStyle:"normal",letterSpacing:n.letterSpacing.v,textAlign:n.textAlign.v,textDecoration:n.textDecoration.map((function(e){return e.v})),lineHeight:n.lineHeight.v,paragraphSpacing:n.paragraphSpacing.v,color:n.color.v.slice(0)};if(r.length){var a=t[t.length-1];(!t.length||a.location+a.length<r.length)&&(t.push(K({location:a?a.location+a.length:0,length:a?r.length-a.location-a.length:r.length},o)),i=!0),(a=t[t.length-1]).location+a.length>r.length&&(a.length=r.length-a.location,i=!0);var s=t[0];s.location>0&&(t.unshift(K({location:0,length:s.location},o)),i=!0)}for(var l=t.length-2;l>=0;l--){var c=t[l],u=t[l+1];if(u.length)if(c.length){var h=c.location+c.length;if(h===u.location)Pu(c,u,["color","fontFamily","fontSize","letterSpacing","lineHeight","textDecoration","paragraphSpacing"])?c.textAlign!==u.textAlign&&"\n"===r.charAt(u.location-1)||(c.length+=u.length,t.splice(l+1,1),i=!0):1===u.length&&"\n"===r.charAt(u.location)&&(c.length+=u.length,t.splice(l+1,1),i=!0);else{if(h<u.location)t.splice(l+1,0,K({location:h,length:u.location-h},o)),l+=2;else{var d=c.location+c.length-u.location;u.location-=d,u.length-=d,l++}i=!0}}else t.splice(l,1),l++;else t.splice(l+1,1)}return i}},t.prototype.setInputStyle=function(e){this.inputStyle=e?K(K({},this.inputStyle),e):void 0},t.prototype.getSortedCursor=function(){var e,t=this.cursor,r=t.isMulti,n=t.startLineBox,i=t.startTextBox,o=t.startString,a=t.endLineBox,s=t.endTextBox,l=t.endString,c=t.start,u=t.end,h=!1;return r?c>u&&(n=(e=[a,s,l,u,n,i,o,c])[0],i=e[1],o=e[2],c=e[3],a=e[4],s=e[5],l=e[6],u=e[7],h=!0):(a=n,s=i,l=o,u=c),{isMulti:r,startLineBox:n,startTextBox:i,startString:o,endLineBox:a,endTextBox:s,endString:l,start:c,end:u,isReversed:h}},t.prototype.getCursorRich=function(){var e=this.rich,t=this.lineBoxList,r=[];if(!e.length)return r;function n(t,r,n){for(void 0===r&&(r=0),void 0===n&&(n=e.length-1);r<n;){var i=Math.floor(.5*(r+n)),o=e[i];if(o.location<t&&o.location+o.length>=t)return o;o.location>=t?n=Math.min(i,n-1):r=Math.max(i,r+1)}return e[r]}var i=this.getSortedCursor(),o=i.isMulti,a=i.startLineBox,s=i.startTextBox,l=i.startString,c=i.start,u=i.end;if(o)for(var h=0,d=e.length;h<d;h++){if((f=e[h]).location>=u)break;f.location+f.length>c&&r.push(f)}if(!o||!r.length){var f,p=t[a],v=p.list;if(v.length)(f=n(v[s].index+(s+l===0?1:l)))&&-1===r.indexOf(f)&&r.push(f);else(f=n(p.index))&&-1===r.indexOf(f)&&r.push(f)}return r},t.prototype.clone=function(e){var r=this,n=Iu(this.props),i=n.uuid;e&&e.hasOwnProperty(i)&&e[i].forEach((function(e){var t=e.key,n=e.value;"content"===t[0]&&(r._content=n)})),n.uuid=a(),n.sourceUuid=this.props.uuid,this.rich&&(n.rich=this.rich.map((function(e){return K(K({},e),{textAlign:["left","right","center","justify"][e.textAlign]||"left",textDecoration:e.textDecoration.map((function(e){return["none","underline","lineThrough"][e]||"none"})),color:Jf(e.color)})}))),n.content=this._content;var o=new t(n);return o.style=Iu(this.style),o.computedStyle=Iu(this.computedStyle),n.textBehaviour===nh.AUTO?(o.style.width={v:this.width,u:zu.PX},o.style.height={v:this.height,u:zu.PX}):n.textBehaviour===nh.FIXED_W&&(o.style.height={v:this.height,u:zu.PX}),o},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.TEXT,t},t.prototype.toSketchJson=function(t){return Z(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,c,u,h,d,f;return J(this,(function(p){switch(p.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=p.sent())._class=Q.ClassValue.Text,n=this.rich.length?this.rich:this._content?[{location:0,length:this._content.length,fontFamily:this.computedStyle.fontFamily,fontSize:this.computedStyle.fontSize,fontWeight:this.computedStyle.fontWeight,letterSpacing:this.computedStyle.letterSpacing,textAlign:this.computedStyle.textAlign,textDecoration:this.computedStyle.textDecoration,lineHeight:this.style.lineHeight.u===zu.AUTO?0:this.computedStyle.lineHeight,paragraphSpacing:this.computedStyle.paragraphSpacing,color:this.computedStyle.color}]:[],r.attributedString={_class:"attributedString",string:this._content,attributes:n.map((function(e){return{_class:"stringAttribute",location:e.location,length:e.length,attributes:{kerning:e.letterSpacing,MSAttributedStringFontAttribute:{_class:"fontDescriptor",attributes:{name:e.fontFamily,size:e.fontSize}},MSAttributedStringColorAttribute:{_class:"color",alpha:e.color[3],red:e.color[0]/255,green:e.color[1]/255,blue:e.color[2]/255},paragraphStyle:{_class:"paragraphStyle",alignment:[Q.TextHorizontalAlignment.Left,Q.TextHorizontalAlignment.Right,Q.TextHorizontalAlignment.Centered,Q.TextHorizontalAlignment.Justified][e.textAlign||0],minimumLineHeight:e.lineHeight,maximumLineHeight:e.lineHeight,paragraphSpacing:e.paragraphSpacing},underlineStyle:e.textDecoration.indexOf(ph.UNDERLINE)>-1?Q.UnderlineStyle.Underlined:Q.UnderlineStyle.None,strikethroughStyle:e.textDecoration.indexOf(ph.LINE_THROUGH)>-1?Q.StrikethroughStyle.Strikethrough:Q.StrikethroughStyle.None}}}))},i=this.style,o=i.left,a=i.right,s=i.top,l=i.bottom,c=i.width,u=i.height,h=c.u===zu.AUTO&&(o.u===zu.AUTO||a.u===zu.AUTO),d=u.u===zu.AUTO&&(s.u===zu.AUTO||l.u===zu.AUTO),r.textBehaviour=h&&d||h?Q.TextBehaviour.Flexible:d?Q.TextBehaviour.Fixed:Q.TextBehaviour.FixedWidthAndHeight,f=this.computedStyle,r.style.textStyle={_class:"textStyle",verticalAlignment:[Q.TextVerticalAlignment.Top,Q.TextVerticalAlignment.Middle,Q.TextVerticalAlignment.Bottom][f.textVerticalAlign],encodedAttributes:{paragraphStyle:{_class:"paragraphStyle",alignment:[Q.TextHorizontalAlignment.Left,Q.TextHorizontalAlignment.Right,Q.TextHorizontalAlignment.Centered,Q.TextHorizontalAlignment.Justified,Q.TextHorizontalAlignment.Natural][f.textAlign]},underlineStyle:f.textDecoration.includes(ph.UNDERLINE)?Q.UnderlineStyle.Underlined:Q.UnderlineStyle.None,strikethroughStyle:f.textDecoration.includes(ph.LINE_THROUGH)?Q.StrikethroughStyle.Strikethrough:Q.StrikethroughStyle.None,kerning:f.letterSpacing,MSAttributedStringFontAttribute:{_class:"fontDescriptor",attributes:{name:f.fontFamily,size:f.fontSize}}}},[2,r]}}))}))},Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){e!==this._content&&(this._content=e,this.refresh(XE.REFLOW))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.lineBoxList.forEach((function(t){t.list.forEach((function(t){var r=t.fontFamily,n=t.fontSize,i=t.lineHeight,o=t.str,a=t.font,s=i;if(Hh.hasRegister(r)){s=Hh.data[r].lhr*n}else{var l=dh.getFontCanvas().ctx;l.font=a;var c=l.measureText(o);s=c.actualBoundingBoxAscent+c.actualBoundingBoxDescent}var u=s-i;if(u>0){var h=.5*u,d=t.y-h,f=t.lineHeight+h;d<0&&(e[1]=Math.min(e[1],d)),e[3]=Math.max(e[3],f)}}))}));var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===eh.INSIDE||(a=o[t]===eh.OUTSIDE?Math.max(a,2*e):Math.max(a,.5*e*2)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),t.setFontAndLetterSpacing=r_,t}(Ow);function r_(e,t,r){1!==r?(e.font=t.font.replace(/([\d.e+-]+)px/gi,(function(e,t){return t*r+"px"})),e.letterSpacing=t.letterSpacing*r+"px"):(e.font=t.font,e.letterSpacing=t.letterSpacing+"px")}var n_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.artBoards=new Mw({name:"overlay-artBoards",uuid:"",index:0,style:{width:"100%",height:"100%",pointerEvents:!1}},[]),n.appendChild(n.artBoards),n.artBoardList=[],n}return p(t,e),t.prototype.setArtBoard=function(e){this.artBoards.clearChildren(),this.artBoardList.splice(0);for(var t=0,r=e.length;t<r;t++){var n=e[t],i="overlay-"+(n.props.name||"画板"),o=new t_({name:i,uuid:"",index:0,style:{fontSize:24,color:n instanceof JS?"#b6e":"#777"},content:n.props.name||"画板"});this.artBoards.appendChild(o),this.artBoardList.push({artBoard:n,text:o})}},t.prototype.updateArtBoard=function(e){for(var t=this.artBoardList,r=0,n=t.length;r<n;r++)if(t[r].artBoard===e){t[r].text.content=e.props.name||"画板";break}},t.prototype.removeArtBoard=function(e){for(var t=this.artBoardList,r=0,n=t.length;r<n;r++)if(t[r].artBoard===e){t.splice(r,1),this.artBoards.removeChild(this.artBoards.children[r]);break}},t.prototype.update=function(){for(var e=this.artBoardList,t=0,r=e.length;t<r;t++){var n=e[t],i=n.artBoard,o=n.text,a=i._rect||i.rect,s=yd({x:a[0],y:a[1]},i.matrixWorld);o.updateStyleData({translateX:s.x,translateY:s.y-32}).length&&o.calMatrix(XE.TRANSLATE)}},t}(Mw),i_=function(e){function t(t,r){var n=this,i=t.overrideValues||{};return(n=e.call(this,t,r.children.map((function(e){return e.clone(i)})))||this).isSymbolInstance=!0,n.symbolMaster=r,n.symbolInstance=n,r.addSymbolInstance(n),n}return p(t,e),t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=this.symbolMaster.clone(e),i=new t(r,n);return n.addSymbolInstance(i),i.style=Iu(this.style),i.computedStyle=Iu(this.computedStyle),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.SYMBOL_INSTANCE,t},t}(WS);function o_(e,t){var r=e.tagName;if(r===s.ART_BOARD||r===s.SYMBOL_MASTER){for(var n=[],i=0,o=e.children.length;i<o;i++){(h=o_(e.children[i],t))&&n.push(h)}if(r===s.SYMBOL_MASTER){var a=(l=e.props).symbolId;return(null==t?void 0:t.symbolMasters[a])||new JS(l,n)}return new kw(e.props,n)}if(r===s.SYMBOL_INSTANCE){a=(l=e.props).symbolId;var l,c=null==t?void 0:t.symbolMasters[a];if(c)return new i_(l,c)}else{if(r===s.GROUP){n=[];var u=e.children||[];for(i=0,o=u.length;i<o;i++){(h=o_(u[i],t))&&n.push(h)}return new WS(e.props,n)}if(r===s.BITMAP)return new Fw(e.props);if(r===s.TEXT)return new t_(e.props);if(r===s.POLYLINE)return new Jw(e.props);if(r===s.SHAPE_GROUP){for(n=[],i=0,o=e.children.length;i<o;i++){var h;(h=o_(e.children[i],t))&&n.push(h)}return new rC(e.props,n)}if(r===s.SLICE)return new Lw(e.props)}}function a_(e){var t={};return e.forEach((function(e){s_(e.props.symbolId,e.children||[],t)})),e.sort((function(e,r){var n=e.props.symbolId,i=r.props.symbolId;return t[n]===i?-1:t[i]===n?1:0})),e}function s_(e,t,r){t.forEach((function(t){if(t.tagName===s.SYMBOL_MASTER){var n=t.props.symbolId;r[n]=e,s_(n,t.children||[],r)}else if(t.tagName===s.SYMBOL_INSTANCE)r[t.props.symbolId]=e;else if(t.tagName===s.GROUP){var i=t.children||[];s_(e,i,r)}}))}var l_={parse:o_,sortSymbolMasters:a_},c_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isPage=!0,n.page=n,n}return p(t,e),t.prototype.initIfNot=function(){if(this.json){for(var e=0,t=this.json.children,r=t.length;e<r;e++){var n=o_(t[e],this.root);n&&this.appendChild(n)}return this.json=void 0,!0}return!1},t.prototype.zoomTo=function(e,t,r){if(void 0===t&&(t=.5),void 0===r&&(r=.5),this.root&&!this.isDestroyed){var n=this.getComputedStyle(),i=n.translateX,o=n.translateY;if(n.scaleX!==e){var a=sd(this.matrixWorld),s=this.root,l=s.width,c=s.height,u=s.dpi,h={x:t*l/u*u,y:r*c/u*u},d=yd(h,a),f=yd(d,Id(Yf({translateX:i,translateY:o,scaleX:e,scaleY:e}))),p=f.x-h.x/u,v=f.y-h.y/u;this.updateStyle({translateX:i-p,translateY:o-v,scaleX:e,scaleY:e})}}else this.updateStyle({scaleX:e,scaleY:e})},t.prototype.zoomActual=function(){return this.updateStyle({scaleX:1,scaleY:1}).keys.length>0},t.prototype.zoomFit=function(){var e=this.children;if(e.length&&this.root){for(var t=e[0],r=t.rect,n=r[0],i=r[1],o=r[2],a=r[3],s=t.matrix,l=yd({x:n,y:i},s),c=yd({x:n,y:a},s),u=yd({x:o,y:i},s),h=yd({x:o,y:a},s),d=Math.min(l.x,c.x,u.x,h.x),f=Math.min(l.y,c.y,u.y,h.y),p=Math.max(l.x,c.x,u.x,h.x),v=Math.max(l.y,c.y,u.y,h.y),y=1,g=e.length;y<g;y++){var m=e[y],b=m.rect,x=b[0],E=b[1],w=b[2],S=b[3],_=m.matrix,C=yd({x:x,y:E},_),A=yd({x:x,y:S},_),T=yd({x:w,y:E},_),O=yd({x:w,y:S},_);d=Math.min(d,C.x,A.x,T.x,O.x),f=Math.min(f,C.y,A.y,T.y,O.y),p=Math.max(p,C.x,A.x,T.x,O.x),v=Math.max(v,C.y,A.y,T.y,O.y)}var M=p-d,k=v-f;if(M&&k){var L=d-.05*M,R=f-.05*k;M*=1.1,k*=1.1;var I=this.root,P=I.width,F=I.height,D=I.dpi,N=(P=Math.max(P,100)/D)/M,B=(F=Math.max(F,100)/D)/k;return N>=B?this.updateStyle({translateX:-L*B-.5*(M*B-P),translateY:-R*B,scaleX:B,scaleY:B}):this.updateStyle({translateX:-L*N,translateY:-R*N-.5*(k*N-F),scaleX:N,scaleY:N}),!0}}},t.prototype.getZoom=function(e){void 0===e&&(e=!1);var t=this.computedStyle.scaleX;return!e&&this.root?t*this.root.dpi:t},t.prototype.clone=function(e){var r=Iu(this.props);r.uuid=a(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Iu(this.style),n.computedStyle=Iu(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.PAGE,t},t.prototype.toSketchJson=function(t,r){return Z(this,void 0,void 0,(function(){var n,i;return J(this,(function(o){switch(o.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=o.sent())._class=Q.ClassValue.Page,n.hasClickThrough=!0,n.horizontalRulerData={_class:"rulerData",base:0,guides:[]},n.verticalRulerData={_class:"rulerData",base:0,guides:[]},[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t,r)})))];case 2:return i=o.sent(),n.layers=i.map((function(e){return e})),[2,n]}}))}))},t}(Mw);function u_(e,t,r){var n=e.parent;r?(e.checkPosSizeUpward(),e.clearCacheUpward(!1),e.destroy()):(e.layout({w:n.width,h:n.height}),e.checkPosSizeUpward(),e.clearCacheUpward(!1))}var h_,d_={checkReflow:u_},f_=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this,t,r)||this;return n.ani=[],n.aniChange=!1,n.dpi=t.dpi,n.root=n,n.programs={},n.refs={},n.symbolMasters={},n.structs=[],n.isAsyncDraw=!1,n.task=[],n.taskClone=[],n.rl=XE.REBUILD,n.imgLoadingCount=0,n.imgLoadList=[],n.firstDraw=!0,n.tileRecord={},n.tileLastIndex=0,n.tileRemain=!1,n.breakMerge=!1,n.scale=1,n.scaleIndex=0,n.pageContainer=new Mw({name:"pageContainer",uuid:"pageContainer",index:0,style:{width:"100%",height:"100%",pointerEvents:!1,scaleX:n.dpi,scaleY:n.dpi,transformOrigin:[0,0]}},[]),n.overlay=new n_({name:"overlay",uuid:"overlay",index:1,style:{width:"100%",height:"100%",pointerEvents:!1}},[]),n.appendChild(n.pageContainer),n.appendChild(n.overlay),n}return p(t,e),t.prototype.appendTo=function(e){this.canvas=e;var t=Object.assign(VS,this.props.contextAttributes),r=e.getContext("webgl2",t);if(r?this.isWebgl2=!0:(r=e.getContext("webgl",t),this.isWebgl2=!1),!r)throw new Error("Webgl unsupported!");this.appendToGl(r)},t.prototype.appendToGl=function(e){this.ctx?dh.error("Duplicate appendToGl"):(this.ctx=e,bu.init(e.getParameter(e.MAX_TEXTURE_SIZE),e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),e.getParameter(e.MAX_VARYING_VECTORS)),this.initShaders(e),this.tileManager=new _w(e),this.willMount(),this.structs=this.structure(0),qS.addRoot(this),this.reLayout(),this.didMount(),this.addUpdate(this,[],XE.REFLOW))},t.prototype.initShaders=function(e){var t=this.programs.program=nw(e,"#define GLSLIFY 1\nattribute vec2 a_position;varying vec4 v_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;attribute float a_opacity;varying float v_opacity;void main(){gl_Position=vec4(a_position,0,1);v_position=gl_Position;v_texCoords=a_texCoords;v_opacity=a_opacity;}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;varying vec2 v_texCoords;varying float v_opacity;uniform float x1;uniform float y1;uniform float x2;uniform float y2;uniform sampler2D u_texture;void main(){if(v_position.x<x1||v_position.x>x2||v_position.y<y1||v_position.y>y2){discard;}float opacity=v_opacity;if(opacity<=0.0){discard;}opacity=clamp(opacity,0.0,1.0);vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color*opacity;}");this.programs.bgColorProgram=nw(e,"#define GLSLIFY 1\nattribute vec2 a_position;void main(){gl_Position=vec4(a_position,0,1);}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nuniform vec4 u_color;void main(){gl_FragColor=u_color;}"),this.programs.bgShadowProgram=nw(e,"#define GLSLIFY 1\nattribute vec2 a_position;varying vec2 v_position;void main(){gl_Position=vec4(a_position,0,1);v_position=a_position;}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nuniform vec2 u_tl;uniform vec2 u_br;uniform vec2 u_radius;uniform vec4 u_color;varying vec2 v_position;void main(){if(v_position.x<u_tl.x&&v_position.y<u_tl.y){float dx=abs(v_position.x-u_tl.x);float dy=abs(v_position.y-u_tl.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x<u_tl.x&&v_position.y>u_br.y){float dx=abs(v_position.x-u_tl.x);float dy=abs(v_position.y-u_br.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x>u_br.x&&v_position.y>u_br.y){float dx=abs(v_position.x-u_br.x);float dy=abs(v_position.y-u_br.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x>u_br.x&&v_position.y<u_tl.y){float dx=abs(v_position.x-u_br.x);float dy=abs(v_position.y-u_tl.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x<u_tl.x){float d=abs(v_position.x-u_tl.x);if(d<=u_radius.x){float a=(u_radius.x-d)/u_radius.x;gl_FragColor=u_color*a*a;}}else if(v_position.y>u_br.y){float d=abs(v_position.y-u_br.y);if(d<=u_radius.y){float a=(u_radius.y-d)/u_radius.y;gl_FragColor=u_color*a*a;}}else if(v_position.x>u_br.x){float d=abs(v_position.x-u_br.x);if(d<=u_radius.x){float a=(u_radius.x-d)/u_radius.x;gl_FragColor=u_color*a*a;}}else if(v_position.y<u_tl.y){float d=abs(v_position.y-u_tl.y);if(d<=u_radius.y){float a=(u_radius.y-d)/u_radius.y;gl_FragColor=u_color*a*a;}}}"),this.programs.simpleProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color;}"),this.programs.maskProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a<=0.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}gl_FragColor=color2*color1.a;}"),this.programs.maskGrayProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;uniform vec2 u_d;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a<=0.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords+u_d);if(color2.a<=0.0){discard;}float gray=max(color1.r,max(color1.g,color1.b));gl_FragColor=color2*color1.a*gray;}"),this.programs.clipProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a>=1.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}gl_FragColor=color2*(1.0-color1.a);}"),this.programs.multiplyProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return((1.0-a2/a3)*c1*255.0+a2/a3*((1.0-a1)*c2*255.0+a1*c3*255.0))/255.0;}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=bottom*top;float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.screenProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.overlayProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(top.r,bottom.r),op(top.g,bottom.g),op(top.b,bottom.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.darkenProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return min(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.lightenProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return max(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorDodgeProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==1.0){return a==0.0 ? a : 1.0;}return min(1.0,a/(1.0-b));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorBurnProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==0.0){return a==1.0 ? a : 0.0;}return 1.0-min(1.0,(1.0-a)/b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.hardLightProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.softLightProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5? a-(1.0-2.0*b)*a*(1.0-a): a+(2.0*b-1.0)*((a<=0.25?((16.0*a-12.0)*a+4.0)*a: sqrt(a))-a);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.differenceProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return abs(a-b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.exclusionProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-2.0*a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.hueProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(a);float l=getLuminosity(a);return setLuminosity(setSaturation(b,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.saturationProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(b);float l=getLuminosity(a);return setLuminosity(setSaturation(a,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(a);return setLuminosity(b,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.luminosityProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(b);return setLuminosity(a,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.dropShadowProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_color;void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a<=0.0){discard;}gl_FragColor=u_color*c.a;}"),this.programs.innerShadowProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_color;void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){discard;}gl_FragColor=u_color;}"),this.programs.tintProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_tint;void main(){vec4 color=texture2D(u_texture,v_texCoords);if(color.a<=0.0){discard;}gl_FragColor=u_tint*color.a;}"),this.programs.cmProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_m[20];void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){c.rgb/=c.a;}vec4 result;result.r=(u_m[0]*c.r);result.r+=(u_m[1]*c.g);result.r+=(u_m[2]*c.b);result.r+=(u_m[3]*c.a);result.r+=u_m[4];result.g=(u_m[5]*c.r);result.g+=(u_m[6]*c.g);result.g+=(u_m[7]*c.b);result.g+=(u_m[8]*c.a);result.g+=u_m[9];result.b=(u_m[10]*c.r);result.b+=(u_m[11]*c.g);result.b+=(u_m[12]*c.b);result.b+=(u_m[13]*c.a);result.b+=u_m[14];result.a=(u_m[15]*c.r);result.a+=(u_m[16]*c.g);result.a+=(u_m[17]*c.b);result.a+=(u_m[18]*c.a);result.a+=u_m[19];gl_FragColor=vec4(result.rgb*result.a,result.a);}"),this.programs.boxProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_pw;uniform float u_ph;uniform int u_r;uniform int u_direction;const int MAX_KERNEL_SIZE=2048;void main(){vec4 color=texture2D(u_texture,v_texCoords);float total=1.0;if(u_r==0){if(u_direction==0){color+=texture2D(u_texture,vec2(v_texCoords.x+u_pw,v_texCoords.y))*0.125;color+=texture2D(u_texture,vec2(v_texCoords.x-u_pw,v_texCoords.y))*0.125;}else{color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y+u_ph))*0.125;color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y-u_ph))*0.125;}total+=0.25;}else{for(int i=1;i<MAX_KERNEL_SIZE;i++){if(u_direction==0){float offset=float(i)*u_pw;color+=texture2D(u_texture,vec2(v_texCoords.x+offset,v_texCoords.y));color+=texture2D(u_texture,vec2(v_texCoords.x-offset,v_texCoords.y));}else{float offset=float(i)*u_ph;color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y+offset));color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y-offset));}total+=2.0;if(i>=u_r){break;}}}gl_FragColor=color/total;}"),this.programs.dualDownProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform float u_x;uniform float u_y;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords)*4.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,u_y));color+=texture2D(u_texture,v_texCoords+vec2(u_x,-u_y));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,u_y));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,-u_y));gl_FragColor=color*0.125;}"),this.programs.dualUpProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform float u_x;uniform float u_y;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords+vec2(u_x,u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,-u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(-u_x,u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(-u_x,-u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,0.0));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,0.0));color+=texture2D(u_texture,v_texCoords+vec2(0.0,u_y));color+=texture2D(u_texture,v_texCoords+vec2(0.0,-u_y));gl_FragColor=color/12.0;}"),this.programs.motionProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform int u_kernel;uniform vec2 u_velocity;const int MAX_KERNEL_SIZE=2048;void main(void){vec4 color=texture2D(u_texture,v_texCoords);int k=u_kernel-1;for(int i=1;i<MAX_KERNEL_SIZE-1;i++){if(i==k){break;}vec2 bias=u_velocity*(float(i)/float(k)-0.5);color+=texture2D(u_texture,v_texCoords+bias);}gl_FragColor=color/float(k);}"),this.programs.radialProgram=nw(e,KS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform int u_kernel;uniform vec2 u_center;uniform float u_ratio;const int MAX_KERNEL_SIZE=2048;void main(void){if(v_texCoords.x==u_center.x&&v_texCoords.y==u_center.y){gl_FragColor=texture2D(u_texture,v_texCoords);return;}vec4 color=texture2D(u_texture,v_texCoords);int k=u_kernel-1;float total=1.0;for(int i=1;i<MAX_KERNEL_SIZE-1;i++){if(i==k){break;}total++;vec2 velocity=-(v_texCoords-u_center)*u_ratio;vec2 bias=velocity*(float(i)/float(k));color+=texture2D(u_texture,v_texCoords+bias);}gl_FragColor=color/total;}"),this.programs.tileProgram=nw(e,ZS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;uniform float u_x1;uniform float u_y1;uniform float u_x2;uniform float u_y2;uniform float u_width;uniform float u_height;uniform int u_count;void main(){if(v_position.x>u_x1+u_width&&v_position.x<u_x2-u_width&&v_position.y>u_y1+u_height&&v_position.y<u_y2-u_height){if(u_count==0){gl_FragColor+=vec4(0.0,0.0,0.5,0.1);}else{gl_FragColor+=vec4(0.0,0.0,0.0,0.1);}}if(v_position.x>=u_x1-u_width&&v_position.x<=u_x1+u_width&&v_position.y>=u_y1&&v_position.y<=u_y2){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.x>=u_x2-u_width&&v_position.x<=u_x2+u_width&&v_position.y>=u_y1&&v_position.y<=u_y2){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.y>=u_y1-u_height&&v_position.y<=u_y1+u_height&&v_position.x>=u_x1+u_width&&v_position.x<=u_x2-u_width){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.y>=u_y2-u_height&&v_position.y<=u_y2+u_height&&v_position.x>=u_x1+u_width&&v_position.x<=u_x2-u_width){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}}"),this.programs.sliceProgram=nw(e,ZS,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;uniform float u_x1;uniform float u_y1;uniform float u_x2;uniform float u_y2;uniform float u_width;uniform float u_height;void main(){if(v_position.x>=u_x1&&v_position.x<=u_x1+u_width*2.0&&v_position.y>=u_y1&&v_position.y<=u_y2){if(v_position.y<=u_y1+u_height*2.0||v_position.y>=u_y2-u_height*2.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int y=int((v_position.y-u_y1+u_height)/u_height);int p=int(y/12);if(y-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.x>=u_x2-u_width*2.0&&v_position.x<=u_x2&&v_position.y>=u_y1&&v_position.y<=u_y2){if(v_position.y<u_y1+u_height*2.0||v_position.y>u_y2-u_height*2.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int y=int((v_position.y-u_y1+u_height)/u_height);int p=int(y/12);if(y-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.y>=u_y1&&v_position.y<=u_y1+u_height*2.0&&v_position.x>=u_x1+u_width*2.0&&v_position.x<=u_x2-u_width*2.0){if(v_position.x<u_x1+u_width*4.0||v_position.x>u_x2-u_width*4.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int x=int((v_position.x-u_x1+u_width)/u_width);int p=int(x/12);if(x-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.y>=u_y2-u_height*2.0&&v_position.y<=u_y2&&v_position.x>=u_x1+u_width*2.0&&v_position.x<=u_x2-u_width*2.0){if(v_position.x<u_x1+u_width*4.0||v_position.x>u_x2-u_width*4.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int x=int((v_position.x-u_x1+u_width)/u_width);int p=int(x/12);if(x-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}}"),e.useProgram(t)},t.prototype.checkRoot=function(){var e,t=this.style,r=t.width,n=t.height,i=this.canvas;r.u===zu.AUTO?i&&(r.u=zu.PX,this.width=this.computedStyle.width=r.v=Math.max(1,i.width)):this.width=this.computedStyle.width=Math.max(1,this.style.width.v),n.u===zu.AUTO?i&&(n.u=zu.PX,this.height=this.computedStyle.height=n.v=Math.max(1,i.height)):this.height=this.computedStyle.height=Math.max(1,this.style.height.v),null===(e=this.ctx)||void 0===e||e.viewport(0,0,this.width,this.height)},t.prototype.setJPages=function(e){var t=this;this.pageContainer.clearChildren(),this.lastPage=void 0,e.forEach((function(e){var r=new c_(e.props,[]);r.json=e,t.pageContainer.appendChild(r)}))},t.prototype.setPages=function(e){var t=this;this.pageContainer.clearChildren(),this.lastPage=void 0,e.forEach((function(e){return t.pageContainer.appendChild(e)}))},t.prototype.getPageIndex=function(){for(var e=this.pageContainer.children,t=0,r=e.length;t<r;t++)if(this.lastPage===e[t])return t;return-1},t.prototype.setPageIndex=function(e){if(!(e<0||e>=this.pageContainer.children.length)){if(this.lastPage){if(this.lastPage===this.pageContainer.children[e])return;this.lastPage.updateStyle({visibility:"hidden"})}this.lastPage=void 0;var t=this.pageContainer.children[e];t.initIfNot(),t.updateStyle({visibility:"visible"}),this.lastPage=t;var r=[];return t.children.forEach((function(e){e instanceof kw&&r.push(e)})),this.overlay.setArtBoard(r),t}},t.prototype.addUpdate=function(e,t,r,n,i,o){if(void 0===r&&(r=XE.NONE),void 0===n&&(n=!1),void 0===i&&(i=!1),this.isDestroyed)return XE.NONE;e===this&&this.pageTexture&&(t.indexOf("width")>-1||t.indexOf("height")>-1)&&(this.ctx.deleteTexture(this.pageTexture),this.pageTexture=void 0);var a=r;if(t&&t.length)for(var s=0,l=t.length;s<l;s++){a|=KE(t[s])}if(i){e instanceof kw&&this.overlay.removeArtBoard(e),this.emit(Tw.WILL_REMOVE_DOM,e);var c=e.props.uuid;c&&this.tileRecord[c]&&delete this.tileRecord[c]}return(n||i)&&(a|=XE.REFLOW|XE.REBUILD),this.calUpdate(e,a,n,i)?this.asyncDraw(o):(o&&o(!0),this.imgLoadingCount||this.breakMerge||this.tileRemain||this.emit(Tw.REFRESH_COMPLETE,XE.NONE)),this.lastPage&&e.page&&(n?this.emit(Tw.DID_ADD_DOM,e):!i&&t.length&&this.emit(Tw.STYLE_CHANGED,e,t)),a},t.prototype.calUpdate=function(e,t,r,n){if(t===XE.NONE||this.isDestroyed)return!1;var i=bu.tile&&!this.firstDraw&&!e.isPage;if(i&&t>XE.CACHE&&Sw.clean(e.cleanTile()),qE(t))e===this?this.reLayout():(u_(e,0,n),i&&r&&(this.tileRecord[e.props.uuid]=e));else{if(t>=XE.REPAINT)e.calRepaintStyle(t);else{var o=e.style,a=e.computedStyle;t&XE.TRANSFORM_ALL&&e.calMatrix(t),t&(XE.TRANSLATE|XE.ROTATE_Z)&&(e.checkPosSizeUpward(),i&&(this.tileRecord[e.props.uuid]=e)),t&XE.OPACITY&&e.calOpacity(),t&XE.FILTER&&(e.calFilter(t),i&&(this.tileRecord[e.props.uuid]=e)),t&XE.MIX_BLEND_MODE&&(a.mixBlendMode=o.mixBlendMode.v);var s=!1;if(t&XE.MASK&&(a.maskMode=o.maskMode.v,e.clearMask(!0),s=!0,e.checkPosSizeUpward(),e.calMask(),i))for(var l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Ju.NONE;)a.maskMode!==Ju.NONE?Sw.clean(l.cleanTile()):this.tileRecord[l.props.uuid]=l,l=l.next;if(t&XE.BREAK_MASK){a.breakMask=o.breakMask.v;var c=e.mask;e.calMask();var u=e.mask;if(a.breakMask&&c){if(c.clearMask(!0),c.checkPosSizeUpward(),i&&!a.maskMode){this.tileRecord[e.props.uuid]=e;for(l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Ju.NONE;)this.tileRecord[l.props.uuid]=l,l=l.next}}else if(!a.breakMask&&u){if(i&&!a.maskMode){Sw.clean(e.cleanTile());for(l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Ju.NONE;)Sw.clean(l.cleanTile()),l=l.next}}else t&=XE.FULL^XE.BREAK_MASK;if(!a.breakMask||c)for(var h=e.prev;h;){if(h.computedStyle.maskMode){h.clearMask(!0);break}if(h.computedStyle.breakMask)break;h=h.prev}}a.maskMode&&!s&&t>XE.CACHE&&e.clearMask(!0)}e.clearCacheUpward(!1)}var d=e.mask;if(!(d&&t>XE.CACHE)||t&XE.MASK||t&XE.BREAK_MASK||(d.checkPosSizeUpward(),d.clearMask()),e.refreshLevel|=t,this.rl|=t,t&XE.CACHE)return!0;for(var f=e.parent;f;){if(f.computedStyle.visibility===rh.HIDDEN)return!1;f=f.parent}return t>XE.NONE},t.prototype.asyncDraw=function(e){this.isAsyncDraw||(qS.onFrame(this),this.isAsyncDraw=!0),this.task.push(e)},t.prototype.cancelAsyncDraw=function(e){if(e){var t=this.task,r=t.indexOf(e);r>-1&&(t.splice(r,1),t.length||(qS.offFrame(this),this.isAsyncDraw=!1))}},t.prototype.draw=function(){if(!this.isDestroyed){this.tileRemain=!1,this.breakMerge=!1;var e=this.rl;e>XE.NONE&&(e>XE.CACHE&&(this.tileLastIndex=0),this.clear(),this.rl=XE.NONE,_C(this.ctx,this),this.emit(Tw.REFRESH,e),this.firstDraw=!1),this.imgLoadingCount||this.breakMerge||this.tileRemain||this.emit(Tw.REFRESH_COMPLETE,e)}},t.prototype.reLayout=function(){this.checkRoot(),this.layout({w:this.width,h:this.height})},t.prototype.clear=function(){var e=this.ctx;e&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT))},t.prototype.destroy=function(){var t;e.prototype.destroy.call(this),qS.removeRoot(this),this.task.splice(0),this.taskClone.splice(0);var r=this.ctx,n=this.programs;if(r){for(var i in r.deleteProgram(n.program),r.deleteProgram(n.bgColorProgram),r.deleteProgram(n.bgShadowProgram),r.deleteProgram(n.simpleProgram),r.deleteProgram(n.maskProgram),r.deleteProgram(n.maskGrayProgram),r.deleteProgram(n.clipProgram),r.deleteProgram(n.multiplyProgram),r.deleteProgram(n.screenProgram),r.deleteProgram(n.overlayProgram),r.deleteProgram(n.darkenProgram),r.deleteProgram(n.lightenProgram),r.deleteProgram(n.colorDodgeProgram),r.deleteProgram(n.colorBurnProgram),r.deleteProgram(n.hardLightProgram),r.deleteProgram(n.softLightProgram),r.deleteProgram(n.differenceProgram),r.deleteProgram(n.exclusionProgram),r.deleteProgram(n.hueProgram),r.deleteProgram(n.saturationProgram),r.deleteProgram(n.colorProgram),r.deleteProgram(n.luminosityProgram),r.deleteProgram(n.dropShadowProgram),r.deleteProgram(n.innerShadowProgram),r.deleteProgram(n.gaussBlurProgram),r.deleteProgram(n.tintProgram),r.deleteProgram(n.cmProgram),r.deleteProgram(n.boxProgram),r.deleteProgram(n.dualDownProgram),r.deleteProgram(n.dualUpProgram),r.deleteProgram(n.motionProgram),r.deleteProgram(n.radialProgram),r.deleteProgram(n.tileProgram),r.deleteProgram(n.sliceProgram),r)if(0===i.indexOf("programGauss,")){var o=n[i];r.deleteProgram(o)}r.bindTexture(r.TEXTURE_2D,null),null===(t=r.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext()}},t.prototype.before=function(){var e=this.ani,t=this.taskClone=this.task.splice(0);e.length;var r=t.length;this.aniChange=!1,(this.aniChange||r)&&this.draw()},t.prototype.after=function(){for(var e=this.ani,t=this.taskClone.splice(0),r=e.length,n=t.length,i=0;i<r;i++);for(i=0;i<n;i++){var o=t[i];o&&o(!1)}r=e.length,n=this.task.length,r||n||(qS.offFrame(this),this.isAsyncDraw=!1)},t.prototype.getPages=function(){return this.pageContainer.children},t.prototype.getCurPage=function(){return this.lastPage},t.prototype.getCurPageWithCreate=function(){if(this.lastPage)return this.lastPage;if(this.pageContainer.children.length){var e=this.pageContainer.children[0];return this.setCurPage(e),e}var t=this.addNewPage();return this.setCurPage(t),t},t.prototype.addNewPage=function(e){var t=this.pageContainer;return e||(e=new c_({uuid:a(),index:t.children.length,name:"页面 "+(t.children.length+1),style:{width:100,height:100,visibility:"hidden",transformOrigin:[0,0],pointerEvents:!1},rule:{baseX:0,baseY:0},isLocked:!1,isExpanded:!1},[])),t.appendChild(e),e},t.prototype.setCurPage=function(e){var t=this.pageContainer.children.indexOf(e);this.setPageIndex(t)},t.prototype.getCurPageStructs=function(){var e=this.structs,t=this.lastPage;if(t){var r=t.struct,n=e.indexOf(r);if(-1===n)throw new Error("Unknown index error");return e.slice(n,n+r.total+1)}},t.prototype.getCurPageZoom=function(e){return void 0===e&&(e=!1),this.lastPage?this.lastPage.getZoom(e):this.dpi},t.prototype.zoomTo=function(e,t,r){var n;null===(n=this.lastPage)||void 0===n||n.zoomTo(e,t,r)},t.prototype.zoomActual=function(){var e;return null===(e=this.lastPage)||void 0===e?void 0:e.zoomActual()},t.prototype.zoomFit=function(){var e;return null===(e=this.lastPage)||void 0===e?void 0:e.zoomFit()},t.prototype.toSketchFile=function(e){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,s,l,c,u,h,d,f;return J(this,(function(p){switch(p.label){case 0:return this.isDestroyed&&(this.willMount(),this.reLayout(),this.didMount()),t=new yu,r=t.folder("pages"),n=t.folder("images"),i=this.props,o={},s=[],l={document:{pageListHeight:100,pageListCollapsed:0}},this.pageContainer.children.forEach((function(e){var t=e,r=t.props.uuid;s.push({_class:"MSJSONFileReference",_ref_class:"MSImmutablePage",_ref:"pages/"+r}),l[r]={scrollOrigin:"{"+t.computedStyle.translateX+", "+t.computedStyle.translateY+"}",zoomValue:t.getZoom(!0)},o[r]={name:t.props.name||"",artboards:{}},t.children.forEach((function(e){if(e instanceof kw){var t=e.props.uuid;o[r].artboards[t]={name:e.props.name||""}}}))})),r&&n?[4,Promise.all(this.pageContainer.children.map((function(r){return r.toSketchJson(t,e)})))]:[3,2];case 1:p.sent().forEach((function(e){r.file(e.do_objectID+".json",JSON.stringify(e))})),p.label=2;case 2:return c={commit:"",pagesAndArtboards:o,version:146,compatibilityVersion:99,app:Q.BundleId.PublicRelease,autosaved:0,variant:"NONAPPSTORE",created:{commit:"",appVersion:"99.1",build:0,app:Q.BundleId.PublicRelease,coeditCompatibilityVersion:145,compatibilityVersion:99,version:146,variant:"NONAPPSTORE"},saveHistory:[],appVersion:"99.1",build:0},u={_class:"document",do_objectID:i.uuid||a(),assets:{_class:"assetCollection",do_objectID:(null===(h=i.assets)||void 0===h?void 0:h.uuid)||a(),colorAssets:[],gradientAssets:[],images:[],colors:[],gradients:[],exportPresets:[]},colorSpace:Q.ColorSpace.Unmanaged,currentPageIndex:this.getPageIndex(),foreignLayerStyles:[],foreignSymbols:[],foreignTextStyles:[],foreignSwatches:[],layerStyles:{_class:"sharedStyleContainer",do_objectID:(null===(d=i.layerStyles)||void 0===d?void 0:d.uuid)||a(),objects:[]},layerTextStyles:{_class:"sharedTextStyleContainer",do_objectID:(null===(f=i.layerTextStyles)||void 0===f?void 0:f.uuid)||a(),objects:[]},perDocumentLibraries:[],pages:s},t.file("meta.json",JSON.stringify(c)),t.file("user.json",JSON.stringify(l)),t.file("document.json",JSON.stringify(u)),[2,t]}}))}))},t}(Mw);function p_(e,t,r){if(void 0===r&&(r=h_.APPEND),e.length)if(e.indexOf(t)>-1)dh.error("Can not moveTo self");else{var n=t.parent,i=t.artBoard;n instanceof WS&&(n.fixedPosAndSize=!0);for(var o=0,a=e.length;o<a;o++){var s=e[o];if(r===h_.BEFORE){n&&b_(n,s),t.insertBefore(s);var l=t.prev;s.props.index=.5*(((null==l?void 0:l.props.index)||0)+t.props.index)}else if(r===h_.AFTER){n&&b_(n,s),t.insertAfter(s);var c=t.next;s.props.index=.5*(((null==c?void 0:c.props.index)||1)+t.props.index)}else if(t instanceof Mw)if(b_(t,s),r===h_.PREPEND){t.prependChild(s);c=s.next;s.props.index=.5*((null==c?void 0:c.props.index)||1)}else{t.appendChild(s);l=s.prev;s.props.index=.5*(((null==l?void 0:l.props.index)||0)+1)}s.artBoard=i}n instanceof WS&&(n.fixedPosAndSize=!1,n.checkPosSizeSelf())}}function v_(e,t){p_(e,t,h_.APPEND)}function y_(e,t){p_(e,t,h_.AFTER)}function g_(e){var t=e.computedStyle,r=t.scaleX,n=t.scaleY,i=t.rotateZ,o=t.transformOrigin;if(r>=0||n>=0)return e.matrix;var a=nd(),s=e.transform;return a[12]=s[12],a[13]=s[13],i&&dd(a,xd(i)),Rd(a,o[0],o[1])}function m_(e,t){if(void 0===t&&(t=!1),!e.page)throw new Error("Node not on a Page");if(e.isPage&&e instanceof c_)return nd();for(var r=e.page,n=e.parent,i=[];n&&n!==r;)i.push(n),n=n.parent;for(var o=nd();i.length;){var a=i.pop();o=od(o,t?g_(a):a.matrix)}return o=od(o,t?g_(e):e.matrix)}function b_(e,t){if(t.parent!==e){var r=e.width,n=e.height,i=m_(e),o=e.computedStyle,a=o.scaleX,s=o.scaleY,l=0;if(-1===a){var c=nd();fd(c,a);var u=e.computedStyle.transformOrigin,h=od(i,Rd(c,u[0],u[1]));l=Math.acos(h[0])}else l=Math.acos(i[0]);var d=yd({x:0,y:0},i),f=yd({x:e.width,y:0},i),p=yd({x:0,y:e.height},i),v={x:f.x-d.x,y:f.y-d.y},y={x:p.x-d.x,y:p.y-d.y},g=nd(),m=function(e){if(!e.page)throw new Error("Node not on a Page");if(e.isPage&&e instanceof c_)return{x:1,y:1};for(var t=e.computedStyle.scaleX,r=e.computedStyle.scaleY,n=e.page,i=e.parent;i&&i!==n;)t*=i.computedStyle.scaleX,r*=i.computedStyle.scaleY,i=i.parent;return{x:t,y:r}}(t);1!==m.x&&fd(g,m.x),1!==m.y&&fd(g,m.y);var b=m_(t,!0),x=Math.acos(b[0])-l;dd(g,-x),-1===a&&fd(g,a),-1===s&&pd(g,s);var E=t.computedStyle.transformOrigin,w=od(b,Rd(g,E[0],E[1])),S=yd({x:-t.computedStyle.translateX,y:-t.computedStyle.translateY},w),_={x:S.x-d.x,y:S.y-d.y},C=qh(_.x,_.y,v.x,v.y),A=qh(_.x,_.y,y.x,y.y),T=Kh(C.x,C.y),O=Kh(A.x,A.y),M=Vh(_.x,_.y,v.x,v.y),k=Vh(_.x,_.y,y.x,y.y),L=.5*Math.PI;M<=L&&k<=L||(M<=L?O=-O:k<=L?T=-T:(T=-T,O=-O));var R=t.style,I=R.left.u===zu.PX,P=R.right.u===zu.PX,F=R.top.u===zu.PX,D=R.bottom.u===zu.PX,N=R.width.u===zu.PX,B=R.height.u===zu.PX;I?(R.left.v=T,P?R.right.v=r-T-t.width:N||(R.right.v=100*(r-T-t.width)/r)):P?(R.right.v=r-T-t.width,N||(R.left.v=100*(r-R.right.v-t.width)/r)):N||R.left.u===zu.PERCENT&&R.right.u===zu.AUTO?R.left.v=100*T/r:(R.left.v=100*T/r,R.right.v=100*(r-T-t.width)/r),F?(R.top.v=O,D?R.bottom.v=n-O-t.height:B||(R.bottom.v=100*(n-O-t.height)/n)):D?(R.bottom.v=n-O-t.height,B||(R.top.v=100*(n-R.bottom.v-t.height)/n)):B||R.top.u===zu.PERCENT&&R.bottom.u===zu.AUTO?R.top.v=100*O/n:(R.top.v=100*O/n,R.bottom.v=100*(n-O-t.height)/n),R.rotateZ.v=Ed(x),R.scaleX.v=m.x*(-1===a?-1:1),R.scaleY.v=m.y*(-1===s?-1:1)}}function x_(e){if(e.length&&e[0].root){for(var t=e[0].root.structs,r=0,n=e.length;r<n;r++){var i=e[r];if(i.isDestroyed)throw new Error("Can not group a destroyed Node");i.tempIndex=t.indexOf(i.struct)}e.sort((function(e,t){return e.tempIndex-t.tempIndex}))}}function E_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r>t.height){r-=t.height,r=Math.max(r,1),i.top.u===zu.PX?o.top=t.top+t.height:i.left.u===zu.PERCENT&&(o.top=100*(t.top+t.height)/e.parent.height+"%");var a=Object.assign({},t);a.height=0,Object.assign(o,w_(e,a,r)),o.scaleY=-1*t.scaleY}else r=Math.min(r,t.height-1),o.scaleY=t.scaleY,i.top.u===zu.PX||i.top.u===zu.PERCENT?(i.top.u===zu.PX?o.top=t.top+r:o.top=100*(t.top+r)/e.parent.height+"%",i.height.u===zu.PX||i.height.u===zu.AUTO&&i.bottom.u===zu.AUTO?o.height=t.height-r:i.height.u===zu.PERCENT&&(o.height=100*(t.height-r)/e.parent.height+"%")):i.height.u!==zu.PX&&i.height.u!==zu.PERCENT&&i.height.u!==zu.AUTO||(i.height.u===zu.PX||i.height.u===zu.AUTO?o.height=t.height-r:o.height=100*(t.height-r)/e.parent.height+"%");if(n){var s=w_(e,t,-r);s.height&&("number"==typeof s.height?s.height=t.height-2*r:s.height=100*(t.height-2*r)/e.parent.height+"%"),Object.assign(o,s)}return o}function w_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r<-t.height){r+=t.height,r=Math.min(r,-1),i.bottom.u===zu.PX?o.bottom=t.bottom+t.height:i.bottom.u===zu.PERCENT&&(o.bottom=100*(t.bottom+t.height)/e.parent.height+"%");var a=Object.assign({},t);a.height=0,Object.assign(o,E_(e,a,r)),o.scaleY=-1*t.scaleY}else r=Math.max(r,1-t.height),o.scaleY=t.scaleY,i.bottom.u===zu.PX||i.bottom.u===zu.PERCENT?(i.bottom.u===zu.PX?o.bottom=t.bottom-r:o.bottom=100*(t.bottom-r)/e.parent.height+"%",i.height.u===zu.PX||i.height.u===zu.AUTO&&i.top.u===zu.AUTO?o.height=t.height+r:i.height.u===zu.PERCENT&&(o.height=100*(t.height+r)/e.parent.height+"%")):i.height.u!==zu.PX&&i.height.u!==zu.PERCENT&&i.height.u!==zu.AUTO||(i.height.u===zu.PX||i.height.u===zu.AUTO?o.height=t.height+r:o.height=100*(t.height+r)/e.parent.height+"%");if(n){var s=E_(e,t,-r);s.height&&("number"==typeof s.height?s.height=t.height+2*r:s.height=100*(t.height+2*r)/e.parent.height+"%"),Object.assign(o,s)}return o}function S_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r>t.width){r-=t.width,r=Math.max(r,1),i.left.u===zu.PX?o.left=t.left+t.width:i.left.u===zu.PERCENT&&(o.left=100*(t.left+t.width)/e.parent.width+"%");var a=Object.assign({},t);a.width=0,Object.assign(o,__(e,a,r)),o.scaleX=-1*t.scaleX}else r=Math.min(r,t.width-1),o.scaleX=t.scaleX,i.left.u===zu.PX||i.left.u===zu.PERCENT?(i.left.u===zu.PX?o.left=t.left+r:o.left=100*(t.left+r)/e.parent.width+"%",i.width.u===zu.PX||i.width.u===zu.AUTO&&i.right.u===zu.AUTO?o.width=t.width-r:i.width.u===zu.PERCENT&&(o.width=100*(t.width-r)/e.parent.width+"%")):i.width.u!==zu.PX&&i.width.u!==zu.PERCENT&&i.width.u!==zu.AUTO||(i.width.u===zu.PX||i.width.u===zu.AUTO?o.width=t.width-r:o.width=100*(t.width-r)/e.parent.width+"%");if(n){var s=__(e,t,-r);s.width&&("number"==typeof s.width?s.width=t.width-2*r:s.width=100*(t.width-2*r)/e.parent.width+"%"),Object.assign(o,s)}return o}function __(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r<-t.width){r+=t.width,r=Math.min(r,-1),i.right.u===zu.PX?o.right=t.right+t.width:i.right.u===zu.PERCENT&&(o.right=100*(t.right+t.width)/e.parent.width+"%");var a=Object.assign({},t);a.width=0,Object.assign(o,S_(e,a,r)),o.scaleX=-1*t.scaleX}else r=Math.max(r,1-t.width),o.scaleX=t.scaleX,i.right.u===zu.PX||i.right.u===zu.PERCENT?(i.right.u===zu.PX?o.right=t.right-r:o.right=100*(t.right-r)/e.parent.width+"%",i.width.u===zu.PX||i.width.u===zu.AUTO&&i.left.u===zu.AUTO?o.width=t.width+r:i.width.u===zu.PERCENT&&(o.width=100*(t.width+r)/e.parent.width+"%")):i.width.u!==zu.PX&&i.width.u!==zu.PERCENT&&i.width.u!==zu.AUTO||(i.width.u===zu.PX||i.width.u===zu.AUTO?o.width=t.width+r:o.width=100*(t.width+r)/e.parent.width+"%");if(n){var s=S_(e,t,-r);s.width&&("number"==typeof s.width?s.width=t.width+2*r:s.width=100*(t.width+2*r)/e.parent.width+"%"),Object.assign(o,s)}return o}function C_(e,t,r){var n=r*(t.width/t.height),i=S_(e,t,.5*-n),o=__(e,t,.5*n),a=Object.assign({},i,o);if(a.width)if("number"==typeof a.width){var s=a.width-t.width;a.width=t.width+2*s}else{var l=e.parent.width;s=parseFloat(a.width)*l*.01-t.width;a.width=100*(t.width+2*s)/l+"%"}return a}function A_(e,t,r,n){void 0===n&&(n=!1);var i=E_(e,t,r);if(n){var o=w_(e,t,-r);o.height&&("number"==typeof o.height?o.height=t.height-2*r:o.height=100*(t.height-2*r)/e.parent.height+"%"),Object.assign(i,o)}var a=C_(e,t,n?2*-r:-r);return Object.assign(i,a)}function T_(e,t,r,n){void 0===n&&(n=!1);var i=w_(e,t,r);if(n){var o=E_(e,t,-r);o.height&&("number"==typeof o.height?o.height=t.height+2*r:o.height=100*(t.height+2*r)/e.parent.height+"%"),Object.assign(i,o)}var a=C_(e,t,n?2*r:r);return Object.assign(i,a)}function O_(e,t,r){var n=r/(t.width/t.height),i=E_(e,t,.5*-n),o=w_(e,t,.5*n),a=Object.assign({},i,o);if(a.height)if("number"==typeof a.height){var s=a.height-t.height;a.height=t.height+2*s}else{var l=e.parent.height;s=parseFloat(a.height)*l*.01-t.height;a.height=100*(t.height+2*s)/l+"%"}return a}function M_(e,t,r,n){void 0===n&&(n=!1);var i=S_(e,t,r);if(n){var o=__(e,t,-r);o.width&&("number"==typeof o.width?o.width=t.width-2*r:o.width=100*(t.width-2*r)/e.parent.width+"%"),Object.assign(i,o)}var a=O_(e,t,n?2*-r:-r);return Object.assign(i,a)}function k_(e,t,r,n){void 0===n&&(n=!1);var i=__(e,t,r);if(n){var o=S_(e,t,-r);o.width&&("number"==typeof o.width?o.width=t.width+2*r:o.width=100*(t.width+2*r)/e.parent.width+"%"),Object.assign(i,o)}var a=O_(e,t,n?2*r:r);return Object.assign(i,a)}function L_(e,t,r,n){void 0===n&&(n=!0);var i=e.width,o=e.height,a=o/i;n||(a*=-1);var s=-1/a,l=i+t,c=o+r,u=(c-o+a*i-s*l)/(a-s);return{x:u,y:s*u-s*l+c}}function R_(e,t,r,n,i){void 0===i&&(i=!1);var o=L_(t,r,n,!0),a=o.x,s=o.y,l=S_(e,t,a-t.width,i);return Object.assign(l,E_(e,t,s-t.height,i)),l}function I_(e,t,r,n,i){void 0===i&&(i=!1);var o=L_(t,r,n,!1),a=o.x,s=o.y,l=__(e,t,a-t.width,i);return Object.assign(l,E_(e,t,s-t.height,i)),l}function P_(e,t,r,n,i){void 0===i&&(i=!1);var o=L_(t,r,n,!1),a=o.x,s=o.y,l=S_(e,t,a-t.width,i);return Object.assign(l,w_(e,t,s-t.height,i)),l}function F_(e,t,r,n,i){void 0===i&&(i=!1);var o=L_(t,r,n,!0),a=o.x,s=o.y,l=__(e,t,a-t.width,i);return Object.assign(l,w_(e,t,s-t.height,i)),l}function D_(e,t,r,n){n&&(e.left?"number"==typeof e.left?e.left+=n:e.left=parseFloat(e.left)+n/t.parent.width*100+"%":e.width||(t.style.left.u===zu.PERCENT?e.left=100*(r.left+n)/t.parent.width+"%":t.style.left.u===zu.PX&&(e.left=r.left+n)),e.right?"number"==typeof e.right?e.right-=n:e.right=parseFloat(e.right)-n/t.parent.width*100+"%":e.width||(t.style.right.u===zu.PERCENT?e.right=100*(r.right-n)/t.parent.width+"%":t.style.right.u===zu.PX&&(e.right=r.right-n)))}function N_(e,t,r,n){n&&(e.top?"number"==typeof e.top?e.top+=n:e.top=parseFloat(e.top)+n/t.parent.height*100+"%":e.height||(t.style.top.u===zu.PERCENT?e.top=100*(r.top+n)/t.parent.height+"%":t.style.top.u===zu.PX&&(e.top=r.top+n)),e.bottom?"number"==typeof e.bottom?e.bottom-=n:e.bottom=parseFloat(e.bottom)-n/t.parent.height*100+"%":e.height||(t.style.bottom.u===zu.PERCENT?e.bottom=100*(r.bottom-n)/t.parent.height+"%":t.style.bottom.u===zu.PX&&(e.bottom=r.bottom-n)))}function B_(e,t,r){var n=e*r.h/r.w,i=r.y+.5*r.h;return(t.y+.5*t.h-i)*n/r.h}function U_(e,t,r){var n=e*r.w/r.h,i=r.x+.5*r.w;return(t.x+.5*t.w-i)*n/r.w}function z_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?A_(e,t,r*n.h/i.h,a):E_(e,t,r*n.h/i.h,a),l=U_(r,n,i);a&&(l*=2),D_(s,e,t,-l);return N_(s,e,t,a?-r*(n.y+.5*n.h-i.y-.5*i.h)*2/i.h:r*(i.y+i.h-n.y-n.h)/i.h),s}function G_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?T_(e,t,r*n.h/i.h,a):w_(e,t,r*n.h/i.h,a);if(o){var l=U_(r,n,i);a&&(l*=2),D_(s,e,t,l)}var c=0;return c=a?r*(n.y+.5*n.h-i.y-.5*i.h)*2/i.h:r*(n.y-i.y)/i.h,n.y,i.y,i.h,N_(s,e,t,c),s}function X_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?M_(e,t,r*n.w/i.w,a):S_(e,t,r*n.w/i.w,a);if(o){var l=B_(r,n,i);a&&(l*=2),N_(s,e,t,-l)}return D_(s,e,t,a?-r*(n.x+.5*n.w-i.x-.5*i.w)*2/i.w:r*(i.x+i.w-n.x-n.w)/i.w),s}function H_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?k_(e,t,r*n.w/i.w,a):__(e,t,r*n.w/i.w,a);if(o){var l=B_(r,n,i);a&&(l*=2),N_(s,e,t,l)}return D_(s,e,t,a?r*(n.x+.5*n.w-i.x-.5*i.w)*2/i.w:r*(n.x-i.x)/i.w),s}function j_(e,t,r,n,i,o){var a=z_(e,t,r,n,i);delete o.top,delete o.height,delete o.bottom,void 0!==a.top&&(o.top=a.top),void 0!==a.height&&(o.height=a.height),void 0!==a.bottom&&(o.bottom=a.bottom)}function W_(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=X_(e,t,r,i,o,a,s);if(s)return l;if(a)j_(e,t,n,i,o,l);else{var c=z_(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function Y_(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=H_(e,t,r,i,o,a,s);if(s)return l;if(a)j_(e,t,n,i,o,l);else{var c=z_(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function q_(e,t,r,n,i,o){var a=G_(e,t,r,n,i);delete o.top,delete o.height,delete o.bottom,void 0!==a.top&&(o.top=a.top),void 0!==a.height&&(o.height=a.height),void 0!==a.bottom&&(o.bottom=a.bottom)}function V_(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=X_(e,t,r,i,o,a,s);if(s)return l;if(a)q_(e,t,n,i,o,l);else{var c=G_(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function K_(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=H_(e,t,r,i,o,a,s);if(s)return l;if(a)q_(e,t,n,i,o,l);else{var c=G_(e,t,n,i,o,a,s);Object.assign(l,c)}return l}function Z_(e){var t=[e],r=e.artBoard||e.page;if(e!==r)for(var n=e.parent;n&&n!==r;)t.unshift(n),n=n.parent;for(var i=nd(),o=0,a=t.length;o<a;o++)i=od(i,t[o].matrix);return i}function J_(e){var t,r,n,i,o=0,a=0;return e.artBoard||(o=(null===(r=(null===(t=e.page)||void 0===t?void 0:t.props).rule)||void 0===r?void 0:r.baseX)||0,a=(null===(i=(null===(n=e.page)||void 0===n?void 0:n.props).rule)||void 0===i?void 0:i.baseY)||0),{baseX:o,baseY:a}}function $_(e){var t=Z_(e),r=e._rect||e.rect,n=md(r[0],r[1],r[2],r[3],t),i=n.x1,o=n.y1,a=n.x2,s=n.y2,l=n.x3,c=n.y3,u=n.x4,h=n.y4,d=e.computedStyle,f=J_(e),p=f.baseX,v=f.baseY;return{baseX:p,baseY:v,x:Math.min(i,a,l,u)-p,y:Math.min(o,s,c,h)-v,w:r[2]-r[0],h:r[3]-r[1],isFlippedHorizontal:-1===d.scaleX,isFlippedVertical:-1===d.scaleY,rotation:d.rotateZ,opacity:d.opacity,mixBlendMode:d.mixBlendMode,constrainProportions:!!e.props.constrainProportions,matrix:t}}!function(e){e[e.APPEND=0]="APPEND",e[e.PREPEND=1]="PREPEND",e[e.BEFORE=2]="BEFORE",e[e.AFTER=3]="AFTER"}(h_||(h_={}));var Q_={moveAppend:v_,movePrepend:function(e,t){p_(e,t,h_.PREPEND)},moveAfter:y_,moveBefore:function(e,t){p_(e,t,h_.BEFORE)},move:function(e,t,r){var n=e.getStyle();(t||r)&&(e.updateStyle({translateX:e.computedStyle.translateX+t,translateY:e.computedStyle.translateY+r}),e.endPosChange(n,t,r),e.checkPosSizeUpward())},migrate:b_,sortTempIndex:x_,getWholeBoundingClientRect:function(e,t){if(e.length){for(var r=e[0].getBoundingClientRect(t),n=1,i=e.length;n<i;n++){var o=e[n].getBoundingClientRect(t);r.left=Math.min(r.left,o.left),r.right=Math.max(r.right,o.right),r.top=Math.min(r.top,o.top),r.bottom=Math.max(r.bottom,o.bottom)}return r}},resizeTopOperate:E_,resizeBottomOperate:w_,resizeLeftOperate:S_,resizeRightOperate:__,resizeTop:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=E_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeBottom:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=w_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeLeft:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=S_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeRight:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=__(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeTopAspectRatioOperate:A_,resizeBottomAspectRatioOperate:T_,resizeLeftAspectRatioOperate:M_,resizeRightAspectRatioOperate:k_,resizeTopLeftAspectRatioOperate:R_,resizeTopRightAspectRatioOperate:I_,resizeBottomLeftAspectRatioOperate:P_,resizeBottomRightAspectRatioOperate:F_,resizeTopMultiArOperate:z_,resizeBottomMultiArOperate:G_,resizeRightMultiArOperate:H_,resizeLeftMultiArOperate:X_,resizeTopLeftMultiArOperate:W_,resizeTopRightMultiArOperate:Y_,resizeBottomLeftMultiArOperate:V_,resizeBottomRightMultiArOperate:K_,getBasicMatrix:Z_,getBaseCoords:J_,getBasicInfo:$_,toPngBlob:function(e){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,a,s;return J(this,(function(l){return e.isDestroyed?[2]:(t=e.root,e===t?[2,new Promise((function(e,r){t.canvas&&t.canvas.toBlob((function(t){t?e(t):r()}))}))]:(r=e._filterBbox2||e.filterBbox2,n=r[2]-r[0],i=r[3]-r[1],(o=document.createElement("canvas")).width=n,o.height=i,o.style.position="fixed",o.style.left="100%",o.style.top="100%",document.body.appendChild(o),(a=new f_({dpi:1,uuid:"",index:0,style:{width:n,height:i}})).appendTo(o),(s=e.clone()).updateStyle({left:-r[0],top:-r[1],right:"auto",bottom:"auto",width:e.width,height:e.height,translateX:0,translateY:0}),a.getCurPageWithCreate().appendChild(s),[2,new Promise((function(e,t){a.on("REFRESH_COMPLETE",(function(){o.toBlob((function(r){r?e(r):t()}))}))}))]))}))}))}};function eC(e){return e.map((function(e){return e.map((function(e){return Math.round(100*e)}))}))}function tC(e,t){if(t&&!id(t)){var r=t[0],n=t[1],i=t[4],o=t[5],a=t[12],s=t[13];return e.map((function(e){var t=(1===r?e[0]:e[0]*r)+(i?e[1]*i:0)+a,l=(1===n?e[0]:e[0]*n)+(o?e[1]*o:0)+s;if(4===e.length||6===e.length){var c=(1===r?e[2]:e[2]*r)+(i?e[3]*i:0)+a,u=(1===n?e[2]:e[2]*n)+(o?e[3]*o:0)+s;return 6===e.length?[t,l,c,u,(1===r?e[4]:e[4]*r)+(i?e[5]*i:0)+a,(1===n?e[4]:e[4]*n)+(o?e[5]*o:0)+s]:[t,l,c,u]}return[t,l]}))}return e.map((function(e){return e.slice(0)}))}var rC=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.props=t,n.loaders=[],n.isShapeGroup=!0,n}return p(t,e),t.prototype.didMount=function(){for(var e,t=this.children,r=t.length,n=0;n<r;n++)t[n].didMount();if(this.buildPoints(),null===(e=this.coords)||void 0===e?void 0:e.length){var i=this._rect||this.rect,o=this.width,a=this.height,s=WS.EPS;(Math.abs(i[0])>s||Math.abs(i[1])>s||Math.abs(o-i[2])>s||Math.abs(a-i[3])>s)&&this.adjustPosAndSize({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]})}},t.prototype.lay=function(t){e.prototype.lay.call(this,t),this.coords=void 0},t.prototype.clearPoints=function(){this.coords=void 0,this._rect=void 0,this._bbox=void 0,this.clearCache(!0)},t.prototype.clearPointsUpward=function(){this.clearPoints();for(var e=this.parent;e&&e instanceof t;)e.clearPoints(),e=e.parent},t.prototype.calContent=function(){return this.buildPoints(),this.hasContent=!!this.coords&&this.coords.length>0},t.prototype.buildPoints=function(){var e=this;if(!this.coords){this.coords=[],this.textureOutline.forEach((function(e){return null==e?void 0:e.release()}));for(var r=this.children,n=[],i=!0,o=function(e,o){var a=r[e];if(a.computedStyle.visibility===rh.HIDDEN)return"continue";var s=void 0;if(a instanceof Jw||a instanceof t)a.buildPoints(),s=a.coords;else{var l=a.width,c=a.height;s=[[0,0],[l,0],[l,c],[0,c],[0,0]]}var u=a.matrix;if(s&&s.length){var h=void 0;h=a instanceof t?s.map((function(e){return eC(tC(e,u))})):[eC(tC(s,u))];var d=a.computedStyle.booleanOperation;if(i||!d)n=n.concat(h),i=!1;else if(d===qu.INTERSECT){var f=HS.intersect(n,h);n=f||[]}else if(d===qu.UNION){var p=[],v=[];if(h.forEach((function(e){e.length<=2?v.push(e):p.push(e)})),p.length){f=HS.union(n,p);n=f||[]}v.length&&(n=n.concat(v))}else if(d===qu.SUBTRACT){f=HS.subtract(n,h);n=f||[]}else if(d===qu.XOR){f=HS.xor(n,h);n=f||[]}}},a=0,s=r.length;a<s;a++)o(a);n.forEach((function(t){if(t.length>1){var r=t.map((function(e){return e.map((function(e){return.01*e}))}));e.coords.push(r)}}))}},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t),this.buildPoints();var i=this.coords;if(i&&i.length){var o=this._bbox2||this.bbox2,a=o[0],s=o[1],l=o[2]-a,c=o[3]-s,u=-a*t,h=-s*t;l*=t,c*=t;var d=this.canvasCache=Iw.getInstance(l,c,u,h);d.available=!0;for(var f=this.computedStyle,p=f.fill,v=f.fillOpacity,y=f.fillRule,g=f.fillEnable,m=f.fillMode,b=f.stroke,x=f.strokeEnable,E=f.strokeWidth,w=f.strokePosition,S=f.strokeMode,_=f.strokeDasharray,C=f.strokeLinecap,A=f.strokeLinejoin,T=f.strokeMiterlimit,O=d.list,M=function(e,o){var a=O[e],s=a.x,d=a.y,f=a.os.ctx,M=-s,L=-d;1!==t?f.setLineDash(_.map((function(e){return e*t}))):f.setLineDash(_),f.beginPath(),i.forEach((function(e){JE(f,e,t,M,L)})),f.closePath();for(var R=function(e,o){if(!g[e]||!v[e])return"continue";var a=p[e],s=void 0,d=m[e];if(f.globalAlpha=v[e],Array.isArray(a)){if(!a[3])return"continue";f.fillStyle=Jf(a)}else{if(void 0!==a.url){var b=a.url;if(b){var x=k.loaders[e],E=dh.IMG[b];if(!x&&E&&(x=k.loaders[e]={error:!1,loading:!1,width:E.width,height:E.height,source:E.source}),x)if(x.error||x.loading||!x.source)x.error||x.loading||k.root.imgLoadingCount++;else{var w=k.width,S=k.height,_=w*t,C=S*t,A=dh.getOffscreenCanvas(l,c),T=A.ctx;if(T.beginPath(),i.forEach((function(e){JE(f,e,t,M,L)})),T.closePath(),T.save(),T.clip(),a.type===th.TILE)for(var O=null!==(r=a.scale)&&void 0!==r?r:1,R=0,I=Math.ceil(w/O/x.width);R<I;R++)for(var P=0,F=Math.ceil(S/O/x.height);P<F;P++)T.drawImage(x.source,M+R*x.width*t*O,L+P*x.height*t*O,x.width*t*O,x.height*t*O);else if(a.type===th.FILL){var D=_/x.width,N=C/x.height,B=Math.max(D,N),U=-.5*(x.width*B-_),z=-.5*(x.height*B-C);T.drawImage(x.source,0,0,x.width,x.height,U+M,z+L,x.width*B,x.height*B)}else if(a.type===th.STRETCH)T.drawImage(x.source,M,L,_,C);else if(a.type===th.FIT){D=_/x.width,N=C/x.height,B=Math.min(D,N);var G=-.5*(x.width*B-_),X=-.5*(x.height*B-C);T.drawImage(x.source,0,0,x.width,x.height,G+M,X+L,x.width*B,x.height*B)}d!==Hu.NORMAL&&(f.globalCompositeOperation=Pw(d)),f.drawImage(A.canvas,0,0),d!==Hu.NORMAL&&(f.globalCompositeOperation="source-over"),A.release()}else k.root.imgLoadingCount++,x=k.loaders[e]=k.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},dh.loadImg(b,(function(t){b===p[e].url&&(x.loading=!1,t.success?(x.error=!1,x.source=t.source,x.width=t.width,x.height=t.height,n.isDestroyed||n.root.addUpdate(n,[],XE.REPAINT,!1,!1,void 0)):x.error=!0,n.root.imgLoadingCount--)}))}return"continue"}if(a.t===Wu.LINEAR){var H=Gf(a.stops,a.d,M,L,l-2*u,c-2*h),j=f.createLinearGradient(H.x1,H.y1,H.x2,H.y2);H.stop.forEach((function(e){j.addColorStop(e.offset,Jf(e.color))})),f.fillStyle=j}else if(a.t===Wu.RADIAL){H=Xf(a.stops,a.d,M,L,l-2*u,c-2*h);var W=f.createRadialGradient(H.cx,H.cy,0,H.cx,H.cy,H.total);H.stop.forEach((function(e){W.addColorStop(e.offset,Jf(e.color))}));var Y=H.matrix;if(Y){var q=(s=dh.getOffscreenCanvas(l,c)).ctx;q.beginPath(),i.forEach((function(e){JE(q,e,t,M,L)})),q.closePath(),q.clip(),q.fillStyle=W,q.setTransform(Y[0],Y[1],Y[4],Y[5],Y[12],Y[13]),q.fill(y===Zu.EVEN_ODD?"evenodd":"nonzero")}else f.fillStyle=W}else if(a.t===Wu.CONIC){H=Hf(a.stops,a.d,M,L,l-2*u,c-2*h);var V=f.createConicGradient(H.angle,H.cx+M,H.cy+L);H.stop.forEach((function(e){V.addColorStop(e.offset,Jf(e.color))})),f.fillStyle=V}}d!==Hu.NORMAL&&(f.globalCompositeOperation=Pw(d)),s?(f.drawImage(s.canvas,0,0),s.release()):f.fill(y===Zu.EVEN_ODD?"evenodd":"nonzero"),d!==Hu.NORMAL&&(f.globalCompositeOperation="source-over")},I=0,P=p.length;I<P;I++)R(I);f.globalAlpha=1,f.globalCompositeOperation="source-over";var F=k.computedStyle,D=F.innerShadow,N=F.innerShadowEnable;if(D&&D.length){var B=0,U=!1;D.forEach((function(e,r){if(N[r]){U=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.x))+e.spread)*t;B=Math.max(B,n+e.blur*t)}})),U&&(f.save(),f.beginPath(),i.forEach((function(e){JE(f,e,t,M,L)})),f.closePath(),f.clip(),f.fillStyle="#FFF",f.beginPath(),i.forEach((function(e){JE(f,e,t,M,L)})),JE(f,[[-B,-B],[l+B,-B],[l+B,c+B],[-B,c+B],[-B,-B]],1,0,0),f.closePath(),D.forEach((function(e,r){N[r]&&(f.shadowOffsetX=e.x*t,f.shadowOffsetY=e.y*t,f.shadowColor=Jf(e.color),f.shadowBlur=e.blur*t,f.fill("evenodd"))})),f.restore(),f.beginPath(),i.forEach((function(e){JE(f,e,t,M,L)})),f.closePath())}C===$u.ROUND?f.lineCap="round":C===$u.SQUARE?f.lineCap="square":f.lineCap="butt",A===Qu.ROUND?f.lineJoin="round":A===Qu.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=T;for(var z=function(e,r){if(!x[e]||!E[e])return"continue";var n=b[e],o=w[e];if(f.globalCompositeOperation=Pw(S[e]),Array.isArray(n))f.strokeStyle=Jf(n);else if(n.t===Wu.LINEAR){var a=Gf(n.stops,n.d,M,L,l-2*u,c-2*h),s=f.createLinearGradient(a.x1,a.y1,a.x2,a.y2);a.stop.forEach((function(e){s.addColorStop(e.offset,Jf(e.color))})),f.strokeStyle=s}else if(n.t===Wu.RADIAL){a=Xf(n.stops,n.d,M,L,l-2*u,c-2*h);var d=f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.total);a.stop.forEach((function(e){d.addColorStop(e.offset,Jf(e.color))}));var p=a.matrix;if(p){var v=dh.getOffscreenCanvas(l,c),y=v.ctx;return y.setLineDash(_),y.lineCap=f.lineCap,y.lineJoin=f.lineJoin,y.miterLimit=f.miterLimit,y.lineWidth=E[e]*t,y.strokeStyle="#F00",y.beginPath(),i.forEach((function(e){JE(y,e,t,M,L)})),y.closePath(),o===eh.INSIDE?(y.lineWidth=2*E[e]*t,y.save(),y.clip(),y.stroke(),y.restore()):o===eh.OUTSIDE?(y.lineWidth=2*E[e]*t,y.stroke(),y.save(),y.clip(),y.globalCompositeOperation="destination-out",y.strokeStyle="#FFF",y.stroke(),y.restore()):y.stroke(),y.fillStyle=d,y.globalCompositeOperation="source-in",y.setTransform(p[0],p[1],p[4],p[5],p[12],p[13]),y.fillRect(0,0,l,c),f.drawImage(v.canvas,0,0),v.release(),"continue"}f.strokeStyle=d}else if(n.t===Wu.CONIC){a=Hf(n.stops,n.d,M,L,l-2*u,c-2*h);var g=f.createConicGradient(a.angle,a.cx+M,a.cy+L);a.stop.forEach((function(e){g.addColorStop(e.offset,Jf(e.color))})),f.strokeStyle=g}var m,C=void 0;o===eh.INSIDE?f.lineWidth=2*E[e]*t:o===eh.OUTSIDE?(C=dh.getOffscreenCanvas(l,c),(m=C.ctx).setLineDash(_),m.lineCap=f.lineCap,m.lineJoin=f.lineJoin,m.miterLimit=f.miterLimit,m.strokeStyle=f.strokeStyle,m.lineWidth=2*E[e]*t,m.beginPath(),i.forEach((function(e){JE(m,e,t,M,L)}))):f.lineWidth=E[e]*t,m&&m.closePath(),o===eh.INSIDE?(f.save(),f.clip(),f.stroke(),f.restore()):o===eh.OUTSIDE?(m.stroke(),m.save(),m.clip(),m.globalCompositeOperation="destination-out",m.strokeStyle="#FFF",m.stroke(),m.restore(),f.drawImage(C.canvas,M-u,L-h),C.release()):f.stroke()},G=0,X=b.length;G<X;G++)z(G);f.globalCompositeOperation="source-over"},k=this,L=0,R=O.length;L<R;L++)M(L)}},t.prototype.refresh=function(t,r){void 0===t&&(t=XE.REPAINT),t>=XE.REPAINT&&(this.coords=void 0),e.prototype.refresh.call(this,t,r)},t.prototype.toSvg=function(e){this.buildPoints();var t=this.computedStyle,r=this.coords||[],n=new Float64Array(this.matrixWorld),i=[],o=0,a=0,s=0,l=0,c=!0;r.forEach((function(e,t){var r=[];e.forEach((function(e,t){if(6===e.length){var i=yd({x:e[0],y:e[1]},n),u=yd({x:e[2],y:e[3]},n),h=yd({x:e[4],y:e[5]},n);r.push([i.x,i.y,u.x,u.y,h.x,h.y]),c?(c=!1,o=Math.min(i.x,u.x,h.x),a=Math.min(i.y,u.y,h.y),s=Math.max(i.x,u.x,h.x),l=Math.max(i.y,u.y,h.y)):(o=Math.min(o,i.x,u.x,h.x),a=Math.min(a,i.y,u.y,h.y),s=Math.max(s,i.x,u.x,h.x),l=Math.max(l,i.y,u.y,h.y))}else if(4===e.length){i=yd({x:e[0],y:e[1]},n),u=yd({x:e[2],y:e[3]},n);r.push([i.x,i.y,u.x,u.y]),c?(c=!1,o=Math.min(i.x,u.x),a=Math.min(i.y,u.y),s=Math.max(i.x,u.x),l=Math.max(i.y,u.y)):(o=Math.min(o,i.x,u.x),a=Math.min(a,i.y,u.y),s=Math.max(s,i.x,u.x),l=Math.max(l,i.y,u.y))}else if(2===e.length){var d=yd({x:e[0],y:e[1]},n);r.push([d.x,d.y]),c?(c=!1,o=d.x,a=d.y,s=d.x,l=d.y):(o=Math.min(o,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),l=Math.max(l,d.y))}})),r.length&&i.push(r)}));var u=s-o,h=l-a,d=1;d=u>=h?e/u:e/h;var f=t.fillRule===Zu.EVEN_ODD?"evenodd":"nonzero",p='<svg width="'.concat(u*d,'" height="').concat(h*d,'"><path');if(i.length){var v=[["d",""],["fill","#D8D8D8"],["fill-rule",f],["stroke","#979797"],["stroke-width",1]];i.forEach((function(e){var t=$E(e.map((function(e){return e.map((function(e){return e*d}))})),-o*d,-a*d)+"Z";v[0][1]+=t})),v.forEach((function(e){p+=" "+e[0]+'="'+e[1]+'"'})),p+="></path>"}return p+"</svg>"},t.prototype.clone=function(e){var r=Iu(this.props),n=r.uuid;r.uuid=a(),r.sourceUuid=this.props.uuid;var i=new t(r,this.children.map((function(t){return t.clone(e)})));return i.style=Iu(this.style),e&&e.hasOwnProperty(n)&&e[n].forEach((function(e){var t=e.key,n=e.value;if("fill"===t[0]){var o=parseInt(t[1])||0;r.style.fill[o]=n,i.style.fill[o]={v:Zf(n),u:zu.RGBA}}})),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=s.SHAPE_GROUP,t},t.prototype.toSketchJson=function(t){return Z(this,void 0,void 0,(function(){var r;return J(this,(function(n){switch(n.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=n.sent())._class=Q.ClassValue.ShapeGroup,[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this),t&&this.loaders.forEach((function(e){e.loading&&(t.imgLoadingCount--,e.loading=!1)}))}},Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;if(!e){e=this._rect=new Float64Array(4),this.buildPoints();var t=this.coords;t&&t.length&&function(e,t){var r=!0;t=t||new Float64Array(4);for(var n=0,i=0,o=0,a=e.length;o<a;o++)for(var s=e[o],l=0,c=s.length;l<c;l++){var u=s[l];if(r){if(!(h=Bw(u,t))){dh.error("Unsupported point data: "+o+":"+l+" - "+u.join(","));continue}n=h.x,i=h.y,r=!1}else{var h;if(!(h=Uw(u,n,i,t))){dh.error("Unsupported point data: "+o+":"+l+" - "+u.join(","));continue}n=h.x,i=h.y}}}(t,e)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.buildPoints();var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=r.strokeLinejoin,s=r.strokeMiterlimit,l=0;n.forEach((function(e,t){i[t]&&(o[t]===eh.INSIDE||(l=o[t]===eh.OUTSIDE?Math.max(l,4*e):Math.max(l,.5*e*4)))}));var c=e[0]-l,u=e[1]-l,h=e[2]+l,d=e[3]+l;(this.coords||[]).forEach((function(t){var r=Dw(e,l,t,a,s);e[0]=Math.min(e[0],r[0]),e[1]=Math.min(e[1],r[1]),e[2]=Math.min(e[2],r[2]),e[3]=Math.min(e[3],r[3])})),e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],u),e[2]=Math.max(e[2],h),e[3]=Math.max(e[3],d)}return e},enumerable:!1,configurable:!0}),t.groupAsShape=function(e,r,n){if(void 0===r&&(r=qu.NONE),e.length){x_(e);var i,o=e[0],s=o.parent;s instanceof WS&&(s.fixedPosAndSize=!0);for(var l=0,c=e.length;l<c;l++){b_(s,u=e[l]),u.style.booleanOperation={v:r,u:zu.NUMBER}}for(l=0,c=e.length;l<c;l++){var u;if((u=e[l])instanceof Jw||u instanceof t){i=u.getCssStyle();break}}i||(i=h());var d=new t(Object.assign({uuid:a(),name:"形状结合",style:{left:"0%",top:"0%",right:"0%",bottom:"0%",fill:i.fill,fillEnable:i.fillEnable,fillRule:i.fillRule,stroke:i.stroke,strokeEnable:i.strokeEnable,strokeWidth:i.strokeWidth,strokePosition:i.strokePosition,strokeDasharray:i.strokeDasharray,strokeLinecap:i.strokeLinecap,strokeLinejoin:i.strokeLinejoin,strokeMiterlimit:i.strokeMiterlimit}},n),[]);d.fixedPosAndSize=!0,o.insertAfter(d);for(l=0,c=e.length;l<c;l++)d.appendChild(e[l]);return d.fixedPosAndSize=!1,s instanceof WS&&(s.fixedPosAndSize=!1),d.checkPosSizeSelf(),d}},t}(WS);function nC(e,t,r,n,i,o,a,s,l){for(var c,u,h,d,f,p,v,y,g=t.structs,m=t.width,b=t.height,x=[],E=[],w=0,S=g.length;w<S;w++){var _=g[w],C=_.node,A=_.lv,T=_.total,O=_.next,M=C.refreshLevel,k=C.computedStyle;C.refreshLevel=XE.NONE;var L=C.textureTotal,R=C.textureFilter,I=C.textureMask;M&&(M<XE.REPAINT||C.calContent());var P=k.maskMode,F=k.opacity,D=k.shadow,N=k.shadowEnable,B=k.innerShadow,U=k.innerShadowEnable,z=k.blur,G=k.mixBlendMode,X=k.fill,H=k.fillEnable,j=k.hueRotate,W=k.saturate,Y=k.brightness,q=k.contrast,V=!1;C.isGroup&&H[0]&&X[0]&&Array.isArray(X[0])&&(V=!0);for(var K=(F>0&&F<1||G!==Hu.NORMAL||V)&&T>0&&!C.isShapeGroup&&(!L[n]||!L[n].available),Z=!1,J=0,$=D.length;J<$;J++)if(N[J]&&D[J].color[3]>0){Z=!0;break}for(var Q=0,ee=B.length;Q<ee;Q++)if(U[Q]&&B[Q].color[3]>0){Z=!0;break}Z&&(null===(c=R[n])||void 0===c?void 0:c.available)&&(Z=!1);var te=(z.t===Yu.GAUSSIAN&&z.radius>=1||z.t===Yu.BACKGROUND&&(z.radius>=1||1!==z.saturation)&&T||z.t===Yu.RADIAL&&z.radius>=1||z.t===Yu.MOTION&&z.radius>=1)&&(!R[n]||!(null===(u=R[n])||void 0===u?void 0:u.available)),re=P>0&&(!I[n]||!(null===(h=I[n])||void 0===h?void 0:h.available));if(re&&(P!==Ju.ALPHA||0!==k.opacity&&C.next&&!C.next.computedStyle.breakMask?P!==Ju.OUTLINE||0!==k.opacity&&C.next&&!C.next.computedStyle.breakMask||(re=!1,k.visibility===rh.HIDDEN||0===k.opacity?C.textureTarget[n]=void 0:C.resetTextureTarget()):(re=!1,C.textureTarget[n]=void 0)),K||Z||te||re||(j||1!==W||1!==Y||1!==q)){var ne={i:w,lv:A,total:T,node:C,valid:!1,subList:[],isNew:!1,isTop:!0};x.push(ne),E[w]=ne}(C instanceof rC||(null===(d=L[n])||void 0===d?void 0:d.available))&&(w+=T),(null===(f=I[n])||void 0===f?void 0:f.available)&&(w+=O)}x.length&&x.sort((function(e,t){return e.lv===t.lv?t.i-e.i:t.lv-e.lv}));var ie=0;for(S=x.length;ie<S;ie++){w=(ae=x[ie]).i,T=ae.total,C=ae.node;var oe=ae.isNew=!C.tempBbox;C.tempBbox=iC(g,C,w,T,oe,n,ae,E)}for(ie=0,S=x.length;ie<S;ie++){C=(ae=x[ie]).node;var ae,se=ae.isTop;w=ae.i,A=ae.lv,T=ae.total;if(se&&aC(C.tempBbox,C.matrixWorld,i,o,a-i,s-o)&&(SC(ae),C.computedStyle.maskMode!==Ju.NONE)){sC(C,g,w,A,T);for(var le=ie;le>=0;le--){var ce=x[le];if(ce.i>w+T+C.struct.next)break;SC(ce)}}}var ue,he=!0,de=[];for(ie=0,S=x.length;ie<S;ie++){var fe=x[ie],pe=(w=fe.i,A=fe.lv,T=fe.total,C=fe.node,fe.valid),ve=(oe=fe.isNew,C.computedStyle),ye=(P=ve.maskMode,ve.visibility);F=ve.opacity;if(pe){if(!(ye===rh.HIDDEN||F<=0)||P){if(!he&&Date.now()-l>bu.deltaTime){ue=x.slice(ie);break}var ge=void 0;if(!(null===(p=C.textureTotal[n])||void 0===p?void 0:p.available))(ne=lC(e,t,C,g,w,T,m,b,r,n))&&(C.textureTotal[n]=C.textureTarget[n]=ne,ge=ne,he=!1);if(C.textureTarget[n]&&!(null===(v=C.textureFilter[n])||void 0===v?void 0:v.available))(ne=hC(e,t,C,m,b,r,n))&&(C.textureFilter[n]=C.textureTarget[n]=ne,ge=ne,he=!1);if(P&&C.textureTarget[n]&&!(null===(y=C.textureMask[n])||void 0===y?void 0:y.available)&&C.next)(ne=mC(e,t,C,P,g,w,A,T,m,b,r,n))&&(C.textureMask[n]=C.textureTarget[n]=ne,ge=ne,he=!1);ge&&!t.firstDraw&&de.push({bbox:ge.bbox,m:C._matrixWorld||C.matrixWorld})}}else oe&&P&&sC(C,g,w,A,T)}return ue&&ue.length&&(t.breakMerge=!0),{mergeRecord:de,breakMerge:ue}}function iC(e,t,r,n,i,o,a,s){var l=(t.tempBbox||t._rect||t.rect).slice(0);ad(t.tempMatrix);for(var c=r+1,u=r+n+1;c<u;c++){var h=e[c],d=h.node,f=h.total,p=h.next,v=d.textureTarget[o];if(i){var y=od(d.parent.tempMatrix,d.matrix);ld(d.tempMatrix,y);var g=v&&v!==d.textureCache[o]?v.bbox:d._filterBbox2||d.filterBbox2;g[2]-g[0]&&g[3]-g[1]&&Nw(l,g,y)}v&&v.available&&v!==d.textureCache[o]?c+=f+p:d.isShapeGroup&&(c+=f);var m=s[c];m&&(m.isTop=!1,a.subList.push(m))}return l}function oC(e,t,r,n){return aC(e,t,0,0,r,n)}function aC(e,t,r,n,i,o){var a,s,l=md(e[0],e[1],e[2],e[3],t),c=l.x1,u=l.y1,h=l.x2,d=l.y2,f=l.x3,p=l.y3,v=l.x4,y=l.y4;return c===v&&u===d&&h===f&&p===y?(c>h&&(c=(a=[f,c])[0],f=a[1]),d>p&&(u=(s=[p,u])[0],p=s[1]),Ad(r,n,r+i,n+o,c,u,f,p,!1)):Td(r,n,r+i,n+o,[{x:c,y:u},{x:h,y:d},{x:f,y:p},{x:v,y:y}],!1)}function sC(e,t,r,n,i){for(var o=r+i+1,a=t.length;o<a;o++){var s=t[o],l=s.node,c=s.lv,u=l.computedStyle;if(n>c){e.struct.next=o-r-i-1;break}if(o===a||u.breakMask&&n===c){e.struct.next=o-r-i-1;break}}}function lC(e,t,r,n,i,o,a,s,l,c,u){var h;if(void 0===u&&(u=!1),null===(h=r.textureTotal[c])||void 0===h?void 0:h.available){if(!u)return r.textureTotal[c];if(r.textureTotal[c]!==r.textureCache[c])return r.textureTotal[c]}var d=r.tempBbox;if(r.tempBbox=void 0,d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3]),(!o||r instanceof rC)&&!u){var f=r.textureCache[c];return f&&f.available||!r.hasContent||(r.genTexture(e,l,c),f=r.textureCache[c]),f}for(var p,v=t.programs,y=v.program,g=d[0],m=d[1],b=g*l,x=m*l,E=Math.ceil(d[2]-g),w=Math.ceil(d[3]-m),S=E*l,_=w*l,C=Aw.getEmptyInstance(e,d),A=C.list,T=bu.maxTextureSize,O=[],M=0,k=Math.ceil(_/T);M<k;M++)for(var L=0,R=Math.ceil(S/T);L<R;L++){var I=L===R-1?S-L*T:T,P=M===k-1?_-M*T:T,F=g+L*T/l,D=m+M*T/l,N=new Float64Array([F,D,F+I/l,D+P/l]),B=b+L*T,U=x+M*T;O.push({x:B,y:U,w:I,h:P,bbox:N})}for(M=i,k=i+o+1;M<k;M++){var z=n[M],G=z.node,X=z.total,H=z.next,j=G.computedStyle,W=wC(G,j,c),Y=W.shouldIgnore,q=W.isBgBlur;if(Y)M+=X+H;else{G.isBitmap&&G.checkLoader()&&t.imgLoadList.push(G);var V=void 0,K=void 0;if(M===i)V=G.tempOpacity=1,ad(G.tempMatrix),K=vd(G.tempMatrix,l);else{var Z=G.parent;V=G.tempOpacity=j.opacity*Z.tempOpacity,K=od(Z.tempMatrix,G.matrix)}ld(G.tempMatrix,K);var J=G.textureTarget[c];if(!J&&G.hasContent&&(G.genTexture(e,l,c),J=G.textureTarget[c]),J&&J.available){var $=j.mixBlendMode,Q=j.blur;if(q&&M>i){var ee=G.textureOutline[l]=EC(e,G,n,M,X,J.bbox,l);ld(G.tempMatrix,K),A.splice(0),O.forEach((function(e){if(e.t){var t={bbox:e.bbox,w:e.w,h:e.h,t:e.t};e.ref=t,A.push(t)}})),xC(e,t,C,K,ee,Q,v,l,E,w),O.forEach((function(e){e.ref&&(e.t=e.ref.t,e.ref=void 0)})),A.splice(0),p&&e.bindFramebuffer(e.FRAMEBUFFER,p)}for(var te=J.list,re=(L=0,O.length);L<re;L++)for(var ne=O[L],ie=ne.x,oe=ne.y,ae=ne.w,se=ne.h,le=ne.t,ce=.5*ae,ue=.5*se,he=0,de=te.length;he<de;he++){var fe=te[he],pe=fe.bbox,ve=fe.t;if(ve&&aC(pe,K,ie,oe,ae,se)){le||(le=ne.t=ow(e,0,void 0,ae,se)),p?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,le,0),e.viewport(0,0,ae,se)):p=cC(e,le,ae,se);var ye=void 0;$!==Hu.NORMAL&&M>i&&(ye=ow(e,0,void 0,ae,se),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ye,0)),sw(e,ce,ue,y,[{opacity:V,matrix:K,bbox:pe,texture:ve}],-ne.x,-ne.y,!1,-1,-1,1,1),$!==Hu.NORMAL&&ye&&(le=ne.t=bC(e,le,ye,$,v,ae,se))}}}J&&J.available&&J!==G.textureCache[c]||j.maskMode&&M!==i?M+=X+H:G.isShapeGroup&&(M+=X)}}return p&&uC(e,p,a,s),O.forEach((function(e){A.push({bbox:e.bbox,w:e.w,h:e.h,t:e.t})})),C}function cC(e,t,r,n){var i=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,i),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.viewport(0,0,r,n),i}function uC(e,t,r,n){e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(t),e.viewport(0,0,r,n)}function hC(e,t,r,n,i,o,a){var s,l;if(null===(s=r.textureFilter[a])||void 0===s?void 0:s.available)return r.textureFilter[a];var c=r.computedStyle,u=c.shadow,h=c.shadowEnable,d=c.blur,f=c.fill,p=c.fillEnable,v=c.fillOpacity,y=c.hueRotate,g=c.saturate,m=c.brightness,b=c.contrast,x=r.textureTarget[a];r instanceof WS&&!(r instanceof rC)&&p[0]&&f[0]&&Array.isArray(f[0])&&(l=function(e,t,r,n,i,o,a){var s=r.bbox,l=r.list,c=t.programs,u=c.tintProgram;e.useProgram(u);for(var h,d=Aw.getEmptyInstance(e,s),f=d.list,p=0,v=l.length;p<v;p++){var y=l[p],g=y.bbox,m=y.w,b=y.h,x=y.t,E=ow(e,0,void 0,m,b);h?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,E,0),e.viewport(0,0,m,b)):h=cC(e,E,m,b),x&&yw(e,u,x,n,i),f.push({bbox:g.slice(0),w:m,h:b,t:E})}return e.useProgram(c.program),uC(e,h,o,a),d}(e,t,x,f[0],v[0],n,i));var E=[];if(u.forEach((function(e,t){h[t]&&e.color[3]>0&&E.push(e)})),E.length){var w=function(e,t,r,n,i,o,a){for(var s=r.bbox,l=s.slice(0),c=[0,0,0,0],u=[],h=[],d=0,f=n.length;d<f;d++){var p=Rf(Lf(.5*(Re=n[d]).blur));if(h.push(p),Re.x||Re.y||p){var v=Re.x-p,y=Re.y-p,g=Re.x+p,m=Re.y+p;u.push([v,y,g+(s[2]-s[0]),m+(s[3]-s[1])]),c[0]=Math.min(c[0],v),c[1]=Math.min(c[1],y),c[2]=Math.max(c[2],g),c[3]=Math.max(c[3],m)}}if(!u.length)return;l[0]+=c[0],l[1]+=c[1],l[2]+=c[2],l[3]+=c[3];var b,x,E=l[0],w=l[1],S=l[2]-l[0],_=l[3]-l[1],C=S*a,A=_*a,T=t.programs,O=T.program,M=T.dropShadowProgram,k=Aw.getEmptyInstance(e,l),L=k.list,R=bu.maxTextureSize;for(d=0,f=Math.ceil(A/R);d<f;d++)for(var I=0,P=Math.ceil(C/R);I<P;I++){for(var F=I===P-1?C-I*R:R,D=d===f-1?A-d*R:R,N=E+I*R/a,B=w+d*R/a,U=F/a,z=D/a,G=!0,X=0,H=u.length;X<H;X++){var j=u[X];if(Ad(s[0],s[1],s[2],s[3],N,B,N+U,B+z)||Ad(j[0],j[1],j[2],j[3],N,B,N+U,B+z)){G=!1;break}}if(!G){var W=new Float64Array([N,B,N+U,B+z]),Y=ow(e,0,void 0,F,D);L.push({bbox:W,w:F,h:D,t:Y})}}1!==a&&vd(b=nd(),a);for(d=0,f=n.length;d<f;d++){p=h[d];var q=n[d],V=q.x,K=q.y,Z=q.blur,J=q.color,$=s.slice(0);$[0]-=p,$[1]-=p,$[2]+=p,$[3]+=p;var Q=$[0],ee=$[1],te=$[2]-$[0],re=$[3]-$[1],ne=te*a,ie=re*a,oe=Aw.getEmptyInstance(e,$),ae=oe.list,se=dC(e,O,r,oe,Q,ee,a,ne,ie),le=Aw.getEmptyInstance(e,$),ce=le.list;e.useProgram(M);for(var ue=0,he=ae.length;ue<he;ue++){var de=ae[ue],fe=(W=de.bbox,de.w),pe=de.h;Y=de.t;e.viewport(0,0,fe,pe);var ve=W.slice(0);ve[0]+=V,ve[1]+=K,ve[2]+=V,ve[3]+=K;var ye=ow(e,0,void 0,fe,pe);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ye,0),Y&&pw(e,M,Y,ep(J)),ce.push({bbox:ve,w:fe,h:pe,t:ye})}if(oe.release(),Z){var ge=.5*Z,me=ge*a,be=Rf(Lf(ge)),xe=If(.5*me),Ee=T.boxProgram;e.useProgram(Ee);for(var we=Aw.getEmptyInstance(e,$),Se=we.list,_e=0,Ce=ce.length;_e<Ce;_e++){var Ae=ce[_e],Te=(W=Ae.bbox,Ae.w),Oe=Ae.h;Y=Ae.t;e.viewport(0,0,Te,Oe);ye=Y&&uw(e,Ee,Y,Te,Oe,xe);Se.push({bbox:W.slice(0),w:Te,h:Oe,t:ye})}if(ce.length>1){for(var Me=fC(e,we,Q,ee,te,re,a,be),ke=0,Le=Me.length;ke<Le;ke++){W=(Re=Me[ke]).bbox;var Re,Ie=Re.w,Pe=Re.h;Y=Re.t;e.useProgram(O),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Y,0),e.viewport(0,0,Ie,Pe);for(var Fe=.5*Ie,De=.5*Pe,Ne=!1,Be=(I=0,ce.length);I<Be;I++){var Ue=ce[I],ze=Ue.bbox,Ge=Ue.w,Xe=Ue.h;(nt=Ue.t)&&aC(W,void 0,ze[0],ze[1],Ge,Xe)&&(sw(e,Fe,De,O,[{opacity:1,bbox:ze,texture:nt}],-W[0],-W[1],!1,-1,-1,1,1),Ne=!0)}Ne&&(e.useProgram(Ee),Re.t=uw(e,Ee,Y,Ie,Pe,xe)),e.deleteTexture(Y)}pC(e,O,a,le,Me,$,be)}le.release(),ce=(le=we).list}e.useProgram(O);for(var He=0,je=L.length;He<je;He++){var We=L[He],Ye=(W=We.bbox,We.w),qe=We.h;Y=We.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Y,0),e.viewport(0,0,Ye,qe);Fe=.5*Ye,De=.5*qe,I=0;for(var Ve=ce.length;I<Ve;I++){var Ke=ce[I],Ze=(ze=Ke.bbox,Ke.w),Je=Ke.h;(nt=Ke.t)&&aC(W,void 0,ze[0],ze[1],Ze,Je)&&sw(e,Fe,De,O,[{opacity:1,matrix:b,bbox:ze,texture:nt}],-W[0]*a,-W[1]*a,!1,-1,-1,1,1)}}le.release(),se&&uC(e,se,i,o)}var $e=r.list;for(d=0,f=L.length;d<f;d++){var Qe=L[d],et=(W=Qe.bbox,Qe.w),tt=Qe.h;Y=Qe.t;x?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Y,0),e.viewport(0,0,et,tt)):x=cC(e,Y,et,tt);Fe=.5*et,De=.5*tt,I=0;for(var rt=$e.length;I<rt;I++){var nt,it=$e[I],ot=(ze=it.bbox,it.w),at=it.h;(nt=it.t)&&aC(W,void 0,ze[0],ze[1],ot,at)&&sw(e,Fe,De,O,[{opacity:1,matrix:b,bbox:ze,texture:nt}],-W[0]*a,-W[1]*a,!1,-1,-1,1,1)}}x&&uC(e,x,i,o);return k}(e,t,l||x,E,n,i,o);l&&l.release(),l=w}if(d.t===Yu.GAUSSIAN&&d.radius>=1){w=vC(e,t,l||x,d.radius,n,i,o);l&&l.release(),l=w}else if(d.t===Yu.RADIAL&&d.radius>=1){w=function(e,t,r,n,i,o,a,s){var l=r.bbox,c=Rf(Lf(n)),u=l.slice(0),h=u[2]-u[0],d=u[3]-u[1],f=i[0]*h,p=i[1]*d,v=Math.sqrt(h*h+d*d),y=2*c/v,g=Math.ceil(y*f),m=Math.ceil(y*(h-f)),b=Math.ceil(y*p),x=Math.ceil(y*(d-p));u[0]-=g,u[1]-=b,u[2]+=m,u[3]+=x;var E=u[0],w=u[1],S=u[2]-u[0],_=u[3]-u[1],C=S*s,A=_*s,T=t.programs,O=T.program,M=Aw.getEmptyInstance(e,u),k=M.list,L=dC(e,O,r,M,E,w,s,C,A),R=T.radialProgram;e.useProgram(R);for(var I=Aw.getEmptyInstance(e,u),P=I.list,F=f+g,D=p+b,N=0,B=k.length;N<B;N++){var U=k[N],z=U.bbox,G=U.w,X=U.h,H=U.t;e.viewport(0,0,G,X);var j=z[2]-z[0],W=z[3]-z[1],Y=[(F-z[0]+u[0])/j,(D-z[1]+u[1])/W],q=H&&fw(e,R,H,y,c*s,Y,G,X);P.push({bbox:z.slice(0),w:G,h:X,t:q})}if(k.length>1){var V=fC(e,I,E,w,S,_,s,c);for(N=0,B=V.length;N<B;N++){var K=V[N],Z=(z=K.bbox,K.w),J=K.h;H=K.t;e.useProgram(O),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,H,0),e.viewport(0,0,Z,J);Y=[(F-z[0]+u[0])/(z[2]-z[0]),(D-z[1]+u[0])/(z[3]-z[1])];for(var $=.5*Z,Q=.5*J,ee=!1,te=0,re=k.length;te<re;te++){var ne=k[te],ie=ne.bbox,oe=ne.t,ae=ie[2]-ie[0],se=ie[3]-ie[1];oe&&aC(z,void 0,ie[0],ie[1],ae,se)&&(sw(e,$,Q,O,[{opacity:1,bbox:new Float64Array([ie[0]*s,ie[1]*s,ie[2]*s,ie[3]*s]),texture:oe}],-z[0]*s,-z[1]*s,!1,-1,-1,1,1),ee=!0)}ee&&(e.useProgram(R),K.t=fw(e,R,H,y,c*s,Y,Z,J)),e.deleteTexture(H)}pC(e,O,s,I,V,u,c)}return M.release(),e.useProgram(O),uC(e,L,o,a),I}(e,t,l||x,d.radius,d.center,n,i,o);l&&l.release(),l=w}else if(d.t===Yu.MOTION&&d.radius>=1){w=function(e,t,r,n,i,o,a,s){var l=xd(i),c=Rf(Lf(n)),u=r.bbox.slice(0),h=Math.sin(l),d=Math.cos(l),f=Math.abs(Math.ceil(h*c)),p=Math.abs(Math.ceil(d*c));u[0]-=p,u[1]-=f,u[2]+=p,u[3]+=f;var v=u[0],y=u[1],g=u[2]-u[0],m=u[3]-u[1],b=g*s,x=m*s,E=t.programs,w=E.program,S=Aw.getEmptyInstance(e,u),_=S.list,C=dC(e,w,r,S,v,y,s,b,x),A=n*s,T=Lf(A),O=E.motionProgram;e.useProgram(O);for(var M=Aw.getEmptyInstance(e,u),k=M.list,L=0,R=_.length;L<R;L++){var I=_[L],P=I.bbox,F=I.w,D=I.h,N=I.t;e.viewport(0,0,F,D);var B=N&&dw(e,O,N,T,l,F,D);k.push({bbox:P.slice(0),w:F,h:D,t:B})}if(_.length>1){var U=fC(e,M,v,y,g,m,s,c);for(L=0,R=U.length;L<R;L++){var z=U[L],G=(P=z.bbox,z.w),X=z.h;N=z.t;e.useProgram(w),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,N,0),e.viewport(0,0,G,X);for(var H=.5*G,j=.5*X,W=!1,Y=0,q=_.length;Y<q;Y++){var V=_[Y],K=V.bbox,Z=V.t,J=K[2]-K[0],$=K[3]-K[1];Z&&aC(P,void 0,K[0],K[1],J,$)&&(sw(e,H,j,w,[{opacity:1,bbox:new Float64Array([K[0]*s,K[1]*s,K[2]*s,K[3]*s]),texture:Z}],-P[0]*s,-P[1]*s,!1,-1,-1,1,1),W=!0)}W&&(e.useProgram(O),z.t=dw(e,O,N,T,l,G,X)),e.deleteTexture(N)}pC(e,w,s,M,U,u,c)}return S.release(),e.useProgram(w),uC(e,C,o,a),M}(e,t,l||x,d.radius,d.angle,n,i,o);l&&l.release(),l=w}if(y||1!==g||1!==m||1!==b){w=gC(e,t,l||x,y,g,m,b,n,i);l&&l.release(),l=w}return l}function dC(e,t,r,n,i,o,a,s,l){for(var c,u=bu.maxTextureSize,h=r.list,d=n.list,f=0,p=Math.ceil(l/u);f<p;f++)for(var v=0,y=Math.ceil(s/u);v<y;v++){var g=v===y-1?s-v*u:u,m=f===p-1?l-f*u:u,b=ow(e,0,void 0,g,m),x=i+v*u/a,E=o+f*u/a,w=g/a,S=m/a,_={bbox:new Float64Array([x,E,x+w,E+S]),w:g,h:m,t:b};d.push(_),c?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0),e.viewport(0,0,g,m)):c=cC(e,b,g,m);for(var C=.5*g,A=.5*m,T=0,O=h.length;T<O;T++){var M=h[T],k=M.bbox,L=M.t;L&&aC(k,void 0,x,E,w,S)&&sw(e,C,A,t,[{opacity:1,bbox:new Float64Array([k[0]*a,k[1]*a,k[2]*a,k[3]*a]),texture:L}],-x*a,-E*a,!1,-1,-1,1,1)}}return c}function fC(e,t,r,n,i,o,a,s){for(var l=bu.maxTextureSize,c=l-s*a*2,u=[],h=t.bbox,d=i*a,f=o*a,p=0,v=Math.ceil(f/c);p<v;p++)for(var y=1,g=Math.ceil(d/l);y<g;y++){var m=Math.max(h[0],r+y*l/a-2*s),b=Math.max(h[1],n+p*c/a-s),x=Math.min(h[2],m+4*s),E=Math.min(h[3],b+c/a+2*s),w=new Float64Array([m,b,x,E]);m>h[2]-2*s&&(m=w[0]=Math.max(h[0],h[2]-2*s),x=w[2]=h[2]),b>h[3]-2*s&&(b=w[1]=Math.max(h[1],h[3]-2*s),E=w[3]=h[3]);var S=(w[2]-w[0])*a,_=(w[3]-w[1])*a;u.push({bbox:w,w:S,h:_,t:ow(e,0,void 0,S,_),x1:Math.max(h[0],m+s),y1:Math.max(h[1],p?b+s:b),x2:Math.min(h[2],x-s),y2:Math.min(h[3],p===v-1?E:b+c+s)})}for(p=1,v=Math.ceil(f/l);p<v;p++)for(y=0,g=Math.ceil(d/c);y<g;y++){m=Math.max(h[0],r+y*c/a-s),b=Math.max(h[1],n+p*l/a-2*s),x=Math.min(h[2],m+c/a+2*s),E=Math.min(h[3],b+4*s),w=new Float64Array([m,b,x,E]);m>h[2]-2*s&&(m=w[0]=Math.max(h[0],h[2]-2*s),x=w[2]=h[2]),b>h[3]-2*s&&(b=w[1]=Math.max(h[1],h[3]-2*s),E=w[3]=h[3]);var C=(w[2]-w[0])*a,A=(w[3]-w[1])*a;u.push({bbox:w,w:C,h:A,t:ow(e,0,void 0,C,A),x1:Math.max(h[0],y?m+s:m),y1:Math.max(h[1],b+s),x2:Math.min(h[2],y===g-1?x:m+c+s),y2:Math.min(h[3],E-s)})}return u}function pC(e,t,r,n,i,o,a){e.useProgram(t),e.blendFunc(e.ONE,e.ZERO);for(var s=n.list,l=0,c=s.length;l<c;l++){var u=s[l],h=u.bbox,d=u.w,f=u.h,p=u.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,p,0),e.viewport(0,0,d,f);for(var v=.5*d,y=.5*f,g=0,m=i.length;g<m;g++){var b=i[g],x=b.bbox,E=b.w,w=b.h,S=b.t,_=x.slice(0);_[0]!==o[0]&&(_[0]+=a),_[1]!==o[1]&&(_[1]+=a),_[2]!==o[2]&&(_[2]-=a),_[3]!==o[3]&&(_[3]-=a);var C=_[2]-_[0],A=_[3]-_[1];aC(h,void 0,_[0],_[1],C,A)&&sw(e,v,y,t,[{opacity:1,bbox:new Float64Array([_[0]*r,_[1]*r,_[2]*r,_[3]*r]),texture:S,tc:{x1:(_[0]===o[0]?0:a*r)/E,y1:(_[1]===o[1]?0:a*r)/w,x3:(_[2]===o[2]?E:E-a*r)/E,y3:(_[3]===o[3]?w:w-a*r)/w}}],-h[0]*r,-h[1]*r,!1,-1,-1,1,1)}}e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),i.forEach((function(t){return e.deleteTexture(t.t)}))}function vC(e,t,r,n,i,o,a){var s=Rf(Lf(n)),l=r.bbox.slice(0);l[0]-=s,l[1]-=s,l[2]+=s,l[3]+=s;var c=l[0],u=l[1],h=l[2]-l[0],d=l[3]-l[1],f=h*a,p=d*a,v=t.programs.program,y=Aw.getEmptyInstance(e,l),g=y.list,m=dC(e,v,r,y,c,u,a,f,p),b=n*a,x=0;b>=256?x=4:b>=64?x=3:b>=16?x=2:b>=4&&(x=1);for(var E=If(b*Math.pow(.5,x)),w=Aw.getEmptyInstance(e,l),S=w.list,_=0,C=g.length;_<C;_++){var A=g[_],T=A.bbox,O=A.w,M=A.h,k=A.t;S.push({bbox:T.slice(0),w:O,h:M,t:k&&yC(e,t,E,x,k,O,M)})}if(g.length>1){var L=fC(e,w,c,u,h,d,a,s);for(_=0,C=L.length;_<C;_++){var R=L[_],I=(T=R.bbox,R.w),P=R.h;k=R.t;e.useProgram(v),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,k,0),e.viewport(0,0,I,P);for(var F=.5*I,D=.5*P,N=!1,B=0,U=g.length;B<U;B++){var z=g[B],G=z.bbox,X=z.t,H=G[2]-G[0],j=G[3]-G[1];X&&aC(T,void 0,G[0],G[1],H,j)&&(sw(e,F,D,v,[{opacity:1,bbox:new Float64Array([G[0]*a,G[1]*a,G[2]*a,G[3]*a]),texture:X}],-T[0]*a,-T[1]*a,!1,-1,-1,1,1),N=!0)}N&&(R.t=yC(e,t,E,x,k,I,P),e.deleteTexture(k))}pC(e,v,a,w,L,l,s)}return y.release(),e.useProgram(v),uC(e,m,i,o),w}function yC(e,t,r,n,i,o,a){var s=t.programs,l=s.boxProgram,c=s.dualDownProgram,u=s.dualUpProgram,h=o,d=a,f=void 0;if(n){e.useProgram(c),f=i;for(var p=1;p<=n;p++){var v=Math.ceil(o*Math.pow(.5,p)),y=Math.ceil(a*Math.pow(.5,p));e.viewport(0,0,v,y),f=hw(e,c,m=f,h,d,v,y),m!==i&&e.deleteTexture(m),h=v,d=y}}e.useProgram(l),e.viewport(0,0,h,d);var g=uw(e,l,f||i,h,d,r);if(n){e.useProgram(u),f=g;for(p=n-1;p>=0;p--){var m;v=Math.ceil(o*Math.pow(.5,p)),y=Math.ceil(a*Math.pow(.5,p));e.viewport(0,0,v,y),f=hw(e,u,m=f,h,d,v,y),e.deleteTexture(m),h=v,d=y}g=f}return e.viewport(0,0,o,a),g}function gC(e,t,r,n,i,o,a,s,l){var c=t.programs,u=c.cmProgram;e.useProgram(u);var h,d=r;if(n||1!==i||1!==o||1!==a){var f=xd(n%360),p=Math.cos(f),v=Math.sin(f),y=.213*(1-i),g=.715*(1-i),m=.072*(1-i),b=o-1,x=a,E=.5*(1-x),w=od(n?new Float64Array([.213+.787*p-.213*v,.715-.715*p-.715*v,.072-.072*p+.928*v,0,.213-.213*p+.143*v,.715+.285*p+.14*v,.072-.072*p-.283*v,0,.213-.213*p-.787*v,.715-.715*p+.715*v,.072+.928*p+.072*v,0,0,0,0,1]):nd(),1!==i?new Float64Array([y+i,g,m,0,y,g+i,m,0,y,g,m+i,0,0,0,0,1]):nd());1!==x&&(w[0]*=x,w[1]*=x,w[2]*=x,w[4]*=x,w[5]*=x,w[6]*=x,w[8]*=x,w[9]*=x,w[10]*=x);var S=d,_=function(e,t,r,n,i){for(var o=Aw.getEmptyInstance(e,r.bbox),a=r.list,s=o.list,l=0,c=a.length;l<c;l++){var u=a[l],h=u.bbox,d=u.w,f=u.h,p=u.t,v=ow(e,0,void 0,d,f);i?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),e.viewport(0,0,d,f)):i=cC(e,v,d,f),p&&gw(e,t,p,n),s.push({bbox:h.slice(0),w:d,h:f,t:v})}return{res:o,frameBuffer:i}}(e,u,S,[w[0],w[1],w[2],w[3],b+E,w[4],w[5],w[6],w[7],b+E,w[8],w[9],w[10],w[11],b+E,0,0,0,1],h);d=_.res,h=_.frameBuffer,S!==r&&S.release()}if(e.useProgram(c.program),h)return uC(e,h,s,l),d;e.viewport(0,0,s,l)}function mC(e,t,r,n,i,o,a,s,l,c,u,h){var d,f;if(null===(d=r.textureMask[h])||void 0===d?void 0:d.available)return r.textureMask[h];var p=r.textureTarget[h];if(!r.next)return p;var v=p.list,y=t.programs,g=y.program;e.useProgram(g);var m,b,x=p.bbox,E=r.matrix,w=r.computedStyle,S=x[0],_=x[1],C=S*u,A=_*u,T=x[2]-S,O=x[3]-_,M=T*u,k=O*u,L=Aw.getEmptyInstance(e,x),R=L.list,I=bu.maxTextureSize;r instanceof Fw&&r.onlyImg&&p===r.textureCache[h]&&(r.tempBbox=(r.tempBbox||r._rect||r.rect).slice(0),v=(b=lC(e,t,r,i,o,s,l,c,u,h,!0)).list);var P=nd();ld(P,E),vd(P,1/u);for(var F=gd(P),D=0,N=Math.ceil(k/I);D<N;D++)for(var B=0,U=Math.ceil(M/I);B<U;B++){var z=B===U-1?M-B*I:I,G=D===N-1?k-D*I:I,X=ow(e,0,void 0,z,G),H=S+B*I/u,j=_+D*I/u,W={bbox:new Float64Array([H,j,H+z/u,j+G/u]),w:z,h:G,t:X};R.push(W);var Y=C+B*I,q=A+D*I;m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,X,0),e.viewport(0,0,z,G)):m=cC(e,X,z,G);var V=.5*z,K=.5*G;if([Ju.ALPHA_WITH,Ju.GRAY_WITH].includes(n)&&w.visibility===rh.VISIBLE&&w.opacity>0&&p.available){var Z=null===(f=v[D*U+B])||void 0===f?void 0:f.t;Z&&sw(e,V,K,g,[{opacity:1,bbox:new Float64Array([0,0,z,G]),texture:Z}],0,0,!1,-1,-1,1,1)}for(var J=!D&&!B,$=o+s+1,Q=i.length;$<Q;$++){var ee=i[$],te=ee.node,re=ee.lv,ne=ee.total,ie=ee.next,oe=te.computedStyle;if(a>re){r.struct.next=$-o-s-1;break}if($===Q||oe.breakMask&&a===re){r.struct.next=$-o-s-1;break}var ae=wC(te,oe,h),se=ae.shouldIgnore,le=ae.isBgBlur;if(se)$+=ne+ie;else{J&&te.isBitmap&&te.checkLoader()&&t.imgLoadList.push(te);var ce=void 0,ue=void 0;if(J){if(a===re)ce=te.tempOpacity=oe.opacity,ue=od(F,te.matrix);else{var he=te.parent;ce=te.tempOpacity=oe.opacity*he.tempOpacity,ue=od(he.tempMatrix,te.matrix)}ld(te.tempMatrix,ue)}else ce=te.tempOpacity,ue=te.tempMatrix;var de=te.textureTarget[h];if(!de&&te.hasContent&&(te.genTexture(e,u,h),de=te.textureTarget[h]),de&&de.available){var fe=oe.mixBlendMode,pe=oe.blur;if(!aC(de.bbox,ue,Y,q,z,G))continue;if(le&&$>o+s+1){var ve=te.textureOutline[u]=EC(e,te,i,$,ne,de.bbox,u);ld(te.tempMatrix,ue),xC(e,t,L,ue,ve,pe,y,u,T,O),e.bindFramebuffer(e.FRAMEBUFFER,m),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W.t,0),e.viewport(0,0,z,G)}for(var ye=de.list,ge=0,me=ye.length;ge<me;ge++){var be=ye[ge],xe=be.bbox,Ee=be.t;if(Ee&&aC(xe,ue,Y,q,z,G)){var we=void 0;fe!==Hu.NORMAL&&($>o+s+1&&[Ju.OUTLINE,Ju.ALPHA,Ju.GRAY].includes(n)||$>o+s&&[Ju.ALPHA_WITH,Ju.GRAY_WITH].includes(n))&&(we=ow(e,0,void 0,z,G),m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,we,0),e.viewport(0,0,z,G)):m=cC(e,we,z,G)),sw(e,V,K,g,[{opacity:ce,matrix:ue,bbox:xe,texture:Ee}],-Y,-q,!1,-1,-1,1,1),fe!==Hu.NORMAL&&we&&(W.t=bC(e,W.t,we,fe,y,z,G))}}}de&&de.available&&de!==te.textureCache[h]||oe.maskMode?$+=ne+ie:te.isShapeGroup&&($+=ne)}}}var Se,_e=Aw.getEmptyInstance(e,x),Ce=_e.list;n===Ju.OUTLINE&&(Se=(ve=r.textureOutline[u]=EC(e,r,i,o,s,x,u)).list);if(n===Ju.GRAY||n===Ju.GRAY_WITH){var Ae=y.maskGrayProgram;e.useProgram(Ae);for(D=0,N=R.length;D<N;D++){var Te=R[D],Oe=Te.bbox,Me=Te.w,ke=Te.h;X=Te.t,we=void 0;v[D]&&v[D].t&&X&&(we=ow(e,0,void 0,Me,ke),m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,we,0),e.viewport(0,0,Me,ke)):m=cC(e,we,Me,ke),v[D]&&v[D].t&&cw(e,Ae,v[D].t,X)),Ce.push({bbox:Oe.slice(0),w:Me,h:ke,t:we})}}else{var Le=y.maskProgram;for(D=0,N=R.length;D<N;D++){var Re=R[D],Ie=Re.bbox,Pe=Re.w,Fe=Re.h;X=Re.t,we=ow(e,0,void 0,Pe,Fe);m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,we,0),e.viewport(0,0,Pe,Fe)):m=cC(e,we,Pe,Fe),[Ju.OUTLINE].includes(n)&&r.computedStyle.visibility===rh.VISIBLE&&r.computedStyle.opacity&&(e.useProgram(g),sw(e,.5*Pe,.5*Fe,g,[{opacity:1,bbox:new Float64Array([0,0,Pe,Fe]),texture:v[D].t}],0,0,!1,-1,-1,1,1)),e.useProgram(Le),cw(e,Le,Se?Se[D].t:v[D].t,X),Ce.push({bbox:Ie.slice(0),w:Pe,h:Fe,t:we})}}return e.useProgram(g),L.release(),b&&b.release(),m?uC(e,m,l,c):e.viewport(0,0,l,c),_e}function bC(e,t,r,n,i,o,a){var s;n===Hu.MULTIPLY?s=i.multiplyProgram:n===Hu.SCREEN?s=i.screenProgram:n===Hu.OVERLAY?s=i.overlayProgram:n===Hu.DARKEN?s=i.darkenProgram:n===Hu.LIGHTEN?s=i.lightenProgram:n===Hu.COLOR_DODGE?s=i.colorDodgeProgram:n===Hu.COLOR_BURN?s=i.colorBurnProgram:n===Hu.HARD_LIGHT?s=i.hardLightProgram:n===Hu.SOFT_LIGHT?s=i.softLightProgram:n===Hu.DIFFERENCE?s=i.differenceProgram:n===Hu.EXCLUSION?s=i.exclusionProgram:n===Hu.HUE?s=i.hueProgram:n===Hu.SATURATION?s=i.saturationProgram:n===Hu.COLOR?s=i.colorProgram:n===Hu.LUMINOSITY?s=i.luminosityProgram:(dh.error("Unknown mixBlendMode: "+n),s=i.program),e.useProgram(s);var l=ow(e,0,void 0,o,a);return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,l,0),vw(e,s,t,r),e.deleteTexture(t),e.deleteTexture(r),e.useProgram(i.program),l}function xC(e,t,r,n,i,o,a,s,l,c){for(var u,h=a.program,d=vC(e,t,r,o.radius,l,c,s),f=d.list,p=i.list,v=[],y=0,g=f.length;y<g;y++){var m=f[y],b=m.bbox,x=.5*(O=m.w),E=.5*(M=m.h),w=ow(e,0,void 0,O,M);v.push(w),u?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,w,0),e.viewport(0,0,O,M)):u=cC(e,w,O,M);for(var S=0,_=p.length;S<_;S++){var C=p[S],A=C.bbox;(G=C.t)&&aC(A,n,b[0]*s,b[1]*s,(b[2]-b[0])*s,(b[3]-b[1])*s)&&sw(e,x,E,h,[{opacity:1,matrix:n,bbox:A,texture:G}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}var T=a.maskProgram;e.useProgram(T);for(y=0,g=f.length;y<g;y++){var O=(N=f[y]).w,M=N.h,k=N.t;w=ow(e,0,void 0,O,M);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,w,0),e.viewport(0,0,O,M),k&&(cw(e,T,v[y],k),e.deleteTexture(k)),e.deleteTexture(v[y]),N.t=w}if(void 0!==o.saturation&&1!==o.saturation&&(k=gC(e,t,d||r,0,o.saturation,1,1,l,c))){for(y=0,g=f.length;y<g;y++)f[y].t&&e.deleteTexture(f[y].t),f[y].t=k.list[y].t;u&&e.bindFramebuffer(e.FRAMEBUFFER,u)}e.useProgram(h);var L=[],R=r.list;for(y=0,g=R.length;y<g;y++){var I=R[y];b=I.bbox,x=.5*(O=I.w),E=.5*(M=I.h),w=ow(e,0,void 0,O,M);L.push(w),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,w,0),e.viewport(0,0,O,M);S=0;for(var P=p.length;S<P;S++){var F=p[S];A=F.bbox;(G=F.t)&&aC(A,n,b[0]*s,b[1]*s,(b[2]-b[0])*s,(b[3]-b[1])*s)&&sw(e,x,E,h,[{opacity:1,matrix:n,bbox:A,texture:G}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}var D=a.clipProgram;e.useProgram(D);for(y=0,g=R.length;y<g;y++){var N;O=(N=R[y]).w,M=N.h,k=N.t,w=ow(e,0,void 0,O,M);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,w,0),e.viewport(0,0,O,M),k&&(cw(e,D,L[y],k),e.deleteTexture(k)),e.deleteTexture(L[y]),N.t=w}e.useProgram(h);var B=nd();1!==s&&vd(B,s),e.blendFunc(e.ONE,e.ONE);for(y=0,g=R.length;y<g;y++){var U=R[y];b=U.bbox,O=U.w,M=U.h,k=U.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,k,0),e.viewport(0,0,O,M);S=0;for(var z=f.length;S<z;S++){var G,X=f[S];A=X.bbox;(G=X.t)&&aC(A,void 0,b[0],b[1],b[2]-b[0],b[3]-b[1])&&sw(e,.5*O,.5*M,h,[{opacity:1,matrix:B,bbox:A,texture:G}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),u?uC(e,u,l,c):e.viewport(0,0,l,c)}function EC(e,t,r,n,i,o,a){var s;if(null===(s=t.textureOutline[a])||void 0===s?void 0:s.available)return t.textureOutline[a];var l=o[0],c=o[1],u=o[2]-l,h=o[3]-c,d=-l*a,f=-c*a,p=u*a,v=h*a,y=Iw.getInstance(p,v,d,f);y.available=!0;for(var g=y.list,m=function(e,t){var o=g[e],s=o.x,l=o.y,c=o.os.ctx,u=-s,d=-l;c.fillStyle="#FFF";for(var f=n,p=n+i+1;f<p;f++){var v=r[f],y=v.node,m=v.total,b=v.next,x=void 0;if(f===n)x=ad(y.tempMatrix);else x=od(y.parent.tempMatrix,y.matrix),ld(y.tempMatrix,x);var E=y.computedStyle.fillRule===Zu.EVEN_ODD?"evenodd":"nonzero";if(c.setTransform(x[0],x[1],x[4],x[5],x[12],x[13]),y instanceof Jw){var w=y.coords;c.beginPath(),JE(c,w,a,u,d),c.closePath(),c.fill(E)}else if(y instanceof rC){w=y.coords;c.beginPath(),w.forEach((function(e){JE(c,e,a,u,d)})),c.closePath(),c.fill(E),f+=m+b}else if(y instanceof t_)for(var S=y.lineBoxList,_=0,C=S.length;_<C;_++){var A=S[_];if(A.y>=h)break;for(var T=A.list,O=T.length,M=0;M<O;M++){var k=T[M];t_.setFontAndLetterSpacing(c,k,a),c.fillText(k.str,k.x*a+u,(k.y+k.baseline)*a+d)}}else c.fillRect(u,d,y.width*a,y.height*a),y instanceof WS&&(f+=m+b)}},b=0,x=g.length;b<x;b++)m(b);var E=Aw.getInstance(e,y,o);return y.release(),E}function wC(e,t,r){var n=t.blur,i=n.t===Yu.BACKGROUND&&(n.radius>0||1!==n.saturation)&&(e instanceof rC||e instanceof zw||e instanceof Fw||e instanceof t_),o=t.visibility===rh.HIDDEN||t.opacity<=0;if(o&&t.maskMode&&e.next&&(o=!1),o&&t.maskMode&&t.opacity>0){var a=e.textureTarget[r];t.maskMode===Ju.OUTLINE?(t.visibility===rh.VISIBLE||a!==e.textureTotal[r]&&a!==e.textureCache[r])&&(o=!1):t.maskMode===Ju.ALPHA&&e.next&&a!==e.textureTotal[r]&&a!==e.textureCache[r]&&(o=!1)}return o&&i&&t.visibility===rh.VISIBLE&&(o=!1),{shouldIgnore:o,isBgBlur:i}}function SC(e){e.valid=!0;for(var t=e.subList;t.length;){var r=t.pop();r.valid=!0;for(var n=r.subList;n.length;)t.push(n.pop())}}function _C(e,t){var r=t.getCurPageZoom(),n=0;if(r<=1)1===r?(r=2,n=1):r=1;else{for(var i=1;r>1;)r*=.5,i<<=1,n++;r=i}t.scale=r,t.scaleIndex=n;var o=t.imgLoadList,a=t.lastPage;bu.tile&&a?CC(e,t,r,n):TC(e,t,r,n);for(var s=0,l=o.length;s<l;s++)o[s].loadAndRefresh();o.splice(0)}function CC(e,t,r,n){var i=t.structs,o=t.lastPage,a=t.width,s=t.height,l=t.dpi,c=t.imgLoadList,u=t.tileRecord,h=o.computedStyle.scaleX,d=o.matrixWorld,f=h,p=1;if(f<.5)for(;f<.5;)f*=2,p*=.5;else p=r/l;var v=h/p,y=t.tileManager;y.setPage(o);var g=yd({x:0,y:0},d),m=g.x,b=g.y,x=Sw.UNIT*v*l,E=0,w=0,S=m%x,_=b%x,C=Math.floor(-m/x),A=Math.floor(-b/x);E=S>0?Math.ceil((a-S)/x)+1:Math.ceil((a-S)/x),w=_>0?Math.ceil((s-_)/x)+1:Math.ceil((s-_)/x);var T=Math.round(Sw.UNIT/p),O=y.active(p,C*T,A*T,E,w),M=.5*a,k=.5*s,L=t.programs,R=L.program;e.useProgram(L.program);for(var I=[],P=new Float64Array([0,0,a,s]),F=!0,D=0,N=O.length;D<N;D++){(dt=O[D]).init(l),dt.complete||(F=!1);var B=dt.x,U=dt.y,z=md(B,U,B+T,U+T,d);dt.bbox[0]=z.x1,dt.bbox[1]=z.y1,dt.bbox[2]=z.x3,dt.bbox[3]=z.y3}var G=0,X=0,H=a,j=s;if(O.length){var W=O[0],Y=O[O.length-1];G=W.bbox[0],X=W.bbox[1],H=Y.bbox[2],j=Y.bbox[3]}var q=Date.now(),V=nC(e,t,r,n,G,X,H,j,q),K=V.mergeRecord,Z=V.breakMerge,J=Object.keys(u);for(D=0,N=J.length;D<N;D++){if((ge=u[J[D]])&&ge.hasContent&&ge.computedStyle.maskMode!==Ju.ALPHA){var $=ge.matrixWorld;if(aC(z=ge.filterBbox,$,G,X,H-G,j-X))for(var Q=md(z[0],z[1],z[2],z[3],$),ee=0,te=O.length;ee<te;ee++){var re=(dt=O[ee]).bbox;Td(re[0],re[1],re[2],re[3],[{x:Q.x1,y:Q.y1},{x:Q.x2,y:Q.y2},{x:Q.x3,y:Q.y3},{x:Q.x4,y:Q.y4}])&&(dt.clean(),F=!1)}}}t.tileRecord={};for(D=0,N=K.length;D<N;D++){var ne=K[D];if(aC(z=ne.bbox,$=ne.m,G,X,H-G,j-X)){Q=md(z[0],z[1],z[2],z[3],$),ee=0;for(var ie=O.length;ee<ie;ee++){var oe=(dt=O[ee]).bbox;dt.count&&Td(oe[0],oe[1],oe[2],oe[3],[{x:Q.x1,y:Q.y1},{x:Q.x2,y:Q.y2},{x:Q.x3,y:Q.y3},{x:Q.x4,y:Q.y4}])&&(dt.clean(),F=!1)}}}var ae=t.overlay,se=!1;if(!F){var le=!0,ce=void 0,ue=gd(d),he=Sw.UNIT*l,de=.5*he;if(t.tileLastIndex){var fe=(ge=i[t.tileLastIndex].node).artBoard;if(fe&&ge!==fe){var pe=fe.struct;if((me=pe.total)+(be=pe.next)){I[(D=i.indexOf(fe.struct))+me+be]=fe;var ve=md((z=fe._bbox||fe.bbox)[0],z[1],z[2],z[3],fe.matrixWorld);P[0]=ve.x1,P[1]=ve.y1,P[2]=ve.x3,P[3]=ve.y3}}}for(D=0,N=O.length;D<N;D++){!(dt=O[D]).count&&!dt.complete&&dt.texture&&dt.needClear&&(dt.needClear=!1,ce?e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,dt.texture,0):ce=cC(e,dt.texture,he,he),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT))}for(D=t.tileLastIndex,N=i.length;D<N;D++){var ye=i[D],ge=ye.node,me=ye.total,be=ye.next;if(ae===ge)break;var xe=ge.computedStyle,Ee=wC(ge,xe,n),we=Ee.shouldIgnore;if(Ee.isBgBlur,we)I[D+=me+be]&&(AC(O),P[0]=0,P[1]=0,P[2]=a,P[3]=s);else{var Se=ge.parent,_e=ge.textureTarget;OC(ge,D,Se);var Ce=ge._opacity,Ae=ge._matrixWorld,Te=_e[n],Oe=!1;if(Te&&Te.available?Oe=aC(Te.bbox,Ae,G,X,H-G,j-X):(Oe=aC(ge._filterBbox||ge.filterBbox,Ae,G,X,H-G,j-X))&&ge.hasContent&&ge.computedStyle.maskMode!==Ju.ALPHA&&(ge.genTexture(e,r,n),Te=_e[n]),Oe)if(ge.isArtBoard&&ge instanceof kw){if(me+be){ve=md((z=ge._bbox||ge.bbox)[0],z[1],z[2],z[3],Ae);P[0]=ve.x1,P[1]=ve.y1,P[2]=ve.x3,P[3]=ve.y3}}else 0===P[0]&&0===P[1]&&P[2]===a&&P[3]===s||(Oe=Te&&Te.available?aC(Te.bbox,Ae,P[0],P[1],P[2]-P[0],P[3]-P[1]):aC(ge._filterBbox||ge.filterBbox,Ae,P[0],P[1],P[2]-P[0],P[3]-P[1]));else if(ge.isArtBoard&&ge instanceof kw){AC(O),P[0]=0,P[1]=0,P[2]=a,P[3]=s;continue}if(Oe&&ge.isBitmap&&ge.checkLoader()&&c.push(ge),Oe){if(!le&&Date.now()-q>bu.deltaTime){se=!0,t.tileLastIndex=D;break}var Me=Te&&Te.available||!1,ke=xe.mixBlendMode,Le=(Q=md((z=Me?Te.bbox:ge._filterBbox||ge.filterBbox)[0],z[1],z[2],z[3],Ae),$=od(ue,Ae),p*l);if(1!==Le)vd(We=nd(),Le),$=od(We,$);var Re=Me&&1===Te.list.length?bw(z,de,de,0,0,!1,$):void 0,Ie=[],Pe=(ve=void 0,ge.isArtBoard&&ge instanceof kw);if(Pe){var Fe=ge._bbox||ge.bbox;ve=md(Fe[0],Fe[1],Fe[2],Fe[3],$),I[D+me+be]=ge;var De=md(Fe[0],Fe[1],Fe[2],Fe[3],ge.matrixWorld);P[0]=De.x1,P[1]=De.y1,P[2]=De.x3,P[3]=De.y3}ee=0;for(var Ne=O.length;ee<Ne;ee++){var Be=(dt=O[ee]).bbox;if(Pe&&(dt.x1=(ve.x1-dt.x*Le-de)/de,dt.y1=(ve.y1-dt.y*Le-de)/de,dt.x2=(ve.x3-dt.x*Le-de)/de,dt.y2=(ve.y3-dt.y*Le-de)/de),(ge.hasContent||Pe)&&!dt.complete&&!dt.has(ge)&&Td(Be[0],Be[1],Be[2],Be[3],[{x:Q.x1,y:Q.y1},{x:Q.x2,y:Q.y2},{x:Q.x3,y:Q.y3},{x:Q.x4,y:Q.y4}])&&(ge.addTile(dt),dt.add(ge),(Me||Pe)&&!(dt.x1>1||dt.y1>1||dt.x2<-1||dt.y2<-1))){le&&(le=!1),ce?e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,dt.texture,0):ce=cC(e,dt.texture,he,he),0===dt.count&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),Pe&&ge.renderBgcTile(e,de,M,k,Le,dt,ve);var Ue=null==Te?void 0:Te.list;if(Ue&&Ue.length){var ze=void 0;if(ke!==Hu.NORMAL&&(ze=ow(e,0,void 0,he,he),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ze,0)),1===Ue.length)Ue[0].t&&sw(e,de,de,R,[{opacity:Ce,bbox:z,coords:Re,texture:Ue[0].t}],-dt.x*Le/de,-dt.y*Le/de,!1,dt.x1,dt.y1,dt.x2,dt.y2);else if(Ue.length>1)for(var Ge=0,Xe=Ue.length;Ge<Xe;Ge++){var He=Ue[Ge],je=He.bbox,We=He.t,Ye=md(je[0],je[1],je[2],je[3],Ae);Td(Be[0],Be[1],Be[2],Be[3],[{x:Ye.x1,y:Ye.y1},{x:Ye.x2,y:Ye.y2},{x:Ye.x3,y:Ye.y3},{x:Ye.x4,y:Ye.y4}])&&(Ie[Ge]=Ie[Ge]||bw(je,de,de,0,0,!1,$),We&&sw(e,de,de,R,[{opacity:Ce,bbox:je,coords:Ie[Ge],texture:We}],-dt.x*Le/de,-dt.y*Le/de,!1,dt.x1,dt.y1,dt.x2,dt.y2))}if(ke!==Hu.NORMAL){We=bC(e,dt.texture,ze,ke,L,he,he);dt.updateTex(We)}}}}}Te&&Te.available&&Te!==ge.textureCache[n]||xe.maskMode?D+=me+be:ge.isShapeGroup&&(D+=me),I[D]&&(AC(O),P[0]=0,P[1]=0,P[2]=a,P[3]=s)}}ce&&uC(e,ce,a,s)}for(D=0,N=O.length;D<N;D++){if((dt=O[D]).available&&dt.count)sw(e,M,k,R,[{opacity:1,bbox:dt.bbox,texture:dt.texture}],0,0,!0,-1,-1,1,1);else{var qe=dt.x,Ve=dt.y,Ke=y.getDowngrade(p,qe,Ve);if(Ke&&Ke.length){ee=0;for(var Ze=Ke.length;ee<Ze;ee++){var Je=Ke[ee],$e=Je.scale/p;if($e<1){var Qe=(qe-Je.tile.x)/Je.tile.size,et=(Ve-Je.tile.y)/Je.tile.size;sw(e,M,k,R,[{opacity:1,bbox:dt.bbox,texture:Je.tile.texture,tc:{x1:Qe,y1:et,x3:Qe+$e,y3:et+$e}}],0,0,!0,-1,-1,1,1)}else if($e>1){var tt=(Je.tile.x-qe)/dt.size,rt=(Je.tile.y-Ve)/dt.size,nt=(z=dt.bbox)[2]-z[0],it=z[3]-z[1],ot=z[0]+tt*nt,at=z[1]+rt*it;sw(e,M,k,R,[{opacity:1,bbox:new Float64Array([ot,at,ot+nt/$e,at+it/$e]),texture:Je.tile.texture}],0,0,!0,-1,-1,1,1)}}}}se||(dt.complete=!0)}if(bu.debug){var st=L.tileProgram;e.useProgram(st);var lt=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,lt),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var ct=e.getAttribLocation(st,"a_position");e.vertexAttribPointer(ct,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(ct);var ut=e.getUniformLocation(st,"u_width");e.uniform1f(ut,1/M);var ht=e.getUniformLocation(st,"u_height");e.uniform1f(ht,1/k);for(D=0,N=O.length;D<N;D++){var dt=O[D],ft=e.getUniformLocation(st,"u_x1");e.uniform1f(ft,(dt.bbox[0]-M)/M);var pt=e.getUniformLocation(st,"u_y1");e.uniform1f(pt,(k-dt.bbox[3])/k);var vt=e.getUniformLocation(st,"u_x2");e.uniform1f(vt,(dt.bbox[2]-M)/M);var yt=e.getUniformLocation(st,"u_y2");e.uniform1f(yt,(k-dt.bbox[1])/k);var gt=e.getUniformLocation(st,"u_count");e.uniform1i(gt,dt.count),e.drawArrays(e.TRIANGLE_STRIP,0,4)}e.deleteBuffer(lt),e.disableVertexAttribArray(ct),e.useProgram(R)}if(kC(e,M,k,a,s,t,!0),se&&(t.tileRemain=!0,t.addUpdate(t,[],XE.CACHE,!1,!1,void 0)),Z&&Z.length&&(t.tileLastIndex=0),Z&&Z.length)for(D=0,N=Z.length;D<N;D++)t.addUpdate(Z[D].node,[],XE.CACHE,!1,!1,void 0)}function AC(e){e.forEach((function(e){e.x1=e.y1=-1,e.x2=e.y2=1}))}function TC(e,t,r,n){var i,o=t.structs,a=t.width,s=t.height,l=t.imgLoadList,c=nC(e,t,r,n,0,0,a,s,Date.now()).breakMerge,u=.5*a,h=.5*s,d=t.programs,f=[],p=t.pageTexture||ow(e,0,void 0,a,s),v=p,y=cC(e,v,a,s);e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);var g=t.overlay,m=d.program;e.useProgram(d.program);for(var b=-1,x=-1,E=1,w=1,S=new Float64Array([0,0,a,s]),_=0,C=o.length;_<C;_++){var A=o[_],T=A.node,O=A.total,M=A.next;if(g===T)break;var k=T.computedStyle,L=wC(T,k,n),R=L.shouldIgnore,I=L.isBgBlur;if(R)f[_+=O+M]&&(S[0]=0,S[1]=0,S[2]=a,S[3]=s,b=x=-1,E=w=1,v=MC(e,m,u,h,a,s,p,v));else{var P=T.parent,F=T.textureTarget;OC(T,_,P);var D=T._opacity,N=T._matrixWorld,B=F[n],U=!1;if(B&&B.available?U=oC(B.bbox,N,a,s):(U=oC(T._filterBbox||T.filterBbox,N,a,s))&&T.hasContent&&T.computedStyle.maskMode!==Ju.ALPHA&&(T.genTexture(e,r,n),B=F[n]),U)if(T.isArtBoard&&T instanceof kw){if(T.renderBgc(e,u,h),O+M){f[_+O+M]=T;var z=md((Q=T._bbox||T.bbox)[0],Q[1],Q[2],Q[3],N);S[0]=z.x1,S[1]=z.y1,S[2]=z.x3,S[3]=z.y3,b=(z.x1-u)/u,x=(z.y1-h)/h,E=(z.x3-u)/u,w=(z.y3-h)/h,i=ow(e,0,void 0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),v=i}}else 0===S[0]&&0===S[1]&&S[2]===a&&S[3]===s||(U=B&&B.available?aC(B.bbox,N,S[0],S[1],S[2]-S[0],S[3]-S[1]):aC(T._filterBbox||T.filterBbox,N,S[0],S[1],S[2]-S[0],S[3]-S[1]));else if(T.isArtBoard&&T instanceof kw){_+=O+M;continue}if(U&&T.isBitmap&&T.checkLoader()&&l.push(T),U&&B&&B.available){var G=k.mixBlendMode,X=k.blur;if(I&&_){var H=T.textureOutline[r]=EC(e,T,o,_,O,B.bbox,r),j=a/t.dpi,W=s/t.dpi,Y=Aw.getEmptyInstance(e,new Float64Array([0,0,j,W]));Y.list.push({bbox:new Float64Array([0,0,j,W]),w:a,h:s,t:v});var q=v===p;xC(e,t,Y,N,H,X,d,r,a,s),v=Y.list[0].t,q&&(p=v),e.bindFramebuffer(e.FRAMEBUFFER,y),e.viewport(0,0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0)}var V=void 0;G!==Hu.NORMAL&&(V=ow(e,0,void 0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,V,0));for(var K=B.list,Z=0,J=K.length;Z<J;Z++){var $=K[Z],Q=$.bbox,ee=$.t;ee&&sw(e,u,h,m,[{opacity:D,matrix:N,bbox:Q,texture:ee}],0,0,!1,b,x,E,w)}G!==Hu.NORMAL&&(v=bC(e,v,V,G,d,a,s))}(null==B?void 0:B.available)&&B!==T.textureCache[n]||k.maskMode?_+=O+M:T.isShapeGroup&&(_+=O),f[_]&&(S[0]=0,S[1]=0,S[2]=a,S[3]=s,b=x=-1,E=w=1,v=MC(e,m,u,h,a,s,p,v))}}if(kC(e,u,h,a,s,t,!1),uC(e,y,a,s),sw(e,u,h,m,[{opacity:1,bbox:new Float64Array([0,0,a,s]),texture:v}],0,0,!0,-1,-1,1,1),t.pageTexture=v,c&&c.length)for(_=0,C=c.length;_<C;_++)t.addUpdate(c[_].node,[],XE.CACHE,!1,!1,void 0)}function OC(e,t,r){var n=!1,i=!1;t?(n=e.hasCacheOp&&e.parentOpId===r.localOpId,i=e.hasCacheMw&&e.parentMwId===r.localMwId):(n=e.hasCacheOp,i=e.hasCacheMw),n||(e._opacity=r?r._opacity*e.computedStyle.opacity:e.computedStyle.opacity,r&&(e.parentOpId=r.localOpId),e.hasCacheOp=!0),i||(ld(e._matrixWorld,r?od(r._matrixWorld,e.matrix):e.matrix),r&&(e.parentMwId=r.localMwId),e.hasCacheMw&&e.localMwId++,e.hasCacheMw=!0)}function MC(e,t,r,n,i,o,a,s){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),sw(e,r,n,t,[{opacity:1,bbox:new Float64Array([0,0,i,o]),texture:s}],0,0,!1,-1,-1,1,1),e.deleteTexture(s),a}function kC(e,t,r,n,i,o,a){var s=o.overlay,l=o.structs,c=o.programs;s.update();for(var u=l.indexOf(s.struct),h=c.program,d=u,f=l.length;d<f;d++){var p=(k=l[d].node).parent,v=k.textureTarget;OC(k,d,p);var y=k._opacity,g=k._matrixWorld,m=v[0];if(!m&&k.hasContent&&(k.genTexture(e,1,0),m=v[0]),m&&m.available)if(oC(m.bbox,g,n,i))for(var b=m.list,x=0,E=b.length;x<E;x++){var w=b[x],S=w.bbox,_=w.t;_&&sw(e,t,r,h,[{opacity:y,matrix:g,bbox:S,texture:_}],0,0,a,-1,-1,1,1)}}var C=c.sliceProgram;e.useProgram(C);var A=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,A),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var T=e.getAttribLocation(C,"a_position");e.vertexAttribPointer(T,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(T);var O=e.getUniformLocation(C,"u_width");e.uniform1f(O,1/t);var M=e.getUniformLocation(C,"u_height");e.uniform1f(M,1/r);for(d=0;d<u;d++){var k;if((k=l[d].node).isSlice&&k instanceof Lw){g=k._matrixWorld;if(oC(S=k._rect||k.rect,g,n,i)){var L=k.getBoundingClientRect({excludeRotate:!0}),R=e.getUniformLocation(C,"u_x1");e.uniform1f(R,(L.left-t)/t);var I=e.getUniformLocation(C,"u_x2");e.uniform1f(I,(L.right-t)/t);var P=e.getUniformLocation(C,"u_y1"),F=e.getUniformLocation(C,"u_y2");a?(e.uniform1f(F,(r-L.top)/r),e.uniform1f(P,(r-L.bottom)/r)):(e.uniform1f(P,(L.top-r)/r),e.uniform1f(F,(L.bottom-r)/r)),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}}e.deleteBuffer(A),e.disableVertexAttribArray(T),e.useProgram(h)}var LC={level:ZE,paint:rw,Tile:Sw,TileManager:_w,struct:{renderWebgl:_C,renderWebglNoTile:TC,renderWebglTile:CC,renderOverlay:kC}},RC={font:Hh,transform:Fd,define:yh,css:fp,gradient:Wf},IC={type:Fu,Event:Tw,inject:dh,opentype:Bh,config:bu},PC={frame:qS},FC={ArtBoard:kw,Bitmap:Fw,Container:Mw,Group:WS,Node:Ow,Page:c_,Root:f_,Slice:Lw,SymbolInstance:i_,SymbolMaster:JS,Text:t_,Geom:zw,Polyline:Jw,ShapeGroup:rC,reflow:d_,parser:l_};function DC(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,v,y){void 0===y&&(y=!1);var g=v.fontFamily,m=v.color,b=v.fontSize,x=v.letterSpacing,E=v.lineHeight,w=v.paragraphSpacing,S=v.textAlign;n.includes(g)||n.push(g);var _=Hh.data[g];if(_){i.includes(_.family)||(i.push(_.family),o.push(_.name)),r.includes(!0)||r.push(!0);for(var C=_.list,A=0,T=C.length;A<T;A++){var O=C[A];if(O.postscriptName===g){l.includes(O.style)||l.push(O.style);break}}}else i.includes(g)||(i.push(g),o.push(g)),r.includes(!1)||r.push(!1);var M=Qf(m);a.includes(M)||a.push(M),s.includes(b)||s.push(b),c.includes(x)||c.push(x);var k=y?!E:t.u===zu.AUTO;if(h.includes(k)||h.push(k),k&&_){var L=b*_.lhr;u.includes(L)||u.push(L)}else u.includes(E)||u.push(E);d.includes(w)||d.push(w),f.includes(S)||f.push(S);var R=NC(e);p.includes(R)||p.push(R)}function NC(e){var t=e.style,r=t.left,n=t.right,i=t.top,o=t.bottom,a=t.width,s=t.height,l=nh.AUTO,c=a.u===zu.AUTO&&(r.u===zu.AUTO||n.u===zu.AUTO),u=s.u===zu.AUTO&&(i.u===zu.AUTO||o.u===zu.AUTO);return c&&u||(l=u?nh.FIXED_W:nh.FIXED_W_H),l}function BC(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],c=[],u=[],h=[],d=[],f=[],p=[],v=0,y=e.length;v<y;v++){var g=e[v],m=g.rich,b=g.style,x=g.computedStyle;d.includes(x.textVerticalAlign)||d.push(x.textVerticalAlign);var E=b.lineHeight;if(m&&m.length)for(var w=0,S=m.length;w<S;w++)DC(g,E,t,r,n,i,o,a,p,s,l,c,u,h,f,m[w],!0);else DC(g,E,t,r,n,i,o,a,p,s,l,c,u,h,f,x)}var _=[];return 1===n.length&&(_=UC(n[0])),{valid:t,postscriptName:r,fontFamily:n,name:i,fontWeight:p,fontWeightList:_,color:o,fontSize:a,autoLineHeight:c,lineHeight:l,letterSpacing:s,paragraphSpacing:u,textAlign:h,textVerticalAlign:d,textBehaviour:f}}function UC(e){var t=Hh.data[e];return t?t.list.map((function(e){return{label:e.style,value:e.postscriptName}})):[]}function zC(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],c=[],u=[],h=[],d=[e.computedStyle.textVerticalAlign],f=[],p=[],v=e.getCursorRich(),y=e.style.lineHeight,g=0,m=v.length;g<m;g++)DC(e,y,t,r,n,i,o,a,p,s,l,c,u,h,f,v[g],!0);var b=[];return 1===n.length&&(b=UC(n[0])),{valid:t,postscriptName:r,fontFamily:n,name:i,fontWeight:p,fontWeightList:b,color:o,fontSize:a,autoLineHeight:c,lineHeight:l,letterSpacing:s,paragraphSpacing:u,textAlign:h,textVerticalAlign:d,textBehaviour:f}}function GC(e,t){var r={},n=e.getStyle(),i=n.left,o=n.right,a=n.top,s=n.bottom,l=n.width,c=n.height;t===nh.AUTO?(l.u!==zu.AUTO&&(r.width="auto"),c.u!==zu.AUTO&&(r.height="auto"),i.u!==zu.AUTO&&o.u!==zu.AUTO&&(i.u===zu.PX?r.right="auto":o.u===zu.PX?r.left="auto":r.right="auto"),a.u!==zu.AUTO&&s.u!==zu.AUTO&&(a.u===zu.PX?r.bottom="auto":s.u===zu.PX?r.top="auto":r.bottom="auto")):t===nh.FIXED_W?(l.u===zu.PX||i.u===zu.PX&&o.u===zu.PX||(r.width=e.width),c.u!==zu.AUTO&&(r.height="auto"),i.u===zu.AUTO||o.u===zu.AUTO||i.u===zu.PX&&o.u===zu.PX||(i.u===zu.PX?o.u===zu.PERCENT&&(r.right="auto"):o.u===zu.PX?i.u===zu.PERCENT&&(r.left="auto"):r.right="auto"),a.u!==zu.AUTO&&s.u!==zu.AUTO&&(a.u===zu.PX?r.bottom="auto":s.u===zu.PX?r.top="auto":r.bottom="auto")):t===nh.FIXED_W_H&&(l.u===zu.PX||i.u===zu.PX&&o.u===zu.PX||(r.width=e.width),c.u===zu.PX||a.u===zu.PX&&s.u===zu.PX||(r.height=e.height),i.u===zu.AUTO||o.u===zu.AUTO||i.u===zu.PX&&o.u===zu.PX||(i.u===zu.PX?o.u===zu.PERCENT&&(r.right="auto"):o.u===zu.PX?i.u===zu.PERCENT&&(r.left="auto"):r.right="auto"),a.u===zu.AUTO||s.u===zu.AUTO||a.u===zu.PX&&s.u===zu.PX||(a.u===zu.PX?s.u===zu.PERCENT&&(r.bottom="auto"):s.u===zu.PX?a.u===zu.PERCENT&&(r.top="auto"):r.bottom="auto")),e.startSizeChange(),e.updateStyle(r),e.endSizeChange(n),e.checkPosSizeUpward()}function XC(e){for(var t,r=e.root,n=e.parent;n&&n!==r&&n instanceof rC;)t=n,n=n.parent;return t}function HC(e,t,r,n,i){var o,a,s=i.getBoundingClientRect();return e>r&&(e=(o=[r,e])[0],r=o[1]),t>n&&(t=(a=[n,t])[0],n=a[1]),s.left>e&&s.top>t&&s.right<r&&s.bottom<n}function jC(e,t,r){for(var n=e.children,i=n.length-1;i>=0;i--){var o=n[i];if(!o.props.isLocked&&o.computedStyle.visibility!==rh.HIDDEN){var a=o.computedStyle,s=o.matrixWorld,l=o._rect||o.rect;if(o instanceof Jw){var c=l[2]-l[0],u=l[3]-l[1];(c<2||u<2)&&(l=l.slice(0),c<2&&(l[0]-=.5*(2-c),l[2]+=.5*(2-c)),u<2&&(l[1]-=.5*(2-u),l[3]+=.5*(2-u)))}if(Sd(t,r,l[0],l[1],l[2],l[3],s,!0))if(o instanceof Mw){var h=jC(o,t,r);if(h)return h;if(o instanceof kw)return o}else if(a.pointerEvents)return o}}}function WC(e,t,r,n,i){for(var o=e.children,a=[],s=0,l=o.length;s<l;s++){var c=o[s];if(!c.props.isLocked&&c.computedStyle.visibility!==rh.HIDDEN){var u=c.matrixWorld,h=c._rect||c.rect,d=md(h[0],h[1],h[2],h[3],u);if(Td(t,r,n,i,[{x:d.x1,y:d.y1},{x:d.x2,y:d.y2},{x:d.x3,y:d.y3},{x:d.x4,y:d.y4}]))if(c instanceof Mw){var f=WC(c,t,r,n,i);f.length?a.push.apply(a,f):c.computedStyle.pointerEvents&&a.push(c)}else c.computedStyle.pointerEvents&&a.push(c)}}return a}function YC(e,t,r,n,i,o){if(void 0===n&&(n=!1),void 0===i&&(i=[]),void 0===o&&(o=!1),!e.isDestroyed){var a=e.lastPage;if(a){var s=jC(a,t,r);if(s){if(n){if(s instanceof WS){for(var l=s.parent;l&&l!==e;){if(l instanceof kw)return l;l=l.parent}return}if(s instanceof zw||s instanceof rC){var c=XC(s);if(c)return c}return s}if(s instanceof WS&&!(s instanceof rC))return;if(i.length){if(o){for(y=s;y.struct&&y.struct.lv>3;){for(var u=0;u<i.length;u++){var h=i[u];if(y.parent===h)return y;if(y===h&&!(h instanceof Mw))return y}if((l=y.parent)instanceof kw)break;y=l}return y}var d=s,f=i.slice(0),p=d.struct.lv,v=p;if(f.forEach((function(e,t){if(e.struct.lv>p)for(;e.struct.lv>p;)e=e.parent,f[t]=e;else v=Math.max(v,e.struct.lv)})),v<p)for(;d.struct.lv>v;)d=d.parent;for(;d&&d.struct.lv>3;){for(u=0;u<f.length;u++){h=f[u];if(d.isSibling(h)||d===h)return d}if((l=d.parent)instanceof kw)break;d=l,f.forEach((function(e,t){e.struct.lv>d.struct.lv&&(f[t]=e.parent)}))}return d}for(var y=s;y&&y.struct.lv>3;){if((l=y.parent)instanceof kw)break;y=l}return y}}}}function qC(e,t,r){if(!e.isDestroyed){var n=e.lastPage;if(n)for(var i=n.children,o=i.length-1;o>=0;o--){var a=i[o];if(!a.props.isLocked&&a.computedStyle.visibility!==rh.HIDDEN&&a instanceof kw){var s=a.computedStyle,l=a.matrixWorld,c=a._rect||a.rect;if(s.pointerEvents&&Sd(t,r,c[0],c[1],c[2],c[3],l,!0))return a}}}}function VC(e,t,r){return jC(e.overlay,t,r)}function KC(e,t,r){var n=VC(e,t,r);if(n&&n instanceof t_)for(var i=e.overlay.artBoardList,o=0,a=i.length;o<a;o++){var s=i[o];if(s.text===n)return s.artBoard}}function ZC(e,t,r,n,i,o){if(void 0===o&&(o=!1),e.isDestroyed||t===n||r===i)return[];var a=e.lastPage;if(a){var s=WC(a,t,r,n,i);if(s.length){for(var l=[],c=0,u=s.length;c<u;c++){if((f=s[c])instanceof zw||f instanceof rC){var h=XC(f);h?-1===l.indexOf(h)&&l.push(h):l.push(f)}else l.push(f)}if(o)return l.filter((function(e){return(!(e instanceof WS)||e instanceof rC)&&!(e instanceof kw)}));var d=[];e:for(c=0,u=l.length;c<u;c++){var f;if(!((f=l[c])instanceof WS)||f instanceof rC)if(f instanceof kw)HC(t,r,n,i,f)&&-1===d.indexOf(f)&&d.push(f);else{for(var p=f;p&&p.struct.lv>3;){var v=p.parent;if(v instanceof kw){if(HC(t,r,n,i,v)){-1===d.indexOf(v)&&d.push(v);continue e}break}p=v}-1===d.indexOf(p)&&d.push(p)}}return d}}return[]}function JC(e,t,r,n,i,o,a,s){var l=e.getBoundingClientRect({excludeDpi:!0}),c=l.left,u=l.right,h=l.top,d=l.bottom;if(!(c>=i||u<=0||h>=o||d<=0)){var f=!1;if(s&&e instanceof WS)for(var p=0,v=s.length;p<v;p++)for(var y=s[p].parent;y&&!y.isPage&&!(y instanceof c_);){if(y===e){f=!0;break}y=y.parent}if(!f){var g=.5*(c+u),m=.5*(h+d),b={left:c,right:u,top:h,bottom:d,center:g,middle:m};if(c>=0&&c<=i){var x=$C(c,t);x>-1&&(!t[x-1]||Math.abs(t[x-1].n-c)>=n)&&(!t[x]||Math.abs(t[x].n-c)>=n)&&t.splice(x,0,{node:e,n:c,r:b})}if(u>=0&&u<=i){var E=$C(u,t);E>-1&&(!t[E-1]||Math.abs(t[E-1].n-u)>=n)&&(!t[E]||Math.abs(t[E].n-u)>=n)&&t.splice(E,0,{node:e,n:u,r:b})}if(g>=0&&g<=i){var w=$C(g,t);w>-1&&(!t[w-1]||Math.abs(t[w-1].n-g)>=n)&&(!t[w]||Math.abs(t[w].n-g)>=n)&&t.splice(w,0,{node:e,n:g,r:b})}if(h>=0&&h<=o){var S=$C(h,r);S>-1&&(!r[S-1]||Math.abs(r[S-1].n-h)>=n)&&(!r[S]||Math.abs(r[S].n-h)>=n)&&r.splice(S,0,{node:e,n:h,r:b})}if(d>=0&&d<=o){var _=$C(d,r);_>-1&&(!r[_-1]||Math.abs(r[_-1].n-d)>=n)&&(!r[_]||Math.abs(r[_].n-d)>=n)&&r.splice(_,0,{node:e,n:d,r:b})}if(m>=0&&m<=o){var C=$C(m,r);C>-1&&(!r[C-1]||Math.abs(r[C-1].n-m)>=n)&&(!r[C]||Math.abs(r[C].n-m)>=n)&&r.splice(C,0,{node:e,n:m,r:b})}}e instanceof WS&&e.children.forEach((function(e){s&&s.includes(e)||JC(e,t,r,n,i,o,a,s)}))}}function $C(e,t){if(!t.length)return 0;if(e<t[0].n)return 0;var r=t.length;if(e>t[r-1].n)return r;for(var n=0,i=r;n<i;){if(n===i-1)return i;var o=Math.round(.5*(n+i));if(e===t[o].n)return o+1;e>t[o].n?n=o:i=o}return n}function QC(e,t){var r={x:[],y:[]};if(e.isDestroyed)return r;var n=e.lastPage;if(n){var i=Math.max(0,bu.guidesSnap);n.children.forEach((function(n){t&&t.includes(n)||JC(n,r.x,r.y,i,e.width/e.dpi,e.height/e.dpi,e.dpi,t)}))}return r}function eA(e,t,r){void 0===r&&(r=!1);var n=e.style,i=e.computedStyle,o=t.x,a=t.y,s=t.parent,l=Iu(n.top),c=Iu(n.right),u=Iu(n.bottom),h=Iu(n.left),d=Iu(n.width),f=Iu(n.height);n.left={v:o,u:zu.PX},n.right={v:0,u:zu.AUTO},n.top={v:a,u:zu.PX},n.bottom={v:0,u:zu.AUTO},n.width={v:i.width,u:zu.PX},n.height={v:i.height,u:zu.PX},tA(s,e,r),h.u===zu.PERCENT?n.left={v:100*i.left/s.width,u:zu.PERCENT}:h.u===zu.PX?n.left={v:i.left,u:zu.PX}:h.u===zu.AUTO&&(n.left={v:0,u:zu.AUTO}),c.u===zu.PERCENT?n.right={v:100*i.right/s.width,u:zu.PERCENT}:c.u===zu.PX?n.right={v:i.right,u:zu.PX}:c.u===zu.AUTO&&(n.right={v:0,u:zu.AUTO}),l.u===zu.PERCENT?n.top={v:100*i.top/s.height,u:zu.PERCENT}:l.u===zu.PX?n.top={v:i.top,u:zu.PX}:l.u===zu.AUTO&&(n.top={v:0,u:zu.AUTO}),u.u===zu.PERCENT?n.bottom={v:100*i.bottom/s.height,u:zu.PERCENT}:u.u===zu.PX?n.bottom={v:i.bottom,u:zu.PX}:u.u===zu.AUTO&&(n.bottom={v:0,u:zu.AUTO}),d.u===zu.PERCENT?n.width={v:100*i.width/s.width,u:zu.PERCENT}:d.u===zu.PX?n.width={v:i.width,u:zu.PX}:d.u===zu.AUTO&&(n.width={v:0,u:zu.AUTO}),f.u===zu.PERCENT?n.height={v:100*i.height/s.height,u:zu.PERCENT}:f.u===zu.PX?n.height={v:i.height,u:zu.PX}:f.u===zu.AUTO&&(n.height={v:0,u:zu.AUTO})}function tA(e,t,r){var n,i;void 0===r&&(r=!1);var o=e.children;if(o.length)for(var a=0,s=o.length;a<s;a++){var l=o[a];if(t.props.index<l.props.index){l.insertBefore(t),r&&(t.props.index=.5*(l.props.index+((null===(n=o[a+1])||void 0===n?void 0:n.props.index)||1)));break}if(a===s-1){e.appendChild(t),r&&(t.props.index=.5*(((null===(i=o[a-1])||void 0===i?void 0:i.props.index)||0)+1));break}}else e.appendChild(t),r&&(t.props.index=.5)}function rA(e,t,r,n,i){var o=[];if(t===n||r===i)return o;e.buildPoints();var a=e.matrixWorld,s=e._rect||e.rect,l=[{x:s[0],y:s[1]},{x:s[2],y:s[1]},{x:s[2],y:s[3]},{x:s[0],y:s[3]}].map((function(e){return yd(e,a)}));return Td(t,r,n,i,l)?(e.props.points.forEach((function(e,s){var l=yd({x:e.absX,y:e.absY},a);Sd(l.x,l.y,t,r,n,i)&&o.push(s)})),o):o}function nA(e,t){var r=Z_(e);t||(t=e.props.points);var n=J_(e),i=n.baseX,o=n.baseY;(Array.isArray(t)?t:[t]).forEach((function(e){var t=yd({x:e.absX-i,y:e.absY-o},r),n=yd({x:e.absFx-i,y:e.absFy-o},r),a=yd({x:e.absTx-i,y:e.absTy-o},r);e.dspX=t.x,e.dspY=t.y,e.dspFx=n.x,e.dspFy=n.y,e.dspTx=a.x,e.dspTy=a.y}))}function iA(e,t){var r=Z_(e);t||(t=e.props.points);var n=sd(r),i=J_(e),o=i.baseX,a=i.baseY;(Array.isArray(t)?t:[t]).forEach((function(e){var t=yd({x:e.dspX+o,y:e.dspY+a},n),r=yd({x:e.dspFx+o,y:e.dspFy+a},n),i=yd({x:e.dspTx+o,y:e.dspTy+a},n);e.absX=t.x,e.absY=t.y,e.absFx=r.x,e.absFy=r.y,e.absTx=i.x,e.absTy=i.y}))}function oA(e,t){if(e.length){var r=e.slice(0);x_(r);var n=r[0],i=n.parent;i instanceof WS&&(i.fixedPosAndSize=!0),t||(t=new WS({uuid:a(),name:"编组",index:i.props.index,style:{left:"0%",top:"0%",right:"0%",bottom:"0%"}},[])),t.fixedPosAndSize=!0,n.insertAfter(t);for(var o=0,s=r.length;o<s;o++){b_(t,r[o])}for(o=0,s=r.length;o<s;o++)t.appendChild(r[o]);return t.fixedPosAndSize=!1,i instanceof WS&&(i.fixedPosAndSize=!1),t.checkPosSizeSelf(),t}}function aA(e){if(!e.isDestroyed&&e.parent){e.fixedPosAndSize=!0;var t=e.parent;t instanceof WS&&(t.fixedPosAndSize=!0);for(var r=e,n=e.children.slice(0),i=0,o=n.length;i<o;i++){var a=n[i];b_(t,a),r.insertAfter(a),r=a}return t instanceof WS&&(t.fixedPosAndSize=!1),e.fixedPosAndSize=!1,e.remove(),{children:n,parent:t}}dh.error("Can not unGroup a destroyed Node")}var sA,lA={node:Q_,text:{TEXT_BEHAVIOUR:nh,SIZE_LIST:[6,7,8,9,10,11,12,14,16,18,20,21,24,36,48,60,72],getTextInfo:BC,getEditTextInfo:zC,getTextBehaviour:NC,setTextBehaviour:GC,getFontWeightList:UC},root:{getNodeByPoint:YC,getArtBoardByPoint:qC,getOverlayNodeByPoint:VC,getOverlayArtBoardByPoint:KC,getFrameNodes:ZC,getGuidesNodes:QC,search2:$C},container:{appendWithPosAndSize:eA,appendWithIndex:tA},polyline:{getFrameVertexes:rA,getPointsDspByAbs:nA,getPointsAbsByDsp:iA},group:{group:oA,unGroup:aA}},cA=function(){function e(e,t){this.root=e,this.dom=t;var r=this.frame=document.createElement("div");r.className="frame",r.style.display="none",t.appendChild(r);var n=this.hover=document.createElement("div");n.className="hover",n.style.display="none",t.appendChild(n);var i=this.select=document.createElement("div");i.className="select",i.style.display="none",i.innerHTML='\n  <div class="sub"></div>\n  <span class="l">\n    <b></b>\n  </span>\n  <span class="t">\n    <b></b>\n  </span>\n  <span class="r">\n    <b></b>\n  </span>\n  <span class="b">\n    <b></b>\n  </span>\n  <span class="tl">\n    <b></b>\n  </span>\n  <span class="tr">\n    <b></b>\n  </span>\n  <span class="br">\n    <b></b>\n  </span>\n  <span class="bl">\n    <b></b>\n  </span>\n',t.appendChild(i)}return e.prototype.showFrame=function(e,t,r,n){this.frame.style.left=e+"px",this.frame.style.top=t+"px",this.updateFrame(r,n),this.frame.style.display="block"},e.prototype.updateFrame=function(e,t){this.frame.style.width=Math.abs(e)+"px",this.frame.style.height=Math.abs(t)+"px",this.frame.style.transform="scale(".concat(e>=0?1:-1,", ").concat(t>=0?1:-1,")")},e.prototype.hideFrame=function(){this.frame.style.display="none"},e.prototype.showHover=function(e){this.hoverNode=e,this.updateHover(e),this.hover.style.display="block"},e.prototype.hideHover=function(){this.hoverNode=void 0,this.hover.style.display="none"},e.prototype.calRect=function(e){var t,r,n,i,o,a,s,l,c=this.root.dpi,u=e.computedStyle,h=e._rect||e.rect,d=e.matrixWorld;if(1!==c){var f=nd();vd(f,1/c),d=od(f,d)}e instanceof Jw&&e.isLine();var p=md(h[0],h[1],h[2],h[3],d),v=p.x1,y=p.y1,g=p.x2,m=p.y2,b=p.x3,x=p.y3,E=p.x4,w=p.y4;-1===u.scaleX&&(v=(t=[g,v])[0],g=t[1],y=(r=[m,y])[0],m=r[1],b=(n=[E,b])[0],E=n[1],x=(i=[w,x])[0],w=i[1]),-1===u.scaleY&&(v=(o=[E,v])[0],E=o[1],y=(a=[w,y])[0],w=a[1],g=(s=[b,g])[0],b=s[1],m=(l=[x,m])[0],x=l[1]);var S={left:v,top:y,width:Math.sqrt(Math.pow(v-g,2)+Math.pow(y-m,2)),height:Math.sqrt(Math.pow(g-b,2)+Math.pow(m-x,2)),transform:""};if(g>v){if(m!==y){var _=Ed(Math.atan((m-y)/(g-v)));S.transform="rotateZ(".concat(_,"deg)")}}else if(g<v){_=Ed(Math.atan((m-y)/(g-v)));S.transform="rotateZ(".concat(_+180,"deg)")}else m>y?S.transform="rotateZ(90deg)":m<y&&(S.transform="rotateZ(-90deg)");return S},e.prototype.updateHover=function(e){var t=this.calRect(e);this.hover.style.left=t.left+"px",this.hover.style.top=t.top+"px",this.hover.style.width=t.width+"px",this.hover.style.height=t.height+"px",this.hover.style.transform=t.transform},e.prototype.showSelect=function(e){this.updateSelect(e),this.showSelectNotUpdate()},e.prototype.showSelectNotUpdate=function(){this.select.style.display="block"},e.prototype.updateSelect=function(e){var t=this.select.querySelector(".sub");if(1===e.length){t.innerHTML="",this.select.classList.remove("multi"),e[0].computedStyle.visibility===rh.VISIBLE?this.select.classList.remove("hide"):this.select.classList.add("hide");var r=this.calRect(e[0]);this.select.style.left=r.left+"px",this.select.style.top=r.top+"px",this.select.style.width=r.width+"px",this.select.style.height=r.height+"px",this.select.style.transform=r.transform}else if(e.length>1){this.select.classList.add("multi");var n=0,i=0,o=0,a=0,s=[];e.forEach((function(e,t){var r=e.getBoundingClientRect();s.push({left:r.left,top:r.top,right:r.right,bottom:r.bottom,visible:e.computedStyle.visibility===rh.VISIBLE}),t?(n=Math.min(n,r.left),i=Math.min(i,r.top),o=Math.max(o,r.right),a=Math.max(a,r.bottom)):(n=r.left,i=r.top,o=r.right,a=r.bottom)}));var l=this.root.dpi,c=this.select.style;c.left=n/l+"px",c.top=i/l+"px",c.width=(o-n)/l+"px",c.height=(a-i)/l+"px",c.transform="";var u="";s.forEach((function(e){u+='<div style="left:'.concat((e.left-n)/l,"px;top:").concat((e.top-i)/l,"px;width:").concat((e.right-e.left)/l,"px;height:").concat((e.bottom-e.top)/l,"px;").concat(e.visible?"":"border-style:dashed;",'"></div>')}));var h=this.select.querySelector(".sub");h.innerHTML!==u&&(h.innerHTML=u)}},e.prototype.hideSelect=function(){this.select.style.display="none"},e.prototype.isSelectControlDom=function(e){return e.parentElement===this.select},e.prototype.destroy=function(){this.hover.remove(),this.select.remove(),this.frame.remove()},e.prototype.metaKey=function(e){e?this.select.classList.add("rotate"):this.select.classList.remove("rotate")},e.prototype.getAspectRatio=function(){var e=this.select.style;return{x:parseFloat(e.left),y:parseFloat(e.top),w:parseFloat(e.width),h:parseFloat(e.height)}},e}();!function(e){e[e.NORMAL=0]="NORMAL",e[e.HAND=1]="HAND",e[e.RESIZE=2]="RESIZE",e[e.EDIT_TEXT=3]="EDIT_TEXT",e[e.EDIT_GRADIENT=4]="EDIT_GRADIENT",e[e.EDIT_GEOM=5]="EDIT_GEOM",e[e.ADD_TEXT=6]="ADD_TEXT"}(sA||(sA={}));var uA,hA,dA,fA,pA,vA,yA=sA,gA=function(e){this.nodes=e},mA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.beforeEdit(),e.cursor=t[r].next.cursor,e.content=t[r].next.content,e.setRich(t[r].next.rich),e.afterEdit()}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.beforeEdit(),e.cursor=t[r].prev.cursor,e.content=t[r].prev.content,e.setRich(t[r].prev.rich),e.afterEdit()}))},t}(gA),bA=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.ignoreBlur=[],this.hasBlur=!0;var i=this.containerEl=document.createElement("div");i.className="input",i.style.position="absolute",i.style.pointerEvents="none",i.style.opacity="0",t.appendChild(i);var o=this.inputEl=document.createElement("input");o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.width="10px",o.style.height="100%",o.style.boxSizing="content-box",o.style.border="none",o.style.pointerEvents="none",o.style.opacity="0",o.type="text",o.autocomplete="off",o.spellcheck=!1,i.appendChild(o);var a=function(e){if(n.node){var t=n.node._content,i=n.node.getRich(),a=n.node.getCursor();e(),n.updateCursor(),n.showCursor(),o.value="",n.listener.select.updateSelect([n.node]),r.emit([dT.TEXT_CONTENT_NODE,dT.CURSOR_NODE],[n.node]),n.listener.history.addCommand(new mA([n.node],[{prev:{content:t,rich:i,cursor:a},next:{content:n.node._content,rich:n.node.getRich(),cursor:n.node.getCursor()}}]),n.hasBlur),n.hasBlur=!1}},s=function(e){e&&a((function(){var t;null===(t=n.node)||void 0===t||t.input(e)}))},l=!1;o.addEventListener("keydown",(function(e){var t=e.keyCode,i=e.code;if(n.node)if(13===t||"Enter"===i)a((function(){var e;null===(e=n.node)||void 0===e||e.enter()}));else if(8===t||46===t||"Backspace"===i||"Delete"===i)e.stopPropagation(),a((function(){var e;null===(e=n.node)||void 0===e||e.delete(46===t||"Delete"===i)}));else if(t>=37&&t<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(i)){e.stopPropagation();var o=n.node.moveCursor(t,e.shiftKey);e.shiftKey?n.hideCursor():(n.showCursor(),n.updateCursor(o)),r.emit(dT.CURSOR_NODE,[n.node])}})),o.addEventListener("input",(function(e){if(!l){var t=e.data;t&&s(t)}})),o.addEventListener("paste",(function(e){var t;e.stopPropagation();var r=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");r&&s(r)})),o.addEventListener("compositionstart",(function(e){l=!0})),o.addEventListener("compositionend",(function(e){l=!1;var t=e.data;t&&s(t)}));var c=this.cursorEl=document.createElement("div");c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width="10px",c.style.height="100%",c.style.borderLeft="1px solid #000",c.style.pointerEvents="none",i.appendChild(c),c.animate([{visibility:"visible",borderColor:"#000"},{visibility:"visible",borderColor:"#FFF"},{visibility:"hidden"},{visibility:"hidden"}],{duration:800,iterations:1/0}),document.addEventListener("click",(function(e){if(r.state===yA.EDIT_TEXT){for(var t=e.target,i=t;i;){if(i===r.dom||n.ignoreBlur.includes(i))return void(["INPUT","SELECT"].includes(t.tagName.toUpperCase())||n.focus());i=i.parentElement}r.state=yA.NORMAL;var o=n.node;o.resetCursor(),o.afterEdit(),o.inputStyle=void 0,n.hide()}}))}return e.prototype.show=function(e,t,r){this.node=e,this.update(t,r),this.focus(),this.showCursor()},e.prototype.update=function(e,t){var r=this.root.dpi,n=this.node.setCursorStartByAbsCoords(e*r,t*r);this.containerEl.style.left=n.x/r+"px",this.containerEl.style.top=n.y/r+"px",this.containerEl.style.height=n.h/r+"px"},e.prototype.hide=function(){if(this.hideCursor(),this.blur(),!this.node._content.length){var e=this.listener.history.commands[0];e&&e instanceof mA&&e.nodes[0]===this.node&&e.undo(),this.listener.removeNode()}this.node=void 0},e.prototype.focus=function(){this.inputEl.focus()},e.prototype.blur=function(){this.inputEl.blur(),this.hasBlur=!0},e.prototype.showCursor=function(){this.containerEl.style.opacity="1"},e.prototype.hideCursor=function(){this.containerEl.style.opacity="0"},e.prototype.updateCursor=function(e){if(e=e||this.node.getCursorAbsCoords()){var t=this.root.dpi;this.containerEl.style.left=e.x/t+"px",this.containerEl.style.top=e.y/t+"px",this.containerEl.style.height=e.h/t+"px"}},e.prototype.destroy=function(){this.hide(),this.containerEl.remove()},e}(),xA=0,EA={keep:!1,show:function(e,t,r,n,i,o){var a,s,l,c,u,h=this;dA=r,fA&&(fA(),fA=void 0),fA=i,Array.isArray(t)?pA=t:t.stops&&(vA=t);var d=e.getBoundingClientRect(),f=!uA;f&&((uA=document.createElement("div")).innerHTML='\n<span class="arrow">\n  <b></b>\n</span>\n<ul class="type">\n  <li class="color" title="纯色"></li>\n  <li class="linear" title="线性渐变"></li>\n  <li class="radial" title="径向渐变"></li>\n  <li class="conic" title="圆锥渐变"></li>\n</ul>\n<div class="line">\n  <div class="bg"></div>\n  <div class="con"></div>\n</div>\n',document.body.appendChild(uA));var p=uA.querySelector(".type");null===(a=p.querySelector(".cur"))||void 0===a||a.classList.remove("cur");var v=uA.querySelector(".line");v.removeAttribute("style");var y=v.querySelector(".bg"),g=v.querySelector(".con");if(f){p.addEventListener("click",(function(e){var r=e.target;if("LI"===r.tagName.toUpperCase()){var i=r.classList;if(!i.contains("cur"))if(p.querySelector(".cur").classList.remove("cur"),i.add("cur"),i.contains("color")){v.style.display="none";var o=[0,0,0,1];pA?o=pA.slice(0):t.stops?(o=t.stops[0].color,n(o,!1,!0)):n(o,!1,!0),hA.setColor(o,!0)}else{if(v.style.display="block",i.contains("linear"))if(vA){if(vA.t===Wu.RADIAL||vA.t===Wu.CONIC){var a=vA.d[2]-vA.d[0],s=vA.d[3]-vA.d[1];vA.d[0]-=a,vA.d[1]-=s}vA.t=Wu.LINEAR}else vA={t:Wu.LINEAR,d:[0,.5,1,.5],stops:[{color:pA?pA.slice(0):[0,0,0,1],offset:0},{color:pA?pA.slice(0):[255,255,255,1],offset:1}]};else if(i.contains("radial"))if(vA){if(vA.t===Wu.LINEAR){a=vA.d[2]-vA.d[0],s=vA.d[3]-vA.d[1];vA.d[0]+=.5*a,vA.d[1]+=.5*s}else vA.t===Wu.CONIC&&(vA.d.length||vA.d.push(.5,.5,1,1));vA.t=Wu.RADIAL}else vA={t:Wu.RADIAL,d:[.5,.5,1,1],stops:[{color:pA?pA.slice(0):[0,0,0,1],offset:0},{color:pA?pA.slice(0):[255,255,255,1],offset:1}]};else if(i.contains("conic"))if(vA){if(vA.t===Wu.LINEAR){a=vA.d[2]-vA.d[0],s=vA.d[3]-vA.d[1];vA.d[0]+=.5*a,vA.d[1]+=.5*s}vA.t=Wu.CONIC}else vA={t:Wu.CONIC,d:[],stops:[{color:pA?pA.slice(0):[0,0,0,1],offset:0},{color:pA?pA.slice(0):[255,255,255,1],offset:1}]};vA&&n(vA,!1,!0)}}}));var m=y.clientWidth,b=!1,x=0,E=0,w=g.querySelector(".cur");g.addEventListener("mousedown",(function(e){var r,i,a;e.preventDefault();var s=e.target,l=s.tagName.toUpperCase();if(m=y.clientWidth,"SPAN"===l)g.querySelector(".cur").classList.remove("cur"),(w=s).classList.add("cur"),xA=parseInt(w.title),b=!0,x=e.pageX,E=.01*parseFloat(w.style.left),hA.setColor(t.stops[xA].color,!0),o.gradient.setCur(xA);else if("DIV"===l){g.querySelector(".cur").classList.remove("cur");var c=e.offsetX/m,u=document.createElement("span");u.style.left=100*c+"%";var h=g.querySelectorAll(".con span");g.appendChild(u);for(var d={color:[0,0,0,0],offset:c},f=0,p=h.length;f<p;f++){var v=h[f],S=.01*parseFloat(v.style.left);if(S>=c){if(f){var _=t.stops[f-1].color,C=t.stops[f].color,A=.01*parseFloat(h[f-1].style.left),T=(c-A)/(S-A);d.color=[_[0]+(C[0]-_[0])*T,_[1]+(C[1]-_[1])*T,_[2]+(C[2]-_[2])*T,(null!==(r=_[3])&&void 0!==r?r:1)+((null!==(i=C[3])&&void 0!==i?i:1)-(null!==(a=_[3])&&void 0!==a?a:1))*T]}else d.color=t.stops[f].color.slice(0);xA=f;break}f===p-1&&(d.color=t.stops[f].color.slice(0),xA=p)}for(f=xA,p=h.length;f<p;f++)h[f].title=(xA+1).toString();u.title=xA.toString(),t.stops.splice(xA,0,d),(w=u).classList.add("cur"),b=!0,x=e.pageX,E=.01*parseFloat(w.style.left),hA.setColor(d.color,!0),o.gradient.setCur(xA),n(t)}})),uA.addEventListener("mousedown",(function(){h.keep=!0,o.state===yA.EDIT_GRADIENT&&(o.gradient.keep=!0)})),document.addEventListener("mousemove",(function(e){if(b){e.preventDefault();var r=e.pageX-x,i=Math.min(1,Math.max(0,E+r/m));t.stops[xA].offset=i,w.style.left=100*i+"%",y.style.background=cp(t,y.clientWidth,y.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),n(t)}})),document.addEventListener("click",(function(e){b&&(t.stops.sort((function(e,t){return e.offset-t.offset})),uA.querySelectorAll(".line .con span").forEach((function(e,t){e.title=t.toString()})),b=!1),h.keep?h.keep=!1:(h.hide(),o.state===yA.EDIT_GRADIENT&&(o.state=yA.NORMAL,o.select.showSelectNotUpdate()))}))}if(uA.className="sketch-editor-picker",uA.classList.add(r),uA.style.left=d.left+.5*(d.right-d.left)+"px",uA.style.top=d.bottom+10+"px",uA.style.display="block",hA||((hA=new window.Picker({parent:uA,popup:!1})).onDone=function(){h.hide(),o.state===yA.EDIT_GRADIENT&&(o.state=yA.NORMAL,o.select.showSelectNotUpdate())}),hA.onChange=function(e){p.querySelector(".cur").classList.contains("color")?n(e.rgba):(t.stops[xA].color=e.rgba,y.style.background=cp(t,y.clientWidth,y.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),n(t))},Array.isArray(t)){var S=Jf(t);hA.setColor(S,!0),null===(s=p.querySelector(".color"))||void 0===s||s.classList.add("cur"),v.style.display="none"}else void 0!==t.url?v.style.display="none":(hA.setColor(Jf(t.stops[0].color),!0),this.updateLineBg(t),v.style.display="block",function(e,t){var r=t.querySelector(".con");r.innerHTML="";var n=document.createDocumentFragment();e.stops.forEach((function(e,t){var r=document.createElement("span");t||r.classList.add("cur"),r.style.left=100*e.offset+"%",r.title=t.toString(),n.appendChild(r)})),r.appendChild(n)}(t,v),hA.setColor(Jf(t.stops[0].color),!0),t.t===Wu.LINEAR?null===(l=p.querySelector(".linear"))||void 0===l||l.classList.add("cur"):t.t===Wu.RADIAL?null===(c=p.querySelector(".radial"))||void 0===c||c.classList.add("cur"):t.t===Wu.CONIC&&(null===(u=p.querySelector(".conic"))||void 0===u||u.classList.add("cur")));return hA.show(),hA},hide:function(){uA&&"block"===uA.style.display&&(uA.style.display="none",fA&&(fA(),fA=void 0))},isShow:function(){return!!uA&&"block"===uA.style.display},isShowFrom:function(e){return this.isShow()&&dA===e},setLineCur:function(e){var t,r;uA&&(null===(t=uA.querySelector(".line .con .cur"))||void 0===t||t.classList.remove("cur"),null===(r=uA.querySelector('.line .con span[title="'.concat(e,'"]')))||void 0===r||r.classList.add("cur"),xA=e)},addLineItem:function(e,t){if(uA){var r=uA.querySelector(".line .con"),n=document.createElement("span");n.title=e.toString(),n.style.left=100*t+"%";for(var i=r.querySelectorAll("span"),o=0,a=i.length;o<a;o++){var s=i[o];if(e<=parseInt(s.title)){r.insertBefore(n,s);for(var l=o;l<a;l++){var c=i[l];c.title=(parseInt(c.title)+1).toString()}break}o===a-1&&r.appendChild(n)}xA=e}},updateLinePos:function(e,t,r){uA&&(uA.querySelector('.line .con span[title="'.concat(e,'"]')).style.left=100*t+"%",this.updateLineBg(r))},updateLineBg:function(e){if(uA){var t=Object.assign({},e);t.t=Wu.LINEAR;var r=uA.querySelector(".line .bg");r.style.background=jf(t,r.clientWidth,r.clientHeight,!0).replace(/\([^,]*,/,"(to right,")}}};var wA,SA="0.13.0",_A='\n  <div class="item group">编组选择对象</div>\n  <div class="item un-group">解除编组</div>\n  <div class="item select-all">选择全部</div>\n  <div class="split"></div>\n  <div class="item cut">剪切</div>\n  <div class="item copy">复制</div>\n  <div class="item paste">粘贴</div>\n  <div class="split"></div>\n  <div class="item remove">删除</div>\n  <div class="split"></div>\n  <div class="item lock">锁定<span></span>个图层</div>\n  <div class="item un-lock">解锁<span></span>个图层</div>\n  <div class="item hide">隐藏<span></span>个图层</div>\n  <div class="item show">显示<span></span>个图层</div>\n  <div class="split"></div>\n  <div class="item mask">\n    <span class="checked">✅</span>用作蒙版 <b class="arrow"></b>\n    <div class="sub">\n      <div class="item outline-mask"><span class="checked">✅</span>轮廓模版</div>\n      <div class="item alpha-mask"><span class="checked">✅</span>透明度模版</div>\n    </div>\n  </div>\n  <div class="item break-mask"><span class="checked">✅</span>忽略底层蒙版</div>\n  <div class="split"></div>\n  <div class="item scale-up">放大</div>\n  <div class="item scale-down">缩小</div>\n  <div class="split"></div>\n  <div class="item ok">确定</div>\n  <div class="item version">版本 '.concat(SA,"</div>\n");function CA(e){wA||(wA=document.createElement("div"),document.body.appendChild(wA),document.addEventListener("click",(function(t){OA.keep?OA.keep=!1:AA()&&e.emit(dT.CONTEXT_MENU,!1,wA)})),document.addEventListener("visibilitychange",(function(t){"hidden"===document.visibilityState&&AA()&&e.emit(dT.CONTEXT_MENU,!1,wA)})),wA.addEventListener("click",(function(t){var r,n=t.target,i=n.classList;n===wA?OA.keep=!0:i.contains("group")?e.group():i.contains("un-group")?e.unGroup():i.contains("select-all")?e.selectAll():i.contains("scale-up")||i.contains("scale-down")?e.zoom(i.contains("scale-up")?2:.5):i.contains("mask")||i.contains("outline-mask")?wA.classList.contains("outline")?e.mask("none"):e.mask("outline"):i.contains("alpha-mask")?wA.classList.contains("alpha")?e.mask("none"):e.mask("alpha"):i.contains("break-mask")?wA.classList.contains("break")?e.breakMask(!1):e.breakMask(!0):i.contains("lock")?e.lock(!0):i.contains("un-lock")?e.lock(!1):i.contains("hide")?e.visible("hidden"):i.contains("show")?e.visible("visible"):i.contains("remove")?e.removeNode():i.contains("cut")||i.contains("copy")?(e.clone(),i.contains("cut")&&!(null===(r=e.options.disabled)||void 0===r?void 0:r.remove)&&e.removeNode()):i.contains("paste")?e.paste():i.contains("ok")&&(e.state===yA.EDIT_GEOM?e.cancelEditGeom():e.state===yA.EDIT_GRADIENT&&e.cancelEditGradient(),e.state=yA.NORMAL)}))),wA.innerHTML=_A,wA.className="sketch-editor-context-menu"}function AA(){return!(!wA||"block"!==wA.style.display)&&(wA.style.display="none",!0)}var TA,OA={keep:!1,showCanvas:function(e,t,r){CA(r);var n=wA.classList,i=r.selected;if(i.length>1)n.add("multi");else if(1===i.length){i[0]instanceof WS?n.add("single-group"):n.add("single")}else n.add("empty");(r.clones.length?n.remove("no-clone"):n.add("no-clone"),i.filter((function(e){return e.computedStyle.maskMode})).length)&&(i.filter((function(e){return e.computedStyle.maskMode===Ju.OUTLINE})).length?n.add("outline"):n.add("alpha"));i.filter((function(e){return e.computedStyle.breakMask})).length&&n.add("break");var o=i.filter((function(e){return e.props.isLocked}));o.length===i.length?(n.add("locked"),wA.querySelector(".un-lock span").innerHTML=o.length.toString()):wA.querySelector(".lock span").innerHTML=i.length.toString();var a=i.filter((function(e){return e.computedStyle.visibility===rh.HIDDEN}));a.length===i.length?(n.add("hidden"),wA.querySelector(".show span").innerHTML=a.length.toString()):wA.querySelector(".hide span").innerHTML=i.length.toString(),wA.style.left=e+"px",wA.style.top=t+"px",wA.style.display="block",r.emit(dT.CONTEXT_MENU,!0,wA)},showTree:function(e,t,r){this.showCanvas(e,t,r)},showOk:function(e,t,r){CA(r),wA.classList.add("only-ok"),wA.style.left=e+"px",wA.style.top=t+"px",wA.style.display="block",r.emit(dT.CONTEXT_MENU,!0,wA)},hide:AA},MA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=e.getStyle(),l=e.computedStyle;t.update(e,l,o,a),e.endPosChange(s,o,a),e.checkPosSizeUpward()}))},t.prototype.undo=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=e.getStyle(),l=e.computedStyle;t.update(e,l,-o,-a),e.endPosChange(s,-o,-a),e.checkPosSizeUpward()}))},t.update=function(e,t,r,n){var i=e.artBoard;e.updateStyle({translateX:t.translateX+r,translateY:t.translateY+n});var o=e.getBoundingClientRect();if(i&&Td((c=i.getBoundingClientRect()).left,c.top,c.right,c.bottom,o.points))return i;var a=e.page;if(a)for(var s=a.children,l=s.length-1;l>=0;l--){var c,u=s[l];if(u!==i&&u instanceof kw)if(Td((c=u.getBoundingClientRect()).left,c.top,c.right,c.bottom,o.points))return v_([e],u),u}i&&(y_([e],i),e.artBoard=void 0)},t}(gA),kA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.updateStyle(t[r].next)}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.updateStyle(t[r].prev)}))},t}(gA);!function(e){e[e.T=0]="T",e[e.R=1]="R",e[e.B=2]="B",e[e.L=3]="L",e[e.TL=4]="TL",e[e.TR=5]="TR",e[e.BL=6]="BL",e[e.BR=7]="BR"}(TA||(TA={}));var LA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=i.controlType,l=i.aspectRatio,c=i.clientRect,u=i.selectRect,h=i.fromCenter,d=i.widthToAuto,f=i.heightToAuto;i.flipX,i.flipY;var p=e.getStyle();e.startSizeChange();var v=e.getComputedStyle(),y=e.getCssStyle();c?t.updateStyleMultiAr(e,v,y,o,a,s,c,u,l,h,d,f):t.updateStyle(e,v,y,o,a,s,l,h,d,f),e.endSizeChange(p),e.checkPosSizeUpward()}))},t.prototype.undo=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=i.controlType,l=i.aspectRatio,c=i.clientRect,u=i.selectRect,h=i.fromCenter,d=i.widthFromAuto,f=i.heightFromAuto,p=i.flipX,v=i.flipY,y=e.getStyle();e.startSizeChange();var g=e.getComputedStyle(),m=e.getCssStyle();s=function(e,t,r){t&&(e===TA.L?e=TA.R:e===TA.R?e=TA.L:e===TA.TL?e=TA.TR:e===TA.TR&&(e=TA.TL));r&&(e===TA.T?e=TA.B:e===TA.B?e=TA.T:e===TA.BL?e=TA.BR:e===TA.BR&&(e=TA.BL));return e}(s,p,v),c?t.updateStyleMultiAr(e,g,m,-o,-a,s,c,u,l,h,d,f):t.updateStyle(e,g,m,-o,-a,s,l,h,d,f),e.endSizeChange(y),e.checkPosSizeUpward()}))},t.updateStyle=function(e,t,r,n,i,o,a,s,l,c){void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===c&&(c=!1);var u={left:r.left,right:r.right,top:r.top,bottom:r.bottom,width:r.width,height:r.height,scaleX:r.scaleX,scaleY:r.scaleY};a?o===TA.T?Object.assign(u,A_(e,t,i,s)):o===TA.R?Object.assign(u,k_(e,t,n,s)):o===TA.B?Object.assign(u,T_(e,t,i,s)):o===TA.L?Object.assign(u,M_(e,t,n,s)):o===TA.TL?Object.assign(u,R_(e,t,n,i,s)):o===TA.TR?Object.assign(u,I_(e,t,n,i,s)):o===TA.BL?Object.assign(u,P_(e,t,n,i,s)):o===TA.BR&&Object.assign(u,F_(e,t,n,i,s)):(o===TA.T||o===TA.TL||o===TA.TR?Object.assign(u,E_(e,t,i,s)):o!==TA.B&&o!==TA.BL&&o!==TA.BR||Object.assign(u,w_(e,t,i,s)),o===TA.L||o===TA.TL||o===TA.BL?Object.assign(u,S_(e,t,n,s)):o!==TA.R&&o!==TA.TR&&o!==TA.BR||Object.assign(u,__(e,t,n,s))),l&&(u.width="auto"),c&&(u.height="auto"),e.updateStyle(u)},t.updateStyleMultiAr=function(e,t,r,n,i,o,a,s,l,c,u,h){var d;void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===h&&(h=!1);var f={left:r.left,right:r.right,top:r.top,bottom:r.bottom,width:r.width,height:r.height,scaleX:r.scaleX,scaleY:r.scaleY};if(o===TA.T)Object.assign(f,z_(e,t,i,a,s,l,c));else if(o===TA.R)Object.assign(f,H_(e,t,n,a,s,l,c));else if(o===TA.B)Object.assign(f,G_(e,t,i,a,s,l,c));else if(o===TA.L)Object.assign(f,X_(e,t,n,a,s,l,c));else{if(l){var p=(null===(d=e.root)||void 0===d?void 0:d.dpi)||1,v={width:s.w*p,height:s.h*p},y=L_(v,n,i,[TA.TL,TA.BR].includes(o)),g=y.x,m=y.y;n=g-v.width,i=m-v.height}o===TA.TL?Object.assign(f,W_(e,t,n,i,a,s,l,c)):o===TA.TR?Object.assign(f,Y_(e,t,n,i,a,s,l,c)):o===TA.BL?Object.assign(f,V_(e,t,n,i,a,s,l,c)):o===TA.BR&&Object.assign(f,K_(e,t,n,i,a,s,l,c))}u&&(f.width="auto"),h&&(f.height="auto"),e.updateStyle(f)},t}(gA);var RA,IA=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.data=r,i.type=n,i}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.setRich(t[r].next)}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.setRich(t[r].prev)}))},t.FONT_FAMILY="FONT_FAMILY",t.FONT_SIZE="FONT_SIZE",t.LETTER_SPACING="LETTER_SPACING",t.LINE_HEIGHT="LINE_HEIGHT",t.PARAGRAPH_SPACING="PARAGRAPH_SPACING",t.COLOR="COLOR",t.TEXT_ALIGN="TEXT_ALIGN",t}(gA);var PA=function(){function e(e){void 0===e&&(e=100),this.commands=[],this.commandsR=[],this.size=Math.max(1,e),this.lastTime=0}return e.prototype.addCommand=function(e,t){void 0===t&&(t=!1),this.commandsR.splice(0);var r=this.commands.length;if(!t&&r>0){var n=this.commands[r-1];if((Date.now()-this.lastTime<bu.historyTime||n instanceof mA&&e instanceof mA)&&function(e,t){if(e.constructor!==t.constructor)return!1;var r=e.nodes,n=t.nodes;if(r.length!==n.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;if(e instanceof LA){var a=e.data,s=t.data;for(i=0,o=a.length;i<o;i++){var l=a[i],c=s[i];if(l.controlType!==c.controlType||l.aspectRatio!==c.aspectRatio||l.fromCenter!==c.fromCenter||l.widthFromAuto!==c.widthFromAuto||l.heightFromAuto!==c.heightFromAuto||l.widthToAuto!==c.widthToAuto||l.heightToAuto!==c.heightToAuto)return!1}}if(e instanceof IA){if(e.type!==t.type)return!1;for(a=e.data,s=t.data,i=0,o=a.length;i<o;i++){if(l=a[i],c=s[i],l.prev.length!==c.prev.length)return!1;for(var u=0;u<l.prev.length;u++){var h=l.prev[u],d=c.prev[u];if(h.location!==d.location||h.length!==d.length)return!1}}}return!0}(n,e)){var i=!0;if(n instanceof MA){var o=e.data;n.data.forEach((function(e,t){e.dx+=o[t].dx,e.dy+=o[t].dy}))}else if(n instanceof kA){var a=e.data;n.data.forEach((function(e,t){e.next=a[t].next}))}else if(n instanceof LA){var s=e.data;n.data.forEach((function(e,t){e.dx+=s[t].dx,e.dy+=s[t].dy}))}else if(n instanceof IA){var l=e.data;n.data.forEach((function(e,t){e.next=l[t].next}))}else if(n instanceof mA){var c=e.data;n.data.forEach((function(e,t){e.next=c[t].next}))}else i=!1;if(i)return void(this.lastTime=Date.now())}}this.lastTime=Date.now(),r>=this.size&&this.commands.slice(0,r-this.size+1),this.commands.push(e)},e.prototype.undo=function(){if(this.commands.length){var e=this.commands.pop();return e.undo(),this.commandsR.push(e),e}},e.prototype.redo=function(){if(this.commandsR.length){var e=this.commandsR.pop();return e.execute(),this.commands.push(e),e}},e.getInstance=function(){return RA||(RA=new e),RA},e}(),FA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){this.nodes.forEach((function(e){e.remove()}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){eA(e,t[r])}))},t.operate=function(e){var t=e.parent,r={x:e.computedStyle.left,y:e.computedStyle.top,parent:t};if(t.isGroup&&t instanceof WS){var n=t.getChildrenRect(e);r.x-=n.minX,r.y-=n.minY}return e.remove(),r},t}(gA),DA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),NA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),BA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),UA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),zA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),GA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),XA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),HA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),jA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),WA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),YA=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.data=r,i.group=n,i}return p(t,e),t.prototype.execute=function(){t.operate(this.nodes,this.group)},t.prototype.undo=function(){var e=this;this.group.fixedPosAndSize=!0,this.nodes.forEach((function(t,r){var n=e.data[r],i=n.parent,o=n.index;i instanceof WS&&(i.fixedPosAndSize=!0),b_(i,t),t.props.index=o,tA(i,t)})),this.data.forEach((function(e){var t=e.parent;t instanceof WS&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())})),this.group.fixedPosAndSize=!1,this.group.remove()},t.operate=function(e,t){return{data:e.map((function(e){return{parent:e.parent,index:e.props.index}})),group:oA(e,t)}},t}(gA),qA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){t.operate(this.nodes)},t.prototype.undo=function(){var e=this;this.nodes.forEach((function(t,r){var n=t;n.fixedPosAndSize=!0;var i=e.data[r],o=i.parent,a=i.children;o instanceof WS&&(o.fixedPosAndSize=!0),tA(o,n),a.filter((function(e){b_(n,e),n.appendChild(e)})),n.fixedPosAndSize=!1,n.checkPosSizeSelf(),n instanceof rC&&n.refresh()})),this.data.forEach((function(e){var t=e.parent;t instanceof WS&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())}))},t.operate=function(e){return e.map((function(e){return aA(e)}))},t}(gA),VA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.name=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.name=t[r].prev}))},t}(gA),KA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.isLocked=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.isLocked=t[r].prev}))},t}(gA),ZA=function(e){function t(t,r){return e.call(this,t,r)||this}return p(t,e),t}(kA),JA=function(){function e(e,t,r){this.root=e,this.dom=t,this.listener=r,this.xs=[],this.ys=[],this.move={left:0,right:0,top:0,bottom:0,center:0,middle:0},this.lineH=[],this.lineV=[],this.distanceH=document.createElement("div"),this.distanceH.className="distance-h",this.distanceH.style.display="none",this.distanceH.innerHTML="<span></span>",this.dom.appendChild(this.distanceH),this.distanceV=document.createElement("div"),this.distanceV.className="distance-v",this.distanceV.style.display="none",this.distanceV.innerHTML="<span></span>",this.dom.appendChild(this.distanceV)}return e.prototype.initMove=function(e,t){var r=QC(this.root,t),n=r.x,i=r.y;this.xs=n,this.ys=i;var o=parseFloat(e.style.left),a=parseFloat(e.style.top),s=o+parseFloat(e.style.width),l=.5*(o+s),c=a+parseFloat(e.style.height),u=.5*(a+c);this.move={left:o,right:s,top:a,bottom:c,center:l,middle:u}},e.prototype.snapMove=function(e,t,r){var n,i,o=0,a=0,s=!1,l=this.xs,c=this.ys,u=Math.max(0,bu.guidesSnap),h=this.move,d=h.left,f=h.right,p=h.top,v=h.bottom,y=h.center,g=h.middle;f+=e,y+=e,p+=t,v+=t,g+=t;var m=$C(d+=e,l),b=$C(y,l),x=$C(f,l),E=[$A(d,u,l,m),$A(y,u,l,b),$A(f,u,l,x)].filter((function(e){return e}));if(E.length){s=!0,E.sort((function(e,t){return Math.abs(e.d)-Math.abs(t.d)}));var w=E[0];d+=o=k=w.d,f+=o,n=L=w.ng,this.showLineV(L.n,Math.min(p,L.r.top),Math.max(v,L.r.bottom),0);for(var S=1,_=E.length;S<_;S++){var C=E[S];if(!(Math.abs(C.d-k)<1e-9))break;this.showLineV(C.ng.n,Math.min(p,C.ng.r.top),Math.max(v,C.ng.r.bottom),S)}}else this.hideLineV();var A=$C(p,c),T=$C(g,c),O=$C(v,c),M=[$A(p,u,c,A),$A(g,u,c,T),$A(v,u,c,O)].filter((function(e){return e}));if(M.length){s=!0,M.sort((function(e,t){return Math.abs(e.d)-Math.abs(t.d)}));var k,L,R=M[0];p+=a=k=R.d,v+=a,i=L=R.ng,this.showLineH(L.n,Math.min(d,L.r.left),Math.max(f,L.r.right),0);for(S=1,_=M.length;S<_;S++){if((C=M[S]).d!==k)break;this.showLineH(C.ng.n,Math.min(d,C.ng.r.left),Math.max(f,C.ng.r.right),S)}}else this.hideLineH();if(n?p>n.r.bottom?this.showDistanceV(n.r.bottom,p,r):v<n.r.top?this.showDistanceV(v,n.r.top,r):this.hideDistanceV():this.hideDistanceV(),i?d>i.r.right?this.showDistanceH(i.r.right,d,r):f<i.r.left?this.showDistanceH(f,i.r.left,r):this.hideDistanceH():this.hideDistanceH(),s)return{x:o,y:a}},e.prototype.showLineH=function(e,t,r,n){if(!this.lineH[n]){var i=this.lineH[n]=document.createElement("div");i.className="line-h",this.dom.appendChild(i)}var o=this.lineH[n].style;o.top=e+"px",o.left=t+"px",o.width=r-t+"px",o.display="block"},e.prototype.showLineV=function(e,t,r,n){if(!this.lineV[n]){var i=this.lineV[n]=document.createElement("div");i.className="line-v",this.dom.appendChild(i)}var o=this.lineV[n].style;o.left=e+"px",o.top=t+"px",o.height=r-t+"px",o.display="block"},e.prototype.showDistanceH=function(e,t,r){var n=this.distanceH.style,i=Math.abs(e-t);this.distanceH.querySelector("span").innerHTML=Ff(i*r,2).toString();var o=this.lineH.length;n.top=3===o?this.lineH[1].style.top:o>1?.5*(parseFloat(this.lineH[0].style.top)+parseFloat(this.lineH[o-1].style.top))+"px":this.lineH[0].style.top,n.left=Math.min(e,t)+"px",n.width=i+"px",n.display="block"},e.prototype.showDistanceV=function(e,t,r){var n=this.distanceV.style,i=Math.abs(e-t);this.distanceV.querySelector("span").innerHTML=Ff(i*r,2).toString();var o=this.lineV.length;n.left=3===o?this.lineV[1].style.left:o>1?.5*(parseFloat(this.lineV[0].style.left)+parseFloat(this.lineV[o-1].style.left))+"px":this.lineV[0].style.left,n.top=Math.min(e,t)+"px",n.height=i+"px",n.display="block"},e.prototype.hideLineH=function(){this.lineH.splice(0).forEach((function(e){e.style.display="none",e.remove()}))},e.prototype.hideLineV=function(){this.lineV.splice(0).forEach((function(e){e.style.display="none",e.remove()}))},e.prototype.hideDistanceH=function(){this.distanceH.style.display="none"},e.prototype.hideDistanceV=function(){this.distanceV.style.display="none"},e.prototype.hide=function(){this.hideLineH(),this.hideLineV(),this.hideDistanceH(),this.hideDistanceV()},e}();function $A(e,t,r,n){var i=r[n-1],o=r[n];if(i&&o){var a=Math.abs(i.n-e),s=Math.abs(o.n-e);if(a<=t&&s<=t)return a<=s?{d:i.n-e,ng:i}:{d:o.n-e,ng:o};if(a<=t)return{d:i.n-e,ng:i};if(s<=t)return{d:o.n-e,ng:o}}else if(i){if(Math.abs(e-i.n)<=t)return{d:i.n-e,ng:i}}else if(o&&Math.abs(e-o.n)<=t)return{d:o.n-e,ng:o}}var QA=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){eA(e,t[r])}))},t.prototype.undo=function(){this.nodes.forEach((function(e){e.remove()}))},t}(gA),eT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r;var i=this.panel=document.createElement("div");i.className="gradient",i.style.display="none",t.appendChild(i);var o,a=!1,s=!1,l=0,c=0,u=0,h=1,d=1,f=1,p=0,v=0,y=1,g=1;i.addEventListener("mousedown",(function(e){var t=n.data;if(t&&(n.keep=!0,EA.keep=!0,0===e.button&&!r.spaceKey)){var m=(o=e.target).classList,b=o.tagName.toUpperCase(),x=i.getBoundingClientRect();l=x.left,c=x.top,h=i.clientWidth,d=i.clientHeight;var E=i.querySelector('span[title="0"]').getBoundingClientRect();p=E.left+.5*E.width,v=E.top+.5*E.height,y=t.d[2]-t.d[0],g=t.d[3]-t.d[1];var w=n.node.computedStyle,S=w.scaleX,_=w.scaleY;if(m.contains("c2")){for(var C=e.offsetX,A=e.offsetY,T=.5*Math.max(h,d),O=tT(T,T,C,A,S,_),M=void 0,k=void 0,L=0,R=(P=t.stops).length;L<R;L++){if(O<(D=P[L]).offset){k=D,u=L;break}M=D}if(M&&k){N=(O-M.offset)/(k.offset-M.offset);P.splice(u,0,{color:rT(M,k,N),offset:O}),i.innerHTML+="<span></span>",i.querySelectorAll("span").forEach((function(e,t){e.title=t.toString(),t===u&&(o=e)}))}else{M=M||P[0];var I={color:rT(k=k||P[P.length-1],M,N=Math.abs(O-M.offset)/Math.abs(M.offset-k.offset)),offset:O};O<M.offset?(P.unshift(I),u=0):(P.push(I),u=P.length-1)}n.updateConicStops(t),EA.addLineItem(u,O),n.setCur(u,!0),n.onInput(t,!0),a=!0}else if(m.contains("e"))f=i.querySelector(".l").clientWidth,s=!0;else if("SPAN"===b)u=parseInt(o.title),n.setCur(u,!0),a=!0;else if("DIV"===b){for(var P=t.stops,F=(O=Math.sqrt(Math.pow(e.pageX-p,2)+Math.pow(e.pageY-v,2))/o.clientWidth,L=0,P.length);L<F;L++){var D;if(O<(D=P[L]).offset){var N=(O-(M=P[L-1]).offset)/(D.offset-M.offset);P.splice(L,0,{color:rT(M,D,N),offset:O}),u=L;break}}i.innerHTML+="<span></span>",i.querySelectorAll("span").forEach((function(e,t){e.title=t.toString(),t===u&&(o=e)})),n.updateLinearStops(t),EA.addLineItem(u,O),n.setCur(u,!0),n.onInput(t,!0),a=!0}}})),document.addEventListener("mousemove",(function(e){if(s){if(i=n.data){var t=i.d,r=Math.sqrt(Math.pow(e.pageX-p,2)+Math.pow(e.pageY-v,2));t[4]=r/f,n.updateRadialD(i),n.updateRadialStops(i),n.onInput(i,!0)}}else if(a){var i,m=(e.pageX-l)/h,b=(e.pageY-c)/d;if(i=n.data){t=i.d;var x=i.stops,E=n.node.computedStyle,w=E.scaleX,S=E.scaleY,_=-1===w?1-t[0]:t[0],C=-1===S?1-t[1]:t[1];if(0!==u&&u!==x.length-1||i.t===Wu.CONIC){if(i.t===Wu.CONIC){var A=tT(l+.5*h,c+.5*d,e.pageX,e.pageY,w,S);x[u].offset=A,n.updateConicStops(i),EA.updateLinePos(u,A,i)}else{var T=m-_,O=b-C,M=(T<0?-1:1)*(t[2]<t[0]?-1:1)*w,k=(O<0?-1:1)*(t[3]<t[1]?-1:1)*S,L=Math.pow(T,2)*M+Math.pow(O,2)*k;A=Math.sqrt(Math.max(0,L))/Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(t[3]-t[1],2));A=Math.max(0,Math.min(1,A)),x[u].offset=A;var R=100*(_+(t[2]-t[0])*A*w)+"%",I=100*(C+(t[3]-t[1])*A*S)+"%";o.style.left=R,o.style.top=I,EA.updateLinePos(u,A,i)}n.onInput(i,!0)}else 0===u?(t[0]=-1===w?1-m:m,t[1]=-1===S?1-b:b,[Wu.RADIAL].includes(i.t)&&(t[2]=t[0]+y,t[3]=t[1]+g)):(t[2]=-1===w?1-m:m,t[3]=-1===S?1-b:b),i.t===Wu.LINEAR?(n.updateLinearD(i),n.updateLinearStops(i)):i.t===Wu.RADIAL&&(n.updateLinearD(i),n.updateRadialD(i),n.updateLinearStops(i),n.updateRadialStops(i)),n.onInput(i,!0)}}})),document.addEventListener("mouseup",(function(){s?s=!1:a&&(n.data&&(n.data.stops.sort((function(e,t){return e.offset-t.offset})),i.querySelectorAll("span").forEach((function(e,t){e.title=t.toString()}))),a=!1,n.onChange&&n.onChange())})),i.addEventListener("wheel",(function(e){a&&e.stopPropagation()})),document.addEventListener("click",(function(){n.keep?n.keep=!1:n.hide()}))}return e.prototype.show=function(e,t,r,n){Array.isArray(t)||t.url||(this.node=e,this.onInput=r,this.onChange=n,this.data=t,this.updateSize(e),t.t===Wu.LINEAR?this.genLinear(t):t.t===Wu.RADIAL?this.genRadial(t):t.t===Wu.CONIC&&this.genConic(t))},e.prototype.update=function(e,t,r){var n,i,o;void 0===r&&(r=!1),Array.isArray(t)||t.url||(this.node=e,this.updateSize(e),this.data=t,t.t===Wu.LINEAR?r||t.stops.length!==(null===(n=this.data)||void 0===n?void 0:n.stops.length)?this.genLinear(t):(this.updateLinearD(t),this.updateLinearStops(t)):t.t===Wu.RADIAL?r||t.stops.length!==(null===(i=this.data)||void 0===i?void 0:i.stops.length)?this.genRadial(t):(this.updateLinearD(t),this.updateRadialD(t),this.updateLinearStops(t),this.updateLinearStops(t)):t.t===Wu.CONIC&&(r||t.stops.length!==(null===(o=this.data)||void 0===o?void 0:o.stops.length)?this.genConic(t):(this.updateConicD(t),this.updateConicStops(t))))},e.prototype.updateSize=function(e){var t=this.panel,r=this.listener.select.calRect(e);t.style.left=r.left+"px",t.style.top=r.top+"px",t.style.width=r.width+"px",t.style.height=r.height+"px",t.style.transform=r.transform,t.style.display="block"},e.prototype.genLinear=function(e){var t=this.panel,r=e.stops;t.innerHTML="";var n='<div class="l"></div>';r.forEach((function(e,t){n+='<span title="'.concat(t,'"></span>')})),t.innerHTML=n,this.updateLinearD(e),this.updateLinearStops(e),this.setCur(0)},e.prototype.updateLinearD=function(e){var t=this.panel,r=t.querySelector(".l"),n=t.clientWidth,i=t.clientHeight,o=this.node.computedStyle,a=o.scaleX,s=o.scaleY,l=e.d,c=l[2]-l[0],u=l[3]-l[1],h=100*(-1===a?1-l[0]:l[0])+"%",d=100*(-1===s?1-l[1]:l[1])+"%",f=Math.sqrt(Math.pow(c*n,2)+Math.pow(u*i,2))+"px";if(r.style.left=h,r.style.top=d,r.style.width=f,l[0]===l[2])l[3]>=l[1]?r.style.transform="translateY(-50%) rotateZ(90deg) scale(".concat(a,", ").concat(s,")"):r.style.transform="translateY(-50%) rotateZ(-90deg) scale(".concat(a,", ").concat(s,")");else if(l[1]===l[3])l[2]>=l[0]?r.style.transform="translateY(-50%) scale(".concat(a,", ").concat(s,")"):r.style.transform="translateY(-50%) rotateZ(180deg) scale(".concat(a,", ").concat(s,")");else{var p=Ff(Ed(Math.atan(u*i/c/n)));r.style.transform=c>=0?"translateY(-50%) rotateZ(".concat(p,"deg) scale(").concat(a,", ").concat(s,")"):"translateY(-50%) rotateZ(".concat(p+180,"deg) scale(").concat(a,", ").concat(s,")")}},e.prototype.updateLinearStops=function(e){var t=this.panel.querySelectorAll("span"),r=this.node.computedStyle,n=r.scaleX,i=r.scaleY,o=e.d,a=e.stops,s=o[2]-o[0],l=o[3]-o[1];a.forEach((function(e,r){var a=e.color,c=e.offset,u=100*(-1===n?1-o[0]:o[0])+c*s*100*n+"%",h=100*(-1===i?1-o[1]:o[1])+c*l*100*i+"%",d=Jf(a),f=t[r];f&&(f.style.left=u,f.style.top=h,f.style.background=d)}))},e.prototype.genRadial=function(e){var t=this.panel,r=e.stops;t.innerHTML="";var n='<div class="l"></div><div class="c"></div><div class="e"></div>';r.forEach((function(e,t){n+='<span title="'.concat(t,'"></span>')})),t.innerHTML=n,this.updateLinearD(e),this.updateRadialD(e),this.updateLinearStops(e),this.updateRadialStops(e),this.setCur(0)},e.prototype.updateRadialD=function(e){var t=this.panel,r=t.querySelector(".c"),n=t.clientWidth,i=t.clientHeight,o=this.node.computedStyle,a=o.scaleX,s=o.scaleY,l=e.d,c=100*(-1===a?1-l[0]:l[0])+"%",u=100*(-1===s?1-l[1]:l[1])+"%",h=l[2]-l[0],d=l[3]-l[1],f=Math.sqrt(Math.pow(h*n,2)+Math.pow(d*i,2));if(r.style.left=c,r.style.top=u,r.style.width=r.style.height=2*f+"px",l[0]===l[2])l[3]>=l[1]?r.style.transform="translate(-50%, -50%) rotateZ(90deg) scale(".concat(a,", ").concat(s*(l[4]||1),")"):r.style.transform="translate(-50%, -50%) rotateZ(-90deg) scale(".concat(a,", ").concat(s*(l[4]||1),")");else if(l[1]===l[3])l[2]>=l[0]?r.style.transform="translate(-50%, -50%) scale(".concat(a,", ").concat(s*(l[4]||1),")"):r.style.transform="translate(-50%, -50%) rotateZ(180deg) scale(".concat(a,", ").concat(s*(l[4]||1),")");else{var p=Ff(Ed(Math.atan(d*i/h/n)));r.style.transform=h>=0?"translate(-50%, -50%) rotateZ(".concat(p,"deg) scale(").concat(a,", ").concat(s*(l[4]||1),")"):"translate(-50%, -50%) rotateZ(".concat(p+180,"deg) scale(").concat(a,", ").concat(s*(l[4]||1),")")}},e.prototype.updateRadialStops=function(e){var t=this.panel,r=t.clientWidth,n=t.clientHeight,i=this.node.computedStyle,o=i.scaleX,a=i.scaleY,s=t.querySelector(".e"),l=e.d,c=-1===o?1-l[0]:l[0],u=-1===a?1-l[1]:l[1],h=l[2]-l[0],d=l[3]-l[1],f=Math.sqrt(Math.pow(h*r,2)+Math.pow(d*n,2)),p=f/r*(l[4]||1),v=f/n*(l[4]||1);if(l[0]===l[2])s.style.top=100*u+"%",l[3]>=l[1]?s.style.left=100*(-1===o?l[0]+p:l[0]-p)+"%":s.style.left=100*(-1===o?l[0]-p:l[0]+p)+"%";else if(l[1]===l[3])s.style.left=100*c+"%",l[2]>=l[0]?s.style.top=100*(-1===a?l[1]-v:l[1]+v)+"%":s.style.top=100*(-1===a?l[1]+v:l[1]-v)+"%";else{var y=Math.atan(d*n/h/r)+.5*Math.PI,g=Math.sin(y),m=Math.cos(y);h>=0?(s.style.left=100*(m*p*o+c)+"%",s.style.top=100*(g*v*a+u)+"%"):(s.style.left=100*(-m*p*o+c)+"%",s.style.top=100*(-g*v*a+u)+"%")}},e.prototype.genConic=function(e){var t=this.panel,r=e.stops;t.innerHTML="";var n='<div class="c2"><b></b></div>';r.forEach((function(e,t){n+='<span title="'.concat(t,'"></span>')})),t.innerHTML=n,this.updateConicD(e),this.updateConicStops(e),this.setCur(0)},e.prototype.updateConicD=function(e){var t,r,n,i,o=this.panel,a=o.querySelector(".c2"),s=o.clientWidth,l=o.clientHeight,c=this.node.computedStyle,u=c.scaleX,h=c.scaleY,d=e.d,f=100*(-1===u?1-(null!==(t=d[0])&&void 0!==t?t:.5):null!==(r=d[0])&&void 0!==r?r:.5)+"%",p=100*(-1===h?1-(null!==(n=d[1])&&void 0!==n?n:.5):null!==(i=d[1])&&void 0!==i?i:.5)+"%";a.style.left=f,a.style.top=p,a.style.width=a.style.height=Math.max(s,l)+"px"},e.prototype.updateConicStops=function(e){var t,r,n,i,o=this.panel,a=o.clientWidth,s=o.clientHeight,l=this.node.computedStyle,c=l.scaleX,u=l.scaleY,h=.5*Math.max(a,s),d=o.querySelectorAll("span"),f=o.querySelector(".c2"),p=f.clientWidth/a,v=f.clientHeight/s,y=e.d,g=e.stops,m=100*(-1===c?1-(null!==(t=y[0])&&void 0!==t?t:.5):null!==(r=y[0])&&void 0!==r?r:.5),b=100*(-1===u?1-(null!==(n=y[1])&&void 0!==n?n:.5):null!==(i=y[1])&&void 0!==i?i:.5),x={},E=12;g.forEach((function(e,t){var r=e.color,n=e.offset,i=Jf(r),o=d[t];if(o){o.style.background=i;var l=Ff(n||1),y=x[l]||0;if(o.style.transform="",0===n||1===n)o.style.left=100*h/f.clientWidth*p*c+m+"%",o.style.top=b+"%",y&&(o.style.transform="translate(-50%, -50%) translateX(".concat(y*E*c,"px)"));else if(.25===n)o.style.left=m+"%",o.style.top=100*h/f.clientHeight*v*u+b+"%",y&&(o.style.transform="translate(-50%, -50%) translateY(".concat(y*E*u,"px)"));else if(.5===n)o.style.left=100*-h/f.clientWidth*p*c+m+"%",o.style.top=b+"%",y&&(o.style.transform="translate(-50%, -50%) translateX(".concat(-y*E*c,"px)"));else if(.75===n)o.style.left=m+"%",o.style.top=100*-h/f.clientHeight*v*u+b+"%",y&&(o.style.transform="translate(-50%, -50%) translateY(".concat(-y*E*u,"px)"));else{var g=n*Math.PI*2,w=Math.sin(g),S=Math.cos(g),_=h*S,C=h*w;o.style.left=m+100*_*c/a+"%",o.style.top=b+100*C*u/s+"%",y&&(o.style.transform="translate(-50%, -50%) translate(".concat(y*E*S,"px, ").concat(y*E*w,"px)"))}x[l]=y+1}}))},e.prototype.setCur=function(e,t){var r,n;void 0===t&&(t=!1);var i=this.panel;null===(r=i.querySelector(".cur"))||void 0===r||r.classList.remove("cur"),null===(n=i.querySelector('span[title="'.concat(e,'"]')))||void 0===n||n.classList.add("cur"),t&&EA.setLineCur(e)},e.prototype.hide=function(){this.panel.style.display="none",this.data=void 0,this.node=void 0,this.keep=!1},e.prototype.updatePos=function(){this.node&&this.updateSize(this.node)},e}();function tT(e,t,r,n,i,o){void 0===i&&(i=1),void 0===o&&(o=1);var a=0;if(r===e)a=n>=t?-1===o?.75:.25:-1===o?.25:.75;else if(n===t)a=r>=e?-1===i?.5:0:-1===i?0:.5;else if(r>e)if(n>=t){var s=(n-t)/(r-e);a=.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a+=.5:-1===i?a=.5-a:o&&(a=1-a)}else{s=(t-n)/(r-e);a=1-.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a-=.5:-1===i?a=1.5-a:o&&(a=1-a)}else if(n>=t){s=(n-t)/(e-r);a=.5-.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a+=.5:-1===i?a=.5-a:o&&(a=1-a)}else{s=(t-n)/(e-r);a=.5+.5*Math.atan(s)/Math.PI,-1===i&&-1===o?a-=.5:-1===i?a=1.5-a:o&&(a=1-a)}return a}function rT(e,t,r){var n,i,o;return hp([e.color[0]+(t.color[0]-e.color[0])*r,e.color[1]+(t.color[1]-e.color[1])*r,e.color[2]+(t.color[2]-e.color[2])*r,(null!==(n=e.color[3])&&void 0!==n?n:1)+((null!==(i=t.color[3])&&void 0!==i?i:1)-(null!==(o=e.color[3])&&void 0!==o?o:1))*r])}var nT=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){if(t[r]){e.props.points=Iu(t[r].next),iA(e),e.reflectPoints(),e.refresh();var n=e.parent;n instanceof rC&&n.clearPointsUpward(),e.checkPointsChange()}}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){if(t[r]){e.props.points=Iu(t[r].prev),iA(e),e.reflectPoints(),e.refresh();var n=e.parent;n instanceof rC&&n.clearPointsUpward(),e.checkPointsChange()}}))},t}(gA),iT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.nodes=[],this.idxes=[],this.clonePoints=[];var i=this.panel=document.createElement("div");i.className="geometry",i.style.display="none",t.appendChild(i);var o,a=-1,s=-1,l=!1,c=!1,u=!1,h=!1,d=!1,f=!1,p=0,v=0,y={td:0,fd:0};i.addEventListener("mousedown",(function(t){var g,b,x,E,w,S,_,C;if(0===t.button&&!r.spaceKey&&n.nodes.length){var A;n.keep=!0;var T=(o=t.target).tagName.toUpperCase(),O=o.classList;if(l=c=u=h=!1,d=!1,f=!1,p=t.clientX,v=t.clientY,"DIV"===T&&O.contains("vt")){n.keepVertPath=!0,a=+o.parentElement.getAttribute("idx"),s=parseInt(o.title);var M=n.idxes[a];r.shiftKey||r.metaKey?(f=!0,M.includes(s)?d=!0:M.push(s),O.add("cur"),null===(g=o.nextElementSibling)||void 0===g||g.classList.add("t"),null===(b=o.previousElementSibling)||void 0===b||b.classList.add("f")):M.includes(s)?d=!0:(M.splice(0),M.push(s),n.clearCur(M),O.add("cur"),null===(x=o.nextElementSibling)||void 0===x||x.classList.add("t"),null===(E=o.previousElementSibling)||void 0===E||E.classList.add("f")),l=!0,n.setClonePoints(),n.emitSelectPoint()}else if("PATH"===T){a=+o.parentElement.parentElement.getAttribute("idx"),A=n.nodes[a];var k=o.getAttribute("title");if(s=parseInt(k),isNaN(s))n.clearCur(),r.emit(dT.SELECT_POINT,[],[]);else{var L=t.offsetX,R=t.offsetY,I=e.getCurPageZoom(!0),P=oT(A,+o.getAttribute("idx"),I);if((re=cf(P,L,R))&&re.d<=5){n.keepVertPath=!0;var F=(te=i.querySelector('div.item[idx="'.concat(a,'"]'))).clientWidth,D=te.clientHeight,N=Iu(A.props.points),B=Jd(P,0,re.t).map((function(e){return{x:e.x/F,y:e.y/D}})),U=Jd(P,re.t,1).map((function(e){return{x:e.x/F,y:e.y/D}})),z=parseInt(/\d+/.exec(k)[0]),G=A.props.points,X=G[z],H=G[z+1]||G[0],j=re.x/F,W=re.y/D,Y={x:j,y:W,absX:re.x,absY:re.y,cornerRadius:0,cornerStyle:Ku.ROUNDED,curveMode:2===B.length?Vu.STRAIGHT:Vu.ASYMMETRIC,fx:j,fy:W,absFx:re.x,absFy:re.y,tx:j,ty:W,absTx:re.x,absTy:re.y,hasCurveFrom:!1,hasCurveTo:!1};if(4===B.length?(X.fx=B[1].x,X.fy=B[1].y,X.absFx=X.fx*F,X.absFy=X.fy*D,Y.hasCurveTo=!0,Y.tx=B[2].x,Y.ty=B[2].y,Y.absTx=Y.tx*F,Y.absTy=Y.ty*D,nA(A,[X,Y])):3===B.length&&(X.hasCurveFrom&&X.curveMode!==Vu.NONE&&X.curveMode!==Vu.STRAIGHT?(X.fx=B[1].x,X.fy=B[1].y,X.absFx=X.fx*F,X.absFy=X.fy*D,nA(A,X)):(Y.hasCurveTo=!0,Y.tx=B[1].x,Y.ty=B[1].y,Y.absTx=Y.tx*F,Y.absTy=Y.ty*D,nA(A,Y))),4===U.length?(H.tx=U[2].x,H.ty=U[2].y,H.absTx=H.tx*F,H.absTy=H.ty*D,Y.hasCurveFrom=!0,Y.fx=U[1].x,Y.fy=U[1].y,Y.absFx=Y.fx*F,Y.absFy=Y.fy*D,nA(A,[H,Y])):3===U.length&&(H.hasCurveTo&&H.curveMode!==Vu.NONE&&H.curveMode!==Vu.STRAIGHT?(H.tx=U[1].x,H.ty=U[1].y,H.absTx=H.tx*F,H.absTy=H.ty*D,nA(A,H)):(Y.hasCurveFrom=!0,Y.fx=U[1].x,Y.fy=U[1].y,Y.absFx=Y.fx*F,Y.absFy=Y.fy*D,nA(A,Y))),Y.hasCurveTo&&Y.hasCurveFrom){var q=Y.fx-Y.x,V=Y.fy-Y.y,K=Y.x-Y.tx,Z=Y.y-Y.ty,J=Math.sqrt(Math.pow(q,2)+Math.pow(V,2)),$=Math.sqrt(Math.pow(K,2)+Math.pow(Z,2));Math.abs($-J)<1e-6&&Math.abs(q-K)<1e-6&&Math.abs(V-Z)<1e-6&&(Y.curveMode=Vu.MIRRORED)}else(Y.hasCurveTo||Y.hasCurveFrom)&&(Y.curveMode=Vu.DISCONNECTED);G.splice(z+1,0,Y),A.refresh(),A.checkPointsChange(),nA(A,Y),n.clearCur(),n.idxes[a].splice(0),n.idxes[a].push(z+1),n.update(A,!0);var Q=te.querySelector('.vt[title="'.concat(z+1,'"]'));Q.classList.add("cur"),null===(w=Q.nextElementSibling)||void 0===w||w.classList.add("t"),null===(S=Q.previousElementSibling)||void 0===S||S.classList.add("f");var ee=n.nodes.map((function(e){if(e===A)return{prev:N,next:Iu(A.props.points)}}));r.history.addCommand(new nT(n.nodes.slice(0),ee),!0),r.emit(dT.POINT_NODE,[A],[[Y]]),n.emitSelectPoint(),m=-1}else n.clearCur(),r.emit(dT.SELECT_POINT,[],[])}}else if("SPAN"===T){n.keepVertPath=!0;var te=o.parentNode;a=+te.parentElement.title,A=n.nodes[a];M=n.idxes[a];n.clearCur(M),te.classList.add("cur"),null===(_=te.nextElementSibling)||void 0===_||_.classList.add("t"),null===(C=te.previousElementSibling)||void 0===C||C.classList.add("f"),s=parseInt(te.title),M.splice(0),M.push(s);var re=A.props.points[s];o.classList.contains("f")?c=!0:u=!0,n.setClonePoints(),y.td=Math.sqrt(Math.pow(re.dspX-re.dspTx,2)+Math.pow(re.dspY-re.dspTy,2)),y.fd=Math.sqrt(Math.pow(re.dspX-re.dspFx,2)+Math.pow(re.dspY-re.dspFy,2))}else n.clearCur(),r.emit(dT.SELECT_POINT,[],[])}})),document.addEventListener("mousemove",(function(t){var i=n.nodes[a];if(i){var o=e.getCurPage();if(o){var d=e.dpi,f=o.getZoom(),g=Math.round(t.clientX-p),m=Math.round(t.clientY-v),b=Math.round(g*d/f),x=Math.round(m*d/f);if(r.shiftKey&&(Math.abs(b)>=Math.abs(x)?m=x=0:g=b=0),l){var E=[],w=[];n.nodes.forEach((function(e,t){var r=n.idxes[t].map((function(r){var i=e.props.points[r],o=n.clonePoints[t][r];return i.dspX=o.dspX+b,i.dspY=o.dspY+x,i.dspFx=o.dspFx+b,i.dspFy=o.dspFy+x,i.dspTx=o.dspTx+b,i.dspTy=o.dspTy+x,i}));if(r.length){iA(e,r),e.reflectPoints(r),e.refresh();var i=e.parent;i instanceof rC&&i.clearPointsUpward(),n.updateVertex(e),E.push(e),w.push(r)}})),r.emit(dT.POINT_NODE,E,w)}else if(c||u){var S=i.props.points[s];if(c?(S.dspFx=n.clonePoints[a][s].dspFx+b,S.dspFy=n.clonePoints[a][s].dspFy+x):(S.dspTx=n.clonePoints[a][s].dspTx+b,S.dspTy=n.clonePoints[a][s].dspTy+x),S.curveMode===Vu.MIRRORED||S.curveMode===Vu.ASYMMETRIC){var _=1;if(c){S.curveMode===Vu.ASYMMETRIC&&(_=y.fd/y.td);var C=S.dspFx-S.dspX,A=S.dspFy-S.dspY;S.dspTx=S.dspX-C*_,S.dspTy=S.dspY-A*_}else{S.curveMode===Vu.ASYMMETRIC&&(_=y.fd/y.td);var T=S.dspTx-S.dspX,O=S.dspTy-S.dspY;S.dspFx=S.dspX-T*_,S.dspFy=S.dspY-O*_}}iA(i,S),i.reflectPoints(S),i.refresh();var M=i.parent;M instanceof rC&&M.clearPointsUpward(),n.updateVertex(i),r.emit(dT.POINT_NODE,[i],[[S]])}h=!0}}})),document.addEventListener("mouseup",(function(){var e,t,o,p;if(n.nodes[a]){if(l&&!h&&d)if(f){null===(e=i.querySelector('div.item[idx="'.concat(a,'"]')).querySelector('div.vt[title="'.concat(s,'"]')))||void 0===e||e.classList.remove("cur");var v=(y=n.idxes[a]).indexOf(s);v>-1&&(y.splice(v,1),n.emitSelectPoint())}else{var y;null===(t=i.querySelectorAll("div.item"))||void 0===t||t.forEach((function(e,t){e.querySelectorAll("div.vt.cur").forEach((function(e){var r=+e.title;t===a&&r===s||e.classList.remove("cur")}))})),(y=n.idxes[a]).splice(0),y.push(s),n.clearCur(y);var g=i.querySelector('div.item[idx="'.concat(a,'"]')).querySelector('div.vt[title="'.concat(s,'"]'));g.classList.add("cur"),null===(o=g.nextElementSibling)||void 0===o||o.classList.add("t"),null===(p=g.previousElementSibling)||void 0===p||p.classList.add("f"),n.emitSelectPoint()}if(h&&(l||c||u)){var m=[],b=[];n.nodes.forEach((function(e,t){var r=n.clonePoints[t],i=e.props.points;m.push(e),Pu(r,i,["x","y","cornerRadius","cornerStyle","curveMode","fx","fy","tx","ty","hasCurveTo","hasCurveFrom"])?b.push(void 0):b.push({prev:r,next:Iu(i)})})),m.length&&(m.forEach((function(e,t){b[t]&&(e.checkPointsChange(),n.update(e,!1))})),r.history.addCommand(new nT(m,b),!0))}l=c=u=h=!1}}));var g,m=-1;i.addEventListener("mouseover",(function(e){if(!r.isMouseDown){var t=e.target;"PATH"===t.tagName.toUpperCase()?(a=+t.parentElement.parentElement.getAttribute("idx"),m=+t.getAttribute("title"),m=isNaN(m)?-1:+t.getAttribute("idx")):m=-1,g=i.querySelector('.item[idx="'.concat(a,'"] .pj'))}})),i.addEventListener("mousemove",(function(t){var r,o,s,l,c,u=n.nodes[a];if(m>-1&&u){var h=t.offsetX,d=t.offsetY,f=e.getCurPageZoom(!0),p=cf(oT(u,m,f),h,d);null===(r=i.querySelector("svg.stroke .cur"))||void 0===r||r.classList.remove("cur"),null===(o=i.querySelector("svg.interactive .cur"))||void 0===o||o.classList.remove("cur"),null===(s=i.querySelector(".pt.cur"))||void 0===s||s.classList.remove("cur"),p&&p.d<=5?(null===(l=i.querySelector('.item[idx="'.concat(a,'"] svg.stroke path[idx="').concat(m,'"]')))||void 0===l||l.classList.add("cur"),null===(c=i.querySelector('.item[idx="'.concat(a,'"] svg.interactive path[idx="').concat(m,'"]')))||void 0===c||c.classList.add("cur"),g.style.left=p.x+"px",g.style.top=p.y+"px",g.classList.add("cur")):null==g||g.classList.remove("cur")}})),i.addEventListener("mouseout",(function(e){var t,r;"PATH"===e.target.tagName.toUpperCase()&&(null===(t=i.querySelector("svg.stroke .cur"))||void 0===t||t.classList.remove("cur"),null===(r=i.querySelector("svg.interactive .cur"))||void 0===r||r.classList.remove("cur")),m=-1,null==g||g.classList.remove("cur")})),i.addEventListener("wheel",(function(e){(l||c||u)&&e.stopPropagation()})),document.addEventListener("click",(function(e){if(n.keep||n.keepVertPath)return n.keep=!1,void(n.keepVertPath=!1)}))}return e.prototype.show=function(e){var t,r=this;this.nodes.splice(0),(t=this.nodes).push.apply(t,e),this.idxes.splice(0),e.forEach((function(){r.idxes.push([])})),this.panel.innerHTML="",this.nodes.forEach((function(e){nA(e),r.update(e,!0)})),this.panel.style.display="block"},e.prototype.hide=function(){this.panel.style.display="none",this.panel.innerHTML="",this.nodes.splice(0),this.idxes.splice(0),this.keep=!1,this.keepVertPath=!1},e.prototype.update=function(e,t){void 0===t&&(t=!1),-1!==this.nodes.indexOf(e)&&(this.updatePosSize(e),t&&this.genVertex(e),this.updateVertex(e))},e.prototype.updateAll=function(e){var t=this;void 0===e&&(e=!1),this.nodes.forEach((function(r){t.update(r,e)}))},e.prototype.updatePosSize=function(e){var t=this.nodes.indexOf(e);if(-1!==t){var r=this.panel,n=r.querySelector('div.item[idx="'.concat(t,'"]'));n||((n=document.createElement("div")).className="item",n.setAttribute("idx",t.toString()),r.appendChild(n));var i=this.listener.select.calRect(e);n.style.left=i.left+"px",n.style.top=i.top+"px",n.style.width=i.width+"px",n.style.height=i.height+"px",n.style.transform=i.transform}},e.prototype.genVertex=function(e){var t=this.nodes.indexOf(e);if(-1!==t){var r=this.panel,n=e.props.points,i=r.querySelector('div.item[idx="'.concat(t,'"]'));i.innerHTML='<svg class="stroke"></svg><svg class="interactive"></svg>';var o=i.querySelector("svg.stroke"),a=i.querySelector("svg.interactive"),s="",l="",c=n.length,u=0;n.forEach((function(t,r){var n=t.curveMode===Vu.NONE||t.curveMode===Vu.STRAIGHT;l+='<div class="vt" title="'.concat(r,'">'),l+='<span class="t '.concat(n?"hide":"",'"><b></b></span>'),l+='<span class="f '.concat(n?"hide":"",'"><b></b></span>'),l+="</div>",t.curveMode===Vu.NONE||t.curveMode===Vu.STRAIGHT?(t.cornerRadius&&(r<c||e.props.isClosed)&&(s+='<path title="cr'.concat(r,'" idx="').concat(u++,'" d=""></path>')),(r<c||e.props.isClosed)&&(s+='<path title="'.concat(r,'" idx="').concat(u++,'" d=""></path>'))):(r<c||e.props.isClosed)&&(s+='<path title="'.concat(r,'" idx="').concat(u++,'" d=""></path>'))})),o.innerHTML=s,a.innerHTML=s,i.innerHTML+=l+'<div class="pj"></div>',r.appendChild(i)}},e.prototype.updateVertex=function(e){var t=this.nodes.indexOf(e);if(-1!==t){e.buildPoints();var r=this.panel.querySelector('div.item[idx="'.concat(t,'"]')),n=e.root.getCurPageZoom(!0),i=e.props.points,o=e.coords,a=r.querySelectorAll(".vt"),s=r.querySelectorAll("svg.stroke path"),l=r.querySelectorAll("svg.interactive path");i.forEach((function(e,t){var r=a[t];if(r){r.style.transform="translate(".concat(e.absX*n,"px, ").concat(e.absY*n,"px)");var i=r.querySelectorAll("span"),o=i[0],s=i[1];if(o.classList.add("hide"),s.classList.add("hide"),e.curveMode!==Vu.NONE&&e.curveMode!==Vu.STRAIGHT){var l=[];e.hasCurveTo&&o&&(o.classList.remove("hide"),l.push({el:o,cx:e.absTx,cy:e.absTy})),e.hasCurveFrom&&s&&(s.classList.remove("hide"),l.push({el:s,cx:e.absFx,cy:e.absFy})),l.forEach((function(t){var r=t.el,i=t.cx,o=t.cy,a=(i-e.absX)*n,s=(o-e.absY)*n;r.style.transform="translate(".concat(a,"px, ").concat(s,"px)");var l=Math.sqrt(a*a+s*s),c=r.firstElementChild;c.style.width=l+"px",c.style.transform="rotateZ(".concat(function(e,t){if(0===e)return t>=0?90:-90;if(0===t)return e>=0?0:180;var r=Math.atan(t/e),n=Ed(r);if(e>0)return n;if(e<0)return 180+n}(-a,-s)||0,"deg)")}))}}})),o.forEach((function(e,t){if(s[t]&&l[t]){var r="M"+e.slice(-2).map((function(e){return e*n})).join(","),a=o[t+1]||o[0],c=s[t].getAttribute("title")||"",u=parseInt(c);if(isNaN(u)){r+="L";var h=parseInt(/\d+/.exec(c)[0]);r+=i[h].absX*n+","+i[h].absY*n,r+="L",r+=a.slice(-2).map((function(e){return e*n})).join(",")}else a&&(6===a.length?r+="C":4===a.length?r+="Q":2===a.length&&(r+="L"),r+=a.map((function(e){return e*n})).join(","));s[t].setAttribute("d",r),l[t].setAttribute("d",r)}}))}},e.prototype.updateCurPosSize=function(){var e=this;this.nodes.forEach((function(t,r){e.idxes[r].length&&e.updatePosSize(t)}))},e.prototype.clearCur=function(e){var t,r,n,i=this.panel;null===(t=i.querySelectorAll("div.cur"))||void 0===t||t.forEach((function(e){e.classList.remove("cur")})),null===(r=i.querySelectorAll("div.f"))||void 0===r||r.forEach((function(e){e.classList.remove("f")})),null===(n=i.querySelectorAll("div.t"))||void 0===n||n.forEach((function(e){e.classList.remove("t")})),this.idxes.forEach((function(t){t!==e&&t.splice(0)}))},e.prototype.hasEditPoint=function(){for(var e=0,t=this.idxes.length;e<t;e++)if(this.idxes[e].length)return!0;return!1},e.prototype.delVertex=function(){var e=this,t=[],r=[];this.nodes.forEach((function(n,i){t.push(n);var o=e.idxes[i];if(o.length){var a=Iu(n.props.points);o.sort((function(e,t){return t-e})),o.forEach((function(e){n.props.points.splice(e,1)})),n.refresh(),n.checkPointsChange(),e.update(n,!0),r.push({prev:a,next:Iu(n.props.points)})}else r.push(void 0)})),t.length&&this.listener.history.addCommand(new nT(t,r),!0)},e.prototype.setClonePoints=function(){this.clonePoints=this.nodes.map((function(e){return Iu(e.props.points)}))},e.prototype.emitSelectPoint=function(){var e=this,t=[];this.nodes.map((function(r,n){var i=e.idxes[n];if(i.length){var o=[];i.forEach((function(e){o.push(r.props.points[e])})),t.push(o)}})),this.listener.emit(dT.SELECT_POINT,[],t)},e}();function oT(e,t,r){var n=e.coords,i=n[t].slice(-2),o=n[t+1]||n[0],a=[];a.push({x:i[0]*r,y:i[1]*r});for(var s=0,l=o.length;s<l;s+=2)a.push({x:o[s]*r,y:o[s+1]*r});return a}function aT(e,t,r){if(e.length){var n=e.slice(0);x_(n);var i=n[0].parent;r||(r=new rC({uuid:a(),name:"编组",index:i.props.index,style:{left:"0%",top:"0%",right:"0%",bottom:"0%"}},[])),oA(n,r);for(var o=0,s=n.length;o<s;o++){var l=n[o];if(o)l.updateStyle({booleanOperation:t});else{var c=l.getCssStyle();r.updateStyle({fill:c.fill,fillEnable:c.fillEnable,fillOpacity:c.fillOpacity,fillMode:c.fillMode,fillRule:c.fillRule,stroke:c.stroke,strokeEnable:c.strokeEnable,strokeWidth:c.strokeWidth,strokePosition:c.strokePosition,strokeMode:c.strokeMode,strokeDasharray:c.strokeDasharray,strokeLinecap:c.strokeLinecap,strokeLinejoin:c.strokeLinejoin,strokeMiterlimit:c.strokeMiterlimit,shadow:c.shadow,shadowEnable:c.shadowEnable,innerShadow:c.innerShadow,innerShadowEnable:c.innerShadowEnable,blur:c.blur,mixBlendMode:c.mixBlendMode})}}return r.clearPointsUpward(),r}}function sT(e,t){var r=e.parent,n=e.width,i=e.height,o=e.coords,s=e.computedStyle;if(e.isDestroyed)dh.error("ShapeGroup is destroyed");else{if(o){var l,c=e.getCssStyle(),u={left:100*s.left/r.width+"%",top:100*s.top/r.height+"%",right:100*s.right/r.width+"%",bottom:100*s.bottom/r.height+"%",fill:c.fill,fillEnable:c.fillEnable,fillOpacity:c.fillOpacity,fillMode:c.fillMode,fillRule:c.fillRule,stroke:c.stroke,strokeEnable:c.strokeEnable,strokeWidth:c.strokeWidth,strokePosition:c.strokePosition,strokeMode:c.strokeMode,strokeDasharray:c.strokeDasharray,strokeLinecap:c.strokeLinecap,strokeLinejoin:c.strokeLinejoin,strokeMiterlimit:c.strokeMiterlimit,shadow:c.shadow,shadowEnable:c.shadowEnable,innerShadow:c.innerShadow,innerShadowEnable:c.innerShadowEnable,blur:c.blur,mixBlendMode:c.mixBlendMode};if(o.length>1){var h=o.map((function(t,r){var o=lT(t,n,i);return new Jw({uuid:a(),name:"路径 "+(r+1),index:e.props.index,isClosed:!0,points:o,fixedRadius:0,pointRadiusBehaviour:vh.DISABLED,style:Object.assign({},u,{left:"0%",right:"0%",top:"0%",bottom:"0%"})})}));l=t||new rC({uuid:a(),name:"形状",index:e.props.index,style:u},h)}else{var d=lT(o[0],n,i);l=t||new Jw({uuid:a(),name:"矢量",index:e.props.index,isClosed:!0,points:d,fixedRadius:0,pointRadiusBehaviour:vh.DISABLED,style:u})}return e.insertAfter(l),e.remove(),l.coords=void 0,l}dh.error("Unsupported flatten data")}}function lT(e,t,r){return e.slice(0,e.length-1).map((function(n,i){var o=n.slice(-2),a=o[0]/t,s=o[1]/r,l=e[i+1],c=l.length>2,u=i?n:e[e.length-1],h=u.length>4;return{x:a,y:s,cornerRadius:0,cornerStyle:Ku.ROUNDED,curveMode:Vu.STRAIGHT,fx:c?l[0]/t:a,fy:c?l[1]/r:s,tx:h?u[2]/t:a,ty:h?u[3]/r:s,hasCurveFrom:c,hasCurveTo:h}}))}var cT=function(e){function t(t,r,n,i){var o=e.call(this,t)||this;return o.data=r,o.shapeGroup=n,o.booleanOperation=i,o}return p(t,e),t.prototype.execute=function(){t.operate(this.nodes,this.booleanOperation,this.shapeGroup)},t.prototype.undo=function(){var e=this;this.shapeGroup.fixedPosAndSize=!0,this.nodes.forEach((function(t,r){var n=e.data[r],i=n.parent,o=n.index,a=n.booleanOperation;i instanceof WS&&(i.fixedPosAndSize=!0),b_(i,t),t.props.index=o,tA(i,t),t.updateStyle({booleanOperation:a})})),this.data.forEach((function(e){var t=e.parent;t instanceof WS&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())})),this.shapeGroup.fixedPosAndSize=!1,this.shapeGroup.remove()},t.operate=function(e,t,r){return{data:e.map((function(e){return{parent:e.parent,index:e.props.index,booleanOperation:["none","union","subtract","intersect","xor"][e.computedStyle.booleanOperation]||"none"}})),shapeGroup:aT(e,t,r)}},t}(gA),uT=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){t.operate(this.nodes,this.data.map((function(e){return e.node})))},t.prototype.undo=function(){var e=this;this.data.forEach((function(t,r){var n=t.node,i=t.index,o=e.nodes[r];o.props.index=i,n.insertAfter(o),n.remove()}))},t.operate=function(e,t){var r=e.map((function(e,r){return{node:t?sT(e,t[r]):sT(e),index:e.props.index}}));return{data:r}},t}(gA),hT="undefined"!=typeof navigator&&/win/i.test(navigator.platform),dT=function(e){function t(t,r,n){void 0===n&&(n={});var i=e.call(this)||this;return i.isWin=hT,i.options=n,i.state=yA.NORMAL,i.root=t,i.dom=r,i.history=new PA,i.metaKey=!1,i.shiftKey=!1,i.ctrlKey=!1,i.altKey=!1,i.spaceKey=!1,i.middleKey=!1,i.isMouseDown=!1,i.isMouseMove=!1,i.button=0,i.isControl=!1,i.isRotate=!1,i.controlType=TA.T,i.originX=0,i.originY=0,i.startX=0,i.startY=0,i.pageTx=0,i.pageTy=0,i.centerX=0,i.centerY=0,i.dx=0,i.dy=0,i.isFrame=!1,i.selected=[],i.abcStyle=[],i.computedStyle=[],i.originStyle=[],i.cssStyle=[],i.updateOrigin(),i.select=new cA(t,r),i.input=new bA(t,r,i),i.guides=new JA(t,r,i),i.gradient=new eT(t,r,i),i.geometry=new iT(t,r,i),i.clones=[],r.addEventListener("mousedown",i.onMouseDown.bind(i)),r.addEventListener("mousemove",i.onMouseMove.bind(i)),r.addEventListener("mouseup",i.onMouseUp.bind(i)),r.addEventListener("mouseleave",i.onMouseLeave.bind(i)),r.addEventListener("touchstart",i.onTouchStart.bind(i)),r.addEventListener("touchmove",i.onTouchMove.bind(i)),r.addEventListener("touchend",i.onTouchEnd.bind(i)),r.addEventListener("click",i.onClick.bind(i)),r.addEventListener("dblclick",i.onDblClick.bind(i)),r.addEventListener("wheel",i.onWheel.bind(i)),r.addEventListener("contextmenu",i.onContextMenu.bind(i)),document.addEventListener("keydown",i.onKeyDown.bind(i)),document.addEventListener("keyup",i.onKeyUp.bind(i)),i}return p(t,e),t.prototype.updateOrigin=function(){var e=this.dom.getBoundingClientRect();this.originX=e.left,this.originY=e.top},t.prototype.active=function(e){var r;if(this.selected.splice(0),(r=this.selected).push.apply(r,e),this.state===yA.EDIT_GEOM){for(var n=!!e.length,i=0,o=e.length;i<o;i++){if(!(e[i]instanceof Jw)){n=!1;break}}n?(this.select.hideSelect(),this.geometry.show(this.selected)):(this.cancelEditGeom(),this.updateActive())}else this.updateActive();this.emit(t.SELECT_NODE,this.selected.slice(0))},t.prototype.updateActive=function(){this.computedStyle=this.selected.map((function(e){return e.getComputedStyle()})),this.selected.length?this.select.showSelect(this.selected):(this.select.hideSelect(),this.cancelEditGeom(),this.cancelEditGradient(),this.cancelEditText())},t.prototype.prepare=function(){var e=this,t=this.selected;t.forEach((function(t){e.toggleGroup(t,!0)})),this.computedStyle=t.map((function(e){return e.getComputedStyle()})),this.originStyle=t.map((function(e){return e.getStyle()}))},t.prototype.toggleGroup=function(e,t){void 0===t&&(t=!1);var r=e.parent;r&&r.isGroup&&r instanceof WS&&(r.fixedPosAndSize=t)},t.prototype.getNode=function(e,t,r){var n;void 0===r&&(r=!1);var i=this.metaKey||hT&&this.ctrlKey;(null===(n=this.options.enabled)||void 0===n?void 0:n.selectWithMeta)&&(i=!i);var o=YC(this.root,e,t,i,this.selected,r);return o instanceof kw&&o.children.length&&!i&&!this.selected.includes(o)&&(o=void 0),o},t.prototype.beforeResize=function(){this.selected.length>1?(this.selectRect=this.select.getAspectRatio(),this.clientRect=this.selected.map((function(e){var t=e.getBoundingClientRect({excludeDpi:!0});return{x:t.left,y:t.top,w:t.width,h:t.height}}))):(this.selectRect=void 0,this.clientRect=void 0)},t.prototype.onDown=function(e,r){var n,i,o=this.selected,s=this.select.isSelectControlDom(e);this.updateOrigin();var l=this.root,c=l.dpi;this.originStyle.splice(0),this.cssStyle.splice(0),this.computedStyle.splice(0),this.dx=this.dy=0;var u=r instanceof MouseEvent&&2===r.button;if(s&&!u){if(null===(n=this.options.disabled)||void 0===n?void 0:n.resize)return;this.isControl=s;var h=this.controlType={t:TA.T,r:TA.R,b:TA.B,l:TA.L,tl:TA.TL,tr:TA.TR,bl:TA.BL,br:TA.BR}[e.className];if(this.prepare(),this.state===yA.EDIT_TEXT&&this.cancelEditText(),1===o.length&&(this.metaKey||hT&&this.ctrlKey)&&!o[0].isSlice&&!(o[0]instanceof Lw)&&[TA.TL,TA.TR,TA.BL,TA.BR].indexOf(h)>-1){var d=o[0].getBoundingClientRect().points,f=Af(d[0].x,d[0].y,d[2].x,d[2].y,d[1].x,d[1].y,d[3].x,d[3].y);this.centerX=f.x/c+this.originX,this.centerY=f.y/c+this.originY,this.isRotate=!0}else this.abcStyle=o.map((function(e){return e.isArtBoard&&e instanceof kw&&!e.props.resizesContent?e.children.map((function(e){var t=e.computedStyle,r=e.style,n={left:Iu(r.left),right:Iu(r.right),top:Iu(r.top),bottom:Iu(r.bottom),width:Iu(r.width),height:Iu(r.height)};return h===TA.T||h===TA.TL||h===TA.TR?(r.bottom.u!==zu.PX&&(r.bottom.v=t.bottom,r.bottom.u=zu.PX),r.top.u!==zu.AUTO&&(r.top.u=zu.AUTO)):h!==TA.B&&h!==TA.BL&&h!==TA.BR||(r.top.u!==zu.PX&&(r.top.v=t.top,r.top.u=zu.PX),r.bottom.u!==zu.AUTO&&(r.bottom.u=zu.AUTO)),h===TA.L||h===TA.TL||h===TA.BL?(r.right.u!==zu.PX&&(r.right.v=t.right,r.right.u=zu.PX),r.left.u!==zu.AUTO&&(r.left.u=zu.AUTO)):h!==TA.R&&h!==TA.TR&&h!==TA.BR||(r.left.u!==zu.PX&&(r.left.v=t.left,r.left.u=zu.PX),r.right.u!==zu.AUTO&&(r.right.u=zu.AUTO)),r.width.u!==zu.PX&&(r.width.v=t.width,r.width.u=zu.PX),r.height.u!==zu.PX&&(r.height.v=t.height,r.height.u=zu.PX),n})):[]})),this.beforeResize()}else if(this.state===yA.ADD_TEXT){var p=this.root.getCurPage(),v=p.getZoom(),y=(r.clientX-this.originX)*c,g=(r.clientY-this.originY)*c,m="输入文本",b=new t_({uuid:a(),name:m,index:0,style:{fontFamily:"Arial",fontStyle:"normal",fontWeight:400,fontSize:16,lineHeight:0,textAlign:"left",textDecoration:[],letterSpacing:0,paragraphSpacing:0,color:"#000",translateY:"-50%"},content:m,rich:[{location:0,length:4,fontFamily:"Arial",fontStyle:"normal",fontWeight:400,fontSize:16,lineHeight:0,textAlign:"left",textDecoration:[],letterSpacing:0,paragraphSpacing:0,color:"#000"}]}),x=qC(this.root,y,g);if(x){var E=(y-(_=x.getBoundingClientRect()).left)/v,w=(g-_.top)/v;b.updateStyle({left:100*E/x.width+"%",top:100*w/x.height+"%"}),x.appendChild(b);var S=b.width;b.updateStyle({left:100*(b.computedStyle.left+.5*S)/x.width+"%",translateX:"-50%"})}else{var _;E=(y-(_=p.getBoundingClientRect()).left)/v,w=(g-_.top)/v;b.updateStyle({left:100*E/p.width+"%",top:100*w/p.height+"%"}),p.appendChild(b);S=b.width;b.updateStyle({left:100*(b.computedStyle.left+.5*S)/p.width+"%",translateX:"-50%"})}this.selected.splice(0),this.selected.push(b),this.select.showSelect(this.selected),this.input.show(b,r.clientX-this.originX,r.clientY-this.originY),this.input.node.selectAll(),this.input.hideCursor(),b.beforeEdit(),this.select.select.classList.add("text"),this.dom.classList.remove("text"),this.history.addCommand(new QA([b],[{x:b.computedStyle.left,y:b.computedStyle.top,parent:b.parent}])),this.emit(t.ADD_NODE,[b]),this.state=yA.EDIT_TEXT,this.emit(t.STATE_CHANGE,yA.NORMAL,this.state)}else{if(o.length>1&&!(this.metaKey||hT&&this.ctrlKey)&&!this.shiftKey){var C=r.clientX,A=r.clientY,T=this.select.select.getBoundingClientRect();if(C>=T.left&&A>=T.top&&C<=T.right&&A<=T.bottom)return this.prepare(),void this.guides.initMove(this.select.select,o)}if(this.state===yA.EDIT_GEOM)return void(this.geometry.keep&&this.geometry.keepVertPath||(this.isFrame=!0));y=(r.clientX-this.originX)*c,g=(r.clientY-this.originY)*c;var O=this.metaKey||hT&&this.ctrlKey;(null===(i=this.options.enabled)||void 0===i?void 0:i.selectWithMeta)&&(O=!O);var M=this.getNode(y,g);if(M instanceof kw&&M.children.length&&!o.includes(M))if(O){for(var k=!1,L=(f=0,o.length);f<L;f++){if((B=o[f])===M||B.artBoard===M){k=!0;break}}k||(this.mouseDownArtBoard=M,M=void 0)}else M=void 0;else M?M.artBoard&&o.includes(M.artBoard)&&(this.mouseDown2ArtBoard=M,M=M.artBoard):M=KC(l,y,g);this.isFrame=!M;var R=o.slice(0);if(M)if((f=o.indexOf(M))>-1)if(!this.shiftKey||this.state===yA.EDIT_TEXT&&o[0]===M){if(this.state===yA.EDIT_TEXT){b=o[0];if(this.shiftKey)b.setCursorEndByAbsCoords(y,g),b.inputStyle=void 0,this.input.hideCursor();else{var I=b.cursor,P=I.isMulti,F=I.start;b.resetCursor();var D=b.setCursorStartByAbsCoords(y,g);if(this.input.updateCursor(D),this.input.showCursor(),b.cursor.isMulti===P&&b.cursor.start===F)return}return void this.emit(t.CURSOR_NODE,o.slice(0))}if(1===o.length&&o[0]===M)return this.prepare(),this.guides.initMove(this.select.select,o),void(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)));o.splice(0),o.push(M)}else 1===o.length&&o[0]===M||o.splice(f,1);else{if(this.shiftKey)for(var N=o.length-1;N>=0;N--){var B=o[N];if(M.isArtBoard&&B.artBoard===M&&M!==B)return;B.isArtBoard&&M.artBoard===B&&M!==B&&o.splice(N,1)}else o.splice(0);o.push(M)}else this.state===yA.EDIT_TEXT||([yA.EDIT_GRADIENT,yA.EDIT_GEOM].includes(this.state)?this.emit(t.SELECT_POINT,[],[]):this.shiftKey||o.splice(0));if(this.state===yA.EDIT_TEXT&&this.cancelEditText(R[0]),this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)),o.length?this.select.showSelect(o):this.select.hideSelect(),0===R.length&&0===o.length)return;(this.metaKey||hT&&this.ctrlKey)&&1===o.length&&this.select.metaKey(!0),this.prepare(),this.guides.initMove(this.select.select,o),this.emit(t.SELECT_NODE,o.slice(0))}},t.prototype.onMouseDown=function(e){var t,r;if(!(null===(t=this.options.disabled)||void 0===t?void 0:t.select)&&!this.isMouseDown){var n=this.root.getCurPage();if(n){if(this.button=e.button,2===e.button){if([yA.EDIT_GRADIENT,yA.EDIT_GEOM].includes(this.state))return void OA.showOk(e.pageX,e.pageY,this);if(this.metaKey||hT&&this.ctrlKey||this.state===yA.EDIT_TEXT||(null===(r=this.options.disabled)||void 0===r?void 0:r.contextMenu))return;var i=e.target;return this.onDown(i,e),void OA.showCanvas(e.pageX,e.pageY,this)}if([yA.EDIT_GRADIENT,yA.EDIT_GEOM].includes(this.state))if(0!==e.button||this.spaceKey)(1===e.button||0===e.button&&this.spaceKey)&&(this.state===yA.EDIT_GRADIENT?(this.gradient.keep=!0,EA.keep=!0):this.geometry.keep=!0);else if(this.state===yA.EDIT_GRADIENT)return void(this.gradient.keep||this.cancelEditGradient());this.isMouseDown=!0,this.isMouseMove=!1,this.startX=e.clientX,this.startY=e.clientY,1===e.button&&(this.middleKey=!0);var o=n.getComputedStyle();if(this.pageTx=o.translateX,this.pageTy=o.translateY,0===e.button&&this.spaceKey||this.middleKey||this.state===yA.HAND)this.dom.classList.add("handing");else if(!this.spaceKey){i=e.target;this.onDown(i,e)}}}},t.prototype.onMove=function(e,r){var n,i,o,a,s,l=this,c=this.root,u=c.getCurPage();if(u&&![yA.EDIT_GRADIENT].includes(this.state)){var h=c.dpi,d=e.clientX-this.startX,f=e.clientY-this.startY,p=u.getZoom(),v=this.dx=Math.round(d*h/p),y=this.dy=Math.round(f*h/p),g=this.selected;if(this.isControl)if(this.isRotate){var m=this.centerX-this.originX,b=this.centerY-this.originY,x=this.startX-this.originX,E=this.startY-this.originY,w=e.clientX-this.originX,S=e.clientY-this.originY,_=Ed(Cd(Math.sqrt(Math.pow(x-w,2)+Math.pow(E-S,2)),Math.sqrt(Math.pow(m-w,2)+Math.pow(b-S,2)),Math.sqrt(Math.pow(x-m,2)+Math.pow(E-b,2)))),C=Yh(x-m,E-b,w-m,S-b);if(this.shiftKey)for(var A=0;A<=180;A+=15)if(Math.abs(_-A)<=7.5){_=A;break}var T=g[0],O=(this.computedStyle[0].rotateZ+_*(C>=0?1:-1))%360;T.updateStyle({rotateZ:O}),this.select.updateSelect(g),this.emit(t.ROTATE_NODE,g.slice(0))}else{var M=this.shiftKey;if(!M){A=0;for(var k=g.length;A<k;A++)if(g[A].props.constrainProportions){M=!0;break}}var L=this.altKey;(null===(n=this.options.enabled)||void 0===n?void 0:n.resizeWithAlt)&&(L=!L);var R=this.controlType;g.forEach((function(e,t){l.isMouseMove||(e.startSizeChange(),l.computedStyle[t]=e.getComputedStyle(),l.cssStyle[t]=e.getCssStyle());var r=l.computedStyle[t],n=l.cssStyle[t];l.selectRect&&l.clientRect&&l.clientRect[t]?LA.updateStyleMultiAr(e,r,n,v,y,R,l.clientRect[t],l.selectRect,M,L):LA.updateStyle(e,r,n,v,y,R,M,L)})),this.isMouseMove=!0,this.select.updateSelect(g),this.emit(t.RESIZE_NODE,g.slice(0))}else if(this.isMouseDown){if(this.state===yA.EDIT_TEXT){var I=(e.clientX-this.originX)*h,P=(e.clientY-this.originY)*h,F=g[0],D=F.cursor,N=D.isMulti,B=D.start,U=D.end;F.setCursorEndByAbsCoords(I,P),this.input.hideCursor();var z=F.cursor;N===z.isMulti&&B===z.start&&U===z.end||this.emit(t.CURSOR_NODE,g.slice(0))}else{if(null===(i=this.options.disabled)||void 0===i?void 0:i.move)return;if(this.isFrame){this.isMouseMove?this.select.updateFrame(d,f):this.select.showFrame(this.startX-this.originX,this.startY-this.originY,d,f),this.isMouseMove=!0;var G=(this.startX-this.originX)*h,X=(this.startY-this.originY)*h,H=this.metaKey||hT&&this.ctrlKey;if((null===(o=this.options.enabled)||void 0===o?void 0:o.selectWithMeta)&&(H=!H),this.state===yA.EDIT_GEOM){var j=this.geometry;if(d&&f||j.keep){j.keep=!0;var W=!1;j.nodes.forEach((function(e,t){var r,n,i,o=rA(e,G,X,G+d*h,X+f*h);if(o.length){j.nodes.includes(e)||j.nodes.push(e);var a=j.nodes.indexOf(e),s=j.idxes[a];if(o.join(",")!==s.sort((function(e,t){return e-t})).join(",")){s.splice(0),s.push.apply(s,o);var l=j.panel.querySelector('div.item[idx="'.concat(a,'"]'));null===(r=l.querySelectorAll("div.cur"))||void 0===r||r.forEach((function(e){e.classList.remove("cur")})),null===(n=l.querySelectorAll("div.f"))||void 0===n||n.forEach((function(e){e.classList.remove("f")})),null===(i=l.querySelectorAll("div.t"))||void 0===i||i.forEach((function(e){e.classList.remove("t")})),o.forEach((function(e){var t,r,n=l.querySelector('div.vt[title="'.concat(e,'"]'));n.classList.add("cur"),null===(t=n.nextElementSibling)||void 0===t||t.classList.add("t"),null===(r=n.previousElementSibling)||void 0===r||r.classList.add("f")})),W=!0}}})),W&&this.geometry.emitSelectPoint()}return}var Y=ZC(c,G,X,G+d*h,X+f*h,H),q=g.splice(0);g.push.apply(g,Y);var V=q.length!==g.length;if(!V)for(A=0,k=q.length;A<k;A++)q[A]!==g[A]&&(V=!0);V&&(Y.length?this.select.showSelect(g):this.select.hideSelect(),this.emit(t.SELECT_NODE,g.slice(0)))}else{if(this.state===yA.EDIT_GEOM)return;if(this.select.select.classList.add("move"),this.shiftKey&&(Math.abs(v)>=Math.abs(y)?this.dy=f=y=0:this.dx=d=v=0),!(null===(a=this.options.disabled)||void 0===a?void 0:a.guides))if(H=this.metaKey||hT&&this.ctrlKey)this.guides.hide();else{var K=this.guides.snapMove(d,f,h/p);K&&(this.dx=v+=K.x*h/p,this.dy=y+=K.y*h/p)}g.forEach((function(e,r){var n=l.computedStyle[r];e.artBoard!==MA.update(e,n,v,y)&&l.emit(t.ART_BOARD_NODE,[e])})),this.select.updateSelect(g),this.emit(t.MOVE_NODE,g.slice(0))}}this.isMouseMove=!0}else if(!r&&this.state===yA.NORMAL){if(null===(s=this.options.disabled)||void 0===s?void 0:s.hover)return;var Z=e.target;if(this.select.isSelectControlDom(Z))return void(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)));this.startX=e.clientX-this.originX,this.startY=e.clientY-this.originY;I=this.startX*h,P=this.startY*h;this.hover(I,P)}}},t.prototype.onMouseMove=function(e){var r,n,i=this.root,o=i.dpi,a=this.selected;if(!this.spaceKey&&!this.middleKey&&this.state!==yA.HAND||this.isFrame)this.onMove(e,!1);else if(this.isMouseDown){if(null===(r=this.options.disabled)||void 0===r?void 0:r.drag)return;this.dom.classList.add("handing"),this.select.hideHover(),this.isMouseMove=!0;var s=i.getCurPage();if(s){var l=e.clientX-this.startX,c=e.clientY-this.startY;s.updateStyle({translateX:this.pageTx+l,translateY:this.pageTy+c}),a.length&&this.select.updateSelect(a),this.state===yA.EDIT_GRADIENT?this.gradient.updatePos():this.state===yA.EDIT_GEOM&&this.geometry.updateCurPosSize()}}else{if(null===(n=this.options.disabled)||void 0===n?void 0:n.hover)return;if("CANVAS"!==e.target.tagName.toUpperCase())return;var u=this.getNode(e.offsetX*o,e.offsetY*o);u?(-1===a.indexOf(u)&&this.select.showHover(u),this.emit(t.HOVER_NODE,u)):this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE))}},t.prototype.onMouseUp=function(e){var r,n,i=this;if(!e||e.button===this.button){var o=this.selected;if(o.forEach((function(e){i.toggleGroup(e,!1)})),this.isControl)if(this.isControl=!1,this.isRotate){this.isRotate=!1;var a=o[0];this.history.addCommand(new DA([a],[{prev:{rotateZ:this.computedStyle[0].rotateZ},next:{rotateZ:a.computedStyle.rotateZ}}]),!0),this.metaKey||hT&&this.ctrlKey||this.select.metaKey(!1)}else{var s=this.dx,l=this.dy;if(this.abcStyle.forEach((function(e,t){if(e.length){var r=o[t].children;e.forEach((function(e,t){var n=r[t].style;["left","right","top","bottom","width","height"].forEach((function(t){var r=e[t];n[t].v=r.v,n[t].u=r.u}))}))}})),this.isMouseMove){var c=this.shiftKey;if(!c)for(var u=0,h=o.length;u<h;u++)if(o[u].props.constrainProportions){c=!0;break}var d=this.altKey;(null===(r=this.options.enabled)||void 0===r?void 0:r.resizeWithAlt)&&(d=!d);var f=this.controlType,p=[];o.forEach((function(e,t){if(e.endSizeChange(i.originStyle[t]),s||l){e.checkPosSizeUpward();var r={dx:s,dy:l,controlType:f,aspectRatio:c,clientRect:i.clientRect&&i.clientRect[t],selectRect:i.selectRect,fromCenter:d},n=i.originStyle[t];n.width.u===zu.AUTO&&(r.widthFromAuto=!0),n.height.u===zu.AUTO&&(r.heightFromAuto=!0),i.computedStyle[t].scaleX!==e.computedStyle.scaleX&&(r.flipX=!0),i.computedStyle[t].scaleY!==e.computedStyle.scaleY&&(r.flipY=!0),p.push(r)}})),p.length&&this.history.addCommand(new LA(o.slice(0),p))}}else if(this.isMouseMove)if(this.state===yA.EDIT_TEXT){if(null===(n=this.options.disabled)||void 0===n?void 0:n.inputText)return;o[0].checkCursorMulti()?this.input.hideCursor():(this.input.updateCursor(),this.input.showCursor()),this.input.focus()}else if([yA.EDIT_GRADIENT].includes(this.state));else if(this.isFrame)this.select.hideFrame();else{this.guides.hide(),this.select.select.classList.remove("move");var v=this.dx,y=this.dy,g=[];o.forEach((function(e,t){e.endPosChange(i.originStyle[t],v,y),(v||y)&&(e.checkPosSizeUpward(),g.push({dx:v,dy:y}))})),g.length&&this.history.addCommand(new MA(o.slice(0),g),!0)}else this.mouseDownArtBoard?(this.shiftKey||o.splice(0),o.push(this.mouseDownArtBoard),this.select.hideHover(),this.select.showSelect(o),this.prepare(),this.emit(t.SELECT_NODE,o.slice(0))):this.mouseDown2ArtBoard&&!this.shiftKey&&(o.splice(0),o.push(this.mouseDown2ArtBoard),this.select.hideHover(),this.select.showSelect(o),this.prepare(),this.emit(t.SELECT_NODE,o.slice(0)));this.state===yA.EDIT_GEOM&&(this.geometry.keep||this.cancelEditGeom()),this.isMouseDown=!1,this.isMouseMove=!1,this.mouseDownArtBoard=void 0,this.mouseDown2ArtBoard=void 0,this.isFrame=!1,this.middleKey=!1,this.dom.classList.remove("handing"),this.spaceKey||this.middleKey||this.state===yA.HAND||this.dom.classList.remove("hand")}},t.prototype.onMouseLeave=function(){this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)),(this.isMouseDown||this.isControl)&&this.onMouseUp()},t.prototype.onTouchStart=function(e){if(1===e.touches.length){var t=e.touches[0];this.isMouseDown=!0,this.isMouseMove=!1,this.startX=t.clientX,this.startY=t.clientY;var r=e.target;this.onDown(r,t)}},t.prototype.onTouchMove=function(e){1===e.touches.length&&this.onMove(e.touches[0],!0)},t.prototype.onTouchEnd=function(){this.onMouseUp()},t.prototype.onClick=function(e){},t.prototype.onDblClick=function(e){var r,n,i,o=this.root;if(o.getCurPage()){var a=this.selected.slice(0),s=o.dpi,l=this.getNode((e.clientX-this.originX)*s,(e.clientY-this.originY)*s,!0);if(l&&!(l instanceof kw)){if(1!==this.selected.length||l!==this.selected[0]){if(null===(r=this.options.disabled)||void 0===r?void 0:r.select)return;this.selected.splice(0),this.selected.push(l),this.select.showSelect(this.selected)}if(l instanceof t_){if(null===(n=this.options.disabled)||void 0===n?void 0:n.editText)return;this.input.show(l,e.clientX-this.originX,e.clientY-this.originY),l.beforeEdit(),this.state=yA.EDIT_TEXT,this.select.select.classList.add("text"),this.emit(t.STATE_CHANGE,yA.NORMAL,this.state)}else if(l instanceof Jw&&a.includes(l)){if(null===(i=this.options.disabled)||void 0===i?void 0:i.editGeom)return;this.select.hideSelect(),this.geometry.show([l]),this.state=yA.EDIT_GEOM,this.emit(t.STATE_CHANGE,yA.NORMAL,this.state)}this.emit(t.SELECT_NODE,this.selected.slice(0))}}},t.prototype.onWheel=function(e){var r,n;e.preventDefault();var i=this.root,o=i.dpi,a=i.width,s=i.height,l=i.getCurPage();if(l){if(this.select.hideHover(),e.ctrlKey||e.metaKey){if(null===(r=this.options.disabled)||void 0===r?void 0:r.scale)return;var c=e.deltaY;e.ctrlKey&&!e.metaKey&&(c*=50);var u=0;c<0?u=c<-300?.2:c<-200?.1:c<-100?.05:c<-50?.02:.01:c>0&&(u=c>300?-.2:c>200?-.1:c>100?-.05:c>50?-.02:-.01);var h=(e.clientX-this.originX)*o/a,d=(e.clientY-this.originY)*o/s,f=l.getZoom(!0);f<1&&(u*=f),u<0&&u>-.01?u=-.01:u>0&&u<.01&&(u=.01),(f+=u)>32?f=32:f<.01&&(f=.01),f=Ff(f),i.zoomTo(f,h,d),this.emit(t.ZOOM_PAGE,f)}else{if(null===(n=this.options.disabled)||void 0===n?void 0:n.drag)return;var p=l.getComputedStyle(),v=p.translateX,y=p.translateY;l.updateStyle({translateX:v-e.deltaX,translateY:y-e.deltaY})}this.updateSelected(),this.updateInput(),this.updateGradient(),this.updateGeom()}},t.prototype.zoom=function(e){var r=this.root,n=r.getCurPage();if(n){var i=n.getZoom(!0);(i*=e)>32?i=32:i<.01&&(i=.01),i=Ff(i),r.zoomTo(i,.5,.5),this.updateSelected(),this.updateInput(),this.updateGradient(),this.updateGeom(),this.emit(t.ZOOM_PAGE,i)}},t.prototype.zoomTo=function(e,r,n){void 0===r&&(r=.5),void 0===n&&(n=.5);var i=this.root.getCurPage();i&&(i.zoomTo(e,r,n),this.updateSelected(),this.updateInput(),this.updateGradient(),this.updateGeom(),this.emit(t.ZOOM_PAGE,e))},t.prototype.zoomActual=function(){this.root.zoomActual()&&this.emit(t.ZOOM_PAGE,this.root.getCurPageZoom())},t.prototype.zoomFit=function(){this.root.zoomFit()&&this.emit(t.ZOOM_PAGE,this.root.getCurPageZoom())},t.prototype.selectAll=function(){var e,t=this.root;if(t.getCurPage()){var r=this.metaKey||hT&&this.ctrlKey;(null===(e=this.options.enabled)||void 0===e?void 0:e.selectWithMeta)&&(r=!r);var n=ZC(t,0,0,t.width,t.height,r);this.active(n)}},t.prototype.group=function(e){if(void 0===e&&(e=this.selected),e.length){var r=YA.operate(e),n=r.data,i=r.group;if(i){var o=e.slice(0);this.selected.splice(0),this.selected.push(i),this.select.updateSelect(this.selected),this.history.addCommand(new YA(o.slice(0),n,i)),this.emit(t.GROUP_NODE,[i],[o.slice(0)]),this.emit(t.SELECT_NODE,[i])}}},t.prototype.unGroup=function(e){var r=this;void 0===e&&(e=this.selected);var n=e.filter((function(e){return e instanceof WS}));if(n.length){var i=qA.operate(n);this.selected.splice(0),i.forEach((function(e){var t;(t=r.selected).push.apply(t,e.children)})),this.select.updateSelect(this.selected),this.history.addCommand(new qA(n.slice(0),i.map((function(e){return{parent:e.parent,children:e.children}})))),this.emit(t.UN_GROUP_NODE,i.map((function(e){return e.children.slice(0)})),n.slice(0));var o=[];i.forEach((function(e){o.push.apply(o,e.children)})),this.emit(t.SELECT_NODE,o)}},t.prototype.boolGroup=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=cT.operate(r,e),i=n.data,o=n.shapeGroup;if(o){var a=r.slice(0);this.selected.splice(0),this.selected.push(o),this.select.updateSelect(this.selected),this.history.addCommand(new cT(a,i,o,e)),this.emit(t.BOOL_GROUP_NODE,[o],[a.slice(0)],[e]),this.emit(t.SELECT_NODE,[o])}}},t.prototype.flatten=function(e){var r;void 0===e&&(e=this.selected);var n=e.filter((function(e){return e instanceof rC}));if(n.length){var i=uT.operate(n).data;this.selected.splice(0);var o=i.map((function(e){return e.node}));(r=this.selected).push.apply(r,o),this.select.updateSelect(this.selected),this.history.addCommand(new uT(n,i)),this.emit(t.FLATTEN_NODE,o.slice(0),n.slice(0)),this.emit(t.SELECT_NODE,o.slice(0))}},t.prototype.mask=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){var r=["none","outline","alpha","gray","alpha-with","gray-with"][t.computedStyle.maskMode];n.push({maskMode:r}),t.updateStyle({maskMode:e})})),this.history.addCommand(new jA(r.slice(0),n.map((function(t){return{prev:t,next:{maskMode:e}}})))),this.emit(t.MASK_NODE,r.slice(0))}},t.prototype.breakMask=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){n.push({breakMask:t.computedStyle.breakMask}),t.updateStyle({breakMask:e})})),this.history.addCommand(new WA(r.slice(0),n.map((function(t){return{prev:t,next:{breakMask:e}}})))),this.emit(t.BREAK_MASK_NODE,r.slice(0))}},t.prototype.lock=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t,r){n.push(!!t.props.isLocked),t.props.isLocked=e})),this.history.addCommand(new KA(r.slice(0),n.map((function(t){return{prev:t,next:e}})))),this.emit(t.LOCK_NODE,r.slice(0))}},t.prototype.visible=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){n.push(t.computedStyle.visibility===rh.VISIBLE?"visible":"hidden"),t.updateStyle({visibility:e})})),this.history.addCommand(new ZA(r.slice(0),n.map((function(t){return{prev:{visibility:t},next:{visibility:e}}})))),this.updateActive(),this.emit(t.VISIBLE_NODE,r.slice(0))}},t.prototype.rename=function(e,r){void 0===r&&(r=this.selected);var n=r.map((function(t,r){var n=t.props.name||"",i=e[r];return t.props.name=i,t.props.nameIsFixed=!0,{prev:n,next:i}}));this.history.addCommand(new VA(r.slice(0),n)),this.emit(t.RENAME_NODE,r.slice(0),n)},t.prototype.removeNode=function(e){if(void 0===e&&(e=this.selected),e.length){var r=e.slice(0),n=e.splice(0).map((function(e){for(var t=e;t&&t.parent&&t.parent.isGroup&&t.parent instanceof WS&&1===t.parent.children.length;)t=t.parent;return t})),i=[];n.forEach((function(e,t){var n=FA.operate(e);e!==r[t]?i.push(K(K({},n),{selected:r[t]})):i.push(n)})),this.select.hideSelect(),this.history.addCommand(new FA(n,i)),this.emit(t.REMOVE_NODE,n.slice(0)),this.emit(t.SELECT_NODE,[])}},t.prototype.clone=function(e){void 0===e&&(e=this.selected),e.length&&(this.clones=e.map((function(e){return{parent:e.parent,node:e.clone()}})))},t.prototype.paste=function(e){if(void 0===e&&(e=this.clones),e.length){var r=[],n=[];e.forEach((function(e){var t={x:e.node.computedStyle.left,y:e.node.computedStyle.top,parent:e.parent};eA(e.node,t,!0),r.push(e.node),n.push(t)})),r.length&&(this.history.addCommand(new QA(r,n)),this.selected=r.slice(0),this.updateActive(),this.emit(t.ADD_NODE,r.slice(0)))}},t.prototype.hover=function(e,r){var n=this.getNode(e,r);n||(n=KC(this.root,e,r)),n?-1===this.selected.indexOf(n)&&this.select.hoverNode!==n?(this.select.showHover(n),this.emit(t.HOVER_NODE,n)):this.selected.indexOf(n)>-1&&this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)):this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE))},t.prototype.onKeyDown=function(e){var r,n,i,o,a,s,l,c,u,h,d,f,p=this,v=this.metaKey,y=this.ctrlKey;if(this.metaKey=e.metaKey,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.root.getCurPage()){var g=this.metaKey||hT&&this.ctrlKey;if(!g||1!==this.selected.length||this.selected[0].isSlice||this.selected[0]instanceof Lw||this.select.metaKey(!0),(v!==this.metaKey||hT&&y!==this.ctrlKey)&&!this.isMouseDown){var m=this.root.dpi,b=this.startX*m,x=this.startY*m;this.hover(b,x)}var E=e.keyCode,w=e.code,S=e.target,_=["INPUT","TEXTAREA"].includes(S.tagName.toUpperCase());if(8===E||46===E||"Backspace"===w||"Delete"===w)this.state===yA.EDIT_GEOM?this.geometry.hasEditPoint()?this.geometry.delVertex():this.cancelEditGeom():this.state===yA.EDIT_GRADIENT?this.cancelEditGradient():_||(null===(h=this.options.disabled)||void 0===h?void 0:h.remove)||this.removeNode();else if(32===E||"Space"===w)this.spaceKey=!0,(null===(d=this.options.disabled)||void 0===d?void 0:d.drag)||this.isFrame||this.state===yA.EDIT_GEOM&&this.geometry.hasEditPoint()||this.dom.classList.add("hand");else if(27!==E&&"Escape"!==w||!this.altKey)if(27===E||"Escape"===w)if(OA.hide(),EA.isShow())EA.hide(),this.state===yA.EDIT_GRADIENT?(this.select.showSelectNotUpdate(),this.state=yA.NORMAL,this.emit(t.STATE_CHANGE,yA.EDIT_GRADIENT,this.state)):this.state===yA.EDIT_GEOM?(this.select.showSelect(this.selected),this.state=yA.NORMAL,this.emit(t.STATE_CHANGE,yA.EDIT_GEOM,this.state)):this.state===yA.EDIT_TEXT&&this.input.focus();else if(this.state===yA.EDIT_TEXT)this.cancelEditText();else if(this.state===yA.ADD_TEXT)this.dom.classList.remove("text"),this.state=yA.NORMAL,this.emit(t.STATE_CHANGE,yA.ADD_TEXT,this.state);else if(this.state===yA.EDIT_GEOM)this.geometry.hasEditPoint()?(this.geometry.clearCur(),this.emit(t.SELECT_POINT,[],[])):this.cancelEditGeom();else if(this.state===yA.HAND)this.dom.classList.remove("hand"),this.state=yA.NORMAL,this.emit(t.STATE_CHANGE,yA.HAND,this.state);else{var C=this.selected.filter((function(e){return e instanceof Jw||e instanceof rC}));if(C.length){var A=C.map((function(e){var t=e.parent;if(t instanceof rC)return t})).filter((function(e){return e}));if(A.length){var T=[];return A.forEach((function(e){for(var t=T.length-1;t>=0;t--){var r=T[t];if(e.isParent(r))return void T.splice(t,1,e);if(e.isChild(r))return}T.push(e)})),this.selected.splice(0),(r=this.selected).push.apply(r,T),this.select.showSelect(this.selected),void this.emit(t.SELECT_NODE,this.selected.slice(0))}}this.selected.splice(0),this.select.hideSelect(),this.select.hideHover(),this.emit(t.SELECT_NODE,this.selected.slice(0))}else if(E>=37&&E<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(w)){var O=e.target;if(O&&!["INPUT","SELECT","TEXTAREA"].includes(O.tagName.toUpperCase())){e.preventDefault();var M=0,k=0;if(37===E?M=this.shiftKey?-10:this.altKey?-.1:-1:38===E?k=this.shiftKey?-10:this.altKey?-.1:-1:39===E?M=this.shiftKey?10:this.altKey?.1:1:40===E&&(k=this.shiftKey?10:this.altKey?.1:1),this.state===yA.EDIT_GEOM){var L=this.geometry,R=[],I=[],P=[];L.nodes.forEach((function(e,t){var r=L.idxes[t];if(r.length){R.push(e);var n=Iu(e.props.points),i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){e.dspX+=M,e.dspY+=k,e.dspFx+=M,e.dspFy+=k,e.dspTx+=M,e.dspTy+=k})),iA(e,i),e.reflectPoints(i),e.refresh(),L.updateVertex(e),I.push({prev:n,next:Iu(e.props.points)}),P.push(i)}})),R.length&&(this.emit(t.POINT_NODE,R,P),this.history.addCommand(new nT(R,I)))}else{var F=this.selected.slice(0),D=[],N=[];F.forEach((function(e){var t=e.getStyle();e.artBoard!==MA.update(e,e.computedStyle,M,k)&&N.push(e),e.endPosChange(t,M,k),D.push({dx:M,dy:k}),e.checkPosSizeUpward()})),N.length&&this.emit(t.ART_BOARD_NODE,N),F.length&&(this.select.updateSelect(F),this.emit(t.MOVE_NODE,F.slice(0)),this.history.addCommand(new MA(F,D)))}}}else if(65!==E&&"KeyA"!==w||!g)if(67!==E&&"KeyC"!==w&&88!==E&&"KeyX"!==w||!g)if(86!==E&&"KeyV"!==w||!g)if(187!==E&&"Equal"!==w||!g)if(189!==E&&"Minus"!==w||!g){if((90===E||"KeyZ"===w)&&g){var B;if(e.target&&_&&e.preventDefault(),B=this.shiftKey?this.history.redo():this.history.undo()){F=B.nodes.slice(0);var U=this.selected.slice(0),z=!1;if(B instanceof QA||B instanceof FA||B instanceof YA||B instanceof qA||B instanceof cT||B instanceof nT||B instanceof uT||(this.selected.splice(0),(n=this.selected).push.apply(n,F),this.updateActive(),z=!0),B instanceof MA)this.emit(t.MOVE_NODE,F.slice(0));else if(B instanceof LA)this.emit(t.RESIZE_NODE,F.slice(0));else if(B instanceof FA)this.shiftKey?(this.selected.splice(0),this.select.hideSelect(),this.emit(t.REMOVE_NODE,F.slice(0)),this.emit(t.SELECT_NODE,[])):(this.selected=F.map((function(e,t){return B.data[t].selected||e})),this.updateActive(),this.emit(t.ADD_NODE,F.slice(0),this.selected.slice(0)),this.emit(t.SELECT_NODE,F.slice(0)));else if(B instanceof QA)this.shiftKey?(this.selected.splice(0),(i=this.selected).push.apply(i,F),this.updateActive(),this.emit(t.ADD_NODE,F.slice(0)),this.emit(t.SELECT_NODE,F.slice(0))):(this.selected.splice(0),this.select.hideSelect(),this.emit(t.REMOVE_NODE,F.slice(0)),this.emit(t.SELECT_NODE,[]),this.state===yA.EDIT_TEXT&&(this.state=yA.NORMAL,this.input.hide(),this.emit(t.STATE_CHANGE,yA.ADD_TEXT,this.state)));else if(B instanceof DA)this.emit(t.ROTATE_NODE,F.slice(0));else if(B instanceof NA)this.emit(t.OPACITY_NODE,F.slice(0));else if(B instanceof UA)this.emit(t.SHADOW_NODE,F.slice(0));else if(B instanceof zA)this.emit(t.BLUR_NODE,F.slice(0));else if(B instanceof GA)this.emit(t.COLOR_ADJUST_NODE,F.slice(0));else if(B instanceof BA)this.emit(t.TEXT_VERTICAL_ALIGN_NODE,F.slice(0));else if(B instanceof XA)this.emit(t.FILL_NODE,F.slice(0),B.data);else if(B instanceof HA)this.emit(t.STROKE_NODE,F.slice(0));else if(B instanceof YA)this.selected.splice(0),this.shiftKey?(this.selected.push(B.group),this.updateActive(),this.emit(t.GROUP_NODE,[B.group],[F.slice(0)]),this.emit(t.SELECT_NODE,[B.group])):((o=this.selected).push.apply(o,F),this.updateActive(),this.emit(t.UN_GROUP_NODE,[F.slice(0)],[B.group]),this.emit(t.SELECT_NODE,F.slice(0)));else if(B instanceof qA)if(this.selected.splice(0),this.shiftKey){F.forEach((function(e,t){var r;(r=p.selected).push.apply(r,B.data[t].children)})),this.updateActive(),this.emit(t.UN_GROUP_NODE,F.map((function(e,t){return B.data[t].children.slice(0)})),B.nodes.slice(0));var G=[];F.forEach((function(e,t){G.push.apply(G,B.data[t].children)})),this.emit(t.SELECT_NODE,G)}else(a=this.selected).push.apply(a,F),this.updateActive(),this.emit(t.GROUP_NODE,F.slice(0),B.data.map((function(e){return e.children.slice(0)}))),this.emit(t.SELECT_NODE,F.slice(0));else if(B instanceof cT)this.selected.splice(0),this.shiftKey?(this.selected.push(B.shapeGroup),this.updateActive(),this.emit(t.BOOL_GROUP_NODE,[B.shapeGroup],[F.slice(0)]),this.emit(t.SELECT_NODE,[B.shapeGroup])):((s=this.selected).push.apply(s,F),this.updateActive(),this.emit(t.UN_BOOL_GROUP_NODE,[F.slice(0)],[B.shapeGroup]),this.emit(t.SELECT_NODE,F.slice(0)));else if(B instanceof jA){var X=["none","outline","alpha","gray","alpha-with","gray-with"][F[0].computedStyle.maskMode];this.emit(t.MASK_NODE,F.slice(0),X)}else if(B instanceof WA){var H=F[0].computedStyle.breakMask;this.emit(t.BREAK_MASK_NODE,F.slice(0),H)}else if(B instanceof IA){if(B.type===IA.TEXT_ALIGN?this.emit(t.TEXT_ALIGN_NODE,F.slice(0)):B.type===IA.COLOR?this.emit(t.COLOR_NODE,F.slice(0)):B.type===IA.FONT_FAMILY?this.emit(t.FONT_FAMILY_NODE,F.slice(0)):B.type===IA.FONT_SIZE?this.emit(t.FONT_SIZE_NODE,F.slice(0)):B.type===IA.LINE_HEIGHT?this.emit(t.LINE_HEIGHT_NODE,F.slice(0)):B.type===IA.PARAGRAPH_SPACING?this.emit(t.PARAGRAPH_SPACING_NODE,F.slice(0)):B.type===IA.LETTER_SPACING&&this.emit(t.LETTER_SPACING_NODE,F.slice(0)),this.state===yA.EDIT_TEXT){var j=(Q=F[0]).getSortedCursor(),W=j.isMulti,Y=j.start;if(W)this.input.hideCursor();else{var q=Q.updateCursorByIndex(Y);this.input.updateCursor(q),this.input.showCursor()}this.input.focus()}}else if(B instanceof mA){if(this.state===yA.EDIT_TEXT){var V=(Q=F[0]).getSortedCursor();W=V.isMulti,Y=V.start;if(W)this.input.hideCursor();else{q=Q.updateCursorByIndex(Y);this.input.updateCursor(q),this.input.showCursor()}this.input.focus()}}else if(B instanceof nT)this.emit(t.SELECT_NODE,F.slice(0)),this.state===yA.EDIT_GEOM?this.geometry.show(F.slice(0)):(this.selected.splice(0),(l=this.selected).push.apply(l,F),this.updateActive()),this.emit(t.POINT_NODE,F.slice(0));else if(B instanceof VA)this.emit(t.RENAME_NODE,F.slice(0));else if(B instanceof KA)this.emit(t.LOCK_NODE,F.slice(0));else if(B instanceof ZA)this.emit(t.VISIBLE_NODE,F.slice(0));else if(B instanceof uT)if(this.selected.splice(0),this.shiftKey){var K=B.data.map((function(e){return e.node}));(c=this.selected).push.apply(c,K),this.updateActive(),this.emit(t.FLATTEN_NODE,K.slice(0),F.slice(0)),this.emit(t.SELECT_NODE,K.slice(0))}else(u=this.selected).push.apply(u,F),this.updateActive(),this.emit(t.UN_FLATTEN_NODE,F.slice(0),B.data.map((function(e){return e.node}))),this.emit(t.SELECT_NODE,F.slice(0));if(z)if(F.length!==U.length)this.emit(t.SELECT_NODE,F.slice(0));else for(var Z=0,J=F.length;Z<J;Z++)if(F[Z]!==U[Z]){this.emit(t.SELECT_NODE,F.slice(0));break}}}}else e.preventDefault(),this.zoom(.5);else e.preventDefault(),this.zoom(2);else!_&&this.clones.length&&this.paste();else _||(this.clone(),88!==E&&"KeyX"!==w||(null===(f=this.options.disabled)||void 0===f?void 0:f.remove)||this.removeNode());else{var $=e.target;this.state===yA.EDIT_TEXT&&$===this.input.inputEl?(e.preventDefault(),this.input.node.selectAll(),this.input.hideCursor()):$&&!_&&(e.preventDefault(),this.selectAll())}else if(this.selected.length){var Q;if((Q=this.selected[0])instanceof c_||Q instanceof f_||Q instanceof kw)return;Q=Q.parent,this.selected.splice(0),this.selected.push(Q),this.select.updateSelect(this.selected),this.emit(t.SELECT_NODE,this.selected.slice(0))}}},t.prototype.onKeyUp=function(e){var t=this.metaKey,r=this.ctrlKey;if(this.metaKey=e.metaKey,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.metaKey||hT&&this.ctrlKey||this.isRotate||this.select.metaKey(!1),(t!==this.metaKey||hT&&r!==this.ctrlKey)&&!this.isMouseDown){var n=this.root.dpi,i=this.startX*n,o=this.startY*n;this.hover(i,o)}32===e.keyCode&&(this.spaceKey=!1,this.state!==yA.HAND&&(this.dom.classList.remove("hand"),this.dom.classList.remove("handing")))},t.prototype.updateSelected=function(){this.selected.length&&this.select.updateSelect(this.selected)},t.prototype.updateInput=function(){this.state===yA.EDIT_TEXT&&this.input.updateCursor()},t.prototype.updateGradient=function(){this.state===yA.EDIT_GRADIENT&&this.gradient.updatePos()},t.prototype.updateGeom=function(){this.state===yA.EDIT_GEOM&&this.geometry.updateAll()},t.prototype.cancelEditText=function(e){if(this.state===yA.EDIT_TEXT){var r=e||this.selected[0];r&&(r.resetCursor(),r.afterEdit(),r.inputStyle=void 0),this.input.hide(),this.state=yA.NORMAL,this.select.select.classList.remove("text"),this.emit(t.STATE_CHANGE,yA.EDIT_TEXT,this.state)}},t.prototype.cancelEditGradient=function(){this.state===yA.EDIT_GRADIENT&&(this.select.showSelectNotUpdate(),this.state=yA.NORMAL,this.emit(t.STATE_CHANGE,yA.EDIT_GRADIENT,this.state))},t.prototype.cancelEditGeom=function(){this.state===yA.EDIT_GEOM&&(this.geometry.hide(),this.select.showSelect(this.selected),this.state=yA.NORMAL,this.emit(t.STATE_CHANGE,yA.EDIT_GEOM,this.state))},t.prototype.onContextMenu=function(e){e.preventDefault()},t.prototype.destroy=function(){this.dom.removeEventListener("mousedown",this.onMouseDown),this.dom.removeEventListener("mousemove",this.onMouseMove),this.dom.removeEventListener("mouseup",this.onMouseUp),this.dom.removeEventListener("mouseleave",this.onMouseLeave),this.dom.removeEventListener("click",this.onClick),this.dom.removeEventListener("dblclick",this.onDblClick),this.dom.removeEventListener("wheel",this.onWheel),this.dom.removeEventListener("contextmenu",this.onContextMenu),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.selected.splice(0),this.abcStyle.splice(0),this.computedStyle.splice(0),this.originStyle.splice(0),this.cssStyle.splice(0),this.select.destroy()},t.HOVER_NODE="HOVER_NODE",t.UN_HOVER_NODE="UN_HOVER_NODE",t.SELECT_NODE="SELECT_NODE",t.RESIZE_NODE="RESIZE_NODE",t.MOVE_NODE="MOVE_NODE",t.ROTATE_NODE="ROTATE_NODE",t.OPACITY_NODE="OPACITY_NODE",t.FLIP_H_NODE="FLIP_H_NODE",t.FLIP_V_NODE="FLIP_V_NODE",t.FILL_NODE="FILL_NODE",t.STROKE_NODE="STROKE_NODE",t.FONT_FAMILY_NODE="FONT_FAMILY_NODE",t.FONT_SIZE_NODE="FONT_SIZE_NODE",t.LINE_HEIGHT_NODE="LINE_HEIGHT_NODE",t.LETTER_SPACING_NODE="LETTER_SPACING_NODE",t.PARAGRAPH_SPACING_NODE="PARAGRAPH_SPACING_NODE",t.COLOR_NODE="COLOR_NODE",t.TEXT_ALIGN_NODE="TEXT_ALIGN_NODE",t.TEXT_VERTICAL_ALIGN_NODE="TEXT_VERTICAL_ALIGN_NODE",t.TEXT_CONTENT_NODE="TEXT_CONTENT_NODE",t.CURSOR_NODE="CURSOR_NODE",t.SHADOW_NODE="SHADOW_NODE",t.BLUR_NODE="BLUR_NODE",t.COLOR_ADJUST_NODE="COLOR_ADJUST_NODE",t.REMOVE_NODE="REMOVE_NODE",t.ADD_NODE="ADD_NODE",t.GROUP_NODE="GROUP_NODE",t.UN_GROUP_NODE="UN_GROUP_NODE",t.BOOL_GROUP_NODE="BOOL_GROUP_NODE",t.UN_BOOL_GROUP_NODE="UN_BOOL_GROUP_NODE",t.FLATTEN_NODE="FLATTEN_NODE",t.UN_FLATTEN_NODE="UN_FLATTEN_NODE",t.MASK_NODE="MASK_NODE",t.BREAK_MASK_NODE="BREAK_MASK_NODE",t.RENAME_NODE="RENAME_NODE",t.LOCK_NODE="LOCK_NODE",t.VISIBLE_NODE="VISIBLE_NODE",t.ART_BOARD_NODE="ART_BOARD_NODE",t.CONSTRAIN_PROPORTION_NODE="CONSTRAIN_PROPORTION_NODE",t.POINT_NODE="POINT_NODE",t.SELECT_POINT="SELECT_POINT",t.ZOOM_PAGE="ZOOM_PAGE",t.CONTEXT_MENU="CONTEXT_MENU",t.STATE_CHANGE="STATE_CHANGE",t}(Tw);function fT(e,t,r){void 0===r&&(r=!1);var n=function(e){var t="default";e instanceof i_?t="symbol-instance":e instanceof JS?t="symbol-master":e instanceof kw?t="art-board":e instanceof WS?t="group":e instanceof Fw?t="bitmap":e instanceof t_?t="text":e instanceof zw?t="geom":e instanceof rC?t="shape-group":e instanceof Lw&&(t="slice");return t}(e),i=document.createElement("dl"),o=["layer"];e instanceof i_&&o.push("symbol-instance"),e instanceof JS&&o.push("symbol-master"),e.props.isExpanded&&o.push("expand");var a="";e instanceof Mw&&(o.push("container"),a+='<span class="arrow"></span>'),e.mask&&(a+='<span class="mask"></span>'),i.className=o.join(" "),i.setAttribute("uuid",e.props.uuid),i.setAttribute("lv",t.toString());var s=document.createElement("dt");(t>3&&(s.style.paddingLeft=(t-3)*bu.treeLvPadding+"px"),e instanceof zw||e instanceof rC)?a+='<span class="type geom">'+e.toSvg(12)+"</span>":a+='<span class="type '.concat(n,'"></span>');if(a+='<span class="name" title="'.concat(e.props.name||"",'">').concat(e.props.name||"","</span>"),e instanceof kw||(e.props.isLocked&&(a+='<span class="lock"></span>'),a+='<span class="visible '.concat(e.computedStyle.visibility===rh.VISIBLE?"t":"",'"></span>')),s.innerHTML=a,i.appendChild(s),r)return i;if(e instanceof Mw){var l=e.children;if(l.length)for(var c=l.length-1;c>=0;c--){var u=document.createElement("dd");u.appendChild(fT(l[c],t+1)),i.appendChild(u)}}return i}var pT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.silence=!1,e.getCurPage()&&this.init(),r.on(dT.HOVER_NODE,(function(e){n.hover(e)})),r.on(dT.UN_HOVER_NODE,(function(){n.unHover()})),r.on(dT.SELECT_NODE,(function(e){n.select(e)})),r.on(dT.REMOVE_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));n&&n.parentElement.remove()}}))})),r.on(dT.ADD_NODE,(function(e,r){e.forEach((function(e){var r,n=fT(e,e.struct.lv),i=document.createElement("dd");i.appendChild(n);var o=null===(r=e.prev)||void 0===r?void 0:r.props.uuid;if(o){if(a=t.querySelector('dl[uuid="'.concat(o,'"]')))a.parentElement.before(i)}else{var a,s=e.parent.props.uuid;(a=t.querySelector('dl[uuid="'.concat(s,'"]')))&&a.appendChild(i)}})),n.select(r||e)})),r.on([dT.GROUP_NODE,dT.BOOL_GROUP_NODE],(function(e,r){e.forEach((function(e,n){var i,o=fT(e,e.struct.lv,!0),a=document.createElement("dd");a.appendChild(o),r[n].slice(0).reverse().forEach((function(e){var r=e.props.uuid,n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*bu.treeLvPadding+"px",n.querySelectorAll("dl").forEach((function(e){var t=e.firstChild,r=e.getAttribute("lv");e.setAttribute("lv",(+r+1).toString()),t.style.paddingLeft=(+r+1-3)*bu.treeLvPadding+"px"})),o.appendChild(n.parentElement)}}));var s=null===(i=e.prev)||void 0===i?void 0:i.props.uuid;if(s){if(l=t.querySelector('dl[uuid="'.concat(s,'"]')))l.parentElement.before(a)}else{var l,c=e.parent.props.uuid;(l=t.querySelector('dl[uuid="'.concat(c,'"]')))&&l.appendChild(a)}}))})),r.on([dT.UN_GROUP_NODE,dT.UN_BOOL_GROUP_NODE],(function(e,r){e.forEach((function(e,n){var i=r[n].props.uuid;if(i){var o=t.querySelector('dl[uuid="'.concat(i,'"]'));if(o){var a=o.parentElement,s=document.createDocumentFragment();e.slice(0).reverse().forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*bu.treeLvPadding+"px",n.querySelectorAll("dl").forEach((function(e){var t=e.firstChild,r=e.getAttribute("lv");e.setAttribute("lv",(+r-1).toString()),t.style.paddingLeft=(+r-1-3)*bu.treeLvPadding+"px"})),s.appendChild(n.parentElement)}}})),a.before(s),a.remove()}}}));var n=[];e.forEach((function(e){n.push.apply(n,e)}))})),r.on(dT.MASK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n)for(var i=n.parentElement,o=e.next;o&&!o.computedStyle.breakMask&&!o.computedStyle.maskMode;){var a=(i=i.previousElementSibling).firstElementChild.firstElementChild,s=a.querySelector(".mask");if(e.computedStyle.maskMode===Ju.NONE)s&&s.remove();else if(!s){var l=document.createElement("span");l.classList.add("mask"),a.prepend(l)}o=o.next}}}))})),r.on(dT.BREAK_MASK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.firstElementChild,o=i.querySelector(".mask");if(e.computedStyle.breakMask)o&&o.remove();else if(e.mask){if(!o)(l=document.createElement("span")).classList.add("mask"),i.prepend(l)}for(var a=n.parentElement,s=e.next;s&&!s.computedStyle.breakMask&&!s.computedStyle.maskMode;){var l,c=(a=a.previousElementSibling).firstElementChild.firstElementChild,u=c.querySelector(".mask");e.computedStyle.breakMask?u&&u.remove():u||((l=document.createElement("span")).classList.add("mask"),c.prepend(l)),s=s.next}}}}))})),r.on(dT.RENAME_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"] .name'));n&&(n.title=n.innerText=e.props.name||"")}}))})),r.on(dT.LOCK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.firstElementChild,o=i.querySelector(".lock");if(e.props.isLocked){if(!o){var a=document.createElement("span");a.classList.add("lock"),i.querySelector(".name").after(a)}}else o&&o.remove()}}}))})),r.on(dT.VISIBLE_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.querySelector(".visible").classList;e.computedStyle.visibility===rh.VISIBLE?i.add("t"):i.remove("t")}}}))})),r.on(dT.ART_BOARD_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*bu.treeLvPadding+"px";var o=n.parentElement;o.remove();var a=e.prev,s=e.next;if(a){if(l=a.props.uuid)(c=t.querySelector('dl[uuid="'.concat(l,'"]')))&&c.parentElement.before(o)}else if(s){if(l=s.props.uuid)(c=t.querySelector('dl[uuid="'.concat(l,'"]')))&&c.parentElement.after(o)}else{var l,c;if(l=e.parent.props.uuid)(c=t.querySelector('dl[uuid="'.concat(l,'"]')))&&c.parentElement.appendChild(o)}}}}))})),r.on(dT.TEXT_CONTENT_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"] dt .name'));if(n){var i=e.props.nameIsFixed,o=e.content;i||(n.innerText=o,n.title=o)}}}))})),r.on([dT.FLATTEN_NODE,dT.UN_FLATTEN_NODE],(function(e,r){e.forEach((function(e,n){var i=fT(e,e.struct.lv),o=document.createElement("dd");o.appendChild(i);var a=r[n].props.uuid,s=t.querySelector('dl[uuid="'.concat(a,'"]'));if(s){var l=s.parentElement;l.before(o),l.remove()}}))})),t.addEventListener("selectstart",(function(e){e.preventDefault()}));var i=function(n,i){void 0===i&&(i=!1);var o=n.querySelector("dt"),a=t.querySelectorAll("dt.active");if(1!==a.length||a[0]!==o){var s=n.getAttribute("uuid");if(s){var l=e.refs[s];if(l)if(i)-1===(u=(c=r.selected.slice(0)).indexOf(l))&&(c.splice(0),c.push(l)),r.active(c);else if(r.metaKey){var c,u;if((u=(c=r.selected.slice(0)).indexOf(l))>-1)c.splice(u,1);else{for(var h=c.length-1;h>=0;h--){var d=c[h];if(l.isParent(d))c.splice(h,1);else if(l.isChild(d))return}c.push(l)}r.active(c)}else r.active([l])}a.forEach((function(e){e.classList.remove("active")})),r.selected.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"] dt'));n&&n.classList.add("active")}}))}};t.addEventListener("click",(function(t){n.silence=!0;var o=t.target,a=o.classList,s="DT"===o.tagName.toUpperCase();if(a.contains("arrow"))(l=(u=o.parentElement.parentElement).getAttribute("uuid"))&&(c=e.refs[l])&&((c.props.isExpanded=!c.props.isExpanded)?u.classList.add("expand"):u.classList.remove("expand"));else if(a.contains("visible")){if(l=(u=o.parentElement.parentElement).getAttribute("uuid"))(c=e.refs[l])&&r.visible(a.contains("t")?"hidden":"visible",[c])}else if(a.contains("lock")){var l;if(l=(u=o.parentElement.parentElement).getAttribute("uuid")){var c=e.refs[l];r.lock(!1,[c])}o.remove()}else if(a.contains("name")||a.contains("type")||s){var u=s?o.parentElement:o.parentElement.parentElement;i(u)}else r.active([]);n.silence=!1}));var o=function(t){var n=t.value,i=t.parentElement.parentElement.getAttribute("uuid"),o=e.refs[i],a=t.nextSibling;t.remove(),a.style.display="block",o&&r.rename([n],[o])};t.addEventListener("dblclick",(function(e){var t=e.target;if(t.classList.contains("name")){t.style.display="none";var r=document.createElement("input");r.type="text",r.value=t.innerText,t.parentElement.insertBefore(r,t),r.focus();var n=!1;r.onblur=function(){n||(n=!0,o(r))},r.onkeydown=function(e){var t=e.keyCode,i=e.code;27===t||"Escape"===i?(e.stopPropagation(),n||(n=!0,o(r))):13!==t&&"Enter"!==i||n||(n=!0,o(r))},r.onchange=function(){n||(n=!0,o(r))}}})),t.addEventListener("mousemove",(function(t){var n=t.target;"SPAN"===n.nodeName&&(n=n.parentElement);var i=n.parentElement.getAttribute("uuid");if(i){var o=e.refs[i];if(o)return void r.select.showHover(o)}r.select.hideHover()})),t.addEventListener("mouseleave",(function(){r.select.hideHover()})),t.addEventListener("contextmenu",(function(e){var t;if(!(null===(t=r.options.disabled)||void 0===t?void 0:t.contextMenu)){e.preventDefault(),n.silence=!0;var o=e.target,a=o.classList,s="DT"===o.tagName.toUpperCase();if(a.contains("name")||a.contains("type")||s){var l=s?o.parentElement:o.parentElement.parentElement;i(l,!0)}n.silence=!1,OA.showTree(e.pageX,e.pageY,n.listener)}}))}return e.prototype.init=function(){this.dom.innerHTML="";var e=document.createElement("dl");this.dom.appendChild(e);var t=this.root.getCurPage();if(t){e.setAttribute("uuid",t.props.uuid);var r=t.children;if(!r.length)return;for(var n=new DocumentFragment,i=r.length-1;i>=0;i--){var o=r[i],a=fT(o,o.struct.lv),s=document.createElement("dd");s.appendChild(a),n.appendChild(s)}e.appendChild(n)}},e.prototype.hover=function(e){var t=this.dom.querySelector("dt.hover"),r=e.props.uuid;if(r){var n=this.dom.querySelector('dl[uuid="'.concat(r,'"] dt'));n&&(n.classList.add("hover"),n!==t&&t&&t.classList.remove("hover"))}},e.prototype.unHover=function(){var e=this.dom.querySelector("dt.hover");e&&e.classList.remove("hover")},e.prototype.select=function(e){var t=this;this.dom.querySelectorAll("dt.active").forEach((function(e){e.classList.remove("active")})),e.forEach((function(e){var r=t.dom.querySelector('dl[uuid="'.concat(e.props.uuid,'"] dt'));if(r){for(var n=r.parentElement;n;){if("DL"===n.nodeName){n.classList.add("expand");var i=n.getAttribute("uuid");if(i){var o=t.root.refs[i];o&&(o.props.isExpanded=!0)}}if(n===t.dom)break;n=n.parentElement}r.classList.add("active"),t.silence||(r.scrollIntoViewIfNeeded?r.scrollIntoViewIfNeeded():r.scrollIntoView())}}))},e}(),vT=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.nodes=[],this.silence=!1,r.on(dT.SELECT_NODE,(function(e){n.silence||n.show(e)}))}return e.prototype.show=function(e){this.nodes=e},e}(),yT=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.constrainProportions=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.constrainProportions=t[r].prev}))},t}(gA),gT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.data=[];var o=i.panel=document.createElement("div");o.className="basic-panel",o.innerHTML='\n  <div class="line">\n    <div class="input-unit">\n      <input type="number" class="x" step="1"/>\n      <span class="unit">X</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="y" step="1"/>\n      <span class="unit">Y</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="r" step="1"/>\n      <span class="unit">°</span>\n    </div>\n  </div>\n  <div class="line">\n    <div class="input-unit">\n      <input type="number" class="w" step="1"/>\n      <span class="unit">W</span>\n    </div>\n    <div class="cp"></div>\n    <div class="input-unit">\n      <input type="number" class="h" step="1"/>\n      <span class="unit">H</span>\n    </div>\n    <span class="fh" title="水平翻转"></span>\n    <span class="fv" title="垂直翻转"></span>\n  </div>\n',r.appendChild(o);var a=o.querySelector(".x"),s=o.querySelector(".y"),l=o.querySelector(".r"),c=o.querySelector(".w"),u=o.querySelector(".h"),h=o.querySelector(".cp"),d=o.querySelector(".fh"),f=o.querySelector(".fv"),p=[],v=[],y=[],g=[],m=[],b=[],x=function(e,t){void 0===t&&(t=!0),i.silence=!0;var r=!p.length;r&&(v=[],y=[],m=[]),b=[];var o=parseFloat(t?a.value:s.value)||0,l=e instanceof InputEvent;i.nodes.forEach((function(e,c){r&&(p.push(e),v.push(e.getStyle()),y.push(e.getComputedStyle()),m.push(t?i.data[c].x:i.data[c].y));var u=m[c],h=o,d=0;l?d=h-u:(d=(t?a.placeholder:s.placeholder)?h:h-u,n.shiftKey?d=d>0?10:-10:n.altKey&&(d=d>0?.1:-.1),h=u+d),b.push(h),e.artBoard!==(t?MA.update(e,y[c],d,0):MA.update(e,y[c],0,d))&&n.emit(dT.ART_BOARD_NODE,[e])})),p.length&&(n.select.updateSelect(i.nodes),n.emit(dT.MOVE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1},E=function(e){if(void 0===e&&(e=!0),p.length){var t=[];p.forEach((function(r,n){var i=b[n]-m[n];e?(r.endPosChange(v[n],i,0),t.push({dx:i,dy:0})):(r.endPosChange(v[n],0,i),t.push({dx:0,dy:i})),r.checkPosSizeUpward()})),n.history.addCommand(new MA(p,t)),p=[],v=[],y=[],m=[],b=[]}};a.addEventListener("input",(function(e){x(e,!0)})),a.addEventListener("change",(function(e){E(!0)})),s.addEventListener("input",(function(e){x(e,!1)})),s.addEventListener("change",(function(e){E(!1)})),l.addEventListener("input",(function(e){i.silence=!0;var t=!p.length;t&&(y=[],m=[]),b=[];var r=e instanceof InputEvent;i.nodes.forEach((function(e,o){t&&(p.push(e),y.push(e.getComputedStyle()),m.push(i.data[o].rotation));var a=m[o],s=parseFloat(l.value)||0,c=0;r?c=s-a:(c=l.placeholder?s:s-a,n.shiftKey?c=c>0?10:-10:n.altKey&&(c=c>0?.1:-.1),s=a+c),b.push(s),e.updateStyle({rotateZ:y[o].rotateZ+c})})),p.length&&(n.select.updateSelect(i.nodes),n.emit(dT.ROTATE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1})),l.addEventListener("change",(function(e){p.length&&(n.history.addCommand(new DA(p,m.map((function(e,t){return{prev:{rotateZ:e},next:{rotateZ:b[t]}}})))),p=[],y=[],m=[],b=[])}));var w=function(e,t){void 0===t&&(t=!0),i.silence=!0,n.beforeResize();var r=!1;if(!r)for(var o=0,a=n.selected.length;o<a;o++)if(n.selected[o].props.constrainProportions){r=!0;break}var s=!p.length;s&&(v=[],y=[],g=[],m=[]),b=[];var l=parseFloat(t?c.value:u.value)||0,h=e instanceof InputEvent;i.nodes.forEach((function(e,o){if(s){p.push(e),v.push(e.getStyle()),e.startSizeChange(),y.push(e.getComputedStyle()),g.push(e.getCssStyle()),m.push(t?i.data[o].w:i.data[o].h);var a=e.parent;a&&a.isGroup&&a instanceof WS&&(a.fixedPosAndSize=!0)}var d=m[o],f=l,x=0;h?x=f-d:(x=(t?c.placeholder:u.placeholder)?f:f-d,n.shiftKey?x=x>0?10:-10:n.altKey&&(x=x>0?.1:-.1),f=d+x),b.push(f),LA.updateStyle(e,y[o],g[o],t?x:0,t?0:x,t?TA.R:TA.B,r)})),p.length&&(n.select.updateSelect(i.nodes),n.emit(dT.RESIZE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1},S=function(e){if(void 0===e&&(e=!0),p.length){var t=n.shiftKey;if(!t)for(var r=0,i=n.selected.length;r<i;r++)if(n.selected[r].props.constrainProportions){t=!0;break}var o=[];p.forEach((function(r,n){var i=r.parent;i&&i.isGroup&&i instanceof WS&&(i.fixedPosAndSize=!1),r.endSizeChange(v[n]),r.checkPosSizeUpward();var a=b[n]-m[n],s={dx:e?a:0,dy:e?0:a,controlType:e?TA.R:TA.B,aspectRatio:t,fromCenter:!1};v[n].width.u===zu.AUTO&&(s.widthFromAuto=!0),v[n].height.u===zu.AUTO&&(s.heightFromAuto=!0),y[n].scaleX!==r.computedStyle.scaleX&&(s.flipX=!0),y[n].scaleY!==r.computedStyle.scaleY&&(s.flipY=!0),o.push(s)})),p.length&&o.length&&n.history.addCommand(new LA(p,o)),p=[],v=[],y=[],m=[],b=[]}};return c.addEventListener("input",(function(e){w(e,!0)})),c.addEventListener("change",(function(e){S(!0)})),u.addEventListener("input",(function(e){w(e,!1)})),u.addEventListener("change",(function(e){S(!1)})),h.addEventListener("click",(function(e){i.silence=!0,h.classList.contains("active")?h.classList.remove("active"):h.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e){var n=!!e.props.constrainProportions,i=h.classList.contains("active");n!==i&&(e.props.constrainProportions=i,t.push(e),r.push({prev:n,next:i}))})),t.length&&(n.history.addCommand(new yT(t,r)),n.emit(dT.CONSTRAIN_PROPORTION_NODE,t.slice(0))),i.silence=!1})),d.addEventListener("click",(function(e){i.silence=!0,d.classList.contains("active")?d.classList.remove("active"):d.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e,n){var i=e.computedStyle.scaleX,o=d.classList.contains("active")?-1:1;i!==o&&(e.updateStyle({scaleX:o}),t.push(e),r.push({prev:{scaleX:i},next:{scaleX:o}}))})),t.length&&(n.history.addCommand(new kA(t,r)),n.select.updateSelect(i.nodes),n.emit(dT.FLIP_H_NODE,t.slice(0))),i.silence=!1})),f.addEventListener("click",(function(e){i.silence=!0,f.classList.contains("active")?f.classList.remove("active"):f.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e,n){var i=e.computedStyle.scaleY,o=f.classList.contains("active")?-1:1;i!==o&&(e.updateStyle({scaleY:o}),t.push(e),r.push({prev:{scaleX:i},next:{scaleX:o}}))})),t.length&&(n.history.addCommand(new kA(t,r)),n.select.updateSelect(i.nodes),n.emit(dT.FLIP_V_NODE,t.slice(0))),i.silence=!1})),n.on([dT.MOVE_NODE,dT.RESIZE_NODE,dT.ROTATE_NODE,dT.FLIP_H_NODE,dT.FLIP_V_NODE,dT.CONSTRAIN_PROPORTION_NODE],(function(e){i.silence||i.show(e)})),n.on(dT.STATE_CHANGE,(function(e,t){t!==yA.EDIT_GEOM&&t!==yA.NORMAL||i.show(n.selected)})),i}return p(t,e),t.prototype.show=function(t){var r=this;e.prototype.show.call(this,t),this.data=[];var n=this.panel;if(this.listener.state!==yA.EDIT_GEOM){if(n.style.display="block",!t.length)return n.querySelectorAll(".input-unit,.cp,.fh,.fv").forEach((function(e){e.classList.add("disabled"),e.classList.remove("active")})),void n.querySelectorAll("input").forEach((function(e){e.disabled=!0,e.placeholder="",e.value=""}));n.querySelectorAll(".input-unit,.cp,.fh,.fv").forEach((function(e){e.classList.remove("disabled")})),n.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder="",e.value=""}));var i=[],o=[],a=[],s=[],l=[],c=[],u=[],h=[];t.forEach((function(e){var t=$_(e),n=t.x,d=t.y,f=t.rotation,p=t.w,v=t.h,y=t.isFlippedHorizontal,g=t.isFlippedVertical,m=t.constrainProportions;r.data.push(t),i.includes(n)||i.push(n),o.includes(d)||o.push(d),a.includes(f)||a.push(f),s.includes(p)||s.push(p),l.includes(v)||l.push(v),c.includes(m)||c.push(m),u.includes(y)||u.push(y),h.includes(g)||h.push(g)}));var d=n.querySelector(".x"),f=n.querySelector(".y"),p=n.querySelector(".r"),v=n.querySelector(".w"),y=n.querySelector(".h"),g=n.querySelector(".cp"),m=n.querySelector(".fh"),b=n.querySelector(".fv");i.length>1?d.placeholder="多个":d.value=Ff(i[0]).toString(),o.length>1?f.placeholder="多个":f.value=Ff(o[0]).toString(),p.disabled=t.filter((function(e){return e.isSlice&&e instanceof Lw})).length>0,a.length>1?p.placeholder="多个":p.value=Ff(a[0]).toString(),s.length>1?v.placeholder="多个":v.value=Ff(s[0]).toString(),l.length>1?y.placeholder="多个":y.value=Ff(l[0]).toString(),c.length>1||c[0]?g.classList.add("active"):g.classList.remove("active"),u.includes(!0)?m.classList.add("active"):m.classList.remove("active"),h.includes(!0)?b.classList.add("active"):b.classList.remove("active")}else n.style.display="none"},t}(vT),mT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="opacity-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">不透明度</h4>\n  <div class="line">\n    <input type="range" min="0" max="100" step="1"/>\n    <div class="input-unit">\n      <input type="number" min="0" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n',r.appendChild(o);var a=o.querySelector("input[type=range]"),s=o.querySelector("input[type=number]"),l=[],c=[],u=[];return a.addEventListener("input",(function(e){var t=!l.length;t&&(c=[]),u=[],i.nodes.forEach((function(e){var r=e.computedStyle.opacity,n=.01*parseFloat(a.value);r!==n&&(e.updateStyle({opacity:n}),t&&(l.push(e),c.push(r)),u.push(n))})),a.style.setProperty("--p",a.value),s.value=a.value,s.placeholder=""})),a.addEventListener("change",(function(e){l.length&&(n.history.addCommand(new NA(l,c.map((function(e,t){return{prev:{opacity:e},next:{opacity:u[t]}}})))),n.emit(dT.OPACITY_NODE,l.slice(0)),l=[],c=[],u=[])})),s.addEventListener("input",(function(e){i.silence=!0;var t=!l.length;t&&(c=[]),u=[];var r=e instanceof InputEvent,o=Math.min(100,Math.max(0,parseFloat(s.value)||0));i.nodes.forEach((function(e,i){var a=100*e.computedStyle.opacity,h=o,d=0;r?(d=h-a,i||(s.placeholder="")):(0===h&&(h=-1),d=s.placeholder?h:h-a,n.shiftKey&&(d=d>0?10:-10),h=a+d,h=Math.max(h,0),h=Math.min(h,100),i||(s.value=s.placeholder?"":h.toString())),d&&a!==h&&(e.updateStyle({opacity:.01*h}),t&&(l.push(e),c.push(.01*a)),u.push(.01*h))})),a.value=s.value||"0",a.style.setProperty("--p",a.value),l.length&&n.emit(dT.OPACITY_NODE,l.slice(0)),i.silence=!1})),s.addEventListener("change",(function(e){l.length&&(n.history.addCommand(new NA(l,c.map((function(e,t){return{prev:{opacity:e},next:{opacity:u[t]}}})))),l=[],c=[],u=[])})),n.on([dT.OPACITY_NODE],(function(e){i.silence||i.show(e)})),n.on(dT.STATE_CHANGE,(function(e,t){t!==yA.EDIT_GEOM&&t!==yA.NORMAL||i.show(n.selected)})),i}return p(t,e),t.prototype.show=function(t){e.prototype.show.call(this,t);var r=this.panel;if(t.length&&this.listener.state!==yA.EDIT_GEOM){r.style.display="block",r.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder="",e.value=""}));var n=[];t.forEach((function(e){var t=e.computedStyle.opacity;n.includes(t)||n.push(t)}));var i=r.querySelector("input[type=range]"),o=r.querySelector("input[type=number]");if(n.length>1)i.value="0",i.style.setProperty("--p","0"),o.placeholder="多个";else{var a=Math.round(100*n[0]).toString();i.value=a,i.style.setProperty("--p",a),o.value=a}}else r.style.display="none"},t}(vT),bT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.nodes=[];var o=i.panel=document.createElement("div");o.className="point-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">锚点</h4>\n  <div class="line coords">\n    <div class="input-unit">\n      <input type="number" class="x" step="1"/>\n      <span class="unit">X</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="y" step="1"/>\n      <span class="unit">Y</span>\n    </div>\n  </div>\n  <div class="intro">类型</div>\n  <ul class="line type">\n    <li class="straight" title="直线"></li>\n    <li class="mirrored" title="对称曲线"></li>\n    <li class="disconnected" title="断开连接"></li>\n    <li class="asymmetric" title="不对称曲线"></li>\n  </ul>\n  <div class="intro">半径</div>\n  <div class="line num">\n    <input type="range" min="0" max="100" step="1" value="0"/>\n    <div class="input-unit">\n      <input type="number" class="r" min="0" max="100" step="1" value=""/>\n    </div>\n  </div>\n',r.appendChild(o);var a=[],s=[];o.addEventListener("click",(function(e){var t;i.silence=!0;var r=e.target,c=r.tagName.toUpperCase(),u=r.classList,h=n.geometry,d=h.nodes,f=h.idxes;d.forEach((function(e,t){f[t].length&&(a.push(e),s.push(Iu(e.props.points)))})),"LI"!==c||u.contains("cur")||(null===(t=o.querySelector(".type .cur"))||void 0===t||t.classList.remove("cur"),u.add("cur"),a.splice(0),s.splice(0),d.forEach((function(e,t){var r=f[t];if(r.length){a.push(e),s.push(Iu(e.props.points));var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){if(e.hasCurveTo=e.hasCurveFrom=!0,u.contains("mirrored")){if(e.curveMode=Vu.MIRRORED,e.hasCurveTo){var r=e.tx-e.x,n=e.ty-e.y;e.fx=e.x-r,e.fy=e.y-n}else if(e.hasCurveFrom){r=e.fx-e.x,n=e.fy-e.y;e.tx=e.x-r,e.ty=e.y-n}else{var o=i[t-1]||i[i.length-1];e.tx=.5*(o.x+e.x),e.ty=.5*(o.y+e.y);r=e.tx-e.x,n=e.ty-e.y;e.fx=e.x-r,e.fy=e.y-n}e.hasCurveFrom=!0,e.hasCurveTo=!0}else if(u.contains("disconnected"))e.curveMode=Vu.DISCONNECTED;else if(u.contains("asymmetric")){e.curveMode=Vu.ASYMMETRIC;var a=Math.sqrt(Math.pow(e.tx-e.x,2)+Math.pow(e.ty-e.y,2)),s=Math.sqrt(Math.pow(e.fx-e.x,2)+Math.pow(e.fy-e.y,2));if(e.hasCurveTo||!e.hasCurveFrom&&!e.hasCurveTo){r=e.tx-e.x,n=e.ty-e.y;e.fx=e.x-r*s/a,e.fy=e.y-n*s/a}else if(e.hasCurveFrom){r=e.fx-e.x,n=e.fy-e.y;e.tx=e.x-r*a/s,e.ty=e.y-n*a/s}e.hasCurveFrom=!0,e.hasCurveTo=!0}else e.curveMode=Vu.STRAIGHT,e.hasCurveTo=e.hasCurveFrom=!1})),e.refresh()}n.geometry.updateVertex(e)})),l()),n.geometry.keep=!0,i.silence=!1}));var l=function(e){void 0===e&&(e=!1),a.length&&(a.forEach((function(e){return e.checkPointsChange()})),n.geometry.updateAll(e),n.history.addCommand(new nT(a.slice(0),a.map((function(e,t){return{prev:s[t],next:Iu(e.props.points)}})))),a.splice(0),s.splice(0))},c=o.querySelector("input.x"),u=o.querySelector("input.y"),h=function(e,t){void 0===t&&(t=!0),i.silence=!0;var r=n.geometry,o=r.nodes,l=r.idxes,h=parseFloat(t?c.value:u.value)||0,d=e instanceof InputEvent,f=!a.length,p=[];o.forEach((function(e,r){var i=l[r];if(i.length){f&&(a.push(e),s.push(Iu(e.props.points)));var o=i.map((function(t){return e.props.points[t]}));o.forEach((function(e,i){if(d)t?e.dspX=h:e.dspY=h,r||i||(t?c.placeholder="":u.placeholder="");else{var o=0;o=t?c.placeholder?h:h-e.dspX:u.placeholder?h:h-e.dspY,n.shiftKey?o=o>0?10:-10:n.altKey&&(o=o>0?.1:-.1),t?(e.dspX+=o,e.dspFx+=o,e.dspTx+=o):(e.dspY+=o,e.dspFy+=o,e.dspTy+=o),r||i||(t?c.placeholder?c.value="":c.value=Ff(e.dspX).toString():u.placeholder?u.value="":u.value=Ff(e.dspY).toString())}})),iA(e,o),e.reflectPoints(o),e.refresh(),n.geometry.updateVertex(e),p.push(o)}})),n.emit(dT.POINT_NODE,a.slice(0),p),i.silence=!1};c.addEventListener("input",(function(e){h(e,!0)})),c.addEventListener("change",(function(){return l()})),u.addEventListener("input",(function(e){h(e,!1)})),u.addEventListener("change",(function(){return l()}));var d=o.querySelector('input[type="range"]'),f=o.querySelector("input.r"),p=!1;return d.addEventListener("input",(function(e){i.silence=!0;var t=n.geometry,r=t.nodes,o=t.idxes,l=parseFloat(d.value)||0;p=!1;var c=!a.length,u=[];r.forEach((function(e,t){var r=o[t];if(r.length){c&&(a.push(e),s.push(Iu(e.props.points)));var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){(e.cornerRadius&&!l||!e.cornerRadius&&l)&&(p=!0),e.cornerRadius=l})),e.refresh(),n.geometry.updateVertex(e),u.push(i)}})),d.placeholder=f.placeholder="",f.value=d.value,n.emit(dT.POINT_NODE,a.slice(0),u),i.silence=!1})),d.addEventListener("change",(function(){return l(p)})),f.addEventListener("input",(function(e){i.silence=!0;var t=n.geometry,r=t.nodes,o=t.idxes,l=parseFloat(f.value)||0,c=e instanceof InputEvent,u=!a.length,h=[];r.forEach((function(e,t){var r=o[t];if(r.length){u&&(a.push(e),s.push(Iu(e.props.points)));var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e,r){if(c)e.cornerRadius=l,t||r||(d.placeholder=f.placeholder="",d.value=f.value);else{var i=0;i=f.placeholder?l:l-e.cornerRadius,n.shiftKey?i=i>0?10:-10:n.altKey&&(i=i>0?.1:-.1),e.cornerRadius+=i,t||r||(f.placeholder?f.value="":f.value=Ff(e.cornerRadius).toString())}})),e.refresh(),n.geometry.updateVertex(e),h.push(i)}})),n.emit(dT.POINT_NODE,a.slice(0),h),i.silence=!1})),f.addEventListener("change",(function(){return l()})),n.on(dT.STATE_CHANGE,(function(e,t){t!==yA.EDIT_GEOM&&e!==yA.EDIT_GEOM||(a.splice(0),s.splice(0),i.show())})),n.on([dT.SELECT_POINT,dT.POINT_NODE],(function(){i.silence||(a.splice(0),s.splice(0),i.updateCoords(),i.updateType(),i.updateRange())})),i}return p(t,e),t.prototype.show=function(){var e=this.listener.selected.filter((function(e){return e instanceof Jw})),t=this.panel;e.length&&this.listener.state===yA.EDIT_GEOM?(t.style.display="block",this.updateCoords(),this.updateType(),this.updateRange()):t.style.display="none"},t.prototype.updateCoords=function(){var e=this.panel,t=this.listener.geometry,r=t.nodes,n=t.idxes,i=e.querySelector(".coords"),o=i.querySelector("input.x"),a=i.querySelector("input.y"),s=[],l=[];r.forEach((function(e,t){var r=n[t];if(r.length){var i=r.map((function(t){return e.props.points[t]}));nA(e,i),i.forEach((function(e){s.includes(e.dspX)||s.push(e.dspX),l.includes(e.dspY)||l.push(e.dspY)}))}})),i.classList.remove("enable"),o.value=a.value="",o.placeholder=a.placeholder="",o.disabled=a.disabled=!0,s.length&&(i.classList.add("enable"),o.disabled=a.disabled=!1,s.length>1?o.placeholder="多个":o.value=Ff(s[0]).toString(),l.length>1?a.placeholder="多个":a.value=Ff(l[0]).toString())},t.prototype.updateType=function(){var e,t,r=this.panel,n=this.listener.geometry,i=n.nodes,o=n.idxes,a=r.querySelector(".type"),s=[];if(i.forEach((function(e,t){var r=o[t];if(r.length){var n=r.map((function(t){return e.props.points[t]}));n.forEach((function(e){var t=e.curveMode;t===Vu.NONE&&(t=Vu.STRAIGHT),s.includes(t)||s.push(t)}))}})),a.classList.remove("enable"),null===(e=a.querySelector(".cur"))||void 0===e||e.classList.remove("cur"),s.length&&(a.classList.add("enable"),1===s.length)){var l="straight";s[0]===Vu.MIRRORED?l="mirrored":s[0]===Vu.DISCONNECTED?l="disconnected":s[0]===Vu.ASYMMETRIC&&(l="asymmetric"),null===(t=r.querySelector(".type .".concat(l)))||void 0===t||t.classList.add("cur")}},t.prototype.updateRange=function(){var e=this.panel,t=this.listener.geometry,r=t.nodes,n=t.idxes,i=e.querySelector(".num"),o=i.querySelector('input[type="range"]'),a=i.querySelector("input.r"),s=[];r.forEach((function(e,t){var r=n[t];if(r.length){var i=r.map((function(t){return e.props.points[t]}));i.forEach((function(e){if(e.curveMode===Vu.NONE||e.curveMode===Vu.STRAIGHT){var t=e.cornerRadius;s.includes(t)||s.push(t)}}))}})),i.classList.remove("enable"),o.value="0",a.value="",o.placeholder=a.placeholder="",o.disabled=a.disabled=!0,s.length&&(i.classList.add("enable"),o.disabled=a.disabled=!1,s.length>1?o.placeholder=a.placeholder="多个":o.value=a.value=Ff(s[0]).toString())},t}(vT);var xT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="fill-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">填充</h4>\n',r.appendChild(o);var a=[],s=[],l=[],c=[],u=function(){l.length&&n.history.addCommand(new XA(a,s.map((function(e,t){return{prev:e,next:l[t],index:c[t]}})))),a=[],s=[],l=[],c=[],n.gradient.hide()};return o.addEventListener("click",(function(e){var t=e.target,r=t.classList;if(r.contains("pick")){if(t.parentElement.classList.contains("read-only"))return;if(EA.isShowFrom("fillPanel"))return void EA.hide();EA.keep=!0,n.gradient.keep=!0,a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.fill,n=t.fillEnable,i=t.fillOpacity,o=r.map((function(t){return cp(t,e.width,e.height)}));s.push({fill:o,fillOpacity:i,fillEnable:n})}));var h=t.parentElement.parentElement.parentElement,d=parseInt(h.title),f=i.nodes[0].computedStyle.fill[d],p=function(e,t,r){var s,u,p;void 0===t&&(t=!1),void 0===r&&(r=!1),i.silence=!0;var v=h.querySelector(".pick").style;if(Array.isArray(e)){null===(s=o.querySelector(".value .hex"))||void 0===s||s.classList.remove("hide"),null===(u=o.querySelector(".value .gradient"))||void 0===u||u.classList.add("hide"),null===(p=o.querySelector(".value .multi-type"))||void 0===p||p.classList.add("hide");var y=Qf(e);h.querySelector(".hex input").value=y.slice(1),v.background=Jf(e)}else{if(void 0!==e.url);else o.querySelector(".value .hex").classList.add("hide"),o.querySelector(".value .gradient").classList.remove("hide"),o.querySelector(".value .multi-type").classList.add("hide"),o.querySelector(".value .gradient select").value=e.t.toString(),v.background=cp(e,i.nodes[0].width,i.nodes[0].height,!0)}l=[],c=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.fill,i=r.fillEnable,o=r.fillOpacity,a=n.map((function(t,r){return cp(r===d?e:t)})),s={fill:a,fillOpacity:o,fillEnable:i};l.push(s),c.push(d),t.updateStyle(s)})),t||n.gradient.update(i.nodes[0],f,r),a.length&&n.emit(dT.FILL_NODE,a.slice(0)),i.silence=!1};n.cancelEditGeom(),EA.show(t,f,"fillPanel",p,u,n),n.select.hideSelect(),n.gradient.show(i.nodes[0],f,p,(function(){l.length&&(n.history.addCommand(new XA(a,s.map((function(e,t){return{prev:e,next:l[t],index:d}}))),!0),s=l.slice(0),l=[])})),Array.isArray(f)||(n.state=yA.EDIT_GRADIENT)}else if(r.contains("enabled")){i.silence=!0;var v=t.parentElement,y=parseInt(v.title),g=i.nodes.slice(0),m=[],b=[],x=[],E=!1;(r.contains("multi-checked")||r.contains("un-checked"))&&(E=!0),g.forEach((function(e){var t=e.getComputedStyle(),r=t.fill,n=t.fillEnable,i=t.fillOpacity,o=r.map((function(t){return cp(t,e.width,e.height)}));m.push({fill:o,fillOpacity:i,fillEnable:n});var a=o.slice(0),s=n.slice(0),l=i.slice(0);void 0!==s[y]&&(s[y]=E);var c={fill:a,fillEnable:s,fillOpacity:l};b.push(c),x.push(y),e.updateStyle(c)})),r.remove("multi-checked"),E?(r.remove("un-checked"),r.add("checked"),v.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(r.remove("checked"),r.add("un-checked"),v.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),g.length&&(n.emit(dT.FILL_NODE,g.slice(0)),n.history.addCommand(new XA(g,m.map((function(e,t){return{prev:e,next:b[t],index:x[t]}}))))),i.silence=!1}})),o.addEventListener("keydown",(function(e){var t=e.target;if("INPUT"===t.tagName.toUpperCase()&&"text"===t.type){var r=e.keyCode,i=e.code;e.metaKey||n.isWin&&e.ctrlKey||e.shiftKey||e.altKey||r>=48&&r<=57||/Digit\d/.test(i)||r>=37&&r<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(i)||r>=65&&r<=90||/Key[A-Z]/.test(i)||8===r||"Backspace"===i||46===r||"Delete"===i||27===r||"Escape"===i||13===r||"Enter"===i||20===r||"CapsLock"===i||e.preventDefault()}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=t.parentElement.parentElement.parentElement,o=parseInt(r.title),c=!a.length;if(c&&(s=[]),l=[],"text"===t.type){var u=Zf(t.value);i.nodes.forEach((function(e,t){if(c){a.push(e);var r=e.getComputedStyle(),n=r.fill,i=r.fillEnable,h=r.fillOpacity,d=n.map((function(t){return cp(t,e.width,e.height)}));s.push({fill:d,fillOpacity:h,fillEnable:i})}var f={fill:s[t].fill.slice(0),fillOpacity:s[t].fillOpacity.slice(0),fillEnable:s[t].fillEnable.slice(0)};l.push(f),f.fill[o]=u,e.updateStyle(f)})),t.placeholder="";var h=r.querySelector(".picker-btn b");h.title=h.style.background=Jf(u)}else if("number"===t.type){var d=Math.min(100,Math.max(0,parseFloat(t.value)||0)),f=e instanceof InputEvent;i.nodes.forEach((function(e,r){if(c){a.push(e);var i=e.getComputedStyle(),u=i.fill,h=i.fillEnable,p=i.fillOpacity,v=u.map((function(t){return cp(t,e.width,e.height)}));s.push({fill:v,fillOpacity:p,fillEnable:h})}var y={fill:s[r].fill.slice(0),fillOpacity:s[r].fillOpacity.slice(0),fillEnable:s[r].fillEnable.slice(0)};l.push(y);var g=100*s[r].fillOpacity[o],m=d,b=0;f?(b=m-g,r||(t.placeholder="")):(0===m&&(m=-1),b=t.placeholder?m:m-g,n.shiftKey&&(b=b>0?10:-10),m=g+b,m=Math.max(m,0),m=Math.min(m,100),r||(t.value=t.placeholder?"":m.toString())),b&&(y.fillOpacity[o]=.01*m,e.updateStyle(y))}))}a.length&&n.emit(dT.FILL_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",(function(e){var t=e.target,r=t.tagName.toUpperCase();if("SELECT"===r)if(t.parentElement.classList.contains("pattern"));else{var o=t.parentElement.parentElement.parentElement,c=parseInt(o.title);a=i.nodes.slice(0),s=[],l=[],a.forEach((function(e){var r=e.getComputedStyle(),n=r.fill,i=r.fillEnable,o=r.fillOpacity,a=n.map((function(t){return cp(t,e.width,e.height)}));s.push({fill:a,fillOpacity:o,fillEnable:i});var u=n.map((function(r,n){return n===c?(r.t=parseInt(t.value),cp(r,e.width,e.height)):cp(r,e.width,e.height)})),h={fill:u,fillOpacity:o,fillEnable:i};l.push(h),e.updateStyle(h)})),u(),a.length&&n.emit(dT.FILL_NODE,a.slice(0))}else"INPUT"===r&&u()})),n.on([dT.FILL_NODE],(function(e,t){if(!i.silence&&(i.show(e),n.state===yA.EDIT_GRADIENT)){var r=n.gradient.node;n.gradient.update(r,r.computedStyle.fill[t[0].index])}})),i}return p(t,e),t.prototype.show=function(e){var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),this.nodes=e.filter((function(e){return e instanceof Jw||e instanceof rC||e instanceof t_||e instanceof Fw})),this.nodes.length){t.style.display="block";var r=[],n=[],i=[];this.nodes.forEach((function(e){var t=e.getComputedStyle(),o=t.fill,a=t.fillEnable,s=t.fillOpacity;o.forEach((function(e,t){(r[t]=r[t]||[]).push(e)})),a.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),s.forEach((function(e,t){var r=i[t]=i[t]||[];r.includes(e)||r.push(e)}))}));for(var o=function(e){var o=r[e],s=n[e],l=i[e],c=[],u=[],h=[];o.forEach((function(e){if(Array.isArray(e)){var t=Jf(e);c.includes(t)||c.push(t)}else{var r=e;if(void 0===r.url){var n=e;var i=0;e:for(d=h.length;i<d;i++){if((f=h[i]).t===n.t&&f.d.length===n.d.length){for(var o=f.d.length-1;o>=0;o--)if(f.d[o]!==n.d[o])continue e;if(f.stops.length===n.stops.length){for(o=f.stops.length-1;o>=0;o--){var a=f.stops[o],s=n.stops[o];if(a.color[0]!==s.color[0]||a.color[1]!==s.color[1]||a.color[2]!==s.color[2]||a.color[3]!==s.color[3]||a.offset!==s.offset)continue e}return}}}h.push(n)}else{for(var l=0,d=u.length;l<d;l++){var f;if((f=u[l]).url===r.url&&f.type===r.type&&f.scale===r.scale)return}u.push(r)}}})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,c){var u,h,d,f,p,v,y,g=o.length>1,m=a.length>1,b=s.length>1,x=(o.length?1:0)+(a.length?1:0)+(s.length?1:0)>1,E=x||g||m||b,w=t||!r||x||m||b||a.length?'readonly="readonly"':"",S="",_=" ",C=" ",A="多种";if(x)_="多个";else if(o.length)_="颜色",C="Hex",1===o.length&&(S=o[0]);else if(a.length){if(_="图像",C="显示",A=["填充","适应","拉伸","平铺"][a[0].type],1===a.length)S=cp(a[0],l,c,!0);else for(var T=1,O=a.length;T<O;T++)if(a[T].type!==a[0].type){A="多个";break}}else if(s.length)if(_="渐变",C="类型",A=["线性","径向","角度"][s[0].t],1===s.length)S=cp(s[0],l,c,!0);else for(T=1,O=s.length;T<O;T++)if(s[T].t!==s[0].t){A="多个";break}return'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(w?"read-only":"",'">\n        <b class="pick ').concat(E?"multi":"",'" style="').concat(E?"":"background:".concat(S),'">○○○</b>\n      </span>\n      <span class="txt">').concat(_,'</span>\n    </div>\n    <div class="value">\n      <div class="hex ').concat(a.length||s.length?"hide":"",'">\n        <span>#</span>\n        <input type="text" value="').concat(g?"":Qf(o[0]).slice(1),'" placeholder="').concat(g?"多个":"",'" maxlength="8"/>\n      </div>\n      <div class="pattern ').concat(o.length||s.length||m?"hide":"",'">\n        <select disabled="disabled">\n          <option value="').concat(th.FILL,'" ').concat((null===(u=a[0])||void 0===u?void 0:u.type)===th.FILL?'selected="selected"':"",'>填充</option>\n          <option value="').concat(th.FIT,'" ').concat((null===(h=a[0])||void 0===h?void 0:h.type)===th.FIT?'selected="selected"':"",'>适应</option>\n          <option value="').concat(th.STRETCH,'" ').concat((null===(d=a[0])||void 0===d?void 0:d.type)===th.STRETCH?'selected="selected"':"",'>拉伸</option>\n          <option value="').concat(th.TILE,'" ').concat((null===(f=a[0])||void 0===f?void 0:f.type)===th.TILE?'selected="selected"':"",'>平铺</option>\n        </select>\n      </div>\n      <div class="gradient ').concat(o.length||a.length||b?"hide":"",'">\n        <select>\n          <option value="').concat(Wu.LINEAR,'" ').concat((null===(p=s[0])||void 0===p?void 0:p.t)===Wu.LINEAR?'selected="selected"':"",'>线性</option>\n          <option value="').concat(Wu.RADIAL,'" ').concat((null===(v=s[0])||void 0===v?void 0:v.t)===Wu.RADIAL?'selected="selected"':"",'>径向</option>\n          <option value="').concat(Wu.CONIC,'" ').concat((null===(y=s[0])||void 0===y?void 0:y.t)===Wu.CONIC?'selected="selected"':"",'>角度</option>\n        </select>\n      </div>\n      <div class="multi-type ').concat(x||m||b?"":"hide",'">\n        <select disabled="disabled">\n          <option>').concat(A,'</option>\n        </select>\n      </div>\n      <span class="txt">').concat(C,'</span>\n    </div>\n    <div class="opacity">\n      <div class="input-unit">\n        <input type="number" min="0" max="100" step="1" value="').concat(n?"":100*i,'" placeholder="').concat(n?"多个":"",'"/>\n        <span class="unit">%</span>\n      </div>\n      <span class="txt">不透明度</span>\n    </div>\n  </div>')}(e,s.length>1,s[0],l.length>1,l[0],c,u,h,a.nodes[0].width,a.nodes[0].height)},a=this,s=r.length-1;s>=0;s--)o(s)}else t.style.display="none"},t}(vT);var ET=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="stroke-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">描边</h4>\n',r.appendChild(o);var a=[],s=[],l=[],c=function(){l&&l.length&&n.history.addCommand(new HA(a.slice(0),s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[],n.gradient.hide()};return o.addEventListener("click",(function(e){var t,r=e.target,u=r.classList;if(u.contains("pick")){if(r.parentElement.classList.contains("read-only"))return;if(EA.isShowFrom("strokePanel"))return void EA.hide();EA.keep=!0,a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return cp(t,e.width,e.height)}));s.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return up(e)})),strokeWidth:o})}));var h=r.parentElement.parentElement.parentElement,d=parseInt(h.title),f=i.nodes[0].computedStyle.stroke[d],p=function(e,t){var r,s,c;void 0===t&&(t=!1),i.silence=!0;var u=h.querySelector(".pick").style;Array.isArray(e)?(null===(r=o.querySelector(".value .hex"))||void 0===r||r.classList.remove("hide"),null===(s=o.querySelector(".value .gradient"))||void 0===s||s.classList.add("hide"),null===(c=o.querySelector(".value .multi-type"))||void 0===c||c.classList.add("hide"),u.background=Jf(e)):void 0!==e.url||(o.querySelector(".value .hex").classList.add("hide"),o.querySelector(".value .gradient").classList.remove("hide"),o.querySelector(".value .multi-type").classList.add("hide"),o.querySelector(".value .gradient select").value=e.t.toString(),u.background=cp(e,i.nodes[0].width,i.nodes[0].height,!0));l=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.stroke,i=r.strokeEnable,o=r.strokePosition,a=r.strokeWidth,s=n.map((function(t,r){return cp(r===d?e:t)})),c={stroke:s,strokeEnable:i,strokePosition:o.map((function(e){return up(e)})),strokeWidth:a};l.push(c),t.updateStyle(c)})),t||n.gradient.update(i.nodes[0],f),a.length&&n.emit(dT.STROKE_NODE,a.slice(0)),i.silence=!1};n.cancelEditGeom(),EA.show(r,f,"strokePanel",p,c,n),n.select.hideSelect(),n.gradient.show(i.nodes[0],f,p),n.state=yA.EDIT_GRADIENT}else if(u.contains("enabled")){i.silence=!0;var v=r.parentElement,y=parseInt(v.title),g=i.nodes.slice(0),m=[],b=[],x=!1;(u.contains("multi-checked")||u.contains("un-checked"))&&(x=!0),g.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return cp(t,e.width,e.height)}));m.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return up(e)})),strokeWidth:o});var s=a.slice(0),l=n.slice(0),c=i.map((function(e){return up(e)})),u=o.slice(0);void 0!==l[y]&&(l[y]=x);var h={stroke:s,strokeEnable:l,strokePosition:c,strokeWidth:u};b.push(h),e.updateStyle(h)})),u.remove("multi-checked"),x?(u.remove("un-checked"),u.add("checked"),v.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(u.remove("checked"),u.add("un-checked"),v.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),g.length&&(n.emit(dT.STROKE_NODE,g.slice(0)),n.history.addCommand(new HA(g.slice(0),m.map((function(e,t){return{prev:e,next:b[t]}}))))),i.silence=!1}else if(u.contains("p")&&!u.contains("cur")){i.silence=!0,null===(t=r.parentElement.querySelector(".cur"))||void 0===t||t.classList.remove("cur"),r.classList.add("cur");v=r.parentElement.parentElement.parentElement;var E=parseInt(v.title),w=i.nodes.slice(0),S=[],_=[],C="inside";u.contains("center")?C="center":u.contains("outside")&&(C="outside"),w.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return cp(t,e.width,e.height)}));S.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return up(e)})),strokeWidth:o});var s=a.slice(0),l=n.slice(0),c=i.map((function(e){return up(e)})),u=o.slice(0);void 0!==c[E]&&(c[E]=C);var h={stroke:s,strokeEnable:l,strokePosition:c,strokeWidth:u};_.push(h),e.updateStyle(h)})),w.length&&(n.emit(dT.STROKE_NODE,w.slice(0)),n.history.addCommand(new HA(w.slice(0),S.map((function(e,t){return{prev:e,next:_[t]}}))))),i.silence=!1}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=t.parentElement.parentElement.parentElement,o=parseInt(r.title),c=!a.length;c&&(s=[]),l=[];var u=Math.min(100,Math.max(0,parseFloat(t.value)||0)),h=e instanceof InputEvent;i.nodes.forEach((function(e,r){if(c){a.push(e);var i=e.getComputedStyle(),d=i.stroke,f=i.strokeEnable,p=i.strokePosition,v=i.strokeWidth,y=d.map((function(t){return cp(t,e.width,e.height)}));s.push({stroke:y,strokeEnable:f,strokePosition:p.map((function(e){return up(e)})),strokeWidth:v})}var g={stroke:s[r].stroke.slice(0),strokeEnable:s[r].strokeEnable.slice(0),strokePosition:s[r].strokePosition.slice(0),strokeWidth:s[r].strokeWidth.slice(0)};l.push(g);var m=s[r].strokeWidth[o],b=u,x=0;h?(x=b-m,r||(t.placeholder="")):(0===b&&(b=-1),x=t.placeholder?b:b-m,n.shiftKey?x=x>0?10:-10:n.altKey&&(x=x>0?.1:-.1),b=m+x,b=Math.max(b,0),b=Math.min(b,100),r||(t.value=t.placeholder?"":b.toString())),x&&(g.strokeWidth[o]=b,e.updateStyle(g))})),a.length&&n.emit(dT.STROKE_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",c),n.on([dT.STROKE_NODE],(function(e){i.silence||i.show(e)})),i}return p(t,e),t.prototype.show=function(e){var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),this.nodes=e.filter((function(e){return e instanceof Jw||e instanceof rC||e instanceof t_||e instanceof Fw})),this.nodes.length){t.style.display="block";var r=[],n=[],i=[],o=[];this.nodes.forEach((function(e){var t=e.getComputedStyle(),a=t.stroke,s=t.strokeEnable,l=t.strokePosition,c=t.strokeWidth;a.forEach((function(e,t){(r[t]=r[t]||[]).push(e)})),s.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),l.forEach((function(e,t){var r=i[t]=i[t]||[],n=up(e);r.includes(n)||r.push(n)})),c.forEach((function(e,t){var r=o[t]=o[t]||[];r.includes(e)||r.push(e)}))}));for(var a=function(e){var a=r[e],l=n[e],c=i[e],u=o[e],h=[],d=[],f=[];a.forEach((function(e){if(Array.isArray(e)){var t=Jf(e);h.includes(t)||h.push(t)}else{var r=e;if(void 0===r.url){var n=e;var i=0;e:for(c=f.length;i<c;i++){if((u=f[i]).t===n.t&&u.d.length===n.d.length){for(var o=u.d.length-1;o>=0;o--)if(u.d[o]!==n.d[o])continue e;if(u.stops.length===n.stops.length){for(o=u.stops.length-1;o>=0;o--){var a=u.stops[o],s=n.stops[o];if(a.color[0]!==s.color[0]||a.color[1]!==s.color[1]||a.color[2]!==s.color[2]||a.color[3]!==s.color[3]||a.offset!==s.offset)continue e}return}}}f.push(n)}else{for(var l=0,c=d.length;l<c;l++){var u;if((u=d[l]).url===r.url&&u.type===r.type&&u.scale===r.scale)return}d.push(r)}}})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,c,u,h){var d=s.length>1,f=l.length>1,p=c.length>1,v=(s.length?1:0)+(l.length?1:0)+(c.length?1:0)>1,y=v||d||f||p,g=t||!r||v||f||p||l.length||c.length?'readonly="readonly"':"",m="",b=" ";v?b="多个":s.length?(b="颜色",1===s.length&&(m=s[0])):l.length?(b="图像",1===l.length&&(m=cp(l[0],u,h,!0))):c.length&&(b="渐变",1===c.length&&(m=cp(c[0],u,h,!0)));var x=" ";return x=n?"多种":{inside:"内部",center:"中间",outside:"外部"}[i],'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(g?"read-only":"",'">\n        <b class="pick ').concat(y?"multi":"",'" style="').concat(y?"":"background:".concat(m),'">○○○</b>\n      </span>\n      <span class="txt">').concat(b,'</span>\n    </div>\n    <div class="pos">\n      <div>\n        <span class="p inside ').concat(n||"inside"!==i?"":"cur",'" title="内部"></span>\n        <span class="p center ').concat(n||"center"!==i?"":"cur",'" title="中间"></span>\n        <span class="p outside ').concat(n||"outside"!==i?"":"cur",'" title="外部"></span>\n      </div>\n      <span class="txt">').concat(x,'</span>\n    </div>\n    <div class="width">\n      <div class="input-unit">\n        <input type="number" min="0" max="100" step="1" value="').concat(o?"":a,'" placeholder="').concat(o?"多个":"",'"/>\n      </div>\n      <span class="txt">宽度</span>\n    </div>\n  </div>')}(e,l.length>1,l[0],c.length>1,c[0],u.length>1,u[0],h,d,f,s.nodes[0].width,s.nodes[0].height)},s=this,l=r.length-1;l>=0;l--)a(l)}else t.style.display="none"},t}(vT),wT="textPanelFold",ST=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.nodes=[];var o=i.panel=document.createElement("div");o.className="text-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title">字符<b class="btn arrow"></b></h4>\n  <div class="line ff">\n    <select>\n      <option value="arial">Arial</option>\n    </select>\n    <span class="multi">多种字体</span>\n  </div>\n  <div class="line wc">\n    <div class="weight">\n      <select></select>\n      <span class="multi">多种字重</span>\n    </div>\n    <div class="color">\n      <span class="picker-btn"><b class="pick">○○○</b></span>\n    </div>\n  </div>\n  <div class="line num">\n    <div class="fs">\n      <input type="number" min="0" step="1"/>\n      <span>字号</span>\n    </div>\n    <div class="ls">\n      <input type="number" step="1"/>\n      <span>字距</span>\n    </div>\n    <div class="lh">\n      <input type="number" min="0" step="1"/>\n      <span>行高</span>\n    </div>\n    <div class="ps">\n      <input type="number" step="1"/>\n      <span>段落</span>\n    </div>\n  </div>\n  <div class="line wh">\n    <div>\n      <span class="auto" title="自动宽度"></span>\n      <span class="fw" title="自动高度"></span>\n      <span class="fwh" title="固定尺寸"></span>\n    </div>\n    <span class="txt"></span>\n  </div>\n  <div class="line al">\n    <span class="left" title="水平左对齐"></span>\n    <span class="center" title="水平居中对齐"></span>\n    <span class="right" title="水平右对齐"></span>\n    <span class="justify" title="水平两端对齐"></span>\n  </div> \n  <div class="line va">\n    <span class="top" title="垂直上对齐"></span>\n    <span class="middle" title="垂直居中对齐"></span>\n    <span class="bottom" title="垂直下对齐"></span>\n  </div> \n',r.appendChild(o),n.input.ignoreBlur.push(o),i.initFontList(),"1"===localStorage.getItem(wT)&&o.classList.add("fold");var a=o.querySelector(".fs input"),s=o.querySelector(".ls input"),l=o.querySelector(".lh input"),c=o.querySelector(".ps input"),u=o.querySelector(".ff select"),h=o.querySelector(".weight select"),d=[],f=[],p=[],v=function(){d.length&&p.length&&n.history.addCommand(new IA(d,f.map((function(e,t){return{prev:e,next:p[t]}})),IA.COLOR)),d=[],f=[],p=[]},y=function(e,t){var r,o;i.silence=!0;var a=e.target,s=parseFloat(a.value)||0,l=!d.length;l&&(f=[]),p=[];var c=e instanceof InputEvent;if(n.state===yA.EDIT_TEXT&&1===i.nodes.length){var u=i.nodes[0],h=u.getSortedCursor(),v=h.isMulti,y=h.start,g=h.end;v?(l&&(d.push(u),f.push(u.getRich())),c?u.updateRangeStyle(y,g-y,((r={})[t]=s,r)):u.rich.forEach((function(e,r){var i;if(e.location<g&&e.location+e.length>y){var o=0;a.placeholder?(o=s>0?1:-1,n.shiftKey?o*=10:n.altKey&&(o*=.1)):(o=s-f[0][r][t],n.shiftKey?o*=10:n.altKey&&(o*=.1));var l=Math.max(e.location,y),c=Math.min(e.length,g-e.location)-(l-e.location),h=_T(e,t,o);u.updateRangeStyle(l,c,((i={})[t]=h,i))}})),p.push(u.getRich()),u.setCursorByIndex(y),u.setCursorByIndex(g,!0)):u.setInputStyle(((o={})[t]=s,o))}else i.nodes.forEach((function(e){var r;if(l&&(d.push(e),f.push(e.getRich())),c)e.updateRangeStyle(0,e._content.length,((r={})[t]=s,r));else{var i=0;a.placeholder?(i=s>0?1:-1,n.shiftKey?i*=10:n.altKey&&(i*=.1)):(i=s-f[0][0][t],n.shiftKey?i*=10:n.altKey&&(i*=.1)),e.rich.forEach((function(r){var n;e.updateRangeStyle(r.location,r.length,((n={})[t]=_T(r,t,i),n))}))}p.push(e.getRich())}));d.length&&(n.select.updateSelect(d),"fontSize"===t?n.emit(dT.FONT_SIZE_NODE,d.slice(0)):"letterSpacing"===t?n.emit(dT.LETTER_SPACING_NODE,d.slice(0)):"paragraphSpacing"===t?n.emit(dT.PARAGRAPH_SPACING_NODE,d.slice(0)):"lineHeight"===t&&n.emit(dT.LINE_HEIGHT_NODE,d.slice(0)),i.show(i.nodes)),i.silence=!1},g=function(e){if(d.length){var t="";"fontSize"==e?t=IA.FONT_SIZE:"letterSpacing"===e?t=IA.LETTER_SPACING:"lineHeight"===e?t=IA.LINE_HEIGHT:"paragraphSpacing"===e&&(t=IA.PARAGRAPH_SPACING),n.history.addCommand(new IA(d,f.map((function(e,t){return{prev:e,next:p[t]}})),t)),d=[],f=[],p=[]}},m=function(){n.state===yA.EDIT_TEXT&&n.input.focus()};a.addEventListener("input",(function(e){y(e,"fontSize")})),s.addEventListener("input",(function(e){y(e,"letterSpacing")})),l.addEventListener("input",(function(e){y(e,"lineHeight")})),c.addEventListener("input",(function(e){y(e,"paragraphSpacing")})),a.addEventListener("change",(function(e){g("fontSize")})),s.addEventListener("change",(function(e){g("letterSpacing")})),l.addEventListener("change",(function(e){g("lineHeight")})),c.addEventListener("change",(function(e){g("paragraphSpacing")})),a.addEventListener("blur",m),s.addEventListener("blur",m),l.addEventListener("blur",m),c.addEventListener("blur",m);var b=function(e,t){i.silence=!0;var r=e.target,a=r.value,s=i.nodes.slice(0);if("fontFamily"===t){o.querySelector(".ff .multi").style.display="none";var l=UC(a),c=o.querySelector(".wc select"),u="";l.forEach((function(e){u+='<option value="'.concat(e.value,'">').concat(e.label,"</option>")})),c.innerHTML=u;for(var h=l.length?l[0].value:a,d=0,f=l.length;d<f;d++){var p=l[d];if("regular"===p.label.toLowerCase()){h=p.value;break}}c.disabled=!1;var v=[];if(n.state===yA.EDIT_TEXT&&1===i.nodes.length){var y=(S=s[0]).getSortedCursor(),g=y.isMulti,m=y.start,b=y.end;if(g){var x=S.getRich();S.updateRangeStyle(m,b-m,{fontFamily:h}),v.push({prev:x,next:S.getRich()}),S.setCursorByIndex(m),S.setCursorByIndex(b,!0)}else S.setInputStyle({fontFamily:h})}else s.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{fontFamily:h}),v.push({prev:t,next:e.getRich()})}));v.length&&(n.history.addCommand(new IA(s,v,IA.FONT_FAMILY)),n.select.updateSelect(s),n.emit(dT.FONT_FAMILY_NODE,s.slice(0)),i.show(i.nodes))}else if("fontWeight"===t){o.querySelector(".wc .multi").style.display="none";var E=r.querySelector(":disabled");E&&E.remove();var w=[];if(n.state===yA.EDIT_TEXT&&1===i.nodes.length){var S,_=(S=s[0]).getSortedCursor();g=_.isMulti,m=_.start,b=_.end;if(g){x=S.getRich();S.updateRangeStyle(m,b-m,{fontFamily:a}),w.push({prev:x,next:S.getRich()}),S.setCursorByIndex(m),S.setCursorByIndex(b,!0)}else S.setInputStyle({fontFamily:a})}else s.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{fontFamily:a}),w.push({prev:t,next:e.getRich()})}));w.length&&(n.history.addCommand(new IA(s,w,IA.FONT_FAMILY)),n.select.updateSelect(s),n.emit(dT.FONT_FAMILY_NODE,s.slice(0)))}i.silence=!1};return u.addEventListener("change",(function(e){b(e,"fontFamily")})),h.addEventListener("change",(function(e){b(e,"fontWeight")})),o.addEventListener("click",(function(e){var t,a,s,l=e.target,c=l.classList;if(c.contains("pick")){if(l.parentElement.classList.contains("read-only"))return;if(EA.isShowFrom("textPanel"))return void EA.hide();EA.keep=!0,d=i.nodes.slice(0),f=d.map((function(e){return e.getRich()}));var u=i.nodes[0].computedStyle.color,h=EA.show(l,u,"textPanel",(function(e){if(i.silence=!0,p=[],n.state===yA.EDIT_TEXT&&1===d.length){var t=d[0],r=t.getSortedCursor(),a=r.isMulti,s=r.start,l=r.end;a?(t.updateRangeStyle(s,l-s,{color:e}),p.push(t.getRich()),t.setCursorByIndex(s),t.setCursorByIndex(l,!0)):t.setInputStyle({color:e})}else d.forEach((function(t){t.updateRangeStyle(0,t._content.length,{color:e}),p.push(t.getRich())}));o.querySelector(".pick").style.background=Jf(e),d.length&&n.emit(dT.COLOR_NODE,d.slice(0)),i.silence=!1}),v,n),y=h.domElement.parentElement;n.input.ignoreBlur.includes(y)||n.input.ignoreBlur.push(y)}else if(c.contains("arrow"))o.classList.contains("fold")?(o.classList.remove("fold"),localStorage.removeItem(wT)):(o.classList.add("fold"),localStorage.setItem(wT,"1"));else if((c.contains("auto")||c.contains("fw")||c.contains("fwh"))&&!c.contains("cur")){d=i.nodes.slice(0);var g=nh.AUTO;c.contains("fw")?g=nh.FIXED_W:c.contains("fwh")&&(g=nh.FIXED_W_H);var m=[];d.map((function(e){var t=e.width,r=e.height,n=NC(e);GC(e,g);var i={dx:e.width-t,dy:e.height-r,controlType:TA.BR,aspectRatio:!1,fromCenter:!1};n===nh.AUTO?(i.widthFromAuto=!0,i.heightFromAuto=!0):n===nh.FIXED_W&&(i.heightFromAuto=!0),g===nh.AUTO?(i.widthToAuto=!0,i.heightToAuto=!0):g===nh.FIXED_W&&(i.heightToAuto=!0),m.push(i)})),n.history.addCommand(new LA(d,m)),n.select.updateSelect(d),n.emit(dT.RESIZE_NODE,d.slice(0)),null===(t=r.querySelector(".wh .cur"))||void 0===t||t.classList.remove("cur"),c.add("cur"),r.querySelector(".wh .txt").innerHTML=l.title}else if((c.contains("left")||c.contains("right")||c.contains("center")||l.classList.contains("justify"))&&!c.contains("cur")){var b=i.nodes.slice(0),x=Gu.LEFT;c.contains("right")?x=Gu.RIGHT:c.contains("center")?x=Gu.CENTER:c.contains("justify")&&(x=Gu.JUSTIFY);var E=[];if(1===b.length&&n.state===yA.EDIT_TEXT){var w=b[0],S=w.content,_=w.getSortedCursor(),C=_.isMulti,A=_.start,T=_.end;(A="\n"===S.charAt(A)?S.lastIndexOf("\n",A-1):S.lastIndexOf("\n",A))<0?A=0:A++,(T=S.indexOf("\n",T))<0?T=S.length:T++;var O=w.getRich();if(w.updateRangeStyle(A,T-A,{textAlign:x}),E.push({prev:O,next:w.getRich()}),C)w.setCursorByIndex(A),w.setCursorByIndex(T,!0);else{h=w.updateCursorByIndex(_.start);n.input.updateCursor(h)}}else b.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{textAlign:x}),E.push({prev:t,next:e.getRich()})}));E.length&&(n.history.addCommand(new IA(b,E,IA.TEXT_ALIGN)),n.emit(dT.TEXT_ALIGN_NODE,b.slice(0))),null===(a=r.querySelector(".al .cur"))||void 0===a||a.classList.remove("cur"),c.add("cur")}else if((c.contains("top")||c.contains("bottom")||c.contains("middle"))&&!c.contains("cur")){v();var M=i.nodes.slice(0),k="top";c.contains("middle")?k="middle":c.contains("bottom")&&(k="bottom");var L=[];M.forEach((function(e){var t=e.computedStyle.textVerticalAlign,r="top";t===Xu.MIDDLE?r="middle":t===Xu.BOTTOM&&(r="bottom"),e.updateStyle({textVerticalAlign:k}),L.push({prev:{textVerticalAlign:r},next:{textVerticalAlign:k}})})),n.history.addCommand(new BA(M,L)),n.emit(dT.TEXT_VERTICAL_ALIGN_NODE,M.slice(0)),null===(s=r.querySelector(".va .cur"))||void 0===s||s.classList.remove("cur"),c.add("cur")}})),n.on([dT.RESIZE_NODE,dT.FONT_SIZE_NODE,dT.FONT_FAMILY_NODE,dT.LETTER_SPACING_NODE,dT.LINE_HEIGHT_NODE,dT.PARAGRAPH_SPACING_NODE,dT.COLOR_NODE,dT.TEXT_ALIGN_NODE,dT.TEXT_VERTICAL_ALIGN_NODE,dT.CURSOR_NODE],(function(e){i.silence||i.show(e)})),i}return p(t,e),t.prototype.initFontList=function(e){var t=RC.font.info,r="";if(e&&e.length){var n=t.Arial;e.forEach((function(e){Hh.registerData(K(K({},n),e)),r+='<option value="'.concat(e.family,'">').concat(e.name,"</option>")}))}else for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];r+='<option value="'.concat(i,'">').concat(o.name||i,"</option>")}this.panel.querySelector("select").innerHTML=r},t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){if(e[n]instanceof t_){r=!0;break}}if(r){t.style.display="block",t.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder=""}));var o=e.filter((function(e){return e instanceof t_}));this.nodes=o;var a,s,l=this.listener.state===yA.EDIT_TEXT&&1===e.length&&o[0]._content?zC(o[0]):BC(o);(s=(a=t.querySelector(".ff select")).querySelector(":disabled"))&&s.remove();var c=t.querySelector(".ff .multi");for(n=0,i=(f=a.querySelectorAll("option")).length;n<i;n++){var u=f[n];if(u.selected){u.selected=!1;break}}if(l.fontFamily.length>1){c.innerText="多种字体",c.style.display="block",c.classList.remove("invalid");a.innerHTML+='<option value="" selected="selected" disabled>多种字体</option>'}else if(l.valid[0]){if(c.style.display="none",c.classList.remove("invalid"),!a.querySelector('option[value="'.concat(l.fontFamily[0],'"]'))){h='<option value="'.concat(l.fontFamily[0],'">').concat(l.name[0],"</option>");a.innerHTML+=h}a.value=l.fontFamily[0]}else{if(c.innerText=l.fontFamily[0],c.classList.add("invalid"),c.style.display="block",a.querySelector('option[value="'.concat(l.postscriptName[0],'"]')))a.value=l.postscriptName[0];else{var h='<option value="'.concat(l.postscriptName[0],'" selected="selected" disabled>').concat(l.fontFamily[0],"</option>");a.innerHTML+=h}}(s=(a=t.querySelector(".wc select")).querySelector(":disabled"))&&s.remove();var d="";l.fontWeightList.forEach((function(e){d+='<option value="'.concat(e.value,'">').concat(e.label,"</option>")})),a.innerHTML=d;c=t.querySelector(".wc .multi");if(l.fontWeight.length>1){c.style.display="block";a.innerHTML+='<option value="" selected="selected" disabled>多种字体</option>'}else{c.style.display="none";var f;for(n=0,i=(f=a.querySelectorAll("option")).length;n<i;n++){var p=f[n];if(p.innerHTML===l.fontWeight[0]){p.selected=!0;break}}}a.disabled=!(1===l.valid.length&&l.valid[0]);var v=t.querySelector(".color .pick");l.color.length>1?(v.style.background="",v.classList.add("multi")):(v.style.background=l.color[0],v.classList.remove("multi"));var y=t.querySelector(".fs input");l.fontSize.length>1?(y.value="",y.placeholder="多个"):(y.value=Ff(l.fontSize[0]||0,2).toString(),y.placeholder="");y=t.querySelector(".ls input");l.letterSpacing.length>1?(y.value="",y.placeholder="多个"):(y.value=Ff(l.letterSpacing[0]||0,2).toString(),y.placeholder="");y=t.querySelector(".lh input");l.lineHeight.length>1?(y.value="",y.placeholder="多个"):l.autoLineHeight[0]?(y.value="",y.placeholder=Ff(l.lineHeight[0]||0,2).toString()):(y.value=Ff(l.lineHeight[0]||0,2).toString(),y.placeholder="");y=t.querySelector(".ps input");l.paragraphSpacing.length>1?(y.value="",y.placeholder="多个"):(y.value=Ff(l.paragraphSpacing[0]||0,2).toString(),y.placeholder=""),(g=t.querySelector(".wh .cur"))&&g.classList.remove("cur");var g,m=t.querySelector(".wh .txt");if(1===l.textBehaviour.length){var b=l.textBehaviour[0];b===nh.AUTO?(t.querySelector(".wh .auto").classList.add("cur"),m.innerHTML="自动宽度"):b===nh.FIXED_W?(t.querySelector(".wh .fw").classList.add("cur"),m.innerHTML="自动高度"):b===nh.FIXED_W_H&&(t.querySelector(".wh .fwh").classList.add("cur"),m.innerHTML="固定尺寸")}else m.innerHTML="多种";if((g=t.querySelector(".al .cur"))&&g.classList.remove("cur"),1===l.textAlign.length){var x=l.textAlign[0];x===Gu.LEFT?t.querySelector(".al .left").classList.add("cur"):x===Gu.CENTER?t.querySelector(".al .center").classList.add("cur"):x===Gu.RIGHT?t.querySelector(".al .right").classList.add("cur"):x===Gu.JUSTIFY&&t.querySelector(".al .justify").classList.add("cur")}if((g=t.querySelector(".va .cur"))&&g.classList.remove("cur"),1===l.textVerticalAlign.length){var E=l.textVerticalAlign[0];E===Xu.TOP?t.querySelector(".va .top").classList.add("cur"):E===Xu.MIDDLE?t.querySelector(".va .middle").classList.add("cur"):E===Xu.BOTTOM&&t.querySelector(".va .bottom").classList.add("cur")}}else t.style.display="none"},t}(vT);function _T(e,t,r){var n=e[t];if(!n&&"lineHeight"===t){var i=Hh.data[e.fontFamily];n=i?e.fontSize*i.lhr:e.fontSize*(Hh.data[dh.defaultFontFamily]||Hh.data.arial).lhr}var o=n+r;return"fontSize"!==t&&"lineHeight"!==t||(o=Math.max(0,o)),o}var CT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");return o.className="align-panel",o.innerHTML='\n  <div class="line">\n    <span class="left" title="居左"></span>\n    <span class="center" title="左右居中"></span>\n    <span class="right" title="居右"></span>\n    <span class="top" title="居上"></span>\n    <span class="middle" title="上下居中"></span>\n    <span class="bottom" title="居下"></span>\n  </div>\n',r.appendChild(o),o.addEventListener("click",(function(e){var t=e.target;if("SPAN"===t.tagName.toUpperCase()&&t.parentElement.classList.contains("disabled"))return;var r=t.classList,o=[],a=[];i.nodes.forEach((function(e){var t=0,n=0,i=e.parent,s=i.width,l=i.height,c=e.computedStyle;if(r.contains("left")?t=-c.left-c.translateX:r.contains("center")?t=.5*s-c.left-c.translateX-.5*c.width:r.contains("right")?t=s-c.left-c.translateX-c.width:r.contains("top")?n=-c.top-c.translateY:r.contains("middle")?n=.5*l-c.top-c.translateY-.5*c.height:r.contains("bottom")&&(n=l-c.top-c.translateY-c.height),t||n){var u=e.getStyle();e.updateStyle({translateX:c.translateX+t,translateY:c.translateY+n}),e.endPosChange(u,t,n),e.checkPosSizeUpward(),o.push(e),a.push({dx:t,dy:n})}})),o.length&&(n.select.updateSelect(o),n.emit(dT.MOVE_NODE,o.slice(0)),n.history.addCommand(new MA(o,a)))})),i}return p(t,e),t.prototype.show=function(e){var t=this.panel,r=[];e.forEach((function(e){var t=e.parent;t&&(t instanceof WS||t instanceof kw)&&r.push(e)})),this.nodes=r,r.length?t.querySelector(".line").classList.remove("disabled"):t.querySelector(".line").classList.add("disabled")},t}(vT),AT=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=e.getCurPage(),i=e.pageContainer,o=document.createElement("ul");i.children.forEach((function(e){var t=document.createElement("li");t.title=e.props.name||"",t.setAttribute("uuid",e.props.uuid),t.innerHTML=e.props.name||"",n&&e===n&&(t.className="active"),o.appendChild(t)})),t.innerHTML="",t.appendChild(o),t.addEventListener("click",(function(t){var n,a=t.target,s=a.classList;if(!s.contains("active")){null===(n=o.querySelector(".active"))||void 0===n||n.classList.remove("active"),s.add("active");var l=a.getAttribute("uuid");if(l){var c=e.refs[l];if(c){var u=i.children.indexOf(c);u>-1&&(e.setPageIndex(u),r.active([]))}}}}))};var TT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="shadow-panel",o.style.display="none",o.innerHTML='\n  <div class="panel-title">阴影<b class="btn del"></b><b class="btn add"></b></div>\n',r.appendChild(o);var a=[],s=[],l=[],c=function(){l.length&&n.history.addCommand(new UA(a,s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[]};return o.addEventListener("click",(function(e){var t=e.target,r=t.classList;if(r.contains("pick")){if(t.parentElement.classList.contains("read-only"))return;if(EA.isShowFrom("shadowPanel"))return void EA.hide();EA.keep=!0,a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return lp(e)}));s.push({shadow:i,shadowEnable:n})}));var u=t.parentElement.parentElement.parentElement,h=parseInt(u.title),d=i.nodes[0].computedStyle.shadow[h].color;EA.show(t,d,"shadowPanel",(function(e){i.silence=!0,l=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.shadow,i=r.shadowEnable,o=n.map((function(t,r){return lp(r===h?Object.assign(t,{color:e}):t)})),a={shadow:o,shadowEnable:i};l.push(a),t.updateStyle(a)})),u.querySelector(".pick").style.background=Jf(e),a.length&&n.emit(dT.SHADOW_NODE,a.slice(0)),i.silence=!1}),c,n)}else if(r.contains("add")){i.silence=!0;var f=i.nodes.slice(0),p=[],v=[];f.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return lp(e)}));p.push({shadow:i,shadowEnable:n});var o=i.slice(0),a=n.slice(0);o.push("rgba(0,0,0,0.5) 0 2 4 0"),a.push(!0);var s={shadow:o,shadowEnable:a};v.push(s),e.updateStyle(s)})),i.show(f),n.emit(dT.SHADOW_NODE,f.slice(0)),n.history.addCommand(new UA(f.slice(0),p.map((function(e,t){return{prev:e,next:v[t]}})))),i.silence=!1}else if(r.contains("del")){i.silence=!0;var y=i.nodes.slice(0),g=[],m=[],b=0;y.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return lp(e)}));b=Math.max(b,n.length),g.push({shadow:i,shadowEnable:n}),m.push({shadow:i.slice(0),shadowEnable:n.slice(0)})}));for(var x=function(e){for(var t=0,r=m.length;t<r;t++){if(m[t].shadowEnable[e])return"continue-outer"}m.forEach((function(t){t.shadow.splice(e,1),t.shadowEnable.splice(e,1)}))},E=b-1;E>=0;E--)x(E);y.forEach((function(e,t){e.updateStyle(m[t])})),i.show(y),n.emit(dT.SHADOW_NODE,y.slice(0)),n.history.addCommand(new UA(y.slice(0),g.map((function(e,t){return{prev:e,next:m[t]}})))),i.silence=!1}else if(r.contains("enabled")){i.silence=!0;var w=t.parentElement,S=parseInt(w.title),_=i.nodes.slice(0),C=[],A=[],T=!1;(r.contains("multi-checked")||r.contains("un-checked"))&&(T=!0),_.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return lp(e)}));C.push({shadow:i,shadowEnable:n});var o=i.slice(0),a=n.slice(0);void 0!==a[S]&&(a[S]=T);var s={shadow:o,shadowEnable:a};A.push(s),e.updateStyle(s)})),r.remove("multi-checked"),T?(r.remove("un-checked"),r.add("checked"),w.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(r.remove("checked"),r.add("un-checked"),w.querySelectorAll("input").forEach((function(e){e.readOnly=!0})));var O=o.querySelector(".un-checked");o.querySelector(".del").style.display=O?"block":"none",n.emit(dT.SHADOW_NODE,_.slice(0)),n.history.addCommand(new UA(_.slice(0),C.map((function(e,t){return{prev:e,next:A[t]}})))),i.silence=!1}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=parseInt(t.parentElement.parentElement.title),o=t.classList,c=1;o.contains("y")?c=2:o.contains("blur")?c=3:o.contains("spread")&&(c=4);var u=Math.min(5e5,Math.max(-5e5,parseFloat(t.value)||0)),h=!a.length;h&&(s=[]),l=[];var d=e instanceof InputEvent;i.nodes.forEach((function(e,i){if(h){a.push(e);var o=e.getComputedStyle(),f=o.shadow,p=o.shadowEnable,v=f.map((function(e){return lp(e)}));s.push({shadow:v,shadowEnable:p})}var y={shadow:s[i].shadow.slice(0),shadowEnable:s[i].shadowEnable.slice(0)};l.push(y);var g=parseFloat(s[i].shadow[r].split(" ")[c]),m=u;if(d)t.placeholder="";else{var b=0;t.placeholder?(b=u>0?1:-1,n.shiftKey?b*=10:n.altKey&&(b*=.1)):(b=u-g,n.shiftKey?b*=10:n.altKey&&(b*=.1)),m=g+b,t.placeholder?t.value="":t.value=Math.round(m).toString()}if(y.shadow[r]){var x=y.shadow[r].split(" ");x[c]=m.toString(),y.shadow[r]=x.join(" "),e.updateStyle(y)}})),a.length&&n.emit(dT.SHADOW_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",c),n.on([dT.SHADOW_NODE],(function(e){i.silence||i.show(e)})),n.on(dT.STATE_CHANGE,(function(e,t){t!==yA.EDIT_GEOM&&t!==yA.NORMAL||i.show(n.selected)})),i}return p(t,e),t.prototype.show=function(t){e.prototype.show.call(this,t);var r=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),t.length&&this.listener.state!==yA.EDIT_GEOM){r.style.display="block";var n=[],i=[];t.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow;t.shadowEnable.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),r.forEach((function(e,t){(i[t]=i[t]||[]).push(e)}))}));for(var o=!1,a=function(e){var t=i[e],a=n[e],s=[],l=[],c=[],u=[],h=[];t.forEach((function(e){var t=Jf(e.color);s.includes(t)||s.push(t),l.includes(e.x)||l.push(e.x),c.includes(e.y)||c.push(e.y),u.includes(e.blur)||u.push(e.blur),h.includes(e.spread)||h.push(e.spread)})),r.innerHTML+=function(e,t,r,n,i,o,a,s,l,c,u,h,d){var f=t||!r?'readonly="readonly"':"";return'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(f?"read-only":"",'">\n        <b class="pick ').concat(n?"multi":"",'" style="').concat(n?"":"background:".concat(i),'">○○○</b>\n      </span>\n      <span class="txt">颜色</span>\n    </div>\n    <div>\n      <input class="x" type="number" min="-500000" max="500000" step="1" value="').concat(o?"":a,'" placeholder="').concat(o?"多个":"",'" ').concat(f,'/>\n      <span class="txt">X</span>\n    </div>\n    <div>\n      <input class="y" type="number" min="-500000" max="500000" step="1" value="').concat(s?"":l,'" placeholder="').concat(s?"多个":"",'" ').concat(f,'/>\n      <span class="txt">Y</span>\n    </div>\n    <div>\n      <input class="blur" type="number" min="0" max="50" step="1" value="').concat(c?"":u,'" placeholder="').concat(c?"多个":"",'" ').concat(f,'/>\n      <span class="txt">模糊</span>\n    </div>\n  </div>')}(e,a.length>1,a[0],s.length>1,s[0],l.length>1,l[0],c.length>1,c[0],u.length>1,u[0]),1!==a.length||a[0]||(o=!0)},s=i.length-1;s>=0;s--)a(s);this.panel.querySelector(".del").style.display=o?"block":"none"}else r.style.display="none"},t}(vT),OT='\n  <div class="panel-title">模糊<b class="btn"></b></div>\n  <select>\n    <option value="'.concat(Yu.GAUSSIAN,'">高斯模糊</option>\n    <option value="').concat(Yu.MOTION,'">动感模糊</option>\n    <option value="').concat(Yu.RADIAL,'">缩放模糊</option>\n    <option value="').concat(Yu.BACKGROUND,'">背景模糊</option>\n    <option value="').concat(Yu.NONE,'" disabled="disabled" style="display:none">多个</option>\n  </select>\n  <div class="type radius">\n    <div class="con">\n      <input class="range" type="range" min="0" max="50" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="0" max="50" step="1"/>\n      </div>\n    </div>\n  </div>\n  <div class="type t').concat(Yu.MOTION,' angle">\n    <div class="intro">角度</div>\n    <div class="con">\n      <input class="range" type="range" min="-180" max="180" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="-180" max="180" step="1"/>\n        <span class="unit">°</span>\n      </div>\n    </div>\n  </div>\n  <div class="type t').concat(Yu.RADIAL,' center">\n    <button disabled="disabled">编辑原点</button>\n  </div>\n  <div class="type t').concat(Yu.BACKGROUND,' saturation">\n    <div class="intro">饱和度</div>\n    <div class="con">\n      <input class="range" type="range" min="-100" max="100" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="-100" max="100" step="1"/>\n        <span class="unit">%</span>\n      </div>\n    </div>\n  </div>\n'),MT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="blur-panel",o.style.display="none",o.innerHTML=OT,r.appendChild(o);var a=i.btn=o.querySelector(".btn"),s=i.select=o.querySelector("select"),l=i.radiusRange=o.querySelector(".radius .range"),c=i.radiusNumber=o.querySelector(".radius .number"),u=i.angleRange=o.querySelector(".angle .range"),h=i.angleNumber=o.querySelector(".angle .number"),d=i.saturationRange=o.querySelector(".saturation .range"),f=i.saturationNumber=o.querySelector(".saturation .number"),p=[],v=[],y=[];a.addEventListener("click",(function(){var e=a.classList.contains("add");e?(a.classList.remove("add"),a.classList.add("del")):(a.classList.add("add"),a.classList.remove("del")),p=[],v=[],y=[],i.nodes.forEach((function(t){p.push(t),v.push({blur:t.getCssStyle().blur});var r={blur:"none"};e&&(r.blur=sp(Yu.GAUSSIAN,4,0,[.5,.5],1)),y.push(r),t.updateStyle(r)})),i.show(i.nodes),b()})),s.addEventListener("change",(function(){i.silence=!0;var e=parseInt(s.value);o.querySelectorAll("div.t2,div.t3,div.t4").forEach((function(e){e.style.display="none"}));var t=o.querySelector("div.t".concat(e));t&&(t.style.display="block"),p=[],v=[],y=[],i.nodes.forEach((function(t){p.push(t),v.push({blur:t.getCssStyle().blur});var r=t.computedStyle.blur,n={blur:sp(e,r.radius,r.angle,r.center,r.saturation)};y.push(n),t.updateStyle(n)})),n.emit(dT.BLUR_NODE,p.slice(0)),b(),i.show(i.nodes),i.silence=!1}));var g=function(e,t,r){i.silence=!0;var o=e.value,a=parseFloat(o),s=!p.length;s&&(v=[]),y=[],i.nodes.forEach((function(e){s&&(p.push(e),v.push({blur:e.getCssStyle().blur}));var t,n=e.computedStyle.blur;"radius"===r?t={blur:sp(n.t,a,n.angle,n.center,n.saturation)}:"angle"===r?t={blur:sp(n.t,n.radius,a,n.center,n.saturation)}:"saturation"===r&&(t={blur:sp(n.t,n.radius,n.angle,n.center,.01*(a+100))}),y.push(t),e.updateStyle(t)})),"radius"===r?e.style.setProperty("--p",(2*a).toString()):"angle"===r?e.style.setProperty("--p",(100*(a+180)/360).toString()):"saturation"===r&&e.style.setProperty("--p",(.5*(a+100)).toString()),t.value=o,t.placeholder="",p.length&&n.emit(dT.BLUR_NODE,p.slice(0)),i.silence=!1},m=function(e,t,r,o,a,s){i.silence=!0;var l=!p.length;l&&(v=[]),y=[];var c=parseFloat(t.value)||0;if(i.nodes.forEach((function(e,i){var u=e.computedStyle.blur;if(u.t!==Yu.NONE){l&&(p.push(e),v.push({blur:e.getCssStyle().blur}));var h=u.radius;"angle"===r?h=u.angle:"saturation"===r&&(h=100*u.saturation-100);var d,f=c;if(o)i||(t.placeholder="");else{var g=0;t.placeholder?(g=f>0?1:-1,n.shiftKey?g*=10:n.altKey&&(g*=.1),f=Math.min(a,Math.max(s,Math.round(h+g))),t.value=""):(g=f-h,n.shiftKey?g*=10:n.altKey&&(g*=.1),f=Math.min(a,Math.max(s,Math.round(h+g))),i||(t.value=f.toString()))}"radius"===r?d={blur:sp(u.t,f,u.angle,u.center,u.saturation)}:"angle"===r?d={blur:sp(u.t,u.radius,f,u.center,u.saturation)}:"saturation"===r&&(d={blur:sp(u.t,u.radius,u.angle,u.center,.01*(f+100))}),y.push(d),e.updateStyle(d)}})),e.value=t.value||"0",!t.placeholder){var u=parseFloat(e.value);"radius"===r?e.style.setProperty("--p",(2*u).toString()):"angle"===r?e.style.setProperty("--p",(100*(u+180)/360).toString()):"saturation"===r&&e.style.setProperty("--p",(.5*(u+100)).toString())}p.length&&n.emit(dT.BLUR_NODE,p.slice(0)),i.silence=!1},b=function(){p.length&&n.history.addCommand(new zA(p,v.map((function(e,t){return{prev:e,next:y[t]}})))),p=[],v=[],y=[]};return l.addEventListener("input",(function(){g(l,c,"radius")})),l.addEventListener("change",b),c.addEventListener("input",(function(e){m(l,c,"radius",e instanceof InputEvent,50,0)})),c.addEventListener("change",b),u.addEventListener("input",(function(){g(u,h,"angle")})),u.addEventListener("change",b),h.addEventListener("input",(function(e){m(u,h,"angle",e instanceof InputEvent,180,-180)})),h.addEventListener("change",b),d.addEventListener("input",(function(){g(d,f,"saturation")})),d.addEventListener("change",b),f.addEventListener("input",(function(e){m(d,f,"saturation",e instanceof InputEvent,100,-100)})),f.addEventListener("change",b),n.on([dT.BLUR_NODE],(function(e){i.silence||i.show(e)})),n.on(dT.STATE_CHANGE,(function(e,t){t!==yA.EDIT_GEOM&&t!==yA.NORMAL||i.show(n.selected)})),i}return p(t,e),t.prototype.show=function(t){e.prototype.show.call(this,t);var r=this.panel;if(t.length&&this.listener.state!==yA.EDIT_GEOM){r.style.display="block";var n=r.querySelector("select"),i=n.querySelector(":disabled"),o=[],a=[],s=[],l=[];if(t.forEach((function(e){var t=e.computedStyle.blur;t.t!==Yu.NONE&&(o.includes(t.t)||o.push(t.t),a.includes(t.radius)||a.push(t.radius),void 0===t.angle||s.includes(t.angle)||s.push(t.angle),void 0===t.saturation||l.includes(t.saturation)||l.push(t.saturation))})),r.querySelectorAll("select,div.type").forEach((function(e){e.style.display="none"})),!o.length)return this.btn.classList.remove("del"),void this.btn.classList.add("add");if(this.btn.classList.remove("add"),this.btn.classList.add("del"),this.select.style.display="block",r.querySelector("div.radius").style.display="block",o.length>1)i.style.display="block",n.value=Yu.NONE.toString();else{i.style.display="none",n.value=o[0].toString();var c=r.querySelector("div.t".concat(o[0]));c&&(c.style.display="block")}if(a.length>1)this.radiusRange.value="0",this.radiusRange.style.setProperty("--p","0"),this.radiusNumber.value="",this.radiusNumber.placeholder="多个";else{var u=(h=Math.round(a[0]||0)).toString();this.radiusRange.style.setProperty("--p",(2*h).toString()),this.radiusRange.value=u,this.radiusNumber.value=u,this.radiusNumber.placeholder=""}if(s.length>1)this.angleRange.value="0",this.radiusRange.style.setProperty("--p","50"),this.angleNumber.value="",this.angleNumber.placeholder="多个";else{u=(h=Math.round(s[0]||0)).toString();this.angleRange.value=u,this.angleRange.style.setProperty("--p",(100*(h+180)/360).toString()),this.angleNumber.value=u,this.angleNumber.placeholder=""}if(l.length>1)this.saturationRange.value="0",this.saturationRange.style.setProperty("--p","50"),this.saturationNumber.value="",this.saturationNumber.placeholder="多个";else{var h;u=(h=Math.round(100*(l[0]||0)-100)).toString();this.saturationRange.value=u,this.saturationRange.style.setProperty("--p",(.5*(h+100)).toString()),this.saturationNumber.value=u,this.saturationNumber.placeholder=""}}else r.style.display="none"},t}(vT),kT=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="color-adjust-panel",o.style.display="none",o.innerHTML='\n  <div class="panel-title">颜色调整</div>\n  <div class="line hue">\n    <div class="intro">色相</div>\n    <input class="range" type="range" min="-180" max="180" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-180" max="180" step="1"/>\n      <span class="unit">°</span>\n    </div>\n  </div>\n  <div class="line saturate">\n    <div class="intro">饱和度</div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n  <div class="line brightness">\n    <div class="intro">亮度</div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n  <div class="line contrast">\n    <div class="intro">对比度</div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n',r.appendChild(o);var a=i.hueRotateRange=o.querySelector(".hue .range"),s=i.hueRotateNumber=o.querySelector(".hue .number"),l=i.saturateRange=o.querySelector(".saturate .range"),c=i.saturateNumber=o.querySelector(".saturate .number"),u=i.brightnessRange=o.querySelector(".brightness .range"),h=i.brightnessNumber=o.querySelector(".brightness .number"),d=i.contrastRange=o.querySelector(".contrast .range"),f=i.contrastNumber=o.querySelector(".contrast .number"),p=[],v=[],y=[],g=function(e,t,r){i.silence=!0;var o=e.value,a=parseFloat(o),s=!p.length;s&&(v=[]),y=[],i.nodes.forEach((function(e){var t=e.getCssStyle(),n=t.hueRotate,i=t.saturate,o=t.brightness,l=t.contrast;s&&(p.push(e),v.push({hueRotate:n,saturate:i,brightness:o,contrast:l}));var c={hueRotate:"hueRotate"===r?a:n,saturate:"saturate"===r?a+100+"%":i,brightness:"brightness"===r?a+100+"%":o,contrast:"contrast"===r?(a>0?3*a+100:a+100)+"%":l};y.push(c),e.updateStyle(c)})),"hueRotate"===r?e.style.setProperty("--p",(100*(a+180)/360).toString()):("saturate"===r||"brightness"===r||"contrast"===r)&&e.style.setProperty("--p",(.5*(a+100)).toString()),t.value=o,t.placeholder="",p.length&&n.emit(dT.COLOR_ADJUST_NODE,p.slice(0)),i.silence=!1},m=function(e,t,r,o,a,s){i.silence=!0;var l=!p.length;l&&(v=[]),y=[];var c=parseFloat(t.value)||0;if(i.nodes.forEach((function(e,i){var u=e.getCssStyle(),h=u.hueRotate,d=u.saturate,f=u.brightness,g=u.contrast;l&&(p.push(e),v.push({hueRotate:h,saturate:d,brightness:f,contrast:g}));var m=e.computedStyle,b=0;"hueRotate"===r?b=m.hueRotate:"saturate"===r?b=100*m.saturate-100:"brightness"===r?b=100*m.brightness-100:"contrast"===r&&(b=100*m.contrast-100)>0&&(b/=3);var x=c;if(o)i||(t.placeholder="");else{var E=0;t.placeholder?(E=x>0?1:-1,n.shiftKey&&(E*=10),x=Math.min(a,Math.max(s,Math.round(b+E))),t.value=""):(E=x-b,n.shiftKey&&(E*=10),x=Math.min(a,Math.max(s,Math.round(b+E))),i||(t.value=x.toString()))}var w={hueRotate:"hueRotate"===r?x:h,saturate:"saturate"===r?x+100+"%":d,brightness:"brightness"===r?x+100+"%":f,contrast:"contrast"===r?(x>0?3*x+100:x+100)+"%":g};y.push(w),e.updateStyle(w)})),e.value=t.value||"0",!t.placeholder){var u=parseFloat(e.value);"hueRotate"===r?e.style.setProperty("--p",(100*(u+180)/360).toString()):("saturate"===r||"brightness"===r||"contrast"===r)&&e.style.setProperty("--p",(.5*(u+100)).toString())}p.length&&n.emit(dT.COLOR_ADJUST_NODE,p.slice(0)),i.silence=!1},b=function(){p.length&&n.history.addCommand(new GA(p,v.map((function(e,t){return{prev:e,next:y[t]}})))),p=[],v=[],y=[]};return a.addEventListener("input",(function(){g(a,s,"hueRotate")})),a.addEventListener("change",b),s.addEventListener("input",(function(e){m(a,s,"hueRotate",e instanceof InputEvent,180,-180)})),s.addEventListener("change",b),l.addEventListener("input",(function(){g(l,c,"saturate")})),l.addEventListener("change",b),c.addEventListener("input",(function(e){m(l,c,"saturate",e instanceof InputEvent,100,-100)})),c.addEventListener("change",b),u.addEventListener("input",(function(){g(u,h,"brightness")})),u.addEventListener("change",b),h.addEventListener("input",(function(e){m(u,h,"brightness",e instanceof InputEvent,100,-100)})),h.addEventListener("change",b),d.addEventListener("input",(function(){g(d,f,"contrast")})),d.addEventListener("change",b),f.addEventListener("input",(function(e){m(d,f,"contrast",e instanceof InputEvent,100,-100)})),f.addEventListener("change",b),n.on([dT.COLOR_ADJUST_NODE],(function(e){i.silence||i.show(e)})),i}return p(t,e),t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){if(e[n]instanceof Fw){r=!0;break}}if(r){t.style.display="block";var o=[],a=[],s=[],l=[];if(this.nodes=e.filter((function(e){return e instanceof Fw})),this.nodes.forEach((function(e){var t=e.computedStyle,r=t.hueRotate,n=t.saturate,i=t.brightness,c=t.contrast;o.includes(r)||o.push(r),a.includes(n)||a.push(n),s.includes(i)||s.push(i),l.includes(c)||l.push(c)})),o.length>1)this.hueRotateRange.value="0",this.hueRotateRange.style.setProperty("--p","50"),this.hueRotateNumber.value="",this.hueRotateNumber.placeholder="多个";else{var c=(u=Math.round(o[0]||0)).toString();this.hueRotateRange.value=c,this.hueRotateRange.style.setProperty("--p",(100*(u+180)/360).toString()),this.hueRotateNumber.value=c,this.hueRotateNumber.placeholder=""}if(a.length>1)this.saturateRange.value="0",this.saturateRange.style.setProperty("--p","50"),this.saturateNumber.value="",this.saturateNumber.placeholder="多个";else{c=(u=Math.round(100*(a[0]||0)-100)).toString();this.saturateRange.value=c,this.saturateRange.style.setProperty("--p",(.5*(u+100)).toString()),this.saturateNumber.value=c,this.saturateNumber.placeholder=""}if(s.length>1)this.brightnessRange.value="0",this.brightnessRange.style.setProperty("--p","50"),this.brightnessNumber.value="",this.brightnessNumber.placeholder="多个";else{c=(u=Math.round(100*(s[0]||0)-100)).toString();this.brightnessRange.value=c,this.brightnessRange.style.setProperty("--p",(.5*(u+100)).toString()),this.brightnessNumber.value=c,this.brightnessNumber.placeholder=""}if(l.length>1)this.contrastRange.value="0",this.contrastRange.style.setProperty("--p","50"),this.contrastNumber.value="",this.contrastNumber.placeholder="多个";else{var u=100*(l[0]||0)-100;c=Math.round(u>0?u/3:u).toString();this.contrastRange.value=c,u>0?this.contrastRange.style.setProperty("--p",(u/3*.5+50).toString()):this.contrastRange.style.setProperty("--p",(.5*(u+100)).toString()),this.contrastNumber.value=c,this.contrastNumber.placeholder=""}}else t.style.display="none"},t}(vT),LT=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=document.createElement("select");n.innerHTML='\n      <option value="" disabled="disabled">请选择</option>\n      <option value="up">放大</option>\n      <option value="down">缩小</option>\n      <option value="actual">实际尺寸</option>\n      <option value="fit">适应画布</option>\n    ',n.selectedIndex=-1,t.appendChild(n);var i=document.createElement("div");i.innerText=Ff(100*e.getCurPageZoom(!0),0).toString()+"%",t.appendChild(i),n.addEventListener("change",(function(e){"up"===n.value?r.zoom(2):"down"===n.value?r.zoom(.5):"actual"===n.value?r.zoomActual():"fit"===n.value&&r.zoomFit(),n.value=""})),r.on(dT.ZOOM_PAGE,(function(e){i.innerText=Ff(100*e,0).toString()+"%"}))},RT=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=document.createElement("div");n.className="sel item active",n.innerHTML='\n<div class="ti" title="select"><b class="select"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="select" class="cur"><b class="select"></b><span class="name">选择</span><span class="key">V</span></li>\n  <li title="hand"><b class="hand"></b><span class="name">平移画布</span><span class="key">H</span></li>\n</ul>\n',t.appendChild(n);var i=document.createElement("div");i.className="geom item",i.innerHTML='\n<div class="ti" title="square"><b class="square"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="square"><b class="square"></b><span class="name">矩形</span><span class="key">R</span></li>\n  <li title="ellipse"><b class="ellipse"></b><span class="name">椭圆形</span><span class="key">O</span></li>\n  <li title="line"><b class="line"></b><span class="name">直线</span><span class="key">L</span></li>\n  <li title="arrow"><b class="arrow"></b><span class="name">箭头</span></li>\n  <li title="star"><b class="star"></b><span class="name">星形</span></li>\n  <li class="split"></li>\n  <li title="pen"><b class="pen"></b><span class="name">钢笔</span><span class="key">P</span></li>\n</ul>\n';var o=document.createElement("div");o.className="text item",o.innerHTML='<div class="ti" title="text"><b class="text"></b></div>',t.appendChild(o);var a=document.createElement("div");a.className="img item",a.innerHTML='<div class="ti" title="image"><b class="image"></b></div>';var s=document.createElement("div");s.className="mask item",s.innerHTML='\n<div class="ti disable" title="alpha"><b class="alpha"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="alpha" class="disable"><b class="alpha"></b><span class="name">透明度蒙版</span><span class="key">⌃</span><span class="key">⌘</span><span class="key">M</span></li>\n  <li title="outline" class="disable"><b class="outline"></b><span class="name">轮廓蒙版</span></li>\n</ul>\n';var l=document.createElement("div");l.className="bool item",l.innerHTML='\n<div class="ti disable readonly" title="union"><b class="union"></b></div>\n<div class="drop"></div>\n<ul class="sub">\n  <li title="union" class="disable readonly"><b class="union"></b><span class="name">联集</span></li>\n  <li title="subtract" class="disable readonly"><b class="subtract"></b><span class="name">减去顶层</span></li>\n  <li title="intersect" class="disable readonly"><b class="intersect"></b><span class="name">交集</span></li>\n  <li title="xor" class="disable readonly"><b class="xor"></b><span class="name">差集</span></li>\n  <li class="split"></li>\n  <li title="flatten" class="disable readonly"><b class="flatten"></b><span class="name">路径合并</span></li>\n</ul>\n',t.appendChild(l);var c=!1;t.addEventListener("click",(function(e){var n,i,o,a=e.target,s=a.tagName.toUpperCase(),l=a.classList;if(l.contains("drop"))return(h=a.parentElement).classList.contains("show")?h.classList.remove("show"):(null===(n=t.querySelector(".show"))||void 0===n||n.classList.remove("show"),h.classList.add("show")),void(c=!0);if(l.contains("name")||l.contains("key")?(s="LI",l=(a=a.parentElement).classList):"B"===s&&(s=(a=a.parentElement).tagName.toUpperCase(),l=a.classList),"DIV"===s&&a.parentElement.classList.contains("active")||l.contains("cur"))c=!0;else if(l.contains("disable")||a.parentElement.classList.contains("disable"))c=!0;else{l.contains("item")&&(s=(a=a.querySelector("div")).tagName.toUpperCase(),l=a.classList);var u="";if(l.contains("readonly")||(null===(i=t.querySelector(".active"))||void 0===i||i.classList.remove("active"),null===(o=t.querySelector(".cur"))||void 0===o||o.classList.remove("cur")),"DIV"===s){u=a.title;var h=a.parentElement;l.contains("readonly")||h.classList.add("active")}else if("LI"===s&&(u=a.title,h=a.parentElement.parentElement,!l.contains("readonly"))){l.add("cur"),h.classList.add("active");var d=h.querySelector(".ti");d.title=u,d.querySelector("b").className=u}console.log(u),r.dom.classList.remove("hand"),r.dom.classList.remove("text");var f=r.state;"select"===u?r.state=yA.NORMAL:"hand"===u?(r.state=yA.HAND,r.dom.classList.add("hand")):"text"===u?(r.state=yA.ADD_TEXT,r.dom.classList.add("text")):"union"===u||"subtract"===u||"intersect"===u||"xor"===u?(r.state=yA.NORMAL,r.boolGroup(u)):"flatten"===u&&(r.state=yA.NORMAL,r.flatten()),f!==r.state&&r.emit(dT.STATE_CHANGE,f,r.state)}})),document.addEventListener("click",(function(e){var r;c?c=!1:null===(r=t.querySelector(".show"))||void 0===r||r.classList.remove("show")})),r.on(dT.STATE_CHANGE,(function(e,r){var n,i,o,a,s;if(r===yA.NORMAL){null===(n=t.querySelector(".active"))||void 0===n||n.classList.remove("active"),null===(i=t.querySelector(".sel.item"))||void 0===i||i.classList.add("active"),null===(o=t.querySelector(".sel.item .ti"))||void 0===o||o.setAttribute("title","select");var l=t.querySelector(".sel.item .ti b");l&&(l.className="select"),null===(a=t.querySelector(".sel.item li.cur"))||void 0===a||a.classList.remove("cur"),null===(s=t.querySelector('.sel.item li[title="select"]'))||void 0===s||s.classList.add("cur")}})),r.on(dT.SELECT_NODE,(function(e){for(var t,r,n=0,i=0,o=!1,a=0,s=e.length;a<s;a++){var c=e[a];if(c instanceof Jw)n++;else{if(!(c instanceof rC))break;i++,o||(o=IT(c))}}n>1&&n===e.length?l.querySelectorAll(".disable").forEach((function(e){e.classList.remove("disable")})):l.querySelectorAll(".ti, li[title]").forEach((function(e){e.classList.add("disable")})),i&&i===e.length&&o?null===(t=l.querySelector('li[title="flatten"]'))||void 0===t||t.classList.remove("disable"):null===(r=l.querySelector('li[title="flatten"]'))||void 0===r||r.classList.add("disable")}))};function IT(e){var t=function(e){for(var r=!1,n=0,i=e.length;n<i;n++){var o=e[n];if(o.computedStyle.booleanOperation!==qu.NONE){r=!0;break}if(o instanceof rC&&(r=t(o.children)))break}return r};return t(e.children)}var PT={initCanvasControl:function(e,t,r){return new dT(e,t,r)},initPageList:function(e,t,r){return new AT(e,t,r)},initTree:function(e,t,r){return new pT(e,t,r)},initPanel:function(e,t,r){var n=new CT(e,t,r);n.show(r.selected);var i=new gT(e,t,r);i.show(r.selected);var o=new mT(e,t,r);o.show(r.selected),new bT(e,t,r).show();var a=new xT(e,t,r);a.show(r.selected);var s=new ET(e,t,r);s.show(r.selected);var l=new ST(e,t,r);l.show(r.selected);var c=new TT(e,t,r);c.show(r.selected);var u=new MT(e,t,r);u.show(r.selected);var h=new kT(e,t,r);return h.show(r.selected),{alignPanel:n,basicPanel:i,opacityPanel:o,fillPanel:a,strokePanel:s,textPanel:l,shadowPanel:c,blurPanel:u,colorAdjustPanel:h}},initZoom:function(e,t,r){return new LT(e,t,r)},initToolbar:function(e,t,r){return new RT(e,t,r)},Listener:dT,PageList:AT,Tree:pT,Select:cA,Input:bA,Panel:vT,BasicPanel:gT,OpacityPanel:mT,PointPanel:bT,FillPanel:xT,StrokePanel:ET,TextPanel:ST,ShadowPanel:TT,BlurPanel:MT,AlignPanel:CT,ColorAdjustPanel:kT,Zoom:LT,picker:EA,contextMenu:OA,Guides:JA,state:yA},FT=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.prevs=r,i.nexts=n,i}return p(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.nexts;e.forEach((function(e,r){e.updateFormatStyle(t[r])}))},t.prototype.undo=function(){var e=this.nodes,t=this.prevs;e.forEach((function(e,r){e.updateFormatStyle(t[r])}))},t}(gA),DT={ca:VS},NT={version:SA,parse:function(e,t){var r,n,i,o;void 0===t&&(t={});var l=t.width,c=void 0===l?0:l,u=t.height,h=void 0===u?0:u,d=t.dpi,f=void 0===d?1:d,p=t.canvas,v={width:c,height:h};(!c||c<1)&&(v.width="auto"),(!h||h<1)&&(v.height="auto");var y=new FC.Root({dpi:f,uuid:(null===(r=e.document)||void 0===r?void 0:r.uuid)||a(),index:0,assets:null===(n=e.document)||void 0===n?void 0:n.assets,layerStyles:null===(i=e.document)||void 0===i?void 0:i.layerStyles,layerTextStyles:null===(o=e.document)||void 0===o?void 0:o.layerTextStyles,style:v,contextAttributes:Object.assign({},DT.ca,t.contextAttributes)});p&&y.appendTo(p);var g=[];return(e.pages||[]).forEach((function(e){e.children.forEach((function(e){e.tagName===s.SYMBOL_MASTER&&g.push(e)}))})),(e.symbolMasters||[]).forEach((function(e){g.push(e)})),a_(g).forEach((function(e){y.symbolMasters[e.props.symbolId]=o_(e,y)})),y.setJPages(e.pages||[]),y.setPageIndex(e.currentPageIndex||0),y},openAndConvertSketchBuffer:function(e){return Z(this,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return[4,yu.loadAsync(e)];case 1:return[2,pp(t.sent())]}}))}))},openAndConvertSketchZip:pp,convertSketch:yp,openAndConvertPsdBuffer:function(e){return Z(this,void 0,void 0,(function(){var t,r,n,i,o,u,h,d,f,p,v,y;return J(this,(function(g){switch(g.label){case 0:if(t=function(e,t){return wb("buffer"in e?Jm(e.buffer,e.byteOffset,e.byteLength):Jm(e),t)}(e,{useImageData:!1}),r=[],n={tagName:s.ART_BOARD,props:{uuid:a(),name:"画板",style:{width:t.width,height:t.height},isExpanded:!0},children:r},i={tagName:s.PAGE,props:{uuid:a(),name:"页面 1",index:0,rule:{baseX:0,baseY:0},style:{width:l,height:c,visibility:"hidden",scaleX:.5,scaleY:.5,transformOrigin:[0,0],pointerEvents:!1}},children:[n]},!t.children)return[3,7];o=0,u=t.children.length,g.label=1;case 1:return o<u?[4,HE(h=t.children[o],t.width,t.height)]:[3,6];case 2:return(d=g.sent())?h.mask?[4,jE(h,t.width,t.height)]:[3,4]:[3,5];case 3:(v=g.sent())&&(d=WE(d,v)),h.clipping||(d.props.style.breakMask=!0),g.label=4;case 4:if(h.clipping&&r.length)for(f=o-1;f>=0;f--)if(!t.children[f].clipping){p=o-f,(v=r[r.length-p]).props.style.maskMode="alpha-with";break}r.push(d),g.label=5;case 5:return o++,[3,1];case 6:return[3,9];case 7:return t.canvas?[4,new Promise((function(e){t.canvas.toBlob((function(t){if(t)return e({tagName:s.BITMAP,props:{uuid:a(),name:"截图",style:{left:"0%",top:"0%",right:"0%",bottom:"0%"},src:URL.createObjectURL(t)}});e(void 0)}))}))]:[3,9];case 8:(y=g.sent())&&r.push(y),g.label=9;case 9:return[2,{pages:[i],currentPageIndex:0}]}}))}))},node:FC,refresh:LC,style:RC,math:Df,util:IC,animation:PC,tools:lA,config:bu,control:PT,history:{History:PA,AbstractCommand:gA,MoveCommand:MA,ResizeCommand:LA,AddCommand:QA,RemoveCommand:FA,RotateCommand:DA,BlurCommand:zA,ShadowCommand:UA,ColorAdjustCommand:GA,FillCommand:XA,MaskModeCommand:jA,BreakMaskCommand:WA,VisibleCommand:ZA,UpdateStyleCommand:kA,UpdateFormatStyleCommand:FT,RichCommand:IA,TextCommand:mA,GroupCommand:YA,UnGroupCommand:qA,RenameCommand:VA,LockCommand:KA,ConstrainProportionCommand:yT,PointCommand:nT,BoolGroupCommand:cT,FlattenCommand:uT},gl:DT,format:d};return NT}));
//# sourceMappingURL=index.min.js.map
