!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("stream"),require("util")):"function"==typeof define&&define.amd?define(["stream","util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).sketchEditor=t(e.require$$0,e.require$$1)}(this,(function(e,t){"use strict";let r;const n=new Uint8Array(16);function i(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(n)}const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));var a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function s(e,t,r){if(a.randomUUID&&!t&&!e)return a.randomUUID();const n=(e=e||{}).random||(e.rng||i)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}(n)}var l,u=100,c=100,h={left:0,top:0,right:"auto",bottom:"auto",width:"auto",height:"auto",lineHeight:"normal",fontFamily:"arial",fontSize:16,fontWeight:400,fontStyle:"normal",visibility:"visible",backgroundColor:[0,0,0,0],color:[0,0,0,1],opacity:1,fill:[],fillOpacity:[],fillEnable:[],fillMode:[],fillRule:"nonzero",stroke:[],strokeEnable:[],strokeWidth:[],strokePosition:[],strokeMode:[],strokeDasharray:[],strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:0,letterSpacing:0,paragraphSpacing:0,textAlign:"left",textVerticalAlign:"top",textDecoration:[],translateX:0,translateY:0,scaleX:1,scaleY:1,rotateZ:0,transformOrigin:["center","center"],booleanOperation:"none",mixBlendMode:"normal",pointerEvents:!0,maskMode:"none",breakMask:!1,blur:"none",shadow:[],shadowEnable:[],innerShadow:[],innerShadowEnable:[],hueRotate:0,saturate:1,brightness:1,contrast:1};function d(e){return Object.assign({},h,e)}!function(e){e.PAGE="page",e.ART_BOARD="artBoard",e.SYMBOL_MASTER="symbolMaster",e.SYMBOL_INSTANCE="symbolInstance",e.GROUP="group",e.BITMAP="bitmap",e.TEXT="text",e.SLICE="slice",e.SHAPE_GROUP="$shapeGroup",e.POLYLINE="$polyline"}(l||(l={}));var f={TAG_NAME:l,getDefaultStyle:d},p=function(e,t){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},p(e,t)};function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var g,m,y,b,x,w,_,E,S,C,k,T,A,M,O,L,R,I,F,P,D,N,B,U,z,X,H,G,j,Y,W,V,q,K,Z=function(){return Z=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Z.apply(this,arguments)};function J(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function Q(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}"function"==typeof SuppressedError&&SuppressedError,function(e){e[e.Linear=0]="Linear",e[e.Radial=1]="Radial",e[e.Angular=2]="Angular"}(g||(g={})),function(e){e[e.Unmanaged=0]="Unmanaged",e[e.SRGB=1]="SRGB",e[e.P3=2]="P3"}(m||(m={})),function(e){e[e.Color=0]="Color",e[e.Gradient=1]="Gradient",e[e.Pattern=4]="Pattern"}(y||(y={})),function(e){e[e.Center=0]="Center",e[e.Inside=1]="Inside",e[e.Outside=2]="Outside"}(b||(b={})),function(e){e[e.Normal=0]="Normal",e[e.Darken=1]="Darken",e[e.Multiply=2]="Multiply",e[e.ColorBurn=3]="ColorBurn",e[e.Lighten=4]="Lighten",e[e.Screen=5]="Screen",e[e.ColorDodge=6]="ColorDodge",e[e.Overlay=7]="Overlay",e[e.SoftLight=8]="SoftLight",e[e.HardLight=9]="HardLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e[e.PlusDarker=16]="PlusDarker",e[e.PlusLighter=17]="PlusLighter"}(x||(x={})),function(e){e[e.Butt=0]="Butt",e[e.Round=1]="Round",e[e.Projecting=2]="Projecting"}(w||(w={})),function(e){e[e.Miter=0]="Miter",e[e.Round=1]="Round",e[e.Bevel=2]="Bevel"}(_||(_={})),function(e){e[e.Gaussian=0]="Gaussian",e[e.Motion=1]="Motion",e[e.Zoom=2]="Zoom",e[e.Background=3]="Background"}(E||(E={})),function(e){e[e.Tile=0]="Tile",e[e.Fill=1]="Fill",e[e.Stretch=2]="Stretch",e[e.Fit=3]="Fit"}(S||(S={})),function(e){e[e.OpenArrow=0]="OpenArrow",e[e.FilledArrow=1]="FilledArrow",e[e.Line=2]="Line",e[e.OpenCircle=3]="OpenCircle",e[e.FilledCircle=4]="FilledCircle",e[e.OpenSquare=5]="OpenSquare",e[e.FilledSquare=6]="FilledSquare"}(C||(C={})),function(e){e[e.NonZero=0]="NonZero",e[e.EvenOdd=1]="EvenOdd"}(k||(k={})),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(T||(T={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Centered=2]="Centered",e[e.Justified=3]="Justified",e[e.Natural=4]="Natural"}(A||(A={})),function(e){e[e.None=0]="None",e[e.Uppercase=1]="Uppercase",e[e.Lowercase=2]="Lowercase"}(M||(M={})),function(e){e[e.None=0]="None",e[e.Underlined=1]="Underlined"}(O||(O={})),function(e){e[e.None=0]="None",e[e.Strikethrough=1]="Strikethrough"}(L||(L={})),function(e){e[e.None=-1]="None",e[e.Union=0]="Union",e[e.Subtract=1]="Subtract",e[e.Intersection=2]="Intersection",e[e.Difference=3]="Difference"}(R||(R={})),function(e){e.PNG="png",e.JPG="jpg",e.TIFF="tiff",e.EPS="eps",e.PDF="pdf",e.WEBP="webp",e.SVG="svg"}(I||(I={})),function(e){e[e.Suffix=0]="Suffix",e[e.SecondaryPrefix=1]="SecondaryPrefix",e[e.PrimaryPrefix=2]="PrimaryPrefix"}(F||(F={})),function(e){e[e.Scale=0]="Scale",e[e.Width=1]="Width",e[e.Height=2]="Height"}(P||(P={})),function(e){e[e.None=0]="None",e[e.SlideFromLeft=1]="SlideFromLeft",e[e.SlideFromRight=2]="SlideFromRight",e[e.SlideFromBottom=3]="SlideFromBottom",e[e.SlideFromTop=4]="SlideFromTop"}(D||(D={})),function(e){e[e.Undecided=0]="Undecided",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"}(N||(N={})),function(e){e[e.Stretch=0]="Stretch",e[e.PinToEdge=1]="PinToEdge",e[e.Resize=2]="Resize",e[e.Float=3]="Float"}(B||(B={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(U||(U={})),function(e){e[e.Min=0]="Min",e[e.Middle=1]="Middle",e[e.Max=2]="Max"}(z||(z={})),function(e){e[e.Disabled=-1]="Disabled",e[e.Legacy=0]="Legacy",e[e.Rounded=1]="Rounded",e[e.Smooth=2]="Smooth"}(X||(X={})),function(e){e[e.Rounded=0]="Rounded",e[e.RoundedInverted=1]="RoundedInverted",e[e.Angled=2]="Angled",e[e.Squared=3]="Squared"}(H||(H={})),function(e){e[e.None=0]="None",e[e.Straight=1]="Straight",e[e.Mirrored=2]="Mirrored",e[e.Asymmetric=3]="Asymmetric",e[e.Disconnected=4]="Disconnected"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Legacy=1]="Legacy",e[e.ConsistentBaseline=2]="ConsistentBaseline"}(j||(j={})),function(e){e[e.Flexible=0]="Flexible",e[e.Fixed=1]="Fixed",e[e.FixedWidthAndHeight=2]="FixedWidthAndHeight"}(Y||(Y={})),function(e){e[e.Local=0]="Local",e[e.Workspace=1]="Workspace",e[e.ThirdParty=2]="ThirdParty"}(W||(W={})),function(e){e.PublicRelease="com.bohemiancoding.sketch3",e.Beta="com.bohemiancoding.sketch3.beta",e.Private="com.bohemiancoding.sketch3.private",e.FeaturePreview="com.bohemiancoding.sketch3.feature-preview",e.Internal="com.bohemiancoding.sketch3.internal",e.Experimental="com.bohemiancoding.sketch3.experimental",e.Testing="com.bohemiancoding.sketch3.testing"}(V||(V={})),function(e){e[e.True=0]="True",e[e.False=1]="False"}(q||(q={})),function(e){e.MSImmutableColorAsset="MSImmutableColorAsset",e.MSImmutableDocumentLibraryInfo="MSImmutableDocumentLibraryInfo",e.MSImmutableFlowConnection="MSImmutableFlowConnection",e.MSImmutableForeignLayerStyle="MSImmutableForeignLayerStyle",e.MSImmutableForeignSwatch="MSImmutableForeignSwatch",e.MSImmutableForeignSymbol="MSImmutableForeignSymbol",e.MSImmutableForeignTextStyle="MSImmutableForeignTextStyle",e.MSImmutableFreeformGroupLayout="MSImmutableFreeformGroupLayout",e.MSImmutableGradientAsset="MSImmutableGradientAsset",e.MSImmutableHotspotLayer="MSImmutableHotspotLayer",e.MSImmutableInferredGroupLayout="MSImmutableInferredGroupLayout",e.MSImmutableOverrideProperty="MSImmutableOverrideProperty",e.MSImmutablePatchInfo="MSImmutablePatchInfo",e.MSImmutablePrototypeViewport="MSImmutablePrototypeViewport",e.MSJSONFileReference="MSJSONFileReference",e.MSJSONOriginalDataReference="MSJSONOriginalDataReference",e.Artboard="artboard",e.AssetCollection="assetCollection",e.AttributedString="attributedString",e.Bitmap="bitmap",e.Blur="blur",e.Border="border",e.BorderOptions="borderOptions",e.Color="color",e.ColorControls="colorControls",e.CurvePoint="curvePoint",e.ExportFormat="exportFormat",e.ExportOptions="exportOptions",e.Fill="fill",e.FontDescriptor="fontDescriptor",e.FontReference="fontReference",e.Gradient="gradient",e.GradientStop="gradientStop",e.GraphicsContextSettings="graphicsContextSettings",e.Group="group",e.ImageCollection="imageCollection",e.InnerShadow="innerShadow",e.LayoutGrid="layoutGrid",e.Oval="oval",e.OverrideValue="overrideValue",e.Page="page",e.ParagraphStyle="paragraphStyle",e.Polygon="polygon",e.Rect="rect",e.Rectangle="rectangle",e.RulerData="rulerData",e.Shadow="shadow",e.ShapeGroup="shapeGroup",e.ShapePath="shapePath",e.SharedStyle="sharedStyle",e.SharedStyleContainer="sharedStyleContainer",e.SharedTextStyleContainer="sharedTextStyleContainer",e.SimpleGrid="simpleGrid",e.Slice="slice",e.Star="star",e.StringAttribute="stringAttribute",e.Style="style",e.Swatch="swatch",e.SwatchContainer="swatchContainer",e.SymbolContainer="symbolContainer",e.SymbolInstance="symbolInstance",e.SymbolMaster="symbolMaster",e.Text="text",e.TextStyle="textStyle",e.Triangle="triangle"}(K||(K={}));var $=Object.freeze({__proto__:null,get AnimationType(){return D},get BlendMode(){return x},get BlurType(){return E},get BooleanOperation(){return R},get BorderPosition(){return b},get BundleId(){return V},get ClassValue(){return K},get ColorSpace(){return m},get CornerStyle(){return H},get CurveMode(){return G},get DocumentLibraryType(){return W},get ExportFileFormat(){return I},get ExportFormatNamingScheme(){return F},get FillType(){return y},get GradientType(){return g},get InferredLayoutAnchor(){return z},get InferredLayoutAxis(){return U},get LayerListExpanded(){return N},get LineCapStyle(){return w},get LineJoinStyle(){return _},get LineSpacingBehaviour(){return j},get MarkerType(){return C},get NumericalBool(){return q},get PatternFillType(){return S},get PointsRadiusBehaviour(){return X},get ResizeType(){return B},get StrikethroughStyle(){return L},get TextBehaviour(){return Y},get TextHorizontalAlignment(){return A},get TextTransform(){return M},get TextVerticalAlignment(){return T},get UnderlineStyle(){return O},get VisibleScaleType(){return P},get WindingRule(){return k}}),ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function te(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var re,ne,ie,oe={},ae={},se={},le={exports:{}},ue={exports:{}};function ce(){if(re)return ue.exports;return re=1,"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?ue.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,a=arguments.length;switch(a){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function(){e.call(null,t)}));case 3:return process.nextTick((function(){e.call(null,t,r)}));case 4:return process.nextTick((function(){e.call(null,t,r,n)}));default:for(i=new Array(a-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick((function(){e.apply(null,i)}))}}}:ue.exports=process,ue.exports}var he,de,fe,pe={exports:{}};function ve(){if(he)return pe.exports;he=1;var e,t="object"==typeof Reflect?Reflect:null,r=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}pe.exports=i,pe.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}p(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,r)}(e,i,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,o,l,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),l=o[t]),void 0===l)l=o[t]=r,++e._eventsCount;else if("function"==typeof l?l=o[t]=n?[r,l]:[l,r]:n?l.unshift(r):l.push(r),(i=s(e))>0&&l.length>i&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=l.length,u=c,console&&console.warn&&console.warn(u)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var u=l.length,c=f(l,u);for(n=0;n<u;++n)r(c[n],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,c(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,c(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},pe.exports}function ge(){return fe?de:(fe=1,de=e)}for(var me={exports:{}},ye={},be={byteLength:function(e){var t=Te(e),r=t[0],n=t[1];return 3*(r+n)/4-n}},xe=be.toByteArray=function(e){var t,r,n=Te(e),i=n[0],o=n[1],a=new Se(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=Ee[e.charCodeAt(r)]<<18|Ee[e.charCodeAt(r+1)]<<12|Ee[e.charCodeAt(r+2)]<<6|Ee[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=Ee[e.charCodeAt(r)]<<2|Ee[e.charCodeAt(r+1)]>>4,a[s++]=255&t);1===o&&(t=Ee[e.charCodeAt(r)]<<10|Ee[e.charCodeAt(r+1)]<<4|Ee[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},we=be.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(Ae(e,a,a+o>s?s:a+o));1===n?(t=e[r-1],i.push(_e[t>>2]+_e[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(_e[t>>10]+_e[t>>4&63]+_e[t<<2&63]+"="));return i.join("")},_e=[],Ee=[],Se="undefined"!=typeof Uint8Array?Uint8Array:Array,Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ke=0;ke<64;++ke)_e[ke]=Ce[ke],Ee[Ce.charCodeAt(ke)]=ke;function Te(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Ae(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(_e[(i=n)>>18&63]+_e[i>>12&63]+_e[i>>6&63]+_e[63&i]);return o.join("")}Ee["-".charCodeAt(0)]=62,Ee["_".charCodeAt(0)]=63;var Me,Oe,Le,Re={};
  /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ie(){return Oe||(Oe=1,function(e){var t=be,r=(Me||(Me=1,Re.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+e[t+h],h+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=d,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=u}return(f?-1:1)*a*Math.pow(2,o-n)},Re.write=function(e,t,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+f]=255&a,f+=p,a/=256,u-=8);e[r+f-p]|=128*v}),Re),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return s(e,t,r)}function s(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|f(e,t),n=o(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(U(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return c(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(U(e,ArrayBuffer)||e&&U(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(U(e,SharedArrayBuffer)||e&&U(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=function(e){if(a.isBuffer(e)){var t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||z(e.length)?o(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),o(e<0?0:0|d(e))}function c(e){for(var t=e.length<0?0:0|d(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,a.prototype),n}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||U(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(i)return n?-1:D(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return k(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=r;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(u(e,o+d)!==u(t,d)){h=!1;break}if(h)return o}return-1}function y(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(z(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return B(D(t,e.length-r),e,r,n)}function x(e,t,r,n){return B(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return B(N(t),e,r,n)}function _(e,t,r,n){return B(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function E(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function S(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,u=e[i],c=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),U(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(U(o,Uint8Array))i+o.length>n.length?a.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),l=Math.min(o,s),u=this.slice(n,i),c=e.slice(t,r),h=0;h<l;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return x(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function k(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function A(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=X[e[o]];return i}function M(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(e,t,n,i,o){return t=+t,n>>>=0,o||R(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function F(e,t,n,i,o){return t=+t,n>>>=0,o||R(e,0,n,8),r.write(e,t,n,i,52,8),n+8}a.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),r.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return F(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return F(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%l]}return this};var P=/[^+/0-9A-Za-z-_]/g;function D(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function N(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function U(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function z(e){return e!=e}var X=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()}(ye)),ye}function Fe(){return Le||(Le=1,function(e,t){var r=Ie(),n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(me,me.exports)),me.exports}var Pe,De={};function Ne(){if(Pe)return De;function e(e){return Object.prototype.toString.call(e)}return Pe=1,De.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},De.isBoolean=function(e){return"boolean"==typeof e},De.isNull=function(e){return null===e},De.isNullOrUndefined=function(e){return null==e},De.isNumber=function(e){return"number"==typeof e},De.isString=function(e){return"string"==typeof e},De.isSymbol=function(e){return"symbol"==typeof e},De.isUndefined=function(e){return void 0===e},De.isRegExp=function(t){return"[object RegExp]"===e(t)},De.isObject=function(e){return"object"==typeof e&&null!==e},De.isDate=function(t){return"[object Date]"===e(t)},De.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},De.isFunction=function(e){return"function"==typeof e},De.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},De.isBuffer=Ie().Buffer.isBuffer,De}var Be,Ue,ze={exports:{}},Xe={exports:{}};function He(){if(Ue)return ze.exports;Ue=1;try{var e=require("util");if("function"!=typeof e.inherits)throw"";ze.exports=e.inherits}catch(e){ze.exports=(Be||(Be=1,"function"==typeof Object.create?Xe.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Xe.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),Xe.exports)}return ze.exports}var Ge,je,Ye,We,Ve,qe,Ke,Ze,Je,Qe={exports:{}};function $e(){return Ge||(Ge=1,function(e){var r=Fe().Buffer,n=t;e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);for(var t,n,i,o=r.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=o,i=s,t.copy(n,i),s+=a.data.length,a=a.next;return o},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})}(Qe)),Qe.exports}function et(){if(Ye)return je;Ye=1;var e=ce();function t(e,t){e.emit("error",t)}return je={destroy:function(r,n){var i=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(n?n(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(t,this,r)):e.nextTick(t,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,(function(r){!n&&r?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,e.nextTick(t,i,r)):e.nextTick(t,i,r):n&&n(r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},je}function tt(){if(Ke)return qe;Ke=1;var e=ce();function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}qe=p;var n,i=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:e.nextTick;p.WritableState=f;var o=Object.create(Ne());o.inherits=He();var a={deprecate:Ve?We:(Ve=1,We=t.deprecate)},s=ge(),l=Fe().Buffer,u=(void 0!==ee?ee:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,h=et();function d(){}function f(t,o){n=n||rt(),t=t||{};var a=o instanceof n;this.objectMode=!!t.objectMode,a&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var s=t.highWaterMark,l=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:a&&(l||0===l)?l:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,r){var n=t._writableState,o=n.sync,a=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),r)!function(t,r,n,i,o){--r.pendingcb,n?(e.nextTick(o,i),e.nextTick(x,t,r),t._writableState.errorEmitted=!0,t.emit("error",i)):(o(i),t._writableState.errorEmitted=!0,t.emit("error",i),x(t,r))}(t,n,o,r,a);else{var s=y(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||m(t,n),o?i(g,t,n,s,a):g(t,n,s,a)}}(o,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function p(e){if(n=n||rt(),!(c.call(p,this)||this instanceof n))return new p(e);this._writableState=new f(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function v(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function g(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),x(e,t)}function m(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,v(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,c=n.encoding,h=n.callback;if(v(e,t,!1,t.objectMode?1:u.length,u,c,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function y(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),x(e,t)}))}function x(t,r){var n=y(r);return n&&(!function(t,r){r.prefinished||r.finalCalled||("function"==typeof t._final?(r.pendingcb++,r.finalCalled=!0,e.nextTick(b,t,r)):(r.prefinished=!0,t.emit("prefinish")))}(t,r),0===r.pendingcb&&(r.finished=!0,t.emit("finish"))),n}return o.inherits(p,s),f.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(f.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(p,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===p&&(e&&e._writableState instanceof f)}})):c=function(e){return e instanceof this},p.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},p.prototype.write=function(t,r,n){var i,o=this._writableState,a=!1,s=!o.objectMode&&(i=t,l.isBuffer(i)||i instanceof u);return s&&!l.isBuffer(t)&&(t=function(e){return l.from(e)}(t)),"function"==typeof r&&(n=r,r=null),s?r="buffer":r||(r=o.defaultEncoding),"function"!=typeof n&&(n=d),o.ended?function(t,r){var n=new Error("write after end");t.emit("error",n),e.nextTick(r,n)}(this,n):(s||function(t,r,n,i){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||r.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),e.nextTick(i,a),o=!1),o}(this,o,t,n))&&(o.pendingcb++,a=function(e,t,r,n,i,o){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var s=t.objectMode?1:n.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,s,n,i,o);return u}(this,o,s,t,r,n)),a},p.prototype.cork=function(){this._writableState.corked++},p.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||m(this,e))},p.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),p.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},p.prototype._writev=null,p.prototype.end=function(t,r,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,r=null):"function"==typeof r&&(n=r,r=null),null!=t&&this.write(t,r),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,r,n){r.ending=!0,x(t,r),n&&(r.finished?e.nextTick(n):t.once("finish",n));r.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(p.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),p.prototype.destroy=h.destroy,p.prototype._undestroy=h.undestroy,p.prototype._destroy=function(e,t){this.end(),t(e)},qe}function rt(){if(Je)return Ze;Je=1;var e=ce(),t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};Ze=l;var r=Object.create(Ne());r.inherits=He();var n=ft(),i=tt();r.inherits(l,n);for(var o=t(i.prototype),a=0;a<o.length;a++){var s=o[a];l.prototype[s]||(l.prototype[s]=i.prototype[s])}function l(e){if(!(this instanceof l))return new l(e);n.call(this,e),i.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",u)}function u(){this.allowHalfOpen||this._writableState.ended||e.nextTick(c,this)}function c(e){e.end()}return Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),l.prototype._destroy=function(t,r){this.push(null),this.end(),e.nextTick(r,t)},Ze}var nt,it,ot,at,st,lt,ut,ct,ht={};function dt(){if(nt)return ht;nt=1;var e=Fe().Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(r){var n;switch(this.encoding=function(r){var n=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(r);if("string"!=typeof n&&(e.isEncoding===t||!t(r)))throw new Error("Unknown encoding: "+r);return n||r}(r),this.encoding){case"utf16le":this.text=o,this.end=a,n=4;break;case"utf8":this.fillLast=i,n=4;break;case"base64":this.text=s,this.end=l,n=3;break;default:return this.write=u,void(this.end=c)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(n)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function o(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function a(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function s(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function u(e){return e.toString(this.encoding)}function c(e){return e&&e.length?this.write(e):""}return ht.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},r.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var o=n(t[i]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(e.lastNeed=o-2),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},ht}function ft(){if(ot)return it;ot=1;var e=ce();it=g;var r,n=function(){if(ie)return ne;ie=1;var e={}.toString;return ne=Array.isArray||function(t){return"[object Array]"==e.call(t)}}();g.ReadableState=v,ve().EventEmitter;var i=function(e,t){return e.listeners(t).length},o=ge(),a=Fe().Buffer,s=(void 0!==ee?ee:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l=Object.create(Ne());l.inherits=He();var u=t,c=void 0;c=u&&u.debuglog?u.debuglog("stream"):function(){};var h,d=$e(),f=et();l.inherits(g,o);var p=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var n=t instanceof(r=r||rt());this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=dt().StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function g(e){if(r=r||rt(),!(this instanceof g))return new g(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function m(e,t,r,n,i){var o,l=e._readableState;null===t?(l.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,w(e)}(e,l)):(i||(o=function(e,t){var r;n=t,a.isBuffer(n)||n instanceof s||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(l,t)),o?e.emit("error",o):l.objectMode||t&&t.length>0?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n?l.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):y(e,l,t,!0):l.ended?e.emit("error",new Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?y(e,l,t,!1):E(e,l)):y(e,l,t,!1))):n||(l.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(l)}function y(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),E(e,t)}Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),g.prototype.destroy=f.destroy,g.prototype._undestroy=f.undestroy,g.prototype._destroy=function(e,t){this.push(null),t(e)},g.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),r=!0),m(this,e,t,!1,r)},g.prototype.unshift=function(e){return m(this,e,null,!0,!1)},g.prototype.isPaused=function(){return!1===this._readableState.flowing},g.prototype.setEncoding=function(e){return h||(h=dt().StringDecoder),this._readableState.decoder=new h(e),this._readableState.encoding=e,this};var b=8388608;function x(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=b?e=b:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(t){var r=t._readableState;r.needReadable=!1,r.emittedReadable||(c("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?e.nextTick(_,t):_(t))}function _(e){c("emit readable"),e.emit("readable"),T(e)}function E(t,r){r.readingMore||(r.readingMore=!0,e.nextTick(S,t,r))}function S(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(c("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function C(e){c("readable nexttick read 0"),e.read(0)}function k(e,t){t.reading||(c("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),T(e),t.flowing&&!t.reading&&e.read(0)}function T(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=a.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function M(t){var r=t._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,e.nextTick(O,r,t))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}return g.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?M(this):w(this),null;if(0===(e=x(e,t))&&t.ended)return 0===t.length&&M(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=x(r,t))),null===(n=e>0?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&M(this)),null!==n&&this.emit("data",n),n},g.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},g.prototype.pipe=function(t,r){var o=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,c("pipe count=%d opts=%j",a.pipesCount,r);var s=(!r||!1!==r.end)&&t!==process.stdout&&t!==process.stderr?u:y;function l(e,r){c("onunpipe"),e===o&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),t.removeListener("close",g),t.removeListener("finish",m),t.removeListener("drain",h),t.removeListener("error",v),t.removeListener("unpipe",l),o.removeListener("end",u),o.removeListener("end",y),o.removeListener("data",p),d=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}function u(){c("onend"),t.end()}a.endEmitted?e.nextTick(s):o.once("end",s),t.on("unpipe",l);var h=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,T(e))}}(o);t.on("drain",h);var d=!1;var f=!1;function p(e){c("ondata"),f=!1,!1!==t.write(e)||f||((1===a.pipesCount&&a.pipes===t||a.pipesCount>1&&-1!==L(a.pipes,t))&&!d&&(c("false write response, pause",a.awaitDrain),a.awaitDrain++,f=!0),o.pause())}function v(e){c("onerror",e),y(),t.removeListener("error",v),0===i(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",m),y()}function m(){c("onfinish"),t.removeListener("close",g),y()}function y(){c("unpipe"),o.unpipe(t)}return o.on("data",p),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(t,"error",v),t.once("close",g),t.once("finish",m),t.emit("pipe",o),a.flowing||(c("pipe resume"),o.resume()),t},g.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=L(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},g.prototype.on=function(t,r){var n=o.prototype.on.call(this,t,r);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):e.nextTick(C,this))}return n},g.prototype.addListener=g.prototype.on,g.prototype.resume=function(){var t=this._readableState;return t.flowing||(c("resume"),t.flowing=!0,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(k,t,r))}(this,t)),this},g.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this},g.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<p.length;o++)e.on(p[o],this.emit.bind(this,p[o]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(g.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),g._fromList=A,it}function pt(){if(st)return at;st=1,at=n;var e=rt(),t=Object.create(Ne());function r(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(t){if(!(this instanceof n))return new n(t);e.call(this,t),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",i)}function i(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){o(e,t,r)})):o(this,null,null)}function o(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}return t.inherits=He(),t.inherits(n,e),n.prototype.push=function(t,r){return this._transformState.needTransform=!1,e.prototype.push.call(this,t,r)},n.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},n.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},n.prototype._destroy=function(t,r){var n=this;e.prototype._destroy.call(this,t,(function(e){r(e),n.emit("close")}))},at}function vt(){return ct||(ct=1,function(t,r){var n=e;"disable"===process.env.READABLE_STREAM&&n?(t.exports=n,(r=t.exports=n.Readable).Readable=n.Readable,r.Writable=n.Writable,r.Duplex=n.Duplex,r.Transform=n.Transform,r.PassThrough=n.PassThrough,r.Stream=n):((r=t.exports=ft()).Stream=n||r,r.Readable=r,r.Writable=tt(),r.Duplex=rt(),r.Transform=pt(),r.PassThrough=function(){if(ut)return lt;ut=1,lt=r;var e=pt(),t=Object.create(Ne());function r(t){if(!(this instanceof r))return new r(t);e.call(this,t)}return t.inherits=He(),t.inherits(r,e),r.prototype._transform=function(e,t,r){r(null,e)},lt}())}(le,le.exports)),le.exports}if(se.base64=!0,se.array=!0,se.string=!0,se.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,se.nodebuffer="undefined"!=typeof Buffer,se.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)se.blob=!1;else{var gt=new ArrayBuffer(0);try{se.blob=0===new Blob([gt],{type:"application/zip"}).size}catch(e){try{var mt=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);mt.append(gt),se.blob=0===mt.getBlob("application/zip").size}catch(e){se.blob=!1}}}try{se.nodestream=!!vt().Readable}catch(e){se.nodestream=!1}var yt,bt={};function xt(){if(yt)return bt;yt=1;var e=Mt(),t=se,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return bt.encode=function(t){for(var n,i,o,a,s,l,u,c=[],h=0,d=t.length,f=d,p="string"!==e.getTypeOf(t);h<t.length;)f=d-h,p?(n=t[h++],i=h<d?t[h++]:0,o=h<d?t[h++]:0):(n=t.charCodeAt(h++),i=h<d?t.charCodeAt(h++):0,o=h<d?t.charCodeAt(h++):0),a=n>>2,s=(3&n)<<4|i>>4,l=f>1?(15&i)<<2|o>>6:64,u=f>2?63&o:64,c.push(r.charAt(a)+r.charAt(s)+r.charAt(l)+r.charAt(u));return c.join("")},bt.decode=function(e){var n,i,o,a,s,l,u=0,c=0,h="data:";if(e.substr(0,5)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&f--,e.charAt(e.length-2)===r.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=t.uint8array?new Uint8Array(0|f):new Array(0|f);u<e.length;)n=r.indexOf(e.charAt(u++))<<2|(a=r.indexOf(e.charAt(u++)))>>4,i=(15&a)<<4|(s=r.indexOf(e.charAt(u++)))>>2,o=(3&s)<<6|(l=r.indexOf(e.charAt(u++))),d[c++]=n,64!==s&&(d[c++]=i),64!==l&&(d[c++]=o);return d},bt}var wt,_t,Et,St,Ct={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}};var kt=null;kt="undefined"!=typeof Promise?Promise:function(){if(St)return Et;St=1;var e=function(){if(_t)return wt;_t=1;var e,t,r=ee.MutationObserver||ee.WebKitMutationObserver;if(process.browser)if(r){var n=0,i=new r(l),o=ee.document.createTextNode("");i.observe(o,{characterData:!0}),e=function(){o.data=n=++n%2}}else if(ee.setImmediate||void 0===ee.MessageChannel)e="document"in ee&&"onreadystatechange"in ee.document.createElement("script")?function(){var e=ee.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},ee.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var a=new ee.MessageChannel;a.port1.onmessage=l,e=function(){a.port2.postMessage(0)}}else e=function(){process.nextTick(l)};var s=[];function l(){var e,r;t=!0;for(var n=s.length;n;){for(r=s,s=[],e=-1;++e<n;)r[e]();n=s.length}t=!1}return wt=function(r){1!==s.push(r)||t||e()}}();function t(){}var r={},n=["REJECTED"],i=["FULFILLED"],o=["PENDING"];if(!process.browser)var a=["UNHANDLED"];function s(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=o,this.queue=[],this.outcome=void 0,process.browser||(this.handled=a),e!==t&&h(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function u(t,n,i){e((function(){var e;try{e=n(i)}catch(e){return r.reject(t,e)}e===t?r.reject(t,new TypeError("Cannot resolve promise with itself")):r.resolve(t,e)}))}function c(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function i(t){n||(n=!0,r.reject(e,t))}function o(t){n||(n=!0,r.resolve(e,t))}var a=d((function(){t(o,i)}));"error"===a.status&&i(a.value)}function d(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}return Et=s,s.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,r){if("function"!=typeof e&&this.state===i||"function"!=typeof r&&this.state===n)return this;var s=new this.constructor(t);return process.browser||this.handled===a&&(this.handled=null),this.state!==o?u(s,this.state===i?e:r,this.outcome):this.queue.push(new l(s,e,r)),s},l.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){r.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},r.resolve=function(e,t){var n=d(c,t);if("error"===n.status)return r.reject(e,n.value);var o=n.value;if(o)h(e,o);else{e.state=i,e.outcome=t;for(var a=-1,s=e.queue.length;++a<s;)e.queue[a].callFulfilled(t)}return e},r.reject=function(t,r){t.state=n,t.outcome=r,process.browser||t.handled===a&&e((function(){t.handled===a&&process.emit("unhandledRejection",r,t)}));for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callRejected(r);return t},s.resolve=function(e){return e instanceof this?e:r.resolve(new this(t),e)},s.reject=function(e){var n=new this(t);return r.reject(n,e)},s.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var a=new Array(i),s=0,l=-1,u=new this(t);++l<i;)c(e[l],l);return u;function c(e,t){n.resolve(e).then((function(e){a[t]=e,++s!==i||o||(o=!0,r.resolve(u,a))}),(function(e){o||(o=!0,r.reject(u,e))}))}},s.race=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var a,s=-1,l=new this(t);++s<i;)a=e[s],n.resolve(a).then((function(e){o||(o=!0,r.resolve(l,e))}),(function(e){o||(o=!0,r.reject(l,e))}));return l},Et}();var Tt,At={Promise:kt};function Mt(){return Tt||(Tt=1,function(e){var t=se,r=xt(),n=Ct,i=At;function o(e){return e}function a(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e.newBlob=function(t,r){e.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(e,t,r){var n=[],i=0,o=e.length;if(o<=r)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,o)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,o)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return t.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return t.nodebuffer&&1===String.fromCharCode.apply(null,n.allocBuffer(1)).length}catch(e){return!1}}()}};function l(t){var r=65536,n=e.getTypeOf(t),i=!0;if("uint8array"===n?i=s.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=s.applyCanBeUsed.nodebuffer),i)for(;r>1;)try{return s.stringifyByChunk(t,n,r)}catch(e){r=Math.floor(r/2)}return s.stringifyByChar(t)}function u(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}e.applyFromCharCode=l;var c={};c.string={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return c.string.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,n.allocBuffer(e.length))}},c.array={string:l,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(e)}},c.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(new Uint8Array(e))}},c.uint8array={string:l,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return n.newBufferFrom(e)}},c.nodebuffer={string:l,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return c.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:o},e.transformTo=function(t,r){if(r||(r=""),!t)return r;e.checkSupport(t);var n=e.getTypeOf(r);return c[n][t](r)},e.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},e.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":t.nodebuffer&&n.isBuffer(e)?"nodebuffer":t.uint8array&&e instanceof Uint8Array?"uint8array":t.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},e.checkSupport=function(e){if(!t[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},e.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},e.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r},e.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},e.prepareContent=function(n,o,s,l,u){var c=i.Promise.resolve(o).then((function(e){return t.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new i.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e}));return c.then((function(o){var c,h=e.getTypeOf(o);return h?("arraybuffer"===h?o=e.transformTo("uint8array",o):"string"===h&&(u?o=r.decode(o):s&&!0!==l&&(o=a(c=o,t.uint8array?new Uint8Array(c.length):new Array(c.length)))),o):i.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}}(ae)),ae}function Ot(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}!function(e,t){if(!e.setImmediate){var r,n,i,o,a=1,s={},l=!1,u=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(i="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&d(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){d(e.data)},r=function(e){n.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?function(){var e=u.documentElement;r=function(t){var r=u.createElement("script");r.onreadystatechange=function(){d(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():r=function(e){setTimeout(d,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return s[a]=i,r(a),a++},c.clearImmediate=h}function h(e){delete s[e]}function d(e){if(l)setTimeout(d,0,e);else{var r=s[e];if(r){l=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{h(e),l=!1}}}}}("undefined"==typeof self?ee:self),Ot.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};var Lt=Ot;!function(e){for(var t=Mt(),r=se,n=Ct,i=Lt,o=new Array(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1;function s(){i.call(this,"utf-8 decode"),this.leftOver=null}function l(){i.call(this,"utf-8 encode")}e.utf8encode=function(e){return r.nodebuffer?n.newBufferFrom(e,"utf-8"):function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},e.utf8decode=function(e){return r.nodebuffer?t.transformTo("nodebuffer",e).toString("utf-8"):function(e){var r,n,i,a,s=e.length,l=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)l[n++]=i;else if((a=o[i])>4)l[n++]=65533,r+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&r<s;)i=i<<6|63&e[r++],a--;a>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),t.applyFromCharCode(l)}(e=t.transformTo(r.uint8array?"uint8array":"array",e))},t.inherits(s,i),s.prototype.processChunk=function(n){var i=t.transformTo(r.uint8array?"uint8array":"array",n.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=i;(i=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),i.set(a,this.leftOver.length)}else i=this.leftOver.concat(i);this.leftOver=null}var s=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}(i),l=i;s!==i.length&&(r.uint8array?(l=i.subarray(0,s),this.leftOver=i.subarray(s,i.length)):(l=i.slice(0,s),this.leftOver=i.slice(s,i.length))),this.push({data:e.utf8decode(l),meta:n.meta})},s.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=s,t.inherits(l,i),l.prototype.processChunk=function(t){this.push({data:e.utf8encode(t.data),meta:t.meta})},e.Utf8EncodeWorker=l}(oe);var Rt=Lt,It=Mt();function Ft(e){Rt.call(this,"ConvertWorker to "+e),this.destType=e}It.inherits(Ft,Rt),Ft.prototype.processChunk=function(e){this.push({data:It.transformTo(this.destType,e.data),meta:e.meta})};var Pt,Dt,Nt=Ft;var Bt=Mt(),Ut=Nt,zt=Lt,Xt=xt(),Ht=At,Gt=null;if(se.nodestream)try{Gt=function(){if(Dt)return Pt;Dt=1;var e=vt().Readable;function t(t,r,n){e.call(this,r),this._helper=t;var i=this;t.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}return Mt().inherits(t,e),t.prototype._read=function(){this._helper.resume()},Pt=t}()}catch(e){}function jt(e,t){return new Ht.Promise((function(r,n){var i=[],o=e._internalType,a=e._outputType,s=e._mimeType;e.on("data",(function(e,r){i.push(e),t&&t(r)})).on("error",(function(e){i=[],n(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return Bt.newBlob(Bt.transformTo("arraybuffer",t),r);case"base64":return Xt.encode(t);default:return Bt.transformTo(e,t)}}(a,function(e,t){var r,n=0,i=null,o=0;for(r=0;r<t.length;r++)o+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,i),s);r(e)}catch(e){n(e)}i=[]})).resume()}))}function Yt(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=t,this._mimeType=r,Bt.checkSupport(n),this._worker=e.pipe(new Ut(n)),e.lock()}catch(e){this._worker=new zt("error"),this._worker.error(e)}}Yt.prototype={accumulate:function(e){return jt(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){Bt.delay(t,arguments,r)})),this},resume:function(){return Bt.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(Bt.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Gt(this,{objectMode:"nodebuffer"!==this._outputType},e)}};var Wt=Yt,Vt={base64:!1,binary:!1,dir:!1,createFolders:!0,date:null,compression:null,compressionOptions:null,comment:null,unixPermissions:null,dosPermissions:null},qt=Mt(),Kt=Lt;function Zt(e){Kt.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=qt.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}qt.inherits(Zt,Kt),Zt.prototype.cleanUp=function(){Kt.prototype.cleanUp.call(this),this.data=null},Zt.prototype.resume=function(){return!!Kt.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,qt.delay(this._tickAndRepeat,[],this)),!0)},Zt.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(qt.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},Zt.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};var Jt=Zt,Qt=Mt();var $t=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var er=function(e,t){return void 0!==e&&e.length?"string"!==Qt.getTypeOf(e)?function(e,t,r,n){var i=$t,o=n+r;e=~e;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return~e}(0|t,e,e.length,0):function(e,t,r,n){var i=$t,o=n+r;e=~e;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length,0):0},tr=Lt,rr=er;function nr(){tr.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}Mt().inherits(nr,tr),nr.prototype.processChunk=function(e){this.streamInfo.crc32=rr(e.data,this.streamInfo.crc32||0),this.push(e)};var ir=nr,or=Mt(),ar=Lt;function sr(e){ar.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}or.inherits(sr,ar),sr.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}ar.prototype.processChunk.call(this,e)};var lr=At,ur=Jt,cr=ir,hr=sr;function dr(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}dr.prototype={getContentWorker:function(){var e=new ur(lr.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new hr("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new ur(lr.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},dr.createWorkerFrom=function(e,t,r){return e.pipe(new cr).pipe(new hr("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new hr("compressedSize")).withStreamInfo("compression",t)};var fr=dr,pr=Wt,vr=Jt,gr=oe,mr=fr,yr=Lt,br=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};br.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(t=t.pipe(new gr.Utf8EncodeWorker)),!i&&n&&(t=t.pipe(new gr.Utf8DecodeWorker))}catch(e){(t=new yr("error")).error(e)}return new pr(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof mr&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new gr.Utf8EncodeWorker)),mr.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof mr?this._data.getContentWorker():this._data instanceof yr?this._data:new vr(this._data)}};for(var xr=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],wr=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_r=0;_r<xr.length;_r++)br.prototype[xr[_r]]=wr;var Er=br,Sr={},Cr={},kr={},Tr={};!function(e){var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(Tr);var Ar={},Mr={},Or={},Lr=Tr,Rr=0,Ir=1;function Fr(e){for(var t=e.length;--t>=0;)e[t]=0}var Pr=0,Dr=29,Nr=256,Br=Nr+1+Dr,Ur=30,zr=19,Xr=2*Br+1,Hr=15,Gr=16,jr=7,Yr=256,Wr=16,Vr=17,qr=18,Kr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Zr=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Jr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Qr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$r=new Array(2*(Br+2));Fr($r);var en=new Array(2*Ur);Fr(en);var tn=new Array(512);Fr(tn);var rn=new Array(256);Fr(rn);var nn=new Array(Dr);Fr(nn);var on,an,sn,ln=new Array(Ur);function un(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function cn(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function hn(e){return e<256?tn[e]:tn[256+(e>>>7)]}function dn(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function fn(e,t,r){e.bi_valid>Gr-r?(e.bi_buf|=t<<e.bi_valid&65535,dn(e,e.bi_buf),e.bi_buf=t>>Gr-e.bi_valid,e.bi_valid+=r-Gr):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function pn(e,t,r){fn(e,r[2*t],r[2*t+1])}function vn(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function gn(e,t,r){var n,i,o=new Array(Hr+1),a=0;for(n=1;n<=Hr;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=vn(o[s]++,s))}}function mn(e){var t;for(t=0;t<Br;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Ur;t++)e.dyn_dtree[2*t]=0;for(t=0;t<zr;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Yr]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function yn(e){e.bi_valid>8?dn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function bn(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function xn(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&bn(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!bn(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function wn(e,t,r){var n,i,o,a,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?pn(e,i,t):(pn(e,(o=rn[i])+Nr+1,t),0!==(a=Kr[o])&&fn(e,i-=nn[o],a),pn(e,o=hn(--n),r),0!==(a=Zr[o])&&fn(e,n-=ln[o],a))}while(s<e.last_lit);pn(e,Yr,t)}function _n(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=Xr,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)xn(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],xn(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,xn(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,v=0;for(o=0;o<=Hr;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<Xr;r++)(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(o=p,v++),l[2*n+1]=o,n>u||(e.bl_count[o]++,a=0,n>=f&&(a=d[n-f]),s=l[2*n],e.opt_len+=s*(o+a),h&&(e.static_len+=s*(c[2*n+1]+a)));if(0!==v){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,v-=2}while(v>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>u||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),gn(o,u,e.bl_count)}function En(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*Wr]++):s<=10?e.bl_tree[2*Vr]++:e.bl_tree[2*qr]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function Sn(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<u)do{pn(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(pn(e,i,e.bl_tree),s--),pn(e,Wr,e.bl_tree),fn(e,s-3,2)):s<=10?(pn(e,Vr,e.bl_tree),fn(e,s-3,3)):(pn(e,qr,e.bl_tree),fn(e,s-11,7));s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4)}}Fr(ln);var Cn=!1;function kn(e,t,r,n){fn(e,(Pr<<1)+(n?1:0),3),function(e,t,r,n){yn(e),dn(e,r),dn(e,~r),Lr.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}Or._tr_init=function(e){Cn||(!function(){var e,t,r,n,i,o=new Array(Hr+1);for(r=0,n=0;n<Dr-1;n++)for(nn[n]=r,e=0;e<1<<Kr[n];e++)rn[r++]=n;for(rn[r-1]=n,i=0,n=0;n<16;n++)for(ln[n]=i,e=0;e<1<<Zr[n];e++)tn[i++]=n;for(i>>=7;n<Ur;n++)for(ln[n]=i<<7,e=0;e<1<<Zr[n]-7;e++)tn[256+i++]=n;for(t=0;t<=Hr;t++)o[t]=0;for(e=0;e<=143;)$r[2*e+1]=8,e++,o[8]++;for(;e<=255;)$r[2*e+1]=9,e++,o[9]++;for(;e<=279;)$r[2*e+1]=7,e++,o[7]++;for(;e<=287;)$r[2*e+1]=8,e++,o[8]++;for(gn($r,Br+1,o),e=0;e<Ur;e++)en[2*e+1]=5,en[2*e]=vn(e,5);on=new un($r,Kr,Nr+1,Br,Hr),an=new un(en,Zr,0,Ur,Hr),sn=new un(new Array(0),Jr,0,zr,jr)}(),Cn=!0),e.l_desc=new cn(e.dyn_ltree,on),e.d_desc=new cn(e.dyn_dtree,an),e.bl_desc=new cn(e.bl_tree,sn),e.bi_buf=0,e.bi_valid=0,mn(e)},Or._tr_stored_block=kn,Or._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return Rr;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Ir;for(t=32;t<Nr;t++)if(0!==e.dyn_ltree[2*t])return Ir;return Rr}(e)),_n(e,e.l_desc),_n(e,e.d_desc),a=function(e){var t;for(En(e,e.dyn_ltree,e.l_desc.max_code),En(e,e.dyn_dtree,e.d_desc.max_code),_n(e,e.bl_desc),t=zr-1;t>=3&&0===e.bl_tree[2*Qr[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?kn(e,t,r,n):4===e.strategy||o===i?(fn(e,2+(n?1:0),3),wn(e,$r,en)):(fn(e,4+(n?1:0),3),function(e,t,r,n){var i;for(fn(e,t-257,5),fn(e,r-1,5),fn(e,n-4,4),i=0;i<n;i++)fn(e,e.bl_tree[2*Qr[i]+1],3);Sn(e,e.dyn_ltree,t-1),Sn(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),wn(e,e.dyn_ltree,e.dyn_dtree)),mn(e),n&&yn(e)},Or._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(rn[r]+Nr+1)]++,e.dyn_dtree[2*hn(t)]++),e.last_lit===e.lit_bufsize-1},Or._tr_align=function(e){fn(e,2,3),pn(e,Yr,$r),function(e){16===e.bi_valid?(dn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)};var Tn=function(e,t,r,n){for(var i=65535&e,o=e>>>16&65535,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16};var An=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var Mn,On=function(e,t,r,n){var i=An,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return~e},Ln={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Rn=Tr,In=Or,Fn=Tn,Pn=On,Dn=Ln,Nn=0,Bn=4,Un=0,zn=-2,Xn=-1,Hn=4,Gn=2,jn=8,Yn=9,Wn=286,Vn=30,qn=19,Kn=2*Wn+1,Zn=15,Jn=3,Qn=258,$n=Qn+Jn+1,ei=42,ti=103,ri=113,ni=666,ii=1,oi=2,ai=3,si=4;function li(e,t){return e.msg=Dn[t],t}function ui(e){return(e<<1)-(e>4?9:0)}function ci(e){for(var t=e.length;--t>=0;)e[t]=0}function hi(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(Rn.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function di(e,t){In._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,hi(e.strm)}function fi(e,t){e.pending_buf[e.pending++]=t}function pi(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function vi(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,Rn.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=Fn(e.adler,t,i,r):2===e.state.wrap&&(e.adler=Pn(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function gi(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-$n?e.strstart-(e.w_size-$n):0,u=e.window,c=e.w_mask,h=e.prev,d=e.strstart+Qn,f=u[o+a-1],p=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(r=t)+a]===p&&u[r+a-1]===f&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<d);if(n=Qn-(d-o),o=d-Qn,n>a){if(e.match_start=t,a=n,n>=s)break;f=u[o+a-1],p=u[o+a]}}}while((t=h[t&c])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function mi(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-$n)){Rn.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);t=r=a;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=vi(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=Jn)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+Jn-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<Jn)););}while(e.lookahead<$n&&0!==e.strm.avail_in)}function yi(e,t){for(var r,n;;){if(e.lookahead<$n){if(mi(e),e.lookahead<$n&&t===Nn)return ii;if(0===e.lookahead)break}if(r=0,e.lookahead>=Jn&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-$n&&(e.match_length=gi(e,r)),e.match_length>=Jn)if(n=In._tr_tally(e,e.strstart-e.match_start,e.match_length-Jn),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Jn){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=In._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(di(e,!1),0===e.strm.avail_out))return ii}return e.insert=e.strstart<Jn-1?e.strstart:Jn-1,t===Bn?(di(e,!0),0===e.strm.avail_out?ai:si):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?ii:oi}function bi(e,t){for(var r,n,i;;){if(e.lookahead<$n){if(mi(e),e.lookahead<$n&&t===Nn)return ii;if(0===e.lookahead)break}if(r=0,e.lookahead>=Jn&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Jn-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-$n&&(e.match_length=gi(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===Jn&&e.strstart-e.match_start>4096)&&(e.match_length=Jn-1)),e.prev_length>=Jn&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Jn,n=In._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-Jn),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Jn-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=Jn-1,e.strstart++,n&&(di(e,!1),0===e.strm.avail_out))return ii}else if(e.match_available){if((n=In._tr_tally(e,0,e.window[e.strstart-1]))&&di(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return ii}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=In._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Jn-1?e.strstart:Jn-1,t===Bn?(di(e,!0),0===e.strm.avail_out?ai:si):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?ii:oi}function xi(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function wi(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=jn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Rn.Buf16(2*Kn),this.dyn_dtree=new Rn.Buf16(2*(2*Vn+1)),this.bl_tree=new Rn.Buf16(2*(2*qn+1)),ci(this.dyn_ltree),ci(this.dyn_dtree),ci(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Rn.Buf16(Zn+1),this.heap=new Rn.Buf16(2*Wn+1),ci(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Rn.Buf16(2*Wn+1),ci(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _i(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Gn,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?ei:ri,e.adler=2===t.wrap?0:1,t.last_flush=Nn,In._tr_init(t),Un):li(e,zn)}function Ei(e){var t,r=_i(e);return r===Un&&((t=e.state).window_size=2*t.w_size,ci(t.head),t.max_lazy_match=Mn[t.level].max_lazy,t.good_match=Mn[t.level].good_length,t.nice_match=Mn[t.level].nice_length,t.max_chain_length=Mn[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Jn-1,t.match_available=0,t.ins_h=0),r}function Si(e,t,r,n,i,o){if(!e)return zn;var a=1;if(t===Xn&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>Yn||r!==jn||n<8||n>15||t<0||t>9||o<0||o>Hn)return li(e,zn);8===n&&(n=9);var s=new wi;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Jn-1)/Jn),s.window=new Rn.Buf8(2*s.w_size),s.head=new Rn.Buf16(s.hash_size),s.prev=new Rn.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Rn.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,Ei(e)}Mn=[new xi(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(mi(e),0===e.lookahead&&t===Nn)return ii;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,di(e,!1),0===e.strm.avail_out))return ii;if(e.strstart-e.block_start>=e.w_size-$n&&(di(e,!1),0===e.strm.avail_out))return ii}return e.insert=0,t===Bn?(di(e,!0),0===e.strm.avail_out?ai:si):(e.strstart>e.block_start&&(di(e,!1),e.strm.avail_out),ii)})),new xi(4,4,8,4,yi),new xi(4,5,16,8,yi),new xi(4,6,32,32,yi),new xi(4,4,16,16,bi),new xi(8,16,32,32,bi),new xi(8,16,128,128,bi),new xi(8,32,128,256,bi),new xi(32,128,258,1024,bi),new xi(32,258,258,4096,bi)],Mr.deflateInit=function(e,t){return Si(e,t,jn,15,8,0)},Mr.deflateInit2=Si,Mr.deflateReset=Ei,Mr.deflateResetKeep=_i,Mr.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?zn:(e.state.gzhead=t,Un):zn},Mr.deflate=function(e,t){var r,n,i,o;if(!e||!e.state||t>5||t<0)return e?li(e,zn):zn;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===ni&&t!==Bn)return li(e,0===e.avail_out?-5:zn);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===ei)if(2===n.wrap)e.adler=0,fi(n,31),fi(n,139),fi(n,8),n.gzhead?(fi(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),fi(n,255&n.gzhead.time),fi(n,n.gzhead.time>>8&255),fi(n,n.gzhead.time>>16&255),fi(n,n.gzhead.time>>24&255),fi(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),fi(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(fi(n,255&n.gzhead.extra.length),fi(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Pn(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(fi(n,0),fi(n,0),fi(n,0),fi(n,0),fi(n,0),fi(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),fi(n,3),n.status=ri);else{var a=jn+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=ri,pi(n,a),0!==n.strstart&&(pi(n,e.adler>>>16),pi(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=Pn(e.adler,n.pending_buf,n.pending-i,i)),hi(e),i=n.pending,n.pending!==n.pending_buf_size));)fi(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=Pn(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Pn(e.adler,n.pending_buf,n.pending-i,i)),hi(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,fi(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Pn(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Pn(e.adler,n.pending_buf,n.pending-i,i)),hi(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,fi(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Pn(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=ti)}else n.status=ti;if(n.status===ti&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&hi(e),n.pending+2<=n.pending_buf_size&&(fi(n,255&e.adler),fi(n,e.adler>>8&255),e.adler=0,n.status=ri)):n.status=ri),0!==n.pending){if(hi(e),0===e.avail_out)return n.last_flush=-1,Un}else if(0===e.avail_in&&ui(t)<=ui(r)&&t!==Bn)return li(e,-5);if(n.status===ni&&0!==e.avail_in)return li(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==Nn&&n.status!==ni){var s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(mi(e),0===e.lookahead)){if(t===Nn)return ii;break}if(e.match_length=0,r=In._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(di(e,!1),0===e.strm.avail_out))return ii}return e.insert=0,t===Bn?(di(e,!0),0===e.strm.avail_out?ai:si):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?ii:oi}(n,t):3===n.strategy?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=Qn){if(mi(e),e.lookahead<=Qn&&t===Nn)return ii;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=Jn&&e.strstart>0&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=e.strstart+Qn;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=Qn-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Jn?(r=In._tr_tally(e,1,e.match_length-Jn),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=In._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(di(e,!1),0===e.strm.avail_out))return ii}return e.insert=0,t===Bn?(di(e,!0),0===e.strm.avail_out?ai:si):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?ii:oi}(n,t):Mn[n.level].func(n,t);if(s!==ai&&s!==si||(n.status=ni),s===ii||s===ai)return 0===e.avail_out&&(n.last_flush=-1),Un;if(s===oi&&(1===t?In._tr_align(n):5!==t&&(In._tr_stored_block(n,0,0,!1),3===t&&(ci(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),hi(e),0===e.avail_out))return n.last_flush=-1,Un}return t!==Bn?Un:n.wrap<=0?1:(2===n.wrap?(fi(n,255&e.adler),fi(n,e.adler>>8&255),fi(n,e.adler>>16&255),fi(n,e.adler>>24&255),fi(n,255&e.total_in),fi(n,e.total_in>>8&255),fi(n,e.total_in>>16&255),fi(n,e.total_in>>24&255)):(pi(n,e.adler>>>16),pi(n,65535&e.adler)),hi(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Un:1)},Mr.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==ei&&69!==t&&73!==t&&91!==t&&t!==ti&&t!==ri&&t!==ni?li(e,zn):(e.state=null,t===ri?li(e,-3):Un):zn},Mr.deflateSetDictionary=function(e,t){var r,n,i,o,a,s,l,u,c=t.length;if(!e||!e.state)return zn;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==ei||r.lookahead)return zn;for(1===o&&(e.adler=Fn(e.adler,t,c,0)),r.wrap=0,c>=r.w_size&&(0===o&&(ci(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new Rn.Buf8(r.w_size),Rn.arraySet(u,t,c-r.w_size,r.w_size,0),t=u,c=r.w_size),a=e.avail_in,s=e.next_in,l=e.input,e.avail_in=c,e.next_in=0,e.input=t,mi(r);r.lookahead>=Jn;){n=r.strstart,i=r.lookahead-(Jn-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+Jn-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=Jn-1,mi(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Jn-1,r.match_available=0,e.next_in=s,e.input=l,e.avail_in=a,r.wrap=o,Un},Mr.deflateInfo="pako deflate (from Nodeca project)";var Ci={},ki=Tr,Ti=!0,Ai=!0;try{String.fromCharCode.apply(null,[0])}catch(e){Ti=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ai=!1}for(var Mi=new ki.Buf8(256),Oi=0;Oi<256;Oi++)Mi[Oi]=Oi>=252?6:Oi>=248?5:Oi>=240?4:Oi>=224?3:Oi>=192?2:1;function Li(e,t){if(t<65534&&(e.subarray&&Ai||!e.subarray&&Ti))return String.fromCharCode.apply(null,ki.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}Mi[254]=Mi[254]=1,Ci.string2buf=function(e){var t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new ki.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},Ci.buf2binstring=function(e){return Li(e,e.length)},Ci.binstring2buf=function(e){for(var t=new ki.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},Ci.buf2string=function(e,t){var r,n,i,o,a=t||e.length,s=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)s[n++]=i;else if((o=Mi[i])>4)s[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<a;)i=i<<6|63&e[r++],o--;o>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return Li(s,n)},Ci.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Mi[e[r]]>t?r:t};var Ri=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Ii=Mr,Fi=Tr,Pi=Ci,Di=Ln,Ni=Ri,Bi=Object.prototype.toString,Ui=0,zi=-1,Xi=0,Hi=8;function Gi(e){if(!(this instanceof Gi))return new Gi(e);this.options=Fi.assign({level:zi,method:Hi,chunkSize:16384,windowBits:15,memLevel:8,strategy:Xi,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ni,this.strm.avail_out=0;var r=Ii.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Ui)throw new Error(Di[r]);if(t.header&&Ii.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?Pi.string2buf(t.dictionary):"[object ArrayBuffer]"===Bi.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=Ii.deflateSetDictionary(this.strm,n))!==Ui)throw new Error(Di[r]);this._dict_set=!0}}function ji(e,t){var r=new Gi(t);if(r.push(e,!0),r.err)throw r.msg||Di[r.err];return r.result}Gi.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=Pi.string2buf(e):"[object ArrayBuffer]"===Bi.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new Fi.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=Ii.deflate(i,n))&&r!==Ui)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(Pi.buf2binstring(Fi.shrinkBuf(i.output,i.next_out))):this.onData(Fi.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=Ii.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Ui):2!==n||(this.onEnd(Ui),i.avail_out=0,!0)},Gi.prototype.onData=function(e){this.chunks.push(e)},Gi.prototype.onEnd=function(e){e===Ui&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Fi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Ar.Deflate=Gi,Ar.deflate=ji,Ar.deflateRaw=function(e,t){return(t=t||{}).raw=!0,ji(e,t)},Ar.gzip=function(e,t){return(t=t||{}).gzip=!0,ji(e,t)};var Yi={},Wi={},Vi=Tr,qi=15,Ki=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Zi=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ji=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Qi=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],$i=Tr,eo=Tn,to=On,ro=function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C,k;r=e.state,n=e.next_in,C=e.input,i=n+(e.avail_in-5),o=e.next_out,k=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,v=r.lencode,g=r.distcode,m=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=v[f&m];t:for(;;){if(f>>>=x=b>>>24,p-=x,0===(x=b>>>16&255))k[o++]=65535&b;else{if(!(16&x)){if(64&x){if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}b=v[(65535&b)+(f&(1<<x)-1)];continue t}for(w=65535&b,(x&=15)&&(p<x&&(f+=C[n++]<<p,p+=8),w+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=g[f&y];;){if(f>>>=x=b>>>24,p-=x,16&(x=b>>>16&255)){if(_=65535&b,p<(x&=15)&&(f+=C[n++]<<p,(p+=8)<x&&(f+=C[n++]<<p,p+=8)),(_+=f&(1<<x)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=x,p-=x,_>(x=o-a)){if((x=_-x)>c&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(E=0,S=d,0===h){if(E+=u-x,x<w){w-=x;do{k[o++]=d[E++]}while(--x);E=o-_,S=k}}else if(h<x){if(E+=u+h-x,(x-=h)<w){w-=x;do{k[o++]=d[E++]}while(--x);if(E=0,h<w){w-=x=h;do{k[o++]=d[E++]}while(--x);E=o-_,S=k}}}else if(E+=h-x,x<w){w-=x;do{k[o++]=d[E++]}while(--x);E=o-_,S=k}for(;w>2;)k[o++]=S[E++],k[o++]=S[E++],k[o++]=S[E++],w-=3;w&&(k[o++]=S[E++],w>1&&(k[o++]=S[E++]))}else{E=o-_;do{k[o++]=k[E++],k[o++]=k[E++],k[o++]=k[E++],w-=3}while(w>2);w&&(k[o++]=k[E++],w>1&&(k[o++]=k[E++]))}break}if(64&x){e.msg="invalid distance code",r.mode=30;break e}b=g[(65535&b)+(f&(1<<x)-1)]}}break}}while(n<i&&o<s);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=f,r.bits=p},no=function(e,t,r,n,i,o,a,s){var l,u,c,h,d,f,p,v,g,m=s.bits,y=0,b=0,x=0,w=0,_=0,E=0,S=0,C=0,k=0,T=0,A=null,M=0,O=new Vi.Buf16(16),L=new Vi.Buf16(16),R=null,I=0;for(y=0;y<=qi;y++)O[y]=0;for(b=0;b<n;b++)O[t[r+b]]++;for(_=m,w=qi;w>=1&&0===O[w];w--);if(_>w&&(_=w),0===w)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(x=1;x<w&&0===O[x];x++);for(_<x&&(_=x),C=1,y=1;y<=qi;y++)if(C<<=1,(C-=O[y])<0)return-1;if(C>0&&(0===e||1!==w))return-1;for(L[1]=0,y=1;y<qi;y++)L[y+1]=L[y]+O[y];for(b=0;b<n;b++)0!==t[r+b]&&(a[L[t[r+b]]++]=b);if(0===e?(A=R=a,f=19):1===e?(A=Ki,M-=257,R=Zi,I-=257,f=256):(A=Ji,R=Qi,f=-1),T=0,b=0,y=x,d=o,E=_,S=0,c=-1,h=(k=1<<_)-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){p=y-S,a[b]<f?(v=0,g=a[b]):a[b]>f?(v=R[I+a[b]],g=A[M+a[b]]):(v=96,g=0),l=1<<y-S,x=u=1<<E;do{i[d+(T>>S)+(u-=l)]=p<<24|v<<16|g}while(0!==u);for(l=1<<y-1;T&l;)l>>=1;if(0!==l?(T&=l-1,T+=l):T=0,b++,0==--O[y]){if(y===w)break;y=t[r+a[b]]}if(y>_&&(T&h)!==c){for(0===S&&(S=_),d+=x,C=1<<(E=y-S);E+S<w&&!((C-=O[E+S])<=0);)E++,C<<=1;if(k+=1<<E,1===e&&k>852||2===e&&k>592)return 1;i[c=T&h]=_<<24|E<<16|d-o}}return 0!==T&&(i[d+T]=y-S<<24|64<<16),s.bits=_,0},io=1,oo=2,ao=0,so=-2,lo=1,uo=12,co=30,ho=852,fo=592;function po(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function vo(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new $i.Buf16(320),this.work=new $i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function go(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=lo,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new $i.Buf32(ho),t.distcode=t.distdyn=new $i.Buf32(fo),t.sane=1,t.back=-1,ao):so}function mo(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,go(e)):so}function yo(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?so:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,mo(e))):so}function bo(e,t){var r,n;return e?(n=new vo,e.state=n,n.window=null,(r=yo(e,t))!==ao&&(e.state=null),r):so}var xo,wo,_o=!0;function Eo(e){if(_o){var t;for(xo=new $i.Buf32(512),wo=new $i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(no(io,e.lens,0,288,xo,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;no(oo,e.lens,0,32,wo,0,e.work,{bits:5}),_o=!1}e.lencode=xo,e.lenbits=9,e.distcode=wo,e.distbits=5}function So(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new $i.Buf8(o.wsize)),n>=o.wsize?($i.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),$i.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?($i.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}Wi.inflateReset=mo,Wi.inflateReset2=yo,Wi.inflateResetKeep=go,Wi.inflateInit=function(e){return bo(e,15)},Wi.inflateInit2=bo,Wi.inflate=function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C,k=0,T=new $i.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return so;(r=e.state).mode===uo&&(r.mode=13),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,u=r.hold,c=r.bits,h=s,d=l,E=ao;e:for(;;)switch(r.mode){case lo:if(0===r.wrap){r.mode=13;break}for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(2&r.wrap&&35615===u){r.check=0,T[0]=255&u,T[1]=u>>>8&255,r.check=to(r.check,T,2,0),u=0,c=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=co;break}if(8!=(15&u)){e.msg="unknown compression method",r.mode=co;break}if(c-=4,_=8+(15&(u>>>=4)),0===r.wbits)r.wbits=_;else if(_>r.wbits){e.msg="invalid window size",r.mode=co;break}r.dmax=1<<_,e.adler=r.check=1,r.mode=512&u?10:uo,u=0,c=0;break;case 2:for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(r.flags=u,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=co;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=co;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(T[0]=255&u,T[1]=u>>>8&255,r.check=to(r.check,T,2,0)),u=0,c=0,r.mode=3;case 3:for(;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.head&&(r.head.time=u),512&r.flags&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,r.check=to(r.check,T,4,0)),u=0,c=0,r.mode=4;case 4:for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(T[0]=255&u,T[1]=u>>>8&255,r.check=to(r.check,T,2,0)),u=0,c=0,r.mode=5;case 5:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(T[0]=255&u,T[1]=u>>>8&255,r.check=to(r.check,T,2,0)),u=0,c=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((f=r.length)>s&&(f=s),f&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),$i.arraySet(r.head.extra,n,o,f,_)),512&r.flags&&(r.check=to(r.check,n,f,o)),s-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;f=0;do{_=n[o+f++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_))}while(_&&f<s);if(512&r.flags&&(r.check=to(r.check,n,f,o)),s-=f,o+=f,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;f=0;do{_=n[o+f++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_))}while(_&&f<s);if(512&r.flags&&(r.check=to(r.check,n,f,o)),s-=f,o+=f,_)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(u!==(65535&r.check)){e.msg="header crc mismatch",r.mode=co;break}u=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=uo;break;case 10:for(;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}e.adler=r.check=po(u),u=0,c=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,2;e.adler=r.check=1,r.mode=uo;case uo:if(5===t||6===t)break e;case 13:if(r.last){u>>>=7&c,c-=7&c,r.mode=27;break}for(;c<3;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}switch(r.last=1&u,c-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(Eo(r),r.mode=20,6===t){u>>>=2,c-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=co}u>>>=2,c-=2;break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=co;break}if(r.length=65535&u,u=0,c=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(f=r.length){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;$i.arraySet(i,n,o,f,a),s-=f,o+=f,l-=f,a+=f,r.length-=f;break}r.mode=uo;break;case 17:for(;c<14;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(r.nlen=257+(31&u),u>>>=5,c-=5,r.ndist=1+(31&u),u>>>=5,c-=5,r.ncode=4+(15&u),u>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=co;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.lens[A[r.have++]]=7&u,u>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},E=no(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,E){e.msg="invalid code lengths set",r.mode=co;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;m=(k=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,y=65535&k,!((g=k>>>24)<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(y<16)u>>>=g,c-=g,r.lens[r.have++]=y;else{if(16===y){for(C=g+2;c<C;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(u>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=co;break}_=r.lens[r.have-1],f=3+(3&u),u>>>=2,c-=2}else if(17===y){for(C=g+3;c<C;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}c-=g,_=0,f=3+(7&(u>>>=g)),u>>>=3,c-=3}else{for(C=g+7;c<C;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}c-=g,_=0,f=11+(127&(u>>>=g)),u>>>=7,c-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=co;break}for(;f--;)r.lens[r.have++]=_}}if(r.mode===co)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=co;break}if(r.lenbits=9,S={bits:r.lenbits},E=no(io,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,E){e.msg="invalid literal/lengths set",r.mode=co;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},E=no(oo,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,E){e.msg="invalid distances set",r.mode=co;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,ro(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,u=r.hold,c=r.bits,r.mode===uo&&(r.back=-1);break}for(r.back=0;m=(k=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,y=65535&k,!((g=k>>>24)<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(m&&!(240&m)){for(b=g,x=m,w=y;m=(k=r.lencode[w+((u&(1<<b+x)-1)>>b)])>>>16&255,y=65535&k,!(b+(g=k>>>24)<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}u>>>=b,c-=b,r.back+=b}if(u>>>=g,c-=g,r.back+=g,r.length=y,0===m){r.mode=26;break}if(32&m){r.back=-1,r.mode=uo;break}if(64&m){e.msg="invalid literal/length code",r.mode=co;break}r.extra=15&m,r.mode=22;case 22:if(r.extra){for(C=r.extra;c<C;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;m=(k=r.distcode[u&(1<<r.distbits)-1])>>>16&255,y=65535&k,!((g=k>>>24)<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(!(240&m)){for(b=g,x=m,w=y;m=(k=r.distcode[w+((u&(1<<b+x)-1)>>b)])>>>16&255,y=65535&k,!(b+(g=k>>>24)<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}u>>>=b,c-=b,r.back+=b}if(u>>>=g,c-=g,r.back+=g,64&m){e.msg="invalid distance code",r.mode=co;break}r.offset=y,r.extra=15&m,r.mode=24;case 24:if(r.extra){for(C=r.extra;c<C;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=co;break}r.mode=25;case 25:if(0===l)break e;if(f=d-l,r.offset>f){if((f=r.offset-f)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=co;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),v=r.window}else v=i,p=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{i[a++]=v[p++]}while(--f);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;i[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;c<32;){if(0===s)break e;s--,u|=n[o++]<<c,c+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?to(r.check,i,d,a-d):eo(r.check,i,d,a-d)),d=l,(r.flags?u:po(u))!==r.check){e.msg="incorrect data check",r.mode=co;break}u=0,c=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(u!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=co;break}u=0,c=0}r.mode=29;case 29:E=1;break e;case co:E=-3;break e;case 31:return-4;default:return so}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,(r.wsize||d!==e.avail_out&&r.mode<co&&(r.mode<27||4!==t))&&So(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?to(r.check,i,d,e.next_out-d):eo(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===uo?128:0)+(20===r.mode||15===r.mode?256:0),(0===h&&0===d||4===t)&&E===ao&&(E=-5),E},Wi.inflateEnd=function(e){if(!e||!e.state)return so;var t=e.state;return t.window&&(t.window=null),e.state=null,ao},Wi.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?(r.head=t,t.done=!1,ao):so},Wi.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?so:11===r.mode&&eo(1,t,n,0)!==r.check?-3:So(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,ao):so},Wi.inflateInfo="pako inflate (from Nodeca project)";var Co={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var ko=Wi,To=Tr,Ao=Ci,Mo=Co,Oo=Ln,Lo=Ri,Ro=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Io=Object.prototype.toString;function Fo(e){if(!(this instanceof Fo))return new Fo(e);this.options=To.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Lo,this.strm.avail_out=0;var r=ko.inflateInit2(this.strm,t.windowBits);if(r!==Mo.Z_OK)throw new Error(Oo[r]);if(this.header=new Ro,ko.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Ao.string2buf(t.dictionary):"[object ArrayBuffer]"===Io.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ko.inflateSetDictionary(this.strm,t.dictionary))!==Mo.Z_OK))throw new Error(Oo[r])}function Po(e,t){var r=new Fo(t);if(r.push(e,!0),r.err)throw r.msg||Oo[r.err];return r.result}Fo.prototype.push=function(e,t){var r,n,i,o,a,s=this.strm,l=this.options.chunkSize,u=this.options.dictionary,c=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?Mo.Z_FINISH:Mo.Z_NO_FLUSH,"string"==typeof e?s.input=Ao.binstring2buf(e):"[object ArrayBuffer]"===Io.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new To.Buf8(l),s.next_out=0,s.avail_out=l),(r=ko.inflate(s,Mo.Z_NO_FLUSH))===Mo.Z_NEED_DICT&&u&&(r=ko.inflateSetDictionary(this.strm,u)),r===Mo.Z_BUF_ERROR&&!0===c&&(r=Mo.Z_OK,c=!1),r!==Mo.Z_STREAM_END&&r!==Mo.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0!==s.avail_out&&r!==Mo.Z_STREAM_END&&(0!==s.avail_in||n!==Mo.Z_FINISH&&n!==Mo.Z_SYNC_FLUSH)||("string"===this.options.to?(i=Ao.utf8border(s.output,s.next_out),o=s.next_out-i,a=Ao.buf2string(s.output,i),s.next_out=o,s.avail_out=l-o,o&&To.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(To.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(c=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==Mo.Z_STREAM_END);return r===Mo.Z_STREAM_END&&(n=Mo.Z_FINISH),n===Mo.Z_FINISH?(r=ko.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Mo.Z_OK):n!==Mo.Z_SYNC_FLUSH||(this.onEnd(Mo.Z_OK),s.avail_out=0,!0)},Fo.prototype.onData=function(e){this.chunks.push(e)},Fo.prototype.onEnd=function(e){e===Mo.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=To.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Yi.Inflate=Fo,Yi.inflate=Po,Yi.inflateRaw=function(e,t){return(t=t||{}).raw=!0,Po(e,t)},Yi.ungzip=Po;var Do={};(0,Tr.assign)(Do,Ar,Yi,Co);var No="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,Bo=Do,Uo=Mt(),zo=Lt,Xo=No?"uint8array":"array";function Ho(e,t){zo.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}kr.magic="\b\0",Uo.inherits(Ho,zo),Ho.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(Uo.transformTo(Xo,e.data),!1)},Ho.prototype.flush=function(){zo.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Ho.prototype.cleanUp=function(){zo.prototype.cleanUp.call(this),this._pako=null},Ho.prototype._createPako=function(){this._pako=new Bo[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},kr.compressWorker=function(e){return new Ho("Deflate",e)},kr.uncompressWorker=function(){return new Ho("Inflate",{})};var Go=Lt;Cr.STORE={magic:"\0\0",compressWorker:function(){return new Go("STORE compression")},uncompressWorker:function(){return new Go("STORE decompression")}},Cr.DEFLATE=kr;var jo={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},Yo=Mt(),Wo=Lt,Vo=oe,qo=er,Ko=jo,Zo=function(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},Jo=function(e,t,r,n,i,o){var a,s,l=e.file,u=e.compression,c=o!==Vo.utf8encode,h=Yo.transformTo("string",o(l.name)),d=Yo.transformTo("string",Vo.utf8encode(l.name)),f=l.comment,p=Yo.transformTo("string",o(f)),v=Yo.transformTo("string",Vo.utf8encode(f)),g=d.length!==l.name.length,m=v.length!==f.length,y="",b="",x="",w=l.dir,_=l.date,E={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(E.crc32=e.crc32,E.compressedSize=e.compressedSize,E.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),c||!g&&!m||(S|=2048);var C,k,T,A=0,M=0;w&&(A|=16),"UNIX"===i?(M=798,A|=(C=l.unixPermissions,k=w,T=C,C||(T=k?16893:33204),(65535&T)<<16)):(M=20,A|=63&(l.dosPermissions||0)),a=_.getUTCHours(),a<<=6,a|=_.getUTCMinutes(),a<<=5,a|=_.getUTCSeconds()/2,s=_.getUTCFullYear()-1980,s<<=4,s|=_.getUTCMonth()+1,s<<=5,s|=_.getUTCDate(),g&&(b=Zo(1,1)+Zo(qo(h),4)+d,y+="up"+Zo(b.length,2)+b),m&&(x=Zo(1,1)+Zo(qo(p),4)+v,y+="uc"+Zo(x.length,2)+x);var O="";return O+="\n\0",O+=Zo(S,2),O+=u.magic,O+=Zo(a,2),O+=Zo(s,2),O+=Zo(E.crc32,4),O+=Zo(E.compressedSize,4),O+=Zo(E.uncompressedSize,4),O+=Zo(h.length,2),O+=Zo(y.length,2),{fileRecord:Ko.LOCAL_FILE_HEADER+O+h+y,dirRecord:Ko.CENTRAL_FILE_HEADER+Zo(M,2)+O+Zo(p.length,2)+"\0\0\0\0"+Zo(A,4)+Zo(n,4)+h+y+p}},Qo=function(e){return Ko.DATA_DESCRIPTOR+Zo(e.crc32,4)+Zo(e.compressedSize,4)+Zo(e.uncompressedSize,4)};function $o(e,t,r,n){Wo.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}Yo.inherits($o,Wo),$o.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,Wo.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},$o.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=Jo(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},$o.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=Jo(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:Qo(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},$o.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,i){var o=Yo.transformTo("string",i(n));return Ko.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Zo(e,2)+Zo(e,2)+Zo(t,4)+Zo(r,4)+Zo(o.length,2)+o}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},$o.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},$o.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},$o.prototype.resume=function(){return!!Wo.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},$o.prototype.error=function(e){var t=this._sources;if(!Wo.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},$o.prototype.lock=function(){Wo.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()};var ea=Cr,ta=$o;Sr.generateWorker=function(e,t,r){var n=new ta(t.streamFiles,r,t.platform,t.encodeFileName),i=0;try{e.forEach((function(e,r){i++;var o=function(e,t){var r=e||t,n=ea[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,t.compression),a=r.options.compressionOptions||t.compressionOptions||{},s=r.dir,l=r.date;r._compressWorker(o,a).withStreamInfo("file",{name:e,dir:s,date:l,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(n)})),n.entriesCount=i}catch(e){n.error(e)}return n};var ra=Mt(),na=Lt;function ia(e,t){na.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}ra.inherits(ia,na),ia.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},ia.prototype.pause=function(){return!!na.prototype.pause.call(this)&&(this._stream.pause(),!0)},ia.prototype.resume=function(){return!!na.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};var oa=ia,aa=oe,sa=Mt(),la=Lt,ua=Wt,ca=Vt,ha=fr,da=Er,fa=Sr,pa=Ct,va=oa,ga=function(e,t,r){var n,i=sa.getTypeOf(t),o=sa.extend(r||{},ca);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=ya(e)),o.createFolders&&(n=ma(e))&&ba.call(this,n,!0);var a="string"===i&&!1===o.binary&&!1===o.base64;r&&void 0!==r.binary||(o.binary=!a),(t instanceof ha&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",i="string");var s=null;s=t instanceof ha||t instanceof la?t:pa.isNode&&pa.isStream(t)?new va(e,t):sa.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var l=new da(e,s,o);this.files[e]=l},ma=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},ya=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},ba=function(e,t){return t=void 0!==t?t:ca.createFolders,e=ya(e),this.files[e]||ga.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function xa(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var wa={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t},file:function(e,t,r){if(1===arguments.length){if(xa(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,ga.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(xa(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=ba.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=sa.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:aa.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");sa.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=fa.generateWorker(this,r,n)}catch(e){(t=new la("error")).error(e)}return new ua(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}},_a=wa,Ea=Mt();function Sa(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}Sa.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return Ea.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}};var Ca=Sa,ka=Ca;function Ta(e){ka.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}Mt().inherits(Ta,ka),Ta.prototype.byteAt=function(e){return this.data[this.zero+e]},Ta.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o-this.zero;return-1},Ta.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&r===o[1]&&n===o[2]&&i===o[3]},Ta.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Aa=Ta,Ma=Ca;function Oa(e){Ma.call(this,e)}Mt().inherits(Oa,Ma),Oa.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},Oa.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},Oa.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},Oa.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var La=Oa,Ra=Aa;function Ia(e){Ra.call(this,e)}Mt().inherits(Ia,Ra),Ia.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Fa=Ia,Pa=Fa;function Da(e){Pa.call(this,e)}Mt().inherits(Da,Pa),Da.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var Na=Da,Ba=Mt(),Ua=se,za=Aa,Xa=La,Ha=Na,Ga=Fa,ja=function(e){var t=Ba.getTypeOf(e);return Ba.checkSupport(t),"string"!==t||Ua.uint8array?"nodebuffer"===t?new Ha(e):Ua.uint8array?new Ga(Ba.transformTo("uint8array",e)):new za(Ba.transformTo("array",e)):new Xa(e)},Ya=ja,Wa=Mt(),Va=fr,qa=er,Ka=oe,Za=Cr,Ja=se;function Qa(e,t){this.options=e,this.loadOptions=t}Qa.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in Za)if(Object.prototype.hasOwnProperty.call(Za,t)&&Za[t].magic===e)return Za[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+Wa.pretty(this.compressionMethod)+" unknown (inner file : "+Wa.transformTo("string",this.fileName)+")");this.decompressed=new Va(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=Ya(this.extraFields[1].value);this.uncompressedSize===Wa.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===Wa.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===Wa.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===Wa.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=Ja.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Ka.utf8decode(this.fileName),this.fileCommentStr=Ka.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=Wa.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=Wa.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=Ya(e.value);return 1!==t.readInt(1)||qa(this.fileName)!==t.readInt(4)?null:Ka.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=Ya(e.value);return 1!==t.readInt(1)||qa(this.fileComment)!==t.readInt(4)?null:Ka.utf8decode(t.readData(e.length-5))}return null}};var $a=Qa,es=ja,ts=Mt(),rs=jo,ns=$a,is=se;function os(e){this.files=[],this.loadOptions=e}os.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+ts.pretty(t)+", expected "+ts.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=is.uint8array?"uint8array":"array",r=ts.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(rs.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(rs.CENTRAL_FILE_HEADER);)(e=new ns({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(rs.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,rs.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(rs.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===ts.MAX_VALUE_16BITS||this.diskWithCentralDirStart===ts.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===ts.MAX_VALUE_16BITS||this.centralDirRecords===ts.MAX_VALUE_16BITS||this.centralDirSize===ts.MAX_VALUE_32BITS||this.centralDirOffset===ts.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(rs.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(rs.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,rs.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(rs.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(rs.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(n>0)this.isSignature(t,rs.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=es(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var as=os,ss=Mt(),ls=At,us=oe,cs=as,hs=ir,ds=Ct;function fs(e){return new ls.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new hs);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}function ps(){if(!(this instanceof ps))return new ps;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new ps;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}ps.prototype=_a,ps.prototype.loadAsync=function(e,t){var r=this;return t=ss.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:us.utf8decode}),ds.isNode&&ds.isStream(e)?ls.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):ss.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new cs(t);return r.load(e),r})).then((function(e){var r=[ls.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var i=0;i<n.length;i++)r.push(fs(n[i]));return ls.Promise.all(r)})).then((function(e){for(var n=e.shift(),i=n.files,o=0;o<i.length;o++){var a=i[o],s=a.fileNameStr,l=ss.resolve(a.fileNameStr);r.file(l,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(r.file(l).unsafeOriginalName=s)}return n.zipComment.length&&(r.comment=n.zipComment),r}))},ps.support=se,ps.defaults=Vt,ps.version="3.10.1",ps.loadAsync=function(e,t){return(new ps).loadAsync(e,t)},ps.external=At;var vs=te(ps),gs=!1,ms={debug:!1,offscreenCanvas:!1,tile:!1,deltaTime:8,maxTextureSize:8192,get MAX_TEXTURE_SIZE(){return this.maxTextureSize},set MAX_TEXTURE_SIZE(e){this.maxTextureSize=e,gs=!0},MAX_TEXTURE_UNITS:8,MAX_VARYING_VECTORS:15,init:function(e,t,r){gs?e<this.maxTextureSize&&(this.maxTextureSize=e):this.maxTextureSize=e,this.MAX_TEXTURE_UNITS=t,this.MAX_VARYING_VECTORS=r},treeLvPadding:16,historyTime:1e3,guidesSnap:8},ys={}.toString;function bs(e){return function(t){return ys.call(t)==="[object "+e+"]"}}var xs,ws=bs("Object"),_s=bs("String"),Es=(xs=["Function","AsyncFunction","GeneratorFunction"],function(e){for(var t=ys.call(e),r=0,n=xs.length;r<n;r++)if(t==="[object "+xs[r]+"]")return!0;return!1}),Ss=bs("Number"),Cs=bs("Boolean"),ks=bs("Date"),Ts={}.hasOwnProperty,As=Ts.toString,Ms=As.call(Object);function Os(e){return null==e}function Ls(e){if(!e||"[object Object]"!==ys.call(e))return!1;var t=Object.getPrototypeOf(e);if(!t)return!0;var r=Ts.call(t,"constructor")&&t.constructor;return"function"==typeof r&&As.call(r)===Ms}function Rs(e){if(Os(e)||"object"!=typeof e)return e;if(ks(e))return new Date(e);if(!Ls(e)&&!Array.isArray(e))return e;var t=Array.isArray(e)?[]:{};return Object.keys(e).forEach((function(r){t[r]=Rs(e[r])})),t}function Is(e,t,r){if(e===t)return!0;if(ws(e)&&ws(t)){for(var n={},i=r||Object.keys(e),o=0,a=i.length;o<a;o++){var s=i[o];if(!t.hasOwnProperty(s)||!Is(e[s],t[s]))return!1;n[s]=!0}for(o=0,a=(i=r||Object.keys(t)).length;o<a;o++){s=i[o];if(!n.hasOwnProperty(s))return!1}return!0}if(ks(e)&&ks(t))return e.getTime()===t.getTime();if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(o=0,a=e.length;o<a;o++)if(!Is(e[o],t[o]))return!1;return!0}return e===t}var Fs={isNil:Os,isString:_s,isNumber:Ss,isObject:ws,isBoolean:Cs,isDate:ks,isFunction:Es,isPlainObject:Ls,equal:Is,extend:function(e,t,r){if(null===t||"object"!=typeof t)return e;r||(r=Object.keys(t));for(var n=0,i=r.length;n<i;){var o=r[n];e[o]=t[o],n++}return e},clone:Rs},Ps=1e3/60,Ds={},Ns="function"==typeof OffscreenCanvas&&OffscreenCanvas.prototype.getContext;var Bs,Us,zs,Xs,Hs,Gs,js,Ys,Ws,Vs,qs,Ks,Zs,Js,Qs,$s,el,tl,rl,nl={},il={},ol={},al=0,sl=0,ll=[],ul=0,cl=[],hl={requestAnimationFrame:function(e){return e?("undefined"!=typeof requestAnimationFrame?(hl.requestAnimationFrame=requestAnimationFrame.bind(null),t=requestAnimationFrame(e)):(t=setTimeout(e,Ps),hl.requestAnimationFrame=function(e){return setTimeout(e,Ps)}),t):-1;var t},cancelAnimationFrame:function(e){var t;return"undefined"!=typeof cancelAnimationFrame?(hl.cancelAnimationFrame=cancelAnimationFrame.bind(null),t=cancelAnimationFrame(e)):(t=clearTimeout(e),hl.cancelAnimationFrame=function(e){return clearTimeout(e)}),t},now:function(){return"undefined"!=typeof performance?(hl.now=function(){return Math.floor(performance.now())},Math.floor(performance.now())):(hl.now=Date.now.bind(Date),Date.now())},hasOffscreenCanvas:function(e){return e&&Ds.hasOwnProperty(e)},getOffscreenCanvas:function(e,t,r,n){return function(e,t,r,n){var i;i=r?Ds[r]?Ds[r]:Ds[r]=!ms.debug&&ms.offscreenCanvas&&Ns?new OffscreenCanvas(e,t):document.createElement("canvas"):!ms.debug&&ms.offscreenCanvas&&Ns?new OffscreenCanvas(e,t):document.createElement("canvas"),e=Math.ceil(e),t=Math.ceil(t),i.width=e,i.height=t,i.style.position="fixed",i.style.left="9999px",i.style.webkitFontSmoothing="antialiased",ms.debug&&(i.style.width=e+"px",i.style.height=t+"px",r&&i.setAttribute("key",r)),document.body.appendChild(i);var o=i.getContext("2d",n);return o||hl.error("Total canvas memory use exceeds the maximum limit"),{canvas:i,ctx:o,available:!0,release:function(){this.available&&!ms.debug&&(this.available=!1,o.globalAlpha=1,o.globalCompositeOperation="source-over",o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,e,t),i.width=i.height=0,document.body.removeChild(i),i=null)}}}(e,t,r,n)},isWebGLTexture:function(e){if(e&&"undefined"!=typeof WebGLTexture)return e instanceof WebGLTexture},defaultFontFamily:"Arial",defaultFontSize:16,getFontCanvas:function(){return hl.getOffscreenCanvas(16,16,"__$$CHECK_SUPPORT_FONT_FAMILY$$__",{willReadFrequently:!0})},checkSupportFontFamily:function(e){if(e===this.defaultFontFamily)return!0;if(nl.hasOwnProperty(e))return nl[e];var t=hl.getFontCanvas().ctx;t.textAlign="center",t.fillStyle="#000",t.textBaseline="middle",Bs||(t.clearRect(0,0,16,16),t.font="16px "+this.defaultFontFamily,t.fillText("a",8,8),Bs=t.getImageData(0,0,16,16).data),t.clearRect(0,0,16,16),/\s/.test(e)&&(e='"'+e.replace(/"/g,'\\"')+'"'),t.font="16px "+e+","+this.defaultFontFamily,t.fillText("a",8,8);for(var r=t.getImageData(0,0,16,16).data,n=0,i=r.length;n<i;n++)if(Bs[n]!==r[n])return nl[e]=!0;return nl[e]=!1},FONT:ol,loadFont:function(e,t,r){if(Es(t)&&(r=t,t=e),Array.isArray(t)){if(!t.length)return r&&r(null);var n=0,i=t.length,o=[];t.forEach((function(e,t){hl.loadFont(e.fontFamily,e.url,(function(e){o[t]=e,++n===i&&r&&r(o)}))}))}else{if(!t||!_s(t))return hl.error("Load font invalid: "+t),void(r&&r({state:2,success:!1,url:t}));var a=ol[t]=ol[t]||{state:0,task:[]};if(2===a.state)r&&r(a);else if(1===a.state)r&&a.task.push(r);else{if(a.state=1,r&&a.task.push(r),al>0&&ul>=al)return void cl.push({fontFamily:e,url:t});function s(e,t,r){if(t instanceof ArrayBuffer)i(t);else{var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){n.response?i(n.response):o()},n.onerror=o,n.send()}function i(n){var i=new FontFace(e,n);if(i.load().then((function(){"undefined"!=typeof document&&document.fonts.add(i),r.state=2,r.success=!0,r.url=t,r.arrayBuffer=n,r.task.splice(0).forEach((function(e){return e(r)}))})).catch(o),ul++,cl.length){var a=cl.shift();s(a.fontFamily,a.url,ol[a.url])}}function o(){if(r.state=2,r.success=!1,r.url=t,r.task.splice(0).forEach((function(e){return e(r)})),ul--,cl.length){var e=cl.shift();s(e.fontFamily,e.url,ol[e.url])}}}ul++,s(e,t,a)}}},addArrayBufferFont:function(e,t){if("undefined"!=typeof document&&"undefined"!=typeof FontFace){var r=new FontFace(e,t);document.fonts.add(r)}},addLocalFont:function(e){if("undefined"!=typeof document&&"undefined"!=typeof FontFace){var t=new FontFace(e,"local(".concat(e));document.fonts.add(t)}},IMG:il,INIT:0,LOADED:2,LOADING:1,get MAX_LOAD_NUM(){return al},set MAX_LOAD_NUM(e){al=parseInt(e)||0},loadImg:function(e,t){if(Array.isArray(e)){if(!e.length)return t&&t([]);var r=0,n=e.length,i=[];e.forEach((function(e,o){hl.loadImg(e,(function(e){i[o]=e,++r===n&&t&&t(i)}))}))}else{if(!e||!_s(e))return hl.error("Loadimg failed: "+e),void(t&&t({state:2,success:!1,url:e}));var o=il[e]=il[e]||{state:0,task:[]};if(2===o.state)t&&t(o);else if(1===o.state)t&&o.task.push(t);else{if(o.state=1,t&&o.task.push(t),al>0&&sl>=al)return void ll.push(e);function a(e,t){var r=new Image;if(r.onload=function(){if(t.state=2,t.success=!0,t.width=r.width,t.height=r.height,t.source=r,t.url=e,t.task.splice(0).forEach((function(e){e(t)})),sl--,ll.length){var n=ll.shift();a(n,il[n])}},r.onerror=function(){(t.state=2,t.success=!1,t.url=e,t.task.splice(0).forEach((function(e){return e(t)})),sl--,ll.length)&&a(ll.shift(),t)},"data:"!==e.substr(0,5)){var n=/^(?:\w+:)?\/\/([^/:]+)/.exec(e);n&&("undefined"!=typeof location&&location.hostname===n[1]||(r.crossOrigin="anonymous"))}r.src=e}sl++,a(e,o)}}},loadArrayBufferImg:function(e){return J(this,void 0,void 0,(function(){var t,r;return Q(this,(function(n){return t=new Blob([e]),r=new Image,[2,new Promise((function(e,n){r.onload=function(){e(r)},r.onerror=function(e){n(e)},r.src=URL.createObjectURL(t)}))]}))}))},pdfjsLibWorkerSrc:"https://gw.alipayobjects.com/os/lib/pdfjs-dist/3.11.174/build/pdf.worker.min.js",loadArrayBufferPdf:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,u;return Q(this,(function(c){switch(c.label){case 0:return(t=window.pdfjsLib).GlobalWorkerOptions.workerSrc=hl.pdfjsLibWorkerSrc,r=new Blob([e]),n=URL.createObjectURL(r),[4,t.getDocument(n).promise];case 1:return[4,c.sent().getPage(1)];case 2:return i=c.sent(),o=i.getViewport({scale:1}),(a=document.createElement("canvas")).width=o.width,a.height=o.height,s=a.getContext("2d"),[4,i.render({viewport:o,canvasContext:s,background:"transparent"}).promise];case 3:return c.sent(),[4,new Promise((function(e,t){a.toBlob((function(r){r?e(r):t()}))}))];case 4:return l=c.sent(),u=new Image,[2,new Promise((function(e,t){u.onload=function(){e(u)},u.onerror=function(e){t(e)},u.src=URL.createObjectURL(l)}))]}}))}))},loadLocalFonts:function(){return J(this,void 0,void 0,(function(){var e;return Q(this,(function(t){switch(t.label){case 0:if("undefined"==typeof navigator)return[3,5];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,navigator.permissions.query({name:"local-fonts"})];case 2:return"denied"===t.sent().state?(hl.error("No Permission."),[2,[]]):[4,window.queryLocalFonts()];case 3:return[2,t.sent()];case 4:return e=t.sent(),hl.error(e),[2,[]];case 5:return[2,[]]}}))}))},log:function(e){console.log(e)},warn:function(e){console.warn(e)},error:function(e){console.error(e)}};function dl(e,t){if(void 0===t&&(t=!1),"auto"===e)return{v:0,u:Us.AUTO};var r=parseFloat(e)||0;return/%$/.test(e)?{v:r,u:Us.PERCENT}:/px$/i.test(e)?{v:r,u:Us.PX}:/deg$/i.test(e)?{v:r,u:t?Us.PX:Us.DEG}:{v:r,u:t?Us.PX:Us.NUMBER}}!function(e){e[e.AUTO=0]="AUTO",e[e.PX=1]="PX",e[e.PERCENT=2]="PERCENT",e[e.NUMBER=3]="NUMBER",e[e.DEG=4]="DEG",e[e.RGBA=5]="RGBA",e[e.BOOLEAN=6]="BOOLEAN",e[e.STRING=7]="STRING",e[e.GRADIENT=8]="GRADIENT",e[e.BLUR=9]="BLUR",e[e.PATTERN=10]="PATTERN",e[e.SHADOW=11]="SHADOW",e[e.MATRIX=12]="MATRIX"}(Us||(Us={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.CENTER=2]="CENTER",e[e.JUSTIFY=3]="JUSTIFY"}(zs||(zs={})),function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM"}(Xs||(Xs={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.MULTIPLY=1]="MULTIPLY",e[e.SCREEN=2]="SCREEN",e[e.OVERLAY=3]="OVERLAY",e[e.DARKEN=4]="DARKEN",e[e.LIGHTEN=5]="LIGHTEN",e[e.COLOR_DODGE=6]="COLOR_DODGE",e[e.COLOR_BURN=7]="COLOR_BURN",e[e.HARD_LIGHT=8]="HARD_LIGHT",e[e.SOFT_LIGHT=9]="SOFT_LIGHT",e[e.DIFFERENCE=10]="DIFFERENCE",e[e.EXCLUSION=11]="EXCLUSION",e[e.HUE=12]="HUE",e[e.SATURATION=13]="SATURATION",e[e.COLOR=14]="COLOR",e[e.LUMINOSITY=15]="LUMINOSITY"}(Hs||(Hs={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ITALIC=1]="ITALIC",e[e.OBLIQUE=2]="OBLIQUE"}(Gs||(Gs={})),function(e){e[e.LINEAR=0]="LINEAR",e[e.RADIAL=1]="RADIAL",e[e.CONIC=2]="CONIC"}(js||(js={})),function(e){e[e.NONE=0]="NONE",e[e.GAUSSIAN=1]="GAUSSIAN",e[e.MOTION=2]="MOTION",e[e.RADIAL=3]="RADIAL",e[e.BACKGROUND=4]="BACKGROUND"}(Ys||(Ys={})),function(e){e[e.NONE=0]="NONE",e[e.UNION=1]="UNION",e[e.SUBTRACT=2]="SUBTRACT",e[e.INTERSECT=3]="INTERSECT",e[e.XOR=4]="XOR"}(Ws||(Ws={})),function(e){e[e.NONE=0]="NONE",e[e.STRAIGHT=1]="STRAIGHT",e[e.MIRRORED=2]="MIRRORED",e[e.ASYMMETRIC=3]="ASYMMETRIC",e[e.DISCONNECTED=4]="DISCONNECTED"}(Vs||(Vs={})),function(e){e[e.ROUNDED=0]="ROUNDED",e[e.ROUNDED_INVERTED=1]="ROUNDED_INVERTED",e[e.ANGLED=2]="ANGLED",e[e.SQUARED=3]="SQUARED"}(qs||(qs={})),function(e){e[e.NON_ZERO=0]="NON_ZERO",e[e.EVEN_ODD=1]="EVEN_ODD"}(Ks||(Ks={})),function(e){e[e.NONE=0]="NONE",e[e.OUTLINE=1]="OUTLINE",e[e.ALPHA=2]="ALPHA",e[e.GRAY=3]="GRAY"}(Zs||(Zs={})),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE"}(Js||(Js={})),function(e){e[e.MITER=0]="MITER",e[e.ROUND=1]="ROUND",e[e.BEVEL=2]="BEVEL"}(Qs||(Qs={})),function(e){e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.OUTSIDE=2]="OUTSIDE"}($s||($s={})),function(e){e[e.TILE=0]="TILE",e[e.FILL=1]="FILL",e[e.STRETCH=2]="STRETCH",e[e.FIT=3]="FIT"}(el||(el={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN"}(tl||(tl={})),function(e){e[e.AUTO=0]="AUTO",e[e.FIXED_W=1]="FIXED_W",e[e.FIXED_W_H=2]="FIXED_W_H"}(rl||(rl={}));var fl,pl,vl={StyleUnit:Us,calUnit:dl,TEXT_ALIGN:zs,TEXT_VERTICAL_ALIGN:Xs,MIX_BLEND_MODE:Hs,FONT_STYLE:Gs,GRADIENT:js,BLUR:Ys,BOOLEAN_OPERATION:Ws,CURVE_MODE:Vs,CORNER_STYLE:qs,FILL_RULE:Ks,MASK:Zs,STROKE_LINE_CAP:Js,STROKE_LINE_JOIN:Qs,STROKE_POSITION:$s,PATTERN_FILL_TYPE:el,TEXT_BEHAVIOUR:rl,VISIBILITY:tl};!function(e){e[e.NONE=0]="NONE",e[e.UNDERLINE=1]="UNDERLINE",e[e.LINE_THROUGH=2]="LINE_THROUGH"}(fl||(fl={})),function(e){e[e.DISABLED=-1]="DISABLED",e[e.LEGACY=0]="LEGACY",e[e.ROUNDED=1]="ROUNDED",e[e.SMOOTH=2]="SMOOTH"}(pl||(pl={}));var gl=function(){var e=0,t=-3;function r(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new r,this.dtree=new r}var i=new r,o=new r,a=new Uint8Array(30),s=new Uint16Array(30),l=new Uint8Array(30),u=new Uint16Array(30),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new r,d=new Uint8Array(320);function f(e,t,r,n){var i,o;for(i=0;i<r;++i)e[i]=0;for(i=0;i<30-r;++i)e[i+r]=i/r|0;for(o=n,i=0;i<30;++i)t[i]=o,o+=1<<e[i]}var p=new Uint16Array(16);function v(e,t,r,n){var i,o;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<n;++i)e.table[t[r+i]]++;for(e.table[0]=0,o=0,i=0;i<16;++i)p[i]=o,o+=e.table[i];for(i=0;i<n;++i)t[r+i]&&(e.trans[p[t[r+i]]++]=i)}function g(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function m(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,n+r}function y(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=0,n=0,i=0,o=e.tag;do{n=2*n+(1&o),o>>>=1,++i,r+=t.table[i],n-=t.table[i]}while(n>=0);return e.tag=o,e.bitcount-=i,t.trans[r+n]}function b(e,t,r){var n,i,o,a,s,l;for(n=m(e,5,257),i=m(e,5,1),o=m(e,4,4),a=0;a<19;++a)d[a]=0;for(a=0;a<o;++a){var u=m(e,3,0);d[c[a]]=u}for(v(h,d,0,19),s=0;s<n+i;){var f=y(e,h),p=void 0;switch(f){case 16:for(p=d[s-1],l=m(e,2,3);l;--l)d[s++]=p;break;case 17:for(l=m(e,3,3);l;--l)d[s++]=0;break;case 18:for(l=m(e,7,11);l;--l)d[s++]=0;break;default:d[s++]=f}}v(t,d,0,n),v(r,d,n,i)}function x(t,r,n){for(;;){var i=y(t,r);if(256===i)return e;if(i<256)t.dest[t.destLen++]=i;else{var o,c,h,d=void 0;for(o=m(t,a[i-=257],s[i]),c=y(t,n),d=h=t.destLen-m(t,l[c],u[c]);d<h+o;++d)t.dest[t.destLen++]=t.dest[d]}}}function w(r){for(var n,i;r.bitcount>8;)r.sourceIndex--,r.bitcount-=8;if((n=256*(n=r.source[r.sourceIndex+1])+r.source[r.sourceIndex])!==(65535&~(256*r.source[r.sourceIndex+3]+r.source[r.sourceIndex+2])))return t;for(r.sourceIndex+=4,i=n;i;--i)r.dest[r.destLen++]=r.source[r.sourceIndex++];return r.bitcount=0,e}return function(e,t){var r;for(r=0;r<7;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;r<24;++r)e.trans[r]=256+r;for(r=0;r<144;++r)e.trans[24+r]=r;for(r=0;r<8;++r)e.trans[168+r]=280+r;for(r=0;r<112;++r)e.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}(i,o),f(a,s,4,3),f(l,u,2,1),a[28]=0,s[28]=258,function(r,a){var s,l,u=new n(r,a);do{switch(s=g(u),m(u,2,0)){case 0:l=w(u);break;case 1:l=x(u,i,o);break;case 2:b(u,u.ltree,u.dtree),l=x(u,u.ltree,u.dtree);break;default:l=t}if(l!==e)throw new Error("Data error")}while(!s);return u.destLen<u.dest.length?"function"==typeof u.dest.slice?u.dest.slice(0,u.destLen):u.dest.subarray(0,u.destLen):u.dest}}(),ml={UTF16:function(e,t,r){for(var n=[],i=r/2,o=0;o<i;o++,t+=2)n[o]=e.getUint16(t);return String.fromCharCode.apply(null,n)}},yl={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};function bl(e,t){for(var r="",n=t;n<t+4;n++)r+=String.fromCharCode(e.getInt8(n));return r}function xl(e,t){return e.getUint16(t,!1)}function wl(e,t){return e.getUint32(t,!1)}ml.MACSTRING=function(e,t,r,n){var i=yl[n];if(void 0!==i){for(var o="",a=0;a<r;a++){var s=e.getUint8(t+a);o+=s<=127?String.fromCharCode(s):i[127&s]}return o}};var _l={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function El(e,t){for(var r=[],n=12,i=0;i<t;i+=1){var o=bl(e,n),a=wl(e,n+4),s=wl(e,n+8),l=wl(e,n+12);r.push({tag:o,checksum:a,offset:s,length:l,compression:!1}),n+=16}return r}function Sl(e,t){if("WOFF"===t.compression){var r=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),n=new Uint8Array(t.length);return gl(r,n),n.byteLength!==t.length&&hl.error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length"),{data:new DataView(n.buffer,0),offset:0}}return{data:e,offset:t.offset}}var Cl=function(){function e(e,t){this.data=e,this.offset=t,this.relativeOffset=0}return e.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},e.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},e.prototype.parseULong=function(){var e=wl(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},e.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},e.prototype.parseFixed=function(){var e,t,r=(e=this.data,t=this.offset+this.relativeOffset,e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535);return this.relativeOffset+=4,r},e.prototype.parseVersion=function(e){var t=xl(this.data,this.offset+this.relativeOffset),r=xl(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+r/e/10},e.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=_l[e]*t},e}(),kl=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Tl={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Al={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},Ml={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Ol={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Ll(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return Tl[t];case 3:return Al[t]}}var Rl="utf-16";function Il(e,t,r){switch(e){case 0:return Rl;case 1:return Ol[r]||Ml[t];case 3:if(1===t||10===t)return Rl}}var Fl={0:"unicode",1:"macintosh",2:"reserved",3:"windows"};function Pl(e){return Fl[e]}function Dl(e,t){var r,n=new Cl(e,t),i=n.parseULong();r="Unsupported ltag table version.",1===i||fail(r),n.skip("uLong",1);for(var o=n.parseULong(),a=[],s=0;s<o;s++){for(var l="",u=t+n.parseUShort(),c=n.parseUShort(),h=u;h<u+c;++h)l+=String.fromCharCode(e.getInt8(h));a.push(l)}return a}var Nl={parse:function(e){var t,r,n=new DataView(e,0),i=bl(n,0),o=!1;if(i===String.fromCharCode(0,1,0,0)||"true"===i||"typ1"===i)r=El(n,t=xl(n,4));else if("OTTO"===i)r=El(n,t=xl(n,4)),o=!0;else if("wOFF"===i){var a=bl(n,4);if(a===String.fromCharCode(0,1,0,0));else if("OTTO"!==a)return void hl.error("Unsupported OpenType flavor "+i);r=function(e,t){for(var r=[],n=44,i=0;i<t;i+=1){var o=bl(e,n),a=wl(e,n+4),s=wl(e,n+8),l=wl(e,n+12),u=void 0;u=s<l&&"WOFF",r.push({tag:o,offset:a,compression:u,compressedLength:s,length:l}),n+=20}return r}(n,t=xl(n,12))}else if("wOF2"===i){hl.error("WOFF2 require an external decompressor library, see examples at: https://github.com/opentypejs/opentype.js/issues/183#issuecomment-1147228025")}else hl.error("Unsupported OpenType signature "+i);for(var s,l,u,c,h=2048,d=0,f=!1,p=0;p<t;p++){var v=r[p];if("head"===v.tag){var g=Sl(n,v);(m=new Cl(g.data,g.offset)).parseVersion(),m.parseFixed(),m.parseULong(),m.parseULong(),m.parseUShort(),h=m.parseUShort()}else if("hhea"===v.tag){if(!f){g=Sl(n,v);(m=new Cl(g.data,g.offset)).parseVersion(),s=Math.abs(m.parseShort()),l=Math.abs(m.parseShort()),d=Math.abs(m.parseShort()||0)}}else if("ltag"===v.tag){c=Dl((g=Sl(n,v)).data,g.offset)}else if("name"===v.tag)u=Sl(n,v);else if("OS/2"===v.tag){g=Sl(n,v);var m,y=(m=new Cl(g.data,g.offset)).parseUShort();m.parseShort(),m.parseUShort(),m.parseUShort(),m.parseUShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort(),m.parseShort();for(var b=0;b<10;b++)m.parseByte();m.parseULong(),m.parseULong(),m.parseULong(),m.parseULong(),m.parseByte(),m.parseByte(),m.parseByte(),m.parseByte();var x=m.parseUShort(),w=y>=4&&(128&x||o);(w||void 0===s)&&(m.parseUShort(),m.parseUShort(),s=Math.abs(m.parseShort()),l=Math.abs(m.parseShort()),d=Math.abs(m.parseShort()||0),w&&(f=!0))}}var _=u?function(e,t,r){for(var n={},i=new Cl(e,t),o=i.parseUShort(),a=i.parseUShort(),s=i.offset+i.parseUShort(),l=0;l<a;l++){var u=i.parseUShort(),c=i.parseUShort(),h=i.parseUShort(),d=i.parseUShort(),f=kl[d]||d,p=i.parseUShort(),v=i.parseUShort(),g=Ll(u,h,r),m=Il(u,c,h),y=Pl(u);if(void 0!==m&&void 0!==g&&void 0!==y){var b=void 0;if(b=m===Rl?ml.UTF16(e,s+v,p):ml.MACSTRING(e,s+v,p,m)){var x=n[y];void 0===x&&(x=n[y]={});var w=x[f];void 0===w&&(w=x[f]={}),w[g]=b}}}return 1===o&&i.parseUShort(),n}(u.data,u.offset,c):{},E={};return _.macintosh&&Object.assign(E,_.macintosh),_.windows&&Object.assign(E,_.windows),{name:E,emSquare:h,ascent:s,descent:l,lineGap:d}}},Bl={name:"Arial",family:"Arial",lhr:1.14990234375,car:1.1171875,blr:.9052734375,lgr:.03271484375,list:[{style:"Regular",postscriptName:"Arial",loaded:!0}]},Ul="localFonts",zl={Arial:Bl},Xl={Arial:Bl},Hl={KEY_INFO:Ul,info:zl,data:Xl,hasRegister:function(e){return Xl.hasOwnProperty(e)},registerLocalFonts:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l,u,c,h,d,f,p,v,g;return Q(this,(function(m){switch(m.label){case 0:return e?[3,2]:[4,hl.loadLocalFonts()];case 1:e=m.sent()||[],m.label=2;case 2:t={},"undefined"!=typeof localStorage&&(t=JSON.parse(localStorage.getItem(Ul)||"{}")),r=t.data||{},(!t.version||t.version<2)&&(r={}),n=0,i=e.length,m.label=3;case 3:return n<i?(o=e[n],a=o.postscriptName,s=o.family,l=o.style,hl.addLocalFont(a),r.hasOwnProperty(s)&&(u=r[s],zl[s]=zl[s]||{name:u.name,family:s,lhr:u.lhr,car:u.car,blr:u.blr,lgr:u.lgr,list:[]}),zl.hasOwnProperty(s)?[3,6]:(c=zl[s]={name:"",family:"",lhr:0,car:0,blr:0,lgr:0,list:[]},[4,o.blob()])):[3,8];case 4:return[4,m.sent().arrayBuffer()];case 5:h=m.sent(),(d=Nl.parse(h))&&d.name&&(c.name=(null===(p=d.name.preferredFamily)||void 0===p?void 0:p.zh)||(null===(v=d.name.preferredFamily)||void 0===v?void 0:v.en)||(null===(g=d.name.fontFamily)||void 0===g?void 0:g.zh)),c.name=c.name||s,c.family=s,f=this._cal(s,d),Object.assign(c,f),m.label=6;case 6:this._register(s,l,a,!0),m.label=7;case 7:return n++,[3,3];case 8:return this.updateLocalStorage(),[2]}}))}))},registerAb:function(e){var t,r,n,i,o,a,s,l,u={},c=Nl.parse(e);c&&c.name&&(u.family=(null===(t=c.name.preferredFamily)||void 0===t?void 0:t.en)||(null===(r=c.name.fontFamily)||void 0===r?void 0:r.en),u.name=(null===(n=c.name.preferredFamily)||void 0===n?void 0:n.zh)||(null===(i=c.name.preferredFamily)||void 0===i?void 0:i.en)||(null===(o=c.name.fontFamily)||void 0===o?void 0:o.zh)||u.family);var h=u.family,d=(null===(a=c.name.preferredSubfamily)||void 0===a?void 0:a.en)||(null===(s=c.name.fontSubfamily)||void 0===s?void 0:s.en),f=null===(l=c.name.postScriptName)||void 0===l?void 0:l.en;if(h&&d&&f){if(!zl.hasOwnProperty(h)){var p=this._cal(h,c);Object.assign(u,p),u.list=[],zl[h]=Xl[h]=u}return this._register(h,d,f,!0),hl.addArrayBufferFont(f,e),this.data[h]}},_cal:function(e,t){var r=0;return["times","helvetica","courier"].indexOf(e.toLowerCase())>-1&&(r=Math.round(.15*(t.ascent+t.descent))),{lhr:(t.ascent+r+t.descent+t.lineGap)/t.emSquare,car:(t.ascent+r+t.descent)/t.emSquare,blr:(t.ascent+r)/t.emSquare,lgr:t.lineGap/t.emSquare}},_register:function(e,t,r,n,i){for(var o=zl[e],a=o.list=o.list||[],s=!1,l=0,u=a.length;l<u;l++){var c=a[l];if(c.postscriptName===r){s=!0,n&&(c.loaded=!0);break}}return s||a.push({style:t,postscriptName:r,loaded:n,url:i}),{family:e,postscriptName:r,data:Xl[e]=Xl[r]=o}},registerData:function(e){var t=this,r=e.family;zl.hasOwnProperty(r)||(zl[r]=Xl[r]=e),e.list.forEach((function(e){t._register(r,e.style,e.postscriptName,e.loaded,e.url)}))},updateLocalStorage:function(){var e={};for(var t in zl)if(zl.hasOwnProperty(t)){var r=zl[t];e[t]={name:r.name,lhr:r.lhr,car:r.car,blr:r.blr,lgr:r.lgr}}"undefined"!=typeof localStorage&&localStorage.setItem(Ul,JSON.stringify({version:2,data:e}))}};function Gl(e,t,r,n){return e*r+t*n}function jl(e,t,r,n,i,o){return e*n+t*i+r*o}function Yl(e,t,r,n){return e*n-r*t}function Wl(e,t,r,n){var i=Gl(e,t,r,n),o=Math.pow(r,2)+Math.pow(n,2);return{x:i*r/o,y:i*n/o}}function Vl(e,t,r,n){return Math.acos(Gl(e,t,r,n)/(ql(e,t)*ql(r,n)))||0}function ql(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function Kl(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function Zl(e,t){var r=ql(e,t);return{x:e/r,y:t/r}}function Jl(e,t,r,n){return Math.abs(e)<1e-9&&Math.abs(t)<1e-9&&Math.abs(r)<1e-9&&Math.abs(n)<1e-9}function Ql(e,t,r,n,i,o){return Math.abs(e)<1e-9&&Math.abs(t)<1e-9&&Math.abs(r)<1e-9&&Math.abs(n)<1e-9&&Math.abs(i)<1e-9&&Math.abs(o)<1e-9}function $l(e,t,r,n){var i=Gl(e,t,r,n)/(ql(e,t)*ql(r,n));return i<-1?i=-1:i>1&&(i=1),Math.acos(i)}function eu(e,t,r,n,i,o){var a=jl(e,t,r,n,i,o)/(Kl(e,t,r)*Kl(n,i,o));return a<-1?a=-1:a>1&&(a=1),Math.acos(a)}var tu={dotProduct:Gl,dotProduct3:jl,crossProduct:Yl,crossProduct3:function(e,t,r,n,i,o){return{x:t*o-i*r,y:r*n-o*e,z:e*i-n*t}},projection:Wl,includedAngle:Vl,length:ql,length3:Kl,unitize:Zl,unitize3:function(e,t,r){var n=Kl(e,t,r);return{x:e/n,y:t/n,z:r/n}},angle:$l,angle3:eu,isParallel:function(e,t,r,n){if(Jl(e,t,r,n))return!0;var i=$l(e,t,r,n);return Math.abs(i)<1e-9||Math.PI-Math.abs(i)<1e-9},isParallel3:function(e,t,r,n,i,o){if(Ql(e,t,r,n,i,o))return!0;var a=eu(e,t,r,n,i,o);return Math.abs(a)<1e-9||Math.PI-Math.abs(a)<1e-9},isZero:Jl,isZero3:Ql};function ru(){return new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function nu(e){return!e||!e.length||1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]}function iu(e,t){if(nu(e))return new Float64Array(t);if(nu(t))return new Float64Array(e);for(var r=ru(),n=0;n<4;n++){var i=e[n],o=e[n+4],a=e[n+8],s=e[n+12];r[n]=i*t[0]+o*t[1]+a*t[2]+s*t[3],r[n+4]=i*t[4]+o*t[5]+a*t[6]+s*t[7],r[n+8]=i*t[8]+o*t[9]+a*t[10]+s*t[11],r[n+12]=i*t[12]+o*t[13]+a*t[14]+s*t[15]}return r}function ou(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function au(e){if(nu(e))return ru();var t=new Float64Array(16);t[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],t[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],t[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],t[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],t[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],t[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],t[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],t[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],t[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],t[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],t[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],t[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],t[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],t[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];var r=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12];if(0===r)return ru();r=1/r;for(var n=new Float64Array(16),i=0;i<16;i++)n[i]=t[i]*r;return n}function su(e,t){return e&&t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e}function lu(e,t,r){return t||r?(e[12]+=e[0]*t+e[4]*r,e[13]+=e[1]*t+e[5]*r,e[14]+=e[2]*t+e[6]*r,e[15]+=e[3]*t+e[7]*r,e):e}function uu(e,t,r){if(!e&&!t)return r;var n=r[3],i=r[7],o=r[11],a=r[15];return r[0]+=n*e,r[1]+=n*t,r[4]+=i*e,r[5]+=i*t,r[8]+=o*e,r[9]+=o*t,r[12]+=a*e,r[13]+=a*t,r}function cu(e,t){if(!t)return e;var r=Math.sin(t),n=Math.cos(t),i=e[0],o=e[1],a=e[2],s=e[3],l=e[4],u=e[5],c=e[6],h=e[7];return e[0]=i*n+l*r,e[1]=o*n+u*r,e[2]=a*n+c*r,e[3]=s*n+h*r,e[4]=i*-r+l*n,e[5]=o*-r+u*n,e[6]=a*-r+c*n,e[7]=s*-r+h*n,e}function hu(e,t){return 1===t||(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t),e}function du(e,t){return 1===t||(e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t),e}function fu(e,t){return 1===t||(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t),e}function pu(e,t){if(t&&!nu(t)){var r=e.x,n=e.y,i=t[0],o=t[1],a=t[4],s=t[5];return{x:(1===i?r:r*i)+(a?n*a:0)+t[12],y:(1===o?r:r*o)+(s?n*s:0)+t[13]}}return e}function vu(e){if(16===e.length)return au(e);var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5];if(1===t&&0===r&&0===n&&1===i&&0===o&&0===a)return e;var s=t*i-r*n;return 0===s?e:new Float64Array([i/s,-r/s,-n/s,t/s,(n*a-i*o)/s,(r*o-t*a)/s])}function gu(e,t,r,n,i){var o,a,s,l,u=pu({x:e,y:t},i),c=u.x,h=u.y,d=pu({x:r,y:n},i),f=d.x,p=d.y;if(i&&i.length&&(i[1]||i[2]||i[4]||i[6]||i[7]||i[8])){var v=pu({x:r,y:t},i);o=v.x,a=v.y,s=(v=pu({x:e,y:n},i)).x,l=v.y}else o=f,a=h,s=c,l=p;return{x1:c,y1:h,x2:o,y2:a,x3:f,y3:p,x4:s,y4:l}}var mu={identity:ru,isE:nu,toE:ou,assignMatrix:su,inverse:vu,inverse4:au,calPoint:pu,calRectPoints:gu,tfoMultiply:uu,multiplyTfo:lu,multiply:iu,multiplyRef:function(e,t){if(nu(e))return t;if(nu(t))return su(t,e),t;for(var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],v=t[13],g=t[14],m=t[15],y=0;y<4;y++){var b=e[y],x=e[y+4],w=e[y+8],_=e[y+12];t[y]=b*r+x*n+w*i+_*o,t[y+4]=b*a+x*s+w*l+_*u,t[y+8]=b*c+x*h+w*d+_*f,t[y+12]=b*p+x*v+w*g+_*m}return t},multiplyTranslate:function(e,t,r){return t||r?(e[12]+=e[0]*t+e[4]*r,e[13]+=e[1]*t+e[5]*r,e[14]+=e[2]*t+e[6]*r,e[15]+=e[3]*t+e[7]*r,e):e},multiplyTranslateX:function(e,t){return t?(e[12]+=e[0]*t,e[13]+=e[1]*t,e[14]+=e[2]*t,e[15]+=e[3]*t,e):e},multiplyTranslateY:function(e,t){return t?(e[12]+=e[4]*t,e[13]+=e[5]*t,e[14]+=e[6]*t,e[15]+=e[7]*t,e):e},multiplyRotateZ:cu,multiplyScale:fu,multiplyScaleX:hu,multiplyScaleY:du},yu=1e-9;function bu(e){var t=[],r=e[3],n=e[2]/r,i=e[1]/r,o=(3*i-n*n)/3,a=(2*n*n*n-9*i*n+27*(e[0]/r))/27,s=n/3,l=a*a/4+o*o*o/27,u=a/2;if(Math.abs(l)<=yu&&(l=0),l>0){var c=Math.sqrt(l),h=void 0,d=void 0;d=(h=-u+c)>=0?Math.pow(h,1/3):-Math.pow(-h,1/3),(h=-u-c)>=0?d+=Math.pow(h,1/3):d-=Math.pow(-h,1/3),t.push(d-s)}else if(l<0){var f=Math.sqrt(-o/3),p=Math.atan2(Math.sqrt(-l),-u)/3,v=Math.cos(p),g=Math.sin(p),m=Math.sqrt(3);t.push(2*f*v-s),t.push(-f*(v+m*g)-s),t.push(-f*(v-m*g)-s)}else{h=void 0;h=u>=0?-Math.pow(u,1/3):Math.pow(-u,1/3),t.push(2*h-s),t.push(-h-s)}return t}function xu(e){for(var t=e.length-1,r=t;r>=0&&Math.abs(e[r])<1e-12;r--)t--;var n=[];switch(t){case 1:n=function(e){var t=[],r=e[1];return 0!==r&&t.push(-e[0]/r),t}(e);break;case 2:n=function(e){var t=[],r=e[2],n=e[1]/r,i=n*n-e[0]/r*4;if(i>0){var o=Math.sqrt(i);t.push(.5*(-n+o)),t.push(.5*(-n-o))}else 0===i&&t.push(.5*-n);return t}(e);break;case 3:n=bu(e);break;case 4:n=function(e){var t=[],r=e[4],n=e[3]/r,i=e[2]/r,o=e[1]/r,a=e[0]/r,s=bu([1,-i,n*o-4*a,-n*n*a+4*i*a-o*o].reverse())[0],l=n*n/4-i+s;if(Math.abs(l)<=yu&&(l=0),l>0){var u=Math.sqrt(l),c=(p=3*n*n/4-u*u-2*i)+(f=(4*n*i-8*o-n*n*n)/(4*u)),h=p-f;if(Math.abs(c)<=yu&&(c=0),Math.abs(h)<=yu&&(h=0),c>=0){var d=Math.sqrt(c);t.push(-n/4+(u+d)/2),t.push(-n/4+(u-d)/2)}h>=0&&(d=Math.sqrt(h),t.push(-n/4+(d-u)/2),t.push(-n/4-(d+u)/2))}else if(l<0);else{var f;if((f=s*s-4*a)>=-yu){var p;if(f<0&&(f=0),(p=3*n*n/4-2*i)+(f=2*Math.sqrt(f))>=yu){var v=Math.sqrt(p+f);t.push(-n/4+v/2),t.push(-n/4-v/2)}p-f>=yu&&(v=Math.sqrt(p-f),t.push(-n/4+v/2),t.push(-n/4-v/2))}}return t}(e)}return n}function wu(e,t,r,n){return[n-t,e-r,t*(r-e)-e*(n-t)]}function _u(e,t,r){return[r,-1,t-r*e]}var Eu={getRoots:xu,twoPoint2General:wu,pointSlope2General:_u};function Su(e,t,r,n,i,o,a,s){var l=arguments.length;if(4===l||void 0===i)return[Math.min(e,r),Math.min(t,n),Math.max(e,r),Math.max(t,n)];if(6===l||void 0===a)return function(e,t,r,n,i,o){var a=Math.min(e,i),s=Math.min(t,o),l=Math.max(e,i),u=Math.max(t,o);if(r<a||n<s||r>l||n>u){var c=(e-r)/(e-2*r+i);isNaN(c)||c<0?c=0:c>1&&(c=1);var h=(t-n)/(t-2*n+o);isNaN(h)||h<0?h=0:h>1&&(h=1);var d=1-c,f=1-h,p=d*d*e+2*d*c*r+c*c*i,v=f*f*t+2*f*h*n+h*h*o;a=Math.min(a,p),s=Math.min(s,v),l=Math.max(l,p),u=Math.max(u,v)}return[a,s,l,u]}(e,t,r,n,i,o);if(8===l)return function(e,t,r,n,i,o,a,s){var l=Math.min(e,a),u=Math.min(t,s),c=Math.max(e,a),h=Math.max(t,s);if(r<l||n<u||r>c||n>h||i<l||o<u||i>c||o>h){var d,f=-e+r,p=-t+n,v=e-2*r+i,g=t-2*n+o,m=3*r-e-3*i+a,y=3*n-t-3*o+s,b=v*v-m*f,x=g*g-y*p;if(b>0){var w=(-v-(b=Math.sqrt(b)))/m;if(m&&w>0&&w<1){var _=(d=1-w)*d*d*e+3*d*d*w*r+3*d*w*w*i+w*w*w*a;l=Math.min(l,_),c=Math.max(c,_)}(w=m?(-v+b)/m:.5*-f/v)>0&&w<1&&(_=(d=1-w)*d*d*e+3*d*d*w*r+3*d*w*w*i+w*w*w*a,l=Math.min(l,_),c=Math.max(c,_))}if(x>0)if(w=(-g-(x=Math.sqrt(x)))/y,y&&w>0&&w<1&&(_=(d=1-w)*d*d*t+3*d*d*w*n+3*d*w*w*o+w*w*w*s,u=Math.min(u,_),h=Math.max(h,_)),(w=y?(-g+x)/y:.5*-p/g)>0&&w<1)_=(d=1-w)*d*d*t+3*d*d*w*n+3*d*w*w*o+w*w*w*s,u=Math.min(u,_),h=Math.max(h,_)}return[l,u,c,h]}(e,t,r,n,i,o,a,s);throw new Error("Unsupported order")}function Cu(e,t,r){var n=e,i=(2*t+r)/3,o=(t+2*r)/3;return(n(t)+3*n(i)+3*n(o)+n(r))*(r-t)/8}function ku(e,t,r,n){void 0===n&&(n=.001);var i=e,o=(t+r)/2,a=Cu(i,t,r),s=Cu(i,t,o),l=Cu(i,o,r),u=s+l-a;return Math.abs(u)<=15*n?s+l+u/15:ku(i,t,o,n/2)+ku(i,o,r,n/2)}function Tu(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=1),2===e.length){var n=e[0],i=n.x,o=n.y,a=e[1],s=a.x,l=a.y;return Math.sqrt(Math.pow(s-i,2)+Math.pow(l-o,2))}if(e.length>4)throw new Error("Unsupported order");return ku((function(t){var r=Au(t,e);return Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))}),t,r)}function Au(e,t,r){if(void 0===r&&(r=1),4===t.length)return function(e,t,r){void 0===r&&(r=1);var n=t[0],i=n.x,o=n.y,a=t[1],s=a.x,l=a.y,u=t[2],c=u.x,h=u.y,d=t[3],f=d.x,p=d.y,v=0,g=0;return 0===r?(v=Math.pow(1-e,3)*i+3*e*Math.pow(1-e,2)*s+3*(1-e)*Math.pow(e,2)*c+Math.pow(e,3)*f,g=Math.pow(1-e,3)*o+3*e*Math.pow(1-e,2)*l+3*(1-e)*Math.pow(e,2)*h+Math.pow(e,3)*p):1===r?(v=3*((1-e)*(1-e)*(s-i)+2*(1-e)*e*(c-s)+e*e*(f-c)),g=3*((1-e)*(1-e)*(l-o)+2*(1-e)*e*(h-l)+e*e*(p-h))):2===r?(v=6*(c-2*s+i)*(1-e)+6*(f-2*c+s)*e,g=6*(h-2*l+o)*(1-e)+6*(p-2*h+l)*e):3===r&&(v=6*(f-3*c+3*s-i),g=6*(p-3*h+3*l-o)),{x:v,y:g}}(e,t,r);if(3===t.length)return function(e,t,r){void 0===r&&(r=1);var n=t[0],i=n.x,o=n.y,a=t[1],s=a.x,l=a.y,u=t[2],c=u.x,h=u.y,d=0,f=0;return 0===r?(d=Math.pow(1-e,2)*i+2*e*(1-e)*s+Math.pow(e,2)*c,f=Math.pow(1-e,2)*o+2*e*(1-e)*l+Math.pow(e,2)*h):1===r?(d=2*(1-e)*(s-i)+2*e*(c-s),f=2*(1-e)*(l-o)+2*e*(h-l)):2===r&&(d=2*(c-2*s+i),f=2*(h-2*l+o)),{x:d,y:f}}(e,t,r);throw new Error("Unsupported order")}function Mu(e,t){var r=e[0],n=r.x,i=r.y,o=e[1],a=o.x,s=o.y,l=(a-n)*t+n,u=(s-i)*t+i;if(2===e.length)return[{x:n,y:i},{x:l,y:u}];var c=e[2],h=c.x,d=c.y,f=(h-a)*t+a,p=(d-s)*t+s,v=(f-l)*t+l,g=(p-u)*t+u;if(4===e.length){var m=e[3];return[{x:n,y:i},{x:l,y:u},{x:v,y:g},{x:(((m.x-h)*t+h-f)*t+f-v)*t+v,y:(((m.y-d)*t+d-p)*t+p-g)*t+g}]}if(3===e.length)return[{x:n,y:i},{x:l,y:u},{x:v,y:g}];throw new Error("Unsupported order")}function Ou(e,t,r){var n;void 0===t&&(t=0),void 0===r&&(r=1),t=Math.max(t,0),t=Math.min(t,1),r=Math.max(r,0),r=Math.min(r,1);var i=e.slice(0);if(0===t&&1===r)return i;var o=r<t;return o&&(t=(n=[r,t])[0],r=n[1]),r<1&&(i=Mu(e,r)),t>0&&(r<1&&(t/=r),i=Mu(i.reverse(),1-t).reverse()),o&&i.reverse(),i}function Lu(e,t){if(void 0===t&&(t=0),0===t)return e[0];if(1===t)return e[e.length-1];if(4===e.length)return Iu(e,t);if(3===e.length)return Ru(e,t);if(2===e.length)return{x:e[0].x+(e[1].x-e[0].x)*t,y:e[0].y+(e[1].y-e[0].y)*t};throw new Error("Unsupported order")}function Ru(e,t){return{x:e[0].x*(1-t)*(1-t)+2*e[1].x*t*(1-t)+e[2].x*t*t,y:e[0].y*(1-t)*(1-t)+2*e[1].y*t*(1-t)+e[2].y*t*t}}function Iu(e,t){return{x:e[0].x*(1-t)*(1-t)*(1-t)+3*e[1].x*t*(1-t)*(1-t)+3*e[2].x*t*t*(1-t)+e[3].x*t*t*t,y:e[0].y*(1-t)*(1-t)*(1-t)+3*e[1].y*t*(1-t)*(1-t)+3*e[2].y*t*t*(1-t)+e[3].y*t*t*t}}function Fu(e,t,r){if(4===e.length)return function(e,t,r){for(var n=xu([e[0].x-t,3*(e[1].x-e[0].x),3*(e[2].x+e[0].x-2*e[1].x),e[3].x-e[0].x+3*e[1].x-3*e[2].x]).filter((function(e){return e>=0&&e<=1})),i=xu([e[0].y-r,3*(e[1].y-e[0].y),3*(e[2].y+e[0].y-2*e[1].y),e[3].y-e[0].y+3*e[1].y-3*e[2].y]).filter((function(e){return e>=0&&e<=1})),o=[],a=0,s=n.length;a<s;a++)for(var l=n[a],u=0,c=i.length;u<c;u++){var h=i[u],d=Math.abs(l-h);d<=.01&&o.push({x:l,y:h,diff:d})}o.sort((function(e,t){return e.diff-t.diff})),o.length>3&&o.splice(3);o=o.map((function(e){return.5*(e.x+e.y)}));var f=[];return o.forEach((function(n){var i=e[0].x*Math.pow(1-n,3)+3*e[1].x*n*Math.pow(1-n,2)+3*e[2].x*n*n*(1-n)+e[3].x*Math.pow(n,3),o=e[0].y*Math.pow(1-n,3)+3*e[1].y*n*Math.pow(1-n,2)+3*e[2].y*n*n*(1-n)+e[3].y*Math.pow(n,3);Math.abs(i-t)<=.01&&Math.abs(o-r)<=.01&&f.push(n)})),f}(e,t,r);if(3===e.length)return function(e,t,r){for(var n=xu([e[0].x-t,2*(e[1].x-e[0].x),e[2].x+e[0].x-2*e[1].x]).filter((function(e){return e>=0&&e<=1})),i=xu([e[0].y-r,2*(e[1].y-e[0].y),e[2].y+e[0].y-2*e[1].y]).filter((function(e){return e>=0&&e<=1})),o=[],a=0,s=n.length;a<s;a++)for(var l=n[a],u=0,c=i.length;u<c;u++){var h=i[u],d=Math.abs(l-h);d<=.01&&o.push({x:l,y:h,diff:d})}o.sort((function(e,t){return e.diff-t.diff})),o.length>2&&o.splice(2);o=o.map((function(e){return.5*(e.x+e.y)}));var f=[];return o.forEach((function(n){var i=e[0].x*Math.pow(1-n,2)+2*e[1].x*n*(1-n)+e[2].x*n*n,o=e[0].y*Math.pow(1-n,2)+2*e[1].y*n*(1-n)+e[2].y*n*n;Math.abs(i-t)<=.01&&Math.abs(o-r)<=.01&&f.push(n)})),f}(e,t,r);throw new Error("Unsupported order")}function Pu(e,t){if(void 0===t&&(t=0),2===e.length){var r=e[0],n=r.x,i=r.y,o=e[1],a=o.x,s=o.y;return n===a?1/0:(s-i)/(a-n)}if(3===e.length)return Du(e,t);if(4===e.length)return Nu(e,t);throw new Error("Unsupported order")}function Du(e,t){void 0===t&&(t=0);var r=e[0],n=r.x,i=r.y,o=e[1],a=o.x,s=o.y,l=e[2],u=l.x,c=l.y,h=2*(n-2*a+u)*t+2*a-2*n;return 0===h?1/0:(2*(i-2*s+c)*t+2*s-2*i)/h}function Nu(e,t){var r=e[0],n=r.x,i=r.y,o=e[1],a=o.x,s=o.y,l=e[2],u=l.x,c=l.y,h=e[3],d=h.x,f=h.y,p=3*(3*a-n-3*u+d)*t*t+2*(3*n-6*a+3*u)*t+3*a-3*n;return 0===p?1/0:(3*(3*s-i-3*c+f)*t*t+2*(3*i-6*s+3*c)*t+3*s-3*i)/p}var Bu={bboxBezier:Su,bezierLength:Tu,bezierAt:Au,sliceBezier:Ou,getPointByT:Lu,getPointT:Fu,bezierSlope:Pu,bezierExtremeT:function(e,t,r,n,i,o,a,s){var l=arguments.length;if(4===l)return[0,1];if(6===l)return function(e,t,r,n,i,o){var a=(e-r)/(e-2*r+i);isNaN(a)||a<0?a=0:a>1&&(a=1);var s=(t-n)/(t-2*n+o);isNaN(s)||s<0?s=0:s>1&&(s=1);var l=[a];return s!==a&&l.push(s),l.sort((function(e,t){return e-t})),l[0]>0&&l.unshift(0),l[l.length-1]<1&&l.push(1),l}(e,t,r,n,i,o);if(8===l)return function(e,t,r,n,i,o,a,s){var l=-e+r,u=-t+n,c=e-2*r+i,h=t-2*n+o,d=3*r-e-3*i+a,f=3*n-t-3*o+s,p=c*c-d*l,v=h*h-f*u,g=[];if(p>0){var m=(-c-(p=Math.sqrt(p)))/d;d&&m>0&&m<1&&g.push(m),(m=d?(-c+p)/d:.5*-l/c)>0&&m<1&&g.push(m)}v>0&&(m=(-h-(v=Math.sqrt(v)))/f,f&&m>0&&m<1&&g.push(m),(m=f?(-h+v)/f:.5*-u/h)>0&&m<1&&g.push(m));g.sort((function(e,t){return e-t}));for(var y=g.length-1;y>0;y--)g[y]===g[y-1]&&g.splice(y,1);return g[0]>0&&g.unshift(0),g[g.length-1]<1&&g.push(1),g}(e,t,r,n,i,o,a,s);throw new Error("Unsupported order")},bezierTangent:function(e,t){if(void 0===t&&(t=0),2===e.length)return wu(e[0].x,e[0].y,e[1].x,e[1].y);if(3===e.length)return function(e,t){void 0===t&&(t=0);var r=Du(e,t),n=Ru(e,t);return _u(n.x,n.y,r)}(e,t);if(4===e.length)return function(e,t){void 0===t&&(t=0);var r=Nu(e,t),n=Iu(e,t);return _u(n.x,n.y,r)}(e,t);throw new Error("Unsupported order")},splitBezierT:function(e,t,r,n){if(void 0===r&&(r=5),t<2)return[];if(e.length>4||e.length<2)throw new Error("Unsupported order");for(var i=e[0],o=e[e.length-1],a=[{x:i.x,y:i.y,t:0}],s=1/t,l=1;l<t;l++){var u=s*l,c=Lu(e,u);a.push({x:c.x,y:c.y,t:u})}if(a.push({x:o.x,y:o.y,t:1}),2===e.length)return a;var h=(n=n||Tu(e))/t;for(l=0;l<r;l++){for(var d=[0],f=1;f<t;f++)d[f]=Math.sqrt(Math.pow(a[f].x-a[f-1].x,2)+Math.pow(a[f].y-a[f-1].y,2));var p=0;for(f=1;f<t;f++){p+=d[f]-h;var v=a[f],g=Au(v.t,e,1),m=Math.sqrt(Math.pow(g.x,2)+Math.pow(g.y,2)),y=Au(v.t,e,2),b=p*m,x=p*Math.sqrt(Math.pow(y.x,2)+Math.pow(y.y,2))+m*m;v.t=v.t-b/x;c=Lu(e,v.t);v.x=c.x,v.y=c.y}}return a}},Uu=tu.unitize3,zu=tu.crossProduct3,Xu=tu.dotProduct3,Hu=tu.isParallel3,Gu=tu.length3;function ju(e,t,r,n,i){for(var o,a,s,l,u,c,h,d,f=[{a:e,b:t,t1:0,t2:1,t3:0,t4:1}];f.length;){var p=f.pop(),v=p.a,g=p.b,m=p.t1,y=p.t2,b=p.t3,x=p.t4,w=Su(v[0].x,v[0].y,v[1].x,v[1].y,null===(o=v[2])||void 0===o?void 0:o.x,null===(a=v[2])||void 0===a?void 0:a.y,null===(s=v[3])||void 0===s?void 0:s.x,null===(l=v[3])||void 0===l?void 0:l.y),_=Su(g[0].x,g[0].y,g[1].x,g[1].y,null===(u=g[2])||void 0===u?void 0:u.x,null===(c=g[2])||void 0===c?void 0:c.y,null===(h=g[3])||void 0===h?void 0:h.x,null===(d=g[3])||void 0===d?void 0:d.y);if(rc(w[0],w[1],w[2],w[3],_[0],_[1],_[2],_[3],!0)){var E=w[2]-w[0]||Number.EPSILON,S=w[3]-w[1]||Number.EPSILON,C=_[2]-_[0]||Number.EPSILON,k=_[3]-_[1]||Number.EPSILON;if(E<=r&&S<=r&&C<=r&&k<=r){var T=.5*(m+y),A=.5*(b+x);if(0===m)((M=v[0]).x===g[0].x&&M.y===g[0].y||M.x===g[g.length-1].x&&M.y===g[g.length-1].y)&&(T=0);else if(1===y){((M=v[v.length-1]).x===g[0].x&&M.y===g[0].y||M.x===g[g.length-1].x&&M.y===g[g.length-1].y)&&(T=1)}if(0===b)((M=g[0]).x===v[0].x&&M.y===v[0].y||M.x===v[v.length-1].x&&M.y===v[v.length-1].y)&&(A=0);else if(1===x){var M;((M=g[g.length-1]).x===v[0].x&&M.y===v[0].y||M.x===v[v.length-1].x&&M.y===v[v.length-1].y)&&(A=1)}var O=Lu(v,T),L=Lu(g,A);i.push({x:.5*(O.x+L.x),y:.5*(O.y+L.y),t1:T,t2:A})}else if((E>r||S>r)&&(C>r||k>r)){var R=Ou(v,0,.5),I=Ou(v,.5,1),F=Ou(g,0,.5),P=Ou(g,.5,1);f.push({a:R,b:F,t1:m,t2:m+.5*(y-m),t3:b,t4:b+.5*(x-b)}),f.push({a:R,b:P,t1:m,t2:m+.5*(y-m),t3:b+.5*(x-b),t4:x}),f.push({a:I,b:F,t1:m+.5*(y-m),t2:y,t3:b,t4:b+.5*(x-b)}),f.push({a:I,b:P,t1:m+.5*(y-m),t2:y,t3:b+.5*(x-b),t4:x})}else if(E>r||S>r){R=Ou(v,0,.5),I=Ou(v,.5,1);f.push({a:R,b:g,t1:m,t2:m+.5*(y-m),t3:b,t4:x}),f.push({a:I,b:g,t1:m+.5*(y-m),t2:y,t3:b,t4:x})}else if(C>r||k>r){F=Ou(g,0,.5),P=Ou(g,.5,1);f.push({a:v,b:F,t1:m,t2:y,t3:b,t4:b+.5*(x-b)}),f.push({a:v,b:P,t1:m,t2:y,t3:b+.5*(x-b),t4:x})}}}i.sort((function(e,t){return e.t1===t.t1?e.t2-t.t2:e.t1-t.t1}));for(var D=i.length-1;D>0;D--){var N=i[D],B=i[D-1];if(Math.abs(N.x-B.x)<=n&&Math.abs(N.y-B.y)<=n)if(1===D)0===N.t1||1===N.t1||0===N.t2||1===N.t2?i.shift():i.splice(1,1);else for(var U=D-1;U>0;U--){var z=i[U],X=i[U-1],H=Math.abs(z.x-X.x)>n&&Math.abs(z.y-X.y)>n;if(H||1===U){var G=H?U:U-1,j=i[G];if(Math.abs(N.x-j.x)<=n&&Math.abs(N.y-j.y)<=n)if(0===N.t1||1===N.t1||0===N.t2||1===N.t2)i.splice(G,D-G);else if(0===j.t1||1===j.t1||0===j.t2||1===j.t2)i.splice(G+1,D-G);else{var Y=i[G+D>>1];i.splice(G,D-G+1,Y)}else i.splice(G+1,D-G-1);D=G;break}}}return i}function Yu(e,t,r,n,i,o,a,s,l,u){void 0===l&&(l=!0),void 0===u&&(u=0);var c=(s-o)*(r-e)-(a-i)*(n-t);if(0!==c){var h=((a-i)*(t-o)-(s-o)*(e-i))/c,d=((r-e)*(t-o)-(n-t)*(e-i))/c,f=1-u;if(l&&(h<u||h>f||d<u||d>f))return;return{x:e+h*(r-e),y:t+h*(n-t),toSource:h,toClip:d}}}function Wu(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}}function Vu(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function qu(e,t,r){var n=Wu(e,t),i=Wu(r,t),o=Xu(i.x,i.y,i.z,i.x,i.y,i.z);return Xu(i.x,i.y,i.z,n.x,n.y,n.z)/o}var Ku={intersectLineLine:Yu,intersectBezier2Line:function(e,t,r,n,i,o,a,s,l,u,c,h){void 0===c&&(c=.1),void 0===h&&(h=.5);var d=[];return ju([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:u}],c,h,d),d},intersectBezier3Line:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f){void 0===d&&(d=.1),void 0===f&&(f=.5);var p=[];return ju([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],[{x:l,y:u},{x:c,y:h}],d,f,p),p},intersectBezier2Bezier2:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f){void 0===d&&(d=.1),void 0===f&&(f=.5);var p=[];return ju([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:u},{x:c,y:h}],d,f,p),p},intersectBezier3Bezier3:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,v,g,m){void 0===g&&(g=.1),void 0===m&&(m=.5);var y=[];return ju([{x:e,y:t},{x:r,y:n},{x:i,y:o},{x:a,y:s}],[{x:l,y:u},{x:c,y:h},{x:d,y:f},{x:p,y:v}],g,m,y),y},intersectBezier2Bezier3:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,v){void 0===p&&(p=.1),void 0===v&&(v=.5);var g=[];return ju([{x:e,y:t},{x:r,y:n},{x:i,y:o}],[{x:a,y:s},{x:l,y:u},{x:c,y:h},{x:d,y:f}],p,v,g),g},intersectLineLine3:function(e,t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1e-9);var a=Wu(e,r),s=Wu(n,r),l=Wu(t,e),u=a.x*s.x+a.y*s.y+a.z*s.z,c=s.x*l.x+s.y*l.y+s.z*l.z,h=a.x*l.x+a.y*l.y+a.z*l.z,d=s.x*s.x+s.y*s.y+s.z*s.z,f=(l.x*l.x+l.y*l.y+l.z*l.z)*d-c*c;if(!(Math.abs(f)<o)){var p,v,g=(u*c-h*d)/f,m=(u+c*g)/d,y={x:e.x+g*l.x,y:e.y+g*l.y,z:e.z+g*l.z},b={x:r.x+m*s.x,y:r.y+m*s.y,z:r.z+m*s.z};if(!((p=y,v=b,Math.sqrt(Math.pow(p.x-v.x,2)+Math.pow(p.y-v.y,2)+Math.pow(p.z-v.z,2)))>o)){var x,w,_=(x=Vu(y,b),w=1/2,{x:x.x*w,y:x.y*w,z:x.z*w});if(!i)return _;var E=qu(_,e,t),S=qu(_,r,n);return E<0&&Math.abs(E)<1e-9?E=0:E>1&&E-1<1e-9&&(E=1),S<0&&Math.abs(S)<1e-9?S=0:S>1&&S-1<1e-9&&(S=1),_.pa=E,_.pb=S,1===i&&E>=0&&E<=1||2===i&&S>=0&&S<=1||3===i&&E>=0&&E<=1&&S>=0&&S<=1?_:void 0}}},intersectPlanePlane:function(e,t,r,n,i,o){var a=Uu(t.x-e.x,t.y-e.y,t.z-e.z),s=Uu(r.x-e.x,r.y-e.y,r.z-e.z),l=Uu(i.x-n.x,i.y-n.y,i.z-n.z),u=Uu(o.x-n.x,o.y-n.y,o.z-n.z),c=zu(a.x,a.y,a.z,s.x,s.y,s.z),h=Uu(c.x,c.y,c.z),d=zu(l.x,l.y,l.z,u.x,u.y,u.z),f=Uu(d.x,d.y,d.z);if(Hu(h.x,h.y,h.z,f.x,f.y,f.z))return null;var p=zu(f.x,f.y,f.z,h.x,h.y,h.z),v=Vu(a,l),g=Uu(p.x,p.y,p.z),m=h.x,y=h.y,b=h.z,x=-m*e.x-y*e.y-b*e.z,w=f.x,_=f.y,E=f.z,S=-w*n.x-_*n.y-E*n.z,C=g.x,k=g.y,T=g.z,A=[-x,-S,-(-C*v.x-k*v.y-T*v.z)],M=m*(_*T-E*k)-y*(w*T-E*C)+b*(w*k-_*C);if(Math.abs(M)<1e-9)return null;var O=1/M,L={x:O*(_*T-E*k)*A[0]+O*(b*k-y*T)*A[1]+O*(y*E-b*_)*A[2],y:O*(E*C-w*T)*A[0]+O*(m*T-b*C)*A[1]+O*(b*w-m*E)*A[2],z:O*(w*k-_*C)*A[0]+O*(y*C-m*k)*A[1]+O*(m*_-y*w)*A[2]};return[L,Vu(L,g)]},pointOnLine3:function(e,t,r){var n=t.x-e.x,i=t.y-e.y,o=t.z-e.z,a=r.x-e.x,s=r.y-e.y,l=r.z-e.z,u=zu(n,i,o,a,s,l);return Gu(u.x,u.y,u.z)<1e-9}};function Zu(e){return e*Math.PI/180}function Ju(e){return 180*e/Math.PI}function Qu(e,t,r,n){void 0===n&&(n=!1);for(var i,o=r[0],a=o.x,s=o.y,l=r[0],u=l.x,c=l.y,h=r.length,d=1;d<h;d++){var f=r[d],p=f.x,v=f.y;a=Math.max(a,p),s=Math.max(s,v),u=Math.min(u,p),c=Math.min(c,v)}if(e<u||t<c||e>a||t>s)return!1;if((e<=u||t<=c||e>=a||t>=s)&&!n)return!1;d=0;for(var g=r.length;d<g;d++){var m=r[d],y=m.x,b=m.y,x=r[(d+1)%g],w=x.x,_=x.y,E=Yl(w-y,_-b,e-y,t-b);if(0!==E){if(E=E>0?1:0,void 0===i)i=E;else if(i^E)return!1}else if(n){if(e===y&&t===b||e===w&&t===_)return!0;var S=e-y,C=w-e,k=t-b,T=_-t;if(0===S||0===C){if(k^T)return!0}else if(0===k||0===T){if(S^C)return!0}else if(S^C&&k^T)return!0}}return!0}function $u(e,t,r,n,i,o,a,s){if(void 0===s&&(s=!1),a&&!nu(a)){var l=pu({x:r,y:n},a),u=pu({x:i,y:n},a),c=pu({x:i,y:o},a),h=pu({x:r,y:o},a);return Qu(e,t,[{x:l.x,y:l.y},{x:u.x,y:u.y},{x:c.x,y:c.y},{x:h.x,y:h.y}])}return s?e>=r&&t>=n&&e<=i&&t<=o:e>r&&t>n&&e<i&&t<o}function ec(e,t,r,n){return Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2))}function tc(e,t,r){var n=(Math.pow(t,2)+Math.pow(r,2)-Math.pow(e,2))/(2*t*r);return Math.acos(n)||0}function rc(e,t,r,n,i,o,a,s,l){if(void 0===l&&(l=!1),l){if(e>a||t>s||i>r||o>n)return!1;if((r===i||e===a)&&(n<o||t>s))return!1;if((n===t||t===n)&&(r<i||e>a))return!1}else if(e>=a||t>=s||i>=r||o>=n)return!1;return!0}function nc(e,t,r){void 0===r&&(r=!1);for(var n=0,i=0,o=0,a=0,s=0,l=e.length;s<l-1;s++){var u=e[s],c=u.x,h=u.y;s?(n=Math.min(n,c),i=Math.min(i,h),o=Math.max(o,c),a=Math.max(a,h)):(n=c,i=h,o=c,a=h)}var d=0,f=0,p=0,v=0;for(s=0,l=t.length;s<l-1;s++){var g=t[s];c=g.x,h=g.y;s?(d=Math.min(d,c),f=Math.min(f,h),p=Math.max(p,c),v=Math.max(v,h)):(d=c,f=h,p=c,v=h)}if(r){if(n>p||i>v||o<d||a<f)return!1}else if(n>=p||i>=v||o<=d||a<=f)return!1;var m=!0;e:for(s=0,l=e.length;s<l-1;s++)for(var y=e[s],b=(c=y.x,h=y.y,void 0),x=0,w=t.length;x<w-1;x++){var _=t[s],E=_.x,S=_.y,C=t[s+1%w];if(0!==(L=Yl((N=C.x)-E,(B=C.y)-S,c-E,h-S))){if(L=L>0?1:0,void 0===b)b=L;else if(b^L){m=!1;continue e}}else if(r){if(c===E&&h===S||c===N&&h===B)return!0;var k=N-c,T=h-S,A=B-h;if(0===(F=c-E)||0===k){if(T^A)return!0}else if(0===T||0===A){if(F^k)return!0}else if(F^k&&T^A)return!0;m=!1}}if(m)return!0;e:for(s=0,l=t.length;s<l-1;s++)for(var M=t[s],O=(c=M.x,h=M.y,b=void 0,x=0,e.length);x<O-1;x++){var L,R=e[s],I=(E=R.x,S=R.y,e[s+1%O]);if(0!==(L=Yl((N=I.x)-E,(B=I.y)-S,c-E,h-S))){if(L=L>0?1:0,void 0===b)b=L;else if(b^L){m=!1;continue e}}else if(r){if(c===E&&h===S||c===N&&h===B)return!0;var F;k=N-c,T=h-S,A=B-h;if(0===(F=c-E)||0===k){if(T^A)return!0}else if(0===T||0===A){if(F^k)return!0}else if(F^k&&T^A)return!0;m=!1}}if(m)return!0;for(s=0,l=e.length;s<l-1;s++)for(var P=e[s],D=(E=P.x,S=P.y,e[s+1]),N=D.x,B=D.y,U=(x=0,t.length);x<U-1;x++){var z=t[x],X=z.x,H=z.y,G=t[x+1],j=Yu(E,S,N,B,X,H,G.x,G.y,!0);if(j)return!!r||j.toSource>0&&j.toSource<1&&j.toClip>0&&j.toClip<1}return!1}function ic(e,t,r,n,i,o){var a,s;void 0===o&&(o=!1),e>r&&(e=(a=[r,e])[0],r=a[1]),t>n&&(t=(s=[n,t])[0],n=s[1]);for(var l=0,u=0,c=0,h=0,d=!0,f=!0,p=0,v=i.length;p<v;p++){var g=i[p],m=g.x,y=g.y;if(p?(l=Math.min(l,m),u=Math.min(u,y),c=Math.max(c,m),h=Math.max(h,y)):(l=m,u=y,c=m,h=y),o){if(m>=e&&m<=r&&y>=t&&y<=n)return!0}else if(m>e&&m<r&&y>t&&y<n)return!0;(m<e||m>r)&&(d=!1),(y<t||y>n)&&(f=!1)}if(d&&f)return!0;if(d)if(o){if(u>=t&&u<=n||h>=t&&h<=n)return!0}else if(u>t&&u<n||h>t&&h<n)return!0;if(f)if(o){if(l>=e&&l<=r||c>=e&&c<=r)return!0}else if(l>e&&l<r||c>e&&c<r)return!0;if(o){if(c<e||l>r||h<t||u>n)return!1}else if(c<=e||l>=r||h<=t||u>=n)return!1;return Qu(e,t,i,o)||Qu(r,t,i,o)||Qu(r,n,i,o)||Qu(e,n,i,o)||nc([{x:e,y:t},{x:r,y:t},{x:r,y:n},{x:e,y:n}],i,o)}var oc={d2r:Zu,r2d:Ju,H:4*(Math.sqrt(2)-1)/3,h:function(e){return e*=.5,(1-Math.cos(e))/Math.sin(e)*4/3},pointInConvexPolygon:Qu,pointInRect:$u,pointsDistance:ec,angleBySides:tc,isRectsOverlap:rc,isRectsInside:function(e,t,r,n,i,o,a,s,l){if(void 0===l&&(l=!1),l){if(e<=i&&t<=o&&r>=a&&n>=s)return!0}else if(e<i&&t<o&&r>a&&n>s)return!0;return!1},isPolygonsOverlap:nc,isPolygonOverlapRect:ic},ac={position:/(([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-?gradient\s*\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i,blur:/(gauss|motion|radial|background)\s*\((.+)\)/i,color:/(?:#[a-f\d]{3,8})|(?:rgba?\s*\(.+?\))/i,number:/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)[pxremvwhina%]*/gi};function sc(e,t){t=Zu(t);var r=Math.sin(t),n=Math.cos(t);return e[0]=e[5]=n,e[1]=r,e[4]=-r,e}function lc(e,t,r){var n=e.slice(0);return 0===t&&0===r||nu(e)?n:n=lu(n=uu(t,r,n),-t,-r)}function uc(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0);var n=ru();n[12]=e.translateX?Dc(e.translateX,t):0,n[13]=e.translateY?Dc(e.translateY,r):0;var i=e.rotateZ?e.rotateZ.v:0,o=e.scaleX?e.scaleX.v:1,a=e.scaleY?e.scaleY.v:1;return nu(n)?sc(n,i):i&&cu(n,Zu(i)),1!==o&&(nu(n)?n[0]=o:hu(n,o)),1!==a&&(nu(n)?n[5]=a:du(n,a)),n}function cc(e,t,r){var n=e.slice(0);return n=uu(-t,-r,n=lu(n,t,r))}var hc={calRotateZ:sc,calMatrix:uc,calMatrixByOrigin:lc,calTransformByMatrixAndOrigin:cc};function dc(e,t){void 0===t&&(t=2);var r=Math.pow(10,t);return Math.round(e*r)/r}var fc={geom:oc,matrix:mu,vector:tu,isec:Ku,bezier:Bu,toPrecision:dc};function pc(e,t,r){void 0===r&&(r=!1);for(var n=[],i=e[0].color,o=0,a=e.length;o<a;o++)n.push(e[o]);(1===n.length&&n.push(Rs(n[0])),void 0===n[0].offset&&(n[0].offset=0),n.length>1)&&(void 0===n[o=n.length-1].offset&&(n[o].offset=1));var s=n[0].offset;for(o=1,a=n.length;o<a-1;o++){if(void 0!==(b=n[o]).offset)s=b.offset;else{for(var l=o+1,u=n[n.length-1].offset;l<a-1;l++){var c=n[l];if(void 0!==c.offset){u=c.offset;break}}for(var h=(u-s)/(l-o+1),d=o;d<l;d++){n[d].offset=s+h*(d+1-o)}o=l}}n.sort((function(e,t){return e.offset-t.offset}));for(o=0,a=n.length;o<a;o++){if((b=n[o]).offset>1){n.splice(o);var f=n[o-1];if(f&&f.offset<1){var p=b.color[0]-f.color[0],v=b.color[1]-f.color[1],g=b.color[2]-f.color[2],m=b.color[3]-f.color[3],y=(1-f.offset)/(b.offset-f.offset);n.push({color:[b.color[0]+p*y,b.color[1]+v*y,b.color[2]+g*y,b.color[3]+m*y],offset:1})}break}}for(o=n.length-1;o>=0;o--){var b;if((b=n[o]).offset<0){n.splice(0,o+1);var x=n[o];if(x&&x.offset>0){p=x.color[0]-b.color[0],v=x.color[1]-b.color[1],g=x.color[2]-b.color[2],m=x.color[3]-b.color[3],y=-b.offset/(x.offset-b.offset);n.unshift({color:[b.color[0]+p*y,b.color[1]+v*y,b.color[2]+g*y,b.color[3]+m*y],offset:0})}break}}if(n.forEach((function(e){e.offset<0?e.offset=0:e.offset>1&&(e.offset=1)})),n.length||n.push({color:i,offset:0},{color:i,offset:1}),r){var w=n[0],_=n[n.length-1];if(w.offset>0||_.offset<1){p=_.color[0]-w.color[0],v=_.color[1]-w.color[1],g=_.color[2]-w.color[2],m=_.color[3]-w.color[3];var E=w.offset+(1-_.offset);if(w.offset>0){y=w.offset/E;n.unshift({color:[w.color[0]+p*y,w.color[1]+v*y,w.color[2]+g*y,w.color[3]+m*y],offset:0})}if(_.offset<1){y=(1-_.offset)/E;n.push({color:[_.color[0]-p*y,_.color[1]-v*y,_.color[2]-g*y,_.color[3]-m*y],offset:1})}}}return n}function vc(e){if(ac.gradient.test(e)){var t=ac.gradient.exec(e);if(t&&["linear","radial","conic"].indexOf(t[1].toLowerCase())>-1)return!0}return!1}function gc(e){var t=ac.gradient.exec(e);if(t){var r={linear:js.LINEAR,radial:js.RADIAL,conic:js.CONIC}[t[1].toLowerCase()],n=void 0;if(r===js.LINEAR){if(!(i=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)/.exec(t[2])))return;n=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]),parseFloat(i[4])]}else if(r===js.RADIAL){var i;if(!(i=/([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?)(\s+([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?))?/.exec(t[2])))return;n=[parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5])||0]}else r===js.CONIC&&(n=[]);var o=t[2].match(/(([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)?\s*((#[0-9a-f]{3,8})|(rgba?\s*\(.+?\)))\s*([-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?[pxremvwhina%]*)?)|(transparent)/gi)||[],a=o.map((function(e,t){var r,n=/(?:#[0-9a-f]{3,8})|(?:rgba?\s*\(.+?\))|(?:transparent)/i.exec(e),i=/[-+]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e[-+]?\d+)?(?:(?:px)|%)?/.exec(e.replace(n[0],""));if(i){var a=dl(i[0]);a.u!==Us.PERCENT&&(a.v*=100,a.u=Us.PERCENT),r=a}else t?t===o.length-1&&(r={v:100,u:Us.PERCENT}):r={v:0,u:Us.PERCENT};return{color:{v:n?kc(n[0]):[0,0,0,1],u:Us.RGBA},offset:r}}));a.sort((function(e,t){return e.offset&&t.offset?e.offset.v-t.offset.v:0}));for(var s=a.length-2;s>0;s--){if(!a[s].offset){for(var l=a[s+1].offset.v,u=a[0].offset.v,c=s,h=s-1;h>=0;h--){if(0===h){s=h;break}if(a[h].offset){s=h,u=a[h].offset.v;break}}for(var d=(l-u)/(c-s+1),f=s+1;f<=c;f++)a[s].offset={v:u+(f-s)*d,u:Us.PERCENT}}}return{t:r,d:n,stops:a}}}function mc(e,t,r,n,i,o){var a=r+t[0]*i,s=n+t[1]*o,l=r+t[2]*i,u=n+t[3]*o,c=Math.sqrt(Math.pow(l-a,2)+Math.pow(u-s,2));return{x1:a,y1:s,x2:l,y2:u,total:c,stop:pc(e,0,!1)}}function yc(e,t,r,n,i,o){var a,s=r+t[0]*i,l=n+t[1]*o,u=r+t[2]*i,c=n+t[3]*o,h=t[4],d=Math.sqrt(Math.pow(u-s,2)+Math.pow(c-l,2)),f=pc(e,0,!1);if(h&&1!==h){if(a=ru(),c!==l)if(u===s)cu(a,Zu(c>=l?90:270));else cu(a,Math.atan((c-l)/(u-s)));du(a,h),a=lc(a,s,l)}return{cx:s,cy:l,tx:u,ty:c,ellipseLength:h,matrix:a,total:d,stop:f}}function bc(e,t,r,n,i,o){var a=Math.floor(r+.5*i),s=Math.floor(n+.5*o),l=Math.floor(r+.5*i)-a,u=Math.floor(n+.5*o)-s;a%2==0&&a++,s%2==0&&s++;var c=0;c=0===l?u>=0?0:Math.PI:Math.atan(u/l);Math.sqrt(Math.pow(l,2)+Math.pow(u,2));return{angle:c,cx:a,cy:s,stop:pc(e,0,!0)}}function xc(e,t,r,n){var i,o,a,s;void 0===t&&(t=100),void 0===r&&(r=100),void 0===n&&(n=!1);var l=e.t,u=e.d,c=e.stops,h=u[0],d=u[1],f=u[2],p=u[3];d*=r,p*=r;var v=0;(h*=t)===(f*=t)?d<p&&(v=180):v=f>h?p>=d?90+Ju(Math.atan((p-d)/(f-h))):Ju(Math.atan((f-h)/(d-p))):p>=d?180+Ju(Math.atan((h-f)/(p-d))):360-Ju(Math.atan((h-f)/(d-p)));var g=c.slice(0);if(g.sort((function(e,t){return e.offset-t.offset})),l===js.LINEAR){var m=void 0,y=void 0;v<=90?(m={x:0,y:r},y={x:t,y:0}):v<=180?(m={x:0,y:0},y={x:t,y:r}):v<=270?(m={x:t,y:0},y={x:0,y:r}):(m={x:t,y:r},y={x:0,y:0});var b=Math.sqrt(Math.pow(p-m.y,2)+Math.pow(f-m.x,2)),x=Math.sqrt(Math.pow(d-m.y,2)+Math.pow(h-m.x,2)),w=Math.sqrt(Math.pow(p-d,2)+Math.pow(f-h,2)),_=tc(b,x,w),E=_?x*Math.cos(_):x,S=(_=tc(b=Math.sqrt(Math.pow(d-y.y,2)+Math.pow(h-y.x,2)),x=Math.sqrt(Math.pow(p-y.y,2)+Math.pow(f-y.x,2)),w))?x*Math.cos(_):x,C=Rs(g).sort((function(e,t){return e.offset-t.offset}));if(C[0].offset>0&&C.unshift({color:C[0].color.slice(0),offset:0}),C[C.length-1].offset<1&&C.push({color:C[C.length-1].color.slice(0),offset:1}),E>1e-9)for(var k=E/w,T=function(e,t){var r=C[e];if(r.offset>=k){var n=C[e-1];if(C.splice(0,e),r.offset>k){var i=w*(r.offset-n.offset),o=(E-n.offset*w)/i,a=n.color.map((function(e,t){return 3===t?e+(r.color[t]-e)*o:e+Math.floor((r.color[t]-e)*o)})),s={color:a,offset:0};C.unshift(s)}return"break"}},A=0,M=C.length;A<M;A++){if("break"===T(A))break}else E<-1e-9&&C.forEach((function(e){e.offset=(e.offset*w-E)/(w-E)}));if(S>1e-9){k=(w-S)/w;var O=function(e){var t=C[e];if(t.offset<=k){var r=C[e+1];if(C.splice(e+1),t.offset<k){var n=w*(r.offset-t.offset),i=(S-(1-r.offset)*w)/n,o=r.color.map((function(e,r){return 3===r?e+(t.color[r]-e)*i:e+Math.floor((t.color[r]-e)*i)})),a={color:o,offset:1};C.push(a)}return"break"}};for(A=C.length-1;A>=0;A--){if("break"===O(A))break}}else S<-1e-9&&C.forEach((function(e){e.offset=e.offset*(w-E)/(w-E-S)}));var L="linear-gradient(";return L+=n?dc(v)+"deg":u.join(" "),C.forEach((function(e){L+=", ",e.color[3]=dc(e.color[3]),L+=Tc(e.color)+" "+dc(100*e.offset)+"%"})),L+")"}if(l===js.RADIAL){var R=Math.sqrt(Math.pow(f-h,2)+Math.pow(p-d,2)),I=Math.sqrt(Math.pow(h,2)+Math.pow(d,2)),F=Math.sqrt(Math.pow(h-t,2)+Math.pow(d,2)),P=Math.sqrt(Math.pow(h-t,2)+Math.pow(d-r,2)),D=Math.sqrt(Math.pow(h,2)+Math.pow(d-r,2)),N=Math.max(I,F,P,D)/R,B="radial-gradient(";return B+=n?"circle at ".concat(100*dc(u[0]),"% ").concat(100*dc(u[1]),"%, "):u.join(" ")+", ",g.forEach((function(e,t){t&&(B+=", ");var r=e.color.map((function(e,t){return 3===t?dc(e):Math.min(255,Math.floor(e*N))}));B+=Tc(r)+" "+dc(100*e.offset)+"%"})),B+")"}if(l===js.CONIC){var U="conic-gradient(";n&&(U+="from 90deg, ");var z=g[0],X=g[g.length-1];if(n&&(z.offset>0||X.offset<1)){var H=[z.color[0]-X.color[0],z.color[1]-X.color[1],z.color[2]-X.color[2],null!==(o=null!==(i=z.color[3])&&void 0!==i?i:1-X.color[3])&&void 0!==o?o:1],G=1-X.offset+z.offset;if(z.offset>0){var j=z.offset/G;g.unshift({color:[Math.min(255,Math.max(0,Math.round(z.color[0]-H[0]*j))),Math.min(255,Math.max(0,Math.round(z.color[1]-H[1]*j))),Math.min(255,Math.max(0,Math.round(z.color[2]-H[2]*j))),Math.min(1,Math.max(0,null!==(a=z.color[3])&&void 0!==a?a:1-H[3]*j))],offset:0})}if(X.offset<1){j=(1-X.offset)/G;g.push({color:[Math.min(255,Math.max(0,Math.round(X.color[0]+H[0]*j))),Math.min(255,Math.max(0,Math.round(X.color[1]+H[1]*j))),Math.min(255,Math.max(0,Math.round(X.color[2]+H[2]*j))),Math.min(1,Math.max(0,null!==(s=X.color[3])&&void 0!==s?s:1+H[3]*j))],offset:1})}}return g.forEach((function(e,t){t&&(U+=", "),e.color[3]=dc(e.color[3]),U+=Tc(e.color)+" "+dc(100*e.offset)+"%"})),U+")"}return""}var wc={getColorStop:pc,getLinear:mc,getRadial:yc,getConic:bc,convert2Css:xc};function _c(e){var t={};["left","top","right","bottom","width","height"].forEach((function(r){var n=e[r];if(!Os(n)){var i=dl(n||0,!0);"width"!==r&&"height"!==r||i.v<0&&(i.v=0),t[r]=i}}));var r=e.lineHeight;Os(r)||("normal"===r?t.lineHeight={v:0,u:Us.AUTO}:((T=dl(r||0,!0)).v<=0&&(T={v:0,u:Us.AUTO}),t.lineHeight=T));var n=e.visibility;Os(n)||(t.visibility={v:/hidden/i.test(n)?tl.HIDDEN:tl.VISIBLE,u:Us.NUMBER});var i=e.fontFamily;Os(i)||(t.fontFamily={v:i.toString().trim().replace(/['"]/g,"").replace(/\s*,\s*/g,","),u:Us.STRING});var o=e.fontSize;Os(o)||((T=dl(o||hl.defaultFontSize,!0)).v<=0&&(T.v=hl.defaultFontSize),t.fontSize=T);var a=e.fontWeight;Os(a)||(_s(a)?/thin/i.test(a)?t.fontWeight={v:100,u:Us.NUMBER}:/lighter/i.test(a)?t.fontWeight={v:200,u:Us.NUMBER}:/light/i.test(a)?t.fontWeight={v:300,u:Us.NUMBER}:/medium/i.test(a)?t.fontWeight={v:500,u:Us.NUMBER}:/semiBold/i.test(a)?t.fontWeight={v:600,u:Us.NUMBER}:/bold/i.test(a)?t.fontWeight={v:700,u:Us.NUMBER}:/extraBold/i.test(a)?t.fontWeight={v:800,u:Us.NUMBER}:/black/i.test(a)?t.fontWeight={v:900,u:Us.NUMBER}:t.fontWeight={v:400,u:Us.NUMBER}:t.fontWeight={v:Math.min(900,Math.max(100,parseInt(a)||400)),u:Us.NUMBER});var s=e.fontStyle;if(!Os(s)){var l=Gs.NORMAL;/italic/i.test(s)?l=Gs.ITALIC:/oblique/i.test(s)&&(l=Gs.OBLIQUE),t.fontStyle={v:l,u:Us.NUMBER}}var u=e.color;Os(u)||(t.color={v:kc(u),u:Us.RGBA});var c=e.backgroundColor;Os(c)||(t.backgroundColor={v:kc(c),u:Us.RGBA});var h=e.opacity;Os(h)||(t.opacity={v:Math.max(0,Math.min(1,h)),u:Us.NUMBER});var d=e.fill;Os(d)||(t.fill=d.map((function(e){if(_s(e))if(vc(e)){if(t=gc(e))return{v:t,u:Us.GRADIENT}}else if(ac.img.test(e)){var t;if(t=ac.img.exec(e)){var r=el.TILE,n=e.replace(t[0],"");n.indexOf("fill")>-1?r=el.FILL:n.indexOf("stretch")>-1?r=el.STRETCH:n.indexOf("fit")>-1&&(r=el.FIT);var i=void 0,o=/([\d.]+)%/.exec(n);return o&&(i={v:parseFloat(o[1]),u:Us.PERCENT}),{v:{url:t[2],type:r,scale:i},u:Us.PATTERN}}}return{v:kc(e),u:Us.RGBA}})));var f=e.fillEnable;Os(f)||(t.fillEnable=f.map((function(e){return{v:e,u:Us.BOOLEAN}})));var p=e.fillOpacity;Os(p)||(t.fillOpacity=p.map((function(e){return{v:Math.max(0,Math.min(1,e)),u:Us.NUMBER}})));var v=e.fillMode;Os(v)||(t.fillMode=v.map((function(e){return{v:Sc(e),u:Us.NUMBER}})));var g=e.fillRule;Os(g)||(t.fillRule={v:"evenodd"===g?Ks.EVEN_ODD:Ks.NON_ZERO,u:Us.NUMBER});var m=e.stroke;Os(m)||(t.stroke=m.map((function(e){if(_s(e))if(vc(e)){if(t=gc(e))return{v:t,u:Us.GRADIENT}}else if(ac.img.test(e)){var t;if(t=ac.img.exec(e)){var r=el.TILE,n=e.replace(t[0],"");n.indexOf("fill")>-1?r=el.FILL:n.indexOf("stretch")>-1?r=el.STRETCH:n.indexOf("fit")>-1&&(r=el.FIT);var i=void 0,o=/([\d.]+)%/.exec(n);return o&&(i={v:parseFloat(o[1]),u:Us.PERCENT}),{v:{url:t[2],type:r,scale:i},u:Us.PATTERN}}}return{v:kc(e),u:Us.RGBA}})));var y=e.strokeEnable;Os(y)||(t.strokeEnable=y.map((function(e){return{v:e,u:Us.BOOLEAN}})));var b=e.strokeWidth;Os(b)||(t.strokeWidth=b.map((function(e){return{v:Math.max(0,e),u:Us.PX}})));var x=e.strokePosition;Os(x)||(t.strokePosition=x.map((function(e){var t=$s.CENTER;return"inside"===e?t=$s.INSIDE:"outside"===e&&(t=$s.OUTSIDE),{v:t,u:Us.NUMBER}})));var w=e.strokeMode;Os(w)||(t.strokeMode=w.map((function(e){return{v:Sc(e),u:Us.NUMBER}})));var _=e.strokeDasharray;Os(_)||(t.strokeDasharray=_.map((function(e){return{v:Math.max(0,e),u:Us.PX}})));var E=e.strokeLinecap;if(!Os(E)){l=Js.BUTT;"round"===E?l=Js.ROUND:"square"===E&&(l=Js.SQUARE),t.strokeLinecap={v:l,u:Us.NUMBER}}var S=e.strokeLinejoin;if(!Os(S)){l=Qs.MITER;"round"===S?l=Qs.ROUND:"bevel"===S&&(l=Qs.BEVEL),t.strokeLinejoin={v:l,u:Us.NUMBER}}var C=e.strokeMiterlimit;Os(C)||(t.strokeMiterlimit={v:C,u:Us.NUMBER}),["translateX","translateY","scaleX","scaleY","rotateZ"].forEach((function(r){var n=e[r];if(!Os(n)){var i=dl(n,!1);!function(e,t){"scaleX"===e||"scaleY"===e?t.u=Us.NUMBER:"translateX"===e||"translateY"===e?t.u===Us.NUMBER&&(t.u=Us.PX):t.u===Us.NUMBER&&(t.u=Us.DEG)}(r,i),t[r]=i}}));var k=e.letterSpacing;if(!Os(k)){var T=dl(k||0,!0);t.letterSpacing=T}var A=e.paragraphSpacing;if(!Os(A)){T=dl(A||0,!0);t.paragraphSpacing=T}var M=e.textAlign;if(!Os(M)){l=zs.LEFT;"center"===M?l=zs.CENTER:"right"===M?l=zs.RIGHT:"justify"===M&&(l=zs.JUSTIFY),t.textAlign={v:l,u:Us.NUMBER}}var O=e.textVerticalAlign;if(!Os(O)){l=Xs.TOP;"middle"===O?l=Xs.MIDDLE:"bottom"===O&&(l=Xs.BOTTOM),t.textVerticalAlign={v:l,u:Us.NUMBER}}var L=e.textDecoration;!Os(L)&&Array.isArray(L)&&(t.textDecoration=L.map((function(e){var t=fl.NONE;return"underline"===e?t=fl.UNDERLINE:"line-through"!==e&&"lineThrough"!==e||(t=fl.LINE_THROUGH),{v:t,u:Us.NUMBER}})));var R=e.transformOrigin;if(!Os(R)){var I=void 0;1===(I=Array.isArray(R)?R:R.match(ac.position)).length&&(I[1]=I[0]);for(var F=[],P=0;P<2;P++){var D=I[P];if(/^[-+]?[\d.]/.test(D)){T=dl(D,!0);F.push(T)}else F.push({v:{top:0,left:0,center:50,right:100,bottom:100}[D],u:Us.PERCENT}),Os(F[P].v)&&(F[P].v=50)}t.transformOrigin=F}var N=e.booleanOperation;if(!Os(N)){l=Ws.NONE;"union"===N?l=Ws.UNION:"subtract"===N?l=Ws.SUBTRACT:"intersect"===N?l=Ws.INTERSECT:"xor"===N&&(l=Ws.XOR),t.booleanOperation={v:l,u:Us.NUMBER}}var B=e.mixBlendMode;Os(B)||(t.mixBlendMode={v:Sc(B),u:Us.NUMBER});var U=e.pointerEvents;Os(U)||(t.pointerEvents={v:U,u:Us.BOOLEAN});var z=e.maskMode;if(!Os(z)){l=Zs.NONE;"outline"===z?l=Zs.OUTLINE:"alpha"===z?l=Zs.ALPHA:"gray"===z&&(l=Zs.GRAY),t.maskMode={v:l,u:Us.NUMBER}}var X=e.breakMask;Os(X)||(t.breakMask={v:X,u:Us.BOOLEAN});var H=e.blur;if(!Os(H))if(l=ac.blur.exec(H)){var G=l[1].toLowerCase();if("gauss"===G)t.blur={v:{t:Ys.GAUSSIAN,radius:{v:parseFloat(l[2])||0,u:Us.PX}},u:Us.BLUR};else if("background"===G){var j=0;(Y=/saturation\s*\((.+)\)/i.exec(H))&&(j=parseInt(Y[1])||0),t.blur={v:{t:Ys.BACKGROUND,radius:{v:parseInt(l[2])||0,u:Us.PX},saturation:{v:j,u:Us.PERCENT}},u:Us.BLUR}}else if("radial"===G){var Y=/center\s*\((.+)\)/i.exec(H),W=[{v:50,u:Us.PERCENT},{v:50,u:Us.PERCENT}];if(Y){var V=Y[1].match(ac.number);V&&(W[0]={v:parseFloat(V[0]),u:Us.PERCENT},W[1]={v:parseFloat(V[1]),u:Us.PERCENT})}t.blur={v:{t:Ys.RADIAL,radius:{v:parseFloat(l[2])||0,u:Us.PX},center:W},u:Us.BLUR}}else if("motion"===G){Y=/angle\s*\((.+)\)/i.exec(H);var q={v:0,u:Us.DEG};Y&&(q.v=parseFloat(Y[1])),t.blur={v:{t:Ys.MOTION,radius:{v:parseFloat(l[2])||0,u:Us.PX},angle:q},u:Us.BLUR}}else t.blur={v:{t:Ys.NONE},u:Us.BLUR}}else t.blur={v:{t:Ys.NONE},u:Us.BLUR};var K=e.shadow;Os(K)||(t.shadow=K.map((function(e){var t=ac.color.exec(e),r=e;t&&(r=r.slice(0,t.index)+r.slice(t.index+t[0].length));var n=r.match(ac.number),i=dl(n?n[0]:"0px",!0),o=dl(n?n[1]:"0px",!0),a=dl(n?n[2]:"0px",!0);return a.v=Math.max(0,a.v),{v:{x:i,y:o,blur:a,spread:dl(n?n[3]:"0px",!0),color:{v:kc(t?t[0]:"#000"),u:Us.RGBA}},u:Us.SHADOW}})));var Z=e.shadowEnable;Os(Z)||(t.shadowEnable=Z.map((function(e){return{v:e,u:Us.BOOLEAN}})));var J=e.innerShadow;Os(J)||(t.innerShadow=J.map((function(e){var t=ac.color.exec(e),r=e;t&&(r=r.slice(0,t.index)+r.slice(t.index+t[0].length));var n=r.match(ac.number),i=dl(n?n[0]:"0px",!0),o=dl(n?n[1]:"0px",!0),a=dl(n?n[2]:"0px",!0);a.v=Math.max(0,a.v);var s=dl(n?n[3]:"0px",!0);return s.v=Math.max(0,s.v),{v:{x:i,y:o,blur:a,spread:s,color:{v:kc(t?t[0]:"#000"),u:Us.RGBA}},u:Us.SHADOW}})));var Q=e.innerShadowEnable;return Os(Q)||(t.innerShadowEnable=Q.map((function(e){return{v:e,u:Us.BOOLEAN}}))),["hueRotate","saturate","brightness","contrast"].forEach((function(r){var n=e[r];if(!Os(n)){var i=dl(n);"hueRotate"===r?i.u!==Us.DEG&&(i.u=Us.DEG):i.u!==Us.PERCENT&&(i.v*=100,i.u=Us.PERCENT),t[r]=i}})),Os(e.matrix)||(t.matrix={v:e.matrix,u:Us.MATRIX}),t}function Ec(e){return Z(Z({},e),{color:kc(e.color),textAlign:{left:zs.LEFT,center:zs.CENTER,right:zs.RIGHT,justify:zs.JUSTIFY}[e.textAlign],textDecoration:e.textDecoration.map((function(e){return{none:fl.NONE,underline:fl.UNDERLINE,lineThrough:fl.LINE_THROUGH,"line-through":fl.LINE_THROUGH}[e]}))})}function Sc(e){var t=Hs.NORMAL;return/multiply/.test(e)?t=Hs.MULTIPLY:/screen/.test(e)?t=Hs.SCREEN:/overlay/.test(e)?t=Hs.OVERLAY:/darken/.test(e)?t=Hs.DARKEN:/lighten/.test(e)?t=Hs.LIGHTEN:/color-dodge/.test(e)||/colorDodge/.test(e)?t=Hs.COLOR_DODGE:/color-burn/.test(e)||/colorBurn/.test(e)?t=Hs.COLOR_BURN:/hard-light/.test(e)||/hardLight/.test(e)?t=Hs.HARD_LIGHT:/soft-light/.test(e)||/softLight/.test(e)?t=Hs.SOFT_LIGHT:/difference/.test(e)?t=Hs.DIFFERENCE:/exclusion/.test(e)?t=Hs.EXCLUSION:/hue/.test(e)?t=Hs.HUE:/saturation/.test(e)?t=Hs.SATURATION:/color/.test(e)?t=Hs.COLOR:/luminosity/.test(e)&&(t=Hs.LUMINOSITY),t}function Cc(e,t,r){var n=t[e],i=r[e];if("transformOrigin"===e)return n[0].v===i[0].v&&n[0].u===i[0].u&&n[1].v===i[1].v&&n[1].u===i[1].u;if("color"===e||"backgroundColor"===e)return n.v[0]===i.v[0]&&n.v[1]===i.v[1]&&n.v[2]===i.v[2]&&n.v[3]===i.v[3];if("fill"===e||"stroke"===e){if(n.length!==i.length)return!1;for(var o=0,a=n.length;o<a;o++){var s=n[o],l=i[o];if(s.u!==l.u)return!1;if(s.u===Us.RGBA){if(s.v[0]!==l.v[0]||s.v[1]!==l.v[1]||s.v[2]!==l.v[2]||s.v[3]!==l.v[3])return!1}else if(s.u===Us.GRADIENT){if(s.v.t!==l.v.t)return!1;if(s.v.d.length!==l.v.d.length)return!1;for(var u=0,c=s.v.d.length;u<c;u++)if(s.v.d[u]!==l.v.d[u])return!1;if(s.v.stops.length!==l.v.stops.length)return!1;for(var h=0,d=s.v.stops.length;h<d;h++){var f=s.v.stops[h],p=l.v.stops[h];if(f.color.v[0]!==p.color.v[0]||f.color.v[1]!==p.color.v[1]||f.color.v[2]!==p.color.v[2]||f.color.v[3]!==p.color.v[3])return!1;if(f.offset&&!p.offset||!f.offset&&p.offset)return!1;if(f.offset.u!==p.offset.u||f.offset.v!==p.offset.v)return!1}}}return!0}if("fillEnable"===e||"fillRule"===e||"fillOpacity"===e||"strokeEnable"===e||"strokeWidth"===e||"strokePosition"===e||"strokeDasharray"===e||"shadowEnable"===e||"innerShadowEnable"===e){if(n.length!==i.length)return!1;for(o=0,a=n.length;o<a;o++){s=n[o],l=i[o];if(s.u!==l.u||s.v!==l.v)return!1}return!0}if("matrix"===e){if(n&&!i||!n&&i)return!1;var v=n.v,g=i.v;if(v.length!==g.length)return!1;for(o=0,a=v.length;o<a;o++)if(v[o]!==g[o])return!1;return!0}if("shadow"===e||"innerShadow"===e){if(n.length!==i.length)return!1;for(o=0,a=n.length;o<a;o++){s=n[o].v,l=i[o].v;if(s.x.v!==l.x.v||s.x.u!==l.x.u||s.y.v!==l.y.v||s.y.u!==l.y.u||s.blur.v!==l.blur.v||s.blur.u!==l.blur.u||s.spread.v!==l.spread.v||s.spread.u!==l.spread.u)return!1;var m=s.color.v,y=l.color.v;if(m[0]!==y[0]||m[1]!==y[1]||m[2]!==y[2]||m[3]!==y[3])return!1}return!0}return n.v===i.v&&n.u===i.u}function kc(e){if(Array.isArray(e))return e;var t=[];if(!e||/transparent/i.test(e))t=[0,0,0,0];else if(/^#?[a-f\d]{3,8}$/i.test(e))3===(e=e.replace("#","")).length||4===e.length?(t.push(parseInt(e.charAt(0)+e.charAt(0),16)),t.push(parseInt(e.charAt(1)+e.charAt(1),16)),t.push(parseInt(e.charAt(2)+e.charAt(2),16)),4===e.length?t[3]=parseInt(e.charAt(3)+e.charAt(3),16):t[3]=1):6===e.length?(t.push(parseInt(e.slice(0,2),16)),t.push(parseInt(e.slice(2,4),16)),t.push(parseInt(e.slice(4),16)),t[3]=1):8===e.length?(t.push(parseInt(e.slice(0,2),16)),t.push(parseInt(e.slice(2,4),16)),t.push(parseInt(e.slice(4,6),16)),t.push(parseInt(e.slice(6),16)/255)):(t[0]=t[1]=t[2]=0,t[3]=1);else{var r=e.match(/rgba?\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)(?:\s*,\s*([\d.]+))?\s*\)/i);r?(t=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],Os(r[4])?t[3]=1:t[3]=parseFloat(r[4])):t=[0,0,0,0]}return t}function Tc(e){var t=kc(e);return Array.isArray(t)&&(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),3===t.length||4===t.length)?4===t.length?(t[3]=Math.max(t[3],0),"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"):"rgba("+t[0]+","+t[1]+","+t[2]+",1)":e||"rgba(0,0,0,0)"}function Ac(e){var t=e.toString(16).toUpperCase();return 1===t.length&&(t="0"+t),t}function Mc(e){var t=kc(e);return!Array.isArray(t)||3!==t.length&&4!==t.length?e||"#000":(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),4===t.length&&t[3]<1?(t[3]=Math.max(t[3],0),"#"+Ac(t[0])+Ac(t[1])+Ac(t[2])+Ac(Math.floor(255*t[3]))):"#"+Ac(t[0])+Ac(t[1])+Ac(t[2]))}function Oc(e){return Array.isArray(e)||(e=kc(e)),[e[0]/255,e[1]/255,e[2]/255,3===e.length?1:e[3]]}function Lc(e){var t=e.fontSize||hl.defaultFontSize,r=e.fontFamily||hl.defaultFontFamily;/[\s.,/\\]/.test(r)&&(r='"'+r.replace(/"/g,'\\"')+'"');var n="";e.fontStyle===Gs.ITALIC&&(n="italic ");var i="";return 400!==e.fontWeight&&(i=e.fontWeight+" "),n+i+t+"px "+r}function Rc(e){for(var t=e.split(/\s*,\s*/),r=0,n=t.length;r<n;r++){var i=t[r].replace(/^['"]/,"").replace(/['"]$/,"");if(Hl.hasRegister(i)||hl.checkSupportFontFamily(i))return i}return hl.defaultFontFamily}function Ic(e,t){t||(t=Rc(e.fontFamily));var r=(Hl.data[t]||Hl.data[hl.defaultFontFamily]||Hl.data.Arial||{}).lhr;return e.fontSize*r}function Fc(e,t){var r=e.fontSize,n=Rc(e.fontFamily),i=Ic(e,n),o=(Hl.data[n]||Hl.data[hl.defaultFontFamily]||Hl.data.Arial||{}).blr||1;return.5*((null!=t?t:e.lineHeight)-i)+r*o}function Pc(e,t){var r=e.fontSize,n=Rc(e.fontFamily),i=Ic(e,n),o=(Hl.data[n]||Hl.data[hl.defaultFontFamily]||Hl.data.Arial||{}).car||1;return.5*((null!=t?t:e.lineHeight)-i)+r*o}function Dc(e,t){return e.u===Us.PX?e.v:e.u===Us.PERCENT?e.v*t*.01:0}function Nc(e,t,r,n,i){if(e===Ys.NONE)return"none";var o=["none","gauss","motion","radial","background"][e]+"(".concat(t,")");if(e===Ys.MOTION)o+=" angle(".concat(r||0,")");else if(e===Ys.RADIAL){for(var a=(n||[]).map((function(e){return 100*e+"%"}));a.length<2;)a.push("50%");o+=" center(".concat(a.join(", "),")")}else e===Ys.BACKGROUND&&(o+=" saturation(".concat(100*(void 0===i?1:i),"%)"));return o}function Bc(e){return"".concat(Tc(e.color)," ").concat(e.x," ").concat(e.y," ").concat(e.blur," ").concat(e.spread)}function Uc(e,t,r,n){if(void 0===n&&(n=!1),Array.isArray(e))return Tc(e);var i=e;if(void 0!==i.url){var o=["tile","fill","stretch","fit"][i.type];return"url(".concat(i.url,") ").concat(o," ").concat(i.scale)}return xc(e,t,r,n)}function zc(e){return["center","inside","outside"][e]||"inside"}var Xc,Hc={normalize:_c,normalizeRich:Ec,equalStyle:Cc,color2rgbaInt:kc,color2rgbaStr:Tc,color2hexStr:Mc,color2gl:Oc,calFontFamily:Rc,calNormalLineHeight:Ic,getBaseline:Fc,getContentArea:Pc,calSize:Dc,getCssBlur:Nc,getCssShadow:Bc,getCssFillStroke:Uc,getCssStrokePosition:zc};function Gc(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,s,l;return Q(this,(function(u){switch(u.label){case 0:return[4,jc(e,"document.json")];case 1:t=u.sent(),r=[],n=0,i=t.pages.length,u.label=2;case 2:return n<i?(o=r,a=n,[4,jc(e,t.pages[n]._ref+".json")]):[3,5];case 3:o[a]=u.sent(),u.label=4;case 4:return n++,[3,2];case 5:return[4,jc(e,"meta.json")];case 6:return s=u.sent(),[4,jc(e,"user.json")];case 7:return l=u.sent(),[4,Yc({document:t,pages:r,meta:s,user:l},e)];case 8:return[2,u.sent()]}}))}))}function jc(e,t){return J(this,void 0,void 0,(function(){var r,n;return Q(this,(function(i){switch(i.label){case 0:return[4,null===(n=e.file(t))||void 0===n?void 0:n.async("string")];case 1:return(r=i.sent())?[2,JSON.parse(r)]:[2,{}]}}))}))}function Yc(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,h,d,f,p,v,g,m,y;return Q(this,(function(b){switch(b.label){case 0:return(r=((null===(g=e.document)||void 0===g?void 0:g.fontReferences)||[]).filter((function(e){if(!e.fontData||!e.fontData._ref)return!1;var t=e.fontFamilyName;return!Hl.hasRegister(t)&&!!e.postscriptNames[0]}))).length?[4,Promise.all(r.map((function(e){return"MSFontData"===e.fontData._ref_class&&t?function(e,t){return J(this,void 0,void 0,(function(){var r,n;return Q(this,(function(i){switch(i.label){case 0:return(r=t.file(e))?[4,r.async("arraybuffer")]:(hl.error("font not exist: >>>".concat(e,"<<<")),[2]);case 1:return n=i.sent(),Hl.registerAb(n),[2]}}))}))}(e.fontData._ref,t):"MSNetFontData"===e.fontData._ref_class?function(e,t){return J(this,void 0,void 0,(function(){return Q(this,(function(r){return Hl.hasRegister(t)?[2]:[2,new Promise((function(t,r){fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){Hl.registerAb(e),t()})).catch((function(){r()}))}))]}))}))}(e.fontData._ref,e.postscriptNames[0]):void 0})))]:[3,2];case 1:b.sent(),b.label=2;case 2:n={zipFile:t,user:e.user,imgSrcRecord:{}},i=[],o=(null===(m=e.document)||void 0===m?void 0:m.foreignSymbols)||[],h=0,d=o.length,b.label=3;case 3:return h<d?(a=i,s=h,[4,Vc(o[h].symbolMaster,(h+1)/(d+1),n,u,c)]):[3,6];case 4:a[s]=b.sent(),b.label=5;case 5:return h++,[3,3];case 6:if(l=[],!e.pages)return[3,10];h=0,d=e.pages.length,b.label=7;case 7:return h<d?(f=l,p=h,[4,Wc(e.pages[h],(h+1)/(d+1),n)]):[3,10];case 8:f[p]=b.sent(),b.label=9;case 9:return h++,[3,7];case 10:return[2,{document:{uuid:(v=e.document).do_objectID,assets:{uuid:v.assets.do_objectID},layerStyles:{uuid:v.layerStyles.do_objectID},layerTextStyles:{uuid:v.layerTextStyles.do_objectID}},pages:l,currentPageIndex:(null===(y=e.document)||void 0===y?void 0:y.currentPageIndex)||0,symbolMasters:i}]}}))}))}function Wc(e,t,r){return J(this,void 0,void 0,(function(){var n,i,o,a,s,h,d,f,p,v,g;return Q(this,(function(m){switch(m.label){case 0:n=[],i=0,o=e.layers.length,m.label=1;case 1:return i<o?[4,Vc(e.layers[i],(i+1)/(o+1),r,u,c)]:[3,4];case 2:(a=m.sent())&&n.push(a),m.label=3;case 3:return i++,[3,1];case 4:return s=0,h=0,d=1,(f=r.user[e.do_objectID])&&(p=f.scrollOrigin,v=f.zoomValue,p&&(g=/\{([+-.\d]+),\s*([+-.\d]+)}/.exec(p))&&(s=parseFloat(g[1])||0,h=parseFloat(g[2])||0),v&&(d=v)),[2,{tagName:l.PAGE,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:e.frame.constrainProportions,rule:{baseX:e.horizontalRulerData.base,baseY:e.verticalRulerData.base},style:{width:u,height:c,visibility:"hidden",translateX:s,translateY:h,scaleX:d,scaleY:d,transformOrigin:[0,0],pointerEvents:!1},isLocked:!1,isExpanded:!1},children:n.filter((function(e){return e}))}]}}))}))}function Vc(e,t,r,n,i){return J(this,void 0,void 0,(function(){var o,a,s,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C,k,T,A,M,O,L,R,I,F,P,D,N,B,U,z,X,H,G,j,Y,W,V,q,K,Z,J,ee,te,re,ne,ie,oe,ae,se,le,ue,ce,he,de,fe,pe,ve,ge,me,ye,be,xe,we,_e,Ee,Se,Ce,ke,Te,Ae,Me,Oe,Le,Re,Ie,Fe,Pe,De,Ne,Be,Ue,ze,Xe,He,Ge,je,Ye,We,Ve,qe,Ke,Ze,Je,Qe,$e,et,tt,rt,nt,it,ot,at,st,lt,ut,ct,ht,dt,ft,pt,vt,gt,mt,yt,bt,xt,wt,_t,Et,St;return Q(this,(function(Q){switch(Q.label){case 0:if(o=e.frame.width||.5,a=e.frame.height||.5,s=e.frame.x||0,u=e.frame.y||0,n<0&&(n=0),i<0&&(i=0),o<0&&(s+=o,o=Math.abs(o)),a<0&&(u+=a,a=Math.abs(a)),c=e.isVisible?"visible":"hidden",h=null!==(rt=null===(tt=null===(et=e.style)||void 0===et?void 0:et.contextSettings)||void 0===tt?void 0:tt.opacity)&&void 0!==rt?rt:1,d=-e.rotation,f=e.isFlippedHorizontal?-1:1,p=e.isFlippedVertical?-1:1,e._class===$.ClassValue.SymbolInstance&&1!==e.scale&&(f*=e.scale,p*=e.scale,v=o/e.scale,g=a/e.scale,s-=.5*(v-o),u-=.5*(g-a),o/=e.scale,a/=e.scale),m=e.isLocked,y=e.layerListExpandedType===$.LayerListExpanded.Expanded,b=e.frame.constrainProportions,e._class!==$.ClassValue.Artboard&&e._class!==$.ClassValue.SymbolMaster)return[3,5];Ze=[],Je=0,Qe=e.layers.length,Q.label=1;case 1:return Je<Qe?[4,Vc(e.layers[Je],(Je+1)/(Qe+1),r,o,a)]:[3,4];case 2:($e=Q.sent())&&Ze.push($e),Q.label=3;case 3:return Je++,[3,1];case 4:return x=e.hasBackgroundColor,w=x?[Math.floor(255*e.backgroundColor.red),Math.floor(255*e.backgroundColor.green),Math.floor(255*e.backgroundColor.blue),e.backgroundColor.alpha]:[255,255,255,1],e._class===$.ClassValue.SymbolMaster?(_=e.symbolID,E=e.includeBackgroundColorInInstance,[2,{tagName:l.SYMBOL_MASTER,props:{uuid:e.do_objectID,name:e.name,constrainProportions:b,hasBackgroundColor:x,resizesContent:e.resizesContent,symbolId:_,includeBackgroundColorInInstance:E,style:{width:o,height:a,visibility:c,opacity:h,translateX:s,translateY:u,rotateZ:d,backgroundColor:w},isLocked:m,isExpanded:y},children:Ze.filter((function(e){return e}))}]):[2,{tagName:l.ART_BOARD,props:{uuid:e.do_objectID,name:e.name,constrainProportions:b,hasBackgroundColor:x,resizesContent:e.resizesContent,style:{width:o,height:a,visibility:c,opacity:h,translateX:s,translateY:u,rotateZ:d,backgroundColor:w},isLocked:m,isExpanded:y},children:Ze.filter((function(e){return e}))}];case 5:return S=e.resizingConstraint^Xc.UNSET,C=0,k=0,T="auto",A="auto",S&Xc.LEFT?(C=s,S&Xc.RIGHT?(T=n-s-o,o="auto"):S&Xc.WIDTH||(T=100*(n-s-o)/n+"%",o="auto"),s=0):S&Xc.RIGHT?(T=n-s-o,S&Xc.WIDTH?C="auto":(C=100*s/n+"%",o="auto"),s=0):S&Xc.WIDTH?(C=100*(s+.5*o)/n+"%",s="-50%"):(C=100*s/n+"%",T=100*(n-s-o)/n+"%",s=0,o="auto"),S&Xc.TOP?(k=u,S&Xc.BOTTOM?(A=i-u-a,a="auto"):S&Xc.HEIGHT||(A=100*(i-u-a)/i+"%",a="auto"),u=0):S&Xc.BOTTOM?(A=i-u-a,S&Xc.HEIGHT?k="auto":(k=100*u/i+"%",a="auto"),u=0):S&Xc.HEIGHT?(k=100*(u+.5*a)/i+"%",u="-50%"):(k=100*u/i+"%",A=100*(i-u-a)/i+"%",u=0,a="auto"),(!n||n<0)&&("auto"!==C&&(C="0%"),"auto"!==T&&(T="0%")),(!i||i<0)&&("auto"!==k&&(k="0%"),"auto"!==A&&(A="0%")),M="none",O=e.hasClippingMask,L=e.clippingMaskMode,O&&(M=L?"alpha":"outline"),R=e.shouldBreakMaskChain,I="none",(null===(it=null===(nt=e.style)||void 0===nt?void 0:nt.blur)||void 0===it?void 0:it.isEnabled)&&(F=e.style.blur,(P=F.type)===$.BlurType.Gaussian?I="gauss(".concat(F.radius,"px)"):P===$.BlurType.Background?I="background(".concat(F.radius,"px) saturation(").concat(100*(F.saturation||0),"%)"):P===$.BlurType.Zoom?(D=F.center.match(ac.number)||["0.5","0.5"],N=D.map((function(e){return 100*parseFloat(e)+"%"})),I="radial(".concat(F.radius,"px) center(").concat(N[0],", ").concat(N[1],")")):P===$.BlurType.Motion&&(I="motion(".concat(F.radius,"px) angle(").concat(-1*(F.motionAngle||0),")"))),B=0,U=1,z=1,X=1,(H=null===(ot=e.style)||void 0===ot?void 0:ot.colorControls)&&H.isEnabled&&(H.hue&&(B=Ju(H.hue)),U=H.saturation,H.brightness&&(z=H.brightness+1),X=H.contrast),G=null===(st=null===(at=e.style)||void 0===at?void 0:at.contextSettings)||void 0===st?void 0:st.blendMode,j=Qc(G),Y=[],W=[],V=[],q=[],(K=null===(lt=e.style)||void 0===lt?void 0:lt.shadows)&&K.forEach((function(e){var t=[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha];Y.push("".concat(Tc(t)," ").concat(e.offsetX," ").concat(e.offsetY," ").concat(e.blurRadius," ").concat(e.spread," ")),W.push(e.isEnabled)})),(Z=null===(ut=e.style)||void 0===ut?void 0:ut.innerShadows)&&Z.forEach((function(e){var t=[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha];V.push("".concat(Tc(t)," ").concat(e.offsetX," ").concat(e.offsetY," ").concat(e.blurRadius," ").concat(e.spread)),q.push(e.isEnabled)})),e._class!==$.ClassValue.SymbolInstance?[3,8]:[4,Kc(e,r)];case 6:return J=Q.sent(),Pe=J.fill,De=J.fillEnable,Ne=J.fillOpacity,[4,eh(e.overrideValues,r)];case 7:return ee=Q.sent(),[2,{tagName:l.SYMBOL_INSTANCE,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,symbolId:e.symbolID,overrideValues:ee,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,fill:Pe,fillEnable:De,fillOpacity:Ne,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:V,innerShadowEnable:q},isLocked:m,isExpanded:y}}];case 8:if(e._class!==$.ClassValue.Group)return[3,14];Ze=[],Je=0,Qe=e.layers.length,Q.label=9;case 9:return Je<Qe?[4,Vc(e.layers[Je],(Je+1)/(Qe+1),r,e.frame.width,e.frame.height)]:[3,12];case 10:($e=Q.sent())&&Ze.push($e),Q.label=11;case 11:return Je++,[3,9];case 12:return[4,Kc(e,r)];case 13:return te=Q.sent(),Pe=te.fill,De=te.fillEnable,Ne=te.fillOpacity,[2,{tagName:l.GROUP,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,fill:Pe,fillEnable:De,fillOpacity:Ne,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:V,innerShadowEnable:q},isLocked:m,isExpanded:y},children:Ze.filter((function(e){return e}))}];case 14:return e._class!==$.ClassValue.Bitmap?[3,19]:(re="",ne="","MSImageData"!==e.image._ref_class?[3,16]:(ne=e.image._ref.replace(/^images\//,""),[4,Jc(e.image._ref,r)]));case 15:return re=Q.sent(),[3,17];case 16:"MSNetworkImage"===e.image._ref_class&&(re=e.image._ref),Q.label=17;case 17:return[4,Kc(e,r)];case 18:return ie=Q.sent(),Pe=ie.fill,De=ie.fillEnable,Ne=ie.fillOpacity,Be=ie.fillMode,ze=ie.stroke,Xe=ie.strokeEnable,He=ie.strokeWidth,Ge=ie.strokePosition,je=ie.strokeMode,Ye=ie.strokeDasharray,We=ie.strokeLinecap,Ve=ie.strokeLinejoin,qe=ie.strokeMiterlimit,[2,{tagName:l.BITMAP,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,fill:Pe,fillEnable:De,fillOpacity:Ne,fillMode:Be,stroke:ze,strokeEnable:Xe,strokeWidth:He,strokePosition:Ge,strokeMode:je,strokeDasharray:Ye,strokeLinecap:We,strokeLinejoin:Ve,strokeMiterlimit:qe,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:V,innerShadowEnable:q,hueRotate:B,saturate:U,brightness:z,contrast:X},isLocked:m,isExpanded:y,src:re,md5:ne}}];case 19:return e._class!==$.ClassValue.Text?[3,21]:((oe=e.textBehaviour)===$.TextBehaviour.Flexible?("auto"!==C&&"auto"!==T&&(T="auto",ae=parseFloat(C.toString()),C=/%$/.test(C.toString())?ae+50*e.frame.width/n+"%":ae+.5*e.frame.width,s="-50%"),"auto"!==k&&"auto"!==A&&(A="auto"),o="auto",a="auto"):oe===$.TextBehaviour.Fixed?("auto"!==k&&"auto"!==A&&(A="auto"),a="auto"):$.TextBehaviour.FixedWidthAndHeight,se=e.attributedString,le=se.string,ue=se.attributes,ce=ue.length?ue.map((function(e){var t=e.location,r=e.length,n=e.attributes,i=n.MSAttributedStringFontAttribute,o=(void 0===i?{}:i).attributes,a=void 0===o?{}:o,s=a.name,l=void 0===s?hl.defaultFontFamily:s,u=a.size,c=void 0===u?hl.defaultFontSize:u,h=n.MSAttributedStringColorAttribute,d=void 0===h?{}:h,f=d.red,p=void 0===f?0:f,v=d.green,g=void 0===v?0:v,m=d.blue,y=void 0===m?0:m,b=d.alpha,x=void 0===b?1:b,w=n.kerning,_=void 0===w?0:w,E=n.underlineStyle,S=void 0===E?$.UnderlineStyle.None:E,C=n.strikethroughStyle,k=void 0===C?$.StrikethroughStyle.None:C,T=n.paragraphStyle,A=void 0===T?{}:T,M=A.alignment,O=void 0===M?0:M,L=A.maximumLineHeight,R=void 0===L?0:L,I=A.paragraphSpacing,F=void 0===I?0:I,P=[];return S!==$.UnderlineStyle.None&&P.push("underline"),k!==$.StrikethroughStyle.None&&P.push("lineThrough"),{location:parseInt(t)||0,length:parseInt(r)||0,fontFamily:l,fontSize:c,fontWeight:400,fontStyle:"normal",letterSpacing:_,textAlign:["left","right","center","justify"][O||0],textDecoration:P,lineHeight:R,paragraphSpacing:F,color:[Math.floor(255*p),Math.floor(255*g),Math.floor(255*y),x]}})):[],he=null===(ft=null===(dt=null===(ht=null===(ct=e.style)||void 0===ct?void 0:ct.textStyle)||void 0===ht?void 0:ht.encodedAttributes)||void 0===dt?void 0:dt.MSAttributedStringFontAttribute)||void 0===ft?void 0:ft.attributes,de=(null==he?void 0:he.size)||(null===(pt=ce[0])||void 0===pt?void 0:pt.fontSize)||hl.defaultFontSize,fe=(null==he?void 0:he.name)||(null===(vt=ce[0])||void 0===vt?void 0:vt.fontFamily)||hl.defaultFontFamily,pe=null===(yt=null===(mt=null===(gt=e.style)||void 0===gt?void 0:gt.textStyle)||void 0===mt?void 0:mt.encodedAttributes)||void 0===yt?void 0:yt.paragraphStyle,ve=(null==pe?void 0:pe.maximumLineHeight)||"normal",ge=(null===(xt=null===(bt=e.style)||void 0===bt?void 0:bt.textStyle)||void 0===xt?void 0:xt.encodedAttributes)||{},me=ge.underlineStyle,ye=void 0===me?0:me,be=ge.strikethroughStyle,xe=void 0===be?0:be,we=ge.kerning,_e=void 0===we?0:we,Ee=ge.MSAttributedStringColorAttribute,Se=void 0!==(null==pe?void 0:pe.alignment)?["left","right","center","justify"][pe.alignment]:null===(wt=ce[0])||void 0===wt?void 0:wt.textAlign,Ce=null===(Et=null===(_t=e.style)||void 0===_t?void 0:_t.textStyle)||void 0===Et?void 0:Et.verticalAlignment,ke=["top","middle","bottom"][Ce||0],Te=[],ye!==$.UnderlineStyle.None&&Te.push("underline"),ye&&xe!==$.StrikethroughStyle.None&&Te.push("lineThrough"),Ae=(null==pe?void 0:pe.paragraphSpacing)||0,Me=Ee?[Math.floor(255*Ee.red),Math.floor(255*Ee.green),Math.floor(255*Ee.blue),Ee.alpha]:(null===(St=ce[0])||void 0===St?void 0:St.color)||[0,0,0,1],[4,Kc(e,r)]);case 20:return Oe=Q.sent(),Pe=Oe.fill,De=Oe.fillEnable,Ne=Oe.fillOpacity,Be=Oe.fillMode,ze=Oe.stroke,Xe=Oe.strokeEnable,He=Oe.strokeWidth,Ge=Oe.strokePosition,je=Oe.strokeMode,Ye=Oe.strokeDasharray,We=Oe.strokeLinecap,Ve=Oe.strokeLinejoin,qe=Oe.strokeMiterlimit,Ke=Oe.styleId,[2,{tagName:l.TEXT,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,styleId:Ke,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,fill:Pe,fillEnable:De,fillOpacity:Ne,fillMode:Be,stroke:ze,strokeEnable:Xe,strokeWidth:He,strokePosition:Ge,strokeMode:je,strokeDasharray:Ye,strokeLinecap:We,strokeLinejoin:Ve,strokeMiterlimit:qe,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,fontSize:de,fontFamily:fe,color:Me,textAlign:Se,textVerticalAlign:ke,textDecoration:Te,letterSpacing:_e,lineHeight:ve,paragraphSpacing:Ae,mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:V,innerShadowEnable:q},isLocked:m,isExpanded:y,content:le,rich:ce}}];case 21:return e._class!==$.ClassValue.Rectangle&&e._class!==$.ClassValue.Oval&&e._class!==$.ClassValue.Star&&e._class!==$.ClassValue.Triangle&&e._class!==$.ClassValue.Polygon&&e._class!==$.ClassValue.ShapePath?[3,23]:(Le=e.points.map((function(e){var t=Zc(e.point),r=Zc(e.curveFrom),n=Zc(e.curveTo);return{x:t.x,y:t.y,cornerRadius:e.cornerRadius,cornerStyle:e.cornerStyle,curveMode:e.curveMode,hasCurveFrom:e.hasCurveFrom,hasCurveTo:e.hasCurveTo,fx:r.x,fy:r.y,tx:n.x,ty:n.y}})),[4,Kc(e,r)]);case 22:return Re=Q.sent(),Pe=Re.fill,De=Re.fillEnable,Ne=Re.fillOpacity,Be=Re.fillMode,Ue=Re.fillRule,ze=Re.stroke,Xe=Re.strokeEnable,He=Re.strokeWidth,Ge=Re.strokePosition,je=Re.strokeMode,Ye=Re.strokeDasharray,We=Re.strokeLinecap,Ve=Re.strokeLinejoin,qe=Re.strokeMiterlimit,Ke=Re.styleId,Ie=pl.DISABLED,e.pointRadiusBehaviour===$.PointsRadiusBehaviour.Legacy?Ie=pl.LEGACY:e.pointRadiusBehaviour===$.PointsRadiusBehaviour.Rounded?Ie=pl.ROUNDED:e.pointRadiusBehaviour===$.PointsRadiusBehaviour.Smooth&&(Ie=pl.SMOOTH),[2,{tagName:l.POLYLINE,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,points:Le,isClosed:e.isClosed,fixedRadius:e.fixedRadius||0,pointRadiusBehaviour:Ie,isRectangle:"rectangle"===e._class,isOval:"oval"===e._class,styleId:Ke,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,fill:Pe,fillEnable:De,fillOpacity:Ne,fillMode:Be,fillRule:Ue,stroke:ze,strokeEnable:Xe,strokeWidth:He,strokePosition:Ge,strokeMode:je,strokeDasharray:Ye,strokeLinecap:We,strokeLinejoin:Ve,strokeMiterlimit:qe,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,booleanOperation:["union","subtract","intersect","xor"][e.booleanOperation]||"none",mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:V,innerShadowEnable:q},isLocked:m,isExpanded:y}}];case 23:return e._class!==$.ClassValue.ShapeGroup?[3,29]:[4,Kc(e,r)];case 24:Fe=Q.sent(),Pe=Fe.fill,De=Fe.fillEnable,Ne=Fe.fillOpacity,Be=Fe.fillMode,Ue=Fe.fillRule,ze=Fe.stroke,Xe=Fe.strokeEnable,He=Fe.strokeWidth,Ge=Fe.strokePosition,je=Fe.strokeMode,Ye=Fe.strokeDasharray,We=Fe.strokeLinecap,Ve=Fe.strokeLinejoin,qe=Fe.strokeMiterlimit,Ke=Fe.styleId,Ze=[],Je=0,Qe=e.layers.length,Q.label=25;case 25:return Je<Qe?[4,Vc(e.layers[Je],(Je+1)/(Qe+1),r,e.frame.width,e.frame.height)]:[3,28];case 26:($e=Q.sent())&&Ze.push($e),Q.label=27;case 27:return Je++,[3,25];case 28:return[2,{tagName:l.SHAPE_GROUP,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,styleId:Ke,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,fill:Pe,fillEnable:De,fillOpacity:Ne,fillMode:Be,fillRule:Ue,stroke:ze,strokeEnable:Xe,strokeWidth:He,strokePosition:Ge,strokeMode:je,strokeDasharray:Ye,strokeLinecap:We,strokeLinejoin:Ve,strokeMiterlimit:qe,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,booleanOperation:["union","subtract","intersect","xor"][e.booleanOperation]||"none",mixBlendMode:j,maskMode:M,breakMask:R,blur:I,shadow:Y,shadowEnable:W,innerShadow:V,innerShadowEnable:q},isLocked:m,isExpanded:y},children:Ze}];case 29:return e._class===$.ClassValue.Slice?[2,{tagName:l.SLICE,props:{uuid:e.do_objectID,name:e.name,index:t,constrainProportions:b,style:{left:C,top:k,right:T,bottom:A,width:o,height:a,visibility:c,opacity:h,translateX:s,translateY:u,scaleX:f,scaleY:p,rotateZ:d,breakMask:R},isLocked:m}}]:(hl.error(e),[2])}}))}))}function qc(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u,c;return Q(this,(function(h){switch(h.label){case 0:return e.fillType!==$.FillType.Pattern?[3,4]:(r="","MSImageData"!==(n=e.image)._ref_class?[3,2]:[4,Jc(n._ref,t)]);case 1:return r=h.sent(),[3,3];case 2:"MSNetworkImage"===n._ref_class&&(r=n._ref),h.label=3;case 3:return i=["tile","fill","stretch","fit"][e.patternFillType],o=e.patternTileScale,[2,"url(".concat(r,") ").concat(i," ").concat(100*o,"%")];case 4:if(e.fillType===$.FillType.Gradient){if(a=e.gradient,s=Zc(a.from),l=Zc(a.to),u=a.stops.map((function(e){return Tc([Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha])+" "+100*e.position+"%"})),a.gradientType===$.GradientType.Linear)return[2,"linearGradient(".concat(s.x," ").concat(s.y," ").concat(l.x," ").concat(l.y,",").concat(u.join(","),")")];if(a.gradientType===$.GradientType.Radial)return c=a.elipseLength,[2,"radialGradient(".concat(s.x," ").concat(s.y," ").concat(l.x," ").concat(l.y," ").concat(c,",").concat(u.join(","),")")];if(a.gradientType===$.GradientType.Angular)return[2,"conicGradient(".concat(.5," ").concat(.5," ").concat(.5," ").concat(.5,",").concat(u.join(","),")")];throw new Error("Unknown gradient")}return[2,[Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha]];case 5:return[2]}}))}))}function Kc(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C,k,T,A,M,O,L,R,I,F;return Q(this,(function(P){switch(P.label){case 0:if(r=e.style||{},n=r.borders,i=r.borderOptions,o=r.fills,a=r.windingRule,s=r.miterLimit,l=r.do_objectID,u=[],c=[],h=[],d=[],!o)return[3,4];b=0,x=o.length,P.label=1;case 1:return b<x?[4,qc(w=o[b],t)]:[3,4];case 2:f=P.sent(),u.push(f),c.push(w.isEnabled),h.push(null!==(R=null===(L=w.contextSettings)||void 0===L?void 0:L.opacity)&&void 0!==R?R:1),T=null===(I=w.contextSettings)||void 0===I?void 0:I.blendMode,d.push(Qc(T)),P.label=3;case 3:return b++,[3,1];case 4:if(p=[],v=[],g=[],m=[],y=[],n)for(b=0,x=n.length;b<x;b++){if((w=n[b]).fillType===$.FillType.Gradient)if(_=w.gradient,E=Zc(_.from),S=Zc(_.to),C=_.stops.map((function(e){return Tc([Math.floor(255*e.color.red),Math.floor(255*e.color.green),Math.floor(255*e.color.blue),e.color.alpha])+" "+100*e.position+"%"})),_.gradientType===$.GradientType.Linear)p.push("linearGradient(".concat(E.x," ").concat(E.y," ").concat(S.x," ").concat(S.y,",").concat(C.join(","),")"));else if(_.gradientType===$.GradientType.Radial)k=_.elipseLength,p.push("radialGradient(".concat(E.x," ").concat(E.y," ").concat(S.x," ").concat(S.y," ").concat(k,",").concat(C.join(","),")"));else{if(_.gradientType!==$.GradientType.Angular)throw new Error("Unknown gradient");p.push("conicGradient(".concat(E.x," ").concat(E.y," ").concat(S.x," ").concat(S.y,",").concat(C.join(","),")"))}else p.push([Math.floor(255*w.color.red),Math.floor(255*w.color.green),Math.floor(255*w.color.blue),w.color.alpha]);v.push(w.isEnabled),g.push(w.thickness||0),w.position===$.BorderPosition.Inside?m.push("inside"):w.position===$.BorderPosition.Outside?m.push("outside"):m.push("center"),T=null===(F=w.contextSettings)||void 0===F?void 0:F.blendMode,y.push(Qc(T))}return A=[],M="butt",O="miter",i&&(i.dashPattern.forEach((function(e){A.push(e)})),i.lineCapStyle===$.LineCapStyle.Round?M="round":i.lineCapStyle===$.LineCapStyle.Projecting&&(M="square"),i.lineJoinStyle===$.LineJoinStyle.Round?O="round":i.lineJoinStyle===$.LineJoinStyle.Bevel&&(O="bevel")),[2,{fill:u,fillEnable:c,fillOpacity:h,fillMode:d,fillRule:a===$.WindingRule.EvenOdd?"evenodd":"nonzero",stroke:p,strokeEnable:v,strokeWidth:g,strokePosition:m,strokeMode:y,strokeDasharray:A,strokeLinecap:M,strokeLinejoin:O,strokeMiterlimit:s,styleId:l}]}}))}))}function Zc(e){var t=/{(.+),\s*(.+)}/.exec(e);if(!t)throw new Error("Unknown point: "+e);return{x:parseFloat(t[1]),y:parseFloat(t[2])}}function Jc(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u;return Q(this,(function(c){switch(c.label){case 0:return e&&t.zipFile?t.imgSrcRecord.hasOwnProperty(e)?[2,t.imgSrcRecord[e]]:(r=t.zipFile.file(e))||(r=t.zipFile.file(e))?[4,r.async("arraybuffer")]:(hl.error("image not exist: >>>".concat(e,"<<<")),[2,""]):[2,""];case 1:if(n=c.sent(),i=new Uint8Array(n),o=!1,37===i[0]&&80===i[1]&&68===i[2]&&70===i[3]&&(o=!0),!n.byteLength)return hl.error("image is empty: >>>".concat(e,"<<<")),[2,""];if(!o)return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,hl.loadArrayBufferPdf(n)];case 3:return a=c.sent(),[3,5];case 4:return s=c.sent(),hl.error(s),[2,""];case 5:return[3,9];case 6:return c.trys.push([6,8,,9]),[4,hl.loadArrayBufferImg(n)];case 7:return a=c.sent(),[3,9];case 8:return l=c.sent(),hl.error(l),[2,""];case 9:return u=a.src||"blob:file://"+e,hl.IMG[u]={success:!0,state:hl.LOADED,width:a.width,height:a.height,source:a,url:u},t.imgSrcRecord[e]=u,[2,u]}}))}))}function Qc(e){void 0===e&&(e=$.BlendMode.Normal);var t="normal";return e===$.BlendMode.Darken?t="darken":e===$.BlendMode.Multiply?t="multiply":e===$.BlendMode.ColorBurn?t="color-burn":e===$.BlendMode.Lighten?t="lighten":e===$.BlendMode.Screen?t="screen":e===$.BlendMode.ColorDodge?t="color-dodge":e===$.BlendMode.Overlay?t="overlay":e===$.BlendMode.SoftLight?t="soft-light":e===$.BlendMode.HardLight?t="hard-light":e===$.BlendMode.Difference?t="difference":e===$.BlendMode.Exclusion?t="exclusion":e===$.BlendMode.Hue?t="hue":e===$.BlendMode.Saturation?t="saturation":e===$.BlendMode.Color?t="color":e===$.BlendMode.Luminosity?t="luminosity":e===$.BlendMode.PlusDarker||$.BlendMode.PlusLighter,t}function $c(e,t){return t?(t.alpha=e[3],t.red=e[0]/255,t.green=e[1]/255,t.blue=e[2]/255,t):{_class:"color",alpha:e[3],red:e[0]/255,green:e[1]/255,blue:e[2]/255}}function eh(e,t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u,c,h,d,f;return Q(this,(function(p){switch(p.label){case 0:r={},n=0,i=e.length,p.label=1;case 1:return n<i?(o=e[n],a=o.overrideName.split("_"),s=a[0],l=a[1],u=l.split(":"),c=u[0],h=u[1],d=(h||c).split("-"),f=o.value,"stringValue"!==d[0]?[3,2]:(d[0]="content",[3,4])):[3,6];case 2:return"fill"!==d[0]||"color"!==c?[3,4]:[4,qc({color:f},t)];case 3:f=Tc(f=p.sent()),p.label=4;case 4:(r[s]=r[s]||[]).push({key:d,value:f}),p.label=5;case 5:return n++,[3,1];case 6:return[2,r]}}))}))}
  /*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */!function(e){e[e.UNSET=63]="UNSET",e[e.RIGHT=1]="RIGHT",e[e.WIDTH=2]="WIDTH",e[e.LEFT=4]="LEFT",e[e.BOTTOM=8]="BOTTOM",e[e.HEIGHT=16]="HEIGHT",e[e.TOP=32]="TOP"}(Xc||(Xc={}));function th(e){let t=e.length;for(;--t>=0;)e[t]=0}const rh=256,nh=286,ih=30,oh=15,ah=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),sh=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),lh=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),uh=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ch=new Array(576);th(ch);const hh=new Array(60);th(hh);const dh=new Array(512);th(dh);const fh=new Array(256);th(fh);const ph=new Array(29);th(ph);const vh=new Array(ih);function gh(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let mh,yh,bh;function xh(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}th(vh);const wh=e=>e<256?dh[e]:dh[256+(e>>>7)],_h=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Eh=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,_h(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Sh=(e,t,r)=>{Eh(e,r[2*t],r[2*t+1])},Ch=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},kh=(e,t,r)=>{const n=new Array(16);let i,o,a=0;for(i=1;i<=oh;i++)a=a+r[i-1]<<1,n[i]=a;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=Ch(n[t]++,t))}},Th=e=>{let t;for(t=0;t<nh;t++)e.dyn_ltree[2*t]=0;for(t=0;t<ih;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Ah=e=>{e.bi_valid>8?_h(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Mh=(e,t,r,n)=>{const i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},Oh=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Mh(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Mh(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},Lh=(e,t,r)=>{let n,i,o,a,s=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+s++],n+=(255&e.pending_buf[e.sym_buf+s++])<<8,i=e.pending_buf[e.sym_buf+s++],0===n?Sh(e,i,t):(o=fh[i],Sh(e,o+rh+1,t),a=ah[o],0!==a&&(i-=ph[o],Eh(e,i,a)),n--,o=wh(n),Sh(e,o,r),a=sh[o],0!==a&&(n-=vh[o],Eh(e,n,a)))}while(s<e.sym_next);Sh(e,256,t)},Rh=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let a,s,l,u=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<o;a++)0!==r[2*a]?(e.heap[++e.heap_len]=u=a,e.depth[a]=0):r[2*a+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=u<2?++u:0,r[2*l]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=n[2*l+1]);for(t.max_code=u,a=e.heap_len>>1;a>=1;a--)Oh(e,r,a);l=o;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Oh(e,r,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,r[2*l]=r[2*a]+r[2*s],e.depth[l]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,r[2*a+1]=r[2*s+1]=l,e.heap[1]=l++,Oh(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length;let u,c,h,d,f,p,v=0;for(d=0;d<=oh;d++)e.bl_count[d]=0;for(r[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<573;u++)c=e.heap[u],d=r[2*r[2*c+1]+1]+1,d>l&&(d=l,v++),r[2*c+1]=d,c>n||(e.bl_count[d]++,f=0,c>=s&&(f=a[c-s]),p=r[2*c],e.opt_len+=p*(d+f),o&&(e.static_len+=p*(i[2*c+1]+f)));if(0!==v){do{for(d=l-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,v-=2}while(v>0);for(d=l;0!==d;d--)for(c=e.bl_count[d];0!==c;)h=e.heap[--u],h>n||(r[2*h+1]!==d&&(e.opt_len+=(d-r[2*h+1])*r[2*h],r[2*h+1]=d),c--)}})(e,t),kh(r,u,e.bl_count)},Ih=(e,t,r)=>{let n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))},Fh=(e,t,r)=>{let n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<u)do{Sh(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(Sh(e,i,e.bl_tree),s--),Sh(e,16,e.bl_tree),Eh(e,s-3,2)):s<=10?(Sh(e,17,e.bl_tree),Eh(e,s-3,3)):(Sh(e,18,e.bl_tree),Eh(e,s-11,7));s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4)}};let Ph=!1;const Dh=(e,t,r,n)=>{Eh(e,0+(n?1:0),3),Ah(e),_h(e,r),_h(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var Nh=e=>{Ph||((()=>{let e,t,r,n,i;const o=new Array(16);for(r=0,n=0;n<28;n++)for(ph[n]=r,e=0;e<1<<ah[n];e++)fh[r++]=n;for(fh[r-1]=n,i=0,n=0;n<16;n++)for(vh[n]=i,e=0;e<1<<sh[n];e++)dh[i++]=n;for(i>>=7;n<ih;n++)for(vh[n]=i<<7,e=0;e<1<<sh[n]-7;e++)dh[256+i++]=n;for(t=0;t<=oh;t++)o[t]=0;for(e=0;e<=143;)ch[2*e+1]=8,e++,o[8]++;for(;e<=255;)ch[2*e+1]=9,e++,o[9]++;for(;e<=279;)ch[2*e+1]=7,e++,o[7]++;for(;e<=287;)ch[2*e+1]=8,e++,o[8]++;for(kh(ch,287,o),e=0;e<ih;e++)hh[2*e+1]=5,hh[2*e]=Ch(e,5);mh=new gh(ch,ah,257,nh,oh),yh=new gh(hh,sh,0,ih,oh),bh=new gh(new Array(0),lh,0,19,7)})(),Ph=!0),e.l_desc=new xh(e.dyn_ltree,mh),e.d_desc=new xh(e.dyn_dtree,yh),e.bl_desc=new xh(e.bl_tree,bh),e.bi_buf=0,e.bi_valid=0,Th(e)},Bh=(e,t,r,n)=>{let i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<rh;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Rh(e,e.l_desc),Rh(e,e.d_desc),a=(e=>{let t;for(Ih(e,e.dyn_ltree,e.l_desc.max_code),Ih(e,e.dyn_dtree,e.d_desc.max_code),Rh(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*uh[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?Dh(e,t,r,n):4===e.strategy||o===i?(Eh(e,2+(n?1:0),3),Lh(e,ch,hh)):(Eh(e,4+(n?1:0),3),((e,t,r,n)=>{let i;for(Eh(e,t-257,5),Eh(e,r-1,5),Eh(e,n-4,4),i=0;i<n;i++)Eh(e,e.bl_tree[2*uh[i]+1],3);Fh(e,e.dyn_ltree,t-1),Fh(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Lh(e,e.dyn_ltree,e.dyn_dtree)),Th(e),n&&Ah(e)},Uh={_tr_init:Nh,_tr_stored_block:Dh,_tr_flush_block:Bh,_tr_tally:(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(fh[r]+rh+1)]++,e.dyn_dtree[2*wh(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Eh(e,2,3),Sh(e,256,ch),(e=>{16===e.bi_valid?(_h(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var zh=(e,t,r,n)=>{let i=65535&e,o=e>>>16&65535,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do{i=i+t[n++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16};const Xh=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var Hh=(e,t,r,n)=>{const i=Xh,o=n+r;e^=-1;for(let r=n;r<o;r++)e=e>>>8^i[255&(e^t[r])];return~e},Gh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},jh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Yh,_tr_stored_block:Wh,_tr_flush_block:Vh,_tr_tally:qh,_tr_align:Kh}=Uh,{Z_NO_FLUSH:Zh,Z_PARTIAL_FLUSH:Jh,Z_FULL_FLUSH:Qh,Z_FINISH:$h,Z_BLOCK:ed,Z_OK:td,Z_STREAM_END:rd,Z_STREAM_ERROR:nd,Z_DATA_ERROR:id,Z_BUF_ERROR:od,Z_DEFAULT_COMPRESSION:ad,Z_FILTERED:sd,Z_HUFFMAN_ONLY:ld,Z_RLE:ud,Z_FIXED:cd,Z_DEFAULT_STRATEGY:hd,Z_UNKNOWN:dd,Z_DEFLATED:fd}=jh,pd=258,vd=262,gd=42,md=113,yd=666,bd=(e,t)=>(e.msg=Gh[t],t),xd=e=>2*e-(e>4?9:0),wd=e=>{let t=e.length;for(;--t>=0;)e[t]=0},_d=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=i?r-i:0}while(--t);t=i,n=t;do{r=e.prev[--n],e.prev[n]=r>=i?r-i:0}while(--t)};let Ed=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const Sd=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},Cd=(e,t)=>{Vh(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Sd(e.strm)},kd=(e,t)=>{e.pending_buf[e.pending++]=t},Td=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Ad=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=zh(e.adler,t,i,r):2===e.state.wrap&&(e.adler=Hh(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},Md=(e,t)=>{let r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match;const l=e.strstart>e.w_size-vd?e.strstart-(e.w_size-vd):0,u=e.window,c=e.w_mask,h=e.prev,d=e.strstart+pd;let f=u[o+a-1],p=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(r=t,u[r+a]===p&&u[r+a-1]===f&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<d);if(n=pd-(d-o),o=d-pd,n>a){if(e.match_start=t,a=n,n>=s)break;f=u[o+a-1],p=u[o+a]}}}while((t=h[t&c])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead},Od=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-vd)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),_d(e),n+=t),0===e.strm.avail_in)break;if(r=Ad(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Ed(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Ed(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<vd&&0!==e.strm.avail_in)},Ld=(e,t)=>{let r,n,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(r=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>i&&(r=i),r<o&&(0===r&&t!==$h||t===Zh||r!==n+e.strm.avail_in))break;a=t===$h&&r===n+e.strm.avail_in?1:0,Wh(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Sd(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(Ad(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==Zh&&t!==$h&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Ad(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,n=e.strstart-e.block_start,(n>=o||(n||t===$h)&&t!==Zh&&0===e.strm.avail_in&&n<=i)&&(r=n>i?i:n,a=t===$h&&0===e.strm.avail_in&&r===n?1:0,Wh(e,e.block_start,r,a),e.block_start+=r,Sd(e.strm)),a?3:1)},Rd=(e,t)=>{let r,n;for(;;){if(e.lookahead<vd){if(Od(e),e.lookahead<vd&&t===Zh)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=Ed(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-vd&&(e.match_length=Md(e,r)),e.match_length>=3)if(n=qh(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ed(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ed(e,e.ins_h,e.window[e.strstart+1]);else n=qh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Cd(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===$h?(Cd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Cd(e,!1),0===e.strm.avail_out)?1:2},Id=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<vd){if(Od(e),e.lookahead<vd&&t===Zh)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=Ed(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-vd&&(e.match_length=Md(e,r),e.match_length<=5&&(e.strategy===sd||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=qh(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Ed(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Cd(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=qh(e,0,e.window[e.strstart-1]),n&&Cd(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=qh(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===$h?(Cd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Cd(e,!1),0===e.strm.avail_out)?1:2};function Fd(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const Pd=[new Fd(0,0,0,0,Ld),new Fd(4,4,8,4,Rd),new Fd(4,5,16,8,Rd),new Fd(4,6,32,32,Rd),new Fd(4,4,16,16,Id),new Fd(8,16,32,32,Id),new Fd(8,16,128,128,Id),new Fd(8,32,128,256,Id),new Fd(32,128,258,1024,Id),new Fd(32,258,258,4096,Id)];function Dd(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fd,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),wd(this.dyn_ltree),wd(this.dyn_dtree),wd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),wd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),wd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Nd=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==gd&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==md&&t.status!==yd?1:0},Bd=e=>{if(Nd(e))return bd(e,nd);e.total_in=e.total_out=0,e.data_type=dd;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?gd:md,e.adler=2===t.wrap?0:1,t.last_flush=-2,Yh(t),td},Ud=e=>{const t=Bd(e);var r;return t===td&&((r=e.state).window_size=2*r.w_size,wd(r.head),r.max_lazy_match=Pd[r.level].max_lazy,r.good_match=Pd[r.level].good_length,r.nice_match=Pd[r.level].nice_length,r.max_chain_length=Pd[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),t},zd=(e,t,r,n,i,o)=>{if(!e)return nd;let a=1;if(t===ad&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>9||r!==fd||n<8||n>15||t<0||t>9||o<0||o>cd||8===n&&1!==a)return bd(e,nd);8===n&&(n=9);const s=new Dd;return e.state=s,s.strm=e,s.status=gd,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=o,s.method=r,Ud(e)};var Xd=(e,t)=>zd(e,t,fd,15,8,hd),Hd=(e,t)=>{if(Nd(e)||t>ed||t<0)return e?bd(e,nd):nd;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===yd&&t!==$h)return bd(e,0===e.avail_out?od:nd);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(Sd(e),0===e.avail_out)return r.last_flush=-1,td}else if(0===e.avail_in&&xd(t)<=xd(n)&&t!==$h)return bd(e,od);if(r.status===yd&&0!==e.avail_in)return bd(e,od);if(r.status===gd&&0===r.wrap&&(r.status=md),r.status===gd){let t=fd+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=ld||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,Td(r,t),0!==r.strstart&&(Td(r,e.adler>>>16),Td(r,65535&e.adler)),e.adler=1,r.status=md,Sd(e),0!==r.pending)return r.last_flush=-1,td}if(57===r.status)if(e.adler=0,kd(r,31),kd(r,139),kd(r,8),r.gzhead)kd(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),kd(r,255&r.gzhead.time),kd(r,r.gzhead.time>>8&255),kd(r,r.gzhead.time>>16&255),kd(r,r.gzhead.time>>24&255),kd(r,9===r.level?2:r.strategy>=ld||r.level<2?4:0),kd(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(kd(r,255&r.gzhead.extra.length),kd(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Hh(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(kd(r,0),kd(r,0),kd(r,0),kd(r,0),kd(r,0),kd(r,9===r.level?2:r.strategy>=ld||r.level<2?4:0),kd(r,3),r.status=md,Sd(e),0!==r.pending)return r.last_flush=-1,td;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=Hh(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=i,Sd(e),0!==r.pending)return r.last_flush=-1,td;t=0,n-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=Hh(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Hh(e.adler,r.pending_buf,r.pending-n,n)),Sd(e),0!==r.pending)return r.last_flush=-1,td;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,kd(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Hh(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Hh(e.adler,r.pending_buf,r.pending-n,n)),Sd(e),0!==r.pending)return r.last_flush=-1,td;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,kd(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Hh(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Sd(e),0!==r.pending))return r.last_flush=-1,td;kd(r,255&e.adler),kd(r,e.adler>>8&255),e.adler=0}if(r.status=md,Sd(e),0!==r.pending)return r.last_flush=-1,td}if(0!==e.avail_in||0!==r.lookahead||t!==Zh&&r.status!==yd){let n=0===r.level?Ld(r,t):r.strategy===ld?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(Od(e),0===e.lookahead)){if(t===Zh)return 1;break}if(e.match_length=0,r=qh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Cd(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===$h?(Cd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Cd(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===ud?((e,t)=>{let r,n,i,o;const a=e.window;for(;;){if(e.lookahead<=pd){if(Od(e),e.lookahead<=pd&&t===Zh)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+pd;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=pd-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=qh(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=qh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Cd(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===$h?(Cd(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Cd(e,!1),0===e.strm.avail_out)?1:2})(r,t):Pd[r.level].func(r,t);if(3!==n&&4!==n||(r.status=yd),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),td;if(2===n&&(t===Jh?Kh(r):t!==ed&&(Wh(r,0,0,!1),t===Qh&&(wd(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Sd(e),0===e.avail_out))return r.last_flush=-1,td}return t!==$h?td:r.wrap<=0?rd:(2===r.wrap?(kd(r,255&e.adler),kd(r,e.adler>>8&255),kd(r,e.adler>>16&255),kd(r,e.adler>>24&255),kd(r,255&e.total_in),kd(r,e.total_in>>8&255),kd(r,e.total_in>>16&255),kd(r,e.total_in>>24&255)):(Td(r,e.adler>>>16),Td(r,65535&e.adler)),Sd(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?td:rd)},Gd={deflateInit:Xd,deflateInit2:zd,deflateReset:Ud,deflateResetKeep:Bd,deflateSetHeader:(e,t)=>Nd(e)||2!==e.state.wrap?nd:(e.state.gzhead=t,td),deflate:Hd,deflateEnd:e=>{if(Nd(e))return nd;const t=e.state.status;return e.state=null,t===md?bd(e,id):td},deflateSetDictionary:(e,t)=>{let r=t.length;if(Nd(e))return nd;const n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==gd||n.lookahead)return nd;if(1===i&&(e.adler=zh(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&(wd(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Od(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=Ed(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,Od(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,n.wrap=i,td},deflateInfo:"pako deflate (from Nodeca project)"};const jd=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Yd={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const t in r)jd(r,t)&&(e[t]=r[t])}}return e},flattenChunks:e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,i=e.length;t<i;t++){let i=e[t];r.set(i,n),n+=i.length}return r}};let Wd=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Wd=!1}const Vd=new Uint8Array(256);for(let e=0;e<256;e++)Vd[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Vd[254]=Vd[254]=1;var qd={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},buf2string:(e,t)=>{const r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,i;const o=new Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){o[i++]=t;continue}let a=Vd[t];if(a>4)o[i++]=65533,n+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&n<r;)t=t<<6|63&e[n++],a--;a>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Wd)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Vd[e[r]]>t?r:t}};var Kd=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Zd=Object.prototype.toString,{Z_NO_FLUSH:Jd,Z_SYNC_FLUSH:Qd,Z_FULL_FLUSH:$d,Z_FINISH:ef,Z_OK:tf,Z_STREAM_END:rf,Z_DEFAULT_COMPRESSION:nf,Z_DEFAULT_STRATEGY:of,Z_DEFLATED:af}=jh;function sf(e){this.options=Yd.assign({level:nf,method:af,chunkSize:16384,windowBits:15,memLevel:8,strategy:of},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kd,this.strm.avail_out=0;let r=Gd.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==tf)throw new Error(Gh[r]);if(t.header&&Gd.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?qd.string2buf(t.dictionary):"[object ArrayBuffer]"===Zd.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=Gd.deflateSetDictionary(this.strm,e),r!==tf)throw new Error(Gh[r]);this._dict_set=!0}}sf.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?ef:Jd,"string"==typeof e?r.input=qd.string2buf(e):"[object ArrayBuffer]"===Zd.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===Qd||o===$d)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=Gd.deflate(r,o),i===rf)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Gd.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===tf;if(0!==r.avail_out){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},sf.prototype.onData=function(e){this.chunks.push(e)},sf.prototype.onEnd=function(e){e===tf&&(this.result=Yd.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const lf=16209;var uf=function(e,t){let r,n,i,o,a,s,l,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C;const k=e.state;r=e.next_in,S=e.input,n=r+(e.avail_in-5),i=e.next_out,C=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),s=k.dmax,l=k.wsize,u=k.whave,c=k.wnext,h=k.window,d=k.hold,f=k.bits,p=k.lencode,v=k.distcode,g=(1<<k.lenbits)-1,m=(1<<k.distbits)-1;e:do{f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),y=p[d&g];t:for(;;){if(b=y>>>24,d>>>=b,f-=b,b=y>>>16&255,0===b)C[i++]=65535&y;else{if(!(16&b)){if(64&b){if(32&b){k.mode=16191;break e}e.msg="invalid literal/length code",k.mode=lf;break e}y=p[(65535&y)+(d&(1<<b)-1)];continue t}for(x=65535&y,b&=15,b&&(f<b&&(d+=S[r++]<<f,f+=8),x+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),y=v[d&m];;){if(b=y>>>24,d>>>=b,f-=b,b=y>>>16&255,16&b){if(w=65535&y,b&=15,f<b&&(d+=S[r++]<<f,f+=8,f<b&&(d+=S[r++]<<f,f+=8)),w+=d&(1<<b)-1,w>s){e.msg="invalid distance too far back",k.mode=lf;break e}if(d>>>=b,f-=b,b=i-o,w>b){if(b=w-b,b>u&&k.sane){e.msg="invalid distance too far back",k.mode=lf;break e}if(_=0,E=h,0===c){if(_+=l-b,b<x){x-=b;do{C[i++]=h[_++]}while(--b);_=i-w,E=C}}else if(c<b){if(_+=l+c-b,b-=c,b<x){x-=b;do{C[i++]=h[_++]}while(--b);if(_=0,c<x){b=c,x-=b;do{C[i++]=h[_++]}while(--b);_=i-w,E=C}}}else if(_+=c-b,b<x){x-=b;do{C[i++]=h[_++]}while(--b);_=i-w,E=C}for(;x>2;)C[i++]=E[_++],C[i++]=E[_++],C[i++]=E[_++],x-=3;x&&(C[i++]=E[_++],x>1&&(C[i++]=E[_++]))}else{_=i-w;do{C[i++]=C[_++],C[i++]=C[_++],C[i++]=C[_++],x-=3}while(x>2);x&&(C[i++]=C[_++],x>1&&(C[i++]=C[_++]))}break}if(64&b){e.msg="invalid distance code",k.mode=lf;break e}y=v[(65535&y)+(d&(1<<b)-1)]}}break}}while(r<n&&i<a);x=f>>3,r-=x,f-=x<<3,d&=(1<<f)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<a?a-i+257:257-(i-a),k.hold=d,k.bits=f};const cf=15,hf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),df=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ff=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),pf=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var vf=(e,t,r,n,i,o,a,s)=>{const l=s.bits;let u,c,h,d,f,p,v=0,g=0,m=0,y=0,b=0,x=0,w=0,_=0,E=0,S=0,C=null;const k=new Uint16Array(16),T=new Uint16Array(16);let A,M,O,L=null;for(v=0;v<=cf;v++)k[v]=0;for(g=0;g<n;g++)k[t[r+g]]++;for(b=l,y=cf;y>=1&&0===k[y];y--);if(b>y&&(b=y),0===y)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(m=1;m<y&&0===k[m];m++);for(b<m&&(b=m),_=1,v=1;v<=cf;v++)if(_<<=1,_-=k[v],_<0)return-1;if(_>0&&(0===e||1!==y))return-1;for(T[1]=0,v=1;v<cf;v++)T[v+1]=T[v]+k[v];for(g=0;g<n;g++)0!==t[r+g]&&(a[T[t[r+g]]++]=g);if(0===e?(C=L=a,p=20):1===e?(C=hf,L=df,p=257):(C=ff,L=pf,p=0),S=0,g=0,v=m,f=o,x=b,w=0,h=-1,E=1<<b,d=E-1,1===e&&E>852||2===e&&E>592)return 1;for(;;){A=v-w,a[g]+1<p?(M=0,O=a[g]):a[g]>=p?(M=L[a[g]-p],O=C[a[g]-p]):(M=96,O=0),u=1<<v-w,c=1<<x,m=c;do{c-=u,i[f+(S>>w)+c]=A<<24|M<<16|O}while(0!==c);for(u=1<<v-1;S&u;)u>>=1;if(0!==u?(S&=u-1,S+=u):S=0,g++,0==--k[v]){if(v===y)break;v=t[r+a[g]]}if(v>b&&(S&d)!==h){for(0===w&&(w=b),f+=m,x=v-w,_=1<<x;x+w<y&&(_-=k[x+w],!(_<=0));)x++,_<<=1;if(E+=1<<x,1===e&&E>852||2===e&&E>592)return 1;h=S&d,i[h]=b<<24|x<<16|f-o}}return 0!==S&&(i[f+S]=v-w<<24|64<<16),s.bits=b,0};const{Z_FINISH:gf,Z_BLOCK:mf,Z_TREES:yf,Z_OK:bf,Z_STREAM_END:xf,Z_NEED_DICT:wf,Z_STREAM_ERROR:_f,Z_DATA_ERROR:Ef,Z_MEM_ERROR:Sf,Z_BUF_ERROR:Cf,Z_DEFLATED:kf}=jh,Tf=16180,Af=16190,Mf=16191,Of=16192,Lf=16194,Rf=16199,If=16200,Ff=16206,Pf=16209,Df=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Nf(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bf=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Tf||t.mode>16211?1:0},Uf=e=>{if(Bf(e))return _f;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Tf,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,bf},zf=e=>{if(Bf(e))return _f;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Uf(e)},Xf=(e,t)=>{let r;if(Bf(e))return _f;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?_f:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,zf(e))},Hf=(e,t)=>{if(!e)return _f;const r=new Nf;e.state=r,r.strm=e,r.window=null,r.mode=Tf;const n=Xf(e,t);return n!==bf&&(e.state=null),n};let Gf,jf,Yf=!0;const Wf=e=>{if(Yf){Gf=new Int32Array(512),jf=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(vf(1,e.lens,0,288,Gf,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;vf(2,e.lens,0,32,jf,0,e.work,{bits:5}),Yf=!1}e.lencode=Gf,e.lenbits=9,e.distcode=jf,e.distbits=5},Vf=(e,t,r,n)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var qf=(e,t)=>{let r,n,i,o,a,s,l,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S=0;const C=new Uint8Array(4);let k,T;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bf(e)||!e.output||!e.input&&0!==e.avail_in)return _f;r=e.state,r.mode===Mf&&(r.mode=Of),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,u=r.hold,c=r.bits,h=s,d=l,E=bf;e:for(;;)switch(r.mode){case Tf:if(0===r.wrap){r.mode=Of;break}for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(2&r.wrap&&35615===u){0===r.wbits&&(r.wbits=15),r.check=0,C[0]=255&u,C[1]=u>>>8&255,r.check=Hh(r.check,C,2,0),u=0,c=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Pf;break}if((15&u)!==kf){e.msg="unknown compression method",r.mode=Pf;break}if(u>>>=4,c-=4,_=8+(15&u),0===r.wbits&&(r.wbits=_),_>15||_>r.wbits){e.msg="invalid window size",r.mode=Pf;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&u?16189:Mf,u=0,c=0;break;case 16181:for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(r.flags=u,(255&r.flags)!==kf){e.msg="unknown compression method",r.mode=Pf;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Pf;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&4&r.wrap&&(C[0]=255&u,C[1]=u>>>8&255,r.check=Hh(r.check,C,2,0)),u=0,c=0,r.mode=16182;case 16182:for(;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.head&&(r.head.time=u),512&r.flags&&4&r.wrap&&(C[0]=255&u,C[1]=u>>>8&255,C[2]=u>>>16&255,C[3]=u>>>24&255,r.check=Hh(r.check,C,4,0)),u=0,c=0,r.mode=16183;case 16183:for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&4&r.wrap&&(C[0]=255&u,C[1]=u>>>8&255,r.check=Hh(r.check,C,2,0)),u=0,c=0,r.mode=16184;case 16184:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&4&r.wrap&&(C[0]=255&u,C[1]=u>>>8&255,r.check=Hh(r.check,C,2,0)),u=0,c=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>s&&(f=s),f&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+f),_)),512&r.flags&&4&r.wrap&&(r.check=Hh(r.check,n,f,o)),s-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break e;f=0;do{_=n[o+f++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_))}while(_&&f<s);if(512&r.flags&&4&r.wrap&&(r.check=Hh(r.check,n,f,o)),s-=f,o+=f,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break e;f=0;do{_=n[o+f++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_))}while(_&&f<s);if(512&r.flags&&4&r.wrap&&(r.check=Hh(r.check,n,f,o)),s-=f,o+=f,_)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(4&r.wrap&&u!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Pf;break}u=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Mf;break;case 16189:for(;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}e.adler=r.check=Df(u),u=0,c=0,r.mode=Af;case Af:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,wf;e.adler=r.check=1,r.mode=Mf;case Mf:if(t===mf||t===yf)break e;case Of:if(r.last){u>>>=7&c,c-=7&c,r.mode=Ff;break}for(;c<3;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}switch(r.last=1&u,u>>>=1,c-=1,3&u){case 0:r.mode=16193;break;case 1:if(Wf(r),r.mode=Rf,t===yf){u>>>=2,c-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Pf}u>>>=2,c-=2;break;case 16193:for(u>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Pf;break}if(r.length=65535&u,u=0,c=0,r.mode=Lf,t===yf)break e;case Lf:r.mode=16195;case 16195:if(f=r.length,f){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;i.set(n.subarray(o,o+f),a),s-=f,o+=f,l-=f,a+=f,r.length-=f;break}r.mode=Mf;break;case 16196:for(;c<14;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(r.nlen=257+(31&u),u>>>=5,c-=5,r.ndist=1+(31&u),u>>>=5,c-=5,r.ncode=4+(15&u),u>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Pf;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.lens[A[r.have++]]=7&u,u>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,k={bits:r.lenbits},E=vf(0,r.lens,0,19,r.lencode,0,r.work,k),r.lenbits=k.bits,E){e.msg="invalid code lengths set",r.mode=Pf;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;S=r.lencode[u&(1<<r.lenbits)-1],g=S>>>24,m=S>>>16&255,y=65535&S,!(g<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(y<16)u>>>=g,c-=g,r.lens[r.have++]=y;else{if(16===y){for(T=g+2;c<T;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(u>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=Pf;break}_=r.lens[r.have-1],f=3+(3&u),u>>>=2,c-=2}else if(17===y){for(T=g+3;c<T;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}u>>>=g,c-=g,_=0,f=3+(7&u),u>>>=3,c-=3}else{for(T=g+7;c<T;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}u>>>=g,c-=g,_=0,f=11+(127&u),u>>>=7,c-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Pf;break}for(;f--;)r.lens[r.have++]=_}}if(r.mode===Pf)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Pf;break}if(r.lenbits=9,k={bits:r.lenbits},E=vf(1,r.lens,0,r.nlen,r.lencode,0,r.work,k),r.lenbits=k.bits,E){e.msg="invalid literal/lengths set",r.mode=Pf;break}if(r.distbits=6,r.distcode=r.distdyn,k={bits:r.distbits},E=vf(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,k),r.distbits=k.bits,E){e.msg="invalid distances set",r.mode=Pf;break}if(r.mode=Rf,t===yf)break e;case Rf:r.mode=If;case If:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,uf(e,d),a=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,u=r.hold,c=r.bits,r.mode===Mf&&(r.back=-1);break}for(r.back=0;S=r.lencode[u&(1<<r.lenbits)-1],g=S>>>24,m=S>>>16&255,y=65535&S,!(g<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(m&&!(240&m)){for(b=g,x=m,w=y;S=r.lencode[w+((u&(1<<b+x)-1)>>b)],g=S>>>24,m=S>>>16&255,y=65535&S,!(b+g<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}u>>>=b,c-=b,r.back+=b}if(u>>>=g,c-=g,r.back+=g,r.length=y,0===m){r.mode=16205;break}if(32&m){r.back=-1,r.mode=Mf;break}if(64&m){e.msg="invalid literal/length code",r.mode=Pf;break}r.extra=15&m,r.mode=16201;case 16201:if(r.extra){for(T=r.extra;c<T;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;S=r.distcode[u&(1<<r.distbits)-1],g=S>>>24,m=S>>>16&255,y=65535&S,!(g<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(!(240&m)){for(b=g,x=m,w=y;S=r.distcode[w+((u&(1<<b+x)-1)>>b)],g=S>>>24,m=S>>>16&255,y=65535&S,!(b+g<=c);){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}u>>>=b,c-=b,r.back+=b}if(u>>>=g,c-=g,r.back+=g,64&m){e.msg="invalid distance code",r.mode=Pf;break}r.offset=y,r.extra=15&m,r.mode=16203;case 16203:if(r.extra){for(T=r.extra;c<T;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Pf;break}r.mode=16204;case 16204:if(0===l)break e;if(f=d-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Pf;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),v=r.window}else v=i,p=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{i[a++]=v[p++]}while(--f);0===r.length&&(r.mode=If);break;case 16205:if(0===l)break e;i[a++]=r.length,l--,r.mode=If;break;case Ff:if(r.wrap){for(;c<32;){if(0===s)break e;s--,u|=n[o++]<<c,c+=8}if(d-=l,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?Hh(r.check,i,d,a-d):zh(r.check,i,d,a-d)),d=l,4&r.wrap&&(r.flags?u:Df(u))!==r.check){e.msg="incorrect data check",r.mode=Pf;break}u=0,c=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,u+=n[o++]<<c,c+=8}if(4&r.wrap&&u!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Pf;break}u=0,c=0}r.mode=16208;case 16208:E=xf;break e;case Pf:E=Ef;break e;case 16210:return Sf;default:return _f}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=s,r.hold=u,r.bits=c,(r.wsize||d!==e.avail_out&&r.mode<Pf&&(r.mode<Ff||t!==gf))&&Vf(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?Hh(r.check,i,d,e.next_out-d):zh(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Mf?128:0)+(r.mode===Rf||r.mode===Lf?256:0),(0===h&&0===d||t===gf)&&E===bf&&(E=Cf),E},Kf={inflateReset:zf,inflateReset2:Xf,inflateResetKeep:Uf,inflateInit:e=>Hf(e,15),inflateInit2:Hf,inflate:qf,inflateEnd:e=>{if(Bf(e))return _f;let t=e.state;return t.window&&(t.window=null),e.state=null,bf},inflateGetHeader:(e,t)=>{if(Bf(e))return _f;const r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,bf):_f},inflateSetDictionary:(e,t)=>{const r=t.length;let n,i,o;return Bf(e)?_f:(n=e.state,0!==n.wrap&&n.mode!==Af?_f:n.mode===Af&&(i=1,i=zh(i,t,r,0),i!==n.check)?Ef:(o=Vf(e,t,r,r),o?(n.mode=16210,Sf):(n.havedict=1,bf)))},inflateInfo:"pako inflate (from Nodeca project)"};var Zf=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Jf=Object.prototype.toString,{Z_NO_FLUSH:Qf,Z_FINISH:$f,Z_OK:ep,Z_STREAM_END:tp,Z_NEED_DICT:rp,Z_STREAM_ERROR:np,Z_DATA_ERROR:ip,Z_MEM_ERROR:op}=jh;function ap(e){this.options=Yd.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kd,this.strm.avail_out=0;let r=Kf.inflateInit2(this.strm,t.windowBits);if(r!==ep)throw new Error(Gh[r]);if(this.header=new Zf,Kf.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=qd.string2buf(t.dictionary):"[object ArrayBuffer]"===Jf.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Kf.inflateSetDictionary(this.strm,t.dictionary),r!==ep)))throw new Error(Gh[r])}function sp(e,t){const r=new ap(t);if(r.push(e),r.err)throw r.msg||Gh[r.err];return r.result}ap.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?$f:Qf,"[object ArrayBuffer]"===Jf.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Kf.inflate(r,a),o===rp&&i&&(o=Kf.inflateSetDictionary(r,i),o===ep?o=Kf.inflate(r,a):o===ip&&(o=rp));r.avail_in>0&&o===tp&&r.state.wrap>0&&0!==e[r.next_in];)Kf.inflateReset(r),o=Kf.inflate(r,a);switch(o){case np:case ip:case rp:case op:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(0===r.avail_out||o===tp))if("string"===this.options.to){let e=qd.utf8border(r.output,r.next_out),t=r.next_out-e,i=qd.buf2string(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==ep||0!==s){if(o===tp)return o=Kf.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},ap.prototype.onData=function(e){this.chunks.push(e)},ap.prototype.onEnd=function(e){e===ep&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Yd.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var lp={Inflate:ap,inflate:sp,inflateRaw:function(e,t){return(t=t||{}).raw=!0,sp(e,t)},ungzip:sp,constants:jh};const{Inflate:up,inflate:cp,inflateRaw:hp,ungzip:dp}=lp;var fp=cp,pp={},vp={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"};Object.keys(vp).forEach((function(e){return pp[vp[e]]=e}));var gp,mp,yp,bp,xp,wp=["none","red","orange","yellow","green","blue","violet","gray"],_p=["LMsk","Lr16","Lr32","Layr","Mt16","Mt32","Mtrn","Alph","FMsk","lnk2","FEid","FXid","PxSD","cinf"];function Ep(e,t,r){var n=function(e){var t={};return Object.keys(e).forEach((function(r){return t[e[r]]=r})),t}(r);return{decode:function(e){var r=e.split(".")[1];if(r&&!n[r])throw new Error("Unrecognized value for enum: '".concat(e,"'"));return n[r]||t},encode:function(n){if(n&&!r[n])throw new Error("Invalid value for enum: '".concat(n,"'"));return"".concat(e,".").concat(r[n]||r[t])}}}function Sp(e,t){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return t?3:e+1;case-1:return t?4:3;default:return e+1}}function Cp(e,t,r){return e<t?t:e>r?r:e}function kp(e){for(var t=e.data,r=t instanceof Float32Array?1:t instanceof Uint16Array?65535:255,n=0,i=0|t.length;n<i;n=n+4|0)t[n+0]=0,t[n+1]=0,t[n+2]=0,t[n+3]=r}function Tp(e){var t,r=Ap(e.width,e.height);if(e.data instanceof Uint8ClampedArray)t=e;else{t=Lp(e.width,e.height);var n=e.data,i=t.data;if(n instanceof Float32Array)for(var o=0,a=n.length;o<a;o+=4)i[o+0]=Math.round(255*Math.pow(n[o+0],1/2.2)),i[o+1]=Math.round(255*Math.pow(n[o+1],1/2.2)),i[o+2]=Math.round(255*Math.pow(n[o+2],1/2.2)),i[o+3]=Math.round(255*n[o+3]);else{var s=n instanceof Uint16Array?8:0;for(o=0,a=n.length;o<a;o++)i[o]=n[o]>>>s}}return r.getContext("2d").putImageData(t,0,0),r}!function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"}(gp||(gp={})),function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"}(mp||(mp={})),function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"}(yp||(yp={})),function(e){e[e.Color0=0]="Color0",e[e.Color1=1]="Color1",e[e.Color2=2]="Color2",e[e.Color3=3]="Color3",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"}(bp||(bp={})),function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"}(xp||(xp={}));var Ap=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")},Mp=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvasFromData method")},Op=void 0,Lp=function(e,t){return Op||(Op=Ap(1,1)),Op.getContext("2d").createImageData(e,t)};function Rp(e){return 4294967168&e?4294965248&e?4294901760&e?4:3:2:1}function Ip(e,t,r){var n=Rp(r);switch(n){case 1:e[t]=r;break;case 2:e[t]=r>>6&31|192,e[t+1]=63&r|128;break;case 3:e[t]=r>>12&15|224,e[t+1]=r>>6&63|128,e[t+2]=63&r|128;break;default:e[t]=r>>18&7|240,e[t+1]=r>>12&63|128,e[t+2]=r>>6&63|128,e[t+3]=63&r|128}return n}function Fp(e){if(e.length>1e3&&"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);var t=new Uint8Array(function(e){for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n>=55296&&n<=56319){if(r+1<e.length){var i=e.charCodeAt(r+1);56320==(64512&i)&&(r++,t+=Rp(((1023&n)<<10)+(1023&i)+65536))}}else t+=Rp(n)}return t}(e));return function(e,t,r){for(var n=0;n<r.length;n++){var i=r.charCodeAt(n);if(i>=55296&&i<=56319){if(n+1<r.length){var o=r.charCodeAt(n+1);56320==(64512&o)&&(n++,t+=Ip(e,t,((1023&i)<<10)+(1023&o)+65536))}}else t+=Ip(e,t,i)}}(t,0,e),t}function Pp(e,t){if(t>=e.length)throw Error("Invalid byte index");var r=e[t];if(128==(192&r))return 63&r;throw Error("Invalid continuation byte")}"undefined"!=typeof document&&(Ap=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},Mp=function(e){var t=new Image;t.src="data:image/jpeg;base64,"+we(e);var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0),r});var Dp=function(){return Dp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Dp.apply(this,arguments)};var Np,Bp,Up={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},zp=(Np=Up,Bp={},Object.keys(Np).forEach((function(e){return Bp[Np[e]]=e})),Bp);function Xp(e,t){return{name:e,classID:t}}for(var Hp=Xp("","null"),Gp={strokeStyleContent:Xp("","solidColorLayer"),printProofSetup:Xp("Proof Setup","proofSetup"),patternFill:Xp("","patternFill"),Grad:Xp("Gradient","Grdn"),ebbl:Xp("","ebbl"),SoFi:Xp("","SoFi"),GrFl:Xp("","GrFl"),sdwC:Xp("","RGBC"),hglC:Xp("","RGBC"),"Clr ":Xp("","RGBC"),tintColor:Xp("","RGBC"),Ofst:Xp("","Pnt "),ChFX:Xp("","ChFX"),MpgS:Xp("","ShpC"),DrSh:Xp("","DrSh"),IrSh:Xp("","IrSh"),OrGl:Xp("","OrGl"),IrGl:Xp("","IrGl"),TrnS:Xp("","ShpC"),Ptrn:Xp("","Ptrn"),FrFX:Xp("","FrFX"),phase:Xp("","Pnt "),frameStep:Hp,duration:Hp,workInTime:Hp,workOutTime:Hp,audioClipGroupList:Hp,bounds:Xp("","Rctn"),customEnvelopeWarp:Xp("","customEnvelopeWarp"),warp:Xp("","warp"),"Sz  ":Xp("","Pnt "),origin:Xp("","Pnt "),autoExpandOffset:Xp("","Pnt "),keyOriginShapeBBox:Xp("","unitRect"),Vrsn:Hp,psVersion:Hp,docDefaultNewArtboardBackgroundColor:Xp("","RGBC"),artboardRect:Xp("","classFloatRect"),keyOriginRRectRadii:Xp("","radii"),keyOriginBoxCorners:Hp,rectangleCornerA:Xp("","Pnt "),rectangleCornerB:Xp("","Pnt "),rectangleCornerC:Xp("","Pnt "),rectangleCornerD:Xp("","Pnt "),compInfo:Hp,Trnf:Xp("Transform","Trnf"),quiltWarp:Xp("","quiltWarp"),generatorSettings:Hp,crema:Hp,FrIn:Hp,blendOptions:Hp,FXRf:Hp,Lefx:Hp,time:Hp,animKey:Hp,timeScope:Hp,inTime:Hp,outTime:Hp,sheetStyle:Hp,translation:Hp,Skew:Hp,boundingBox:Xp("","boundingBox"),"Lnk ":Xp("","ExternalFileLink"),frameReader:Xp("","FrameReader"),effectParams:Xp("","motionTrackEffectParams"),Impr:Xp("None","none"),Anch:Xp("","Pnt "),"Fwd ":Xp("","Pnt "),"Bwd ":Xp("","Pnt "),FlrC:Xp("","Pnt "),meshBoundaryPath:Xp("","pathClass"),filterFX:Xp("","filterFXStyle"),Fltr:Xp("","rigidTransform"),FrgC:Xp("","RGBC"),BckC:Xp("","RGBC"),sdwM:Xp("Parameters","adaptCorrectTones"),hglM:Xp("Parameters","adaptCorrectTones"),customShape:Xp("","customShape"),origFXRefPoint:Hp,FXRefPoint:Hp},jp={"Crv ":Xp("","CrPt"),Clrs:Xp("","Clrt"),Trns:Xp("","TrnS"),keyDescriptorList:Hp,solidFillMulti:Xp("","SoFi"),gradientFillMulti:Xp("","GrFl"),dropShadowMulti:Xp("","DrSh"),innerShadowMulti:Xp("","IrSh"),frameFXMulti:Xp("","FrFX"),FrIn:Hp,FSts:Hp,LaSt:Hp,sheetTimelineOptions:Hp,trackList:Xp("","animationTrack"),globalTrackList:Xp("","animationTrack"),keyList:Hp,audioClipGroupList:Hp,audioClipList:Hp,countObjectList:Xp("","countObject"),countGroupList:Xp("","countGroup"),slices:Xp("","slice"),"Pts ":Xp("","Pthp"),SbpL:Xp("","SbpL"),pathComponents:Xp("","PaCm"),filterFXList:Xp("","filterFX"),puppetShapeList:Xp("","puppetShape"),channelDenoise:Xp("","channelDenoiseParams"),ShrP:Xp("","Pnt "),layerSettings:Hp,list:Hp},Yp={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName","placed","description","reason","artboardPresetName","json","clipID","relPath","fullPath","mediaDescriptor","Msge","altTag","url","cellText","preset","KnNm","FPth","comment"],tdta:["EngineData","LUT3DFileData","indexArray","originalVertexArray","deformedVertexArray","LqMe"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Cnt ","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","presetKind","comp","compID","originalCompID","curvesPresetKind","mixerPresetKind","uOrder","vOrder","PgNm","totalPages","Crop","numerator","denominator","frameCount","Annt","keyOriginType","unitValueQuadVersion","keyOriginIndex","major","minor","fix","docDefaultNewArtboardBackgroundType","artboardBackgroundType","numModifyingFX","deformNumRows","deformNumCols","FrID","FrDl","FsID","LCnt","AFrm","AFSt","numBefore","numAfter","Spcn","minOpacity","maxOpacity","BlnM","sheetID","gblA","globalAltitude","descVersion","frameReaderType","LyrI","zoomOrigin","fontSize","Rds ","sliceID","topOutset","leftOutset","bottomOutset","rightOutset","filterID","meshQuality","meshExpansion","meshRigidity","VrsM","VrsN","NmbG","WLMn","WLMx","AmMn","AmMx","SclH","SclV","Lvl ","TlNm","TlOf","FlRs","Thsh","ShrS","ShrE","FlRs","Vrnc","Strg","ExtS","ExtD","HrzS","VrtS","NmbR","EdgF","Ang1","Ang2","Ang3","Ang4","lastAppliedComp","capturedInfo"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","BlrQ","bvlT","bvlS","bvlD","Md  ","glwS","GrdF","GlwT","RplS","BlrM","SmBM","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder","enableCompCore","enableCompCoreGPU","compCoreSupport","compCoreGPUSupport","Engn","enableCompCoreThreads","gs99","FrDs","trackID","animInterpStyle","horzAlign","vertAlign","bgColorType","shapeOperation","UndA","Wvtp","Drct","WndM","Edg ","FlCl","IntE","IntC","Cnvr","Fl  ","Dstr","MztT","Lns ","ExtT","DspM","ExtR","ZZTy","SphM","SmBQ"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","uglg","antialiasGloss","useShape","Vsbl","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint","keyShapeInvalidated","autoExpandEnabled","autoNestEnabled","autoPositionEnabled","shrinkwrapOnSaveEnabled","present","showInDialog","overprint","sheetDisclosed","lightsDisclosed","meshesDisclosed","materialsDisclosed","hasMotion","muted","Effc","selected","autoScope","fillCanvas","cellTextIsHTML","Smoo","Clsp","validAtPosition","rigidType","hasoptions","filterMaskEnable","filterMaskLinked","filterMaskExtendWithWhite","removeJPEGArtifact","Mnch","ExtF","ExtM","moreAccurate","GpuY","LIWy"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","Wdth","Hght","strokeStyleMiterLimit","strokeStyleResolution","layerTime","keyOriginResolution","xx","xy","yx","yy","tx","ty","FrGA","frameRate","audioLevel","rotation","X   ","Y   ","redFloat","greenFloat","blueFloat","imageResolution","PuX0","PuX1","PuX2","PuX3","PuY0","PuY1","PuY2","PuY3"],UntF:["sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","H   ","Top ","Left","Btom","Rght","Rslt","topRight","topLeft","bottomLeft","bottomRight","ClNs","Shrp"],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","slices","LaSt","Trnf","nonAffineTransform","keyDescriptorList","guideIndeces","gradientFillMulti","solidFillMulti","frameFXMulti","innerShadowMulti","dropShadowMulti","FrIn","FSts","FsFr","sheetTimelineOptions","audioClipList","trackList","globalTrackList","keyList","audioClipList","warpValues","selectedPin","Pts ","SbpL","pathComponents","pinOffsets","posFinalPins","pinVertexIndices","PinP","PnRt","PnOv","PnDp","filterFXList","puppetShapeList","ShrP","channelDenoise","Mtrx","layerSettings","list","compList"],ObAr:["meshPoints","quiltSliceX","quiltSliceY"],"obj ":["null","Chnl"],"Pth ":["DspF"]},Wp=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],Vp={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF",Trnf:"doub",nonAffineTransform:"doub",keyDescriptorList:"Objc",gradientFillMulti:"Objc",solidFillMulti:"Objc",frameFXMulti:"Objc",innerShadowMulti:"Objc",dropShadowMulti:"Objc",LaSt:"Objc",FrIn:"Objc",FSts:"Objc",FsFr:"long",blendOptions:"Objc",sheetTimelineOptions:"Objc",keyList:"Objc",warpValues:"doub",selectedPin:"long","Pts ":"Objc",SbpL:"Objc",pathComponents:"Objc",pinOffsets:"doub",posFinalPins:"doub",pinVertexIndices:"long",PinP:"doub",PnRt:"long",PnOv:"bool",PnDp:"doub",filterFXList:"Objc",puppetShapeList:"Objc",ShrP:"Objc",channelDenoise:"Objc",Mtrx:"long",compList:"long"},qp={},Kp=0,Zp=Object.keys(Yp);Kp<Zp.length;Kp++)for(var Jp=Zp[Kp],Qp=0,$p=Yp[Jp];Qp<$p.length;Qp++){var ev=$p[Qp];qp[ev]=Jp}for(var tv=0,rv=Object.keys(Gp);tv<rv.length;tv++){ev=rv[tv];qp[ev]||(qp[ev]="Objc")}for(var nv=0,iv=Object.keys(jp);nv<iv.length;nv++){ev=iv[nv];Vp[ev]="Objc"}function ov(e,t,r,n){return"null"===e&&"slices"===r?"TEXT":"groupID"===e?"slices"===r?"long":"TEXT":"Sz  "===e?"Wdth"in t?"Objc":"units"in t?"UntF":"doub":"Type"===e?"string"==typeof t?"enum":"long":"AntA"===e?"string"==typeof t?"enum":"bool":"Hrzn"!==e&&"Vrtc"!==e||"keyType.Pstn"!==n.Type?"Hrzn"===e||"Vrtc"===e||"Top "===e||"Left"===e||"Btom"===e||"Rght"===e?"slices"===r?"long":"number"==typeof t?"doub":"UntF":"Vrsn"===e?"number"==typeof t?"long":"Objc":"Rd  "===e||"Grn "===e||"Bl  "===e?"artd"===r?"long":"doub":"Trnf"===e?Array.isArray(t)?"VlLs":"Objc":qp[e]:"long"}function av(e){return Nm(e,Sm(e)||4)}function sv(e,t){if(4===t.length&&"warp"!==t&&"time"!==t&&"hold"!==t&&"list"!==t)Rb(e,0),Xb(e,t);else{Rb(e,t.length);for(var r=0;r<t.length;r++)Ab(e,t.charCodeAt(r))}}function lv(e,t){for(var r=fv(e),n=t?{_name:r.name,_classID:r.classID}:{},i=km(e),o=0;o<i;o++){var a=av(e),s=cv(e,Rm(e),t);n[a]=s}return n}function uv(e,t,r,n,i){jb(e,t),sv(e,r);var o=Object.keys(n),a=o.length;"_name"in n&&a--,"_classID"in n&&a--,Fb(e,a);for(var s=0,l=o;s<l.length;s++){var u=l[s];if("_name"!==u&&"_classID"!==u){var c=ov(u,n[u],i,n),h=Gp[u];"bounds"===u&&"text"===i?h=Xp("","bounds"):"origin"===u?c="slices"===i?"enum":"Objc":"Cyn "!==u&&"Mgnt"!==u&&"Ylw "!==u&&"Blck"!==u||"CMYC"!==n._classID?/^PN[a-z][a-z]$/.test(u)?c="TEXT":/^PT[a-z][a-z]$/.test(u)?c="long":/^PF[a-z][a-z]$/.test(u)?c="doub":"ClSz"===u||"Rds "===u||"Amnt"===u?c="number"==typeof n[u]?"long":"UntF":"sdwM"!==u&&"hglM"!==u||"string"!=typeof n[u]?"blur"===u&&"string"==typeof n[u]?c="enum":"Angl"===u&&"number"==typeof n[u]?c="doub":"bounds"===u&&"slices"===i?(c="Objc",h=Xp("","Rct1")):"Scl "===u?"object"==typeof n[u]&&"Hrzn"in n[u]?(c="Objc",h=Hp):c="number"==typeof n[u]?"long":"UntF":"audioClipGroupList"===u&&1===o.length?c="VlLs":"Strt"!==u&&"Brgh"!==u||!("H   "in n)?"Wdth"===u&&"object"==typeof n[u]?c="UntF":"Ofst"===u&&"number"==typeof n[u]?c="long":"Strt"===u&&"object"==typeof n[u]?(c="Objc",h=Hp):-1!==Wp.indexOf(u)?c="RGBC"===r&&"artd"!==i?"doub":"long":"profile"===u?c="printOutput"===r?"TEXT":"tdta":"strokeStyleContent"===u?n[u]["Clr "]?h=Xp("","solidColorLayer"):n[u].Grad?h=Xp("","gradientLayer"):n[u].Ptrn&&(h=Xp("","patternLayer")):"bounds"===u&&"quiltWarp"===i&&(h=Xp("","classFloatRect")):c="doub":c="enum":c="doub",h&&"RGBC"===h.classID&&"H   "in n[u]&&(h={classID:"HSBC",name:""}),sv(e,u),Xb(e,c||"long"),dv(e,c||"long",n[u],u,h,i)}}}function cv(e,t,r){switch(t){case"obj ":return function(e){for(var t=Sm(e),r=[],n=0;n<t;n++){var i=Rm(e);switch(i){case"prop":fv(e);var o=av(e);r.push(o);break;case"Clss":r.push(fv(e));break;case"Enmr":fv(e);var a=av(e),s=av(e);r.push("".concat(a,".").concat(s));break;case"rele":fv(e),r.push(km(e));break;case"Idnt":case"indx":r.push(Sm(e));break;case"name":fv(e),r.push(Pm(e));break;default:throw new Error("Invalid descriptor reference type: ".concat(i))}}return r}(e);case"Objc":case"GlbO":return lv(e,r);case"VlLs":for(var n=Sm(e),i=[],o=0;o<n;o++){var a=Rm(e);i.push(cv(e,a,r))}return i;case"doub":return Am(e);case"UntF":var s=Rm(e),l=Am(e);if(!Up[s])throw new Error("Invalid units: ".concat(s));return{units:Up[s],value:l};case"UnFl":s=Rm(e),l=Tm(e);if(!Up[s])throw new Error("Invalid units: ".concat(s));return{units:Up[s],value:l};case"TEXT":return Pm(e);case"enum":var u=av(e);l=av(e);return"".concat(u,".").concat(l);case"long":return Sm(e);case"comp":return{low:km(e),high:km(e)};case"bool":return!!bm(e);case"type":case"GlbC":return fv(e);case"alis":return Nm(e,Sm(e));case"tdta":return Lm(e,Sm(e));case"ObAr":Sm(e),Pm(e),av(e);var c=Sm(e);for(i=[],o=0;o<c;o++){var h=av(e);Rm(e),Rm(e);for(var d=Sm(e),f=[],p=0;p<d;p++)f.push(Am(e));i.push({type:h,values:f})}return i;case"Pth ":Sm(e);var v=Rm(e);Cm(e);var g=function(e,t){var r="";for(;t--;){var n=Em(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}(e,Cm(e));return{sig:v,path:g};default:throw new Error("Invalid TySh descriptor OSType: ".concat(t," at ").concat(e.offset.toString(16)))}}var hv={meshPoints:"rationalPoint",quiltSliceX:"UntF",quiltSliceY:"UntF"};function dv(e,t,r,n,i,o){switch(t){case"obj ":!function(e,t,r){Rb(e,r.length);for(var n=0;n<r.length;n++){var i=r[n],o="unknown";switch("string"==typeof i&&(o=/^[a-z]+\.[a-z]+$/i.test(i)?"Enmr":"name"),Xb(e,o),o){case"Enmr":var a=i.split("."),s=a[0],l=a[1];pv(e,"\0",s),sv(e,s),sv(e,l);break;case"name":pv(e,"\0","Lyr "),Gb(e,i+"\0");break;default:throw new Error("Invalid descriptor reference type: ".concat(o))}}}(e,0,r);break;case"Objc":case"GlbO":if("object"!=typeof r)throw new Error("Invalid struct value: ".concat(JSON.stringify(r),", key: ").concat(n));if(!i)throw new Error("Missing ext type for: '".concat(n,"' (").concat(JSON.stringify(r),")"));uv(e,r._name||i.name,r._classID||i.classID,r,o);break;case"VlLs":if(!Array.isArray(r))throw new Error("Invalid list value: ".concat(JSON.stringify(r),", key: ").concat(n));Rb(e,r.length);for(var a=0;a<r.length;a++){var s=Vp[n];Xb(e,s||"long"),dv(e,s||"long",r[a],"".concat(n,"[]"),jp[n],o)}break;case"doub":if("number"!=typeof r)throw new Error("Invalid number value: ".concat(JSON.stringify(r),", key: ").concat(n));Db(e,r);break;case"UntF":if(!zp[r.units])throw new Error("Invalid units: ".concat(r.units," in ").concat(n));Xb(e,zp[r.units]),Db(e,r.value);break;case"UnFl":if(!zp[r.units])throw new Error("Invalid units: ".concat(r.units," in ").concat(n));Xb(e,zp[r.units]),Pb(e,r.value);break;case"TEXT":jb(e,r);break;case"enum":if("string"!=typeof r)throw new Error("Invalid enum value: ".concat(JSON.stringify(r),", key: ").concat(n));var l=r.split("."),u=l[0],c=l[1];sv(e,u),sv(e,c);break;case"long":if("number"!=typeof r)throw new Error("Invalid integer value: ".concat(JSON.stringify(r),", key: ").concat(n));Rb(e,r);break;case"bool":if("boolean"!=typeof r)throw new Error("Invalid boolean value: ".concat(JSON.stringify(r),", key: ").concat(n));Ab(e,r?1:0);break;case"tdta":Rb(e,r.byteLength),Ub(e,r);break;case"ObAr":Rb(e,16),jb(e,"");var h=hv[n];if(!h)throw new Error("Not implemented ObArType for: ".concat(n));sv(e,h),Rb(e,r.length);for(a=0;a<r.length;a++){sv(e,r[a].type),Xb(e,"UnFl"),Xb(e,"#Pxl"),Rb(e,r[a].values.length);for(var d=0;d<r[a].values.length;d++)Db(e,r[a].values[d])}break;case"Pth ":var f=12+2*r.path.length;Rb(e,f),Xb(e,r.sig),Ib(e,f),Ib(e,r.path.length),function(e,t){for(var r=0;r<t.length;r++)Lb(e,t.charCodeAt(r))}(e,r.path);break;default:throw new Error("Not implemented descriptor OSType: ".concat(t))}}function fv(e){return{name:Pm(e),classID:av(e)}}function pv(e,t,r){Gb(e,t),sv(e,r)}function vv(e,t){void 0===t&&(t=!1);var r=km(e);if(16!==r)throw new Error("Invalid descriptor version: ".concat(r));return lv(e,t)}function gv(e,t,r,n,i){void 0===i&&(i=""),Fb(e,16),uv(e,t,r,n,i)}function mv(e){return{x:e.Hrzn,y:e.Vrtc}}function yv(e){return{Hrzn:e.x,Vrtc:e.y}}function bv(e){return{top:jv(e["Top "]),left:jv(e.Left),right:jv(e.Rght),bottom:jv(e.Btom)}}function xv(e){var t;return(t={Left:Kv(e.left,"bounds.left")})["Top "]=Kv(e.top,"bounds.top"),t.Rght=Kv(e.right,"bounds.right"),t.Btom=Kv(e.bottom,"bounds.bottom"),t}function wv(e){var t={enabled:!!e.enab,position:dg.decode(e.Styl),fillType:fg.decode(e.PntT),blendMode:tg.decode(e["Md  "]),opacity:Hv(e.Opct),size:jv(e["Sz  "])};return void 0!==e.present&&(t.present=e.present),void 0!==e.showInDialog&&(t.showInDialog=e.showInDialog),void 0!==e.overprint&&(t.overprint=e.overprint),e["Clr "]&&(t.color=Uv(e["Clr "])),e.Grad&&(t.gradient=Iv(e)),e.Ptrn&&(t.pattern=Fv(e)),t}function _v(e){var t={};return t.enab=!!e.enabled,void 0!==e.present&&(t.present=!!e.present),void 0!==e.showInDialog&&(t.showInDialog=!!e.showInDialog),t.Styl=dg.encode(e.position),t.PntT=fg.encode(e.fillType),t["Md  "]=tg.encode(e.blendMode),t.Opct=Vv(e.opacity),t["Sz  "]=Kv(e.size,"size"),e.color&&(t["Clr "]=zv(e.color)),e.gradient&&(t=Dp(Dp({},t),Dv(e.gradient))),e.pattern&&(t=Dp(Dp({},t),Nv(e.pattern))),void 0!==e.overprint&&(t.overprint=!!e.overprint),t}function Ev(e,t,r){for(var n,i,o,a,s,l,u,c,h,d,f,p,v,g=r?{"Scl ":qv(null!==(n=e.scale)&&void 0!==n?n:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":qv(null!==(i=e.scale)&&void 0!==i?i:1)},m=0,y=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"];m<y.length;m++){if(e[w=y[m]]&&!Array.isArray(e[w]))throw new Error("".concat(w," should be an array"))}if((null===(o=e.dropShadow)||void 0===o?void 0:o[0])&&!r&&(g.DrSh=Ov(e.dropShadow[0],"dropShadow",t)),(null===(a=e.dropShadow)||void 0===a?void 0:a[0])&&r&&(g.dropShadowMulti=e.dropShadow.map((function(e){return Ov(e,"dropShadow",t)}))),(null===(s=e.innerShadow)||void 0===s?void 0:s[0])&&!r&&(g.IrSh=Ov(e.innerShadow[0],"innerShadow",t)),(null===(l=e.innerShadow)||void 0===l?void 0:l[0])&&r&&(g.innerShadowMulti=e.innerShadow.map((function(e){return Ov(e,"innerShadow",t)}))),e.outerGlow&&(g.OrGl=Ov(e.outerGlow,"outerGlow",t)),(null===(u=e.solidFill)||void 0===u?void 0:u[0])&&r&&(g.solidFillMulti=e.solidFill.map((function(e){return Ov(e,"solidFill",t)}))),(null===(c=e.gradientOverlay)||void 0===c?void 0:c[0])&&r&&(g.gradientFillMulti=e.gradientOverlay.map((function(e){return Ov(e,"gradientOverlay",t)}))),(null===(h=e.stroke)||void 0===h?void 0:h[0])&&r&&(g.frameFXMulti=e.stroke.map((function(e){return _v(e)}))),e.innerGlow&&(g.IrGl=Ov(e.innerGlow,"innerGlow",t)),e.bevel&&(g.ebbl=Ov(e.bevel,"bevel",t)),(null===(d=e.solidFill)||void 0===d?void 0:d[0])&&!r&&(g.SoFi=Ov(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(g.patternFill=Ov(e.patternOverlay,"patternOverlay",t)),(null===(f=e.gradientOverlay)||void 0===f?void 0:f[0])&&!r&&(g.GrFl=Ov(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(g.ChFX=Ov(e.satin,"satin",t)),(null===(p=e.stroke)||void 0===p?void 0:p[0])&&!r&&(g.FrFX=_v(null===(v=e.stroke)||void 0===v?void 0:v[0])),r){g.numModifyingFX=0;for(var b=0,x=Object.keys(e);b<x.length;b++){var w,_=e[w=x[b]];if(Array.isArray(_))for(var E=0,S=_;E<S.length;E++){S[E].enabled&&g.numModifyingFX++}else _.enabled&&g.numModifyingFX++}}return g}function Sv(e,t){var r={};return e.masterFXSwitch||(r.disabled=!0),e["Scl "]&&(r.scale=Hv(e["Scl "])),e.DrSh&&(r.dropShadow=[Mv(e.DrSh,t)]),e.dropShadowMulti&&(r.dropShadow=e.dropShadowMulti.map((function(e){return Mv(e,t)}))),e.IrSh&&(r.innerShadow=[Mv(e.IrSh,t)]),e.innerShadowMulti&&(r.innerShadow=e.innerShadowMulti.map((function(e){return Mv(e,t)}))),e.OrGl&&(r.outerGlow=Mv(e.OrGl,t)),e.IrGl&&(r.innerGlow=Mv(e.IrGl,t)),e.ebbl&&(r.bevel=Mv(e.ebbl,t)),e.SoFi&&(r.solidFill=[Mv(e.SoFi,t)]),e.solidFillMulti&&(r.solidFill=e.solidFillMulti.map((function(e){return Mv(e,t)}))),e.patternFill&&(r.patternOverlay=Mv(e.patternFill,t)),e.GrFl&&(r.gradientOverlay=[Mv(e.GrFl,t)]),e.gradientFillMulti&&(r.gradientOverlay=e.gradientFillMulti.map((function(e){return Mv(e,t)}))),e.ChFX&&(r.satin=Mv(e.ChFX,t)),e.FrFX&&(r.stroke=[wv(e.FrFX)]),e.frameFXMulti&&(r.stroke=e.frameFXMulti.map((function(e){return wv(e)}))),r}function Cv(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.time,a=o.denominator,s=o.numerator,l=i.selected,u=i.animKey,c={numerator:s,denominator:a},h=lg.decode(i.animInterpStyle);switch(u.Type){case"keyType.Opct":r.push({interpolation:h,time:c,selected:l,type:"opacity",value:Hv(u.Opct)});break;case"keyType.Pstn":r.push({interpolation:h,time:c,selected:l,type:"position",x:u.Hrzn,y:u.Vrtc});break;case"keyType.Trnf":r.push({interpolation:h,time:c,selected:l,type:"transform",scale:mv(u["Scl "]),skew:mv(u.Skew),rotation:u.rotation,translation:mv(u.translation)});break;case"keyType.sheetStyle":var d={interpolation:h,time:c,selected:l,type:"style"};u.sheetStyle.Lefx&&(d.style=Sv(u.sheetStyle.Lefx,t)),r.push(d);break;case"keyType.globalLighting":r.push({interpolation:h,time:c,selected:l,type:"globalLighting",globalAngle:u.gblA,globalAltitude:u.globalAltitude});break;default:throw new Error("Unsupported keyType value")}}return r}function kv(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=n.time,o=n.selected,a=void 0!==o&&o,s=n.interpolation,l=lg.encode(s),u=void 0;switch(n.type){case"opacity":u={Type:"keyType.Opct",Opct:Vv(n.value)};break;case"position":u={Type:"keyType.Pstn",Hrzn:n.x,Vrtc:n.y};break;case"transform":u={Type:"keyType.Trnf","Scl ":yv(n.scale),Skew:yv(n.skew),rotation:n.rotation,translation:yv(n.translation)};break;case"style":u={Type:"keyType.sheetStyle",sheetStyle:{Vrsn:1,blendOptions:{}}},n.style&&(u.sheetStyle={Vrsn:1,Lefx:Ev(n.style,!1,!1),blendOptions:{}});break;case"globalLighting":u={Type:"keyType.globalLighting",gblA:n.globalAngle,globalAltitude:n.globalAltitude};break;default:throw new Error("Unsupported keyType value")}t.push({Vrsn:1,animInterpStyle:l,time:i,animKey:u,selected:a})}return t}function Tv(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o={type:ug.decode(i.trackID),enabled:i.enab,keys:Cv(i.keyList,t)};i.effectParams&&(o.effectParams={fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin,keys:Cv(i.effectParams.keyList,t)}),r.push(o)}return r}function Av(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(Dp(Dp({trackID:ug.encode(n.type),Vrsn:1,enab:!!n.enabled,Effc:!!n.effectParams},n.effectParams?{effectParams:{keyList:kv(n.keys),fillCanvas:n.effectParams.fillCanvas,zoomOrigin:n.effectParams.zoomOrigin}}:{}),{keyList:kv(n.keys)}))}return t}function Mv(e,t){for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],a=e[o];switch(o){case"enab":r.enabled=!!a;break;case"uglg":r.useGlobalLight=!!a;break;case"AntA":r.antialiased=!!a;break;case"Algn":r.align=!!a;break;case"Dthr":r.dither=!!a;break;case"Invr":r.invert=!!a;break;case"Rvrs":r.reverse=!!a;break;case"Clr ":r.color=Uv(a);break;case"hglC":r.highlightColor=Uv(a);break;case"sdwC":r.shadowColor=Uv(a);break;case"Styl":r.position=dg.decode(a);break;case"Md  ":r.blendMode=tg.decode(a);break;case"hglM":r.highlightBlendMode=tg.decode(a);break;case"sdwM":r.shadowBlendMode=tg.decode(a);break;case"bvlS":r.style=rg.decode(a);break;case"bvlD":r.direction=ig.decode(a);break;case"bvlT":r.technique=ng.decode(a);break;case"GlwT":r.technique=og.decode(a);break;case"glwS":r.source=ag.decode(a);break;case"Type":r.type=sg.decode(a);break;case"gs99":r.interpolationMethod=cg.decode(a);break;case"Opct":r.opacity=Hv(a);break;case"hglO":r.highlightOpacity=Hv(a);break;case"sdwO":r.shadowOpacity=Hv(a);break;case"lagl":case"Angl":r.angle=Xv(a);break;case"Lald":r.altitude=Xv(a);break;case"Sftn":r.soften=jv(a);break;case"srgR":r.strength=Hv(a);break;case"blur":r.size=jv(a);break;case"Nose":r.noise=Hv(a);break;case"Inpr":r.range=Hv(a);break;case"Ckmt":r.choke=jv(a);break;case"ShdN":r.jitter=Hv(a);break;case"Dstn":r.distance=jv(a);break;case"Scl ":r.scale=Hv(a);break;case"Ptrn":r.pattern={name:a["Nm  "],id:a.Idnt};break;case"phase":r.phase={x:a.Hrzn,y:a.Vrtc};break;case"Ofst":r.offset={x:Hv(a.Hrzn),y:Hv(a.Vrtc)};break;case"MpgS":case"TrnS":r.contour={name:a["Nm  "],curve:a["Crv "].map((function(e){return{x:e.Hrzn,y:e.Vrtc}}))};break;case"Grad":r.gradient=Lv(a);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[o]=a;break;case"_name":case"_classID":break;default:t&&console.log("Invalid effect key: '".concat(o,"', value:"),a)}}return r}function Ov(e,t,r){for(var n={},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=e[a];switch(a){case"enabled":n.enab=!!s;break;case"useGlobalLight":n.uglg=!!s;break;case"antialiased":n.AntA=!!s;break;case"align":n.Algn=!!s;break;case"dither":n.Dthr=!!s;break;case"invert":n.Invr=!!s;break;case"reverse":n.Rvrs=!!s;break;case"color":n["Clr "]=zv(s);break;case"highlightColor":n.hglC=zv(s);break;case"shadowColor":n.sdwC=zv(s);break;case"position":n.Styl=dg.encode(s);break;case"blendMode":n["Md  "]=tg.encode(s);break;case"highlightBlendMode":n.hglM=tg.encode(s);break;case"shadowBlendMode":n.sdwM=tg.encode(s);break;case"style":n.bvlS=rg.encode(s);break;case"direction":n.bvlD=ig.encode(s);break;case"technique":"bevel"===t?n.bvlT=ng.encode(s):n.GlwT=og.encode(s);break;case"source":n.glwS=ag.encode(s);break;case"type":n.Type=sg.encode(s);break;case"interpolationMethod":n.gs99=cg.encode(s);break;case"opacity":n.Opct=Vv(s);break;case"highlightOpacity":n.hglO=Vv(s);break;case"shadowOpacity":n.sdwO=Vv(s);break;case"angle":"gradientOverlay"===t||"patternFill"===t?n.Angl=Wv(s):n.lagl=Wv(s);break;case"altitude":n.Lald=Wv(s);break;case"soften":n.Sftn=Kv(s,a);break;case"strength":n.srgR=Vv(s);break;case"size":n.blur=Kv(s,a);break;case"noise":n.Nose=Vv(s);break;case"range":n.Inpr=Vv(s);break;case"choke":n.Ckmt=Kv(s,a);break;case"jitter":n.ShdN=Vv(s);break;case"distance":n.Dstn=Kv(s,a);break;case"scale":n["Scl "]=Vv(s);break;case"pattern":n.Ptrn={"Nm  ":s.name,Idnt:s.id};break;case"phase":n.phase={Hrzn:s.x,Vrtc:s.y};break;case"offset":n.Ofst={Hrzn:Vv(s.x),Vrtc:Vv(s.y)};break;case"contour":n["satin"===t?"MpgS":"TrnS"]={"Nm  ":s.name,"Crv ":s.curve.map((function(e){return{Hrzn:e.x,Vrtc:e.y}}))};break;case"gradient":n.Grad=Rv(s);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[a]=s;break;default:r&&console.log("Invalid effect key: '".concat(a,"', value:"),s)}}return n}function Lv(e){if("GrdF.CstS"===e.GrdF){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map((function(e){return{color:Uv(e["Clr "]),location:e.Lctn/t,midpoint:e.Mdpn/100}})),opacityStops:e.Trns.map((function(e){return{opacity:Hv(e.Opct),location:e.Lctn/t,midpoint:e.Mdpn/100}}))}}return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:hg.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map((function(e){return e/100})),max:e["Mxm "].map((function(e){return e/100}))}}function Rv(e){var t,r;if("solid"===e.type){var n=Math.round(4096*(null!==(t=e.smoothness)&&void 0!==t?t:1));return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:n,Clrs:e.colorStops.map((function(e){var t;return{"Clr ":zv(e.color),Type:"Clry.UsrS",Lctn:Math.round(e.location*n),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}})),Trns:e.opacityStops.map((function(e){var t;return{Opct:Vv(e.opacity),Lctn:Math.round(e.location*n),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}}))}}return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:hg.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(4096*(null!==(r=e.roughness)&&void 0!==r?r:1)),"Mnm ":(e.min||[0,0,0,0]).map((function(e){return 100*e})),"Mxm ":(e.max||[1,1,1,1]).map((function(e){return 100*e}))}}function Iv(e){var t=Lv(e.Grad);return t.style=sg.decode(e.Type),void 0!==e.Dthr&&(t.dither=e.Dthr),void 0!==e.Rvrs&&(t.reverse=e.Rvrs),void 0!==e.Angl&&(t.angle=Xv(e.Angl)),void 0!==e["Scl "]&&(t.scale=Hv(e["Scl "])),void 0!==e.Algn&&(t.align=e.Algn),void 0!==e.Ofst&&(t.offset={x:Hv(e.Ofst.Hrzn),y:Hv(e.Ofst.Vrtc)}),t}function Fv(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return void 0!==e.Lnkd&&(t.linked=e.Lnkd),void 0!==e.phase&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function Pv(e){if("Grad"in e)return Iv(e);if("Ptrn"in e)return Dp({type:"pattern"},Fv(e));if("Clr "in e)return{type:"color",color:Uv(e["Clr "])};throw new Error("Invalid vector content")}function Dv(e){var t={};return void 0!==e.dither&&(t.Dthr=e.dither),void 0!==e.reverse&&(t.Rvrs=e.reverse),void 0!==e.angle&&(t.Angl=Wv(e.angle)),t.Type=sg.encode(e.style),void 0!==e.align&&(t.Algn=e.align),void 0!==e.scale&&(t["Scl "]=Vv(e.scale)),e.offset&&(t.Ofst={Hrzn:Vv(e.offset.x),Vrtc:Vv(e.offset.y)}),t.Grad=Rv(e),t}function Nv(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return void 0!==e.linked&&(t.Lnkd=!!e.linked),void 0!==e.phase&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function Bv(e){return"color"===e.type?{key:"SoCo",descriptor:{"Clr ":zv(e.color)}}:"pattern"===e.type?{key:"PtFl",descriptor:Nv(e)}:{key:"GdFl",descriptor:Dv(e)}}function Uv(e){if("H   "in e)return{h:Gv(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};if("redFloat"in e)return{fr:e.redFloat,fg:e.greenFloat,fb:e.blueFloat};throw new Error("Unsupported color descriptor")}function zv(e){if(e){if("r"in e)return{_name:"",_classID:"RGBC","Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("fr"in e)return{_name:"",_classID:"RGBC",redFloat:e.fr,greenFloat:e.fg,blueFloat:e.fb};if("h"in e)return{_name:"",_classID:"HSBC","H   ":Wv(360*e.h),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{_name:"",_classID:"CMYC","Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{_name:"",_classID:"LABC",Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{_name:"",_classID:"GRYC","Gry ":e.k};throw new Error("Invalid color value")}return{_name:"",_classID:"RGBC","Rd  ":0,"Grn ":0,"Bl  ":0}}function Xv(e){if(void 0===e)return 0;if("Angle"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value}function Hv(e){if(void 0===e)return 1;if("Percent"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value/100}function Gv(e){if(void 0===e)return 1;if("Percent"===e.units)return e.value/100;if("Angle"===e.units)return e.value/360;throw new Error("Invalid units: ".concat(e.units))}function jv(e){var t=e.units,r=e.value;if("Pixels"!==t&&"Millimeters"!==t&&"Points"!==t&&"None"!==t&&"Picas"!==t&&"Inches"!==t&&"Centimeters"!==t&&"Density"!==t)throw new Error("Invalid units: ".concat(JSON.stringify({units:t,value:r})));return{value:r,units:t}}function Yv(e,t){return void 0===t&&(t="Pixels"),"number"==typeof e?{value:e,units:t}:jv(e)}function Wv(e){return{units:"Angle",value:e||0}}function Vv(e){return{units:"Percent",value:Math.round(100*(e||0))}}function qv(e){return{units:"Percent",value:100*(e||0)}}function Kv(e,t){if(null==e)return{units:"Pixels",value:0};if("object"!=typeof e)throw new Error("Invalid value: ".concat(JSON.stringify(e)," (key: ").concat(t,") (should have value and units)"));var r=e.units,n=e.value;if("number"!=typeof n)throw new Error("Invalid value in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));if("Pixels"!==r&&"Millimeters"!==r&&"Points"!==r&&"None"!==r&&"Picas"!==r&&"Inches"!==r&&"Centimeters"!==r&&"Density"!==r)throw new Error("Invalid units in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));return{units:r,value:n}}function Zv(e){return{numerator:e.numerator,denominator:e.denominator}}var Jv=Ep("textGridding","none",{none:"None",round:"Rnd "}),Qv=Ep("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"}),$v=Ep("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm",platform:"antiAliasPlatformGray",platformLCD:"antiAliasPlatformLCD"}),eg=Ep("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist",cylinder:"warpCylinder",custom:"warpCustom"}),tg=Ep("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns","linear height":"linearHeight",height:"Hght",subtraction:"Sbtr"}),rg=Ep("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"}),ng=Ep("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"}),ig=Ep("BESs","up",{up:"In  ",down:"Out "}),og=Ep("BETE","softer",{softer:"SfBL",precise:"PrBL"}),ag=Ep("IGSr","edge",{edge:"SrcE",center:"SrcC"}),sg=Ep("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"}),lg=Ep("animInterpStyle","linear",{linear:"Lnr ",hold:"hold"}),ug=Ep("stdTrackID","opacity",{opacity:"opacityTrack",style:"styleTrack",sheetTransform:"sheetTransformTrack",sheetPosition:"sheetPositionTrack",globalLighting:"globalLightingTrack"}),cg=Ep("gradientInterpolationMethodType","perceptual",{perceptual:"Perc",linear:"Lnr",classic:"Gcls",smooth:"Smoo"}),hg=Ep("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl",hsl:"HSLC"}),dg=Ep("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"}),fg=Ep("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"}),pg=Ep("ESliceType","image",{image:"Img ",noImage:"noImage"}),vg=Ep("ESliceHorzAlign","default",{default:"default"}),gg=Ep("ESliceVertAlign","default",{default:"default"}),mg=Ep("ESliceOrigin","userGenerated",{userGenerated:"userGenerated",autoGenerated:"autoGenerated",layer:"layer"}),yg=Ep("ESliceBGColorType","none",{none:"None",matte:"matte",color:"Clr "}),bg=Ep("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"}),xg=Ep("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"}),wg=Ep("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"}),_g=Ep("BlrM","ispinmage",{spin:"Spn ",zoom:"Zm  "}),Eg=Ep("BlrQ","good",{draft:"Drft",good:"Gd  ",best:"Bst "}),Sg=Ep("SmBM","normal",{normal:"SBMN","edge only":"SBME","overlay edge":"SBMO"}),Cg=Ep("SmBQ","medium",{low:"SBQL",medium:"SBQM",high:"SBQH"}),kg=Ep("DspM","stretch to fit",{"stretch to fit":"StrF",tile:"Tile"}),Tg=Ep("UndA","repeat edge pixels",{"wrap around":"WrpA","repeat edge pixels":"RptE"}),Ag=Ep("Cnvr","rectangular to polar",{"rectangular to polar":"RctP","polar to rectangular":"PlrR"}),Mg=Ep("RplS","medium",{small:"Sml ",medium:"Mdm ",large:"Lrg "}),Og=Ep("SphM","normal",{normal:"Nrml","horizontal only":"HrzO","vertical only":"VrtO"}),Lg=Ep("Wvtp","sine",{sine:"WvSn",triangle:"WvTr",square:"WvSq"}),Rg=Ep("ZZTy","pond ripples",{"around center":"ArnC","out from center":"OtFr","pond ripples":"PndR"}),Ig=Ep("Dstr","uniform",{uniform:"Unfr",gaussian:"Gsn "}),Fg=Ep("Chnl","composite",{red:"Rd  ",green:"Grn ",blue:"Bl  ",composite:"Cmps"}),Pg=Ep("MztT","fine dots",{"fine dots":"FnDt","medium dots":"MdmD","grainy dots":"GrnD","coarse dots":"CrsD","short lines":"ShrL","medium lines":"MdmL","long lines":"LngL","short strokes":"ShSt","medium strokes":"MdmS","long strokes":"LngS"}),Dg=Ep("Lns ","50-300mm zoom",{"50-300mm zoom":"Zm  ","32mm prime":"Nkn ","105mm prime":"Nkn1","movie prime":"PnVs"}),Ng=Ep("blurType","gaussian blur",{"gaussian blur":"GsnB","lens blur":"lensBlur","motion blur":"MtnB"}),Bg=Ep("DfsM","normal",{normal:"Nrml","darken only":"DrkO","lighten only":"LghO",anisotropic:"anisotropic"}),Ug=Ep("ExtT","blocks",{blocks:"Blks",pyramids:"Pyrm"}),zg=Ep("ExtR","random",{random:"Rndm","level-based":"LvlB"}),Xg=Ep("FlCl","background color",{"background color":"FlBc","foreground color":"FlFr","inverse image":"FlIn","unaltered image":"FlSm"}),Hg=Ep("CntE","upper",{lower:"Lwr ",upper:"Upr "}),Gg=Ep("WndM","wind",{wind:"Wnd ",blast:"Blst",stagger:"Stgr"}),jg=Ep("Drct","from the right",{left:"Left",right:"Rght"}),Yg=Ep("IntE","odd lines",{"odd lines":"ElmO","even lines":"ElmE"}),Wg=Ep("IntC","interpolation",{duplication:"CrtD",interpolation:"CrtI"}),Vg=Ep("FlMd","wrap around",{"set to transparent":"Bckg","repeat edge pixels":"Rpt ","wrap around":"Wrp "});Ep("prjM","fisheye",{fisheye:"fisP",perspective:"perP",auto:"auto","full spherical":"fusP"});var qg=function(){return qg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},qg.apply(this,arguments)},Kg={};function Zg(e,t,r,n){var i={key:e,has:t,read:r,write:n};Kg[i.key]=i}var Jg=[void 0,"PPI","PPCM"],Qg=[void 0,"Inches","Centimeters","Points","Picas","Columns"],$g="0123456789abcdef";function em(e){return e<=57?e-48:e-87}function tm(e,t){return em(e.charCodeAt(t))<<4|em(e.charCodeAt(t+1))}function rm(e,t){return function(e){if(e.byteLength>1e3&&"undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t=[],r=0;r<e.length;){var n=e[r++],i=void 0;if(128&n)if(192==(224&n)){if((i=(31&n)<<6|Pp(e,r++))<128)throw Error("Invalid continuation byte")}else if(224==(240&n)){if((i=(15&n)<<12|Pp(e,r++)<<6|Pp(e,r++))<2048)throw Error("Invalid continuation byte");if(i>=55296&&i<=57343)throw Error("Lone surrogate U+".concat(i.toString(16).toUpperCase()," is not a scalar value"))}else{if(240!=(248&n))throw Error("Invalid UTF-8 detected");if((i=(15&n)<<18|Pp(e,r++)<<12|Pp(e,r++)<<6|Pp(e,r++))<65536||i>1114111)throw Error("Invalid continuation byte")}else i=n;i>65535&&(i-=65536,t.push(String.fromCharCode(i>>>10&1023|55296)),i=56320|1023&i),t.push(String.fromCharCode(i))}return t.join("")}(Lm(e,t))}function nm(e,t){Ub(e,Fp(t))}Zg(1061,(function(e){return void 0!==e.captionDigest}),(function(e,t){for(var r="",n=0;n<16;n++){var i=bm(e);r+=$g[i>>4],r+=$g[15&i]}t.captionDigest=r}),(function(e,t){for(var r=0;r<16;r++)Ab(e,tm(t.captionDigest,2*r))})),Zg(1060,(function(e){return void 0!==e.xmpMetadata}),(function(e,t,r){t.xmpMetadata=rm(e,r())}),(function(e,t){nm(e,t.xmpMetadata)}));var im=Ep("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});Zg(1082,(function(e){return void 0!==e.printInformation}),(function(e,t){var r,n,i=vv(e);t.printInformation={printerName:i.printerName||"",renderingIntent:im.decode(null!==(r=i.Inte)&&void 0!==r?r:"Inte.Img ")};var o=t.printInformation;void 0!==i.PstS&&(o.printerManagesColors=i.PstS),void 0!==i["Nm  "]&&(o.printerProfile=i["Nm  "]),void 0!==i.MpBl&&(o.blackPointCompensation=i.MpBl),void 0!==i.printSixteenBit&&(o.printSixteenBit=i.printSixteenBit),void 0!==i.hardProof&&(o.hardProof=i.hardProof),i.printProofSetup&&("Bltn"in i.printProofSetup?o.proofSetup={builtin:i.printProofSetup.Bltn.split(".")[1]}:o.proofSetup={profile:i.printProofSetup.profile,renderingIntent:im.decode(null!==(n=i.printProofSetup.Inte)&&void 0!==n?n:"Inte.Img "),blackPointCompensation:!!i.printProofSetup.MpBl,paperWhite:!!i.printProofSetup.paperWhite})}),(function(e,t){var r,n,i=t.printInformation,o={};i.printerManagesColors?o.PstS=!0:(void 0!==i.hardProof&&(o.hardProof=!!i.hardProof),o.ClrS="ClrS.RGBC",o["Nm  "]=null!==(r=i.printerProfile)&&void 0!==r?r:"CIE RGB"),o.Inte=im.encode(i.renderingIntent),i.printerManagesColors||(o.MpBl=!!i.blackPointCompensation),o.printSixteenBit=!!i.printSixteenBit,o.printerName=i.printerName||"",i.proofSetup&&"profile"in i.proofSetup?o.printProofSetup={profile:i.proofSetup.profile||"",Inte:im.encode(i.proofSetup.renderingIntent),MpBl:!!i.proofSetup.blackPointCompensation,paperWhite:!!i.proofSetup.paperWhite}:o.printProofSetup={Bltn:(null===(n=i.proofSetup)||void 0===n?void 0:n.builtin)?"builtinProof.".concat(i.proofSetup.builtin):"builtinProof.proofCMYK"},gv(e,"","printOutput",o)})),Zg(1005,(function(e){return void 0!==e.resolutionInfo}),(function(e,t){var r=Mm(e),n=_m(e),i=_m(e),o=Mm(e),a=_m(e),s=_m(e);t.resolutionInfo={horizontalResolution:r,horizontalResolutionUnit:Jg[n]||"PPI",widthUnit:Qg[i]||"Inches",verticalResolution:o,verticalResolutionUnit:Jg[a]||"PPI",heightUnit:Qg[s]||"Inches"}}),(function(e,t){var r=t.resolutionInfo;Nb(e,r.horizontalResolution||0),Ob(e,Math.max(1,Jg.indexOf(r.horizontalResolutionUnit))),Ob(e,Math.max(1,Qg.indexOf(r.widthUnit))),Nb(e,r.verticalResolution||0),Ob(e,Math.max(1,Jg.indexOf(r.verticalResolutionUnit))),Ob(e,Math.max(1,Qg.indexOf(r.heightUnit)))}));var om=["centered","size to fit","user defined"];Zg(1062,(function(e){return void 0!==e.printScale}),(function(e,t){t.printScale={style:om[wm(e)],x:Tm(e),y:Tm(e),scale:Tm(e)}}),(function(e,t){var r=t.printScale,n=r.style,i=r.x,o=r.y,a=r.scale;Mb(e,Math.max(0,om.indexOf(n))),Pb(e,i||0),Pb(e,o||0),Pb(e,a||0)})),Zg(1006,(function(e){return void 0!==e.alphaChannelNames}),(function(e,t,r){for(t.alphaChannelNames=[];r()>0;){var n=Fm(e,1);t.alphaChannelNames.push(n)}}),(function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){Hb(e,n[r],1)}})),Zg(1045,(function(e){return void 0!==e.alphaChannelNames}),(function(e,t,r){for(t.alphaChannelNames=[];r()>0;)t.alphaChannelNames.push(Pm(e))}),(function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){jb(e,n[r])}})),Zg(1053,(function(e){return void 0!==e.alphaIdentifiers}),(function(e,t,r){for(t.alphaIdentifiers=[];r()>=4;)t.alphaIdentifiers.push(km(e))}),(function(e,t){for(var r=0,n=t.alphaIdentifiers;r<n.length;r++){Fb(e,n[r])}})),Zg(1010,(function(e){return void 0!==e.backgroundColor}),(function(e,t){return t.backgroundColor=ny(e)}),(function(e,t){return qb(e,t.backgroundColor)})),Zg(1037,(function(e){return void 0!==e.globalAngle}),(function(e,t){return t.globalAngle=Sm(e)}),(function(e,t){return Rb(e,t.globalAngle)})),Zg(1049,(function(e){return void 0!==e.globalAltitude}),(function(e,t){return t.globalAltitude=km(e)}),(function(e,t){return Fb(e,t.globalAltitude)})),Zg(1011,(function(e){return void 0!==e.printFlags}),(function(e,t){t.printFlags={labels:!!bm(e),cropMarks:!!bm(e),colorBars:!!bm(e),registrationMarks:!!bm(e),negative:!!bm(e),flip:!!bm(e),interpolate:!!bm(e),caption:!!bm(e),printFlags:!!bm(e)}}),(function(e,t){var r=t.printFlags;Ab(e,r.labels?1:0),Ab(e,r.cropMarks?1:0),Ab(e,r.colorBars?1:0),Ab(e,r.registrationMarks?1:0),Ab(e,r.negative?1:0),Ab(e,r.flip?1:0),Ab(e,r.interpolate?1:0),Ab(e,r.caption?1:0),Ab(e,r.printFlags?1:0)})),Zg(1080,(function(e){return void 0!==e.countInformation}),(function(e,t){var r=vv(e);t.countInformation=r.countGroupList.map((function(e){return{color:{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]},name:e["Nm  "],size:e["Rds "],fontSize:e.fontSize,visible:e.Vsbl,points:e.countObjectList.map((function(e){return{x:e["X   "],y:e["Y   "]}}))}}))}),(function(e,t){gv(e,"","Cnt ",{Vrsn:1,countGroupList:t.countInformation.map((function(e){return{"Rd  ":e.color.r,"Grn ":e.color.g,"Bl  ":e.color.b,"Nm  ":e.name,"Rds ":e.size,fontSize:e.fontSize,Vsbl:e.visible,countObjectList:e.points.map((function(e){return{"X   ":e.x,"Y   ":e.y}}))}}))})})),Zg(1024,(function(e){return void 0!==e.layerState}),(function(e,t){return t.layerState=_m(e)}),(function(e,t){return Ob(e,t.layerState)})),Zg(1026,(function(e){return void 0!==e.layersGroup}),(function(e,t,r){for(t.layersGroup=[];r()>0;)t.layersGroup.push(_m(e))}),(function(e,t){for(var r=0,n=t.layersGroup;r<n.length;r++){Ob(e,n[r])}})),Zg(1072,(function(e){return void 0!==e.layerGroupsEnabledId}),(function(e,t,r){for(t.layerGroupsEnabledId=[];r()>0;)t.layerGroupsEnabledId.push(bm(e))}),(function(e,t){for(var r=0,n=t.layerGroupsEnabledId;r<n.length;r++){Ab(e,n[r])}})),Zg(1069,(function(e){return void 0!==e.layerSelectionIds}),(function(e,t){var r=_m(e);for(t.layerSelectionIds=[];r--;)t.layerSelectionIds.push(km(e))}),(function(e,t){Ob(e,t.layerSelectionIds.length);for(var r=0,n=t.layerSelectionIds;r<n.length;r++){Fb(e,n[r])}})),Zg(1032,(function(e){return void 0!==e.gridAndGuidesInformation}),(function(e,t){var r=km(e),n=km(e),i=km(e),o=km(e);if(1!==r)throw new Error("Invalid 1032 resource version: ".concat(r));t.gridAndGuidesInformation={grid:{horizontal:n,vertical:i},guides:[]};for(var a=0;a<o;a++)t.gridAndGuidesInformation.guides.push({location:km(e)/32,direction:bm(e)?"horizontal":"vertical"})}),(function(e,t){var r=t.gridAndGuidesInformation,n=r.grid||{horizontal:576,vertical:576},i=r.guides||[];Fb(e,1),Fb(e,n.horizontal),Fb(e,n.vertical),Fb(e,i.length);for(var o=0,a=i;o<a.length;o++){var s=a[o];Fb(e,32*s.location),Ab(e,"horizontal"===s.direction?1:0)}})),Zg(1065,(function(e){return void 0!==e.layerComps}),(function(e,t){var r=vv(e,!0);t.layerComps={list:[]};for(var n=0,i=r.list;n<i.length;n++){var o=i[n];t.layerComps.list.push({id:o.compID,name:o["Nm  "],capturedInfo:o.capturedInfo}),"comment"in o&&(t.layerComps.list[t.layerComps.list.length-1].comment=o.comment)}"lastAppliedComp"in r&&(t.layerComps.lastApplied=r.lastAppliedComp)}),(function(e,t){for(var r=t.layerComps,n={list:[]},i=0,o=r.list;i<o.length;i++){var a=o[i],s={_classID:"Comp"};s["Nm  "]=a.name,"comment"in a&&(s.comment=a.comment),s.compID=a.id,s.capturedInfo=a.capturedInfo,n.list.push(s)}"lastApplied"in r&&(n.lastAppliedComp=r.lastApplied),gv(e,"","CompList",n)}));var am=["normal",void 0,void 0,void 0,void 0,void 0,void 0,"multiply","screen",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"difference"];function sm(e){return{"Top ":e.top,Left:e.left,Btom:e.bottom,Rght:e.right}}function lm(e){return{top:e["Top "],left:e.Left,bottom:e.Btom,right:e.Rght}}function um(e,t){return e[Math.max(0,Math.min(e.length-1,t))]}Zg(1078,(function(e){return void 0!==e.onionSkins}),(function(e,t){var r=vv(e);t.onionSkins={enabled:r.enab,framesBefore:r.numBefore,framesAfter:r.numAfter,frameSpacing:r.Spcn,minOpacity:r.minOpacity/100,maxOpacity:r.maxOpacity/100,blendMode:am[r.BlnM]||"normal"}}),(function(e,t){var r=t.onionSkins;gv(e,"","null",{Vrsn:1,enab:r.enabled,numBefore:r.framesBefore,numAfter:r.framesAfter,Spcn:r.frameSpacing,minOpacity:100*r.minOpacity|0,maxOpacity:100*r.maxOpacity|0,BlnM:Math.max(0,am.indexOf(r.blendMode))})})),Zg(1075,(function(e){return void 0!==e.timelineInformation}),(function(e,t){var r,n,i=vv(e);t.timelineInformation={enabled:i.enab,frameStep:Zv(i.frameStep),frameRate:i.frameRate,time:Zv(i.time),duration:Zv(i.duration),workInTime:Zv(i.workInTime),workOutTime:Zv(i.workOutTime),repeats:i.LCnt,hasMotion:i.hasMotion,globalTracks:Tv(i.globalTrackList,!!e.logMissingFeatures)},(null===(n=null===(r=i.audioClipGroupList)||void 0===r?void 0:r.audioClipGroupList)||void 0===n?void 0:n.length)&&(t.timelineInformation.audioClipGroups=i.audioClipGroupList.audioClipGroupList.map((function(e){return{id:e.groupID,muted:e.muted,audioClips:e.audioClipList.map((function(e){var t=e.clipID,r=e.timeScope,n=e.muted,i=e.audioLevel,o=e.frameReader;return{id:t,start:Zv(r.Strt),duration:Zv(r.duration),inTime:Zv(r.inTime),outTime:Zv(r.outTime),muted:n,audioLevel:i,frameReader:{type:o.frameReaderType,mediaDescriptor:o.mediaDescriptor,link:{name:o["Lnk "]["Nm  "],fullPath:o["Lnk "].fullPath,relativePath:o["Lnk "].relPath}}}}))}})))}),(function(e,t){var r,n=t.timelineInformation,i={Vrsn:1,enab:n.enabled,frameStep:n.frameStep,frameRate:n.frameRate,time:n.time,duration:n.duration,workInTime:n.workInTime,workOutTime:n.workOutTime,LCnt:n.repeats,globalTrackList:Av(n.globalTracks),audioClipGroupList:{audioClipGroupList:null===(r=n.audioClipGroups)||void 0===r?void 0:r.map((function(e){return{groupID:e.id,muted:e.muted,audioClipList:e.audioClips.map((function(e){return{clipID:e.id,timeScope:{Vrsn:1,Strt:e.start,duration:e.duration,inTime:e.inTime,outTime:e.outTime},frameReader:{frameReaderType:e.frameReader.type,descVersion:1,"Lnk ":{descVersion:1,"Nm  ":e.frameReader.link.name,fullPath:e.frameReader.link.fullPath,relPath:e.frameReader.link.relativePath},mediaDescriptor:e.frameReader.mediaDescriptor},muted:e.muted,audioLevel:e.audioLevel}}))}}))},hasMotion:n.hasMotion};gv(e,"","null",i,"anim")})),Zg(1076,(function(e){return void 0!==e.sheetDisclosure}),(function(e,t){var r=vv(e);t.sheetDisclosure={},r.sheetTimelineOptions&&(t.sheetDisclosure.sheetTimelineOptions=r.sheetTimelineOptions.map((function(e){return{sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}})))}),(function(e,t){var r=t.sheetDisclosure,n={Vrsn:1};r.sheetTimelineOptions&&(n.sheetTimelineOptions=r.sheetTimelineOptions.map((function(e){return{Vrsn:2,sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}}))),gv(e,"","null",n)})),Zg(1054,(function(e){return void 0!==e.urlsList}),(function(e,t){var r=km(e);t.urlsList=[];for(var n=0;n<r;n++){if("slic"!==Rm(e)&&e.throwForMissingFeatures)throw new Error("Unknown long");var i=km(e),o=Pm(e);t.urlsList.push({id:i,url:o,ref:"slice"})}}),(function(e,t){var r=t.urlsList;Fb(e,r.length);for(var n=0;n<r.length;n++)Xb(e,"slic"),Fb(e,r[n].id),Gb(e,r[n].url)}));var cm=["autoGenerated","layer","userGenerated"],hm=["noImage","image"],dm=["default"];Zg(1050,(function(e){return e.slices?e.slices.length:0}),(function(e,t){var r=km(e);if(6===r){t.slices||(t.slices=[]);var n=Sm(e),i=Sm(e),o=Sm(e),a=Sm(e),s=Pm(e),l=km(e);t.slices.push({bounds:{top:n,left:i,bottom:o,right:a},groupName:s,slices:[]});for(var u=t.slices[t.slices.length-1].slices,c=0;c<l;c++){var h=km(e),d=km(e),f=um(cm,km(e)),p="layer"==f?km(e):0,v=Pm(e),g=um(hm,km(e)),m=Sm(e),y=Sm(e),b=Sm(e),x=Sm(e),w=Pm(e),_=Pm(e),E=Pm(e),S=Pm(e),C=!!bm(e),k=Pm(e),T=um(dm,km(e)),A=um(dm,km(e)),M=bm(e),O=bm(e),L=bm(e),R=bm(e),I=M+O+L+R===0?"none":0===M?"matte":"color";u.push({id:h,groupId:d,origin:f,associatedLayerId:p,name:v,target:_,message:E,altTag:S,cellTextIsHTML:C,cellText:k,horizontalAlignment:T,verticalAlignment:A,type:g,url:w,bounds:{top:y,left:m,bottom:x,right:b},backgroundColorType:I,backgroundColor:{r:O,g:L,b:R,a:M}})}(F=vv(e)).slices.forEach((function(e){var t=u.find((function(t){return e.sliceID==t.id}));t&&(t.topOutset=e.topOutset,t.leftOutset=e.leftOutset,t.bottomOutset=e.bottomOutset,t.rightOutset=e.rightOutset)}))}else{if(7!==r&&8!==r)throw new Error("Invalid slices version (".concat(r,")"));var F=vv(e);t.slices||(t.slices=[]),t.slices.push({groupName:F.baseName,bounds:lm(F.bounds),slices:F.slices.map((function(e){return qg(qg({},e["Nm  "]?{name:e["Nm  "]}:{}),{id:e.sliceID,groupId:e.groupID,associatedLayerId:0,origin:mg.decode(e.origin),type:pg.decode(e.Type),bounds:lm(e.bounds),url:e.url,target:e.null,message:e.Msge,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horizontalAlignment:vg.decode(e.horzAlign),verticalAlignment:gg.decode(e.vertAlign),backgroundColorType:yg.decode(e.bgColorType),backgroundColor:e.bgColor?{r:e.bgColor["Rd  "],g:e.bgColor["Grn "],b:e.bgColor["Bl  "],a:e.bgColor.alpha}:{r:0,g:0,b:0,a:0},topOutset:e.topOutset||0,leftOutset:e.leftOutset||0,bottomOutset:e.bottomOutset||0,rightOutset:e.rightOutset||0})}))})}}),(function(e,t,r){var n=t.slices[r],i=n.bounds,o=n.groupName,a=n.slices;Fb(e,6),Rb(e,i.top),Rb(e,i.left),Rb(e,i.bottom),Rb(e,i.right),Gb(e,o),Fb(e,a.length);for(var s=0;s<a.length;s++){var l=a[s],u=l.backgroundColor,c=u.a,h=u.r,d=u.g,f=u.b;"none"===l.backgroundColorType?c=h=d=f=0:"matte"===l.backgroundColorType&&(c=0,h=d=f=255),Fb(e,l.id),Fb(e,l.groupId),Fb(e,cm.indexOf(l.origin)),"layer"===l.origin&&Fb(e,l.associatedLayerId),Gb(e,l.name||""),Fb(e,hm.indexOf(l.type)),Rb(e,l.bounds.left),Rb(e,l.bounds.top),Rb(e,l.bounds.right),Rb(e,l.bounds.bottom),Gb(e,l.url),Gb(e,l.target),Gb(e,l.message),Gb(e,l.altTag),Ab(e,l.cellTextIsHTML?1:0),Gb(e,l.cellText),Fb(e,dm.indexOf(l.horizontalAlignment)),Fb(e,dm.indexOf(l.verticalAlignment)),Ab(e,c),Ab(e,h),Ab(e,d),Ab(e,f)}var p={bounds:sm(i),slices:[]};a.forEach((function(e){var t=qg(qg({sliceID:e.id,groupID:e.groupId,origin:mg.encode(e.origin),Type:pg.encode(e.type),bounds:sm(e.bounds)},e.name?{"Nm  ":e.name}:{}),{url:e.url,null:e.target,Msge:e.message,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horzAlign:vg.encode(e.horizontalAlignment),vertAlign:gg.encode(e.verticalAlignment),bgColorType:yg.encode(e.backgroundColorType)});if("color"===e.backgroundColorType){var r=e.backgroundColor,n=r.r,i=r.g,o=r.b,a=r.a;t.bgColor={"Rd  ":n,"Grn ":i,"Bl  ":o,alpha:a}}t.topOutset=e.topOutset||0,t.leftOutset=e.leftOutset||0,t.bottomOutset=e.bottomOutset||0,t.rightOutset=e.rightOutset||0,p.slices.push(t)})),gv(e,"","null",p,"slices")})),Zg(1064,(function(e){return void 0!==e.pixelAspectRatio}),(function(e,t){if(km(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:Am(e)}}),(function(e,t){Fb(e,2),Db(e,t.pixelAspectRatio.aspect)})),Zg(1041,(function(e){return void 0!==e.iccUntaggedProfile}),(function(e,t){t.iccUntaggedProfile=!!bm(e)}),(function(e,t){Ab(e,t.iccUntaggedProfile?1:0)})),Zg(1044,(function(e){return void 0!==e.idsSeedNumber}),(function(e,t){return t.idsSeedNumber=km(e)}),(function(e,t){return Fb(e,t.idsSeedNumber)})),Zg(1036,(function(e){return void 0!==e.thumbnail||void 0!==e.thumbnailRaw}),(function(e,t,r){var n=km(e),i=km(e),o=km(e);km(e),km(e),km(e);var a=_m(e),s=_m(e);if(1!==n||24!==a||1!==s)return e.logMissingFeatures&&e.log("Invalid thumbnail data (format: ".concat(n,", bitsPerPixel: ").concat(a,", planes: ").concat(s,")")),void Bm(e,r());var l=Lm(e,r());e.useRawThumbnail?t.thumbnailRaw={width:i,height:o,data:l}:l.byteLength&&(t.thumbnail=Mp(l))}),(function(e,t){var r,n,i=0,o=0;if(t.thumbnailRaw)i=t.thumbnailRaw.width,o=t.thumbnailRaw.height,n=t.thumbnailRaw.data;else{var a=null===(r=t.thumbnail.toDataURL("image/jpeg",1))||void 0===r?void 0:r.substring(23);a?(i=t.thumbnail.width,o=t.thumbnail.height,n=xe(a)):n=new Uint8Array(0)}var s=4*Math.floor((24*i+31)/32),l=s*o*1,u=n.length;Fb(e,1),Fb(e,i),Fb(e,o),Fb(e,s),Fb(e,l),Fb(e,u),Ob(e,24),Ob(e,1),Ub(e,n)})),Zg(1057,(function(e){return void 0!==e.versionInfo}),(function(e,t,r){if(1!==km(e))throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!bm(e),writerName:Pm(e),readerName:Pm(e),fileVersion:km(e)},Bm(e,r())}),(function(e,t){var r=t.versionInfo;Fb(e,1),Ab(e,r.hasRealMergedData?1:0),Gb(e,r.writerName),Gb(e,r.readerName),Fb(e,r.fileVersion)})),Zg(7e3,(function(e){return void 0!==e.imageReadyVariables}),(function(e,t,r){t.imageReadyVariables=rm(e,r())}),(function(e,t){nm(e,t.imageReadyVariables)})),Zg(7001,(function(e){return void 0!==e.imageReadyDataSets}),(function(e,t,r){t.imageReadyDataSets=rm(e,r())}),(function(e,t){nm(e,t.imageReadyDataSets)})),Zg(1088,(function(e){return void 0!==e.pathSelectionState}),(function(e,t,r){var n=vv(e);t.pathSelectionState=n.null}),(function(e,t){gv(e,"","null",{null:t.pathSelectionState})}));var fm=Ep("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"});Zg(4e3,(function(e){return void 0!==e.animations}),(function(e,t,r){var n=Rm(e);if("mani"===n)Um(e,"IRFR"),ry(e,1,(function(r){for(var n=function(){Um(e,"8BIM");var r=Rm(e);ry(e,1,(function(n){if("AnDs"===r){var i=vv(e);t.animations={frames:i.FrIn.map((function(e){return{id:e.FrID,delay:(e.FrDl||0)/100,dispose:e.FrDs?fm.decode(e.FrDs):"auto"}})),animations:i.FSts.map((function(e){return{id:e.FsID,frames:e.FsFr,repeats:e.LCnt,activeFrame:e.AFrm||0}}))}}else if("Roll"===r){var o=Lm(e,n());e.logDevFeatures&&e.log("#4000 Roll",o)}else e.logMissingFeatures&&e.log("Unhandled subsection in #4000",r)}))};r()>0;)n()}));else if("mopt"===n){var i=Lm(e,r());e.logDevFeatures&&e.log("#4000 mopt",i)}else e.logMissingFeatures&&e.log("Unhandled key in #4000:",n)}),(function(e,t){t.animations&&(Xb(e,"mani"),Xb(e,"IRFR"),Yb(e,1,(function(){Xb(e,"8BIM"),Xb(e,"AnDs"),Yb(e,1,(function(){for(var r={FrIn:[],FSts:[]},n=0;n<t.animations.frames.length;n++){var i=t.animations.frames[n],o={FrID:i.id};i.delay&&(o.FrDl=100*i.delay|0),o.FrDs=fm.encode(i.dispose),r.FrIn.push(o)}for(n=0;n<t.animations.animations.length;n++){var a=t.animations.animations[n],s={FsID:a.id,AFrm:0|a.activeFrame,FsFr:a.frames,LCnt:0|a.repeats};r.FSts.push(s)}gv(e,"","null",r)}))})))}));var pm=[0,1,3],vm=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"];function gm(e){for(var t=e.width*e.height*4,r=0;r<t;r+=4)e.data[r+1]=e.data[r],e.data[r+2]=e.data[r]}function mm(e,t,r){return{view:new DataView(e,t,r),offset:0,strict:!1,debug:!1,large:!1,globalAlpha:!1,log:console.log}}function ym(e,t){if(e.strict)throw new Error(t);e.debug&&e.log(t)}function bm(e){return e.offset+=1,e.view.getUint8(e.offset-1)}function xm(e){return e.view.getUint8(e.offset)}function wm(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}function _m(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}function Em(e){return e.offset+=2,e.view.getUint16(e.offset-2,!0)}function Sm(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}function Cm(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)}function km(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}function Tm(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)}function Am(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}function Mm(e){return Sm(e)/65536}function Om(e){return Sm(e)/(1<<24)}function Lm(e,t){var r=e.view.byteOffset+e.offset;if(e.offset+=t,r+t>e.view.buffer.byteLength){if(ym(e,"Reading bytes exceeding buffer length"),t>104857600)throw new Error("Reading past end of file");var n=new Uint8Array(t),i=Math.min(t,e.view.byteLength-r);return i>0&&n.set(new Uint8Array(e.view.buffer,r,i)),n}return new Uint8Array(e.view.buffer,r,t)}function Rm(e){return zm(e,4)}function Im(e,t){var r=String.fromCharCode(e.view.getUint8(t))+String.fromCharCode(e.view.getUint8(t+1))+String.fromCharCode(e.view.getUint8(t+2))+String.fromCharCode(e.view.getUint8(t+3));return"8BIM"==r||"8B64"==r}function Fm(e,t){for(var r=bm(e),n=r?zm(e,r):"";++r%t;)e.offset++;return n}function Pm(e){return Dm(e,km(e))}function Dm(e,t){for(var r="";t--;){var n=_m(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}function Nm(e,t){for(var r="";t--;)r+=String.fromCharCode(bm(e));return r}function Bm(e,t){e.offset+=t}function Um(e,t,r){var n=e.offset,i=Rm(e);if(i!==t&&i!==r)throw new Error("Invalid signature: '".concat(i,"' at 0x").concat(n.toString(16)))}function zm(e,t){for(var r=Lm(e,t),n="",i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return n}function Xm(e){return"8BIM"===e||"MeSa"===e||"AgHg"===e||"PHUT"===e||"DCSR"===e}function Hm(e,t){var r;void 0===t&&(t={}),Um(e,"8BPS");var n=_m(e);if(1!==n&&2!==n)throw new Error("Invalid PSD file version: ".concat(n));Bm(e,6);var i=_m(e),o=km(e),a=km(e),s=_m(e),l=_m(e),u=1===n?3e4:3e5;if(a>u||o>u)throw new Error("Invalid size: ".concat(a,"x").concat(o));if(i>16)throw new Error("Invalid channel count: ".concat(i));if(![1,8,16,32].includes(s))throw new Error("Invalid bitsPerChannel: ".concat(s));if(-1===pm.indexOf(l))throw new Error("Color mode not supported: ".concat(null!==(r=vm[l])&&void 0!==r?r:l));var c={width:a,height:o,channels:i,bitsPerChannel:s,colorMode:l};Object.assign(e,t),e.large=2===n,e.globalAlpha=!1;var h=[0,1,-1,2,-2,3,-3,4,-4];ry(e,1,(function(t){t()&&Bm(e,t())})),ry(e,1,(function(t){for(var r=function(){for(var t=e.offset,r="",n=0,i=h;n<i.length;n++){var o=i[n];try{e.offset=t+o,r=Rm(e)}catch(e){}if(Xm(r))break}if(!Xm(r))throw new Error("Invalid signature: '".concat(r,"' at 0x").concat(t.toString(16)));var a=_m(e);Fm(e,2),ry(e,2,(function(t){var r=Kg[a],n=1036===a&&!!e.skipThumbnail;if(c.imageResources||(c.imageResources={}),r&&!n)try{r.read(e,c.imageResources,t)}catch(r){if(e.throwForMissingFeatures)throw r;Bm(e,t())}else Bm(e,t())}))};t()>0;)r()})),ry(e,1,(function(t){if(ry(e,2,(function(t){Gm(e,c),Bm(e,t())}),void 0,e.large),t()>0){var r=function(e){return ry(e,1,(function(t){if(t()){var r=_m(e),n=_m(e),i=_m(e),o=_m(e),a=_m(e),s=_m(e)/255,l=bm(e);return Bm(e,t()),{overlayColorSpace:r,colorSpace1:n,colorSpace2:i,colorSpace3:o,colorSpace4:a,opacity:s,kind:l}}}))}(e);r&&(c.globalLayerMaskInfo=r)}else Bm(e,t());for(;t()>0;){for(;t()&&0===xm(e);)Bm(e,1);t()>=12?Vm(e,c,c):Bm(e,t())}}),void 0,e.large);var d=c.children&&c.children.length;return e.skipCompositeImageData&&(e.skipLayerImageData||d)||function(e,t){var r,n,i=_m(e),o=null!==(r=t.bitsPerChannel)&&void 0!==r?r:8;if(-1===pm.indexOf(t.colorMode))throw new Error("Color mode not supported: ".concat(t.colorMode));if(0!==i&&1!==i)throw new Error("Compression type not supported: ".concat(i));var a=qm(t.width,t.height,o);switch(kp(a),t.colorMode){case 0:if(1!==o)throw new Error("Invalid bitsPerChannel for bitmap color mode");var s=void 0;if(0===i)s=Lm(e,Math.ceil(t.width/8)*t.height);else{if(1!==i)throw new Error("Bitmap compression not supported: ".concat(i));ty(e,{data:s=new Uint8Array(t.width*t.height),width:t.width,height:t.height},t.width,t.height,8,1,[0],e.large)}!function(e,t,r,n){if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("Invalid bit depth");for(var i=0,o=0,a=0;i<n;i++)for(var s=0;s<r;)for(var l=e[a++],u=0;u<8&&s<r;u++,s++,o+=4){var c=128&l?0:255;l<<=1,t[o+0]=c,t[o+1]=c,t[o+2]=c,t[o+3]=255}}(s,a.data,t.width,t.height);break;case 3:case 1:var l=1===t.colorMode?[0]:[0,1,2];if(t.channels&&t.channels>3)for(var u=3;u<t.channels;u++)l.push(u);else e.globalAlpha&&l.push(3);if(0===i)for(u=0;u<l.length;u++)Qm(e,a,t.width,t.height,o,4,l[u]);else 1===i&&(e.offset,ty(e,a,t.width,t.height,o,4,l,e.large));1===t.colorMode&&gm(a);break;case 4:if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");if(4!==t.channels)throw new Error("Invalid channel count");l=[0,1,2,3];if(e.globalAlpha&&l.push(4),0===i)throw new Error("Not implemented");if(1===i){var c={width:a.width,height:a.height,data:new Uint8Array(a.width*a.height*5)};e.offset,ty(e,c,t.width,t.height,null!==(n=t.bitsPerChannel)&&void 0!==n?n:8,5,l,e.large),Km(c,a,!0)}break;default:throw new Error("Color mode not supported: ".concat(t.colorMode))}if(e.globalAlpha){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");var h=a.data,d=a.width*a.height*4;for(u=0;u<d;u+=4){var f=h[u+3];if(0!=f&&255!=f){var p=1/(f/255),v=255*(1-p);h[u+0]=h[u+0]*p+v,h[u+1]=h[u+1]*p+v,h[u+2]=h[u+2]*p+v}}}e.useImageData?t.imageData=a:t.canvas=Tp(a)}(e,c),c}function Gm(e,t){var r=wm(e);r<0&&(e.globalAlpha=!0,r=-r);for(var n=[],i=[],o=0;o<r;o++){var a=jm(e,t),s=a.layer,l=a.channels;n.push(s),i.push(l)}if(!e.skipLayerImageData)for(o=0;o<r;o++)Ym(e,t,n[o],i[o]);t.children||(t.children=[]);var u=[t];for(o=n.length-1;o>=0;o--){var c=n[o],h=c.sectionDivider?c.sectionDivider.type:0;1===h||2===h?(c.opened=1===h,c.children=[],u[u.length-1].children.unshift(c),u.push(c)):3===h?u.pop():u[u.length-1].children.unshift(c)}}function jm(e,t){var r={};r.top=Sm(e),r.left=Sm(e),r.bottom=Sm(e),r.right=Sm(e);for(var n=_m(e),i=[],o=0;o<n;o++){var a=wm(e),s=km(e);if(e.large){if(0!==s)throw new Error("Sizes larger than 4GB are not supported");s=km(e)}i.push({id:a,length:s})}Um(e,"8BIM");var l=Rm(e);if(!vp[l])throw new Error("Invalid blend mode: '".concat(l,"'"));r.blendMode=vp[l],r.opacity=bm(e)/255,r.clipping=1===bm(e);var u=bm(e);return r.transparencyProtected=!!(1&u),r.hidden=!!(2&u),32&u&&(r.effectsOpen=!0),Bm(e,1),ry(e,1,(function(n){var i=function(e){return ry(e,1,(function(t){if(t()){var r={};r.top=Sm(e),r.left=Sm(e),r.bottom=Sm(e),r.right=Sm(e),r.defaultColor=bm(e);var n=bm(e);if(r.positionRelativeToLayer=!!(1&n),r.disabled=!!(2&n),r.fromVectorData=!!(8&n),16&n){var i=bm(e);1&i&&(r.userMaskDensity=bm(e)/255),2&i&&(r.userMaskFeather=Am(e)),4&i&&(r.vectorMaskDensity=bm(e)/255),8&i&&(r.vectorMaskFeather=Am(e))}return t()>2&&e.logMissingFeatures&&e.log("Unhandled extra real user mask params"),Bm(e,t()),r}}))}(e);for(i&&(r.mask=i),function(e){ry(e,1,(function(t){for(var r=km(e),n=km(e),i=[];t()>0;){var o=km(e),a=km(e);i.push({sourceRange:o,destRange:a})}return{compositeGrayBlendSource:r,compositeGraphBlendDestinationRange:n,ranges:i}}))}(e),r.name=Fm(e,1);n()>4&&!Im(e,e.offset);)e.offset++;for(;n()>4;)Vm(e,r,t)})),{layer:r,channels:i}}function Ym(e,t,r,n){var i,o,a,s,l,u=(r.right||0)-(r.left||0),c=(r.bottom||0)-(r.top||0),h=4===t.colorMode;if(u&&c)if(h){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");l={width:u,height:c,data:new Uint8ClampedArray(u*c*5)};for(var d=4;d<l.data.byteLength;d+=5)l.data[d]=255}else kp(l=qm(u,c,null!==(i=t.bitsPerChannel)&&void 0!==i?i:8));for(var f=0,p=n;f<p.length;f++){var v=p[f];if(0!==v.length){if(v.length<2)throw new Error("Invalid channel length");var g=e.offset,m=_m(e);if(m>3&&(e.offset-=1,m=_m(e)),m>3&&(e.offset-=3,m=_m(e)),m>3)throw new Error("Invalid compression: ".concat(m));if(-2===v.id){var y=r.mask;if(!y)throw new Error("Missing layer mask data");var b=(y.right||0)-(y.left||0),x=(y.bottom||0)-(y.top||0);if(b&&x){var w=qm(b,x,null!==(o=t.bitsPerChannel)&&void 0!==o?o:8);kp(w),e.offset,Wm(e,v.length,w,m,b,x,null!==(a=t.bitsPerChannel)&&void 0!==a?a:8,0,e.large,4),gm(w),e.useImageData?y.imageData=w:y.canvas=Tp(w)}}else if(-3===v.id)e.logMissingFeatures&&e.log("RealUserMask not supported"),e.offset=g+v.length;else{var _=Sp(v.id,h),E=l;if(_<0&&(E=void 0,e.throwForMissingFeatures))throw new Error("Channel not supported: ".concat(v.id));Wm(e,v.length,E,m,u,c,null!==(s=t.bitsPerChannel)&&void 0!==s?s:8,_,e.large,h?5:4),e.offset=g+v.length,E&&1===t.colorMode&&gm(E)}}}if(l){if(h){var S=l;Km(S,l=Lp(S.width,S.height),!1)}e.useImageData?r.imageData=l:r.canvas=Tp(l)}}function Wm(e,t,r,n,i,o,a,s,l,u){if(0===n)Qm(e,r,i,o,a,u,s);else if(1===n)ty(e,r,i,o,a,u,[s],l);else if(2===n)ey(e,t,r,i,o,a,u,s,!1);else{if(3!==n)throw new Error("Invalid Compression type: ".concat(n));ey(e,t,r,i,o,a,u,s,!0)}}function Vm(e,t,r){var n=Rm(e);if("8BIM"!==n&&"8B64"!==n)throw new Error("Invalid signature: '".concat(n,"' at 0x").concat((e.offset-4).toString(16)));var i=Rm(e),o="8B64"===n||e.large&&-1!==_p.indexOf(i);ry(e,2,(function(n){var o=zy[i];if(o)try{o.read(e,t,n,r)}catch(t){if(e.throwForMissingFeatures)throw t}else e.logMissingFeatures&&e.log("Unhandled additional info: ".concat(i)),Bm(e,n());n()&&(e.logMissingFeatures&&e.log("Unread ".concat(n()," bytes left for additional info: ").concat(i)),Bm(e,n()))}),!1,o)}function qm(e,t,r){if(1===r||8===r)return Lp(e,t);if(16===r)return{width:e,height:t,data:new Uint16Array(e*t*4)};if(32===r)return{width:e,height:t,data:new Float32Array(e*t*4)};throw new Error("Invalid bitDepth (".concat(r,")"))}function Km(e,t,r){for(var n=t.width*t.height*4,i=e.data,o=t.data,a=0,s=0;s<n;a+=5,s+=4){var l=i[a],u=i[a+1],c=i[a+2],h=i[a+3];o[s]=(l*h|0)/255|0,o[s+1]=(u*h|0)/255|0,o[s+2]=(c*h|0)/255|0,o[s+3]=r?255-i[a+4]:i[a+4]}}function Zm(e,t){if(8===t)return e;if(16===t){if(e.byteOffset%2){var r=new Uint16Array(e.byteLength/2);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(e),r}return new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2)}if(32===t){if(e.byteOffset%4){r=new Float32Array(e.byteLength/4);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(e),r}return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}throw new Error("Invalid bitDepth (".concat(t,")"))}function Jm(e,t,r,n){!function(e,t){if(e.byteLength/e.length!=t.byteLength/t.length)throw new Error("Invalid array types")}(e.data,t);for(var i=e.width*e.height,o=e.data,a=0,s=0|r;a<i;a++,s=s+n|0)o[s]=t[a]}function Qm(e,t,r,n,i,o,a){var s=Lm(e,r*n*Math.floor(i/8));if(32==i)for(var l=0;l<s.byteLength;l+=4){var u=s[l+0],c=s[l+1],h=s[l+2],d=s[l+3];s[l+0]=d,s[l+1]=h,s[l+2]=c,s[l+3]=u}var f=Zm(s,i);t&&a<o&&Jm(t,f,a,o)}function $m(e,t,r,n){for(var i=0;i<r;i++)for(var o=1,a=i*t+1;o<t;o++,a++)e[a]=(e[a-1]+e[a])%n}function ey(e,t,r,n,i,o,a,s,l){var u=Lm(e,t),c=fp(u);if(r&&s<a){var h=Zm(c,o);if(8===o)l&&$m(c,n,i,256),Jm(r,c,s,a);else if(16===o)l&&$m(h,n,i,65536),Jm(r,h,s,a);else{if(32!==o)throw new Error("Invalid bitDepth");l&&$m(c,4*n,i,256);for(var d=s,f=new Uint32Array(r.data.buffer,r.data.byteOffset,r.data.length),p=0;p<i;p++)for(var v=4*n*p,g=0;g<n;g++,v++,d+=a){var m=v+n,y=m+n,b=y+n;f[d]=(c[v]<<24|c[m]<<16|c[y]<<8|c[b])>>>0}}}}function ty(e,t,r,n,i,o,a,s){var l,u=t&&t.data;if(s){l=new Uint32Array(a.length*n);for(var c=0,h=0;c<a.length;c++)for(var d=0;d<n;d++,h++)l[h]=km(e)}else{l=new Uint16Array(a.length*n);for(c=0,h=0;c<a.length;c++)for(d=0;d<n;d++,h++)l[h]=_m(e)}if(1!==i&&8!==i)throw new Error("Invalid bit depth (".concat(i,")"));var f=o-1|0,p=0;for(h=0;p<a.length;p++){var v=0|a[p];if(!u||(p>f||v>f))for(d=0;d<n;d++,h++)Bm(e,l[h]);else{d=0;for(var g=0|v;d<n;d++,h++)for(var m=l[h],y=Lm(e,m),b=0;b<m;b++){var x=y[b];if(x>128){var w=y[++b];x=256-x|0;for(var _=0;_<=x;_=_+1|0)u[g]=w,g=g+o|0}else if(x<128)for(_=0;_<=x;_=_+1|0)u[g]=y[++b],g=g+o|0}}}}function ry(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!1);var o=km(e);if(i){if(0!==o)throw new Error("Sizes larger than 4GB are not supported");o=km(e)}if(!(o<=0&&n)){var a=e.offset+o;if(a>e.view.byteLength)throw new Error("Section exceeds file size");var s=r((function(){return a-e.offset}));for(e.offset!==a&&(e.offset>a?ym(e,"Exceeded section limits"):ym(e,"Unread section data"));a%t;)a++;return e.offset=a,s}}function ny(e){switch(_m(e)){case 0:var t=_m(e)/257,r=_m(e)/257,n=_m(e)/257;return Bm(e,2),{r:t,g:r,b:n};case 1:var i=_m(e)/65535,o=_m(e)/65535;n=_m(e)/65535;return Bm(e,2),{h:i,s:o,b:n};case 2:return{c:_m(e)/257,m:_m(e)/257,y:_m(e)/257,k:c=_m(e)/257};case 7:var a=wm(e)/1e4,s=wm(e),l=wm(e),u=s<0?s/12800:s/12700;n=l<0?l/12800:l/12700;return Bm(e,2),{l:a,a:u,b:n};case 8:var c=255*_m(e)/1e4;return Bm(e,6),{k:c};default:throw new Error("Invalid color space")}}var iy=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function oy(e){return Um(e,"8BIM"),vp[Rm(e)]||"normal"}function ay(e,t){Xb(e,"8BIM"),Xb(e,pp[t]||"norm")}function sy(e){return bm(e)/255}function ly(e,t){Ab(e,0|Math.round(255*t))}function uy(e,t){var r;Fb(e,51),Fb(e,2),Nb(e,t.size&&t.size.value||0),Nb(e,0),Nb(e,t.angle||0),Nb(e,t.distance&&t.distance.value||0),qb(e,t.color),ay(e,t.blendMode),Ab(e,t.enabled?1:0),Ab(e,t.useGlobalLight?1:0),ly(e,null!==(r=t.opacity)&&void 0!==r?r:1),qb(e,t.color)}function cy(e){return 32===e||10===e||13===e||9===e}function hy(e){return e>=48&&e<=57||46===e||45===e}var dy=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth","AutoLeading"],fy=["RunLengthArray"];function py(e,t){void 0===t&&(t=!1);var r=new Uint8Array(1024),n=0,i=0;function o(e){if(n>=r.length){var t=new Uint8Array(2*r.length);t.set(r),r=t}r[n]=e,n++}function a(e){for(var t=0;t<e.length;t++)o(e.charCodeAt(t))}function s(){if(t)a(" ");else for(var e=0;e<i;e++)a("\t")}function l(e,r){s(),a("/".concat(e)),f(r,e,!0),t||a("\n")}function u(e){return e.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function c(e,t){return t&&-1!==dy.indexOf(t)||(0|e)!==e?u(e):function(e){return e.toString()}(e)}function h(e){var t=Object.keys(e);return-1!==t.indexOf("98")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),-1!==t.indexOf("99")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),t}function d(e){40!==e&&41!==e&&92!==e||o(92),o(e)}function f(e,r,n){function p(){n?a(" "):s()}if(void 0===n&&(n=!1),null===e)p(),a(t?"/nil":"null");else if("number"==typeof e)p(),a(c(e,r));else if("boolean"==typeof e)p(),a(e?"true":"false");else if("string"==typeof e)if(p(),"99"!==r&&"98"!==r||"/"!==e.charAt(0)){a("("),o(254),o(255);for(var v=0;v<e.length;v++){var g=e.charCodeAt(v);d(g>>8&255),d(255&g)}a(")")}else a(e);else if(Array.isArray(e))if(p(),e.every((function(e){return"number"==typeof e}))){a("[");for(var m=-1!==fy.indexOf(r),y=0,b=e;y<b.length;y++){var x=b[y];a(" "),a(m?c(x):u(x))}a(" ]")}else{a("["),t||a("\n");for(var w=0,_=e;w<_.length;w++){f(x=_[w],r),t||a("\n")}s(),a("]")}else if("object"==typeof e){n&&!t&&a("\n"),s(),a("<<"),t||a("\n"),i++;for(var E=0,S=h(e);E<S.length;E++){var C=S[E];l(C,e[C])}i--,s(),a(">>")}}if(t){if("object"==typeof e)for(var p=0,v=h(e);p<v.length;p++){var g=v[p];l(g,e[g])}}else a("\n\n"),f(e);return r.slice(0,n)}var vy=function(){return vy=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},vy.apply(this,arguments)},gy={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},my={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},yy={font:gy,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},by={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},xy=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],wy=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],_y=["none","crisp","strong","smooth","sharp"],Ey=["left","right","center","justify-left","justify-right","justify-center","justify-all"];function Sy(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function Cy(e){var t=e.Values;switch(e.Type){case 0:return{k:255*t[1]};case 1:return 1===t[0]?{r:255*t[1],g:255*t[2],b:255*t[3]}:{r:255*t[1],g:255*t[2],b:255*t[3],a:255*t[0]};case 2:return{c:255*t[1],m:255*t[2],y:255*t[3],k:255*t[4]};default:throw new Error("Unknown color type in text layer")}}function ky(e){if(e){if("r"in e)return{Type:1,Values:["a"in e?e.a/255:1,e.r/255,e.g/255,e.b/255]};if("c"in e)return{Type:2,Values:[1,e.c/255,e.m/255,e.y/255,e.k/255]};if("k"in e)return{Type:0,Values:[1,e.k/255]};throw new Error("Invalid color type in text layer")}return{Type:1,Values:[0,0,0,0]}}function Ty(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Ay(e,t){if(!e||!t)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){if(e[a=n[r]]!==t[a])return!1}for(var i=0,o=Object.keys(t);i<o.length;i++){var a;if(e[a=o[i]]!==t[a])return!1}return!0}function My(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t.name)return r;return e.push(t),e.length-1}function Oy(e,t,r){for(var n={},i=0,o=t;i<o.length;i++){var a=o[i],s=Sy(a);void 0!==e[s]&&(n[a]="justification"===a?Ey[e[s]]:"font"===a?r[e[s]]:"fillColor"===a||"strokeColor"===a?Cy(e[s]):e[s])}return n}function Ly(e,t,r){for(var n,i={},o=0,a=t;o<a.length;o++){var s=a[o],l=Sy(s);void 0!==e[s]&&(i[l]="justification"===s?Ey.indexOf(null!==(n=e[s])&&void 0!==n?n:"left"):"font"===s?My(r,e[s]):"fillColor"===s||"strokeColor"===s?ky(e[s]):e[s])}return i}function Ry(e,t){return Oy(e,xy,t)}function Iy(e,t){return Oy(e,wy,t)}function Fy(e,t){return Ly(e,xy,t)}function Py(e,t){return Ly(e,wy,t)}function Dy(e,t,r){if(t.length){for(var n=function(r){var n=t[0].style[r];if(void 0!==n){var i=!1;i=Array.isArray(n)?t.every((function(e){return Ty(e.style[r],n)})):"object"==typeof n?t.every((function(e){return Ay(e.style[r],n)})):t.every((function(e){return e.style[r]===n})),i&&(e[r]=n)}if(void 0!==e[r])for(var o=0,a=t;o<a.length;o++){var s=a[o];(Array.isArray(n)?Ty(s.style[r],n):"object"==typeof n?Ay(s.style[r],n):s.style[r]===n)&&delete s.style[r]}},i=0,o=r;i<o.length;i++){n(o[i])}t.every((function(e){return 0===Object.keys(e.style).length}))&&(t.length=0)}}function Ny(e){var t,r,n,i,o,a,s,l,u,c,h,d,f="".concat((e.text||"").replace(/\r?\n/g,"\r"),"\r"),p=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],v=(null===(t=e.style)||void 0===t?void 0:t.font)||(null===(n=null===(r=e.styleRuns)||void 0===r?void 0:r.find((function(e){return e.style.font})))||void 0===n?void 0:n.style.font)||gy,g=[],m=[],y=e.paragraphStyleRuns;if(y&&y.length){for(var b=f.length,x=0,w=y;x<w.length;x++){var _=w[x];b-=R=Math.min(_.length,b),R&&(1===b&&_===y[y.length-1]&&(R++,b--),m.push(R),g.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:Fy(vy(vy(vy({},my),e.paragraphStyle),_.style),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}b&&(m.push(b),g.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:Fy(vy(vy({},my),e.paragraphStyle),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}else for(var E=0,S=0;E<f.length;E++)13===f.charCodeAt(E)&&(m.push(E-S+1),g.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:Fy(vy(vy({},my),e.paragraphStyle),p)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),S=E+1);for(var C=Py(vy(vy({},yy),{font:v}),p),k=e.styleRuns||[{length:f.length,style:e.style||{}}],T=[],A=[],M=f.length,O=0,L=k;O<L.length;O++){var R,I=L[O];M-=R=Math.min(I.length,M),R&&(1===M&&I===k[k.length-1]&&(R++,M--),A.push(R),T.push({StyleSheet:{StyleSheetData:Py(vy(vy({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),I.style),p)}}))}M&&k.length&&(A.push(M),T.push({StyleSheet:{StyleSheetData:Py(vy({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),p)}}));var F=vy(vy({},by),e.gridInfo),P="vertical"===e.orientation?2:0,D="vertical"===e.orientation?1:0,N="box"===e.shapeType?1:0,B={ShapeType:N};0===N?B.PointBase=e.pointBase||[0,0]:B.BoxBounds=e.boxBounds||[0,0,0,0],B.Base={ShapeType:N,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var U={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"?!)]},.:;",NoEnd:"([{",Keep:"",Hanging:".,"},{Name:"PhotoshopKinsokuSoft",NoStart:"",NoEnd:"",Keep:"",Hanging:".,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:Fy(vy(vy({},my),e.paragraphStyle),p)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:C}],FontSet:p.map((function(e){return{Name:e.name,Script:e.script||0,FontType:e.type||0,Synthetic:e.synthetic||0}})),SuperscriptSize:null!==(i=e.superscriptSize)&&void 0!==i?i:.583,SuperscriptPosition:null!==(o=e.superscriptPosition)&&void 0!==o?o:.333,SubscriptSize:null!==(a=e.subscriptSize)&&void 0!==a?a:.583,SubscriptPosition:null!==(s=e.subscriptPosition)&&void 0!==s?s:.333,SmallCapSize:null!==(l=e.smallCapSize)&&void 0!==l?l:.7};return{EngineDict:{Editor:{Text:f},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:g,RunLengthArray:m,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:T,RunLengthArray:A,IsJoinable:2},GridInfo:{GridIsOn:!!F.isOn,ShowGrid:!!F.show,GridSize:null!==(u=F.size)&&void 0!==u?u:18,GridLeading:null!==(c=F.leading)&&void 0!==c?c:22,GridColor:ky(F.color),GridLeadingFillColor:ky(F.color),AlignLineHeightToGridFlags:!!F.alignLineHeightToGridFlags},AntiAlias:_y.indexOf(null!==(h=e.antiAlias)&&void 0!==h?h:"sharp"),UseFractionalGlyphWidths:null===(d=e.useFractionalGlyphWidths)||void 0===d||d,Rendered:{Version:1,Shapes:{WritingDirection:P,Children:[{ShapeType:N,Procession:D,Lines:{WritingDirection:P,Children:[]},Cookie:{Photoshop:B}}]}}},ResourceDict:vy({},U),DocumentResources:vy({},U)}}var By=function(){return By=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},By.apply(this,arguments)},Uy="abcdefghijklmnopqrstuvwxyz",zy={};function Xy(e,t,r,n){var i={key:e,has:t,read:r,write:n};zy[i.key]=i}function Hy(e,t){zy[e]=zy[t]}function Gy(e){return function(t){return void 0!==t[e]}}function jy(e){if(km(e))throw new Error("Resource size above 4 GB limit at ".concat(e.offset.toString(16)));return km(e)}function Yy(e,t){Fb(e,0),Fb(e,t)}function Wy(e,t,r){var n=Om(e)*r,i=Om(e)*t,o=Om(e)*r,a=Om(e)*t,s=Om(e)*r;return[i,n,a,o,Om(e)*t,s]}function Vy(e,t,r,n){Bb(e,t[1]/n),Bb(e,t[0]/r),Bb(e,t[3]/n),Bb(e,t[2]/r),Bb(e,t[5]/n),Bb(e,t[4]/r)}Xy("TySh",Gy("text"),(function(e,t,r){if(1!==wm(e))throw new Error("Invalid TySh version");for(var n=[],i=0;i<6;i++)n.push(Am(e));if(50!==wm(e))throw new Error("Invalid TySh text version");var o=vv(e);if(1!==wm(e))throw new Error("Invalid TySh warp version");var a=vv(e);if(t.text={transform:n,left:Tm(e),top:Tm(e),right:Tm(e),bottom:Tm(e),text:o["Txt "].replace(/\r/g,"\n"),index:o.TextIndex||0,gridding:Jv.decode(o.textGridding),antiAlias:$v.decode(o.AntA),orientation:Qv.decode(o.Ornt),warp:{style:eg.decode(a.warpStyle),value:a.warpValue||0,perspective:a.warpPerspective||0,perspectiveOther:a.warpPerspectiveOther||0,rotate:Qv.decode(a.warpRotate)}},o.bounds&&(t.text.bounds=bv(o.bounds)),o.boundingBox&&(t.text.boundingBox=bv(o.boundingBox)),o.EngineData){var s=function(e){var t=0;function r(){for(;t<e.length&&cy(e[t]);)t++}function n(){var r=e[t];return t++,92===r&&(r=e[t],t++),r}function i(){var r="";if(41===e[t])return t++,r;if(254!==e[t]||255!==e[t+1])throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&41!==e[t];){var i=n()<<8|n();r+=String.fromCharCode(i)}return t++,r}var o=null,a=[];function s(e){a.length?(l(e),a.push(e)):(a.push(e),o=e)}function l(e){if(!a.length)throw new Error("Invalid data");var t=a[a.length-1];if("string"==typeof t)a[a.length-2][t]=e,c();else{if(!Array.isArray(t))throw new Error("Invalid data");t.push(e)}}function u(e){a.length||s({});var t=a[a.length-1];if(t&&"string"==typeof t)l("nil"===e?null:"/".concat(e));else{if(!t||"object"!=typeof t)throw new Error("Invalid data");a.push(e)}}function c(){if(!a.length)throw new Error("Invalid data");a.pop()}for(r();t<e.length;){var h=t,d=e[h];if(60===d&&60===e[h+1])t+=2,s({});else if(62===d&&62===e[h+1])t+=2,c();else if(47===d){for(var f=t+=1;t<e.length&&!cy(e[t]);)t++;for(var p="",v=f;v<t;v++)p+=String.fromCharCode(e[v]);u(p)}else if(40===d)t+=1,l(i());else if(91===d)t+=1,s([]);else if(93===d)t+=1,c();else if(110===d&&117===e[h+1]&&108===e[h+2]&&108===e[h+3])t+=4,l(null);else if(116===d&&114===e[h+1]&&117===e[h+2]&&101===e[h+3])t+=4,l(!0);else if(102===d&&97===e[h+1]&&108===e[h+2]&&115===e[h+3]&&101===e[h+4])t+=5,l(!1);else if(hy(d)){for(var g="";t<e.length&&hy(e[t]);)g+=String.fromCharCode(e[t]),t++;l(parseFloat(g))}else t+=1,console.log("Invalid token ".concat(String.fromCharCode(d)," at ").concat(t));r()}return o}(o.EngineData),l=function(e){for(var t,r,n,i,o,a,s=e.EngineDict,l=e.ResourceDict,u=l.FontSet.map((function(e){return{name:e.Name,script:e.Script,type:e.FontType,synthetic:e.Synthetic}})),c=s.Editor.Text.replace(/\r/g,"\n"),h=0;/\n$/.test(c);)c=c.substring(0,c.length-1),h++;var d={text:c,antiAlias:null!==(t=_y[s.AntiAlias])&&void 0!==t?t:"smooth",useFractionalGlyphWidths:!!s.UseFractionalGlyphWidths,superscriptSize:l.SuperscriptSize,superscriptPosition:l.SuperscriptPosition,subscriptSize:l.SubscriptSize,subscriptPosition:l.SubscriptPosition,smallCapSize:l.SmallCapSize},f=null===(a=null===(o=null===(i=null===(n=null===(r=s.Rendered)||void 0===r?void 0:r.Shapes)||void 0===n?void 0:n.Children)||void 0===i?void 0:i[0])||void 0===o?void 0:o.Cookie)||void 0===a?void 0:a.Photoshop;f&&(d.shapeType=1===f.ShapeType?"box":"point",f.PointBase&&(d.pointBase=f.PointBase),f.BoxBounds&&(d.boxBounds=f.BoxBounds));var p=s.ParagraphRun;d.paragraphStyle={},d.paragraphStyleRuns=[];for(var v=0;v<p.RunArray.length;v++){var g=p.RunArray[v],m=p.RunLengthArray[v],y=Ry(g.ParagraphSheet.Properties,u);d.paragraphStyleRuns.push({length:m,style:y})}for(var b=h;d.paragraphStyleRuns.length&&b>0;b--)0==--d.paragraphStyleRuns[d.paragraphStyleRuns.length-1].length&&d.paragraphStyleRuns.pop();Dy(d.paragraphStyle,d.paragraphStyleRuns,xy),d.paragraphStyleRuns.length||delete d.paragraphStyleRuns;var x=s.StyleRun;for(d.style={},d.styleRuns=[],v=0;v<x.RunArray.length;v++){var w=x.RunLengthArray[v];(y=Iy(x.RunArray[v].StyleSheet.StyleSheetData,u)).font||(y.font=u[0]),d.styleRuns.push({length:w,style:y})}for(b=h;d.styleRuns.length&&b>0;b--)0==--d.styleRuns[d.styleRuns.length-1].length&&d.styleRuns.pop();return Dy(d.style,d.styleRuns,wy),d.styleRuns.length||delete d.styleRuns,d}(s);t.text=By(By({},t.text),l)}Bm(e,r())}),(function(e,t){var r=t.text,n=r.warp||{},i=r.transform||[1,0,0,1,0,0],o=By(By(By({"Txt ":(r.text||"").replace(/\r?\n/g,"\r"),textGridding:Jv.encode(r.gridding),Ornt:Qv.encode(r.orientation),AntA:$v.encode(r.antiAlias)},r.bounds?{bounds:xv(r.bounds)}:{}),r.boundingBox?{boundingBox:xv(r.boundingBox)}:{}),{TextIndex:r.index||0,EngineData:py(Ny(r))});Mb(e,1);for(var a=0;a<6;a++)Db(e,i[a]);Mb(e,50),gv(e,"","TxLr",o,"text"),Mb(e,1),gv(e,"","warp",Qy(n)),Pb(e,r.left),Pb(e,r.top),Pb(e,r.right),Pb(e,r.bottom)})),Xy("SoCo",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"color"===e.vectorFill.type}),(function(e,t){var r=vv(e);t.vectorFill=Pv(r)}),(function(e,t){gv(e,"","null",Bv(t.vectorFill).descriptor)})),Xy("GdFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&("solid"===e.vectorFill.type||"noise"===e.vectorFill.type)}),(function(e,t,r){var n=vv(e);t.vectorFill=Pv(n),Bm(e,r())}),(function(e,t){gv(e,"","null",Bv(t.vectorFill).descriptor)})),Xy("PtFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"pattern"===e.vectorFill.type}),(function(e,t){var r=vv(e);t.vectorFill=Pv(r)}),(function(e,t){gv(e,"","null",Bv(t.vectorFill).descriptor)})),Xy("vscg",(function(e){return void 0!==e.vectorFill&&void 0!==e.vectorStroke}),(function(e,t,r){Rm(e);var n=vv(e);t.vectorFill=Pv(n),Bm(e,r())}),(function(e,t){var r=Bv(t.vectorFill),n=r.descriptor;Xb(e,r.key),gv(e,"","null",n)}));var qy=["exclude","combine","subtract","intersect"];Xy("vmsk",Gy("vectorMask"),(function(e,t,r,n){var i=n.width,o=n.height;if(3!==km(e))throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var a=t.vectorMask,s=km(e);a.invert=!!(1&s),a.notLink=!!(2&s),a.disable=!!(4&s),function(e,t,r,n,i){for(var o=e.offset+i,a=t.paths,s=void 0;o-e.offset>=26;){var l=_m(e);switch(l){case 0:case 3:_m(e);var u=wm(e),c=_m(e);Bm(e,18),s={open:3===l,knots:[],fillRule:2===c?"non-zero":"even-odd"},-1!==u&&(s.operation=qy[u]),a.push(s);break;case 1:case 2:case 4:case 5:s.knots.push({linked:1===l||4===l,points:Wy(e,r,n)});break;case 6:Bm(e,24);break;case 7:var h=Om(e),d=Om(e),f=Om(e),p=Om(e),v=Om(e);Bm(e,4),t.clipboard={top:h,left:d,bottom:f,right:p,resolution:v};break;case 8:t.fillStartsWithAllPixels=!!_m(e),Bm(e,22);break;default:throw new Error("Invalid vmsk section")}}}(e,a,i,o,r()),Bm(e,r())}),(function(e,t,r){var n=r.width,i=r.height,o=t.vectorMask,a=(o.invert?1:0)|(o.notLink?2:0)|(o.disable?4:0);Fb(e,3),Fb(e,a),Ob(e,6),zb(e,24);var s=o.clipboard;s&&(Ob(e,7),Bb(e,s.top),Bb(e,s.left),Bb(e,s.bottom),Bb(e,s.right),Bb(e,s.resolution),zb(e,4)),void 0!==o.fillStartsWithAllPixels&&(Ob(e,8),Ob(e,o.fillStartsWithAllPixels?1:0),zb(e,22));for(var l=0,u=o.paths;l<u.length;l++){var c=u[l];Ob(e,c.open?3:0),Ob(e,c.knots.length),Ob(e,c.operation?qy.indexOf(c.operation):-1),Ob(e,"non-zero"===c.fillRule?2:1),zb(e,18);for(var h=c.open?4:1,d=c.open?5:2,f=0,p=c.knots;f<p.length;f++){var v=p[f],g=v.linked,m=v.points;Ob(e,g?h:d),Vy(e,m,n,i)}}})),Hy("vsms","vmsk"),Xy("vogk",Gy("vectorOrigination"),(function(e,t,r){if(1!==Sm(e))throw new Error("Invalid vogk version");var n=vv(e);t.vectorOrigination={keyDescriptorList:[]};for(var i=0,o=n.keyDescriptorList;i<o.length;i++){var a=o[i],s={};null!=a.keyShapeInvalidated&&(s.keyShapeInvalidated=a.keyShapeInvalidated),null!=a.keyOriginType&&(s.keyOriginType=a.keyOriginType),null!=a.keyOriginResolution&&(s.keyOriginResolution=a.keyOriginResolution),a.keyOriginShapeBBox&&(s.keyOriginShapeBoundingBox={top:Yv(a.keyOriginShapeBBox["Top "]),left:Yv(a.keyOriginShapeBBox.Left),bottom:Yv(a.keyOriginShapeBBox.Btom),right:Yv(a.keyOriginShapeBBox.Rght)});var l=a.keyOriginRRectRadii;l&&(s.keyOriginRRectRadii={topRight:jv(l.topRight),topLeft:jv(l.topLeft),bottomLeft:jv(l.bottomLeft),bottomRight:jv(l.bottomRight)});var u=a.keyOriginBoxCorners;u&&(s.keyOriginBoxCorners=[{x:u.rectangleCornerA.Hrzn,y:u.rectangleCornerA.Vrtc},{x:u.rectangleCornerB.Hrzn,y:u.rectangleCornerB.Vrtc},{x:u.rectangleCornerC.Hrzn,y:u.rectangleCornerC.Vrtc},{x:u.rectangleCornerD.Hrzn,y:u.rectangleCornerD.Vrtc}]);var c=a.Trnf;c&&(s.transform=[c.xx,c.xy,c.xy,c.yy,c.tx,c.ty]),t.vectorOrigination.keyDescriptorList.push(s)}Bm(e,r())}),(function(e,t){for(var r=t.vectorOrigination,n={keyDescriptorList:[]},i=0;i<r.keyDescriptorList.length;i++){var o=r.keyDescriptorList[i];if(o.keyShapeInvalidated)n.keyDescriptorList.push({keyShapeInvalidated:!0,keyOriginIndex:i});else{n.keyDescriptorList.push({});var a=n.keyDescriptorList[n.keyDescriptorList.length-1];null!=o.keyOriginType&&(a.keyOriginType=o.keyOriginType),null!=o.keyOriginResolution&&(a.keyOriginResolution=o.keyOriginResolution);var s=o.keyOriginRRectRadii;s&&(a.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:Kv(s.topRight,"topRight"),topLeft:Kv(s.topLeft,"topLeft"),bottomLeft:Kv(s.bottomLeft,"bottomLeft"),bottomRight:Kv(s.bottomRight,"bottomRight")});var l=o.keyOriginShapeBoundingBox;l&&(a.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":Kv(l.top,"top"),Left:Kv(l.left,"left"),Btom:Kv(l.bottom,"bottom"),Rght:Kv(l.right,"right")});var u=o.keyOriginBoxCorners;u&&4===u.length&&(a.keyOriginBoxCorners={rectangleCornerA:{Hrzn:u[0].x,Vrtc:u[0].y},rectangleCornerB:{Hrzn:u[1].x,Vrtc:u[1].y},rectangleCornerC:{Hrzn:u[2].x,Vrtc:u[2].y},rectangleCornerD:{Hrzn:u[3].x,Vrtc:u[3].y}});var c=o.transform;c&&6===c.length&&(a.Trnf={xx:c[0],xy:c[1],yx:c[2],yy:c[3],tx:c[4],ty:c[5]}),a.keyOriginIndex=i}}Rb(e,1),gv(e,"","null",n)})),Xy("lmfx",(function(e){return void 0!==e.effects&&Tb(e.effects)}),(function(e,t,r){if(0!==km(e))throw new Error("Invalid lmfx version");var n=vv(e);t.effects=Sv(n,!!e.logMissingFeatures),Bm(e,r())}),(function(e,t,r,n){var i=Ev(t.effects,!!n.logMissingFeatures,!0);Fb(e,0),gv(e,"","null",i)})),Xy("lrFX",Gy("effects"),(function(e,t,r){t.effects||(t.effects=function(e){var t=_m(e);if(0!==t)throw new Error("Invalid effects layer version: ".concat(t));for(var r=_m(e),n={},i=0;i<r;i++){Um(e,"8BIM");var o=Rm(e);switch(o){case"cmnS":var a=km(e),s=km(e),l=!!bm(e);if(Bm(e,2),7!==a||0!==s||!l)throw new Error("Invalid effects common state");break;case"dsdw":case"isdw":var u=km(e),c=km(e);if(41!==u&&51!==u)throw new Error("Invalid shadow size: ".concat(u));if(0!==c&&2!==c)throw new Error("Invalid shadow version: ".concat(c));a=Mm(e),Mm(e);var h=Mm(e),d=Mm(e),f=ny(e),p=oy(e),v=!!bm(e),g=!!bm(e),m=sy(e);u>=51&&ny(e);var y={size:{units:"Pixels",value:a},distance:{units:"Pixels",value:d},angle:h,color:f,blendMode:p,enabled:v,useGlobalLight:g,opacity:m};"dsdw"===o?n.dropShadow=[y]:n.innerShadow=[y];break;case"oglw":u=km(e);var b=km(e);if(32!==u&&42!==u)throw new Error("Invalid outer glow size: ".concat(u));if(0!==b&&2!==b)throw new Error("Invalid outer glow version: ".concat(b));a=Mm(e),Mm(e),f=ny(e),p=oy(e),v=!!bm(e),m=sy(e),u>=42&&ny(e),n.outerGlow={size:{units:"Pixels",value:a},color:f,blendMode:p,enabled:v,opacity:m};break;case"iglw":u=km(e);var x=km(e);if(32!==u&&43!==u)throw new Error("Invalid inner glow size: ".concat(u));if(0!==x&&2!==x)throw new Error("Invalid inner glow version: ".concat(x));a=Mm(e),Mm(e),f=ny(e),p=oy(e),v=!!bm(e),m=sy(e),u>=43&&(bm(e),ny(e)),n.innerGlow={size:{units:"Pixels",value:a},color:f,blendMode:p,enabled:v,opacity:m};break;case"bevl":u=km(e);var w=km(e);if(58!==u&&78!==u)throw new Error("Invalid bevel size: ".concat(u));if(0!==w&&2!==w)throw new Error("Invalid bevel version: ".concat(w));h=Mm(e);var _=Mm(e),E=(a=Mm(e),oy(e)),S=oy(e),C=ny(e),k=ny(e),T=iy[bm(e)]||"inner bevel",A=sy(e),M=sy(e),O=(v=!!bm(e),g=!!bm(e),bm(e)?"down":"up");u>=78&&(ny(e),ny(e)),n.bevel={size:{units:"Pixels",value:a},angle:h,strength:_,highlightBlendMode:E,shadowBlendMode:S,highlightColor:C,shadowColor:k,style:T,highlightOpacity:A,shadowOpacity:M,enabled:v,useGlobalLight:g,direction:O};break;case"sofi":a=km(e);var L=km(e);if(34!==a)throw new Error("Invalid effects solid fill info size: ".concat(a));if(2!==L)throw new Error("Invalid effects solid fill info version: ".concat(L));p=oy(e),f=ny(e),m=sy(e),v=!!bm(e),ny(e),n.solidFill=[{blendMode:p,color:f,opacity:m,enabled:v}];break;default:throw new Error("Invalid effect type: '".concat(o,"'"))}}return n}(e)),Bm(e,r())}),(function(e,t){!function(e,t){var r,n,i,o,a,s,l=null===(r=t.dropShadow)||void 0===r?void 0:r[0],u=null===(n=t.innerShadow)||void 0===n?void 0:n[0],c=t.outerGlow,h=t.innerGlow,d=t.bevel,f=null===(i=t.solidFill)||void 0===i?void 0:i[0],p=1;if(l&&p++,u&&p++,c&&p++,h&&p++,d&&p++,f&&p++,Ob(e,0),Ob(e,p),Xb(e,"8BIM"),Xb(e,"cmnS"),Fb(e,7),Fb(e,0),Ab(e,1),zb(e,2),l&&(Xb(e,"8BIM"),Xb(e,"dsdw"),uy(e,l)),u&&(Xb(e,"8BIM"),Xb(e,"isdw"),uy(e,u)),c&&(Xb(e,"8BIM"),Xb(e,"oglw"),Fb(e,42),Fb(e,2),Nb(e,(null===(o=c.size)||void 0===o?void 0:o.value)||0),Nb(e,0),qb(e,c.color),ay(e,c.blendMode),Ab(e,c.enabled?1:0),ly(e,c.opacity||0),qb(e,c.color)),h&&(Xb(e,"8BIM"),Xb(e,"iglw"),Fb(e,43),Fb(e,2),Nb(e,(null===(a=h.size)||void 0===a?void 0:a.value)||0),Nb(e,0),qb(e,h.color),ay(e,h.blendMode),Ab(e,h.enabled?1:0),ly(e,h.opacity||0),Ab(e,0),qb(e,h.color)),d){Xb(e,"8BIM"),Xb(e,"bevl"),Fb(e,78),Fb(e,2),Nb(e,d.angle||0),Nb(e,d.strength||0),Nb(e,(null===(s=d.size)||void 0===s?void 0:s.value)||0),ay(e,d.highlightBlendMode),ay(e,d.shadowBlendMode),qb(e,d.highlightColor),qb(e,d.shadowColor);var v=iy.indexOf(d.style);Ab(e,v<=0?1:v),ly(e,d.highlightOpacity||0),ly(e,d.shadowOpacity||0),Ab(e,d.enabled?1:0),Ab(e,d.useGlobalLight?1:0),Ab(e,"down"===d.direction?1:0),qb(e,d.highlightColor),qb(e,d.shadowColor)}f&&(Xb(e,"8BIM"),Xb(e,"sofi"),Fb(e,34),Fb(e,2),ay(e,f.blendMode),qb(e,f.color),ly(e,f.opacity||0),Ab(e,f.enabled?1:0),qb(e,f.color))}(e,t.effects)})),Xy("luni",Gy("name"),(function(e,t,r){if(r()>4){var n=km(e);r()>=2*n?t.name=Dm(e,n):e.logDevFeatures&&e.log("name in luni section is too long")}else e.logDevFeatures&&e.log("empty luni section");Bm(e,r())}),(function(e,t){Gb(e,t.name)})),Xy("lnsr",Gy("nameSource"),(function(e,t){return t.nameSource=Rm(e)}),(function(e,t){return Xb(e,t.nameSource)})),Xy("lyid",Gy("id"),(function(e,t){return t.id=km(e)}),(function(e,t,r,n){for(var i=t.id;n.layerIds.has(i);)i+=100;Fb(e,i),n.layerIds.add(i),n.layerToId.set(t,i)})),Xy("lsct",Gy("sectionDivider"),(function(e,t,r){t.sectionDivider={type:km(e)},r()&&(Um(e,"8BIM"),t.sectionDivider.key=Rm(e)),r()&&(t.sectionDivider.subType=km(e))}),(function(e,t){Fb(e,t.sectionDivider.type),t.sectionDivider.key&&(Xb(e,"8BIM"),Xb(e,t.sectionDivider.key),void 0!==t.sectionDivider.subType&&Fb(e,t.sectionDivider.subType))})),Hy("lsdk","lsct"),Xy("clbl",Gy("blendClippendElements"),(function(e,t){t.blendClippendElements=!!bm(e),Bm(e,3)}),(function(e,t){Ab(e,t.blendClippendElements?1:0),zb(e,3)})),Xy("infx",Gy("blendInteriorElements"),(function(e,t){t.blendInteriorElements=!!bm(e),Bm(e,3)}),(function(e,t){Ab(e,t.blendInteriorElements?1:0),zb(e,3)})),Xy("knko",Gy("knockout"),(function(e,t){t.knockout=!!bm(e),Bm(e,3)}),(function(e,t){Ab(e,t.knockout?1:0),zb(e,3)})),Xy("lmgm",Gy("layerMaskAsGlobalMask"),(function(e,t){t.layerMaskAsGlobalMask=!!bm(e),Bm(e,3)}),(function(e,t){Ab(e,t.layerMaskAsGlobalMask?1:0),zb(e,3)})),Xy("lspf",Gy("protected"),(function(e,t){var r=km(e);t.protected={transparency:!!(1&r),composite:!!(2&r),position:!!(4&r)},8&r&&(t.protected.artboards=!0)}),(function(e,t){Fb(e,(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0))})),Xy("lclr",Gy("layerColor"),(function(e,t){var r=_m(e);Bm(e,6),t.layerColor=wp[r]}),(function(e,t){var r=wp.indexOf(t.layerColor);Ob(e,-1===r?0:r),zb(e,6)})),Xy("shmd",(function(e){return void 0!==e.timestamp||void 0!==e.animationFrames||void 0!==e.animationFrameFlags||void 0!==e.timeline||void 0!==e.comps}),(function(e,t,r){for(var n=km(e),i=function(r){Um(e,"8BIM");var n=Rm(e);bm(e),Bm(e,3),ry(e,1,(function(r){if("cust"===n)void 0!==(i=vv(e)).layerTime&&(t.timestamp=i.layerTime);else if("mlst"===n){var i=vv(e);t.animationFrames=[];for(var o=0;o<i.LaSt.length;o++){var a=i.LaSt[o],s={frames:a.FrLs};void 0!==a.enab&&(s.enable=a.enab),a.Ofst&&(s.offset=mv(a.Ofst)),a.FXRf&&(s.referencePoint=mv(a.FXRf)),a.Lefx&&(s.effects=Sv(a.Lefx,!!e.logMissingFeatures)),a.blendOptions&&a.blendOptions.Opct&&(s.opacity=Hv(a.blendOptions.Opct)),t.animationFrames.push(s)}}else if("mdyn"===n){_m(e);var l=bm(e),u=bm(e);t.animationFrameFlags={propagateFrameOne:!l,unifyLayerPosition:!!(1&u),unifyLayerStyle:!!(2&u),unifyLayerVisibility:!!(4&u)}}else if("tmln"===n){var c=(i=vv(e)).timeScope,h={start:Zv(c.Strt),duration:Zv(c.duration),inTime:Zv(c.inTime),outTime:Zv(c.outTime),autoScope:i.autoScope,audioLevel:i.audioLevel};i.trackList&&(h.tracks=Tv(i.trackList,!!e.logMissingFeatures)),t.timeline=h}else if("cmls"===n){i=vv(e);t.comps={settings:[]},i.origFXRefPoint&&(t.comps.originalEffectsReferencePoint={x:i.origFXRefPoint.Hrzn,y:i.origFXRefPoint.Vrtc});for(var d=0,f=i.layerSettings;d<f.length;d++){var p=f[d];t.comps.settings.push({compList:p.compList});var v=t.comps.settings[t.comps.settings.length-1];"enab"in p&&(v.enabled=p.enab),p.Ofst&&(v.offset={x:p.Ofst.Hrzn,y:p.Ofst.Vrtc}),p.FXRefPoint&&(v.effectsReferencePoint={x:p.FXRefPoint.Hrzn,y:p.FXRefPoint.Vrtc})}}else e.logMissingFeatures&&e.log('Unhandled "shmd" section key',n);Bm(e,r())}))},o=0;o<n;o++)i();Bm(e,r())}),(function(e,t,r,n){var i=t.animationFrames,o=t.animationFrameFlags,a=t.timestamp,s=t.timeline,l=t.comps,u=0;i&&u++,o&&u++,s&&u++,void 0!==a&&u++,l&&u++,Fb(e,u),i&&(Xb(e,"8BIM"),Xb(e,"mlst"),Ab(e,0),zb(e,3),Yb(e,2,(function(){for(var r,n={LaID:null!==(r=t.id)&&void 0!==r?r:0,LaSt:[]},o=0;o<i.length;o++){var a=i[o],s={};void 0!==a.enable&&(s.enab=a.enable),s.FrLs=a.frames,a.offset&&(s.Ofst=yv(a.offset)),a.referencePoint&&(s.FXRf=yv(a.referencePoint)),a.effects&&(s.Lefx=Ev(a.effects,!1,!1)),void 0!==a.opacity&&(s.blendOptions={Opct:Vv(a.opacity)}),n.LaSt.push(s)}gv(e,"","null",n)}),!0)),o&&(Xb(e,"8BIM"),Xb(e,"mdyn"),Ab(e,0),zb(e,3),Yb(e,2,(function(){Ob(e,0),Ab(e,o.propagateFrameOne?0:15),Ab(e,(o.unifyLayerPosition?1:0)|(o.unifyLayerStyle?2:0)|(o.unifyLayerVisibility?4:0))}))),s&&(Xb(e,"8BIM"),Xb(e,"tmln"),Ab(e,0),zb(e,3),Yb(e,2,(function(){var r={Vrsn:1,timeScope:{Vrsn:1,Strt:s.start,duration:s.duration,inTime:s.inTime,outTime:s.outTime},autoScope:s.autoScope,audioLevel:s.audioLevel};s.tracks&&(r.trackList=Av(s.tracks));var i=n.layerToId.get(t)||t.id;if(!i)throw new Error("You need to provide layer.id value whan writing document with animations");r.LyrI=i,gv(e,"","null",r,"anim")}),!0)),void 0!==a&&(Xb(e,"8BIM"),Xb(e,"cust"),Ab(e,0),zb(e,3),Yb(e,2,(function(){gv(e,"","metadata",{layerTime:a})}),!0)),l&&(Xb(e,"8BIM"),Xb(e,"cmls"),Ab(e,0),zb(e,3),Yb(e,2,(function(){var r=n.layerToId.get(t)||t.id;if(!r)throw new Error("You need to provide layer.id value whan writing document with layer comps");var i={};l.originalEffectsReferencePoint&&(i.origFXRefPoint={Hrzn:l.originalEffectsReferencePoint.x,Vrtc:l.originalEffectsReferencePoint.y}),i.LyrI=r,i.layerSettings=[];for(var o=0,a=l.settings;o<a.length;o++){var s=a[o],u={};void 0!==s.enabled&&(u.enab=s.enabled),s.offset&&(u.Ofst={Hrzn:s.offset.x,Vrtc:s.offset.y}),s.effectsReferencePoint&&(u.FXRefPoint={Hrzn:s.effectsReferencePoint.x,Vrtc:s.effectsReferencePoint.y}),u.compList=s.compList,i.layerSettings.push(u)}gv(e,"","null",i)}),!0))})),Xy("vstk",Gy("vectorStroke"),(function(e,t,r){var n=vv(e);t.vectorStroke={strokeEnabled:n.strokeEnabled,fillEnabled:n.fillEnabled,lineWidth:jv(n.strokeStyleLineWidth),lineDashOffset:jv(n.strokeStyleLineDashOffset),miterLimit:n.strokeStyleMiterLimit,lineCapType:bg.decode(n.strokeStyleLineCapType),lineJoinType:xg.decode(n.strokeStyleLineJoinType),lineAlignment:wg.decode(n.strokeStyleLineAlignment),scaleLock:n.strokeStyleScaleLock,strokeAdjust:n.strokeStyleStrokeAdjust,lineDashSet:n.strokeStyleLineDashSet.map(jv),blendMode:tg.decode(n.strokeStyleBlendMode),opacity:Hv(n.strokeStyleOpacity),content:Pv(n.strokeStyleContent),resolution:n.strokeStyleResolution},Bm(e,r())}),(function(e,t){var r,n,i,o=t.vectorStroke;gv(e,"","strokeStyle",{strokeStyleVersion:2,strokeEnabled:!!o.strokeEnabled,fillEnabled:!!o.fillEnabled,strokeStyleLineWidth:o.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:o.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:null!==(r=o.miterLimit)&&void 0!==r?r:100,strokeStyleLineCapType:bg.encode(o.lineCapType),strokeStyleLineJoinType:xg.encode(o.lineJoinType),strokeStyleLineAlignment:wg.encode(o.lineAlignment),strokeStyleScaleLock:!!o.scaleLock,strokeStyleStrokeAdjust:!!o.strokeAdjust,strokeStyleLineDashSet:o.lineDashSet||[],strokeStyleBlendMode:tg.encode(o.blendMode),strokeStyleOpacity:Vv(null!==(n=o.opacity)&&void 0!==n?n:1),strokeStyleContent:Bv(o.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:null!==(i=o.resolution)&&void 0!==i?i:72})})),Xy("artb",Gy("artboard"),(function(e,t,r){var n=vv(e),i=n.artboardRect;t.artboard={rect:{top:i["Top "],left:i.Left,bottom:i.Btom,right:i.Rght},guideIndices:n.guideIndeces,presetName:n.artboardPresetName,color:Uv(n["Clr "]),backgroundType:n.artboardBackgroundType},Bm(e,r())}),(function(e,t){var r,n=t.artboard,i=n.rect;gv(e,"","artboard",{artboardRect:{"Top ":i.top,Left:i.left,Btom:i.bottom,Rght:i.right},guideIndeces:n.guideIndices||[],artboardPresetName:n.presetName||"","Clr ":zv(n.color),artboardBackgroundType:null!==(r=n.backgroundType)&&void 0!==r?r:1})})),Xy("sn2P",Gy("usingAlignedRendering"),(function(e,t){return t.usingAlignedRendering=!!km(e)}),(function(e,t){return Fb(e,t.usingAlignedRendering?1:0)}));var Ky=["unknown","vector","raster","image stack"];function Zy(e){var t,r,n,i,o,a,s=By(By({style:eg.decode(e.warpStyle)},e.warpValues?{values:e.warpValues}:{value:e.warpValue||0}),{perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:Qv.decode(e.warpRotate),bounds:e.bounds&&{top:Yv(e.bounds["Top "]),left:Yv(e.bounds.Left),bottom:Yv(e.bounds.Btom),right:Yv(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder});null==e.deformNumRows&&null==e.deformNumCols||(s.deformNumRows=e.deformNumRows,s.deformNumCols=e.deformNumCols);var l=e.customEnvelopeWarp;if(l){s.customEnvelopeWarp={meshPoints:[]};for(var u=(null===(t=l.meshPoints.find((function(e){return"Hrzn"===e.type})))||void 0===t?void 0:t.values)||[],c=(null===(r=l.meshPoints.find((function(e){return"Vrtc"===e.type})))||void 0===r?void 0:r.values)||[],h=0;h<u.length;h++)s.customEnvelopeWarp.meshPoints.push({x:u[h],y:c[h]});(l.quiltSliceX||l.quiltSliceY)&&(s.customEnvelopeWarp.quiltSliceX=(null===(i=null===(n=l.quiltSliceX)||void 0===n?void 0:n[0])||void 0===i?void 0:i.values)||[],s.customEnvelopeWarp.quiltSliceY=(null===(a=null===(o=l.quiltSliceY)||void 0===o?void 0:o[0])||void 0===a?void 0:a.values)||[])}return s}function Jy(e){var t,r;return null!=e.deformNumCols||null!=e.deformNumRows||(null===(t=e.customEnvelopeWarp)||void 0===t?void 0:t.quiltSliceX)||(null===(r=e.customEnvelopeWarp)||void 0===r?void 0:r.quiltSliceY)}function Qy(e){var t=e.bounds,r=By(By({warpStyle:eg.encode(e.style)},e.values?{warpValues:e.values}:{warpValue:e.value||0}),{warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:Qv.encode(e.rotate),bounds:{"Top ":Kv(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:Kv(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:Kv(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:Kv(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0}),n=Jy(e);n&&((o=r).deformNumRows=e.deformNumRows||0,o.deformNumCols=e.deformNumCols||0);var i=e.customEnvelopeWarp;if(i){var o,a=i.meshPoints||[];if(n)(o=r).customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",quiltSliceX:[{type:"quiltSliceX",values:i.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:i.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:a.map((function(e){return e.x}))},{type:"Vrtc",values:a.map((function(e){return e.y}))}]};else r.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",meshPoints:[{type:"Hrzn",values:a.map((function(e){return e.x}))},{type:"Vrtc",values:a.map((function(e){return e.y}))}]}}return r}function $y(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function eb(e){for(var t=[],r=0;r<e.length;r+=2)t.push({x:e[r],y:e[r+1]});return t}function tb(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].x,e[r].y);return t}function rb(e){return eb(function(e){return new Float32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}(e))}function nb(e){return{x:jv(e.Hrzn),y:jv(e.Vrtc)}}function ib(e){return{_name:"",_classID:"Pnt ",Hrzn:Kv(e.x,"x"),Vrtc:Kv(e.y,"y")}}function ob(e,t){return{enabled:e.enab,validAtPosition:e.validAtPosition,maskEnabled:e.filterMaskEnable,maskLinked:e.filterMaskLinked,maskExtendWithWhite:e.filterMaskExtendWithWhite,list:e.filterFXList.map((function(e){return function(e,t){var r={name:e["Nm  "],opacity:Hv(e.blendOptions.Opct),blendMode:tg.decode(e.blendOptions["Md  "]),enabled:e.enab,hasOptions:e.hasoptions,foregroundColor:Uv(e.FrgC),backgroundColor:Uv(e.BckC)};if("Fltr"in e)switch(e.Fltr._classID){case"boxblur":return By(By({},r),{type:"box blur",filter:{radius:jv(e.Fltr["Rds "])}});case"GsnB":return By(By({},r),{type:"gaussian blur",filter:{radius:jv(e.Fltr["Rds "])}});case"MtnB":return By(By({},r),{type:"motion blur",filter:{angle:e.Fltr.Angl,distance:jv(e.Fltr.Dstn)}});case"RdlB":return By(By({},r),{type:"radial blur",filter:{amount:e.Fltr.Amnt,method:_g.decode(e.Fltr.BlrM),quality:Eg.decode(e.Fltr.BlrQ)}});case"shapeBlur":return By(By({},r),{type:"shape blur",filter:{radius:jv(e.Fltr["Rds "]),customShape:{name:e.Fltr.customShape["Nm  "],id:e.Fltr.customShape.Idnt}}});case"SmrB":return By(By({},r),{type:"smart blur",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh,quality:Cg.decode(e.Fltr.SmBQ),mode:Sg.decode(e.Fltr.SmBM)}});case"surfaceBlur":return By(By({},r),{type:"surface blur",filter:{radius:jv(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dspl":return By(By({},r),{type:"displace",filter:{horizontalScale:e.Fltr.HrzS,verticalScale:e.Fltr.VrtS,displacementMap:kg.decode(e.Fltr.DspM),undefinedAreas:Tg.decode(e.Fltr.UndA),displacementFile:{signature:e.Fltr.DspF.sig,path:e.Fltr.DspF.path}}});case"Pnch":return By(By({},r),{type:"pinch",filter:{amount:e.Fltr.Amnt}});case"Plr ":return By(By({},r),{type:"polar coordinates",filter:{conversion:Ag.decode(e.Fltr.Cnvr)}});case"Rple":return By(By({},r),{type:"ripple",filter:{amount:e.Fltr.Amnt,size:Mg.decode(e.Fltr.RplS)}});case"Shr ":return By(By({},r),{type:"shear",filter:{shearPoints:e.Fltr.ShrP.map((function(e){return{x:e.Hrzn,y:e.Vrtc}})),shearStart:e.Fltr.ShrS,shearEnd:e.Fltr.ShrE,undefinedAreas:Tg.decode(e.Fltr.UndA)}});case"Sphr":return By(By({},r),{type:"spherize",filter:{amount:e.Fltr.Amnt,mode:Og.decode(e.Fltr.SphM)}});case"Twrl":return By(By({},r),{type:"twirl",filter:{angle:e.Fltr.Angl}});case"Wave":return By(By({},r),{type:"wave",filter:{numberOfGenerators:e.Fltr.NmbG,type:Lg.decode(e.Fltr.Wvtp),wavelength:{min:e.Fltr.WLMn,max:e.Fltr.WLMx},amplitude:{min:e.Fltr.AmMn,max:e.Fltr.AmMx},scale:{x:e.Fltr.SclH,y:e.Fltr.SclV},randomSeed:e.Fltr.RndS,undefinedAreas:Tg.decode(e.Fltr.UndA)}});case"ZgZg":return By(By({},r),{type:"zigzag",filter:{amount:e.Fltr.Amnt,ridges:e.Fltr.NmbR,style:Rg.decode(e.Fltr.ZZTy)}});case"AdNs":return By(By({},r),{type:"add noise",filter:{amount:Hv(e.Fltr.Nose),distribution:Ig.decode(e.Fltr.Dstr),monochromatic:e.Fltr.Mnch,randomSeed:e.Fltr.FlRs}});case"DstS":return By(By({},r),{type:"dust and scratches",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh}});case"Mdn ":return By(By({},r),{type:"median",filter:{radius:jv(e.Fltr["Rds "])}});case"denoise":return By(By({},r),{type:"reduce noise",filter:{preset:e.Fltr.preset,removeJpegArtifact:e.Fltr.removeJPEGArtifact,reduceColorNoise:Hv(e.Fltr.ClNs),sharpenDetails:Hv(e.Fltr.Shrp),channelDenoise:e.Fltr.channelDenoise.map((function(e){return By({channels:e.Chnl.map((function(e){return Fg.decode(e)})),amount:e.Amnt},e.EdgF?{preserveDetails:e.EdgF}:{})}))}});case"ClrH":return By(By({},r),{type:"color halftone",filter:{radius:e.Fltr["Rds "],angle1:e.Fltr.Ang1,angle2:e.Fltr.Ang2,angle3:e.Fltr.Ang3,angle4:e.Fltr.Ang4}});case"Crst":return By(By({},r),{type:"crystallize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Mztn":return By(By({},r),{type:"mezzotint",filter:{type:Pg.decode(e.Fltr.MztT),randomSeed:e.Fltr.FlRs}});case"Msc ":return By(By({},r),{type:"mosaic",filter:{cellSize:jv(e.Fltr.ClSz)}});case"Pntl":return By(By({},r),{type:"pointillize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Clds":return By(By({},r),{type:"clouds",filter:{randomSeed:e.Fltr.FlRs}});case"DfrC":return By(By({},r),{type:"difference clouds",filter:{randomSeed:e.Fltr.FlRs}});case"Fbrs":return By(By({},r),{type:"fibers",filter:{variance:e.Fltr.Vrnc,strength:e.Fltr.Strg,randomSeed:e.Fltr.RndS}});case"LnsF":return By(By({},r),{type:"lens flare",filter:{brightness:e.Fltr.Brgh,position:{x:e.Fltr.FlrC.Hrzn,y:e.Fltr.FlrC.Vrtc},lensType:Dg.decode(e.Fltr["Lns "])}});case"smartSharpen":return By(By({},r),{type:"smart sharpen",filter:{amount:Hv(e.Fltr.Amnt),radius:jv(e.Fltr["Rds "]),threshold:e.Fltr.Thsh,angle:e.Fltr.Angl,moreAccurate:e.Fltr.moreAccurate,blur:Ng.decode(e.Fltr.blur),preset:e.Fltr.preset,shadow:{fadeAmount:Hv(e.Fltr.sdwM.Amnt),tonalWidth:Hv(e.Fltr.sdwM.Wdth),radius:e.Fltr.sdwM["Rds "]},highlight:{fadeAmount:Hv(e.Fltr.hglM.Amnt),tonalWidth:Hv(e.Fltr.hglM.Wdth),radius:e.Fltr.hglM["Rds "]}}});case"UnsM":return By(By({},r),{type:"unsharp mask",filter:{amount:Hv(e.Fltr.Amnt),radius:jv(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dfs ":return By(By({},r),{type:"diffuse",filter:{mode:Bg.decode(e.Fltr["Md  "]),randomSeed:e.Fltr.FlRs}});case"Embs":return By(By({},r),{type:"emboss",filter:{angle:e.Fltr.Angl,height:e.Fltr.Hght,amount:e.Fltr.Amnt}});case"Extr":return By(By({},r),{type:"extrude",filter:{type:Ug.decode(e.Fltr.ExtT),size:e.Fltr.ExtS,depth:e.Fltr.ExtD,depthMode:zg.decode(e.Fltr.ExtR),randomSeed:e.Fltr.FlRs,solidFrontFaces:e.Fltr.ExtF,maskIncompleteBlocks:e.Fltr.ExtM}});case"Tls ":return By(By({},r),{type:"tiles",filter:{numberOfTiles:e.Fltr.TlNm,maximumOffset:e.Fltr.TlOf,fillEmptyAreaWith:Xg.decode(e.Fltr.FlCl),randomSeed:e.Fltr.FlRs}});case"TrcC":return By(By({},r),{type:"trace contour",filter:{level:e.Fltr["Lvl "],edge:Hg.decode(e.Fltr["Edg "])}});case"Wnd ":return By(By({},r),{type:"wind",filter:{method:Gg.decode(e.Fltr.WndM),direction:jg.decode(e.Fltr.Drct)}});case"Dntr":return By(By({},r),{type:"de-interlace",filter:{eliminate:Yg.decode(e.Fltr.IntE),newFieldsBy:Wg.decode(e.Fltr.IntC)}});case"Cstm":return By(By({},r),{type:"custom",filter:{scale:e.Fltr["Scl "],offset:e.Fltr.Ofst,matrix:e.Fltr.Mtrx}});case"HghP":return By(By({},r),{type:"high pass",filter:{radius:jv(e.Fltr["Rds "])}});case"Mxm ":return By(By({},r),{type:"maximum",filter:{radius:jv(e.Fltr["Rds "])}});case"Mnm ":return By(By({},r),{type:"minimum",filter:{radius:jv(e.Fltr["Rds "])}});case"Ofst":return By(By({},r),{type:"offset",filter:{horizontal:e.Fltr.Hrzn,vertical:e.Fltr.Vrtc,undefinedAreas:Vg.decode(e.Fltr["Fl  "])}});case"rigidTransform":return By(By({},r),{type:"puppet",filter:{rigidType:e.Fltr.rigidType,bounds:[{x:e.Fltr.PuX0,y:e.Fltr.PuY0},{x:e.Fltr.PuX1,y:e.Fltr.PuY1},{x:e.Fltr.PuX2,y:e.Fltr.PuY2},{x:e.Fltr.PuX3,y:e.Fltr.PuY3}],puppetShapeList:e.Fltr.puppetShapeList.map((function(e){return{rigidType:e.rigidType,originalVertexArray:rb(e.originalVertexArray),deformedVertexArray:rb(e.deformedVertexArray),indexArray:Array.from((t=e.indexArray,new Uint32Array(t.buffer.slice(t.byteOffset),0,t.byteLength/4))),pinOffsets:eb(e.pinOffsets),posFinalPins:eb(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,selectedPin:e.selectedPin,pinPosition:eb(e.PinP),pinRotation:e.PnRt,pinOverlay:e.PnOv,pinDepth:e.PnDp,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{pathComponents:e.meshBoundaryPath.pathComponents.map((function(e){return{shapeOperation:e.shapeOperation.split(".")[1],paths:e.SbpL.map((function(e){return{closed:e.Clsp,points:e["Pts "].map((function(e){return{anchor:nb(e.Anch),forward:nb(e["Fwd "]),backward:nb(e["Bwd "]),smooth:e.Smoo}}))}}))}}))}};var t}))}});case"PbPl":for(var n=[],i=e.Fltr,o=0;o<Uy.length&&i["PN".concat(Uy[o],"a")];o++)for(var a=0;a<Uy.length&&i["PN".concat(Uy[o]).concat(Uy[a])];a++)n.push({name:i["PN".concat(Uy[o]).concat(Uy[a])],value:i["PF".concat(Uy[o]).concat(Uy[a])]});return By(By({},r),{type:"oil paint plugin",filter:{name:e.Fltr.KnNm,gpu:e.Fltr.GpuY,lighting:e.Fltr.LIWy,parameters:n}});case"HsbP":return By(By({},r),{type:"hsb/hsl",filter:{inputMode:hg.decode(e.Fltr.Inpt),rowOrder:hg.decode(e.Fltr.Otpt)}});case"oilPaint":return By(By({},r),{type:"oil paint",filter:{lightingOn:e.Fltr.lightingOn,stylization:e.Fltr.stylization,cleanliness:e.Fltr.cleanliness,brushScale:e.Fltr.brushScale,microBrush:e.Fltr.microBrush,lightDirection:e.Fltr.LghD,specularity:e.Fltr.specularity}});case"LqFy":return By(By({},r),{type:"liquify",filter:{liquifyMesh:e.Fltr.LqMe}});default:if(t.throwForMissingFeatures)throw new Error("Unknown filter classId: ".concat(e.Fltr._classID));return}else switch(e.filterID){case 1098281575:return By(By({},r),{type:"average"});case 1114403360:return By(By({},r),{type:"blur"});case 1114403405:return By(By({},r),{type:"blur more"});case 1148416099:return By(By({},r),{type:"despeckle"});case 1180922912:return By(By({},r),{type:"facet"});case 1181902701:return By(By({},r),{type:"fragment"});case 1399353968:return By(By({},r),{type:"sharpen"});case 1399353925:return By(By({},r),{type:"sharpen edges"});case 1399353933:return By(By({},r),{type:"sharpen more"});case 1181639749:return By(By({},r),{type:"find edges"});case 1399616122:return By(By({},r),{type:"solarize"});case 1314149187:return By(By({},r),{type:"ntsc colors"});default:if(t.throwForMissingFeatures)throw new Error("Unknown filterID: ".concat(e.filterID))}}(e,t)})).filter((function(e){return!!e}))}}function ab(e){return Kv(e.radius,"radius")}function sb(e){if(e.warp)return e.warp;if(!e.width||!e.height)throw new Error("You must provide width and height of the linked image in placedLayer");var t=e.width,r=e.height,n=t/3,i=2*t/3,o=r/3,a=2*r/3;return{style:"custom",value:0,perspective:0,perspectiveOther:0,rotate:"horizontal",bounds:{top:{value:0,units:"Pixels"},left:{value:0,units:"Pixels"},bottom:{value:r,units:"Pixels"},right:{value:t,units:"Pixels"}},uOrder:4,vOrder:4,customEnvelopeWarp:{meshPoints:[{x:0,y:0},{x:n,y:0},{x:i,y:0},{x:t,y:0},{x:0,y:o},{x:n,y:o},{x:i,y:o},{x:t,y:o},{x:0,y:a},{x:n,y:a},{x:i,y:a},{x:t,y:a},{x:0,y:r},{x:n,y:r},{x:i,y:r},{x:t,y:r}]}}}function lb(e){return{top:Sm(e),left:Sm(e),bottom:Sm(e),right:Sm(e)}}function ub(e,t){Rb(e,t.top),Rb(e,t.left),Rb(e,t.bottom),Rb(e,t.right)}function cb(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}function hb(e){return{shadowInput:wm(e),highlightInput:wm(e),shadowOutput:wm(e),highlightOutput:wm(e),midtoneInput:wm(e)/100}}function db(e,t){Mb(e,t.shadowInput),Mb(e,t.highlightInput),Mb(e,t.shadowOutput),Mb(e,t.highlightOutput),Mb(e,Math.round(100*t.midtoneInput))}function fb(e){for(var t=_m(e),r=[],n=0;n<t;n++){var i=wm(e),o=wm(e);r.push({input:o,output:i})}return r}function pb(e,t){Ob(e,t.length);for(var r=0,n=t;r<n.length;r++){var i=n[r];Ob(e,i.output),Ob(e,i.input)}}function vb(e){return{a:wm(e),b:wm(e),c:wm(e),d:wm(e),hue:wm(e),saturation:wm(e),lightness:wm(e)}}function gb(e,t){var r=t||{};Mb(e,r.a||0),Mb(e,r.b||0),Mb(e,r.c||0),Mb(e,r.d||0),Mb(e,r.hue||0),Mb(e,r.saturation||0),Mb(e,r.lightness||0)}function mb(e){return{cyanRed:wm(e),magentaGreen:wm(e),yellowBlue:wm(e)}}function yb(e,t){Mb(e,t.cyanRed||0),Mb(e,t.magentaGreen||0),Mb(e,t.yellowBlue||0)}function bb(e){var t=wm(e),r=wm(e),n=wm(e);return Bm(e,2),{red:t,green:r,blue:n,constant:wm(e)}}function xb(e,t){var r=t||{};Mb(e,r.red),Mb(e,r.green),Mb(e,r.blue),zb(e,2),Mb(e,r.constant)}Xy("PlLd",Gy("placedLayer"),(function(e,t,r){if("plcL"!==Rm(e))throw new Error("Invalid PlLd signature");if(3!==Sm(e))throw new Error("Invalid PlLd version");var n=Fm(e,1),i=Sm(e),o=Sm(e);Sm(e);var a=Sm(e);if(!Ky[a])throw new Error("Invalid PlLd type");for(var s=[],l=0;l<8;l++)s.push(Am(e));var u=Sm(e);if(0!==u)throw new Error("Invalid Warp version ".concat(u));var c=vv(e);t.placedLayer=t.placedLayer||{id:n,type:Ky[a],pageNumber:i,totalPages:o,transform:s,warp:Zy(c)},Bm(e,r())}),(function(e,t){var r=t.placedLayer;if(Xb(e,"plcL"),Rb(e,3),!r.id||"string"!=typeof r.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(r.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(Hb(e,r.id,1),Rb(e,1),Rb(e,1),Rb(e,16),-1===Ky.indexOf(r.type))throw new Error("Invalid placedLayer type");Rb(e,Ky.indexOf(r.type));for(var n=0;n<8;n++)Db(e,r.transform[n]);Rb(e,0);var i=sb(r),o=Jy(i)?"quiltWarp":"warp";gv(e,"",o,Qy(i),o)})),Xy("SoLd",Gy("placedLayer"),(function(e,t,r){if("soLD"!==Rm(e))throw new Error("Invalid SoLd type");var n=Sm(e);if(4!==n&&5!==n)throw new Error("Invalid SoLd version");var i=vv(e,!0);t.placedLayer={id:i.Idnt,placed:i.placed,type:Ky[i.Type],pageNumber:i.PgNm,totalPages:i.totalPages,frameStep:Zv(i.frameStep),duration:Zv(i.duration),frameCount:i.frameCount,transform:i.Trnf,width:i["Sz  "].Wdth,height:i["Sz  "].Hght,resolution:jv(i.Rslt),warp:Zy(i.quiltWarp||i.warp)},i.nonAffineTransform&&i.nonAffineTransform.some((function(e,t){return e!==i.Trnf[t]}))&&(t.placedLayer.nonAffineTransform=i.nonAffineTransform),i.Crop&&(t.placedLayer.crop=i.Crop),i.comp&&(t.placedLayer.comp=i.comp),i.compInfo&&(t.placedLayer.compInfo={compID:i.compInfo.compID,originalCompID:i.compInfo.originalCompID}),i.filterFX&&(t.placedLayer.filter=ob(i.filterFX,e)),Bm(e,r())}),(function(e,t){var r,n;Xb(e,"soLD"),Rb(e,4);var i=t.placedLayer;if(!i.id||"string"!=typeof i.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(i.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");var o=By(By({Idnt:i.id,placed:null!==(r=i.placed)&&void 0!==r?r:i.id,PgNm:i.pageNumber||1,totalPages:i.totalPages||1},i.crop?{Crop:i.crop}:{}),{frameStep:i.frameStep||{numerator:0,denominator:600},duration:i.duration||{numerator:0,denominator:600},frameCount:i.frameCount||0,Annt:16,Type:Ky.indexOf(i.type),Trnf:i.transform,nonAffineTransform:null!==(n=i.nonAffineTransform)&&void 0!==n?n:i.transform,warp:Qy(sb(i)),"Sz  ":{_name:"",_classID:"Pnt ",Wdth:i.width||0,Hght:i.height||0},Rslt:i.resolution?Kv(i.resolution,"resolution"):{units:"Density",value:72}});if(i.filter&&(o.filterFX={_name:"",_classID:"filterFXStyle",enab:i.filter.enabled,validAtPosition:i.filter.validAtPosition,filterMaskEnable:i.filter.maskEnabled,filterMaskLinked:i.filter.maskLinked,filterMaskExtendWithWhite:i.filter.maskExtendWithWhite,filterFXList:i.filter.list.map((function(e){return function(e){var t={_name:"",_classID:"filterFX","Nm  ":e.name,blendOptions:{_name:"",_classID:"blendOptions",Opct:qv(e.opacity),"Md  ":tg.encode(e.blendMode)},enab:e.enabled,hasoptions:e.hasOptions,FrgC:zv(e.foregroundColor),BckC:zv(e.backgroundColor)};switch(e.type){case"average":return By(By({},t),{filterID:1098281575});case"blur":return By(By({},t),{filterID:1114403360});case"blur more":return By(By({},t),{filterID:1114403405});case"box blur":return By(By({},t),{Fltr:{_name:"Box Blur",_classID:"boxblur","Rds ":ab(e.filter)},filterID:697});case"gaussian blur":return By(By({},t),{Fltr:{_name:"Gaussian Blur",_classID:"GsnB","Rds ":ab(e.filter)},filterID:1198747202});case"motion blur":return By(By({},t),{Fltr:{_name:"Motion Blur",_classID:"MtnB",Angl:e.filter.angle,Dstn:Kv(e.filter.distance,"distance")},filterID:1299476034});case"radial blur":return By(By({},t),{Fltr:{_name:"Radial Blur",_classID:"RdlB",Amnt:e.filter.amount,BlrM:_g.encode(e.filter.method),BlrQ:Eg.encode(e.filter.quality)},filterID:1382313026});case"shape blur":return By(By({},t),{Fltr:{_name:"Shape Blur",_classID:"shapeBlur","Rds ":ab(e.filter),customShape:{_name:"",_classID:"customShape","Nm  ":e.filter.customShape.name,Idnt:e.filter.customShape.id}},filterID:702});case"smart blur":return By(By({},t),{Fltr:{_name:"Smart Blur",_classID:"SmrB","Rds ":e.filter.radius,Thsh:e.filter.threshold,SmBQ:Cg.encode(e.filter.quality),SmBM:Sg.encode(e.filter.mode)},filterID:1399681602});case"surface blur":return By(By({},t),{Fltr:{_name:"Surface Blur",_classID:"surfaceBlur","Rds ":ab(e.filter),Thsh:e.filter.threshold},filterID:701});case"displace":return By(By({},t),{Fltr:{_name:"Displace",_classID:"Dspl",HrzS:e.filter.horizontalScale,VrtS:e.filter.verticalScale,DspM:kg.encode(e.filter.displacementMap),UndA:Tg.encode(e.filter.undefinedAreas),DspF:{sig:e.filter.displacementFile.signature,path:e.filter.displacementFile.path}},filterID:1148416108});case"pinch":return By(By({},t),{Fltr:{_name:"Pinch",_classID:"Pnch",Amnt:e.filter.amount},filterID:1349411688});case"polar coordinates":return By(By({},t),{Fltr:{_name:"Polar Coordinates",_classID:"Plr ",Cnvr:Ag.encode(e.filter.conversion)},filterID:1349284384});case"ripple":return By(By({},t),{Fltr:{_name:"Ripple",_classID:"Rple",Amnt:e.filter.amount,RplS:Mg.encode(e.filter.size)},filterID:1383099493});case"shear":return By(By({},t),{Fltr:{_name:"Shear",_classID:"Shr ",ShrP:e.filter.shearPoints.map((function(e){return{_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y}})),UndA:Tg.encode(e.filter.undefinedAreas),ShrS:e.filter.shearStart,ShrE:e.filter.shearEnd},filterID:1399353888});case"spherize":return By(By({},t),{Fltr:{_name:"Spherize",_classID:"Sphr",Amnt:e.filter.amount,SphM:Og.encode(e.filter.mode)},filterID:1399875698});case"twirl":return By(By({},t),{Fltr:{_name:"Twirl",_classID:"Twrl",Angl:e.filter.angle},filterID:1417114220});case"wave":return By(By({},t),{Fltr:{_name:"Wave",_classID:"Wave",Wvtp:Lg.encode(e.filter.type),NmbG:e.filter.numberOfGenerators,WLMn:e.filter.wavelength.min,WLMx:e.filter.wavelength.max,AmMn:e.filter.amplitude.min,AmMx:e.filter.amplitude.max,SclH:e.filter.scale.x,SclV:e.filter.scale.y,UndA:Tg.encode(e.filter.undefinedAreas),RndS:e.filter.randomSeed},filterID:1466005093});case"zigzag":return By(By({},t),{Fltr:{_name:"ZigZag",_classID:"ZgZg",Amnt:e.filter.amount,NmbR:e.filter.ridges,ZZTy:Rg.encode(e.filter.style)},filterID:1516722791});case"add noise":return By(By({},t),{Fltr:{_name:"Add Noise",_classID:"AdNs",Dstr:Ig.encode(e.filter.distribution),Nose:qv(e.filter.amount),Mnch:e.filter.monochromatic,FlRs:e.filter.randomSeed},filterID:1097092723});case"despeckle":return By(By({},t),{filterID:1148416099});case"dust and scratches":return By(By({},t),{Fltr:{_name:"Dust & Scratches",_classID:"DstS","Rds ":e.filter.radius,Thsh:e.filter.threshold},filterID:1148417107});case"median":return By(By({},t),{Fltr:{_name:"Median",_classID:"Mdn ","Rds ":ab(e.filter)},filterID:1298427424});case"reduce noise":return By(By({},t),{Fltr:{_name:"Reduce Noise",_classID:"denoise",ClNs:qv(e.filter.reduceColorNoise),Shrp:qv(e.filter.sharpenDetails),removeJPEGArtifact:e.filter.removeJpegArtifact,channelDenoise:e.filter.channelDenoise.map((function(e){return By({_name:"",_classID:"channelDenoiseParams",Chnl:e.channels.map((function(e){return Fg.encode(e)})),Amnt:e.amount},e.preserveDetails?{EdgF:e.preserveDetails}:{})})),preset:e.filter.preset},filterID:633});case"color halftone":return By(By({},t),{Fltr:{_name:"Color Halftone",_classID:"ClrH","Rds ":e.filter.radius,Ang1:e.filter.angle1,Ang2:e.filter.angle2,Ang3:e.filter.angle3,Ang4:e.filter.angle4},filterID:1131180616});case"crystallize":return By(By({},t),{Fltr:{_name:"Crystallize",_classID:"Crst",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1131574132});case"facet":return By(By({},t),{filterID:1180922912});case"fragment":return By(By({},t),{filterID:1181902701});case"mezzotint":return By(By({},t),{Fltr:{_name:"Mezzotint",_classID:"Mztn",MztT:Pg.encode(e.filter.type),FlRs:e.filter.randomSeed},filterID:1299870830});case"mosaic":return By(By({},t),{Fltr:{_name:"Mosaic",_classID:"Msc ",ClSz:Kv(e.filter.cellSize,"cellSize")},filterID:1299407648});case"pointillize":return By(By({},t),{Fltr:{_name:"Pointillize",_classID:"Pntl",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1349416044});case"clouds":return By(By({},t),{Fltr:{_name:"Clouds",_classID:"Clds",FlRs:e.filter.randomSeed},filterID:1131177075});case"difference clouds":return By(By({},t),{Fltr:{_name:"Difference Clouds",_classID:"DfrC",FlRs:e.filter.randomSeed},filterID:1147564611});case"fibers":return By(By({},t),{Fltr:{_name:"Fibers",_classID:"Fbrs",Vrnc:e.filter.variance,Strg:e.filter.strength,RndS:e.filter.randomSeed},filterID:1180856947});case"lens flare":return By(By({},t),{Fltr:{_name:"Lens Flare",_classID:"LnsF",Brgh:e.filter.brightness,FlrC:{_name:"",_classID:"Pnt ",Hrzn:e.filter.position.x,Vrtc:e.filter.position.y},"Lns ":Dg.encode(e.filter.lensType)},filterID:1282306886});case"sharpen":return By(By({},t),{filterID:1399353968});case"sharpen edges":return By(By({},t),{filterID:1399353925});case"sharpen more":return By(By({},t),{filterID:1399353933});case"smart sharpen":return By(By({},t),{Fltr:{_name:"Smart Sharpen",_classID:"smartSharpen",Amnt:qv(e.filter.amount),"Rds ":ab(e.filter),Thsh:e.filter.threshold,Angl:e.filter.angle,moreAccurate:e.filter.moreAccurate,blur:Ng.encode(e.filter.blur),preset:e.filter.preset,sdwM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:qv(e.filter.shadow.fadeAmount),Wdth:qv(e.filter.shadow.tonalWidth),"Rds ":e.filter.shadow.radius},hglM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:qv(e.filter.highlight.fadeAmount),Wdth:qv(e.filter.highlight.tonalWidth),"Rds ":e.filter.highlight.radius}},filterID:698});case"unsharp mask":return By(By({},t),{Fltr:{_name:"Unsharp Mask",_classID:"UnsM",Amnt:qv(e.filter.amount),"Rds ":ab(e.filter),Thsh:e.filter.threshold},filterID:1433301837});case"diffuse":return By(By({},t),{Fltr:{_name:"Diffuse",_classID:"Dfs ","Md  ":Bg.encode(e.filter.mode),FlRs:e.filter.randomSeed},filterID:1147564832});case"emboss":return By(By({},t),{Fltr:{_name:"Emboss",_classID:"Embs",Angl:e.filter.angle,Hght:e.filter.height,Amnt:e.filter.amount},filterID:1164796531});case"extrude":return By(By({},t),{Fltr:{_name:"Extrude",_classID:"Extr",ExtS:e.filter.size,ExtD:e.filter.depth,ExtF:e.filter.solidFrontFaces,ExtM:e.filter.maskIncompleteBlocks,ExtT:Ug.encode(e.filter.type),ExtR:zg.encode(e.filter.depthMode),FlRs:e.filter.randomSeed},filterID:1165522034});case"find edges":return By(By({},t),{filterID:1181639749});case"solarize":return By(By({},t),{filterID:1399616122});case"tiles":return By(By({},t),{Fltr:{_name:"Tiles",_classID:"Tls ",TlNm:e.filter.numberOfTiles,TlOf:e.filter.maximumOffset,FlCl:Xg.encode(e.filter.fillEmptyAreaWith),FlRs:e.filter.randomSeed},filterID:1416393504});case"trace contour":return By(By({},t),{Fltr:{_name:"Trace Contour",_classID:"TrcC","Lvl ":e.filter.level,"Edg ":Hg.encode(e.filter.edge)},filterID:1416782659});case"wind":return By(By({},t),{Fltr:{_name:"Wind",_classID:"Wnd ",WndM:Gg.encode(e.filter.method),Drct:jg.encode(e.filter.direction)},filterID:1466852384});case"de-interlace":return By(By({},t),{Fltr:{_name:"De-Interlace",_classID:"Dntr",IntE:Yg.encode(e.filter.eliminate),IntC:Wg.encode(e.filter.newFieldsBy)},filterID:1148089458});case"ntsc colors":return By(By({},t),{filterID:1314149187});case"custom":return By(By({},t),{Fltr:{_name:"Custom",_classID:"Cstm","Scl ":e.filter.scale,Ofst:e.filter.offset,Mtrx:e.filter.matrix},filterID:1131639917});case"high pass":return By(By({},t),{Fltr:{_name:"High Pass",_classID:"HghP","Rds ":ab(e.filter)},filterID:1214736464});case"maximum":return By(By({},t),{Fltr:{_name:"Maximum",_classID:"Mxm ","Rds ":ab(e.filter)},filterID:1299737888});case"minimum":return By(By({},t),{Fltr:{_name:"Minimum",_classID:"Mnm ","Rds ":ab(e.filter)},filterID:1299082528});case"offset":return By(By({},t),{Fltr:{_name:"Offset",_classID:"Ofst",Hrzn:e.filter.horizontal,Vrtc:e.filter.vertical,"Fl  ":Vg.encode(e.filter.undefinedAreas)},filterID:1332114292});case"puppet":return By(By({},t),{Fltr:{_name:"Rigid Transform",_classID:"rigidTransform",null:["Ordn.Trgt"],rigidType:e.filter.rigidType,puppetShapeList:e.filter.puppetShapeList.map((function(e){return{_name:"",_classID:"puppetShape",rigidType:e.rigidType,VrsM:1,VrsN:0,originalVertexArray:$y(new Float32Array(tb(e.originalVertexArray))),deformedVertexArray:$y(new Float32Array(tb(e.deformedVertexArray))),indexArray:$y(new Uint32Array(e.indexArray)),pinOffsets:tb(e.pinOffsets),posFinalPins:tb(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,PinP:tb(e.pinPosition),PnRt:e.pinRotation,PnOv:e.pinOverlay,PnDp:e.pinDepth,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{_name:"",_classID:"pathClass",pathComponents:e.meshBoundaryPath.pathComponents.map((function(e){return{_name:"",_classID:"PaCm",shapeOperation:"shapeOperation.".concat(e.shapeOperation),SbpL:e.paths.map((function(e){return{_name:"",_classID:"Sbpl",Clsp:e.closed,"Pts ":e.points.map((function(e){return{_name:"",_classID:"Pthp",Anch:ib(e.anchor),"Fwd ":ib(e.forward),"Bwd ":ib(e.backward),Smoo:e.smooth}}))}}))}}))},selectedPin:e.selectedPin}})),PuX0:e.filter.bounds[0].x,PuX1:e.filter.bounds[1].x,PuX2:e.filter.bounds[2].x,PuX3:e.filter.bounds[3].x,PuY0:e.filter.bounds[0].y,PuY1:e.filter.bounds[1].y,PuY2:e.filter.bounds[2].y,PuY3:e.filter.bounds[3].y},filterID:991});case"oil paint plugin":for(var r={},n=0;n<e.filter.parameters.length;n++){var i=e.filter.parameters[n],o=i.name,a=i.value,s="".concat(Uy[Math.floor(n/Uy.length)]).concat(Uy[n%Uy.length]);r["PN".concat(s)]=o,r["PT".concat(s)]=0,r["PF".concat(s)]=a}return By(By({},t),{Fltr:By({_name:"Oil Paint Plugin",_classID:"PbPl",KnNm:e.filter.name,GpuY:e.filter.gpu,LIWy:e.filter.lighting,FPth:"1"},r),filterID:1348620396});case"oil paint":return By(By({},t),{Fltr:{_name:"Oil Paint",_classID:"oilPaint",lightingOn:e.filter.lightingOn,stylization:e.filter.stylization,cleanliness:e.filter.cleanliness,brushScale:e.filter.brushScale,microBrush:e.filter.microBrush,LghD:e.filter.lightDirection,specularity:e.filter.specularity},filterID:1122});case"liquify":return By(By({},t),{Fltr:{_name:"Liquify",_classID:"LqFy",LqMe:e.filter.liquifyMesh},filterID:1282492025});default:throw new Error("Unknow filter type: ".concat(e.type))}}(e)}))}),i.warp&&Jy(i.warp)){var a=Qy(i.warp);o.quiltWarp=a,o.warp={warpStyle:"warpStyle.warpNone",warpValue:a.warpValue,warpPerspective:a.warpPerspective,warpPerspectiveOther:a.warpPerspectiveOther,warpRotate:a.warpRotate,bounds:a.bounds,uOrder:a.uOrder,vOrder:a.vOrder}}else delete o.quiltWarp;i.comp&&(o.comp=i.comp),i.compInfo&&(o.compInfo=i.compInfo),gv(e,"","null",o,o.quiltWarp?"quiltWarp":"warp")})),Hy("SoLE","SoLd"),Xy("fxrp",Gy("referencePoint"),(function(e,t){t.referencePoint={x:Am(e),y:Am(e)}}),(function(e,t){Db(e,t.referencePoint.x),Db(e,t.referencePoint.y)})),Xy("Lr16",(function(){return!1}),(function(e,t,r,n){Gm(e,n)}),(function(e,t){})),Xy("Lr32",(function(){return!1}),(function(e,t,r,n){Gm(e,n)}),(function(e,t){})),Xy("LMsk",Gy("userMask"),(function(e,t){if(t.userMask={colorSpace:ny(e),opacity:_m(e)/255},128!==bm(e))throw new Error("Invalid flag value");Bm(e,1)}),(function(e,t){var r=t.userMask;qb(e,r.colorSpace),Ob(e,255*Cp(r.opacity,0,1)),Ab(e,128),zb(e,1)})),Xy("Patt",(function(e){return!e}),(function(e,t,r){r()&&Bm(e,r())}),(function(e,t){})),Xy("Anno",(function(e){return void 0!==e.annotations}),(function(e,t,r){var n=_m(e),i=_m(e);if(2!==n||1!==i)throw new Error("Invalid Anno version");for(var o=km(e),a=[],s=0;s<o;s++){km(e);var l=Rm(e),u=!!bm(e);bm(e),_m(e);var c=lb(e),h=lb(e),d=ny(e),f=Fm(e,2),p=Fm(e,2),v=Fm(e,2);km(e),Rm(e);var g=km(e),m=void 0;if("txtA"===l)g>=2&&65279===_m(e)?m=Dm(e,(g-2)/2):(e.offset-=2,m=Nm(e,g)),m=m.replace(/\r/g,"\n");else{if("sndA"!==l)throw new Error("Unknown annotation type");m=Lm(e,g)}a.push({type:"txtA"===l?"text":"sound",open:u,iconLocation:c,popupLocation:h,color:d,author:f,name:p,date:v,data:m})}t.annotations=a,Bm(e,r())}),(function(e,t){var r=t.annotations;Ob(e,2),Ob(e,1),Fb(e,r.length);for(var n=0,i=r;n<i.length;n++){var o=i[n],a="sound"===o.type;if(a&&!(o.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!a&&"string"!=typeof o.data)throw new Error("Text annotation data should be string");var s=e.offset;Fb(e,0),Xb(e,a?"sndA":"txtA"),Ab(e,o.open?1:0),Ab(e,28),Ob(e,1),ub(e,o.iconLocation),ub(e,o.popupLocation),qb(e,o.color),Hb(e,o.author||"",2),Hb(e,o.name||"",2),Hb(e,o.date||"",2);var l=e.offset;Fb(e,0),Xb(e,a?"sndM":"txtC"),Fb(e,0);var u=e.offset;if(a)Ub(e,o.data);else{Ob(e,65279);for(var c=o.data.replace(/\n/g,"\r"),h=0;h<c.length;h++)Ob(e,c.charCodeAt(h))}e.view.setUint32(s,e.offset-s,!1),e.view.setUint32(l,e.offset-l,!1),e.view.setUint32(u-4,e.offset-u,!1)}})),Xy("lnk2",(function(e){return!!e.linkedFiles&&e.linkedFiles.length>0}),(function(e,t,r){var n=t;for(n.linkedFiles=n.linkedFiles||[];r()>8;){var i=jy(e),o=e.offset,a=Rm(e),s=Sm(e),l=Fm(e,1),u=Pm(e),c=Rm(e).trim(),h=Rm(e).trim(),d=jy(e),f=bm(e)?vv(e):void 0;"liFE"===a&&vv(e);var p={id:l,name:u};if(c&&(p.type=c),h&&(p.creator=h),f&&(p.descriptor={compInfo:{compID:f.compInfo.compID,originalCompID:f.compInfo.originalCompID}}),"liFE"===a&&s>3){var v=Sm(e),g=bm(e),m=bm(e),y=bm(e),b=bm(e),x=Am(e),w=Math.floor(x),_=1e3*(x-w);p.time=new Date(v,g,m,y,b,w,_).toISOString()}var E="liFE"===a?jy(e):0;for("liFA"===a&&Bm(e,8),"liFD"===a&&(p.data=Lm(e,d)),s>=5&&(p.childDocumentID=Pm(e)),s>=6&&(p.assetModTime=Am(e)),s>=7&&(p.assetLockedState=bm(e)),"liFE"===a&&2===s&&(p.data=Lm(e,E)),e.skipLinkedFilesData&&(p.data=void 0),n.linkedFiles.push(p);i%4;)i++;e.offset=o+i}Bm(e,r())}),(function(e,t){for(var r=0,n=t.linkedFiles;r<n.length;r++){var i=n[r],o=2;null!=i.assetLockedState?o=7:null!=i.assetModTime?o=6:null!=i.childDocumentID&&(o=5),Fb(e,0),Fb(e,0);var a=e.offset;if(Xb(e,i.data?"liFD":"liFA"),Rb(e,o),!i.id||"string"!=typeof i.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(i.id))throw new Error("Linked file ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(Hb(e,i.id,1),jb(e,i.name||""),Xb(e,i.type?"".concat(i.type,"    ").substring(0,4):"    "),Xb(e,i.creator?"".concat(i.creator,"    ").substring(0,4):"\0\0\0\0"),Yy(e,i.data?i.data.byteLength:0),i.descriptor&&i.descriptor.compInfo){var s={compInfo:{compID:i.descriptor.compInfo.compID,originalCompID:i.descriptor.compInfo.originalCompID}};Ab(e,1),gv(e,"","null",s)}else Ab(e,0);i.data?Ub(e,i.data):Yy(e,0),o>=5&&jb(e,i.childDocumentID||""),o>=6&&Db(e,i.assetModTime||0),o>=7&&Ab(e,i.assetLockedState||0);var l=e.offset-a;for(e.view.setUint32(a-4,l,!1);l%4;)l++,Ab(e,0)}})),Hy("lnkD","lnk2"),Hy("lnk3","lnk2"),Hy("lnkE","lnk2"),Xy("pths",Gy("pathList"),(function(e,t){vv(e,!0),t.pathList=[]}),(function(e,t){gv(e,"","pathsDataClass",{pathList:[]})})),Xy("lyvr",Gy("version"),(function(e,t){return t.version=km(e)}),(function(e,t){return Fb(e,t.version)})),Xy("brit",cb("brightness/contrast"),(function(e,t,r){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:wm(e),contrast:wm(e),meanValue:wm(e),labColorOnly:!!bm(e),useLegacy:!0}),Bm(e,r())}),(function(e,t){var r,n=t.adjustment;Mb(e,n.brightness||0),Mb(e,n.contrast||0),Mb(e,null!==(r=n.meanValue)&&void 0!==r?r:127),Ab(e,n.labColorOnly?1:0),zb(e,1)})),Xy("levl",cb("levels"),(function(e,t,r){if(2!==_m(e))throw new Error("Invalid levl version");t.adjustment=By(By({},t.adjustment),{type:"levels",rgb:hb(e),red:hb(e),green:hb(e),blue:hb(e)}),Bm(e,r())}),(function(e,t){var r=t.adjustment,n={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};Ob(e,2),db(e,r.rgb||n),db(e,r.red||n),db(e,r.blue||n),db(e,r.green||n);for(var i=0;i<59;i++)db(e,n)})),Xy("curv",cb("curves"),(function(e,t,r){if(bm(e),1!==_m(e))throw new Error("Invalid curv version");_m(e);var n=_m(e),i={type:"curves"};1&n&&(i.rgb=fb(e)),2&n&&(i.red=fb(e)),4&n&&(i.green=fb(e)),8&n&&(i.blue=fb(e)),t.adjustment=By(By({},t.adjustment),i),Bm(e,r())}),(function(e,t){var r=t.adjustment,n=r.rgb,i=r.red,o=r.green,a=r.blue,s=0,l=0;n&&n.length&&(s|=1,l++),i&&i.length&&(s|=2,l++),o&&o.length&&(s|=4,l++),a&&a.length&&(s|=8,l++),Ab(e,0),Ob(e,1),Ob(e,0),Ob(e,s),n&&n.length&&pb(e,n),i&&i.length&&pb(e,i),o&&o.length&&pb(e,o),a&&a.length&&pb(e,a),Xb(e,"Crv "),Ob(e,4),Ob(e,0),Ob(e,l),n&&n.length&&(Ob(e,0),pb(e,n)),i&&i.length&&(Ob(e,1),pb(e,i)),o&&o.length&&(Ob(e,2),pb(e,o)),a&&a.length&&(Ob(e,3),pb(e,a)),zb(e,2)})),Xy("expA",cb("exposure"),(function(e,t,r){if(1!==_m(e))throw new Error("Invalid expA version");t.adjustment=By(By({},t.adjustment),{type:"exposure",exposure:Tm(e),offset:Tm(e),gamma:Tm(e)}),Bm(e,r())}),(function(e,t){var r=t.adjustment;Ob(e,1),Pb(e,r.exposure),Pb(e,r.offset),Pb(e,r.gamma),zb(e,2)})),Xy("vibA",cb("vibrance"),(function(e,t,r){var n=vv(e);t.adjustment={type:"vibrance"},void 0!==n.vibrance&&(t.adjustment.vibrance=n.vibrance),void 0!==n.Strt&&(t.adjustment.saturation=n.Strt),Bm(e,r())}),(function(e,t){var r=t.adjustment,n={};void 0!==r.vibrance&&(n.vibrance=r.vibrance),void 0!==r.saturation&&(n.Strt=r.saturation),gv(e,"","null",n)})),Xy("hue2",cb("hue/saturation"),(function(e,t,r){if(2!==_m(e))throw new Error("Invalid hue2 version");t.adjustment=By(By({},t.adjustment),{type:"hue/saturation",master:vb(e),reds:vb(e),yellows:vb(e),greens:vb(e),cyans:vb(e),blues:vb(e),magentas:vb(e)}),Bm(e,r())}),(function(e,t){var r=t.adjustment;Ob(e,2),gb(e,r.master),gb(e,r.reds),gb(e,r.yellows),gb(e,r.greens),gb(e,r.cyans),gb(e,r.blues),gb(e,r.magentas)})),Xy("blnc",cb("color balance"),(function(e,t,r){t.adjustment={type:"color balance",shadows:mb(e),midtones:mb(e),highlights:mb(e),preserveLuminosity:!!bm(e)},Bm(e,r())}),(function(e,t){var r=t.adjustment;yb(e,r.shadows||{}),yb(e,r.midtones||{}),yb(e,r.highlights||{}),Ab(e,r.preserveLuminosity?1:0),zb(e,1)})),Xy("blwh",cb("black & white"),(function(e,t,r){var n=vv(e);t.adjustment={type:"black & white",reds:n["Rd  "],yellows:n.Yllw,greens:n["Grn "],cyans:n["Cyn "],blues:n["Bl  "],magentas:n.Mgnt,useTint:!!n.useTint,presetKind:n.bwPresetKind,presetFileName:n.blackAndWhitePresetFileName},void 0!==n.tintColor&&(t.adjustment.tintColor=Uv(n.tintColor)),Bm(e,r())}),(function(e,t){var r=t.adjustment;gv(e,"","null",{"Rd  ":r.reds||0,Yllw:r.yellows||0,"Grn ":r.greens||0,"Cyn ":r.cyans||0,"Bl  ":r.blues||0,Mgnt:r.magentas||0,useTint:!!r.useTint,tintColor:zv(r.tintColor),bwPresetKind:r.presetKind||0,blackAndWhitePresetFileName:r.presetFileName||""})})),Xy("phfl",cb("photo filter"),(function(e,t,r){var n,i=_m(e);if(2!==i&&3!==i)throw new Error("Invalid phfl version");n=2===i?ny(e):{l:Sm(e)/100,a:Sm(e)/100,b:Sm(e)/100},t.adjustment={type:"photo filter",color:n,density:km(e)/100,preserveLuminosity:!!bm(e)},Bm(e,r())}),(function(e,t){var r=t.adjustment;Ob(e,2),qb(e,r.color||{l:0,a:0,b:0}),Fb(e,100*(r.density||0)),Ab(e,r.preserveLuminosity?1:0),zb(e,3)})),Xy("mixr",cb("channel mixer"),(function(e,t,r){if(1!==_m(e))throw new Error("Invalid mixr version");var n=t.adjustment=By(By({},t.adjustment),{type:"channel mixer",monochrome:!!_m(e)});n.monochrome||(n.red=bb(e),n.green=bb(e),n.blue=bb(e)),n.gray=bb(e),Bm(e,r())}),(function(e,t){var r=t.adjustment;Ob(e,1),Ob(e,r.monochrome?1:0),r.monochrome?(xb(e,r.gray),zb(e,30)):(xb(e,r.red),xb(e,r.green),xb(e,r.blue),xb(e,r.gray))}));var wb=Ep("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),_b=Ep("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),Eb=Ep("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});Xy("clrL",cb("color lookup"),(function(e,t,r){if(1!==_m(e))throw new Error("Invalid clrL version");var n=vv(e);t.adjustment={type:"color lookup"};var i=t.adjustment;void 0!==n.lookupType&&(i.lookupType=wb.decode(n.lookupType)),void 0!==n["Nm  "]&&(i.name=n["Nm  "]),void 0!==n.Dthr&&(i.dither=n.Dthr),void 0!==n.profile&&(i.profile=n.profile),void 0!==n.LUTFormat&&(i.lutFormat=_b.decode(n.LUTFormat)),void 0!==n.dataOrder&&(i.dataOrder=Eb.decode(n.dataOrder)),void 0!==n.tableOrder&&(i.tableOrder=Eb.decode(n.tableOrder)),void 0!==n.LUT3DFileData&&(i.lut3DFileData=n.LUT3DFileData),void 0!==n.LUT3DFileName&&(i.lut3DFileName=n.LUT3DFileName),Bm(e,r())}),(function(e,t){var r=t.adjustment,n={};void 0!==r.lookupType&&(n.lookupType=wb.encode(r.lookupType)),void 0!==r.name&&(n["Nm  "]=r.name),void 0!==r.dither&&(n.Dthr=r.dither),void 0!==r.profile&&(n.profile=r.profile),void 0!==r.lutFormat&&(n.LUTFormat=_b.encode(r.lutFormat)),void 0!==r.dataOrder&&(n.dataOrder=Eb.encode(r.dataOrder)),void 0!==r.tableOrder&&(n.tableOrder=Eb.encode(r.tableOrder)),void 0!==r.lut3DFileData&&(n.LUT3DFileData=r.lut3DFileData),void 0!==r.lut3DFileName&&(n.LUT3DFileName=r.lut3DFileName),Ob(e,1),gv(e,"","null",n)})),Xy("nvrt",cb("invert"),(function(e,t,r){t.adjustment={type:"invert"},Bm(e,r())}),(function(){})),Xy("post",cb("posterize"),(function(e,t,r){t.adjustment={type:"posterize",levels:_m(e)},Bm(e,r())}),(function(e,t){var r;Ob(e,null!==(r=t.adjustment.levels)&&void 0!==r?r:4),zb(e,2)})),Xy("thrs",cb("threshold"),(function(e,t,r){t.adjustment={type:"threshold",level:_m(e)},Bm(e,r())}),(function(e,t){var r;Ob(e,null!==(r=t.adjustment.level)&&void 0!==r?r:128),zb(e,2)}));var Sb=["","","","rgb","hsb","","lab"];function Cb(e){return{c:wm(e),m:wm(e),y:wm(e),k:wm(e)}}function kb(e,t){var r=t||{};Mb(e,r.c),Mb(e,r.m),Mb(e,r.y),Mb(e,r.k)}function Tb(e){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return Array.isArray(e)&&e.length>1}))}Xy("grdm",cb("gradient map"),(function(e,t,r){if(1!==_m(e))throw new Error("Invalid grdm version");var n={type:"gradient map",gradientType:"solid"};n.reverse=!!bm(e),n.dither=!!bm(e),n.name=Pm(e),n.colorStops=[],n.opacityStops=[];for(var i=_m(e),o=0;o<i;o++)n.colorStops.push({location:km(e),midpoint:km(e)/100,color:ny(e)}),Bm(e,2);var a=_m(e);for(o=0;o<a;o++)n.opacityStops.push({location:km(e),midpoint:km(e)/100,opacity:_m(e)/255});if(2!==_m(e))throw new Error("Invalid grdm expansion count");var s=_m(e);if(n.smoothness=s/4096,32!==_m(e))throw new Error("Invalid grdm length");n.gradientType=_m(e)?"noise":"solid",n.randomSeed=km(e),n.addTransparency=!!_m(e),n.restrictColors=!!_m(e),n.roughness=km(e)/4096,n.colorModel=Sb[_m(e)]||"rgb",n.min=[_m(e)/32768,_m(e)/32768,_m(e)/32768,_m(e)/32768],n.max=[_m(e)/32768,_m(e)/32768,_m(e)/32768,_m(e)/32768],Bm(e,r());for(var l=0,u=n.colorStops;l<u.length;l++){u[l].location/=s}for(var c=0,h=n.opacityStops;c<h.length;c++){h[c].location/=s}t.adjustment=n}),(function(e,t){var r,n,i,o=t.adjustment;Ob(e,1),Ab(e,o.reverse?1:0),Ab(e,o.dither?1:0),jb(e,o.name||""),Ob(e,o.colorStops&&o.colorStops.length||0);for(var a=Math.round(4096*(null!==(r=o.smoothness)&&void 0!==r?r:1)),s=0,l=o.colorStops||[];s<l.length;s++){var u=l[s];Fb(e,Math.round(u.location*a)),Fb(e,Math.round(100*u.midpoint)),qb(e,u.color),zb(e,2)}Ob(e,o.opacityStops&&o.opacityStops.length||0);for(var c=0,h=o.opacityStops||[];c<h.length;c++){u=h[c];Fb(e,Math.round(u.location*a)),Fb(e,Math.round(100*u.midpoint)),Ob(e,Math.round(255*u.opacity))}Ob(e,2),Ob(e,a),Ob(e,32),Ob(e,"noise"===o.gradientType?1:0),Fb(e,o.randomSeed||0),Ob(e,o.addTransparency?1:0),Ob(e,o.restrictColors?1:0),Fb(e,Math.round(4096*(null!==(n=o.roughness)&&void 0!==n?n:1)));var d=Sb.indexOf(null!==(i=o.colorModel)&&void 0!==i?i:"rgb");Ob(e,-1===d?3:d);for(var f=0;f<4;f++)Ob(e,Math.round(32768*(o.min&&o.min[f]||0)));for(f=0;f<4;f++)Ob(e,Math.round(32768*(o.max&&o.max[f]||0)));zb(e,4)})),Xy("selc",cb("selective color"),(function(e,t){if(1!==_m(e))throw new Error("Invalid selc version");var r=_m(e)?"absolute":"relative";Bm(e,8),t.adjustment={type:"selective color",mode:r,reds:Cb(e),yellows:Cb(e),greens:Cb(e),cyans:Cb(e),blues:Cb(e),magentas:Cb(e),whites:Cb(e),neutrals:Cb(e),blacks:Cb(e)}}),(function(e,t){var r=t.adjustment;Ob(e,1),Ob(e,"absolute"===r.mode?1:0),zb(e,8),kb(e,r.reds),kb(e,r.yellows),kb(e,r.greens),kb(e,r.cyans),kb(e,r.blues),kb(e,r.magentas),kb(e,r.whites),kb(e,r.neutrals),kb(e,r.blacks)})),Xy("CgEd",(function(e){var t=e.adjustment;return!!t&&("brightness/contrast"===t.type&&!t.useLegacy||("levels"===t.type||"curves"===t.type||"exposure"===t.type||"channel mixer"===t.type||"hue/saturation"===t.type)&&void 0!==t.presetFileName)}),(function(e,t,r){var n=vv(e);if(1!==n.Vrsn)throw new Error("Invalid CgEd version");t.adjustment="presetFileName"in n?By(By({},t.adjustment),{presetKind:n.presetKind,presetFileName:n.presetFileName}):"curvesPresetFileName"in n?By(By({},t.adjustment),{presetKind:n.curvesPresetKind,presetFileName:n.curvesPresetFileName}):"mixerPresetFileName"in n?By(By({},t.adjustment),{presetKind:n.mixerPresetKind,presetFileName:n.mixerPresetFileName}):{type:"brightness/contrast",brightness:n.Brgh,contrast:n.Cntr,meanValue:n.means,useLegacy:!!n.useLegacy,labColorOnly:!!n["Lab "],auto:!!n.Auto},Bm(e,r())}),(function(e,t){var r,n,i,o,a=t.adjustment;if("levels"===a.type||"exposure"===a.type||"hue/saturation"===a.type)gv(e,"","null",{Vrsn:1,presetKind:null!==(r=a.presetKind)&&void 0!==r?r:1,presetFileName:a.presetFileName||""});else if("curves"===a.type){gv(e,"","null",{Vrsn:1,curvesPresetKind:null!==(n=a.presetKind)&&void 0!==n?n:1,curvesPresetFileName:a.presetFileName||""})}else if("channel mixer"===a.type){gv(e,"","null",{Vrsn:1,mixerPresetKind:null!==(i=a.presetKind)&&void 0!==i?i:1,mixerPresetFileName:a.presetFileName||""})}else{if("brightness/contrast"!==a.type)throw new Error("Unhandled CgEd case");gv(e,"","null",{Vrsn:1,Brgh:a.brightness||0,Cntr:a.contrast||0,means:null!==(o=a.meanValue)&&void 0!==o?o:127,"Lab ":!!a.labColorOnly,useLegacy:!!a.useLegacy,Auto:!!a.auto})}})),Xy("Txt2",Gy("engineData"),(function(e,t,r){var n=Lm(e,r());t.engineData=we(n)}),(function(e,t){Ub(e,xe(t.engineData))})),Xy("FEid",Gy("filterEffectsMasks"),(function(e,t,r){var n=Sm(e);if(n<1||n>3)throw new Error("Invalid filterEffects version ".concat(n));if(km(e))throw new Error("filterEffects: 64 bit length is not supported");var i=km(e),o=e.offset+i;for(t.filterEffectsMasks=[];e.offset<o;){var a=Fm(e,1),s=Sm(e);if(1!==s)throw new Error("Invalid filterEffect version ".concat(s));if(km(e))throw new Error("filterEffect: 64 bit length is not supported");km(e);for(var l=Sm(e),u=Sm(e),c=Sm(e),h=Sm(e),d=Sm(e),f=Sm(e),p=[],v=0;v<f+2;v++){if(Sm(e)){if(km(e))throw new Error("filterEffect: 64 bit length is not supported");var g=km(e),m=_m(e),y=Lm(e,g-2);p.push({compressionMode:m,data:y})}else p.push(void 0)}if(t.filterEffectsMasks.push({id:a,top:l,left:u,bottom:c,right:h,depth:d,channels:p}),r()&&bm(e)){m=_m(e),y=Lm(e,r());t.filterEffectsMasks[t.filterEffectsMasks.length-1].extra={compressionMode:m,data:y}}}}),(function(e,t){var r;Rb(e,3),Fb(e,0),Fb(e,0);for(var n=e.offset,i=0,o=t.filterEffectsMasks;i<o.length;i++){var a=o[i];Hb(e,a.id,1),Rb(e,1),Fb(e,0),Fb(e,0);var s=e.offset;Rb(e,a.top),Rb(e,a.left),Rb(e,a.bottom),Rb(e,a.right),Rb(e,a.depth);var l=Math.max(0,a.channels.length-2);Rb(e,l);for(var u=0;u<l+2;u++){var c=a.channels[u];Rb(e,c?1:0),c&&(Fb(e,0),Fb(e,c.data.length+2),Ob(e,c.compressionMode),Ub(e,c.data))}e.view.setUint32(s-4,e.offset-s,!1)}var h=null===(r=t.filterEffectsMasks[t.filterEffectsMasks.length-1])||void 0===r?void 0:r.extra;h&&(Ab(e,1),Ob(e,h.compressionMode),Ub(e,h.data)),e.view.setUint32(n-4,e.offset-n,!1)})),Hy("FXid","FEid"),Xy("FMsk",Gy("filterMask"),(function(e,t){t.filterMask={colorSpace:ny(e),opacity:_m(e)/255}}),(function(e,t){var r;qb(e,t.filterMask.colorSpace),Ob(e,255*Cp(null!==(r=t.filterMask.opacity)&&void 0!==r?r:1,0,1))})),Xy("artd",(function(e){return void 0!==e.artboards}),(function(e,t,r){var n=vv(e);t.artboards={count:n["Cnt "],autoExpandOffset:{horizontal:n.autoExpandOffset.Hrzn,vertical:n.autoExpandOffset.Vrtc},origin:{horizontal:n.origin.Hrzn,vertical:n.origin.Vrtc},autoExpandEnabled:n.autoExpandEnabled,autoNestEnabled:n.autoNestEnabled,autoPositionEnabled:n.autoPositionEnabled,shrinkwrapOnSaveEnabled:!!n.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:Uv(n.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:n.docDefaultNewArtboardBackgroundType},Bm(e,r())}),(function(e,t){var r,n,i,o,a,s=t.artboards;gv(e,"","null",{"Cnt ":s.count,autoExpandOffset:s.autoExpandOffset?{Hrzn:s.autoExpandOffset.horizontal,Vrtc:s.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:s.origin?{Hrzn:s.origin.horizontal,Vrtc:s.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:null===(r=s.autoExpandEnabled)||void 0===r||r,autoNestEnabled:null===(n=s.autoNestEnabled)||void 0===n||n,autoPositionEnabled:null===(i=s.autoPositionEnabled)||void 0===i||i,shrinkwrapOnSaveEnabled:null===(o=s.shrinkwrapOnSaveEnabled)||void 0===o||o,docDefaultNewArtboardBackgroundColor:zv(s.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:null!==(a=s.docDefaultNewArtboardBackgroundType)&&void 0!==a?a:1},"artd")})),Xy("lfx2",(function(e){return void 0!==e.effects&&!Tb(e.effects)}),(function(e,t,r){if(0!==km(e))throw new Error("Invalid lfx2 version");var n=vv(e);t.effects=Sv(n,!!e.logMissingFeatures),Bm(e,r())}),(function(e,t,r,n){var i=Ev(t.effects,!!n.logMissingFeatures,!0);Fb(e,0),gv(e,"","null",i)})),Xy("cinf",Gy("compositorUsed"),(function(e,t,r){var n=vv(e);function i(e){return e.split(".")[1]}t.compositorUsed={description:n.description,reason:n.reason,engine:i(n.Engn)},n.enableCompCore&&(t.compositorUsed.enableCompCore=i(n.enableCompCore)),n.enableCompCoreGPU&&(t.compositorUsed.enableCompCoreGPU=i(n.enableCompCoreGPU)),n.compCoreSupport&&(t.compositorUsed.compCoreSupport=i(n.compCoreSupport)),n.compCoreGPUSupport&&(t.compositorUsed.compCoreGPUSupport=i(n.compCoreGPUSupport)),Bm(e,r())}),(function(e,t){var r=t.compositorUsed,n={Vrsn:{major:1,minor:0,fix:0},description:r.description,reason:r.reason,Engn:"Engn.".concat(r.engine)};r.enableCompCore&&(n.enableCompCore="enable.".concat(r.enableCompCore)),r.enableCompCoreGPU&&(n.enableCompCoreGPU="enable.".concat(r.enableCompCoreGPU)),r.compCoreSupport&&(n.compCoreSupport="reason.".concat(r.compCoreSupport)),r.compCoreGPUSupport&&(n.compCoreGPUSupport="reason.".concat(r.compCoreGPUSupport)),gv(e,"","null",n)})),Xy("extn",(function(e){return void 0!==e._extn}),(function(e,t){vv(e)}),(function(e,t){})),Xy("iOpa",Gy("fillOpacity"),(function(e,t){t.fillOpacity=bm(e)/255,Bm(e,3)}),(function(e,t){Ab(e,255*t.fillOpacity),zb(e,3)})),Xy("brst",Gy("channelBlendingRestrictions"),(function(e,t,r){for(t.channelBlendingRestrictions=[];r()>4;)t.channelBlendingRestrictions.push(Sm(e))}),(function(e,t){for(var r=0,n=t.channelBlendingRestrictions;r<n.length;r++){Rb(e,n[r])}})),Xy("tsly",Gy("transparencyShapesLayer"),(function(e,t){t.transparencyShapesLayer=!!bm(e),Bm(e,3)}),(function(e,t){Ab(e,t.transparencyShapesLayer?1:0),zb(e,3)}));function Ab(e,t){var r=Vb(e,1);e.view.setUint8(r,t)}function Mb(e,t){var r=Vb(e,2);e.view.setInt16(r,t,!1)}function Ob(e,t){var r=Vb(e,2);e.view.setUint16(r,t,!1)}function Lb(e,t){var r=Vb(e,2);e.view.setUint16(r,t,!0)}function Rb(e,t){var r=Vb(e,4);e.view.setInt32(r,t,!1)}function Ib(e,t){var r=Vb(e,4);e.view.setInt32(r,t,!0)}function Fb(e,t){var r=Vb(e,4);e.view.setUint32(r,t,!1)}function Pb(e,t){var r=Vb(e,4);e.view.setFloat32(r,t,!1)}function Db(e,t){var r=Vb(e,8);e.view.setFloat64(r,t,!1)}function Nb(e,t){Rb(e,65536*t)}function Bb(e,t){Rb(e,t*(1<<24))}function Ub(e,t){t&&(Wb(e,e.offset+t.length),new Uint8Array(e.buffer).set(t,e.offset),e.offset+=t.length)}function zb(e,t){for(var r=0;r<t;r++)Ab(e,0)}function Xb(e,t){if(4!==t.length)throw new Error("Invalid signature: '".concat(t,"'"));for(var r=0;r<4;r++)Ab(e,t.charCodeAt(r))}function Hb(e,t,r){var n=t.length;if(n>255)throw new Error("String too long");Ab(e,n);for(var i=0;i<n;i++){var o=t.charCodeAt(i);Ab(e,o<128?o:"?".charCodeAt(0))}for(;++n%r;)Ab(e,0)}function Gb(e,t){Fb(e,t.length),function(e,t){for(var r=0;r<t.length;r++)Ob(e,t.charCodeAt(r))}(e,t)}function jb(e,t){Fb(e,t.length+1);for(var r=0;r<t.length;r++)Ob(e,t.charCodeAt(r));Ob(e,0)}function Yb(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),i&&Fb(e,0);var o=e.offset;Fb(e,0),r();for(var a=e.offset-o-4,s=a;e.offset%t!=0;)Ab(e,0),s++;n&&(a=s),e.view.setUint32(o,a,!1)}function Wb(e,t){t>e.buffer.byteLength&&function(e,t){var r=e.buffer.byteLength;do{r*=2}while(t>r);var n=new ArrayBuffer(r),i=new Uint8Array(n),o=new Uint8Array(e.buffer);i.set(o),e.buffer=n,e.view=new DataView(e.buffer)}(e,t)}function Vb(e,t){var r=e.offset;return Wb(e,e.offset+=t),r}function qb(e,t){t?"r"in t?(Ob(e,0),Ob(e,Math.round(257*t.r)),Ob(e,Math.round(257*t.g)),Ob(e,Math.round(257*t.b)),Ob(e,0)):"fr"in t?(Ob(e,0),Ob(e,Math.round(255*t.fr*257)),Ob(e,Math.round(255*t.fg*257)),Ob(e,Math.round(255*t.fb*257)),Ob(e,0)):"l"in t?(Ob(e,7),Mb(e,Math.round(1e4*t.l)),Mb(e,Math.round(t.a<0?12800*t.a:12700*t.a)),Mb(e,Math.round(t.b<0?12800*t.b:12700*t.b)),Ob(e,0)):"h"in t?(Ob(e,1),Ob(e,Math.round(65535*t.h)),Ob(e,Math.round(65535*t.s)),Ob(e,Math.round(65535*t.b)),Ob(e,0)):"c"in t?(Ob(e,2),Ob(e,Math.round(257*t.c)),Ob(e,Math.round(257*t.m)),Ob(e,Math.round(257*t.y)),Ob(e,Math.round(257*t.k))):(Ob(e,8),Ob(e,Math.round(1e4*t.k/255)),zb(e,6)):(Ob(e,0),zb(e,8))}var Kb,Zb,Jb,Qb;function $b(e,t,r){return J(this,void 0,void 0,(function(){var n,i,o,a,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C,k,T,A,M,O,L,R,I,F,P,D,N,B,U,z,X,H,G,j,Y,W,V,q,K,J,$,ee,te,re,ne,ie,oe,ae,se,le,ue,ce,he,de,fe,pe,ve,ge,me,ye,be,xe,we,_e,Ee,Se,Ce,ke,Te,Ae,Me,Oe,Le,Re,Ie,Fe,Pe,De,Ne;return Q(this,(function(Q){switch(Q.label){case 0:if(n=e.name,i=e.opacity,o=e.hidden,a=e.top,u=void 0===a?0:a,c=e.left,h=void 0===c?0:c,d=e.bottom,f=void 0===d?0:d,p=e.right,v=void 0===p?0:p,g=e.effects,y=o?"hidden":"visible",b=[],x=[],w=[],_=[],(m=void 0===g?{}:g).dropShadow&&m.dropShadow.forEach((function(e){var t,r,n,i,o=[Math.floor(e.color.r),Math.floor(e.color.g),Math.floor(e.color.b),null!==(t=e.opacity)&&void 0!==t?t:1],a=Zu(e.angle||0),s=(null===(r=e.distance)||void 0===r?void 0:r.value)||0,l=Math.acos(a)*s||0,u=Math.sin(a)*s||0,c=(null===(n=e.size)||void 0===n?void 0:n.value)||0,h=(null===(i=e.choke)||void 0===i?void 0:i.value)||0;b.push("".concat(Tc(o)," ").concat(l," ").concat(u," ").concat(c*(100-h)*.01," ").concat(c*h*.01)),x.push(!m.disabled&&!!e.enabled)})),m.innerShadow&&m.innerShadow.forEach((function(e){var t,r,n,i,o=[Math.floor(e.color.r),Math.floor(e.color.g),Math.floor(e.color.b),null!==(t=e.opacity)&&void 0!==t?t:1],a=Zu(e.angle||0),s=(null===(r=e.distance)||void 0===r?void 0:r.value)||0,l=Math.acos(a)*s||0,u=Math.sin(a)*s||0,c=(null===(n=e.size)||void 0===n?void 0:n.value)||0,h=(null===(i=e.choke)||void 0===i?void 0:i.value)||0;w.push("".concat(Tc(o)," ").concat(l," ").concat(u," ").concat(c*(100-h)*.01," ").concat(c*h*.01)),_.push(!m.disabled&&!!e.enabled)})),void 0===e.opened)return[3,7];if(E=[],!e.children)return[3,6];S=!1,ue=0,C=e.children.length,Q.label=1;case 1:return ue<C?[4,$b(k=e.children[ue],t,r)]:[3,6];case 2:return(ce=Q.sent())?(S&&(ce.props.style.breakMask=S,S=!1),k.mask?[4,ex(k,t,r)]:[3,4]):[3,5];case 3:(T=Q.sent())&&(E.push(T),S=!0),k.mask.disabled&&(ce.props.style.breakMask=!0),Q.label=4;case 4:E.push(ce),Q.label=5;case 5:return ue++,[3,1];case 6:return E.forEach((function(e,t){e.props.index=(t+1)/(E.length+1)})),[2,{tagName:l.GROUP,props:{uuid:s(),name:n,isExpanded:e.opened,style:{left:100*h/t+"%",top:100*u/r+"%",right:100*v/t+"%",bottom:100*f/r+"%",opacity:i,visibility:y,shadow:b,shadowEnable:x,innerShadow:w,innerShadowEnable:_}},children:E}];case 7:if(e.text){if(A=[],M=[],O=[],L=[],m.stroke&&m.stroke.forEach((function(e){var t,r;"color"===e.fillType&&(A.push(!m.disabled&&!!e.enabled),M.push(Tc([Math.floor(e.color.r),Math.floor(e.color.g),Math.floor(e.color.b),null!==(t=e.opacity)&&void 0!==t?t:1])),O.push((null===(r=e.size)||void 0===r?void 0:r.value)||1),L.push(e.position||"center"))})),R=e.text.transform||[1,0,1,0,0,0],I=[],F=e.text.style||{},P=F.font,D=(void 0===P?{}:P).name,N=void 0===D?hl.defaultFontFamily:D,B=F.fontSize,U=void 0===B?hl.defaultFontSize:B,z=F.fauxBold,X=F.fauxItalic,H=F.autoKerning,G=F.kerning,j=void 0===G?0:G,Y=F.autoLeading,W=F.leading,V=void 0===W?0:W,q=F.fillColor,K=F.underline,J=F.strikethrough,$=(e.text.paragraphStyle||{}).justification,ee=[],K&&ee.push("underline"),J&&ee.push("lineThrough"),te={fontFamily:N,fontSize:U*R[0],fontWeight:z?"bold":"normal",fontStyle:X?"italic":"normal",letterSpacing:H?0:j,textAlign:$||"left",color:Tc(q?[Math.floor(q.r),Math.floor(q.g),Math.floor(q.b)]:[0,0,0]),textDecoration:ee,paragraphSpacing:Y?0:V},re=Z(Z({left:100*(h+.5*(v-h))/t+"%",top:100*(u+.5*(f-u))/r+"%",opacity:i,visibility:y,translateX:"-50%",translateY:"-50%"},te),{stroke:M,strokeEnable:A,strokePosition:L,strokeWidth:O,shadow:b,shadowEnable:x,innerShadow:w,innerShadowEnable:_}),ne=e.text,ie=ne.styleRuns,oe=ne.paragraphStyleRuns,ie||oe)for(ae=0,se=(ie||[]).slice(0),le=(oe||[]).slice(0),ue=0;(se.length||le.length)&&!(ue++>10);)ce={location:ae,length:1,fontFamily:N,fontSize:U,fontWeight:te.fontWeight,fontStyle:te.fontStyle,letterSpacing:j,lineHeight:0,textAlign:$?{left:"left","justify-left":"left",center:"center","justify-center":"center",right:"right","justify-right":"right",justify:"justify","justify-all":"justify"}[$]:"left",color:kc(te.color),textDecoration:te.textDecoration,paragraphSpacing:V},he=-1,de=-1,se[0]&&(he=se[0].length),le[0]&&(de=le[0].length),he===de?ae+=he:(-1!==he&&-1!==de&&(he>de?he=-1:de=-1),ae+=Math.max(he,de),he>-1&&le[0]&&(le[0].length-=he),de>-1&&se[0]&&(se[0].length-=de)),he>-1&&(fe=se.shift(),pe=fe.length,ve=fe.style,ce.length=pe,ve.font&&(ce.fontFamily=ve.font.name),void 0!==ve.fauxBold&&(ce.fontWeight=ve.fauxBold?"bold":"normal"),void 0!==ve.fauxItalic&&(ce.fontStyle=ve.fauxItalic?"italic":"normal"),void 0!==ve.fontSize&&(ce.fontSize=ve.fontSize),void 0!==ve.kerning&&(ce.letterSpacing=ve.kerning),void 0!==ve.leading&&(ce.paragraphSpacing=ve.leading),ve.fillColor&&(ce.color=[Math.floor((ve.fillColor||q).r),Math.floor((ve.fillColor||q).g),Math.floor((ve.fillColor||q).b)]),void 0===ve.strikethrough&&void 0===ve.underline||(ge=[],ve.strikethrough&&ge.push("lineThrough"),ve.underline&&ge.push("underline"),ce.textDecoration=ge)),de>-1&&(me=le.shift(),ye=me.length,be=me.style,ce.length=ye,be.justification&&(ce.textAlign={left:"left","justify-left":"left",center:"center","justify-center":"center",right:"right","justify-right":"right",justify:"justify","justify-all":"justify"}[be.justification])),I.push(ce);return[2,{tagName:l.TEXT,props:{uuid:s(),name:n,style:re,content:e.text.text,rich:I}}]}if(e.vectorOrigination&&e.vectorOrigination.keyDescriptorList.length&&!e.vectorOrigination.keyDescriptorList[0].keyShapeInvalidated)return xe=e.vectorFill,we=e.vectorStroke,_e=e.vectorOrigination.keyDescriptorList,Ee=[],Se=[],Ce=[],ke=[],Te=[],Ae=[],Me=[],Oe=[],Le=[],xe&&(Ee.push(Tc([Math.floor(xe.color.r),Math.floor(xe.color.g),Math.floor(xe.color.b)])),Se.push(null===(Pe=null==we?void 0:we.fillEnabled)||void 0===Pe||Pe),Ce.push(1),ke.push("normal")),we&&(Te.push(Tc([Math.floor(we.content.color.r),Math.floor(we.content.color.g),Math.floor(we.content.color.b),null!==(De=we.opacity)&&void 0!==De?De:1])),Ae.push(!!we.strokeEnabled),Me.push((null===(Ne=we.lineWidth)||void 0===Ne?void 0:Ne.value)||1),Oe.push(we.lineAlignment||"center"),Le.push(we.blendMode||"normal")),Re=v-h,Ie=f-u,Fe=[],_e.forEach((function(e){var t=e.keyOriginRRectRadii,r=e.keyOriginShapeBoundingBox;r&&(Fe.push({x:((r.left.value||h)-h)/Re,y:((r.top.value||u)-u)/Ie,cornerRadius:(null==t?void 0:t.topLeft.value)||0,curveMode:Vs.STRAIGHT,cornerStyle:qs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),Fe.push({x:(((null==r?void 0:r.right.value)||v)-h)/Re,y:(((null==r?void 0:r.top.value)||u)-u)/Ie,cornerRadius:(null==t?void 0:t.topRight.value)||0,curveMode:Vs.STRAIGHT,cornerStyle:qs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),Fe.push({x:(((null==r?void 0:r.right.value)||v)-h)/Re,y:(((null==r?void 0:r.bottom.value)||f)-u)/Ie,cornerRadius:(null==t?void 0:t.bottomLeft.value)||0,curveMode:Vs.STRAIGHT,cornerStyle:qs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}),Fe.push({x:(((null==r?void 0:r.left.value)||h)-h)/Re,y:(((null==r?void 0:r.bottom.value)||f)-u)/Ie,cornerRadius:(null==t?void 0:t.bottomRight.value)||0,curveMode:Vs.STRAIGHT,cornerStyle:qs.ROUNDED,hasCurveFrom:!1,hasCurveTo:!1,fx:0,fy:0,tx:0,ty:0}))})),[2,{tagName:_e.length>1?l.SHAPE_GROUP:l.POLYLINE,props:{uuid:s(),name:n,style:{left:100*h/t+"%",top:100*u/r+"%",right:100*(t-v)/t+"%",bottom:100*(r-f)/r+"%",opacity:i,visibility:y,fill:Ee,fillEnable:Se,fillOpacity:Ce,fillMode:ke,stroke:Te,strokeEnable:Ae,strokePosition:Oe,strokeWidth:Me,strokeMode:Le,shadow:b,shadowEnable:x,innerShadow:w,innerShadowEnable:_},points:Fe,isClosed:!0}}];if(e.canvas)return[2,new Promise((function(o){e.canvas.toBlob((function(e){if(e)return o({tagName:l.BITMAP,props:{uuid:s(),name:n,style:{left:100*h/t+"%",top:100*u/r+"%",right:100*(t-v)/t+"%",bottom:100*(r-f)/r+"%",opacity:i,visibility:y,shadow:b,shadowEnable:x,innerShadow:w,innerShadowEnable:_},src:URL.createObjectURL(e)}});o(void 0)}))}))];Q.label=8;case 8:return[2]}}))}))}function ex(e,t,r){return J(this,void 0,void 0,(function(){var n,i,o,a,u,c,h,d,f,p,v,g,m,y;return Q(this,(function(b){return n=e.mask,i=n.top,o=void 0===i?0:i,a=n.left,u=void 0===a?0:a,c=n.bottom,h=void 0===c?0:c,d=n.right,f=void 0===d?0:d,(p=n.canvas)?(v=p,(o>e.top||u>e.left||f<e.right||h<e.bottom)&&(m=e.right-e.left,y=e.bottom-e.top,g=hl.getOffscreenCanvas(m,y),v=g.canvas,g.ctx.fillStyle="#FFF",o>e.top&&g.ctx.fillRect(0,0,m,o-e.top),h<e.bottom&&g.ctx.fillRect(0,h,m,e.bottom-h),u>e.left&&g.ctx.fillRect(0,0,u-e.left,y),f<e.right&&g.ctx.fillRect(f,0,e.right-f,y),g.ctx.drawImage(p,u-e.left,o-e.top)),[2,new Promise((function(n){v.toBlob((function(i){if(g&&g.release(),i){var o=document.createElement("img");return o.src=URL.createObjectURL(i),o.title=e.name,document.body.appendChild(o),n({tagName:l.BITMAP,props:{uuid:s(),name:e.name,style:{left:100*e.left/t+"%",top:100*e.top/r+"%",right:100*(t-e.right)/t+"%",bottom:100*(r-e.bottom)/r+"%",maskMode:"gray"},src:URL.createObjectURL(i)}})}n(void 0)}))}))]):[2]}))}))}function tx(e){return e>=Qb.REFLOW}function rx(e){return"width"===e||"height"===e||"letterSpacing"===e||"paragraphSpacing"===e||"textAlign"===e||"textVerticalAlign"===e||"fontFamily"===e||"fontSize"===e||"fontWeight"===e||"fontStyle"===e||"lineHeight"===e||"left"===e||"top"===e||"right"===e||"bottom"===e}function nx(e){return"pointerEvents"===e||"constrainProportions"===e||"isLocked"===e||"isSelected"===e||"resizesContent"===e||"isRectangle"===e?Qb.NONE:"translateX"===e?Qb.TRANSLATE_X:"translateY"===e?Qb.TRANSLATE_Y:"rotateZ"===e?Qb.ROTATE_Z:"scaleX"===e?Qb.SCALE_X:"scaleY"===e?Qb.SCALE_Y:"transformOrigin"===e||"matrix"===e?Qb.TRANSFORM:"opacity"===e?Qb.OPACITY:"blur"===e||"shadow"===e||"shadowEnable"===e||"hueRotate"===e||"saturate"===e||"brightness"===e||"contrast"===e?Qb.FILTER:"mixBlendMode"===e?Qb.MIX_BLEND_MODE:"maskMode"===e?Qb.MASK:"breakMask"===e?Qb.BREAK_MASK:rx(e)?Qb.REFLOW:Qb.REPAINT}!function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"}(Kb||(Kb={})),function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"}(Zb||(Zb={})),function(e){e[e.None=0]="None",e[e.Visibility=1]="Visibility",e[e.Position=2]="Position",e[e.Appearance=4]="Appearance"}(Jb||(Jb={})),function(e){e[e.NONE=0]="NONE",e[e.CACHE=1]="CACHE",e[e.TRANSLATE_X=2]="TRANSLATE_X",e[e.TRANSLATE_Y=4]="TRANSLATE_Y",e[e.TRANSLATE=6]="TRANSLATE",e[e.ROTATE_Z=8]="ROTATE_Z",e[e.SCALE_X=16]="SCALE_X",e[e.SCALE_Y=32]="SCALE_Y",e[e.SCALE=48]="SCALE",e[e.TRANSFORM=64]="TRANSFORM",e[e.TRANSFORM_ALL=126]="TRANSFORM_ALL",e[e.OPACITY=128]="OPACITY",e[e.FILTER=256]="FILTER",e[e.MIX_BLEND_MODE=512]="MIX_BLEND_MODE",e[e.MASK=1024]="MASK",e[e.BREAK_MASK=2048]="BREAK_MASK",e[e.REPAINT=4096]="REPAINT",e[e.REFLOW=8192]="REFLOW",e[e.REFLOW_TRANSFORM=8446]="REFLOW_TRANSFORM",e[e.REFLOW_OPACITY=8320]="REFLOW_OPACITY",e[e.REFLOW_FILTER=8448]="REFLOW_FILTER",e[e.REBUILD=16384]="REBUILD",e[e.FULL=32767]="FULL"}(Qb||(Qb={}));var ix={RefreshLevel:Qb,isRepaint:function(e){return e<Qb.REFLOW},isReflow:tx,isReflowKey:rx};function ox(e,t,r,n,i){if(void 0===n&&(n=0),void 0===i&&(i=0),t&&t.length){for(var o=-1,a=0,s=t.length;a<s;a++){var l=t[a];if(Array.isArray(l)&&l.length){o=a;break}}if(-1!==o){var u=t[o];4===u.length?e.moveTo(u[2]*r+n,u[3]*r+i):6===u.length?e.moveTo(u[4]*r+n,u[5]*r+i):e.moveTo(u[0]*r+n,u[1]*r+i);for(a=o+1,s=t.length;a<s;a++){l=t[a];Array.isArray(l)&&(2===l.length?e.lineTo(l[0]*r+n,l[1]*r+i):4===l.length?e.quadraticCurveTo(l[0]*r+n,l[1]*r+i,l[2]*r+n,l[3]*r+i):6===l.length&&e.bezierCurveTo(l[0]*r+n,l[1]*r+i,l[2]*r+n,l[3]*r+i,l[4]*r+n,l[5]*r+i))}}}}function ax(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),!e||!e.length)return"";for(var n,i=-1,o=0,a=e.length;o<a;o++){var s=e[o];if(Array.isArray(s)&&s.length){i=o;break}}if(-1===i)return"";var l=e[i];n=4===l.length?"M"+(l[2]+t)+","+(l[3]+r):6===l.length?"M"+(l[4]+t)+","+(l[5]+r):"M"+(l[0]+t)+","+(l[1]+r);for(o=i+1,a=e.length;o<a;o++){s=e[o];Array.isArray(s)&&(2===s.length?n+="L"+(s[0]+t)+","+(s[1]+r):4===s.length?n+="Q"+(s[0]+t)+","+(s[1]+r)+" "+(s[2]+t)+","+(s[3]+r):6===s.length&&(n+="C"+(s[0]+t)+","+(s[1]+r)+" "+(s[2]+t)+","+(s[3]+r)+" "+(s[4]+t)+","+(s[5]+r)))}return n}var sx,lx,ux,cx={canvasPolygon:ox,svgPolygon:ax};function hx(e,t,r){var n=function(e,t,r){var n=dx(e,e.VERTEX_SHADER,t),i=dx(e,e.FRAGMENT_SHADER,r);if(!n||!i)return null;var o=e.createProgram();if(!o)return null;o.vertexShader=n,o.fragmentShader=i,e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o);var a=e.getProgramParameter(o,e.LINK_STATUS);if(!a){var s=e.getProgramInfoLog(o);throw e.deleteProgram(o),e.deleteShader(i),e.deleteShader(n),new Error("Failed to link program: "+s)}return o}(e,t,r);if(!n)throw new Error("Failed to create program");return e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),n}function dx(e,t,r){var n=e.createShader(t);if(null===n)throw new Error("unable to create shader");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error("Failed to compile shader: "+i)}return n}function fx(e,t,r,n,i){var o=e.createTexture();if(px(e,o,t),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r)e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);else{if(!n||!i)throw new Error("Missing texImageSource or w/h");e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,i,0,e.RGBA,e.UNSIGNED_BYTE,null)}return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),o}function px(e,t,r){e.activeTexture(e["TEXTURE"+r]),e.bindTexture(e.TEXTURE_2D,t)}function vx(e,t,r,n,i,o,a,s,l,u,c,h){void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=!0),void 0===l&&(l=-1),void 0===u&&(u=-1),void 0===c&&(c=1),void 0===h&&(h=1);var d=i.length;if(d){var f,p,v,g=1===d,m=g?8:12*d,y=g?4:6*d;f=sx&&sx.length===m?sx:sx=new Float32Array(m),p=lx&&lx.length===m?lx:lx=new Float32Array(m),v=ux&&ux.length===y?ux:ux=new Float32Array(y);for(var b=0,x=i.length;b<x;b++){var w=i[b],_=w.opacity,E=w.matrix,S=w.bbox,C=w.coords,k=w.tc;px(e,w.texture,0);var T=C?Ax(C,o,a):Tx(S,t,r,o,a,s,E),A=T.t1,M=T.t2,O=T.t3,L=T.t4,R=12*b;f[R]=A.x,f[R+1]=A.y,f[R+2]=L.x,f[R+3]=L.y,f[R+4]=M.x,f[R+5]=M.y,g?(f[R+6]=O.x,f[R+7]=O.y):(f[R+6]=L.x,f[R+7]=L.y,f[R+8]=M.x,f[R+9]=M.y,f[R+10]=O.x,f[R+11]=O.y),k?(p[R]=k.x1,p[R+1]=k.y1,p[R+2]=k.x1,p[R+3]=k.y3,p[R+4]=k.x3,p[R+5]=k.y1,g?(p[R+6]=k.x3,p[R+7]=k.y3):(p[R+6]=k.x1,p[R+7]=k.y3,p[R+8]=k.x3,p[R+9]=k.y1,p[R+10]=k.x3,p[R+11]=k.y3)):(p[R]=0,p[R+1]=0,p[R+2]=0,p[R+3]=1,p[R+4]=1,p[R+5]=0,g?(p[R+6]=1,p[R+7]=1):(p[R+6]=0,p[R+7]=1,p[R+8]=1,p[R+9]=0,p[R+10]=1,p[R+11]=1)),v[R=6*b]=_,v[R+1]=_,v[R+2]=_,v[R+3]=_,g||(v[R+4]=_,v[R+5]=_)}var I=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,I),e.bufferData(e.ARRAY_BUFFER,f,e.STATIC_DRAW);var F=e.getAttribLocation(n,"a_position");e.vertexAttribPointer(F,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(F);var P=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,P),e.bufferData(e.ARRAY_BUFFER,p,e.STATIC_DRAW);var D=e.getAttribLocation(n,"a_texCoords");e.vertexAttribPointer(D,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(D);var N=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,N),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW);var B=e.getAttribLocation(n,"a_opacity");e.vertexAttribPointer(B,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(B);var U=e.getUniformLocation(n,"u_texture");e.uniform1i(U,0);var z=e.getUniformLocation(n,"x1");e.uniform1f(z,l);var X=e.getUniformLocation(n,"y1");e.uniform1f(X,u);var H=e.getUniformLocation(n,"x2");e.uniform1f(H,c);var G=e.getUniformLocation(n,"y2");e.uniform1f(G,h),e.drawArrays(g?e.TRIANGLE_STRIP:e.TRIANGLES,0,y),e.deleteBuffer(I),e.deleteBuffer(P),e.deleteBuffer(N),e.disableVertexAttribArray(F),e.disableVertexAttribArray(D),e.disableVertexAttribArray(B)}}function gx(e,t){var r=function(){var e=new Float32Array(8),t=new Float32Array(8);return e[0]=-1,e[1]=-1,e[2]=-1,e[3]=1,e[4]=1,e[5]=-1,e[6]=1,e[7]=1,t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=1,t[5]=0,t[6]=1,t[7]=1,{vtPoint:e,vtTex:t}}(),n=r.vtPoint,i=r.vtTex,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);var a=e.getAttribLocation(t,"a_position");e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a);var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);var l=e.getAttribLocation(t,"a_texCoords");return e.vertexAttribPointer(l,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(l),{pointBuffer:o,a_position:a,texBuffer:s,a_texCoords:l}}function mx(e,t,r,n){var i=gx(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;px(e,r,0),px(e,n,1);var u=e.getUniformLocation(t,"u_texture1");e.uniform1i(u,0);var c=e.getUniformLocation(t,"u_texture2");e.uniform1i(c,1),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}function yx(e,t,r,n,i,o){var a=gx(e,t),s=a.pointBuffer,l=a.a_position,u=a.texBuffer,c=a.a_texCoords,h=e.getUniformLocation(t,"u_texture"),d=e.getUniformLocation(t,"u_pw"),f=e.getUniformLocation(t,"u_ph");e.uniform1f(d,1/n),e.uniform1f(f,1/i);for(var p=e.getUniformLocation(t,"u_direction"),v=e.getUniformLocation(t,"u_r"),g=r,m=fx(e,0,void 0,n,i),y=fx(e,0,void 0,n,i),b=0,x=o.length;b<x;b++){var w=o[b]-1>>1;e.uniform1i(v,w),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,m,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),px(e,g,0),e.uniform1i(h,0),e.uniform1i(p,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,y,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),px(e,m,0),e.uniform1i(p,1),e.drawArrays(e.TRIANGLE_STRIP,0,4),g=y}return e.deleteBuffer(s),e.deleteBuffer(u),e.disableVertexAttribArray(l),e.disableVertexAttribArray(c),e.deleteTexture(m),y}function bx(e,t,r,n,i,o,a,s){void 0===s&&(s=1);var l=gx(e,t),u=l.pointBuffer,c=l.a_position,h=l.texBuffer,d=l.a_texCoords,f=e.getUniformLocation(t,"u_x"),p=e.getUniformLocation(t,"u_y");e.uniform1f(f,s/n),e.uniform1f(p,s/i);var v=fx(e,0,void 0,o,a),g=e.getUniformLocation(t,"u_texture");return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),px(e,r,0),e.uniform1i(g,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(u),e.deleteBuffer(h),e.disableVertexAttribArray(c),e.disableVertexAttribArray(d),v}function xx(e,t,r,n,i,o,a){var s=gx(e,t),l=s.pointBuffer,u=s.a_position,c=s.texBuffer,h=s.a_texCoords,d=e.getUniformLocation(t,"u_kernel");e.uniform1i(d,n);var f=Math.sin(i)*n/a,p=Math.cos(i)*n/o,v=e.getUniformLocation(t,"u_velocity");e.uniform2f(v,p,f);for(var g=e.getUniformLocation(t,"u_texture"),m=r,y=fx(e,0,void 0,o,a),b=fx(e,0,void 0,o,a),x=0;x<3;x++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,[y,b,y][x],0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),px(e,[m,y,b][x],0),e.uniform1i(g,0),e.drawArrays(e.TRIANGLE_STRIP,0,4);return e.deleteBuffer(l),e.deleteBuffer(c),e.disableVertexAttribArray(u),e.disableVertexAttribArray(h),e.deleteTexture(b),y}function wx(e,t,r,n,i,o,a,s){var l=gx(e,t),u=l.pointBuffer,c=l.a_position,h=l.texBuffer,d=l.a_texCoords,f=e.getUniformLocation(t,"u_kernel");e.uniform1i(f,i);var p=e.getUniformLocation(t,"u_center");e.uniform2f(p,o[0],o[1]);var v=e.getUniformLocation(t,"u_ratio");e.uniform1f(v,n);for(var g=r,m=[],y=0;y<1;y++){var b=fx(e,0,void 0,a,s);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0),px(e,g,0);var x=e.getUniformLocation(t,"u_texture");e.uniform1i(x,0),e.drawArrays(e.TRIANGLE_STRIP,0,4),m.push(g),g=b}return e.deleteBuffer(u),e.deleteBuffer(h),e.disableVertexAttribArray(c),e.disableVertexAttribArray(d),m.forEach((function(t){t!==r&&e.deleteTexture(t)})),g}function _x(e,t,r,n){var i=gx(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;px(e,r,0);var u=e.getUniformLocation(t,"u_texture");e.uniform1i(u,0);var c=e.getUniformLocation(t,"u_color"),h=n[3];e.uniform4f(c,n[0]*h,n[1]*h,n[2]*h,h),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}var Ex=mx;function Sx(e,t,r,n,i){var o=gx(e,t),a=o.pointBuffer,s=o.a_position,l=o.texBuffer,u=o.a_texCoords;px(e,r,0);var c=e.getUniformLocation(t,"u_texture");e.uniform1i(c,0);var h=e.getUniformLocation(t,"u_tint"),d=Oc(n);d[3]*=i,e.uniform4f(h,d[0]*d[3],d[1]*d[3],d[2]*d[3],d[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(a),e.deleteBuffer(l),e.disableVertexAttribArray(s),e.disableVertexAttribArray(u)}function Cx(e,t,r,n){var i=gx(e,t),o=i.pointBuffer,a=i.a_position,s=i.texBuffer,l=i.a_texCoords;px(e,r,0);var u=e.getUniformLocation(t,"u_texture");e.uniform1i(u,0);var c=e.getUniformLocation(t,"u_m[0]");e.uniform1fv(c,new Float32Array(n)),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(o),e.deleteBuffer(s),e.disableVertexAttribArray(a),e.disableVertexAttribArray(l)}function kx(e,t,r,n,i){return void 0===i&&(i=!1),{x:e=e===r?0:(e-r)/r,y:t=t===n?0:i?(n-t)/n:(t-n)/n}}function Tx(e,t,r,n,i,o,a){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=!0);var s=gu(e[0],e[1],e[2],e[3],a),l=s.x1,u=s.y1,c=s.x2,h=s.y2,d=s.x3,f=s.y3,p=s.x4,v=s.y4;return{t1:kx(l+n,u+i,t,r,o),t2:kx(c+n,h+i,t,r,o),t3:kx(d+n,f+i,t,r,o),t4:kx(p+n,v+i,t,r,o)}}function Ax(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),t||r){var n=e.t1,i=e.t2,o=e.t3,a=e.t4;return{t1:{x:n.x+t,y:n.y+r},t2:{x:i.x+t,y:i.y+r},t3:{x:o.x+t,y:o.y+r},t4:{x:a.x+t,y:a.y+r}}}return e}var Mx,Ox=512,Lx=0,Rx=function(){function e(e,t,r,n){this.uuid=Lx++,this.available=!1,this.complete=!1,this.count=0,this.needClear=!1,this.nodes=[],this.x=t,this.y=r,this.size=n,this.gl=e,this.bbox=new Float64Array([0,0,0,0]),this.x1=this.y1=-1,this.x2=this.y2=1}return e.prototype.init=function(e){void 0===e&&(e=1),this.available||(this.available=!0,this.complete=!1,this.count=0,this.texture=fx(this.gl,0,void 0,Ox*e,Ox*e))},e.prototype.clean=function(){var e=this;this.count&&(this.count=0,this.needClear=!0),this.complete=!1;var t=this.nodes.splice(0);return t.forEach((function(t){return t.removeTile(e)})),t},e.prototype.add=function(e){-1===this.nodes.indexOf(e)&&(this.nodes.push(e),e.addTile(this),this.count++)},e.prototype.has=function(e){return this.nodes.indexOf(e)>-1},e.prototype.remove=function(e){var t=this.nodes.indexOf(e);t>-1&&(this.nodes.splice(t,1),e.removeTile(this),this.count--,this.complete=!1)},e.prototype.updateTex=function(e){this.texture&&this.gl.deleteTexture(this.texture),this.texture=e},e.prototype.destroy=function(){this.available=!1,this.complete=!1,this.count=0,this.texture&&(this.gl.deleteTexture(this.texture),this.texture=void 0)},e.prototype.toString=function(){return this.uuid+": "+this.available+","+this.complete+"; "+this.x+","+this.y+","+(this.x+Ox)+","+(this.y+Ox)+"; "+this.bbox.map((function(e){return Math.round(e)})).join(",")},Object.defineProperty(e,"UNIT",{get:function(){return Ox},set:function(e){for(var t=e,r=0;t>0;)t>>=1,r++;for(t=0;r>0;)r--,t<<=1;if(t<32)throw new Error("The UNIT of Tile muse be a power of 2 and the minimum is 32");Ox=t},enumerable:!1,configurable:!0}),e.clean=function(e){e.forEach((function(e){return e.clean()}))},e}(),Ix=function(){function e(e){this.gl=e,this.hash=new WeakMap,this.data=[]}return e.prototype.setPage=function(e){this.hash.has(e)?this.data=this.hash.get(e):(this.data=[],this.hash.set(e,this.data))},e.prototype.active=function(e,t,r,n,i){if(!n||!i)return[];var o=Math.round(Rx.UNIT/e),a=this.getTable(e),s=[];if(a.length){for(var l=a[0][0],u=t-l.x,c=r-l.y,h=Math.round(u/o),d=Math.round(c/o);d<0;)a.unshift([new Rx(this.gl,l.x,l.y-o,o)]),l=a[0][0],d++;for(;h<0;){v=0;for(var f=a.length;v<f;v++){if((g=a[v]=a[v]||[]).length){y=g[0];g.unshift(new Rx(this.gl,y.x-o,y.y,o))}}h++}l=a[0][0];for(v=d;v<d+i;v++)for(g=a[v]=a[v]||[],m=h;m<h+n;m++)if(g[m])s.push(g[m]);else{y=new Rx(this.gl,l.x+m*o,l.y+v*o,o);g[m]=y;for(var p=m-1;p>=0&&!g[p];p--)g[p]=new Rx(this.gl,l.x+p*o,l.y+v*o,o);s.push(y)}}else for(var v=0;v<i;v++){for(var g=[],m=0;m<n;m++){var y=new Rx(this.gl,t+m*o,r+v*o,o);g.push(y),s.push(y)}a.push(g)}return s},e.prototype.getTable=function(e){for(var t=0,r=this.data.length;t<r;t++){var n=this.data[t];if(n.scale===e)return n.table;if(n.scale>e){var i={scale:e,table:[]};return this.data.splice(t,0,i),i.table}}var o={scale:e,table:[]};return this.data.push(o),o.table},e.prototype.getDowngrade=function(e,t,r){for(var n=0,i=this.data.length;n<i;n++){if(this.data[n].scale===e){for(var o=n-1;o>=0;o--)for(var a=this.data[o],s=a.scale,l=0,u=(f=a.table).length;l<u;l++){if((y=f[l]).length)if((b=y[0]).y===r||b.y<r&&b.y+b.size>r)for(var c=0,h=y.length;c<h;c++){if(((_=y[c]).x===t||_.x<t&&_.x+_.size>t)&&_.available&&_.count)return[{scale:s,tile:_}];if(_.x>t)break}else if(b.y>r)break}for(o=n+1;o<i;o++){for(var d=this.data[o],f=(s=d.scale,d.table),p=Rx.UNIT/e,v=[],g=0,m=f.length;g<m;g++){var y,b;if((y=f[g]).length)if((b=y[0]).y>=r&&b.y<r+p)for(var x=0,w=y.length;x<w;x++){var _;if((_=y[x]).x>=t&&_.x<t+p&&_.available&&_.count)v.push({scale:s,tile:_});else if(_.x>=t+p)break}else if(b.y>=r+p)break}if(v.length)return v}break}}},e}(),Fx={level:ix,paint:cx,Tile:Rx,TileManager:Ix},Px={font:Hl,transform:hc,define:vl,css:Hc,gradient:wc},Dx=function(){function e(){this.__eHash={}}return e.prototype.on=function(e,t){if(Es(t)){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)this.on(e[r],t);else{this.__eHash.hasOwnProperty(e)||(this.__eHash[e]=[]);r=0;var i=this.__eHash[e];for(n=i.length;r<n;r++)if(i[r]===t)return this;this.__eHash[e].push(t)}return this}},e.prototype.once=function(e,t){var r=this;if(Es(t)){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)this.once(e[n],t);else{var o=function(){t.apply(r,Array.prototype.slice.call(arguments)),r.off(e,o)};if(o.__eventCb=t,Array.isArray(e))for(n=0,i=e.length;n<i;n++)this.once(e[n],t);else this.on(e,o)}return this}},e.prototype.off=function(e,t){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)this.off(e[r],t);else if(this.__eHash.hasOwnProperty(e))if(t){r=0;var i=this.__eHash[e];for(n=i.length;r<n;r++)if(i[r]===t||i[r].__eventCb===t){i.splice(r,1);break}}else delete this.__eHash[e];return this},e.prototype.emit=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return Array.isArray(e)||(e=[e]),e.forEach((function(e){if(e&&t.__eHash.hasOwnProperty(e)){var n=t.__eHash[e];if(n.length)for(var i=0,o=(n=n.slice()).length;i<o;i++){var a=n[i];Es(a)&&a.apply(t,r)}}})),this},e.REFRESH="REFRESH",e.REFRESH_COMPLETE="REFRESH_COMPLETE",e.DID_ADD_DOM="DID_ADD_DOM",e.WILL_REMOVE_DOM="WILL_REMOVE_DOM",e.STYLE_CHANGED="STYLE_CHANGED",e.DID_ADD_PAGE="DID_ADD_PAGE",e.WILL_REMOVE_PAGE="WILL_REMOVE_PAGE",e}(),Nx={type:Fs,Event:Dx,inject:hl,opentype:Nl,config:ms};var Bx=function(){function e(){this.rootTask=[],this.roots=[],this.task=[],this.now=hl.now(),this.id=0}return e.prototype.init=function(){var e=this,t=this.task;hl.cancelAnimationFrame(this.id);var r=this.now=hl.now(),n=function(){hl.cancelAnimationFrame(e.id),e.id=hl.requestAnimationFrame((function(){var i=e.now=hl.now();if(!Mx&&t.length){var o=i-r;o=Math.max(o,0),r=i;var a=t.slice(0),s=a.length;!function(e,t,r){for(var n=0;n<t;n++){var i=e[n];i.before&&i.before(r)}}(a,s,o),function(e,t,r){for(var n=0;n<t;n++)e[n].after(r)}(a,s,o),t.length&&n()}}))};n()},e.prototype.onFrame=function(e){if(e){var t=this.task;t.length||this.init(),Es(e)&&(e={after:e,ref:e}),t.push(e)}},e.prototype.offFrame=function(e){if(e){for(var t=this.task,r=0,n=t.length;r<n;r++){var i=t[r];if(i===e||i.ref===e){t.splice(r,1);break}}t.length||(hl.cancelAnimationFrame(this.id),this.now=0)}},e.prototype.nextFrame=function(e){var t=this;if(e){var r=Es(e)?{after:function(n){e(n),t.offFrame(r)}}:{before:e.before,after:function(n){e.after&&e.after(n),t.offFrame(r)}};r.ref=e,this.onFrame(r)}},e.prototype.pause=function(){Mx=!0},e.prototype.resume=function(){Mx&&(this.init(),Mx=!1)},e.prototype.addRoot=function(e){this.roots.push(e)},e.prototype.removeRoot=function(e){var t=this.roots.indexOf(e);t>-1&&this.roots.splice(t,1)},e}(),Ux=new Bx,zx={frame:Ux};function Xx(e){if(e<=0)return 0;var t=Math.floor(3*e*Math.sqrt(2*Math.PI)/4+.5);return t<2&&(t=2),t%2==0&&t++,t}function Hx(e){return 3*Math.floor(.5*e)}function Gx(e,t){void 0===t&&(t=3);var r=Math.sqrt(12*e*e/t+1),n=Math.floor(r);n%2==0&&n--;for(var i=n+2,o=(12*e*e-t*n*n-4*t*n-3*t)/(-4*n-4),a=Math.round(o),s=[],l=0;l<t;l++)s.push(l<a?n:i);return s}var jx={},Yx=function(){function e(e,t,r){this.gl=e,this.available=!0,this.bbox=t.slice(0);var n=t[2],i=t[3];if(this.list=[],r)for(var o=r.list,a=r.w,s=r.h,l=o.length,u=(t[2]-t[0])/a,c=(t[3]-t[1])/s,h=0;h<l;h++){var d=o[h],f=fx(e,0,d.os.canvas);this.list.push({bbox:new Float64Array([d.x*u,d.y*c,Math.min(n,(d.x+d.w)*u),Math.min(i,(d.y+d.h)*c)]),w:d.w,h:d.h,t:f})}}return e.prototype.release=function(){var e=this;this.available&&(this.available=!1,this.list.splice(0).forEach((function(t){return e.gl.deleteTexture(t.t)})))},e.prototype.releaseImg=function(e,t){var r=this;if(this.available){this.available=!1;var n=jx[e],i=n[t];i&&(i.count--,i.count||(delete n[t],this.list.splice(0).forEach((function(e){return r.gl.deleteTexture(e.t)}))))}},e.getInstance=function(t,r,n){return new e(t,n,r)},e.hasImgInstance=function(e,t){if(jx.hasOwnProperty(e)&&jx[e].hasOwnProperty(t))return!0;return!1},e.getImgInstance=function(t,r,n,i,o){if(jx.hasOwnProperty(t)){var a=jx[t];if(a.hasOwnProperty(n)){var s=a[n];s.count++;for(var l=new e(r,i),u=i[2]-i[0],c=i[3]-i[1],h=u/s.w,d=c/s.h,f=i[2],p=i[3],v=s.value,g=v.length,m=0;m<g;m++){var y=v[m];l.list.push({bbox:new Float64Array([y.x*h,y.y*d,Math.min(f,(y.x+y.w)*h),Math.min(p,(y.y+y.h)*d)]),w:y.w,h:y.h,t:y.t})}return l}}var b=jx[t]=jx[t]||{},x=new e(r,i,o);return b[n]={value:x.list.map((function(e,t){return{x:o.list[t].x,y:o.list[t].y,w:e.w,h:e.h,t:e.t}})),w:o.w,h:o.h,count:1},x},e.getEmptyInstance=function(t,r){return new e(t,r)},e}(),Wx=function(e){function t(t){var r=e.call(this)||this;return r.isGroup=!1,r.isArtBoard=!1,r.isSymbolMaster=!1,r.isSymbolInstance=!1,r.isPage=!1,r.isText=!1,r.isGeom=!1,r.isPolyline=!1,r.isBitmap=!1,r.isShapeGroup=!1,r.isContainer=!1,r.isSlice=!1,r.props=t,r.props.uuid=r.props.uuid||s(),r.style=_c(d(t.style)),r.computedStyle={},r.width=0,r.height=0,r.minWidth=.5,r.minHeight=.5,r.isDestroyed=!0,r.struct={node:r,num:0,total:0,lv:0,next:0},r.refreshLevel=Qb.REFLOW,r._opacity=1,r.hasCacheOp=!1,r.localOpId=0,r.parentOpId=0,r.transform=ru(),r.matrix=ru(),r._matrixWorld=ru(),r.hasCacheMw=!1,r.localMwId=0,r.parentMwId=0,r.hasContent=!1,r.textureCache=[],r.textureTotal=[],r.textureFilter=[],r.textureMask=[],r.textureTarget=[],r.textureOutline=[],r.tempOpacity=1,r.tempMatrix=ru(),r.tempIndex=0,r.tileList=[],r}return v(t,e),t.prototype.willMount=function(){this.isDestroyed=!1;var e=this.parent;if(e){this.parentOpId=e.localOpId,this.parentMwId=e.localMwId;var t=this.root=e.root;this.isPage||(this.page=e.page),this.isArtBoard||(this.artBoard=e.artBoard),this.isSymbolInstance||(this.symbolInstance=e.symbolInstance);var r=this.props.uuid;r&&(t.refs[r]=this)}},t.prototype.didMount=function(){},t.prototype.lay=function(e){this.refreshLevel=Qb.REFLOW,this.calReflowStyle();var t=this.style,r=this.computedStyle,n=t.left,i=t.top,o=t.right,a=t.bottom,s=t.width,l=t.height,u=!1,c=!1,h=!1,d=!1;n.u!==Us.AUTO&&(u=!0,r.left=Dc(n,e.w)),o.u!==Us.AUTO&&(h=!0,r.right=Dc(o,e.w)),i.u!==Us.AUTO&&(c=!0,r.top=Dc(i,e.h)),a.u!==Us.AUTO&&(d=!0,r.bottom=Dc(a,e.h)),u&&h?this.width=r.width=Math.max(this.minWidth,e.w-r.left-r.right):u?(s.u!==Us.AUTO?this.width=r.width:this.width=this.minWidth,r.right=e.w-r.left-this.width):h&&(s.u!==Us.AUTO?this.width=r.width:this.width=this.minWidth,r.left=e.w-r.right-this.width),c&&d?this.height=r.height=Math.max(this.minHeight,e.h-r.top-r.bottom):c?(l.u!==Us.AUTO?this.height=r.height:this.height=this.minHeight,r.bottom=e.h-r.top-this.height):d&&(l.u!==Us.AUTO?this.height=r.height:this.height=this.minHeight,r.top=e.h-r.bottom-this.height)},t.prototype.layout=function(e){this.isDestroyed||(this.lay(e),this.calRepaintStyle(Qb.REFLOW),this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this._rect=void 0)},t.prototype.insertAfter=function(e,t){e.remove();var r=this.root,n=this.parent;if(!n)throw new Error("Can not appendSelf without parent");e.parent=n,e.prev=this,this.next?(e.props.index=.5*(this.next.props.index+this.props.index),this.next.prev=e):e.props.index=.5*(this.props.index+1),e.next=this.next,this.next=e,e.root=r;var i=n.children,o=i.indexOf(this);i.splice(o+1,0,e),n.isDestroyed?t&&t(!0):(e.willMount(),n.insertStruct(e,o+1),r.addUpdate(e,[],Qb.REFLOW,!0,!1,(function(r){!r&&e.page&&e.didMount(),t&&t(r)})))},t.prototype.insertBefore=function(e,t){e.remove();var r=this.root,n=this.parent;if(!n)throw new Error("Can not prependBefore without parent");e.parent=n,e.prev=this.prev,this.prev?(e.props.index=.5*(this.prev.props.index+this.props.index),this.prev.next=e):e.props.index=.5*this.props.index,e.next=this,this.prev=e,e.root=r;var i=n.children,o=i.indexOf(this);i.splice(o,0,e),n.isDestroyed?t&&t(!0):(e.willMount(),n.insertStruct(e,o),r.addUpdate(e,[],Qb.REFLOW,!0,!1,(function(r){!r&&e.page&&e.didMount(),t&&t(r)})))},t.prototype.calReflowStyle=function(){var e=this,t=e.style,r=e.computedStyle,n=e.parent;r.fontFamily=t.fontFamily.v,r.fontSize=t.fontSize.v,r.fontWeight=t.fontWeight.v,r.fontStyle=t.fontStyle.v;var i=t.lineHeight;i.u===Us.AUTO?r.lineHeight=Ic(r):r.lineHeight=i.v,this.width=this.height=0;var o=t.width,a=t.height;n&&(o.u!==Us.AUTO&&(this.width=r.width=Math.max(this.minWidth,Dc(o,n.width))),a.u!==Us.AUTO&&(this.height=r.height=Math.max(this.minHeight,Dc(a,n.height)))),r.letterSpacing=t.letterSpacing.v,r.paragraphSpacing=t.paragraphSpacing.v,r.textAlign=t.textAlign.v,r.textVerticalAlign=t.textVerticalAlign.v},t.prototype.calRepaintStyle=function(e){var t=this.style,r=this.computedStyle;r.visibility=t.visibility.v,r.color=t.color.v,r.backgroundColor=t.backgroundColor.v,r.fill=t.fill.map((function(e){var t,r;if(Array.isArray(e.v))return e.v.slice(0);var n=e.v;if(n&&void 0!==n.url)return{url:n.url,type:n.type,scale:.01*(null!==(r=null===(t=n.scale)||void 0===t?void 0:t.v)&&void 0!==r?r:100)};var i=e.v;return{t:i.t,d:i.d.slice(0),stops:i.stops.map((function(e){var t=.01*e.offset.v;return{color:e.color.v.slice(0),offset:t}}))}})),r.fillEnable=t.fillEnable.map((function(e){return e.v})),r.fillOpacity=t.fillOpacity.map((function(e){return e.v})),r.fillMode=t.fillMode.map((function(e){return e.v})),r.fillRule=t.fillRule.v,r.stroke=t.stroke.map((function(e){if(Array.isArray(e.v))return e.v.slice(0);var t=e.v;return{t:t.t,d:t.d.slice(0),stops:t.stops.map((function(e){var t=e.offset?.01*e.offset.v:void 0;return{color:e.color.v.slice(0),offset:t}}))}})),r.strokeEnable=t.strokeEnable.map((function(e){return e.v})),r.strokeWidth=t.strokeWidth.map((function(e){return e.v})),r.strokePosition=t.strokePosition.map((function(e){return e.v})),r.strokeMode=t.strokeMode.map((function(e){return e.v})),r.strokeDasharray=t.strokeDasharray.map((function(e){return e.v})),r.strokeLinecap=t.strokeLinecap.v,r.strokeLinejoin=t.strokeLinejoin.v,r.strokeMiterlimit=t.strokeMiterlimit.v,r.booleanOperation=t.booleanOperation.v,r.mixBlendMode=t.mixBlendMode.v,r.pointerEvents=t.pointerEvents.v,e&(Qb.MASK|Qb.REFLOW|Qb.REPAINT)&&this.calMask(),r.innerShadow=t.innerShadow.map((function(e){var t=e.v;return{x:t.x.v,y:t.y.v,blur:t.blur.v,spread:t.spread.v,color:t.color.v}})),r.innerShadowEnable=t.innerShadowEnable.map((function(e){return e.v})),r.textDecoration=t.textDecoration.map((function(e){return e.v})),e&Qb.REFLOW_TRANSFORM&&this.calMatrix(e),e&Qb.REFLOW_OPACITY&&this.calOpacity(),e&Qb.REFLOW_FILTER&&this.calFilter(e),this.clearCache(!0),this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0},t.prototype.calMask=function(){var e=this.style,t=this.computedStyle;t.maskMode=e.maskMode.v,t.breakMask=e.breakMask.v;var r=this.prev;if(r&&!t.breakMask&&(r.computedStyle.maskMode?this.mask=r:r.mask&&(this.mask=r.mask)),t.maskMode){this.mask=void 0;for(var n=this.next;n;){if(n.computedStyle.maskMode){n.mask=this;break}if(n.computedStyle.breakMask)break;n.mask=this,n=n.next}}else{var i=t.breakMask?void 0:this.mask;this.mask=i;for(n=this.next;n;){if(n.computedStyle.maskMode){n.mask=i;break}if(n.computedStyle.breakMask)break;n.mask=i,n=n.next}}},t.prototype.calFilter=function(e){var t,r,n,i=this.style,o=this.computedStyle,a=i.blur.v;o.blur={t:a.t,radius:(null===(t=a.radius)||void 0===t?void 0:t.v)||0,center:a.center?a.center.map((function(e){return.01*e.v})):[.5,.5],saturation:.01*(null!==(n=null===(r=a.saturation)||void 0===r?void 0:r.v)&&void 0!==n?n:100),angle:a.angle?a.angle.v:0},o.shadow=i.shadow.map((function(e){var t=e.v;return{x:t.x.v,y:t.y.v,blur:t.blur.v,spread:t.spread.v,color:t.color.v}})),o.shadowEnable=i.shadowEnable.map((function(e){return e.v})),o.hueRotate=i.hueRotate.v,o.saturate=.01*i.saturate.v,o.brightness=.01*i.brightness.v,o.contrast=.01*i.contrast.v,e<Qb.REPAINT&&(this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0,this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.resetTextureTarget())},t.prototype.calMatrix=function(e){var t=this,r=this,n=r.style,i=r.computedStyle,o=r.matrix,a=r.transform;!this.hasCacheMw&&this.localMwId||(this.hasCacheMw=!1,this.localMwId++);var s=!0;if((e>=Qb.REFLOW||e&Qb.TRANSFORM||e&Qb.SCALE_X&&!i.scaleX||e&Qb.SCALE_Y&&!i.scaleY)&&(s=!1),s){if(e&Qb.TRANSLATE_X){var l=(u=Dc(n.translateX,this.width))-i.translateX;i.translateX=u,a[12]+=l,o[12]+=l}if(e&Qb.TRANSLATE_Y){l=(u=Dc(n.translateY,this.height))-i.translateY;i.translateY=u,a[13]+=l,o[13]+=l}if(e&Qb.ROTATE_Z){var u=n.rotateZ.v;i.rotateZ=u;var c=Zu(u),h=Math.sin(c),d=Math.cos(c),f=i.scaleX,p=i.scaleY;o[0]=a[0]=d*f,o[1]=a[1]=h*p,o[4]=a[4]=-h*f,o[5]=a[5]=d*p;var v=(x=i.transformOrigin)[0],g=x[1];o[12]=a[12]+v-a[0]*v-g*a[4],o[13]=a[13]+g-a[1]*v-g*a[5]}if(e&Qb.SCALE){if(e&Qb.SCALE_X){f=(u=n.scaleX.v)/i.scaleX;i.scaleX=u,a[0]*=f,a[4]*=f,o[0]*=f,o[4]*=f}if(e&Qb.SCALE_Y){p=(u=n.scaleY.v)/i.scaleY;i.scaleY=u,a[1]*=p,a[5]*=p,o[1]*=p,o[5]*=p}v=(x=i.transformOrigin)[0],g=x[1];o[12]=a[12]+v-a[0]*v-a[4]*g,o[13]=a[13]+g-a[1]*v-a[5]*g,o[14]=a[14]-a[2]*v-a[6]*g}}else{ou(a);var m=n.transformOrigin.map((function(e,r){return Dc(e,r?t.height:t.width)}));i.transformOrigin=m;var y=i.left,b=i.top;if(n.matrix)return i.matrix=n.matrix.v.slice(0),su(o,i.matrix),this.transform=cc(o,m[0],m[1]),o;i.translateX=Dc(n.translateX,this.width),a[12]=y+i.translateX,i.translateY=Dc(n.translateY,this.height),a[13]=b+i.translateY;var x,w=n.rotateZ?n.rotateZ.v:0,_=n.scaleX?n.scaleX.v:1,E=n.scaleY?n.scaleY.v:1;i.rotateZ=w,i.scaleX=_,i.scaleY=E,1!==_&&(nu(a)?a[0]=_:hu(a,_)),1!==E&&(nu(a)?a[5]=E:du(a,E)),nu(a)?sc(a,w):w&&cu(a,Zu(w)),su(o,x=lc(a,m[0],m[1]))}return o},t.prototype.calOpacity=function(){var e=this.style,t=this.computedStyle;!this.hasCacheOp&&this.localOpId||(this.hasCacheOp=!1,this.localOpId++),t.opacity=e.opacity.v},t.prototype.calContent=function(){return this.hasContent=!1},t.prototype.renderCanvas=function(e){var t=this.canvasCache;t&&t.available&&e&&t.release()},t.prototype.genTexture=function(e,t,r){var n;this.renderCanvas(t),null===(n=this.textureCache[r])||void 0===n||n.release();var i=this.canvasCache;(null==i?void 0:i.available)?(this.textureTarget[r]=this.textureCache[r]=Yx.getInstance(e,i,(this._bbox2||this.bbox2).slice(0)),i.release()):this.textureTarget[r]=this.textureCache[r]=void 0},t.prototype.resetTextureTarget=function(){for(var e,t,r,n,i=this,o=i.textureMask,a=i.textureFilter,s=i.textureTotal,l=i.textureCache,u=0,c=Math.max(l.length,s.length);u<c;u++)(null===(e=o[u])||void 0===e?void 0:e.available)?this.textureTarget[u]=o[u]:(null===(t=a[u])||void 0===t?void 0:t.available)?this.textureTarget[u]=a[u]:(null===(r=s[u])||void 0===r?void 0:r.available)?this.textureTarget[u]=s[u]:(null===(n=l[u])||void 0===n?void 0:n.available)?this.textureTarget[u]=l[u]:this.textureTarget[u]=void 0},t.prototype.clearCache=function(e){var t=this;void 0===e&&(e=!1),this.textureTarget.splice(0),e?(this.refreshLevel|=Qb.REPAINT,this.textureCache.forEach((function(e){return null==e?void 0:e.release()}))):this.textureCache.forEach((function(e,r){e&&e.available&&(t.textureTarget[r]=e)})),this.textureTotal.forEach((function(e){return null==e?void 0:e.release()})),this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.textureOutline.forEach((function(e){return null==e?void 0:e.release()}))},t.prototype.clearCacheUpward=function(e){void 0===e&&(e=!1);for(var t=this.parent;t;){t.tempBbox=void 0,t.clearCache(e);var r=t.mask;r&&r.clearMask(),t=t.parent}},t.prototype.clearMask=function(e){if(void 0===e&&(e=!0),this.textureMask.forEach((function(e){return null==e?void 0:e.release()})),this.resetTextureTarget(),this.struct.next=0,e)for(var t=this.parent;t&&t!==this.root;)t._rect=void 0,t._bbox=void 0,t._bbox2=void 0,t._filterBbox=void 0,t._filterBbox2=void 0,t.tempBbox=void 0,t=t.parent},t.prototype.remove=function(e){var t=this.root,r=this.parent;if(r){var n=r.children.indexOf(this);if(-1===n)throw new Error("Invalid index of remove()");r.children.splice(n,1);var i=this.prev,o=this.next;i&&(i.next=o),o&&(o.prev=i)}this.prev=this.next=void 0,this.isPage||(this.page=void 0),this.isArtBoard||(this.artBoard=void 0),this.isSymbolInstance||(this.symbolInstance=void 0),this.isDestroyed?e&&e(!0):(null==r||r.deleteStruct(this),t.addUpdate(this,[],Qb.REFLOW,!1,!0,e))},t.prototype.destroy=function(){this.isDestroyed||(this.isDestroyed=!0,this.clearCache(!0),this.parent=this.root=this.mask=void 0)},t.prototype.structure=function(e){var t=this.struct;return t.lv=e,[t]},t.prototype.updateFormatStyleData=function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];Cc(r,e,this.style)||(this.style[r]=n,t.push(r))}return t},t.prototype.updateFormatStyle=function(e,t){var r,n=this.updateFormatStyleData(e);return n.length?{keys:n,lv:null===(r=this.root)||void 0===r?void 0:r.addUpdate(this,n,void 0,!1,!1,t)}:(t&&t(!0),{keys:n,lv:Qb.NONE})},t.prototype.updateStyleData=function(e){var t=_c(e);return this.updateFormatStyleData(t)},t.prototype.updateStyle=function(e,t){var r=_c(e);return this.updateFormatStyle(r,t)},t.prototype.updateProps=function(e,t){var r,n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];Is(o,this.props[i])||(this.props[i]=o,n.push(o))}if(!n.length)return t&&t(!0),n;null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t)},t.prototype.refreshStyle=function(e,t){var r,n,i=this;return Array.isArray(e)?n=e.slice(0):(n=Object.keys(e)).forEach((function(t){i.style[t]=e[t]})),n.length?(null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t),n):(t&&t(!0),n)},t.prototype.refreshProps=function(e,t){var r,n,i=this;return Array.isArray(e)?n=e.slice(0):(n=Object.keys(e)).forEach((function(t){i.props[t]=e[t]})),n.length?(null===(r=this.root)||void 0===r||r.addUpdate(this,n,void 0,!1,!1,t),n):(t&&t(!0),n)},t.prototype.refresh=function(e,t){var r;void 0===e&&(e=Qb.REPAINT),null===(r=this.root)||void 0===r||r.addUpdate(this,[],e,!1,!1,t)},t.prototype.getStyle=function(){return Rs(this.style)},t.prototype.getComputedStyle=function(){var e=Object.assign({},this.computedStyle);return e.color=e.color.slice(0),e.backgroundColor=e.backgroundColor.slice(0),e.fill=Rs(e.fill),e.stroke=Rs(e.stroke),e.shadow=Rs(e.shadow),e.innerShadow=Rs(e.innerShadow),e.fillOpacity=e.fillOpacity.slice(0),e.fillEnable=e.fillEnable.slice(0),e.fillMode=e.fillMode.slice(0),e.strokeEnable=e.strokeEnable.slice(0),e.strokeWidth=e.strokeWidth.slice(0),e.transformOrigin=e.transformOrigin.slice(0),e.strokeDasharray=e.strokeDasharray.slice(0),e.shadowEnable=e.shadowEnable.slice(0),e},t.prototype.getCssStyle=function(){var e=this,t={},r=this.style,n=this.computedStyle;["top","right","bottom","left","width","height","translateX","translateY","scaleX","scaleY","rotateZ"].forEach((function(e){var n=r[e];n.u===Us.AUTO?t[e]="auto":n.u===Us.PERCENT?t[e]=n.v+"%":n.u!==Us.PX&&n.u!==Us.NUMBER&&n.u!==Us.DEG||(t[e]=n.v)})),t.opacity=n.opacity,t.visibility=n.visibility===tl.VISIBLE?"visible":"hidden",t.color=Tc(n.color),t.backgroundColor=Tc(n.backgroundColor),t.fontStyle=["normal","italic","oblique"][n.fontStyle],t.textAlign=["left","center","right","justify"][n.textAlign],t.textVerticalAlign=["top","middle","bottom"][n.textVerticalAlign],t.mixBlendMode=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"][n.mixBlendMode],["shadowEnable","strokeEnable","fillEnable","fillOpacity","strokeWidth"].forEach((function(e){t[e]=n[e].slice(0)})),t.fill=n.fill.map((function(t){return Uc(t,e.width,e.height)})),t.fillRule=["nonzero","evenodd"][n.fillRule],t.stroke=n.stroke.map((function(t){return Uc(t,e.width,e.height)})),t.strokeLinecap=["butt","round","square"][n.strokeLinecap],t.strokeLinejoin=["miter","round","bevel"][n.strokeLinejoin],t.strokePosition=n.strokePosition.map((function(e){return zc(e)})),t.maskMode=["none","outline","alpha","gray"][n.maskMode],t.booleanOperation=["none","union","subtract","intersect","xor"][n.booleanOperation];var i=n.blur;t.blur=Nc(i.t,i.radius,i.angle,i.center,i.saturation),t.shadow=n.shadow.map((function(e){return Bc(e)}));var o=r.transformOrigin;return t.transformOrigin=n.transformOrigin.map((function(e,t){var r=o[t];return r.u===Us.PERCENT?r.v+"%":e})),t.hueRotate=n.hueRotate,t.saturate=100*n.saturate+"%",t.brightness=100*n.brightness+"%",t.contrast=100*n.contrast+"%",t},t.prototype.getBoundingClientRect=function(e){var t,r,n=(null==e?void 0:e.includeBbox)?this._bbox||this.bbox:this._rect||this.rect;if((null==e?void 0:e.excludeRotate)&&this.computedStyle.rotateZ){var i=this.parent,o=ru(),a=this.matrix;o[12]=a[12],o[13]=a[13];var s=iu(i.matrixWorld,o);r=gu(n[0],n[1],n[2],n[3],s)}else r=gu(n[0],n[1],n[2],n[3],this.matrixWorld);var l=(null===(t=this.root)||void 0===t?void 0:t.dpi)||1,u=(null==e?void 0:e.excludeDpi)?r.x1/l:r.x1,c=(null==e?void 0:e.excludeDpi)?r.y1/l:r.y1,h=(null==e?void 0:e.excludeDpi)?r.x2/l:r.x2,d=(null==e?void 0:e.excludeDpi)?r.y2/l:r.y2,f=(null==e?void 0:e.excludeDpi)?r.x3/l:r.x3,p=(null==e?void 0:e.excludeDpi)?r.y3/l:r.y3,v=(null==e?void 0:e.excludeDpi)?r.x4/l:r.x4,g=(null==e?void 0:e.excludeDpi)?r.y4/l:r.y4,m=Math.min(u,h,f,v),y=Math.min(c,d,p,g),b=Math.max(u,h,f,v),x=Math.max(c,d,p,g);return{left:m,top:y,right:b,bottom:x,width:b-m,height:x-y,points:[{x:u,y:c},{x:h,y:d},{x:f,y:p},{x:v,y:g}]}},t.prototype.startSizeChange=function(){var e=this,t=e.width,r=e.height,n=e.style,i=e.computedStyle,o=e.parent;if(e.isDestroyed||!o)throw new Error("Can not resize a destroyed Node or Root");var a=n.left,s=n.right,l=n.top,u=n.bottom,c=n.translateX,h=n.translateY,d=o.width,f=o.height;if(c.v&&c.u===Us.PERCENT){var p=c.v*t*.01;a.u===Us.PERCENT?a.v+=100*p/d:a.u===Us.PX&&(a.v+=p),i.left+=p,s.u===Us.PERCENT?s.v-=100*p/d:s.u===Us.PX&&(s.v-=p),i.right-=p,c.v=0}if(h.v&&h.u===Us.PERCENT){p=h.v*r*.01;l.u===Us.PERCENT?l.v+=100*p/f:l.u===Us.PX&&(l.v+=p),i.top+=p,u.u===Us.PERCENT?u.v-=100*p/f:u.u===Us.PX&&(u.v-=p),i.bottom-=p,h.v=0}},t.prototype.endSizeChange=function(e){var t=e.translateX,r=e.translateY,n=this,i=n.style,o=n.computedStyle,a=n.parent,s=n.width,l=n.height,u=i.left,c=i.right,h=i.top,d=i.bottom,f=a,p=f.width,v=f.height;if(t.v&&t.u===Us.PERCENT){var g=t.v*s*.01;u.u===Us.PX?u.v-=g:u.u===Us.PERCENT&&(u.v-=100*g/p),o.left-=g,c.u===Us.PX?c.v+=g:c.u===Us.PERCENT&&(c.v+=100*g/p),o.right+=g,o.translateX+=g}if(r.v&&r.u===Us.PERCENT){g=r.v*l*.01;h.u===Us.PX?h.v-=g:i.top.u===Us.PERCENT&&(h.v-=100*g/v),o.top-=g,d.u===Us.PX?d.v+=g:d.u===Us.PERCENT&&(d.v+=100*g/v),o.bottom+=g,o.translateY+=g}i.translateX.v=t.v,i.translateX.u=t.u,i.translateY.v=r.v,i.translateY.u=r.u},t.prototype.endPosChange=function(e,t,r){var n=this,i=n.style,o=n.computedStyle,a=n.parent;if(a){var s=e.translateX,l=e.translateY,u=i.top,c=i.right,h=i.bottom,d=i.left,f=a.width,p=a.height;t&&(d.u===Us.PX?d.v+=t:d.u===Us.PERCENT&&(d.v+=100*t/f),o.left+=t,c.u===Us.PX?c.v-=t:c.u===Us.PERCENT&&(c.v-=100*t/f),o.right-=t,o.translateX-=t),r&&(u.u===Us.PX?u.v+=r:u.u===Us.PERCENT&&(u.v+=100*r/p),o.top+=r,h.u===Us.PX?h.v-=r:h.u===Us.PERCENT&&(h.v-=100*r/p),o.bottom-=r,o.translateY-=r),i.translateX.v=s.v,i.translateX.u=s.u,i.translateY.v=l.v,i.translateY.u=l.u}},t.prototype.checkShapeChange=function(){},t.prototype.clearPoints=function(){},t.prototype.adjustPosAndSizeSelf=function(e,t,r,n){var i=this,o=i.style,a=i.computedStyle,s=i.parent,l=i.root;if(s&&l&&(e||t||r||n)){var u=s.width,c=s.height,h=o.top,d=o.right,f=o.bottom,p=o.left,v=o.width,g=o.height;e&&(p.u===Us.PX?p.v+=e:p.u===Us.PERCENT&&(p.v+=100*e/u),a.left+=e),r&&(d.u===Us.PX?d.v-=r:d.u===Us.PERCENT?d.v-=100*r/u:v.u===Us.PX?v.v=r+this.width-e:v.u===Us.PERCENT&&(v.v=100*(r+this.width-e)/s.width),a.right-=r),this.width=a.width=s.width-a.left-a.right,t&&(h.u===Us.PX?h.v+=t:h.u===Us.PERCENT&&(h.v+=100*t/c),a.top+=t),n&&(f.u===Us.PX?f.v-=n:f.u===Us.PERCENT?f.v-=100*n/c:g.u===Us.PX?g.v=n+this.height-t:g.u===Us.PERCENT&&(g.v=100*(n+this.height-t)/s.height),a.bottom-=n),this.height=a.height=s.height-a.top-a.bottom,this.refreshLevel|=Qb.TRANSFORM,l.rl|=Qb.TRANSFORM,this.calMatrix(Qb.TRANSFORM),this._rect=void 0,this._bbox=void 0,this._bbox2=void 0,this._filterBbox=void 0,this._filterBbox2=void 0,this.tempBbox=void 0}},t.prototype.checkPosSizeUpward=function(){for(var e=this.root,t=this.parent;t&&t!==e&&t.adjustPosAndSize();)t=t.parent},t.prototype.adjustPosAndSize=function(){return!1},t.prototype.getZoom=function(e){void 0===e&&(e=!1);for(var t=this.computedStyle.scaleX,r=this.parent;r&&r!==this.page&&!r.isPage;)t*=r.computedStyle.scaleX,r=r.parent;return!e&&this.root?t*this.root.dpi:t},t.prototype.setZoom=function(e,t){void 0===t&&(t=!1),t&&this.root&&(e/=this.root.dpi),this.updateStyle({scaleX:e,scaleY:e})},t.prototype.rename=function(e){this.props.name=e},t.prototype.getStructs=function(){return this.root?[this.struct]:[]},t.prototype.isSibling=function(e){for(var t=this.prev;t;){if(t===e)return!0;t=t.prev}for(var r=this.next;r;){if(r===e)return!0;r=r.next}return!1},t.prototype.toJson=function(){return{tagName:"node",props:Rs(this.props)}},t.prototype.toSketchJson=function(e,t){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,l,u,c,h,d,f,p,v,g,m,y,b,x,w,_,E,S,C,k,T,A,M=this;return Q(this,(function(O){switch(O.label){case 0:return r=(t=this).props,n=t.width,i=t.height,o=t.style,a=t.computedStyle,l=0,o.left.v===Us.PX&&(l|=Xc.LEFT),o.right.v===Us.PX&&(l|=Xc.RIGHT),o.top.v===Us.PX&&(l|=Xc.TOP),o.bottom.v===Us.PX&&(l|=Xc.BOTTOM),o.width.v===Us.PX&&(l|=Xc.WIDTH),o.height.v===Us.PX&&(l|=Xc.HEIGHT),l^=Xc.UNSET,u=$.LineCapStyle.Butt,a.strokeLinecap===Js.ROUND?u=$.LineCapStyle.Round:a.strokeLinecap===Js.SQUARE&&(u=$.LineCapStyle.Projecting),c=$.LineJoinStyle.Miter,a.strokeLinejoin===Qs.ROUND?c=$.LineJoinStyle.Round:a.strokeLinejoin===Qs.BEVEL&&(c=$.LineJoinStyle.Bevel),h=a.shadow,d=a.shadowEnable,f=a.innerShadow,p=a.innerShadowEnable,v=a.blur,g=a.hueRotate,m=a.brightness,y=a.contrast,b=a.saturate,x=a.opacity,w=a.mixBlendMode,_=a.scaleX,E=a.scaleY,S=[],C=[],h.forEach((function(e,t){S.push({_class:"shadow",isEnabled:d[t],blurRadius:e.blur,color:$c(e.color),contextSettings:{_class:"graphicsContextSettings",blendMode:$.BlendMode.Normal,opacity:1},offsetX:e.x,offsetY:e.y,spread:e.spread})})),f.forEach((function(e,t){C.push({_class:"innerShadow",isEnabled:p[t],blurRadius:e.blur,color:$c(e.color),contextSettings:{_class:"graphicsContextSettings",blendMode:$.BlendMode.Normal,opacity:1},offsetX:e.x,offsetY:e.y,spread:e.spread})})),k={booleanOperation:a.booleanOperation-1,clippingMaskMode:a.maskMode===Zs.ALPHA?1:0,do_objectID:r.uuid,exportOptions:{exportFormats:[],includedLayerIds:[],layerOptions:0,shouldTrim:!1,_class:"exportOptions"},frame:{constrainProportions:r.constrainProportions||!1,width:n||0,height:i||0,x:a.left+a.translateX,y:a.top+a.translateY,_class:"rect"},hasClippingMask:a.maskMode!==Zs.NONE,isFixedToViewport:!1,isFlippedHorizontal:-1===_,isFlippedVertical:-1===E,isLocked:r.isLocked||!1,isTemplate:!1,isVisible:a.visibility===tl.VISIBLE,layerListExpandedType:r.isExpanded?$.LayerListExpanded.Expanded:$.LayerListExpanded.Collapsed,name:r.name||"",nameIsFixed:!1,resizingConstraint:l,resizingType:$.ResizeType.Stretch,rotation:-a.rotateZ,shouldBreakMaskChain:a.breakMask,style:{_class:"style",do_objectID:this.props.styleId||s(),borderOptions:{_class:"borderOptions",isEnabled:!0,dashPattern:a.strokeDasharray,lineCapStyle:u,lineJoinStyle:c},startMarkerType:$.MarkerType.OpenArrow,endMarkerType:$.MarkerType.OpenArrow,miterLimit:a.strokeMiterlimit,windingRule:a.fillRule===Ks.EVEN_ODD?$.WindingRule.EvenOdd:$.WindingRule.NonZero,shadows:S,innerShadows:C,colorControls:{_class:"colorControls",isEnabled:!0,brightness:m-1,contrast:y,hue:Zu(g),saturation:b},contextSettings:{_class:"graphicsContextSettings",blendMode:[0,2,5,7,1,4,6,3,9,8,10,11,12,13,14,15][w]||0,opacity:x}}},T=k.style,[4,Promise.all(a.fill.map((function(t,r){return J(M,void 0,void 0,(function(){var n,i,o,l,u,c,h,d,f,p;return Q(this,(function(v){switch(v.label){case 0:return n={_class:"color",alpha:1,red:0,green:0,blue:0},i={_class:"gradient",gradientType:$.GradientType.Linear,elipseLength:1,from:"",to:"",stops:[]},o=$.FillType.Color,l=$.PatternFillType.Tile,u=1,Array.isArray(t)?($c(t,n),[3,5]):[3,1];case 1:return t.url?(o=$.FillType.Pattern,l=t.type,u=t.scale,(h=e.folder("images"))?[4,fetch(t.url)]:[3,3]):[3,4];case 2:d=v.sent(),f=d.blob(),p=(this.props.uuid||s())+".png",h.file(p,f),c={_class:"MSJSONFileReference",_ref_class:"MSImageData",_ref:"images/"+p},v.label=3;case 3:return[3,5];case 4:o=$.FillType.Gradient,i.from="{"+t.d[0]+", "+t.d[1]+"}",i.to="{"+t.d[2]+", "+t.d[3]+"}",t.t===js.RADIAL?(i.gradientType=$.GradientType.Radial,i.elipseLength=t.d[4]):t.t===js.CONIC&&(i.gradientType=$.GradientType.Angular),t.stops.forEach((function(e){i.stops.push({_class:"gradientStop",color:$c(e.color),position:e.offset||0})})),v.label=5;case 5:return[2,{_class:"fill",isEnabled:a.fillEnable[r],color:n,fillType:o,noiseIndex:0,noiseIntensity:0,patternFillType:l,patternTileScale:u,gradient:i,image:c,contextSettings:{_class:"graphicsContextSettings",blendMode:$.BlendMode.Normal,opacity:a.fillOpacity[r]}}]}}))}))})))];case 1:return T.fills=O.sent(),k.style.borders=a.stroke.map((function(e,t){var r={_class:"color",alpha:1,red:0,green:0,blue:0},n={_class:"gradient",gradientType:$.GradientType.Linear,elipseLength:1,from:"",to:"",stops:[]},i=$.FillType.Color;Array.isArray(e)?$c(e,r):(i=$.FillType.Gradient,n.from="{"+e.d[0]+", "+e.d[1]+"}",n.to="{"+e.d[2]+", "+e.d[3]+"}",e.t===js.RADIAL?(n.gradientType=$.GradientType.Radial,n.elipseLength=e.d[4]):e.t===js.CONIC&&(n.gradientType=$.GradientType.Angular),e.stops.forEach((function(e){n.stops.push({_class:"gradientStop",color:$c(e.color),position:e.offset||0})})));var o=$.BorderPosition.Center;return a.strokePosition[t]===$s.INSIDE?o=$.BorderPosition.Inside:a.strokePosition[t]===$s.OUTSIDE&&(o=$.BorderPosition.Outside),{_class:"border",isEnabled:a.strokeEnable[t],color:r,fillType:i,position:o,thickness:a.strokeWidth[t],gradient:n,contextSettings:{_class:"graphicsContextSettings",blendMode:$.BlendMode.Normal,opacity:1}}})),v.t!==Ys.GAUSSIAN&&v.t!==Ys.MOTION&&v.t!==Ys.BACKGROUND&&v.t!==Ys.RADIAL||(A=void 0,A=v.center?"{"+v.center.join(", ")+"}":"{0.5, 0.5}",k.style.blur={_class:"blur",isEnabled:!0,center:A,motionAngle:Zu(v.angle||0),radius:v.radius||0,saturation:v.saturation||0,type:[$.BlurType.Gaussian,$.BlurType.Motion,$.BlurType.Zoom,$.BlurType.Background][v.t-1]}),[2,k]}}))}))},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r);return n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.addTile=function(e){-1===this.tileList.indexOf(e)&&(this.tileList.push(e),e.add(this))},t.prototype.removeTile=function(e){var t=this.tileList.indexOf(e);t>-1&&this.tileList.splice(t,1)[0].remove(this)},t.prototype.cleanTile=function(){var e=this,t=this.tileList.splice(0);return t.forEach((function(t){t.remove(e)})),t},Object.defineProperty(t.prototype,"opacity",{get:function(){var e,t=this.root;if(!t)return this._opacity;for(var r=this,n=this.hasCacheOp,i=r.parent,o=-1,a=[];i;)a.push(i),i.hasCacheOp&&i.localOpId===r.parentOpId||(n=!1,o=a.length),r=i,i=i.parent;if(!n){if(o>-1){a.splice(o),a.reverse();for(var s=0,l=a.length;s<l;s++){var u=a[s];u.hasCacheOp&&u.localOpId!==(null===(e=u.parent)||void 0===e?void 0:e.parentOpId)&&u.localOpId++,u.hasCacheOp=!0,u===t?u._opacity=u.computedStyle.opacity:(u._opacity=u.parent._opacity*u.computedStyle.opacity,u.parentOpId=u.parent.localOpId)}}this.hasCacheOp&&this.localOpId++,this.hasCacheOp=!0,(i=this.parent)?(this._opacity=i._opacity*this.computedStyle.opacity,this.parentOpId=i.localOpId):this._opacity=this.computedStyle.opacity}return this._opacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"matrixWorld",{get:function(){var e,t=this.root,r=this._matrixWorld;if(!t)return r;for(var n=this,i=this.hasCacheMw,o=n.parent,a=-1,s=[];o;)s.push(o),o.hasCacheMw&&o.localMwId===n.parentMwId||(i=!1,a=s.length),n=o,o=o.parent;if(!i){if(a>-1){s.splice(a),s.reverse();for(var l=0,u=s.length;l<u;l++){var c=s[l];if(c.hasCacheMw&&c.parentMwId!==(null===(e=c.parent)||void 0===e?void 0:e.localMwId)&&c.localMwId++,c.hasCacheMw=!0,c===t)su(c._matrixWorld,c.matrix);else{var h=iu(c.parent._matrixWorld,c.matrix);su(c._matrixWorld,h),c.parentMwId=c.parent.localMwId}}}if(this.hasCacheMw&&this.localMwId++,this.hasCacheMw=!0,o=this.parent)su(r,h=iu(o._matrixWorld,this.matrix)),this.parentMwId=o.localMwId;else su(r,this.matrix)}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;return e||((e=this._rect=new Float64Array(4))[0]=0,e[1]=0,e[2]=this.width,e[3]=this.height),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===$s.INSIDE||(a=o[t]===$s.OUTSIDE?Math.max(a,e):Math.max(a,.5*e)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterBbox",{get:function(){var e=this._filterBbox;if(!e){var t=this._bbox||this.bbox;e=this._filterBbox=t.slice(0);for(var r=this.computedStyle,n=r.shadow,i=r.shadowEnable,o=r.blur,a=[0,0,0,0],s=0,l=n.length;s<l;s++)if(i[s]){var u=n[s];if(u.color[3]>0){var c=Hx(Xx(.5*u.blur));(u.x||u.y||c)&&(a[0]=Math.min(a[0],u.x-c),a[1]=Math.min(a[1],u.y-c),a[2]=Math.max(a[2],u.x+c),a[3]=Math.max(a[3],u.y+c))}}if(e[0]+=a[0],e[1]+=a[1],e[2]+=a[2],e[3]+=a[3],o.t===Ys.GAUSSIAN||o.t===Ys.MOTION||o.t===Ys.BACKGROUND||o.t===Ys.RADIAL){var h=o.radius;if(h>0)(c=Hx(Xx(h)))&&(e[0]-=c,e[1]-=c,e[2]+=c,e[3]+=c)}}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox2",{get:function(){var e=this._bbox2;return e||((e=(this._bbox||this.bbox).slice(0))[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterBbox2",{get:function(){var e=this._filterBbox2;return e||((e=(this._filterBbox||this.filterBbox).slice(0))[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])),e},enumerable:!1,configurable:!0}),t}(Dx),Vx=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this,t)||this;n.children=r;var i=r.length;if(i){var o=r[0];o.parent=n;for(var a=o,s=1;s<i;s++){var l=r[s];l.parent=n,a.next=l,l.prev=a,a=l}}return n.isContainer=!0,n}return v(t,e),t.prototype.willMount=function(){e.prototype.willMount.call(this);var t=this.children,r=t.length;if(r){var n=t[0];n.parent=this,n.willMount();for(var i=n,o=1;o<r;o++){var a=t[o];a.parent=this,a.willMount(),i.next=a,a.prev=i,i=a}}},t.prototype.didMount=function(){for(var t=this.children,r=t.length,n=0;n<r;n++)t[n].didMount();e.prototype.didMount.call(this)},t.prototype.lay=function(t){e.prototype.lay.call(this,t);var r=this.children;this.computedStyle;for(var n=0,i=r.length;n<i;n++){r[n].layout({w:this.width,h:this.height})}},t.prototype.getChildrenRect=function(e){for(var t=this.children,r={minX:0,minY:0,maxX:0,maxY:0},n=!1,i=!0,o=0,a=t.length;o<a;o++){var s=t[o],l=s.computedStyle;if(!n||l.breakMask){if(l.maskMode){n=!0;for(var u=s.next;u&&!u.computedStyle.breakMask;)o++,u=u.next}else l.breakMask&&(n=!1);if(e!==s){var c=s._rect||s.rect,h=gu(c[0],c[1],c[2],c[3],s.matrix),d=h.x1,f=h.y1,p=h.x2,v=h.y2,g=h.x3,m=h.y3,y=h.x4,b=h.y4,x=Math.min(d,p,g,y),w=Math.min(f,v,m,b),_=Math.max(d,p,g,y),E=Math.max(f,v,m,b);i?(i=!1,r.minX=x,r.minY=w,r.maxX=_,r.maxY=E):(r.minX=Math.min(r.minX,x),r.minY=Math.min(r.minY,w),r.maxX=Math.max(r.maxX,_),r.maxY=Math.max(r.maxY,E))}}}return r},t.prototype.appendChild=function(e,t){e.remove();var r=this.root,n=this.children,i=n.length;if(i){var o=n[n.length-1];o.next=e,e.prev=o,e.props.index=.5*(o.props.index+1)}else e.props.index=.5;e.parent=this,e.root=r,n.push(e),this.isDestroyed?t&&t(!0):(e.willMount(),this.insertStruct(e,i),r.addUpdate(e,[],Qb.REFLOW,!0,!1,t))},t.prototype.prependChild=function(e,t){e.remove();var r=this.root,n=this.children;if(n.length){var i=n[0];i.next=e,e.prev=i,e.props.index=.5*i.props.index}else e.props.index=.5;e.parent=this,e.root=r,n.push(e),this.isDestroyed?t&&t(!0):(e.willMount(),this.insertStruct(e,0),r.addUpdate(e,[],Qb.REFLOW,!0,!1,(function(r){!r&&e.page&&e.didMount(),t&&t(r)})))},t.prototype.removeChild=function(e,t){e.parent===this?e.remove(t):hl.error("Invalid parameter of removeChild()")},t.prototype.clearChildren=function(e){var t=this.root,r=this.children;if(r.length){if(this.isDestroyed)return r.splice(0),void(e&&e(!0));for(;r.length;){var n=r.pop();this.deleteStruct(n),n.destroy()}t.addUpdate(this,[],Qb.REFLOW,!1,!1,e)}},t.prototype.destroy=function(){var t=this.isDestroyed,r=this.children;if(!t){for(var n=0,i=r.length;n<i;n++)r[n].destroy();e.prototype.destroy.call(this)}},t.prototype.structure=function(t){var r=e.prototype.structure.call(this,t);return this.children.forEach((function(e){r=r.concat(e.structure(t+1))})),r[0].num=this.children.length,r[0].total=r.length-1,r},t.prototype.insertStruct=function(e,t){var r,n=this.struct,i=this.root,o=e.structure(n.lv+1),a=i.structs;if(t){var s=this.children[t-1].struct,l=s.total;r=a.indexOf(s)+l+1}else r=a.indexOf(n)+1;a.splice.apply(a,function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}([r,0],o,!1));var u=o[0].total+1;n.num++,n.total+=u;for(var c=this.parent;c;)c.struct.total+=u,c=c.parent},t.prototype.deleteStruct=function(e){var t=e.struct,r=t.total+1,n=this.root.structs,i=n.indexOf(t);n.splice(i,r);var o=this.struct;o.num--,o.total-=r;for(var a=this.parent;a;)a.struct.total-=r,a=a.parent},t.prototype.getStructs=function(){if(!this.root)return[];var e=this.root.structs,t=this.struct,r=e.indexOf(t);return e.slice(r,r+t.total+1)},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.children=this.children.map((function(e){return e.toJson()})),t},t}(Wx),qx=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.hasBackgroundColor=!!t.hasBackgroundColor,n.resizesContent=!!t.resizesContent,n.includeBackgroundColorInExport=!!t.includeBackgroundColorInExport,n.isArtBoard=!0,n.artBoard=n,n}return v(t,e),t.prototype.calContent=function(){return this.hasContent=this.hasBackgroundColor},t.prototype.rename=function(t){var r,n;e.prototype.rename.call(this,t),null===(n=null===(r=this.root)||void 0===r?void 0:r.overlay)||void 0===n||n.updateArtBoard(this)},t.prototype.renderBgc=function(e,t,r){var n=this.root.programs,i=this,o=i.width,a=i.height,s=i.matrixWorld,l=n.bgColorProgram;e.useProgram(l);var u=gu(0,0,o,a,s),c=new Float32Array(8),h=kx(u.x1,u.y1,t,r,!1),d=kx(u.x2,u.y2,t,r,!1),f=kx(u.x3,u.y3,t,r,!1),p=kx(u.x4,u.y4,t,r,!1);c[0]=h.x,c[1]=h.y,c[2]=p.x,c[3]=p.y,c[4]=d.x,c[5]=d.y,c[6]=f.x,c[7]=f.y;var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,c,e.STATIC_DRAW);var g=e.getAttribLocation(l,"a_position");e.vertexAttribPointer(g,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(g);var m=e.getUniformLocation(l,"u_color"),y=Oc(this.computedStyle.backgroundColor);e.uniform4f(m,y[0],y[1],y[2],y[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(v),e.disableVertexAttribArray(g);var b=!0;if((h.x<=-1&&h.y<=-1&&f.x>=1&&f.y>=1||f.x<-1-4/t&&f.y<-1-4/r||h.x>1+4/t&&f.y>1+4/r)&&(b=!1),b){var x=n.bgShadowProgram;e.useProgram(x);var w=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,w),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var _=e.getAttribLocation(x,"a_position");e.vertexAttribPointer(_,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(_);var E=e.getUniformLocation(x,"u_tl");e.uniform2f(E,h.x,h.y);var S=e.getUniformLocation(x,"u_br");e.uniform2f(S,f.x,f.y);var C=e.getUniformLocation(x,"u_color");e.uniform4f(C,0,0,0,.2);var k=e.getUniformLocation(x,"u_radius");e.uniform2f(k,8/t,8/r),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(w),e.disableVertexAttribArray(_)}e.useProgram(n.program)},t.prototype.renderBgcTile=function(e,t,r,n,i,o,a){var s=this.root.programs,l=s.bgColorProgram;e.useProgram(l);var u={x1:a.x1-o.x*i,y1:a.y1-o.y*i,x2:a.x2-o.x*i,y2:a.y2-o.y*i,x3:a.x3-o.x*i,y3:a.y3-o.y*i,x4:a.x4-o.x*i,y4:a.y4-o.y*i},c=new Float32Array(8),h=kx(u.x1,u.y1,t,t,!1),d=kx(u.x2,u.y2,t,t,!1),f=kx(u.x3,u.y3,t,t,!1),p=kx(u.x4,u.y4,t,t,!1);c[0]=h.x,c[1]=h.y,c[2]=p.x,c[3]=p.y,c[4]=d.x,c[5]=d.y,c[6]=f.x,c[7]=f.y;var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,c,e.STATIC_DRAW);var g=e.getAttribLocation(l,"a_position");e.vertexAttribPointer(g,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(g);var m=e.getUniformLocation(l,"u_color"),y=Oc(this.computedStyle.backgroundColor);e.uniform4f(m,y[0],y[1],y[2],y[3]),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(v),e.disableVertexAttribArray(g);var b=s.bgShadowProgram;e.useProgram(b);var x=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,x),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var w=e.getAttribLocation(b,"a_position");e.vertexAttribPointer(w,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(w);var _=e.getUniformLocation(b,"u_tl");e.uniform2f(_,h.x,h.y);var E=e.getUniformLocation(b,"u_br");e.uniform2f(E,f.x,f.y);var S=e.getUniformLocation(b,"u_color");e.uniform4f(S,0,0,0,.2);var C=e.getUniformLocation(b,"u_radius");e.uniform2f(C,8/r,8/n),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.deleteBuffer(x),e.disableVertexAttribArray(w),e.useProgram(s.program)},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.ART_BOARD,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n,i,o;return Q(this,(function(a){switch(a.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=a.sent())._class=$.ClassValue.Artboard,n.hasClickThrough=!1,n.includeBackgroundColorInExport=!1,n.isFlowHome=!1,n.resizesContent=this.resizesContent,n.includeBackgroundColorInExport=this.includeBackgroundColorInExport,n.horizontalRulerData={_class:"rulerData",base:0,guides:[]},n.verticalRulerData={_class:"rulerData",base:0,guides:[]},i=this.computedStyle,n.backgroundColor={alpha:i.backgroundColor[3],blue:i.backgroundColor[2]/255,green:i.backgroundColor[1]/255,red:i.backgroundColor[0]/255,_class:"color"},n.hasBackgroundColor=this.hasBackgroundColor,[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t,r)})))];case 2:return o=a.sent(),n.layers=o.map((function(e){return e})),[2,n]}}))}))},Object.defineProperty(t.prototype,"filterBbox",{get:function(){var e=this._filterBbox;if(!e){var t=this._bbox||this.bbox;(e=this._filterBbox=t.slice(0))[0]-=8,e[1]-=8,e[2]+=8,e[3]+=8}return e},enumerable:!1,configurable:!0}),t}(Vx),Kx={},Zx=function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this.available=!1,this.w=e,this.h=t,this.dx=r,this.dy=n,this.list=[];for(var i=ms.maxTextureSize,o=0,a=Math.ceil(t/i);o<a;o++)for(var s=0,l=Math.ceil(e/i);s<l;s++){var u=s===l-1?e-s*i:i,c=o===a-1?t-o*i:i;this.list.push({x:s*i-r,y:o*i-n,w:u,h:c,os:hl.getOffscreenCanvas(u,c)})}}return e.prototype.release=function(){this.available&&(this.available=!1,this.list.splice(0).forEach((function(e){return e.os.release()})))},e.prototype.releaseImg=function(e){if(this.available){this.available=!1;var t=Kx[e];t.count--,t.count||(delete Kx[e],this.list.splice(0).forEach((function(e){return e.os.release()})))}},e.prototype.getCount=function(e){var t;return null===(t=Kx[e])||void 0===t?void 0:t.count},e.getInstance=function(t,r,n,i){return void 0===n&&(n=0),void 0===i&&(i=0),new e(t,r,n,i)},e.getImgInstance=function(t,r,n){if(Kx.hasOwnProperty(n)){var i=Kx[n];return i.count++,i.value}var o=new e(t,r,0,0);return Kx[n]={value:o,count:1},o},e}();function Jx(e){switch(e){case Hs.MULTIPLY:return"multiply";case Hs.SCREEN:return"screen";case Hs.OVERLAY:return"overlay";case Hs.DARKEN:return"darken";case Hs.LIGHTEN:return"lighten";case Hs.COLOR_DODGE:return"color-dodge";case Hs.COLOR_BURN:return"color-burn";case Hs.HARD_LIGHT:return"hard-light";case Hs.SOFT_LIGHT:return"soft-light";case Hs.DIFFERENCE:return"difference";case Hs.EXCLUSION:return"exclusion";case Hs.HUE:return"hue";case Hs.SATURATION:return"saturation";case Hs.COLOR:return"color";case Hs.LUMINOSITY:return"luminosity";default:return"source-over"}}var Qx=function(e){function t(t){var r=e.call(this,t)||this;r.isBitmap=!0,r.onlyImg=!0;var n=r._src=t.src||"";if(r.loader={error:!1,loading:!1,url:n,width:0,height:0},r.loaders=[],n){var i=hl.IMG[n];i&&i.state===hl.LOADED&&(i.success?(r.loader.source=i.source,r.loader.width=i.source.width,r.loader.height=i.source.height):r.loader.error=!0)}else r.loader.error=!0;return r}return v(t,e),t.prototype.loadAndRefresh=function(){var e=this,t=this.loader;if(!t.loading||t.url!==this._src){var r=t.error,n=t.source;if(t.source=void 0,t.error=!1,!this.isDestroyed){var i=this.root,o=hl.IMG[this._src];if(o&&o.state===hl.LOADED)return o.success&&o.source?(t.source=o.source,t.width=o.width,t.height=o.height):t.error=!0,void this.root.addUpdate(this,[],Qb.REPAINT,!1,!1,void 0);t.loading||i.imgLoadingCount++,(r||n)&&i.addUpdate(this,[],Qb.REPAINT,!1,!1,void 0),t.loading=!0,hl.loadImg(this._src,(function(r){r.url===e._src&&(i.imgLoadingCount--,t.loading=!1,r.success?(t.error=!1,t.source=r.source,t.width=r.width,t.height=r.height,e.isDestroyed||e.root.addUpdate(e,[],Qb.REPAINT,!1,!1,void 0)):(t.error=!0,e.isDestroyed||e.root.addUpdate(e,[],Qb.NONE,!1,!1,void 0)))}))}}},t.prototype.checkLoader=function(){var e=this.loader;return!(e.loading||e.source||e.error)},t.prototype.calContent=function(){var e=this.computedStyle,t=e.fill,r=e.fillOpacity,n=e.fillEnable,i=e.stroke,o=e.strokeEnable,a=e.strokeWidth,s=e.innerShadow,l=e.innerShadowEnable;this.onlyImg=!0;for(var u=0,c=t.length;u<c;u++)if(n[u]&&r[u]){this.onlyImg=!1;break}if(this.onlyImg)for(u=0,c=i.length;u<c;u++)if(o[u]&&a[u]){this.onlyImg=!1;break}if(this.onlyImg)for(u=0,c=s.length;u<c;u++)if(l[u]){this.onlyImg=!1;break}return this.hasContent=!!this.loader.source},t.prototype.renderCanvas=function(t){var r,n,i=this,o=this.loader,a=this.computedStyle;if(this.onlyImg){null===(r=this.canvasCache)||void 0===r||r.releaseImg(this._src);var s=o.width,l=o.height;if((p=this.canvasCache=Zx.getImgInstance(s,l,this._src)).available=!0,1===p.getCount(this._src))for(var u=0,c=(D=p.list).length;u<c;u++){var h=D[u],d=h.x,f=h.y;h.os.ctx.drawImage(o.source,-d,-f)}}else{e.prototype.renderCanvas.call(this,t);var p,v=this._bbox2||this.bbox2,g=(d=v[0],f=v[1],s=v[2]-d,l=v[3]-f,this._rect||this.rect),m=g[2]-g[0],y=g[3]-g[1],b=-d*t,x=-f*t;s*=t,l*=t,(p=this.canvasCache=Zx.getInstance(s,l,b,x)).available=!0;var w=a.fill,_=a.fillOpacity,E=a.fillEnable,S=a.fillMode,C=a.stroke,k=a.strokeEnable,T=a.strokeWidth,A=a.strokePosition,M=a.strokeMode,O=a.strokeDasharray,L=a.strokeLinecap,R=a.strokeLinejoin,I=a.strokeMiterlimit,F=a.innerShadow,P=a.innerShadowEnable,D=p.list,N=function(e,r){var a=D[e],u=a.x,c=a.y,h=a.os,d=h.ctx,f=h.canvas,p=-u,v=-c;d.drawImage(o.source,p,v,m*t,y*t),1!==t?d.setLineDash(O.map((function(e){return e*t}))):d.setLineDash(O);var g=[[0,0],[m,0],[m,y],[0,y],[0,0]];d.beginPath(),ox(d,g,t,p,v),d.closePath();for(var N=function(e,r){if(!E[e]||!_[e])return"continue";var o=void 0,a=w[e],u=void 0,c=S[e];if(c!==Hs.NORMAL&&(u=hl.getOffscreenCanvas(s,l)),d.globalAlpha=_[e],Array.isArray(a)){if(!a[3])return"continue";d.fillStyle=Tc(a)}else{if(a.url){var h=a.url;if(h){var C=B.loaders[e],k=hl.IMG[h];!C&&k&&(C=B.loaders[e]={error:!1,loading:!1,url:h,width:k.width,height:k.height,source:k.source});var T=hl.IMG[h];if(C){if(!C.error&&!C.loading){var A=u||hl.getOffscreenCanvas(s,l),M=A.ctx;if(a.type===el.TILE)for(var O=null!==(n=a.scale)&&void 0!==n?n:1,L=0,R=Math.ceil(m/O/C.width);L<R;L++)for(var I=0,F=Math.ceil(y/O/C.height);I<F;I++)M.drawImage(T.source,p+L*T.width*t*O,v+I*T.height*t*O,T.width*t*O,T.height*t*O);else if(a.type===el.FILL){var P=m*t/T.width,D=y*t/T.height,N=Math.max(P,D),U=-.5*(T.width*N-m*t),z=-.5*(T.height*N-y*t);M.drawImage(T.source,0,0,T.width,T.height,U+p,z+v,T.width*N,T.height*N)}else if(a.type===el.STRETCH)M.drawImage(T.source,p,v,m*t,y*t);else if(a.type===el.FIT){P=m*t/T.width,D=y*t/T.height,N=Math.min(P,D);var X=-.5*(T.width*N-m*t),H=-.5*(T.height*N-y*t);M.drawImage(T.source,0,0,T.width,T.height,X+p,H+v,T.width*N,T.height*N)}M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),c!==Hs.NORMAL&&(d.globalCompositeOperation=Jx(c)),d.drawImage(A.canvas,0,0),c!==Hs.NORMAL&&(d.globalCompositeOperation="source-atop"),A.release()}}else C=B.loaders[e]=B.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},hl.loadImg(h,(function(t){var r;h===(null===(r=w[e])||void 0===r?void 0:r.url)&&(C.loading=!1,t.success?(C.error=!1,C.source=t.source,C.width=t.width,C.height=t.height,i.isDestroyed||i.root.addUpdate(i,[],Qb.REPAINT,!1,!1,void 0)):C.error=!0)}))}return"continue"}if(a.t===js.LINEAR){var G=mc(a.stops,a.d,p,v,s-2*b,l-2*x),j=d.createLinearGradient(G.x1,G.y1,G.x2,G.y2);G.stop.forEach((function(e){j.addColorStop(e.offset,Tc(e.color))})),d.fillStyle=j}else if(a.t===js.RADIAL){G=yc(a.stops,a.d,p,v,s-2*b,l-2*x);var Y=d.createRadialGradient(G.cx,G.cy,0,G.cx,G.cy,G.total);G.stop.forEach((function(e){Y.addColorStop(e.offset,Tc(e.color))}));var W=G.matrix;if(W)(M=(o=hl.getOffscreenCanvas(s,l)).ctx).beginPath(),ox(M,g,t,p,v),M.closePath(),M.clip(),M.fillStyle=Y,M.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]),M.fill();else d.fillStyle=Y}else if(a.t===js.CONIC){G=bc(a.stops,a.d,p,v,s-2*b,l-2*x);var V=d.createConicGradient(G.angle,G.cx+p,G.cy+v);G.stop.forEach((function(e){V.addColorStop(e.offset,Tc(e.color))})),d.fillStyle=V}}if(o){if(u)(M=u.ctx).drawImage(o.canvas,0,0),M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),d.globalCompositeOperation=Jx(c),d.drawImage(u.canvas,0,0),u.release();else d.globalCompositeOperation="source-atop",d.drawImage(o.canvas,0,0);o.release()}else{if(u)(M=u.ctx).fillStyle=d.fillStyle,M.beginPath(),ox(M,g,t,p,v),M.closePath(),M.fill(),M.globalCompositeOperation="destination-atop",M.drawImage(f,0,0),d.globalCompositeOperation=Jx(c),d.drawImage(u.canvas,0,0),u.release();else d.globalCompositeOperation="source-atop",d.fill()}},U=0,z=w.length;U<z;U++)N(U);if(d.globalAlpha=1,d.globalCompositeOperation="source-atop",F&&F.length){var X=0;F.forEach((function(e,t){if(P[t]){var r=Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread;X=Math.max(X,r+e.blur)}})),d.save(),d.beginPath(),ox(d,g,t,p,p),d.closePath(),d.clip(),d.fillStyle="#FFF",d.beginPath(),ox(d,g,t,p,p),ox(d,[[-X,-X],[s+X,-X],[s+X,l+X],[-X,l+X],[-X,-X]],1,p,p),d.closePath(),F.forEach((function(e,t){P[t]&&(d.shadowOffsetX=e.x,d.shadowOffsetY=e.y,d.shadowColor=Tc(e.color),d.shadowBlur=e.blur,d.fill("evenodd"))})),d.restore()}L===Js.ROUND?d.lineCap="round":L===Js.SQUARE?d.lineCap="square":d.lineCap="butt",R===Qs.ROUND?d.lineJoin="round":R===Qs.BEVEL?d.lineJoin="bevel":d.lineJoin="miter",d.miterLimit=I*t;for(var H=function(e,r){if(!k[e]||!T[e])return"continue";var n=C[e],i=A[e];if(d.globalCompositeOperation=Jx(M[e]),Array.isArray(n))d.strokeStyle=Tc(n);else if(n.t===js.LINEAR){var o=mc(n.stops,n.d,p,v,s-2*b,l-2*x),a=d.createLinearGradient(o.x1,o.y1,o.x2,o.y2);o.stop.forEach((function(e){a.addColorStop(e.offset,Tc(e.color))})),d.strokeStyle=a}else if(n.t===js.RADIAL){o=yc(n.stops,n.d,p,v,s-2*b,l-2*x);var u=d.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.total);o.stop.forEach((function(e){u.addColorStop(e.offset,Tc(e.color))}));var c=o.matrix;if(c){var h=hl.getOffscreenCanvas(s,l),f=h.ctx;return f.setLineDash(d.getLineDash()),f.lineCap=d.lineCap,f.lineJoin=d.lineJoin,f.miterLimit=d.miterLimit*t,f.lineWidth=T[e]*t,f.strokeStyle="#FFF",f.beginPath(),ox(f,g,t,p,v),f.closePath(),i===$s.INSIDE?(f.lineWidth=2*T[e]*t,f.save(),f.clip(),f.stroke(),f.restore()):i===$s.OUTSIDE?(f.lineWidth=2*T[e]*t,f.stroke(),f.save(),f.clip(),f.globalCompositeOperation="destination-out",f.strokeStyle="#FFF",f.stroke(),f.restore()):f.stroke(),f.fillStyle=u,f.globalCompositeOperation="source-in",f.setTransform(c[0],c[1],c[4],c[5],c[12],c[13]),f.fillRect(0,0,s,l),d.drawImage(h.canvas,0,0),h.release(),"continue"}d.strokeStyle=u}else if(n.t===js.CONIC){o=bc(n.stops,n.d,p,v,s-2*b,l-2*x);var m=d.createConicGradient(o.angle,o.cx+p,o.cy+v);o.stop.forEach((function(e){m.addColorStop(e.offset,Tc(e.color))})),d.strokeStyle=m}var y=void 0,w=void 0;i===$s.INSIDE?d.lineWidth=2*T[e]*t:i===$s.OUTSIDE?((w=(y=hl.getOffscreenCanvas(s,l)).ctx).setLineDash(d.getLineDash()),w.lineCap=d.lineCap,w.lineJoin=d.lineJoin,w.miterLimit=d.miterLimit*t,w.strokeStyle=d.strokeStyle,w.lineWidth=2*T[e]*t,w.beginPath(),ox(w,g,t,p,v)):d.lineWidth=T[e]*t,w&&w.closePath(),i===$s.INSIDE?(d.save(),d.clip(),d.stroke(),d.restore()):i===$s.OUTSIDE?(w.stroke(),w.save(),w.clip(),w.globalCompositeOperation="destination-out",w.strokeStyle="#FFF",w.stroke(),w.restore(),d.drawImage(y.canvas,p-b,v-x),y.release()):d.stroke()},G=0,j=C.length;G<j;G++)H(G);d.globalCompositeOperation="source-over"},B=this;for(u=0,c=D.length;u<c;u++)N(u)}},t.prototype.genTexture=function(t,r,n){if(this.loader.source)if(this.onlyImg){var i=this.textureCache[0];if(i&&i.available)return void(this.textureCache[n]=this.textureTarget[n]=i);var o=this.root.props.uuid,a=(this._rect||this.rect).slice(0);if(a[0]=Math.floor(a[0]),a[1]=Math.floor(a[1]),a[2]=Math.ceil(a[2]),a[3]=Math.ceil(a[3]),Yx.hasImgInstance(o,this._src))return void(this.textureCache[n]=this.textureTarget[n]=this.textureCache[0]=Yx.getImgInstance(o,t,this._src,a));this.renderCanvas(r);var s=this.canvasCache;(null==s?void 0:s.available)&&(this.textureCache[n]=this.textureTarget[n]=this.textureCache[0]=Yx.getImgInstance(o,t,this._src,a,s),s.releaseImg(this._src))}else e.prototype.genTexture.call(this,t,r,n)},t.prototype.clearCache=function(t){var r=this;void 0===t&&(t=!1),this.onlyImg?(t&&this.textureCache.forEach((function(e){return null==e?void 0:e.releaseImg(r.root.props.uuid,r._src)})),this.textureTarget.splice(0),this.textureFilter.forEach((function(e){return null==e?void 0:e.release()})),this.textureMask.forEach((function(e){return null==e?void 0:e.release()}))):e.prototype.clearCache.call(this,t)},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid,r.src=this._src;var n=new t(r);return n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.BITMAP,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r,n,i,o,a;return Q(this,(function(l){switch(l.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=l.sent())._class=$.ClassValue.Bitmap,r.image={_class:"MSJSONFileReference",_ref_class:"MSImageData",_ref:""},r.fillReplacesImage=!1,(n=t.folder("images"))?[4,fetch(this._src)]:[3,3];case 2:i=l.sent(),o=i.blob(),a=this.props.md5||this.props.uuid||s(),n.file(a,o),r.image._ref="images/"+a,l.label=3;case 3:return[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this);var r=this.loader;r.loading&&t&&(t.imgLoadingCount--,r.loading=!1)}},Object.defineProperty(t.prototype,"src",{get:function(){return this._src},set:function(e){this._src!==e&&(this.clearCache(!0),this._src=e,this.loadAndRefresh())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===$s.OUTSIDE?a=Math.max(a,e):o[t]===$s.CENTER&&(a=Math.max(a,.5*e)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),t}(Wx);function $x(e,t,r,n,i){var o=e.slice(0);if(n===Qs.ROUND)return o[0]-=t,o[1]-=t,o[2]+=t,o[3]+=t,o;if(!r.length)return o;for(var a=[],s=[],l=r[0],u=l[0],c=l[1],h=1,d=r.length;h<d;h++){var f=0,p=0;2===(y=r[h]).length?(f=y[0]-u,p=y[1]-c,u=y[0],c=y[1],a.push([f,p])):4===y.length?(f=2*(u-2*y[0]+y[2])+2*y[0]-2*u,p=2*(c-2*y[1]+y[3])+2*y[1]-2*c,u=y[2],c=y[3],a.push([f,p])):6===y.length&&(f=3*(-u+3*y[0]-3*y[2]+y[4])+2*(3*u-6*y[0]+3*y[2])+3*y[0]-3*u,p=3*(-c+3*y[1]-3*y[3]+y[5])+2*(3*c-6*y[1]+3*y[3])+3*y[1]-3*c,u=y[4],c=y[5],a.push([f,p]));var v=Math.atan(Math.abs(p/f)),g=Math.sin(v)*t,m=Math.cos(v)*t;f>=0?p>=0?s.push([-g,m]):s.push([g,m]):p>=0?s.push([-g,-m]):s.push([g,-m])}for(h=0,d=a.length;h<d;h++){var y=a[h],b=a[(h+1)%d];if(y[0]&&y[1]&&b[0]&&b[1]){var x=Yl(y[0],y[1],b[0],b[1]),w=s[h],_=s[(h+1)%d];if(w[0]||w[1]||_[0]||_[1]){var E=0,S=0,C=0,k=0,T=[y[0]+w[0],y[1]+w[1]],A=Yl(y[0],y[1],T[0],T[1]);x>=0&&A>=0||x<0&&A<0?(E=-w[0],S=-w[1]):(E=w[0],S=w[1]);var M=[b[0]+_[0],b[1]+_[1]],O=Yl(b[0],b[1],M[0],M[1]);x>=0&&O>=0||x<0&&O<0?(C=-_[0],k=-_[1]):(C=_[0],k=_[1]);var L=r[h],R=r[h+1],I=r[(h+2)%d],F=L.length,P=R.length,D=I.length,N=L[F-2]+E,B=L[F-1]+S,U=R[P-2]+E,z=R[P-1]+S,X=R[P-2]+C,H=R[P-1]+k,G=Yu(N,B,U,z,X,H,I[D-2]+C,I[D-1]+k,!1);if(G&&1!==G.toSource&&0!==G.toClip)if(n===Qs.BEVEL)if((q=2*t/Math.sqrt(Math.pow(X-U,2)+Math.pow(H-z,2)))>=1)o[0]=Math.min(o[0],U,X),o[1]=Math.min(o[1],z,H),o[2]=Math.max(o[2],U,X),o[3]=Math.max(o[3],z,H);else{var j=G.x-(G.x-U)*q,Y=G.y-(G.y-z)*q,W=G.x-(G.x-X)*q,V=G.y-(G.y-H)*q;o[0]=Math.min(o[0],j,W),o[1]=Math.min(o[1],Y,V),o[2]=Math.max(o[2],j,W),o[3]=Math.max(o[3],Y,V)}else if(n===Qs.MITER){var q;if((q=Math.sqrt(Math.pow(G.x-R[P-2],2)+Math.pow(G.y-R[P-1],2))/t)>i){var K=2*t/Math.sqrt(Math.pow(X-U,2)+Math.pow(H-z,2));if(K>=1)o[0]=Math.min(o[0],U,X),o[1]=Math.min(o[1],z,H),o[2]=Math.max(o[2],U,X),o[3]=Math.max(o[3],z,H);else{j=G.x-(G.x-U)*K,Y=G.y-(G.y-z)*K,W=G.x-(G.x-X)*K,V=G.y-(G.y-H)*K;o[0]=Math.min(o[0],j,W),o[1]=Math.min(o[1],Y,V),o[2]=Math.max(o[2],j,W),o[3]=Math.max(o[3],Y,V)}}else o[0]=Math.min(o[0],G.x),o[1]=Math.min(o[1],G.y),o[2]=Math.max(o[2],G.x),o[3]=Math.max(o[3],G.y)}}}}return o}function ew(e,t,r,n,i){if(3===arguments.length){var o=t,a=o[0],s=o[1],l=o[2],u=o[3];if(!nu(r)){var c=pu({x:a,y:s},r),h=pu({x:a,y:u},r),d=pu({x:l,y:s},r),f=pu({x:l,y:u},r);a=Math.min(c.x,h.x,d.x,f.x),s=Math.min(c.y,h.y,d.y,f.y),l=Math.max(c.x,h.x,d.x,f.x),u=Math.max(c.y,h.y,d.y,f.y)}e[0]=Math.min(e[0],a),e[1]=Math.min(e[1],s),e[2]=Math.max(e[2],l),e[3]=Math.max(e[3],u)}else 2===arguments.length?(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3])):5===arguments.length&&(e[0]=Math.min(e[0],t),e[1]=Math.min(e[1],r),e[2]=Math.max(e[2],n),e[3]=Math.max(e[3],i))}function tw(e,t){var r,n;if(6===e.length)r=e[4],n=e[5];else if(4===e.length)r=e[2],n=e[3];else{if(2!==e.length)return;r=e[0],n=e[1]}return t[0]=r,t[1]=n,t[2]=r,t[3]=n,{x:r,y:n}}function rw(e,t,r,n){var i,o;if(4===e.length)i=e[2],o=e[3],ew(n,(a=Bu.bboxBezier(t,r,e[0],e[1],i,o))[0],a[1],a[2],a[3]);else if(6===e.length){var a;i=e[4],o=e[5],ew(n,(a=Bu.bboxBezier(t,r,e[0],e[1],e[2],e[3],i,o))[0],a[1],a[2],a[3])}else{if(2!==e.length)return;ew(n,i=e[0],o=e[1],i,o)}return{x:i,y:o}}function nw(e,t){var r=!0;t=t||new Float64Array(4);for(var n=0,i=0,o=0,a=e.length;o<a;o++){var s=e[o];if(r){if(!(l=tw(s,t))){hl.error("Unsupported point data: "+o+" - "+s.join(","));continue}n=l.x,i=l.y,r=!1}else{var l;if(!(l=rw(s,n,i,t))){hl.error("Unsupported point data: "+o+" - "+s.join(","));continue}n=l.x,i=l.y}}return t}var iw=function(e){function t(t){var r=e.call(this,t)||this;return r.isGeom=!0,r.loaders=[],r.points=[],r}return v(t,e),t.prototype.lay=function(t){e.prototype.lay.call(this,t),this.coords=void 0},t.prototype.calRepaintStyle=function(t){e.prototype.calRepaintStyle.call(this,t),this.coords=void 0,this._rect=void 0,this._bbox=void 0},t.prototype.buildPoints=function(){this.coords||(this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this.coords=[])},t.prototype.calContent=function(){return this.buildPoints(),this.hasContent=!!this.coords&&this.coords.length>1},t.prototype.isLine=function(){this.buildPoints();var e=this.coords;return!!e&&2===e.length&&2===e[0].length&&2===e[1].length},t.prototype.checkShapeChange=function(){for(var e=this.parent;e&&e.isShapeGroup;)e.clearPoints(),e=e.parent},t.prototype.toSvg=function(e,t){void 0===t&&(t=!1),this.buildPoints();var r=this.computedStyle,n=this.coords||[],i=new Float64Array(this.matrixWorld),o=[],a=0,s=0,l=0,u=0,c=!0;n.forEach((function(e,t){if(6===e.length){var r=pu({x:e[0],y:e[1]},i),n=pu({x:e[2],y:e[3]},i),h=pu({x:e[4],y:e[5]},i);o.push([r.x,r.y,n.x,n.y,h.x,h.y]),c?(c=!1,a=Math.min(r.x,n.x,h.x),s=Math.min(r.y,n.y,h.y),l=Math.max(r.x,n.x,h.x),u=Math.max(r.y,n.y,h.y)):(a=Math.min(a,r.x,n.x,h.x),s=Math.min(s,r.y,n.y,h.y),l=Math.max(l,r.x,n.x,h.x),u=Math.max(u,r.y,n.y,h.y))}else if(4===e.length){r=pu({x:e[0],y:e[1]},i),n=pu({x:e[2],y:e[3]},i);o.push([r.x,r.y,n.x,n.y]),c?(c=!1,a=Math.min(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.x,n.x),u=Math.max(r.y,n.y)):(a=Math.min(a,r.x,n.x),s=Math.min(s,r.y,n.y),l=Math.max(l,r.x,n.x),u=Math.max(u,r.y,n.y))}else if(2===e.length){var d=pu({x:e[0],y:e[1]},i);o.push([d.x,d.y]),c?(c=!1,a=d.x,s=d.y,l=d.x,u=d.y):(a=Math.min(a,d.x),s=Math.min(s,d.y),l=Math.max(l,d.x),u=Math.max(u,d.y))}}));var h=l-a||1,d=u-s||1,f=1;f=h>=d?e/h:e/d;var p=ax(o.map((function(e){return e.map((function(e){return e*f}))})),-a*f,-s*f);p&&t&&(p+="Z");var v=[["d",p],["fill","#D8D8D8"],["fill-rule",r.fillRule===Ks.EVEN_ODD?"evenodd":"nonzero"],["stroke","#979797"],["stroke-width",1]],g='<svg width="'.concat(h*f,'" height="').concat(d*f,'"><path');return v.forEach((function(e){g+=" "+e[0]+'="'+e[1]+'"'})),g+"></path></svg>"},Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;if(!e){e=this._rect=new Float64Array(4),this.buildPoints();var t=this.coords;t&&t.length&&nw(t,e);var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=0;if(n.forEach((function(e,t){i[t]&&(o=Math.max(o,e))})),e[2]-e[0]<o){var a=.5*o;e[0]-=a,e[2]+=a}if(e[3]-e[1]<o){a=.5*o;e[1]-=a,e[3]+=a}}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rectLine",{get:function(){var e=new Float64Array(4);this.buildPoints();var t=this.coords;return t&&t.length&&nw(t,e),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.buildPoints();var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=r.strokeLinecap,s=r.strokeLinejoin,l=r.strokeMiterlimit,u=0;n.forEach((function(e,t){i[t]&&(o[t]===$s.OUTSIDE?u=Math.max(u,e):o[t]===$s.CENTER&&(u=Math.max(u,.5*e)))}));var c=e[0]-u,h=e[1]-u,d=e[2]+u,f=e[3]+u;e=this.isLine()?this._bbox=function(e,t,r,n){var i=e.slice(0);if(n===Js.ROUND&&(i[0]-=t,i[1]-=t,i[2]+=t,i[3]+=t),!r.length)return i;for(var o=r[0],a=r[r.length-1],s=a.length,l=[],u=0;u<s;u+=2)l.push({x:a[u],y:a[u+1]});var c=0,h=0;s>2?(c=Math.abs(Pu(l,0)),h=Math.abs(Pu(l,1))):c=h=Math.abs(a[s-1]-o[1])/Math.abs(a[s-2]-o[0]);var d=Math.atan(c),f=Math.atan(h),p=Math.sin(d),v=Math.cos(d),g=Math.sin(f),m=Math.cos(f),y=p===1/0?t:Math.abs(p*t),b=v===1/0?t:Math.abs(v*t),x=g===1/0?t:Math.abs(g*t),w=m===1/0?t:Math.abs(m*t);return n===Js.BUTT?(i[0]=Math.min(i[0],o[0]-y,a[s-2]-x),i[1]=Math.min(i[1],o[1]-b,a[s-1]-w),i[2]=Math.max(i[2],o[0]+y,a[s-2]+x),i[3]=Math.max(i[3],o[1]+b,a[s-1]+w)):n===Js.SQUARE&&(i[0]=Math.min(i[0],o[0]-y-b,a[s-2]-x-w),i[1]=Math.min(i[1],o[1]-y-b,a[s-1]-x-w),i[2]=Math.max(i[2],o[0]+y+b,a[s-2]+x+w),i[3]=Math.max(i[3],o[1]+y+b,a[s-1]+x+w)),i}(e,u,this.coords||[],a):this._bbox=$x(e,u,this.coords||[],s,l),e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],h),e[2]=Math.max(e[2],d),e[3]=Math.max(e[3],f)}return e},enumerable:!1,configurable:!0}),t}(Wx);function ow(e){return e.curveMode===Vs.STRAIGHT&&e.cornerRadius>0}function aw(e,t,r,n,i,o){var a=ec(e.absX,e.absY,t.absX,t.absY),s=ec(t.absX,t.absY,r.absX,r.absY),l=tc(ec(e.absX,e.absY,r.absX,r.absY),a,s),u=Math.tan(.5*l),c=o/u,h=Math.min(n?.5*a:a,i?.5*s:s);c>h&&(o=(c=h)*u);var d=Zl(e.absX-t.absX,e.absY-t.absY),f=Zl(r.absX-t.absX,r.absY-t.absY),p={x:d.x*c,y:d.y*c};p.x+=t.absX,p.y+=t.absY;var v={x:f.x*c,y:f.y*c};v.x+=t.absX,v.y+=t.absY;var g=4/3*Math.tan((Math.PI-l)/4),m={x:d.x*-o*g,y:d.y*-o*g};m.x+=p.x,m.y+=p.y;var y={x:f.x*-o*g,y:f.y*-o*g};return y.x+=v.x,y.y+=v.y,{prevTangent:p,prevHandle:m,nextTangent:v,nextHandle:y}}function sw(e,t,r,n,i,o){var a,s,l,u;if(n){var c=Math.sqrt(Math.pow(t.absX-e.absX,2)+Math.pow(t.absY-e.absY,2));o=Math.min(o,.5*c)}if(i){c=Math.sqrt(Math.pow(t.absX-r.absX,2)+Math.pow(t.absY-r.absY,2));o=Math.min(o,.5*c)}var h=e.absFx-t.absX,d=e.absFy-t.absY,f=r.absTx-t.absX,p=r.absTy-t.absY,v=e.absX-t.absX,g=e.absY-t.absY,m=r.absX-t.absX,y=r.absY-t.absY,b=Yl(h,d,f,p),x=Yl(v,g,m,y),w=Yl(h,d,v,g),_=Yl(f,p,m,y);if(!(Math.abs(b)<1e-6)){var E=[{x:e.absX,y:e.absY},{x:null!==(a=e.absFx)&&void 0!==a?a:e.absX,y:null!==(s=e.absFy)&&void 0!==s?s:e.absY},{x:t.absX,y:t.absY}],S=[{x:t.absX,y:t.absY},{x:null!==(l=r.absTx)&&void 0!==l?l:r.absX,y:null!==(u=r.absTy)&&void 0!==u?u:r.absY},{x:r.absX,y:r.absY}],C=Ku.intersectBezier2Bezier2(E[0].x,E[0].y,E[1].x,E[1].y,E[2].x,E[2].y,S[0].x,S[0].y,S[1].x,S[1].y,S[2].x,S[2].y).filter((function(e){return e.x!==S[0].x&&e.y!==S[0].y})).sort((function(e,t){return e.t1===t.t1?t.t2-e.t2:t.t1-e.t1})),k=C.length;if(!k)return lw(E,S,t,k,!1,b,x,w,_,o,0,1,0,1);var T=C.map((function(e){return e.t1})),A=C.map((function(e){return Fu(S,e.x,e.y)[0]}));if(!A.find((function(e){return void 0===e}))){var M=!1;T.unshift(1),T.push(0),A.unshift(0),A.push(1);for(var O=0;O<=k;O++){var L=lw(E,S,t,k,M,b,x,w,_,o,T[O+1],T[O],A[O],A[O+1]);if(L)return L;M=!M}}}}function lw(e,t,r,n,i,o,a,s,l,u,c,h,d,f){var p=cw(e,n,i,o,a,s,u,!0,c,h),v=cw(t,n,i,o,a,l,u,!1,d,f);if(!(!p||p.length<2||!v||v.length<2)){var g=function(e,t){var r=fw(e,0),n=fw(t,1),i=function(e){var t={};e.forEach((function(e){var r,n=e.x1,i=e.x2;n>i&&(n=(r=[i,n])[0],i=r[1]),hw(t,n,e),hw(t,i,e)}));var r=[];return Object.keys(t).forEach((function(e){return r.push({x:parseFloat(e),arr:t[e]})})),r.sort((function(e,t){return e.x-t.x}))}(r.concat(n)),o=[],a=[],s=[];for(;i.length;){a.length&&a.splice(0).forEach((function(e){var t=o.indexOf(e);o.splice(t,1)}));for(var l=i.shift().arr;l.length;){var u=l.shift();if(!u.isDeleted){var c=u.belong,h=u.bbox;if(u.isVisited)a.push(u);else{if(o.length)for(var d=u.x1,f=u.y1,p=u.x2,v=u.y2,g=u.bbox,m=0;m<o.length;m++){var y=o[m];if(!y.isDeleted&&!u.isDeleted&&y.belong!==c){var b=y.x1,x=y.y1,w=y.x2,_=y.y2;if(rc(h[0],h[1],h[2],h[3],g[0],g[1],g[2],g[3],!0)){var E=(_-x)*(p-d)-(w-b)*(v-f);if(0!==E){var S=((w-b)*(f-x)-(_-x)*(d-b))/E,C=((p-d)*(f-x)-(v-f)*(d-b))/E;if(S>=0&&S<=1&&C>=0&&C<=1){var k=d+S*(p-d),T=f+S*(v-f);s.push({x:k,y:T,t1:0===c?u.t:y.t,t2:0===c?y.t:u.t}),u.isDeleted=!0;break}}}}}u.isDeleted||(o.push(u),u.isVisited=!0)}}}}return s}(p,v);if(g.length){var m=g[0];if(g.length>1)for(var y=Math.pow(r.absX-m.x,2)+Math.pow(r.absY-m.y,2),b=1,x=g.length;b<x;b++){var w=g[b],_=Math.pow(r.absX-w.x,2)+Math.pow(r.absY-w.y,2);_<y&&(m=w,y=_)}var E=Lu(e,m.t1),S=Lu(t,m.t2),C=Pu(e,m.t1),k=Pu(t,m.t2),T=E.y-C*E.x,A=(S.y-k*S.x-T)/(C-k),M=C*A+T;Math.abs(C)<1e-9?(M=E.y,k!==1/0&&k!==-1/0||(A=S.x)):Math.abs(k)<1e-9?(M=S.y,C!==1/0&&C!==-1/0||(A=E.x)):C===1/0||C===-1/0?(A=E.x,M=S.y):k!==1/0&&k!==-1/0||(A=S.x,M=E.y);var O=ec(E.x,E.y,A,M),L=ec(A,M,S.x,S.y),R=tc(ec(E.x,E.y,S.x,S.y),O,L),I=4/3*Math.tan((Math.PI-R)/4),F=Zl(E.x-A,E.y-M),P=Zl(S.x-A,S.y-M),D={x:F.x*-u*I,y:F.y*-u*I};D.x+=E.x,D.y+=E.y;var N={x:P.x*-u*I,y:P.y*-u*I};return N.x+=S.x,N.y+=S.y,{prevTangent:E,prevHandle:D,nextTangent:S,nextHandle:N,t1:m.t1,t2:m.t2}}}}var uw={11010:1,11e3:1,11110:1,11100:1,11001:1,11111:1,11012:1,11002:1,11112:1,11102:1,11013:1,11103:1,10010:0,10100:0,10011:0,10001:0,10111:0,10101:0,"00010":0,"00000":0,"00110":0,"00100":0,"00011":0,"00101":0,"00002":0,"00012":0,"00102":0,"00112":0,"00003":0,"00103":0,"01000":1,"01110":1,"01001":1,"01011":1,"01101":1,"01111":1};function cw(e,t,r,n,i,o,a,s,l,u){var c=(i>=0?"0":"1")+(n>=0?"0":"1")+(s?"0":"1")+(o>=0?"0":"1")+t;if(uw.hasOwnProperty(c)){for(var h=Math.ceil(Tu(e)),d=[],f=function(t){var n=t/h;if(n<=l||n>u)return"continue";var i,o=2*(e[0].x-2*e[1].x+e[2].x)*n+2*e[1].x-2*e[0].x,s=2*(e[0].y-2*e[1].y+e[2].y)*n+2*e[1].y-2*e[0].y,f=Lu(e,n),p=Pu(e,n),v=0;v=Math.abs(p)<1e-12?1/0:p===1/0||p===-1/0?0:-1/p,i=v===1/0?f.y:f.y-v*f.x;var g=void 0,m=void 0;v===1/0?(g=[f.x,f.x],m=[f.y-a,f.y+a]):m=(g=xu([Math.pow(f.x,2)+Math.pow(i,2)-2*f.y*i+Math.pow(f.y,2)-Math.pow(a,2),2*(i*v-f.x-f.y*v),Math.pow(v,2)+1])).map((function(e){return v*e+i}));var y=Yl(g[0]-f.x,m[0]-f.y,o,s)>=0?0:1;r&&(y=(y+1)%2),uw[c]===y?d.push({x:g[0],y:m[0],t:n}):d.push({x:g[1],y:m[1],t:n})},p=0;p<=h;p++)f(p);return d}}function hw(e,t,r){var n=e[t]=e[t]||[];r.isVisited?(n.unshift(r),r.isVisited=!1):(n.push(r),r.isVisited=!0)}var dw=0;function fw(e,t){for(var r,n,i=[],o=1,a=e.length;o<a;o++){var s=e[o-1],l=s.x,u=s.y,c=s.t,h=e[o],d=h.x,f=h.y,p=h.t;(d<l||l===d&&f<u)&&(l=(r=[d,l])[0],d=r[1],u=(n=[f,u])[0],f=n[1]);var v=[l,Math.min(u,f),d,Math.max(u,f)];i.push({id:dw++,x1:l,y1:u,x2:d,y2:f,bbox:v,belong:t,isVisited:!1,isDeleted:!1,t:.5*(c+p)})}return i}var pw=function(e){function t(t){var r=e.call(this,t)||this;return r.props=t,r.points=Rs(t.points||[]),r.isPolyline=!0,r}return v(t,e),t.prototype.buildPoints=function(){var e;if(!this.coords){this.textureOutline.forEach((function(e){return null==e?void 0:e.release()})),this.coords=[];var t=this.width,r=this.height,n=this.points;if(n.length){for(var i=!1,o=0,a=n.length;o<a;o++){(R=n[o]).absX=(R.x||0)*t,R.absY=(R.y||0)*r,ow(R)?i=!0:(R.hasCurveTo&&(R.absTx=R.tx*t,R.absTy=R.ty*r),R.hasCurveFrom&&(R.absFx=R.fx*t,R.absFy=R.fy*r))}var s=[];if(i){o=0;for(var l=n.length;o<l;o++){var u=n[o];if(ow(u)){var c=(o+1)%l,h=n[o?o-1:l-1],d=n[c],f=u.cornerRadius,p=ow(h),v=p||h.curveMode===Vs.STRAIGHT||!h.hasCurveFrom,g=ow(d),m=g||d.curveMode===Vs.STRAIGHT||!d.hasCurveTo;s[o]=v&&m?aw(h,u,d,p,g,f):sw(h,u,d,p,g,f)}}}for(var y=Rs(n),b=(o=0,y.length);o<b;o++){var x=s[o];if(x){var w=x.prevTangent,_=x.prevHandle,E=x.nextTangent,S=x.nextHandle,C={x:0,y:0,cornerRadius:0,cornerStyle:0,curveMode:0,hasCurveFrom:!0,fx:0,fy:0,hasCurveTo:!1,tx:0,ty:0,absX:w.x,absY:w.y,absFx:_.x,absFy:_.y,absTx:0,absTy:0},k={x:0,y:0,cornerRadius:0,cornerStyle:0,curveMode:0,hasCurveFrom:!1,fx:0,fy:0,hasCurveTo:!0,tx:0,ty:0,absX:E.x,absY:E.y,absFx:0,absFy:0,absTx:S.x,absTy:S.y};if(x.t1){var T=Ou([{x:(I=y[(o+b-1)%b]).absX,y:I.absY},{x:I.absFx,y:I.absFy},{x:y[o].absX,y:y[o].absY}],0,x.t1);I.absFx=T[1].x,I.absFy=T[1].y}if(x.t2){var A=y[(o+1)%b];T=Ou([{x:A.absX,y:A.absY},{x:A.absTx,y:A.absTy},{x:y[o].absX,y:y[o].absY}],0,1-x.t2);A.absTx=T[1].x,A.absTy=T[1].y}y.splice(o,1,C,k),o++,b++,s.splice(o,0,void 0)}}var M=y[0],O=[[M.absX,M.absY]],L=y.length;for(o=1;o<L;o++){var R=y[o],I=y[o-1],F=[R.absX,R.absY];R.hasCurveTo&&F.unshift(R.absTx,R.absTy),I.hasCurveFrom&&F.unshift(I.absFx,I.absFy),O.push(F)}if(this.props.isClosed){var P=y[L-1],D=[M.absX,M.absY];M.hasCurveTo&&D.unshift(M.absTx,M.absTy),P.hasCurveFrom&&D.unshift(P.absFx,P.absFy),O.push(D)}(e=this.coords).push.apply(e,O)}}},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t),this.buildPoints();var i=this.coords;if(i&&i.length){var o=this._bbox2||this.bbox2,a=o[0],s=o[1],l=o[2]-a,u=o[3]-s,c=-a*t,h=-s*t;l*=t,u*=t;var d=this.canvasCache=Zx.getInstance(l,u,c,h);d.available=!0;for(var f=this.computedStyle,p=f.fill,v=f.fillOpacity,g=f.fillRule,m=f.fillEnable,y=f.fillMode,b=f.stroke,x=f.strokeEnable,w=f.strokeWidth,_=f.strokePosition,E=f.strokeMode,S=f.strokeDasharray,C=f.strokeLinecap,k=f.strokeLinejoin,T=f.strokeMiterlimit,A=this.isLine(),M=d.list,O=function(e,o){var a=M[e],s=a.x,d=a.y,f=a.os.ctx,O=-s,R=-d;1!==t?f.setLineDash(S.map((function(e){return e*t}))):f.setLineDash(S),f.beginPath(),ox(f,i,t,O,R),L.props.isClosed&&f.closePath();for(var I=function(e,o){if(!m[e]||!v[e])return"continue";var a=p[e],s=void 0,d=y[e];if(f.globalAlpha=v[e],Array.isArray(a)){if(a[3]<=0)return"continue";f.fillStyle=Tc(a)}else{if(void 0!==a.url){var b=a.url;if(b){var x=L.loaders[e],w=hl.IMG[b];if(!x&&w&&w.source&&(x=L.loaders[e]={error:!1,loading:!1,width:w.width,height:w.height,source:w.source}),x)if(x.error||x.loading||!x.source)x.error||x.loading||L.root.imgLoadingCount++;else{var _=L.width,E=L.height,S=_*t,C=E*t,k=hl.getOffscreenCanvas(l,u);if((Y=k.ctx).beginPath(),ox(Y,i,t,O,R),L.props.isClosed&&Y.closePath(),Y.save(),Y.clip(),a.type===el.TILE)for(var T=null!==(r=a.scale)&&void 0!==r?r:1,A=0,M=Math.ceil(_/T/x.width);A<M;A++)for(var I=0,F=Math.ceil(E/T/x.height);I<F;I++)Y.drawImage(x.source,O+A*x.width*t*T,R+I*x.height*t*T,x.width*t*T,x.height*t*T);else if(a.type===el.FILL){var P=S/x.width,D=C/x.height,N=Math.max(P,D),B=-.5*(x.width*N-S),U=-.5*(x.height*N-C);Y.drawImage(x.source,0,0,x.width,x.height,B+O,U+R,x.width*N,x.height*N)}else if(a.type===el.STRETCH)Y.drawImage(x.source,O,R,S,C);else if(a.type===el.FIT){P=S/x.width,D=C/x.height,N=Math.min(P,D);var z=-.5*(x.width*N-S),X=-.5*(x.height*N-C);Y.drawImage(x.source,0,0,x.width,x.height,z+O,X+R,x.width*N,x.height*N)}Y.restore(),d!==Hs.NORMAL&&(f.globalCompositeOperation=Jx(d)),f.drawImage(k.canvas,0,0),d!==Hs.NORMAL&&(f.globalCompositeOperation="source-over"),k.release()}else L.root.imgLoadingCount++,x=L.loaders[e]=L.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},hl.loadImg(b,(function(t){var r;b===(null===(r=p[e])||void 0===r?void 0:r.url)&&(x.loading=!1,t.success?(x.error=!1,x.source=t.source,x.width=t.width,x.height=t.height,n.isDestroyed||n.root.addUpdate(n,[],Qb.REPAINT,!1,!1,void 0)):x.error=!0,n.root.imgLoadingCount--)}))}return"continue"}if(a.t===js.LINEAR){var H=mc(a.stops,a.d,O,R,l-2*c,u-2*h),G=f.createLinearGradient(H.x1,H.y1,H.x2,H.y2);H.stop.forEach((function(e){G.addColorStop(e.offset,Tc(e.color))})),f.fillStyle=G}else if(a.t===js.RADIAL){H=yc(a.stops,a.d,O,R,l-2*c,u-2*h);var j=f.createRadialGradient(H.cx,H.cy,0,H.cx,H.cy,H.total);H.stop.forEach((function(e){j.addColorStop(e.offset,Tc(e.color))}));var Y,W=H.matrix;if(W)(Y=(s=hl.getOffscreenCanvas(l,u)).ctx).beginPath(),ox(Y,i,t,O,R),L.props.isClosed&&Y.closePath(),Y.clip(),Y.fillStyle=j,Y.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]),Y.fill(g===Ks.EVEN_ODD?"evenodd":"nonzero");else f.fillStyle=j}else if(a.t===js.CONIC){H=bc(a.stops,a.d,O,R,l-2*c,u-2*h);var V=f.createConicGradient(H.angle,H.cx+O,H.cy+R);H.stop.forEach((function(e){V.addColorStop(e.offset,Tc(e.color))})),f.fillStyle=V}}d!==Hs.NORMAL&&(f.globalCompositeOperation=Jx(d)),s?(f.drawImage(s.canvas,0,0),s.release()):f.fill(g===Ks.EVEN_ODD?"evenodd":"nonzero"),d!==Hs.NORMAL&&(f.globalCompositeOperation="source-over")},F=0,P=p.length;F<P;F++)I(F);f.globalAlpha=1,f.globalCompositeOperation="source-over";var D=L.computedStyle,N=D.innerShadow,B=D.innerShadowEnable;if(N&&N.length){var U=!1,z=0;N.forEach((function(e,r){if(B[r]){U=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread)*t;z=Math.max(z,n+e.blur*t)}})),U&&(f.save(),f.beginPath(),ox(f,i,t,O,R),L.props.isClosed&&f.closePath(),f.clip(),f.fillStyle="#FFF",f.beginPath(),ox(f,i,t,O,R),ox(f,[[-z,-z],[l+z,-z],[l+z,u+z],[-z,u+z],[-z,-z]],1,O,R),f.closePath(),N.forEach((function(e,r){B[r]&&(f.shadowOffsetX=e.x*t,f.shadowOffsetY=e.y*t,f.shadowColor=Tc(e.color),f.shadowBlur=e.blur*t,f.fill("evenodd"))})),f.restore(),f.beginPath(),ox(f,i,t,O,R),L.props.isClosed&&f.closePath())}C===Js.ROUND?f.lineCap="round":C===Js.SQUARE?f.lineCap="square":f.lineCap="butt",k===Qs.ROUND?f.lineJoin="round":k===Qs.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=T;for(var X=function(e,r){if(!x[e]||!w[e])return"continue";var n=b[e],o=_[e];if(f.globalCompositeOperation=Jx(E[e]),Array.isArray(n))f.strokeStyle=Tc(n);else if(n.t===js.LINEAR){var a=mc(n.stops,n.d,O,R,l-2*O,u-2*R),s=f.createLinearGradient(a.x1,a.y1,a.x2,a.y2);a.stop.forEach((function(e){s.addColorStop(e.offset,Tc(e.color))})),f.strokeStyle=s}else if(n.t===js.RADIAL){a=yc(n.stops,n.d,O,R,l-2*O,u-2*R);var d=f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.total);a.stop.forEach((function(e){d.addColorStop(e.offset,Tc(e.color))}));var p=a.matrix;if(p){var v=hl.getOffscreenCanvas(l,u),g=v.ctx;return g.setLineDash(f.getLineDash()),g.lineCap=f.lineCap,g.lineJoin=f.lineJoin,g.miterLimit=f.miterLimit,g.lineWidth=w[e]*t,g.strokeStyle="#FFF",g.beginPath(),ox(g,i,t,O,R),L.props.isClosed&&g.closePath(),o===$s.INSIDE?(g.lineWidth=2*w[e]*t,g.save(),A||g.clip(),g.stroke(),g.restore()):o===$s.OUTSIDE?(g.lineWidth=2*w[e]*t,g.stroke(),g.save(),A||g.clip(),g.globalCompositeOperation="destination-out",g.strokeStyle="#FFF",g.stroke(),g.restore()):g.stroke(),g.fillStyle=d,g.globalCompositeOperation="source-in",g.setTransform(p[0],p[1],p[4],p[5],p[12],p[13]),g.fillRect(0,0,l,u),f.drawImage(v.canvas,0,0),v.release(),"continue"}f.strokeStyle=d}else if(n.t===js.CONIC){a=bc(n.stops,n.d,O,R,l-2*O,u-2*R);var m=f.createConicGradient(a.angle,a.cx+O,a.cy+R);a.stop.forEach((function(e){m.addColorStop(e.offset,Tc(e.color))})),f.strokeStyle=m}var y=void 0,S=void 0;o===$s.INSIDE?f.lineWidth=2*w[e]*t:o===$s.OUTSIDE?((S=(y=hl.getOffscreenCanvas(l,u)).ctx).setLineDash(f.getLineDash()),S.lineCap=f.lineCap,S.lineJoin=f.lineJoin,S.miterLimit=f.miterLimit,S.strokeStyle=f.strokeStyle,S.lineWidth=2*w[e]*t,S.beginPath(),ox(S,i,t,O,R)):f.lineWidth=w[e]*t,L.props.isClosed&&S&&S.closePath(),o===$s.INSIDE?(f.save(),A||f.clip(),f.stroke(),f.restore()):o===$s.OUTSIDE?(S.stroke(),S.save(),A||S.clip(),S.globalCompositeOperation="destination-out",S.strokeStyle="#FFF",S.stroke(),S.restore(),f.drawImage(y.canvas,O-c,R-h),y.release()):f.stroke()},H=0,G=b.length;H<G;H++)X(H);f.globalCompositeOperation="source-over"},L=this,R=0,I=M.length;R<I;R++)O(R)}},t.prototype.updatePointsBaseOnAP=function(e,t){var r,n,i,o;if(!e.length)return e;var a=this.props.points,s=this.width,l=this.height,u=au(t),c=0,h=0;return this.artBoard||(c=(null===(n=(null===(r=this.page)||void 0===r?void 0:r.props).rule)||void 0===n?void 0:n.baseX)||0,h=(null===(o=(null===(i=this.page)||void 0===i?void 0:i.props).rule)||void 0===o?void 0:o.baseY)||0),e.forEach((function(e){if(-1===a.indexOf(e))throw new Error("Can not update non-existent point");var t=pu({x:e.dspX+c,y:e.dspY+h},u);if(e.absX=t.x,e.absY=t.y,e.x=t.x/s,e.y=t.y/l,e.hasCurveFrom){var r=pu({x:e.dspFx+c,y:e.dspFy+h},u);e.absFx=r.x,e.absFy=r.y,e.fx=r.x/s,e.fy=r.y/l}if(e.hasCurveTo){var n=pu({x:e.dspTx+c,y:e.dspTy+h},u);e.absTx=n.x,e.absTy=n.y,e.tx=n.x/s,e.ty=n.y/l}})),this.refresh(),e},t.prototype.checkPointsChange=function(){this._rect=void 0,this._bbox=void 0;var e=this.rect,t=e[0],r=e[1],n=e[2]-this.width,i=e[3]-this.height;(t||r||n||i)&&(this.adjustPosAndSizeSelf(t,r,n,i),this.adjustPoints(t,r),this.checkPosSizeUpward())},t.prototype.adjustPoints=function(e,t){var r=this.width,n=this.height;this.points.forEach((function(i){i.x=(i.absX-e)/r,i.y=(i.absY-t)/n,i.hasCurveFrom&&(i.fx=(i.absFx-e)/r,i.fy=(i.absFy-t)/n),i.hasCurveTo&&(i.tx=(i.absTx-e)/r,i.ty=(i.absTy-t)/n)})),this.points.splice(0)},t.prototype.toSvg=function(t){return e.prototype.toSvg.call(this,t,this.props.isClosed)},t.prototype.clone=function(e){var r=Rs(this.props),n=r.uuid;r.uuid=s(),r.sourceUuid=this.props.uuid;var i=new t(r);return i.style=Rs(this.style),i.computedStyle=Rs(this.computedStyle),e&&e.hasOwnProperty(n)&&e[n].forEach((function(e){var t=e.key,n=e.value;if("fill"===t[0]){var o=parseInt(t[1])||0;r.style.fill[o]=n,i.style.fill[o]={v:kc(n),u:Us.RGBA}}})),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.POLYLINE,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r;return Q(this,(function(n){switch(n.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=n.sent())._class=$.ClassValue.ShapePath,r.isClosed=this.props.isClosed,r.points=this.points.map((function(e){return{_class:"curvePoint",cornerRadius:e.cornerRadius,cornerStyle:[$.CornerStyle.Rounded,$.CornerStyle.RoundedInverted,$.CornerStyle.Angled,$.CornerStyle.Squared][e.cornerStyle||0],curveMode:[$.CurveMode.None,$.CurveMode.Straight,$.CurveMode.Mirrored,$.CurveMode.Asymmetric,$.CurveMode.Disconnected][e.curveMode||0],hasCurveFrom:e.hasCurveFrom,hasCurveTo:e.hasCurveTo,curveFrom:"{"+e.fx+", "+e.fy+"}",curveTo:"{"+e.tx+", "+e.ty+"}",point:"{"+e.x+", "+e.y+"}"}})),[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this),t&&this.loaders.forEach((function(e){e.loading&&(t.imgLoadingCount--,e.loading=!1)}))}},t}(iw),vw=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.toString=function(){return this.x+","+this.y},e.prototype.equal=function(e){return this===e||this.x===e.x&&this.y===e.y},e.prototype.equalEps=function(e,t){return void 0===t&&(t=.01),Math.abs(100*this.x-100*e.x)<=100*t&&Math.abs(100*this.y-100*e.y)<=100*t},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.minus=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.compare=function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y},e.toPoint=function(e){return{x:e[0],y:e[1]}},e.toPoints=function(t){return t.map((function(t){return e.toPoint(t)}))},e}(),gw=.001;function mw(e){e.sort((function(e,t){return e.x===t.x?e.y-t.y:e.x-t.x}));for(var t=e.length-1;t>=1;t--){var r=e[t],n=e[t-1];r.x=Math.round(r.x),r.y=Math.round(r.y),n.x=Math.round(n.x),n.y=Math.round(n.y),r.x===n.x&&r.y===n.y&&e.splice(t,1)}return e.map((function(e){return{point:new vw(Math.round(e.x),Math.round(e.y)),toSource:e.t1,toClip:e.t2}}))}var yw=function(e,t,r,n,i,o,a,s){var l=Ku.intersectLineLine(e,t,r,n,i,o,a,s,!0);if(l)return[{point:new vw(Math.round(l.x),Math.round(l.y)),toSource:l.toSource,toClip:l.toClip}]},bw=function(e,t,r,n,i,o,a,s,l,u){var c=Ku.intersectBezier2Line(e,t,r,n,i,o,a,s,l,u,gw,1);if(c.length)return mw(c)},xw=function(e,t,r,n,i,o,a,s,l,u,c,h){var d=Ku.intersectBezier2Bezier2(e,t,r,n,i,o,a,s,l,u,c,h,gw,1);if(d.length)return mw(d)},ww=function(e,t,r,n,i,o,a,s,l,u,c,h,d,f){var p=Ku.intersectBezier2Bezier3(e,t,r,n,i,o,a,s,l,u,c,h,d,f,gw,1);if(p.length)return mw(p)},_w=function(e,t,r,n,i,o,a,s,l,u,c,h){var d=Ku.intersectBezier3Line(e,t,r,n,i,o,a,s,l,u,c,h,gw,1);if(d.length)return mw(d)},Ew=function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,v){var g=Ku.intersectBezier3Bezier3(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,v,gw,1);if(g.length)return mw(g)},Sw=function(e,t){return e.sort((function(e,r){return t?e.toSource-r.toSource:e.toClip-r.toClip})).map((function(e){return{point:e.point,t:t?e.toSource:e.toClip}}))},Cw=0,kw=function(){function e(e,t){if(this.uuid=Cw++,e.length>2){for(var r=e[0],n=!0,i=!0,o=1,a=e.length;o<a;o++){var s=e[o];if(s.x!==r.x&&(n=!1),s.y!==r.y&&(i=!1),!n&&!i)break}if(n||i)e.splice(1,e.length-2);else{var l=e[e.length-1],u=(l.y-r.y)/(l.x-r.x),c=!0;for(o=1;o<e.length-1;o++){var h=e[o],d=(h.y-r.y)/(h.x-r.x);if(isNaN(u)||isNaN(d)){if(u!==d){c=!1;break}}else if(u===1/0||u===-1/0){if(u!==d){c=!1;break}}else if(Math.abs(d-u)>1e-9){c=!1;break}}c&&e.splice(1,e.length-2)}}this.coords=e,this.belong=t,this.bbox=this.calBbox(),this.myFill=[!1,!1],this.otherFill=[!1,!1],this.myCoincide=0,this.otherCoincide=0,this.isVisited=!1,this.isDeleted=!1}return e.prototype.calBbox=function(){var e=this.coords,t=e.length,r=e[0],n=e[1];if(2===t)return[Math.min(r.x,n.x),Math.min(r.y,n.y),Math.max(r.x,n.x),Math.max(r.y,n.y)];var i=e[2];if(3===t)return Bu.bboxBezier(r.x,r.y,n.x,n.y,i.x,i.y);var o=e[3];return Bu.bboxBezier(r.x,r.y,n.x,n.y,i.x,i.y,o.x,o.y)},e.prototype.reverse=function(){this.coords.reverse()},e.prototype.equal=function(e){var t=this.coords,r=e.coords;if(t.length!==r.length)return!1;for(var n=0,i=t.length;n<i;n++)if(!t[n].equal(r[n]))return!1;return!0},e.prototype.toHash=function(){return this.coords.map((function(e){return e.toString()})).join(" ")},e.prototype.toString=function(){return this.uuid+" "+this.belong+" "+this.myCoincide+this.otherCoincide+" "+(this.isVisited?"v":"n")+(this.isDeleted?"d":"n")+" "+this.myFill.map((function(e){return e?1:0})).join("")+this.otherFill.map((function(e){return e?1:0})).join("")+" "+this.toHash()},e}(),Tw=yw,Aw=bw,Mw=xw,Ow=ww,Lw=_w,Rw=Ew,Iw=Sw,Fw=function(){function e(e,t){this.index=t;var r=this.segments=[];Array.isArray(e)&&e.forEach((function(e){if(Array.isArray(e)&&!(e.length<2)&&!(2===e.length&&e[1].length<=2)){for(var n,i=new vw(e[0][0],e[0][1]),o=i,a=function(o,a){var s=e[o],l=s.length,u=new vw(s[l-2],s[l-1]),c=void 0;if(2===l){if(i.equal(u))return n=o,"continue";var h=vw.compare(i,u)?[u,i]:[i,u];c=new kw(h,t),r.push(c)}else if(4===l){if(i.equal(u)&&i.x===s[0]&&i.y===s[1])return n=o,"continue";var d=new vw(s[0],s[1]);if(b=Gw([i,d,u])){var f=[[i.x,i.y],[s[0],s[1]],[u.x,u.y]],p=Bu.sliceBezier(vw.toPoints(f),0,b[0]).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),v=Bu.sliceBezier(vw.toPoints(f),b[0],1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),g=new vw(p[1].x,p[1].y),m=new vw(p[2].x,p[2].y),y=new vw(v[1].x,v[1].y);h=vw.compare(i,m)?[m,g,i]:[i,g,m];i.equal(m)||r.push(new kw(h,t)),h=vw.compare(m,u)?[u,y,m]:[m,y,u],u.equal(m)||r.push(new kw(h,t))}else{h=vw.compare(i,u)?[u,d,i]:[i,d,u];r.push(new kw(h,t))}}else if(6===l){if(s[0]===s[2]&&s[1]===s[3])return s.splice(2,2),o--,n=o,"continue";if(i.equal(u)&&i.x===s[0]&&i.y===s[1]&&i.x===s[2]&&i.y===s[3])return n=o,"continue";var b,x=new vw(s[0],s[1]),w=new vw(s[2],s[3]);if(b=Gw([i,x,w,u])){var _=[[i.x,i.y],[s[0],s[1]],[s[2],s[3]],[u.x,u.y]],E=i,S=0;b.forEach((function(e){var n=Bu.sliceBezier(vw.toPoints(_),S,e).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}})),i=new vw(n[1].x,n[1].y),o=new vw(n[2].x,n[2].y),a=new vw(n[3].x,n[3].y),s=vw.compare(E,a)?[a,o,i,E]:[E,i,o,a];E.equal(a)||r.push(new kw(s,t)),S=e,E=a}));var C=Bu.sliceBezier(vw.toPoints(_),S,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));g=new vw(C[1].x,C[1].y),m=new vw(C[2].x,C[2].y),h=vw.compare(E,u)?[u,m,g,E]:[E,g,m,u];E.equal(u)||r.push(new kw(h,t))}else{h=vw.compare(i,u)?[u,w,x,i]:[i,x,w,u];r.push(new kw(h,t))}}i=u,n=o},s=1,l=e.length;s<l;s++)a(s),s=n;if(!i.equal(o)){var u=vw.compare(i,o)?[o,i]:[i,o];r.push(new kw(u,t))}}}))}return e.prototype.selfIntersect=function(){var e=Bw(this.segments);this.segments=Pw(e,!1,!1,!1)},e.prototype.toString=function(){return this.segments.map((function(e){return e.toString()}))},e.prototype.reset=function(e){return this.index=e,this.segments.forEach((function(t){t.belong=e,t.otherCoincide=0,t.otherFill[0]=t.otherFill[1]=!1})),this},e.intersect2=function(e,t,r,n){if(e.segments.length&&t.segments.length){var i=Pw(Bw(e.segments.concat(t.segments)),!0,r,n);e.segments=i.filter((function(e){return 0===e.belong})),t.segments=i.filter((function(e){return 1===e.belong}))}},e.annotate2=function(e,t,r,n){var i=function(e){var t={};e.forEach((function(e){var r=e.coords,n=r.length,i=r[0],o=r[n-1];zw(t,i.x,i.y,e,!0),zw(t,o.x,o.y,e,!1)}));var r=[];Object.keys(t).forEach((function(e){var n=t[e],i=[];Object.keys(n).forEach((function(e){var t=n[e].sort((function(e,t){return e.isStart!==t.isStart?e.isStart?1:-1:e.isStart?Hw(e.seg,t.seg)?1:-1:0}));i.push({y:parseFloat(e),arr:t})})),r.push({x:parseFloat(e),arr:i.sort((function(e,t){return e.y-t.y}))})})),r.sort((function(e,t){return e.x-t.x}));var n=[];return r.forEach((function(e){e.arr.forEach((function(e){n=n.concat(e.arr)}))})),n}(e.segments.concat(t.segments)),o=[],a=[],s={},l={};i.forEach((function(e){var t=e.isStart,i=e.seg,u=i.belong;if(!(0===u&&r||1===u&&n)){var c=0===u?o:a,h=0===u?s:l;if(t){if(i.myCoincide){var d=i.toHash();if(h.hasOwnProperty(d))return;h[d]=!0}if(c.length){var f=c.length,p=c[f-1];if(Hw(i,p))i.myFill[1]=p.myFill[0],i.myCoincide?i.myFill[0]=i.myCoincide%2==0?!i.myFill[1]:i.myFill[1]:i.myFill[0]=!i.myFill[1],c.push(i);else if(1===f)i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,c.unshift(i);else for(var v=f-2;v>=0;v--){var g=c[v];if(Hw(i,g)){i.myFill[1]=g.myFill[0],i.myCoincide?i.myFill[0]=i.myCoincide%2==0?!i.myFill[1]:i.myFill[1]:i.myFill[0]=!i.myFill[1],c.splice(v+1,0,i);break}0===v&&(i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,c.unshift(i))}}else i.myCoincide?i.myFill[0]=i.myCoincide%2==0:i.myFill[0]=!0,c.push(i)}else{(v=c.indexOf(i))>-1&&c.splice(v,1)}}}));var u=[],c={};i.forEach((function(e){var t=e.isStart,r=e.seg,n=r.belong;if(t){if(r.myCoincide||r.otherCoincide){var i=r.toHash();if(c.hasOwnProperty(i))return;c[i]=!0}var o=!1;if(u.length){var a=u.length,s=u[a-1];if(Hw(r,s))o=s.belong===n?s.otherFill[0]:s.myFill[0],u.push(r);else if(1===a)u.unshift(r);else for(var l=a-2;l>=0;l--){var h=u[l];if(Hw(r,h)){o=h.belong===n?h.otherFill[0]:h.myFill[0],u.splice(l+1,0,r);break}0===l&&u.unshift(r)}}else o=!1,u.push(r);r.otherCoincide||(r.otherFill[0]=o,r.otherFill[1]=o)}else{(l=u.indexOf(r))>-1&&u.splice(l,1)}}))},e}();function Pw(e,t,r,n){for(var i=[],o=[],a=[];e.length;){o.length&&o.splice(0).forEach((function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1),e.isDeleted||a.push(e)}));for(var s=e.shift(),l=s.x,u=s.arr;u.length;){var c=u.shift();if(!c.isDeleted){var h=c.belong,d=c.bbox;if(c.isVisited){if(d[0]!==d[2]||2!==c.coords.length)(w=i.indexOf(c))>-1&&i.splice(w,1),c.isDeleted||a.push(c);else o.push(c);c.isVisited=!1}else{if(i.length)for(var f=c.coords,p=f.length,v=f[0],g=v.x,m=v.y,y=f[1],b=y.x,x=y.y,w=0;w<i.length;w++){var _=i[w];if(!_.isDeleted&&!c.isDeleted&&(!t||_.belong!==h)){var E=_.bbox,S=_.coords,C=S.length,k=!1;if(Yw(d,E,p,C)){if(p===C&&c.equal(_)){t?(c.otherCoincide++,_.otherCoincide++,c.otherFill=_.myFill,_.otherFill=c.myFill):(c.myCoincide++,_.myCoincide++,c.myFill=_.myFill);continue}var T=S[0],A=T.x,M=T.y,O=S[1],L=O.x,R=O.y,I=void 0,F=void 0;if(2===p)if(2===C){if(0===(R-M)*(b-g)-(L-A)*(x-m))if(g===b)g===A&&b===L&&(F=Ww(g,m,b,x,c,A,M,L,R,_,!0));else{var P=0,D=0;x!==m&&(P=(b-g)/(x-m)),R!==M&&(D=(L-A)/(R-M)),m-P*g===M-D*A&&(F=Ww(g,m,b,x,c,A,M,L,R,_,!1))}else I=Tw(g,m,b,x,A,M,L,R)}else{var N=S[2],B=N.x,U=N.y;if(3===C)I=Aw(A,M,L,R,B,U,g,m,b,x),k=!0;else{var z=S[3],X=z.x,H=z.y;I=Lw(A,M,L,R,B,U,X,H,g,m,b,x),k=!0}}else{var G=f[2],j=G.x,Y=G.y;if(3===p)if(2===C)I=Aw(g,m,b,x,j,Y,A,M,L,R);else{var W=S[2];B=W.x,U=W.y;if(3===C)(F=Vw(c,_))||(I=Mw(g,m,b,x,j,Y,A,M,L,R,B,U));else{var V=S[3];X=V.x,H=V.y;I=Ow(g,m,b,x,j,Y,A,M,L,R,B,U,X,H)}}else{var q=f[3],K=q.x,Z=q.y;if(2===C)I=Lw(g,m,b,x,j,Y,K,Z,A,M,L,R);else{var J=S[2];B=J.x,U=J.y;if(3===C)I=Ow(A,M,L,R,B,U,g,m,b,x,j,Y,K,Z),k=!0;else if(!(F=Vw(c,_))){var Q=S[3];X=Q.x,H=Q.y;I=Rw(g,m,b,x,j,Y,K,Z,A,M,L,R,B,U,X,H)}}}}if(F){c.isDeleted=_.isDeleted=!0,Nw(a,e,i,l,F.ra),Nw(a,e,i,l,F.rb),i.splice(w,1);break}if(I&&I.length){for(var $=I.length-1;$>=0;$--){var ee=I[$];ee.point.equal(f[0])?ee.point.equal(S[0])||ee.point.equal(S[C-1])?I.splice($,1):ee.point=f[0]:ee.point.equal(f[p-1])?ee.point.equal(S[0])||ee.point.equal(S[C-1])?I.splice($,1):ee.point=f[p-1]:ee.point.equal(S[0])?ee.point=S[0]:ee.point.equal(S[C-1])&&(ee.point=S[C-1])}if(I.length){var te=Iw(I,!k),re=Iw(I,k),ne=Dw(c,te,r&&0===h),ie=Dw(_,re,n&&1===h);if(ne.length&&Nw(a,e,i,l,ne),ie.length&&(Nw(a,e,i,l,ie),i.splice(w--,1)),ne.length)break}}}}}c.isDeleted||(i.push(c),c.isVisited=!0)}}}}return o.forEach((function(e){e.isDeleted||-1!==a.indexOf(e)||a.push(e)})),i.forEach((function(e){e.isDeleted||-1!==a.indexOf(e)||a.push(e)})),a.filter((function(e){return!e.isDeleted}))}function Dw(e,t,r){var n=[];if(!t.length)return n;var i,o=e.belong,a=e.coords,s=a.length,l=a[0],u=0;if(t.forEach((function(t){var i=t.point,c=t.t;if(!i.equal(l)){var h;if(2===s)h=vw.compare(l,i)?new kw([i,l],o):new kw([l,i],o);else if(3===s){var d=Bu.sliceBezier(a,u,c).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));h=vw.compare(l,i)?new kw([i,new vw(d[1].x,d[1].y),l],o):new kw([l,new vw(d[1].x,d[1].y),i],o)}else if(4===s){d=Bu.sliceBezier(a,u,c).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));h=vw.compare(l,i)?new kw([i,new vw(d[2].x,d[2].y),new vw(d[1].x,d[1].y),l],o):new kw([l,new vw(d[1].x,d[1].y),new vw(d[2].x,d[2].y),i],o)}r&&(h.myFill[0]=e.myFill[0],h.myFill[1]=e.myFill[1]),l=i,n.push(h),u=c}})),!l.equal(a[a.length-1])){if(2===s)i=vw.compare(l,a[1])?new kw([a[1],l],o):new kw([l,a[1]],o);else if(3===s){var c=Bu.sliceBezier(a,u,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));i=vw.compare(l,a[2])?new kw([a[2],new vw(c[1].x,c[1].y),l],o):new kw([l,new vw(c[1].x,c[1].y),a[2]],o)}else if(4===s){c=Bu.sliceBezier(a,u,1).map((function(e){return{x:Math.round(e.x),y:Math.round(e.y)}}));i=vw.compare(l,a[3])?new kw([a[3],new vw(c[2].x,c[2].y),new vw(c[1].x,c[1].y),l],o):new kw([l,new vw(c[1].x,c[1].y),new vw(c[2].x,c[2].y),a[3]],o)}r&&(i.myFill[0]=e.myFill[0],i.myFill[1]=e.myFill[1]),n.push(i)}return n.length>1?(e.isDeleted=!0,n):[]}function Nw(e,t,r,n,i){i.forEach((function(i){var o,a=i.coords,s=a[0],l=a[a.length-1],u=s.x,c=l.x;if(u>c&&(u=(o=[c,u])[0],c=o[1]),c<=n&&u!==c)e.push(i);else{if(u===c)for(var h=r.length-1;h>=0;h--){var d=r[h];if(i.equal(d)&&!d.isDeleted)return void(i.belong===d.belong?d.myCoincide++:d.otherCoincide++)}var f=0;if(u<n)i.isVisited=!0,r.push(i);else if(t.length)for(var p=t.length;f<p;f++){if(u===(g=(d=t[f]).x)){d.arr.push(i),u===c&&u===n&&r.push(i);break}if(u<g){var v={x:u,arr:[i]};u===c&&u===n&&r.push(i),t.splice(f,0,v);break}}else r.push(i);for(p=t.length;f<p;f++){var g;if(c===(g=(d=t[f]).x)){d.arr.unshift(i);break}if(c<g){v={x:c,arr:[i]};t.splice(f,0,v);break}}}}))}function Bw(e){var t={};e.forEach((function(e){var r,n=e.coords,i=n[0],o=n[n.length-1],a=i.x,s=o.x;a>s&&(a=(r=[s,a])[0],s=r[1]),Uw(t,a,e),Uw(t,s,e)}));var r=[];return Object.keys(t).forEach((function(e){return r.push({x:parseFloat(e),arr:t[e]})})),r.sort((function(e,t){return e.x-t.x}))}function Uw(e,t,r){var n=e[t]=e[t]||[];r.isVisited?(n.unshift(r),r.isVisited=!1):(n.push(r),r.isVisited=!0)}function zw(e,t,r,n,i){var o=e[t]=e[t]||{};(o[r]=o[r]||[]).push({isStart:i,seg:n})}function Xw(e,t,r){var n=e.x,i=e.y,o=t.x,a=t.y,s=r.x,l=r.y;return tu.crossProduct(o-n,a-i,s-n,l-i)>=0}function Hw(e,t){var r=e.coords,n=t.coords,i=r.length,o=n.length,a=r[0],s=n[0];if(2===i&&2===o){var l=r[1],u=n[1];return a.equal(s)?Xw(l,s,u):Xw(a,s,u)}if(2===i&&a.x===r[1].x){if(a.equal(s))return!0;if(r[i-1].equal(s))return!0;if(r[i-1].equal(n[o-1]))return!1}if(2===o&&s.x===n[1].x&&a.equal(s))return!1;var c=Math.max(a.x,s.x),h=Math.min(r[i-1].x,n[o-1].x),d=c+.5*(h-c);if(!a.equal(s)){var f=jw(r,c),p=jw(n,c);if(f!==p)return f>p}var v=jw(r,d),g=jw(n,d);if(v!==g)return v>g;if(!r[i-1].equal(n[o-1])){var m=jw(r,h),y=jw(n,h);if(m!==y)return m>y}return!1}function Gw(e,t){if(3===e.length){if((r=(e[0].x-e[1].x)/(e[0].x-2*e[1].x+e[2].x))>1e-9&&r<1-1e-9)return[r]}else if(4===e.length){var r=Eu.getRoots([3*(e[1].x-e[0].x),6*(e[2].x+e[0].x-2*e[1].x),3*(e[3].x+3*e[1].x-e[0].x-3*e[2].x)]).filter((function(e){return e>1e-9&&e<1-1e-9}));if(r.length)return r.sort((function(e,t){return e-t}))}}function jw(e,t){var r=e.length;if(t===e[0].x)return e[0].y;if(t===e[r-1].x)return e[r-1].y;if(2===r){if(e[0].y===e[1].y)return e[0].y;var n=(t-e[0].x)/(e[1].x-e[0].x);return e[0].y+n*(e[1].y-e[0].y)}if(3===r){var i=Eu.getRoots([e[0].x-t,2*(e[1].x-e[0].x),e[2].x+e[0].x-2*e[1].x]).filter((function(e){return e>=0&&e<=1}));return Bu.getPointByT(e,i[0]).y}if(4===r){i=Eu.getRoots([e[0].x-t,3*(e[1].x-e[0].x),3*(e[2].x+e[0].x-2*e[1].x),e[3].x+3*e[1].x-e[0].x-3*e[2].x]).filter((function(e){return e>=0&&e<=1}));return Bu.getPointByT(e,i[0]).y}}function Yw(e,t,r,n){if(2===r&&2===n){if(e[0]===e[2]&&t[0]===t[2]&&e[0]===e[2])return!(e[1]>=t[3]||t[1]>=e[3]);if(e[1]===e[3]&&t[1]===t[3]&&e[1]===e[3])return!(e[0]>=t[2]||t[0]>=e[2])}return oc.isRectsOverlap(e[0],e[1],e[2],e[3],t[0],t[1],t[2],t[3],!0)}function Ww(e,t,r,n,i,o,a,s,l,u,c){var h=[],d=[],f=i.coords,p=u.coords;return e<o&&!c||t<a&&c?(h.push(new kw([f[0],p[0]],i.belong)),r<s&&!c||n<l&&c?(h.push(new kw([p[0],f[1]],i.belong)),d.push(new kw([p[0],f[1]],u.belong)),d.push(new kw([f[1],p[1]],u.belong))):r===s&&!c||n===l&&c?(h.push(new kw([p[0],p[1]],i.belong)),d.push(new kw([p[0],p[1]],u.belong))):(h.push(new kw([p[0],p[1]],i.belong)),d.push(new kw([p[0],p[1]],u.belong)),h.push(new kw([p[1],f[1]],i.belong)))):e===o&&!c||t===a&&c?r<s&&!c||n<l&&c?(h.push(new kw([f[0],f[1]],i.belong)),d.push(new kw([f[0],f[1]],u.belong)),d.push(new kw([f[1],p[1]],u.belong))):(h.push(new kw([p[0],p[1]],i.belong)),h.push(new kw([p[1],f[1]],i.belong)),d.push(new kw([p[0],p[1]],u.belong))):(d.push(new kw([p[0],f[0]],u.belong)),r<s&&!c||n<l&&c?(h.push(new kw([f[0],f[1]],i.belong)),d.push(new kw([f[0],f[1]],u.belong)),d.push(new kw([f[1],p[1]],u.belong))):r===s&&!c||n===l&&c?(h.push(new kw([f[0],f[1]],i.belong)),d.push(new kw([f[0],f[1]],u.belong))):(h.push(new kw([f[0],p[1]],i.belong)),d.push(new kw([f[0],p[1]],u.belong)),h.push(new kw([p[1],f[1]],i.belong)))),{ra:h,rb:d}}function Vw(e,t){var r=e.coords,n=r.length,i=t.coords,o=i.length,a=r[0],s=i[0],l=r[n-1],u=i[o-1],c=Bu.getPointT(r,s.x,s.y),h=Bu.getPointT(r,u.x,u.y),d=Bu.getPointT(i,a.x,a.y),f=Bu.getPointT(i,l.x,l.y),p=c.length,v=h.length,g=d.length,m=f.length;if(1===p&&1===v&&0===g&&0===m||0===p&&0===v&&1===g&&1===m||(1===p&&1===v&&g+m===1||p+v===1&&1===g&&1===m)||p+v===1&&g+m===1){var y=p?c[0]:0,b=v?h[0]:1,x=Bu.sliceBezier(r,y,b),w=g?d[0]:0,_=m?f[0]:1;if(function(e,t){for(var r=0,n=e.length;r<n;r++){var i=e[r],o=t[r];if(Math.abs(i.x-o.x)>1e-9||Math.abs(i.y-o.y)>1e-9)return!1}return!0}(x,Bu.sliceBezier(i,w,_))){var E=x.map((function(e){return new vw(e.x,e.y)})),S=[],C=[];if(y>0){var k=Bu.sliceBezier(r,0,y),T=[e.coords[0],new vw(k[1].x,k[1].y),t.coords[0]];4===n&&T.splice(2,0,new vw(k[2].x,k[2].y)),S.push(new kw(T,e.belong))}if(S.push(new kw(E,e.belong)),b<1){k=Bu.sliceBezier(r,b,1),T=[t.coords[o-1],new vw(k[1].x,k[1].y),e.coords[n-1]];4===n&&T.splice(2,0,new vw(k[2].x,k[2].y)),S.push(new kw(T,e.belong))}if(w>0){k=Bu.sliceBezier(i,0,w),T=[t.coords[0],new vw(k[1].x,k[1].y),e.coords[0]];4===o&&T.splice(2,0,new vw(k[2].x,k[2].y)),C.push(new kw(T,t.belong))}if(C.push(new kw(E,t.belong)),_<1){k=Bu.sliceBezier(i,_,1),T=[e.coords[n-1],new vw(k[1].x,k[1].y),t.coords[o-1]];4===o&&T.splice(2,0,new vw(k[2].x,k[2].y)),C.push(new kw(T,t.belong))}return{ra:S,rb:C}}}}function qw(e,t,r,n,i,o){for(var a=0,s=t.length;a<s;a++){var l=t[a];if(l!==r){var u=l.length,c=l[0],h=l[u-1],d=c.coords[0],f=h.coords,p=f[f.length-1];if(i.equal(d))return o?(l=Zw(r).concat(l),t[a]=l,t.splice(n,1),Kw(e,t,l,a)):(l=r.concat(l),t[a]=l,t.splice(n,1),Kw(e,t,l,a));if(i.equal(p))return o?(l=l.concat(r),t[a]=l,t.splice(n,1),Kw(e,t,l,a)):(l=l.concat(Zw(r)),t[a]=l,t.splice(n,1),Kw(e,t,l,a))}}Kw(e,t,r,n)}function Kw(e,t,r,n){var i=r.length,o=r[0],a=r[i-1],s=o.coords[0],l=a.coords,u=l[l.length-1];s.equal(u)&&(t.splice(n,1),e.push(r))}function Zw(e){return e.forEach((function(e){return e.reverse()})),e.reverse()}function Jw(e){var t=[],r=[];e.sort((function(e,t){return t.otherFill[0]&&t.otherFill[1]?1:-1}));e:for(;e.length;){for(var n=e.shift(),i=n.coords,o=i.length,a=i[0],s=i[o-1],l=void 0,u=0,c=t.length;u<c;u++){var h=t[u],d=h.length,f=h[0],p=h[d-1],v=f.coords[0],g=p.coords,m=g[g.length-1];if(a.equal(m)){if(n.belong!==p.belong){h.push(n),qw(r,t,h,u,s,!1);continue e}l||(l={i:u,t:0})}else if(a.equal(v)){if(n.belong!==p.belong){n.reverse(),h.unshift(n),qw(r,t,h,u,s,!0);continue e}l||(l={i:u,t:1})}else if(s.equal(m)){if(n.belong!==p.belong){n.reverse(),h.push(n),qw(r,t,h,u,a,!1);continue e}l||(l={i:u,t:2})}else if(s.equal(v)){if(n.belong!==p.belong){h.unshift(n),qw(r,t,h,u,a,!0);continue e}l||(l={i:u,t:3})}}l?0===l.t?(t[l.i].push(n),qw(r,t,t[l.i],l.i,s,!1)):1===l.t?(n.reverse(),t[l.i].unshift(n),qw(r,t,t[l.i],l.i,s,!0)):2===l.t?(n.reverse(),t[l.i].push(n),qw(r,t,t[l.i],l.i,a,!1)):3===l.t&&(t[l.i].unshift(n),qw(r,t,t[l.i],l.i,a,!0)):t.push([n])}var y=r.map((function(e){var t=!0,r=0,n=0,i=0,o=0,a=0,s=0,l=0;e.forEach((function(e,t){var u=e.coords,c=u.length,h=e.bbox;t?(o=Math.min(o,h[0]),a=Math.min(a,h[1]),s=Math.max(s,h[2]),l=Math.max(l,h[3])):(o=h[0],a=h[1],s=h[2],l=h[3]),2===c?(r+=t?n*u[1].y-i*u[1].x:u[0].x*u[1].y-u[0].y*u[1].x,n=u[1].x,i=u[1].y):3===c?(r+=t?n*u[2].y-i*u[2].x:u[0].x*u[1].y-u[0].y*u[2].x,n=u[2].x,i=u[2].y):4===c&&(r+=t?n*u[3].y-i*u[3].x:u[0].x*u[3].y-u[0].y*u[3].x,n=u[3].x,i=u[3].y)}));var u=e[0].coords;return(r+=n*u[0].y-i*u[0].x)<0&&(t=!1),{checked:!1,list:e,clockwise:t,bbox:[o,a,s,l],area:(s-o)*(l-a)}}));return y.forEach((function(e){if(!e.checked){for(var t=e.bbox,r=[e],n=0,i=y.length;n<i;n++){if((u=y[n])!==e){var o=u.bbox;(oc.isRectsInside(t[0],t[1],t[2],t[3],o[0],o[1],o[2],o[3],!0)||oc.isRectsInside(o[0],o[1],o[2],o[3],t[0],t[1],t[2],t[3],!0))&&r.push(u)}}if(r.length>1){r.sort((function(e,t){return e.area-t.area}));for(n=1,i=r.length;n<i;n++){var a=r[n];if(a.checked){for(var s=a.clockwise,l=n-1;l>=0;l--){(u=r[l]).checked=!0,u.clockwise===s&&(Zw(u.list),u.clockwise=!s),s=!s}s=a.clockwise;for(l=n+1;l<i;l++){var u;(u=r[l]).checked=!0,u.clockwise===s&&(Zw(u.list),u.clockwise=!s),s=!s}return}}var c=r[0].clockwise;r[0].checked=!0;for(n=1,i=r.length;n<i;n++){var h=r[n];h.checked=!0,h.clockwise===c&&(Zw(h.list),h.clockwise=!c),c=!c}}}})),y.map((function(e){var t=e.list.map((function(e){var t=e.coords,r=t.length;return 3===r?[t[1].x,t[1].y,t[2].x,t[2].y]:4===r?[t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y]:[t[1].x,t[1].y]})),r=e.list[0].coords;return t.unshift([r[0].x,r[0].y]),t}))}function Qw(e){return e&&Array.isArray(e)&&Array.isArray(e[0])?Array.isArray(e[0][0])?e:[e]:[]}function $w(e,t){var r,n,i=e instanceof Fw,o=t instanceof Fw;return i?r=e.reset(0):(r=new Fw(Qw(e),0)).selfIntersect(),o?n=t.reset(1):(n=new Fw(Qw(t),1)).selfIntersect(),Fw.intersect2(r,n,i,o),Fw.annotate2(r,n,i,o),[r,n]}var e_=[0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0],t_=[0,1,1,1,1,0,0,0,1,0,0,0,1,0,0,0],r_=[0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0],n_=[0,1,0,0,1,0,1,1,0,1,0,0,0,1,0,0],i_=[0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0];function o_(e,t){var r=[],n={};return e.forEach((function(e){var i,o=e.belong,a=e.myFill,s=e.otherFill;if(e.otherCoincide){var l=e.toHash();if(n.hasOwnProperty(l))return;n[l]=!0}i=o?(s[0]?8:0)+(a[0]?4:0)+(s[1]?2:0)+(a[1]?1:0):(a[0]?8:0)+(s[0]?4:0)+(a[1]?2:0)+(s[1]?1:0),t[i]&&r.push(e)})),r}var a_={intersect:function(e,t,r){void 0===r&&(r=!1);var n=$w(e,t),i=n[0],o=n[1],a=o_(i.segments.concat(o.segments),e_);return r?(i.segments=a,i):Jw(a)},union:function(e,t,r){void 0===r&&(r=!1);var n=$w(e,t),i=n[0],o=n[1],a=o_(i.segments.concat(o.segments),t_);return r?(i.segments=a,i):Jw(a)},subtract:function(e,t,r){void 0===r&&(r=!1);var n=$w(e,t),i=n[0],o=n[1],a=o_(i.segments.concat(o.segments),r_);return a.length,r?(i.segments=a,i):Jw(a)},subtractRev:function(e,t,r){void 0===r&&(r=!1);var n=$w(e,t),i=n[0],o=n[1],a=o_(i.segments.concat(o.segments),n_);return r?(i.segments=a,i):Jw(a)},xor:function(e,t,r){void 0===r&&(r=!1);var n=$w(e,t),i=n[0],o=n[1],a=o_(i.segments.concat(o.segments),i_);return r?(i.segments=a,i):Jw(a)},chain:function(e){return e instanceof Fw?Jw(e.segments):Qw(e)},chains:Jw},s_=.01,l_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isGroup=!0,n.fixedPosAndSize=!1,n}return v(t,e),t.prototype.didMount=function(){e.prototype.didMount.call(this),this.adjustPosAndSize()},t.prototype.adjustPosAndSizeChild=function(e,t,r,n,i,o,a){var s=e.style,l=e.computedStyle,u=e.root;if(u){var c=s.top,h=s.right,d=s.bottom,f=s.left;(t||n)&&(l.left-=t,f.u===Us.PX?f.v=l.left:f.u===Us.PERCENT&&o&&(f.v=100*l.left/o),l.right+=n,h.u===Us.PX?h.v=l.right:h.u===Us.PERCENT&&o&&(h.v=100*l.right/o)),(r||i)&&(l.top-=r,c.u===Us.PX?c.v=l.top:c.u===Us.PERCENT&&a&&(c.v=100*l.top/a),l.bottom+=i,d.u===Us.PX?d.v=l.bottom:d.u===Us.PERCENT&&a&&(d.v=100*l.bottom/a)),e.refreshLevel|=Qb.TRANSFORM,u.rl|=Qb.TRANSFORM,e.calMatrix(Qb.TRANSFORM),e._rect=void 0,e._bbox=void 0,e._filterBbox=void 0,e.tempBbox=void 0}},t.prototype.adjustPosAndSize=function(e){if(this.fixedPosAndSize)return!1;var t=this.children;e||(e=this.getChildrenRect());var r=this.width,n=this.height,i=e.minX,o=e.minY,a=e.maxX-r,s=e.maxY-n;if(Math.abs(i)>s_||Math.abs(o)>s_||Math.abs(a)>s_||Math.abs(s)>s_){this.adjustPosAndSizeSelf(i,o,a,s),r=this.width,n=this.height;for(var l=0,u=t.length;l<u;l++){var c=t[l];this.adjustPosAndSizeChild(c,i,o,a,s,r,n)}return!0}return!1},t.prototype.checkPosSizeSelf=function(){this.adjustPosAndSize()&&this.checkPosSizeUpward()},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.GROUP,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n,i;return Q(this,(function(o){switch(o.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(n=o.sent())._class=$.ClassValue.Group,n.hasClickThrough=!1,[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t)})))];case 2:return i=o.sent(),n.layers=i.map((function(e){return e})),[2,n]}}))}))},Object.defineProperty(t,"EPS",{get:function(){return s_},enumerable:!1,configurable:!0}),t}(Vx),u_=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isSymbolMaster=!0,n.symbolInstances=[],n}return v(t,e),t.prototype.addSymbolInstance=function(e){-1===this.symbolInstances.indexOf(e)&&this.symbolInstances.push(e)},t.prototype.removeSymbolInstance=function(e){var t=this.symbolInstances.indexOf(e);t>-1&&this.symbolInstances.splice(t,1)},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.symbolInstances=[],n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SYMBOL_MASTER,t},t}(qx),c_=function(){function e(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),this.x=0,this.y=e,this.w=0,this.h=t,this.index=r,this.list=[],this.startEnter=n,this.endEnter=i}return e.prototype.add=function(e){this.list.push(e),this.w+=e.w},e.prototype.verticalAlign=function(){for(var e=this.baseline,t=this.list,r=0,n=t.length;r<n;r++){var i=t[r],o=i.baseline;if(o!==e){var a=e-o;i.y+=a}}},e.prototype.offsetX=function(e){this.x+=e;for(var t=this.list,r=0,n=t.length;r<n;r++)t[r].x+=e},e.prototype.offsetY=function(e){this.y+=e;for(var t=this.list,r=0,n=t.length;r<n;r++)t[r].y+=e},Object.defineProperty(e.prototype,"size",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){for(var e=0,t=this.list,r=0,n=t.length;r<n;r++)e=Math.max(e,t[r].baseline);return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){var e=this.list;if(e.length){for(var t=0,r=0,n=e.length;r<n;r++)t=Math.max(t,e[r].lineHeight);return t}return this.h},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.ceil(this.w)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.ceil(this.lineHeight)},enumerable:!1,configurable:!0}),e}(),h_=function(e,t,r,n,i,o,a,s,l,u,c,h,d,f){this.x=e,this.y=t,this.w=r,this.lineHeight=n,this.baseline=i,this.contentArea=o,this.index=a,this.str=s,this.font=l,this.fontFamily=u,this.fontSize=c,this.color=h,this.letterSpacing=d,this.textDecoration=f};function d_(e,t,r,n,i,o,a){var s=t,l=r,u=0,c=!1,h=Math.round(i/o);for(h<=0?h=1:h>r-t&&(h=r-t);s<l;){var d=e.measureText(n.slice(t,t+h)).width;if(d===i){u=i,c=!0;break}if(d>i+1e-10){if(c=!0,1===h){u=d;break}if(s===l-1||s-t==h-1){h=s-t;break}l=h+t-1;var f=Math.round((d-i)/o);f<=0&&(f=1),(h-=f)<s-t&&(h=s-t)}else{if(u=d,h===r-t)break;s=h+t;var p=Math.round((i-d)/o);p<=0&&(p=1),(h+=p)>l-t&&(h=l-t)}}for(var v=t,g=t+h;v<g;v++)if("\n"===n.charAt(v))return{hypotheticalNum:h=v-t,rw:u=e.measureText(n.slice(t,t+h)).width,newLine:c=!1};if(t+h<r&&/[\w.-]/.test(n.charAt(t+h-1)))for(var m=t+h-2;m>t;m--)if(!/[\w.-]/.test(n.charAt(m)))return{hypotheticalNum:h=m-t+1,rw:u=e.measureText(n.slice(t,t+h)).width,newLine:c=!0};return"\n"===n.charAt(t+h)&&(c=!1),{hypotheticalNum:h,rw:u,newLine:c}}var f_=function(e){function t(t){var r,n=e.call(this,t)||this;return n.isText=!0,n._content=t.content||"",n.rich=((null===(r=t.rich)||void 0===r?void 0:r.slice(0))||[]).map((function(e){return Ec(e)})),n.lineBoxList=[],n.tempCursorX=0,n.currentCursorX=0,n.cursor={isMulti:!1,startLineBox:0,endLineBox:0,startTextBox:0,endTextBox:0,startString:0,endString:0,start:0,end:0},n.asyncRefresh=!1,n.loaders=[],n}return v(t,e),t.prototype.lay=function(t){var r=this;e.prototype.lay.call(this,t);var n,i,o,a,s,l,u,c,h,d=this,f=d.rich,p=d.style,v=d.computedStyle,g=d._content,m=d.lineBoxList,y=p.left,b=p.right,x=p.top,w=p.bottom,_=p.width,E=p.height,S=_.u===Us.AUTO&&(y.u===Us.AUTO||b.u===Us.AUTO),C=E.u===Us.AUTO&&(x.u===Us.AUTO||w.u===Us.AUTO),k=0,T=g.length,A=[],M=0,O=0,L=0;this.mergeRich();var R={};if(f.length)for(var I=function(e,t){var n=f[e];R[n.location]=e;var i=n.fontFamily,o=Hl.data[i];if(o)for(var a=o.list||[],s=function(t,n){var o=a[t];if(o.postscriptName===i)return!o.loaded&&o.url&&hl.loadFont(i,o.url,(function(t){if(o.loaded=!0,t.success&&f&&f[e]&&f[e].fontFamily===i){if(r.asyncRefresh)return;r.asyncRefresh=!0,hl.requestAnimationFrame((function(){t.success&&f&&f[e]&&f[e].fontFamily===i&&(r.asyncRefresh=!1,r.refresh(Qb.REFLOW))}))}})),"break"},l=0,u=a.length;l<u;l++){if("break"===s(l))break}},F=0,P=f.length;F<P;F++)I(F);else{var D=v.fontFamily,N=Hl.data[D];if(N){var B=N.list||[],U=function(e,t){var n=B[e];if(n.postscriptName===D)return!n.loaded&&n.url&&hl.loadFont(D,n.url,(function(e){n.loaded=!0,e.success&&!f.length&&v.fontFamily===D&&r.refresh(Qb.REFLOW)})),"break"},z=0;for(P=B.length;z<P;z++){if("break"===U(z))break}}}var X=hl.getFontCanvas().ctx;if(f.length){var H=f[0];i=H.letterSpacing||0,o=H.paragraphSpacing||0,n=.8*H.fontSize+i,s=Fc(H,a=H.lineHeight||Ic(H)),l=Pc(H,a),u=H.fontFamily,c=H.fontSize,h=Tc(H.color),A=H.textDecoration||[],X.font=Lc(H),X.letterSpacing=i+"px"}else i=v.letterSpacing,o=v.paragraphSpacing,n=.8*v.fontWeight+i,a=v.lineHeight||Ic(v),s=Fc(v,a),l=Pc(v,a),u=v.fontFamily,c=v.fontSize,h=Tc(this.style.color.v),A=v.textDecoration||[],X.font=Lc(v),X.letterSpacing=i+"px";var G=new c_(L,a,k,!1);m.splice(0),m.push(G);for(var j=S?Number.MAX_SAFE_INTEGER:this.width;k<T;){var Y=R[k];if(k&&Y){var W=f[Y];i=W.letterSpacing||0,o=W.paragraphSpacing||0,n=.8*W.fontSize+i,s=Fc(W,a=W.lineHeight||Ic(W)),l=Pc(W,a),u=W.fontFamily,c=W.fontSize,h=Tc(W.color),A=W.textDecoration||[],X.font=Lc(W),X.letterSpacing=i+"px"}if("\n"!==g.charAt(k)){P=T;if(f.length)for(var V=k+1;V<P;V++)if(R[V]){P=V;break}if(X.measureText(g.charAt(k)).width>j-O+1e-10&&O)O=0,L+=G.height+o,k<T&&(G.verticalAlign(),G=new c_(L,a,k,!1),m.push(G));else{var q=d_(X,k,P,g,j-O,n),K=q.hypotheticalNum,Z=q.rw,J=q.newLine,Q=new h_(O,L,Z,a,s,l,k,g.slice(k,k+K),X.font,u,c,h,i,A);G.add(Q),k+=K,M=Math.max(M,Math.ceil(Z+O)),J?(O=0,L+=G.height+o,k<T&&(G.verticalAlign(),G=new c_(L,a,k,!1),m.push(G))):O+=Z}}else k++,O=0,L+=G.height+o,G.verticalAlign(),G.endEnter=!0,G=new c_(L,a,k,!0),m.push(G)}if((G.verticalAlign(),M=Math.max(M,G.width),i&&i<0&&(M-=i),S)&&(ue=M-this.width)){this.width=v.width=M;var $=p.left,ee=p.right;$.u!==Us.AUTO&&ee.u!==Us.AUTO||($.u!==Us.AUTO?v.right-=ue:ee.u!==Us.AUTO&&(v.left-=ue))}if(C){var te=G.y+G.height;if(ue=te-this.height){this.height=v.height=te;var re=p.top,ne=p.bottom;re.u!==Us.AUTO&&ne.u!==Us.AUTO||(re.u!==Us.AUTO?v.bottom-=ue:ne.u!==Us.AUTO&&(v.top-=ue))}}if(f&&f.length){var ie={};f.forEach((function(e){ie[e.location]=e}));var oe=f[0].textAlign,ae=0;for(P=m.length;ae<P;ae++){var se=m[ae];if(se.startEnter||!se.index){var le=ie[se.index];le&&(oe=le.textAlign)}if(oe===zs.CENTER)(ue=this.width-se.width)&&se.offsetX(.5*ue);else if(oe===zs.RIGHT){var ue;(ue=this.width-se.width)&&se.offsetX(ue)}}}var ce=this.height-G.y-G.height;if(ce){var he=v.textVerticalAlign;if(he===Xs.MIDDLE){var de=0;for(P=m.length;de<P;de++){m[de].offsetY(.5*ce)}}else if(he===Xs.BOTTOM){var fe=0;for(P=m.length;fe<P;fe++){m[fe].offsetY(ce)}}}},t.prototype.calContent=function(){return this.hasContent=!!this._content},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t);var i=this._bbox2||this.bbox2,o=i[0],a=i[1],s=i[2]-o,l=i[3]-a,u=-o*t,c=-a*t;s*=t,l*=t;var h=this.computedStyle,d=this.lineBoxList,f=this.canvasCache=Zx.getInstance(s,l,u,c);f.available=!0;var p=f.list,v=this.getSortedCursor(),g=v.isMulti,m=v.startLineBox,y=v.startTextBox,b=v.startString,x=v.endLineBox,w=v.endTextBox,_=v.endString,E=v.start,S=v.end;if(g&&E!==S)for(var C=0,k=p.length;C<k;C++){var T=p[C],A=T.x,M=T.y,O=T.os.ctx,L=-A,R=-M;if(O.fillStyle="#f4d3c1",m===x){var I=(D=d[m]).list,F=(N=I[y]).x*t+L;O.font=N.font,O.letterSpacing=N.letterSpacing+"px",F+=O.measureText(N.str.slice(0,b)).width*t;var P=(N=I[w]).x*t+L;O.font=N.font,P+=O.measureText(N.str.slice(0,_)).width*t,O.fillRect(F,D.y*t+R,P-F,D.lineHeight*t)}else{var D,N,B=(D=d[m]).list;if(N=B[y]){F=N.x*t+L;O.font=N.font,O.letterSpacing=N.letterSpacing+"px",F+=O.measureText(N.str.slice(0,b)).width*t,O.fillRect(F,D.y*t+R,D.w*t+L-F,D.lineHeight*t)}for(var U=m+1,z=x;U<z;U++){var X=d[U];X.list.length&&O.fillRect(X.list[0].x*t+L,X.y*t+R,X.w*t,X.lineHeight*t)}if(N=(B=(D=d[x]).list)[w]){F=N.x*t+L;O.font=N.font,O.letterSpacing=N.letterSpacing+"px",F+=O.measureText(N.str.slice(0,_)).width*t,O.fillRect(D.x*t+L,D.y*t+R,F-(D.x+L)*t,D.lineHeight*t)}}}var H=!1,G=h.fill,j=h.fillOpacity,Y=h.fillEnable,W=h.fillMode,V=h.stroke,q=h.strokeEnable,K=h.strokeWidth,Z=h.strokePosition,J=h.strokeMode,Q=h.strokeDasharray,$=h.strokeLinecap,ee=h.strokeLinejoin;for(C=0,k=G.length;C<k;C++)if(Y[C]&&j[C]){H=!0;break}function te(e,r){void 0===r&&(r=!0);for(var n=0,i=d.length;n<i;n++){var o=d[n];if(o.y>=l)break;for(var a=o.list,s=a.length,h=function(n){var i=a[n],o=i.textDecoration;p_(e,i,t),r?e.fillText(i.str,i.x*t+u,(i.y+i.baseline)*t+c):e.strokeText(i.str,i.x*t+u,(i.y+i.baseline)*t+c),o.length&&o.forEach((function(r){r===fl.UNDERLINE?e.strokeRect(i.x*t+u,(i.y+i.contentArea-4)*t+c,i.w*t,3*t):r===fl.LINE_THROUGH&&e.strokeRect(i.x*t+u,(i.y+.5*i.lineHeight-1.5)*t+c,i.w*t,3*t)}))},f=0;f<s;f++)h(f)}}var re=function(e,i){var o=p[e],a=o.x,h=o.y,f=o.os.ctx,v=-a,g=-h;if(H)for(var m=function(e,i){if(!Y[e]||!j[e])return"continue";var o=G[e],a=void 0,h=W[e];if(f.globalAlpha=j[e],Array.isArray(o)){if(o[3]<=0)return"continue";f.fillStyle=Tc(o)}else{if(void 0!==o.url){var d=o.url;if(d){var p=ne.loaders[e],m=hl.IMG[d];if(!p&&m&&(p=ne.loaders[e]={error:!1,loading:!1,width:m.width,height:m.height,source:m.source}),p){if(!p.error&&!p.loading){var y=ne.width,b=ne.height,x=y*t,w=b*t,_=hl.getOffscreenCanvas(s,l),E=_.ctx;if(o.type===el.TILE)for(var S=null!==(r=o.scale)&&void 0!==r?r:1,C=0,k=Math.ceil(y/S/p.width);C<k;C++)for(var T=0,A=Math.ceil(b/S/p.height);T<A;T++)E.drawImage(p.source,v+C*p.width*t*S,g+T*p.height*t*S,p.width*t*S,p.height*t*S);else if(o.type===el.FILL){var M=x/p.width,O=w/p.height,L=Math.max(M,O),R=-.5*(p.width*L-x),I=-.5*(p.height*L-w);E.drawImage(p.source,0,0,p.width,p.height,R+v,I+g,p.width*L,p.height*L)}else if(o.type===el.STRETCH)E.drawImage(p.source,v,g,x,w);else if(o.type===el.FIT){M=x/p.width,O=w/p.height,L=Math.min(M,O);var F=-.5*(p.width*L-x),P=-.5*(p.height*L-w);E.drawImage(p.source,0,0,p.width,p.height,F+v,P+g,p.width*L,p.height*L)}E.fillStyle="#FFF",E.globalCompositeOperation="destination-in",te(E,!0),E.globalCompositeOperation="source-over",h!==Hs.NORMAL&&(f.globalCompositeOperation=Jx(h)),f.drawImage(_.canvas,0,0),h!==Hs.NORMAL&&(f.globalCompositeOperation="source-over"),_.release()}}else p=ne.loaders[e]=ne.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},hl.loadImg(d,(function(t){var r;d===(null===(r=G[e])||void 0===r?void 0:r.url)&&(p.loading=!1,t.success?(p.error=!1,p.source=t.source,p.width=t.width,p.height=t.height,n.isDestroyed||n.refresh()):p.error=!0)}))}return"continue"}if(o.t===js.LINEAR){var D=mc(o.stops,o.d,v,g,s-2*u,l-2*c),N=f.createLinearGradient(D.x1,D.y1,D.x2,D.y2);D.stop.forEach((function(e){N.addColorStop(e.offset,Tc(e.color))})),f.fillStyle=N}else if(o.t===js.RADIAL){D=yc(o.stops,o.d,v,g,s-2*u,l-2*c);var B=f.createRadialGradient(D.cx,D.cy,0,D.cx,D.cy,D.total);D.stop.forEach((function(e){B.addColorStop(e.offset,Tc(e.color))}));var U=D.matrix;if(U)(E=(a=hl.getOffscreenCanvas(s,l)).ctx).fillStyle="#FFF",te(E,!0),E.globalCompositeOperation="source-in",E.fillStyle=B,E.setTransform(U[0],U[1],U[4],U[5],U[12],U[13]),E.fillRect(0,0,s,l);else f.fillStyle=B}else if(o.t===js.CONIC){D=bc(o.stops,o.d,v,g,s-2*u,l-2*c);var z=f.createConicGradient(D.angle,D.cx+v,D.cy+g);D.stop.forEach((function(e){z.addColorStop(e.offset,Tc(e.color))})),f.fillStyle=z}}h!==Hs.NORMAL&&(f.globalCompositeOperation=Jx(h)),a?(f.drawImage(a.canvas,0,0),a.release()):te(f,!0),h!==Hs.NORMAL&&(f.globalCompositeOperation="source-over")},y=0,b=G.length;y<b;y++)m(y);else for(var x=0,w=d.length;x<w;x++){if((P=d[x]).y>=l)break;for(var _=P.list,E=_.length,S=function(e){var r=_[e],n=r.textDecoration;p_(f,r,t),f.fillStyle=r.color,f.fillText(r.str,r.x*t+v,(r.y+r.baseline)*t+g),n.length&&n.forEach((function(e){e===fl.UNDERLINE?f.fillRect(r.x*t+v,(r.y+r.contentArea-4)*t+g,r.w*t,3*t):e===fl.LINE_THROUGH&&f.fillRect(r.x*t+v,(r.y+.5*r.lineHeight-1.5)*t+g,r.w*t,3*t)}))},C=0;C<E;C++)S(C)}f.globalAlpha=1,f.globalCompositeOperation="source-over";var k=ne.computedStyle,T=k.innerShadow,A=k.innerShadowEnable;if(T&&T.length){var M=!1,O=hl.getOffscreenCanvas(s,l),L=O.ctx;L.fillStyle="#FFF";var R=0;if(T.forEach((function(e,r){if(A[r]){M=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.y))+e.spread)*t;R=Math.max(R,n+e.blur*t)}})),M){for(var I=0,F=d.length;I<F;I++){var P;if((P=d[I]).y>=l)break;for(var D=P.list,N=D.length,B=0;B<N;B++){var U=D[B];p_(L,U,t),L.fillText(U.str,U.x*t+v,(U.y+U.baseline)*t+g)}}L.globalCompositeOperation="source-out",L.fillRect(-R,-R,s+R,l+R);var z=hl.getOffscreenCanvas(s,l),X=z.ctx;T.forEach((function(e,r){A[r]&&(X.shadowOffsetX=e.x*t,X.shadowOffsetY=e.y*t,X.shadowColor=Tc(e.color),X.shadowBlur=e.blur*t,X.drawImage(O.canvas,0,0))})),f.globalCompositeOperation="source-atop",f.drawImage(z.canvas,0,0),f.globalCompositeOperation="source-over",O.release(),z.release()}}1!==t?f.setLineDash(Q.map((function(e){return e*t}))):f.setLineDash(Q),$===Js.ROUND?f.lineCap="round":$===Js.SQUARE?f.lineCap="square":f.lineCap="butt",ee===Qs.ROUND?f.lineJoin="round":ee===Qs.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=1,f.fillStyle="transparent";for(var re=function(e,r){if(!q[e]||!K[e])return"continue";var n=V[e],i=Z[e];if(f.globalCompositeOperation=Jx(J[e]),Array.isArray(n))f.strokeStyle=Tc(n);else if(n.t===js.LINEAR){var o=mc(n.stops,n.d,v,g,s-2*u,l-2*c),a=f.createLinearGradient(o.x1,o.y1,o.x2,o.y2);o.stop.forEach((function(e){a.addColorStop(e.offset,Tc(e.color))})),f.strokeStyle=a}else if(n.t===js.RADIAL){o=yc(n.stops,n.d,v,g,s-2*u,l-2*c);var h=f.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.total);o.stop.forEach((function(e){h.addColorStop(e.offset,Tc(e.color))}));var d=o.matrix;if(d){var p=hl.getOffscreenCanvas(s,l),m=p.ctx;return m.setLineDash(f.getLineDash()),m.lineCap=f.lineCap,m.lineJoin=f.lineJoin,m.miterLimit=f.miterLimit*t,m.lineWidth=K[e]*t,i===$s.INSIDE||i===$s.OUTSIDE?(m.fillStyle="#FFF",te(m,!0),m.lineWidth=2*K[e]*t,m.strokeStyle="#FFF",i===$s.INSIDE?m.globalCompositeOperation="source-in":m.globalCompositeOperation="source-out",te(m,!1)):(m.lineWidth=K[e]*t,m.strokeStyle="#FFF",te(m,!1)),m.globalCompositeOperation="source-in",m.setTransform(d[0],d[1],d[4],d[5],d[12],d[13]),m.fillStyle=h,m.fillRect(0,0,s,l),f.drawImage(p.canvas,0,0),p.release(),"continue"}f.strokeStyle=h}else if(n.t===js.CONIC){o=bc(n.stops,n.d,v,g,s-2*u,l-2*c);var y=f.createConicGradient(o.angle,o.cx+v,o.cy+g);o.stop.forEach((function(e){y.addColorStop(e.offset,Tc(e.color))})),f.strokeStyle=y}var b=void 0,x=void 0;if(i===$s.INSIDE||i===$s.OUTSIDE){(x=(b=hl.getOffscreenCanvas(s,l)).ctx).setLineDash(f.getLineDash()),x.lineCap=f.lineCap,x.lineJoin=f.lineJoin,x.miterLimit=f.miterLimit*t,x.strokeStyle=f.strokeStyle,x.lineWidth=2*K[e]*t,x.lineWidth=2*K[e]*t,x.fillStyle="#FFF",te(x,!1);var w=hl.getOffscreenCanvas(s,l),_=w.ctx;_.fillStyle="#FFF",te(_,!0),i===$s.INSIDE?x.globalCompositeOperation="destination-in":x.globalCompositeOperation="destination-out",x.drawImage(w.canvas,0,0),w.release()}else f.lineWidth=K[e]*t,te(f,!1);b&&(f.drawImage(b.canvas,v-u,g-c),b.release()),f.globalCompositeOperation="source-over"},ie=0,oe=V.length;ie<oe;ie++)re(ie)},ne=this;for(C=0,k=p.length;C<k;C++)re(C)},t.prototype.setCursorStartByAbsCoords=function(e,t){var r=this.matrixWorld,n=pu({x:e,y:t},au(r)),i=this.lineBoxList,o=this.cursor,a=o.start;o.isMulti=!1;for(var s=i.length,l=0;l<s;l++){var u=i[l];if(n.y>=u.y&&n.y<u.y+u.lineHeight){o.startLineBox=o.endLineBox=l;var c=this.getCursorByLocalX(n.x,u,!1);o.endTextBox=o.startTextBox,o.endString=o.startString,o.end=o.start,this.tempCursorX=this.currentCursorX=c.x,o.start!==a&&(this.inputStyle=void 0);var h=pu({x:c.x,y:c.y},r);return{x:h.x,y:h.y,h:c.h*r[0]}}}var d=i[s-1];o.startLineBox=o.endLineBox=s-1;var f=this.getCursorByLocalX(this.width,d,!1);o.endTextBox=o.startTextBox,o.endString=o.startString,o.end=o.start,this.tempCursorX=this.currentCursorX=f.x,o.start!==a&&(this.inputStyle=void 0);var p=pu({x:f.x,y:f.y},r);return{x:p.x,y:p.y,h:f.h*r[0]}},t.prototype.setCursorEndByAbsCoords=function(e,t){var r=this.matrixWorld,n=pu({x:e,y:t},au(r)),i=this.lineBoxList,o=this.cursor,a=o.end;o.isMulti=!0;for(var s=i.length,l=0;l<s;l++){var u=i[l];if(n.y>=u.y&&n.y<u.y+u.lineHeight){o.endLineBox=l;var c=this.getCursorByLocalX(n.x,u,!0);o.end!==a&&this.refresh();var h=pu({x:c.x,y:c.y},r);return{x:h.x,y:h.y,h:c.h*r[0]}}}var d=i[s-1];o.endLineBox=s-1;var f=this.getCursorByLocalX(this.width,d,!0);o.end!==a&&this.refresh(),o.end!==o.start&&(this.inputStyle=void 0);var p=pu({x:f.x,y:f.y},r);return{x:p.x,y:p.y,h:f.h*r[0]}},t.prototype.resetCursor=function(){var e=this.cursor;e.isMulti&&(e.isMulti=!1,e.start!==e.end&&(this.refresh(),e.endLineBox=e.startLineBox,e.endTextBox=e.startTextBox,e.endString=e.startString,e.end=e.start))},t.prototype.beforeEdit=function(){var e=this,t=e.style,r=e.computedStyle,n=e.parent,i=e.isDestroyed,o=e.width,a=e.height;if(i||!n)throw new Error("Can not edit a destroyed Text");var s=this.getStyle(),l=t.left,u=t.right,c=t.top,h=t.bottom,d=t.width,f=t.height,p=t.translateX,v=t.translateY,g=t.textAlign,m=t.textVerticalAlign,y=l.u!==Us.AUTO&&u.u!==Us.AUTO||d.u!==Us.AUTO,b=g.v===zs.LEFT&&!y&&(l.u!==Us.AUTO&&p.v&&p.u===Us.PERCENT||u.u!==Us.AUTO),x=g.v===zs.CENTER&&!y&&(-50!==p.v||p.u!==Us.PERCENT),w=g.v===zs.RIGHT&&u.u===Us.AUTO,_=c.u!==Us.AUTO&&h.u!==Us.AUTO||f.u!==Us.AUTO,E=m.v===Xs.TOP&&!_&&(c.u!==Us.AUTO&&v.v&&v.u===Us.PERCENT||h.u!==Us.AUTO),S=m.v===Xs.MIDDLE&&!_&&(-50!==v.v||v.u!==Us.PERCENT),C=m.v===Xs.BOTTOM&&!_&&h.u===Us.AUTO,k=n.width,T=n.height,A=!1,M=0;if(p.u===Us.PX?M=p.v:p.u===Us.PERCENT&&(M=.01*p.v*o),b)l.u!==Us.AUTO&&p.v&&p.u===Us.PERCENT?(A=!0,r.left+=M,l.u===Us.PX?l.v+=M:l.u===Us.PERCENT&&(l.v+=100*M/k),r.right-=M,u.u===Us.PX?u.v-=M:u.u===Us.PERCENT&&(u.v-=100*M/k)):u.u!==Us.AUTO&&(A=!0,r.left+=M,l.v=r.left,l.u=Us.PX,r.right-=M,u.v=0,u.u=Us.AUTO),p.v=0;else if(x){if(p.u===Us.AUTO||p.u===Us.PX){A=!0;var O=.5*o-p.v;r.left+=O,r.right-=O,l.u===Us.PX?(l.v+=O,p.v=-50):l.u===Us.PERCENT?(l.v+=100*O/k,p.v=-50):u.u===Us.PX?(u.v+=O,p.v=50):u.u===Us.PERCENT&&(u.v+=100*O/k,p.v=50),p.u=Us.PERCENT}else if(p.u===Us.PERCENT&&-50!==p.v){A=!0;O=.5*o-p.v*o;r.left+=O,r.right-=O,l.u===Us.PX?(l.v+=O,p.v=-50):l.u===Us.PERCENT?(l.v+=100*O/k,p.v=-50):u.u===Us.PX?(u.v+=O,p.v=50):u.u===Us.PERCENT&&(u.v+=100*O/k,p.v=50)}}else w&&(A=!0,r.left+=M,l.u!==Us.AUTO&&(l.v=0,l.u=Us.AUTO),r.right-=M,u.v=r.right,u.u=Us.PX,p.v=0);var L=0;if(v.u===Us.PX?L=v.v:v.u===Us.PERCENT&&(L=.01*v.v*a),E)c.u!==Us.AUTO&&v.v&&v.u===Us.PERCENT?(A=!0,r.top+=L,c.u===Us.PX?c.v+=L:c.u===Us.PERCENT&&(c.v+=100*L/T),r.bottom-=L,h.u===Us.PX?h.v-=L:h.u===Us.PERCENT&&(h.v-=100*L/T)):h.u!==Us.AUTO&&(A=!0,r.top+=L,c.v=r.top,c.u=Us.PX,r.bottom-=L,h.v=0,h.u=Us.AUTO),v.v=0;else if(S){if(v.u===Us.AUTO||v.u===Us.PX){A=!0;var R=.5*a-v.v;r.top+=R,r.bottom-=R,c.u===Us.PX?(c.v+=R,v.v=-50):c.u===Us.PERCENT?(c.v+=100*R/T,v.v=-50):h.u===Us.PX?(h.v+=R,v.v=50):h.u===Us.PERCENT&&(h.v+=100*R/T,v.v=50),v.u=Us.PERCENT}else if(v.u===Us.PERCENT&&-50!==v.v){A=!0;R=.5*a-v.v*a;r.top+=R,r.bottom-=R,c.u===Us.PX?(c.v+=R,v.v=-50):c.u===Us.PERCENT?(c.v+=100*R/T,v.v=-50):h.u===Us.PX?(h.v-=R,v.v=50):h.u===Us.PERCENT&&(h.v-=100*R/T,v.v=50),v.v=-50}}else C&&(A=!0,r.top+=L,c.u!==Us.AUTO&&(c.v=0,c.u=Us.AUTO),r.bottom-=L,h.v=r.bottom,h.u=Us.PX,v.v=0);if(A)return this.editStyle={isLeft:b,isCenter:x,isRight:w,isTop:E,isMiddle:S,isBottom:C,isFixedHeight:_,prev:s}},t.prototype.afterEdit=function(){if(this.editStyle){var e=this.editStyle,t=e.isLeft,r=e.isCenter,n=e.isRight,i=e.isTop,o=e.isMiddle,a=e.isBottom;e.isFixedHeight;var s=e.prev,l=this,u=l.style,c=l.computedStyle,h=l.parent,d=l.width,f=l.height,p=s.left,v=s.right,g=s.top,m=s.bottom;s.height;var y=s.translateX,b=s.translateY,x=h,w=x.width,_=x.height,E=0;if(y.u===Us.PX?E=y.v:y.u===Us.PERCENT&&(E=.01*y.v*d),t){if(p.u!==Us.AUTO&&y.v&&y.u===Us.PERCENT){if(p.u===Us.PX)u.left.v-=E,c.left-=E;else if(p.u===Us.PERCENT){var S=100*E/w;u.left.v-=S,c.left-=E}if(v.u===Us.PX)u.right.v+=E,c.right+=E;else if(v.u===Us.PERCENT){S=100*E/w;u.right.v+=S,c.right+=E}c.translateX+=E}else v.u!==Us.AUTO&&(u.left.v=0,u.left.u=Us.AUTO,c.left-=E,u.right.v=v.v,u.right.u=v.u,c.right+=E);u.translateX.v=y.v}else if(r){if(y.u===Us.AUTO||y.u===Us.PX){var C=.5*d-y.v;p.u===Us.PX?u.left.v-=C:p.u===Us.PERCENT?u.left.v-=100*C/w:v.u===Us.PX?u.right.v-=C:v.u===Us.PERCENT&&(u.right.v-=100*C/w),u.translateX.v=y.v,u.translateX.u=y.u}else if(y.u===Us.PERCENT&&-50!==y.v){C=.5*d-y.v*d;p.u===Us.PX?u.left.v-=C:p.u===Us.PERCENT&&(u.left.v-=100*C/w),v.u===Us.PX?u.right.v-=C:v.u===Us.PERCENT&&(u.right.v-=100*C/w),u.translateX.v=y.v}}else n&&(c.left-=E,p.u===Us.PX?u.left.v=c.left:p.u===Us.PERCENT&&(u.left.v=100*c.left/w),u.left.u=p.u,c.right+=E,v.u===Us.AUTO&&(u.right.v=0,u.right.u=Us.AUTO),u.translateX.v=y.v,u.translateX.u=y.u);var k=0;if(b.u===Us.PX?k=b.v:b.u===Us.PERCENT&&(k=.01*b.v*f),i){if(g.u!==Us.AUTO&&b.v&&b.u===Us.PERCENT){if(g.u===Us.PX)u.top.v-=k,c.top-=k;else if(g.u===Us.PERCENT){S=100*k/_;u.top.v-=S,c.top-=k}if(m.u===Us.PX)u.bottom.v+=k,c.bottom+=k;else if(m.u===Us.PERCENT){S=100*k/_;u.bottom.v+=S,c.bottom+=k}}else m.u!==Us.AUTO&&(u.top.v=0,u.top.u=Us.AUTO,c.top-=k,u.bottom.v=m.v,u.bottom.u=m.u,c.bottom+=k);u.translateY.v=b.v,c.translateY+=k}else if(o){if(b.u===Us.AUTO||b.u===Us.PX){var T=.5*f-b.v;g.u===Us.PX?u.top.v-=T:g.u===Us.PERCENT?u.top.v-=100*T/_:m.u===Us.PX?u.bottom.v-=T:m.u===Us.PERCENT&&(u.bottom.v-=100*T/_),u.translateY.v=b.v,u.translateY.u=Us.PX}else if(b.u===Us.PERCENT&&-50!==b.v){T=.5*f-b.v*f;g.u===Us.PX?u.top.v-=T:g.u===Us.PERCENT?u.top.v-=100*T/_:m.u===Us.PX?u.bottom.v-=T:m.u===Us.PERCENT&&(u.bottom.v-=100*T/_),u.translateY.v=b.v}}else a&&(c.top-=k,g.u===Us.PX?u.top.v=c.top:g.u===Us.PERCENT&&(u.top.v=100*c.top/_),c.bottom+=k,m.u===Us.AUTO&&(u.bottom.v=0,u.bottom.u=Us.AUTO),u.translateY.v=b.v,u.translateY.u=b.u)}},t.prototype.updateCursorByIndex=function(e){var t=this.setCursorByIndex(e,!1),r=t.lineBox,n=t.textBox,i=this.cursor,o=this.matrixWorld;if(n){var a=hl.getFontCanvas().ctx;a.font=n.font,a.letterSpacing=n.letterSpacing+"px";var s=n.str,l=a.measureText(s.slice(0,i.startString)).width;this.tempCursorX=this.currentCursorX=n.x+l}else{var u=this.computedStyle.textAlign;u===zs.CENTER?this.tempCursorX=this.currentCursorX=.5*this.width:u===zs.RIGHT?this.tempCursorX=this.currentCursorX=this.width:this.tempCursorX=this.currentCursorX=0}var c=pu({x:this.tempCursorX,y:r.y},o);return{x:c.x,y:c.y,h:r.lineHeight*o[0]}},t.prototype.setCursorByIndex=function(e,t){void 0===t&&(t=!1);var r=this.lineBoxList,n=this.cursor;t?n.end=e:n.start=e;for(var i=0,o=r.length;i<o;i++){var a=r[i],s=a.list;if(!s.length&&a.index===e)return n.startLineBox=i,n.startTextBox=0,n.startString=0,{lineBox:a,textBox:void 0};for(var l=0,u=s.length;l<u;l++){var c=s[l];if(e>=c.index&&(e<c.index+c.str.length||l===u-1&&a.endEnter&&e<=c.index+c.str.length))return t?(n.endLineBox=i,n.endTextBox=l,n.endString=e-c.index):(n.startLineBox=i,n.startTextBox=l,n.startString=e-c.index),{lineBox:a,textBox:c}}}var h=r.length-1,d=r[h],f=d.list;if(t?n.endLineBox=h:n.startLineBox=h,!f||!f.length)return t?(n.endTextBox=0,n.endString=0):(n.startTextBox=0,n.startString=0),{lineBox:d,textBox:void 0};var p=f.length-1,v=f[p];return t?(n.endTextBox=p,n.endString=v.str.length):(n.startTextBox=p,n.startString=v.str.length),{lineBox:d,textBox:v}},t.prototype.checkCursorMulti=function(){var e=this.cursor;return e.isMulti&&e.start===e.end&&(e.isMulti=!1),e.isMulti},t.prototype.getCursorAbsCoords=function(){var e=this.matrixWorld,t=this.lineBoxList,r=this.cursor;if(!r.isMulti){var n=t[r.startLineBox],i=n.list,o=n.lineHeight;if(!i.length){var a=this.computedStyle.textAlign,s=0;a===zs.CENTER?s=.5*this.width:a===zs.RIGHT&&(s=this.width);var l=pu({x:s,y:n.y},e);return{x:l.x,y:l.y,h:o*e[0]}}var u=pu({x:this.currentCursorX,y:n.y},e);return{x:u.x,y:u.y,h:o*e[0]}}},t.prototype.moveCursor=function(e,t){void 0===t&&(t=!1);var r=this.matrixWorld,n=this.cursor,i=this.getSortedCursor(),o=t?i.endLineBox:i.startLineBox,a=t?i.endTextBox:i.startTextBox,s=t?i.endString:i.startString,l=this.lineBoxList,u=l[o],c=u.list,h=c[a],d=t?i.end:i.start;if(n.isMulti&&!t){if(n.isMulti=!1,n.start!==n.end&&this.refresh(),39===e||40===e){var f=i.endLineBox,p=i.endTextBox,v=i.endString;d=(h=(c=(u=l[f]).list)[p])?h.index+v:u.index+v}return this.inputStyle=void 0,this.updateCursorByIndex(d)}if(t&&(n.isMulti=!0),37===e){if(0===d)return;0===s?0===a?(t?n.endLineBox=--o:n.startLineBox=--o,(c=(u=l[o]).list).length?(t?n.endTextBox=a=c.length-1:n.startTextBox=a=c.length-1,h=c[a],t?(n.endString=h.str.length-(u.endEnter?0:1),n.end=h.index+n.endString):(n.startString=h.str.length-(u.endEnter?0:1),n.start=h.index+n.startString)):t?(n.endTextBox=0,n.endString=0,n.end=u.index):(n.startTextBox=0,n.startString=0,n.start=u.index)):(t?n.endTextBox=--a:n.startTextBox=--a,h=c[a],t?(n.endString=h.str.length-1,n.end=h.index+n.endString):(n.startString=h.str.length-1,n.start=h.index+n.startString)):t?(n.endString=--s,n.end=h.index+n.endString):(n.startString=--s,n.start=h.index+n.startString)}else if(38===e){if(0===d)return;if(0!==o){u=l[--o],t?n.endLineBox=o:n.startLineBox=o;var g=this.getCursorByLocalX(this.tempCursorX,u,t);t&&this.refresh(),this.inputStyle=void 0;var m=pu({x:g.x,y:g.y},r);return{x:m.x,y:m.y,h:u.lineHeight*r[0]}}t?n.endTextBox=0:n.startTextBox=0,h=c[0],t?(n.endString=0,n.end=0):(n.startString=0,n.start=0)}else if(39===e){if(d===this._content.length)return;!h||a===c.length-1&&s===h.str.length&&u.endEnter?(t?(n.endLineBox=++o,n.endTextBox=0,n.endString=0):(n.startLineBox=++o,n.startTextBox=0,n.startString=0),h=(c=(u=l[o]).list)[0],t?n.end=h.index:n.start=h.index):a===c.length-1&&s===h.str.length?(t?(n.endLineBox=++o,n.endTextBox=0,n.endString=1):(n.startLineBox=++o,n.startTextBox=0,n.startString=1),h=(c=(u=l[o]).list)[0],t?n.end=h.index+1:n.start=h.index+1):s===h.str.length?(t?n.endTextBox=++a:n.startTextBox=++a,h=c[a],t?(n.endString=1,n.end=h.index+1):(n.startString=1,n.start=h.index+1),a===c.length-1&&1===h.str.length&&!u.endEnter&&o<l.length-1&&(t?n.endLineBox=++o:n.startLineBox=++o,c=(u=l[o]).list,t?n.endTextBox=a=0:n.startTextBox=a=0,h=c[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index))):s===h.str.length-1?a===c.length-1?u.endEnter||o===l.length-1?t?(n.endString++,n.end=h.index+n.endString):(n.startString++,n.start=h.index+n.startString):(t?n.endLineBox=++o:n.startLineBox=++o,c=(u=l[o]).list,t?n.endTextBox=a=0:n.startTextBox=a=0,h=c[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index)):(t?n.endTextBox=++a:n.startTextBox=++a,h=c[a],t?(n.endString=0,n.end=h.index):(n.startString=0,n.start=h.index)):t?(n.endString=++s,n.end=h.index+n.endString):(n.startString=++s,n.start=h.index+n.startString)}else if(40===e){if(d===this._content.length)return;if(o!==l.length-1){u=l[++o],t?n.endLineBox=o:n.startLineBox=o;g=this.getCursorByLocalX(this.tempCursorX,u,t);t&&this.refresh(),this.inputStyle=void 0;var y=pu({x:g.x,y:g.y},r);return{x:y.x,y:y.y,h:u.lineHeight*r[0]}}t?n.endTextBox=a=c.length-1:n.startTextBox=a=c.length-1,h=c[a],t?(n.endString=h?h.str.length:0,n.end=h.index+n.endString):(n.startString=h?h.str.length:0,n.start=h.index+n.startString)}if(h){var b=hl.getFontCanvas().ctx;b.font=h.font,b.letterSpacing=h.letterSpacing+"px";var x=h.str,w=b.measureText(x.slice(0,n.startString)).width;this.tempCursorX=this.currentCursorX=h.x+w}else{var _=this.computedStyle.textAlign;_===zs.CENTER?this.tempCursorX=this.currentCursorX=.5*this.width:_===zs.RIGHT?this.tempCursorX=this.currentCursorX=this.width:this.tempCursorX=this.currentCursorX=0}t&&this.refresh(),this.inputStyle=void 0;var E=pu({x:this.currentCursorX,y:u.y},r);return{x:E.x,y:E.y,h:u.lineHeight*r[0]}},t.prototype.selectAll=function(){var e=this.lineBoxList,t=e.length,r=e[t-1],n=null==r?void 0:r.list,i=n?n[n.length-1]:void 0;Object.assign(this.cursor,{isMulti:!0,startLineBox:0,startTextBox:0,startString:0,start:0,endLineBox:t-1,endTextBox:n?n.length-1:0,endString:i?i.str.length:0,end:this._content.length}),this.refresh()},t.prototype.input=function(e){var t=this.getSortedCursor(),r=t.isMulti,n=t.start,i=t.end,o=this._content;if(r){var a=this.getCursorRich();this.cursor.isMulti=!1,this._content=o.slice(0,n)+o.slice(i),this.cutRich(n,i),o=this._content,this._content=o.slice(0,n)+e+o.slice(n),this.insertRich(a[0],n,e.length)}else if(this.inputStyle){a=this.getCursorRich();this._content=o.slice(0,n)+e+o.slice(n),this.insertRich(Object.assign({},a[0],this.inputStyle),n,e.length),this.inputStyle=void 0}else this._content=o.slice(0,n)+e+o.slice(n),this.expandRich(n,e.length);this.refresh(Qb.REFLOW),this.updateCursorByIndex(n+e.length)},t.prototype.enter=function(){this.inputStyle=void 0;var e=this.getSortedCursor(),t=e.isMulti,r=e.start,n=e.end;if(t){this.cursor.isMulti=!1,this.cutRich(r,n);var i=this._content;this._content=i.slice(0,r)+i.slice(n)}this.expandRich(r,1);var o=this._content;this._content=o.slice(0,r)+"\n"+o.slice(r),this.refresh(Qb.REFLOW),this.updateCursorByIndex(r+1)},t.prototype.delete=function(e){void 0===e&&(e=!1),this.inputStyle=void 0;var t=this._content;if(t){var r=this.getSortedCursor(),n=r.isMulti,i=r.start,o=r.end;i<1&&!n&&!e||i===t.length&&e||(n?(this.cursor.isMulti=!1,this._content=t.slice(0,i)+t.slice(o),this.cutRich(i,o)):e?(this._content=t.slice(0,i)+t.slice(i+1),this.cutRich(i,i+1)):(this._content=t.slice(0,i-1)+t.slice(i),this.cutRich(i-1,i)),this.refresh(Qb.REFLOW),n||e?this.updateCursorByIndex(i):this.updateCursorByIndex(i-1))}},t.prototype.getCursorByLocalX=function(e,t,r){void 0===r&&(r=!1);var n=t.list,i=this.cursor,o=0,a=t.y,s=t.lineHeight;r?i.endString=i.end=0:i.startString=i.start=0;e:for(var l=0,u=n.length;l<u;l++){var c=(E=n[l]).x,h=E.w,d=E.str,f=E.font,p=E.letterSpacing;if(!l&&e<c||e>=c&&e<c+h||l===u-1){r?i.endTextBox=l:i.startTextBox=l;var v=hl.getFontCanvas().ctx;v.font=f,v.letterSpacing=p+"px";for(var g=0,m=d.length;g<m;){if(g===m-1){var y=v.measureText(d.slice(0,g)).width,b=v.measureText(d.slice(0,m)).width;e-(c+y)>c+b-e?(o=c+b,r?(i.endString=m,i.end=E.index+m):(i.startString=m,i.start=E.index+m)):(o=c+y,r?(i.endString=g,i.end=E.index+g):(i.startString=g,i.start=E.index+g));break e}var x=g+(m-g>>1),w=v.measureText(d.slice(0,x)).width;if(e>c+w)g=x;else{if(!(e<c+w)){r?(i.endString=x,i.end=E.index+x):(i.startString=x,i.start=E.index+x),o=c+w;break e}m=x}}}}var _=r?i.endTextBox:i.startTextBox;if(_<n.length-1){var E=n[_];(r?i.endString:i.startString)===E.str.length&&(r?(i.endTextBox++,i.endString=0,i.end=n[_+1].index):(i.startTextBox++,i.startString=0,i.start=n[_+1].index))}if(!n.length){r?(i.endString=0,i.end=t.index):(i.startString=0,i.start=t.index);var S=this.computedStyle.textAlign;S===zs.CENTER?o=.5*this.width:S===zs.RIGHT&&(o=this.width)}return{x:o,y:a,h:s}},t.prototype.getRich=function(){return this.rich.map((function(e){return Object.assign({},e)}))},t.prototype.setRich=function(e){this.rich=e,this.refresh(Qb.REFLOW)},t.prototype.getCursor=function(){return Object.assign({},this.cursor)},t.prototype.updateRangeStyle=function(e,t,r){var n=Qb.NONE;if(0===e){var i=this.style,o=this.computedStyle;void 0!==r.fontFamily&&(i.fontFamily.v=o.fontFamily=r.fontFamily),void 0!==r.fontSize&&(i.fontSize.v=o.fontSize=r.fontSize),void 0!==r.color&&(i.color.v=o.color=kc(r.color)),void 0!==r.letterSpacing&&(i.letterSpacing.v=o.letterSpacing=r.letterSpacing),void 0!==r.lineHeight&&(0===r.lineHeight?(i.lineHeight.v=0,i.lineHeight.u=Us.AUTO,o.lineHeight=Ic(o)):(i.lineHeight.v=o.lineHeight=r.lineHeight,i.lineHeight.u=Us.PX)),void 0!==r.paragraphSpacing&&(i.paragraphSpacing.v=o.paragraphSpacing=r.paragraphSpacing),void 0!==r.textAlign&&(i.textAlign.v=o.textAlign=r.textAlign),void 0!==r.textDecoration&&(i.textDecoration=r.textDecoration.map((function(e){return{v:e,u:Us.NUMBER}})),o.textDecoration=r.textDecoration.slice(0))}for(var a=this.rich,s=0,l=a.length;s<l&&!(t<1);s++){var u=a[s];if(e>=u.location&&e<u.location+u.length){if(e>u.location){var c=Z(Z({},u),{length:e-u.location});a.splice(s,0,c),s++,l++,u.location+=c.length,u.length-=c.length}var h=!1;if(e+t<u.location+u.length){var d=Z(Z({},u),{location:e+t,length:u.location+u.length-e-t});a.splice(s+1,0,d),u.length-=d.length,h=!0}if(n|=this.updateRichItem(u,r),h)break;e+=u.length,t-=u.length}}this.mergeRich(),n&&this.refresh(n)},t.prototype.updateRichItem=function(e,t){var r=Qb.NONE;if(void 0!==t.fontFamily&&t.fontFamily!==e.fontFamily&&(e.fontFamily=t.fontFamily,r|=Qb.REFLOW),void 0!==t.fontSize&&t.fontSize!==e.fontSize&&(e.fontSize=t.fontSize,r|=Qb.REFLOW),void 0!==t.color){var n=kc(t.color);e.color[0]===n[0]&&e.color[1]===n[1]&&e.color[2]===n[2]&&e.color[3]===n[3]||(e.color=n,r|=Qb.REFLOW)}return void 0!==t.letterSpacing&&t.letterSpacing!==e.letterSpacing&&(e.letterSpacing=t.letterSpacing,r|=Qb.REFLOW),void 0!==t.lineHeight&&t.lineHeight!==e.lineHeight&&(e.lineHeight=t.lineHeight,r|=Qb.REFLOW),void 0!==t.paragraphSpacing&&t.paragraphSpacing!==e.paragraphSpacing&&(e.paragraphSpacing=t.paragraphSpacing,r|=Qb.REFLOW),void 0!==t.textAlign&&t.textAlign!==e.textAlign&&(e.textAlign=t.textAlign,r|=Qb.REFLOW),void 0!==t.textDecoration&&t.textDecoration!==e.textDecoration&&(e.textDecoration=t.textDecoration,r|=Qb.REFLOW),r},t.prototype.cutRich=function(e,t){var r=this.rich;if(r.length){for(var n=t-e,i=0,o=r.length;i<o;i++){var a=r[i];if(a.location<=e&&a.location+a.length>e){if(a.location+a.length>=t){a.length-=n;for(var s=i+1;s<o;s++)r[s].location-=n;a.length||r.splice(i,1)}else{a.length=e-a.location;for(var l=i+1,u=r.length;l<u;l++){var c=r[l];if(c.location<=t&&(c.location+c.length>t||l===u-1)){c.length-=t-c.location,c.location-=n;s=l+1;for(var h=r.length;s<h;s++)r[s].location-=n;i<l-1&&r.splice(i+1,l-i-1),c.length||r.splice(l,1);break}}a.length||r.splice(i,1)}break}}this.mergeRich()}},t.prototype.expandRich=function(e,t){var r=this.rich,n=this._content;if(r.length){e=Math.max(0,e);for(var i=0,o=r.length;i<o;i++){var a=r[i];if(a.location<=e&&a.location+a.length>=e){if(e===a.location+a.length&&"\n"===n.charAt(e-1))continue;a.length+=t;for(var s=i+1;s<o;s++)r[s].location+=t;return}}r[r.length-1].length+=t}else{var l=this.computedStyle;r.push({location:e,length:t,fontFamily:l.fontFamily,fontSize:l.fontSize,fontWeight:400,fontStyle:"normal",letterSpacing:l.letterSpacing,textAlign:[zs.LEFT,zs.RIGHT,zs.CENTER,zs.JUSTIFY][l.textAlign],textDecoration:l.textDecoration,lineHeight:l.lineHeight,paragraphSpacing:l.paragraphSpacing,color:l.color})}},t.prototype.insertRich=function(e,t,r){var n=this.computedStyle,i=Object.assign({location:t,length:r,fontFamily:n.fontFamily,fontSize:n.fontSize,fontWeight:400,fontStyle:"normal",letterSpacing:n.letterSpacing,textAlign:n.textAlign,textDecoration:n.textDecoration,lineHeight:n.lineHeight,paragraphSpacing:n.paragraphSpacing,color:n.color},e);i.color=kc(i.color),i.location=t,i.length=r;var o=this.rich;if(o.length){for(var a=0,s=o.length;a<s;a++){var l=o[a];if(l.location<=t&&l.location+l.length>=t){for(var u=a+1;u<s;u++)o[u].location+=r;if(l.location===t)o.splice(a,0,i),l.location+=r;else if(l.location+l.length===t)o.splice(a+1,0,i);else if(l.location+l.length>t){var c=Rs(l);l.length=t-l.location,c.location=t+r,c.length-=l.length,o.splice(a+1,0,i),o.splice(a+2,0,c)}return void this.mergeRich()}}o.push(i),this.mergeRich()}else o.push(i)},t.prototype.mergeRich=function(){var e=this,t=e.rich,r=e._content,n=e.style;if(t.length){this.rich=t=t.filter((function(e){return e.location>-1&&e.length>0})),t.sort((function(e,t){return e.location===t.location?e.length-t.length:e.location-t.location}));var i=!1,o={fontFamily:n.fontFamily.v,fontSize:n.fontSize.v,fontWeight:400,fontStyle:"normal",letterSpacing:n.letterSpacing.v,textAlign:n.textAlign.v,textDecoration:n.textDecoration.map((function(e){return e.v})),lineHeight:n.lineHeight.v,paragraphSpacing:n.paragraphSpacing.v,color:n.color.v.slice(0)};if(r.length){var a=t[t.length-1];(!t.length||a.location+a.length<r.length)&&(t.push(Z({location:a?a.location+a.length:0,length:a?r.length-a.location-a.length:r.length},o)),i=!0),(a=t[t.length-1]).location+a.length>r.length&&(a.length=r.length-a.location,i=!0);var s=t[0];s.location>0&&(t.unshift(Z({location:0,length:s.location},o)),i=!0)}for(var l=t.length-2;l>=0;l--){var u=t[l],c=t[l+1];if(c.length)if(u.length){var h=u.location+u.length;if(h===c.location)Is(u,c,["color","fontFamily","fontSize","letterSpacing","lineHeight","textDecoration","paragraphSpacing"])?u.textAlign!==c.textAlign&&"\n"===r.charAt(c.location-1)||(u.length+=c.length,t.splice(l+1,1),i=!0):1===c.length&&"\n"===r.charAt(c.location)&&(u.length+=c.length,t.splice(l+1,1),i=!0);else{if(h<c.location)t.splice(l+1,0,Z({location:h,length:c.location-h},o)),l+=2;else{var d=u.location+u.length-c.location;c.location-=d,c.length-=d,l++}i=!0}}else t.splice(l,1),l++;else t.splice(l+1,1)}return i}},t.prototype.setInputStyle=function(e){this.inputStyle=e?Z(Z({},this.inputStyle),e):void 0},t.prototype.getSortedCursor=function(){var e,t=this.cursor,r=t.isMulti,n=t.startLineBox,i=t.startTextBox,o=t.startString,a=t.endLineBox,s=t.endTextBox,l=t.endString,u=t.start,c=t.end,h=!1;return r?u>c&&(n=(e=[a,s,l,c,n,i,o,u])[0],i=e[1],o=e[2],u=e[3],a=e[4],s=e[5],l=e[6],c=e[7],h=!0):(a=n,s=i,l=o,c=u),{isMulti:r,startLineBox:n,startTextBox:i,startString:o,endLineBox:a,endTextBox:s,endString:l,start:u,end:c,isReversed:h}},t.prototype.getCursorRich=function(){var e=this.rich,t=this.lineBoxList,r=[];if(!e.length)return r;function n(t,r,n){for(void 0===r&&(r=0),void 0===n&&(n=e.length-1);r<n;){var i=Math.floor(.5*(r+n)),o=e[i];if(o.location<t&&o.location+o.length>=t)return o;o.location>=t?n=Math.min(i,n-1):r=Math.max(i,r+1)}return e[r]}var i=this.getSortedCursor(),o=i.isMulti,a=i.startLineBox,s=i.startTextBox,l=i.startString,u=i.start,c=i.end;if(o)for(var h=0,d=e.length;h<d;h++){if((f=e[h]).location>=c)break;f.location+f.length>u&&r.push(f)}if(!o||!r.length){var f,p=t[a],v=p.list;if(v.length)(f=n(v[s].index+(s+l===0?1:l)))&&-1===r.indexOf(f)&&r.push(f);else(f=n(p.index))&&-1===r.indexOf(f)&&r.push(f)}return r},t.prototype.clone=function(e){var r=this,n=Rs(this.props),i=n.uuid;e&&e.hasOwnProperty(i)&&e[i].forEach((function(e){var t=e.key,n=e.value;"content"===t[0]&&(r._content=n)})),n.uuid=s(),n.sourceUuid=this.props.uuid,this.rich&&(n.rich=this.rich.map((function(e){return Z(Z({},e),{textAlign:["left","right","center","justify"][e.textAlign]||"left",textDecoration:e.textDecoration.map((function(e){return["none","underline","lineThrough"][e]||"none"})),color:Tc(e.color)})}))),n.content=this._content;var o=new t(n);return o.style=Rs(this.style),o.computedStyle=Rs(this.computedStyle),o},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.TEXT,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r,n,i,o,a,s,l,u,c,h,d,f;return Q(this,(function(p){switch(p.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=p.sent())._class=$.ClassValue.Text,n=this.rich.length?this.rich:this._content?[{location:0,length:this._content.length,fontFamily:this.computedStyle.fontFamily,fontSize:this.computedStyle.fontSize,fontWeight:this.computedStyle.fontWeight,letterSpacing:this.computedStyle.letterSpacing,textAlign:this.computedStyle.textAlign,textDecoration:this.computedStyle.textDecoration,lineHeight:this.style.lineHeight.u===Us.AUTO?0:this.computedStyle.lineHeight,paragraphSpacing:this.computedStyle.paragraphSpacing,color:this.computedStyle.color}]:[],r.attributedString={_class:"attributedString",string:this._content,attributes:n.map((function(e){return{_class:"stringAttribute",location:e.location,length:e.length,attributes:{kerning:e.letterSpacing,MSAttributedStringFontAttribute:{_class:"fontDescriptor",attributes:{name:e.fontFamily,size:e.fontSize}},MSAttributedStringColorAttribute:{_class:"color",alpha:e.color[3],red:e.color[0]/255,green:e.color[1]/255,blue:e.color[2]/255},paragraphStyle:{_class:"paragraphStyle",alignment:[$.TextHorizontalAlignment.Left,$.TextHorizontalAlignment.Right,$.TextHorizontalAlignment.Centered,$.TextHorizontalAlignment.Justified][e.textAlign||0],minimumLineHeight:e.lineHeight,maximumLineHeight:e.lineHeight,paragraphSpacing:e.paragraphSpacing},underlineStyle:e.textDecoration.indexOf(fl.UNDERLINE)>-1?$.UnderlineStyle.Underlined:$.UnderlineStyle.None,strikethroughStyle:e.textDecoration.indexOf(fl.LINE_THROUGH)>-1?$.StrikethroughStyle.Strikethrough:$.StrikethroughStyle.None}}}))},i=this.style,o=i.left,a=i.right,s=i.top,l=i.bottom,u=i.width,c=i.height,h=u.u===Us.AUTO&&(o.u===Us.AUTO||a.u===Us.AUTO),d=c.u===Us.AUTO&&(s.u===Us.AUTO||l.u===Us.AUTO),r.textBehaviour=h&&d||h?$.TextBehaviour.Flexible:d?$.TextBehaviour.Fixed:$.TextBehaviour.FixedWidthAndHeight,f=this.computedStyle,r.style.textStyle={_class:"textStyle",verticalAlignment:[$.TextVerticalAlignment.Top,$.TextVerticalAlignment.Middle,$.TextVerticalAlignment.Bottom][f.textVerticalAlign],encodedAttributes:{paragraphStyle:{_class:"paragraphStyle",alignment:[$.TextHorizontalAlignment.Left,$.TextHorizontalAlignment.Right,$.TextHorizontalAlignment.Centered,$.TextHorizontalAlignment.Justified,$.TextHorizontalAlignment.Natural][f.textAlign]},underlineStyle:f.textDecoration.includes(fl.UNDERLINE)?$.UnderlineStyle.Underlined:$.UnderlineStyle.None,strikethroughStyle:f.textDecoration.includes(fl.LINE_THROUGH)?$.StrikethroughStyle.Strikethrough:$.StrikethroughStyle.None,kerning:f.letterSpacing,MSAttributedStringFontAttribute:{_class:"fontDescriptor",attributes:{name:f.fontFamily,size:f.fontSize}}}},[2,r]}}))}))},Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){e!==this._content&&(this._content=e,this.refresh(Qb.REFLOW))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.lineBoxList.forEach((function(t){t.list.forEach((function(t){var r=t.fontFamily,n=t.fontSize,i=t.lineHeight,o=t.str,a=t.font,s=i;if(Hl.hasRegister(r)){s=Hl.data[r].lhr*n}else{var l=hl.getFontCanvas().ctx;l.font=a;var u=l.measureText(o);s=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent}var c=s-i;if(c>0){var h=.5*c,d=t.y-h,f=t.lineHeight+h;d<0&&(e[1]=Math.min(e[1],d)),e[3]=Math.max(e[3],f)}}))}));var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=0;n.forEach((function(e,t){i[t]&&(o[t]===$s.INSIDE||(a=o[t]===$s.OUTSIDE?Math.max(a,2*e):Math.max(a,.5*e*2)))})),e[0]-=a,e[1]-=a,e[2]+=a,e[3]+=a}return e},enumerable:!1,configurable:!0}),t.setFontAndLetterSpacing=p_,t}(Wx);function p_(e,t,r){1!==r?(e.font=t.font.replace(/([\d.e+-]+)px/gi,(function(e,t){return t*r+"px"})),e.letterSpacing=t.letterSpacing*r+"px"):(e.font=t.font,e.letterSpacing=t.letterSpacing+"px")}var v_=function(e){function t(t,r){var n=this,i=t.overrideValues||{};return(n=e.call(this,t,r.children.map((function(e){return e.clone(i)})))||this).isSymbolInstance=!0,n.symbolMaster=r,n.symbolInstance=n,r.addSymbolInstance(n),n}return v(t,e),t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=this.symbolMaster.clone(e),i=new t(r,n);return n.addSymbolInstance(i),i.style=Rs(this.style),i.computedStyle=Rs(this.computedStyle),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SYMBOL_INSTANCE,t},t}(l_),g_=function(e){function t(t){var r=e.call(this,t)||this;return r.isSlice=!0,r}return v(t,e),t.prototype.calContent=function(){return this.hasContent=!1},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SLICE,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n;return Q(this,(function(i){switch(i.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=i.sent())._class=$.ClassValue.Slice,[2,n]}}))}))},t}(Wx);function m_(e,t){var r=e.tagName;if(r===l.ART_BOARD||r===l.SYMBOL_MASTER){for(var n=[],i=0,o=e.children.length;i<o;i++){(h=m_(e.children[i],t))&&n.push(h)}if(r===l.SYMBOL_MASTER){var a=(s=e.props).symbolId;return(null==t?void 0:t.symbolMasters[a])||new u_(s,n)}return new qx(e.props,n)}if(r===l.SYMBOL_INSTANCE){a=(s=e.props).symbolId;var s,u=null==t?void 0:t.symbolMasters[a];if(u)return new v_(s,u)}else{if(r===l.GROUP){n=[];var c=e.children||[];for(i=0,o=c.length;i<o;i++){(h=m_(c[i],t))&&n.push(h)}return new l_(e.props,n)}if(r===l.BITMAP)return new Qx(e.props);if(r===l.TEXT)return new f_(e.props);if(r===l.POLYLINE)return new pw(e.props);if(r===l.SHAPE_GROUP){for(n=[],i=0,o=e.children.length;i<o;i++){var h;(h=m_(e.children[i],t))&&n.push(h)}return new uE(e.props,n)}if(r===l.SLICE)return new g_(e.props)}}function y_(e){var t={};return e.forEach((function(e){b_(e.props.symbolId,e.children||[],t)})),e.sort((function(e,r){var n=e.props.symbolId,i=r.props.symbolId;return t[n]===i?-1:t[i]===n?1:0})),e}function b_(e,t,r){t.forEach((function(t){if(t.tagName===l.SYMBOL_MASTER){var n=t.props.symbolId;r[n]=e,b_(n,t.children||[],r)}else if(t.tagName===l.SYMBOL_INSTANCE)r[t.props.symbolId]=e;else if(t.tagName===l.GROUP){var i=t.children||[];b_(e,i,r)}}))}var x_,w_={parse:m_,sortSymbolMasters:y_},__=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.isPage=!0,n.page=n,n}return v(t,e),t.prototype.initIfNot=function(){if(this.json){for(var e=0,t=this.json.children,r=t.length;e<r;e++){var n=m_(t[e],this.root);n&&this.appendChild(n)}return this.json=void 0,!0}return!1},t.prototype.zoomTo=function(e,t,r){if(void 0===t&&(t=.5),void 0===r&&(r=.5),this.root&&!this.isDestroyed){var n=this.getComputedStyle(),i=n.translateX,o=n.translateY;if(n.scaleX!==e){var a=au(this.matrixWorld),s=this.root,l=s.width,u=s.height,c=s.dpi,h={x:t*l/c*c,y:r*u/c*c},d=pu(h,a),f=pu(d,uc(_c({translateX:i,translateY:o,scaleX:e,scaleY:e}))),p=f.x-h.x/c,v=f.y-h.y/c;this.updateStyle({translateX:i-p,translateY:o-v,scaleX:e,scaleY:e})}}else this.updateStyle({scaleX:e,scaleY:e})},t.prototype.zoomActual=function(){return this.updateStyle({scaleX:1,scaleY:1}).keys.length>0},t.prototype.zoomFit=function(){var e=this.children;if(e.length&&this.root){for(var t=e[0],r=t.rect,n=r[0],i=r[1],o=r[2],a=r[3],s=t.matrix,l=pu({x:n,y:i},s),u=pu({x:n,y:a},s),c=pu({x:o,y:i},s),h=pu({x:o,y:a},s),d=Math.min(l.x,u.x,c.x,h.x),f=Math.min(l.y,u.y,c.y,h.y),p=Math.max(l.x,u.x,c.x,h.x),v=Math.max(l.y,u.y,c.y,h.y),g=1,m=e.length;g<m;g++){var y=e[g],b=y.rect,x=b[0],w=b[1],_=b[2],E=b[3],S=y.matrix,C=pu({x:x,y:w},S),k=pu({x:x,y:E},S),T=pu({x:_,y:w},S),A=pu({x:_,y:E},S);d=Math.min(d,C.x,k.x,T.x,A.x),f=Math.min(f,C.y,k.y,T.y,A.y),p=Math.max(p,C.x,k.x,T.x,A.x),v=Math.max(v,C.y,k.y,T.y,A.y)}var M=p-d,O=v-f;if(M&&O){var L=d-.05*M,R=f-.05*O;M*=1.1,O*=1.1;var I=this.root,F=I.width,P=I.height,D=I.dpi,N=(F=Math.max(F,100)/D)/M,B=(P=Math.max(P,100)/D)/O;return N>=B?this.updateStyle({translateX:-L*B-.5*(M*B-F),translateY:-R*B,scaleX:B,scaleY:B}):this.updateStyle({translateX:-L*N,translateY:-R*N-.5*(O*N-P),scaleX:N,scaleY:N}),!0}}},t.prototype.getZoom=function(e){void 0===e&&(e=!1);var t=this.computedStyle.scaleX;return!e&&this.root?t*this.root.dpi:t},t.prototype.clone=function(e){var r=Rs(this.props);r.uuid=s(),r.sourceUuid=this.props.uuid;var n=new t(r,this.children.map((function(t){return t.clone(e)})));return n.style=Rs(this.style),n.computedStyle=Rs(this.computedStyle),n},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.PAGE,t},t.prototype.toSketchJson=function(t,r){return J(this,void 0,void 0,(function(){var n,i;return Q(this,(function(o){switch(o.label){case 0:return[4,e.prototype.toSketchJson.call(this,t,r)];case 1:return(n=o.sent())._class=$.ClassValue.Page,n.hasClickThrough=!0,n.horizontalRulerData={_class:"rulerData",base:0,guides:[]},n.verticalRulerData={_class:"rulerData",base:0,guides:[]},[4,Promise.all(this.children.filter((function(e){return!r||r(e)})).map((function(e){return e.toSketchJson(t,r)})))];case 2:return i=o.sent(),n.layers=i.map((function(e){return e})),[2,n]}}))}))},t}(Vx);function E_(e,t,r){if(void 0===r&&(r=x_.APPEND),e.length)if(e.indexOf(t)>-1)hl.error("Can not moveTo self");else{var n=t.parent,i=t.artBoard;n instanceof l_&&(n.fixedPosAndSize=!0);for(var o=0,a=e.length;o<a;o++){var s=e[o];if(r===x_.BEFORE){n&&A_(n,s),t.insertBefore(s);var l=t.prev;s.props.index=.5*(((null==l?void 0:l.props.index)||0)+t.props.index)}else if(r===x_.AFTER){n&&A_(n,s),t.insertAfter(s);var u=t.next;s.props.index=.5*(((null==u?void 0:u.props.index)||1)+t.props.index)}else if(t instanceof Vx)if(A_(t,s),r===x_.PREPEND){t.prependChild(s);u=s.next;s.props.index=.5*((null==u?void 0:u.props.index)||1)}else{t.appendChild(s);l=s.prev;s.props.index=.5*(((null==l?void 0:l.props.index)||0)+1)}s.artBoard=i}n instanceof l_&&(n.fixedPosAndSize=!1,n.checkPosSizeSelf())}}function S_(e,t){E_(e,t,x_.APPEND)}function C_(e,t){E_(e,t,x_.AFTER)}function k_(e){var t=e.computedStyle,r=t.scaleX,n=t.scaleY,i=t.rotateZ,o=t.transformOrigin;if(r>=0||n>=0)return e.matrix;var a=ru(),s=e.transform;return a[12]=s[12],a[13]=s[13],i&&cu(a,Zu(i)),lc(a,o[0],o[1])}function T_(e,t){if(void 0===t&&(t=!1),!e.page)throw new Error("Node not on a Page");if(e.isPage&&e instanceof __)return ru();for(var r=e.page,n=e.parent,i=[];n&&n!==r;)i.push(n),n=n.parent;for(var o=ru();i.length;){var a=i.pop();o=iu(o,t?k_(a):a.matrix)}return o=iu(o,t?k_(e):e.matrix)}function A_(e,t){if(t.parent!==e){var r=e.width,n=e.height,i=T_(e),o=e.computedStyle,a=o.scaleX,s=o.scaleY,l=0;if(-1===a){var u=ru();hu(u,a);var c=e.computedStyle.transformOrigin,h=iu(i,lc(u,c[0],c[1]));l=Math.acos(h[0])}else l=Math.acos(i[0]);var d=pu({x:0,y:0},i),f=pu({x:e.width,y:0},i),p=pu({x:0,y:e.height},i),v={x:f.x-d.x,y:f.y-d.y},g={x:p.x-d.x,y:p.y-d.y},m=ru(),y=function(e){if(!e.page)throw new Error("Node not on a Page");if(e.isPage&&e instanceof __)return{x:1,y:1};for(var t=e.computedStyle.scaleX,r=e.computedStyle.scaleY,n=e.page,i=e.parent;i&&i!==n;)t*=i.computedStyle.scaleX,r*=i.computedStyle.scaleY,i=i.parent;return{x:t,y:r}}(t);1!==y.x&&hu(m,y.x),1!==y.y&&hu(m,y.y);var b=T_(t,!0),x=Math.acos(b[0])-l;cu(m,-x),-1===a&&hu(m,a),-1===s&&du(m,s);var w=t.computedStyle.transformOrigin,_=iu(b,lc(m,w[0],w[1])),E=pu({x:-t.computedStyle.translateX,y:-t.computedStyle.translateY},_),S={x:E.x-d.x,y:E.y-d.y},C=Wl(S.x,S.y,v.x,v.y),k=Wl(S.x,S.y,g.x,g.y),T=ql(C.x,C.y),A=ql(k.x,k.y),M=Vl(S.x,S.y,v.x,v.y),O=Vl(S.x,S.y,g.x,g.y),L=.5*Math.PI;M<=L&&O<=L||(M<=L?A=-A:O<=L?T=-T:(T=-T,A=-A));var R=t.style,I=R.left.u===Us.PX,F=R.right.u===Us.PX,P=R.top.u===Us.PX,D=R.bottom.u===Us.PX,N=R.width.u===Us.PX,B=R.height.u===Us.PX;I?(R.left.v=T,F?R.right.v=r-T-t.width:N||(R.right.v=100*(r-T-t.width)/r)):F?(R.right.v=r-T-t.width,N||(R.left.v=100*(r-R.right.v-t.width)/r)):N||R.left.u===Us.PERCENT&&R.right.u===Us.AUTO?R.left.v=100*T/r:(R.left.v=100*T/r,R.right.v=100*(r-T-t.width)/r),P?(R.top.v=A,D?R.bottom.v=n-A-t.height:B||(R.bottom.v=100*(n-A-t.height)/n)):D?(R.bottom.v=n-A-t.height,B||(R.top.v=100*(n-R.bottom.v-t.height)/n)):B||R.top.u===Us.PERCENT&&R.bottom.u===Us.AUTO?R.top.v=100*A/n:(R.top.v=100*A/n,R.bottom.v=100*(n-A-t.height)/n),R.rotateZ.v=Ju(x),R.scaleX.v=y.x*(-1===a?-1:1),R.scaleY.v=y.y*(-1===s?-1:1)}}function M_(e){if(e.length&&e[0].root){for(var t=e[0].root.structs,r=0,n=e.length;r<n;r++){var i=e[r];if(i.isDestroyed)throw new Error("Can not group a destroyed Node");i.tempIndex=t.indexOf(i.struct)}e.sort((function(e,t){return e.tempIndex-t.tempIndex}))}}function O_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r>t.height){r-=t.height,r=Math.max(r,1),i.top.u===Us.PX?o.top=t.top+t.height:i.left.u===Us.PERCENT&&(o.top=100*(t.top+t.height)/e.parent.height+"%");var a=Object.assign({},t);a.height=0,Object.assign(o,L_(e,a,r)),o.scaleY=-1*t.scaleY}else r=Math.min(r,t.height-1),o.scaleY=t.scaleY,i.top.u===Us.PX||i.top.u===Us.PERCENT?(i.top.u===Us.PX?o.top=t.top+r:o.top=100*(t.top+r)/e.parent.height+"%",i.height.u===Us.PX||i.height.u===Us.AUTO&&i.bottom.u===Us.AUTO?o.height=t.height-r:i.height.u===Us.PERCENT&&(o.height=100*(t.height-r)/e.parent.height+"%")):i.height.u!==Us.PX&&i.height.u!==Us.PERCENT&&i.height.u!==Us.AUTO||(i.height.u===Us.PX||i.height.u===Us.AUTO?o.height=t.height-r:o.height=100*(t.height-r)/e.parent.height+"%");if(n){var s=L_(e,t,-r);s.height&&("number"==typeof s.height?s.height=t.height-2*r:s.height=100*(t.height-2*r)/e.parent.height+"%"),Object.assign(o,s)}return o}function L_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r<-t.height){r+=t.height,r=Math.min(r,-1),i.bottom.u===Us.PX?o.bottom=t.bottom+t.height:i.bottom.u===Us.PERCENT&&(o.bottom=100*(t.bottom+t.height)/e.parent.height+"%");var a=Object.assign({},t);a.height=0,Object.assign(o,O_(e,a,r)),o.scaleY=-1*t.scaleY}else r=Math.max(r,1-t.height),o.scaleY=t.scaleY,i.bottom.u===Us.PX||i.bottom.u===Us.PERCENT?(i.bottom.u===Us.PX?o.bottom=t.bottom-r:o.bottom=100*(t.bottom-r)/e.parent.height+"%",i.height.u===Us.PX||i.height.u===Us.AUTO&&i.top.u===Us.AUTO?o.height=t.height+r:i.height.u===Us.PERCENT&&(o.height=100*(t.height+r)/e.parent.height+"%")):i.height.u!==Us.PX&&i.height.u!==Us.PERCENT&&i.height.u!==Us.AUTO||(i.height.u===Us.PX||i.height.u===Us.AUTO?o.height=t.height+r:o.height=100*(t.height+r)/e.parent.height+"%");if(n){var s=O_(e,t,-r);s.height&&("number"==typeof s.height?s.height=t.height+2*r:s.height=100*(t.height+2*r)/e.parent.height+"%"),Object.assign(o,s)}return o}function R_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r>t.width){r-=t.width,r=Math.max(r,1),i.left.u===Us.PX?o.left=t.left+t.width:i.left.u===Us.PERCENT&&(o.left=100*(t.left+t.width)/e.parent.width+"%");var a=Object.assign({},t);a.width=0,Object.assign(o,I_(e,a,r)),o.scaleX=-1*t.scaleX}else r=Math.min(r,t.width-1),o.scaleX=t.scaleX,i.left.u===Us.PX||i.left.u===Us.PERCENT?(i.left.u===Us.PX?o.left=t.left+r:o.left=100*(t.left+r)/e.parent.width+"%",i.width.u===Us.PX||i.width.u===Us.AUTO&&i.right.u===Us.AUTO?o.width=t.width-r:i.width.u===Us.PERCENT&&(o.width=100*(t.width-r)/e.parent.width+"%")):i.width.u!==Us.PX&&i.width.u!==Us.PERCENT&&i.width.u!==Us.AUTO||(i.width.u===Us.PX||i.width.u===Us.AUTO?o.width=t.width-r:o.width=100*(t.width-r)/e.parent.width+"%");if(n){var s=I_(e,t,-r);s.width&&("number"==typeof s.width?s.width=t.width-2*r:s.width=100*(t.width-2*r)/e.parent.width+"%"),Object.assign(o,s)}return o}function I_(e,t,r,n){void 0===n&&(n=!1);var i=e.style,o={};if(r<-t.width){r+=t.width,r=Math.min(r,-1),i.right.u===Us.PX?o.right=t.right+t.width:i.right.u===Us.PERCENT&&(o.right=100*(t.right+t.width)/e.parent.width+"%");var a=Object.assign({},t);a.width=0,Object.assign(o,R_(e,a,r)),o.scaleX=-1*t.scaleX}else r=Math.max(r,1-t.width),o.scaleX=t.scaleX,i.right.u===Us.PX||i.right.u===Us.PERCENT?(i.right.u===Us.PX?o.right=t.right-r:o.right=100*(t.right-r)/e.parent.width+"%",i.width.u===Us.PX||i.width.u===Us.AUTO&&i.left.u===Us.AUTO?o.width=t.width+r:i.width.u===Us.PERCENT&&(o.width=100*(t.width+r)/e.parent.width+"%")):i.width.u!==Us.PX&&i.width.u!==Us.PERCENT&&i.width.u!==Us.AUTO||(i.width.u===Us.PX||i.width.u===Us.AUTO?o.width=t.width+r:o.width=100*(t.width+r)/e.parent.width+"%");if(n){var s=R_(e,t,-r);s.width&&("number"==typeof s.width?s.width=t.width+2*r:s.width=100*(t.width+2*r)/e.parent.width+"%"),Object.assign(o,s)}return o}function F_(e,t,r){var n=r*(t.width/t.height),i=R_(e,t,.5*-n),o=I_(e,t,.5*n),a=Object.assign({},i,o);if(a.width)if("number"==typeof a.width){var s=a.width-t.width;a.width=t.width+2*s}else{var l=e.parent.width;s=parseFloat(a.width)*l*.01-t.width;a.width=100*(t.width+2*s)/l+"%"}return a}function P_(e,t,r,n){void 0===n&&(n=!1);var i=O_(e,t,r);if(n){var o=L_(e,t,-r);o.height&&("number"==typeof o.height?o.height=t.height-2*r:o.height=100*(t.height-2*r)/e.parent.height+"%"),Object.assign(i,o)}var a=F_(e,t,n?2*-r:-r);return Object.assign(i,a)}function D_(e,t,r,n){void 0===n&&(n=!1);var i=L_(e,t,r);if(n){var o=O_(e,t,-r);o.height&&("number"==typeof o.height?o.height=t.height+2*r:o.height=100*(t.height+2*r)/e.parent.height+"%"),Object.assign(i,o)}var a=F_(e,t,n?2*r:r);return Object.assign(i,a)}function N_(e,t,r){var n=r/(t.width/t.height),i=O_(e,t,.5*-n),o=L_(e,t,.5*n),a=Object.assign({},i,o);if(a.height)if("number"==typeof a.height){var s=a.height-t.height;a.height=t.height+2*s}else{var l=e.parent.height;s=parseFloat(a.height)*l*.01-t.height;a.height=100*(t.height+2*s)/l+"%"}return a}function B_(e,t,r,n){void 0===n&&(n=!1);var i=R_(e,t,r);if(n){var o=I_(e,t,-r);o.width&&("number"==typeof o.width?o.width=t.width-2*r:o.width=100*(t.width-2*r)/e.parent.width+"%"),Object.assign(i,o)}var a=N_(e,t,n?2*-r:-r);return Object.assign(i,a)}function U_(e,t,r,n){void 0===n&&(n=!1);var i=I_(e,t,r);if(n){var o=R_(e,t,-r);o.width&&("number"==typeof o.width?o.width=t.width+2*r:o.width=100*(t.width+2*r)/e.parent.width+"%"),Object.assign(i,o)}var a=N_(e,t,n?2*r:r);return Object.assign(i,a)}function z_(e,t,r,n){void 0===n&&(n=!0);var i=e.width,o=e.height,a=o/i;n||(a*=-1);var s=-1/a,l=i+t,u=o+r,c=(u-o+a*i-s*l)/(a-s);return{x:c,y:s*c-s*l+u}}function X_(e,t,r,n,i){void 0===i&&(i=!1);var o=z_(t,r,n,!0),a=o.x,s=o.y,l=R_(e,t,a-t.width,i);return Object.assign(l,O_(e,t,s-t.height,i)),l}function H_(e,t,r,n,i){void 0===i&&(i=!1);var o=z_(t,r,n,!1),a=o.x,s=o.y,l=I_(e,t,a-t.width,i);return Object.assign(l,O_(e,t,s-t.height,i)),l}function G_(e,t,r,n,i){void 0===i&&(i=!1);var o=z_(t,r,n,!1),a=o.x,s=o.y,l=R_(e,t,a-t.width,i);return Object.assign(l,L_(e,t,s-t.height,i)),l}function j_(e,t,r,n,i){void 0===i&&(i=!1);var o=z_(t,r,n,!0),a=o.x,s=o.y,l=I_(e,t,a-t.width,i);return Object.assign(l,L_(e,t,s-t.height,i)),l}function Y_(e,t,r,n){n&&(e.left?"number"==typeof e.left?e.left+=n:e.left=parseFloat(e.left)+n/t.parent.width*100+"%":e.width||(t.style.left.u===Us.PERCENT?e.left=100*(r.left+n)/t.parent.width+"%":t.style.left.u===Us.PX&&(e.left=r.left+n)),e.right?"number"==typeof e.right?e.right-=n:e.right=parseFloat(e.right)-n/t.parent.width*100+"%":e.width||(t.style.right.u===Us.PERCENT?e.right=100*(r.right-n)/t.parent.width+"%":t.style.right.u===Us.PX&&(e.right=r.right-n)))}function W_(e,t,r,n){n&&(e.top?"number"==typeof e.top?e.top+=n:e.top=parseFloat(e.top)+n/t.parent.height*100+"%":e.height||(t.style.top.u===Us.PERCENT?e.top=100*(r.top+n)/t.parent.height+"%":t.style.top.u===Us.PX&&(e.top=r.top+n)),e.bottom?"number"==typeof e.bottom?e.bottom-=n:e.bottom=parseFloat(e.bottom)-n/t.parent.height*100+"%":e.height||(t.style.bottom.u===Us.PERCENT?e.bottom=100*(r.bottom-n)/t.parent.height+"%":t.style.bottom.u===Us.PX&&(e.bottom=r.bottom-n)))}function V_(e,t,r){var n=e*r.h/r.w,i=r.y+.5*r.h;return(t.y+.5*t.h-i)*n/r.h}function q_(e,t,r){var n=e*r.w/r.h,i=r.x+.5*r.w;return(t.x+.5*t.w-i)*n/r.w}function K_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?P_(e,t,r*n.h/i.h,a):O_(e,t,r*n.h/i.h,a),l=q_(r,n,i);a&&(l*=2),Y_(s,e,t,-l);return W_(s,e,t,a?-r*(n.y+.5*n.h-i.y-.5*i.h)*2/i.h:r*(i.y+i.h-n.y-n.h)/i.h),s}function Z_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?D_(e,t,r*n.h/i.h,a):L_(e,t,r*n.h/i.h,a);if(o){var l=q_(r,n,i);a&&(l*=2),Y_(s,e,t,l)}var u=0;return u=a?r*(n.y+.5*n.h-i.y-.5*i.h)*2/i.h:r*(n.y-i.y)/i.h,n.y,i.y,i.h,W_(s,e,t,u),s}function J_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?B_(e,t,r*n.w/i.w,a):R_(e,t,r*n.w/i.w,a);if(o){var l=V_(r,n,i);a&&(l*=2),W_(s,e,t,-l)}return Y_(s,e,t,a?-r*(n.x+.5*n.w-i.x-.5*i.w)*2/i.w:r*(i.x+i.w-n.x-n.w)/i.w),s}function Q_(e,t,r,n,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var s=o?U_(e,t,r*n.w/i.w,a):I_(e,t,r*n.w/i.w,a);if(o){var l=V_(r,n,i);a&&(l*=2),W_(s,e,t,l)}return Y_(s,e,t,a?r*(n.x+.5*n.w-i.x-.5*i.w)*2/i.w:r*(n.x-i.x)/i.w),s}function $_(e,t,r,n,i,o){var a=K_(e,t,r,n,i);delete o.top,delete o.height,delete o.bottom,void 0!==a.top&&(o.top=a.top),void 0!==a.height&&(o.height=a.height),void 0!==a.bottom&&(o.bottom=a.bottom)}function eE(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=J_(e,t,r,i,o,a,s);if(s)return l;if(a)$_(e,t,n,i,o,l);else{var u=K_(e,t,n,i,o,a,s);Object.assign(l,u)}return l}function tE(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=Q_(e,t,r,i,o,a,s);if(s)return l;if(a)$_(e,t,n,i,o,l);else{var u=K_(e,t,n,i,o,a,s);Object.assign(l,u)}return l}function rE(e,t,r,n,i,o){var a=Z_(e,t,r,n,i);delete o.top,delete o.height,delete o.bottom,void 0!==a.top&&(o.top=a.top),void 0!==a.height&&(o.height=a.height),void 0!==a.bottom&&(o.bottom=a.bottom)}function nE(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=J_(e,t,r,i,o,a,s);if(s)return l;if(a)rE(e,t,n,i,o,l);else{var u=Z_(e,t,n,i,o,a,s);Object.assign(l,u)}return l}function iE(e,t,r,n,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var l=Q_(e,t,r,i,o,a,s);if(s)return l;if(a)rE(e,t,n,i,o,l);else{var u=Z_(e,t,n,i,o,a,s);Object.assign(l,u)}return l}function oE(e){var t,r,n,i,o=[e],a=e.artBoard||e.page;if(e!==a)for(var s=e.parent;s&&s!==a;)o.unshift(s),s=s.parent;for(var l=ru(),u=0,c=o.length;u<c;u++)l=iu(l,o[u].matrix);var h=e._rect||e.rect,d=gu(h[0],h[1],h[2],h[3],l),f=d.x1,p=d.y1,v=d.x2,g=d.y2,m=d.x3,y=d.y3,b=d.x4,x=d.y4,w=e.computedStyle,_=0,E=0;e.artBoard||(_=(null===(r=(null===(t=e.page)||void 0===t?void 0:t.props).rule)||void 0===r?void 0:r.baseX)||0,E=(null===(i=(null===(n=e.page)||void 0===n?void 0:n.props).rule)||void 0===i?void 0:i.baseY)||0);var S={baseX:_,baseY:E,x:Math.min(f,v,m,b)-_,y:Math.min(p,g,y,x)-E,w:h[2]-h[0],h:h[3]-h[1],isFlippedHorizontal:-1===w.scaleX,isFlippedVertical:-1===w.scaleY,rotation:w.rotateZ,opacity:w.opacity,mixBlendMode:w.mixBlendMode,constrainProportions:!!e.props.constrainProportions,matrix:l,isLine:!1,length:0,angle:0,points:[]};if(e instanceof iw){S.isLine=e.isLine();var C=e.points;if(S.isLine){S.length=Math.sqrt(Math.pow(C[1].absX-C[0].absX,2)+Math.pow(C[1].absY-C[0].absY,2));var k=C[1].absX-C[0].absX;if(0===k)C[1].absY>=C[0].absY?S.angle=90:S.angle=-90;else{var T=(C[1].absY-C[0].absY)/k;S.angle=Ju(Math.atan(T))}}C.forEach((function(e){var t=pu({x:e.absX-S.baseX,y:e.absY-S.baseY},l);if(e.dspX=t.x,e.dspY=t.y,e.hasCurveFrom){var r=pu({x:e.absFx-S.baseX,y:e.absFy-S.baseY},l);e.dspFx=r.x,e.dspFy=r.y}if(e.hasCurveTo){var n=pu({x:e.absTx-S.baseX,y:e.absTy-S.baseY},l);e.dspTx=n.x,e.dspTy=n.y}})),S.points=C}return S}!function(e){e[e.APPEND=0]="APPEND",e[e.PREPEND=1]="PREPEND",e[e.BEFORE=2]="BEFORE",e[e.AFTER=3]="AFTER"}(x_||(x_={}));var aE={moveAppend:S_,movePrepend:function(e,t){E_(e,t,x_.PREPEND)},moveAfter:C_,moveBefore:function(e,t){E_(e,t,x_.BEFORE)},move:function(e,t,r){var n=e.getStyle();(t||r)&&(e.updateStyle({translateX:e.computedStyle.translateX+t,translateY:e.computedStyle.translateY+r}),e.endPosChange(n,t,r),e.checkPosSizeUpward())},migrate:A_,sortTempIndex:M_,getWholeBoundingClientRect:function(e,t){if(e.length){for(var r=e[0].getBoundingClientRect(t),n=1,i=e.length;n<i;n++){var o=e[n].getBoundingClientRect(t);r.left=Math.min(r.left,o.left),r.right=Math.max(r.right,o.right),r.top=Math.min(r.top,o.top),r.bottom=Math.max(r.bottom,o.bottom)}return r}},resizeTopOperate:O_,resizeBottomOperate:L_,resizeLeftOperate:R_,resizeRightOperate:I_,resizeTop:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=O_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeBottom:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=L_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeLeft:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=R_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeRight:function(e,t){if(t){var r=e.getStyle();e.startSizeChange();var n=I_(e,e.computedStyle,t);e.updateStyle(n),e.endSizeChange(r),e.checkPosSizeUpward()}},resizeTopAspectRatioOperate:P_,resizeBottomAspectRatioOperate:D_,resizeLeftAspectRatioOperate:B_,resizeRightAspectRatioOperate:U_,resizeTopLeftAspectRatioOperate:X_,resizeTopRightAspectRatioOperate:H_,resizeBottomLeftAspectRatioOperate:G_,resizeBottomRightAspectRatioOperate:j_,resizeTopMultiArOperate:K_,resizeBottomMultiArOperate:Z_,resizeRightMultiArOperate:Q_,resizeLeftMultiArOperate:J_,resizeTopLeftMultiArOperate:eE,resizeTopRightMultiArOperate:tE,resizeBottomLeftMultiArOperate:nE,resizeBottomRightMultiArOperate:iE,getBasicInfo:oE};function sE(e){return e.map((function(e){return e.map((function(e){return Math.round(100*e)}))}))}function lE(e,t){if(t&&!nu(t)){var r=t[0],n=t[1],i=t[4],o=t[5],a=t[12],s=t[13];return e.map((function(e){var t=(1===r?e[0]:e[0]*r)+(i?e[1]*i:0)+a,l=(1===n?e[0]:e[0]*n)+(o?e[1]*o:0)+s;if(4===e.length||6===e.length){var u=(1===r?e[2]:e[2]*r)+(i?e[3]*i:0)+a,c=(1===n?e[2]:e[2]*n)+(o?e[3]*o:0)+s;return 6===e.length?[t,l,u,c,(1===r?e[4]:e[4]*r)+(i?e[5]*i:0)+a,(1===n?e[4]:e[4]*n)+(o?e[5]*o:0)+s]:[t,l,u,c]}return[t,l]}))}return e.map((function(e){return e.slice(0)}))}var uE=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.props=t,n.loaders=[],n.isShapeGroup=!0,n}return v(t,e),t.prototype.didMount=function(){var e;if(this.buildPoints(),null===(e=this.coords)||void 0===e?void 0:e.length){var t=this._rect||this.rect,r=this.width,n=this.height,i=l_.EPS;(Math.abs(-t[0])>i||Math.abs(-t[1])>i||Math.abs(r-t[2])>i||Math.abs(n-t[3])>i)&&this.adjustPosAndSize({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}},t.prototype.lay=function(t){e.prototype.lay.call(this,t),this.coords=void 0},t.prototype.clearPoints=function(){this.coords=void 0,this._rect=void 0,this._bbox=void 0,this.clearCache(!0)},t.prototype.checkShapeChange=function(){for(var e=this.parent;e&&e.isShapeGroup;)e.clearPoints(),e=e.parent},t.prototype.calContent=function(){return this.buildPoints(),this.hasContent=!!this.coords&&this.coords.length>0},t.prototype.buildPoints=function(){var e=this;if(!this.coords){this.coords=[],this.textureOutline.forEach((function(e){return null==e?void 0:e.release()}));for(var r=this.children,n=[],i=!0,o=function(e,o){var a=r[e];if(a.computedStyle.visibility===tl.HIDDEN)return"continue";var s=void 0;if(a instanceof pw||a instanceof t)a.buildPoints(),s=a.coords;else{var l=a.width,u=a.height;s=[[0,0],[l,0],[l,u],[0,u],[0,0]]}var c=a.matrix;if(s&&s.length){var h=void 0;h=a instanceof t?s.map((function(e){return sE(lE(e,c))})):[sE(lE(s,c))];var d=a.computedStyle.booleanOperation;if(i||!d)n=n.concat(h),i=!1;else if(d===Ws.INTERSECT){var f=a_.intersect(n,h);n=f||[]}else if(d===Ws.UNION){var p=[],v=[];if(h.forEach((function(e){e.length<=2?v.push(e):p.push(e)})),p.length){f=a_.union(n,p);n=f||[]}v.length&&(n=n.concat(v))}else if(d===Ws.SUBTRACT){f=a_.subtract(n,h);n=f||[]}else if(d===Ws.XOR){f=a_.xor(n,h);n=f||[]}}},a=0,s=r.length;a<s;a++)o(a);n.forEach((function(t){if(t.length>1){var r=t.map((function(e){return e.map((function(e){return.01*e}))}));e.coords.push(r)}}))}},t.prototype.renderCanvas=function(t){var r,n=this;e.prototype.renderCanvas.call(this,t),this.buildPoints();var i=this.coords;if(i&&i.length){var o=this._bbox2||this.bbox2,a=o[0],s=o[1],l=o[2]-a,u=o[3]-s,c=-a*t,h=-s*t;l*=t,u*=t;var d=this.canvasCache=Zx.getInstance(l,u,c,h);d.available=!0;for(var f=this.computedStyle,p=f.fill,v=f.fillOpacity,g=f.fillRule,m=f.fillEnable,y=f.fillMode,b=f.stroke,x=f.strokeEnable,w=f.strokeWidth,_=f.strokePosition,E=f.strokeMode,S=f.strokeDasharray,C=f.strokeLinecap,k=f.strokeLinejoin,T=f.strokeMiterlimit,A=d.list,M=function(e,o){var a=A[e],s=a.x,d=a.y,f=a.os.ctx,M=-s,L=-d;1!==t?f.setLineDash(S.map((function(e){return e*t}))):f.setLineDash(S),f.beginPath(),i.forEach((function(e){ox(f,e,t,M,L)})),f.closePath();for(var R=function(e,o){if(!m[e]||!v[e])return"continue";var a=p[e],s=void 0,d=y[e];if(f.globalAlpha=v[e],Array.isArray(a)){if(!a[3])return"continue";f.fillStyle=Tc(a)}else{if(void 0!==a.url){var b=a.url;if(b){var x=O.loaders[e],w=hl.IMG[b];if(!x&&w&&(x=O.loaders[e]={error:!1,loading:!1,width:w.width,height:w.height,source:w.source}),x)if(x.error||x.loading||!x.source)x.error||x.loading||O.root.imgLoadingCount++;else{var _=O.width,E=O.height,S=_*t,C=E*t,k=hl.getOffscreenCanvas(l,u),T=k.ctx;if(T.beginPath(),i.forEach((function(e){ox(f,e,t,M,L)})),T.closePath(),T.save(),T.clip(),a.type===el.TILE)for(var A=null!==(r=a.scale)&&void 0!==r?r:1,R=0,I=Math.ceil(_/A/x.width);R<I;R++)for(var F=0,P=Math.ceil(E/A/x.height);F<P;F++)T.drawImage(x.source,M+R*x.width*t*A,L+F*x.height*t*A,x.width*t*A,x.height*t*A);else if(a.type===el.FILL){var D=S/x.width,N=C/x.height,B=Math.max(D,N),U=-.5*(x.width*B-S),z=-.5*(x.height*B-C);T.drawImage(x.source,0,0,x.width,x.height,U+M,z+L,x.width*B,x.height*B)}else if(a.type===el.STRETCH)T.drawImage(x.source,M,L,S,C);else if(a.type===el.FIT){D=S/x.width,N=C/x.height,B=Math.min(D,N);var X=-.5*(x.width*B-S),H=-.5*(x.height*B-C);T.drawImage(x.source,0,0,x.width,x.height,X+M,H+L,x.width*B,x.height*B)}d!==Hs.NORMAL&&(f.globalCompositeOperation=Jx(d)),f.drawImage(k.canvas,0,0),d!==Hs.NORMAL&&(f.globalCompositeOperation="source-over"),k.release()}else O.root.imgLoadingCount++,x=O.loaders[e]=O.loaders[e]||{error:!1,loading:!0,width:0,height:0,source:void 0},hl.loadImg(b,(function(t){b===p[e].url&&(x.loading=!1,t.success?(x.error=!1,x.source=t.source,x.width=t.width,x.height=t.height,n.isDestroyed||n.root.addUpdate(n,[],Qb.REPAINT,!1,!1,void 0)):x.error=!0,n.root.imgLoadingCount--)}))}return"continue"}if(a.t===js.LINEAR){var G=mc(a.stops,a.d,M,L,l-2*c,u-2*h),j=f.createLinearGradient(G.x1,G.y1,G.x2,G.y2);G.stop.forEach((function(e){j.addColorStop(e.offset,Tc(e.color))})),f.fillStyle=j}else if(a.t===js.RADIAL){G=yc(a.stops,a.d,M,L,l-2*c,u-2*h);var Y=f.createRadialGradient(G.cx,G.cy,0,G.cx,G.cy,G.total);G.stop.forEach((function(e){Y.addColorStop(e.offset,Tc(e.color))}));var W=G.matrix;if(W){var V=(s=hl.getOffscreenCanvas(l,u)).ctx;V.beginPath(),i.forEach((function(e){ox(V,e,t,M,L)})),V.closePath(),V.clip(),V.fillStyle=Y,V.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]),V.fill(g===Ks.EVEN_ODD?"evenodd":"nonzero")}else f.fillStyle=Y}else if(a.t===js.CONIC){G=bc(a.stops,a.d,M,L,l-2*c,u-2*h);var q=f.createConicGradient(G.angle,G.cx+M,G.cy+L);G.stop.forEach((function(e){q.addColorStop(e.offset,Tc(e.color))})),f.fillStyle=q}}d!==Hs.NORMAL&&(f.globalCompositeOperation=Jx(d)),s?(f.drawImage(s.canvas,0,0),s.release()):f.fill(g===Ks.EVEN_ODD?"evenodd":"nonzero"),d!==Hs.NORMAL&&(f.globalCompositeOperation="source-over")},I=0,F=p.length;I<F;I++)R(I);f.globalAlpha=1,f.globalCompositeOperation="source-over";var P=O.computedStyle,D=P.innerShadow,N=P.innerShadowEnable;if(D&&D.length){var B=0,U=!1;D.forEach((function(e,r){if(N[r]){U=!0;var n=(Math.max(Math.abs(e.x),Math.abs(e.x))+e.spread)*t;B=Math.max(B,n+e.blur*t)}})),U&&(f.save(),f.beginPath(),i.forEach((function(e){ox(f,e,t,M,L)})),f.closePath(),f.clip(),f.fillStyle="#FFF",f.beginPath(),i.forEach((function(e){ox(f,e,t,M,L)})),ox(f,[[-B,-B],[l+B,-B],[l+B,u+B],[-B,u+B],[-B,-B]],1,0,0),f.closePath(),D.forEach((function(e,r){N[r]&&(f.shadowOffsetX=e.x*t,f.shadowOffsetY=e.y*t,f.shadowColor=Tc(e.color),f.shadowBlur=e.blur*t,f.fill("evenodd"))})),f.restore(),f.beginPath(),i.forEach((function(e){ox(f,e,t,M,L)})),f.closePath())}C===Js.ROUND?f.lineCap="round":C===Js.SQUARE?f.lineCap="square":f.lineCap="butt",k===Qs.ROUND?f.lineJoin="round":k===Qs.BEVEL?f.lineJoin="bevel":f.lineJoin="miter",f.miterLimit=T;for(var z=function(e,r){if(!x[e]||!w[e])return"continue";var n=b[e],o=_[e];if(f.globalCompositeOperation=Jx(E[e]),Array.isArray(n))f.strokeStyle=Tc(n),f.lineWidth=w[e];else if(n.t===js.LINEAR){var a=mc(n.stops,n.d,M,L,l-2*c,u-2*h),s=f.createLinearGradient(a.x1,a.y1,a.x2,a.y2);a.stop.forEach((function(e){s.addColorStop(e.offset,Tc(e.color))})),f.strokeStyle=s}else if(n.t===js.RADIAL){a=yc(n.stops,n.d,M,L,l-2*c,u-2*h);var d=f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.total);a.stop.forEach((function(e){d.addColorStop(e.offset,Tc(e.color))}));var p=a.matrix;if(p){var v=hl.getOffscreenCanvas(l,u),g=v.ctx;return g.setLineDash(S),g.lineCap=f.lineCap,g.lineJoin=f.lineJoin,g.miterLimit=f.miterLimit,g.lineWidth=w[e]*t,g.strokeStyle="#F00",g.beginPath(),i.forEach((function(e){ox(g,e,t,M,L)})),g.closePath(),o===$s.INSIDE?(g.lineWidth=2*w[e]*t,g.save(),g.clip(),g.stroke(),g.restore()):o===$s.OUTSIDE?(g.lineWidth=2*w[e]*t,g.stroke(),g.save(),g.clip(),g.globalCompositeOperation="destination-out",g.strokeStyle="#FFF",g.stroke(),g.restore()):g.stroke(),g.fillStyle=d,g.globalCompositeOperation="source-in",g.setTransform(p[0],p[1],p[4],p[5],p[12],p[13]),g.fillRect(0,0,l,u),f.drawImage(v.canvas,0,0),v.release(),"continue"}f.strokeStyle=d}else if(n.t===js.CONIC){a=bc(n.stops,n.d,M,L,l-2*c,u-2*h);var m=f.createConicGradient(a.angle,a.cx+M,a.cy+L);a.stop.forEach((function(e){m.addColorStop(e.offset,Tc(e.color))})),f.strokeStyle=m}var y,C=void 0;o===$s.INSIDE?f.lineWidth=2*w[e]*t:o===$s.OUTSIDE?(C=hl.getOffscreenCanvas(l,u),(y=C.ctx).setLineDash(S),y.lineCap=f.lineCap,y.lineJoin=f.lineJoin,y.miterLimit=f.miterLimit,y.strokeStyle=f.strokeStyle,y.lineWidth=2*w[e]*t,y.beginPath(),i.forEach((function(e){ox(y,e,t,M,L)}))):f.lineWidth=w[e]*t,y&&y.closePath(),o===$s.INSIDE?(f.save(),f.clip(),f.stroke(),f.restore()):o===$s.OUTSIDE?(y.stroke(),y.save(),y.clip(),y.globalCompositeOperation="destination-out",y.strokeStyle="#FFF",y.stroke(),y.restore(),f.drawImage(C.canvas,M-c,L-h),C.release()):f.stroke()},X=0,H=b.length;X<H;X++)z(X);f.globalCompositeOperation="source-over"},O=this,L=0,R=A.length;L<R;L++)M(L)}},t.prototype.toSvg=function(e){this.buildPoints();var t=this.computedStyle,r=this.coords||[],n=new Float64Array(this.matrixWorld),i=[],o=0,a=0,s=0,l=0,u=!0;r.forEach((function(e,t){var r=[];e.forEach((function(e,t){if(6===e.length){var i=pu({x:e[0],y:e[1]},n),c=pu({x:e[2],y:e[3]},n),h=pu({x:e[4],y:e[5]},n);r.push([i.x,i.y,c.x,c.y,h.x,h.y]),u?(u=!1,o=Math.min(i.x,c.x,h.x),a=Math.min(i.y,c.y,h.y),s=Math.max(i.x,c.x,h.x),l=Math.max(i.y,c.y,h.y)):(o=Math.min(o,i.x,c.x,h.x),a=Math.min(a,i.y,c.y,h.y),s=Math.max(s,i.x,c.x,h.x),l=Math.max(l,i.y,c.y,h.y))}else if(4===e.length){i=pu({x:e[0],y:e[1]},n),c=pu({x:e[2],y:e[3]},n);r.push([i.x,i.y,c.x,c.y]),u?(u=!1,o=Math.min(i.x,c.x),a=Math.min(i.y,c.y),s=Math.max(i.x,c.x),l=Math.max(i.y,c.y)):(o=Math.min(o,i.x,c.x),a=Math.min(a,i.y,c.y),s=Math.max(s,i.x,c.x),l=Math.max(l,i.y,c.y))}else if(2===e.length){var d=pu({x:e[0],y:e[1]},n);r.push([d.x,d.y]),u?(u=!1,o=d.x,a=d.y,s=d.x,l=d.y):(o=Math.min(o,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),l=Math.max(l,d.y))}})),r.length&&i.push(r)}));var c=s-o,h=l-a,d=1;d=c>=h?e/c:e/h;var f=t.fillRule===Ks.EVEN_ODD?"evenodd":"nonzero",p='<svg width="'.concat(c*d,'" height="').concat(h*d,'"><path');if(i.length){var v=[["d",""],["fill","#D8D8D8"],["fill-rule",f],["stroke","#979797"],["stroke-width",1]];i.forEach((function(e){var t=ax(e.map((function(e){return e.map((function(e){return e*d}))})),-o*d,-a*d)+"Z";v[0][1]+=t})),v.forEach((function(e){p+=" "+e[0]+'="'+e[1]+'"'})),p+="></path>"}return p+"</svg>"},t.prototype.clone=function(e){var r=Rs(this.props),n=r.uuid;r.uuid=s(),r.sourceUuid=this.props.uuid;var i=new t(r,this.children.map((function(t){return t.clone(e)})));return i.style=Rs(this.style),e&&e.hasOwnProperty(n)&&e[n].forEach((function(e){var t=e.key,n=e.value;if("fill"===t[0]){var o=parseInt(t[1])||0;r.style.fill[o]=n,i.style.fill[o]={v:kc(n),u:Us.RGBA}}})),i},t.prototype.toJson=function(){var t=e.prototype.toJson.call(this);return t.tagName=l.SHAPE_GROUP,t},t.prototype.toSketchJson=function(t){return J(this,void 0,void 0,(function(){var r;return Q(this,(function(n){switch(n.label){case 0:return[4,e.prototype.toSketchJson.call(this,t)];case 1:return(r=n.sent())._class=$.ClassValue.ShapeGroup,[2,r]}}))}))},t.prototype.destroy=function(){if(!this.isDestroyed){var t=this.root;e.prototype.destroy.call(this),t&&this.loaders.forEach((function(e){e.loading&&(t.imgLoadingCount--,e.loading=!1)}))}},Object.defineProperty(t.prototype,"rect",{get:function(){var e=this._rect;if(!e){e=this._rect=new Float64Array(4),this.buildPoints();var t=this.coords;t&&t.length&&function(e,t){var r=!0;t=t||new Float64Array(4);for(var n=0,i=0,o=0,a=e.length;o<a;o++)for(var s=e[o],l=0,u=s.length;l<u;l++){var c=s[l];if(r){if(!(h=tw(c,t))){hl.error("Unsupported point data: "+o+":"+l+" - "+c.join(","));continue}n=h.x,i=h.y,r=!1}else{var h;if(!(h=rw(c,n,i,t))){hl.error("Unsupported point data: "+o+":"+l+" - "+c.join(","));continue}n=h.x,i=h.y}}}(t,e)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bbox",{get:function(){var e=this._bbox;if(!e){var t=this._rect||this.rect;e=this._bbox=t.slice(0),this.buildPoints();var r=this.computedStyle,n=r.strokeWidth,i=r.strokeEnable,o=r.strokePosition,a=r.strokeLinejoin,s=r.strokeMiterlimit,l=0;n.forEach((function(e,t){i[t]&&(o[t]===$s.INSIDE||(l=o[t]===$s.OUTSIDE?Math.max(l,4*e):Math.max(l,.5*e*4)))}));var u=e[0]-l,c=e[1]-l,h=e[2]+l,d=e[3]+l;(this.coords||[]).forEach((function(t){var r=$x(e,l,t,a,s);e[0]=Math.min(e[0],r[0]),e[1]=Math.min(e[1],r[1]),e[2]=Math.min(e[2],r[2]),e[3]=Math.min(e[3],r[3])})),e[0]=Math.min(e[0],u),e[1]=Math.min(e[1],c),e[2]=Math.max(e[2],h),e[3]=Math.max(e[3],d)}return e},enumerable:!1,configurable:!0}),t.groupAsShape=function(e,r,n){if(void 0===r&&(r=Ws.NONE),e.length){M_(e);var i,o=e[0],a=o.parent;a instanceof l_&&(a.fixedPosAndSize=!0);for(var l=0,u=e.length;l<u;l++){A_(a,c=e[l]),c.style.booleanOperation={v:r,u:Us.NUMBER}}for(l=0,u=e.length;l<u;l++){var c;if((c=e[l])instanceof pw||c instanceof t){i=c.getCssStyle();break}}i||(i=d());var h=new t(Object.assign({uuid:s(),name:"",style:{left:"0%",top:"0%",right:"0%",bottom:"0%",fill:i.fill,fillEnable:i.fillEnable,fillRule:i.fillRule,stroke:i.stroke,strokeEnable:i.strokeEnable,strokeWidth:i.strokeWidth,strokePosition:i.strokePosition,strokeDasharray:i.strokeDasharray,strokeLinecap:i.strokeLinecap,strokeLinejoin:i.strokeLinejoin,strokeMiterlimit:i.strokeMiterlimit}},n),[]);h.fixedPosAndSize=!0,o.insertAfter(h);for(l=0,u=e.length;l<u;l++)h.appendChild(e[l]);return h.fixedPosAndSize=!1,a instanceof l_&&(a.fixedPosAndSize=!1),h.checkPosSizeSelf(),h}},t}(l_);function cE(e,t,r){var n=e.parent;r?(e.checkPosSizeUpward(),e.clearCacheUpward(!1),e.destroy()):(e.layout({w:n.width,h:n.height}),t&&e.didMount(),e.checkPosSizeUpward(),e.clearCacheUpward(!1))}var hE={checkReflow:cE},dE={alpha:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,depth:!0,stencil:!0},fE="#define GLSLIFY 1\nattribute vec2 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=vec4(a_position,0,1);v_texCoords=a_texCoords;}",pE="#define GLSLIFY 1\nattribute vec2 a_position;varying vec4 v_position;void main(){gl_Position=vec4(a_position,0,1);v_position=gl_Position;}";function vE(e,t,r,n,i,o,a,s,l){for(var u,c,h,d,f,p,v,g,m=t.structs,y=t.width,b=t.height,x=[],w=[],_=0,E=m.length;_<E;_++){var S=m[_],C=S.node,k=S.lv,T=S.total,A=S.next,M=C.refreshLevel,O=C.computedStyle;C.refreshLevel=Qb.NONE;var L=C.textureTotal,R=C.textureFilter,I=C.textureMask;M&&(M<Qb.REPAINT||C.calContent());var F=O.maskMode,P=O.opacity,D=O.shadow,N=O.shadowEnable,B=O.innerShadow,U=O.innerShadowEnable,z=O.blur,X=O.mixBlendMode,H=O.fill,G=O.fillEnable,j=O.hueRotate,Y=O.saturate,W=O.brightness,V=O.contrast,q=!1;C.isGroup&&G[0]&&H[0]&&Array.isArray(H[0])&&(q=!0);for(var K=(P>0&&P<1||X!==Hs.NORMAL||q)&&T>0&&!C.isShapeGroup&&(!L[n]||!L[n].available),Z=!1,J=0,Q=D.length;J<Q;J++)if(N[J]&&D[J].color[3]>0){Z=!0;break}for(var $=0,ee=B.length;$<ee;$++)if(U[$]&&B[$].color[3]>0){Z=!0;break}Z&&(null===(u=R[n])||void 0===u?void 0:u.available)&&(Z=!1);var te=(z.t===Ys.GAUSSIAN&&z.radius>=1||z.t===Ys.BACKGROUND&&(z.radius>=1||1!==z.saturation)&&T||z.t===Ys.RADIAL&&z.radius>=1||z.t===Ys.MOTION&&z.radius>=1)&&(!R[n]||!(null===(c=R[n])||void 0===c?void 0:c.available)),re=F>0&&(!I[n]||!(null===(h=I[n])||void 0===h?void 0:h.available));if(re){F!==Zs.ALPHA||0!==O.opacity&&C.next&&!C.next.computedStyle.breakMask?F!==Zs.OUTLINE||0!==O.opacity&&C.next&&!C.next.computedStyle.breakMask||(re=!1,O.visibility===tl.HIDDEN||0===O.opacity?C.textureTarget[n]=void 0:C.resetTextureTarget()):(re=!1,C.textureTarget[n]=void 0);var ne=C.next;ne&&(ne.computedStyle.maskMode||ne.computedStyle.breakMask)&&(re=!1)}if(K||Z||te||re||(j||1!==Y||1!==W||1!==V)){var ie={i:_,lv:k,total:T,node:C,valid:!1,subList:[],isNew:!1,isTop:!0};x.push(ie),w[_]=ie}C instanceof uE&&(_+=T),(null===(d=L[n])||void 0===d?void 0:d.available)&&(_+=T,(null===(f=I[n])||void 0===f?void 0:f.available)&&(_+=A))}x.length&&x.sort((function(e,t){return e.lv===t.lv?t.i-e.i:t.lv-e.lv}));var oe=0;for(E=x.length;oe<E;oe++){_=(se=x[oe]).i,T=se.total,C=se.node;var ae=se.isNew=!C.tempBbox;C.tempBbox=gE(m,C,_,T,ae,n,se,w)}for(oe=0,E=x.length;oe<E;oe++){C=(se=x[oe]).node;var se,le=se.isTop;_=se.i,k=se.lv,T=se.total;if(le&&yE(C.tempBbox,C.matrixWorld,i,o,a-i,s-o)&&(PE(se),C.computedStyle.maskMode!==Zs.NONE)){bE(C,m,_,k,T);for(var ue=oe;ue>=0;ue--){var ce=x[ue];if(ce.i>_+T+C.struct.next)break;PE(ce)}}}var he,de=!0,fe=[];for(oe=0,E=x.length;oe<E;oe++){var pe=x[oe],ve=(_=pe.i,k=pe.lv,T=pe.total,C=pe.node,pe.valid),ge=(ae=pe.isNew,C.computedStyle),me=(F=ge.maskMode,ge.visibility);P=ge.opacity;if(ve){if(!(me===tl.HIDDEN||P<=0)||F){if(!de&&Date.now()-l>ms.deltaTime){he=x.slice(oe);break}var ye=void 0;if(!(null===(p=C.textureTotal[n])||void 0===p?void 0:p.available))(ie=xE(e,t,C,m,_,T,y,b,r,n))&&(C.textureTotal[n]=C.textureTarget[n]=ie,ye=ie,de=!1);if(C.textureTarget[n]&&!(null===(v=C.textureFilter[n])||void 0===v?void 0:v.available))(ie=EE(e,t,C,y,b,r,n))&&(C.textureFilter[n]=C.textureTarget[n]=ie,ye=ie,de=!1);if(F&&C.textureTarget[n]&&!(null===(g=C.textureMask[n])||void 0===g?void 0:g.available)&&C.next)(ie=OE(e,t,C,F,m,_,k,T,y,b,r,n))&&(C.textureMask[n]=C.textureTarget[n]=ie,ye=ie,de=!1);ye&&!t.firstDraw&&fe.push({bbox:ye.bbox,m:C._matrixWorld||C.matrixWorld})}}else ae&&F&&bE(C,m,_,k,T)}return he&&he.length&&(t.breakMerge=!0),{mergeRecord:fe,breakMerge:he}}function gE(e,t,r,n,i,o,a,s){var l=(t.tempBbox||t._rect||t.rect).slice(0);ou(t.tempMatrix);for(var u=r+1,c=r+n+1;u<c;u++){var h=e[u],d=h.node,f=h.total,p=h.next,v=d.textureTarget[o];if(i){var g=iu(d.parent.tempMatrix,d.matrix);su(d.tempMatrix,g);var m=v&&v!==d.textureCache[o]?v.bbox:d._filterBbox2||d.filterBbox2;m[2]-m[0]&&m[3]-m[1]&&ew(l,m,g)}v&&v.available&&v!==d.textureCache[o]?u+=f+p:d.isShapeGroup&&(u+=f);var y=s[u];y&&(y.isTop=!1,a.subList.push(y))}return l}function mE(e,t,r,n){return yE(e,t,0,0,r,n)}function yE(e,t,r,n,i,o){var a,s,l=gu(e[0],e[1],e[2],e[3],t),u=l.x1,c=l.y1,h=l.x2,d=l.y2,f=l.x3,p=l.y3,v=l.x4,g=l.y4;return u===v&&c===d&&h===f&&p===g?(u>h&&(u=(a=[f,u])[0],f=a[1]),d>p&&(c=(s=[p,c])[0],p=s[1]),rc(r,n,r+i,n+o,u,c,f,p,!1)):ic(r,n,r+i,n+o,[{x:u,y:c},{x:h,y:d},{x:f,y:p},{x:v,y:g}],!1)}function bE(e,t,r,n,i){for(var o=r+i+1,a=t.length;o<a;o++){var s=t[o],l=s.node,u=s.lv,c=l.computedStyle;if(n>u){e.struct.next=o-r-i-1;break}if(o===a||c.breakMask&&n===u){e.struct.next=o-r-i-1;break}}}function xE(e,t,r,n,i,o,a,s,l,u){var c;if(null===(c=r.textureTotal[u])||void 0===c?void 0:c.available)return r.textureTotal[u];var h=r.tempBbox;if(r.tempBbox=void 0,h[0]=Math.floor(h[0]),h[1]=Math.floor(h[1]),h[2]=Math.ceil(h[2]),h[3]=Math.ceil(h[3]),!o||r.isShapeGroup){var d=r.textureCache[u];return d&&d.available||!r.hasContent||(r.genTexture(e,l,u),d=r.textureCache[u]),d}for(var f,p=t.programs,v=p.program,g=h[0],m=h[1],y=g*l,b=m*l,x=Math.ceil(h[2]-g),w=Math.ceil(h[3]-m),_=x*l,E=w*l,S=Yx.getEmptyInstance(e,h),C=S.list,k=ms.maxTextureSize,T=[],A=0,M=Math.ceil(E/k);A<M;A++)for(var O=0,L=Math.ceil(_/k);O<L;O++){var R=O===L-1?_-O*k:k,I=A===M-1?E-A*k:k,F=g+O*k/l,P=m+A*k/l,D=new Float64Array([F,P,F+R/l,P+I/l]),N=y+O*k,B=b+A*k;T.push({x:N,y:B,w:R,h:I,bbox:D})}for(A=i,M=i+o+1;A<M;A++){var U=n[A],z=U.node,X=U.total,H=U.next,G=z.computedStyle,j=FE(z,G,u),Y=j.shouldIgnore,W=j.isBgBlur;if(Y)A+=X+H;else{z.isBitmap&&z.checkLoader()&&t.imgLoadList.push(z);var V=void 0,q=void 0;if(A===i)V=z.tempOpacity=1,ou(z.tempMatrix),q=fu(z.tempMatrix,l);else{var K=z.parent;V=z.tempOpacity=G.opacity*K.tempOpacity,q=iu(K.tempMatrix,z.matrix)}su(z.tempMatrix,q);var Z=z.textureTarget[u];if(!Z&&z.hasContent&&(z.genTexture(e,l,u),Z=z.textureTarget[u]),Z&&Z.available){var J=G.mixBlendMode,Q=G.blur;if(W&&A>i){var $=z.textureOutline[l]=IE(e,z,n,A,X,Z.bbox,l);su(z.tempMatrix,q),C.splice(0),T.forEach((function(e){if(e.t){var t={bbox:e.bbox,w:e.w,h:e.h,t:e.t};e.ref=t,C.push(t)}})),RE(e,t,S,q,$,Q,p,l,x,w),T.forEach((function(e){e.ref&&(e.t=e.ref.t,e.ref=void 0)})),C.splice(0),f&&e.bindFramebuffer(e.FRAMEBUFFER,f)}for(var ee=Z.list,te=(O=0,T.length);O<te;O++)for(var re=T[O],ne=re.x,ie=re.y,oe=re.w,ae=re.h,se=re.t,le=.5*oe,ue=.5*ae,ce=0,he=ee.length;ce<he;ce++){var de=ee[ce],fe=de.bbox,pe=de.t;if(yE(fe,q,ne,ie,oe,ae)){se||(se=re.t=fx(e,0,void 0,oe,ae)),f?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,se,0),e.viewport(0,0,oe,ae)):f=wE(e,se,oe,ae);var ve=void 0;J!==Hs.NORMAL&&A>i&&(ve=fx(e,0,void 0,oe,ae),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ve,0)),vx(e,le,ue,v,[{opacity:V,matrix:q,bbox:fe,texture:pe}],-re.x,-re.y,!1,-1,-1,1,1),J!==Hs.NORMAL&&ve&&(re.t=LE(e,se,ve,J,p,oe,ae))}}}Z&&Z.available&&Z!==z.textureCache[u]||G.maskMode&&A!==i?A+=X+H:z.isShapeGroup&&(A+=X)}}return f&&_E(e,f,a,s),T.forEach((function(e){e.t&&C.push({bbox:e.bbox,w:e.w,h:e.h,t:e.t})})),S}function wE(e,t,r,n){var i=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,i),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.viewport(0,0,r,n),i}function _E(e,t,r,n){e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(t),e.viewport(0,0,r,n)}function EE(e,t,r,n,i,o,a){var s,l;if(null===(s=r.textureFilter[a])||void 0===s?void 0:s.available)return r.textureFilter[a];var u=r.computedStyle,c=u.shadow,h=u.shadowEnable,d=u.blur,f=u.fill,p=u.fillEnable,v=u.fillOpacity,g=u.hueRotate,m=u.saturate,y=u.brightness,b=u.contrast,x=r.textureTarget[a];r.isGroup&&p[0]&&f[0]&&Array.isArray(f[0])&&(l=function(e,t,r,n,i,o,a){var s=r.bbox,l=r.list,u=t.programs,c=u.tintProgram;e.useProgram(c);for(var h,d=Yx.getEmptyInstance(e,s),f=d.list,p=0,v=l.length;p<v;p++){var g=l[p],m=g.bbox,y=g.w,b=g.h,x=g.t,w=fx(e,0,void 0,y,b);h?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,w,0),e.viewport(0,0,y,b)):h=wE(e,w,y,b),Sx(e,c,x,n,i),f.push({bbox:m.slice(0),w:y,h:b,t:w})}return e.useProgram(u.program),_E(e,h,o,a),d}(e,t,x,f[0],v[0],n,i));var w=[];if(c.forEach((function(e,t){h[t]&&e.color[3]>0&&w.push(e)})),w.length){var _=function(e,t,r,n,i,o,a){for(var s=r.bbox,l=s.slice(0),u=[0,0,0,0],c=[],h=[],d=0,f=n.length;d<f;d++){var p=Hx(Xx(.5*(Re=n[d]).blur));if(h.push(p),Re.x||Re.y||p){var v=Re.x-p,g=Re.y-p,m=Re.x+p,y=Re.y+p;c.push([v,g,m+(s[2]-s[0]),y+(s[3]-s[1])]),u[0]=Math.min(u[0],v),u[1]=Math.min(u[1],g),u[2]=Math.max(u[2],m),u[3]=Math.max(u[3],y)}}if(!c.length)return;l[0]+=u[0],l[1]+=u[1],l[2]+=u[2],l[3]+=u[3];var b,x,w=l[0],_=l[1],E=l[2]-l[0],S=l[3]-l[1],C=E*a,k=S*a,T=t.programs,A=T.program,M=T.dropShadowProgram,O=Yx.getEmptyInstance(e,l),L=O.list,R=ms.maxTextureSize;for(d=0,f=Math.ceil(k/R);d<f;d++)for(var I=0,F=Math.ceil(C/R);I<F;I++){for(var P=I===F-1?C-I*R:R,D=d===f-1?k-d*R:R,N=w+I*R/a,B=_+d*R/a,U=P/a,z=D/a,X=!0,H=0,G=c.length;H<G;H++){var j=c[H];if(rc(s[0],s[1],s[2],s[3],N,B,N+U,B+z)||rc(j[0],j[1],j[2],j[3],N,B,N+U,B+z)){X=!1;break}}if(!X){var Y=new Float64Array([N,B,N+U,B+z]),W=fx(e,0,void 0,P,D);L.push({bbox:Y,w:P,h:D,t:W})}}1!==a&&fu(b=ru(),a);for(d=0,f=n.length;d<f;d++){p=h[d];var V=n[d],q=V.x,K=V.y,Z=V.blur,J=V.color,Q=s.slice(0);Q[0]-=p,Q[1]-=p,Q[2]+=p,Q[3]+=p;var $=Q[0],ee=Q[1],te=Q[2]-Q[0],re=Q[3]-Q[1],ne=te*a,ie=re*a,oe=Yx.getEmptyInstance(e,Q),ae=oe.list,se=SE(e,A,r,oe,$,ee,a,ne,ie),le=Yx.getEmptyInstance(e,Q),ue=le.list;e.useProgram(M);for(var ce=0,he=ae.length;ce<he;ce++){var de=ae[ce],fe=(Y=de.bbox,de.w),pe=de.h;W=de.t;e.viewport(0,0,fe,pe);var ve=Y.slice(0);ve[0]+=q,ve[1]+=K,ve[2]+=q,ve[3]+=K;var ge=fx(e,0,void 0,fe,pe);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ge,0),_x(e,M,W,Oc(J)),ue.push({bbox:ve,w:fe,h:pe,t:ge})}if(oe.release(),Z){var me=.5*Z,ye=me*a,be=Hx(Xx(me)),xe=Gx(.5*ye),we=T.boxProgram;e.useProgram(we);for(var _e=Yx.getEmptyInstance(e,Q),Ee=_e.list,Se=0,Ce=ue.length;Se<Ce;Se++){var ke=ue[Se],Te=(Y=ke.bbox,ke.w),Ae=ke.h;W=ke.t;e.viewport(0,0,Te,Ae);ge=yx(e,we,W,Te,Ae,xe);Ee.push({bbox:Y.slice(0),w:Te,h:Ae,t:ge})}if(ue.length>1){for(var Me=CE(e,_e,$,ee,te,re,a,be),Oe=0,Le=Me.length;Oe<Le;Oe++){Y=(Re=Me[Oe]).bbox;var Re,Ie=Re.w,Fe=Re.h;W=Re.t;e.useProgram(A),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W,0),e.viewport(0,0,Ie,Fe);for(var Pe=.5*Ie,De=.5*Fe,Ne=!1,Be=(I=0,ue.length);I<Be;I++){var Ue=ue[I],ze=Ue.bbox,Xe=Ue.w,He=Ue.h,Ge=Ue.t;yE(Y,void 0,ze[0],ze[1],Xe,He)&&(vx(e,Pe,De,A,[{opacity:1,bbox:ze,texture:Ge}],-Y[0],-Y[1],!1,-1,-1,1,1),Ne=!0)}Ne&&(e.useProgram(we),Re.t=yx(e,we,W,Ie,Fe,xe)),e.deleteTexture(W)}kE(e,A,a,le,Me,Q,be)}le.release(),ue=(le=_e).list}e.useProgram(A);for(var je=0,Ye=L.length;je<Ye;je++){var We=L[je],Ve=(Y=We.bbox,We.w),qe=We.h;W=We.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W,0),e.viewport(0,0,Ve,qe);Pe=.5*Ve,De=.5*qe,I=0;for(var Ke=ue.length;I<Ke;I++){var Ze=ue[I],Je=(ze=Ze.bbox,Ze.w),Qe=Ze.h;Ge=Ze.t;yE(Y,void 0,ze[0],ze[1],Je,Qe)&&vx(e,Pe,De,A,[{opacity:1,matrix:b,bbox:ze,texture:Ge}],-Y[0]*a,-Y[1]*a,!1,-1,-1,1,1)}}le.release(),se&&_E(e,se,i,o)}var $e=r.list;for(d=0,f=L.length;d<f;d++){var et=L[d],tt=(Y=et.bbox,et.w),rt=et.h;W=et.t;x?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,W,0),e.viewport(0,0,tt,rt)):x=wE(e,W,tt,rt);Pe=.5*tt,De=.5*rt,I=0;for(var nt=$e.length;I<nt;I++){var it=$e[I],ot=(ze=it.bbox,it.w),at=it.h;Ge=it.t;yE(Y,void 0,ze[0],ze[1],ot,at)&&vx(e,Pe,De,A,[{opacity:1,matrix:b,bbox:ze,texture:Ge}],-Y[0]*a,-Y[1]*a,!1,-1,-1,1,1)}}x&&_E(e,x,i,o);return O}(e,t,l||x,w,n,i,o);l&&l.release(),l=_}if(d.t===Ys.GAUSSIAN&&d.radius>=1){_=TE(e,t,l||x,d.radius,n,i,o);l&&l.release(),l=_}else if(d.t===Ys.RADIAL&&d.radius>=1){_=function(e,t,r,n,i,o,a,s){var l=r.bbox,u=Hx(Xx(n)),c=l.slice(0),h=c[2]-c[0],d=c[3]-c[1],f=i[0]*h,p=i[1]*d,v=Math.sqrt(h*h+d*d),g=2*u/v,m=Math.ceil(g*f),y=Math.ceil(g*(h-f)),b=Math.ceil(g*p),x=Math.ceil(g*(d-p));c[0]-=m,c[1]-=b,c[2]+=y,c[3]+=x;var w=c[0],_=c[1],E=c[2]-c[0],S=c[3]-c[1],C=E*s,k=S*s,T=t.programs,A=T.program,M=Yx.getEmptyInstance(e,c),O=M.list,L=SE(e,A,r,M,w,_,s,C,k),R=T.radialProgram;e.useProgram(R);for(var I=Yx.getEmptyInstance(e,c),F=I.list,P=f+m,D=p+b,N=0,B=O.length;N<B;N++){var U=O[N],z=U.bbox,X=U.w,H=U.h,G=U.t;e.viewport(0,0,X,H);var j=z[2]-z[0],Y=z[3]-z[1],W=wx(e,R,G,g,u*s,J=[(P-z[0]+c[0])/j,(D-z[1]+c[1])/Y],X,H);F.push({bbox:z.slice(0),w:X,h:H,t:W})}if(O.length>1){var V=CE(e,I,w,_,E,S,s,u);for(N=0,B=V.length;N<B;N++){var q=V[N],K=(z=q.bbox,q.w),Z=q.h;G=q.t;e.useProgram(A),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,G,0),e.viewport(0,0,K,Z);for(var J=[(P-z[0]+c[0])/(z[2]-z[0]),(D-z[1]+c[0])/(z[3]-z[1])],Q=.5*K,$=.5*Z,ee=!1,te=0,re=O.length;te<re;te++){var ne=O[te],ie=ne.bbox,oe=ne.t,ae=ie[2]-ie[0],se=ie[3]-ie[1];yE(z,void 0,ie[0],ie[1],ae,se)&&(vx(e,Q,$,A,[{opacity:1,bbox:new Float64Array([ie[0]*s,ie[1]*s,ie[2]*s,ie[3]*s]),texture:oe}],-z[0]*s,-z[1]*s,!1,-1,-1,1,1),ee=!0)}ee&&(e.useProgram(R),q.t=wx(e,R,G,g,u*s,J,K,Z)),e.deleteTexture(G)}kE(e,A,s,I,V,c,u)}return M.release(),e.useProgram(A),_E(e,L,o,a),I}(e,t,l||x,d.radius,d.center,n,i,o);l&&l.release(),l=_}else if(d.t===Ys.MOTION&&d.radius>=1){_=function(e,t,r,n,i,o,a,s){var l=Zu(i),u=Hx(Xx(n)),c=r.bbox.slice(0),h=Math.sin(l),d=Math.cos(l),f=Math.abs(Math.ceil(h*u)),p=Math.abs(Math.ceil(d*u));c[0]-=p,c[1]-=f,c[2]+=p,c[3]+=f;var v=c[0],g=c[1],m=c[2]-c[0],y=c[3]-c[1],b=m*s,x=y*s,w=t.programs,_=w.program,E=Yx.getEmptyInstance(e,c),S=E.list,C=SE(e,_,r,E,v,g,s,b,x),k=n*s,T=Xx(k),A=w.motionProgram;e.useProgram(A);for(var M=Yx.getEmptyInstance(e,c),O=M.list,L=0,R=S.length;L<R;L++){var I=S[L],F=I.bbox,P=I.w,D=I.h,N=I.t;e.viewport(0,0,P,D);var B=xx(e,A,N,T,l,P,D);O.push({bbox:F.slice(0),w:P,h:D,t:B})}if(S.length>1){var U=CE(e,M,v,g,m,y,s,u);for(L=0,R=U.length;L<R;L++){var z=U[L],X=(F=z.bbox,z.w),H=z.h;N=z.t;e.useProgram(_),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,N,0),e.viewport(0,0,X,H);for(var G=.5*X,j=.5*H,Y=!1,W=0,V=S.length;W<V;W++){var q=S[W],K=q.bbox,Z=q.t,J=K[2]-K[0],Q=K[3]-K[1];yE(F,void 0,K[0],K[1],J,Q)&&(vx(e,G,j,_,[{opacity:1,bbox:new Float64Array([K[0]*s,K[1]*s,K[2]*s,K[3]*s]),texture:Z}],-F[0]*s,-F[1]*s,!1,-1,-1,1,1),Y=!0)}Y&&(e.useProgram(A),z.t=xx(e,A,N,T,l,X,H)),e.deleteTexture(N)}kE(e,_,s,M,U,c,u)}return E.release(),e.useProgram(_),_E(e,C,o,a),M}(e,t,l||x,d.radius,d.angle,n,i,o);l&&l.release(),l=_}if(g||1!==m||1!==y||1!==b){_=ME(e,t,l||x,g,m,y,b,n,i);l&&l.release(),l=_}return l}function SE(e,t,r,n,i,o,a,s,l){for(var u,c=ms.maxTextureSize,h=r.list,d=n.list,f=0,p=Math.ceil(l/c);f<p;f++)for(var v=0,g=Math.ceil(s/c);v<g;v++){var m=v===g-1?s-v*c:c,y=f===p-1?l-f*c:c,b=fx(e,0,void 0,m,y),x=i+v*c/a,w=o+f*c/a,_=m/a,E=y/a,S={bbox:new Float64Array([x,w,x+_,w+E]),w:m,h:y,t:b};d.push(S),u?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0),e.viewport(0,0,m,y)):u=wE(e,b,m,y);for(var C=.5*m,k=.5*y,T=0,A=h.length;T<A;T++){var M=h[T],O=M.bbox,L=M.t;yE(O,void 0,x,w,_,E)&&vx(e,C,k,t,[{opacity:1,bbox:new Float64Array([O[0]*a,O[1]*a,O[2]*a,O[3]*a]),texture:L}],-x*a,-w*a,!1,-1,-1,1,1)}}return u}function CE(e,t,r,n,i,o,a,s){for(var l=ms.maxTextureSize,u=l-s*a*2,c=[],h=t.bbox,d=i*a,f=o*a,p=0,v=Math.ceil(f/u);p<v;p++)for(var g=1,m=Math.ceil(d/l);g<m;g++){var y=Math.max(h[0],r+g*l/a-2*s),b=Math.max(h[1],n+p*u/a-s),x=Math.min(h[2],y+4*s),w=Math.min(h[3],b+u/a+2*s),_=new Float64Array([y,b,x,w]);y>h[2]-2*s&&(y=_[0]=Math.max(h[0],h[2]-2*s),x=_[2]=h[2]),b>h[3]-2*s&&(b=_[1]=Math.max(h[1],h[3]-2*s),w=_[3]=h[3]);var E=(_[2]-_[0])*a,S=(_[3]-_[1])*a;c.push({bbox:_,w:E,h:S,t:fx(e,0,void 0,E,S),x1:Math.max(h[0],y+s),y1:Math.max(h[1],p?b+s:b),x2:Math.min(h[2],x-s),y2:Math.min(h[3],p===v-1?w:b+u+s)})}for(p=1,v=Math.ceil(f/l);p<v;p++)for(g=0,m=Math.ceil(d/u);g<m;g++){y=Math.max(h[0],r+g*u/a-s),b=Math.max(h[1],n+p*l/a-2*s),x=Math.min(h[2],y+u/a+2*s),w=Math.min(h[3],b+4*s),_=new Float64Array([y,b,x,w]);y>h[2]-2*s&&(y=_[0]=Math.max(h[0],h[2]-2*s),x=_[2]=h[2]),b>h[3]-2*s&&(b=_[1]=Math.max(h[1],h[3]-2*s),w=_[3]=h[3]);var C=(_[2]-_[0])*a,k=(_[3]-_[1])*a;c.push({bbox:_,w:C,h:k,t:fx(e,0,void 0,C,k),x1:Math.max(h[0],g?y+s:y),y1:Math.max(h[1],b+s),x2:Math.min(h[2],g===m-1?x:y+u+s),y2:Math.min(h[3],w-s)})}return c}function kE(e,t,r,n,i,o,a){e.useProgram(t),e.blendFunc(e.ONE,e.ZERO);for(var s=n.list,l=0,u=s.length;l<u;l++){var c=s[l],h=c.bbox,d=c.w,f=c.h,p=c.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,p,0),e.viewport(0,0,d,f);for(var v=.5*d,g=.5*f,m=0,y=i.length;m<y;m++){var b=i[m],x=b.bbox,w=b.w,_=b.h,E=b.t,S=x.slice(0);S[0]!==o[0]&&(S[0]+=a),S[1]!==o[1]&&(S[1]+=a),S[2]!==o[2]&&(S[2]-=a),S[3]!==o[3]&&(S[3]-=a);var C=S[2]-S[0],k=S[3]-S[1];yE(h,void 0,S[0],S[1],C,k)&&vx(e,v,g,t,[{opacity:1,bbox:new Float64Array([S[0]*r,S[1]*r,S[2]*r,S[3]*r]),texture:E,tc:{x1:(S[0]===o[0]?0:a*r)/w,y1:(S[1]===o[1]?0:a*r)/_,x3:(S[2]===o[2]?w:w-a*r)/w,y3:(S[3]===o[3]?_:_-a*r)/_}}],-h[0]*r,-h[1]*r,!1,-1,-1,1,1)}}e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),i.forEach((function(t){return e.deleteTexture(t.t)}))}function TE(e,t,r,n,i,o,a){var s=Hx(Xx(n)),l=r.bbox.slice(0);l[0]-=s,l[1]-=s,l[2]+=s,l[3]+=s;var u=l[0],c=l[1],h=l[2]-l[0],d=l[3]-l[1],f=h*a,p=d*a,v=t.programs.program,g=Yx.getEmptyInstance(e,l),m=g.list,y=SE(e,v,r,g,u,c,a,f,p),b=n*a,x=0;b>=256?x=4:b>=64?x=3:b>=16?x=2:b>=4&&(x=1);for(var w=Gx(b*Math.pow(.5,x)),_=Yx.getEmptyInstance(e,l),E=_.list,S=0,C=m.length;S<C;S++){var k=m[S],T=k.bbox,A=k.w,M=k.h,O=k.t;E.push({bbox:T.slice(0),w:A,h:M,t:AE(e,t,w,x,O,A,M)})}if(m.length>1){var L=CE(e,_,u,c,h,d,a,s);for(S=0,C=L.length;S<C;S++){var R=L[S],I=(T=R.bbox,R.w),F=R.h;O=R.t;e.useProgram(v),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,O,0),e.viewport(0,0,I,F);for(var P=.5*I,D=.5*F,N=!1,B=0,U=m.length;B<U;B++){var z=m[B],X=z.bbox,H=z.t,G=X[2]-X[0],j=X[3]-X[1];yE(T,void 0,X[0],X[1],G,j)&&(vx(e,P,D,v,[{opacity:1,bbox:new Float64Array([X[0]*a,X[1]*a,X[2]*a,X[3]*a]),texture:H}],-T[0]*a,-T[1]*a,!1,-1,-1,1,1),N=!0)}N&&(R.t=AE(e,t,w,x,O,I,F),e.deleteTexture(O))}kE(e,v,a,_,L,l,s)}return g.release(),e.useProgram(v),_E(e,y,i,o),_}function AE(e,t,r,n,i,o,a){var s=t.programs,l=s.boxProgram,u=s.dualDownProgram,c=s.dualUpProgram,h=o,d=a,f=void 0;if(n){e.useProgram(u),f=i;for(var p=1;p<=n;p++){var v=Math.ceil(o*Math.pow(.5,p)),g=Math.ceil(a*Math.pow(.5,p));e.viewport(0,0,v,g),f=bx(e,u,y=f,h,d,v,g),y!==i&&e.deleteTexture(y),h=v,d=g}}e.useProgram(l),e.viewport(0,0,h,d);var m=yx(e,l,f||i,h,d,r);if(n){e.useProgram(c),f=m;for(p=n-1;p>=0;p--){var y;v=Math.ceil(o*Math.pow(.5,p)),g=Math.ceil(a*Math.pow(.5,p));e.viewport(0,0,v,g),f=bx(e,c,y=f,h,d,v,g),e.deleteTexture(y),h=v,d=g}m=f}return e.viewport(0,0,o,a),m}function ME(e,t,r,n,i,o,a,s,l){var u=t.programs,c=u.cmProgram;e.useProgram(c);var h,d=r;if(n||1!==i||1!==o||1!==a){var f=Zu(n%360),p=Math.cos(f),v=Math.sin(f),g=.213*(1-i),m=.715*(1-i),y=.072*(1-i),b=o-1,x=a,w=.5*(1-x),_=iu(n?new Float64Array([.213+.787*p-.213*v,.715-.715*p-.715*v,.072-.072*p+.928*v,0,.213-.213*p+.143*v,.715+.285*p+.14*v,.072-.072*p-.283*v,0,.213-.213*p-.787*v,.715-.715*p+.715*v,.072+.928*p+.072*v,0,0,0,0,1]):ru(),1!==i?new Float64Array([g+i,m,y,0,g,m+i,y,0,g,m,y+i,0,0,0,0,1]):ru());1!==x&&(_[0]*=x,_[1]*=x,_[2]*=x,_[4]*=x,_[5]*=x,_[6]*=x,_[8]*=x,_[9]*=x,_[10]*=x);var E=d,S=function(e,t,r,n,i){for(var o=Yx.getEmptyInstance(e,r.bbox),a=r.list,s=o.list,l=0,u=a.length;l<u;l++){var c=a[l],h=c.bbox,d=c.w,f=c.h,p=c.t,v=fx(e,0,void 0,d,f);i?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),e.viewport(0,0,d,f)):i=wE(e,v,d,f),Cx(e,t,p,n),s.push({bbox:h.slice(0),w:d,h:f,t:v})}return{res:o,frameBuffer:i}}(e,c,E,[_[0],_[1],_[2],_[3],b+w,_[4],_[5],_[6],_[7],b+w,_[8],_[9],_[10],_[11],b+w,0,0,0,1],h);d=S.res,h=S.frameBuffer,E!==r&&E.release()}if(e.useProgram(u.program),h)return _E(e,h,s,l),d;e.viewport(0,0,s,l)}function OE(e,t,r,n,i,o,a,s,l,u,c,h){var d;if(null===(d=r.textureMask[h])||void 0===d?void 0:d.available)return r.textureMask[h];var f=r.textureTarget[h];if(!r.next)return f;var p=f.list,v=t.programs,g=v.program;e.useProgram(g);var m,y=f.bbox,b=r.matrix,x=r.computedStyle,w=y[0],_=y[1],E=w*c,S=_*c,C=y[2]-w,k=y[3]-_,T=C*c,A=k*c,M=Yx.getEmptyInstance(e,y),O=M.list,L=ms.maxTextureSize,R=ru();su(R,b),fu(R,1/c);for(var I=vu(R),F=0,P=Math.ceil(A/L);F<P;F++)for(var D=0,N=Math.ceil(T/L);D<N;D++){var B=D===N-1?T-D*L:L,U=F===P-1?A-F*L:L,z=fx(e,0,void 0,B,U),X=w+D*L/c,H=_+F*L/c,G={bbox:new Float64Array([X,H,X+B/c,H+U/c]),w:B,h:U,t:z};O.push(G);var j=E+D*L,Y=S+F*L;m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,z,0),e.viewport(0,0,B,U)):m=wE(e,z,B,U);var W=.5*B,V=.5*U;if(n===Zs.OUTLINE&&x.visibility===tl.VISIBLE&&x.opacity>0&&f.available){var q=F*N+D;vx(e,W,V,g,[{opacity:1,bbox:new Float64Array([0,0,B,U]),texture:p[q].t}],0,0,!1,-1,-1,1,1)}for(var K=!F&&!D,Z=o+s+1,J=i.length;Z<J;Z++){var Q=i[Z],$=Q.node,ee=Q.lv,te=Q.total,re=Q.next,ne=$.computedStyle;if(a>ee){r.struct.next=Z-o-s-1;break}if(Z===J||ne.breakMask&&a===ee){r.struct.next=Z-o-s-1;break}var ie=FE($,ne,h),oe=ie.shouldIgnore,ae=ie.isBgBlur;if(oe)Z+=te+re;else{K&&$.isBitmap&&$.checkLoader()&&t.imgLoadList.push($);var se=void 0,le=void 0;if(K){if(a===ee)se=$.tempOpacity=ne.opacity,le=iu(I,$.matrix);else{var ue=$.parent;se=$.tempOpacity=ne.opacity*ue.tempOpacity,le=iu(ue.tempMatrix,$.matrix)}su($.tempMatrix,le)}else se=$.tempOpacity,le=$.tempMatrix;var ce=$.textureTarget[h];if(!ce&&$.hasContent&&($.genTexture(e,c,h),ce=$.textureTarget[h]),ce&&ce.available){var he=ne.mixBlendMode,de=ne.blur;if(ae&&Z>o+s+1){var fe=$.textureOutline[c]=IE(e,$,i,Z,te,ce.bbox,c);su($.tempMatrix,le),RE(e,t,M,le,fe,de,v,c,C,k),e.bindFramebuffer(e.FRAMEBUFFER,m),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,G.t,0),e.viewport(0,0,B,U)}for(var pe=ce.list,ve=0,ge=pe.length;ve<ge;ve++){var me=pe[ve],ye=me.bbox,be=me.t;if(yE(ye,le,j,Y,B,U)){var xe=void 0;he!==Hs.NORMAL&&Z>o&&(xe=fx(e,0,void 0,B,U),m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,xe,0),e.viewport(0,0,B,U)):m=wE(e,xe,B,U)),vx(e,W,V,g,[{opacity:se,matrix:le,bbox:ye,texture:be}],-j,-Y,!1,-1,-1,1,1),he!==Hs.NORMAL&&xe&&(G.t=LE(e,G.t,xe,he,v,B,U))}}}ce&&ce.available&&ce!==$.textureCache[h]||ne.maskMode?Z+=te+re:$.isShapeGroup&&(Z+=te)}}}var we,_e=Yx.getEmptyInstance(e,y),Ee=_e.list;n===Zs.OUTLINE&&(we=(fe=r.textureOutline[c]=IE(e,r,i,o,s,y,c)).list);if(n===Zs.GRAY){var Se=v.maskGrayProgram;e.useProgram(Se);for(F=0,P=O.length;F<P;F++){var Ce=O[F],ke=Ce.bbox,Te=Ce.w,Ae=Ce.h;z=Ce.t,xe=fx(e,0,void 0,Te,Ae);m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,xe,0),e.viewport(0,0,Te,Ae)):m=wE(e,xe,Te,Ae),mx(e,Se,p[F].t,z),Ee.push({bbox:ke.slice(0),w:Te,h:Ae,t:xe})}}else{var Me=v.maskProgram,Oe=v.clipProgram;e.useProgram(Me);for(F=0,P=O.length;F<P;F++){var Le=O[F],Re=Le.bbox,Ie=Le.w,Fe=Le.h;z=Le.t,xe=fx(e,0,void 0,Ie,Fe);m?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,xe,0),e.viewport(0,0,Ie,Fe)):m=wE(e,xe,Ie,Fe),mx(e,Me,we?we[F].t:p[F].t,z),we&&(e.useProgram(Oe),mx(e,Oe,we[F].t,p[F].t),e.useProgram(Me)),Ee.push({bbox:Re.slice(0),w:Ie,h:Fe,t:xe})}}return e.useProgram(g),M.release(),m?_E(e,m,l,u):e.viewport(0,0,l,u),_e}function LE(e,t,r,n,i,o,a){var s;n===Hs.MULTIPLY?s=i.multiplyProgram:n===Hs.SCREEN?s=i.screenProgram:n===Hs.OVERLAY?s=i.overlayProgram:n===Hs.DARKEN?s=i.darkenProgram:n===Hs.LIGHTEN?s=i.lightenProgram:n===Hs.COLOR_DODGE?s=i.colorDodgeProgram:n===Hs.COLOR_BURN?s=i.colorBurnProgram:n===Hs.HARD_LIGHT?s=i.hardLightProgram:n===Hs.SOFT_LIGHT?s=i.softLightProgram:n===Hs.DIFFERENCE?s=i.differenceProgram:n===Hs.EXCLUSION?s=i.exclusionProgram:n===Hs.HUE?s=i.hueProgram:n===Hs.SATURATION?s=i.saturationProgram:n===Hs.COLOR?s=i.colorProgram:n===Hs.LUMINOSITY?s=i.luminosityProgram:(hl.error("Unknown mixBlendMode: "+n),s=i.program),e.useProgram(s);var l=fx(e,0,void 0,o,a);return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,l,0),Ex(e,s,t,r),e.deleteTexture(t),e.deleteTexture(r),e.useProgram(i.program),l}function RE(e,t,r,n,i,o,a,s,l,u){for(var c,h=a.program,d=TE(e,t,r,o.radius,l,u,s),f=d.list,p=i.list,v=[],g=0,m=f.length;g<m;g++){var y=f[g],b=y.bbox,x=.5*(M=y.w),w=.5*(O=y.h),_=fx(e,0,void 0,M,O);v.push(_),c?(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,_,0),e.viewport(0,0,M,O)):c=wE(e,_,M,O);for(var E=0,S=p.length;E<S;E++){var C=p[E],k=C.bbox,T=C.t;yE(k,n,b[0]*s,b[1]*s,(b[2]-b[0])*s,(b[3]-b[1])*s)&&vx(e,x,w,h,[{opacity:1,matrix:n,bbox:k,texture:T}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}var A=a.maskProgram;e.useProgram(A);for(g=0,m=f.length;g<m;g++){var M=(B=f[g]).w,O=B.h,L=B.t;_=fx(e,0,void 0,M,O);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,_,0),e.viewport(0,0,M,O),mx(e,A,v[g],L),e.deleteTexture(L),e.deleteTexture(v[g]),B.t=_}if(void 0!==o.saturation&&1!==o.saturation&&(L=ME(e,t,d||r,0,o.saturation,1,1,l,u))){for(g=0,m=f.length;g<m;g++)e.deleteTexture(f[g].t),f[g].t=L.list[g].t;c&&e.bindFramebuffer(e.FRAMEBUFFER,c)}e.useProgram(h);var R=[],I=r.list;for(g=0,m=I.length;g<m;g++){var F=I[g];b=F.bbox,M=F.w,O=F.h,L=F.t,x=.5*M,w=.5*O,_=fx(e,0,void 0,M,O);R.push(_),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,_,0),e.viewport(0,0,M,O);E=0;for(var P=p.length;E<P;E++){var D=p[E];k=D.bbox,T=D.t;yE(k,n,b[0]*s,b[1]*s,(b[2]-b[0])*s,(b[3]-b[1])*s)&&vx(e,x,w,h,[{opacity:1,matrix:n,bbox:k,texture:T}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}var N=a.clipProgram;e.useProgram(N);for(g=0,m=I.length;g<m;g++){var B;M=(B=I[g]).w,O=B.h,L=B.t,_=fx(e,0,void 0,M,O);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,_,0),e.viewport(0,0,M,O),mx(e,N,R[g],L),e.deleteTexture(L),e.deleteTexture(R[g]),B.t=_}e.useProgram(h);var U=ru();1!==s&&fu(U,s),e.blendFunc(e.ONE,e.ONE);for(g=0,m=I.length;g<m;g++){var z=I[g];b=z.bbox,M=z.w,O=z.h,L=z.t;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,L,0),e.viewport(0,0,M,O);E=0;for(var X=f.length;E<X;E++){var H=f[E];k=H.bbox,T=H.t;yE(k,void 0,b[0],b[1],b[2]-b[0],b[3]-b[1])&&vx(e,.5*M,.5*O,h,[{opacity:1,matrix:U,bbox:k,texture:T}],-b[0]*s,-b[1]*s,!1,-1,-1,1,1)}}e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),c?_E(e,c,l,u):e.viewport(0,0,l,u)}function IE(e,t,r,n,i,o,a){var s;if(null===(s=t.textureOutline[a])||void 0===s?void 0:s.available)return t.textureOutline[a];var l=o[0],u=o[1],c=o[2]-l,h=o[3]-u,d=-l*a,f=-u*a,p=c*a,v=h*a,g=Zx.getInstance(p,v,d,f);g.available=!0;for(var m=g.list,y=function(e,t){var o=m[e],s=o.x,l=o.y,u=o.os.ctx,c=-s,d=-l;u.fillStyle="#FFF";for(var f=n,p=n+i+1;f<p;f++){var v=r[f],g=v.node,y=v.total,b=v.next,x=void 0;if(f===n)x=ou(g.tempMatrix);else x=iu(g.parent.tempMatrix,g.matrix),su(g.tempMatrix,x);var w=g.computedStyle.fillRule===Ks.EVEN_ODD?"evenodd":"nonzero";if(u.setTransform(x[0],x[1],x[4],x[5],x[12],x[13]),g instanceof pw){var _=g.coords;u.beginPath(),ox(u,_,a,c,d),u.closePath(),u.fill(w)}else if(g instanceof uE){_=g.coords;u.beginPath(),_.forEach((function(e){ox(u,e,a,c,d)})),u.closePath(),u.fill(w),f+=y+b}else if(g instanceof f_)for(var E=g.lineBoxList,S=0,C=E.length;S<C;S++){var k=E[S];if(k.y>=h)break;for(var T=k.list,A=T.length,M=0;M<A;M++){var O=T[M];f_.setFontAndLetterSpacing(u,O,a),u.fillText(O.str,O.x*a+c,(O.y+O.baseline)*a+d)}}else u.fillRect(c,d,g.width*a,g.height*a),g instanceof l_&&(f+=y+b)}},b=0,x=m.length;b<x;b++)y(b);var w=Yx.getInstance(e,g,o);return g.release(),w}function FE(e,t,r){var n=t.blur,i=n.t===Ys.BACKGROUND&&(n.radius>0||1!==n.saturation)&&(e instanceof uE||e instanceof iw||e instanceof Qx||e instanceof f_),o=t.visibility===tl.HIDDEN||t.opacity<=0;if(o&&t.maskMode&&e.next&&(o=!1),o&&t.maskMode&&t.opacity>0){var a=e.textureTarget[r];t.maskMode===Zs.OUTLINE?(t.visibility===tl.VISIBLE||a!==e.textureTotal[r]&&a!==e.textureCache[r])&&(o=!1):t.maskMode===Zs.ALPHA&&e.next&&a!==e.textureTotal[r]&&a!==e.textureCache[r]&&(o=!1)}return o&&i&&t.visibility===tl.VISIBLE&&(o=!1),{shouldIgnore:o,isBgBlur:i}}function PE(e){e.valid=!0;for(var t=e.subList;t.length;){var r=t.pop();r.valid=!0;for(var n=r.subList;n.length;)t.push(n.pop())}}function DE(e,t){var r=t.getCurPageZoom(),n=0;if(r<=1)1===r?(r=2,n=1):r=1;else{for(var i=1;r>1;)r*=.5,i<<=1,n++;r=i}t.scale=r,t.scaleIndex=n;var o=t.imgLoadList,a=t.lastPage;ms.tile&&a?function(e,t,r,n){var i=t.structs,o=t.lastPage,a=t.width,s=t.height,l=t.dpi,u=t.imgLoadList,c=t.tileRecord,h=o.computedStyle.scaleX,d=o.matrixWorld,f=h,p=1;if(f<.5)for(;f<.5;)f*=2,p*=.5;else p=r/l;var v=h/p,g=t.tileManager;g.setPage(o);var m=pu({x:0,y:0},d),y=m.x,b=m.y,x=Rx.UNIT*v*l,w=0,_=0,E=y%x,S=b%x,C=Math.floor(-y/x),k=Math.floor(-b/x);w=E>0?Math.ceil((a-E)/x)+1:Math.ceil((a-E)/x);_=S>0?Math.ceil((s-S)/x)+1:Math.ceil((s-S)/x);var T=Math.round(Rx.UNIT/p),A=g.active(p,C*T,k*T,w,_),M=.5*a,O=.5*s,L=t.programs,R=L.program;e.useProgram(L.program);for(var I=[],F=!0,P=0,D=A.length;P<D;P++){(ct=A[P]).init(l),ct.complete||(F=!1);var N=ct.x,B=ct.y,U=gu(N,B,N+T,B+T,d);ct.bbox[0]=U.x1,ct.bbox[1]=U.y1,ct.bbox[2]=U.x3,ct.bbox[3]=U.y3}var z=0,X=0,H=a,G=s;if(A.length){var j=A[0],Y=A[A.length-1];z=j.bbox[0],X=j.bbox[1],H=Y.bbox[2],G=Y.bbox[3]}var W=Date.now(),V=vE(e,t,r,n,z,X,H,G,W),q=V.mergeRecord,K=V.breakMerge,Z=Object.keys(c);for(P=0,D=Z.length;P<D;P++){if((ve=c[Z[P]])&&ve.hasContent&&ve.computedStyle.maskMode!==Zs.ALPHA){var J=ve.matrixWorld;if(yE(U=ve.filterBbox,J,z,X,H-z,G-X))for(var Q=gu(U[0],U[1],U[2],U[3],J),$=0,ee=A.length;$<ee;$++){var te=(ct=A[$]).bbox;ic(te[0],te[1],te[2],te[3],[{x:Q.x1,y:Q.y1},{x:Q.x2,y:Q.y2},{x:Q.x3,y:Q.y3},{x:Q.x4,y:Q.y4}])&&(ct.clean(),F=!1)}}}t.tileRecord={};for(P=0,D=q.length;P<D;P++){var re=q[P];if(yE(U=re.bbox,J=re.m,z,X,H-z,G-X)){Q=gu(U[0],U[1],U[2],U[3],J),$=0;for(var ne=A.length;$<ne;$++){var ie=(ct=A[$]).bbox;ct.count&&ic(ie[0],ie[1],ie[2],ie[3],[{x:Q.x1,y:Q.y1},{x:Q.x2,y:Q.y2},{x:Q.x3,y:Q.y3},{x:Q.x4,y:Q.y4}])&&(ct.clean(),F=!1)}}}var oe=t.overlay,ae=!1;if(!F){var se=!0,le=void 0,ue=vu(d),ce=Rx.UNIT*l,he=.5*ce;if(t.tileLastIndex){var de=(ve=i[t.tileLastIndex].node).artBoard;if(de&&ve!==de){var fe=de.struct;if((ge=fe.total)+(me=fe.next))I[(P=i.indexOf(de.struct))+ge+me]=de}}for(P=0,D=A.length;P<D;P++){!(ct=A[P]).count&&!ct.complete&&ct.texture&&ct.needClear&&(ct.needClear=!1,le?e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ct.texture,0):le=wE(e,ct.texture,ce,ce),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT))}for(P=t.tileLastIndex,D=i.length;P<D;P++){var pe=i[P],ve=pe.node,ge=pe.total,me=pe.next;if(oe===ve)break;var ye=ve.computedStyle,be=FE(ve,ye,n),xe=be.shouldIgnore;if(be.isBgBlur,xe)I[P+=ge+me]&&NE(A);else{var we=ve.parent,_e=ve.textureTarget;UE(ve,P,we);var Ee=ve._opacity,Se=ve._matrixWorld,Ce=_e[n],ke=!1;if(Ce&&Ce.available?ke=yE(Ce.bbox,Se,z,X,H-z,G-X):(ke=yE(ve._filterBbox||ve.filterBbox,Se,z,X,H-z,G-X))&&ve.hasContent&&ve.computedStyle.maskMode!==Zs.ALPHA&&(ve.genTexture(e,r,n),Ce=_e[n]),ke&&ve.isBitmap&&ve.checkLoader()&&u.push(ve),ke){if(!se&&Date.now()-W>ms.deltaTime){ae=!0,t.tileLastIndex=P;break}var Te=Ce&&Ce.available||!1,Ae=ye.mixBlendMode,Me=(Q=gu((U=Te?Ce.bbox:ve._filterBbox||ve.filterBbox)[0],U[1],U[2],U[3],Se),J=iu(ue,Se),p*l);if(1!==Me)fu(Ge=ru(),Me),J=iu(Ge,J);var Oe=Te&&1===Ce.list.length?Tx(U,he,he,0,0,!1,J):void 0,Le=[],Re=void 0,Ie=ve.isArtBoard&&ve instanceof qx;if(Ie){var Fe=ve._bbox||ve.bbox;Re=gu(Fe[0],Fe[1],Fe[2],Fe[3],J),I[P+ge+me]=ve}$=0;for(var Pe=A.length;$<Pe;$++){var De=(ct=A[$]).bbox;if(Ie&&(ct.x1=(Re.x1-ct.x*Me-he)/he,ct.y1=(Re.y1-ct.y*Me-he)/he,ct.x2=(Re.x3-ct.x*Me-he)/he,ct.y2=(Re.y3-ct.y*Me-he)/he),(ve.hasContent||Ie)&&!ct.complete&&!ct.has(ve)&&ic(De[0],De[1],De[2],De[3],[{x:Q.x1,y:Q.y1},{x:Q.x2,y:Q.y2},{x:Q.x3,y:Q.y3},{x:Q.x4,y:Q.y4}]))if(ve.addTile(ct),ct.add(ve),Te||Ie)if(!(ct.x1>1||ct.y1>1||ct.x2<-1||ct.y2<-1))if(se&&(se=!1),le?e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,ct.texture,0):le=wE(e,ct.texture,ce,ce),0===ct.count&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),Ie)ve.renderBgcTile(e,he,M,O,Me,ct,Re);else{var Ne=void 0;Ae!==Hs.NORMAL&&(Ne=fx(e,0,void 0,ce,ce),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Ne,0));var Be=Ce.list;if(1===Be.length)vx(e,he,he,R,[{opacity:Ee,bbox:U,coords:Oe,texture:Be[0].t}],-ct.x*Me/he,-ct.y*Me/he,!1,ct.x1,ct.y1,ct.x2,ct.y2);else if(Be.length>1)for(var Ue=0,ze=Be.length;Ue<ze;Ue++){var Xe=Be[Ue],He=Xe.bbox,Ge=Xe.t,je=gu(He[0],He[1],He[2],He[3],Se);ic(De[0],De[1],De[2],De[3],[{x:je.x1,y:je.y1},{x:je.x2,y:je.y2},{x:je.x3,y:je.y3},{x:je.x4,y:je.y4}])&&(Le[Ue]=Le[Ue]||Tx(He,he,he,0,0,!1,J),vx(e,he,he,R,[{opacity:Ee,bbox:He,coords:Le[Ue],texture:Ge}],-ct.x*Me/he,-ct.y*Me/he,!1,ct.x1,ct.y1,ct.x2,ct.y2))}if(Ae!==Hs.NORMAL){Ge=LE(e,ct.texture,Ne,Ae,L,ce,ce);ct.updateTex(Ge)}}}}Ce&&Ce.available&&Ce!==ve.textureCache[n]||ye.maskMode?P+=ge+me:ve.isShapeGroup&&(P+=ge),I[P]&&NE(A)}}le&&_E(e,le,a,s)}for(P=0,D=A.length;P<D;P++){if((ct=A[P]).available&&ct.count)vx(e,M,O,R,[{opacity:1,bbox:ct.bbox,texture:ct.texture}],0,0,!0,-1,-1,1,1);else{var Ye=ct.x,We=ct.y,Ve=g.getDowngrade(p,Ye,We);if(Ve&&Ve.length){$=0;for(var qe=Ve.length;$<qe;$++){var Ke=Ve[$],Ze=Ke.scale/p;if(Ze<1){var Je=(Ye-Ke.tile.x)/Ke.tile.size,Qe=(We-Ke.tile.y)/Ke.tile.size;vx(e,M,O,R,[{opacity:1,bbox:ct.bbox,texture:Ke.tile.texture,tc:{x1:Je,y1:Qe,x3:Je+Ze,y3:Qe+Ze}}],0,0,!0,-1,-1,1,1)}else if(Ze>1){var $e=(Ke.tile.x-Ye)/ct.size,et=(Ke.tile.y-We)/ct.size,tt=(U=ct.bbox)[2]-U[0],rt=U[3]-U[1],nt=U[0]+$e*tt,it=U[1]+et*rt;vx(e,M,O,R,[{opacity:1,bbox:new Float64Array([nt,it,nt+tt/Ze,it+rt/Ze]),texture:Ke.tile.texture}],0,0,!0,-1,-1,1,1)}}}}ae||(ct.complete=!0)}if(ms.debug){var ot=L.tileProgram;e.useProgram(ot);var at=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,at),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var st=e.getAttribLocation(ot,"a_position");e.vertexAttribPointer(st,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(st);var lt=e.getUniformLocation(ot,"u_width");e.uniform1f(lt,1/M);var ut=e.getUniformLocation(ot,"u_height");e.uniform1f(ut,1/O);for(P=0,D=A.length;P<D;P++){var ct=A[P],ht=e.getUniformLocation(ot,"u_x1");e.uniform1f(ht,(ct.bbox[0]-M)/M);var dt=e.getUniformLocation(ot,"u_y1");e.uniform1f(dt,(O-ct.bbox[3])/O);var ft=e.getUniformLocation(ot,"u_x2");e.uniform1f(ft,(ct.bbox[2]-M)/M);var pt=e.getUniformLocation(ot,"u_y2");e.uniform1f(pt,(O-ct.bbox[1])/O);var vt=e.getUniformLocation(ot,"u_count");e.uniform1i(vt,ct.count),e.drawArrays(e.TRIANGLE_STRIP,0,4)}e.deleteBuffer(at),e.disableVertexAttribArray(st),e.useProgram(R)}XE(e,M,O,a,s,t,!0),ae&&(t.tileRemain=!0,t.addUpdate(t,[],Qb.CACHE,!1,!1,void 0));K&&K.length&&(t.tileLastIndex=0);if(K&&K.length)for(P=0,D=K.length;P<D;P++)t.addUpdate(K[P].node,[],Qb.CACHE,!1,!1,void 0)}(e,t,r,n):BE(e,t,r,n);for(var s=0,l=o.length;s<l;s++)o[s].loadAndRefresh();o.splice(0)}function NE(e){e.forEach((function(e){e.x1=e.y1=-1,e.x2=e.y2=1}))}function BE(e,t,r,n){var i,o=t.structs,a=t.width,s=t.height,l=t.imgLoadList,u=vE(e,t,r,n,0,0,a,s,Date.now()).breakMerge,c=.5*a,h=.5*s,d=t.programs,f=[],p=t.pageTexture||fx(e,0,void 0,a,s),v=p,g=wE(e,v,a,s);e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);var m=t.overlay,y=d.program;e.useProgram(d.program);for(var b=-1,x=-1,w=1,_=1,E=0,S=o.length;E<S;E++){var C=o[E],k=C.node,T=C.total,A=C.next;if(m===k)break;var M=k.computedStyle,O=FE(k,M,n),L=O.shouldIgnore,R=O.isBgBlur;if(L)f[E+=T+A]&&(b=x=-1,w=_=1,v=zE(e,y,c,h,a,s,p,v));else{var I=k.parent,F=k.textureTarget;UE(k,E,I);var P=k._opacity,D=k._matrixWorld,N=F[n],B=!1;if(N&&N.available?B=mE(N.bbox,D,a,s):(B=mE(k._filterBbox||k.filterBbox,D,a,s))&&k.hasContent&&k.computedStyle.maskMode!==Zs.ALPHA&&(k.genTexture(e,r,n),N=F[n]),B){if(k.isArtBoard&&k instanceof qx&&(k.renderBgc(e,c,h),T+A)){f[E+T+A]=k;var U=gu((J=k._bbox||k.bbox)[0],J[1],J[2],J[3],D);b=(U.x1-c)/c,x=(U.y1-h)/h,w=(U.x3-c)/c,_=(U.y3-h)/h,i=fx(e,0,void 0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),v=i}k.isBitmap&&k.checkLoader()&&l.push(k)}if(B&&N&&N.available){var z=M.mixBlendMode,X=M.blur;if(R&&E){var H=k.textureOutline[r]=IE(e,k,o,E,T,N.bbox,r),G=a/t.dpi,j=s/t.dpi,Y=Yx.getEmptyInstance(e,new Float64Array([0,0,G,j]));Y.list.push({bbox:new Float64Array([0,0,G,j]),w:a,h:s,t:v});var W=v===p;RE(e,t,Y,D,H,X,d,r,a,s),v=Y.list[0].t,W&&(p=v),e.bindFramebuffer(e.FRAMEBUFFER,g),e.viewport(0,0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0)}var V=void 0;z!==Hs.NORMAL&&(V=fx(e,0,void 0,a,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,V,0));for(var q=N.list,K=0,Z=q.length;K<Z;K++){var J,Q=q[K];vx(e,c,h,y,[{opacity:P,matrix:D,bbox:J=Q.bbox,texture:Q.t}],0,0,!1,b,x,w,_)}z!==Hs.NORMAL&&(v=LE(e,v,V,z,d,a,s))}(null==N?void 0:N.available)&&N!==k.textureCache[n]||M.maskMode?E+=T+A:k.isShapeGroup&&(E+=T),f[E]&&(b=x=-1,w=_=1,v=zE(e,y,c,h,a,s,p,v))}}if(XE(e,c,h,a,s,t,!1),_E(e,g,a,s),vx(e,c,h,y,[{opacity:1,bbox:new Float64Array([0,0,a,s]),texture:v}],0,0,!0,-1,-1,1,1),t.pageTexture=v,u&&u.length)for(E=0,S=u.length;E<S;E++)t.addUpdate(u[E].node,[],Qb.CACHE,!1,!1,void 0)}function UE(e,t,r){var n=!1,i=!1;t?(n=e.hasCacheOp&&e.parentOpId===r.localOpId,i=e.hasCacheMw&&e.parentMwId===r.localMwId):(n=e.hasCacheOp,i=e.hasCacheMw),n||(e._opacity=r?r._opacity*e.computedStyle.opacity:e.computedStyle.opacity,r&&(e.parentOpId=r.localOpId),e.hasCacheOp=!0),i||(su(e._matrixWorld,r?iu(r._matrixWorld,e.matrix):e.matrix),r&&(e.parentMwId=r.localMwId),e.hasCacheMw&&e.localMwId++,e.hasCacheMw=!0)}function zE(e,t,r,n,i,o,a,s){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),vx(e,r,n,t,[{opacity:1,bbox:new Float64Array([0,0,i,o]),texture:s}],0,0,!1,-1,-1,1,1),e.deleteTexture(s),a}function XE(e,t,r,n,i,o,a){var s=o.overlay,l=o.structs,u=o.programs;s.update();for(var c=l.indexOf(s.struct),h=u.program,d=c,f=l.length;d<f;d++){var p=(A=l[d].node).parent,v=A.textureTarget;UE(A,d,p);var g=A._opacity,m=A._matrixWorld,y=v[0];if(!y&&A.hasContent&&(A.genTexture(e,1,0),y=v[0]),y&&y.available)if(mE(y.bbox,m,n,i))for(var b=y.list,x=0,w=b.length;x<w;x++){var _=b[x];vx(e,t,r,h,[{opacity:g,matrix:m,bbox:_.bbox,texture:_.t}],0,0,a,-1,-1,1,1)}}var E=u.sliceProgram;e.useProgram(E);var S=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,S),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),e.STATIC_DRAW);var C=e.getAttribLocation(E,"a_position");e.vertexAttribPointer(C,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(C);var k=e.getUniformLocation(E,"u_width");e.uniform1f(k,1/t);var T=e.getUniformLocation(E,"u_height");e.uniform1f(T,1/r);for(d=0;d<c;d++){var A;if((A=l[d].node).isSlice&&A instanceof g_){m=A._matrixWorld;if(mE(A._rect||A.rect,m,n,i)){var M=A.getBoundingClientRect({excludeRotate:!0}),O=e.getUniformLocation(E,"u_x1");e.uniform1f(O,(M.left-t)/t);var L=e.getUniformLocation(E,"u_x2");e.uniform1f(L,(M.right-t)/t);var R=e.getUniformLocation(E,"u_y1"),I=e.getUniformLocation(E,"u_y2");a?(e.uniform1f(I,(r-M.top)/r),e.uniform1f(R,(r-M.bottom)/r)):(e.uniform1f(R,(M.top-r)/r),e.uniform1f(I,(M.bottom-r)/r)),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}}e.deleteBuffer(S),e.disableVertexAttribArray(C),e.useProgram(h)}var HE=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.artBoards=new Vx({name:"overlay-artBoards",uuid:"",index:0,style:{width:"100%",height:"100%",pointerEvents:!1}},[]),n.appendChild(n.artBoards),n.artBoardList=[],n}return v(t,e),t.prototype.setArtBoard=function(e){this.artBoards.clearChildren(),this.artBoardList.splice(0);for(var t=0,r=e.length;t<r;t++){var n=e[t],i="overlay-"+(n.props.name||""),o=new f_({name:i,uuid:"",index:0,style:{fontSize:24,color:n instanceof u_?"#b6e":"#777"},content:n.props.name||""});this.artBoards.appendChild(o),this.artBoardList.push({artBoard:n,text:o})}},t.prototype.updateArtBoard=function(e){for(var t=this.artBoardList,r=0,n=t.length;r<n;r++)if(t[r].artBoard===e){t[r].text.content=e.props.name||"";break}},t.prototype.update=function(){for(var e=this.artBoardList,t=0,r=e.length;t<r;t++){var n=e[t],i=n.artBoard,o=n.text,a=i._rect||i.rect,s=pu({x:a[0],y:a[1]},i.matrixWorld);o.updateStyleData({translateX:s.x,translateY:s.y-32}).length&&o.calMatrix(Qb.TRANSLATE)}},t}(Vx),GE=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this,t,r)||this;return n.ani=[],n.aniChange=!1,n.dpi=t.dpi,n.root=n,n.programs={},n.refs={},n.symbolMasters={},n.structs=[],n.isAsyncDraw=!1,n.task=[],n.taskClone=[],n.rl=Qb.REBUILD,n.imgLoadingCount=0,n.imgLoadList=[],n.firstDraw=!0,n.tileRecord={},n.tileLastIndex=0,n.tileRemain=!1,n.breakMerge=!1,n.scale=1,n.scaleIndex=0,n.pageContainer=new Vx({name:"pageContainer",uuid:"pageContainer",index:0,style:{width:"100%",height:"100%",pointerEvents:!1,scaleX:n.dpi,scaleY:n.dpi,transformOrigin:[0,0]}},[]),n.overlay=new HE({name:"overlay",uuid:"overlay",index:1,style:{width:"100%",height:"100%",pointerEvents:!1}},[]),n.appendChild(n.pageContainer),n.appendChild(n.overlay),n}return v(t,e),t.prototype.appendTo=function(e){this.canvas=e;var t=Object.assign(dE,this.props.contextAttributes),r=e.getContext("webgl2",t);if(r?this.isWebgl2=!0:(r=e.getContext("webgl",t),this.isWebgl2=!1),!r)throw new Error("Webgl unsupported!");this.appendToGl(r)},t.prototype.appendToGl=function(e){this.ctx?hl.error("Duplicate appendToGl"):(this.ctx=e,ms.init(e.getParameter(e.MAX_TEXTURE_SIZE),e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),e.getParameter(e.MAX_VARYING_VECTORS)),this.initShaders(e),this.tileManager=new Ix(e),this.willMount(),this.structs=this.structure(0),Ux.addRoot(this),this.reLayout(),this.didMount(),this.addUpdate(this,[],Qb.REFLOW))},t.prototype.initShaders=function(e){var t=this.programs.program=hx(e,"#define GLSLIFY 1\nattribute vec2 a_position;varying vec4 v_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;attribute float a_opacity;varying float v_opacity;void main(){gl_Position=vec4(a_position,0,1);v_position=gl_Position;v_texCoords=a_texCoords;v_opacity=a_opacity;}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;varying vec2 v_texCoords;varying float v_opacity;uniform float x1;uniform float y1;uniform float x2;uniform float y2;uniform sampler2D u_texture;void main(){if(v_position.x<x1||v_position.x>x2||v_position.y<y1||v_position.y>y2){discard;}float opacity=v_opacity;if(opacity<=0.0){discard;}opacity=clamp(opacity,0.0,1.0);vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color*opacity;}");this.programs.bgColorProgram=hx(e,"#define GLSLIFY 1\nattribute vec2 a_position;void main(){gl_Position=vec4(a_position,0,1);}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nuniform vec4 u_color;void main(){gl_FragColor=u_color;}"),this.programs.bgShadowProgram=hx(e,"#define GLSLIFY 1\nattribute vec2 a_position;varying vec2 v_position;void main(){gl_Position=vec4(a_position,0,1);v_position=a_position;}","#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nuniform vec2 u_tl;uniform vec2 u_br;uniform vec2 u_radius;uniform vec4 u_color;varying vec2 v_position;void main(){if(v_position.x<u_tl.x&&v_position.y<u_tl.y){float dx=abs(v_position.x-u_tl.x);float dy=abs(v_position.y-u_tl.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x<u_tl.x&&v_position.y>u_br.y){float dx=abs(v_position.x-u_tl.x);float dy=abs(v_position.y-u_br.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x>u_br.x&&v_position.y>u_br.y){float dx=abs(v_position.x-u_br.x);float dy=abs(v_position.y-u_br.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x>u_br.x&&v_position.y<u_tl.y){float dx=abs(v_position.x-u_br.x);float dy=abs(v_position.y-u_tl.y);if(dx<=u_radius.x&&dy<=u_radius.y){float ax=(u_radius.x-dx)/u_radius.x;float ay=(u_radius.y-dy)/u_radius.y;gl_FragColor=u_color*ax*ax*ay*ay;}}else if(v_position.x<u_tl.x){float d=abs(v_position.x-u_tl.x);if(d<=u_radius.x){float a=(u_radius.x-d)/u_radius.x;gl_FragColor=u_color*a*a;}}else if(v_position.y>u_br.y){float d=abs(v_position.y-u_br.y);if(d<=u_radius.y){float a=(u_radius.y-d)/u_radius.y;gl_FragColor=u_color*a*a;}}else if(v_position.x>u_br.x){float d=abs(v_position.x-u_br.x);if(d<=u_radius.x){float a=(u_radius.x-d)/u_radius.x;gl_FragColor=u_color*a*a;}}else if(v_position.y<u_tl.y){float d=abs(v_position.y-u_tl.y);if(d<=u_radius.y){float a=(u_radius.y-d)/u_radius.y;gl_FragColor=u_color*a*a;}}}"),this.programs.simpleProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color;}"),this.programs.maskProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a<=0.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}gl_FragColor=color2*color1.a;}"),this.programs.maskGrayProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a<=0.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}float gray=max(color1.r,max(color1.g,color1.b));gl_FragColor=color2*color1.a*gray;}"),this.programs.clipProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);if(color1.a>=1.0){discard;}vec4 color2=texture2D(u_texture2,v_texCoords);if(color2.a<=0.0){discard;}gl_FragColor=color2*(1.0-color1.a);}"),this.programs.multiplyProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return((1.0-a2/a3)*c1*255.0+a2/a3*((1.0-a1)*c2*255.0+a1*c3*255.0))/255.0;}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=bottom*top;float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.screenProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.overlayProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(top.r,bottom.r),op(top.g,bottom.g),op(top.b,bottom.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.darkenProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return min(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.lightenProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return max(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorDodgeProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==1.0){return a==0.0 ? a : 1.0;}return min(1.0,a/(1.0-b));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorBurnProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==0.0){return a==1.0 ? a : 0.0;}return 1.0-min(1.0,(1.0-a)/b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.hardLightProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.softLightProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5? a-(1.0-2.0*b)*a*(1.0-a): a+(2.0*b-1.0)*((a<=0.25?((16.0*a-12.0)*a+4.0)*a: sqrt(a))-a);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.differenceProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return abs(a-b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.exclusionProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-2.0*a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.hueProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(a);float l=getLuminosity(a);return setLuminosity(setSaturation(b,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.saturationProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(b);float l=getLuminosity(a);return setLuminosity(setSaturation(a,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.colorProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(a);return setLuminosity(b,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.luminosityProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(b);return setLuminosity(a,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}"),this.programs.dropShadowProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_color;void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a<=0.0){discard;}gl_FragColor=u_color*c.a;}"),this.programs.innerShadowProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_color;void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){discard;}gl_FragColor=u_color;}"),this.programs.tintProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform vec4 u_tint;void main(){vec4 color=texture2D(u_texture,v_texCoords);if(color.a<=0.0){discard;}gl_FragColor=u_tint*color.a;}"),this.programs.cmProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_m[20];void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){c.rgb/=c.a;}vec4 result;result.r=(u_m[0]*c.r);result.r+=(u_m[1]*c.g);result.r+=(u_m[2]*c.b);result.r+=(u_m[3]*c.a);result.r+=u_m[4];result.g=(u_m[5]*c.r);result.g+=(u_m[6]*c.g);result.g+=(u_m[7]*c.b);result.g+=(u_m[8]*c.a);result.g+=u_m[9];result.b=(u_m[10]*c.r);result.b+=(u_m[11]*c.g);result.b+=(u_m[12]*c.b);result.b+=(u_m[13]*c.a);result.b+=u_m[14];result.a=(u_m[15]*c.r);result.a+=(u_m[16]*c.g);result.a+=(u_m[17]*c.b);result.a+=(u_m[18]*c.a);result.a+=u_m[19];gl_FragColor=vec4(result.rgb*result.a,result.a);}"),this.programs.boxProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_pw;uniform float u_ph;uniform int u_r;uniform int u_direction;const int MAX_KERNEL_SIZE=2048;void main(){vec4 color=texture2D(u_texture,v_texCoords);float total=1.0;if(u_r==0){if(u_direction==0){color+=texture2D(u_texture,vec2(v_texCoords.x+u_pw,v_texCoords.y))*0.125;color+=texture2D(u_texture,vec2(v_texCoords.x-u_pw,v_texCoords.y))*0.125;}else{color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y+u_ph))*0.125;color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y-u_ph))*0.125;}total+=0.25;}else{for(int i=1;i<MAX_KERNEL_SIZE;i++){if(u_direction==0){float offset=float(i)*u_pw;color+=texture2D(u_texture,vec2(v_texCoords.x+offset,v_texCoords.y));color+=texture2D(u_texture,vec2(v_texCoords.x-offset,v_texCoords.y));}else{float offset=float(i)*u_ph;color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y+offset));color+=texture2D(u_texture,vec2(v_texCoords.x,v_texCoords.y-offset));}total+=2.0;if(i>=u_r){break;}}}gl_FragColor=color/total;}"),this.programs.dualDownProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform float u_x;uniform float u_y;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords)*4.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,u_y));color+=texture2D(u_texture,v_texCoords+vec2(u_x,-u_y));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,u_y));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,-u_y));gl_FragColor=color*0.125;}"),this.programs.dualUpProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform float u_x;uniform float u_y;uniform sampler2D u_texture;void main(){vec4 color=texture2D(u_texture,v_texCoords+vec2(u_x,u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,-u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(-u_x,u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(-u_x,-u_y)*0.5)*2.0;color+=texture2D(u_texture,v_texCoords+vec2(u_x,0.0));color+=texture2D(u_texture,v_texCoords+vec2(-u_x,0.0));color+=texture2D(u_texture,v_texCoords+vec2(0.0,u_y));color+=texture2D(u_texture,v_texCoords+vec2(0.0,-u_y));gl_FragColor=color/12.0;}"),this.programs.motionProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform int u_kernel;uniform vec2 u_velocity;const int MAX_KERNEL_SIZE=2048;void main(void){vec4 color=texture2D(u_texture,v_texCoords);int k=u_kernel-1;for(int i=1;i<MAX_KERNEL_SIZE-1;i++){if(i==k){break;}vec2 bias=u_velocity*(float(i)/float(k)-0.5);color+=texture2D(u_texture,v_texCoords+bias);}gl_FragColor=color/float(k);}"),this.programs.radialProgram=hx(e,fE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform int u_kernel;uniform vec2 u_center;uniform float u_ratio;const int MAX_KERNEL_SIZE=2048;void main(void){if(v_texCoords.x==u_center.x&&v_texCoords.y==u_center.y){gl_FragColor=texture2D(u_texture,v_texCoords);return;}vec4 color=texture2D(u_texture,v_texCoords);int k=u_kernel-1;float total=1.0;for(int i=1;i<MAX_KERNEL_SIZE-1;i++){if(i==k){break;}total++;vec2 velocity=-(v_texCoords-u_center)*u_ratio;vec2 bias=velocity*(float(i)/float(k));color+=texture2D(u_texture,v_texCoords+bias);}gl_FragColor=color/total;}"),this.programs.tileProgram=hx(e,pE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;uniform float u_x1;uniform float u_y1;uniform float u_x2;uniform float u_y2;uniform float u_width;uniform float u_height;uniform int u_count;void main(){if(v_position.x>u_x1+u_width&&v_position.x<u_x2-u_width&&v_position.y>u_y1+u_height&&v_position.y<u_y2-u_height){if(u_count==0){gl_FragColor+=vec4(0.0,0.0,0.5,0.1);}else{gl_FragColor+=vec4(0.0,0.0,0.0,0.1);}}if(v_position.x>=u_x1-u_width&&v_position.x<=u_x1+u_width&&v_position.y>=u_y1&&v_position.y<=u_y2){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.x>=u_x2-u_width&&v_position.x<=u_x2+u_width&&v_position.y>=u_y1&&v_position.y<=u_y2){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.y>=u_y1-u_height&&v_position.y<=u_y1+u_height&&v_position.x>=u_x1+u_width&&v_position.x<=u_x2-u_width){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}if(v_position.y>=u_y2-u_height&&v_position.y<=u_y2+u_height&&v_position.x>=u_x1+u_width&&v_position.x<=u_x2-u_width){gl_FragColor+=vec4(0.5,0.0,0.0,0.2);}}"),this.programs.sliceProgram=hx(e,pE,"#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec4 v_position;uniform float u_x1;uniform float u_y1;uniform float u_x2;uniform float u_y2;uniform float u_width;uniform float u_height;void main(){if(v_position.x>=u_x1&&v_position.x<=u_x1+u_width*2.0&&v_position.y>=u_y1&&v_position.y<=u_y2){if(v_position.y<=u_y1+u_height*2.0||v_position.y>=u_y2-u_height*2.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int y=int((v_position.y-u_y1+u_height)/u_height);int p=int(y/12);if(y-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.x>=u_x2-u_width*2.0&&v_position.x<=u_x2&&v_position.y>=u_y1&&v_position.y<=u_y2){if(v_position.y<u_y1+u_height*2.0||v_position.y>u_y2-u_height*2.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int y=int((v_position.y-u_y1+u_height)/u_height);int p=int(y/12);if(y-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.y>=u_y1&&v_position.y<=u_y1+u_height*2.0&&v_position.x>=u_x1+u_width*2.0&&v_position.x<=u_x2-u_width*2.0){if(v_position.x<u_x1+u_width*4.0||v_position.x>u_x2-u_width*4.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int x=int((v_position.x-u_x1+u_width)/u_width);int p=int(x/12);if(x-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}if(v_position.y>=u_y2-u_height*2.0&&v_position.y<=u_y2&&v_position.x>=u_x1+u_width*2.0&&v_position.x<=u_x2-u_width*2.0){if(v_position.x<u_x1+u_width*4.0||v_position.x>u_x2-u_width*4.0){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}else{int x=int((v_position.x-u_x1+u_width)/u_width);int p=int(x/12);if(x-p*12>=6){gl_FragColor+=vec4(0.0,0.0,0.0,0.2);}}}}"),e.useProgram(t)},t.prototype.checkRoot=function(){var e,t=this.style,r=t.width,n=t.height,i=this.canvas;r.u===Us.AUTO?i&&(r.u=Us.PX,this.width=this.computedStyle.width=r.v=Math.max(1,i.width)):this.width=this.computedStyle.width=Math.max(1,this.style.width.v),n.u===Us.AUTO?i&&(n.u=Us.PX,this.height=this.computedStyle.height=n.v=Math.max(1,i.height)):this.height=this.computedStyle.height=Math.max(1,this.style.height.v),null===(e=this.ctx)||void 0===e||e.viewport(0,0,this.width,this.height)},t.prototype.setJPages=function(e){var t=this;e.forEach((function(e){var r=new __(e.props,[]);r.json=e,t.pageContainer.appendChild(r)}))},t.prototype.getPageIndex=function(){for(var e=this.pageContainer.children,t=0,r=e.length;t<r;t++)if(this.lastPage===e[t])return t;return-1},t.prototype.setPageIndex=function(e){if(!(e<0||e>=this.pageContainer.children.length)){if(this.lastPage){if(this.lastPage===this.pageContainer.children[e])return;this.lastPage.updateStyle({visibility:"hidden"})}this.lastPage=void 0;var t=this.pageContainer.children[e];t.initIfNot(),t.updateStyle({visibility:"visible"}),this.lastPage=t;var r=[];return t.children.forEach((function(e){e instanceof qx&&r.push(e)})),this.overlay.setArtBoard(r),t}},t.prototype.addUpdate=function(e,t,r,n,i,o){if(void 0===r&&(r=Qb.NONE),void 0===n&&(n=!1),void 0===i&&(i=!1),this.isDestroyed)return Qb.NONE;e===this&&this.pageTexture&&(t.indexOf("width")>-1||t.indexOf("height")>-1)&&(this.ctx.deleteTexture(this.pageTexture),this.pageTexture=void 0);var a=r;if(t&&t.length)for(var s=0,l=t.length;s<l;s++){a|=nx(t[s])}if(i)if(e instanceof __)this.emit(Dx.WILL_REMOVE_PAGE,e);else{this.emit(Dx.WILL_REMOVE_DOM,e);var u=e.props.uuid;u&&this.tileRecord[u]&&delete this.tileRecord[u]}return(n||i)&&(a|=Qb.REFLOW|Qb.REBUILD),this.calUpdate(e,a,n,i)?this.asyncDraw(o):(o&&o(!0),this.imgLoadingCount||this.breakMerge||this.tileRemain||this.emit(Dx.REFRESH_COMPLETE,Qb.NONE)),this.lastPage&&e.page&&(n?e instanceof __?this.emit(Dx.DID_ADD_PAGE,e):this.emit(Dx.DID_ADD_DOM,e):!i&&t.length&&this.emit(Dx.STYLE_CHANGED,e,t)),a},t.prototype.calUpdate=function(e,t,r,n){if(t===Qb.NONE||this.isDestroyed)return!1;var i=ms.tile&&!this.firstDraw&&!e.isPage;if(i&&t>Qb.CACHE&&Rx.clean(e.cleanTile()),tx(t))e===this?this.reLayout():(cE(e,r,n),i&&r&&(this.tileRecord[e.props.uuid]=e));else{if(t>=Qb.REPAINT)e.calRepaintStyle(t);else{var o=e.style,a=e.computedStyle;t&Qb.TRANSFORM_ALL&&e.calMatrix(t),t&(Qb.TRANSLATE|Qb.ROTATE_Z)&&(e.checkPosSizeUpward(),i&&(this.tileRecord[e.props.uuid]=e)),t&Qb.OPACITY&&e.calOpacity(),t&Qb.FILTER&&(e.calFilter(t),i&&(this.tileRecord[e.props.uuid]=e)),t&Qb.MIX_BLEND_MODE&&(a.mixBlendMode=o.mixBlendMode.v);var s=!1;if(t&Qb.MASK&&(a.maskMode=o.maskMode.v,e.clearMask(!0),s=!0,e.checkPosSizeUpward(),e.calMask(),i))for(var l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Zs.NONE;)a.maskMode!==Zs.NONE?Rx.clean(l.cleanTile()):this.tileRecord[l.props.uuid]=l,l=l.next;if(t&Qb.BREAK_MASK){a.breakMask=o.breakMask.v;var u=e.mask;e.calMask();var c=e.mask;if(a.breakMask&&u){if(u.clearMask(!0),u.checkPosSizeUpward(),i&&!a.maskMode){this.tileRecord[e.props.uuid]=e;for(l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Zs.NONE;)this.tileRecord[l.props.uuid]=l,l=l.next}}else if(!a.breakMask&&c){if(i&&!a.maskMode){Rx.clean(e.cleanTile());for(l=e.next;l&&!l.computedStyle.breakMask&&l.computedStyle.maskMode===Zs.NONE;)Rx.clean(l.cleanTile()),l=l.next}}else t&=Qb.FULL^Qb.BREAK_MASK;if(!a.breakMask||u)for(var h=e.prev;h;){if(h.computedStyle.maskMode){h.clearMask(!0);break}if(h.computedStyle.breakMask)break;h=h.prev}}a.maskMode&&!s&&t>Qb.CACHE&&e.clearMask(!0)}e.clearCacheUpward(!1)}var d=e.mask;if(!(d&&t>Qb.CACHE)||t&Qb.MASK||t&Qb.BREAK_MASK||(d.checkPosSizeUpward(),d.clearMask()),e.refreshLevel|=t,this.rl|=t,t&Qb.CACHE)return!0;for(var f=e.parent;f;){if(f.computedStyle.visibility===tl.HIDDEN)return!1;f=f.parent}return t>Qb.NONE},t.prototype.asyncDraw=function(e){this.isAsyncDraw||(Ux.onFrame(this),this.isAsyncDraw=!0),this.task.push(e)},t.prototype.cancelAsyncDraw=function(e){if(e){var t=this.task,r=t.indexOf(e);r>-1&&(t.splice(r,1),t.length||(Ux.offFrame(this),this.isAsyncDraw=!1))}},t.prototype.draw=function(){if(!this.isDestroyed){this.tileRemain=!1,this.breakMerge=!1;var e=this.rl;e>Qb.NONE&&(e>Qb.CACHE&&(this.tileLastIndex=0),this.clear(),this.rl=Qb.NONE,DE(this.ctx,this),this.emit(Dx.REFRESH,e),this.firstDraw=!1),this.imgLoadingCount||this.breakMerge||this.tileRemain||this.emit(Dx.REFRESH_COMPLETE,e)}},t.prototype.reLayout=function(){this.checkRoot(),this.layout({w:this.width,h:this.height})},t.prototype.clear=function(){var e=this.ctx;e&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT))},t.prototype.destroy=function(){var t;e.prototype.destroy.call(this),Ux.removeRoot(this),this.task.splice(0),this.taskClone.splice(0);var r=this.ctx,n=this.programs;if(r){for(var i in r.deleteProgram(n.program),r.deleteProgram(n.bgColorProgram),r.deleteProgram(n.bgShadowProgram),r.deleteProgram(n.simpleProgram),r.deleteProgram(n.maskProgram),r.deleteProgram(n.maskGrayProgram),r.deleteProgram(n.clipProgram),r.deleteProgram(n.multiplyProgram),r.deleteProgram(n.screenProgram),r.deleteProgram(n.overlayProgram),r.deleteProgram(n.darkenProgram),r.deleteProgram(n.lightenProgram),r.deleteProgram(n.colorDodgeProgram),r.deleteProgram(n.colorBurnProgram),r.deleteProgram(n.hardLightProgram),r.deleteProgram(n.softLightProgram),r.deleteProgram(n.differenceProgram),r.deleteProgram(n.exclusionProgram),r.deleteProgram(n.hueProgram),r.deleteProgram(n.saturationProgram),r.deleteProgram(n.colorProgram),r.deleteProgram(n.luminosityProgram),r.deleteProgram(n.dropShadowProgram),r.deleteProgram(n.innerShadowProgram),r.deleteProgram(n.gaussBlurProgram),r.deleteProgram(n.tintProgram),r.deleteProgram(n.cmProgram),r.deleteProgram(n.boxProgram),r.deleteProgram(n.dualDownProgram),r.deleteProgram(n.dualUpProgram),r.deleteProgram(n.motionProgram),r.deleteProgram(n.radialProgram),r.deleteProgram(n.tileProgram),r.deleteProgram(n.sliceProgram),r)if(0===i.indexOf("programGauss,")){var o=n[i];r.deleteProgram(o)}r.bindTexture(r.TEXTURE_2D,null),null===(t=r.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext()}},t.prototype.before=function(){var e=this.ani,t=this.taskClone=this.task.splice(0);e.length;var r=t.length;this.aniChange=!1,(this.aniChange||r)&&this.draw()},t.prototype.after=function(){for(var e=this.ani,t=this.taskClone.splice(0),r=e.length,n=t.length,i=0;i<r;i++);for(i=0;i<n;i++){var o=t[i];o&&o(!1)}r=e.length,n=this.task.length,r||n||(Ux.offFrame(this),this.isAsyncDraw=!1)},t.prototype.getPages=function(){return this.pageContainer.children},t.prototype.getCurPage=function(){return this.lastPage},t.prototype.setCurPage=function(e){var t=this.pageContainer.children.indexOf(e);this.setPageIndex(t)},t.prototype.getCurPageStructs=function(){var e=this.structs,t=this.lastPage;if(t){var r=t.struct,n=e.indexOf(r);if(-1===n)throw new Error("Unknown index error");return e.slice(n,n+r.total+1)}},t.prototype.getCurPageZoom=function(e){return void 0===e&&(e=!1),this.lastPage?this.lastPage.getZoom(e):this.dpi},t.prototype.zoomTo=function(e,t,r){var n;null===(n=this.lastPage)||void 0===n||n.zoomTo(e,t,r)},t.prototype.zoomActual=function(){var e;return null===(e=this.lastPage)||void 0===e?void 0:e.zoomActual()},t.prototype.zoomFit=function(){var e;return null===(e=this.lastPage)||void 0===e?void 0:e.zoomFit()},t.prototype.toSketchFile=function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,l,u,c,h,d,f;return Q(this,(function(p){switch(p.label){case 0:return this.isDestroyed&&(this.willMount(),this.reLayout(),this.didMount()),t=new vs,r=t.folder("pages"),n=t.folder("images"),i=this.props,o={},a=[],l={document:{pageListHeight:100,pageListCollapsed:0}},this.pageContainer.children.forEach((function(e){var t=e,r=t.props.uuid;a.push({_class:"MSJSONFileReference",_ref_class:"MSImmutablePage",_ref:"pages/"+r}),l[r]={scrollOrigin:"{"+t.computedStyle.translateX+", "+t.computedStyle.translateY+"}",zoomValue:t.getZoom(!0)},o[r]={name:t.props.name||"",artboards:{}},t.children.forEach((function(e){if(e instanceof qx){var t=e.props.uuid;o[r].artboards[t]={name:e.props.name||""}}}))})),r&&n?[4,Promise.all(this.pageContainer.children.map((function(r){return r.toSketchJson(t,e)})))]:[3,2];case 1:p.sent().forEach((function(e){r.file(e.do_objectID+".json",JSON.stringify(e))})),p.label=2;case 2:return u={commit:"",pagesAndArtboards:o,version:146,compatibilityVersion:99,app:$.BundleId.PublicRelease,autosaved:0,variant:"NONAPPSTORE",created:{commit:"",appVersion:"99.1",build:0,app:$.BundleId.PublicRelease,coeditCompatibilityVersion:145,compatibilityVersion:99,version:146,variant:"NONAPPSTORE"},saveHistory:[],appVersion:"99.1",build:0},c={_class:"document",do_objectID:i.uuid||s(),assets:{_class:"assetCollection",do_objectID:(null===(h=i.assets)||void 0===h?void 0:h.uuid)||s(),colorAssets:[],gradientAssets:[],images:[],colors:[],gradients:[],exportPresets:[]},colorSpace:$.ColorSpace.Unmanaged,currentPageIndex:this.getPageIndex(),foreignLayerStyles:[],foreignSymbols:[],foreignTextStyles:[],foreignSwatches:[],layerStyles:{_class:"sharedStyleContainer",do_objectID:(null===(d=i.layerStyles)||void 0===d?void 0:d.uuid)||s(),objects:[]},layerTextStyles:{_class:"sharedTextStyleContainer",do_objectID:(null===(f=i.layerTextStyles)||void 0===f?void 0:f.uuid)||s(),objects:[]},perDocumentLibraries:[],pages:a},t.file("meta.json",JSON.stringify(u)),t.file("user.json",JSON.stringify(l)),t.file("document.json",JSON.stringify(c)),[2,t]}}))}))},t}(Vx),jE={ArtBoard:qx,Bitmap:Qx,Container:Vx,Group:l_,Node:Wx,Page:__,Root:GE,Slice:g_,SymbolInstance:v_,SymbolMaster:u_,Text:f_,Geom:iw,Polyline:pw,ShapeGroup:uE,reflow:hE,parser:w_};function YE(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,v,g){void 0===g&&(g=!1);var m=v.fontFamily,y=v.color,b=v.fontSize,x=v.letterSpacing,w=v.lineHeight,_=v.paragraphSpacing,E=v.textAlign;n.includes(m)||n.push(m);var S=Hl.data[m];if(S){i.includes(S.family)||(i.push(S.family),o.push(S.name)),r.includes(!0)||r.push(!0);for(var C=S.list,k=0,T=C.length;k<T;k++){var A=C[k];if(A.postscriptName===m){l.includes(A.style)||l.push(A.style);break}}}else i.includes(m)||(i.push(m),o.push(m)),r.includes(!1)||r.push(!1);var M=Mc(y);a.includes(M)||a.push(M),s.includes(b)||s.push(b),u.includes(x)||u.push(x);var O=g?!w:t.u===Us.AUTO;if(h.includes(O)||h.push(O),O&&S){var L=b*S.lhr;c.includes(L)||c.push(L)}else c.includes(w)||c.push(w);d.includes(_)||d.push(_),f.includes(E)||f.push(E);var R=WE(e);p.includes(R)||p.push(R)}function WE(e){var t=e.style,r=t.left,n=t.right,i=t.top,o=t.bottom,a=t.width,s=t.height,l=rl.AUTO,u=a.u===Us.AUTO&&(r.u===Us.AUTO||n.u===Us.AUTO),c=s.u===Us.AUTO&&(i.u===Us.AUTO||o.u===Us.AUTO);return u&&c||(l=c?rl.FIXED_W:rl.FIXED_W_H),l}function VE(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],u=[],c=[],h=[],d=[],f=[],p=[],v=0,g=e.length;v<g;v++){var m=e[v],y=m.rich,b=m.style,x=m.computedStyle;d.includes(x.textVerticalAlign)||d.push(x.textVerticalAlign);var w=b.lineHeight;if(y&&y.length)for(var _=0,E=y.length;_<E;_++)YE(m,w,t,r,n,i,o,a,p,s,l,u,c,h,f,y[_],!0);else YE(m,w,t,r,n,i,o,a,p,s,l,u,c,h,f,x)}var S=[];return 1===n.length&&(S=qE(n[0])),{valid:t,postscriptName:r,fontFamily:n,name:i,fontWeight:p,fontWeightList:S,color:o,fontSize:a,autoLineHeight:u,lineHeight:l,letterSpacing:s,paragraphSpacing:c,textAlign:h,textVerticalAlign:d,textBehaviour:f}}function qE(e){var t=Hl.data[e];return t?t.list.map((function(e){return{label:e.style,value:e.postscriptName}})):[]}function KE(e){for(var t=[],r=[],n=[],i=[],o=[],a=[],s=[],l=[],u=[],c=[],h=[],d=[e.computedStyle.textVerticalAlign],f=[],p=[],v=e.getCursorRich(),g=e.style.lineHeight,m=0,y=v.length;m<y;m++)YE(e,g,t,r,n,i,o,a,p,s,l,u,c,h,f,v[m],!0);var b=[];return 1===n.length&&(b=qE(n[0])),{valid:t,postscriptName:r,fontFamily:n,name:i,fontWeight:p,fontWeightList:b,color:o,fontSize:a,autoLineHeight:u,lineHeight:l,letterSpacing:s,paragraphSpacing:c,textAlign:h,textVerticalAlign:d,textBehaviour:f}}function ZE(e,t){var r={},n=e.getStyle(),i=n.left,o=n.right,a=n.top,s=n.bottom,l=n.width,u=n.height;t===rl.AUTO?(l.u!==Us.AUTO&&(r.width="auto"),u.u!==Us.AUTO&&(r.height="auto"),i.u!==Us.AUTO&&o.u!==Us.AUTO&&(i.u===Us.PX?r.right="auto":o.u===Us.PX?r.left="auto":r.right="auto"),a.u!==Us.AUTO&&s.u!==Us.AUTO&&(a.u===Us.PX?r.bottom="auto":s.u===Us.PX?r.top="auto":r.bottom="auto")):t===rl.FIXED_W?(l.u===Us.PX||i.u===Us.PX&&o.u===Us.PX||(r.width=e.width),u.u!==Us.AUTO&&(r.height="auto"),i.u===Us.AUTO||o.u===Us.AUTO||i.u===Us.PX&&o.u===Us.PX||(i.u===Us.PX?o.u===Us.PERCENT&&(r.right="auto"):o.u===Us.PX?i.u===Us.PERCENT&&(r.left="auto"):r.right="auto"),a.u!==Us.AUTO&&s.u!==Us.AUTO&&(a.u===Us.PX?r.bottom="auto":s.u===Us.PX?r.top="auto":r.bottom="auto")):t===rl.FIXED_W_H&&(l.u===Us.PX||i.u===Us.PX&&o.u===Us.PX||(r.width=e.width),u.u===Us.PX||a.u===Us.PX&&s.u===Us.PX||(r.height=e.height),i.u===Us.AUTO||o.u===Us.AUTO||i.u===Us.PX&&o.u===Us.PX||(i.u===Us.PX?o.u===Us.PERCENT&&(r.right="auto"):o.u===Us.PX?i.u===Us.PERCENT&&(r.left="auto"):r.right="auto"),a.u===Us.AUTO||s.u===Us.AUTO||a.u===Us.PX&&s.u===Us.PX||(a.u===Us.PX?s.u===Us.PERCENT&&(r.bottom="auto"):s.u===Us.PX?a.u===Us.PERCENT&&(r.top="auto"):r.bottom="auto")),e.startSizeChange(),e.updateStyle(r),e.endSizeChange(n),e.checkPosSizeUpward()}function JE(e){for(var t,r=e.root,n=e.parent;n&&n!==r&&n instanceof uE;)t=n,n=n.parent;return t}function QE(e,t,r,n,i){var o,a,s=i.getBoundingClientRect();return e>r&&(e=(o=[r,e])[0],r=o[1]),t>n&&(t=(a=[n,t])[0],n=a[1]),s.left>e&&s.top>t&&s.right<r&&s.bottom<n}function $E(e,t,r){for(var n=e.children,i=n.length-1;i>=0;i--){var o=n[i];if(!o.props.isLocked&&o.computedStyle.visibility!==tl.HIDDEN){var a=o.computedStyle,s=o.matrixWorld,l=o._rect||o.rect;if($u(t,r,l[0],l[1],l[2],l[3],s,!0))if(o instanceof Vx){var u=$E(o,t,r);if(u)return u;if(o instanceof qx)return o}else if(a.pointerEvents)return o}}}function eS(e,t,r,n,i){for(var o=e.children,a=[],s=0,l=o.length;s<l;s++){var u=o[s];if(!u.props.isLocked&&u.computedStyle.visibility!==tl.HIDDEN){var c=u.matrixWorld,h=u._rect||u.rect,d=gu(h[0],h[1],h[2],h[3],c);if(ic(t,r,n,i,[{x:d.x1,y:d.y1},{x:d.x2,y:d.y2},{x:d.x3,y:d.y3},{x:d.x4,y:d.y4}]))if(u instanceof Vx){var f=eS(u,t,r,n,i);f.length?a.push.apply(a,f):u.computedStyle.pointerEvents&&a.push(u)}else u.computedStyle.pointerEvents&&a.push(u)}}return a}function tS(e,t,r,n,i,o){if(void 0===n&&(n=!1),void 0===i&&(i=[]),void 0===o&&(o=!1),!e.isDestroyed){var a=e.lastPage;if(a){var s=$E(a,t,r);if(s){if(n){if(s instanceof l_){for(var l=s.parent;l&&l!==e;){if(l instanceof qx)return l;l=l.parent}return}if(s instanceof iw||s instanceof uE){var u=JE(s);if(u)return u}return s}if(s instanceof l_&&!(s instanceof uE))return;if(i.length){if(o){for(g=s;g.struct&&g.struct.lv>3;){for(var c=0;c<i.length;c++){var h=i[c];if(g.parent===h)return g;if(g===h&&!(h instanceof Vx))return g}if((l=g.parent)instanceof qx)break;g=l}return g}var d=s,f=i.slice(0),p=d.struct.lv,v=p;if(f.forEach((function(e,t){if(e.struct.lv>p)for(;e.struct.lv>p;)e=e.parent,f[t]=e;else v=Math.max(v,e.struct.lv)})),v<p)for(;d.struct.lv>v;)d=d.parent;for(;d&&d.struct.lv>3;){for(c=0;c<f.length;c++){h=f[c];if(d.isSibling(h)||d===h)return d}if((l=d.parent)instanceof qx)break;d=l,f.forEach((function(e,t){e.struct.lv>d.struct.lv&&(f[t]=e.parent)}))}return d}for(var g=s;g&&g.struct.lv>3;){if((l=g.parent)instanceof qx)break;g=l}return g}}}}function rS(e,t,r){return $E(e.overlay,t,r)}function nS(e,t,r){var n=rS(e,t,r);if(n&&n instanceof f_)for(var i=e.overlay.artBoardList,o=0,a=i.length;o<a;o++){var s=i[o];if(s.text===n)return s.artBoard}}function iS(e,t,r,n,i,o){if(void 0===o&&(o=!1),e.isDestroyed)return[];var a=e.lastPage;if(a){var s=eS(a,t,r,n,i);if(s.length){for(var l=[],u=0,c=s.length;u<c;u++){if((f=s[u])instanceof iw||f instanceof uE){var h=JE(f);h?-1===l.indexOf(h)&&l.push(h):l.push(f)}else l.push(f)}if(o)return l.filter((function(e){return(!(e instanceof l_)||e instanceof uE)&&!(e instanceof qx)}));var d=[];e:for(u=0,c=l.length;u<c;u++){var f;if(!((f=l[u])instanceof l_)||f instanceof uE)if(f instanceof qx)QE(t,r,n,i,f)&&-1===d.indexOf(f)&&d.push(f);else{for(var p=f;p&&p.struct.lv>3;){var v=p.parent;if(v instanceof qx){if(QE(t,r,n,i,v)){-1===d.indexOf(v)&&d.push(v);continue e}break}p=v}-1===d.indexOf(p)&&d.push(p)}}return d}}return[]}function oS(e,t,r,n,i,o,a,s){var l=e.getBoundingClientRect({excludeDpi:!0}),u=l.left,c=l.right,h=l.top,d=l.bottom;if(!(u>=i||c<=0||h>=o||d<=0)){var f=!1;if(s&&e instanceof l_)for(var p=0,v=s.length;p<v;p++)for(var g=s[p].parent;g&&!g.isPage&&!(g instanceof __);){if(g===e){f=!0;break}g=g.parent}if(!f){var m=.5*(u+c),y=.5*(h+d),b={left:u,right:c,top:h,bottom:d,center:m,middle:y};if(u>=0&&u<=i){var x=aS(u,t);x>-1&&(!t[x-1]||Math.abs(t[x-1].n-u)>=n)&&(!t[x]||Math.abs(t[x].n-u)>=n)&&t.splice(x,0,{node:e,n:u,r:b})}if(c>=0&&c<=i){var w=aS(c,t);w>-1&&(!t[w-1]||Math.abs(t[w-1].n-c)>=n)&&(!t[w]||Math.abs(t[w].n-c)>=n)&&t.splice(w,0,{node:e,n:c,r:b})}if(m>=0&&m<=i){var _=aS(m,t);_>-1&&(!t[_-1]||Math.abs(t[_-1].n-m)>=n)&&(!t[_]||Math.abs(t[_].n-m)>=n)&&t.splice(_,0,{node:e,n:m,r:b})}if(h>=0&&h<=o){var E=aS(h,r);E>-1&&(!r[E-1]||Math.abs(r[E-1].n-h)>=n)&&(!r[E]||Math.abs(r[E].n-h)>=n)&&r.splice(E,0,{node:e,n:h,r:b})}if(d>=0&&d<=o){var S=aS(d,r);S>-1&&(!r[S-1]||Math.abs(r[S-1].n-d)>=n)&&(!r[S]||Math.abs(r[S].n-d)>=n)&&r.splice(S,0,{node:e,n:d,r:b})}if(y>=0&&y<=o){var C=aS(y,r);C>-1&&(!r[C-1]||Math.abs(r[C-1].n-y)>=n)&&(!r[C]||Math.abs(r[C].n-y)>=n)&&r.splice(C,0,{node:e,n:y,r:b})}}e instanceof l_&&e.children.forEach((function(e){s&&s.includes(e)||oS(e,t,r,n,i,o,a,s)}))}}function aS(e,t){if(!t.length)return 0;if(e<t[0].n)return 0;var r=t.length;if(e>t[r-1].n)return r;for(var n=0,i=r;n<i;){if(n===i-1)return i;var o=Math.round(.5*(n+i));if(e===t[o].n)return o+1;e>t[o].n?n=o:i=o}return n}function sS(e,t){var r={x:[],y:[]};if(e.isDestroyed)return r;var n=e.lastPage;if(n){var i=Math.max(0,ms.guidesSnap);n.children.forEach((function(n){t&&t.includes(n)||oS(n,r.x,r.y,i,e.width/e.dpi,e.height/e.dpi,e.dpi,t)}))}return r}function lS(e,t,r){void 0===r&&(r=!1);var n=e.style,i=e.computedStyle,o=t.x,a=t.y,s=t.parent,l=Rs(n.top),u=Rs(n.right),c=Rs(n.bottom),h=Rs(n.left),d=Rs(n.width),f=Rs(n.height);n.left={v:o,u:Us.PX},n.right={v:0,u:Us.AUTO},n.top={v:a,u:Us.PX},n.bottom={v:0,u:Us.AUTO},n.width={v:i.width,u:Us.PX},n.height={v:i.height,u:Us.PX},uS(s,e,r),h.u===Us.PERCENT?n.left={v:100*i.left/s.width,u:Us.PERCENT}:h.u===Us.PX?n.left={v:i.left,u:Us.PX}:h.u===Us.AUTO&&(n.left={v:0,u:Us.AUTO}),u.u===Us.PERCENT?n.right={v:100*i.right/s.width,u:Us.PERCENT}:u.u===Us.PX?n.right={v:i.right,u:Us.PX}:u.u===Us.AUTO&&(n.right={v:0,u:Us.AUTO}),l.u===Us.PERCENT?n.top={v:100*i.top/s.height,u:Us.PERCENT}:l.u===Us.PX?n.top={v:i.top,u:Us.PX}:l.u===Us.AUTO&&(n.top={v:0,u:Us.AUTO}),c.u===Us.PERCENT?n.bottom={v:100*i.bottom/s.height,u:Us.PERCENT}:c.u===Us.PX?n.bottom={v:i.bottom,u:Us.PX}:c.u===Us.AUTO&&(n.bottom={v:0,u:Us.AUTO}),d.u===Us.PERCENT?n.width={v:100*i.width/s.width,u:Us.PERCENT}:d.u===Us.PX?n.width={v:i.width,u:Us.PX}:d.u===Us.AUTO&&(n.width={v:0,u:Us.AUTO}),f.u===Us.PERCENT?n.height={v:100*i.height/s.height,u:Us.PERCENT}:f.u===Us.PX?n.height={v:i.height,u:Us.PX}:f.u===Us.AUTO&&(n.height={v:0,u:Us.AUTO})}function uS(e,t,r){var n,i;void 0===r&&(r=!1);var o=e.children;if(o.length)for(var a=0,s=o.length;a<s;a++){var l=o[a];if(t.props.index<l.props.index){l.insertBefore(t),r&&(t.props.index=.5*(l.props.index+((null===(n=o[a+1])||void 0===n?void 0:n.props.index)||1)));break}if(a===s-1){e.appendChild(t),r&&(t.props.index=.5*(((null===(i=o[a-1])||void 0===i?void 0:i.props.index)||0)+1));break}}else e.appendChild(t),r&&(t.props.index=.5)}var cS,hS={node:aE,text:{TEXT_BEHAVIOUR:rl,SIZE_LIST:[6,7,8,9,10,11,12,14,16,18,20,21,24,36,48,60,72],getTextInfo:VE,getEditTextInfo:KE,getTextBehaviour:WE,setTextBehaviour:ZE,getFontWeightList:qE},root:{getNodeByPoint:tS,getOverlayNodeByPoint:rS,getOverlayArtBoardByPoint:nS,getFrameNodes:iS,getGuidesNodes:sS,search2:aS},container:{appendWithPosAndSize:lS,appendWithIndex:uS}},dS=function(){function e(e,t){this.root=e,this.dom=t;var r=this.frame=document.createElement("div");r.className="frame",r.style.display="none",t.appendChild(r);var n=this.hover=document.createElement("div");n.className="hover",n.style.display="none",t.appendChild(n);var i=this.select=document.createElement("div");i.className="select",i.style.display="none",i.innerHTML='\n  <span class="l">\n    <b></b>\n  </span>\n  <span class="t">\n    <b></b>\n  </span>\n  <span class="r">\n    <b></b>\n  </span>\n  <span class="b">\n    <b></b>\n  </span>\n  <div class="sub"></div>\n  <span class="tl">\n    <b></b>\n  </span>\n  <span class="tr">\n    <b></b>\n  </span>\n  <span class="br">\n    <b></b>\n  </span>\n  <span class="bl">\n    <b></b>\n  </span>\n',t.appendChild(i)}return e.prototype.showFrame=function(e,t,r,n){this.frame.style.left=e+"px",this.frame.style.top=t+"px",this.updateFrame(r,n),this.frame.style.display="block"},e.prototype.updateFrame=function(e,t){this.frame.style.width=Math.abs(e)+"px",this.frame.style.height=Math.abs(t)+"px",this.frame.style.transform="scale(".concat(e>=0?1:-1,", ").concat(t>=0?1:-1,")")},e.prototype.hideFrame=function(){this.frame.style.display="none"},e.prototype.showHover=function(e){this.hoverNode=e,this.updateHover(e),this.hover.style.display="block"},e.prototype.hideHover=function(){this.hoverNode=void 0,this.hover.style.display="none"},e.prototype.calRect=function(e){var t,r,n,i,o,a,s,l,u=this.root.dpi,c=e.computedStyle,h=e._rect||e.rect,d=e.matrixWorld;if(1!==u){var f=ru();fu(f,1/u),d=iu(f,d)}e instanceof pw&&e.isLine()&&(h=e.rectLine);var p=gu(h[0],h[1],h[2],h[3],d),v=p.x1,g=p.y1,m=p.x2,y=p.y2,b=p.x3,x=p.y3,w=p.x4,_=p.y4;-1===c.scaleX&&(v=(t=[m,v])[0],m=t[1],g=(r=[y,g])[0],y=r[1],b=(n=[w,b])[0],w=n[1],x=(i=[_,x])[0],_=i[1]),-1===c.scaleY&&(v=(o=[w,v])[0],w=o[1],g=(a=[_,g])[0],_=a[1],m=(s=[b,m])[0],b=s[1],y=(l=[x,y])[0],x=l[1]);var E={left:v,top:g,width:Math.sqrt(Math.pow(v-m,2)+Math.pow(g-y,2)),height:Math.sqrt(Math.pow(m-b,2)+Math.pow(y-x,2)),transform:""};if(m>v){if(y!==g){var S=Ju(Math.atan((y-g)/(m-v)));E.transform="rotateZ(".concat(S,"deg)")}}else if(m<v){S=Ju(Math.atan((y-g)/(m-v)));E.transform="rotateZ(".concat(S+180,"deg)")}else y>g?E.transform="rotateZ(90deg)":y<g&&(E.transform="rotateZ(-90deg)");return E},e.prototype.updateHover=function(e){var t=this.calRect(e);this.hover.style.left=t.left+"px",this.hover.style.top=t.top+"px",this.hover.style.width=t.width+"px",this.hover.style.height=t.height+"px",this.hover.style.transform=t.transform},e.prototype.showSelect=function(e){this.updateSelect(e),this.select.style.display="block"},e.prototype.updateSelect=function(e){var t=this.select.querySelector(".sub");if(1===e.length){t.innerHTML="",this.select.classList.remove("multi"),e[0].computedStyle.visibility===tl.VISIBLE?this.select.classList.remove("hide"):this.select.classList.add("hide");var r=this.calRect(e[0]);this.select.style.left=r.left+"px",this.select.style.top=r.top+"px",this.select.style.width=r.width+"px",this.select.style.height=r.height+"px",this.select.style.transform=r.transform}else if(e.length>1){this.select.classList.add("multi");var n=0,i=0,o=0,a=0,s=[];e.forEach((function(e,t){var r=e.getBoundingClientRect();s.push({left:r.left,top:r.top,right:r.right,bottom:r.bottom,visible:e.computedStyle.visibility===tl.VISIBLE}),t?(n=Math.min(n,r.left),i=Math.min(i,r.top),o=Math.max(o,r.right),a=Math.max(a,r.bottom)):(n=r.left,i=r.top,o=r.right,a=r.bottom)}));var l=this.root.dpi;this.select.style.left=n/l+"px",this.select.style.top=i/l+"px",this.select.style.width=(o-n)/l+"px",this.select.style.height=(a-i)/l+"px",this.select.style.transform="";var u="";s.forEach((function(e){u+='<div style="left:'.concat((e.left-n)/l,"px;top:").concat((e.top-i)/l,"px;width:").concat((e.right-e.left)/l,"px;height:").concat((e.bottom-e.top)/l,"px;").concat(e.visible?"":"border-style:dashed;",'"></div>')}));var c=this.select.querySelector(".sub");c.innerHTML!==u&&(c.innerHTML=u)}},e.prototype.hideSelect=function(){this.select.style.display="none"},e.prototype.isSelectControlDom=function(e){return e.parentElement===this.select},e.prototype.destroy=function(){this.hover.remove(),this.select.remove(),this.frame.remove()},e.prototype.metaKey=function(e){e?this.select.querySelectorAll(".tl, .tr, .bl, .br").forEach((function(e){e.style.cursor="cell"})):(this.select.querySelector(".tl").style.cursor="nwse-resize",this.select.querySelector(".tr").style.cursor="nesw-resize",this.select.querySelector(".bl").style.cursor="nesw-resize",this.select.querySelector(".br").style.cursor="nwse-resize")},e.prototype.getAspectRatio=function(){var e=this.select;return{x:parseFloat(e.style.left),y:parseFloat(e.style.top),w:parseFloat(e.style.width),h:parseFloat(e.style.height)}},e}();!function(e){e[e.NORMAL=0]="NORMAL",e[e.EDIT_TEXT=1]="EDIT_TEXT"}(cS||(cS={}));var fS,pS,vS,gS,mS,yS,bS=cS,xS=function(e){this.nodes=e},wS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.beforeEdit(),e.cursor=t[r].next.cursor,e.content=t[r].next.content,e.setRich(t[r].next.rich),e.afterEdit()}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.beforeEdit(),e.cursor=t[r].prev.cursor,e.content=t[r].prev.content,e.setRich(t[r].prev.rich),e.afterEdit()}))},t}(xS),_S=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.ignoreBlur=[],this.hasBlur=!0;var i=this.containerEl=document.createElement("div");i.className="input",i.style.position="absolute",i.style.pointerEvents="none",i.style.opacity="0",t.appendChild(i);var o=this.inputEl=document.createElement("input");o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.width="10px",o.style.height="100%",o.style.boxSizing="content-box",o.style.border="none",o.style.pointerEvents="none",o.style.opacity="0",o.type="text",o.autocomplete="off",o.spellcheck=!1,i.appendChild(o);var a=function(e){if(n.node){var t=n.node._content,i=n.node.getRich(),a=n.node.getCursor();e(),n.updateCursor(),n.showCursor(),o.value="",n.listener.select.updateSelect([n.node]),r.emit([rC.TEXT_CONTENT_NODE,rC.CURSOR_NODE],[n.node]),n.listener.history.addCommand(new wS([n.node],[{prev:{content:t,rich:i,cursor:a},next:{content:n.node._content,rich:n.node.getRich(),cursor:n.node.getCursor()}}]),n.hasBlur),n.hasBlur=!1}},s=function(e){e&&a((function(){var t;null===(t=n.node)||void 0===t||t.input(e)}))},l=!1;o.addEventListener("keydown",(function(e){var t=e.keyCode,i=e.code;if(n.node)if(13===t||"Enter"===i)a((function(){var e;null===(e=n.node)||void 0===e||e.enter()}));else if(8===t||46===t||"Backspace"===i||"Delete"===i)e.stopPropagation(),a((function(){var e;null===(e=n.node)||void 0===e||e.delete(46===t||"Delete"===i)}));else if(t>=37&&t<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(i)){e.stopPropagation();var o=n.node.moveCursor(t,e.shiftKey);e.shiftKey?n.hideCursor():(n.showCursor(),n.updateCursor(o)),r.emit(rC.CURSOR_NODE,[n.node])}})),o.addEventListener("input",(function(e){if(!l){var t=e.data;t&&s(t)}})),o.addEventListener("paste",(function(e){var t;e.stopPropagation();var r=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");r&&s(r)})),o.addEventListener("compositionstart",(function(e){l=!0})),o.addEventListener("compositionend",(function(e){l=!1;var t=e.data;t&&s(t)}));var u=this.cursorEl=document.createElement("div");u.style.position="absolute",u.style.left="0px",u.style.top="0px",u.style.width="10px",u.style.height="100%",u.style.borderLeft="1px solid #000",u.style.pointerEvents="none",i.appendChild(u),u.animate([{visibility:"visible",borderColor:"#000"},{visibility:"visible",borderColor:"#FFF"},{visibility:"hidden"},{visibility:"hidden"}],{duration:800,iterations:1/0}),document.addEventListener("click",(function(e){if(r.state===bS.EDIT_TEXT){for(var t=e.target,i=t;i;){if(i===r.dom||n.ignoreBlur.includes(i))return void(["INPUT","SELECT"].includes(t.tagName.toUpperCase())||n.focus());i=i.parentElement}r.state=bS.NORMAL;var o=n.node;o.resetCursor(),o.afterEdit(),o.inputStyle=void 0,n.hide()}}))}return e.prototype.show=function(e,t,r){this.node=e,this.update(t,r),this.focus(),this.showCursor()},e.prototype.update=function(e,t){var r=this.root.dpi,n=this.node.setCursorStartByAbsCoords(e*r,t*r);this.containerEl.style.left=n.x/r+"px",this.containerEl.style.top=n.y/r+"px",this.containerEl.style.height=n.h/r+"px"},e.prototype.hide=function(){if(this.hideCursor(),this.blur(),!this.node._content.length){var e=this.listener.history.commands[0];e&&e instanceof wS&&e.nodes[0]===this.node&&e.undo(),this.listener.remove()}this.node=void 0},e.prototype.focus=function(){this.inputEl.focus()},e.prototype.blur=function(){this.inputEl.blur(),this.hasBlur=!0},e.prototype.showCursor=function(){this.containerEl.style.opacity="1"},e.prototype.hideCursor=function(){this.containerEl.style.opacity="0"},e.prototype.updateCursor=function(e){if(e=e||this.node.getCursorAbsCoords()){var t=this.root.dpi;this.containerEl.style.left=e.x/t+"px",this.containerEl.style.top=e.y/t+"px",this.containerEl.style.height=e.h/t+"px"}},e.prototype.destroy=function(){this.hide(),this.containerEl.remove()},e}(),ES={show:function(e,t,r,n,i){var o,a,s,l,u,c=this;vS=r,gS&&(gS(),gS=void 0),gS=i,Array.isArray(t)?mS=t:t.stops&&(yS=t);var h=e.getBoundingClientRect(),d=!fS;d&&((fS=document.createElement("div")).innerHTML='\n<span class="arrow">\n  <b></b>\n</span>\n<ul class="type">\n  <li class="color" title=""></li>\n  <li class="linear" title=""></li>\n  <li class="radial" title=""></li>\n  <li class="conic" title=""></li>\n</ul>\n<div class="line">\n  <div class="bg"></div>\n  <div class="con"></div>\n</div>\n',document.body.appendChild(fS),document.addEventListener("click",(function(e){for(var t=e.target;t;){if(t===fS)return;t=t.parentElement}c.hide()})));var f=fS.querySelector(".type");null===(o=f.querySelector(".cur"))||void 0===o||o.classList.remove("cur");var p=fS.querySelector(".line");p.removeAttribute("style");var v=p.querySelector(".bg"),g=p.querySelector(".con"),m=0;if(d){f.addEventListener("click",(function(e){var r=e.target;if("LI"===r.tagName.toUpperCase()){var i=r.classList;if(!i.contains("cur"))if(f.querySelector(".cur").classList.remove("cur"),i.add("cur"),i.contains("color")){p.style.display="none";var o=[0,0,0,1];mS?o=mS.slice(0):t.stops?(o=t.stops[0].color,n(o)):n(o),pS.setColor(o,!0)}else{if(p.style.display="block",i.contains("linear"))if(yS){if(yS.t===js.RADIAL||yS.t===js.CONIC){var a=yS.d[2]-yS.d[0],s=yS.d[3]-yS.d[1];yS.d[0]-=a,yS.d[1]-=s}yS.t=js.LINEAR}else yS={t:js.LINEAR,d:[0,.5,1,.5],stops:[{color:mS?mS.slice(0):[0,0,0,1],offset:0},{color:mS?mS.slice(0):[255,255,255,1],offset:1}]};else if(i.contains("radial"))if(yS){if(yS.t===js.LINEAR){a=yS.d[2]-yS.d[0],s=yS.d[3]-yS.d[1];yS.d[0]+=.5*a,yS.d[1]+=.5*s}else yS.t===js.CONIC&&(yS.d.length||yS.d.push(.5,.5,1,1));yS.t=js.RADIAL}else yS={t:js.RADIAL,d:[.5,.5,1,1],stops:[{color:mS?mS.slice(0):[0,0,0,1],offset:0},{color:mS?mS.slice(0):[255,255,255,1],offset:1}]};else if(i.contains("conic"))if(yS){if(yS.t===js.LINEAR){a=yS.d[2]-yS.d[0],s=yS.d[3]-yS.d[1];yS.d[0]+=.5*a,yS.d[1]+=.5*s}yS.t=js.CONIC}else yS={t:js.CONIC,d:[],stops:[{color:mS?mS.slice(0):[0,0,0,1],offset:0},{color:mS?mS.slice(0):[255,255,255,1],offset:1}]};yS&&n(yS)}}}));var y=v.clientWidth,b=!1,x=0,w=0,_=g.querySelector(".cur");g.addEventListener("mousedown",(function(e){var r,n,i;e.preventDefault();var o=e.target,a=o.tagName.toUpperCase();if(y=v.clientWidth,"SPAN"===a)g.querySelector(".cur").classList.remove("cur"),(_=o).classList.add("cur"),m=parseInt(_.title),b=!0,x=e.pageX,w=.01*parseFloat(_.style.left),pS.setColor(t.stops[m].color,!0);else if("DIV"===a){g.querySelector(".cur").classList.remove("cur");var s=e.offsetX/y,l=document.createElement("span");l.style.left=100*s+"%";var u=g.querySelectorAll(".con span");m=u.length,l.title=m.toString(),g.appendChild(l);for(var c={color:[0,0,0,0],offset:s},h=0,d=u.length;h<d;h++){var f=u[h],p=.01*parseFloat(f.style.left);if(p>=s){if(h){var E=t.stops[h-1].color,S=t.stops[h].color,C=.01*parseFloat(u[h-1].style.left),k=(s-C)/(p-C);c.color=[E[0]+(S[0]-E[0])*k,E[1]+(S[1]-E[1])*k,E[2]+(S[2]-E[2])*k,(null!==(r=E[3])&&void 0!==r?r:1)+((null!==(n=S[3])&&void 0!==n?n:1)-(null!==(i=E[3])&&void 0!==i?i:1))*k]}else c.color=t.stops[h].color.slice(0);break}h===d-1&&(c.color=t.stops[h].color.slice(0))}t.stops[m]=c,(_=l).classList.add("cur"),b=!0,x=e.pageX,w=.01*parseFloat(_.style.left),pS.setColor(c.color,!0)}})),document.addEventListener("mousemove",(function(e){if(b){var r=e.pageX-x,i=Math.min(1,Math.max(0,w+r/y));t.stops[m].offset=i,_.style.left=100*i+"%",v.style.background=Uc(t,v.clientWidth,v.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),n(t)}})),document.addEventListener("mouseup",(function(){b=!1}))}if(fS.className="sketch-editor-picker",fS.classList.add(r),fS.style.left=h.left+.5*(h.right-h.left)+"px",fS.style.top=h.bottom+10+"px",fS.style.display="block",pS||((pS=new window.Picker({parent:fS,popup:!1})).onDone=function(){c.hide()},pS.onChange=function(e){f.querySelector(".cur").classList.contains("color")?n(e.rgba):(t.stops[m].color=e.rgba,v.style.background=Uc(t,v.clientWidth,v.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),n(t))}),Array.isArray(t)){var E=Tc(t);pS.setColor(E,!0),null===(a=f.querySelector(".color"))||void 0===a||a.classList.add("cur"),p.style.display="none"}else if(void 0!==t.url)p.style.display="none";else{pS.setColor(Tc(t.stops[0].color),!0);var S=Object.assign({},t);S.t=js.LINEAR,v.style.background=xc(S,v.clientWidth,v.clientHeight,!0).replace(/\([^,]*,/,"(to right,"),p.style.display="block",function(e,t){var r=t.querySelector(".con");r.innerHTML="";var n=document.createDocumentFragment();e.stops.forEach((function(e,t){var r=document.createElement("span");t||r.classList.add("cur"),r.style.left=100*e.offset+"%",r.title=t.toString(),n.appendChild(r)})),r.appendChild(n)}(t,p),pS.setColor(Tc(t.stops[0].color),!0),t.t===js.LINEAR?null===(s=f.querySelector(".linear"))||void 0===s||s.classList.add("cur"):t.t===js.RADIAL?null===(l=f.querySelector(".radial"))||void 0===l||l.classList.add("cur"):t.t===js.CONIC&&(null===(u=f.querySelector(".conic"))||void 0===u||u.classList.add("cur"))}return pS.show(),pS},hide:function(){fS&&"block"===fS.style.display&&(fS.style.display="none",gS&&(gS(),gS=void 0))},isShow:function(){return!!fS&&"block"===fS.style.display},isShowFrom:function(e){return this.isShow()&&vS===e}};var SS,CS,kS="0.10.3",TS='\n  <div class="item group"></div>\n  <div class="item un-group"></div>\n  <div class="item select-all"></div>\n  <div class="split"></div>\n  <div class="item cut"></div>\n  <div class="item copy"></div>\n  <div class="item paste"></div>\n  <div class="split"></div>\n  <div class="item remove"></div>\n  <div class="split"></div>\n  <div class="item lock"><span></span></div>\n  <div class="item un-lock"><span></span></div>\n  <div class="item hide"><span></span></div>\n  <div class="item show"><span></span></div>\n  <div class="split"></div>\n  <div class="item mask">\n    <span class="checked"></span> <b class="arrow"></b>\n    <div class="sub">\n      <div class="item outline-mask"><span class="checked"></span></div>\n      <div class="item alpha-mask"><span class="checked"></span></div>\n    </div>\n  </div>\n  <div class="item break-mask"><span class="checked"></span></div>\n  <div class="split"></div>\n  <div class="item scale-up"></div>\n  <div class="item scale-down"></div>\n  <div class="split"></div>\n  <div class="item version"> '.concat(kS,"</div>\n"),AS={showCanvas:function(e,t,r){var n=this;SS||(SS=document.createElement("div"),document.body.appendChild(SS),document.addEventListener("click",(function(e){e.target!==SS&&n.hide()&&r.emit(rC.CONTEXT_MENU,!1,SS)})),document.addEventListener("visibilitychange",(function(e){"hidden"===document.visibilityState&&n.hide()&&r.emit(rC.CONTEXT_MENU,!1,SS)})),SS.addEventListener("click",(function(e){var t,n=e.target.classList;n.contains("group")?r.group():n.contains("un-group")?r.unGroup():n.contains("select-all")?r.selectAll():n.contains("scale-up")||n.contains("scale-down")?r.zoom(n.contains("scale-up")?2:.5):n.contains("mask")||n.contains("outline-mask")?SS.classList.contains("outline")?r.mask("none"):r.mask("outline"):n.contains("alpha-mask")?SS.classList.contains("alpha")?r.mask("none"):r.mask("alpha"):n.contains("break-mask")?SS.classList.contains("break")?r.breakMask(!1):r.breakMask(!0):n.contains("lock")?r.lock(!0):n.contains("un-lock")?r.lock(!1):n.contains("hide")?r.visible("hidden"):n.contains("show")?r.visible("visible"):n.contains("remove")?r.remove():n.contains("cut")||n.contains("copy")?(r.clone(),n.contains("cut")&&!(null===(t=r.options.disabled)||void 0===t?void 0:t.remove)&&r.remove()):n.contains("paste")&&r.paste()}))),SS.innerHTML=TS,SS.className="sketch-editor-context-menu";var i=SS.classList,o=r.selected;if(o.length>1)i.add("multi");else if(1===o.length){o[0]instanceof l_?i.add("single-group"):i.add("single")}else i.add("empty");(r.clones.length?i.remove("no-clone"):i.add("no-clone"),o.filter((function(e){return e.computedStyle.maskMode})).length)&&(o.filter((function(e){return e.computedStyle.maskMode===Zs.OUTLINE})).length?i.add("outline"):i.add("alpha"));o.filter((function(e){return e.computedStyle.breakMask})).length&&i.add("break");var a=o.filter((function(e){return e.props.isLocked}));a.length===o.length?(i.add("locked"),SS.querySelector(".un-lock span").innerHTML=a.length.toString()):SS.querySelector(".lock span").innerHTML=o.length.toString();var s=o.filter((function(e){return e.computedStyle.visibility===tl.HIDDEN}));s.length===o.length?(i.add("hidden"),SS.querySelector(".show span").innerHTML=s.length.toString()):SS.querySelector(".hide span").innerHTML=o.length.toString(),SS.style.left=e+"px",SS.style.top=t+"px",SS.style.display="block",r.emit(rC.CONTEXT_MENU,!0,SS)},showTree:function(e,t,r){this.showCanvas(e,t,r)},hide:function(){return!(!SS||"block"!==SS.style.display)&&(SS.style.display="none",!0)}},MS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=e.getStyle(),l=e.computedStyle;t.update(e,l,o,a),e.endPosChange(s,o,a),e.checkPosSizeUpward()}))},t.prototype.undo=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=e.getStyle(),l=e.computedStyle;t.update(e,l,-o,-a),e.endPosChange(s,-o,-a),e.checkPosSizeUpward()}))},t.update=function(e,t,r,n){var i=e.artBoard;e.updateStyle({translateX:t.translateX+r,translateY:t.translateY+n});var o=e.getBoundingClientRect();if(i&&ic((u=i.getBoundingClientRect()).left,u.top,u.right,u.bottom,o.points))return i;var a=e.page;if(a)for(var s=a.children,l=s.length-1;l>=0;l--){var u,c=s[l];if(c!==i&&c instanceof qx)if(ic((u=c.getBoundingClientRect()).left,u.top,u.right,u.bottom,o.points))return S_([e],c),c}i&&(C_([e],i),e.artBoard=void 0)},t}(xS),OS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.updateStyle(t[r].next)}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.updateStyle(t[r].prev)}))},t}(xS);!function(e){e[e.T=0]="T",e[e.R=1]="R",e[e.B=2]="B",e[e.L=3]="L",e[e.TL=4]="TL",e[e.TR=5]="TR",e[e.BL=6]="BL",e[e.BR=7]="BR"}(CS||(CS={}));var LS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=i.controlType,l=i.aspectRatio,u=i.clientRect,c=i.selectRect,h=i.fromCenter,d=i.widthToAuto,f=i.heightToAuto;i.flipX,i.flipY;var p=e.getStyle();e.startSizeChange();var v=e.getComputedStyle(),g=e.getCssStyle();u?t.updateStyleMultiAr(e,v,g,o,a,s,u,c,l,h,d,f):t.updateStyle(e,v,g,o,a,s,l,h,d,f),e.endSizeChange(p),e.checkPosSizeUpward()}))},t.prototype.undo=function(){var e=this.nodes,r=this.data;e.forEach((function(e,n){var i=r[n],o=i.dx,a=i.dy,s=i.controlType,l=i.aspectRatio,u=i.clientRect,c=i.selectRect,h=i.fromCenter,d=i.widthFromAuto,f=i.heightFromAuto,p=i.flipX,v=i.flipY,g=e.getStyle();e.startSizeChange();var m=e.getComputedStyle(),y=e.getCssStyle();s=function(e,t,r){t&&(e===CS.L?e=CS.R:e===CS.R?e=CS.L:e===CS.TL?e=CS.TR:e===CS.TR&&(e=CS.TL));r&&(e===CS.T?e=CS.B:e===CS.B?e=CS.T:e===CS.BL?e=CS.BR:e===CS.BR&&(e=CS.BL));return e}(s,p,v),u?t.updateStyleMultiAr(e,m,y,-o,-a,s,u,c,l,h,d,f):t.updateStyle(e,m,y,-o,-a,s,l,h,d,f),e.endSizeChange(g),e.checkPosSizeUpward()}))},t.updateStyle=function(e,t,r,n,i,o,a,s,l,u){void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===u&&(u=!1);var c={left:r.left,right:r.right,top:r.top,bottom:r.bottom,width:r.width,height:r.height,scaleX:r.scaleX,scaleY:r.scaleY};a?o===CS.T?Object.assign(c,P_(e,t,i,s)):o===CS.R?Object.assign(c,U_(e,t,n,s)):o===CS.B?Object.assign(c,D_(e,t,i,s)):o===CS.L?Object.assign(c,B_(e,t,n,s)):o===CS.TL?Object.assign(c,X_(e,t,n,i,s)):o===CS.TR?Object.assign(c,H_(e,t,n,i,s)):o===CS.BL?Object.assign(c,G_(e,t,n,i,s)):o===CS.BR&&Object.assign(c,j_(e,t,n,i,s)):(o===CS.T||o===CS.TL||o===CS.TR?Object.assign(c,O_(e,t,i,s)):o!==CS.B&&o!==CS.BL&&o!==CS.BR||Object.assign(c,L_(e,t,i,s)),o===CS.L||o===CS.TL||o===CS.BL?Object.assign(c,R_(e,t,n,s)):o!==CS.R&&o!==CS.TR&&o!==CS.BR||Object.assign(c,I_(e,t,n,s))),l&&(c.width="auto"),u&&(c.height="auto"),e.updateStyle(c)},t.updateStyleMultiAr=function(e,t,r,n,i,o,a,s,l,u,c,h){var d;void 0===u&&(u=!1),void 0===c&&(c=!1),void 0===h&&(h=!1);var f={left:r.left,right:r.right,top:r.top,bottom:r.bottom,width:r.width,height:r.height,scaleX:r.scaleX,scaleY:r.scaleY};if(o===CS.T)Object.assign(f,K_(e,t,i,a,s,l,u));else if(o===CS.R)Object.assign(f,Q_(e,t,n,a,s,l,u));else if(o===CS.B)Object.assign(f,Z_(e,t,i,a,s,l,u));else if(o===CS.L)Object.assign(f,J_(e,t,n,a,s,l,u));else{if(l){var p=(null===(d=e.root)||void 0===d?void 0:d.dpi)||1,v={width:s.w*p,height:s.h*p},g=z_(v,n,i,[CS.TL,CS.BR].includes(o)),m=g.x,y=g.y;n=m-v.width,i=y-v.height}o===CS.TL?Object.assign(f,eE(e,t,n,i,a,s,l,u)):o===CS.TR?Object.assign(f,tE(e,t,n,i,a,s,l,u)):o===CS.BL?Object.assign(f,nE(e,t,n,i,a,s,l,u)):o===CS.BR&&Object.assign(f,iE(e,t,n,i,a,s,l,u))}c&&(f.width="auto"),h&&(f.height="auto"),e.updateStyle(f)},t}(xS);var RS,IS=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.data=r,i.type=n,i}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.setRich(t[r].next)}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.setRich(t[r].prev)}))},t.FONT_FAMILY="FONT_FAMILY",t.FONT_SIZE="FONT_SIZE",t.LETTER_SPACING="LETTER_SPACING",t.LINE_HEIGHT="LINE_HEIGHT",t.PARAGRAPH_SPACING="PARAGRAPH_SPACING",t.COLOR="COLOR",t.TEXT_ALIGN="TEXT_ALIGN",t}(xS);var FS=function(){function e(e){void 0===e&&(e=100),this.commands=[],this.commandsR=[],this.size=Math.max(1,e),this.lastTime=0}return e.prototype.addCommand=function(e,t){void 0===t&&(t=!1),this.commandsR.splice(0);var r=this.commands.length;if(!t&&r>0){var n=this.commands[r-1];if((Date.now()-this.lastTime<ms.historyTime||n instanceof wS&&e instanceof wS)&&function(e,t){if(e.constructor!==t.constructor)return!1;var r=e.nodes,n=t.nodes;if(r.length!==n.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;if(e instanceof LS){var a=e.data,s=t.data;for(i=0,o=a.length;i<o;i++){var l=a[i],u=s[i];if(l.controlType!==u.controlType||l.aspectRatio!==u.aspectRatio||l.fromCenter!==u.fromCenter||l.widthFromAuto!==u.widthFromAuto||l.heightFromAuto!==u.heightFromAuto||l.widthToAuto!==u.widthToAuto||l.heightToAuto!==u.heightToAuto)return!1}}if(e instanceof IS){if(e.type!==t.type)return!1;for(a=e.data,s=t.data,i=0,o=a.length;i<o;i++){if(l=a[i],u=s[i],l.prev.length!==u.prev.length)return!1;for(var c=0;c<l.prev.length;c++){var h=l.prev[c],d=u.prev[c];if(h.location!==d.location||h.length!==d.length)return!1}}}return!0}(n,e)){var i=!0;if(n instanceof MS){var o=e.data;n.data.forEach((function(e,t){e.dx+=o[t].dx,e.dy+=o[t].dy}))}else if(n instanceof OS){var a=e.data;n.data.forEach((function(e,t){e.next=a[t].next}))}else if(n instanceof LS){var s=e.data;n.data.forEach((function(e,t){e.dx+=s[t].dx,e.dy+=s[t].dy}))}else if(n instanceof IS){var l=e.data;n.data.forEach((function(e,t){e.next=l[t].next}))}else if(n instanceof wS){var u=e.data;n.data.forEach((function(e,t){e.next=u[t].next}))}else i=!1;if(i)return void(this.lastTime=Date.now())}}this.lastTime=Date.now(),r>=this.size&&this.commands.slice(0,r-this.size+1),this.commands.push(e)},e.prototype.undo=function(){if(this.commands.length){var e=this.commands.pop();return e.undo(),this.commandsR.push(e),e}},e.prototype.redo=function(){if(this.commandsR.length){var e=this.commandsR.pop();return e.execute(),this.commands.push(e),e}},e.getInstance=function(){return RS||(RS=new e),RS},e}(),PS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){this.nodes.forEach((function(e){e.remove()}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){lS(e,t[r])}))},t.operate=function(e){var t=e.parent,r={x:e.computedStyle.left,y:e.computedStyle.top,parent:t};if(t.isGroup&&t instanceof l_){var n=t.getChildrenRect(e);r.x-=n.minX,r.y-=n.minY}return e.remove(),r},t}(xS),DS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),NS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),BS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),US=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),zS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),XS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),HS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),GS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),jS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),YS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS);function WS(e,t){if(e.length){M_(e);var r=e[0],n=r.parent;if(n instanceof l_&&(n.fixedPosAndSize=!0),!t){var i=Object.assign({uuid:s(),name:"",style:{left:"0%",top:"0%",right:"0%",bottom:"0%"}});t=new l_(i,[])}t.fixedPosAndSize=!0,r.insertAfter(t);for(var o=0,a=e.length;o<a;o++){A_(t,e[o])}for(o=0,a=e.length;o<a;o++)t.appendChild(e[o]);return t.fixedPosAndSize=!1,n instanceof l_&&(n.fixedPosAndSize=!1),t.checkPosSizeSelf(),t}}var VS=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.data=r,i.group=n,i}return v(t,e),t.prototype.execute=function(){t.operate(this.nodes,this.group)},t.prototype.undo=function(){var e=this;this.nodes.forEach((function(t,r){var n=e.data[r],i=n.parent,o=n.index;i instanceof l_&&(i.fixedPosAndSize=!0),A_(i,t),t.props.index=o,uS(i,t)})),this.data.forEach((function(e){var t=e.parent;t instanceof l_&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())})),this.group.remove()},t.operate=function(e,t){return{data:e.map((function(e){return{parent:e.parent,index:e.props.index}})),group:WS(e,t)}},t}(xS),qS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){t.operate(this.nodes)},t.prototype.undo=function(){var e=this;this.nodes.forEach((function(t,r){var n=t;n.fixedPosAndSize=!0;var i=e.data[r],o=i.parent,a=i.children;o instanceof l_&&(o.fixedPosAndSize=!0),uS(o,n),a.filter((function(e){A_(n,e),n.appendChild(e)})),n.fixedPosAndSize=!1,n.checkPosSizeSelf()})),this.data.forEach((function(e){var t=e.parent;t instanceof l_&&t.fixedPosAndSize&&(t.fixedPosAndSize=!1,t.checkPosSizeSelf())}))},t.operate=function(e){return e.map((function(e){return function(e){if(!e.isDestroyed&&e.parent){e.fixedPosAndSize=!0;var t=e.parent;t instanceof l_&&(t.fixedPosAndSize=!0);for(var r=e,n=e.children.slice(0),i=0,o=n.length;i<o;i++){var a=n[i];A_(t,a),r.insertAfter(a),r=a}return t instanceof l_&&(t.fixedPosAndSize=!1),e.fixedPosAndSize=!1,e.remove(),{children:n,parent:t}}hl.error("Can not unGroup a destroyed Node")}(e)}))},t}(xS),KS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.name=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.name=t[r].prev}))},t}(xS),ZS=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.isLocked=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.isLocked=t[r].prev}))},t}(xS),JS=function(e){function t(t,r){return e.call(this,t,r)||this}return v(t,e),t}(OS),QS=function(){function e(e,t,r){this.root=e,this.dom=t,this.listener=r,this.xs=[],this.ys=[],this.move={left:0,right:0,top:0,bottom:0,center:0,middle:0},this.lineH=[],this.lineV=[],this.distanceH=document.createElement("div"),this.distanceH.className="distance-h",this.distanceH.style.display="none",this.distanceH.innerHTML="<span></span>",this.dom.appendChild(this.distanceH),this.distanceV=document.createElement("div"),this.distanceV.className="distance-v",this.distanceV.style.display="none",this.distanceV.innerHTML="<span></span>",this.dom.appendChild(this.distanceV)}return e.prototype.initMove=function(e,t){var r=sS(this.root,t),n=r.x,i=r.y;this.xs=n,this.ys=i;var o=parseFloat(e.style.left),a=parseFloat(e.style.top),s=o+parseFloat(e.style.width),l=.5*(o+s),u=a+parseFloat(e.style.height),c=.5*(a+u);this.move={left:o,right:s,top:a,bottom:u,center:l,middle:c}},e.prototype.snapMove=function(e,t,r){var n,i,o=0,a=0,s=!1,l=this.xs,u=this.ys,c=Math.max(0,ms.guidesSnap),h=this.move,d=h.left,f=h.right,p=h.top,v=h.bottom,g=h.center,m=h.middle;f+=e,g+=e,p+=t,v+=t,m+=t;var y=aS(d+=e,l),b=aS(g,l),x=aS(f,l),w=[$S(d,c,l,y),$S(g,c,l,b),$S(f,c,l,x)].filter((function(e){return e}));if(w.length){s=!0,w.sort((function(e,t){return Math.abs(e.d)-Math.abs(t.d)}));var _=w[0];d+=o=O=_.d,f+=o,n=L=_.ng,this.showLineV(L.n,Math.min(p,L.r.top),Math.max(v,L.r.bottom),0);for(var E=1,S=w.length;E<S;E++){var C=w[E];if(!(Math.abs(C.d-O)<1e-9))break;this.showLineV(C.ng.n,Math.min(p,C.ng.r.top),Math.max(v,C.ng.r.bottom),E)}}else this.hideLineV();var k=aS(p,u),T=aS(m,u),A=aS(v,u),M=[$S(p,c,u,k),$S(m,c,u,T),$S(v,c,u,A)].filter((function(e){return e}));if(M.length){s=!0,M.sort((function(e,t){return Math.abs(e.d)-Math.abs(t.d)}));var O,L,R=M[0];p+=a=O=R.d,v+=a,i=L=R.ng,this.showLineH(L.n,Math.min(d,L.r.left),Math.max(f,L.r.right),0);for(E=1,S=M.length;E<S;E++){if((C=M[E]).d!==O)break;this.showLineH(C.ng.n,Math.min(d,C.ng.r.left),Math.max(f,C.ng.r.right),E)}}else this.hideLineH();if(n?p>n.r.bottom?this.showDistanceV(n.r.bottom,p,r):v<n.r.top?this.showDistanceV(v,n.r.top,r):this.hideDistanceV():this.hideDistanceV(),i?d>i.r.right?this.showDistanceH(i.r.right,d,r):f<i.r.left?this.showDistanceH(f,i.r.left,r):this.hideDistanceH():this.hideDistanceH(),s)return{x:o,y:a}},e.prototype.showLineH=function(e,t,r,n){if(!this.lineH[n]){var i=this.lineH[n]=document.createElement("div");i.className="line-h",this.dom.appendChild(i)}var o=this.lineH[n].style;o.top=e+"px",o.left=t+"px",o.width=r-t+"px",o.display="block"},e.prototype.showLineV=function(e,t,r,n){if(!this.lineV[n]){var i=this.lineV[n]=document.createElement("div");i.className="line-v",this.dom.appendChild(i)}var o=this.lineV[n].style;o.left=e+"px",o.top=t+"px",o.height=r-t+"px",o.display="block"},e.prototype.showDistanceH=function(e,t,r){var n=this.distanceH.style,i=Math.abs(e-t);this.distanceH.querySelector("span").innerHTML=dc(i*r,2).toString();var o=this.lineH.length;n.top=3===o?this.lineH[1].style.top:o>1?.5*(parseFloat(this.lineH[0].style.top)+parseFloat(this.lineH[o-1].style.top))+"px":this.lineH[0].style.top,n.left=Math.min(e,t)+"px",n.width=i+"px",n.display="block"},e.prototype.showDistanceV=function(e,t,r){var n=this.distanceV.style,i=Math.abs(e-t);this.distanceV.querySelector("span").innerHTML=dc(i*r,2).toString();var o=this.lineV.length;n.left=3===o?this.lineV[1].style.left:o>1?.5*(parseFloat(this.lineV[0].style.left)+parseFloat(this.lineV[o-1].style.left))+"px":this.lineV[0].style.left,n.top=Math.min(e,t)+"px",n.height=i+"px",n.display="block"},e.prototype.hideLineH=function(){this.lineH.splice(0).forEach((function(e){e.style.display="none",e.remove()}))},e.prototype.hideLineV=function(){this.lineV.splice(0).forEach((function(e){e.style.display="none",e.remove()}))},e.prototype.hideDistanceH=function(){this.distanceH.style.display="none"},e.prototype.hideDistanceV=function(){this.distanceV.style.display="none"},e.prototype.hide=function(){this.hideLineH(),this.hideLineV(),this.hideDistanceH(),this.hideDistanceV()},e}();function $S(e,t,r,n){var i=r[n-1],o=r[n];if(i&&o){var a=Math.abs(i.n-e),s=Math.abs(o.n-e);if(a<=t&&s<=t)return a<=s?{d:i.n-e,ng:i}:{d:o.n-e,ng:o};if(a<=t)return{d:i.n-e,ng:i};if(s<=t)return{d:o.n-e,ng:o}}else if(i){if(Math.abs(e-i.n)<=t)return{d:i.n-e,ng:i}}else if(o&&Math.abs(e-o.n)<=t)return{d:o.n-e,ng:o}}var eC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){lS(e,t[r])}))},t.prototype.undo=function(){this.nodes.forEach((function(e){e.remove()}))},t}(xS),tC="undefined"!=typeof navigator&&/win/i.test(navigator.platform),rC=function(e){function t(t,r,n){void 0===n&&(n={});var i=e.call(this)||this;return i.isWin=tC,i.options=n,i.state=bS.NORMAL,i.root=t,i.dom=r,i.history=new FS,i.metaKey=!1,i.shiftKey=!1,i.ctrlKey=!1,i.altKey=!1,i.spaceKey=!1,i.middleKey=!1,i.isMouseDown=!1,i.isMouseMove=!1,i.button=0,i.isControl=!1,i.isRotate=!1,i.controlType=CS.T,i.originX=0,i.originY=0,i.startX=0,i.startY=0,i.pageTx=0,i.pageTy=0,i.centerX=0,i.centerY=0,i.dx=0,i.dy=0,i.isFrame=!1,i.selected=[],i.abcStyle=[],i.computedStyle=[],i.originStyle=[],i.cssStyle=[],i.updateOrigin(),i.select=new dS(t,r),i.input=new _S(t,r,i),i.guides=new QS(t,r,i),i.clones=[],r.addEventListener("mousedown",i.onMouseDown.bind(i)),r.addEventListener("mousemove",i.onMouseMove.bind(i)),r.addEventListener("mouseup",i.onMouseUp.bind(i)),r.addEventListener("mouseleave",i.onMouseLeave.bind(i)),r.addEventListener("touchstart",i.onTouchStart.bind(i)),r.addEventListener("touchmove",i.onTouchMove.bind(i)),r.addEventListener("touchend",i.onTouchEnd.bind(i)),r.addEventListener("click",i.onClick.bind(i)),r.addEventListener("dblclick",i.onDblClick.bind(i)),r.addEventListener("wheel",i.onWheel.bind(i)),r.addEventListener("contextmenu",i.onContextMenu.bind(i)),document.addEventListener("keydown",i.onKeyDown.bind(i)),document.addEventListener("keyup",i.onKeyUp.bind(i)),i}return v(t,e),t.prototype.updateOrigin=function(){var e=this.dom.getBoundingClientRect();this.originX=e.left,this.originY=e.top},t.prototype.active=function(e){var r;this.selected.splice(0),(r=this.selected).push.apply(r,e),this.updateActive(),this.emit(t.SELECT_NODE,this.selected.slice(0))},t.prototype.updateActive=function(){this.computedStyle=this.selected.map((function(e){return e.getComputedStyle()})),this.selected.length?this.select.showSelect(this.selected):this.select.hideSelect()},t.prototype.prepare=function(){var e=this,t=this.selected;t.forEach((function(t){e.toggleGroup(t,!0)})),this.computedStyle=t.map((function(e){return e.getComputedStyle()})),this.originStyle=t.map((function(e){return e.getStyle()}))},t.prototype.toggleGroup=function(e,t){void 0===t&&(t=!1);var r=e.parent;r&&r.isGroup&&r instanceof l_&&(r.fixedPosAndSize=t)},t.prototype.getNode=function(e,t,r){var n;void 0===r&&(r=!1);var i=this.metaKey||tC&&this.ctrlKey;(null===(n=this.options.enabled)||void 0===n?void 0:n.selectWithMeta)&&(i=!i);var o=tS(this.root,e,t,i,this.selected,r);return o instanceof qx&&o.children.length&&!i&&!this.selected.includes(o)&&(o=void 0),o},t.prototype.beforeResize=function(){this.selected.length>1?(this.selectRect=this.select.getAspectRatio(),this.clientRect=this.selected.map((function(e){var t=e.getBoundingClientRect({excludeDpi:!0});return{x:t.left,y:t.top,w:t.width,h:t.height}}))):(this.selectRect=void 0,this.clientRect=void 0)},t.prototype.onDown=function(e,r){var n,i,o=this.selected,a=this.select.isSelectControlDom(e);this.updateOrigin();var s=this.root,l=s.dpi;this.originStyle.splice(0),this.cssStyle.splice(0),this.computedStyle.splice(0),this.dx=this.dy=0;var u=r instanceof MouseEvent&&2===r.button;if(a&&!u){if(null===(n=this.options.disabled)||void 0===n?void 0:n.resize)return;this.isControl=a;var c=this.controlType={t:CS.T,r:CS.R,b:CS.B,l:CS.L,tl:CS.TL,tr:CS.TR,bl:CS.BL,br:CS.BR}[e.className];if(this.prepare(),this.state===bS.EDIT_TEXT)this.state=bS.NORMAL,this.input.hide(),(E=o[0]).resetCursor(),E.afterEdit(),E.inputStyle=void 0;if(1===o.length&&(this.metaKey||tC&&this.ctrlKey)&&!o[0].isSlice&&!(o[0]instanceof g_)&&[CS.TL,CS.TR,CS.BL,CS.BR].indexOf(c)>-1){var h=o[0].getBoundingClientRect().points,d=Yu(h[0].x,h[0].y,h[2].x,h[2].y,h[1].x,h[1].y,h[3].x,h[3].y);this.centerX=d.x/l+this.originX,this.centerY=d.y/l+this.originY,this.isRotate=!0}else this.abcStyle=o.map((function(e){return e.isArtBoard&&e instanceof qx&&!e.props.resizesContent?e.children.map((function(e){var t=e.computedStyle,r=e.style,n={left:Rs(r.left),right:Rs(r.right),top:Rs(r.top),bottom:Rs(r.bottom),width:Rs(r.width),height:Rs(r.height)};return c===CS.T||c===CS.TL||c===CS.TR?(r.bottom.u!==Us.PX&&(r.bottom.v=t.bottom,r.bottom.u=Us.PX),r.top.u!==Us.AUTO&&(r.top.u=Us.AUTO)):c!==CS.B&&c!==CS.BL&&c!==CS.BR||(r.top.u!==Us.PX&&(r.top.v=t.top,r.top.u=Us.PX),r.bottom.u!==Us.AUTO&&(r.bottom.u=Us.AUTO)),c===CS.L||c===CS.TL||c===CS.BL?(r.right.u!==Us.PX&&(r.right.v=t.right,r.right.u=Us.PX),r.left.u!==Us.AUTO&&(r.left.u=Us.AUTO)):c!==CS.R&&c!==CS.TR&&c!==CS.BR||(r.left.u!==Us.PX&&(r.left.v=t.left,r.left.u=Us.PX),r.right.u!==Us.AUTO&&(r.right.u=Us.AUTO)),r.width.u!==Us.PX&&(r.width.v=t.width,r.width.u=Us.PX),r.height.u!==Us.PX&&(r.height.v=t.height,r.height.u=Us.PX),n})):[]})),this.beforeResize()}else{if(o.length>1&&!(this.metaKey||tC&&this.ctrlKey)&&!this.shiftKey){var f=r.clientX,p=r.clientY,v=this.select.select.getBoundingClientRect();if(f>=v.left&&p>=v.top&&f<=v.right&&p<=v.bottom)return this.prepare(),void this.guides.initMove(this.select.select,o)}var g=(r.clientX-this.originX)*l,m=(r.clientY-this.originY)*l,y=this.metaKey||tC&&this.ctrlKey;(null===(i=this.options.enabled)||void 0===i?void 0:i.selectWithMeta)&&(y=!y);var b=this.getNode(g,m);if(b instanceof qx&&b.children.length&&!o.includes(b))if(y){for(var x=!1,w=(d=0,o.length);d<w;d++){if((M=o[d])===b||M.artBoard===b){x=!0;break}}x||(this.mouseDownArtBoard=b,b=void 0)}else b=void 0;else b?b.artBoard&&o.includes(b.artBoard)&&(this.mouseDown2ArtBoard=b,b=b.artBoard):b=nS(s,g,m);this.isFrame=!b;var _=o.slice(0);if(b)if((d=o.indexOf(b))>-1)if(!this.shiftKey||this.state===bS.EDIT_TEXT&&o[0]===b){if(this.state===bS.EDIT_TEXT){var E=o[0];if(this.shiftKey)E.setCursorEndByAbsCoords(g,m),E.inputStyle=void 0,this.input.hideCursor();else{var S=E.cursor,C=S.isMulti,k=S.start;E.resetCursor();var T=E.setCursorStartByAbsCoords(g,m);if(this.input.updateCursor(T),this.input.showCursor(),E.cursor.isMulti===C&&E.cursor.start===k)return}return void this.emit(t.CURSOR_NODE,o.slice(0))}if(1===o.length&&o[0]===b)return this.prepare(),this.guides.initMove(this.select.select,o),void(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)));o.splice(0),o.push(b)}else 1===o.length&&o[0]===b||o.splice(d,1);else{if(this.shiftKey)for(var A=o.length-1;A>=0;A--){var M=o[A];if(b.isArtBoard&&M.artBoard===b&&b!==M)return;M.isArtBoard&&b.artBoard===M&&b!==M&&o.splice(A,1)}else o.splice(0);o.push(b)}else this.state===bS.EDIT_TEXT||this.shiftKey||o.splice(0);if(this.state===bS.EDIT_TEXT)(E=o[0]).resetCursor(),E.afterEdit(),E.inputStyle=void 0,this.state=bS.NORMAL,this.input.hide();if(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)),o.length?this.select.showSelect(o):this.select.hideSelect(),0===_.length&&0===o.length)return;(this.metaKey||tC&&this.ctrlKey)&&1===o.length&&this.select.metaKey(!0),this.prepare(),this.guides.initMove(this.select.select,o),this.emit(t.SELECT_NODE,o.slice(0))}},t.prototype.onMouseDown=function(e){var t,r;if(!(null===(t=this.options.disabled)||void 0===t?void 0:t.select)&&!this.isMouseDown){var n=this.root.getCurPage();if(n){if(this.button=e.button,2===e.button){if(this.metaKey||tC&&this.ctrlKey||this.state===bS.EDIT_TEXT||(null===(r=this.options.disabled)||void 0===r?void 0:r.contextMenu))return;var i=e.target;return this.onDown(i,e),void AS.showCanvas(e.pageX,e.pageY,this)}if(this.isMouseDown=!0,this.isMouseMove=!1,this.startX=e.clientX,this.startY=e.clientY,1===e.button&&(this.middleKey=!0),0===e.button&&this.spaceKey||this.middleKey){var o=n.getComputedStyle();this.pageTx=o.translateX,this.pageTy=o.translateY,this.dom.style.cursor="grabbing"}else if(!this.spaceKey){i=e.target;this.onDown(i,e)}}}},t.prototype.onMove=function(e,r){var n,i,o,a,s,l=this,u=this.root,c=u.getCurPage();if(c){var h=u.dpi,d=e.clientX-this.startX,f=e.clientY-this.startY,p=c.getZoom(),v=this.dx=Math.round(d*h/p),g=this.dy=Math.round(f*h/p),m=this.selected;if(this.isControl)if(this.isRotate){var y=this.centerX-this.originX,b=this.centerY-this.originY,x=this.startX-this.originX,w=this.startY-this.originY,_=e.clientX-this.originX,E=e.clientY-this.originY,S=Ju(tc(Math.sqrt(Math.pow(x-_,2)+Math.pow(w-E,2)),Math.sqrt(Math.pow(y-_,2)+Math.pow(b-E,2)),Math.sqrt(Math.pow(x-y,2)+Math.pow(w-b,2)))),C=Yl(x-y,w-b,_-y,E-b);if(this.shiftKey)for(var k=0;k<=180;k+=15)if(Math.abs(S-k)<=7.5){S=k;break}var T=m[0],A=(this.computedStyle[0].rotateZ+S*(C>=0?1:-1))%360;T.updateStyle({rotateZ:A}),this.select.updateSelect(m),this.emit(t.ROTATE_NODE,m.slice(0))}else{var M=this.shiftKey;if(!M){k=0;for(var O=m.length;k<O;k++)if(m[k].props.constrainProportions){M=!0;break}}var L=this.altKey;(null===(n=this.options.enabled)||void 0===n?void 0:n.resizeWithAlt)&&(L=!L);var R=this.controlType;m.forEach((function(e,t){l.isMouseMove||(e.startSizeChange(),l.computedStyle[t]=e.getComputedStyle(),l.cssStyle[t]=e.getCssStyle());var r=l.computedStyle[t],n=l.cssStyle[t];l.selectRect&&l.clientRect&&l.clientRect[t]?LS.updateStyleMultiAr(e,r,n,v,g,R,l.clientRect[t],l.selectRect,M,L):LS.updateStyle(e,r,n,v,g,R,M,L)})),this.isMouseMove=!0,this.select.updateSelect(m),this.emit(t.RESIZE_NODE,m.slice(0))}else if(this.isMouseDown){if(this.state===bS.EDIT_TEXT){var I=(e.clientX-this.originX)*h,F=(e.clientY-this.originY)*h,P=m[0],D=P.cursor,N=D.isMulti,B=D.start,U=D.end;P.setCursorEndByAbsCoords(I,F),this.input.hideCursor();var z=P.cursor;N===z.isMulti&&B===z.start&&U===z.end||this.emit(t.CURSOR_NODE,m.slice(0))}else{if(null===(i=this.options.disabled)||void 0===i?void 0:i.move)return;if(this.isFrame){this.isMouseMove?this.select.updateFrame(d,f):this.select.showFrame(this.startX-this.originX,this.startY-this.originY,d,f);I=(this.startX-this.originX)*h,F=(this.startY-this.originY)*h;var X=this.metaKey||tC&&this.ctrlKey;(null===(o=this.options.enabled)||void 0===o?void 0:o.selectWithMeta)&&(X=!X);var H=iS(u,I,F,I+d*h,F+f*h,X),G=m.splice(0);m.push.apply(m,H);var j=G.length!==m.length;if(!j)for(k=0,O=G.length;k<O;k++)G[k]!==m[k]&&(j=!0);j&&(H.length?this.select.showSelect(m):this.select.hideSelect(),this.emit(t.SELECT_NODE,m.slice(0)))}else{if(this.select.select.classList.add("move"),this.shiftKey&&(Math.abs(v)>=Math.abs(g)?this.dy=f=g=0:this.dx=d=v=0),!(null===(a=this.options.disabled)||void 0===a?void 0:a.guides))if(X=this.metaKey||tC&&this.ctrlKey)this.guides.hide();else{var Y=this.guides.snapMove(d,f,h/p);Y&&(this.dx=v+=Y.x*h/p,this.dy=g+=Y.y*h/p)}m.forEach((function(e,r){var n=l.computedStyle[r];e.artBoard!==MS.update(e,n,v,g)&&l.emit(t.ART_BOARD_NODE,[e])})),this.select.updateSelect(m),this.emit(t.MOVE_NODE,m.slice(0))}}this.isMouseMove=!0}else if(!r){if(null===(s=this.options.disabled)||void 0===s?void 0:s.hover)return;var W=e.target;if("CANVAS"!==W.tagName.toUpperCase()&&W!==this.dom)return void(this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)));this.startX=e.offsetX,this.startY=e.offsetY;I=this.startX*h,F=this.startY*h;this.hover(I,F)}}},t.prototype.onMouseMove=function(e){var r,n,i=this.root,o=i.dpi,a=this.selected;if(this.spaceKey||this.middleKey)if(this.isMouseDown){if(null===(r=this.options.disabled)||void 0===r?void 0:r.drag)return;this.select.hideHover(),this.isMouseMove=!0;var s=i.getCurPage();if(s){var l=e.clientX-this.startX,u=e.clientY-this.startY;s.updateStyle({translateX:this.pageTx+l,translateY:this.pageTy+u}),a.length&&this.select.updateSelect(a)}}else{if(null===(n=this.options.disabled)||void 0===n?void 0:n.hover)return;if("CANVAS"!==e.target.tagName.toUpperCase())return;var c=this.getNode(e.offsetX*o,e.offsetY*o);c?(-1===a.indexOf(c)&&this.select.showHover(c),this.emit(t.HOVER_NODE,c)):this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE))}else this.onMove(e,!1)},t.prototype.onMouseUp=function(e){var r,n,i,o=this;if(!e||e.button===this.button){var a=this.selected;if(a.forEach((function(e){o.toggleGroup(e,!1)})),this.isControl)if(this.isControl=!1,this.isRotate){this.isRotate=!1;var s=a[0];this.history.addCommand(new DS([s],[{prev:{rotateZ:this.computedStyle[0].rotateZ},next:{rotateZ:s.computedStyle.rotateZ}}]),!0),this.metaKey||tC&&this.ctrlKey||this.select.metaKey(!1)}else{var l=this.dx,u=this.dy;if(this.abcStyle.forEach((function(e,t){if(e.length){var r=a[t].children;e.forEach((function(e,t){var n=r[t].style;["left","right","top","bottom","width","height"].forEach((function(t){var r=e[t];n[t].v=r.v,n[t].u=r.u}))}))}})),this.isMouseMove){var c=this.shiftKey;if(!c)for(var h=0,d=a.length;h<d;h++)if(a[h].props.constrainProportions){c=!0;break}var f=this.altKey;(null===(r=this.options.enabled)||void 0===r?void 0:r.resizeWithAlt)&&(f=!f);var p=this.controlType,v=[];a.forEach((function(e,t){if(e.endSizeChange(o.originStyle[t]),l||u){e.checkPosSizeUpward();var r={dx:l,dy:u,controlType:p,aspectRatio:c,clientRect:o.clientRect&&o.clientRect[t],selectRect:o.selectRect,fromCenter:f},n=o.originStyle[t];n.width.u===Us.AUTO&&(r.widthFromAuto=!0),n.height.u===Us.AUTO&&(r.heightFromAuto=!0),o.computedStyle[t].scaleX!==e.computedStyle.scaleX&&(r.flipX=!0),o.computedStyle[t].scaleY!==e.computedStyle.scaleY&&(r.flipY=!0),v.push(r)}})),v.length&&this.history.addCommand(new LS(a.slice(0),v))}}else if(this.isMouseMove)if(this.state===bS.EDIT_TEXT){if(null===(n=this.options.disabled)||void 0===n?void 0:n.inputText)return;a[0].checkCursorMulti()?this.input.hideCursor():(this.input.updateCursor(),this.input.showCursor()),this.input.focus()}else if(this.isFrame)this.select.hideFrame();else{this.guides.hide(),this.select.select.classList.remove("move");var g=this.dx,m=this.dy,y=[];a.forEach((function(e,t){e.endPosChange(o.originStyle[t],g,m),(g||m)&&(e.checkPosSizeUpward(),y.push({dx:g,dy:m}))})),y.length&&this.history.addCommand(new MS(a.slice(0),y),!0)}else this.mouseDownArtBoard?(this.shiftKey||a.splice(0),a.push(this.mouseDownArtBoard),this.select.hideHover(),this.select.showSelect(a),this.prepare(),this.emit(t.SELECT_NODE,a.slice(0))):this.mouseDown2ArtBoard&&!this.shiftKey&&(a.splice(0),a.push(this.mouseDown2ArtBoard),this.select.hideHover(),this.select.showSelect(a),this.prepare(),this.emit(t.SELECT_NODE,a.slice(0)));if(this.isMouseDown=!1,this.isMouseMove=!1,this.mouseDownArtBoard=void 0,this.mouseDown2ArtBoard=void 0,this.isFrame=!1,this.middleKey=!1,this.spaceKey||this.middleKey){if(null===(i=this.options.disabled)||void 0===i?void 0:i.drag)return;this.dom.style.cursor="grab"}else this.dom.style.cursor="auto"}},t.prototype.onMouseLeave=function(){this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)),(this.isMouseDown||this.isControl)&&this.onMouseUp()},t.prototype.onTouchStart=function(e){if(1===e.touches.length){var t=e.touches[0];this.isMouseDown=!0,this.isMouseMove=!1,this.startX=t.clientX,this.startY=t.clientY;var r=e.target;this.onDown(r,t)}},t.prototype.onTouchMove=function(e){1===e.touches.length&&this.onMove(e.touches[0],!0)},t.prototype.onTouchEnd=function(){this.onMouseUp()},t.prototype.onClick=function(){},t.prototype.onDblClick=function(e){var r,n,i=this.root;if(i.getCurPage()){var o=i.dpi,a=this.getNode((e.clientX-this.originX)*o,(e.clientY-this.originY)*o,!0);if(a&&!(a instanceof qx)){if(1!==this.selected.length||a!==this.selected[0]){if(null===(r=this.options.disabled)||void 0===r?void 0:r.select)return;this.selected.splice(0),this.selected.push(a),this.select.showSelect(this.selected)}if(a instanceof f_){if(null===(n=this.options.disabled)||void 0===n?void 0:n.editText)return;this.input.show(a,e.clientX-this.originX,e.clientY-this.originY),this.state=bS.EDIT_TEXT,a.beforeEdit()}this.emit(t.SELECT_NODE,this.selected.slice(0))}}},t.prototype.onWheel=function(e){var r,n;e.preventDefault();var i=this.root,o=i.dpi,a=i.width,s=i.height,l=i.getCurPage();if(l){if(this.select.hideHover(),e.ctrlKey||e.metaKey){if(null===(r=this.options.disabled)||void 0===r?void 0:r.scale)return;var u=e.deltaY;e.ctrlKey&&!e.metaKey&&(u*=50);var c=0;u<0?c=u<-300?.2:u<-200?.1:u<-100?.05:u<-50?.02:.01:u>0&&(c=u>300?-.2:u>200?-.1:u>100?-.05:u>50?-.02:-.01);var h=(e.clientX-this.originX)*o/a,d=(e.clientY-this.originY)*o/s,f=l.getZoom(!0);f<1&&(c*=f),(f+=c)>32?f=32:f<.01&&(f=.01),f=dc(f),i.zoomTo(f,h,d),this.emit(t.ZOOM_PAGE,f)}else{if(null===(n=this.options.disabled)||void 0===n?void 0:n.drag)return;var p=l.getComputedStyle(),v=p.translateX,g=p.translateY;l.updateStyle({translateX:v-e.deltaX,translateY:g-e.deltaY})}this.updateSelected(),this.updateInput()}},t.prototype.zoom=function(e){var r=this.root,n=r.getCurPage();if(n){var i=n.getZoom(!0);(i*=e)>32?i=32:i<.01&&(i=.01),i=dc(i),r.zoomTo(i,.5,.5),this.updateSelected(),this.emit(t.ZOOM_PAGE,i)}},t.prototype.zoomActual=function(){this.root.zoomActual()&&this.emit(t.ZOOM_PAGE,this.root.getCurPageZoom())},t.prototype.zoomFit=function(){this.root.zoomFit()&&this.emit(t.ZOOM_PAGE,this.root.getCurPageZoom())},t.prototype.selectAll=function(){var e,r=this.root;if(r.getCurPage()){var n=this.metaKey||tC&&this.ctrlKey;(null===(e=this.options.enabled)||void 0===e?void 0:e.selectWithMeta)&&(n=!n);var i=iS(r,0,0,r.width,r.height,n);this.active(i),this.emit(t.SELECT_NODE,i.slice(0))}},t.prototype.group=function(e){if(void 0===e&&(e=this.selected),e.length){var r=VS.operate(e),n=r.data,i=r.group;if(i){var o=this.selected.slice(0);this.selected.splice(0),this.selected.push(i),this.select.updateSelect(this.selected),this.history.addCommand(new VS(o,n,i)),this.emit(t.GROUP_NODE,[i],[o.slice(0)])}}},t.prototype.unGroup=function(e){var r=this;void 0===e&&(e=this.selected);var n=e.filter((function(e){return e instanceof l_}));if(n.length){var i=qS.operate(n);this.selected.splice(0),i.forEach((function(e){var t;(t=r.selected).push.apply(t,e.children)})),this.select.updateSelect(this.selected),this.history.addCommand(new qS(n.slice(0),i.map((function(e){return{parent:e.parent,children:e.children}})))),this.emit(t.UN_GROUP_NODE,i.map((function(e){return e.children.slice(0)})),n)}},t.prototype.mask=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){var r=["none","outline","alpha"][t.computedStyle.maskMode];n.push({maskMode:r}),t.updateStyle({maskMode:e})})),this.history.addCommand(new jS(r.slice(0),n.map((function(t){return{prev:t,next:{maskMode:e}}})))),this.emit(t.MASK_NODE,r.slice(0))}},t.prototype.breakMask=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){n.push({breakMask:t.computedStyle.breakMask}),t.updateStyle({breakMask:e})})),this.history.addCommand(new YS(r.slice(0),n.map((function(t){return{prev:t,next:{breakMask:e}}})))),this.emit(t.BREAK_MASK_NODE,r.slice(0))}},t.prototype.lock=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t,r){n.push(!!t.props.isLocked),t.props.isLocked=e})),this.history.addCommand(new ZS(r.slice(0),n.map((function(t){return{prev:t,next:e}})))),this.emit(t.LOCK_NODE,r.slice(0))}},t.prototype.visible=function(e,r){if(void 0===r&&(r=this.selected),r.length){var n=[];r.forEach((function(t){n.push(t.computedStyle.visibility===tl.VISIBLE?"visible":"hidden"),t.updateStyle({visibility:e})})),this.history.addCommand(new JS(r.slice(0),n.map((function(t){return{prev:{visibility:t},next:{visibility:e}}})))),this.updateActive(),this.emit(t.VISIBLE_NODE,r.slice(0))}},t.prototype.rename=function(e,r){void 0===e&&(e=this.selected),this.history.addCommand(new KS(e.slice(0),e.map((function(e,t){var n=e.props.name||"",i=r[t];return e.props.name=i,{prev:n,next:i}})))),this.emit(t.RENAME_NODE,e.slice(0))},t.prototype.remove=function(e){if(void 0===e&&(e=this.selected),e.length){var r=e.slice(0),n=e.splice(0).map((function(e){for(var t=e;t&&t.parent&&t.parent.isGroup&&t.parent instanceof l_&&1===t.parent.children.length;)t=t.parent;return t})),i=[];n.forEach((function(e,t){var n=PS.operate(e);e!==r[t]?i.push(Z(Z({},n),{selected:r[t]})):i.push(n)})),this.select.hideSelect(),this.history.addCommand(new PS(n,i)),this.emit(t.REMOVE_NODE,n.slice(0))}},t.prototype.clone=function(e){void 0===e&&(e=this.selected),e.length&&(this.clones=e.map((function(e){return{parent:e.parent,node:e.clone()}})))},t.prototype.paste=function(e){if(void 0===e&&(e=this.clones),e.length){var r=[],n=[];e.forEach((function(e){var t={x:e.node.computedStyle.left,y:e.node.computedStyle.top,parent:e.parent};lS(e.node,t,!0),r.push(e.node),n.push(t)})),r.length&&(this.history.addCommand(new eC(r,n)),this.selected=r.slice(0),this.updateActive(),this.emit(t.ADD_NODE,r.slice(0)))}},t.prototype.hover=function(e,r){var n=this.getNode(e,r);n||(n=nS(this.root,e,r)),n?-1===this.selected.indexOf(n)&&this.select.hoverNode!==n?(this.select.showHover(n),this.emit(t.HOVER_NODE,n)):this.selected.indexOf(n)>-1&&this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE)):this.select.hoverNode&&(this.select.hideHover(),this.emit(t.UN_HOVER_NODE))},t.prototype.onKeyDown=function(e){var r,n,i,o,a,s,l=this,u=this.metaKey,c=this.ctrlKey;if(this.metaKey=e.metaKey,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.root.getCurPage()){var h=this.metaKey||tC&&this.ctrlKey;if(!h||1!==this.selected.length||this.selected[0].isSlice||this.selected[0]instanceof g_||this.select.metaKey(!0),(u!==this.metaKey||tC&&c!==this.ctrlKey)&&!this.isMouseDown){var d=this.root.dpi,f=this.startX*d,p=this.startY*d;this.hover(f,p)}var v=e.keyCode,g=e.code,m=e.target,y=["INPUT","TEXTAREA"].includes(m.tagName.toUpperCase());if(8===v||46===v||"Backspace"===g||"Delete"===g)e.target,y||(null===(o=this.options.disabled)||void 0===o?void 0:o.remove)||this.remove();else if(32===v||"Space"===g)this.spaceKey=!0,this.isMouseDown||(null===(a=this.options.disabled)||void 0===a?void 0:a.drag)||(this.dom.style.cursor="grab");else if(27!==v&&"Escape"!==g||!this.altKey)if(27===v||"Escape"===g)if(AS.hide(),ES.isShow())ES.hide(),this.state===bS.EDIT_TEXT&&this.input.focus();else if(this.state===bS.EDIT_TEXT){var b=this.selected[0];b.resetCursor(),b.afterEdit(),b.inputStyle=void 0,this.state=bS.NORMAL,this.input.hide()}else this.selected.splice(0),this.select.hideSelect(),this.select.hideHover(),this.emit(t.SELECT_NODE,this.selected.slice(0));else if(v>=37&&v<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(g)){var x=e.target;if(x&&!["INPUT","SELECT","TEXTAREA"].includes(x.tagName.toUpperCase())){e.preventDefault();var w=this.selected.slice(0),_=[],E=[];w.forEach((function(e){var t=e.getStyle(),r=e.artBoard,n=0,i=0;37===v?n=l.shiftKey?-10:-1:38===v?i=l.shiftKey?-10:-1:39===v?n=l.shiftKey?10:1:40===v&&(i=l.shiftKey?10:1),r!==MS.update(e,e.computedStyle,n,i)&&E.push(e),e.endPosChange(t,n,i),_.push({dx:n,dy:i}),e.checkPosSizeUpward()})),E.length&&this.emit(t.ART_BOARD_NODE,E),w.length&&(this.select.updateSelect(w),this.emit(t.MOVE_NODE,w.slice(0)),this.history.addCommand(new MS(w,_)))}}else if(65!==v&&"KeyA"!==g||!h)if(67!==v&&"KeyC"!==g&&88!==v&&"KeyX"!==g||!h)if(86!==v&&"KeyV"!==g||!h)if(187!==v&&"Equal"!==g||!h)if(189!==v&&"Minus"!==g||!h){if((90===v||"KeyZ"===g)&&h){var S;if(e.target&&y&&e.preventDefault(),S=this.shiftKey?this.history.redo():this.history.undo()){w=S.nodes.slice(0);if(!(S instanceof PS||S instanceof VS)){var C=this.selected.slice(0);if(this.selected.splice(0),(r=this.selected).push.apply(r,w),this.updateActive(),!(S instanceof eC))if(w.length!==C.length)this.emit(t.SELECT_NODE,w);else for(var k=0,T=w.length;k<T;k++)if(w[k]!==C[k]){this.emit(t.SELECT_NODE,w);break}}if(S instanceof MS)this.emit(t.MOVE_NODE,w);else if(S instanceof LS)this.emit(t.RESIZE_NODE,w);else if(S instanceof PS)this.shiftKey?(this.selected.splice(0),this.select.hideSelect(),this.emit(t.REMOVE_NODE,w)):(this.selected=w.map((function(e,t){return S.data[t].selected||e})),this.updateActive(),this.emit(t.ADD_NODE,w,this.selected.slice(0)));else if(S instanceof eC)this.shiftKey?(this.selected=w.slice(0),this.updateActive(),this.emit(t.ADD_NODE,w)):(this.selected.splice(0),this.select.hideSelect(),this.emit(t.REMOVE_NODE,w));else if(S instanceof DS)this.emit(t.ROTATE_NODE,w);else if(S instanceof NS)this.emit(t.OPACITY_NODE,w);else if(S instanceof US)this.emit(t.SHADOW_NODE,w);else if(S instanceof zS)this.emit(t.BLUR_NODE,w);else if(S instanceof XS)this.emit(t.COLOR_ADJUST_NODE,w);else if(S instanceof BS)this.emit(t.TEXT_VERTICAL_ALIGN_NODE,w);else if(S instanceof HS)this.emit(t.FILL_NODE,w);else if(S instanceof GS)this.emit(t.STROKE_NODE,w);else if(S instanceof VS)this.shiftKey?(this.selected.splice(0),this.selected.push(S.group),this.updateActive(),this.emit(t.GROUP_NODE,[S.group],[w])):(this.selected.splice(0),(n=this.selected).push.apply(n,w),this.updateActive(),this.emit(t.UN_GROUP_NODE,[w],[S.group]));else if(S instanceof qS)this.shiftKey?(this.selected.splice(0),w.forEach((function(e,t){var r;(r=l.selected).push.apply(r,S.data[t].children)})),this.updateActive(),this.emit(t.UN_GROUP_NODE,w.map((function(e,t){return S.data[t].children.slice(0)})),S.nodes.slice(0))):(this.selected.splice(0),(i=this.selected).push.apply(i,w),this.updateActive(),this.emit(t.GROUP_NODE,w,S.data.map((function(e){return e.children.slice(0)}))));else if(S instanceof jS){var A=["none","outline","alpha"][w[0].computedStyle.maskMode];this.emit(t.MASK_NODE,w,A)}else if(S instanceof YS){var M=w[0].computedStyle.breakMask;this.emit(t.BREAK_MASK_NODE,w,M)}else if(S instanceof IS){if(S.type===IS.TEXT_ALIGN?this.emit(t.TEXT_ALIGN_NODE,w):S.type===IS.COLOR?this.emit(t.COLOR_NODE,w):S.type===IS.FONT_FAMILY?this.emit(t.FONT_FAMILY_NODE,w):S.type===IS.FONT_SIZE?this.emit(t.FONT_SIZE_NODE,w):S.type===IS.LINE_HEIGHT?this.emit(t.LINE_HEIGHT_NODE,w):S.type===IS.PARAGRAPH_SPACING?this.emit(t.PARAGRAPH_SPACING_NODE,w):S.type===IS.LETTER_SPACING&&this.emit(t.LETTER_SPACING_NODE,w),this.state===bS.EDIT_TEXT&&1===w.length){var O=(D=w[0]).getSortedCursor(),L=O.isMulti,R=O.start;if(!L){var I=D.updateCursorByIndex(R);this.input.updateCursor(I),this.input.showCursor()}this.input.focus()}}else if(S instanceof wS){if(this.state===bS.EDIT_TEXT&&1===w.length){var F=(D=w[0]).getSortedCursor();L=F.isMulti,R=F.start;if(!L){I=D.updateCursorByIndex(R);this.input.updateCursor(I),this.input.showCursor()}this.input.focus()}}else S instanceof KS?this.emit(t.RENAME_NODE,w):S instanceof ZS?this.emit(t.LOCK_NODE,w):S instanceof JS&&this.emit(t.VISIBLE_NODE,w)}}}else e.preventDefault(),this.zoom(.5);else e.preventDefault(),this.zoom(2);else!y&&this.clones.length&&this.paste();else y||(this.clone(),88!==v&&"KeyX"!==g||(null===(s=this.options.disabled)||void 0===s?void 0:s.remove)||this.remove());else{var P=e.target;this.state===bS.EDIT_TEXT&&P===this.input.inputEl?(e.preventDefault(),this.input.node.selectAll(),this.input.hideCursor()):P&&!y&&(e.preventDefault(),this.selectAll())}else if(this.selected.length){var D;if((D=this.selected[0])instanceof __||D instanceof GE||D instanceof qx)return;D=D.parent,this.selected.splice(0),this.selected.push(D),this.select.updateSelect(this.selected),this.emit(t.SELECT_NODE,this.selected.slice(0))}}},t.prototype.onKeyUp=function(e){var t=this.metaKey,r=this.ctrlKey;if(this.metaKey=e.metaKey,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.metaKey||tC&&this.ctrlKey||this.isRotate||this.select.metaKey(!1),(t!==this.metaKey||tC&&r!==this.ctrlKey)&&!this.isMouseDown){var n=this.root.dpi,i=this.startX*n,o=this.startY*n;this.hover(i,o)}32===e.keyCode&&(this.spaceKey=!1,this.dom.style.cursor="auto")},t.prototype.updateSelected=function(){this.selected.length&&this.select.updateSelect(this.selected)},t.prototype.updateInput=function(){this.state===bS.EDIT_TEXT&&this.input.updateCursor()},t.prototype.onContextMenu=function(e){e.preventDefault()},t.prototype.destroy=function(){this.dom.removeEventListener("mousedown",this.onMouseDown),this.dom.removeEventListener("mousemove",this.onMouseMove),this.dom.removeEventListener("mouseup",this.onMouseUp),this.dom.removeEventListener("mouseleave",this.onMouseLeave),this.dom.removeEventListener("click",this.onClick),this.dom.removeEventListener("dblclick",this.onDblClick),this.dom.removeEventListener("wheel",this.onWheel),this.dom.removeEventListener("contextmenu",this.onContextMenu),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.selected.splice(0),this.abcStyle.splice(0),this.computedStyle.splice(0),this.originStyle.splice(0),this.cssStyle.splice(0),this.select.destroy()},t.HOVER_NODE="HOVER_NODE",t.UN_HOVER_NODE="UN_HOVER_NODE",t.SELECT_NODE="SELECT_NODE",t.RESIZE_NODE="RESIZE_NODE",t.MOVE_NODE="MOVE_NODE",t.ROTATE_NODE="ROTATE_NODE",t.OPACITY_NODE="OPACITY_NODE",t.FLIP_H_NODE="FLIP_H_NODE",t.FLIP_V_NODE="FLIP_V_NODE",t.FILL_NODE="FILL_NODE",t.STROKE_NODE="STROKE_NODE",t.FONT_FAMILY_NODE="FONT_FAMILY_NODE",t.FONT_SIZE_NODE="FONT_SIZE_NODE",t.LINE_HEIGHT_NODE="LINE_HEIGHT_NODE",t.LETTER_SPACING_NODE="LETTER_SPACING_NODE",t.PARAGRAPH_SPACING_NODE="PARAGRAPH_SPACING_NODE",t.COLOR_NODE="COLOR_NODE",t.TEXT_ALIGN_NODE="TEXT_ALIGN_NODE",t.TEXT_VERTICAL_ALIGN_NODE="TEXT_VERTICAL_ALIGN_NODE",t.TEXT_CONTENT_NODE="TEXT_CONTENT_NODE",t.CURSOR_NODE="CURSOR_NODE",t.SHADOW_NODE="SHADOW_NODE",t.BLUR_NODE="BLUR_NODE",t.COLOR_ADJUST_NODE="COLOR_ADJUST_NODE",t.REMOVE_NODE="REMOVE_NODE",t.ADD_NODE="ADD_NODE",t.GROUP_NODE="GROUP_NODE",t.UN_GROUP_NODE="UN_GROUP_NODE",t.MASK_NODE="MASK_NODE",t.BREAK_MASK_NODE="BREAK_MASK_NODE",t.RENAME_NODE="RENAME_NODE",t.LOCK_NODE="LOCK_NODE",t.VISIBLE_NODE="VISIBLE_NODE",t.ART_BOARD_NODE="ART_BOARD_NODE",t.CONSTRAIN_PROPORTION_NODE="CONSTRAIN_PROPORTION_NODE",t.ZOOM_PAGE="ZOOM_PAGE",t.CONTEXT_MENU="CONTEXT_MENU",t}(Dx);function nC(e,t,r){void 0===r&&(r=!1);var n=function(e){var t="default";e instanceof v_?t="symbol-instance":e instanceof u_?t="symbol-master":e instanceof qx?t="art-board":e instanceof l_?t="group":e instanceof Qx?t="bitmap":e instanceof f_?t="text":e instanceof iw?t="geom":e instanceof uE?t="shape-group":e instanceof g_&&(t="slice");return t}(e),i=document.createElement("dl"),o=["layer"];e instanceof v_&&o.push("symbol-instance"),e instanceof u_&&o.push("symbol-master"),e.props.isExpanded&&o.push("expand");var a="";e instanceof Vx&&(o.push("container"),a+='<span class="arrow"></span>'),e.mask&&(a+='<span class="mask"></span>'),i.className=o.join(" "),i.setAttribute("uuid",e.props.uuid),i.setAttribute("lv",t.toString());var s=document.createElement("dt");(t>3&&(s.style.paddingLeft=(t-3)*ms.treeLvPadding+"px"),e instanceof iw||e instanceof uE)?a+='<span class="type geom">'+e.toSvg(12)+"</span>":a+='<span class="type '.concat(n,'"></span>');if(a+='<span class="name" title="'.concat(e.props.name||"",'">').concat(e.props.name||"","</span>"),e instanceof qx||(e.props.isLocked&&(a+='<span class="lock"></span>'),a+='<span class="visible '.concat(e.computedStyle.visibility===tl.VISIBLE?"t":"",'"></span>')),s.innerHTML=a,i.appendChild(s),r)return i;if(e instanceof Vx){var l=e.children;if(l.length)for(var u=l.length-1;u>=0;u--){var c=document.createElement("dd");c.appendChild(nC(l[u],t+1)),i.appendChild(c)}}return i}var iC=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.silence=!1,e.getCurPage()&&this.init(),r.on(rC.HOVER_NODE,(function(e){n.hover(e)})),r.on(rC.UN_HOVER_NODE,(function(){n.unHover()})),r.on(rC.SELECT_NODE,(function(e){n.select(e)})),r.on(rC.REMOVE_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));n&&n.parentElement.remove()}}))})),r.on(rC.ADD_NODE,(function(e,r){e.forEach((function(e){var r,n=nC(e,e.struct.lv),i=document.createElement("dd");i.appendChild(n);var o=null===(r=e.prev)||void 0===r?void 0:r.props.uuid;if(o){if(a=t.querySelector('dl[uuid="'.concat(o,'"]')))a.parentElement.before(i)}else{var a,s=e.parent.props.uuid;(a=t.querySelector('dl[uuid="'.concat(s,'"]')))&&a.appendChild(i)}})),n.select(r||e)})),r.on(rC.GROUP_NODE,(function(e,r){e.forEach((function(e,n){var i,o=nC(e,e.struct.lv,!0),a=document.createElement("dd");a.appendChild(o),r[n].reverse().forEach((function(e){var r=e.props.uuid,n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*ms.treeLvPadding+"px",n.querySelectorAll("dl").forEach((function(e){var t=e.firstChild,r=e.getAttribute("lv");e.setAttribute("lv",(+r+1).toString()),t.style.paddingLeft=(+r+1-3)*ms.treeLvPadding+"px"})),o.appendChild(n.parentElement)}}));var s=null===(i=e.prev)||void 0===i?void 0:i.props.uuid;if(s){if(l=t.querySelector('dl[uuid="'.concat(s,'"]')))l.parentElement.before(a)}else{var l,u=e.parent.props.uuid;(l=t.querySelector('dl[uuid="'.concat(u,'"]')))&&l.appendChild(a)}})),n.select(e)})),r.on(rC.UN_GROUP_NODE,(function(e,r){e.forEach((function(e,n){var i=r[n].props.uuid;if(i){var o=t.querySelector('dl[uuid="'.concat(i,'"]'));if(o){var a=o.parentElement,s=document.createDocumentFragment();e.reverse().forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*ms.treeLvPadding+"px",n.querySelectorAll("dl").forEach((function(e){var t=e.firstChild,r=e.getAttribute("lv");e.setAttribute("lv",(+r-1).toString()),t.style.paddingLeft=(+r-1-3)*ms.treeLvPadding+"px"})),s.appendChild(n.parentElement)}}})),a.before(s),a.remove()}}}));var i=[];e.forEach((function(e){i.push.apply(i,e)})),n.select(i)})),r.on(rC.MASK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n)for(var i=n.parentElement,o=e.next;o&&!o.computedStyle.breakMask&&!o.computedStyle.maskMode;){var a=(i=i.previousElementSibling).firstElementChild.firstElementChild,s=a.querySelector(".mask");if(e.computedStyle.maskMode===Zs.NONE)s&&s.remove();else if(!s){var l=document.createElement("span");l.classList.add("mask"),a.prepend(l)}o=o.next}}}))})),r.on(rC.BREAK_MASK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.firstElementChild,o=i.querySelector(".mask");if(e.computedStyle.breakMask)o&&o.remove();else if(e.mask){if(!o)(l=document.createElement("span")).classList.add("mask"),i.prepend(l)}for(var a=n.parentElement,s=e.next;s&&!s.computedStyle.breakMask&&!s.computedStyle.maskMode;){var l,u=(a=a.previousElementSibling).firstElementChild.firstElementChild,c=u.querySelector(".mask");e.computedStyle.breakMask?c&&c.remove():c||((l=document.createElement("span")).classList.add("mask"),u.prepend(l)),s=s.next}}}}))})),r.on(rC.RENAME_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));n&&(n.querySelector("span.name").innerText=e.props.name||"")}}))})),r.on(rC.LOCK_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.firstElementChild,o=i.querySelector(".lock");if(e.props.isLocked){if(!o){var a=document.createElement("span");a.classList.add("lock"),i.querySelector(".name").after(a)}}else o&&o.remove()}}}))})),r.on(rC.VISIBLE_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=n.querySelector(".visible").classList;e.computedStyle.visibility===tl.VISIBLE?i.add("t"):i.remove("t")}}}))})),r.on(rC.ART_BOARD_NODE,(function(e){e.forEach((function(e){var r=e.props.uuid;if(r){var n=t.querySelector('dl[uuid="'.concat(r,'"]'));if(n){var i=e.struct.lv;n.setAttribute("lv",i.toString()),n.querySelector("dt").style.paddingLeft=(i-3)*ms.treeLvPadding+"px";var o=n.parentElement;o.remove();var a=e.prev,s=e.next;if(a){var l=a.props.uuid;(u=t.querySelector('dl[uuid="'.concat(l,'"]')))&&u.parentElement.before(o)}else if(s){console.log(s);l=s.props.uuid;(u=t.querySelector('dl[uuid="'.concat(l,'"]')))&&u.parentElement.after(o)}else{var u;l=e.parent.props.uuid;(u=t.querySelector('dl[uuid="'.concat(l,'"]')))&&u.parentElement.appendChild(o)}}}}))})),t.addEventListener("selectstart",(function(e){e.preventDefault()}));var i=function(n,i){void 0===i&&(i=!1);var o=n.querySelector("dt"),a=t.querySelectorAll("dt.active");if(1!==a.length||a[0]!==o){a.forEach((function(e){e.classList.remove("active")})),o.classList.add("active");var s=n.getAttribute("uuid");if(s){var l=e.refs[s];if(l)if(i)-1===(c=(u=r.selected.slice(0)).indexOf(l))&&(u.splice(0),u.push(l)),r.active(u);else if(r.metaKey){var u,c;(c=(u=r.selected.slice(0)).indexOf(l))>-1?u.splice(c,1):u.push(l),r.active(u)}else r.active([l])}}};t.addEventListener("click",(function(t){n.silence=!0;var o=t.target,a=o.classList,s="DT"===o.tagName.toUpperCase();if(a.contains("arrow"))(l=(c=o.parentElement.parentElement).getAttribute("uuid"))&&(u=e.refs[l])&&((u.props.isExpanded=!u.props.isExpanded)?c.classList.add("expand"):c.classList.remove("expand"));else if(a.contains("visible")){if(l=(c=o.parentElement.parentElement).getAttribute("uuid"))(u=e.refs[l])&&r.visible(a.contains("t")?"visible":"hidden",[u])}else if(a.contains("lock")){var l;if(l=(c=o.parentElement.parentElement).getAttribute("uuid")){var u=e.refs[l];r.lock(!1,[u])}o.remove()}else if(a.contains("name")||a.contains("type")||s){var c=s?o.parentElement:o.parentElement.parentElement;i(c)}else r.active([]);n.silence=!1}));var o=function(t){var n=t.value,i=t.parentElement.parentElement.getAttribute("uuid"),o=e.refs[i],a=t.nextSibling;t.remove(),a.style.display="block",o&&r.rename([o],[n])};t.addEventListener("dblclick",(function(e){var t=e.target;if(t.classList.contains("name")){t.style.display="none";var r=document.createElement("input");r.type="text",r.value=t.innerText,t.parentElement.insertBefore(r,t),r.focus();var n=!1;r.onblur=function(){n||(n=!0,o(r))},r.onkeydown=function(e){var t=e.keyCode,i=e.code;27===t||"Escape"===i?(e.stopPropagation(),n||(n=!0,o(r))):13!==t&&"Enter"!==i||n||(n=!0,o(r))},r.onchange=function(){n||(n=!0,o(r))}}})),t.addEventListener("mousemove",(function(t){var n=t.target;"SPAN"===n.nodeName&&(n=n.parentElement);var i=n.parentElement.getAttribute("uuid");if(i){var o=e.refs[i];if(o)return void r.select.showHover(o)}r.select.hideHover()})),t.addEventListener("mouseleave",(function(){r.select.hideHover()})),t.addEventListener("contextmenu",(function(e){var t;if(!(null===(t=r.options.disabled)||void 0===t?void 0:t.contextMenu)){e.preventDefault(),n.silence=!0;var o=e.target,a=o.classList,s="DT"===o.tagName.toUpperCase();if(a.contains("name")||a.contains("type")||s){var l=s?o.parentElement:o.parentElement.parentElement;i(l,!0)}n.silence=!1,AS.showTree(e.pageX,e.pageY,n.listener)}}))}return e.prototype.init=function(){this.dom.innerHTML="";var e=document.createElement("dl");this.dom.appendChild(e);var t=this.root.getCurPage();if(t){e.setAttribute("uuid",t.props.uuid);var r=t.children;if(!r.length)return;for(var n=new DocumentFragment,i=r.length-1;i>=0;i--){var o=r[i],a=nC(o,o.struct.lv),s=document.createElement("dd");s.appendChild(a),n.appendChild(s)}e.appendChild(n)}},e.prototype.hover=function(e){var t=this.dom.querySelector("dt.hover"),r=e.props.uuid;if(r){var n=this.dom.querySelector('dl[uuid="'.concat(r,'"] dt'));n&&(n.classList.add("hover"),n!==t&&t&&t.classList.remove("hover"))}},e.prototype.unHover=function(){var e=this.dom.querySelector("dt.hover");e&&e.classList.remove("hover")},e.prototype.select=function(e){var t=this;this.dom.querySelectorAll("dt.active").forEach((function(e){e.classList.remove("active")})),e.forEach((function(e){var r=t.dom.querySelector('dl[uuid="'.concat(e.props.uuid,'"] dt'));if(r){for(var n=r.parentElement;n;){if("DL"===n.nodeName){n.classList.add("expand");var i=n.getAttribute("uuid");if(i){var o=t.root.refs[i];o&&(o.props.isExpanded=!0)}}if(n===t.dom)break;n=n.parentElement}r.classList.add("active"),t.silence||(r.scrollIntoViewIfNeeded?r.scrollIntoViewIfNeeded():r.scrollIntoView())}}))},e}(),oC=function(){function e(e,t,r){var n=this;this.root=e,this.dom=t,this.listener=r,this.nodes=[],this.silence=!1,r.on([rC.SELECT_NODE,rC.ADD_NODE,rC.GROUP_NODE],(function(e){n.silence||n.show(e)})),r.on([rC.UN_GROUP_NODE],(function(e){var t=[];e.forEach((function(e){t.push.apply(t,e)})),n.show(t)})),r.on(rC.REMOVE_NODE,(function(){n.silence||n.show([])}))}return e.prototype.show=function(e){this.nodes=e},e}(),aC=function(e){function t(t,r){var n=e.call(this,t)||this;return n.data=r,n}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.constrainProportions=t[r].next}))},t.prototype.undo=function(){var e=this.nodes,t=this.data;e.forEach((function(e,r){e.props.constrainProportions=t[r].prev}))},t}(xS),sC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.data=[];var o=i.panel=document.createElement("div");o.className="basic-panel",o.innerHTML='\n  <div class="line">\n    <div class="input-unit">\n      <input type="number" class="x" step="1"/>\n      <span class="unit">X</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="y" step="1"/>\n      <span class="unit">Y</span>\n    </div>\n    <div class="input-unit">\n      <input type="number" class="r" step="1"/>\n      <span class="unit"></span>\n    </div>\n  </div>\n  <div class="line">\n    <div class="input-unit">\n      <input type="number" class="w" step="1"/>\n      <span class="unit">W</span>\n    </div>\n    <div class="cp"></div>\n    <div class="input-unit">\n      <input type="number" class="h" step="1"/>\n      <span class="unit">H</span>\n    </div>\n    <span class="fh" title=""></span>\n    <span class="fv" title=""></span>\n  </div>\n',r.appendChild(o);var a=o.querySelector(".x"),s=o.querySelector(".y"),l=o.querySelector(".r"),u=o.querySelector(".w"),c=o.querySelector(".h"),h=o.querySelector(".cp"),d=o.querySelector(".fh"),f=o.querySelector(".fv"),p=[],v=[],g=[],m=[],y=[],b=[],x=function(e,t){void 0===t&&(t=!0),i.silence=!0;var r=!p.length;r&&(v=[],g=[],y=[]),b=[];var o=parseFloat(t?a.value:s.value)||0,l=e instanceof InputEvent;i.nodes.forEach((function(e,u){r&&(p.push(e),v.push(e.getStyle()),g.push(e.getComputedStyle()),y.push(t?i.data[u].x:i.data[u].y));var c=y[u],h=o,d=0;l?d=h-c:(d=(t?a.placeholder:s.placeholder)?h:h-c,n.shiftKey?d=d>0?10:-10:n.altKey&&(d=d>0?.1:-.1),h=c+d),b.push(h),e.artBoard!==(t?MS.update(e,g[u],d,0):MS.update(e,g[u],0,d))&&n.emit(rC.ART_BOARD_NODE,[e])})),p.length&&(n.select.updateSelect(i.nodes),n.emit(rC.MOVE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1},w=function(e){if(void 0===e&&(e=!0),p.length){var t=[];p.forEach((function(r,n){var i=b[n]-y[n];e?(r.endPosChange(v[n],i,0),t.push({dx:i,dy:0})):(r.endPosChange(v[n],0,i),t.push({dx:0,dy:i})),r.checkPosSizeUpward()})),n.history.addCommand(new MS(p,t)),p=[],v=[],g=[],y=[],b=[]}};a.addEventListener("input",(function(e){x(e,!0)})),a.addEventListener("change",(function(e){w(!0)})),s.addEventListener("input",(function(e){x(e,!1)})),s.addEventListener("change",(function(e){w(!1)})),l.addEventListener("input",(function(e){i.silence=!0;var t=!p.length;t&&(g=[],y=[]),b=[];var r=e instanceof InputEvent;i.nodes.forEach((function(e,o){t&&(p.push(e),g.push(e.getComputedStyle()),y.push(i.data[o].rotation));var a=y[o],s=parseFloat(l.value)||0,u=0;r?u=s-a:(u=l.placeholder?s:s-a,n.shiftKey?u=u>0?10:-10:n.altKey&&(u=u>0?.1:-.1),s=a+u),b.push(s),e.updateStyle({rotateZ:g[o].rotateZ+u})})),p.length&&(n.select.updateSelect(i.nodes),n.emit(rC.ROTATE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1})),l.addEventListener("change",(function(e){p.length&&(n.history.addCommand(new DS(p,y.map((function(e,t){return{prev:{rotateZ:e},next:{rotateZ:b[t]}}})))),p=[],g=[],y=[],b=[])}));var _=function(e,t){void 0===t&&(t=!0),i.silence=!0,n.beforeResize();var r=!1;if(!r)for(var o=0,a=n.selected.length;o<a;o++)if(n.selected[o].props.constrainProportions){r=!0;break}var s=!p.length;s&&(v=[],g=[],m=[],y=[]),b=[];var l=parseFloat(t?u.value:c.value)||0,h=e instanceof InputEvent;i.nodes.forEach((function(e,o){if(s){p.push(e),v.push(e.getStyle()),e.startSizeChange(),g.push(e.getComputedStyle()),m.push(e.getCssStyle()),y.push(t?i.data[o].w:i.data[o].h);var a=e.parent;a&&a.isGroup&&a instanceof l_&&(a.fixedPosAndSize=!0)}var d=y[o],f=l,x=0;h?x=f-d:(x=(t?u.placeholder:c.placeholder)?f:f-d,n.shiftKey?x=x>0?10:-10:n.altKey&&(x=x>0?.1:-.1),f=d+x),b.push(f),LS.updateStyle(e,g[o],m[o],t?x:0,t?0:x,t?CS.R:CS.B,r)})),p.length&&(n.select.updateSelect(i.nodes),n.emit(rC.RESIZE_NODE,p.slice(0)),i.show(i.nodes)),i.silence=!1},E=function(e){if(void 0===e&&(e=!0),p.length){var t=n.shiftKey;if(!t)for(var r=0,i=n.selected.length;r<i;r++)if(n.selected[r].props.constrainProportions){t=!0;break}var o=[];p.forEach((function(r,n){var i=r.parent;i&&i.isGroup&&i instanceof l_&&(i.fixedPosAndSize=!1),r.endSizeChange(v[n]),r.checkPosSizeUpward();var a=b[n]-y[n],s={dx:e?a:0,dy:e?0:a,controlType:e?CS.R:CS.B,aspectRatio:t,fromCenter:!1};v[n].width.u===Us.AUTO&&(s.widthFromAuto=!0),v[n].height.u===Us.AUTO&&(s.heightFromAuto=!0),g[n].scaleX!==r.computedStyle.scaleX&&(s.flipX=!0),g[n].scaleY!==r.computedStyle.scaleY&&(s.flipY=!0),o.push(s)})),p.length&&o.length&&n.history.addCommand(new LS(p,o)),p=[],v=[],g=[],y=[],b=[]}};return u.addEventListener("input",(function(e){_(e,!0)})),u.addEventListener("change",(function(e){E(!0)})),c.addEventListener("input",(function(e){_(e,!1)})),c.addEventListener("change",(function(e){E(!1)})),h.addEventListener("click",(function(e){i.silence=!0,h.classList.contains("active")?h.classList.remove("active"):h.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e){var n=!!e.props.constrainProportions,i=h.classList.contains("active");n!==i&&(e.props.constrainProportions=i,t.push(e),r.push({prev:n,next:i}))})),t.length&&(n.history.addCommand(new aC(t,r)),n.emit(rC.CONSTRAIN_PROPORTION_NODE,t.slice(0))),i.silence=!1})),d.addEventListener("click",(function(e){i.silence=!0,d.classList.contains("active")?d.classList.remove("active"):d.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e,n){var i=e.computedStyle.scaleX,o=d.classList.contains("active")?-1:1;i!==o&&(e.updateStyle({scaleX:o}),t.push(e),r.push({prev:{scaleX:i},next:{scaleX:o}}))})),t.length&&(n.history.addCommand(new OS(t,r)),n.select.updateSelect(i.nodes),n.emit(rC.FLIP_H_NODE,t.slice(0))),i.silence=!1})),f.addEventListener("click",(function(e){i.silence=!0,f.classList.contains("active")?f.classList.remove("active"):f.classList.add("active");var t=[],r=[];i.nodes.forEach((function(e,n){var i=e.computedStyle.scaleY,o=f.classList.contains("active")?-1:1;i!==o&&(e.updateStyle({scaleY:o}),t.push(e),r.push({prev:{scaleX:i},next:{scaleX:o}}))})),t.length&&(n.history.addCommand(new OS(t,r)),n.select.updateSelect(i.nodes),n.emit(rC.FLIP_V_NODE,t.slice(0))),i.silence=!1})),n.on([rC.MOVE_NODE,rC.RESIZE_NODE,rC.ROTATE_NODE,rC.FLIP_H_NODE,rC.FLIP_V_NODE,rC.CONSTRAIN_PROPORTION_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){var t=this;this.nodes=e,this.data=[];var r=this.panel;if(!e.length)return r.querySelectorAll(".input-unit,.cp,.fh,.fv").forEach((function(e){e.classList.add("disabled"),e.classList.remove("active")})),void r.querySelectorAll("input").forEach((function(e){e.disabled=!0,e.placeholder="",e.value=""}));r.querySelectorAll(".input-unit,.cp,.fh,.fv").forEach((function(e){e.classList.remove("disabled")})),r.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder="",e.value=""}));var n=[],i=[],o=[],a=[],s=[],l=[],u=[],c=[];e.forEach((function(e){var r=oE(e),h=r.x,d=r.y,f=r.rotation,p=r.w,v=r.h,g=r.isFlippedHorizontal,m=r.isFlippedVertical,y=r.constrainProportions;t.data.push(r),n.includes(h)||n.push(h),i.includes(d)||i.push(d),o.includes(f)||o.push(f),a.includes(p)||a.push(p),s.includes(v)||s.push(v),l.includes(y)||l.push(y),u.includes(g)||u.push(g),c.includes(m)||c.push(m)}));var h=r.querySelector(".x"),d=r.querySelector(".y"),f=r.querySelector(".r"),p=r.querySelector(".w"),v=r.querySelector(".h"),g=r.querySelector(".cp"),m=r.querySelector(".fh"),y=r.querySelector(".fv");n.length>1?h.placeholder="":h.value=dc(n[0]).toString(),i.length>1?d.placeholder="":d.value=dc(i[0]).toString(),f.disabled=e.filter((function(e){return e.isSlice&&e instanceof g_})).length>0,o.length>1?f.placeholder="":f.value=dc(o[0]).toString(),a.length>1?p.placeholder="":p.value=dc(a[0]).toString(),s.length>1?v.placeholder="":v.value=dc(s[0]).toString(),l.length>1||l[0]?g.classList.add("active"):g.classList.remove("active"),u.includes(!0)?m.classList.add("active"):m.classList.remove("active"),c.includes(!0)?y.classList.add("active"):y.classList.remove("active")},t}(oC),lC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="opacity-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title"></h4>\n  <div class="line">\n    <input type="range" min="0" max="100" step="1"/>\n    <div class="input-unit">\n      <input type="number" min="0" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n',r.appendChild(o);var a=o.querySelector("input[type=range]"),s=o.querySelector("input[type=number]"),l=[],u=[],c=[];return a.addEventListener("input",(function(e){var t=!l.length;t&&(u=[]),c=[],i.nodes.forEach((function(e){var r=e.computedStyle.opacity,n=.01*parseFloat(a.value);r!==n&&(e.updateStyle({opacity:n}),t&&(l.push(e),u.push(r)),c.push(n))})),a.style.setProperty("--p",a.value),s.value=a.value,s.placeholder=""})),a.addEventListener("change",(function(e){l.length&&(n.history.addCommand(new NS(l,u.map((function(e,t){return{prev:{opacity:e},next:{opacity:c[t]}}})))),n.emit(rC.OPACITY_NODE,l.slice(0)),l=[],u=[],c=[])})),s.addEventListener("input",(function(e){i.silence=!0;var t=!l.length;t&&(u=[]),c=[];var r=e instanceof InputEvent,o=Math.min(100,Math.max(0,parseFloat(s.value)||0));i.nodes.forEach((function(e,i){var a=100*e.computedStyle.opacity,h=o,d=0;r?(d=h-a,i||(s.placeholder="")):(0===h&&(h=-1),d=s.placeholder?h:h-a,n.shiftKey&&(d=d>0?10:-10),h=a+d,h=Math.max(h,0),h=Math.min(h,100),i||(s.value=s.placeholder?"":h.toString())),d&&a!==h&&(e.updateStyle({opacity:.01*h}),t&&(l.push(e),u.push(.01*a)),c.push(.01*h))})),a.value=s.value||"0",a.style.setProperty("--p",a.value),l.length&&n.emit(rC.OPACITY_NODE,l.slice(0)),i.silence=!1})),s.addEventListener("change",(function(e){l.length&&(n.history.addCommand(new NS(l,u.map((function(e,t){return{prev:{opacity:e},next:{opacity:c[t]}}})))),l=[],u=[],c=[])})),n.on([rC.OPACITY_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){this.nodes=e;var t=this.panel;if(e.length){t.style.display="block",t.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder="",e.value=""}));var r=[];e.forEach((function(e){var t=e.computedStyle.opacity;r.includes(t)||r.push(t)}));var n=t.querySelector("input[type=range]"),i=t.querySelector("input[type=number]");if(r.length>1)n.value="0",n.style.setProperty("--p","0"),i.placeholder="";else{var o=Math.round(100*r[0]).toString();n.value=o,n.style.setProperty("--p",o),i.value=o}}else t.style.display="none"},t}(oC),uC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");return o.className="round-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title"></h4>\n  <div class="line">\n    <input type="range" min="0" max="100" step="1"/>\n    <div class="input-unit">\n      <input type="number" min="0" max="100" step="1"/>\n    </div>\n  </div>\n',r.appendChild(o),i}return v(t,e),t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){var o=e[n];if(o instanceof pw||o instanceof uE){r=!0;break}}if(r){t.style.display="block",t.querySelectorAll("input").forEach((function(e){e.placeholder="",e.value=""}));var a=e.filter((function(e){return e instanceof pw||e instanceof uE}));this.nodes=a;var s=[];a.forEach((function(e){e instanceof pw?e.points.forEach((function(e){var t=e.cornerRadius;s.includes(t)||s.push(t)})):e instanceof uE&&e.children.forEach((function(e){e instanceof pw&&e.points.forEach((function(e){var t=e.cornerRadius;s.includes(t)||s.push(t)}))}))}));var l=t.querySelector("input[type=range]"),u=t.querySelector("input[type=number]");if(s.length>1)l.value="0",l.style.setProperty("--p","0"),u.placeholder="";else{var c=dc(100*s[0],2).toString();l.value=c,l.style.setProperty("--p",c),u.value=c}}else t.style.display="none"},t}(oC);var cC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="fill-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title"></h4>\n',r.appendChild(o);var a=[],s=[],l=[],u=function(){l.length&&n.history.addCommand(new HS(a,s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[]};return o.addEventListener("click",(function(e){var t=e.target,r=t.classList;if(r.contains("pick")){if(e.stopPropagation(),t.parentElement.classList.contains("read-only"))return;if(ES.isShowFrom("fillPanel"))return void ES.hide();a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.fill,n=t.fillEnable,i=t.fillOpacity,o=r.map((function(t){return Uc(t,e.width,e.height)}));s.push({fill:o,fillOpacity:i,fillEnable:n})}));var c=t.parentElement.parentElement.parentElement,h=parseInt(c.title);ES.show(t,i.nodes[0].computedStyle.fill[0],"fillPanel",(function(e){i.silence=!0;var t=c.querySelector(".pick").style;if(Array.isArray(e)){o.querySelector(".value .hex").classList.remove("hide"),o.querySelector(".value .gradient").classList.add("hide"),o.querySelector(".value .multi-type").classList.add("hide");var r=Mc(e);c.querySelector(".hex input").value=r.slice(1),t.background=Tc(e)}else{if(void 0!==e.url);else o.querySelector(".value .hex").classList.add("hide"),o.querySelector(".value .gradient").classList.remove("hide"),o.querySelector(".value .multi-type").classList.add("hide"),o.querySelector(".value .gradient select").value=e.t.toString(),t.background=Uc(e,i.nodes[0].width,i.nodes[0].height,!0)}l=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.fill,i=r.fillEnable,o=r.fillOpacity,a=n.map((function(r,n){return Uc(n===h?e:r,t.width,t.height)})),s={fill:a,fillOpacity:o,fillEnable:i};l.push(s),t.updateStyle(s)})),a.length&&n.emit(rC.FILL_NODE,a.slice(0)),i.silence=!1}),u)}else if(r.contains("enabled")){i.silence=!0;var d=t.parentElement,f=parseInt(d.title),p=i.nodes.slice(0),v=[],g=[],m=!1;(r.contains("multi-checked")||r.contains("un-checked"))&&(m=!0),p.forEach((function(e){var t=e.getComputedStyle(),r=t.fill,n=t.fillEnable,i=t.fillOpacity,o=r.map((function(t){return Uc(t,e.width,e.height)}));v.push({fill:o,fillOpacity:i,fillEnable:n});var a=o.slice(0),s=n.slice(0),l=i.slice(0);void 0!==s[f]&&(s[f]=m);var u={fill:a,fillEnable:s,fillOpacity:l};g.push(u),e.updateStyle(u)})),r.remove("multi-checked"),m?(r.remove("un-checked"),r.add("checked"),d.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(r.remove("checked"),r.add("un-checked"),d.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),p.length&&(n.emit(rC.FILL_NODE,p.slice(0)),n.history.addCommand(new HS(p,v.map((function(e,t){return{prev:e,next:g[t]}}))))),i.silence=!1}})),o.addEventListener("keydown",(function(e){var t=e.target;if("INPUT"===t.tagName.toUpperCase()&&"text"===t.type){var r=e.keyCode,i=e.code;e.metaKey||n.isWin&&e.ctrlKey||e.shiftKey||e.altKey||r>=48&&r<=57||/Digit\d/.test(i)||r>=37&&r<=40||["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(i)||r>=65&&r<=90||/Key[A-Z]/.test(i)||8===r||"Backspace"===i||46===r||"Delete"===i||27===r||"Escape"===i||13===r||"Enter"===i||20===r||"CapsLock"===i||e.preventDefault()}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=t.parentElement.parentElement.parentElement,o=parseInt(r.title),u=!a.length;if(u&&(s=[]),l=[],"text"===t.type){var c=kc(t.value);i.nodes.forEach((function(e,t){if(u){a.push(e);var r=e.getComputedStyle(),n=r.fill,i=r.fillEnable,h=r.fillOpacity,d=n.map((function(t){return Uc(t,e.width,e.height)}));s.push({fill:d,fillOpacity:h,fillEnable:i})}var f={fill:s[t].fill.slice(0),fillOpacity:s[t].fillOpacity.slice(0),fillEnable:s[t].fillEnable.slice(0)};l.push(f),f.fill[o]=c,e.updateStyle(f)})),t.placeholder="";var h=r.querySelector(".picker-btn b");h.title=h.style.background=Tc(c)}else if("number"===t.type){var d=Math.min(100,Math.max(0,parseFloat(t.value)||0)),f=e instanceof InputEvent;i.nodes.forEach((function(e,r){if(u){a.push(e);var i=e.getComputedStyle(),c=i.fill,h=i.fillEnable,p=i.fillOpacity,v=c.map((function(t){return Uc(t,e.width,e.height)}));s.push({fill:v,fillOpacity:p,fillEnable:h})}var g={fill:s[r].fill.slice(0),fillOpacity:s[r].fillOpacity.slice(0),fillEnable:s[r].fillEnable.slice(0)};l.push(g);var m=100*s[r].fillOpacity[o],y=d,b=0;f?(b=y-m,r||(t.placeholder="")):(0===y&&(y=-1),b=t.placeholder?y:y-m,n.shiftKey&&(b=b>0?10:-10),y=m+b,y=Math.max(y,0),y=Math.min(y,100),r||(t.value=t.placeholder?"":y.toString())),b&&(g.fillOpacity[o]=.01*y,e.updateStyle(g))}))}a.length&&n.emit(rC.FILL_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",(function(e){var t=e.target,r=t.tagName.toUpperCase();if("SELECT"===r)if(t.parentElement.classList.contains("pattern"));else{var o=t.parentElement.parentElement.parentElement,c=parseInt(o.title);a=i.nodes.slice(0),s=[],l=[],a.forEach((function(e){var r=e.getComputedStyle(),n=r.fill,i=r.fillEnable,o=r.fillOpacity,a=n.map((function(t){return Uc(t,e.width,e.height)}));s.push({fill:a,fillOpacity:o,fillEnable:i});var u=n.map((function(r,n){return n===c?(r.t=parseInt(t.value),Uc(r,e.width,e.height)):Uc(r,e.width,e.height)})),h={fill:u,fillOpacity:o,fillEnable:i};l.push(h),e.updateStyle(h)})),u(),a.length&&n.emit(rC.FILL_NODE,a.slice(0))}else"INPUT"===r&&u()})),n.on([rC.FILL_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),this.nodes=e.filter((function(e){return e instanceof pw||e instanceof uE||e instanceof f_||e instanceof Qx})),this.nodes.length){t.style.display="block";var r=[],n=[],i=[];this.nodes.forEach((function(e){var t=e.getComputedStyle(),o=t.fill,a=t.fillEnable,s=t.fillOpacity;o.forEach((function(e,t){(r[t]=r[t]||[]).push(e)})),a.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),s.forEach((function(e,t){var r=i[t]=i[t]||[];r.includes(e)||r.push(e)}))}));for(var o=function(e){var o=r[e],s=n[e],l=i[e],u=[],c=[],h=[];o.forEach((function(e){if(Array.isArray(e)){var t=Tc(e);u.includes(t)||u.push(t)}else{var r=e;if(void 0===r.url){var n=e;var i=0;e:for(d=h.length;i<d;i++){if((f=h[i]).t===n.t&&f.d.length===n.d.length){for(var o=f.d.length-1;o>=0;o--)if(f.d[o]!==n.d[o])continue e;if(f.stops.length===n.stops.length){for(o=f.stops.length-1;o>=0;o--){var a=f.stops[o],s=n.stops[o];if(a.color[0]!==s.color[0]||a.color[1]!==s.color[1]||a.color[2]!==s.color[2]||a.color[3]!==s.color[3]||a.offset!==s.offset)continue e}return}}}h.push(n)}else{for(var l=0,d=c.length;l<d;l++){var f;if((f=c[l]).url===r.url&&f.type===r.type&&f.scale===r.scale)return}c.push(r)}}})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,u){var c,h,d,f,p,v,g,m=o.length>1,y=a.length>1,b=s.length>1,x=(o.length?1:0)+(a.length?1:0)+(s.length?1:0)>1,w=x||m||y||b,_=t||!r||x||y||b||a.length?'readonly="readonly"':"",E="",S=" ",C=" ",k="";if(x)S="";else if(o.length)S="",C="Hex",1===o.length&&(E=o[0]);else if(a.length){if(S="",C="",k=["","","",""][a[0].type],1===a.length)E=Uc(a[0],l,u,!0);else for(var T=1,A=a.length;T<A;T++)if(a[T].type!==a[0].type){k="";break}}else if(s.length)if(S="",C="",k=["","",""][s[0].t],1===s.length)E=Uc(s[0],l,u,!0);else for(T=1,A=s.length;T<A;T++)if(s[T].t!==s[0].t){k="";break}return'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(_?"read-only":"",'">\n        <b class="pick ').concat(w?"multi":"",'" style="').concat(w?"":"background:".concat(E),'"></b>\n      </span>\n      <span class="txt">').concat(S,'</span>\n    </div>\n    <div class="value">\n      <div class="hex ').concat(a.length||s.length?"hide":"",'">\n        <span>#</span>\n        <input type="text" value="').concat(m?"":Mc(o[0]).slice(1),'" placeholder="').concat(m?"":"",'" maxlength="8"/>\n      </div>\n      <div class="pattern ').concat(o.length||s.length||y?"hide":"",'">\n        <select disabled="disabled">\n          <option value="').concat(el.FILL,'" ').concat((null===(c=a[0])||void 0===c?void 0:c.type)===el.FILL?'selected="selected"':"",'></option>\n          <option value="').concat(el.FIT,'" ').concat((null===(h=a[0])||void 0===h?void 0:h.type)===el.FIT?'selected="selected"':"",'></option>\n          <option value="').concat(el.STRETCH,'" ').concat((null===(d=a[0])||void 0===d?void 0:d.type)===el.STRETCH?'selected="selected"':"",'></option>\n          <option value="').concat(el.TILE,'" ').concat((null===(f=a[0])||void 0===f?void 0:f.type)===el.TILE?'selected="selected"':"",'></option>\n        </select>\n      </div>\n      <div class="gradient ').concat(o.length||a.length||b?"hide":"",'">\n        <select>\n          <option value="').concat(js.LINEAR,'" ').concat((null===(p=s[0])||void 0===p?void 0:p.t)===js.LINEAR?'selected="selected"':"",'></option>\n          <option value="').concat(js.RADIAL,'" ').concat((null===(v=s[0])||void 0===v?void 0:v.t)===js.RADIAL?'selected="selected"':"",'></option>\n          <option value="').concat(js.CONIC,'" ').concat((null===(g=s[0])||void 0===g?void 0:g.t)===js.CONIC?'selected="selected"':"",'></option>\n        </select>\n      </div>\n      <div class="multi-type ').concat(x||y||b?"":"hide",'">\n        <select disabled="disabled">\n          <option>').concat(k,'</option>\n        </select>\n      </div>\n      <span class="txt">').concat(C,'</span>\n    </div>\n    <div class="opacity">\n      <div class="input-unit">\n        <input type="number" min="0" max="100" step="1" value="').concat(n?"":100*i,'" placeholder="').concat(n?"":"",'"/>\n        <span class="unit">%</span>\n      </div>\n      <span class="txt"></span>\n    </div>\n  </div>')}(e,s.length>1,s[0],l.length>1,l[0],u,c,h,a.nodes[0].width,a.nodes[0].height)},a=this,s=r.length-1;s>=0;s--)o(s)}else t.style.display="none"},t}(oC);var hC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="stroke-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title"></h4>\n',r.appendChild(o);var a=[],s=[],l=[],u=function(){l&&l.length&&n.history.addCommand(new GS(a.slice(0),s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[]};return o.addEventListener("click",(function(e){var t,r=e.target,o=r.classList;if(o.contains("pick")){if(e.stopPropagation(),r.parentElement.classList.contains("read-only"))return;if(ES.isShowFrom("strokePanel"))return void ES.hide();a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return Uc(t,e.width,e.height)}));s.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return zc(e)})),strokeWidth:o})}));var c=r.parentElement.parentElement.parentElement,h=parseInt(c.title);ES.show(r,i.nodes[0].computedStyle.stroke[0],"strokePanel",(function(e){i.silence=!0,l=[],i.nodes.forEach((function(t){var r=t.getComputedStyle(),n=r.stroke,i=r.strokeEnable,o=r.strokePosition,a=r.strokeWidth,s=n.map((function(r,n){return Uc(n===h?e:r,t.width,t.height)})),u={stroke:s,strokeEnable:i,strokePosition:o.map((function(e){return zc(e)})),strokeWidth:a};l.push(u),t.updateStyle(u)}));var t=c.querySelector(".pick").style;Array.isArray(e)?t.background=Tc(e):t.background=Uc(e,i.nodes[0].width,i.nodes[0].height,!0),a.length&&n.emit(rC.STROKE_NODE,a.slice(0)),i.silence=!1}),u)}else if(o.contains("enabled")){i.silence=!0;var d=r.parentElement,f=parseInt(d.title),p=i.nodes.slice(0),v=[],g=[],m=!1;(o.contains("multi-checked")||o.contains("un-checked"))&&(m=!0),p.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return Uc(t,e.width,e.height)}));v.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return zc(e)})),strokeWidth:o});var s=a.slice(0),l=n.slice(0),u=i.map((function(e){return zc(e)})),c=o.slice(0);void 0!==l[f]&&(l[f]=m);var h={stroke:s,strokeEnable:l,strokePosition:u,strokeWidth:c};g.push(h),e.updateStyle(h)})),o.remove("multi-checked"),m?(o.remove("un-checked"),o.add("checked"),d.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(o.remove("checked"),o.add("un-checked"),d.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),p.length&&(n.emit(rC.STROKE_NODE,p.slice(0)),n.history.addCommand(new GS(p.slice(0),v.map((function(e,t){return{prev:e,next:g[t]}}))))),i.silence=!1}else if(o.contains("p")&&!o.contains("cur")){i.silence=!0,null===(t=r.parentElement.querySelector(".cur"))||void 0===t||t.classList.remove("cur"),r.classList.add("cur");d=r.parentElement.parentElement.parentElement;var y=parseInt(d.title),b=i.nodes.slice(0),x=[],w=[],_="inside";o.contains("center")?_="center":o.contains("outside")&&(_="outside"),b.forEach((function(e){var t=e.getComputedStyle(),r=t.stroke,n=t.strokeEnable,i=t.strokePosition,o=t.strokeWidth,a=r.map((function(t){return Uc(t,e.width,e.height)}));x.push({stroke:a,strokeEnable:n,strokePosition:i.map((function(e){return zc(e)})),strokeWidth:o});var s=a.slice(0),l=n.slice(0),u=i.map((function(e){return zc(e)})),c=o.slice(0);void 0!==u[y]&&(u[y]=_);var h={stroke:s,strokeEnable:l,strokePosition:u,strokeWidth:c};w.push(h),e.updateStyle(h)})),b.length&&(n.emit(rC.STROKE_NODE,b.slice(0)),n.history.addCommand(new GS(b.slice(0),x.map((function(e,t){return{prev:e,next:w[t]}}))))),i.silence=!1}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=t.parentElement.parentElement.parentElement,o=parseInt(r.title),u=!a.length;u&&(s=[]),l=[];var c=Math.min(100,Math.max(0,parseFloat(t.value)||0)),h=e instanceof InputEvent;i.nodes.forEach((function(e,r){if(u){a.push(e);var i=e.getComputedStyle(),d=i.stroke,f=i.strokeEnable,p=i.strokePosition,v=i.strokeWidth,g=d.map((function(t){return Uc(t,e.width,e.height)}));s.push({stroke:g,strokeEnable:f,strokePosition:p.map((function(e){return zc(e)})),strokeWidth:v})}var m={stroke:s[r].stroke.slice(0),strokeEnable:s[r].strokeEnable.slice(0),strokePosition:s[r].strokePosition.slice(0),strokeWidth:s[r].strokeWidth.slice(0)};l.push(m);var y=s[r].strokeWidth[o],b=c,x=0;h?(x=b-y,r||(t.placeholder="")):(0===b&&(b=-1),x=t.placeholder?b:b-y,n.shiftKey?x=x>0?10:-10:n.altKey&&(x=x>0?.1:-.1),b=y+x,b=Math.max(b,0),b=Math.min(b,100),r||(t.value=t.placeholder?"":b.toString())),x&&(m.strokeWidth[o]=b,e.updateStyle(m))})),a.length&&n.emit(rC.STROKE_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",u),n.on([rC.STROKE_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),this.nodes=e.filter((function(e){return e instanceof pw||e instanceof uE||e instanceof f_||e instanceof Qx})),this.nodes.length){t.style.display="block";var r=[],n=[],i=[],o=[];this.nodes.forEach((function(e){var t=e.getComputedStyle(),a=t.stroke,s=t.strokeEnable,l=t.strokePosition,u=t.strokeWidth;a.forEach((function(e,t){(r[t]=r[t]||[]).push(e)})),s.forEach((function(e,t){var r=n[t]=n[t]||[];r.includes(e)||r.push(e)})),l.forEach((function(e,t){var r=i[t]=i[t]||[],n=zc(e);r.includes(n)||r.push(n)})),u.forEach((function(e,t){var r=o[t]=o[t]||[];r.includes(e)||r.push(e)}))}));for(var a=function(e){var a=r[e],l=n[e],u=i[e],c=o[e],h=[],d=[],f=[];a.forEach((function(e){if(Array.isArray(e)){var t=Tc(e);h.includes(t)||h.push(t)}else{var r=e;if(void 0===r.url){var n=e;var i=0;e:for(u=f.length;i<u;i++){if((c=f[i]).t===n.t&&c.d.length===n.d.length){for(var o=c.d.length-1;o>=0;o--)if(c.d[o]!==n.d[o])continue e;if(c.stops.length===n.stops.length){for(o=c.stops.length-1;o>=0;o--){var a=c.stops[o],s=n.stops[o];if(a.color[0]!==s.color[0]||a.color[1]!==s.color[1]||a.color[2]!==s.color[2]||a.color[3]!==s.color[3]||a.offset!==s.offset)continue e}return}}}f.push(n)}else{for(var l=0,u=d.length;l<u;l++){var c;if((c=d[l]).url===r.url&&c.type===r.type&&c.scale===r.scale)return}d.push(r)}}})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,u,c,h){var d=s.length>1,f=l.length>1,p=u.length>1,v=(s.length?1:0)+(l.length?1:0)+(u.length?1:0)>1,g=v||d||f||p,m=t||!r||v||f||p||l.length||u.length?'readonly="readonly"':"",y="",b=" ";v?b="":s.length?(b="",1===s.length&&(y=s[0])):l.length?(b="",1===l.length&&(y=Uc(l[0],c,h,!0))):u.length&&(b="",1===u.length&&(y=Uc(u[0],c,h,!0)));var x=" ";return x=n?"":{inside:"",center:"",outside:""}[i],'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(m?"read-only":"",'">\n        <b class="pick ').concat(g?"multi":"",'" style="').concat(g?"":"background:".concat(y),'"></b>\n      </span>\n      <span class="txt">').concat(b,'</span>\n    </div>\n    <div class="pos">\n      <div>\n        <span class="p inside ').concat(n||"inside"!==i?"":"cur",'" title=""></span>\n        <span class="p center ').concat(n||"center"!==i?"":"cur",'" title=""></span>\n        <span class="p outside ').concat(n||"outside"!==i?"":"cur",'" title=""></span>\n      </div>\n      <span class="txt">').concat(x,'</span>\n    </div>\n    <div class="width">\n      <div class="input-unit">\n        <input type="number" min="0" max="100" step="1" value="').concat(o?"":a,'" placeholder="').concat(o?"":"",'"/>\n      </div>\n      <span class="txt"></span>\n    </div>\n  </div>')}(e,l.length>1,l[0],u.length>1,u[0],c.length>1,c[0],h,d,f,s.nodes[0].width,s.nodes[0].height)},s=this,l=r.length-1;l>=0;l--)a(l)}else t.style.display="none"},t}(oC),dC="textPanelFold",fC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;i.nodes=[];var o=i.panel=document.createElement("div");o.className="text-panel",o.style.display="none",o.innerHTML='\n  <h4 class="panel-title"><b class="btn arrow"></b></h4>\n  <div class="line ff">\n    <select>\n      <option value="arial">Arial</option>\n    </select>\n    <span class="multi"></span>\n  </div>\n  <div class="line wc">\n    <div class="weight">\n      <select></select>\n      <span class="multi"></span>\n    </div>\n    <div class="color">\n      <span class="picker-btn"><b class="pick"></b></span>\n    </div>\n  </div>\n  <div class="line num">\n    <div class="fs">\n      <input type="number" min="0" step="1"/>\n      <span></span>\n    </div>\n    <div class="ls">\n      <input type="number" step="1"/>\n      <span></span>\n    </div>\n    <div class="lh">\n      <input type="number" min="0" step="1"/>\n      <span></span>\n    </div>\n    <div class="ps">\n      <input type="number" step="1"/>\n      <span></span>\n    </div>\n  </div>\n  <div class="line wh">\n    <div>\n      <span class="auto" title=""></span>\n      <span class="fw" title=""></span>\n      <span class="fwh" title=""></span>\n    </div>\n    <span class="txt"></span>\n  </div>\n  <div class="line al">\n    <span class="left" title=""></span>\n    <span class="center" title=""></span>\n    <span class="right" title=""></span>\n    <span class="justify" title=""></span>\n  </div> \n  <div class="line va">\n    <span class="top" title=""></span>\n    <span class="middle" title=""></span>\n    <span class="bottom" title=""></span>\n  </div> \n',r.appendChild(o),n.input.ignoreBlur.push(o),i.initFontList(),"1"===localStorage.getItem(dC)&&o.classList.add("fold");var a=o.querySelector(".fs input"),s=o.querySelector(".ls input"),l=o.querySelector(".lh input"),u=o.querySelector(".ps input"),c=o.querySelector(".ff select"),h=o.querySelector(".weight select"),d=[],f=[],p=[],v=function(){d.length&&p.length&&n.history.addCommand(new IS(d,f.map((function(e,t){return{prev:e,next:p[t]}})),IS.COLOR)),d=[],f=[],p=[]},g=function(e,t){var r,o;i.silence=!0;var a=e.target,s=parseFloat(a.value)||0,l=!d.length;l&&(f=[]),p=[];var u=e instanceof InputEvent;if(n.state===bS.EDIT_TEXT&&1===i.nodes.length){var c=i.nodes[0],h=c.getSortedCursor(),v=h.isMulti,g=h.start,m=h.end;v?(l&&(d.push(c),f.push(c.getRich())),u?c.updateRangeStyle(g,m-g,((r={})[t]=s,r)):c.rich.forEach((function(e,r){var i;if(e.location<m&&e.location+e.length>g){var o=0;a.placeholder?(o=s>0?1:-1,n.shiftKey?o*=10:n.altKey&&(o*=.1)):(o=s-f[0][r][t],n.shiftKey?o*=10:n.altKey&&(o*=.1));var l=Math.max(e.location,g),u=Math.min(e.length,m-e.location)-(l-e.location),h=pC(e,t,o);c.updateRangeStyle(l,u,((i={})[t]=h,i))}})),p.push(c.getRich()),c.setCursorByIndex(g),c.setCursorByIndex(m,!0)):c.setInputStyle(((o={})[t]=s,o))}else i.nodes.forEach((function(e){var r;if(l&&(d.push(e),f.push(e.getRich())),u)e.updateRangeStyle(0,e._content.length,((r={})[t]=s,r));else{var i=0;a.placeholder?(i=s>0?1:-1,n.shiftKey?i*=10:n.altKey&&(i*=.1)):(i=s-f[0][0][t],n.shiftKey?i*=10:n.altKey&&(i*=.1)),e.rich.forEach((function(r){var n;e.updateRangeStyle(r.location,r.length,((n={})[t]=pC(r,t,i),n))}))}p.push(e.getRich())}));d.length&&(n.select.updateSelect(d),"fontSize"===t?n.emit(rC.FONT_SIZE_NODE,d.slice(0)):"letterSpacing"===t?n.emit(rC.LETTER_SPACING_NODE,d.slice(0)):"paragraphSpacing"===t?n.emit(rC.PARAGRAPH_SPACING_NODE,d.slice(0)):"lineHeight"===t&&n.emit(rC.LINE_HEIGHT_NODE,d.slice(0)),i.show(i.nodes)),i.silence=!1},m=function(e){if(d.length){var t="";"fontSize"==e?t=IS.FONT_SIZE:"letterSpacing"===e?t=IS.LETTER_SPACING:"lineHeight"===e?t=IS.LINE_HEIGHT:"paragraphSpacing"===e&&(t=IS.PARAGRAPH_SPACING),n.history.addCommand(new IS(d,f.map((function(e,t){return{prev:e,next:p[t]}})),t)),d=[],f=[],p=[]}},y=function(){n.state===bS.EDIT_TEXT&&n.input.focus()};a.addEventListener("input",(function(e){g(e,"fontSize")})),s.addEventListener("input",(function(e){g(e,"letterSpacing")})),l.addEventListener("input",(function(e){g(e,"lineHeight")})),u.addEventListener("input",(function(e){g(e,"paragraphSpacing")})),a.addEventListener("change",(function(e){m("fontSize")})),s.addEventListener("change",(function(e){m("letterSpacing")})),l.addEventListener("change",(function(e){m("lineHeight")})),u.addEventListener("change",(function(e){m("paragraphSpacing")})),a.addEventListener("blur",y),s.addEventListener("blur",y),l.addEventListener("blur",y),u.addEventListener("blur",y);var b=function(e,t){i.silence=!0;var r=e.target,a=r.value,s=i.nodes.slice(0);if("fontFamily"===t){o.querySelector(".ff .multi").style.display="none";var l=qE(a),u=o.querySelector(".wc select"),c="";l.forEach((function(e){c+='<option value="'.concat(e.value,'">').concat(e.label,"</option>")})),u.innerHTML=c;for(var h=l.length?l[0].value:a,d=0,f=l.length;d<f;d++){var p=l[d];if("regular"===p.label.toLowerCase()){h=p.value;break}}u.disabled=!1;var v=[];if(n.state===bS.EDIT_TEXT&&1===i.nodes.length){var g=(E=s[0]).getSortedCursor(),m=g.isMulti,y=g.start,b=g.end;if(m){var x=E.getRich();E.updateRangeStyle(y,b-y,{fontFamily:h}),v.push({prev:x,next:E.getRich()}),E.setCursorByIndex(y),E.setCursorByIndex(b,!0)}else E.setInputStyle({fontFamily:h})}else s.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{fontFamily:h}),v.push({prev:t,next:e.getRich()})}));v.length&&(n.history.addCommand(new IS(s,v,IS.FONT_FAMILY)),n.select.updateSelect(s),n.emit(rC.FONT_FAMILY_NODE,s.slice(0)),i.show(i.nodes))}else if("fontWeight"===t){o.querySelector(".wc .multi").style.display="none";var w=r.querySelector(":disabled");w&&w.remove();var _=[];if(n.state===bS.EDIT_TEXT&&1===i.nodes.length){var E,S=(E=s[0]).getSortedCursor();m=S.isMulti,y=S.start,b=S.end;if(m){x=E.getRich();E.updateRangeStyle(y,b-y,{fontFamily:a}),_.push({prev:x,next:E.getRich()}),E.setCursorByIndex(y),E.setCursorByIndex(b,!0)}else E.setInputStyle({fontFamily:a})}else s.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{fontFamily:a}),_.push({prev:t,next:e.getRich()})}));_.length&&(n.history.addCommand(new IS(s,_,IS.FONT_FAMILY)),n.select.updateSelect(s),n.emit(rC.FONT_FAMILY_NODE,s.slice(0)))}i.silence=!1};return c.addEventListener("change",(function(e){b(e,"fontFamily")})),h.addEventListener("change",(function(e){b(e,"fontWeight")})),o.addEventListener("click",(function(e){var t,a,s,l=e.target,u=l.classList;if(u.contains("pick")){if(e.stopPropagation(),ES.isShowFrom("textPanel"))return void ES.hide();d=i.nodes.slice(0),f=d.map((function(e){return e.getRich()}));var c=ES.show(l,i.nodes[0].computedStyle.color,"textPanel",(function(e){if(i.silence=!0,p=[],n.state===bS.EDIT_TEXT&&1===d.length){var t=d[0],r=t.getSortedCursor(),a=r.isMulti,s=r.start,l=r.end;a?(t.updateRangeStyle(s,l-s,{color:e}),p.push(t.getRich()),t.setCursorByIndex(s),t.setCursorByIndex(l,!0)):t.setInputStyle({color:e})}else d.forEach((function(t){t.updateRangeStyle(0,t._content.length,{color:e}),p.push(t.getRich())}));o.querySelector(".pick").style.background=Tc(e),d.length&&n.emit(rC.COLOR_NODE,d.slice(0)),i.silence=!1}),v),h=c.domElement.parentElement;n.input.ignoreBlur.includes(h)||n.input.ignoreBlur.push(h)}else if(u.contains("arrow"))o.classList.contains("fold")?(o.classList.remove("fold"),localStorage.removeItem(dC)):(o.classList.add("fold"),localStorage.setItem(dC,"1"));else if((u.contains("auto")||u.contains("fw")||u.contains("fwh"))&&!u.contains("cur")){d=i.nodes.slice(0);var g=rl.AUTO;u.contains("fw")?g=rl.FIXED_W:u.contains("fwh")&&(g=rl.FIXED_W_H);var m=[];d.map((function(e){var t=e.width,r=e.height,n=WE(e);ZE(e,g);var i={dx:e.width-t,dy:e.height-r,controlType:CS.BR,aspectRatio:!1,fromCenter:!1};n===rl.AUTO?(i.widthFromAuto=!0,i.heightFromAuto=!0):n===rl.FIXED_W&&(i.heightFromAuto=!0),g===rl.AUTO?(i.widthToAuto=!0,i.heightToAuto=!0):g===rl.FIXED_W&&(i.heightToAuto=!0),m.push(i)})),n.history.addCommand(new LS(d,m)),n.select.updateSelect(d),n.emit(rC.RESIZE_NODE,d.slice(0)),null===(t=r.querySelector(".wh .cur"))||void 0===t||t.classList.remove("cur"),u.add("cur"),r.querySelector(".wh .txt").innerHTML=l.title}else if((u.contains("left")||u.contains("right")||u.contains("center")||l.classList.contains("justify"))&&!u.contains("cur")){var y=i.nodes.slice(0),b=zs.LEFT;u.contains("right")?b=zs.RIGHT:u.contains("center")?b=zs.CENTER:u.contains("justify")&&(b=zs.JUSTIFY);var x=[];if(1===y.length&&n.state===bS.EDIT_TEXT){var w=y[0],_=w.content,E=w.getSortedCursor(),S=E.isMulti,C=E.start,k=E.end;(C="\n"===_.charAt(C)?_.lastIndexOf("\n",C-1):_.lastIndexOf("\n",C))<0?C=0:C++,(k=_.indexOf("\n",k))<0?k=_.length:k++;var T=w.getRich();if(w.updateRangeStyle(C,k-C,{textAlign:b}),x.push({prev:T,next:w.getRich()}),S)w.setCursorByIndex(C),w.setCursorByIndex(k,!0);else{c=w.updateCursorByIndex(E.start);n.input.updateCursor(c)}}else y.forEach((function(e){var t=e.getRich();e.updateRangeStyle(0,e._content.length,{textAlign:b}),x.push({prev:t,next:e.getRich()})}));x.length&&(n.history.addCommand(new IS(y,x,IS.TEXT_ALIGN)),n.emit(rC.TEXT_ALIGN_NODE,y.slice(0))),null===(a=r.querySelector(".al .cur"))||void 0===a||a.classList.remove("cur"),u.add("cur")}else if((u.contains("top")||u.contains("bottom")||u.contains("middle"))&&!u.contains("cur")){v();var A=i.nodes.slice(0),M="top";u.contains("middle")?M="middle":u.contains("bottom")&&(M="bottom");var O=[];A.forEach((function(e){var t=e.computedStyle.textVerticalAlign,r="top";t===Xs.MIDDLE?r="middle":t===Xs.BOTTOM&&(r="bottom"),e.updateStyle({textVerticalAlign:M}),O.push({prev:{textVerticalAlign:r},next:{textVerticalAlign:M}})})),n.history.addCommand(new BS(A,O)),n.emit(rC.TEXT_VERTICAL_ALIGN_NODE,A.slice(0)),null===(s=r.querySelector(".va .cur"))||void 0===s||s.classList.remove("cur"),u.add("cur")}})),n.on([rC.RESIZE_NODE,rC.FONT_SIZE_NODE,rC.FONT_FAMILY_NODE,rC.LETTER_SPACING_NODE,rC.LINE_HEIGHT_NODE,rC.PARAGRAPH_SPACING_NODE,rC.COLOR_NODE,rC.TEXT_ALIGN_NODE,rC.TEXT_VERTICAL_ALIGN_NODE,rC.CURSOR_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.initFontList=function(e){var t=Px.font.info,r="";if(e&&e.length){var n=t.Arial;e.forEach((function(e){Hl.registerData(Z(Z({},n),e)),r+='<option value="'.concat(e.family,'">').concat(e.name,"</option>")}))}else for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];r+='<option value="'.concat(i,'">').concat(o.name||i,"</option>")}this.panel.querySelector("select").innerHTML=r},t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){if(e[n]instanceof f_){r=!0;break}}if(r){t.style.display="block",t.querySelectorAll("input").forEach((function(e){e.disabled=!1,e.placeholder=""}));var o=e.filter((function(e){return e instanceof f_}));this.nodes=o;var a,s,l=this.listener.state===bS.EDIT_TEXT&&1===e.length&&o[0]._content?KE(o[0]):VE(o);(s=(a=t.querySelector(".ff select")).querySelector(":disabled"))&&s.remove();var u=t.querySelector(".ff .multi");for(n=0,i=(f=a.querySelectorAll("option")).length;n<i;n++){var c=f[n];if(c.selected){c.selected=!1;break}}if(l.fontFamily.length>1){u.innerText="",u.style.display="block",u.classList.remove("invalid");a.innerHTML+='<option value="" selected="selected" disabled></option>'}else if(l.valid[0]){if(u.style.display="none",u.classList.remove("invalid"),!a.querySelector('option[value="'.concat(l.postscriptName[0],'"]'))){h='<option value="'.concat(l.postscriptName[0],'">').concat(l.fontFamily[0],"</option>");a.innerHTML+=h}a.value=l.postscriptName[0]}else{if(u.innerText=l.fontFamily[0],u.classList.add("invalid"),u.style.display="block",a.querySelector('option[value="'.concat(l.postscriptName[0],'"]')))a.value=l.postscriptName[0];else{var h='<option value="'.concat(l.postscriptName[0],'" selected="selected" disabled>').concat(l.fontFamily[0],"</option>");a.innerHTML+=h}}(s=(a=t.querySelector(".wc select")).querySelector(":disabled"))&&s.remove();var d="";l.fontWeightList.forEach((function(e){d+='<option value="'.concat(e.value,'">').concat(e.label,"</option>")})),a.innerHTML=d;u=t.querySelector(".wc .multi");if(l.fontWeight.length>1){u.style.display="block";a.innerHTML+='<option value="" selected="selected" disabled></option>'}else{u.style.display="none";var f;for(n=0,i=(f=a.querySelectorAll("option")).length;n<i;n++){var p=f[n];if(p.innerHTML===l.fontWeight[0]){p.selected=!0;break}}}a.disabled=!(1===l.valid.length&&l.valid[0]);var v=t.querySelector(".color .pick");l.color.length>1?(v.style.background="",v.classList.add("multi")):(v.style.background=l.color[0],v.classList.remove("multi"));var g=t.querySelector(".fs input");l.fontSize.length>1?(g.value="",g.placeholder=""):(g.value=dc(l.fontSize[0]||0,2).toString(),g.placeholder="");g=t.querySelector(".ls input");l.letterSpacing.length>1?(g.value="",g.placeholder=""):(g.value=dc(l.letterSpacing[0]||0,2).toString(),g.placeholder="");g=t.querySelector(".lh input");l.lineHeight.length>1?(g.value="",g.placeholder=""):l.autoLineHeight[0]?(g.value="",g.placeholder=dc(l.lineHeight[0]||0,2).toString()):(g.value=dc(l.lineHeight[0]||0,2).toString(),g.placeholder="");g=t.querySelector(".ps input");l.paragraphSpacing.length>1?(g.value="",g.placeholder=""):(g.value=dc(l.paragraphSpacing[0]||0,2).toString(),g.placeholder=""),(m=t.querySelector(".wh .cur"))&&m.classList.remove("cur");var m,y=t.querySelector(".wh .txt");if(1===l.textBehaviour.length){var b=l.textBehaviour[0];b===rl.AUTO?(t.querySelector(".wh .auto").classList.add("cur"),y.innerHTML=""):b===rl.FIXED_W?(t.querySelector(".wh .fw").classList.add("cur"),y.innerHTML=""):b===rl.FIXED_W_H&&(t.querySelector(".wh .fwh").classList.add("cur"),y.innerHTML="")}else y.innerHTML="";if((m=t.querySelector(".al .cur"))&&m.classList.remove("cur"),1===l.textAlign.length){var x=l.textAlign[0];x===zs.LEFT?t.querySelector(".al .left").classList.add("cur"):x===zs.CENTER?t.querySelector(".al .center").classList.add("cur"):x===zs.RIGHT?t.querySelector(".al .right").classList.add("cur"):x===zs.JUSTIFY&&t.querySelector(".al .justify").classList.add("cur")}if((m=t.querySelector(".va .cur"))&&m.classList.remove("cur"),1===l.textVerticalAlign.length){var w=l.textVerticalAlign[0];w===Xs.TOP?t.querySelector(".va .top").classList.add("cur"):w===Xs.MIDDLE?t.querySelector(".va .middle").classList.add("cur"):w===Xs.BOTTOM&&t.querySelector(".va .bottom").classList.add("cur")}}else t.style.display="none"},t}(oC);function pC(e,t,r){var n=e[t];if(!n&&"lineHeight"===t){var i=Hl.data[e.fontFamily];n=i?e.fontSize*i.lhr:e.fontSize*(Hl.data[hl.defaultFontFamily]||Hl.data.arial).lhr}var o=n+r;return"fontSize"!==t&&"lineHeight"!==t||(o=Math.max(0,o)),o}var vC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");return o.className="align-panel",o.innerHTML='\n  <div class="line">\n    <span class="left" title=""></span>\n    <span class="center" title=""></span>\n    <span class="right" title=""></span>\n    <span class="top" title=""></span>\n    <span class="middle" title=""></span>\n    <span class="bottom" title=""></span>\n  </div>\n',r.appendChild(o),o.addEventListener("click",(function(e){var t=e.target;if("SPAN"===t.tagName.toUpperCase()&&t.parentElement.classList.contains("disabled"))return;var r=t.classList,o=[],a=[];i.nodes.forEach((function(e){var t=0,n=0,i=e.parent,s=i.width,l=i.height,u=e.computedStyle;if(r.contains("left")?t=-u.left-u.translateX:r.contains("center")?t=.5*s-u.left-u.translateX-.5*u.width:r.contains("right")?t=s-u.left-u.translateX-u.width:r.contains("top")?n=-u.top-u.translateY:r.contains("middle")?n=.5*l-u.top-u.translateY-.5*u.height:r.contains("bottom")&&(n=l-u.top-u.translateY-u.height),t||n){var c=e.getStyle();e.updateStyle({translateX:u.translateX+t,translateY:u.translateY+n}),e.endPosChange(c,t,n),e.checkPosSizeUpward(),o.push(e),a.push({dx:t,dy:n})}})),o.length&&(n.select.updateSelect(o),n.emit(rC.MOVE_NODE,o.slice(0)),n.history.addCommand(new MS(o,a)))})),i}return v(t,e),t.prototype.show=function(e){var t=this.panel,r=[];e.forEach((function(e){var t=e.parent;t&&(t instanceof l_||t instanceof qx)&&r.push(e)})),this.nodes=r,r.length?t.querySelector(".line").classList.remove("disabled"):t.querySelector(".line").classList.add("disabled")},t}(oC),gC=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=e.getCurPage(),i=e.pageContainer,o=document.createElement("ul");i.children.forEach((function(e){var t=document.createElement("li");t.title=e.props.name||"",t.setAttribute("uuid",e.props.uuid),t.innerHTML=e.props.name||"",n&&e===n&&(t.className="active"),o.appendChild(t)})),t.innerHTML="",t.appendChild(o),t.addEventListener("click",(function(t){var n,a=t.target,s=a.classList;if(!s.contains("active")){null===(n=o.querySelector(".active"))||void 0===n||n.classList.remove("active"),s.add("active");var l=a.getAttribute("uuid");if(l){var u=e.refs[l];if(u){var c=i.children.indexOf(u);c>-1&&(e.setPageIndex(c),r.active([]))}}}}))};var mC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="shadow-panel",o.style.display="none",o.innerHTML='\n  <div class="panel-title"><b class="btn del"></b><b class="btn add"></b></div>\n',r.appendChild(o);var a=[],s=[],l=[],u=function(){l.length&&n.history.addCommand(new US(a,s.map((function(e,t){return{prev:e,next:l[t]}})))),a=[],s=[],l=[]};return o.addEventListener("click",(function(e){var t=e.target,r=t.classList;if(r.contains("pick")){if(e.stopPropagation(),t.parentElement.classList.contains("read-only"))return;if(ES.isShowFrom("shadowPanel"))return void ES.hide();a=i.nodes.slice(0),s=[],a.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return Bc(e)}));s.push({shadow:i,shadowEnable:n})}));var o=t.parentElement.parentElement.parentElement,c=parseInt(o.title);ES.show(t,i.nodes[0].computedStyle.shadow[0].color,"shadowPanel",(function(e){i.silence=!0,l=[],a.forEach((function(t){var r=t.getComputedStyle(),n=r.shadow,i=r.shadowEnable,o=n.map((function(t,r){return Bc(r===c?Object.assign(t,{color:e}):t)})),a={shadow:o,shadowEnable:i};l.push(a),t.updateStyle(a)})),o.querySelector(".pick").style.background=Tc(e),a.length&&n.emit(rC.SHADOW_NODE,a.slice(0)),i.silence=!1}),u)}else if(r.contains("add")){i.silence=!0;var h=i.nodes.slice(0),d=[],f=[];h.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return Bc(e)}));d.push({shadow:i,shadowEnable:n});var o=i.slice(0),a=n.slice(0);o.push("rgba(0,0,0,0.5) 0 2 4 0"),a.push(!0);var s={shadow:o,shadowEnable:a};f.push(s),e.updateStyle(s)})),i.show(h),n.emit(rC.SHADOW_NODE,h.slice(0)),n.history.addCommand(new US(h.slice(0),d.map((function(e,t){return{prev:e,next:f[t]}})))),i.silence=!1}else if(r.contains("del")){i.silence=!0;var p=i.nodes.slice(0),v=[],g=[],m=0;p.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return Bc(e)}));m=Math.max(m,n.length),v.push({shadow:i,shadowEnable:n}),g.push({shadow:i.slice(0),shadowEnable:n.slice(0)})}));for(var y=function(e){for(var t=0,r=g.length;t<r;t++){if(g[t].shadowEnable[e])return"continue-outer"}g.forEach((function(t){t.shadow.splice(e,1),t.shadowEnable.splice(e,1)}))},b=m-1;b>=0;b--)y(b);p.forEach((function(e,t){e.updateStyle(g[t])})),i.show(p),n.emit(rC.SHADOW_NODE,p.slice(0)),n.history.addCommand(new US(p.slice(0),v.map((function(e,t){return{prev:e,next:g[t]}})))),i.silence=!1}else if(r.contains("enabled")){i.silence=!0;var x=t.parentElement,w=parseInt(x.title),_=i.nodes.slice(0),E=[],S=[],C=!1;(r.contains("multi-checked")||r.contains("un-checked"))&&(C=!0),_.forEach((function(e){var t=e.getComputedStyle(),r=t.shadow,n=t.shadowEnable,i=r.map((function(e){return Bc(e)}));E.push({shadow:i,shadowEnable:n});var o=i.slice(0),a=n.slice(0);void 0!==a[w]&&(a[w]=C);var s={shadow:o,shadowEnable:a};S.push(s),e.updateStyle(s)})),r.remove("multi-checked"),C?(r.remove("un-checked"),r.add("checked"),x.querySelectorAll("input:read-only").forEach((function(e){e.readOnly=!1}))):(r.remove("checked"),r.add("un-checked"),x.querySelectorAll("input").forEach((function(e){e.readOnly=!0}))),n.emit(rC.SHADOW_NODE,_.slice(0)),n.history.addCommand(new US(_.slice(0),E.map((function(e,t){return{prev:e,next:S[t]}})))),i.silence=!1}})),o.addEventListener("input",(function(e){i.silence=!0;var t=e.target,r=parseInt(t.parentElement.parentElement.title),o=t.classList,u=1;o.contains("y")?u=2:o.contains("blur")?u=3:o.contains("spread")&&(u=4);var c=Math.min(5e5,Math.max(-5e5,parseFloat(t.value)||0)),h=!a.length;h&&(s=[]),l=[];var d=e instanceof InputEvent;i.nodes.forEach((function(e,i){if(h){a.push(e);var o=e.getComputedStyle(),f=o.shadow,p=o.shadowEnable,v=f.map((function(e){return Bc(e)}));s.push({shadow:v,shadowEnable:p})}var g={shadow:s[i].shadow.slice(0),shadowEnable:s[i].shadowEnable.slice(0)};l.push(g);var m=parseFloat(s[i].shadow[r].split(" ")[u]),y=c;if(d)t.placeholder="";else{var b=0;t.placeholder?(b=c>0?1:-1,n.shiftKey?b*=10:n.altKey&&(b*=.1)):(b=c-m,n.shiftKey?b*=10:n.altKey&&(b*=.1)),y=m+b,t.placeholder?t.value="":t.value=Math.round(y).toString()}if(g.shadow[r]){var x=g.shadow[r].split(" ");x[u]=y.toString(),g.shadow[r]=x.join(" "),e.updateStyle(g)}})),a.length&&n.emit(rC.SHADOW_NODE,a.slice(0)),i.silence=!1})),o.addEventListener("change",u),n.on([rC.SHADOW_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){this.nodes=e;var t=this.panel;if(this.panel.querySelectorAll(".line").forEach((function(e){e.remove()})),e.length){t.style.display="block";var r=[],n=[];e.forEach((function(e){var t=e.getComputedStyle(),i=t.shadow;t.shadowEnable.forEach((function(e,t){var n=r[t]=r[t]||[];n.includes(e)||n.push(e)})),i.forEach((function(e,t){(n[t]=n[t]||[]).push(e)}))}));for(var i=!1,o=function(e){var o=n[e],a=r[e],s=[],l=[],u=[],c=[],h=[];o.forEach((function(e){var t=Tc(e.color);s.includes(t)||s.push(t),l.includes(e.x)||l.push(e.x),u.includes(e.y)||u.push(e.y),c.includes(e.blur)||c.push(e.blur),h.includes(e.spread)||h.push(e.spread)})),t.innerHTML+=function(e,t,r,n,i,o,a,s,l,u,c,h,d){var f=t||!r?'readonly="readonly"':"";return'<div class="line" title="'.concat(e,'">\n    <span class="enabled ').concat(t?"multi-checked":r?"checked":"un-checked",'"></span>\n    <div class="color">\n      <span class="picker-btn ').concat(f?"read-only":"",'">\n        <b class="pick ').concat(n?"multi":"",'" style="').concat(n?"":"background:".concat(i),'"></b>\n      </span>\n      <span class="txt"></span>\n    </div>\n    <div>\n      <input class="x" type="number" min="-500000" max="500000" step="1" value="').concat(o?"":a,'" placeholder="').concat(o?"":"",'" ').concat(f,'/>\n      <span class="txt">X</span>\n    </div>\n    <div>\n      <input class="y" type="number" min="-500000" max="500000" step="1" value="').concat(s?"":l,'" placeholder="').concat(s?"":"",'" ').concat(f,'/>\n      <span class="txt">Y</span>\n    </div>\n    <div>\n      <input class="blur" type="number" min="0" max="50" step="1" value="').concat(u?"":c,'" placeholder="').concat(u?"":"",'" ').concat(f,'/>\n      <span class="txt"></span>\n    </div>\n  </div>')}(e,a.length>1,a[0],s.length>1,s[0],l.length>1,l[0],u.length>1,u[0],c.length>1,c[0]),1!==a.length||a[0]||(i=!0)},a=n.length-1;a>=0;a--)o(a);this.panel.querySelector(".del").style.display=i?"block":"none"}else t.style.display="none"},t}(oC),yC='\n  <div class="panel-title"><b class="btn"></b></div>\n  <select>\n    <option value="'.concat(Ys.GAUSSIAN,'"></option>\n    <option value="').concat(Ys.MOTION,'"></option>\n    <option value="').concat(Ys.RADIAL,'"></option>\n    <option value="').concat(Ys.BACKGROUND,'"></option>\n    <option value="').concat(Ys.NONE,'" disabled="disabled" style="display:none"></option>\n  </select>\n  <div class="type radius">\n    <div class="con">\n      <input class="range" type="range" min="0" max="50" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="0" max="50" step="1"/>\n      </div>\n    </div>\n  </div>\n  <div class="type t').concat(Ys.MOTION,' angle">\n    <div class="intro"></div>\n    <div class="con">\n      <input class="range" type="range" min="-180" max="180" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="-180" max="180" step="1"/>\n        <span class="unit"></span>\n      </div>\n    </div>\n  </div>\n  <div class="type t').concat(Ys.RADIAL,' center">\n    <button disabled="disabled"></button>\n  </div>\n  <div class="type t').concat(Ys.BACKGROUND,' saturation">\n    <div class="intro"></div>\n    <div class="con">\n      <input class="range" type="range" min="-100" max="100" step="1"/>\n      <div class="input-unit">\n        <input class="number" type="number" min="-100" max="100" step="1"/>\n        <span class="unit">%</span>\n      </div>\n    </div>\n  </div>\n'),bC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="blur-panel",o.style.display="none",o.innerHTML=yC,r.appendChild(o);var a=i.btn=o.querySelector(".btn"),s=i.select=o.querySelector("select"),l=i.radiusRange=o.querySelector(".radius .range"),u=i.radiusNumber=o.querySelector(".radius .number"),c=i.angleRange=o.querySelector(".angle .range"),h=i.angleNumber=o.querySelector(".angle .number"),d=i.saturationRange=o.querySelector(".saturation .range"),f=i.saturationNumber=o.querySelector(".saturation .number"),p=[],v=[],g=[];a.addEventListener("click",(function(){var e=a.classList.contains("add");e?(a.classList.remove("add"),a.classList.add("del")):(a.classList.add("add"),a.classList.remove("del")),p=[],v=[],g=[],i.nodes.forEach((function(t){p.push(t),v.push({blur:t.getCssStyle().blur});var r={blur:"none"};e&&(r.blur=Nc(Ys.GAUSSIAN,4,0,[.5,.5],1)),g.push(r),t.updateStyle(r)})),i.show(i.nodes),b()})),s.addEventListener("change",(function(){i.silence=!0;var e=parseInt(s.value);o.querySelectorAll("div.t2,div.t3,div.t4").forEach((function(e){e.style.display="none"}));var t=o.querySelector("div.t".concat(e));t&&(t.style.display="block"),p=[],v=[],g=[],i.nodes.forEach((function(t){p.push(t),v.push({blur:t.getCssStyle().blur});var r=t.computedStyle.blur,n={blur:Nc(e,r.radius,r.angle,r.center,r.saturation)};g.push(n),t.updateStyle(n)})),n.emit(rC.BLUR_NODE,p.slice(0)),b(),i.show(i.nodes),i.silence=!1}));var m=function(e,t,r){i.silence=!0;var o=e.value,a=parseFloat(o),s=!p.length;s&&(v=[]),g=[],i.nodes.forEach((function(e){s&&(p.push(e),v.push({blur:e.getCssStyle().blur}));var t,n=e.computedStyle.blur;"radius"===r?t={blur:Nc(n.t,a,n.angle,n.center,n.saturation)}:"angle"===r?t={blur:Nc(n.t,n.radius,a,n.center,n.saturation)}:"saturation"===r&&(t={blur:Nc(n.t,n.radius,n.angle,n.center,.01*(a+100))}),g.push(t),e.updateStyle(t)})),"radius"===r?e.style.setProperty("--p",(2*a).toString()):"angle"===r?e.style.setProperty("--p",(100*(a+180)/360).toString()):"saturation"===r&&e.style.setProperty("--p",(.5*(a+100)).toString()),t.value=o,t.placeholder="",p.length&&n.emit(rC.BLUR_NODE,p.slice(0)),i.silence=!1},y=function(e,t,r,o,a,s){i.silence=!0;var l=!p.length;l&&(v=[]),g=[];var u=parseFloat(t.value)||0;if(i.nodes.forEach((function(e,i){var c=e.computedStyle.blur;if(c.t!==Ys.NONE){l&&(p.push(e),v.push({blur:e.getCssStyle().blur}));var h=c.radius;"angle"===r?h=c.angle:"saturation"===r&&(h=100*c.saturation-100);var d,f=u;if(o)i||(t.placeholder="");else{var m=0;t.placeholder?(m=f>0?1:-1,n.shiftKey?m*=10:n.altKey&&(m*=.1),f=Math.min(a,Math.max(s,Math.round(h+m))),t.value=""):(m=f-h,n.shiftKey?m*=10:n.altKey&&(m*=.1),f=Math.min(a,Math.max(s,Math.round(h+m))),i||(t.value=f.toString()))}"radius"===r?d={blur:Nc(c.t,f,c.angle,c.center,c.saturation)}:"angle"===r?d={blur:Nc(c.t,c.radius,f,c.center,c.saturation)}:"saturation"===r&&(d={blur:Nc(c.t,c.radius,c.angle,c.center,.01*(f+100))}),g.push(d),e.updateStyle(d)}})),e.value=t.value||"0",!t.placeholder){var c=parseFloat(e.value);"radius"===r?e.style.setProperty("--p",(2*c).toString()):"angle"===r?e.style.setProperty("--p",(100*(c+180)/360).toString()):"saturation"===r&&e.style.setProperty("--p",(.5*(c+100)).toString())}p.length&&n.emit(rC.BLUR_NODE,p.slice(0)),i.silence=!1},b=function(){p.length&&n.history.addCommand(new zS(p,v.map((function(e,t){return{prev:e,next:g[t]}})))),p=[],v=[],g=[]};return l.addEventListener("input",(function(){m(l,u,"radius")})),l.addEventListener("change",b),u.addEventListener("input",(function(e){y(l,u,"radius",e instanceof InputEvent,50,0)})),u.addEventListener("change",b),c.addEventListener("input",(function(){m(c,h,"angle")})),c.addEventListener("change",b),h.addEventListener("input",(function(e){y(c,h,"angle",e instanceof InputEvent,180,-180)})),h.addEventListener("change",b),d.addEventListener("input",(function(){m(d,f,"saturation")})),d.addEventListener("change",b),f.addEventListener("input",(function(e){y(d,f,"saturation",e instanceof InputEvent,100,-100)})),f.addEventListener("change",b),n.on([rC.BLUR_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){this.nodes=e;var t=this.panel;if(e.length){t.style.display="block";var r=t.querySelector("select"),n=r.querySelector(":disabled"),i=[],o=[],a=[],s=[];if(e.forEach((function(e){var t=e.computedStyle.blur;t.t!==Ys.NONE&&(i.includes(t.t)||i.push(t.t),o.includes(t.radius)||o.push(t.radius),void 0===t.angle||a.includes(t.angle)||a.push(t.angle),void 0===t.saturation||s.includes(t.saturation)||s.push(t.saturation))})),t.querySelectorAll("select,div.type").forEach((function(e){e.style.display="none"})),!i.length)return this.btn.classList.remove("del"),void this.btn.classList.add("add");if(this.btn.classList.remove("add"),this.btn.classList.add("del"),this.select.style.display="block",t.querySelector("div.radius").style.display="block",i.length>1)n.style.display="block",r.value=Ys.NONE.toString();else{n.style.display="none",r.value=i[0].toString();var l=t.querySelector("div.t".concat(i[0]));l&&(l.style.display="block")}if(o.length>1)this.radiusRange.value="0",this.radiusRange.style.setProperty("--p","0"),this.radiusNumber.value="",this.radiusNumber.placeholder="";else{var u=(c=Math.round(o[0]||0)).toString();this.radiusRange.style.setProperty("--p",(2*c).toString()),this.radiusRange.value=u,this.radiusNumber.value=u,this.radiusNumber.placeholder=""}if(a.length>1)this.angleRange.value="0",this.radiusRange.style.setProperty("--p","50"),this.angleNumber.value="",this.angleNumber.placeholder="";else{u=(c=Math.round(a[0]||0)).toString();this.angleRange.value=u,this.angleRange.style.setProperty("--p",(100*(c+180)/360).toString()),this.angleNumber.value=u,this.angleNumber.placeholder=""}if(s.length>1)this.saturationRange.value="0",this.saturationRange.style.setProperty("--p","50"),this.saturationNumber.value="",this.saturationNumber.placeholder="";else{var c;u=(c=Math.round(100*(s[0]||0)-100)).toString();this.saturationRange.value=u,this.saturationRange.style.setProperty("--p",(.5*(c+100)).toString()),this.saturationNumber.value=u,this.saturationNumber.placeholder=""}}else t.style.display="none"},t}(oC),xC=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.panel=document.createElement("div");o.className="color-adjust-panel",o.style.display="none",o.innerHTML='\n  <div class="panel-title"></div>\n  <div class="line hue">\n    <div class="intro"></div>\n    <input class="range" type="range" min="-180" max="180" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-180" max="180" step="1"/>\n      <span class="unit"></span>\n    </div>\n  </div>\n  <div class="line saturate">\n    <div class="intro"></div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n  <div class="line brightness">\n    <div class="intro"></div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n  <div class="line contrast">\n    <div class="intro"></div>\n    <input class="range" type="range" min="-100" max="100" step="1"/>\n    <div class="input-unit">\n      <input class="number" type="number" min="-100" max="100" step="1"/>\n      <span class="unit">%</span>\n    </div>\n  </div>\n',r.appendChild(o);var a=i.hueRotateRange=o.querySelector(".hue .range"),s=i.hueRotateNumber=o.querySelector(".hue .number"),l=i.saturateRange=o.querySelector(".saturate .range"),u=i.saturateNumber=o.querySelector(".saturate .number"),c=i.brightnessRange=o.querySelector(".brightness .range"),h=i.brightnessNumber=o.querySelector(".brightness .number"),d=i.contrastRange=o.querySelector(".contrast .range"),f=i.contrastNumber=o.querySelector(".contrast .number"),p=[],v=[],g=[],m=function(e,t,r){i.silence=!0;var o=e.value,a=parseFloat(o),s=!p.length;s&&(v=[]),g=[],i.nodes.forEach((function(e){var t=e.getCssStyle(),n=t.hueRotate,i=t.saturate,o=t.brightness,l=t.contrast;s&&(p.push(e),v.push({hueRotate:n,saturate:i,brightness:o,contrast:l}));var u={hueRotate:"hueRotate"===r?a:n,saturate:"saturate"===r?a+100+"%":i,brightness:"brightness"===r?a+100+"%":o,contrast:"contrast"===r?(a>0?3*a+100:a+100)+"%":l};g.push(u),e.updateStyle(u)})),"hueRotate"===r?e.style.setProperty("--p",(100*(a+180)/360).toString()):("saturate"===r||"brightness"===r||"contrast"===r)&&e.style.setProperty("--p",(.5*(a+100)).toString()),t.value=o,t.placeholder="",p.length&&n.emit(rC.COLOR_ADJUST_NODE,p.slice(0)),i.silence=!1},y=function(e,t,r,o,a,s){i.silence=!0;var l=!p.length;l&&(v=[]),g=[];var u=parseFloat(t.value)||0;if(i.nodes.forEach((function(e,i){var c=e.getCssStyle(),h=c.hueRotate,d=c.saturate,f=c.brightness,m=c.contrast;l&&(p.push(e),v.push({hueRotate:h,saturate:d,brightness:f,contrast:m}));var y=e.computedStyle,b=0;"hueRotate"===r?b=y.hueRotate:"saturate"===r?b=100*y.saturate-100:"brightness"===r?b=100*y.brightness-100:"contrast"===r&&(b=100*y.contrast-100)>0&&(b/=3);var x=u;if(o)i||(t.placeholder="");else{var w=0;t.placeholder?(w=x>0?1:-1,n.shiftKey&&(w*=10),x=Math.min(a,Math.max(s,Math.round(b+w))),t.value=""):(w=x-b,n.shiftKey&&(w*=10),x=Math.min(a,Math.max(s,Math.round(b+w))),i||(t.value=x.toString()))}var _={hueRotate:"hueRotate"===r?x:h,saturate:"saturate"===r?x+100+"%":d,brightness:"brightness"===r?x+100+"%":f,contrast:"contrast"===r?(x>0?3*x+100:x+100)+"%":m};g.push(_),e.updateStyle(_)})),e.value=t.value||"0",!t.placeholder){var c=parseFloat(e.value);"hueRotate"===r?e.style.setProperty("--p",(100*(c+180)/360).toString()):("saturate"===r||"brightness"===r||"contrast"===r)&&e.style.setProperty("--p",(.5*(c+100)).toString())}p.length&&n.emit(rC.COLOR_ADJUST_NODE,p.slice(0)),i.silence=!1},b=function(){p.length&&n.history.addCommand(new XS(p,v.map((function(e,t){return{prev:e,next:g[t]}})))),p=[],v=[],g=[]};return a.addEventListener("input",(function(){m(a,s,"hueRotate")})),a.addEventListener("change",b),s.addEventListener("input",(function(e){y(a,s,"hueRotate",e instanceof InputEvent,180,-180)})),s.addEventListener("change",b),l.addEventListener("input",(function(){m(l,u,"saturate")})),l.addEventListener("change",b),u.addEventListener("input",(function(e){y(l,u,"saturate",e instanceof InputEvent,100,-100)})),u.addEventListener("change",b),c.addEventListener("input",(function(){m(c,h,"brightness")})),c.addEventListener("change",b),h.addEventListener("input",(function(e){y(c,h,"brightness",e instanceof InputEvent,100,-100)})),h.addEventListener("change",b),d.addEventListener("input",(function(){m(d,f,"contrast")})),d.addEventListener("change",b),f.addEventListener("input",(function(e){y(d,f,"contrast",e instanceof InputEvent,100,-100)})),f.addEventListener("change",b),n.on([rC.COLOR_ADJUST_NODE],(function(e){i.silence||i.show(e)})),i}return v(t,e),t.prototype.show=function(e){for(var t=this.panel,r=!1,n=0,i=e.length;n<i;n++){if(e[n]instanceof Qx){r=!0;break}}if(r){t.style.display="block";var o=[],a=[],s=[],l=[];if(this.nodes=e.filter((function(e){return e instanceof Qx})),this.nodes.forEach((function(e){var t=e.computedStyle,r=t.hueRotate,n=t.saturate,i=t.brightness,u=t.contrast;o.includes(r)||o.push(r),a.includes(n)||a.push(n),s.includes(i)||s.push(i),l.includes(u)||l.push(u)})),o.length>1)this.hueRotateRange.value="0",this.hueRotateRange.style.setProperty("--p","50"),this.hueRotateNumber.value="",this.hueRotateNumber.placeholder="";else{var u=(c=Math.round(o[0]||0)).toString();this.hueRotateRange.value=u,this.hueRotateRange.style.setProperty("--p",(100*(c+180)/360).toString()),this.hueRotateNumber.value=u,this.hueRotateNumber.placeholder=""}if(a.length>1)this.saturateRange.value="0",this.saturateRange.style.setProperty("--p","50"),this.saturateNumber.value="",this.saturateNumber.placeholder="";else{u=(c=Math.round(100*(a[0]||0)-100)).toString();this.saturateRange.value=u,this.saturateRange.style.setProperty("--p",(.5*(c+100)).toString()),this.saturateNumber.value=u,this.saturateNumber.placeholder=""}if(s.length>1)this.brightnessRange.value="0",this.brightnessRange.style.setProperty("--p","50"),this.brightnessNumber.value="",this.brightnessNumber.placeholder="";else{u=(c=Math.round(100*(s[0]||0)-100)).toString();this.brightnessRange.value=u,this.brightnessRange.style.setProperty("--p",(.5*(c+100)).toString()),this.brightnessNumber.value=u,this.brightnessNumber.placeholder=""}if(l.length>1)this.contrastRange.value="0",this.contrastRange.style.setProperty("--p","50"),this.contrastNumber.value="",this.contrastNumber.placeholder="";else{var c=100*(l[0]||0)-100;u=Math.round(c>0?c/3:c).toString();this.contrastRange.value=u,c>0?this.contrastRange.style.setProperty("--p",(c/3*.5+50).toString()):this.contrastRange.style.setProperty("--p",(.5*(c+100)).toString()),this.contrastNumber.value=u,this.contrastNumber.placeholder=""}}else t.style.display="none"},t}(oC),wC=function(e,t,r){this.root=e,this.dom=t,this.listener=r;var n=document.createElement("select");n.innerHTML='\n      <option value="" disabled="disabled"></option>\n      <option value="up"></option>\n      <option value="down"></option>\n      <option value="actual"></option>\n      <option value="fit"></option>\n    ',n.selectedIndex=-1,t.appendChild(n);var i=document.createElement("div");i.innerText=dc(100*e.getCurPageZoom(!0)).toString()+"%",t.appendChild(i),n.addEventListener("change",(function(e){"up"===n.value?r.zoom(2):"down"===n.value?r.zoom(.5):"actual"===n.value?r.zoomActual():"fit"===n.value&&r.zoomFit(),n.value=""})),r.on(rC.ZOOM_PAGE,(function(e){i.innerText=dc(100*e).toString()+"%"}))};var _C={initCanvasControl:function(e,t,r){return new rC(e,t,r)},initPageList:function(e,t,r){return new gC(e,t,r)},initTree:function(e,t,r){return new iC(e,t,r)},initPanel:function(e,t,r){var n=new vC(e,t,r);n.show(r.selected);var i=new sC(e,t,r);i.show(r.selected);var o=new lC(e,t,r);o.show(r.selected);var a=new uC(e,t,r);a.show(r.selected);var s=new cC(e,t,r);s.show(r.selected);var l=new hC(e,t,r);l.show(r.selected);var u=new fC(e,t,r);u.show(r.selected);var c=new mC(e,t,r);c.show(r.selected);var h=new bC(e,t,r);h.show(r.selected);var d=new xC(e,t,r);return d.show(r.selected),{alignPanel:n,basicPanel:i,opacityPanel:o,roundPanel:a,fillPanel:s,strokePanel:l,textPanel:u,shadowPanel:c,blurPanel:h,colorAdjustPanel:d}},initZoom:function(e,t,r){return new wC(e,t,r)},Listener:rC,PageList:gC,Tree:iC,Select:dS,Input:_S,Panel:oC,BasicPanel:sC,OpacityPanel:lC,RoundPanel:uC,FillPanel:cC,StrokePanel:hC,TextPanel:fC,ShadowPanel:mC,BlurPanel:bC,AlignPanel:vC,ColorAdjustPanel:xC,Zoom:wC,picker:ES,contextMenu:AS,Guides:QS},EC=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.prevs=r,i.nexts=n,i}return v(t,e),t.prototype.execute=function(){var e=this.nodes,t=this.nexts;e.forEach((function(e,r){e.updateFormatStyle(t[r])}))},t.prototype.undo=function(){var e=this.nodes,t=this.prevs;e.forEach((function(e,r){e.updateFormatStyle(t[r])}))},t}(xS),SC={ca:dE},CC={version:kS,parse:function(e,t){var r,n,i,o;void 0===t&&(t={});var a=t.width,u=void 0===a?0:a,c=t.height,h=void 0===c?0:c,d=t.dpi,f=void 0===d?1:d,p=t.canvas,v={width:u,height:h};(!u||u<1)&&(v.width="auto"),(!h||h<1)&&(v.height="auto");var g=new jE.Root({dpi:f,uuid:(null===(r=e.document)||void 0===r?void 0:r.uuid)||s(),index:0,assets:null===(n=e.document)||void 0===n?void 0:n.assets,layerStyles:null===(i=e.document)||void 0===i?void 0:i.layerStyles,layerTextStyles:null===(o=e.document)||void 0===o?void 0:o.layerTextStyles,style:v,contextAttributes:Object.assign({},SC.ca,t.contextAttributes)});p&&g.appendTo(p);var m=[];return(e.pages||[]).forEach((function(e){e.children.forEach((function(e){e.tagName===l.SYMBOL_MASTER&&m.push(e)}))})),(e.symbolMasters||[]).forEach((function(e){m.push(e)})),y_(m).forEach((function(e){g.symbolMasters[e.props.symbolId]=m_(e,g)})),g.setJPages(e.pages||[]),g.setPageIndex(e.currentPageIndex||0),g},openAndConvertSketchBuffer:function(e){return J(this,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return[4,vs.loadAsync(e)];case 1:return[2,Gc(t.sent())]}}))}))},openAndConvertSketchZip:Gc,convertSketch:Yc,openAndConvertPsdBuffer:function(e){return J(this,void 0,void 0,(function(){var t,r,n,i,o,a,h,d,f,p;return Q(this,(function(v){switch(v.label){case 0:if(t=function(e,t){return Hm("buffer"in e?mm(e.buffer,e.byteOffset,e.byteLength):mm(e),t)}(e,{useImageData:!1}),r=[],n={tagName:l.ART_BOARD,props:{uuid:s(),name:"default",style:{width:t.width,height:t.height},isExpanded:!0},children:r},i={tagName:l.PAGE,props:{uuid:s(),name:"default",index:0,rule:{baseX:0,baseY:0},style:{width:u,height:c,visibility:"hidden",scaleX:.5,scaleY:.5,transformOrigin:[0,0],pointerEvents:!1}},children:[n]},!t.children)return[3,6];o=!1,a=0,h=t.children.length,v.label=1;case 1:return a<h?[4,$b(d=t.children[a],t.width,t.height)]:[3,6];case 2:return(f=v.sent())?(o&&(f.props.style.breakMask=o,o=!1),d.mask?[4,ex(d,t.width,t.height)]:[3,4]):[3,5];case 3:(p=v.sent())&&(r.push(p),o=!0),d.mask.disabled&&(f.props.style.breakMask=!0),v.label=4;case 4:r.push(f),v.label=5;case 5:return a++,[3,1];case 6:return[2,{pages:[i],currentPageIndex:0}]}}))}))},node:jE,refresh:Fx,style:Px,math:fc,util:Nx,animation:zx,tools:hS,config:ms,control:_C,history:{History:FS,AbstractCommand:xS,MoveCommand:MS,ResizeCommand:LS,AddCommand:eC,RemoveCommand:PS,RotateCommand:DS,BlurCommand:zS,ShadowCommand:US,ColorAdjustCommand:XS,FillCommand:HS,MaskModeCommand:jS,BreakMaskCommand:YS,VisibleCommand:JS,UpdateStyleCommand:OS,UpdateFormatStyleCommand:EC,RichCommand:IS,TextCommand:wS,GroupCommand:VS,UnGroupCommand:qS,RenameCommand:KS,LockCommand:ZS,ConstrainProportionCommand:aC},gl:SC,format:f};return CC}));
//# sourceMappingURL=index.min.js.map
