!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).karas=e()}(this,function(){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(a){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e,r,i,n=J(a);return e=o?(t=J(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),r=this,!(i=e)||"object"!=typeof i&&"function"!=typeof i?s(r):i}}function Q(t,e,r){return(Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=J(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function te(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw a}}return r}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var M=function(){function t(){u(this,t),this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__width=0,this.__height=0,this.__baseLine=0}return l(t,[{key:"__structure",value:function(t,e,r){var i=this.__struct={node:this,index:t,childIndex:r,lv:e};return this.__hasMask&&(i.hasMask=this.__hasMask),i}},{key:"__modifyStruct",value:function(){return[this.__struct,1]}},{key:"__offsetX",value:function(t,e){e?this.__x+=t:this.__ox+=t,this.__sx+=t}},{key:"__offsetY",value:function(t,e){e?this.__y+=t:this.__oy+=t,this.__sy+=t}},{key:"__destroy",value:function(){this.__isDestroyed=!0}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"sx",get:function(){return this.x+this.ox}},{key:"sy",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"domParent",get:function(){if(void 0!==this.__domParent)return this.__domParent;for(var t=this,e=this.root;t;){if(t===e){t=void 0;break}if(t.parent){t=t.parent;break}t.host&&(t=t.host)}return this.__domParent=t||null}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),t}(),Qt={CANVAS:0,SVG:1},j={AUTO:0,PX:1,PERCENT:2,NUMBER:3,INHERIT:4,DEG:5,STRING:6,RGBA:7},h={arial:{lhr:1.14990234375,car:1.1171875,blr:.9052734375}},c={TYPE_VD:{_:1},TYPE_GM:{_:2},TYPE_CP:{_:3}};var ee={identity:function(){return[1,0,0,1,0,0]},multiply:function(t,e){var r=1===t[0]&&0===t[1]&&0===t[2]&&1===t[3],i=1===e[0]&&0===e[1]&&0===e[2]&&1===e[3],n=0===t[4]&&0===t[5],a=0===e[4]&&0===e[5];if(r&&n)return e.slice(0);if(i&&a)return t.slice(0);if(r&&i)return(t=t.slice(0))[4]+=e[4],t[5]+=e[5],t;if(r||i){var o=r?e.slice(0):t.slice(0);return o[4]=t[0]*e[4]+t[2]*e[5]+t[4],o[5]=t[1]*e[4]+t[3]*e[5]+t[5],o}var s=[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],0,0];return n&&a||(a?(s[4]=t[4],s[5]=t[5]):(s[4]=t[0]*e[4]+t[2]*e[5]+t[4],s[5]=t[1]*e[4]+t[3]*e[5]+t[5])),s},calPoint:function(t,e){var r=te(t,2),i=r[0],n=r[1],a=te(e,6),o=a[0],s=a[1],h=a[2],u=a[3];return[o*i+h*n+a[4],s*i+u*n+a[5]]},int2convolution:function(t){var e=Math.floor(3*t*Math.sqrt(2*Math.PI)/4+.5);return(e*=3)%2==0&&e++,e},inverse:function(t){var e=te(t,6),r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],s=e[5];if(1===r&&0===i&&0===n&&1===a&&0===o&&0===s)return t;var h,u,l=1,c=0,f=0,_=1,d=0,p=0;if(0===r)if(1===i)var v=[i,r,a,n,s,o,c,l,_,f,p,d],r=v[0],i=v[1],n=v[2],a=v[3],o=v[4],s=v[5],l=v[6],c=v[7],f=v[8],_=v[9],d=v[10],p=v[11];else{if(0===i)return[0,0,0,0,0,0];r=1,n+=n/i,o+=o/i,l+=l/i,f+=f/i,d+=d/i,i=0}return 0!==i&&(h=i/r,i=0,a-=n*h,s-=o*h,c-=l*h,_-=f*h,p-=d*h),1!==r&&(n/=r,o/=r,l/=r,f/=r,d/=r,r=1),0!==n&&(u=n/a,n=0,o-=s*u,l-=c*u,f-=_*u,d-=p*u),0===a?(s+=(a=1)-o,c+=1-l,_+=1-f,p+=1-d):1!==a&&(s/=a,c/=a,_/=a,p/=a,a=1),0!==o&&(d-=o,o=0),0!==s&&(p-=s,s=0),[l,c,f,_,d,p]},isE:function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]}},d={}.toString;function p(e){return function(t){return d.call(t)==="[object "+e+"]"}}var v=p("Object"),y=p("String"),g=p("Function"),m=p("Number"),b=p("Boolean"),k=p("Date");function w(t){return null==t}function S(t){return w(t)?"":t.toString()}function A(t){if("item"===t.type||"img"===t.type){var e="";return(t.props||[]).forEach(function(t){e+=" "+t[0]+'="'+t[1]+'"'}),"text"===t.tagName?"<text"+e+">"+t.content+"</text>":"<"+t.tagName+e+"/>"}if("text"===t.type){var r="";return(t.children||[]).forEach(function(t){r+=A(t)}),"<g>"+r+"</g>"}if("dom"===t.type||"geom"===t.type){var i="<g";t.bbClip&&(i+=' clip-path="'+t.bbClip+'"'),i+=">",t.bb.forEach(function(t){i+=A(t)}),i+="</g><g",t.conClip&&(i+=' clip-path="'+t.conClip+'"'),i+=">",(t.children||[]).forEach(function(t){t.isMask||(i+=A(t))}),i+="</g>";var n=t.opacity,a=t.transform,o=t.visibility,s=t.mask,h=t.clip,u=t.filter;return"<g"+(1!==n&&void 0!==n?' opacity="'+n+'"':"")+(a?' transform="'+a+'"':"")+' visibility="'+o+'"'+(s?' mask="'+s+'"':"")+(h?' clip-path="'+h+'"':"")+(u?' filter="'+u+'"':"")+">"+i+"</g>"}}function E(t){var i="<"+t.tagName+' id="'+t.uuid+'"';return"mask"===t.tagName||"clipPath"===t.tagName||"filter"===t.tagName||(i+=' gradientUnits="userSpaceOnUse"'),(t.props||[]).forEach(function(t){i+=" "+t[0]+'="'+t[1]+'"'}),i+=">",(t.children||[]).forEach(function(t){var e,r;i+=(r="<"+(e=t).tagName,(e.props||[]).forEach(function(t){r+=" "+t[0]+'="'+t[1]+'"'}),r+="></"+e.tagName+">")}),i+="</"+t.tagName+">"}function P(t,e){for(var r=t.length?t[0]:"",i=1,n=t.length;i<n;i++)r+=e+t[i];return r}var re={isObject:v,isString:y,isFunction:g,isNumber:m,isBoolean:b,isDate:k,isNil:w,isPrimitive:function(t){return re.isNil(t)||re.isBoolean(t)||re.isString(t)||re.isNumber(t)},isAuto:function(t){return w(t)||"auto"===t},stringify:S,joinSourceArray:function t(e){for(var r="",i=0,n=e.length;i<n;i++){var a=e[i];Array.isArray(a)?r+=t(a):r+=S(a)}return r},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},joinVirtualDom:function(t){var e="<defs>";return t.defs.forEach(function(t){e+=E(t)}),e+="</defs><g",t.bbClip&&(e+=' clip-path="'+t.bbClip+'"'),e+=">",t.bb.forEach(function(t){e+=A(t)}),e+="</g><g",t.conClip&&(e+=' clip-path="'+t.conClip+'"'),e+=">",(t.children||[]).forEach(function(t){t.isMask||(e+=A(t))}),e+="</g>"},joinVd:A,joinDef:E,rgba2int:function(t){if(Array.isArray(t))return t;var e,r=[];return t&&"transparent"!==t?"#"===t.charAt(0)?(3===(t=t.slice(1)).length?(r.push(parseInt(t.charAt(0)+t.charAt(0),16)),r.push(parseInt(t.charAt(1)+t.charAt(1),16)),r.push(parseInt(t.charAt(2)+t.charAt(2),16))):6===t.length?(r.push(parseInt(t.slice(0,2),16)),r.push(parseInt(t.slice(2,4),16)),r.push(parseInt(t.slice(4),16))):r[0]=r[1]=r[2]=0,r[3]=1):(e=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\s*\)/i))?(r=[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])],w(e[4])?r[3]=1:r[3]=parseFloat(e[4])):r=[0,0,0,0]:r=[0,0,0,0],r},int2rgba:function(t){if(Array.isArray(t)){if(4===t.length)return"rgba("+P(t,",")+")";if(3===t.length)return"rgba("+P(t,",")+",1)"}return t||"rgba(0,0,0,0)"},arr2hash:function(t){for(var e={},r=0,i=t.length;r<i;r++){var n=t[r];if(Array.isArray(n))e[n[0]]=n[1];else for(var a=Object.keys(n),o=a.length-1;0<=o;o--){var s=a[o];e[s]=n[s]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],r=Object.keys(t),i=0,n=r.length;i<n;i++){var a=r[i];e.push([a,t[a]])}return e},clone:function e(r){if(w(r)||"object"!==o(r))return r;if(r.$$type===c.TYPE_VD||r.$$type===c.TYPE_GM||r.$$type===c.TYPE_CP)return r;if(re.isDate(r))return new Date(r);var i=Array.isArray(r)?[]:{};return Object.keys(r).forEach(function(t){i[t]=e(r[t])}),i},equalArr:function t(e,r){if(!e||!r)return e===r;if(e.length!==r.length)return!1;for(var i=0,n=e.length;i<n;i++){var a=e[i],o=r[i],s=Array.isArray(a),h=Array.isArray(o);if(s&&h){if(!t(a,o))return!1}else{if(s||h)return!1;if(a!==o)return!1}}return!0},equal:function t(e,r){if(e===r)return!0;if(v(e)&&v(r)){for(var i={},n=0,a=Object.keys(e),o=a.length;n<o;n++){var s=a[n];if(!r.hasOwnProperty(s)||!t(e[s],r[s]))return!1;i[s]=!0}for(var h=0,u=Object.keys(r),l=u.length;h<l;h++){var c=u[h];if(!i.hasOwnProperty(c))return!1}}else{if(k(e)&&k(r))return e.getTime()===r.getTime();if(!Array.isArray(e)||!Array.isArray(r))return e===r;if(e.length!==r.length)return!1;for(var f=0,_=e.length;f<_;f++)if(!t(e[f],r[f]))return!1}return!0},extend:function(t,e,r){if(null===e||"object"!==o(e))return t;for(var i=0,n=(r=r||Object.keys(e)).length;i<n;){var a=r[i];t[a]=e[a],i++}return t},joinArr:P,extendAnimate:function(t,e){(e.__animationList=t.animationList.splice(0)).forEach(function(t){t.__target=e,(t.assigning||t.finished&&t.__stayEnd())&&t.assignCurrentStyle()})},transformBbox:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(e&&!ee.isE(e)){var n=te(t,4),a=n[0],o=n[1],s=n[2],h=n[3];r&&(a-=r,s+=r),i&&(o-=i,h+=i);for(var u=[s,o,a,h,s,h],l=te(ee.calPoint([a,o],e),2),c=a=l[0],f=o=l[1],_=a,d=o,p=0;p<6;p+=2)var v=u[p],y=u[p+1],g=te(ee.calPoint([v,y],e),2),v=g[0],y=g[1],c=Math.min(c,v),_=Math.max(c,v),f=Math.min(f,y),d=Math.max(d,y);t=[c,f,_,d]}else(r||i)&&(t[0]-=r,t[1]-=i,t[2]+=r,t[3]+=i);return t}},T={position:/((-?[\d.]+(px|%)?)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-gradient\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i},R=4*(Math.sqrt(2)-1)/3;function C(t,e,r,i){return t*i-r*e}function O(t,e,r,i){return Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2))}function L(t,e){var r=te(t,4),i=r[0],n=r[1],a=r[2],o=r[3],s=te(e,4),h=s[0],u=s[1],l=s[2],c=s[3];return!(l<=i||c<=n||a<=h||o<=u)}function N(t,e,r){var i=r.matrix,n=void 0===i?[1,0,0,1,0,0]:i,a=r.computedStyle,o=void 0===a?{}:a,s=o.width,h=o.height,u=o.transformOrigin,l=te(u=void 0===u?[.5*s,.5*h]:u,2),c=l[0],f=l[1],_=te(ee.calPoint([t*s-c,e*h-f],n),2);return[(t=_[0])+c,(e=_[1])+f]}function I(t){var r=t.length,e=t.reduce(function(t,e){return Math.pow(t,r)+Math.pow(e,r)});return Math.pow(e,1/r)}function F(t,e,r){var i=t,n=(2*e+r)/3,a=(e+2*r)/3;return(i(e)+3*i(n)+3*i(a)+i(r))*(r-e)/8}function W(e,r){return function t(e,r,i,n){var a=3<arguments.length&&void 0!==n?n:.001,o=e,s=(r+i)/2,h=F(o,r,i),u=F(o,r,s),l=F(o,s,i),c=u+l-h;return Math.abs(c)<=15*a?u+l+c/15:t(o,r,s,a/2)+t(o,s,i,a/2)}(function(t){return I(D(t,e,r))},2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1)}function D(t,e,r,i){var n=3<arguments.length&&void 0!==i?i:1;return 2===r?function(t,e,r){var i=2<arguments.length&&void 0!==r?r:1,n=te(e,3),a=n[0],o=n[1],s=n[2],h=te(a,2),u=h[0],l=h[1],c=te(o,2),f=c[0],_=c[1],d=te(s,2),p=d[0],v=d[1],y=0,g=0,g=0===i?(y=Math.pow(1-t,2)*u+2*t*(1-t)*f+Math.pow(t,2)*p,Math.pow(1-t,2)*l+2*t*(1-t)*_+Math.pow(t,2)*v):1===i?(y=2*(1-t)*(f-u)+2*t*(p-f),2*(1-t)*(_-l)+2*t*(v-_)):2===i?(y=2*(p-2*f+u),2*(v-2*_+l)):y=0;return[y,g]}(t,e,n):3===r?function(t,e,r){var i=2<arguments.length&&void 0!==r?r:1,n=te(e,4),a=n[0],o=n[1],s=n[2],h=n[3],u=te(a,2),l=u[0],c=u[1],f=te(o,2),_=f[0],d=f[1],p=te(s,2),v=p[0],y=p[1],g=te(h,2),m=g[0],b=g[1],x=0,k=0,k=0===i?(x=Math.pow(1-t,3)*l+3*t*Math.pow(1-t,2)*_+3*(1-t)*Math.pow(t,2)*v+Math.pow(t,3)*m,Math.pow(1-t,3)*c+3*t*Math.pow(1-t,2)*d+3*(1-t)*Math.pow(t,2)*y+Math.pow(t,3)*b):1===i?(x=3*((1-t)*(1-t)*(_-l)+2*(1-t)*t*(v-_)+t*t*(m-v)),3*((1-t)*(1-t)*(d-c)+2*(1-t)*t*(y-d)+t*t*(b-y))):2===i?(x=6*(v-2*_+l)*(1-t)+6*(m-2*v+_)*t,6*(y-2*d+c)*(1-t)+6*(b-2*y+d)*t):3===i?(x=6*(m-3*v+3*_-l),6*(b-3*y+3*d-c)):x=0;return[x,k]}(t,e,n):void 0}function B(e,r,t){for(var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:.001,o=function(t){return I(D(t,e,r))},s=t*i,h=i,u=h,l=0;l<n;l++){var c=F(o,0,h)-s;if(Math.abs(c)<a)break;var f=I(D(h,e,r,1));if(h-=c*f/(c*I(D(h,e,r,2))+f*f),Math.abs(h-u)<a)break;u=h}return D(h,e,r,0)}function H(t,e){var r=te(t,4),i=te(r[0],2),n=i[0],a=i[1],o=te(r[1],2),s=o[0],h=o[1],u=te(r[2],2),l=u[0],c=u[1],f=r[3],_=(s-n)*e+n,d=(h-a)*e+a,p=(l-s)*e+s,v=(c-h)*e+h,y=(p-_)*e+_,g=(v-d)*e+d;if(4===t.length){var m=te(f,2);return[[n,a],[_,d],[y,g],[(((m[0]-l)*e+l-p)*e+p-y)*e+y,(((m[1]-c)*e+c-v)*e+v-g)*e+g]]}if(3===t.length)return[[n,a],[_,d],[y,g]]}var ie={vectorProduct:C,pointInPolygon:function(t,e,r){for(var i=te(r[0],2),n=i[0],a=i[1],o=te(r[0],2),s=o[0],h=o[1],u=r.length,l=1;l<u;l++)var c=te(r[l],2),f=c[0],_=c[1],n=Math.max(n,f),a=Math.max(a,_),s=Math.min(s,f),h=Math.min(h,_);if(t<s||e<h||n<t||a<e)return!1;for(var d=0,p=r.length;d<p;d++){var v=te(r[d],2),y=v[0],g=v[1],m=te(r[(d+1)%p],2);if(C(m[0]-y,m[1]-g,t-y,e-g)<0)return!1}return!0},d2r:function(t){return t*Math.PI/180},r2d:function(t){return 180*t/Math.PI},H:R,h:function(t){return t*=.5,(1-Math.cos(t))/Math.sin(t)*4/3},angleBySide:function(t,e,r){var i=(Math.pow(e,2)+Math.pow(r,2)-Math.pow(t,2))/(2*e*r);return Math.acos(i)},pointsDistance:O,triangleIncentre:function(t,e,r,i,n,a){var o=O(r,i,n,a),s=O(t,e,n,a),h=O(t,e,r,i);return[(o*t+s*r+h*n)/(o+s+h),(o*e+s*i+h*a)/(o+s+h)]},ellipsePoints:function(t,e,r){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:r,n=r*R,a=i===r?n:i*R;return[[t-r,e],[t-r,e-a,t-n,e-i,t,e-i],[t+n,e-i,t+r,e-a,t+r,e],[t+r,e+a,t+n,e+i,t,e+i],[t-n,e+i,t-r,e+a,t-r,e]]},getRectsIntersection:function(t,e){if(!L(t,e))return null;var r=te(t,4),i=r[0],n=r[1],a=r[2],o=r[3],s=te(e,4),h=s[0],u=s[1],l=s[2],c=s[3];return[Math.max(i,h),Math.max(n,u),Math.min(a,l),Math.min(o,c)]},isRectsOverlap:L,isRectsInside:function(t,e){var r=te(t,4),i=r[0],n=r[1],a=r[2],o=r[3],s=te(e,4),h=s[0],u=s[1],l=s[2],c=s[3];return i<=h&&n<=u&&l<=a&&c<=o},calCoordsInNode:N,calPercentInNode:function(t,e,r){var i,n=r.computedStyle,a=n.width,o=n.height,s=te(n.transformOrigin,2),h=s[0],u=s[1],l=Math.atan((o-u)/(a-h)),c=te(N(1,1,r),2),f=c[0],_=c[1],d=h<=f&&u<=_?(i=h===f?-Math.atan(1/0):Math.atan((_-u)/(f-h)))-l:h<=f&&_<u?(i=h===f?-Math.atan(1/0):Math.atan((u-_)/(f-h)))+l:f<h&&u<=_?(i=Math.atan((_-u)/(h-f)))-l:f<h&&_<u?(i=Math.atan((_-u)/(f-h)))<=l?i+Math.PI-l:-(d=Math.PI-i+l):0,p=Math.sqrt(Math.pow(t-h,2)+Math.pow(e-u,2)),v=h<=t&&u<=e?h===t?-Math.atan(1/0):Math.atan((e-u)/(t-h)):h<=t&&e<u?h===t?-Math.atan(1/0):-Math.atan((e-u)/(h-t)):t<h&&u<=e?Math.PI-Math.atan((e-u)/(h-t)):Math.atan((e-u)/(t-h))-Math.PI;return(v-=d)>Math.PI?(v-=Math.PI,[(h-p*Math.cos(v))/a,(u-p*Math.sin(v))/o]):v>.5*Math.PI?(v=Math.PI-v,[(h-p*Math.cos(v))/a,(u+p*Math.sin(v))/o]):0<=v?[(h+p*Math.cos(v))/a,(u+p*Math.sin(v))/o]:v>=.5*-Math.PI?(v=-v,[(h+p*Math.cos(v))/a,(u-p*Math.sin(v))/o]):v>=-Math.PI?(v=Math.PI+v,[(h-p*Math.cos(v))/a,(u-p*Math.sin(v))/o]):(v=-Math.PI-v,[(h-p*Math.cos(v))/a,(u+p*Math.sin(v))/o])},bboxBezier:function(t,e,r,i,n,a,o,s){return 4===arguments.length?[t,e,r,i]:6===arguments.length?(h=t,u=e,l=r,c=i,f=n,_=a,b=Math.min(h,f),k=Math.min(u,_),M=Math.max(h,f),w=Math.max(u,_),(l<b||c<k||M<l||w<c)&&(g=(v=1-(d=(h-l)/(h-2*l+f)))*v*h+2*v*d*l+d*d*f,m=(y=1-(p=(u-c)/(u-x*c+_)))*y*u+2*y*p*c+p*p*_,b=Math.min(b,g),k=Math.min(k,m),M=Math.min(M,g),w=Math.min(w,m)),[b,k,M,w]):8===arguments.length?(S=t,A=e,E=r,P=i,T=n,R=a,C=o,O=s,V=Math.min(S,C),Z=Math.min(A,O),K=Math.max(S,C),J=Math.max(A,O),(E<V||P<Z||K<E||J<P||T<V||R<Z||K<T||J<R)&&(D=(N=A-2*P+R)*N-(F=3*P-A-3*R+O)*(-A+P),0<(W=(L=S-2*E+T)*L-(I=3*E-S-3*T+C)*(-S+E))&&(0<(B=(-L-(W=Math.sqrt(W)))/I)&&B<1&&(z=(H=1-B)*H*H*S+3*H*H*B*E+3*H*B*B*T+B*B*B*C,V=Math.min(V,z),K=Math.max(K,z)),0<(B=(-L+W)/I)&&B<1&&(Y=(G=1-B)*G*G*S+3*G*G*B*E+3*G*B*B*T+B*B*B*C,V=Math.min(V,Y),K=Math.max(K,Y))),0<D&&(0<(X=(-N-(D=Math.sqrt(D)))/F)&&X<1&&(j=($=1-X)*$*$*A+3*$*$*X*P+3*$*X*X*R+X*X*X*O,Z=Math.min(Z,j),J=Math.max(J,j)),0<(X=(-N+D)/F)&&X<1&&(U=(q=1-X)*q*q*A+3*q*q*X*P+3*q*X*X*R+X*X*X*O,Z=Math.min(Z,U),J=Math.max(J,U)))),[V,Z,K,J]):void 0;var h,u,l,c,f,_,d,p,v,y,g,m,b,k,M,w,S,A,E,P,T,R,C,O,L,N,I,F,W,D,B,H,z,G,Y,X,$,j,q,U,V,Z,K,J},bezierLength:W,pointAtBezier:function(t,e,r,i,n){return B(t,e,W(t,e,0,1),r,i,n)},pointAtBezierWithLength:B,sliceBezier:H,sliceBezier2Both:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e=Math.max(e,0),r=Math.min(r,1);return 0===e&&1===r||(r<1&&(t=H(t,r)),0<e&&(r<1&&(e/=r),t=H(t.reverse(),1-e).reverse())),t}},ne=re.rgba2int,ae=re.int2rgba,z=re.isNil,G=j.PX,oe=j.PERCENT,Y=ie.d2r;function X(t){if(/%$/.test(t)||/px$/.test(t)||/^-?[\d.]+$/.test(t))return{value:parseFloat(t),unit:/%/.test(t)?oe:G};var e={value:{top:0,left:0,center:50,right:100,bottom:100}[t],unit:oe};return z(e.value)&&(e.value=50),e}function $(t,e){for(var r,i=[],n=0,a=t.length;n<a;n++){var o,s,h=t[n];1<h.length?(o=ae(h[0]),(s=h[1]).unit===oe?i.push([o,.01*s.value]):i.push([o,s.value/e])):i.push([ae(h[0])])}1===i[0].length&&i[0].push(0),1<i.length&&(1===i[r=i.length-1].length&&i[r].push(1));for(var u=i[0][1],l=1,c=i.length;l<c-1;l++){var f=i[l];if(1<f.length)u=f[1];else{for(var _=l+1,d=i[i.length-1][1];_<c-1;_++){var p=i[_];if(1<p.length){d=p[1];break}}for(var v=(d-u)/(_-l+1),y=l;y<_;y++){i[y].push(u+v*(y+1-l))}l=_}}for(var g=1,m=i.length;g<m;g++){var b=i[g],x=i[g-1];b[1]<x[1]&&(b[1]=x[1])}for(var k=0,M=i.length;k<M-1;k++){if(1<i[k][1]){i.splice(k+1);break}}for(var w=i.length-1;0<w;w--){if(i[w][1]<0){i.splice(0,w);break}}var S,A,E,P,T,R,C,O,L,N,I,F,W,D,B,H,z,G,Y,X,$,j,q,U,V,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht,ut,lt,ct,ft,_t,dt,pt,vt,yt,gt,mt,bt,xt,kt,Mt,wt,St,At,Et,Pt,Tt,Rt,Ct,Ot,Lt,Nt,It,Ft,Wt,Dt,Bt=i.length;if(1===Bt)i[0][1]=0;else{for(var Ht,zt,Gt,Yt,Xt,$t,jt,qt,Ut,Vt,Zt=!0,Kt=!0,Jt=Bt-1;0<=Jt;Jt--){var Qt=i[Jt][1];0<Qt&&(Zt=!1),Qt<1&&(Kt=!1)}Zt?(i.splice(0,Bt-1),i[0][1]=0):Kt?(i.splice(1),i[0][1]=0):(Ht=i[0],zt=i[Bt-1],2===Bt?Ht[1]<0&&1<zt[1]&&(vt=zt,yt=e,gt=ne((pt=Ht)[0]),mt=ne(vt[0]),bt=te(gt,4),xt=bt[0],kt=bt[1],Mt=bt[2],wt=bt[3],St=void 0===wt?1:wt,At=te(mt,4),Et=At[0],Pt=At[1],Tt=At[2],Rt=At[3],Ct=void 0===Rt?1:Rt,Ot=Math.abs(pt[1])*yt,Lt=vt[1]*yt,Nt=Ot/(Ot+Lt),It=Math.floor(xt+(Et-xt)*Nt),Ft=Math.floor(kt+(Pt-kt)*Nt),Wt=Math.floor(Mt+(Tt-Mt)*Nt),Dt=St+(Ct-St)*Nt,pt[0]="rgba("+It+","+Ft+","+Wt+","+Dt+")",pt[1]=0,Nt=(yt+Ot)/(Ot+Lt),It=Math.floor(xt+(Et-xt)*Nt),Ft=Math.floor(kt+(Pt-kt)*Nt),Wt=Math.floor(Mt+(Tt-Mt)*Nt),Dt=St+(Ct-St)*Nt,vt[0]="rgba("+It+","+Ft+","+Wt+","+Dt+")",vt[1]=1):(Ht[1]<0&&(Gt=i[1],Yt=ne(Ht[0]),Xt=ne(Gt[0]),q=Yt,U=Ht[1],V=Xt,Z=Gt[1],K=e,J=te(q,4),Q=J[0],tt=J[1],et=J[2],rt=J[3],it=void 0===rt?1:rt,nt=te(V,4),at=nt[0],ot=nt[1],st=nt[2],ht=nt[3],ut=void 0===ht?1:ht,lt=Math.abs(U)*K,ct=lt/(Z*K+lt),ft=Math.floor(Q+(at-Q)*ct),_t=Math.floor(tt+(ot-tt)*ct),dt=Math.floor(et+(st-et)*ct),$t=[ft,_t,dt,it+(ut-it)*ct],Ht[0]="rgba("+$t[0]+","+$t[1]+","+$t[2]+","+$t[3]+")",Ht[1]=0),1<zt[1]&&(jt=i[Bt-2],qt=ne(jt[0]),Ut=ne(zt[0]),S=qt,A=jt[1],E=Ut,P=zt[1],T=e,R=te(S,4),C=R[0],O=R[1],L=R[2],N=R[3],I=void 0===N?1:N,F=te(E,4),W=F[0],D=F[1],B=F[2],H=F[3],z=void 0===H?1:H,Y=(T-(G=A*T))/(P*T-G),X=Math.floor(C+(W-C)*Y),$=Math.floor(O+(D-O)*Y),j=Math.floor(L+(B-L)*Y),Vt=[X,$,j,I+(z-I)*Y],zt[0]="rgba("+Vt[0]+","+Vt[1]+","+Vt[2]+","+Vt[3]+")",zt[1]=1)))}return i.forEach(function(t){t[1]<0?t[1]=0:1<t[1]&&(t[1]=1)}),i}var q={parseGradient:function(t){var e,r,i,n=T.gradient.exec(t);if(n){var a,o,s,h,u,l={k:n[1]};"linear"===l.k?(a=/(-?[\d.]+deg)|(to\s+[toprighbml]+)/i.exec(n[2]),l.d=a?(e=a[0].toLowerCase(),i=180,"to top"===e?i=0:"to top right"===e?i=45:"to right"===e?i=90:"to bottom right"===e?i=135:"to bottom"===e||("to bottom left"===e?i=225:"to left"===e?i=270:"to top left"===e?i=315:(r=/(-?[\d.]+)deg/.exec(e))&&(i=parseFloat(r[1]))),i%360):180):"radial"===l.k&&(l.s=-1<n[2].indexOf("ellipse")?"ellipse":"circle",o=/(closest|farthest)-(side|corner)/i.exec(n[2]),l.z=o?o[0].toLowerCase():"farthest-corner",(s=/at\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center))(?:\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center)))?/i.exec(n[2]))?(h=X(s[1]),u=s[2]?X(s[2]):h,l.p=[h,u]):l.p=[{value:50,unit:oe},{value:50,unit:oe}]);var c=n[2].match(/((#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*(-?[\d.]+(px|%))?/gi);return l.v=c.map(function(t){var e=/((?:#[0-9a-f]{3,6})|(?:rgba?\(.+?\)))\s*(-?[\d.]+(?:px|%))?/i.exec(t),r=[ne(e[1])];return e[2]&&(r[1]={value:parseFloat(e[2])},/%$/.test(e[2])?r[1].unit=oe:r[1].unit=G),r}),l}},getLinear:function(t,e,r,i,n,a){var o,s,h,u,l,c,f,_,d,p,v,y,g=Y(e),m=Math.abs(n*Math.sin(g))+Math.abs(a*Math.cos(g)),b=te((s=.5*m,h=r,u=i,d=270<=(o=e)?(l=Y(360-o),c=h+Math.sin(l)*s,f=u+Math.cos(l)*s,_=h-Math.sin(l)*s,u-Math.cos(l)*s):180<=o?(p=Y(o-180),c=h+Math.sin(p)*s,f=u-Math.cos(p)*s,_=h-Math.sin(p)*s,u+Math.cos(p)*s):90<=o?(v=Y(180-o),c=h-Math.sin(v)*s,f=u-Math.cos(v)*s,_=h+Math.sin(v)*s,u+Math.cos(v)*s):(y=Y(o),c=h-Math.sin(y)*s,f=u+Math.cos(y)*s,_=h+Math.sin(y)*s,u-Math.cos(y)*s),[c,f,_,d]),4);return{x1:b[0],y1:b[1],x2:b[2],y2:b[3],stop:$(t,m)}},getRadial:function(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w,S,A,E=o-n,P=s-a,T=te((h=r,l=E,c=P,f=n,_=a,d=o,p=s,w=(u=i)[0].unit===G?f+u[0].value:f+u[0].value*l*.01,S=u[1].unit===G?_+u[1].value:_+u[1].value*c*.01,["closest-side"===h?w<=f||d<=w||S<=_||p<=S?0:(v=w<f+.5*l?w-f:d-w,y=S<_+.5*c?S-_:p-S,Math.min(v,y)):"closest-corner"===h?(g=w<f+.5*l?w-f:d-w,m=S<_+.5*c?S-_:p-S,Math.sqrt(Math.pow(g,2)+Math.pow(m,2))):"farthest-side"===h?w<=f?f-w+l:d<=w?w-d+l:S<=_?_-S+c:p<=w?S-p+c:(b=Math.max(d-w,w-f),x=Math.max(p-S,S-_),Math.max(b,x)):(k=w<f+.5*l?d-w:w-f,M=S<_+.5*c?p-S:S-_,Math.sqrt(Math.pow(k,2)+Math.pow(M,2))),w,S]),3),R=T[0],C=T[1],O=T[2],L=$(t,2*R);return R<=0&&((A=L[L.length-1])[1]=0,L=[A],C=n,O=a,R=E+P),{cx:C,cy:O,r:R,stop:L}}},U={position:"static",display:"block",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:"inherit",fontFamily:"inherit",color:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"normal",backgroundImage:null,backgroundColor:"transparent",backgroundSize:"auto",backgroundRepeat:"repeat",backgroundPositionX:0,backgroundPositionY:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"#000",borderRightColor:"#000",borderBottomColor:"#000",borderLeftColor:"#000",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",borderLeftStyle:"solid",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0,width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",alignSelf:"auto",textAlign:"inherit",transformOrigin:"center",visibility:"inherit",opacity:1,zIndex:0,transform:null,translateX:0,translateY:0,scaleX:1,scaleY:1,skewX:0,skewY:0,rotateZ:0,filter:null,boxShadow:null,pointerEvents:"inherit"},V={fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:4,fillRule:"nonzero"},Z=[],K=[];Object.keys(U).forEach(function(t){K.push(t);var e=U[t];Z.push({k:t,v:e})});var tt=[],et=[];Object.keys(V).forEach(function(t){et.push(t);var e=V[t];tt.push({k:t,v:e})});var rt={fontFamily:"arial",fontSize:16,fontWeight:400,fontStyle:"normal",color:"#000",textAlign:"left",visibility:"visible",pointerEvents:"auto"},it=[];Object.keys(rt).forEach(function(t){it.push(t)});var nt={DOM:U,GEOM:V,isValid:function(t){return U.hasOwnProperty(t)||V.hasOwnProperty(t)},DOM_KEY_SET:K,GEOM_KEY_SET:et,DOM_ENTRY_SET:Z,GEOM_ENTRY_SET:tt,INHERIT:rt,INHERIT_KEY_SET:it},at=re.isNil;function ot(t,e,r,i){at(t.flexGrow)&&(t.flexGrow=e||0),at(t.flexShrink)&&(t.flexShrink=r||0),at(t.flexBasis)&&(t.flexBasis=i||0)}var st={margin:["marginTop","marginRight","marginBottom","marginLeft"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"],border:["borderTop","borderRight","borderBottom","borderLeft"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderWidth:["borderWidthTop","borderWidthRight","borderWidthBottom","borderWidthLeft"],borderColor:["borderColorTop","borderColorRight","borderColorBottom","borderColorLeft"],borderStyle:["borderStyleTop","borderStyleRight","borderStyleBottom","borderStyleLeft"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],background:["backgroundColor","backgroundImage","backgroundRepeat","backgroundPosition"],backgroundRepeat:["backgroundRepeatX","backgroundRepeatY"],backgroundPosition:["backgroundPositionX","backgroundPositionY"],flex:["flexGrow","flexShrink","flexBasis"],translate:["translateX","translateY"],scale:["scaleX","scaleY"],rotate:["rotateZ"],skew:["skewX","skewY"],toFull:function(r,t){var e,i,n,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x=r[t];if("background"===t)at(r.backgroundImage)&&((e=T.gradient.exec(x))?(r.backgroundImage=e[0],x=x.replace(e[0],"")):(i=T.img.exec(x))&&(r.backgroundImage=i[0],x=x.replace(i[0],""))),!at(r.backgroundRepeat)||(n=/(no-)?repeat(-[xy])?/i.exec(x))&&(r.backgroundRepeat=n[0].toLowerCase(),this.toFull(r,"backgroundRepeat")),!at(r.backgroundColor)||(a=/^(transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\))/i.exec(x))&&(r.backgroundColor=a[0],x=x.replace(a[0],"")),!at(r.backgroundPosition)||(o=x.match(T.position))&&(r.backgroundPosition=o.join(" "),this.toFull(r,"backgroundPosition"));else if("flex"===t){"none"===x?ot(r,0,0,"auto"):"auto"===x?ot(r,1,1,"auto"):/^[\d.]+$/.test(x)?ot(r,Math.max(0,parseFloat(x)),1,0):/^[\d.]+px$/i.test(x)?ot(r,1,1,0):/^[\d.]+%$/.test(x)?ot(r,1,1,x):/^[\d.]+\s+[\d.]+$/.test(x)?(s=x.split(/\s+/),ot(r,s[0],s[1],0)):/^[\d.]+\s+[\d.]+%$/.test(x)?(h=x.split(/\s+/),ot(r,h[0],1,h[1])):ot(r,0,1,"auto")}else if("borderRadius"===t){1===(x=x.toString().split("/")).length&&(x[1]=x[0]);for(var k=0;k<2;k++){var M=x[k].toString().split(/\s+/);0===M.length?x[k]=[0,0,0,0]:1===M.length?x[k]=[M[0],M[0],M[0],M[0]]:2===M.length?x[k]=[M[0],M[1],M[0],M[1]]:3===M.length?x[k]=[M[0],M[1],M[2],M[1]]:x[k]=M.slice(0,4)}this[t].forEach(function(t,e){at(r[t])&&(r[t]=x[0][e]+" "+x[1][e])})}else{"backgroundPosition"===t?(1===(x=x.toString().split(/\s+/)).length&&(x[1]="50%"),this[t].forEach(function(t,e){at(r[t])&&(r[t]=x[e])})):-1<["translate","scale","skew"].indexOf(t)?(1===(u=x.toString().split(/\s*,\s*/)).length&&(u[1]=u[0]),this[t].forEach(function(t,e){at(r[t])&&(r[t]=u[e])})):"margin"===t||"padding"===t?(v=r,g=this[y=t],!(b=v[y])||(m=b.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi))&&(1===m.length?m[3]=m[2]=m[1]=m[0]:2===m.length?(m[2]=m[0],m[3]=m[1]):3===m.length&&(m[3]=m[1]),g.forEach(function(t,e){at(v[t])&&(v[t]=m[e])}))):/^border((Top)|(Right)|(Bottom)|(Left))$/.test(t)?(p=(l=r)[c=t],at(p)||(at(l[c+"Width"])&&(f=/\b[\d.]+px\b/i.exec(p),l[c+"Width"]=f?f[0]:0),at(l[c+"Style"])&&(_=/\b(solid|dashed|dotted)\b/i.exec(p),l[c+"Style"]=_?_[1]:"solid"),at(l[c+"Color"])&&((d=/#[0-9a-f]{3,6}/i.exec(p))&&-1<[4,7].indexOf(d[0].length)?l[c+"Color"]=d[0]:/\btransparent\b/i.test(p)?l[c+"Color"]="transparent":(d=/rgba?\(.+\)/i.exec(p),l[c+"Color"]=d?d[0]:"transparent")))):this[t]&&this[t].forEach(function(t){at(r[t])&&(r[t]=x)})}}},ht=["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color"],ut=["fontSize","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","bottom","left","right","top","flexBasis","width","height","lineHeight","marginBottom","marginLeft","marginRight","marginTop","paddingBottom","paddingLeft","paddingRight","paddingTop","strokeWidth","strokeMiterlimit"],lt=["backgroundImage","fill","stroke"],ct=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],ft={};ht.forEach(function(t){ft[t]=!0});var _t={};ut.forEach(function(t){_t[t]=!0});var dt={};ct.forEach(function(t){dt[t]=!0});var pt={};lt.forEach(function(t){pt[t]=!0});var vt=["translateX","translateY","scaleX","scaleY","rotateZ","skewX","skewY"],yt={};vt.forEach(function(t){yt[t]=!0});var gt={KEY_COLOR:ht,KEY_EXPAND:vt,KEY_GRADIENT:lt,KEY_LENGTH:ut,KEY_RADIUS:ct,COLOR_HASH:ft,EXPAND_HASH:yt,GRADIENT_HASH:pt,LENGTH_HASH:_t,RADIUS_HASH:dt,GRADIENT_TYPE:{linear:!0,radial:!0}},Ot={GEOM:{},IGNORE:{pointerEvents:!0},REPAINT:{transform:!0,translateX:!0,translateY:!0,skewX:!0,skewY:!0,scaleX:!0,scaleY:!0,rotateZ:!0,color:!0,fontStyle:!0,strokeWidth:!0,fill:!0,strokeDasharray:!0,strokeLinecap:!0,strokeLinejoin:!0,strokeMiterlimit:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0,backgroundSize:!0,stroke:!0,borderBottomColor:!0,borderLeftColor:!0,borderRightColor:!0,borderTopColor:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0,visibility:!0,opacity:!0,zIndex:!0,filter:!0,boxShadow:!0},MEASURE:{fontSize:!0,fontWeight:!0,fontFamily:!0},isIgnore:function(t){return this.IGNORE.hasOwnProperty(t)},isRepaint:function(t){return this.REPAINT.hasOwnProperty(t)||this.isGeom(t)},isMeasure:function(t){return this.MEASURE.hasOwnProperty(t)},addGeom:function(e,t){Array.isArray(t)?t.forEach(function(t){Ot.addGeom(e,t)}):t&&((Ot.GEOM[t]=Ot.GEOM[t]||{})[e]=!0)},isGeom:function(t,e){return this.GEOM.hasOwnProperty(e)&&this.GEOM[e].hasOwnProperty(t)},isValid:function(t,e){return!!e&&(!!nt.DOM.hasOwnProperty(e)||(!("$"!==t.charAt(0)||!nt.GEOM.hasOwnProperty(e))||!!this.GEOM.hasOwnProperty(e)&&this.GEOM[e].hasOwnProperty(t)))}},mt=Ot.MEASURE_KEY_SET=Object.keys(Ot.MEASURE),bt=mt.length;Ot.isMeasureInherit=function(t){for(var e=0;e<bt;e++){var r=mt[e];if(t.hasOwnProperty(r)&&t[r].unit===j.INHERIT)return!0}return!1},Ot.measureInheritList=function(t){for(var e=[],r=0;r<bt;r++){var i=mt[r];t.hasOwnProperty(i)&&t[i].unit===j.INHERIT&&e.push(i)}return e},Ot.addGeom("$line",["x1","y1","x2","y2","controlA","controlB","start","end"]),Ot.addGeom("$circle",["r"]),Ot.addGeom("$ellipse",["rx","ry"]),Ot.addGeom("$rect",["rx","ry"]),Ot.addGeom("$sector",["begin","end","edge","closure"]),Ot.addGeom("$polyline",["points","controls","start","end"]),Ot.addGeom("$polygon",["points","controls","start","end"]);var xt=j.AUTO,kt=j.PX,Mt=j.PERCENT,wt=j.NUMBER,St=j.INHERIT,At=j.DEG,Et=j.RGBA,Pt=j.STRING,Tt=re.isNil,Rt=re.rgba2int,Ct=gt.COLOR_HASH,Lt=gt.LENGTH_HASH,Nt=gt.RADIUS_HASH,It=gt.GRADIENT_HASH,Ft=gt.EXPAND_HASH,Wt=gt.GRADIENT_TYPE;function Dt(t,e,r){return"auto"===r?t[e]={unit:xt}:"inherit"===r?t[e]={unit:St}:/%$/.test(r)?(r=parseFloat(r)||0,t[e]={value:r,unit:Mt}):/px$/i.test(r)?(r=parseFloat(r)||0,t[e]={value:r,unit:kt}):/deg$/i.test(r)?(r=parseFloat(r)||0,t[e]={value:r,unit:At}):(r=parseFloat(r)||0,t[e]={value:r,unit:wt}),0===e.toString().indexOf("border")&&(t[e].value=Math.max(t[e].value,0)),t}function Bt(t,e){-1<t.indexOf("scale")?e.unit=wt:-1<t.indexOf("translate")?e.unit===wt&&(e.unit=kt):e.unit===wt&&(e.unit=At)}function Ht(t){return t.fontSize*h.arial.lhr}function zt(t,e,r){for(t*=.01;e;){var i=e.currentStyle[r];if(i.unit===xt){if("width"!==r)break;e=e.parent}else{if(i.unit===kt)return t*i.value;i.unit===Mt&&(t*=.01*i.value,e=e.parent)}}return t}var Gt={normalize:function(a){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!re.isObject(a))return{};var e,u,r,i,n,o,s,h,l=(a=re.extend({},a)).border;if(l&&(st.toFull(a,"border"),delete a.border),["borderTop","borderRight","borderBottom","borderLeft"].forEach(function(t){st.toFull(a,t),delete a[t]}),(l=a.borderWidth)&&(st.toFull(a,"borderWidth"),delete a.borderWidth),(l=a.borderColor)&&(st.toFull(a,"borderColor"),delete a.borderColor),(l=a.borderStyle)&&(st.toFull(a,"borderStyle"),delete a.borderStyle),(l=a.borderRadius)&&(st.toFull(a,"borderRadius"),delete a.borderRadius),(l=a.background)&&(st.toFull(a,"background"),delete a.background),l=a.backgroundPosition,Tt(l)||(st.toFull(a,"backgroundPosition"),delete a.backgroundPosition),(l=a.flex)&&(st.toFull(a,"flex"),delete a.flex),l=a.margin,Tt(l)||(st.toFull(a,"margin"),delete a.margin),l=a.padding,Tt(l)||(st.toFull(a,"padding"),delete a.padding),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=a[t];!Tt(e)&&a.transform&&console.error('Can not use expand style "'.concat(t,'" with transform'))}),["translate","scale","skew"].forEach(function(t){l=a[t],Tt(l)||(st.toFull(a,t),delete a[t])}),l=a.rotate,Tt(l)||(st.toFull(a,"rotate"),delete a.rotate),t.forEach(function(t){var e=t.k,r=t.v;Tt(a[e])&&(a[e]=r)}),(l=a.backgroundImage)&&(T.gradient.test(l)?a.backgroundImage=q.parseGradient(l):T.img.test(l)&&(a.backgroundImage=T.img.exec(l)[2])),(l=a.backgroundColor)&&((e=/^#[0-9a-f]{3,6}/i.exec(l))&&-1<[4,7].indexOf(e[0].length)?a.backgroundColor={value:Rt(e[0]),unit:Et}:(e=/rgba?\(.+\)/i.exec(l),a.backgroundColor={value:Rt(e?e[0]:[0,0,0,0]),unit:Et})),["backgroundPositionX","backgroundPositionY"].forEach(function(t){l=a[t],Tt(l)||(/%$/.test(l)||/px$/i.test(l)||/^-?[\d.]+$/.test(l)?(Dt(a,t,l),(l=a[t]).unit===wt&&(l.unit=kt)):a[t]={value:{top:0,left:0,center:50,right:100,bottom:100}[l],unit:Mt})}),l=a.backgroundSize){var c=a.backgroundSize=[],f=l.toString().match(/\b(?:(-?[\d.]+(px|%)?)|(contain|cover|auto))/gi);if(f){1===f.length&&("contain"===f[0]||"cover"===f[0]?f[1]=f[0]:f[1]="auto");for(var _=0;_<2;_++){var d=f[_];/%$/.test(d)||/px$/i.test(d)||/^-?[\d.]+$/.test(d)?(Dt(c,_,d),c[_].unit===wt&&(c[_].unit=kt)):"0"===d||0===d?c.push({value:0,unit:kt}):"contain"===d||"cover"===d?c.push({value:d,unit:Pt}):c.push({unit:xt})}}else c.push({unit:xt}),c[1]=c[0]}if(["Top","Right","Bottom","Left"].forEach(function(t){var e=a[t="border"+t+"Color"];Tt(e)||(a[t]={value:Rt(e),unit:Et})}),["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){var e=a[t="border"+t+"Radius"];if(!Tt(e)){var r=e.toString().split(/\s+/);1===r.length&&(r[1]=r[0]);for(var i=0;i<2;i++){var n=r[i];/%$/.test(n)||/px$/i.test(n)||/^-?[\d.]+$/.test(n)?(Dt(r,i,n),r[i].unit===wt&&(r[i].unit=kt)):r[i]={value:0,unit:kt}}a[t]=r}}),(l=a.transform)&&(u=a.transform=[],(r=l.toString().match(/\w+\(.+?\)/g))&&r.forEach(function(t){var e,r,i,n,a,o=t.indexOf("("),s=t.slice(0,o),h=t.slice(o+1,t.length-1);"matrix"===s?(6<(e=(e=h.toString().split(/\s*,\s*/)).map(function(t){return parseFloat(t)})).length&&(e=e.slice(0,6)),6===e.length&&u.push(["matrix",e])):!{translateX:!0,translateY:!0,scaleX:!0,scaleY:!0,skewX:!0,skewY:!0,rotate:!0,rotateZ:!0}.hasOwnProperty(s)?{translate:!0,scale:!0,skew:!0}.hasOwnProperty(s)&&(1===(i=h.toString().split(/\s*,\s*/)).length&&(i[1]=i[0]),n=Dt([s+"X",i[0]],1,i[0]),a=Dt([s+"Y",i[1]],1,i[1]),Bt(s,n[1]),Bt(s,a[1]),u.push(n),u.push(a)):("rotate"===s&&(s="rotateZ"),Bt(s,(r=Dt([s,h],1,h))[1]),u.push(r))})),l=a.transformOrigin,!Tt(l)){var p=a.transformOrigin=[],v=l.toString().match(T.position);if(v){1===v.length&&(v[1]=v[0]);for(var y=0;y<2;y++){var g=v[y];/%$/.test(g)||/px$/i.test(g)||/^-?[\d.]+$/.test(g)?(Dt(p,y,g),p[y].unit===wt&&(p[y].unit=kt)):(p.push({value:{top:0,left:0,center:50,right:100,bottom:100}[g],unit:Mt}),Tt(p[y].value)&&(p[y].value=50))}}else p.push({value:50,unit:Mt}),p[1]=p[0]}return["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=a[t];Tt(e)||(Dt(a,t,e),"rotate"===t&&(t="rotateZ",a.rotateZ=a.rotate,delete a.rotate),Bt(t,a[t]))}),(l=a.opacity)&&(l=parseFloat(l),isNaN(l)?a.opacity=1:(l=Math.max(l,0),l=Math.min(l,1),a.opacity=l)),(l=a.zIndex)&&(a.zIndex=parseInt(l)||0),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","top","right","bottom","left","width","height","flexBasis","strokeWidth"].forEach(function(t){var e=a[t];Tt(e)||(Dt(a,t,e),(e=a[t]).unit===wt&&(e.unit=kt))}),(l=a.color)&&(a.color="inherit"===l?{unit:St}:{value:Rt(l),unit:Et}),!(l=a.fontSize)&&0!==l||("inherit"===l?a.fontSize={unit:St}:/%$/.test(l)?(i=Math.max(0,parseFloat(l)),a.fontSize=i?{value:i,unit:Mt}:{value:16,unit:kt}):a.fontSize={value:Math.max(0,parseFloat(l))||16,unit:kt}),!(l=a.fontWeight)&&0!==l||(a.fontWeight="bold"===l?{value:700,unit:wt}:"normal"===l?{value:400,unit:wt}:"lighter"===l?{value:200,unit:wt}:"inherit"===l?{unit:St}:{value:Math.max(0,parseInt(l))||400,unit:wt}),(l=a.fontStyle)&&(a.fontStyle="inherit"===l?{unit:St}:{value:l,unit:Pt}),(l=a.fontFamily)&&(a.fontFamily="inherit"===l?{unit:St}:{value:l,unit:Pt}),(l=a.textAlign)&&(a.textAlign="inherit"===l?{unit:St}:{value:l,unit:Pt}),!(l=a.lineHeight)&&0!==l||("inherit"===l?a.lineHeight={unit:St}:"normal"===l?a.lineHeight={unit:xt}:/px$/i.test(l)?a.lineHeight={value:parseFloat(l),unit:kt}:(n=Math.max(0,parseFloat(l))||"normal",a.lineHeight="normal"===n?{unit:xt}:{value:n,unit:wt})),l=a.strokeDasharray,Tt(l)||((o=l.toString().match(/[\d.]+/g))?((o=o.map(function(t){return parseFloat(t)})).length%2==1&&o.push(o[o.length-1]),a.strokeDasharray=o):a.strokeDasharray=[]),(l=a.fill)&&(0<l.indexOf("-gradient(")?a.fill=q.parseGradient(l):a.fill=Rt(l)),(l=a.stroke)&&(0<l.indexOf("-gradient(")?a.stroke=q.parseGradient(l):a.stroke=Rt(l)),(l=a.filter)&&(a.filter=[],!(s=/\bblur\s*\(\s*([\d.]+)\s*(?:px)?\s*\)/i.exec(l))||(h=parseFloat(s[1])||0)&&a.filter.push(["blur",h])),(l=a.visibility)&&(a.visibility="inherit"===l?{unit:St}:{value:l,unit:Pt}),(l=a.pointerEvents)&&(a.pointerEvents="inherit"===l?{unit:St}:{value:l,unit:Pt}),(l=a.boxShadow)&&(a.boxShadow=[],l.match(/(-?[\d.]+(px)?)\s+(-?[\d.]+(px)?)\s+(-?[\d.]+(px)?\s*)?(-?[\d.]+(px)?\s*)?(((transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*)?(inset|outset)?\s*,?/gi).forEach(function(t){var e=/(-?[\d.]+(?:px)?)\s+(-?[\d.]+(?:px)?)\s+(-?[\d.]+(?:px)?\s*)?(-?[\d.]+(?:px)?\s*)?(?:((?:transparent)|(?:#[0-9a-f]{3,6})|(?:rgba?\(.+\)))\s*)?(inset|outset)?/i.exec(t);if(e){for(var r=[e[1],e[2],e[3]||0,e[4]||0,e[5]||"#000",e[6]||"outset"],i=0;i<4;i++)Dt(r,i,r[i]),1<i&&r[i].value<0&&(r[i]=0),r[i].unit===wt&&(r[i]=r[i].value);r[4]=Rt(r[4]),a.boxShadow.push(r)}})),a},computeMeasure:function(t,r){var i=t.currentStyle,n=t.computedStyle,e=t.parent,a=!r&&e.computedStyle;Ot.MEASURE_KEY_SET.forEach(function(t){var e=i[t];e.unit===St?n[t]=r?nt.INHERIT[t]:a[t]:e.unit===Mt?n[t]=r?nt.INHERIT[t]:a[t]*e.value*.01:n[t]=e.value})},computeReflow:function(t,e){var r=t.currentStyle,i=t.computedStyle,n=t.parent,a=r.textAlign,o=r.lineHeight,s=!n,h=n&&n.computedStyle;["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"].forEach(function(t){i[t]=r[t].unit===kt?Math.max(0,r[t].value):0}),["position","display","flexDirection","justifyContent","alignItems","alignSelf","flexGrow","flexShrink"].forEach(function(t){i[t]=r[t]}),a.unit===St?i.textAlign=s?"left":h.textAlign:i.textAlign=s?"left":a.value,o.unit===St?i.lineHeight=s?Ht(i):h.lineHeight:o.unit===kt?i.lineHeight=Math.max(o.value,0)||Ht(i):o.unit===wt?i.lineHeight=Math.max(o.value,0)*i.fontSize||Ht(i):i.lineHeight=Ht(i)},setFontStyle:function(t){var e=t.fontStyle,r=t.fontWeight,i=t.fontSize;return(e||"normal")+" "+(r||"400")+" "+i+"px/"+i+"px "+(t.fontFamily||"arial")},getBaseLine:function(t){var e=t.fontSize*h.arial.lhr;return.5*(t.lineHeight-e)+t.fontSize*h.arial.blr},calRelative:function(t,e,r,i,n){return r.unit===xt?r=0:-1<[kt,wt,At,Et,Pt].indexOf(r.unit)?r=r.value:r.unit===Mt&&(r=zt(r.value,i,n?"width":"height")),r},calAbsolute:function(t,e,r,i){return r.unit===xt?r=0:-1<[kt,wt,At,Et,Pt].indexOf(r.unit)?r=r.value:r.unit===Mt&&(r=r.value*i*.01),r},equalStyle:function(t,e,r,i){if(!e||!r)return e===r;if("transform"===t){if(e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++){var o=e[n],s=r[n];if(o[0]!==s[0])return!1;if("matrix"===o){if(!re.equalArr(o[1],s[1]))return!1}else if(!re.equal(o[1],s[1]))return!1}return!0}if("filter"===t){if(e.length!==r.length)return!1;for(var h=0,u=e.length;h<u;h++)if(!re.equalArr(e[h],r[h]))return!1}if("transformOrigin"===t||"backgroundSize"===t)return e[0].value===r[0].value&&e[0].unit===r[0].unit&&e[1].value===r[1].value&&e[1].unit===r[1].unit;if("backgroundPositionX"===t||"backgroundPositionY"===t||Lt.hasOwnProperty(t)||Ft.hasOwnProperty(t))return e.value===r.value&&e.unit===r.unit;if("boxShadow"===t)return re.equalArr(e,r);if(Nt.hasOwnProperty(t))return e[0].value===r[0].value&&e[0].unit===r[0].unit&&e[1].value===r[1].value&&e[1].unit===r[1].unit;if(Ct.hasOwnProperty(t))return e.unit===r.unit&&re.equalArr(e.value,r.value);if(It.hasOwnProperty(t)&&e.k===r.k&&Wt.hasOwnProperty(e.k)){var l=e.v,c=r.v;if(e.d!==r.d||l.length!==c.length)return!1;for(var f=0,_=l.length;f<_;f++){var d=l[f],p=c[f];if(d.length!==p.length)return!1;for(var v=0;v<4;v++)if(d[0][v]!==p[0][v])return!1;if(1<d.length&&(d[1].value!==p[1].value||d[1].unit!==p[1].unit))return!1}return!0}return Ot.isGeom(i.tagName,t)&&(i.isMulti||Array.isArray(e)&&Array.isArray(r))?re.equalArr(e,r):e===r},isRelativeOrAbsolute:function(t){var e=t.currentStyle.position;return"relative"===e||"absolute"===e}},Yt=function(){function a(t,e,r,i,n){u(this,a),this.__parent=t,this.__x=e,this.__y=r,this.__width=i,this.__content=n,this.__virtualDom={}}return l(a,[{key:"render",value:function(t,e,r,i,n,a){var o=this.content,s=this.x,h=this.y,u=this.parent,l=u.ox,c=u.oy;h+=Gt.getBaseLine(r),s+=l+n,h+=c+a,t===Qt.CANVAS?e.fillText(o,s,h):t===Qt.SVG&&(this.__virtualDom={type:"item",tagName:"text",props:[["x",s],["y",h],["fill",i.color],["font-family",r.fontFamily],["font-weight",r.fontWeight],["font-style",r.fontStyle],["font-size",r.fontSize+"px"]],content:re.encodeHtml(o)})}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"content",get:function(){return this.__content}},{key:"baseLine",get:function(){return Gt.getBaseLine(this.parent.computedStyle)}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}}]),a}(),Xt=function(){e(d,M);var r=f(d);function d(t){var e;return u(this,d),(e=r.call(this)).__content=re.isNil(t)?"":t.toString(),e.__lineBoxes=[],e.__charWidthList=[],e.__charWidth=0,e.__textWidth=0,e}return l(d,[{key:"__computeMeasure",value:function(t,e){var r=this.content,i=this.computedStyle,n=this.charWidthList;n.splice(0),t===Qt.CANVAS&&(e.font=Gt.setFontStyle(i));for(var a=i.fontSize+","+i.fontFamily+","+i.fontWeight,o=d.MEASURE_TEXT.data[a]=d.MEASURE_TEXT.data[a]||{key:a,style:i,hash:{},s:[]},s=d.CHAR_WIDTH_CACHE[a]=d.CHAR_WIDTH_CACHE[a]||{},h=0,u=!1,l=0,c=r.length;l<c;l++){var f=r.charAt(l),_=void 0;s.hasOwnProperty(f)?(_=s[f],n.push(_),h+=_,this.__charWidth=Math.max(this.charWidth,_)):t===Qt.CANVAS?(_=s[f]=e.measureText(f).width,n.push(_),h+=_,this.__charWidth=Math.max(this.charWidth,_)):(o.hash.hasOwnProperty(f)||(o.s+=f),o.hash[f]=!0,n.push(-1),u=!0)}this.__textWidth=h,u&&d.MEASURE_TEXT.list.push(this)}},{key:"__measureCb",value:function(){for(var t,e=this.content,r=this.computedStyle,i=this.charWidthList,n=r.fontSize+","+r.fontFamily+","+r.fontWeight,a=d.CHAR_WIDTH_CACHE[n],o=0,s=0,h=i.length;s<h;s++){i[s]<0&&(o+=t=i[s]=a[e.charAt(s)],this.__charWidth=Math.max(this.charWidth,t))}this.__textWidth=o}},{key:"__layout",value:function(t,e){var r=this,i=t.x,n=t.y,a=t.w;this.__x=this.__sx1=i,this.__y=this.__sy1=n;var o=this.isDestroyed,s=this.content,h=this.computedStyle,u=this.lineBoxes,l=this.charWidthList;if(!o&&"none"!==h.display){this.__ox=this.__oy=0,u.splice(0);for(var c,f,_,d,p=0,v=0,y=0,g=s.length,m=0;v<g;){(y+=l[v])===a?(c=new Yt(this,i,n,y,s.slice(p,v+1)),u.push(c),m=Math.max(m,y),n+=h.lineHeight,v=p=v+1,y=0):a<y?(f=void 0,f=v===p?(v=p+1,y):y-l[v],_=new Yt(this,i,n,f,s.slice(p,v)),u.push(_),m=Math.max(m,f),n+=h.lineHeight,p=v,y=0):v++}if(p<g&&p<v){for(y=0,v=p;v<g;v++)y+=l[v];var b=new Yt(this,i,n,y,s.slice(p,g));u.push(b),m=Math.max(m,y),n+=h.lineHeight}this.__width=m,this.__height=n-t.y,e||(d=h.textAlign,-1<["center","right"].indexOf(d)&&u.forEach(function(t){var e=r.__width-t.width;0<e&&t.__offsetX("center"===d?.5*e:e)}))}}},{key:"__offsetX",value:function(e,t){Q(J(d.prototype),"__offsetX",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetX(e)}),this.__sx1+=e}},{key:"__offsetY",value:function(e,t){Q(J(d.prototype),"__offsetY",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetY(e)}),this.__sy1+=e}},{key:"__tryLayInline",value:function(t){return t-this.textWidth}},{key:"__calMaxAndMinWidth",value:function(){var e=0;return this.charWidthList.forEach(function(t){e=Math.max(e,t)}),{max:this.textWidth,min:e}}},{key:"__calAbsWidth",value:function(t,e,r){return this.__layout({x:t,y:e,w:r},!0),this.width}},{key:"render",value:function(e,t,r,i,n,a){var o=4<arguments.length&&void 0!==n?n:0,s=5<arguments.length&&void 0!==a?a:0;e===Qt.SVG&&(this.__virtualDom={type:"text",children:[]});var h,u,l=this.isDestroyed,c=this.computedStyle,f=this.lineBoxes,_=this.cacheStyle;return!l&&"none"!==c.display&&"hidden"!==c.visibility&&(e===Qt.CANVAS&&(h=Gt.setFontStyle(c),r.font!==h&&(r.font=h),u=_.color,r.fillStyle!==u&&(r.fillStyle=u)),f.forEach(function(t){t.render(e,r,c,_,o,s)}),e===Qt.SVG&&(this.virtualDom.children=f.map(function(t){return t.virtualDom})),!0)}},{key:"deepScan",value:function(t){t(this)}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"lineBoxes",get:function(){return this.__lineBoxes}},{key:"charWidthList",get:function(){return this.__charWidthList}},{key:"charWidth",get:function(){return this.__charWidth}},{key:"textWidth",get:function(){return this.__textWidth}},{key:"baseLine",get:function(){var t=this.lineBoxes;if(!t.length)return 0;var e=t[t.length-1];return e.y-this.y+e.baseLine}},{key:"currentStyle",get:function(){return this.parent.currentStyle}},{key:"computedStyle",get:function(){return this.parent.computedStyle}},{key:"cacheStyle",get:function(){return this.parent.__cacheStyle}},{key:"bbox",get:function(){if(this.content){var t=this.sx,e=this.sy;return[t,e,t+this.width,e+this.height]}}}]),d}();t(Xt,"CHAR_WIDTH_CACHE",{}),t(Xt,"MEASURE_TEXT",{list:[],data:{}}),Xt.prototype.__renderByMask=Xt.prototype.render;var $t=.5*Math.PI;var jt={canvasPolygon:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(e&&e.length){for(var n=0,a=0,o=e.length;a<o;a++){var s=e[a];if(Array.isArray(s)){n=a;break}}t.moveTo(e[n][0]+r,e[n][1]+i);for(var h=n+1,u=e.length;h<u;h++){var l=e[h];Array.isArray(l)&&(2===l.length?t.lineTo(l[0]+r,l[1]+i):4===l.length?t.quadraticCurveTo(l[0]+r,l[1]+i,l[2]+r,l[3]+i):6===l.length&&t.bezierCurveTo(l[0]+r,l[1]+i,l[2]+r,l[3]+i,l[4]+r,l[5]+i))}}},svgPolygon:function(t){if(!t||!t.length)return"";for(var e=0,r=0,i=t.length;r<i;r++){var n=t[r];if(Array.isArray(n)){e=r;break}}for(var a="M"+t[e][0]+","+t[e][1],o=e+1,s=t.length;o<s;o++){var h=t[o];Array.isArray(h)&&(2===h.length?a+="L"+h[0]+","+h[1]:4===h.length?a+="Q"+h[0]+","+h[1]+" "+h[2]+","+h[3]:6===h.length&&(a+="C"+h[0]+","+h[1]+" "+h[2]+","+h[3]+" "+h[4]+","+h[5]))}return a},canvasLine:function(t,e,r,i,n,a,o,s){var h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,u=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0;return t.moveTo(e+h,r+u),3===s?(t.bezierCurveTo(a[0]+h,a[1]+u,o[0]+h,o[1],i+h,n+u),2):2===s?(t.quadraticCurveTo(o[0]+h,o[1]+u,i+h,n+u),2):1===s?(t.quadraticCurveTo(a[0]+h,a[1]+u,i+h,n+u),2):(t.lineTo(i+h,n+u),1)},svgLine:function(t,e,r,i,n,a,o){return 3===o?"M"+t+","+e+"C"+n[0]+","+n[1]+" "+a[0]+","+a[1]+" "+r+","+i:2===o?"M"+t+","+e+"Q"+a[0]+","+a[1]+" "+r+","+i:1===o?"M"+t+","+e+"Q"+n[0]+","+n[1]+" "+r+","+i:"M"+t+","+e+"L"+r+","+i},canvasSector:function(t,e,r,i,n,a,o,s,h,u,l,c,f,_){var d=14<arguments.length&&void 0!==arguments[14]?arguments[14]:0,p=15<arguments.length&&void 0!==arguments[15]?arguments[15]:0;t.arc(e+d,r+p,i,u*Math.PI/180-$t,l*Math.PI/180-$t),f?(c&&_||t.lineTo(e+d,r+p),t.lineTo(n+d,a+p),0<h&&t.stroke()):(0<h&&t.stroke(),c&&_||t.lineTo(e+d,r+p),t.lineTo(n+d,a+p))},svgSector:function(t,e,r,i,n,a,o,s,h,u,l){var c;return(!u||0<s)&&(c="M"+i+","+n+"A"+r+","+r+" 0 "+h+" 1 "+a+","+o),[l&&h?"M"+i+","+n+"A"+r+","+r+" 0 "+h+" 1 "+a+","+o+"z":"M"+t+","+e+"L"+i+","+n+"A"+r+","+r+" 0 "+h+" 1 "+a+","+o+"z",c]}};function qt(t,e,r,i){var n=r-t,a=i-e,o=Math.atan(Math.abs(a)/Math.abs(n));return n<0&&0<=a?Math.PI-o:n<0&&a<0?o-Math.PI:0<=n&&0<=a?o:-o}function Ut(t){var e=Math.sin(t),r=Math.cos(t),i=ee.identity();return i[0]=i[3]=r,i[1]=e,i[2]=-e,i}function Vt(t,e){var r=te(t,6),i=r[0],n=r[1],a=r[2],o=r[3],s=r[4],h=r[5],u=te(e,6),l=u[0],c=u[1],f=u[2],_=u[3],d=u[4],p=(a-i)*(h-n)-(s-i)*(o-n),v=(f-l)*(u[5]-c)-(d-l)*(_-c);return 0<p&&v<0||p<0&&0<v}var Zt={exchangeOrder:function(t,e){var r,i,n,a,o,s,h,u,l,c,f,_,d,p,v,y,g=(l=te(t,6),c=l[0],f=l[1],_=l[2],d=l[3],p=l[4],v=l[5],y=[0,1,2],_<c&&_<p?(c=(r=[_,d,c,f])[0],f=r[1],_=r[2],d=r[3],y[0]=1,y[1]=0):p<_&&p<c&&(c=(i=[p,v,c,f])[0],f=i[1],p=i[2],v=i[3],y[0]=2,y[2]=0),c===_?d<f&&(c=(n=[_,d,c,f])[0],f=n[1],_=n[2],d=n[3],a=y[0],y[0]=y[1],y[1]=a):c===p&&v<f&&(c=(o=[p,v,c,f])[0],f=o[1],p=o[2],v=o[3],s=y[0],y[0]=y[2],y[2]=s),(_-c)*(v-f)-(p-c)*(d-f)<0&&(_=(h=[p,v,_,d])[0],d=h[1],p=h[2],v=h[3],u=y[1],y[1]=y[2],y[2]=u),[c,f,_,d,p,v,y]),m=te(g,7),b=m[0],x=m[1],k=m[2],M=m[3],w=m[4],S=m[5],A=te(function(t,e){for(var r=[],i=0,n=e.length;i<n;i++){var a=e[i];r.push(t[2*a]),r.push(t[2*a+1])}return r}(e,m[6]),6);return[[b,x,k,M,w,S],[A[0],A[1],A[2],A[3],A[4],A[5]]]},isOverflow:Vt,transform:function(t,e){var r,i=te(t,6),n=i[0],a=i[1],o=i[2],s=i[3],h=i[4],u=i[5],l=te(e,6),c=l[0],f=l[1],_=l[2],d=l[3],p=l[4],v=l[5],y=Vt(t,e),g=ee.identity();g[4]=-n,g[5]=-a;var m=qt(n,a,o,s);0!==m&&(r=Ut(-m),g=ee.multiply(r,g));var b=ie.pointsDistance(n,a,o,s),x=ie.pointsDistance(c,f,_,d),k=ee.identity();k[4]=-c,k[5]=-f;var M=m=qt(c,f,_,d);0!==m&&(r=Ut(-m),k=ee.multiply(r,k));var w=Math.abs(ee.calPoint([h,u],g)[1]),S=Math.abs(ee.calPoint([p,v],k)[1]);b===x&&w===S||(r=ee.identity(),b!==x&&(r[0]=x/b),w!==S&&(r[3]=S/w),g=ee.multiply(r,g)),k=g;var A=te(ee.calPoint([n,a],k),2),E=A[0],P=A[1],T=te(ee.calPoint([o,s],k),2),R=T[0],C=T[1],O=te(ee.calPoint([h,u],k),2),L=O[0],N=O[1],I=ie.pointsDistance(E,P,R,C),F=ie.pointsDistance(E,P,L,N),W=ie.pointsDistance(L,N,R,C),D=ie.pointsDistance(c,f,_,d),B=ie.pointsDistance(c,f,p,v),H=ie.pointsDistance(p,v,_,d),z=ie.angleBySide(W,I,F),G=ie.angleBySide(H,D,B);return z!==G&&((r=ee.identity())[2]=Math.tan(z-.5*Math.PI)+Math.tan(.5*Math.PI-G),g=ee.multiply(r,g)),y&&(g[1]=-g[1],g[3]=-g[3],g[5]=-g[5]),(r=0!==M?Ut(M):ee.identity())[4]=c,r[5]=f,g=ee.multiply(r,g)}},Kt={matrix:ee,tar:Zt,geom:ie},Jt=j.PX,se=j.PERCENT,he=Kt.matrix,ue=Kt.geom,le=he.identity,ce=he.calPoint,fe=he.multiply,_e=he.isE,de=ue.d2r,pe=ue.pointInPolygon;function ve(t,e,r){var n,a,o,i=(n=e,a=r,o=[],t.forEach(function(t){var e=te(t,2),r=e[0],i=e[1];o.push([r,function(t,e,r,i){if("translateX"===t){if(e.unit===se)return e.value*r*.01}else if("translateY"===t){if(e.unit===se)return e.value*i*.01}else if("matrix"===t)return e;return e.value}(r,i,n,a)])}),o),l=le();return i.forEach(function(t){var e,r,i,n,a,o=te(t,2),s=o[0],h=o[1],u=le();e=u,i=h,"translateX"===(r=s)?e[4]=i:"translateY"===r?e[5]=i:"scaleX"===r?e[0]=i:"scaleY"===r?e[3]=i:"skewX"===r?(i=de(i),e[2]=Math.tan(i)):"skewY"===r?(i=de(i),e[1]=Math.tan(i)):"rotateZ"===r?(i=de(i),n=Math.sin(i),a=Math.cos(i),e[0]=e[3]=a,e[1]=n,e[2]=-n):"matrix"===r&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5]),l=fe(l,u)}),l}function ye(t,e){var r=te(e,2),i=r[0],n=r[1];if(0===i&&0===n)return t;var a=le();a[4]=i,a[5]=n;var o=fe(a,t),s=le();return s[4]=-i,s[5]=-n,fe(o,s)}var ge={calMatrix:ve,calOrigin:function(t,r,i){var n=[];return t.forEach(function(t,e){t.unit===Jt?n.push(t.value):t.unit===se&&n.push(t.value*(e?i:r)*.01)}),n},calMatrixByOrigin:ye,calMatrixWithOrigin:function(t,e,r,i){return ye(ve(t,r,i),e)},pointInQuadrilateral:function(t,e,r,i,n,a,o,s,h,u,l){if(!l||_e(l))return r<=t&&i<=e&&t<=o&&e<=s;var c=te(ce([r,i],l),2);r=c[0],i=c[1];var f=te(ce([n,a],l),2);n=f[0],a=f[1];var _=te(ce([h,u],l),2);h=_[0],u=_[1];var d=te(ce([o,s],l),2);return o=d[0],s=d[1],pe(t,e,[[r,i],[n,a],[o,s],[h,u]])}},me=ie.H;function be(t,e,r,i,n,a,o,s){var h=1,u=1,l=1;t:for(var c=a;n<=c;c--)for(var f=s;o<=f;f--){var _=c+f,d=Math.floor((t+f)/_),p=f;if(d*_<f+t)if(s<(p=(t-d*c)/(d-1)))continue;if(_=c+p,1<e&&c<e){if(c<e%_)continue;if(1<r)if(c<(e+i)%_)continue}if(1<r)if(c<(e+i)%_)continue;0<d&&(h=d,u=c,l=p);break t}return{n:h,ps:u,pd:l}}function xe(t,e,r,i,n,a){var o=n-e,s=i-r,h=r-e,u=n-i;if("dotted"===t)return be(o,h,u,s,a,a,Math.max(1,.25*a),2*a);var l=be(o,h,u,s,a,3*a,Math.max(1,.25*a),2*a),c=l.n,f=l.ps,_=l.pd;return 1===c?be(o,h,u,s,a,a,Math.max(1,.25*a),2*a):{n:c,ps:f,pd:_}}function ke(t,e,r,i,n,a,o,s,h,u,l,c,f,_){var d=te(f,2),p=d[0],v=d[1],y=te(_,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,S,A,E,P,T,R,C,O,L,N,I=n+p-(n-i),F=a-g+(o-a),W=[],D=[],B=[],H=0,z=c.length;H<z;H++){var G,Y,X,$,j=c[H];j[1][0]<I?W.push(j):j[0][0]>F?B.push(j):j[1][0]>F&&j[0][0]<I?(G=I<n?s+Math.tan(e)*(I-i):h,Y=a<F?s+Math.tan(r)*(o-F):h,W.push([j[0],[I,s],[I,G],j[3]]),I<F&&(n<I&&F<a?D.push([[I,s],[F,s],[F,h],[I,h]]):n<I?(D.push([[I,s],[a,s],[a,h],[I,h]]),D.push([[a,s],[F,s],[F,Y],[a,h]])):F<a?(D.push([[I,s],[n,s],[n,h],[I,G]]),D.push([[n,s],[F,s],[F,h],[n,h]])):(D.push([[I,s],[n,s],[n,h],[I,G]]),D.push([[n,s],[a,s],[a,h],[n,h]]),D.push([[a,s],[F,s],[F,Y],[a,h]]))),B.push([[F,s],j[1],j[2],[F,Y]])):j[1][0]>F?(X=a<F?s+Math.tan(r)*(o-F):h,D.push([j[0],[F,s],[F,X],j[3]]),B.push([[F,s],j[1],j[2],[F,X]])):j[0][0]<I?($=I<n?s+Math.tan(e)*(I-i):h,W.push([j[0],[I,s],[I,$],j[3]]),D.push([[I,s],j[1],j[2],[I,$]])):D.push(j)}W.length&&(b=n-i<p&&t<v,x=Math.atan((n-i)/(h-s)),M=(k=v)/p,w=s+v,A=(S=v-(h-s))/(p-(n-i)),P=te((E=Me(W[0][0],W[0][1],I,w,M,k,!0,Math.tan(x)*k))[0],2),L=P[0],N=P[1],b&&(R=te((T=Me(W[0][3],W[0][2],I,w,A,S,!0,Math.tan(x)*S))[0],2),C=R[0],O=R[1]),W.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=T)):(r=Me(t[0],t[1],I,w,M,k),b&&(i=Me(t[3],t[2],I,w,A,S)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],L,N,0);if(t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3]),b){for(var o=0,s=i.length;o<s;o++)Ne(i[o],C,O,0);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}}));var q,U,V,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=B.length;return ht&&(q=o-a<g&&t<m,U=Math.atan((o-a)/(h-s)),Z=(V=m)/g,K=s+m,Q=(J=m-(h-s))/(g-(o-a)),et=te((tt=we(B[ht-1][0],B[ht-1][1],F,K,Z,V,!0,Math.tan(U)*V))[tt.length-1],2),ot=et[0],st=et[1],q&&(it=te((rt=we(B[ht-1][3],B[ht-1][2],F,K,Q,J,!0,Math.tan(U)*J))[rt.length-1],2),nt=it[0],at=it[1]),B.forEach(function(t,e){var r,i;e===ht-1?(r=tt,q&&(i=rt)):(r=we(t[0],t[1],F,K,Z,V),q&&(i=we(t[3],t[2],F,K,Q,J)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],ot,st,1);if(t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3]),q){for(var o=0,s=i.length;o<s;o++)Ne(i[o],nt,at,1);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}})),W.concat(D).concat(B)}function Me(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(-y+r)*n,M=(-b+r)*n,w=Math.atan(M/(i-x)),S=r-Math.sin(w)*a/n,A=i-Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r-Math.cos(f)*a/n,i-Math.sin(f)*a):(_=Math.atan(k/(i-g)),d=r-Math.sin(_)*a/n,i-Math.cos(_)*a),_===w)return[[d,p]];var E=ie.h(Math.abs(_-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=_-T,C=w+T;return[[d,p],[r-Math.sin(R)*P/n,i-Math.cos(R)*P],[r-Math.sin(C)*P/n,i-Math.cos(C)*P],[S,A]]}function we(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(k/(i-g)),S=r+Math.sin(w)*a/n,A=i-Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r+Math.cos(f)*a/n,i-Math.sin(f)*a):(_=Math.atan(M/(i-x)),d=r+Math.sin(_)*a/n,i-Math.cos(_)*a),w===_)return[[S,A]];var E=ie.h(Math.abs(w-_))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w+T,C=_-T;return[[S,A],[r+Math.sin(R)*P/n,i-Math.cos(R)*P],[r+Math.sin(C)*P/n,i-Math.cos(C)*P],[d,p]]}function Se(t,e,r,i,n,a,o,s,h,u,l,c,f,_){var d=te(f,2),p=d[0],v=d[1],y=te(_,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,S,A,E,P,T,R,C,O,L,N,I=h+v-(h-s),F=u-m+(l-u),W=[],D=[],B=[],H=0,z=c.length;H<z;H++){var G,Y,X,$,j=c[H];j[2][1]<I?W.push(j):j[1][1]>F?B.push(j):j[2][1]>F&&j[1][1]<I?(G=I<h?a+Math.tan(r)*(h-I):a,Y=u<F?a+Math.tan(e)*(F-u):a,W.push([j[0],j[1],[o,I],[G,I]]),I<F&&(F<u&&h<I?D.push([[a,I],[o,I],[o,F],[a,F]]):h<I?(D.push([[a,h],[o,h],[o,u],[a,u]]),D.push([[a,u],[o,u],[o,F],[Y,F]])):F<u?(D.push([[G,I],[o,I],[o,h],[a,h]]),D.push([[a,h],[o,h],[o,F],[a,F]])):(D.push([[G,I],[o,I],[o,h],[a,h]]),D.push([[a,h],[o,h],[o,u],[a,u]]),D.push([[a,u],[o,u],[o,F],[Y,F]]))),B.push([[Y,F],[o,F],j[2],j[3]])):j[2][1]>F?(X=u<F?a+Math.tan(e)*(F-u):a,D.push([j[0],j[1],[o,F],[X,F]]),B.push([[X,F],[o,F],j[2],j[3]])):j[1][1]<I?($=I<h?a+Math.tan(r)*(h-I):a,W.push([j[0],j[1],[o,I],[$,I]]),D.push([[$,I],[o,I],j[2],j[3]])):D.push(j)}W.length&&(b=h-s<v&&t<p,x=Math.atan((o-a)/(h-s)),M=(k=v)/p,w=o-p,A=(S=v-(h-s))/(p-(o-a)),P=te((E=Ae(W[0][1],W[0][2],w,I,M,k,!0,Math.tan(x)*k))[E.length-1],2),L=P[0],N=P[1],b&&(R=te((T=Ae(W[0][0],W[0][3],w,I,A,S,!0,Math.tan(x)*S))[T.length-1],2),C=R[0],O=R[1]),W.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=T)):(r=Ae(t[1],t[2],w,I,M,k),b&&(i=Ae(t[0],t[3],w,I,A,S)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],L,N,2);if(b){for(var o=0,s=i.length;o<s;o++)Ne(i[o],C,O,2);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[2]=t[3],t[3]=t[0];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}));var q,U,V,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=B.length;return ht&&(q=l-u<m&&t<g,U=Math.atan((o-a)/(l-u)),Z=(V=m)/g,K=o-g,Q=(J=m-(l-u))/(g-(o-a)),et=te((tt=Ee(B[ht-1][1],B[ht-1][2],K,F,Z,V,!0,Math.tan(U)*V))[0],2),ot=et[0],st=et[1],q&&(it=te((rt=Ee(B[ht-1][0],B[ht-1][3],K,F,Q,J,!0,Math.tan(U)*J))[0],2),nt=it[0],at=it[1]),B.forEach(function(t,e){var r,i;e===ht-1?(r=tt,q&&(i=rt)):(r=Ee(t[1],t[2],K,F,Z,V),q&&(i=Ee(t[0],t[3],K,F,Q,J)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],ot,st,3);if(q){for(var o=0,s=i.length;o<s;o++)Ne(i[o],nt,at,3);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[2]=t[3],t[3]=t[0];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])})),W.concat(D).concat(B)}function Ae(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(M/(i-x)),S=r+Math.sin(w)*a/n,A=i-Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r+Math.cos(f)*a/n,i-Math.sin(f)*a):(_=Math.atan(k/(i-g)),d=r+Math.sin(_)*a/n,i-Math.cos(_)*a),_===w)return[[d,p]];var E=ie.h(Math.abs(_-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=_+T,C=r+Math.sin(R)*P/n,O=i-Math.cos(R)*P,L=w-T;return[[S,A],[r+Math.sin(L)*P/n,i-Math.cos(L)*P],[C,O],[d,p]]}function Ee(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(k/(g-i)),S=r+Math.sin(w)*a/n,A=i+Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r+Math.cos(f)*a/n,i+Math.sin(f)*a):(_=Math.atan(M/(x-i)),d=r+Math.sin(_)*a/n,i+Math.cos(_)*a),w===_)return[[S,A]];var E=ie.h(Math.abs(w-_))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w-T,C=r+Math.sin(R)*P/n,O=i+Math.cos(R)*P,L=_+T;return[[d,p],[r+Math.sin(L)*P/n,i+Math.cos(L)*P],[C,O],[S,A]]}function Pe(t,e,r,i,n,a,o,s,h,u,l,c,f,_){var d=te(f,2),p=d[0],v=d[1],y=te(_,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,S,A,E,P,T,R,C,O,L,N,I=n+p-(n-i),F=a-g+(o-a),W=[],D=[],B=[],H=0,z=c.length;H<z;H++){var G,Y,X,$,j=c[H];j[2][0]<I?W.push(j):j[3][0]>F?B.push(j):j[2][0]>F&&j[3][0]<I?(G=I<n?l-Math.tan(e)*(I-i):h,Y=a<F?l-Math.tan(r)*(o-F):u,W.push([j[0],[I,G],[I,l],j[3]]),I<F&&(n<I&&F<a?D.push([[I,u],[F,u],[F,l],[I,l]]):n<I?(D.push([[I,u],[a,u],[a,l],[I,l]]),D.push([[a,u],[F,Y],[F,l],[a,l]])):F<a?(D.push([[I,G],[n,u],[n,l],[I,l]]),D.push([[n,u],[F,u],[F,l],[n,l]])):(D.push([[I,G],[n,u],[n,l],[I,l]]),D.push([[n,u],[a,u],[a,l],[n,l]]),D.push([[a,u],[F,Y],[F,l],[a,l]]))),B.push([[F,Y],j[1],j[2],[F,l]])):j[2][0]>F?(X=a<F?l-Math.tan(r)*(o-F):u,D.push([j[0],[F,X],[F,l],j[3]]),B.push([[F,X],j[1],j[2],[F,l]])):j[3][0]<I?($=I<n?l-Math.tan(e)*(I-i):u,W.push([j[0],[I,$],[I,l],j[3]]),D.push([[I,$],j[1],j[2],[I,l]])):D.push(j)}W.length&&(b=n-i<p&&t<v,x=Math.atan((n-i)/(l-u)),M=(k=v)/p,w=l-v,A=(S=v-(l-u))/(p-(n-i)),P=te((E=Te(W[0][3],W[0][2],I,w,M,k,!0,Math.tan(x)*k))[0],2),L=P[0],N=P[1],b&&(R=te((T=Te(W[0][0],W[0][1],I,w,A,S,!0,Math.tan(x)*S))[0],2),C=R[0],O=R[1]),W.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=T)):(r=Te(t[3],t[2],I,w,M,k),b&&(i=Te(t[0],t[1],I,w,A,S)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],L,N,4);if(b){for(var o=0,s=i.length;o<s;o++)Ne(i[o],C,O,4);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}else t[2]=t[1],t[3]=t[0];t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3])}));var q,U,V,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=B.length;return ht&&(q=o-a<g&&t<m,U=Math.atan((o-a)/(l-u)),Z=(V=m)/g,K=l-m,Q=(J=m-(l-u))/(g-(o-a)),et=te((tt=Re(B[ht-1][3],B[ht-1][2],F,K,Z,V,!0,Math.tan(U)*V))[tt.length-1],2),ot=et[0],st=et[1],q&&(it=te((rt=Re(B[ht-1][0],B[ht-1][1],F,K,Q,J,!0,Math.tan(U)*J))[rt.length-1],2),nt=it[0],at=it[1]),B.forEach(function(t,e){var r,i;e===ht-1?(r=tt,q&&(i=rt)):(r=Re(t[3],t[2],F,K,Z,V),q&&(i=Re(t[0],t[1],F,K,Q,J)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],ot,st,5);if(q){for(var o=0,s=i.length;o<s;o++)Ne(i[o],nt,at,5);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}else t[2]=t[1],t[3]=t[0];t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3])})),W.concat(D).concat(B)}function Te(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(-y+r)*n,M=(-b+r)*n,w=Math.atan(M/(x-i)),S=r-Math.sin(w)*a/n,A=i+Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r-Math.cos(f)*a/n,i+Math.sin(f)*a):(_=Math.atan(k/(g-i)),d=r-Math.sin(_)*a/n,i+Math.cos(_)*a),_===w)return[[d,p]];var E=ie.h(Math.abs(_-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=_-T,C=w+T;return[[d,p],[r-Math.sin(R)*P/n,i+Math.cos(R)*P],[r-Math.sin(C)*P/n,i+Math.cos(C)*P],[S,A]]}function Re(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(k/(g-i)),S=r+Math.sin(w)*a/n,A=i+Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r+Math.cos(f)*a/n,i+Math.sin(f)*a):(_=Math.atan(M/(x-i)),d=r+Math.sin(_)*a/n,i+Math.cos(_)*a),w===_)return[[S,A]];var E=ie.h(Math.abs(w-_))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w+T,C=_-T;return[[S,A],[r+Math.sin(R)*P/n,i+Math.cos(R)*P],[r+Math.sin(C)*P/n,i+Math.cos(C)*P],[d,p]]}function Ce(t,e,r,i,n,a,o,s,h,u,l,c,f,_){var d=te(f,2),p=d[0],v=d[1],y=te(_,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,S,A,E,P,T,R,C,O,L,N,I=h+v-(h-s),F=u-m+(l-u),W=[],D=[],B=[],H=0,z=c.length;H<z;H++){var G,Y,X,$,j=c[H];j[3][1]<I?W.push(j):j[0][1]>F?B.push(j):j[3][1]>F&&j[0][1]<I?(G=I<h?n-Math.tan(r)*(h-I):n,Y=u<F?n-Math.tan(e)*(F-u):n,W.push([j[0],j[1],[G,I],[i,I]]),I<F&&(F<u&&h<I?D.push([[i,I],[n,I],[n,F],[i,F]]):h<I?(D.push([[i,I],[n,I],[n,u],[i,u]]),D.push([[i,u],[n,u],[Y,F],[i,F]])):F<u?(D.push([[i,I],[G,I],[n,h],[i,h]]),D.push([[i,h],[n,h],[n,F],[i,F]])):(D.push([[i,I],[G,I],[n,h],[i,h]]),D.push([[i,h],[n,h],[n,u],[i,u]]),D.push([[i,u],[n,u],[Y,F],[i,F]]))),B.push([[i,F],[Y,F],j[2],j[3]])):j[3][1]>F?(X=u<F?n-Math.tan(e)*(F-u):n,D.push([j[0],j[1],[X,F],[i,F]]),B.push([[i,F],[X,F],j[2],j[3]])):j[1][1]<I?($=I<h?n-Math.tan(r)*(h-I):n,W.push([j[0],j[1],[$,I],[i,I]]),D.push([[i,I],[$,I],j[2],j[3]])):D.push(j)}W.length&&(b=h-s<v&&t<p,x=Math.atan((n-i)/(h-s)),M=(k=v)/p,w=i+p,A=(S=v-(h-s))/(p-(n-i)),P=te((E=Oe(W[0][0],W[0][3],w,I,M,k,!0,Math.tan(x)*k))[E.length-1],2),L=P[0],N=P[1],b&&(R=te((T=Oe(W[0][1],W[0][2],w,I,A,S,!0,Math.tan(x)*S))[T.length-1],2),C=R[0],O=R[1]),W.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=T)):(r=Oe(t[0],t[3],w,I,M,k),b&&(i=Oe(t[1],t[2],w,I,A,S)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],L,N,6);if(b){for(var o=0,s=i.length;o<s;o++)Ne(i[o],C,O,6);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[3]=t[1];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}));var q,U,V,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=B.length;return ht&&(q=l-u<m&&t<g,U=Math.atan((n-i)/(l-u)),Z=(V=m)/g,K=i+g,Q=(J=m-(l-u))/(g-(n-i)),et=te((tt=Le(B[ht-1][0],B[ht-1][3],K,F,Z,V,!0,Math.tan(U)*V))[0],2),ot=et[0],st=et[1],q&&(it=te((rt=Le(B[ht-1][1],B[ht-1][2],K,F,Q,J,!0,Math.tan(U)*J))[0],2),nt=it[0],at=it[1]),B.forEach(function(t,e){var r,i;e===ht-1?(r=tt,q&&(i=rt)):(r=Le(t[0],t[3],K,F,Z,V),q&&(i=Le(t[1],t[2],K,F,Q,J)));for(var n=0,a=r.length;n<a;n++)Ne(r[n],ot,st,7);if(q){for(var o=0,s=i.length;o<s;o++)Ne(i[o],nt,at,7);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[3]=t[1];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])})),W.concat(D).concat(B)}function Oe(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(r-y)*n,M=(r-b)*n,w=Math.atan(M/(i-x)),S=r-Math.sin(w)*a/n,A=i-Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r-Math.cos(f)*a/n,i-Math.sin(f)*a):(_=Math.atan(k/(i-g)),d=r-Math.sin(_)*a/n,i-Math.cos(_)*a),_===w)return[[d,p]];var E=ie.h(Math.abs(_-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=_+T,C=r-Math.sin(R)*P/n,O=i-Math.cos(R)*P,L=w-T;return[[S,A],[r-Math.sin(L)*P/n,i-Math.cos(L)*P],[C,O],[d,p]]}function Le(t,e,r,i,n,a,o,s){var h,u,l,c,f,_,d,p,v=te(t,2),y=v[0],g=v[1],m=te(e,2),b=m[0],x=m[1],k=(r-y)*n,M=(r-b)*n,w=Math.atan(k/(g-i)),S=r-Math.sin(w)*a/n,A=i+Math.cos(w)*a;if(p=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),_=.5*Math.PI-f,d=r-Math.cos(f)*a/n,i+Math.sin(f)*a):(_=Math.atan(M/(x-i)),d=r-Math.sin(_)*a/n,i+Math.cos(_)*a),w===_)return[[S,A]];var E=ie.h(Math.abs(w-_))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w-T,C=r-Math.sin(R)*P/n,O=i+Math.cos(R)*P,L=_+T;return[[d,p],[r-Math.sin(L)*P/n,i+Math.cos(L)*P],[C,O],[S,A]]}function Ne(t,e,r,i){0===i?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],r)):1===i?(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r)):2===i?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],r)):3===i?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],r)):4===i?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],r)):5===i||6===i?(t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],r)):7===i&&(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r))}var Ie={calPoints:function(t,e,r,i,n,a,o,s,h,u,l,c,f,_,d){var p=[];if(-1<["dashed","dotted"].indexOf(e)){var v=0===f||2===f?xe(e,n,a,o,s,t):xe(e,h,u,l,c,t),y=v.n,g=v.ps,m=v.pd;if(1<y){for(var b=0;b<y;b++){var x=b===y-1,k=void 0,M=void 0,w=void 0,S=(k=0===f||2===f?b?n+g*b+m*b:n:b?h+g*b+m*b:h)+g;0===f?S<=a?x?p.push([[n,h],[s,h],[o,u],[a,u]]):(M=h+(k-n)*Math.tan(r),w=h+(S-n)*Math.tan(r),p.push([[k,h],[S,h],[S,w],[k,M]])):o<=k?(M=h+(s-k)*Math.tan(i),w=h+(s-S)*Math.tan(i),x?p.push([[k,h],[s,h],[s,h],[k,M]]):p.push([[k,h],[S,h],[S,w],[k,M]])):k<a?(M=h+(k-n)*Math.tan(r),p.push([[k,h],[a,h],[a,u],[k,M]]),x?(p.push([[a,h],[o,h],[o,u],[a,u]]),p.push([[o,h],[s,h],[s,h],[a,u]])):o<S?(w=h+(s-S)*Math.tan(i),p.push([[a,h],[o,h],[o,u],[a,u]]),p.push([[o,h],[S,h],[S,w],[o,u]])):p.push([[a,h],[S,h],[S,u],[a,u]])):o<S?(M=h+(s-S)*Math.tan(i),k<a?(w=h+(k-n)*Math.tan(r),p.push([[k,h],[a,h],[a,u],[k,w]]),p.push([[a,h],[o,h],[o,u],[a,u]])):p.push([[k,h],[o,h],[o,u],[k,u]]),x?p.push([[o,h],[s,h],[s,h],[o,u]]):p.push([[o,h],[S,h],[S,M],[o,u]])):x?p.push([[k,h],[s,h],[o,u],[k,u]]):p.push([[k,h],[S,h],[S,u],[k,u]]):1===f?S<=u?x?p.push([[o,u],[s,h],[s,c],[o,l]]):(M=s-(k-h)*Math.tan(r),w=s-(S-h)*Math.tan(r),p.push([[M,k],[s,k],[s,S],[w,S]])):l<=k?(M=o+(k-l)*Math.tan(i),w=o+(S-l)*Math.tan(i),x?p.push([[M,k],[s,k],[s,c],[s,c]]):p.push([[M,k],[s,k],[s,S],[w,S]])):k<u?(M=o+(u-k)*Math.tan(r),p.push([[M,k],[s,k],[s,u],[o,u]]),x?(p.push([[o,u],[s,u],[s,l],[o,l]]),p.push([[o,l],[s,l],[s,c],[s,c]])):l<S?(w=o+(S-l)*Math.tan(i),p.push([[o,u],[s,u],[s,l],[o,l]]),p.push([[o,l],[s,l],[s,S],[w,S]])):p.push([[o,u],[s,u],[s,S],[o,S]])):l<S?(M=o+(S-l)*Math.tan(i),k<u?(w=o+(u-k)*Math.tan(r),p.push([[w,k],[s,k],[s,u],[o,u]]),p.push([[o,u],[s,u],[s,l],[o,l]]),x?p.push([[o,l],[s,l],[s,s],[s,s]]):p.push([[o,l],[s,l],[s,S],[M,S]])):(p.push([[o,k],[s,k],[s,l],[o,l]]),x?p.push([[o,l],[s,l],[s,c],[s,c]]):p.push([[o,l],[s,l],[s,S],[M,S]]))):x?p.push([[o,k],[s,k],[s,c],[o,l]]):p.push([[o,k],[s,k],[s,S],[o,S]]):2===f?S<=a?x?p.push([[n,c],[a,l],[o,l],[s,c]]):(M=c-(k-n)*Math.tan(r),w=c-(S-n)*Math.tan(r),p.push([[k,M],[S,w],[S,c],[k,c]])):o<=k?(M=c-(s-k)*Math.tan(i),w=c-(s-S)*Math.tan(i),x?p.push([[k,M],[s,c],[s,c],[k,c]]):p.push([[k,M],[S,w],[S,c],[k,c]])):k<a?(M=c-(k-n)*Math.tan(r),p.push([[k,M],[a,l],[a,c],[k,c]]),x?(p.push([[a,l],[o,l],[o,c],[a,c]]),p.push([[o,l],[s,c],[s,c],[o,c]])):o<S?(w=c-(S-o)*Math.tan(i),p.push([[a,l],[o,l],[o,c],[a,c]]),p.push([[o,l],[S,w],[S,c],[o,c]])):p.push([[a,l],[S,l],[S,c],[a,c]])):o<S?(M=c-(s-S)*Math.tan(i),k<a?(w=c-(k-o)*Math.tan(r),p.push([[k,w],[a,l],[a,c],[k,c]]),p.push([[a,l],[o,l],[o,c],[a,c]])):p.push([[k,l],[o,l],[o,c],[k,c]]),x?p.push([[o,l],[s,c],[s,c],[o,c]]):p.push([[o,l],[S,M],[S,c],[o,c]])):x?p.push([[k,l],[o,l],[s,c],[k,c]]):p.push([[k,l],[S,l],[S,c],[k,c]]):3===f&&(S<=u?x?p.push([[n,h],[a,u],[a,l],[n,c]]):(M=n+(k-h)*Math.tan(r),w=n+(S-h)*Math.tan(r),p.push([[n,k],[M,k],[w,S],[n,S]])):l<=k?(M=n+(c-k)*Math.tan(i),w=n+(c-S)*Math.tan(i),x?p.push([[n,k],[M,k],[n,c],[n,c]]):p.push([[n,k],[M,k],[w,S],[n,S]])):k<u?(M=n+(k-h)*Math.tan(r),p.push([[n,k],[M,k],[a,u],[n,u]]),x?(p.push([[n,u],[a,u],[a,l],[n,l]]),p.push([[n,l],[a,l],[n,c],[n,c]])):l<S?(w=n+(c-S)*Math.tan(i),p.push([[n,u],[a,u],[a,l],[n,l]]),p.push([[n,l],[a,l],[w,S],[n,S]])):p.push([[n,u],[a,u],[a,S],[n,S]])):l<S?(M=n+(c-S)*Math.tan(i),k<u?(w=n+(k-h)*Math.tan(r),p.push([[n,k],[w,k],[a,u],[n,h]]),p.push([[n,u],[a,u],[a,l],[n,l]])):p.push([[n,k],[a,k],[a,l],[n,l]]),x?p.push([[n,l],[a,l],[n,c],[n,c]]):p.push([[n,l],[a,l],[M,S],[n,S]])):x?p.push([[n,k],[a,k],[a,l],[n,c]]):p.push([[n,k],[a,k],[a,S],[n,S]]))}if(0===f)return ke(t,r,i,n,a,o,s,h,u,0,0,p,_,d);if(1===f)return Se(t,r,i,0,0,o,s,h,u,l,c,p,_,d);if(2===f)return Pe(t,r,i,n,a,o,s,0,u,l,c,p,_,d);if(3===f)return Ce(t,r,i,n,a,0,0,h,u,l,c,p,_,d)}}return 0===f?(n<a&&p.push([[n,h],[a,h],[a,u],[n,h]]),p.push([[a,h],[o,h],[o,u],[a,u]]),o<s&&p.push([[o,h],[s,h],[s,h],[o,u]]),ke(t,r,i,n,a,o,s,h,u,0,0,p,_,d)):1===f?(h<u&&p.push([[s,h],[s,h],[s,u],[o,u]]),p.push([[o,u],[s,u],[s,l],[o,l]]),l<c&&p.push([[o,l],[s,l],[s,c],[s,c]]),Se(t,r,i,0,0,o,s,h,u,l,c,p,_,d)):2===f?(n<a&&p.push([[n,c],[a,l],[a,c],[n,c]]),p.push([[a,l],[o,l],[o,c],[a,c]]),o<s&&p.push([[o,l],[s,c],[s,c],[o,c]]),Pe(t,r,i,n,a,o,s,0,u,l,c,p,_,d)):3===f?(h<u&&p.push([[n,h],[n,h],[a,u],[n,u]]),p.push([[n,u],[a,u],[a,l],[n,l]]),l<c&&p.push([[n,l],[a,l],[n,c],[n,c]]),Ce(t,r,i,n,a,0,0,h,u,l,c,p,_,d)):void 0},calRadius:function(t,e,r,i,n,a,o,s,h,u,l,c){var f,_=te(h,2),d=_[0],p=_[1],v=te(u,2),y=v[0],g=v[1],m=te(l,2),b=m[0],x=m[1],k=te(c,2),M=k[0],w=k[1];if(p-=n,y-=a,g-=n,b-=a,x-=o,M-=s,w-=o,(0<(d-=s)&&0<p||0<y&&0<g||0<b&&0<x||0<M&&0<w)&&(f=!0),f){var S=[];return 0<d&&0<p?(S.push([t,e+p]),S.push([t,e+p*(1-me),t+d*(1-me),e,t+d,e])):S.push([t,e]),0<y&&0<g?(S.push([t+r-y,e]),S.push([t+r-y*(1-me),e,t+r,e+g*(1-me),t+r,e+g])):S.push([t+r,e]),0<b&&0<x?(S.push([t+r,e+i-x]),S.push([t+r,e+i-x*(1-me),t+r-b*(1-me),e+i,t+r-b,e+i])):S.push([t+r,e+i]),0<M&&0<w?(S.push([t+M,e+i]),S.push([t+M*(1-me),e+i,t,e+i-w*(1-me),t,e+i-w])):S.push([t,e+i]),S}}},Fe=j.PERCENT,We=j.NUMBER;var De={matrixResize:function(t,e,r,i,n,a,o,s){if(t!==r||e!==i){var h=[["scaleX",{value:r/t,unit:We}],["scaleY",{value:i/e,unit:We}]],u=ge.calOrigin([{value:0,unit:Fe},{value:0,unit:Fe}],o,s);return u[0]+=n,u[1]+=a,ge.calMatrixWithOrigin(h,u,o,s)}}},Be="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nvarying vec2 vTextureCoord;\nuniform mat3 projectionMatrix;\n\nvoid main(void)\n{\n  gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n  vTextureCoord = aTextureCoord;\n}",He="\n#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 color = vec4(0.0);\n\n  // Sample top left pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample top right pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample bottom right pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample bottom left pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Average\n  color *= 0.25;\n\n  gl_FragColor = color;\n}";function ze(t,e,r){var i=function(t,e,r){var i=Ge(t,t.VERTEX_SHADER,e),n=Ge(t,t.FRAGMENT_SHADER,r);if(!i||!n)return null;var a=t.createProgram();if(!a)return null;if(t.attachShader(a,i),t.attachShader(a,n),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS))return a;var o=t.getProgramInfoLog(a);return console.error("Failed to link program: "+o),t.deleteProgram(a),t.deleteShader(n),t.deleteShader(i),null}(t,e,r);if(i)return t.useProgram(i),t.program=i,1;console.error("Failed to create program")}function Ge(t,e,r){var i=t.createShader(e);if(null==i)return console.error("unable to create shader"),null;if(t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;var n=t.getShaderInfoLog(i);return console.error("Failed to compile shader: "+n),t.deleteShader(i),null}function Ye(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),e}var Xe=function(){function a(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;u(this,a),this.webgl=t;var i,n=this.gl=t.ctx;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,-1),ze(n,Be,He),this.vertexLocations=function(t){var e=new Float32Array([-1,1,0,1,-1,-1,0,0,1,1,1,1,1,-1,1,0]),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);var i=Float32Array.BYTES_PER_ELEMENT,n=t.getAttribLocation(t.program,"aVertexPosition");t.vertexAttribPointer(n,2,t.FLOAT,!1,4*i,0),t.enableVertexAttribArray(n);var a=t.getAttribLocation(t.program,"aTextureCoord");t.vertexAttribPointer(a,2,t.FLOAT,!1,4*i,2*i);var o=t.getUniformLocation(t.program,"projectionMatrix");return t.uniformMatrix3fv(o,!1,new Float32Array([1,0,0,0,1,0,0,0,1])),t.enableVertexAttribArray(a),{aPosition:n,aTexCoord:a}}(n),this.textureLocations={uSampler:(i=n).getUniformLocation(i.program,"uSampler"),uOffset:i.getUniformLocation(i.program,"uOffset"),uClamp:i.getUniformLocation(i.program,"filterClamp")},this._pixelSize={x:0,y:0},this.pixelSize=1,this._kernels=null,this._blur=e,this.quality=r,this.textures=[],this.framebuffers=[]}return l(a,[{key:"initBuffers",value:function(t,e,r){for(var i=0;i<2;i++){var n=Ye(t);this.textures.push(n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null);var a=t.createFramebuffer();this.framebuffers.push(a),t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}}},{key:"draw",value:function(t,e,r){var i=this.textureLocations,n=i.uOffset,a=i.uClamp,o=this.gl;o.uniform2f(n,e[0],e[1]),o.viewport(0,0,t.width,t.height),o.uniform4f(a,0,0,t.width,t.height),r&&o.bindFramebuffer(o.FRAMEBUFFER,null),o.drawArrays(o.TRIANGLE_STRIP,0,4)}},{key:"apply",value:function(t,e,r){var i=this.gl;this.initBuffers(i,e,r);var n=this.textureLocations.uSampler;i.uniform1i(n,0);var a=Ye(i);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.canvas);var o,s=this._pixelSize.x/e,h=this._pixelSize.y/r,u=this._quality-1;i.bindTexture(i.TEXTURE_2D,a);for(var l=0;l<u;l++){o=this._kernels[l]+.5,i.bindFramebuffer(i.FRAMEBUFFER,this.framebuffers[l%2]);var c=new Float32Array([o*s,o*h]);this.draw(t.canvas,c,!1),i.bindTexture(i.TEXTURE_2D,this.textures[l%2])}o=this._kernels[u]+.5;var f=new Float32Array([o*s,o*h]);return this.draw(t.canvas,f,!0),this.webgl.draw(),t.ctx.clearRect(0,0,e,r),t.ctx.drawImage(i.canvas,0,0),t.draw(),this}},{key:"_generateKernels",value:function(){var t=this._blur,e=this._quality,r=[t];if(0<t)for(var i=t,n=t/e,a=1;a<e;a++)i-=n,r.push(i);this._kernels=r}},{key:"clear",value:function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}},{key:"kernels",get:function(){return this._kernels},set:function(t){Array.isArray(t)&&0<t.length?(this._kernels=t,this._quality=t.length,this._blur=Math.max.apply(Math,t)):(this._kernels=[0],this._quality=1)}},{key:"pixelSize",set:function(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):(this._pixelSize.x=1,this._pixelSize.y=1)},get:function(){return this._pixelSize}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this._generateKernels()}}]),a}();var $e={gaussBlur:function(t,e,r,i,n){return new Xe(e,r).apply(t,i,n)}},je={},qe={};function Ue(t,e,r,i){var n=t?i[t]?i[t]:i[t]=document.createElement("canvas"):document.createElement("canvas");return n.width=e,n.height=r,"undefined"!=typeof karas&&karas.debug&&(n.style.width=e+"px",n.style.height=r+"px",n.setAttribute("type",i===je?"canvas":"webgl"),t&&n.setAttribute("key",t),document.body.appendChild(n)),{canvas:n,ctx:i===je?n.getContext("2d"):n.getContext("webgl")||n.getContext("experimental-webgl"),draw:function(){},available:!0,release:function(){this.canvas=null,this.ctx=null}}}var Ve,Ze,Ke={},Je={measureText:function(t){var e=Xt.MEASURE_TEXT,r=e.list,u=e.data,l="",c=[],f=[];if(Object.keys(u).forEach(function(t){var e=u[t],r=e.key,i=e.style,n=e.s;if(n)for(var a="position:absolute;font-family:".concat(i.fontFamily,";font-size:").concat(i.fontSize,"px;font-weight:").concat(i.fontWeight),o=0,s=n.length;o<s;o++){c.push(r);var h=n.charAt(o);f.push(h),l+='<span style="'.concat(a,'">').concat(h.replace(/</,"&lt;").replace(" ","&nbsp;"),"</span>")}}),l){var i=document.createElement("div");i.style.position="absolute",i.style.left="99999px",i.style.top="-99999px",i.style.visibility="hidden",document.body.appendChild(i),i.innerHTML=l;for(var n=i.childNodes,a=Xt.CHAR_WIDTH_CACHE,o=Xt.MEASURE_TEXT,s=0,h=n.length;s<h;s++){var _=n[s],d=c[s],p=f[s],v=window.getComputedStyle(_,null);a[d][p]=parseFloat(v.width)}r.forEach(function(t){return t.__measureCb()}),t(),o.list=[],o.data={},document.body.removeChild(i)}else t()},IMG:Ke,INIT:0,LOADED:2,LOADING:1,measureImg:function(t,e){var r,i,n=Ke[t]=Ke[t]||{state:0,task:[]};2===n.state?e(n):1===n.state?n.task.push(e):(n.state=1,n.task.push(e),(r=new Image).onload=function(){n.state=2,n.success=!0,n.width=r.width,n.height=r.height,n.source=r,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},r.onerror=function(){n.state=2,n.success=!1,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},"data:"===t.substr(0,5)||(i=/^(?:\w+:)?\/\/([^/:]+)/.exec(t))&&location.hostname!==i[1]&&(r.crossOrigin="anonymous"),r.src=t)},warn:function(t){console.warn(t)},requestAnimationFrame:(Ze=function(t){var e;return"undefined"!=typeof requestAnimationFrame?(Je.requestAnimationFrame=requestAnimationFrame.bind(window),e=requestAnimationFrame(t)):(e=setTimeout(t,1e3/60),Je.requestAnimationFrame=function(t){return setTimeout(t,1e3/60)}),e},tr.toString=function(){return Ze.toString()},tr),cancelAnimationFrame:(Ve=function(t){var e;return"undefined"!=typeof cancelAnimationFrame?(Je.cancelAnimationFrame=cancelAnimationFrame.bind(window),e=cancelAnimationFrame(t)):(e=clearTimeout(t),Je.cancelAnimationFrame=function(t){return clearTimeout(t)}),e},Qe.toString=function(){return Ve.toString()},Qe),now:function(){return"undefined"!=typeof performance?(Je.now=function(){return Math.floor(performance.now())},Math.floor(performance.now())):(Je.now=Date.now.bind(Date),Date.now())},hasCacheCanvas:function(t){return t&&je.hasOwnProperty(t)},getCacheCanvas:function(t,e,r){return Ue(r,t,e,je)},delCacheCanvas:function(t){t&&delete je[t]},hasCacheWebgl:function(t){return t&&qe.hasOwnProperty(t)},getCacheWebgl:function(t,e,r){return Ue(r,t,e,qe)},delCacheWebgl:function(t){t&&delete qe[t]},isDom:function(t){if(t){if(re.isString(t))return!0;if("undefined"!=typeof window&&window.Element&&t instanceof window.Element)return!0;if(re.isFunction(t.getElementsByTagName))return!0}return!1}};function Qe(t){return Ve.apply(this,arguments)}function tr(t){return Ze.apply(this,arguments)}var er=re.isFunction,rr=function(){function o(){u(this,o),this.__eHash={}}return l(o,[{key:"on",value:function(t,e){if(e){var r=this;if(Array.isArray(t))for(var i=0,n=t.length;i<n;i++)r.on(t[i],e);else if(e){r.__eHash.hasOwnProperty(t)||(r.__eHash[t]=[]);for(var a=0,o=r.__eHash[t],s=o.length;a<s;a++)if(o[a]===e)return r;r.__eHash[t].push(e)}return r}}},{key:"once",value:function(i,n){if(er(n)){var a=this;if(o.__karasEventCb=n,Array.isArray(i))for(var t=0,e=i.length;t<e;t++)a.once(i[t],n);else n&&a.on(i,o);return this}function o(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.apply(a,e),a.off(i,o)}}},{key:"off",value:function(t,e){if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++)this.off(t[r],e);else if(this.__eHash.hasOwnProperty(t))if(e){for(var n=0,a=this.__eHash[t],o=a.length;n<o;n++)if(a[n]===e||a[n].__karasEventCb===e){a.splice(n,1);break}}else delete this.__eHash[t];return this}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];if(Array.isArray(t))for(var n=0,a=t.length;n<a;n++)this.emit(t[n],r);else if(this.__eHash.hasOwnProperty(t)){var o=this.__eHash[t];if(o.length)for(var s=0,h=(o=o.slice()).length;s<h;s++){var u=o[s];er(u)&&u.apply(this,r)}}return this}}],[{key:"mix",value:function(){for(var t=arguments.length-1;0<=t;t--){var e=t<0||arguments.length<=t?void 0:arguments[t],r=new o;e.__eHash={};for(var i=["on","once","off","emit"],n=i.length-1;0<=n;n--){var a=i[n];e[a]=r[a]}}}}]),o}();t(rr,"REFRESH","refresh"),t(rr,"PAUSE","pause"),t(rr,"PLAY","play"),t(rr,"FRAME","frame"),t(rr,"FINISH","finish"),t(rr,"CANCEL","cancel"),t(rr,"BEGIN","begin"),t(rr,"END","end");var ir,nr=re.isFunction;function ar(t,e,r){r?t.forEach(function(t){t.__after&&t.__after(e)}):t.forEach(function(t){t.__before&&t.__before(e)})}var or=new(function(){function t(){u(this,t),this.__hookTask=[],this.__task=[],this.__now=null}return l(t,[{key:"__init",value:function(){var n=this,a=n.task;Je.cancelAnimationFrame(n.id);var o=n.__now=Je.now();!function i(){Je.cancelAnimationFrame(n.id),n.id=Je.requestAnimationFrame(function(){var t,e,r;!ir&&a.length&&(e=(t=n.__now=Je.now())-o,e=Math.max(e,0),o=t,ar(r=a.slice(0),e),n.__hookTask.splice(0).forEach(function(t){return t()}),ar(r,e,!0),a.length&&i())})}()}},{key:"onFrame",value:function(t){var e;t&&((e=this.task).length||this.__init(),nr(t)&&(t={__after:t,__karasFramecb:t}),e.push(t))}},{key:"offFrame",value:function(t){if(t){for(var e=this.task,r=0,i=e.length;r<i;r++){var n=e[r];if(n===t||n.__karasFramecb===t){e.splice(r,1);break}}e.length||(Je.cancelAnimationFrame(this.id),this.__now=null)}}},{key:"nextFrame",value:function(e){var r,i=this;e&&((r=nr(e)?{__after:function(t){e(t),i.offFrame(r)}}:{__before:e.__before,__after:function(t){e.__after&&e.__after(t),i.offFrame(r)}}).__karasFramecb=e,this.onFrame(r))}},{key:"pause",value:function(){ir=!0}},{key:"resume",value:function(){ir&&(this.__init(),ir=!1)}},{key:"task",get:function(){return this.__task}}]),t}()),sr=4,hr=1e-7,ur=10,lr="function"==typeof Float32Array;function cr(t,e){return 1-3*e+3*t}function fr(t,e){return 3*e-6*t}function _r(t,e,r){return((cr(e,r)*t+fr(e,r))*t+3*e)*t}function dr(t,e,r){return 3*cr(e,r)*t*t+2*fr(e,r)*t+3*e}function pr(t){return t}function vr(a,e,o,r){if(!(0<=a&&a<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(a===e&&o===r)return pr;for(var s=new(lr?Float32Array:Array)(11),t=0;t<11;++t)s[t]=_r(.1*t,a,o);function i(t){for(var e=0,r=1;10!==r&&s[r]<=t;++r)e+=.1;var i=e+.1*((t-s[--r])/(s[r+1]-s[r])),n=dr(i,a,o);return.001<=n?function(t,e,r,i){for(var n=0;n<sr;++n){var a=dr(e,r,i);if(0===a)return e;e-=(_r(e,r,i)-t)/a}return e}(t,i,a,o):0===n?i:function(t,e,r,i,n){for(var a,o,s=0;0<(a=_r(o=e+(r-e)/2,i,n)-t)?r=o:e=o,Math.abs(a)>hr&&++s<ur;);return o}(t,e,e+.1,a,o)}return function(t){return 0===t||1===t?t:_r(i(t),e,r)}}var yr={linear:vr(1,1,0,0),easeIn:vr(.42,0,1,1),easeOut:vr(0,0,.58,1),ease:vr(.25,.1,.25,1),easeInOut:vr(.42,0,.58,1),cubicBezier:vr},gr=j.AUTO,mr=j.PX,br=j.PERCENT,xr=j.INHERIT,kr=j.RGBA,Mr=j.STRING,wr=j.NUMBER,Sr=re.isNil,Ar=re.isFunction,Er=re.isNumber,Pr=re.isObject,Tr=re.clone,Rr=re.equalArr,Cr=yr.linear,Or=gt.COLOR_HASH,Lr=gt.LENGTH_HASH,Nr=gt.RADIUS_HASH,Ir=gt.GRADIENT_HASH,Fr=gt.EXPAND_HASH,Wr=gt.GRADIENT_TYPE;function Dr(t,e,r,i){r.__addUpdate({node:i,style:t}),e.__style=t,e.__assigning=!0,r.__frameHook()}function Br(r,i,t,n){return t.forEach(function(t){var e=function(t,e,r,i){var n={k:r},a=t[r],o=e[r];if("transform"===r){if(!a&&!o)return;var s=a?a[0][1]:[1,0,0,1,0,0],h=o?o[0][1]:[1,0,0,1,0,0];if(Rr(s,h))return;return n.v=[h[0]-s[0],h[1]-s[1],h[2]-s[2],h[3]-s[3],h[4]-s[4],h[5]-s[5]],n}if("filter"===r)a&&a.length?o&&o.length?n.v=o[0][1]-a[0][1]:n.v=-a[0][1]:n.v=o[0][1];else if("transformOrigin"===r){n.v=[];for(var u=0;u<2;u++){var l,c,f=a[u],_=o[u];f.unit===_.unit?n.v.push(_.value-f.value):f.unit===mr&&_.unit===br?(l=.01*_.value*i[u?"outerHeight":"outerWidth"],n.v.push(l-f.value)):f.unit===br&&_.unit===mr&&(c=100*_.value/i[u?"outerHeight":"outerWidth"],n.v.push(c-f.value))}if(Rr(n.v,[0,0]))return}else if("backgroundPositionX"===r||"backgroundPositionY"===r){if(a.unit===o.unit&&-1<[mr,br].indexOf(a.unit)){var d=o.value-a.value;if(0==d)return;n.v=d}else if(a.unit===mr&&o.unit===br){var p=.01*o.value*i["backgroundPositionX"===r?"innerWidth":"innerHeight"];if(0==(p-=a.value))return;n.v=p}else if(a.unit===br&&o.unit===mr){var v=100*o.value/i["backgroundPositionX"===r?"innerWidth":"innerHeight"];if(0==(v-=a.value))return;n.v=v}}else if("boxShadow"===r){n.v=[];for(var y=0,g=Math.min(a.length,o.length);y<g;y++){for(var m=a[y],b=o[y],x=[],k=0;k<4;k++)x.push(b[k]-m[k]);for(var M=[],w=0;w<4;w++)M.push(b[4][w]-m[4][w]);x.push(M),n.v.push(x)}}else if(Fr.hasOwnProperty(r)){if(a.unit===o.unit){var S=o.value-a.value;if(0==S)return;n.v=S}else if(a.unit===mr&&o.unit===br){var A=.01*o.value*i[/\w+X$/.test(r)?"outerWidth":"outerHeight"];if(0==(A-=a.value))return;n.v=A}else if(a.unit===br&&o.unit===mr){var E=100*o.value/i[/\w+X$/.test(r)?"outerWidth":"outerHeight"];if(0==(E-=a.value))return;n.v=E}}else if("backgroundSize"===r){n.v=[];for(var P=0;P<2;P++){var T=a[P],R=o[P];if(T.unit===R.unit&&-1<[mr,br].indexOf(T.unit))n.v.push(R.value-T.value);else if(T.unit===mr&&R.unit===br){var C=.01*R.value*i[P?"innerWidth":"innerHeight"];n.v.push(C-T.value)}else{if(T.unit!==br||R.unit!==mr)return;var O=100*R.value/i[P?"innerWidth":"innerHeight"];n.v.push(O-T.value)}}if(Rr(n.v,[0,0]))return}else if(Ir.hasOwnProperty(r)){if(a.k!==o.k)return;if("linear"===a.k||"radial"===a.k){var L=a.v,N=o.v;if(Rr(L,N))return;n.v=[];for(var I,F=i.innerWidth,W=0,D=Math.min(L.length,N.length);W<D;W++){var B=L[W],H=N[W],z=[];z.push([H[0][0]-B[0][0],H[0][1]-B[0][1],H[0][2]-B[0][2],H[0][3]-B[0][3]]),I=Rr(z,[0,0,0,0]),B[1]&&H[1]?(B[1].unit===H[1].unit?z.push(H[1].value-B[1].value):B[1].unit===mr&&H[1].unit===br?z.push(H[1].value*F*.01-B[1].value):B[1].unit===br&&H[1].unit===mr&&z.push(100*H[1].value/F-B[1].value),I=I&&0===z[4]):(B[1]||H[1])&&(I=!1),n.v.push(z)}if("linear"===a.k){var G=o.d-a.d;if(I&&0==G)return;n.d=G}else{n.p=[];for(var Y=0;Y<2;Y++){var X,$,j=a.p[Y],q=o.p[Y];j.unit===q.unit?n.p.push(q.value-j.value):j.unit===mr&&q.unit===br?(X=.01*q.value*i[Y?"innerWidth":"innerHeight"],n.p.push(X-j.value)):j.unit===br&&q.unit===mr&&($=100*q.value/i[Y?"innerWidth":"innerHeight"],n.p.push($-j.value))}if(I&&Rr(n.p,[0,0]))return}}else{if(Rr(o,a))return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}}else if(Or.hasOwnProperty(r)){if(o=o.value,a=a.value,Rr(o,a)||0===o[3]&&0===a[3])return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}else if(Nr.hasOwnProperty(r)){if(o[0].value===a[0].value&&o[0].unit===a[0].unit&&o[1].value===a[1].value&&o[1].unit===a[1].unit)return;n.v=[];for(var U=0;U<2;U++)o[U].unit===a[U].unit?n.v.push(o[U].value-a[U].value):a[U].unit===mr&&o[U].unit===br?n.v.push(.01*o[U].value*i[U?"outerHeight":"outerWidth"]-a[U].value):a[U].unit===br&&o[U].unit===mr?n.v.push(100*o[U].value/i[U?"outerHeight":"outerWidth"]-a[U].value):n.v.push(0)}else if(Lr.hasOwnProperty(r)){if(a.unit===gr||o.unit===gr)return;var V,Z,K=i.computedStyle,J=(i.parent||i).computedStyle,Q=0;if(a.unit===o.unit?Q=o.value-a.value:a.unit===mr&&o.unit===br?("fontSize"===r?V=o.value*J[r]*.01:"flexBasis"===r&&"row"===K.flexDirection||"width"===r||/margin/.test(r)||/padding/.test(r)||-1<["left","right"].indexOf(r)?V=o.value*J.width*.01:("flexBasis"===r||"height"===r||-1<["top","bottom"].indexOf(r))&&(V=o.value*J.height*.01),Q=V-a.value):a.unit===br&&o.unit===mr?("fontSize"===r?Z=100*o.value/J[r]:"flexBasis"===r&&"row"===K.flexDirection||"width"===r||/margin/.test(r)||/padding/.test(r)||-1<["left","right"].indexOf(r)?Z=100*o.value/J.width:("flexBasis"===r||"height"===r||-1<["top","bottom"].indexOf(r))&&(Z=100*o.value/J.height),Q=Z-a.value):"lineHeight"===r&&(a.unit===mr&&o.unit===wr?Q=o.value*K.fontSize-a.value:a.unit===wr&&o.unit===mr&&(Q=o.value/K.fontSize-a.value)),0===Q||isNaN(Q))return;n.v=Q}else if(Ot.GEOM.hasOwnProperty(r)){if(Sr(a))return;if(i.isMulti)if("points"===r||"controls"===r){if(Sr(o)||Sr(a)||Rr(a,o))return;n.v=[];for(var tt=0,et=Math.min(a.length,o.length);tt<et;tt++){var rt=a[tt],it=o[tt];if(Sr(rt)||Sr(it))n.v.push(null);else{for(var nt=[],at=0,ot=Math.min(rt.length,it.length);at<ot;at++){var st=rt[at],ht=it[at];if(Sr(st)||Sr(ht))nt.push(null);else{for(var ut=[],lt=0,ct=Math.max(st.length,ht.length);lt<ct;lt++){var ft=st[lt],_t=ht[lt];Sr(ft)||Sr(_t)?ut.push(0):ut.push(_t-ft)}nt.push(ut)}}n.v.push(nt)}}}else if("controlA"===r||"controlB"===r){if(Sr(o)||Sr(a)||Rr(a,o))return;n.v=[];for(var dt=0,pt=Math.min(a.length,o.length);dt<pt;dt++){var vt=a[dt],yt=o[dt];Sr(vt)||Sr(yt)?n.v.push(null):n.v.push([yt[0]-vt[0],yt[1]-vt[1]])}}else{if(o===a||Rr(o,a)||"edge"===r||"closure"===r)return;for(var gt=[],mt=0,bt=Math.min(a.length,o.length);mt<bt;mt++){var xt=a[mt],kt=o[mt];(Sr(xt)||Sr(kt))&&gt.push(0),gt.push(kt-xt)}n.v=gt}else if("points"===r||"controls"===r){if(Sr(o)||Sr(a)||Rr(a,o))return;n.v=[];for(var Mt=0,wt=Math.min(a.length,o.length);Mt<wt;Mt++){var St=a[Mt],At=o[Mt];if(Sr(St)||Sr(At))n.v.push(null);else{for(var Et=[],Pt=0,Tt=Math.max(St.length,At.length);Pt<Tt;Pt++){var Rt=St[Pt],Ct=At[Pt];Sr(Rt)||Sr(Ct)?Et.push(0):Et.push(Ct-Rt)}n.v.push(Et)}}}else if("controlA"===r||"controlB"===r){if(Sr(o)||Sr(a)||Rr(a,o))return;n.v=[o[0]-a[0],o[1]-a[1]]}else{if(o===a||"edge"===r||"closure"===r)return;n.v=o-a}}else{if("opacity"!==r&&"zIndex"!==r)return;if(o===a)return;n.v=o-a}return n}(r.style,i.style,t,n);e&&r.transition.push(e)}),i}function Hr(t,y,g){var e,r,i,n,a,m=Tr(t.style),o=((e=t.easing)&&(i=/^\s*(?:cubic-bezier\s*)?\(\s*[\d.]+\s*,\s*[-\d.]+\s*,\s*[\d.]+\s*,\s*[-\d.]+\s*\)\s*$/i.test(e)?(r=e.match(/[\d.]+/g),yr.cubicBezier(r[0],r[1],r[2],r[3])):(i=/^\s*steps\s*\(\s*(\d+)(?:\s*,\s*(\w+))?\s*\)/i.exec(e))?(n=parseInt(i[1]),a=i[2],function(t){if(n&&0<n){var e=1/n;return("start"===a?Math.ceil(t/e):Math.floor(t/e))/n}return t}):yr[e]),i);o&&o!==Cr&&(y=o(y));for(var s=t.transition,h=0,u=s.length;h<u;h++){var l=s[h],b=l.k,x=l.v,c=l.d,f=l.p,_=m[b];if("transform"===b){_=_||(m[b]=[["matrix",[1,0,0,1,0,0]]]);for(var d=0;d<6;d++)_[0][1][d]+=x[d]*y}else if("backgroundPositionX"===b||"backgroundPositionY"===b||Lr.hasOwnProperty(b)||Fr.hasOwnProperty(b))0!==x&&(_.value+=x*y);else if("filter"===b)(_=_||(m[b]=[["blur",0]]))[0][1]+=x*y;else if(Nr.hasOwnProperty(b))for(var p=0;p<2;p++)_[p].value+=x[p]*y;else if("transformOrigin"===b||"backgroundSize"===b)0!==x[0]&&(_[0].value+=x[0]*y),0!==x[1]&&(_[1].value+=x[1]*y);else if("boxShadow"===b)for(var v=0,k=Math.min(_.length,x.length);v<k;v++){for(var M=0;M<4;M++)_[v][M]+=x[v][M]*y;for(var w=0;w<4;w++)_[v][4][w]+=x[v][4][w]*y}else if(Ir.hasOwnProperty(b))if(Wr.hasOwnProperty(_.k)){for(var S=0,A=Math.min(_.v.length,x.length);S<A;S++){var E=_.v[S],P=x[S];E[0][0]+=P[0][0]*y,E[0][1]+=P[0][1]*y,E[0][2]+=P[0][2]*y,E[0][3]+=P[0][3]*y,E[1]&&P[1]&&(E[1].value+=P[1]*y)}"linear"===_.k&&void 0!==_.d&&void 0!==c&&(_.d+=c*y),"radial"===_.k&&void 0!==_.p&&void 0!==f&&(_.p[0].value+=f[0]*y,_.p[1].value+=f[1]*y)}else _[0]+=x[0]*y,_[1]+=x[1]*y,_[2]+=x[2]*y,_[3]+=x[3]*y;else Or.hasOwnProperty(b)?((_=_.value)[0]+=x[0]*y,_[1]+=x[1]*y,_[2]+=x[2]*y,_[3]+=x[3]*y):Ot.GEOM.hasOwnProperty(b)?function(){var s=m[b];if(g.isMulti)if("points"===b||"controls"===b)for(var t=0,e=Math.min(s.length,x.length);t<e;t++){var r=s[t],i=x[t];if(!Sr(r)&&!Sr(i))for(var n=0,a=Math.min(r.length,i.length);n<a;n++){var o=r[n],h=i[n];if(!Sr(o)&&!Sr(h))for(var u=0,l=Math.min(o.length,h.length);u<l;u++)Sr(o[u])||Sr(h[u])||(o[u]+=h[u]*y)}}else"controlA"===b||"controlB"===b?x.forEach(function(t,e){var r=s[e];if(!Sr(t)&&!Sr(r))for(var i=0,n=Math.min(r.length,t.length);i<n;i++){var a=r[i],o=t[i];Sr(a)||Sr(o)||(r[i]+=o*y)}}):x.forEach(function(t,e){Sr(t)||Sr(s[e])||(s[e]+=t*y)});else if("points"===b||"controls"===b)for(var c=0,f=Math.min(s.length,x.length);c<f;c++){var _=s[c],d=x[c];if(!Sr(_)&&!Sr(d))for(var p=0,v=Math.min(_.length,d.length);p<v;p++)Sr(_[p])||Sr(d[p])||(_[p]+=d[p]*y)}else"controlA"===b||"controlB"===b?(Sr(s[0])||Sr(x[0])||(s[0]+=x[0]*y),Sr(s[1])||Sr(x[1])||(s[1]+=x[1]*y)):Sr(s)||Sr(x)||(m[b]+=x*y)}():"opacity"!==b&&"zIndex"!==b||(m[b]+=x*y)}return m}function zr(t,e){return Ar(t)&&(e=t,t={}),[t||{},e]}var Gr=0,Yr=function(){e(s,rr);var o=f(s);function s(t,n,e){var r,a;u(this,s),(r=o.call(this)).__id=Gr++,r.__target=t,r.__root=t.root,n=Tr(n||[]),Array.isArray(n)?r.__list=n.filter(function(t){return t&&Pr(t)}):n&&Pr(n)?(a=[],Object.keys(n).forEach(function(t){var e=n[t];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){(a[r]=a[r]||{offset:r/(i-1)})[t]=e[r]}}),r.__list=a):r.__list=[],Er(e)&&(r.__options={duration:e},e=r.__options);var i=r.__options=e||{};return r.__playState="idle",r.__duration=Math.max(0,parseFloat(i.duration)||0),r.delay=i.delay,r.endDelay=i.endDelay,r.iterations=i.iterations,r.fps=i.fps,r.fill=i.fill,r.direction=i.direction,r.playbackRate=i.playbackRate,r.__easing=i.easing,r.__playCount=0,r.spfLimit=i.spfLimit,r.__frames=[],r.__framesR=[],r.__startTime=null,r.currentTime=0,r.__nextTime=0,r.__fpsTime=0,r.__isDestroyed=!1,r.__style={},r.__assigning=!1,r.__init(),r}return l(s,[{key:"__init",value:function(){var t=this.iterations,o=this.duration,i=this.list,s=this.easing,e=this.target;if(!(t<1||i.length<1)){for(var r,n=e.tagName,a=0,h=i.length;a<h;a++)(function(t,e){var r=i[t];if(r.hasOwnProperty("offset")){if(r.offset=parseFloat(r.offset)||0,r.offset=Math.max(0,r.offset),r.offset=Math.min(1,r.offset),isNaN(r.offset)||r.offset<0||1<r.offset)return i.splice(t,1),a=--t,h=--e;if(r.offset<=-1)return i.splice(t,1),a=--t,h=--e}Object.keys(r).forEach(function(t){st.hasOwnProperty(t)&&st.toFull(r,t)}),Object.keys(r).forEach(function(t){"easing"===t||"offset"===t||Ot.isValid(n,t)||delete r[t]}),a=t,h=e})(a,h);1===i.length?(i[0]=Tr(i[0]),1===i[0].offset?i.unshift({offset:0}):((r=Tr(i[0])).offset=1,i.push(r))):i.forEach(function(t,e){i[e]=Tr(t)});var u=i[0];u.hasOwnProperty("offset")&&0<u.offset?(u={offset:0},i.unshift(u)):u.offset=0;var l=i[i.length-1];l.hasOwnProperty("offset")&&l.offset<1?(l={offset:1},i.push(l)):l.offset=1;for(var c=1,f=i.length;c<f;c++){if(!(v=i[c]).hasOwnProperty("offset")){for(var _=void 0,d=c+1;d<f&&!(_=i[d]).hasOwnProperty("offset");d++);for(var p=d-c+1,v=i[c-1],y=(_.offset-v.offset)/p,g=c;g<d;g++){i[g].offset=v.offset+y*(g+1-c)}c=d}}var m=[];i.forEach(function(t){var e,r,i,n,a;m.push((r=o,i=s,n=(e=t).offset,a=e.easing,delete e.offset,delete e.easing,{style:e=Gt.normalize(e),time:n*r,easing:a||i,transition:[]}))}),this.__frames=m;var b,x,k,M,w,S,A,E,P=this.__keys=(x=e,k={},M=[],(b=m).forEach(function(t){var r=t.style;Object.keys(r).forEach(function(t){var e=r[t];Sr(e)||k.hasOwnProperty(t)||(k[t]=!0,M.push(t))})}),b.forEach(function(t){var e=t.style;M.forEach(function(t){e.hasOwnProperty(t)&&!Sr(e[t])||(Ot.GEOM.hasOwnProperty(t)?e[t]=x.currentProps[t]:e[t]=x.currentStyle[t])})}),M);w=m,S=P,E=(A=e).computedStyle,w.forEach(function(t){var a=t.style;S.forEach(function(t){var e,r,i,n=a[t];Sr(n)||("transform"===t?(e=A.outerWidth,r=A.outerHeight,i=ge.calMatrix(n,e,r),a[t]=[["matrix",i]]):n.unit===xr&&("color"===t?a[t]={value:re.rgba2int(E[t]),unit:kr}:Lr.hasOwnProperty(t)?a[t]={value:E[t],unit:mr}:"fontWeight"===t?a[t]={value:E[t],unit:wr}:"fontStyle"!==t&&"fontFamily"!==t&&"textAlign"!==t||(a[t]={value:E[t],unit:Mr})))})});var T=e.style,R=e.props,C=this.__originStyle={};P.forEach(function(t){Ot.isGeom(n,t)&&(C[t]=R[t]),C[t]=T[t]});for(var O=m.length,L=m[0],N=1;N<O;N++)L=Br(L,m[N],P,e);var I=Tr(m).reverse();I.forEach(function(t){t.time=o-t.time,t.transition=[]}),L=I[0];for(var F=1;F<O;F++){L=Br(L,I[F],P,e)}this.__framesR=I}}},{key:"__clean",value:function(t){var e;this.__cancelTask(),this.__nextTime=0;var r=this.style,i=this.duration,n=this.iterations,a=this.keys,o=this.target;t?(this.__currentTime=this.delay+i+this.endDelay,this.__playCount=n,this.__playState="finished",this.__stayEnd()||(this.__style={},e=!0)):(this.__playCount=this.__currentTime=0,this.__playState="idle",this.__style={},e=!0),e&&(this.__currentFrames=void 0,this.__currentFrame=void 0,a.forEach(function(t){Ot.GEOM.hasOwnProperty(t)?o.__currentProps[t]===r[t]&&(o.__currentProps[t]=o.props[t]):o.__currentStyle[t]===r[t]&&(o.__currentStyle[t]=o.style[t])}))}},{key:"__fin",value:function(t,e){this.__hasFin||(this.__hasFin=!0,this.__begin=this.__end=this.__isDelay=this.__finish=this.__inFps=this.__enterFrame=null,this.emit(rr.FINISH)),Ar(t)&&t.call(this,e)}},{key:"__frameCb",value:function(t,e){this.emit(rr.FRAME,t,e),this.__firstPlay&&(this.__firstPlay=!1,this.emit(rr.PLAY)),Ar(this.__playCb)&&(this.__playCb.call(this,t,e),this.__playCb=null)}},{key:"__calDiffTime",value:function(t){var e=this.playbackRate,r=this.spfLimit,i=this.fps,n=this.__currentTime=this.__nextTime;return r&&(!0===r?t=Math.min(t,1e3/i):0<r&&(t=Math.min(t,r))),1!==e&&0<e&&(t*=e),this.__nextTime+=t,n}},{key:"play",value:function(t){var d=this,e=this.isDestroyed,p=this.duration,r=this.playState,i=this.list;if(e||p<=0||i.length<1)return this;if("running"===r)return this;this.__cancelTask(),this.__playCb=t,this.__playState="running",this.__firstPlay=!0,this.__hasFin=!1;var v,n,a,y,g,m,b,x,k,o,s,M,w,S=!(this.__hasCancel=!1);return this.__enterFrame||(this.__enterFrame=!0,v=this.frames,n=this.framesR,a=this.direction,y=this.delay,g=this.endDelay,m=this.root,b=v.length,x=2===b,o={alternate:!0,"alternate-reverse":!0}.hasOwnProperty(a),s=this.__currentFrames={reverse:!0,"alternate-reverse":!0}.hasOwnProperty(a)?n:v,x&&(k=s[1].time),M=this.__stayEnd(),w=this.__stayBegin(),this.__currentTime=this.__nextTime=this.__fpsTime=0,this.__before=function(t){var e,r=d.target,i=d.fps,n=d.playCount,a=d.currentFrames,o=d.iterations,s=d.__calDiffTime(t);if(!S&&i<60){if((t=d.__fpsTime+=t)<1e3/i)return void(d.__inFps=!0);d.__fpsTime=0}if(S=!1,0<n)y=0;else if(s<y){return w&&Dr(v[0].style,d,m,r),0===s&&(d.__begin=!0),void(d.__isDelay=!0)}0===(s-=y)&&(d.__begin=!0);var h=a[e=x?s<k?0:1:function t(e,r,i,n){if(e===r)return n[e].time>i?e-1:e;var a=e+(r-e>>1),o=n[a];return o.time===i?a:o.time>i?t(e,Math.max(a-1,e),i,n):t(Math.min(a+1,r),r,i,n)}(0,b-1,s,a)].time,u=e===b-1,l=0;u||(l=x?s/p:(s-h)/(a[e+1].time-h));var c,f=o-1<=n,_=a[e];u?(c=s<p+g,_=M||!f?re.clone(_.style):re.clone(d.__originStyle),f?c||(d.__nextTime=0,o<=(n=++d.__playCount)&&or.offFrame(d)):(d.__nextTime=s-p,n=++d.__playCount,d.__nextBegin=!0)):_=Hr(_,l,r),Dr(_,d,m,r),!u||c&&!f||(d.__end=!0,o<=n&&(d.__finish=!0,d.__clean(!0)))},this.__after=function(t){var e;d.__assigning=!1,d.__inFps?d.__inFps=!1:(d.__frameCb(t,d.__isDelay),d.__isDelay=!1,d.__begin&&(d.__begin=!1,d.emit(rr.BEGIN,d.playCount)),d.__end&&(d.__end=!1,d.emit(rr.END,d.playCount-1),o&&(e=d.playCount%2==0,d.__currentFrames="alternate"===a?e?v:n:e?n:v)),d.__finish&&(d.__finish=!1,d.__fin()),d.__nextBegin&&(d.__nextBegin=!1,d.__begin=!0))}),or.offFrame(this),or.onFrame(this),this.__startTime=or.__now,this}},{key:"pause",value:function(t){var e=this.isDestroyed,r=this.duration,i=this.pending;return e||r<=0||i||(this.__playState="paused",this.__cancelTask(),t||this.emit(rr.PAUSE)),this}},{key:"resume",value:function(t){var e=this.isDestroyed,r=this.duration,i=this.playState;return e||r<=0||"paused"!==i?this:this.play(t)}},{key:"finish",value:function(e){var r=this,t=r.isDestroyed,i=r.duration,n=r.playState,a=r.list;if(t||i<=0||a.length<1||"finished"===n||"idle"===n)return r;r.__cancelTask();var o,s=r.root,h=r.frames,u=r.__originStyle;if(s){if(r.__hasFin)return r.__fin(e,0),r;o=r.__stayEnd()?h[h.length-1].style:u,s.addRefreshTask({__before:function(){Dr(o,r,s,r.target),r.__clean(!0)},__after:function(t){r.__assigning=!1,r.__frameCb(t),r.__fin(e,t)}})}return r}},{key:"cancel",value:function(r){var i=this,t=i.isDestroyed,e=i.duration,n=i.playState,a=i.list;if(t||e<=0||"idle"===n||a.length<1)return i;i.__cancelTask();var o=i.root,s=i.__originStyle;if(o){if(i.__hasCancel)return Ar(r)&&r.call(i,0),i;o.addRefreshTask({__before:function(){Dr(s,i,o,i.target),i.__clean()},__after:function(t){var e;i.__assigning=!1,i.__frameCb(t),e=t,i.__hasCancel||(i.__hasCancel=!0,i.__cancelTask(),i.__begin=i.__end=i.__isDelay=i.__finish=i.__inFps=i.__enterFrame=null,i.emit(rr.CANCEL)),Ar(r)&&r.call(i,e)}})}return i}},{key:"gotoAndPlay",value:function(t,e,r){var i=this.isDestroyed,n=this.duration,a=this.delay,o=this.endDelay;if(i||n<=0)return this;var s=te(zr(e,r),2);return e=s[0],r=s[1],this.__goto(t,e.isFrame,e.excludeDelay),n+a+o<t?this.finish(r):this.play(r)}},{key:"gotoAndStop",value:function(t,e,r){var i=this,n=this.isDestroyed,a=this.duration,o=this.delay,s=this.endDelay;if(n||a<=0)return this;var h=te(zr(e,r),2);return e=h[0],r=h[1],a+o+s<(t=this.__goto(t,e.isFrame,e.excludeDelay))?this.finish(r):this.play(function(t){i.__playState="paused",i.__cancelTask(),Ar(r)&&r.call(i,t)})}},{key:"assignCurrentStyle",value:function(){var r=this.style,i=this.target;this.keys.forEach(function(t){var e;r.hasOwnProperty(t)&&(e=r[t],Ot.GEOM.hasOwnProperty(t)?i.currentProps[t]=e:i.currentStyle[t]=e)})}},{key:"__goto",value:function(t,e,r){var i=this.duration,n=this.iterations,a=this.delay;if(this.__playState="paused",this.__cancelTask(),isNaN(t)||t<0)throw new Error("Param of gotoAnd(Play/Stop) is illegal: "+t);for(e&&(t=(t-1)/this.spf),r&&(t+=a);i<t&&this.playCount<n-1;)this.__playCount++,t-=i;return this.__nextTime=t}},{key:"addControl",value:function(){var t=this.root.animateController;t&&t.add(this)}},{key:"removeControl",value:function(){var t=this.root.animateController;t&&t.remove(this)}},{key:"__stayBegin",value:function(){return{backwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__stayEnd",value:function(){return{forwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__cancelTask",value:function(){or.offFrame(this),this.__playCb=null}},{key:"__destroy",value:function(t){var e=this;e.removeControl(),t?(e.__clean&&e.__clean(),e.__target=null):or.nextFrame({__before:function(){e.__clean&&e.__clean(),e.__target=null}}),e.__startTime=null,e.__isDestroyed=!0}},{key:"__checkModify",value:function(){"idle"!==this.playState&&"finished"!==this.playState&&console.warn("Modification will not come into effect when animation is running")}},{key:"id",get:function(){return this.__id}},{key:"target",get:function(){return this.__target}},{key:"root",get:function(){return this.__root}},{key:"keys",get:function(){return this.__keys}},{key:"style",get:function(){return this.__style}},{key:"list",get:function(){return this.__list}},{key:"options",get:function(){return this.__options}},{key:"duration",get:function(){return this.__duration},set:function(t){t=Math.max(0,parseFloat(t)||0),this.duration!==t&&(this.__duration=t,this.__checkModify())}},{key:"delay",get:function(){return this.__delay},set:function(t){t=Math.max(0,parseFloat(t)||0),this.delay!==t&&(this.__delay=t,this.__checkModify())}},{key:"endDelay",get:function(){return this.__endDelay},set:function(t){t=Math.max(0,parseFloat(t)||0),this.endDelay!==t&&(this.__endDelay=t,this.__checkModify())}},{key:"fps",get:function(){return this.__fps},set:function(t){t=parseInt(t)||60,this.fps!==t&&(t<=0&&(t=60),this.__fps=t)}},{key:"spf",get:function(){return 1/this.fps}},{key:"iterations",get:function(){return this.__iterations},set:function(t){t===1/0||re.isString(t)&&"infinity"===t.toLowerCase()?t=1/0:(t=parseInt(t),(isNaN(t)||t<0)&&(t=1)),this.__iterations!==t&&(this.__iterations=t)}},{key:"fill",get:function(){return this.__fill},set:function(t){t=t||"none",this.fill!==t&&(this.__fill=t,this.__checkModify())}},{key:"direction",get:function(){return this.__direction},set:function(t){t=t||"normal",this.direction!==t&&(this.__direction=t||"normal",this.__checkModify())}},{key:"frames",get:function(){return this.__frames}},{key:"framesR",get:function(){return this.__framesR}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(t){(t=parseFloat(t)||1)<=0&&(t=1),this.playbackRate!==t&&(this.__playbackRate=t)}},{key:"easing",get:function(){return this.__easing}},{key:"startTime",get:function(){return this.__startTime}},{key:"currentTime",get:function(){return this.__currentTime},set:function(t){t=Math.max(0,parseFloat(t)||0),this.__currentTime!==t&&(this.__currentTime=this.__nextTime=t)}},{key:"pending",get:function(){return"running"!==this.playState}},{key:"finished",get:function(){return"finished"===this.playState}},{key:"playState",get:function(){return this.__playState}},{key:"playCount",get:function(){return this.__playCount},set:function(t){t=Math.max(0,parseInt(t)||0),this.playCount!==t&&(this.__playCount=t)}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"animating",get:function(){var t=this.playState;return"idle"!==t&&("finished"!==t||this.__stayEnd())}},{key:"spfLimit",get:function(){return this.__spfLimit},set:function(t){t=re.isNumber(t)||/^\d/.test(t)?Math.max(0,parseInt(t)||0):!!t,this.spfLimit!==t&&(this.__spfLimit=t)}},{key:"assigning",get:function(){return this.__assigning}},{key:"currentFrames",get:function(){return this.__currentFrames}},{key:"currentFrame",get:function(){return this.__currentFrame}}]),s}(),Xr={NONE:0,TRANSLATE_X:1,TRANSLATE_Y:2,TRANSFORM:4,TRANSFORM_ALL:7,OPACITY:8,FILTER:16,REPAINT:32,REFLOW:64},$r={scaleX:!0,scaleY:!0,rotateZ:!0,transform:!0,transformOrigin:!0},jr=Object.assign({contain:function(t,e){return 0<(t&e)},getLevel:function(t){return Ot.isIgnore(t)?Xr.NONE:"translateX"===t?Xr.TRANSLATE_X:"translateY"===t?Xr.TRANSLATE_Y:$r.hasOwnProperty(t)?Xr.TRANSFORM:"opacity"===t?Xr.OPACITY:"filter"===t?Xr.FILTER:Ot.isRepaint(t)?Xr.REPAINT:Xr.REFLOW},isReflow:function(t){return!this.isRepaint(t)},isRepaint:function(t){return t<Xr.REFLOW}},Xr);jr.TRANSFORMS=$r;var qr=[8,16,32,64,128,256,512,1024,2048],Ur=[8,8,8,8,8,4,2,1,1],Vr=qr[qr.length-1],Zr={},Kr=function(){function c(t,e){u(this,c),this.__size=t,this.__number=e,this.__free=this.__total=e*e,t*=e;var r=this.__canvas=Je.getCacheCanvas(t,t);r&&(this.__offScreen=r),this.__grid=[];for(var i=0;i<this.__total;i++)this.__grid.push(1)}return l(c,[{key:"add",value:function(){for(var t=this.number,e=this.grid,r=0;r<t;r++)for(var i=0;i<t;i++){var n=r*t+i;if(e[n])return e[n]=0,this.__free--,n}throw new Error("Can not find free page")}},{key:"del",value:function(t){this.grid[t]=1,this.__free++}},{key:"getCoords",value:function(t){var e=this.size,r=this.number;return[t%r*e,Math.floor(t/r)*e]}},{key:"size",get:function(){return this.__size}},{key:"number",get:function(){return this.__number}},{key:"total",get:function(){return this.__total}},{key:"free",get:function(){return this.__free}},{key:"grid",get:function(){return this.__grid}},{key:"offScreen",get:function(){return this.__offScreen}},{key:"canvas",get:function(){return this.offScreen.canvas}},{key:"ctx",get:function(){return this.offScreen.ctx}}],[{key:"getInstance",value:function(t){if(!(Vr<t)){for(var e=qr[0],r=Ur[0],i=0,n=qr.length;i<n&&(e=qr[i],r=Ur[i],!(qr[i]>=t));i++);for(var a,o=Zr[e]=Zr[e]||[],s=0,h=o.length;s<h;s++){var u=o[s];if(u.free){a=u;break}}if(!a){if(!(a=new c(e,r)).offScreen)return void console.error("Can not create off-screen for page");o.push(a)}var l=a.add();return{page:a,pos:l}}}},{key:"CONFIG",set:function(t){t&&Array.isArray(t.SIZE)&&Array.isArray(t.NUMBER)&&(qr=t.SIZE,Ur=t.NUMBER,Vr=qr[qr.length-1])},get:function(){return{SIZE:qr,NUMBER:Ur}}},{key:"MAX",get:function(){return Vr}}]),c}(),Jr=function(){function p(t,e,r,i,n){u(this,p),this.__init(t,e,r,i,n)}return l(p,[{key:"__init",value:function(t,e,r,i,n){this.__width=t,this.__height=e,this.__bbox=r,this.__page=i,this.__pos=n;var a,o=te(i.getCoords(n),2),s=o[0],h=o[1];this.__coords=[s+1,h+1],i.canvas&&(this.__enabled=!0,(a=i.ctx).setTransform([1,0,0,1,0,0]),a.globalAlpha=1,"undefined"!=typeof karas&&karas.debug&&(i.canvas.setAttribute("size",i.size),a.fillStyle="rgba(0, 0, 0, 0.1)",a.beginPath(),a.rect(s+1,h+1,i.size-2,i.size-2),a.closePath(),a.fill()))}},{key:"__appendData",value:function(t,e){this.sx1=t,this.sy1=e;var r=te(this.coords,2),i=r[0],n=r[1],a=this.bbox;this.dx=i-a[0],this.dy=n-a[1],this.dbx=t-a[0],this.dby=e-a[1]}},{key:"clear",value:function(){var t,e,r,i,n=this.ctx;this.enabled&&n&&this.available&&(n.setTransform([1,0,0,1,0,0]),e=(t=te(this.coords,2))[0],r=t[1],i=this.page.size,n.clearRect(e-1,r-1,i,i)),this.__available=!1}},{key:"release",value:function(){this.enabled&&(this.clear(),this.page.del(this.pos),this.__page=null,this.__enabled=!1)}},{key:"reset",value:function(t){var e,r,i,n,a;re.equalArr(this.bbox,t)&&this.enabled?this.clear():(this.release(),e=Math.ceil(t[2]-t[0]),r=Math.ceil(t[3]-t[1]),e+=2,r+=2,(i=Kr.getInstance(Math.max(e,r)))?(n=i.page,a=i.pos,this.__init(e,r,t,n,a)):this.__enabled=!1)}},{key:"enabled",get:function(){return this.__enabled}},{key:"available",get:function(){return this.enabled&&this.__available}},{key:"bbox",get:function(){return this.__bbox}},{key:"page",get:function(){return this.__page}},{key:"canvas",get:function(){return this.page.canvas}},{key:"ctx",get:function(){return this.page.ctx}},{key:"size",get:function(){return this.page.size}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"pos",get:function(){return this.__pos}},{key:"coords",get:function(){return this.__coords}}],[{key:"getInstance",value:function(t){if(!(isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3]))){var e=Math.ceil(t[2]-t[0]),r=Math.ceil(t[3]-t[1]);e+=2,r+=2;var i=Kr.getInstance(Math.max(e,r));if(i)return new p(e,r,t,i.page,i.pos)}}},{key:"genMask",value:function(t){var e=t.size,r=t.sx1,i=t.sy1,n=t.width,a=t.height,o=Je.getCacheCanvas(n,a);return o.coords=[1,1],o.size=e,o.sx1=r,o.sy1=i,o.dbx=t.dbx,o.dby=t.dby,o.width=n,o.height=a,o}},{key:"genOffScreenBlur",value:function(t,e){var r=te(t.coords,2),i=r[0],n=r[1],a=t.size,o=t.canvas,s=t.sx1,h=t.sy1,u=t.width,l=t.height,c=Je.getCacheCanvas(u,l);c.ctx.drawImage(o,i-1,n-1,u,l,0,0,u,l),c.draw();var f=Je.getCacheWebgl(u,l);return $e.gaussBlur(c,f,e,u,l),f.coords=[1,1],f.size=a,f.sx1=s,f.sy1=h,f.dbx=t.dbx,f.dby=t.dby,f.width=u,f.height=l,f}},{key:"updateCache",value:function(t,e){var r=t.bbox;if(re.equalArr(e,r))return t;var i=r[0]-e[0],n=r[1]-e[1],a=p.getInstance(e);if(a&&a.enabled){var o=te(t.coords,2),s=o[0],h=o[1],u=t.canvas,l=t.width,c=t.height,f=te(a.coords,2),_=f[0],d=f[1];return a.sx1=t.sx1,a.sy1=t.sy1,a.dx=t.dx+i,a.dy=t.dy+n,a.dbx=t.dbx+i,a.dby=t.dby+n,a.ctx.drawImage(u,s-1,h-1,l,c,i+_-1,n+d-1,l,c),a.__available=!0,t.release(),a}}},{key:"drawCache",value:function(t,e,r,i,n,a){var o,s=te(e.coords,2),h=s[0],u=s[1],l=e.sx1,c=e.sy1,f=e.ctx,_=e.dbx,d=e.dby,p=te(t.coords,2),v=p[0],y=p[1],g=t.canvas,m=t.sx1,b=t.sy1,x=t.dbx,k=t.dby,M=t.width,w=t.height,S=h+m-l+_-x,A=u+b-c+d-k;r&&i&&n&&(n[0]+=S,n[1]+=A,o=ge.calMatrixByOrigin(r,n),i=ee.multiply(i,o),a&&(i=re.equalArr(i,a)?[1,0,0,1,0,0]:(a=ee.inverse(a),ee.multiply(i,a))),f.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])),f.drawImage(g,v-1,y-1,M,w,S-1,A-1,M,w)}},{key:"drawMask",value:function(t,e,r,i){for(var n=p.genMask(t),a=[];e&&e.isMask;)a.push(e),e=e.next;var o=te(n.coords,2),s=o[0],h=o[1],u=n.ctx,l=n.dbx,c=n.dby;i[0]+=s+l,i[1]+=h+c;var f=ge.calMatrixByOrigin(r,i);return a.forEach(function(t){var e=t.__cacheFilter,r=t.__cache,i=e&&e.available&&e;(i=i||r&&r.available&&r)?(u.globalAlpha=t.__opacity,p.drawCache(i,n,t.computedStyle.transform,[1,0,0,1,0,0],t.computedStyle.transformOrigin.slice(0),f)):console.error("CacheMask is oversize")}),u.setTransform(1,0,0,1,0,0),u.globalAlpha=1,u.globalCompositeOperation="source-in",p.drawCache(t,n),u.globalCompositeOperation="source-over",n.draw(u),n}},{key:"draw",value:function(t,e,r,i){t.globalAlpha=e,t.setTransform(r[0],r[1],r[2],r[3],r[4],r[5]);var n=te(i.coords,2),a=n[0],o=n[1],s=i.canvas,h=i.sx1,u=i.sy1,l=i.dbx,c=i.dby,f=i.width,_=i.height;t.drawImage(s,a-1,o-1,f,_,h-1-l,u-1-c,f,_)}},{key:"MAX",get:function(){return Kr.MAX-2}}]),p}();t(Jr,"NUM",5);var Qr=j.AUTO,ti=j.PX,ei=j.PERCENT,ri=j.STRING,ii=j.INHERIT,ni=re.clone,ai=re.int2rgba,oi=re.rgba2int,si=re.joinArr,hi=Gt.calRelative,ui=jt.canvasPolygon,li=jt.svgPolygon,ci=jr.TRANSFORM|jr.TRANSLATE_X|jr.TRANSLATE_Y;function fi(t,e,r,i,n,a,o){var s;t===Qt.CANVAS?(i.beginPath(),i.fillStyle!==r&&(i.fillStyle=r),e.forEach(function(t){ui(i,t,a,o)}),i.fill(),i.closePath()):t===Qt.SVG&&(s="",e.forEach(function(t){s+=li(t)}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",s],["fill",r]]}))}function _i(t,e,r,i,n,a,o,s,h,u,l,c,f,_,d,p,v){var y,g=16<arguments.length&&void 0!==v?v:"fill",m=Ie.calRadius(r,i,n,a,h,u,l,c,f,_,d,p);t===Qt.CANVAS?(o.beginPath(),o.fillStyle!==e&&(o.fillStyle=e),m?ui(o,m):o.rect(r,i,n,a),o[g](),o.closePath()):t===Qt.SVG&&(m?(y=li(m),s.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",y],["fill",e]]})):s.virtualDom.bb.push({type:"item",tagName:"rect",props:[["x",r],["y",i],["width",n],["height",a],["fill",e]]}))}var di=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"];function pi(t,e,r){return t.unit===ti?t.value:t.unit===ei?(e-r)*t.value*.01:0}var vi,yi,gi,mi,bi,xi=function(){e(S,M);var i=f(S);function S(t){var r,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,S),r=i.call(this),Array.isArray(e)?r.props=re.arr2hash(e):r.props=e,r.__tagName=t,r.__style=r.props.style||{},r.__currentStyle={},r.__computedStyle={},r.__listener={},r.__refreshLevel=jr.REFLOW,Object.keys(r.props).forEach(function(t){var e=r.props[t];/^on[a-zA-Z]/.test(t)&&(t=t.slice(2).toLowerCase(),r.listener[t]=e)}),r.__animationList=[],r.__loadBgi={cb:function(){}},r.__cacheStyle={},r}return l(S,[{key:"__mp",value:function(i,n,a){var o=this;["Top","Right","Bottom","Left"].forEach(function(t){var e="margin"+t,r="padding"+t;n[e]=o.__mpWidth(i[e],a),n[r]=o.__mpWidth(i[r],a)})}},{key:"__mpWidth",value:function(t,e){return t.unit===ti?t.value:t.unit===ei?t.value*e*.01:0}},{key:"__ioSize",value:function(t,e){var r=this.computedStyle;this.__innerWidth=t+=r.paddingLeft+r.paddingRight,this.__innerHeight=e+=r.paddingTop+r.paddingBottom,this.__outerWidth=t+r.marginLeft+r.borderLeftWidth+r.marginRight+r.borderRightWidth,this.__outerHeight=e+r.marginTop+r.borderTopWidth+r.marginBottom+r.borderBottomWidth}},{key:"__layout",value:function(t,e,r){Gt.computeReflow(this,this.isShadowRoot);var i,n,a,o,s,h,u,l,c,f=t.w,_=this.isDestroyed,d=this.currentStyle,p=this.computedStyle,v=d.display,y=d.width,g=d.position;if(this.__refreshLevel=jr.REFLOW,this.__cancelCache(),this.__layoutData=ni(t),this.__limitCache=!1,_||"none"===v)this.__width=this.__height=this.__innerWidth=this.__innerHeight=this.__outerWidth=this.__outerHeight=p.width=p.height=0;else{if(r||this.__mp(d,p,f),y.unit!==Qr)switch(y.unit){case ti:f=y.value;break;case ei:f*=.01*y.value}this.__ox=this.__oy=0,"flex"===v?this.__layoutFlex(t,e):"inline"===v?this.__layoutInline(t,e):this.__layoutBlock(t,e),"relative"===g?(i=d.top,n=d.right,a=d.bottom,o=d.left,s=this.parent,i.unit!==Qr?(h=hi(d,"top",i,s),this.__offsetY(h),p.top=h,p.bottom="auto"):a.unit!==Qr?(u=hi(d,"bottom",a,s),this.__offsetY(-u),p.bottom=u,p.top="auto"):p.top=p.bottom="auto",o.unit!==Qr?(l=hi(d,"left",o,s,!0),this.__offsetX(l),p.left=l,p.right="auto"):n.unit!==Qr?(c=hi(d,"right",n,s,!0),this.__offsetX(-c),p.right=c,p.left="auto"):p.left=p.right="auto"):"absolute"!==d.position&&(p.top=p.bottom=p.left=p.right="auto"),this.__sx=this.x+this.ox,this.__sy=this.y+this.oy;var m=p.width=this.width,b=p.height=this.height;e&&this.__ioSize(m,b);var x=this.next;if(!this.isMask&&x&&x.isMask){for(var k=0;x;)x.isMask&&k++,x=x.next;this.__hasMask=k}var M,w=this.__animateRecords;w&&(this.__animateRecords=null,w.list.forEach(function(t){t.target.vd instanceof S&&(t.target=t.target.vd)}),M=w.controller||this.root.animateController,w.options&&!1===w.options.autoPlay?M.__records=M.__records.concat(w.list):(M.__auto=M.__auto.concat(w.list),M.__playAuto()))}}},{key:"__preLayout",value:function(t){var e=t.x,r=t.y,i=t.w,n=t.h,a=t.w2,o=t.h2;this.__x=e,this.__y=r;var s,h,u=this.currentStyle,l=this.computedStyle,c=u.width,f=u.height,_=l.borderTopWidth,d=l.borderRightWidth,p=l.borderBottomWidth,v=l.borderLeftWidth,y=l.marginTop,g=l.marginRight,m=l.marginBottom,b=l.marginLeft,x=l.paddingTop,k=l.paddingRight,M=l.paddingBottom,w=l.paddingLeft;if(void 0!==a)s=!0,i=a;else if(c.unit!==Qr)switch(s=!0,c.unit){case ti:i=c.value;break;case ei:i*=.01*c.value}if(void 0!==o)h=!0,n=o;else if(f.unit!==Qr)switch(h=!0,f.unit){case ti:n=f.value;break;case ei:n*=.01*f.value}return e+=v+b+w,t.x=e,r+=_+y+x,t.y=r,c.unit===Qr&&(i-=v+d+b+g+w+k),f.unit===Qr&&(n-=_+p+y+m+x+M),{fixedWidth:s,fixedHeight:h,x:e,y:r,w:i,h:n}}},{key:"__marginAuto",value:function(t,e){var r,i=t.position,n=t.marginLeft,a=t.marginRight,o=t.width;"absolute"===i||o===Qr||n.unit!==Qr||a.unit!==Qr||(r=this.outerWidth)<e.w&&this.__offsetX(.5*(e.w-r),!0)}},{key:"__calMatrix",value:function(t,e,i,n,r,a,o,s){var h,u,l,c,f,_,d,p=e.matrix;return p&&t<jr.REFLOW&&!jr.contain(t,jr.TRANSFORM)?(c=u=0,jr.contain(t,jr.TRANSLATE_X)&&(h=i.translateX,u=(h=re.isNil(h)?0:h.unit===ei?h.value*this.outerWidth*.01:h.value)-(n.translateX||0),n.translateX=h,n.transform[4]+=u,p[4]+=u),jr.contain(t,jr.TRANSLATE_Y)&&(l=i.translateY,c=(l=re.isNil(l)?0:l.unit===ei?l.value*this.outerHeight*.01:l.value)-(n.translateY||0),n.translateY=l,n.transform[5]+=c,p[5]+=c),e.matrix=p):(void 0===r&&(r=this.sx,a=this.sy,o=this.outerWidth,s=this.outerHeight),void 0===e.transformOrigin&&(e.transformOrigin=!0,p=null,n.transformOrigin=ge.calOrigin(i.transformOrigin,o,s)),void 0!==e.transform&&void 0!==e.translateX&&void 0!==e.translateY&&void 0!==e.rotateZ&&void 0!==e.scaleX&&void 0!==e.scaleY&&void 0!==e.skewX&&void 0!==e.skewY||(e.transform=e.translateX=e.translateY=e.rotateZ=e.scaleX=e.scaleY=e.skewX=e.skewY=!0,p=null,i.transform?f=ge.calMatrix(i.transform,o,s):(_=[],["translateX","translateY","rotateZ","rotate","skewX","skewY","scaleX","scaleY"].forEach(function(t){delete n[t];var e,r=i[t];re.isNil(r)||(n[t]=r.value,e=-1<t.indexOf("scale"),1===r.value&&e||!e&&0===r.value||(r.unit===ei&&("translateX"===t?n[t]=r.value*o*.01:"translateY"===t&&(n[t]=r.value*s*.01)),_.push([t,r])))}),_.length&&(f=ge.calMatrix(_,o,s))),n.transform=f||[1,0,0,1,0,0]),p||((d=n.transformOrigin.slice(0))[0]+=r,d[1]+=a,p=e.matrix=ge.calMatrixByOrigin(n.transform,d))),p}},{key:"__calCache",value:function(t,e,r,i,n,f,a,_,o,s,h,u,l,c,d,p,v,y,g,m,b,x,k,M,w,S){var A,E,P,T,R,C,O,L,N,I,F,W,D,B,H,z,G,Y,X=this;this.__calMatrix(e,f,a,_,o,s,l,c),e>=jr.REPAINT?(void 0===f.backgroundPositionX&&(f.backgroundPositionX=!0,A=a.backgroundPositionX,_.backgroundPositionX=A.unit===ti?A.value:A.value+"%"),void 0===f.backgroundPositionY&&(f.backgroundPositionY=!0,E=a.backgroundPositionY,_.backgroundPositionY=E.unit===ti?E.value:E.value+"%"),void 0===f.backgroundSize&&(f.backgroundSize=!0,_.backgroundSize=(H=a.backgroundSize,z=h,G=u,Y=[],H.forEach(function(t,e){t.unit===ti?Y.push(t.value):t.unit===ei?Y.push(t.value*(e?G:z)*.01):t.unit===Qr?Y.push(-1):t.unit===ri&&Y.push("contain"===t.value?-2:-3)}),Y)),void 0===f.backgroundImage&&(P=_.backgroundImage=a.backgroundImage,re.isString(P)?(f.backgroundImage=!0,T=this.__loadBgi,(R=Je.IMG[P])&&R.state===Je.LOADED?(T.url=P,T.source=R.source,T.width=R.width,T.height=R.height):T.url!==P&&(T.url=P,T.source=null,Je.measureImg(P,function(t){var e,r;t.success&&t.url===T.url&&!X.__isDestroyed&&(T.source=t.source,T.width=t.width,T.height=t.height,(r=(e=X).root).delRefreshTask(T.cb),r.addRefreshTask(T.cb={__before:function(){f.backgroundImage=void 0,r.__addUpdate({node:e,focus:jr.REPAINT})}}))},{width:h,height:u}))):P&&P.k&&(f.backgroundImage=this.__gradient(t,r,i,m,M,b,w,h,u,P))),void 0===f.boxShadow&&(f.boxShadow=!0,_.boxShadow=a.boxShadow),["opacity","zIndex","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","backgroundRepeat","filter"].forEach(function(t){_[t]=a[t]}),["backgroundColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"].forEach(function(t){void 0===f[t]&&(f[t]=ai(_[t]=a[t].value))}),void 0!==f.borderTopLeftRadius&&void 0!==f.borderTopRightRadius&&void 0!==f.borderBottomRightRadius&&void 0!==f.borderBottomLeftRadius||(f.borderTopLeftRadius=f.borderTopRightRadius=f.borderBottomRightRadius=f.borderBottomLeftRadius=!0,I=l,F=c,W=a,D=_,B=!0,di.forEach(function(t){D[t]=W[t].map(function(t,e){return 0<t.value?(B=!1,t.unit===ti?Math.max(0,t.value):Math.max(0,t.value*(e?F:I)*.01)):0})}),B||di.forEach(function(t,e){var r,i=e%2==0?0:1,n=i?F:I,a=D[t],o=D[di[(e+1)%4]];a[i]+o[i]>n&&(r=.5*n,a[i]>=r&&o[i]>=r?a[i]=o[i]=r:a[i]>r?a[i]=n-o[i]:o[i]>r&&(o[i]=n-a[i]))}),["Top","Right","Bottom","Left"].forEach(function(t){f["border"+t]=void 0})),C=_.borderTopLeftRadius,O=_.borderTopRightRadius,L=_.borderBottomRightRadius,N=_.borderBottomLeftRadius,["Top","Right","Bottom","Left"].forEach(function(t){var e,r,i,n,a,o,s,h,u="border"+t,l=u+"Width",c=u+"Style";void 0===f[l]&&(f[l]=!0,f[u]=void 0),void 0===f[c]&&(f[c]=!0,f[u]=void 0),void 0===f[u]&&("Top"===t?0<d?(e=Math.atan(d/y),r=Math.atan(d/p),f[u]=Ie.calPoints(d,_[c],e,r,g,m,b,x,k,M,w,S,0,C,O)):f[u]=[]:"Right"===t?0<p?(i=Math.atan(p/d),n=Math.atan(p/v),f[u]=Ie.calPoints(p,_[c],i,n,g,m,b,x,k,M,w,S,1,O,L)):f[u]=[]:"Bottom"===t?0<v?(a=Math.atan(v/y),o=Math.atan(v/p),f[u]=Ie.calPoints(v,_[c],a,o,g,m,b,x,k,M,w,S,2,N,L)):f[u]=[]:"Left"===t&&(0<y?(s=Math.atan(y/d),h=Math.atan(y/v),f[u]=Ie.calPoints(y,_[c],s,h,g,m,b,x,k,M,w,S,3,C,N)):f[u]=[]))})):(jr.contain(e,jr.OPACITY)&&(_.opacity=a.opacity),jr.contain(e,jr.FILTER)&&(_.filter=a.filter));var $=n&&n.computedStyle;if(a.fontStyle.unit===ii?_.fontStyle=n?$.fontStyle:"normal":f.fontStyle||(_.fontStyle=a.fontStyle.value),f.fontStyle=_.fontStyle,a.color.unit===ii?(_.color=n?$.color:[0,0,0,1],f.color=ai(_.color)):f.color||(_.color=oi(a.color.value),f.color=ai(_.color)),a.visibility.unit===ii?_.visibility=n?$.visibility:"visible":f.visibility||(_.visibility=a.visibility.value),f.visibility=_.visibility,a.pointerEvents.unit===ii?_.pointerEvents=n?$.pointerEvents:"auto":f.pointerEvents||(_.pointerEvents=a.pointerEvents.value),f.pointerEvents=_.pointerEvents,t===Qt.CANVAS){if(e<jr.REPAINT)return this.__hasContent;var j=_.backgroundImage;if(j){if(j.k)return!0;var q=this.__loadBgi;if(j===q.url&&q.source)return!0}if(0<_.backgroundColor[3])return!0;for(var U=["borderTop","borderRight","borderBottom","borderLeft"],V=0,Z=U.length;V<Z;V++){var K=U[V];if(0<_[K+"Width"]&&0<_[K+"Color"][3])return!0}var J=_.boxShadow;if(Array.isArray(J))for(var Q=0,tt=J.length;Q<tt;Q++){var et=J[Q];if(et&&(0<et[2]||0<et[3]))return!0}for(var rt=0,it=di.length;rt<it;rt++){var nt=_[di[rt]];if(0<nt[0]&&0<nt[1])return!0}}return!1}},{key:"__renderSelf",value:function(u,l,c,f,_){var d,p=this,t=this.isDestroyed,e=this.currentStyle,r=this.computedStyle,i=this.__cacheStyle,v=this.root,n=this.__cache,a=this.__cacheTotal;if(this.__renderSelfData=null,this.__refreshLevel=jr.NONE,t)return{isDestroyed:t,break:!0};if(u===Qt.SVG&&(d=this.__virtualDom={bb:[],children:[],visibility:"visible"},a?a.available||(a.available=!0):this.__cacheTotal={available:!0,release:function(){this.available=!1,delete d.cache}}),"none"===r.display){if(u===Qt.CANVAS)return{};if(u===Qt.SVG)return{break:!0}}var o=this.sx,s=this.sy,h=this.width,y=this.height,g=this.innerWidth,m=this.innerHeight,b=this.outerWidth,x=this.outerHeight,k=r.marginTop,M=r.marginLeft,w=r.paddingTop,S=r.paddingRight,A=r.paddingBottom,E=r.paddingLeft,P=r.borderLeftWidth,T=r.borderRightWidth,R=r.borderTopWidth,C=r.borderBottomWidth,O=this.__sx1=o+M,L=this.__sx2=O+P,N=this.__sx3=L+h+E+S,I=this.__sx4=N+T,F=this.__sy1=s+k,W=this.__sy2=F+R,D=this.__sy3=W+y+w+A,B=this.__sy4=D+C,H={x1:O,x2:L,x3:N,x4:I,y1:F,y2:W,y3:D,y4:B},z=this.domParent,G=this.__hasContent=this.__calCache(u,l,c,f,this.parent,i,e,r,o,s,g,m,b,x,R,T,C,P,O,L,N,I,F,W,D,B),Y=r.backgroundColor,X=r.borderTopColor,$=r.borderRightColor,j=r.borderBottomColor,q=r.borderLeftColor,U=r.borderTopLeftRadius,V=r.borderTopRightRadius,Z=r.borderBottomRightRadius,K=r.borderBottomLeftRadius,J=r.visibility,Q=r.backgroundRepeat,tt=r.backgroundImage,et=r.opacity,rt=r.filter,it=r.backgroundSize,nt=r.boxShadow;u===Qt.CANVAS?(z&&(et*=z.__opacity),this.__opacity=et):u===Qt.SVG&&(1===et?delete d.opacity:d.opacity=et);var at=this.__matrix=i.matrix,ot=this.__renderMatrix=at;if(z&&(at=ee.multiply(z.matrixEvent,at)),this.__matrixEvent=at,u===Qt.SVG&&(!jr.contain(l,ci)&&l<jr.REPAINT||(ee.isE(ot)?delete d.transform:d.transform="matrix("+si(ot,",")+")")),"hidden"===J&&u===Qt.CANVAS)return H.break=!0,H;u===Qt.SVG&&(d.visibility=J);var st,ht,ut,lt,ct,ft,_t,dt=0,pt=0;if(_&&u===Qt.CANVAS){if(!G&&this.__releaseWhenEmpty(n))return H.break=!0,this.__limitCache=!1,H;if(this.__limitCache||n&&n.available||(st=this.bbox,n?n.reset(st):n=Jr.getInstance(st),n&&n.enabled?((this.__cache=n).__bbox=st,n.__appendData(O,F),ht=n.dbx,ut=n.dby,c=n.ctx,ct=(lt=te(n.coords,2))[0],ft=lt[1],dt=n.dx,pt=n.dy,H.x1=O=ct+ht,H.y1=F=ft+ut,dt&&(H.x2=L+=dt,H.x3=N+=dt,H.x4=I+=dt),pt&&(H.y2=W+=pt,H.y3=D+=pt,H.y4=B+=pt)):(this.__limitCache=!0,n=this.__cache=null)),this.__limitCache)return{limitCache:!0}}if(Array.isArray(rt)&&rt.forEach(function(t){var e,r,i,n,a,o=te(t,2),s=o[0],h=o[1];"blur"===s&&(p.__blurValue=h,u===Qt.CANVAS&&0<h&&!_?(e=v.width,r=v.height,(i=Je.getCacheCanvas(e,r,"__$$blur$$__")).ctx&&((_t={ctx:c,blur:h}).target=i,c=i.ctx)):u===Qt.SVG&&(l>=jr.REFLOW||jr.contain(l,jr.FILTER))&&(0<h?(n=ee.int2convolution(h),a=f.add({tagName:"filter",props:[["x",-n/b],["y",-n/x],["width",1+2*n/b],["height",1+2*n/x]],children:[{tagName:"feGaussianBlur",props:[["stdDeviation",h]]}]}),d.filter="url(#"+a+")"):delete d.filter))}),u!==Qt.CANVAS||_||(c.globalAlpha=et,c.setTransform(at[0],at[1],at[2],at[3],at[4],at[5])),0<Y[3]&&_i(u,i.backgroundColor,L,W,g,m,c,this,R,T,C,P,U,V,Z,K),tt)if(re.isString(tt)){var vt=this.__loadBgi;if(vt.url===tt){var yt=vt.source;if(yt){var gt=vt.width,mt=vt.height,bt=te(it,2),xt=bt[0],kt=bt[1];-1===xt&&-1===kt?(xt=gt,kt=mt):-2===xt?g<gt&&m<mt?(kt=mt/m)<=(xt=gt/g)?kt=(xt=g)*mt/gt:xt=(kt=m)*gt/mt:g<gt?kt=(xt=g)*mt/gt:m<mt?xt=(kt=m)*gt/mt:(xt=gt,kt=mt):-3===xt?gt<g&&mt<m?(xt=gt/g)<=(kt=mt/m)?kt=(xt=g)*mt/gt:xt=(kt=m)*gt/mt:gt<g||!(mt<m)&&(xt=gt/g)<=(kt=mt/m)?kt=(xt=g)*mt/gt:xt=(kt=m)*gt/mt:-1===xt?xt=kt*gt/mt:-1===kt&&(kt=xt*mt/gt);var Mt,wt,St=L+pi(e.backgroundPositionX,g,xt),At=W+pi(e.backgroundPositionY,m,kt),Et=St<L||At<W||g<xt||m<kt,Pt=0,Tt=0,Rt=0,Ct=0;-1<["repeat-x","repeat"].indexOf(Q)&&(0<(Mt=St-L)&&(Pt=Math.ceil(Mt/xt)),0<(Mt=L+g-St-xt)&&(Tt=Math.ceil(Mt/xt))),-1<["repeat-y","repeat"].indexOf(Q)&&(0<(wt=At-W)&&(Rt=Math.ceil(wt/kt)),0<(wt=W+m-At-kt)&&(Ct=Math.ceil(wt/kt)));var Ot,Lt,Nt,It,Ft=[];if(0<Pt)for(var Wt=0;Wt<Pt;Wt++){var Dt=St-(Wt+1)*xt;Ft.push([Dt,At]),!Et&&0===Wt&&Dt<L&&(Et=!0)}if(0<Tt)for(var Bt=0;Bt<Tt;Bt++){var Ht=St+(Bt+1)*xt;Ft.push([Ht,At]),!Et&&Bt===Tt-1&&L+g<Ht+xt&&(Et=!0)}if(0<Rt)for(var zt=0;zt<Rt;zt++){var Gt=At-(zt+1)*kt;Ft.push([St,Gt]),!Et&&0===zt&&Gt<W&&(Et=!0)}if(0<Ct)for(var Yt=0;Yt<Ct;Yt++){var Xt=At+(Yt+1)*kt;Ft.push([St,Xt]),!Et&&Yt===Ct-1&&W+m<Xt+xt&&(Et=!0)}if(0<Pt&&0<Rt)for(var $t=0;$t<Pt;$t++)for(var jt=0;jt<Rt;jt++)Ft.push([St-($t+1)*xt,At-(jt+1)*kt]);if(0<Tt&&0<Rt)for(var qt=0;qt<Tt;qt++)for(var Ut=0;Ut<Rt;Ut++)Ft.push([St+(qt+1)*xt,At-(Ut+1)*kt]);if(0<Pt&&0<Ct)for(var Vt=0;Vt<Pt;Vt++)for(var Zt=0;Zt<Ct;Zt++)Ft.push([St-(Vt+1)*xt,At+(Zt+1)*kt]);if(0<Tt&&0<Ct)for(var Kt=0;Kt<Tt;Kt++)for(var Jt=0;Jt<Ct;Jt++)Ft.push([St+(Kt+1)*xt,At+(Jt+1)*kt]);u===Qt.CANVAS?(Et&&(c.save(),_i(u,"#FFF",L,W,g,m,c,this,R,T,C,P,U,V,Z,K,"clip")),c.drawImage(yt,St,At,xt,kt),Ft.forEach(function(t){c.drawImage(yt,t[0],t[1],xt,kt)}),Et&&c.restore()):u===Qt.SVG&&(Ot=De.matrixResize(gt,mt,xt,kt,St,At,g,m),Lt=[["xlink:href",tt],["x",St],["y",At],["width",gt],["height",mt]],Ot&&!ee.isE(Ot)&&(Nt=!0,Lt.push(["transform","matrix("+si(Ot,",")+")"])),Et&&(It=f.add({tagName:"clipPath",children:[{tagName:"rect",props:[["x",L],["y",W],["width",g],["height",m],["fill","#FFF"]]}]}),this.virtualDom.bbClip="url(#"+It+")"),this.virtualDom.bb.push({type:"img",tagName:"image",props:Lt}),Ft.forEach(function(t){var e,r=ni(Lt);!Nt||(e=De.matrixResize(gt,mt,xt,kt,t[0],t[1],g,m))&&!ee.isE(e)&&(r[5][1]="matrix("+si(e,",")+")"),r[1][1]=t[0],r[2][1]=t[1],p.virtualDom.bb.push({type:"img",tagName:"image",props:r})}))}}}else tt.k&&_i(u,i.backgroundImage,L,W,g,m,c,this,R,T,C,P,U,V,Z,K);return nt&&nt.forEach(function(t){!function(t,e,r,i,n,a,o,s,h,u,l){var c=te(i,6),f=c[0],_=c[1],d=c[2],p=c[3],v=c[4],y=c[5],g=ai(v),m=2*Math.abs(d)+2*Math.abs(p)+2*Math.abs(f)+2*Math.abs(_),b=[[a,o],[s,o],[s,h],[a,h],[a,o]],x=[[a-m,o-m],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m]];if(0<v[3]&&(0<d||0<p))if(t===Qt.CANVAS){if(e.save(),e.beginPath(),"inset"===y){var k=a+f+p,M=o+_+p,w=s+f-p,S=h+_-p,A=[[k,M],[w,M],[w,S],[k,S]],E=ie.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[A[0][0],A[0][1],A[2][0],A[2][1]]);if(!E)return;E=[[E[0],E[1]],[E[2],E[1]],[E[2],E[3]],[E[0],E[3]],[E[0],E[1]]],p?(ui(e,E),ui(e,b.slice(0).reverse()),e.clip(),e.closePath(),e.beginPath(),e.fillStyle!==g&&(e.fillStyle=g),ui(e,b),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),ui(e,E),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowColor=g,e.shadowBlur=d,ui(e,[[k,M],[w,M],[w,S],[a-m,S],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,S],[k,S],[k,M]])):(ui(e,b),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowOffsetX=f,e.shadowOffsetY=_,e.shadowColor=g,e.shadowBlur=d,ui(e,[[a,o],[s,o],[s,h],[a-m,h],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,h],[a,h],[a,o]]))}else{var P=a+f-p,T=o+_-p,R=s+f+p,C=h+_+p,O=[[P,T],[R,T],[R,C],[P,C]],L=ie.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[O[0][0],O[0][1],O[2][0],O[2][1]]);p?(ui(e,b),ui(e,O.slice(0).reverse()),e.clip(),e.closePath(),e.beginPath(),e.fillStyle!==g&&(e.fillStyle=g),ui(e,O),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),L&&ui(e,[[L[0],L[1]],[L[2],L[1]],[L[2],L[3]],[L[0],L[3]],[L[0],L[1]]].reverse()),ui(e,b),ui(e,O),ui(e,x),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowColor=g,e.shadowBlur=d,ui(e,O)):(ui(e,b),ui(e,x),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowOffsetX=f,e.shadowOffsetY=_,e.shadowColor=g,e.shadowBlur=d,ui(e,b))}e.fill(),e.closePath(),e.restore()}else if(t===Qt.SVG){var N=ee.int2convolution(d);if("inset"===y){var I,F,W,D,B=a+f+p,H=o+_+p,z=s+f-p,G=h+_-p,Y=[[B,H],[z,H],[z,G],[B,G]],X=ie.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[Y[0][0],Y[0][1],Y[2][0],Y[2][1]]);if(!X)return;X=[[X[0],X[1]],[X[2],X[1]],[X[2],X[3]],[X[0],X[3]],[X[0],X[1]]],p?(I=r.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*d],["flood-color",g]]}]}),F=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",li(X)+li(b.slice(0).reverse())],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",li(b)],["fill",g],["clip-path","url(#"+F+")"]]}),F=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",li(X)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",li([[B,H],[z,H],[z,G],[a-m,G],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,G],[B,G],[B,H]])],["fill","#FFF"],["filter","url(#"+I+")"],["clip-path","url(#"+F+")"]]})):(W=r.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",f],["dy",_],["stdDeviation",.5*d],["flood-color",g]]}]}),D=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",li(b)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",li([[a,o],[s,o],[s,h],[a-m,h],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,h],[a,h],[a,o]])],["fill","#FFF"],["filter","url(#"+W+")"],["clip-path","url(#"+D+")"]]}))}else{var $,j,q,U,V=a+f-p,Z=o+_-p,K=s+f+p,J=h+_+p,Q=[[V,Z],[K,Z],[K,J],[V,J]],tt=ie.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[Q[0][0],Q[0][1],Q[2][0],Q[2][1]]);p?($=r.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*d],["flood-color",g]]}]}),j=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",li(b)+li(Q.slice(0).reverse())],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",li(Q)],["fill",g],["clip-path","url(#"+j+")"]]}),j=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",(tt?li([[tt[0],tt[1]],[tt[2],tt[1]],[tt[2],tt[3]],[tt[0],tt[3]],[tt[0],tt[1]]].reverse()):"")+li(b)+li(Q)+li(x)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",li(Q)],["fill","#FFF"],["filter","url(#"+$+")"],["clip-path","url(#"+j+")"]]})):(q=r.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",f],["dy",_],["stdDeviation",.5*d],["flood-color",g]]}]}),U=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",li(b)+li(x)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",li(b)],["fill","#FFF"],["filter","url(#"+q+")"],["clip-path","url(#"+U+")"]]}))}}}(u,c,f,t,p,O,F,I,B,b,x)}),0<R&&0<X[3]&&fi(u,i.borderTop,i.borderTopColor,c,this,dt,pt),0<T&&0<$[3]&&fi(u,i.borderRight,i.borderRightColor,c,this,dt,pt),0<C&&0<j[3]&&fi(u,i.borderBottom,i.borderBottomColor,c,this,dt,pt),0<P&&0<q[3]&&fi(u,i.borderLeft,i.borderLeftColor,c,this,dt,pt),n&&n.enabled&&(n.__available=!0),u===Qt.CANVAS&&(H.offScreen=_t),H}},{key:"render",value:function(t,e,r,i,n){return this.__renderSelf(t,e,r,i,n)}},{key:"__destroy",value:function(){var t,e;this.isDestroyed||(!(t=this.props.ref)||(e=this.host||this.root)&&e.ref[t]&&delete e.ref[t],this.animationList.forEach(function(t){return t.__destroy()}),this.root.delRefreshTask(this.__loadBgi.cb),this.root.delRefreshTask(this.__task),Q(J(S.prototype),"__destroy",this).call(this),this.__matrix=this.__matrixEvent=this.__root=null,this.__cache&&(this.__cache.release(),this.__cache=null),this.__cacheTotal&&(this.__cacheTotal.release(),this.__cacheTotal=null),this.__cacheFilter&&(this.__cacheFilter.release(),this.__cacheFilter=null))}},{key:"__emitEvent",value:function(t,e){var r=this.isDestroyed,i=this.computedStyle;if(!r&&"none"!==i.display&&!t.__stopPropagation){var n,a=t.event.type,o=this.listener;return o.hasOwnProperty(a)&&(n=o[a]),e?(t.target=this,re.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0):this.willResponseEvent(t)?(re.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0):void 0}}},{key:"willResponseEvent",value:function(t){var e=t.x,r=t.y,i=this.sx,n=this.sy,a=this.outerWidth,o=this.outerHeight,s=this.matrixEvent;if("none"!==this.computedStyle.pointerEvents)return ge.pointInQuadrilateral(e,r,i,n,i+a,n,i+a,n+o,i,n+o,s)?(t.target||(t.target=this,"touchstart"===t.event.type&&(this.root.__touchstartTarget=this)),!0):void 0}},{key:"__gradient",value:function(t,e,r,i,n,a,o,s,h,u){var l,c,f,_=u.k,d=u.v,p=u.d,v=u.s,y=u.z,g=u.p,m=i+.5*s,b=n+.5*h;return"linear"===_?(l=q.getLinear(d,p,m,b,s,h),c=this.__getLg(t,e,r,l)):"radial"===_&&(f=q.getRadial(d,v,y,g,i,n,a,o),c=this.__getRg(t,e,r,f)),c}},{key:"__getLg",value:function(t,e,r,i){if(t===Qt.CANVAS){var n=e.createLinearGradient(i.x1,i.y1,i.x2,i.y2);return i.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===Qt.SVG)return"url(#"+r.add({tagName:"linearGradient",props:[["x1",i.x1],["y1",i.y1],["x2",i.x2],["y2",i.y2]],children:i.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})})+")"}},{key:"__cancelCache",value:function(){this.__cacheStyle={},this.__cache&&this.__cache.release(),this.__cacheTotal&&this.__cacheTotal.release()}},{key:"__getRg",value:function(t,e,r,i){if(t===Qt.CANVAS){var n=e.createRadialGradient(i.cx,i.cy,0,i.cx,i.cy,i.r);return i.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===Qt.SVG)return"url(#"+r.add({tagName:"radialGradient",props:[["cx",i.cx],["cy",i.cy],["r",i.r]],children:i.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})})+")"}},{key:"updateStyle",value:function(e,r){var t=this.tagName,i=this.root;if(i){var n,a=Object.keys(e);for(var o in a.forEach(function(t){st.hasOwnProperty(t)&&(st.toFull(e,t),delete e[t])}),e)e.hasOwnProperty(o)&&(Ot.isValid(t,o)?n=!0:delete e[o]);if(!n)return void(re.isFunction(r)&&r(0));var s=this;i.addRefreshTask(s.__task={__before:function(){s.isDestroyed||i.__addUpdate({node:s,style:e,origin:!0,overwrite:!0})},__after:function(t){re.isFunction(r)&&r.call(s,t)}})}}},{key:"animate",value:function(t,e){if(!this.isDestroyed){var r=new Yr(this,t,e);return this.animationList.push(r),!1===e.autoPlay?r:r.play()}}},{key:"removeAnimate",value:function(t){var e;t instanceof Yr&&(-1<(e=this.animationList.indexOf(t))&&(t.cancel(),t.__destroy(),this.animationList.splice(e,1)))}},{key:"clearAnimate",value:function(){this.animationList.splice(0).forEach(function(t){t.cancel(),t.__destroy()})}},{key:"__computeMeasure",value:function(t,e,r,i){Gt.computeMeasure(this,r),re.isFunction(i)&&i(this)}},{key:"deepScan",value:function(t,e){return t(this,e)}},{key:"__offsetX",value:function(t,e,r){Q(J(S.prototype),"__offsetX",this).call(this,t,e),e&&(this.layoutData.x+=t),void 0!==r&&(this.__refreshLevel|=r),this.__sx1+=t,this.__sx2+=t,this.__sx3+=t,this.__sx4+=t}},{key:"__offsetY",value:function(t,e,r){Q(J(S.prototype),"__offsetY",this).call(this,t,e),e&&(this.layoutData.y+=t),void 0!==r&&(this.__refreshLevel|=r),this.__sy1+=t,this.__sy2+=t,this.__sy3+=t,this.__sy4+=t}},{key:"__resizeX",value:function(t){this.computedStyle.width=this.__width+=t,this.__innerWidth+=t,this.__outerWidth+=t,this.layoutData.w+=t,t<0&&(this.__limitCache=!1)}},{key:"__resizeY",value:function(t){this.computedStyle.height=this.__height+=t,this.__innerHeight+=t,this.__outerHeight+=t,this.layoutData.h+=t,t<0&&(this.__limitCache=!1)}},{key:"__spreadByBoxShadowAndFilter",value:function(t,e){var s=0,h=0;if(Array.isArray(t)&&t.forEach(function(t){var e,r=te(t,6),i=r[0],n=r[1],a=r[2],o=r[3];"inset"!==r[5]&&(e=ee.int2convolution(a),e+=o,s=Math.max(s,i+e),h=Math.max(h,n+e))}),Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var n,a=te(e[r],2),o=a[0],u=a[1];"blur"===o&&(n=ee.int2convolution(u),s=Math.max(s,n),h=Math.max(h,n))}return[s,h]}},{key:"__releaseWhenEmpty",value:function(t){return t&&t.available&&t.release(),!0}},{key:"tagName",get:function(){return this.__tagName}},{key:"sx",get:function(){return this.__sx}},{key:"sy",get:function(){return this.__sy}},{key:"innerWidth",get:function(){return this.__innerWidth||0}},{key:"innerHeight",get:function(){return this.__innerHeight||0}},{key:"outerWidth",get:function(){return this.__outerWidth||0}},{key:"outerHeight",get:function(){return this.__outerHeight||0}},{key:"bbox",get:function(){var t=this.__sx1,e=this.__sy1,r=this.innerWidth,i=this.innerHeight,n=this.computedStyle,a=n.borderTopWidth,o=n.borderRightWidth,s=n.borderBottomWidth,h=n.borderLeftWidth,u=n.boxShadow,l=n.filter,c=te(this.__spreadByBoxShadowAndFilter(u,l),2),f=c[0],_=c[1];return[t-f,e-_,t+(r+=h+o)+f,e+(i+=a+s)+_]}},{key:"listener",get:function(){return this.__listener}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixEvent",get:function(){return this.__matrixEvent}},{key:"renderMatrix",get:function(){return this.__renderMatrix}},{key:"style",get:function(){return this.__style}},{key:"computedStyle",get:function(){return this.__computedStyle}},{key:"animationList",get:function(){return this.__animationList}},{key:"currentStyle",get:function(){return this.__currentStyle}},{key:"layoutData",get:function(){return this.__layoutData}},{key:"isShadowRoot",get:function(){return!this.parent&&this.host&&this.host!==this.root}}]),S}(),ki=function(){function r(t,e){u(this,r),this.__list=[],this.__x=t,this.__y=e,this.__baseLine=0}return l(r,[{key:"add",value:function(t){this.list.push(t)}},{key:"__calBaseLine",value:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.baseLine)}),e}},{key:"verticalAlign",value:function(){var r=this.__baseLine=this.__calBaseLine();1<this.list.length&&this.list.forEach(function(t){var e=t.baseLine;e!==r&&t.__offsetY(r-e)})}},{key:"horizonAlign",value:function(e){this.list.forEach(function(t){t.__offsetX(e,!0)})}},{key:"list",get:function(){return this.__list}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){var e=0;return this.list.forEach(function(t){e+=t.outerWidth}),e}},{key:"height",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.outerHeight)}),e}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"size",get:function(){return this.__list.length}},{key:"marginBottom",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.computedStyle.marginBottom)}),e}}]),r}(),Mi=c.TYPE_VD,wi=c.TYPE_GM,Si=c.TYPE_CP;function Ai(t,e,r,i,n){if(Array.isArray(t))return t.map(function(t){return Ai(t,e,r,i)});if(re.isObject(t)&&t.$$type){var a=t.tagName,o=t.props,s=t.children,h=t.klass,u=t.$$type,l=t.inherit,c=t.__animateRecords;if(u===Si&&t.placeholder)return t.value;if(u===Mi){if("img"===a){if(f=new gi(a,o),Array.isArray(s)&&s.length)throw new Error("Img can not contain children")}else f=new yi(a,o);if("p"===a)n=!0;else if("div"===a&&n)throw new Error("Markup p can not contain div");s=Array.isArray(s)?Pi(f,Ai(s,e,r,i,n)):[],f.__children=s}else if(u===wi)var f=new(mi.getRegister(a))(a,o);else{if(u!==Si)return new Xt(t);(f=new h(o)).__tagName=f.__tagName||a}t.vd=f,c&&(f.__animateRecords=c).list.forEach(function(t){t.target=f}),l&&re.extendAnimate(l,f),f.__root=e,i&&(f.__host=i),u===Si&&f.__init();var _=o.ref;return re.isString(_)&&_||re.isNumber(_)?r.ref[_]=f:re.isFunction(_)&&_(f),f}return new Xt(t)}function Ei(t){if(Array.isArray(t))return t.map(Ei);if(!t||-1===[Mi,wi,Si].indexOf(t.$$type)||!Array.isArray(t.children))return t;var e=[];return function e(r,t,i){if(Array.isArray(t))t.forEach(function(t){e(r,t,i)});else if(!t||t.$$type!==Mi&&t.$$type!==wi)t&&t.$$type===Si?(r.push(t),i.lastText=null):re.isNil(t)||""===t||(null!==i.lastText?r[r.length-1]=i.lastText+=t:r.push(t));else{if(-1<["canvas","svg"].indexOf(t.tagName))throw new Error("Can not nest canvas/svg");t.$$type===Mi&&Ei(t),r.push(t),i.lastText=null}}(e,t.children,{lastText:null}),t.children=e,t}function Pi(e,t){var r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(t)?t.forEach(function(t){Pi(e,t,i)}):(t instanceof vi||t instanceof bi||t instanceof Xt)&&(t.__parent=e,i.prev&&((i.prev.__next=t).__prev=i.prev),(i.prev=t)instanceof yi?Pi(t,t.children):t instanceof bi&&((r=t.shadowRoot)instanceof Xt&&(r.__parent=e))),t}var Ti={ref:function(t){vi=t.Xom,yi=t.Dom,gi=t.Img,mi=t.Geom,bi=t.Component},initRoot:function(t,e){return Pi(e,Ai(Ei({children:t,$$type:Mi}).children,e,e))},initCp:function(t,e,r){if(re.isObject(t)){var i=Ai(t,e,r,r);return Array.isArray(i)&&Pi(r,i),i}return new Xt(t)},flattenJson:Ei,relation:Pi,build:Ai},Ri=re.isNil,Ci=re.isFunction,Oi=re.clone,Li=re.extend;var Ni=function(){e(h,rr);var r=f(h);function h(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return u(this,h),(t=r.call(this)).__tagName=/(?:function|class)\s+([\w$]+)/.exec(t.constructor.toString())[1],Array.isArray(e)?t.props=re.arr2hash(e):t.props=e,t.__parent=null,t.__host=null,t.__ref={},t.__state={},t.__isMounted=!1,t}return l(h,[{key:"setState",value:function(t,e){var r=this,i=this;if(Ri(t))t={};else{if(Ci(t))return void e.call(i);if(0===Object.keys(t).length)return void(Ci(e)&&e.call(i));var n=Oi(i.state);t=Li(n,t)}var a=i.root;a&&i.__isMounted?(a.delRefreshTask(i.__task),this.__task={__before:function(){i.__nextState=t,function t(e){e.__hasUpdate=!0;var r=e.host;r&&t(r)}(r)},__after:function(){Ci(e)&&e.call(i)},__state:!0},a.addRefreshTask(i.__task)):Ci(e)&&(i.__state=t,e.call(i))}},{key:"__init",value:function(t){var e,r=this,i=this.root,n=t||Ti.flattenJson(this.render()),a=Ti.initCp(n,i,this,this);if(this.__cd=n,a instanceof Xt)console.warn("Component render() return a text, should not inherit style/event");else if(a instanceof M){var o=Gt.normalize(this.props.style),s=Object.keys(o);Li(a.style,o,s),Li(a.currentStyle,o,s),Object.keys(this.props).forEach(function(t){var e=r.props[t];/^on[a-zA-Z]/.test(t)?(t=t.slice(2).toLowerCase(),a.listener[t]=e):/^on-[a-zA-Z\d_$]/.test(t)&&(t=t.slice(3),r.on(t,e))})}else{if(!(a instanceof h))throw new Error("Component render() must return a dom/text: "+this);console.warn("Component render() return a component: "+this.tagName+" -> "+a.tagName+", should not inherit style/event")}for((this.__shadow=a).__host=this;a instanceof h;)a=a.shadowRoot;(a.__host=this).__shadowRoot=a,this.__isMounted||(this.__isMounted=!0,e=this.componentDidMount,Ci(e)&&i.once(rr.REFRESH,function(){e.call(r)}))}},{key:"render",value:function(){}},{key:"__destroy",value:function(){var t;this.isDestroyed||(this.__isDestroyed=!0,t=this.componentWillUnmount,Ci(t)&&(t.call(this),this.__isMounted=!1),this.root.delRefreshTask(this.__task),this.shadowRoot&&this.shadowRoot.__destroy(),this.__shadow=null,this.__shadowRoot=null,this.__parent=null)}},{key:"__emitEvent",value:function(t){var e=this.shadowRoot;if(!(e instanceof Xt))return e.__emitEvent(t)?(t.target=this,!0):void 0}},{key:"__computeMeasure",value:function(t,e,r,i){var n=this.shadowRoot;n instanceof Xt?n.__computeMeasure(t,e):n.__computeMeasure(t,e,!0,i)}},{key:"tagName",get:function(){return this.__tagName}},{key:"shadow",get:function(){return this.__shadow}},{key:"shadowRoot",get:function(){return this.__shadowRoot}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"parent",get:function(){return this.__parent}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"ref",get:function(){return this.__ref}},{key:"state",get:function(){return this.__state},set:function(t){this.__state=t}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),h}();Object.keys(Ot.GEOM).concat(["x","y","ox","oy","sx","sy","width","height","outerWidth","outerHeight","innerWidth","innerHeight","style","animationList","animateStyle","currentStyle","computedStyle","currentProps","baseLine","virtualDom","mask","maskId","textWidth","content","lineBoxes","charWidthList","charWidth","layoutData","availableAnimating","effectiveAnimating","displayAnimating","visibilityAnimating","__refreshLevel","__cacheTotal","__cache","bbox","__struct"]).forEach(function(e){Object.defineProperty(Ni.prototype,e,{get:function(){var t=this.shadowRoot;if(t)return t[e]}})}),["__layout","__layoutAbs","__tryLayInline","__offsetX","__offsetY","__calAutoBasis","__calMp","__calAbs","__renderAsMask","__renderByMask","__mp","animate","removeAnimate","clearAnimate","updateStyle","deepScan","__cancelCache","__structure","__modifyStruct"].forEach(function(e){Ni.prototype[e]=function(){var t=this.shadowRoot;if(t&&Ci(t[e]))return t[e].apply(t,arguments)}});var Ii={TAG_NAME:{div:!0,p:!0,span:!0,img:!0,b:!0,strong:!0},INLINE:{span:!0,img:!0,b:!0,strong:!0},BOLD:{b:!0,strong:!0}},Fi=j.AUTO,Wi=j.PX,Di=j.PERCENT,Bi=Gt.calAbsolute,Hi=Gt.isRelativeOrAbsolute;function zi(t){var n,a,o,s=[],h=[],u={},l=!1;t.children.forEach(function(t,e){var r,i=t;t instanceof Ni&&(t=t.shadowRoot),(t.__layoutData||t instanceof Xt)&&(t.isMask?void 0!==o?u[o].push(t):e&&(u[o=e-1]=[t],n=!0):(o=void 0,t instanceof xi&&Hi(t)?(i.__iIndex=e,r=i.__zIndex=t.currentStyle.zIndex,h.push(i),void 0===a?a=r:l||(r<a&&(l=!0),a=r)):s.push(i)))}),l&&h.sort(function(t,e){return t.__zIndex!==e.__zIndex?t.__zIndex-e.__zIndex:t.__iIndex-e.__iIndex});var e=s.concat(h);if(n)for(var r=e.length-1;0<=r;r--)u.hasOwnProperty(r)&&e.splice.apply(e,[r+1,0].concat(_(u[r])));return e}var Gi,Yi,Xi,$i=function(){e(c,xi);var a=f(c);function c(t,e,r){var i;u(this,c),(i=a.call(this,t,e)).__lineGroups=[];var n=s(i).style;return n.display&&{flex:!0,block:!0,inline:!0,none:!0}.hasOwnProperty(n.display)||(Ii.INLINE.hasOwnProperty(i.tagName)?n.display="inline":n.display="block"),!n.fontWeight&&Ii.BOLD.hasOwnProperty(t)&&(n.fontWeight=700),i.__style=Gt.normalize(n,nt.DOM_ENTRY_SET),i.__currentStyle=re.extend({},i.__style),i.__children=r||[],i}return l(c,[{key:"__structure",value:function(i,n,t){var e=Q(J(c.prototype),"__structure",this).call(this,i++,n,t),a=[e],r=this.__zIndexChildren=this.__zIndexChildren||zi(this);r.forEach(function(t,e){var r=t.__structure(i,n+1,e);Array.isArray(r)?(i+=r.length,a=a.concat(r)):(i++,a.push(r))});var o=a.length-1;return e.num=r.length,e.total=o,a}},{key:"__modifyStruct",value:function(t,e){var r,i=1<arguments.length&&void 0!==e?e:0,n=this.__struct,a=this.__structure(n.index,n.lv,n.childIndex);(r=t.__structs).splice.apply(r,[n.index+i,n.total+1].concat(_(a)));var o=0;return this!==t&&(o=this.__struct.total-n.total,(n=this.domParent.__struct).total+=o),[this.__struct,o]}},{key:"__updateStruct",value:function(t){var e=this.__struct,r=e.index,i=e.total,n=this.__zIndexChildren=zi(this);if(1!==n.length){n.forEach(function(t,e){t.__struct.childIndex=e});for(var a,o,s=[],h=r+1;h<=i;h++){var u=t[h];s.push({child:u,list:t.slice(u.index,u.index+u.total+1)}),h+=u.total}s.sort(function(t,e){var r=t.child.childIndex-e.child.childIndex;return r<0&&(a=!0),r}),a&&(o=[],s.forEach(function(t){o=o.concat(t.list)}),o.forEach(function(t,e){t.index=r+e+1}),t.splice.apply(t,[r+1,i].concat(_(o))))}}},{key:"__tryLayInline",value:function(t,e){var r=this.flowChildren,i=this.currentStyle.width;if(i.unit===Wi)return t-i.value;if(i.unit===Di)return t-e*i.value*.01;for(var n=0;n<r.length;n++){if(t<0)return t;var a=r[n];t-=a instanceof xi||a instanceof Ni?a.__tryLayInline(t,e):a.textWidth}return t}},{key:"__offsetX",value:function(e,r,i){Q(J(c.prototype),"__offsetX",this).call(this,e,r,i),this.flowChildren.forEach(function(t){t&&t.__offsetX(e,r,i)})}},{key:"__offsetY",value:function(e,r,i){Q(J(c.prototype),"__offsetY",this).call(this,e,r,i),this.flowChildren.forEach(function(t){t&&t.__offsetY(e,r,i)})}},{key:"__calAutoBasis",value:function(a,o,s,t){var e,r,i,n,h=0,u=0,l=0,c=this.flowChildren,f=this.currentStyle,_=(this.computedStyle,f.width),d=f.height,p=f.marginLeft,v=f.marginTop,y=f.marginRight,g=f.marginBottom,m=f.paddingLeft,b=f.paddingTop,x=f.paddingRight,k=f.paddingBottom,M=f.borderTopWidth,w=f.borderRightWidth,S=f.borderBottomWidth,A=f.borderLeftWidth,E=a?_:d;return E.unit===Wi&&(h=l=E.value,t&&(u=h)),c.forEach(function(t){var e,r,i,n;l=t instanceof xi||t instanceof Ni&&t.shadowRoot instanceof xi?(r=(e=t.__calAutoBasis(a,o,s,!0)).b,i=e.min,n=e.max,h=Math.max(h,r),u=Math.max(u,i),Math.max(l,n)):a?(u=Math.max(t.charWidth,u),Math.max(t.textWidth,l)):(Gt.computeReflow(t),t.__layout({x:0,y:0,w:o,h:s},!0),u=Math.max(u,t.height),Math.max(l,t.height))}),a?(e=this.__calMp(p,o)+this.__calMp(y,o)+this.__calMp(m,o)+this.__calMp(x,o),r=A.value+w.value+e,h+=r,l+=r,u+=r):(i=this.__calMp(v,o)+this.__calMp(g,o)+this.__calMp(b,o)+this.__calMp(k,o),n=M.value+S.value+i,h+=n,l+=n,u+=n),{b:h,min:u,max:l}}},{key:"__calMp",value:function(t,e){var r=0;return t.unit===Wi?r+=t.value:t.unit===Di&&(t.value*=.01*e,t.unit=Wi,r+=t.value),r}},{key:"__layoutBlock",value:function(e,r){var t=this.flowChildren,i=this.currentStyle,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o=n.textAlign,s=this.__preLayout(e),h=s.fixedWidth,u=s.fixedHeight,l=s.x,c=s.y,f=s.w,_=s.h;if(h&&r)return this.__width=f,void this.__ioSize(f,this.height);var d=0,p=0,v=new ki(l,c);t.forEach(function(t){t instanceof xi||t instanceof Ni&&t.shadowRoot instanceof xi?"inline"===t.currentStyle.display?l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},r),l+=t.outerWidth,r&&(d=Math.max(d,p),p=t.outerWidth)):(0<=t.__tryLayInline(f-l+e.x,f)?t.__layout({x:l,y:c,w:f,h:_},r):(a.push(v),r||v.verticalAlign(),l=e.x,c+=v.height+v.marginBottom,t.__layout({x:e.x,y:c,w:f,h:_},r),v=new ki(l,c),r&&(d=Math.max(d,p),p=0)),l+=t.outerWidth,v.add(t),r&&(p+=t.outerWidth)):(v.size&&(a.push(v),v.verticalAlign(),c+=v.height+v.marginBottom,v=new ki(e.x,c),r&&(d=Math.max(d,p),p=0)),t.__layout({x:e.x,y:c,w:f,h:_},r),l=e.x,c+=t.outerHeight,r&&(d=Math.max(d,t.outerWidth),p=0)):l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},r),l+=t.width,r&&(d=Math.max(d,p),p=t.width)):(0<=t.__tryLayInline(f-l+e.x)?t.__layout({x:l,y:c,w:f,h:_},r):(a.push(v),v.verticalAlign(),l=e.x,c+=v.height+v.marginBottom,t.__layout({x:e.x,y:c,w:f,h:_},r),v=new ki(l,c),r&&(d=Math.max(d,p),p=0)),l+=t.width,v.add(t),r&&(p+=t.width))}),v.size&&(a.push(v),r?d=Math.max(d,p):v.verticalAlign(),c+=v.height);var y=this.__width=h||!r?f:d,g=this.__height=u?_:c-e.y;this.__ioSize(y,g),v.size&&(c+=v.marginBottom),!r&&-1<["center","right"].indexOf(o)&&a.forEach(function(t){var e=f-t.width;0<e&&t.horizonAlign("center"===o?.5*e:e)}),r||this.__marginAuto(i,e)}},{key:"__layoutFlex",value:function(t,l){var e=this.flowChildren,r=this.currentStyle,i=r.flexDirection,n=r.justifyContent,a=r.alignItems,o=this.__preLayout(t),s=o.fixedWidth,S=o.fixedHeight,A=o.x,E=o.y,P=o.w,T=o.h;if(s&&l)return this.__width=P,void this.__ioSize(P,this.height);var c=0,R="row"===i,C=[],O=[],L=[],N=[],I=0,F=0,W=0,f=0;if(e.forEach(function(t){if(t instanceof xi||t instanceof Ni&&t.shadowRoot instanceof xi){var e=t.__calAutoBasis(!!l||R,P,T),r=e.b,i=e.min,n=e.max;if(l)return void(R?c+=n:c=Math.max(c,n));var a=t.currentStyle,o=t.computedStyle,s=a.flexGrow,h=a.flexShrink,u=a.flexBasis;C.push(s),O.push(h),I+=s,F+=h,u.unit===Fi?(L.push(n),W+=n):u.unit===Wi?(o.flexBasis=r=u.value,L.push(r),W+=r):u.unit===Di&&(r=o.flexBasis=(R?P:T)*u.value*.01,L.push(r),W+=r),f+=n,N.push(i)}else{if(l)return void(R?c+=t.textWidth:c=Math.max(c,t.textWidth));C.push(0),O.push(1),F+=1,R?(L.push(t.textWidth),W+=t.textWidth,f+=t.textWidth,N.push(t.charWidth)):(t.__layout({x:0,y:0,w:P,h:T},!0),L.push(t.height),W+=t.height,f+=t.height,N.push(t.height))}}),l){var h=this.__width=Math.min(c,P);this.__ioSize(h,this.height)}else{var D=0,B=(R?P:T)<f;e.forEach(function(t,e){var r,i,n,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M=O[e],w=C[e];i=B?(r=W-(R?P:T),M?L[e]-r*M/F:L[e]):(n=(R?P:T)-W,w?L[e]+n*w/I:L[e]),i=Math.max(i,N[e]),t instanceof xi||t instanceof Ni&&t.shadowRoot instanceof xi?(a=t.currentStyle,o=t.computedStyle,s=a.display,h=a.flexDirection,u=a.width,l=a.height,"inline"===s&&(a.display=o.display="block"),R?("flex"===s&&"column"===h&&S&&l.unit===Fi&&(l.value=T,l.unit=Wi),t.__layout({x:A,y:E,w:i,h:T})):("flex"===s&&"row"===h&&u.unit===Fi&&(u.value=P,u.unit=Wi),t.__layout({x:A,y:E,w:P,h:i})),(B&&M||!B&&w)&&(c=o.borderTopWidth,f=o.borderRightWidth,_=o.borderBottomWidth,d=o.borderLeftWidth,p=o.marginTop,v=o.marginRight,y=o.marginBottom,g=o.marginLeft,m=o.paddingTop,b=o.paddingRight,x=o.paddingBottom,k=o.paddingLeft,R?(t.__width=i-g-v-k-b-d-f,t.__innerWidth=i-g-v-d-f,t.__outerWidth=i):(t.__height=i-p-y-m-x-c-_,t.__innerHeight=i-p-y-c-_,t.__outerHeight=i))):t.__layout({x:A,y:E,w:R?i:P,h:R?T:i}),D=R?(A+=t.outerWidth,Math.max(D,t.outerHeight)):(E+=t.outerHeight,Math.max(D,t.outerWidth))});var u=R?P-A+t.x:T-E+t.y;if(!B&&0===I&&0<u){var _=e.length;if("flex-end"===n)for(var d=0;d<_;d++){var p=e[d];R?p.__offsetX(u,!0):p.__offsetY(u,!0)}else if("center"===n)for(var v=.5*u,y=0;y<_;y++){var g=e[y];R?g.__offsetX(v,!0):g.__offsetY(v,!0)}else if("space-between"===n)for(var m=u/(_-1),b=1;b<_;b++){var x=e[b];R?x.__offsetX(m*b,!0):x.__offsetY(m*b,!0)}else if("space-around"===n)for(var k=u/(_+1),M=0;M<_;M++){var w=e[M];R?w.__offsetX(k*(M+1),!0):w.__offsetY(k*(M+1),!0)}}R?(S&&(D=T),E+=D):s&&(D=P),l||("stretch"===a?e.forEach(function(t){var e,r,i,n,a,o,s,h,u=t.computedStyle,l=t.currentStyle,c=l.alignSelf,f=l.width,_=l.height,d=u.borderTopWidth,p=u.borderRightWidth,v=u.borderBottomWidth,y=u.borderLeftWidth,g=u.marginTop,m=u.marginRight,b=u.marginBottom,x=u.marginLeft,k=u.paddingTop,M=u.paddingRight,w=u.paddingBottom,S=u.paddingLeft;R?"flex-start"===c||("center"===c?0!=(e=D-t.outerHeight)&&t.__offsetY(.5*e,!0):"flex-end"===c?0!=(r=D-t.outerHeight)&&t.__offsetY(r,!0):_.unit===Fi&&(i=t.height,n=(t.__height=u.height=D-g-b-k-w-d-v)-i,t.__innerHeight+=n,t.__outerHeight+=n)):"flex-start"===c||("center"===c?0!=(a=D-t.outerWidth)&&t.__offsetX(.5*a,!0):"flex-end"===c?0!=(o=D-t.outerWidth)&&t.__offsetX(o,!0):f.unit===Fi&&(s=t.width,h=(t.__width=u.width=D-x-m-S-M-p-y)-s,t.__innerWidth+=h,t.__outerWidth+=h))}):"center"===a?e.forEach(function(t){var e,r,i,n,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w,S=t.currentStyle.alignSelf;R?"flex-start"===S||("flex-end"===S?0!=(e=D-t.outerHeight)&&t.__offsetY(e,!0):"stretch"===S?(r=t.computedStyle,i=t.currentStyle.height,n=r.borderTopWidth,a=r.borderBottomWidth,o=r.marginTop,s=r.marginBottom,h=r.paddingTop,u=r.paddingBottom,i.unit===Fi&&(l=t.height,c=(t.__height=r.height=D-o-s-h-u-n-a)-l,t.__innerHeight+=c,t.__outerHeight+=c)):0!=(f=D-t.outerHeight)&&t.__offsetY(.5*f,!0)):"flex-start"===S||("flex-end"===S?0!=(_=D-t.outerWidth)&&t.__offsetX(_,!0):"stretch"===S?(d=t.computedStyle,p=t.currentStyle.width,v=d.borderRightWidth,y=d.borderLeftWidth,g=d.marginRight,m=d.marginLeft,b=d.paddingRight,x=d.paddingLeft,p.unit===Fi&&(k=t.width,M=(t.__width=d.width=D-m-g-x-b-v-y)-k,t.__innerWidth+=M,t.__outerWidth+=M)):0!=(w=D-t.outerWidth)&&t.__offsetX(.5*w,!0))}):"flex-end"===a?e.forEach(function(t){var e,r,i,n,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w,S=t.currentStyle.alignSelf;R?"flex-start"===S||("center"===S?0!=(e=D-t.outerHeight)&&t.__offsetY(.5*e,!0):"stretch"===S?(r=t.computedStyle,i=t.currentStyle.height,n=r.borderTopWidth,a=r.borderBottomWidth,o=r.marginTop,s=r.marginBottom,h=r.paddingTop,u=r.paddingBottom,i.unit===Fi&&(l=t.height,c=(t.__height=r.height=D-o-s-h-u-n-a)-l,t.__innerHeight+=c,t.__outerHeight+=c)):0!=(f=D-t.outerHeight)&&t.__offsetY(f,!0)):"flex-start"===S||("center"===S?0!=(_=D-t.outerWidth)&&t.__offsetX(.5*_,!0):"stretch"===S?(d=t.computedStyle,p=t.currentStyle.width,v=d.borderRightWidth,y=d.borderLeftWidth,g=d.marginRight,m=d.marginLeft,b=d.paddingRight,x=d.paddingLeft,p.unit===Fi&&(k=t.width,M=(t.__width=d.width=D-m-g-x-b-v-y)-k,t.__innerWidth+=M,t.__outerWidth+=M)):0!=(w=D-t.outerHeight)&&t.__offsetY(w,!0))}):e.forEach(function(t){var e,r,i,n,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w,S=t.currentStyle.alignSelf;R?"flex-start"===S||("center"===S?0!=(e=D-t.outerHeight)&&t.__offsetY(.5*e,!0):"flex-end"===S?0!=(r=D-t.outerHeight)&&t.__offsetY(r,!0):"stretch"===S&&(i=t.computedStyle,n=t.currentStyle.height,a=i.borderTopWidth,o=i.borderBottomWidth,s=i.marginTop,h=i.marginBottom,u=i.paddingTop,l=i.paddingBottom,n.unit===Fi&&(c=t.height,f=(t.__height=t.__height=i.height=D-s-h-u-l-a-o)-c,t.__innerHeight+=f,t.__outerHeight+=f))):"flex-start"===S||("center"===S?0!=(_=D-t.outerWidth)&&t.__offsetX(.5*_,!0):"flex-end"===S?0!=(d=D-t.outerWidth)&&t.__offsetX(d,!0):"stretch"===S&&(p=t.computedStyle,v=t.currentStyle.width,y=p.borderRightWidth,g=p.borderLeftWidth,m=p.marginRight,b=p.marginLeft,x=p.paddingRight,k=p.paddingLeft,v.unit===Fi&&(M=t.width,w=(t.__width=p.width=D-b-m-k-x-y-g)-M,t.__innerWidth+=w,t.__outerWidth+=w)))}));var H=this.__width=P,z=this.__height=S?T:E-t.y;this.__ioSize(H,z),this.__marginAuto(r,t)}}},{key:"__layoutInline",value:function(e,r){var i=this,t=this.flowChildren,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o=n.textAlign,s=this.__preLayout(e),h=s.fixedWidth,u=s.fixedHeight,l=s.x,c=s.y,f=s.w,_=s.h;if(h&&r)return this.__width=f,void this.__ioSize(f,this.height);var d=0,p=0,v=new ki(l,c);t.forEach(function(t){t instanceof xi||t instanceof Ni&&t.shadowRoot instanceof xi?("inline"!==t.currentStyle.display&&(t.currentStyle.display=t.computedStyle.display="inline",console.error("Inline can not contain block/flex")),l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},r),l+=t.outerWidth,d=Math.max(d,p),p=t.outerWidth):(0<=t.__tryLayInline(f-l+e.x,f)?t.__layout({x:l,y:c,w:f,h:_},r):(a.push(v),v.verticalAlign(),l=e.x,c+=v.height,t.__layout({x:e.x,y:c,w:f,h:_},r),v=new ki(l,c),d=Math.max(d,p),p=0),l+=t.outerWidth,v.add(t),p+=t.outerWidth)):l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},r),l+=t.width,d=Math.max(d,p),p=t.width):(0<=t.__tryLayInline(f-l+e.x)?t.__layout({x:l,y:c,w:f,h:_},r):(a.push(v),r||v.verticalAlign(),l=e.x,c+=v.height,t.__layout({x:e.x,y:c,w:f,h:_},r),v=new ki(l,c),d=Math.max(d,p),p=0),l+=t.width,v.add(t),p+=t.width)}),v.size&&(a.push(v),r||v.verticalAlign(),c+=v.height,d=Math.max(d,p));var y=this.__width=h?f:d,g=this.__height=u?_:c-e.y;this.__ioSize(y,g),!r&&-1<["center","right"].indexOf(o)&&a.forEach(function(t){var e=i.__width-t.width;0<e&&t.horizonAlign("center"===o?.5*e:e)})}},{key:"__layoutAbs",value:function(r,i,S){var A=r.sx,E=r.sy,P=r.innerWidth,T=r.innerHeight,t=r.computedStyle,e=this.isDestroyed,n=this.children,a=this.absChildren,o=t.display,s=t.borderTopWidth,h=t.borderLeftWidth,u=t.marginTop,l=t.marginLeft,R=t.paddingLeft;e||"none"===o||(A+=l+h,E+=u+s,a.forEach(function(t){if(!S||S===t){var e=t.currentStyle,r=t.computedStyle;t.__mp(e,r,P),"inline"===r.display&&(e.display=r.display="block");var i,n,a,o,s,h,u,l,c,f,_,d=e.left,p=e.top,v=e.right,y=e.bottom,g=e.width,m=e.height,b=e.display,x=e.flexDirection;if(d.unit!==Fi?(f=!0,r.left=Bi(e,"left",d,P)):r.left="auto",v.unit!==Fi?(l=!0,r.right=Bi(e,"right",v,P)):r.right="auto",p.unit!==Fi?(u=!0,r.top=Bi(e,"top",p,T)):r.top="auto",y.unit!==Fi?(c=!0,r.bottom=Bi(e,"bottom",y,T)):r.bottom="auto",f&&l?(i=A+r.left,a=A+P-r.right-i):f&&g.unit!==Fi?(i=A+r.left,a=g.unit===Wi?g.value:P*g.value*.01):l&&g.unit!==Fi?(a=g.unit===Wi?g.value:P*g.value*.01,i=A+P-r.right-a,i-=r.marginLeft,i-=r.marginRight,i-=r.paddingLeft,i-=r.paddingRight,i-=e.borderLeftWidth.value,i-=e.borderRightWidth.value):f?i=A+r.left:l?(i=A+P-r.right,s=!0):(i=A+R,g.unit!==Fi&&(a=g.unit===Wi?g.value:P*g.value*.01)),u&&c)n=E+r.top,o=E+T-r.bottom-n;else if(u&&m.unit!==Fi)n=E+r.top,o=m.unit===Wi?m.value:T*m.value*.01;else if(c&&m.unit!==Fi)o=m.unit===Wi?m.value:T*m.value*.01,n=E+T-r.bottom-o,n-=r.marginTop,n-=r.marginBottom,n-=r.paddingTop,n-=r.paddingBottom,n-=e.borderTopWidth.value,n-=e.borderBottomWidth.value;else if(u)n=E+r.top;else if(c)n=E+T-r.bottom,h=!0;else{n=E;for(var k=t.prev;k;){if(k instanceof Xt||"absolute"!==k.computedStyle.position){n=k.y+k.outerHeight;break}k=k.prev}k||(n=E),m.unit!==Fi&&(o=m.unit===Wi?m.value:T*m.value*.01)}("block"===b&&void 0===a||"flex"===b&&(void 0===a||"column"===x&&void 0===o))&&(_=!0);var M=s?i-A:P+A-i,w=h?n-E:T+E-n;_&&(t.__layout({x:i,y:n,w:M,h:w},!0,!0),M=t.outerWidth),t.__layout({x:i,y:n,w:M,h:w,w2:a,h2:o},!1,!0),s&&t.__offsetX(-t.outerWidth,!0),h&&t.__offsetY(-t.outerHeight,!0)}}),n.forEach(function(t){var e;S&&S!==t||(t instanceof c?t.__layoutAbs(Hi(t)?t:r,i):t instanceof Ni&&((e=t.shadowRoot)instanceof c&&e.__layoutAbs(e,i)))}))}},{key:"__computeMeasure",value:function(e,r,t,i){Q(J(c.prototype),"__computeMeasure",this).call(this,e,r,t,i),this.children.forEach(function(t){t.__computeMeasure(e,r,!1,i)})}},{key:"render",value:function(t,e,r,i,n){var a=Q(J(c.prototype),"render",this).call(this,t,e,r,i,n);return t===Qt.SVG&&(this.virtualDom.type="dom"),a}},{key:"__destroy",value:function(){this.isDestroyed||(this.children.forEach(function(t){t&&t.__destroy()}),Q(J(c.prototype),"__destroy",this).call(this),this.children.splice(0),this.lineGroups.splice(0))}},{key:"__emitEvent",value:function(t,e){if(e)return Q(J(c.prototype),"__emitEvent",this).call(this,t,e);var r=this.isDestroyed,i=this.computedStyle;if(!r&&"none"!==i.display&&!t.__stopPropagation){var n,a=t.event.type,o=this.listener,s=this.zIndexChildren;o.hasOwnProperty(a)&&(n=o[a]);for(var h=s.length-1;0<=h;h--){var u=s[h];if((u instanceof xi||u instanceof Ni&&u.shadowRoot instanceof xi)&&u.__emitEvent(t)){if(t.__stopPropagation)return;return re.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0}}return Q(J(c.prototype),"__emitEvent",this).call(this,t)}}},{key:"__cancelCache",value:function(e){Q(J(c.prototype),"__cancelCache",this).call(this,e),e&&this.children.forEach(function(t){(t instanceof xi||t instanceof Ni&&t.shadowRoot instanceof xi)&&t.__cancelCache(e)})}},{key:"deepScan",value:function(e,r){Q(J(c.prototype),"deepScan",this).call(this,e,r)||this.children.forEach(function(t){t.deepScan(e,r)})}},{key:"children",get:function(){return this.__children}},{key:"flowChildren",get:function(){return this.children.filter(function(t){return t instanceof Ni&&(t=t.shadowRoot),t instanceof Xt||"absolute"!==t.currentStyle.position})}},{key:"absChildren",get:function(){return this.children.filter(function(t){return t instanceof Ni&&(t=t.shadowRoot),t instanceof xi&&"absolute"===t.currentStyle.position})}},{key:"zIndexChildren",get:function(){return this.__zIndexChildren}},{key:"lineGroups",get:function(){return this.__lineGroups}},{key:"baseLine",get:function(){var t=this.lineGroups.length;if(t){var e=this.lineGroups[t-1];return e.y-this.y+e.baseLine}return this.y}}]),c}(),ji=j.AUTO,qi=jt.canvasPolygon,Ui=jt.svgPolygon,Vi=function(){e(K,$i);var a=f(K);function K(t,e){var r;u(this,K);var i=(r=a.call(this,t,e)).props.src,n=r.__loadImg={};return i||(n.error=!0),r}return l(K,[{key:"__preLayout",value:function(t){var e,r,i=Q(J(K.prototype),"__preLayout",this).call(this,t),n=this.__loadImg;return n.error||(e=this.props.src,(r=Je.IMG[e])&&r.state===Je.LOADED&&(n.url=e,n.source=r.source,n.width=r.width,n.height=r.height),n.cache=!1),i.fixedWidth&&i.fixedHeight||(n.error?i.fixedWidth?i.h=i.w:i.fixedHeight?i.w=i.h:i.w=i.h=32:n.source?i.fixedWidth?i.h=i.w*n.height/n.width:i.fixedHeight?i.w=i.h*n.width/n.height:(i.w=n.width,i.h=n.height):i.w=i.h=0,i.fixedWidth=!0,i.fixedHeight=!0),i}},{key:"__addGeom",value:function(t,e){e=re.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),Q(J(K.prototype),"__destroy",this).call(this)}},{key:"render",value:function(t,e,r,i,n){var a,o,s=this,h=Q(J(K.prototype),"render",this).call(this,t,e,r,i,n),u=this.width,l=this.height,c=this.isDestroyed,f=this.props.src,_=this.computedStyle,d=_.display,p=_.borderTopWidth,v=_.borderRightWidth,y=_.borderBottomWidth,g=_.borderLeftWidth,m=(_.marginTop,_.marginLeft,_.paddingTop),b=_.paddingLeft,x=_.borderTopLeftRadius,k=_.borderTopRightRadius,M=_.borderBottomRightRadius,w=_.borderBottomLeftRadius,S=_.visibility,A=this.virtualDom,E=this.__cache;if(c||"none"===d||"hidden"===S)return h;t===Qt.CANVAS&&(this.__cacheTotal=E),n&&E&&E.enabled&&(r=E.ctx),a=h.x2+b,o=h.y2+m;var P=this.__loadImg;if(P.error){var T=.02*Math.min(u,l),R=a+.7*u,C=o+.3*l,O=5*T,L=[[a+.15*u,o+.7*l],[a+.3*u,o+.4*l],[a+.5*u,o+.6*l],[a+.6*u,o+.5*l],[a+.9*u,o+.8*l],[a+.15*u,o+.8*l]];if(t===Qt.CANVAS){r.strokeStyle="#CCC",r.lineWidth=T,r.fillStyle="#DDD",r.beginPath(),r.moveTo(a,o),r.lineTo(a+u,o),r.lineTo(a+u,o+l),r.lineTo(a,o+l),r.lineTo(a,o),r.stroke(),r.closePath(),r.beginPath(),r.arc(R,C,O,0,2*Math.PI),r.fill(),r.closePath(),r.beginPath(),r.moveTo(L[0][0],L[0][1]);for(var N=1,I=L.length;N<I;N++){var F=L[N];r.lineTo(F[0],F[1])}r.lineTo(L[0][0],L[0][1]),r.fill(),r.closePath()}else if(t===Qt.SVG){this.__addGeom("rect",[["x",a],["y",o],["width",u],["height",l],["stroke","#CCC"],["stroke-width",T],["fill","rgba(0,0,0,0)"]]),this.__addGeom("circle",[["cx",R],["cy",C],["r",O],["fill","#DDD"]]);for(var W="",D=0,B=L.length;D<B;D++){var H=L[D];D&&(W+=" "),W+=H[0]+","+H[1]}this.__addGeom("polygon",[["points",W],["fill","#DDD"]])}}else if(P.url===f){var z=P.source;if(z){var G,Y,X,$=Ie.calRadius(a,o,u,l,p,v,y,g,x,k,M,w);if(t===Qt.CANVAS)$?(r.save(),r.beginPath(),qi(r,$),r.clip(),r.closePath(),r.drawImage(z,a,o,u,l),r.restore()):r.drawImage(z,a,o,u,l);else if(t===Qt.SVG){if(P.cache)return P.cache.cache=!0,A.children=[P.cache],void(!A.cache&&$&&(G=Ui($),Y=i.add({tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",G],["fill","#FFF"]]}]}),A.conClip="url(#"+Y+")"));u===P.width&&l===P.height||(X=De.matrixResize(P.width,P.height,u,l,a,o,u,l));var j,q,U=[["xlink:href",f],["x",a],["y",o],["width",P.width],["height",P.height]];$&&(j=Ui($),q=i.add({tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",j],["fill","#FFF"]]}]}),A.conClip="url(#"+q+")",delete A.cache),X&&!re.equalArr(X,[1,0,0,1,0,0])&&U.push(["transform","matrix("+re.joinArr(X,",")+")"]);var V={type:"img",tagName:"image",props:U};A.children=[V],P.cache=V}}}else{var Z=this.__loadImg;Z.url=f,Z.source=null,Z.error=null,Z.cache=!1,Je.measureImg(f,function(t){var e,r,i,n,a=s;t.url!==Z.url||a.__isDestroyed||(t.success?(Z.source=t.source,Z.width=t.width,Z.height=t.height):Z.error=!0,e=a.root,i=(r=a.currentStyle).width,n=r.height,e.delRefreshTask(a.__task),i.unit!==ji&&n.unit!==ji?e.addRefreshTask(a.__task={__before:function(){a.isDestroyed||e.__addUpdate({node:a,focus:jr.REPAINT})}}):e.addRefreshTask(a.__task={__before:function(){a.isDestroyed||e.__addUpdate({node:a,focus:jr.REFLOW,img:!0})}}))},{width:u,height:l})}return h}},{key:"__releaseWhenEmpty",value:function(t){if(!this.__loadImg.error&&!this.__loadImg.source&&this.__loadImg.url!==this.props.src)return Q(J(K.prototype),"__releaseWhenEmpty",this).call(this,t)}},{key:"baseLine",get:function(){return this.height}}]),K}(),Zi=function(){function e(t){u(this,e),this.id=t,this.count=0,this.list=[]}return l(e,[{key:"add",value:function(t){return t.uuid="karas-defs-"+this.id+"-"+this.count++,this.list.push(t),t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(t){return new e(t)}}]),e}(),Ki=j.AUTO,Ji=j.PX,Qi=j.PERCENT,tn=re.int2rgba,en=re.isNil,rn={},nn=function(){e(P,xi);var a=f(P);function P(t,e){var r;u(this,P),(r=a.call(this,t,e)).__isMulti=!!r.props.multi,r.__isMask=!!r.props.mask;var i=s(r),n=i.style;return i.isMask&&(n.visibility="visible",n.background=null,n.border=null,n.strokeWidth=0,n.stroke=null),r.__style=Gt.normalize(r.style,nt.DOM_ENTRY_SET.concat(nt.GEOM_ENTRY_SET)),r.__currentStyle=re.extend({},r.__style),r.__currentProps=re.clone(r.props),r.__cacheProps={},r}return l(P,[{key:"__tryLayInline",value:function(t,e){var r=this.currentStyle.width;return r.unit===Ji?t-r.value:r.unit===Qi?t-e*r.value*.01:t}},{key:"__calAutoBasis",value:function(t){var e,r,i=0,n=0,a=0,o=this.currentStyle,s=this.computedStyle,h=o.width,u=o.height,l=s.borderTopWidth,c=s.borderRightWidth,f=s.borderBottomWidth,_=s.borderLeftWidth,d=t?h:u;return d.unit!==Ki&&(i=a+=d.value),t?(i+=e=c+_,a+=e,n+=e):(i+=r=l+f,a+=r,n+=r),{b:i,min:n,max:a}}},{key:"__layoutBlock",value:function(t,e){var r=this.__preLayout(t),i=r.fixedWidth,n=r.fixedHeight,a=r.w,o=r.h;this.__height=n?o:0,e?this.__width=i?a:0:(this.__width=a,this.__ioSize(a,this.height),this.__marginAuto(this.currentStyle,t),this.__cacheProps={})}},{key:"__layoutFlex",value:function(t){this.__layoutBlock(t)}},{key:"__layoutInline",value:function(t){var e=this.__preLayout(t),r=e.fixedWidth,i=e.fixedHeight,n=e.x,a=e.y,o=e.w,s=e.h,h=this.__width=r?o:n-t.x,u=this.__height=i?s:a-t.y;this.__ioSize(h,u),this.__cacheProps={}}},{key:"__calCache",value:function(r,t,i,n,e,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w,S){var A,E=this;return Q(J(P.prototype),"__calCache",this).call(this,r,t,i,n,e,a,o,s,h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w,S),["stroke","fill"].forEach(function(t){var e;en(a[t])&&(e=o[t],!(s[t]=e)||"linear"!==e.k&&"radial"!==e.k?a[t]=tn(o[t]):a[t]=E.__gradient(r,i,n,m,M,b,w,l,c,e))}),en(a.strokeWidth)&&(a.strokeWidth=!0,(A=o.strokeWidth).unit===Ji?s.strokeWidth=A.value:A.unit===Qi?s.strokeWidth=A.value*width*.01:s.strokeWidth=0),en(a.strokeDasharray)&&(a.strokeDasharray=!0,s.strokeDasharray=o.strokeDasharray,a.strokeDasharrayStr=re.joinArr(o.strokeDasharray,",")),["strokeLinecap","strokeLinejoin","strokeMiterlimit","fillRule"].forEach(function(t){s[t]=o[t]}),!0}},{key:"__preSet",value:function(){var t=this.sx,e=this.sy,r=this.width,i=this.height,n=this.__cacheStyle,a=this.computedStyle,o=a.borderTopWidth,s=a.borderLeftWidth,h=a.display,u=a.marginTop,l=a.marginLeft,c=a.paddingTop,f=a.paddingLeft,_=a.visibility,d=t+s+l+f,p=e+o+u+c,v=d+.5*r,y=p+.5*i,g=n.fill,m=n.stroke,b=n.strokeDasharrayStr,x=a.strokeWidth,k=a.strokeLinecap,M=a.strokeLinejoin,w=a.strokeMiterlimit;return{x:t,y:e,originX:d,originY:p,cx:v,cy:y,display:h,stroke:m,strokeWidth:x,strokeDasharray:a.strokeDasharray,strokeDasharrayStr:b,strokeLinecap:k,strokeLinejoin:M,strokeMiterlimit:w,fill:g,visibility:_,fillRule:a.fillRule}}},{key:"__preSetCanvas",value:function(t,e,r){var i=r.stroke,n=r.strokeWidth,a=r.strokeDasharray,o=r.strokeLinecap,s=r.strokeLinejoin,h=r.strokeMiterlimit,u=r.fill;t===Qt.CANVAS&&(e.fillStyle!==u&&(e.fillStyle=u),e.strokeStyle!==i&&(e.strokeStyle=i),e.lineWidth!==n&&(e.lineWidth=n),e.lineCap!==o&&(e.lineCap=o),e.lineJoin!==s&&(e.lineJoin=s),e.miterLimit!==h&&(e.miterLimit=h),re.isFunction(e.getLineDash)&&re.equalArr(e.getLineDash(),a)||e.setLineDash(a))}},{key:"render",value:function(t,e,r,i){var n=this.__renderSelfData||Q(J(P.prototype),"render",this).call(this,t,e,r,i),a=this.__cache,o=this.__cacheTotal,s=this.__cacheFilter,h=this.__cacheMask;if(e<jr.REPAINT&&(o&&o.available||a&&a.available||!jr.contain(e,jr.FILTER)&&s||h)&&(n.break=!0),t===Qt.SVG&&(this.virtualDom.type="geom"),n.break)return n;var u=this.__preSet(t,r,i),l=n.x2,c=n.y2,f=u.originX,_=u.originY,d=this.computedStyle;return l+=d.paddingLeft,c+=d.paddingTop,u.dx=l-f,u.dy=c-_,this.__preSetCanvas(t,r,u),Object.assign(n,u)}},{key:"__propsStrokeStyle",value:function(t,e,r,i,n){e&&t.push(["stroke-dasharray",e]),"butt"!==r&&t.push(["stroke-linecap",r]),"miter"!==i&&t.push(["stroke-linejoin",i]),4!==n&&t.push(["stroke-miterlimit",n])}},{key:"__cancelCache",value:function(t){Q(J(P.prototype),"__cancelCache",this).call(this,t),this.__cacheProps={}}},{key:"__releaseWhenEmpty",value:function(){}},{key:"addGeom",value:function(t,e){e=re.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"getProps",value:function(t){var e=this.currentProps[t];return en(e)?this["__"+t]:e}},{key:"baseLine",get:function(){return this.__height}},{key:"isMulti",get:function(){return this.__isMulti}},{key:"isMask",get:function(){return this.__isMask}},{key:"currentProps",get:function(){return this.__currentProps}}],[{key:"getRegister",value:function(t){if(!rn.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return rn[t]}},{key:"register",value:function(t,e){if(P.hasRegister(t))throw new Error("Geom has already register: ".concat(t));rn[t]=e}},{key:"hasRegister",value:function(t){return rn.hasOwnProperty(t)}}]),P}(),an=c.TYPE_VD,on=c.TYPE_GM,sn=c.TYPE_CP,hn=[],un=[],ln={};function cn(t){t instanceof Yi&&t.children.forEach(function(t){t instanceof Yi?cn(t):t instanceof Xi&&t.__hasUpdate&&(t.__hasUpdate=!1,fn(t,t.props))})}function fn(t,e,r){(t.__nextState||r)&&(!re.isFunction(t.shouldComponentUpdate)||t.shouldComponentUpdate(e,t.__nextState||t.state))?function(t,e,r){t.props=e,t.__state=r,t.__nextState=null;var i=t.shadow,n=t.shadowRoot,a=t.__cd,o=Ti.flattenJson(t.render());(function(t,e,r){var o=vn(e,{},t),s=vn(r,{}),h=[],u=[];Object.keys(o).forEach(function(t){var e=o[t];s[t]||(e.json.key=ln)}),Object.keys(s).forEach(function(t){var e,r,i,n=o[t],a=s[t];n?(e=n.json,r=a.json,i=n.vd,e.$$type===sn&&r.$$type===sn?e.klass===r.klass&&(pn(e,r,i),e.key=r.key=ln,u.push(i)):e.$$type===r.$$type&&e.tagName===r.tagName&&(r.$$type===on&&e.props.multi!==r.props.multi||(r.inherit=i),e.key=r.key=ln,r.$$type===an&&h.push({vd:i,oj:e,nj:r}))):a.json.key=ln}),h.forEach(function(t){dn(t.vd,t.oj,t.nj)}),_n(t,e,r),u.forEach(function(t){yn(t)})})(i,a,o),t.__init(o);var s=t.shadowRoot;s instanceof Gi&&["__outerWidth","__outerHeight","__sx","__sy","__sx2","__sx3","__sx4","__sy1","__sy2","__sy3","__sy4","__computedStyle"].forEach(function(t){s[t]=n[t]});["__x","__y","__width","__height","__sx1","__layoutData","__parent","__struct"].forEach(function(t){s[t]=n[t]}),hn.push(t),re.isObject(o)&&o.placeholder||un.push(i);o&&o.placeholder&&delete o.placeholder}(t,e,t.__nextState||t.state):cn(t.shadowRoot)}function _n(t,e,r){if(re.isObject(r))if(r.$$type===sn){if(r.key===ln)return;e.$$type===r.$$type&&e.klass===r.klass&&(pn(e,r,t),yn(t))}else r.$$type===on&&e.$$type===on?e.tagName===r.tagName&&e.props.multi===r.props.multi&&(r.inherit=t):r.$$type===an&&e.$$type===an&&(e.tagName===r.tagName&&(r.inherit=t),dn(t,e,r))}function dn(t,e,r){for(var i=e.children,n=r.children,a=i.length,o=n.length,s=t.children,h=0,u=0,l=0,c=Math.min(a,o);h<c;h++){var f=i[h+u],_=n[h+l];f.key===ln&&_.key===ln||(f.key===ln?(u++,h--,a--,c=Math.min(a,o)):_.key===ln?(l++,h--,o--,c=Math.min(a,o)):_n(s[h+u],f,_))}}function pn(n,a,o){a.placeholder=!0;var s=(a.value=o).shadowRoot,h={};Object.keys(n.props).forEach(function(t){var e=n.props[t];h[t]=e}),Object.keys(a.props).forEach(function(t){var e,r,i=a.props[t];/^on[a-zA-Z]/.test(t)?(n.props[t]=i,(e=h[t])?(delete h[t],e!==i&&(t=t.slice(2).toLowerCase(),s.listener[t]=i)):(t=t.slice(2).toLowerCase(),s.listener[t]=i)):/^on-[a-zA-Z\d_$]/.test(t)&&(n.props[t]=i,(r=h[t])?(delete h[t],r!==i&&(t=t.slice(2).toLowerCase(),o.off(t,h[t]),o.on(t,i)),delete h[t]):(t=t.slice(2).toLowerCase(),o.on(t,i)))}),Object.keys(h).forEach(function(t){var e=h[t];/^on[a-zA-Z]/.test(t)?(a.props[t]=e,t=t.slice(2).toLowerCase(),delete s.listener[t]):/^on-[a-zA-Z\d_$]/.test(t)&&(a.props[t]=e,t=t.slice(2).toLowerCase(),o.off(t,e))}),fn(o,a.props,!re.equal(n.props,a.props))}function vn(t,r,i){var e;return Array.isArray(t)?t.forEach(function(t,e){return vn(t,r,i&&i[e])}):re.isObject(t)&&(t.$$type!==an&&t.$$type!==on&&t.$$type!==sn||(t.$$type===an&&vn(t.children,r,i&&i.children),e=t.props.key,re.isNil(e)||""===e||(r.hasOwnProperty(e)&&console.error("Component "+i.tagName+" has duplicate key: "+e),r[e]={json:t,vd:i}))),r}function yn(t){if(t.host){var e=t.parent;if(e){var r=e.children.indexOf(t);if(!(-1<r))throw new Error("Can not find child: "+t.tagName);e.children[r]=null}}}var gn,mn={ref:function(t){Gi=t.Xom,Yi=t.Dom,t.Img,t.Geom,Xi=t.Component},updateList:hn,check:cn,checkCp:fn,did:function(){hn.forEach(function(t){re.isFunction(t.componentDidUpdate)&&t.componentDidUpdate()}),hn=[],un.forEach(function(t){t.__destroy()}),un=[]}},bn=re.joinVd,xn=re.joinDef;function kn(t,e,r){var i=t.childNodes;!function(t,e,r){for(var i=e.length,n=r.length,a=0,o=t.childNodes;a<Math.min(i,n);a++)!function(e,t,r){if(t.tagName!==r.tagName)Nn(e,"beforebegin",xn(r)),e.parentNode.removeChild(e);else{t.uuid!==r.uuid&&e.setAttribute("id",r.uuid);for(var i={},n=0,a=(t.props||[]).length;n<a;n++){var o=te(t.props[n],2),s=o[0],h=o[1];i[s]=h}for(var u=0,l=(r.props||[]).length;u<l;u++){var c=te(r.props[u],2),f=c[0],_=c[1];i.hasOwnProperty(f)?(i[f]!==_&&e.setAttribute(f,_),delete i[f]):e.setAttribute(f,_)}Object.keys(i).forEach(function(t){e.removeAttribute(t)});for(var d=e.childNodes,p=t.children.length,v=r.children.length,y=0;y<Math.min(p,v);y++)Tn(e,y,t.children[y],r.children[y]);if(y<p)for(var g=p-1;y<=g;g--)Ln(e,d,g);else if(y<v)for(;y<v;y++)On(e,d,y,bn(r.children[y]))}}(o[a],e[a],r[a]);if(a<i)for(var s=i-1;a<=s;s--)Ln(t,o,s);else if(a<n)for(;a<n;a++)On(t,o,a,xn(r[a]))}(i[0],e.defs,r.defs),r.hasOwnProperty("lv")||Pn(i[1],e.bb,r.bb,e.bbClip,r.bbClip),An(t,e,r,!0)}function Mn(t,e,r){"dom"===e.type?"dom"===r.type?An(t,e,r):"geom"===r.type?En(t,e,r):Cn(t,r):"text"===e.type?"text"===r.type?function(t,e,r){if(r.cache)return;for(var i=e.children.length,n=r.children.length,a=0;a<Math.min(i,n);a++)Tn(t,a,e.children[a],r.children[a],!0);var o=t.childNodes;if(a<i)for(var s=i-1;a<=s;s--)Ln(t,o,s);else if(a<n)for(;a<n;a++)On(t,o,a,bn(r.children[a]))}(t,e,r):Cn(t,r):"geom"===e.type?"dom"===r.type?En(t,e,r):"geom"===r.type?function(t,e,r){if(r.cache)return;wn(t,e,r),Pn(t.firstChild,e.bb,r.bb,e.bbClip,r.bbClip);for(var i=e.children.length,n=r.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(i,n);a++)Tn(o,a,e.children[a],r.children[a]);if(a<i)for(var h=i-1;a<=h;h--)Ln(o,s,h);else if(a<n)for(;a<n;a++)On(o,s,a,bn(r.children[a]))}(t,e,r):Cn(t,r):"img"===e.type&&("img"===r.type?Rn(t,e,r):Cn(t,r))}function wn(t,e,r){var i=r.transform,n=r.opacity,a=r.visibility,o=r.mask,s=r.filter,h=r.conClip;e.transform!==i&&(i?t.setAttribute("transform",i):t.removeAttribute("transform")),e.opacity!==n&&(1!==n&&void 0!==n?t.setAttribute("opacity",n):t.removeAttribute("opacity")),e.visibility!==a&&t.setAttribute("visibility",a),e.mask!==o&&(o?t.setAttribute("mask",o):t.removeAttribute("mask")),e.filter!==s&&(s?t.setAttribute("filter",s):t.removeAttribute("filter")),e.conClip!==h&&(h?t.childNodes[1].setAttribute("clip-path",h):t.childNodes[1].removeAttribute("clip-path"))}function Sn(t,e,r,i){var n,a,o,s;i!==jr.NONE&&(n=r.transform,a=r.opacity,o=r.mask,s=r.filter,jr.contain(i,jr.TRANSLATE_X|jr.TRANSLATE_Y|jr.TRANSFORM)&&(n?t.setAttribute("transform",n):t.removeAttribute("transform")),jr.contain(i,jr.OPACITY)&&(1!==a?t.setAttribute("opacity",a):t.removeAttribute("opacity")),jr.contain(i,jr.FILTER)&&(s?t.setAttribute("filter",s):t.removeAttribute("filter")),o?t.setAttribute("mask",o):t.removeAttribute("mask"),e.mask&&t.removeAttribute("mask"))}function An(t,e,r,i){if(r.cache)Sn(t,e,r,r.lv);else{r.hasOwnProperty("lv")?Sn(t,e,r,r.lv):(wn(t,e,r),i||Pn(t.firstChild,e.bb,r.bb,e.bbClip,r.bbClip));for(var n=e.children.length,a=r.children.length,o=0,s=t.lastChild,h=s.childNodes;o<Math.min(n,a);o++)Mn(h[o],e.children[o],r.children[o]);if(o<n)for(var u=n-1;o<=u;u--)Ln(s,h,u);else if(o<a)for(;o<a;o++)On(s,h,o,bn(r.children[o]))}}function En(t,e,r){wn(t,e,r),Pn(t.firstChild,e.bb,r.bb,e.bbClip,r.bbClip);for(var i=e.children.length,n=r.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(i,n);a++)Cn(s[a],r.children[a]);if(a<i)for(var h=i-1;a<=h;h--)Ln(o,s,h);else if(a<n)for(;a<n;a++)On(o,s,a,bn(r.children[a]))}function Pn(t,e,r,i,n){var a=e.length,o=r.length;i!==n&&(n?t.setAttribute("clip-path",n):t.removeAttribute("clip-path"));for(var s=0;s<Math.min(a,o);s++)Tn(t,s,e[s],r[s]);var h=t.childNodes;if(s<a)for(var u=a-1;s<=u;u--)Ln(t,h,u);else if(s<o)for(;s<o;s++)On(t,h,s,bn(r[s]))}function Tn(t,e,r,i,n){var a=t.childNodes;r.tagName!==i.tagName?Cn(a[e],i):(Rn(a[e],r,i),n&&r.content!==i.content&&(a[e].innerHTML=i.content))}function Rn(e,t,r){if(!r.cache){for(var i={},n=0,a=(t.props||[]).length;n<a;n++){var o=te(t.props[n],2),s=o[0],h=o[1];i[s]=h}for(var u=0,l=(r.props||[]).length;u<l;u++){var c=te(r.props[u],2),f=c[0],_=c[1];i.hasOwnProperty(f)?(i[f]!==_&&e.setAttribute(f,_),delete i[f]):e.setAttribute(f,_)}Object.keys(i).forEach(function(t){e.removeAttribute(t)})}}function Cn(t,e){var r;Array.isArray(e)?(r="",e.forEach(function(t){r+=bn(t)})):r=bn(e),Nn(t,"beforebegin",r),t.parentNode.removeChild(t)}function On(t,e,r,i){r>=e.length?Nn(t,"beforeend",i):Nn(e[r],"beforebegin",i)}function Ln(t,e,r){e[r]&&t.removeChild(e[r])}function Nn(t,e,r){if(t.insertAdjacentHTML)t.insertAdjacentHTML(e,r);else switch(e){case"beforeend":t.innerHTML+=r;break;case"beforebegin":(gn=gn||document.createElement("svg")).innerHTML=r,t.parentNode.insertBefore(gn.childNodes[0],t)}}var In=re.isFunction,Fn=function(){function t(){u(this,t),this.__records=[],this.__auto=[],this.__list=[]}return l(t,[{key:"add",value:function(t){-1===this.__list.indexOf(t)&&this.list.push(t)}},{key:"remove",value:function(t){var e=this.list.indexOf(t);-1<e&&this.list.splice(e,1)}},{key:"__destroy",value:function(){this.__records=[],this.__auto=[],this.__list=[]}},{key:"__action",value:function(e,r){this.list.forEach(function(t){t[e].apply(t,r)})}},{key:"init",value:function(t){var o=this,e=0<arguments.length&&void 0!==t?t:this.__records;e.length&&e.splice(0).forEach(function(t){var e,r,i,n=t.target,a=t.animate;Array.isArray(a)?a.forEach(function(t){var e=t.value,r=t.options;r.autoPlay=!1;var i=n.animate(e,r);o.add(i)}):(e=a.value,(r=a.options).autoPlay=!1,i=n.animate(e,r),o.add(i))})}},{key:"__playAuto",value:function(){this.init(this.__auto),this.__action("play")}},{key:"play",value:function(e){this.init();var r=!0;this.__action("play",[e&&function(t){r&&(r=!1,In(e)&&e(t))}])}},{key:"pause",value:function(){this.__action("pause")}},{key:"resume",value:function(e){var r=!0;this.__action("resume",[e&&function(t){r&&(r=!1,In(e)&&e(t))}])}},{key:"cancel",value:function(e){var r=!0;this.__action("cancel",[e&&function(t){r&&(r=!1,In(e)&&e(t))}])}},{key:"finish",value:function(e){var r=!0;this.__action("finish",[e&&function(t){r&&(r=!1,In(e)&&e(t))}])}},{key:"gotoAndStop",value:function(t,e,r){this.init();var i=!0;this.__action("gotoAndStop",[t,e,r&&function(t){i&&(i=!1,In(r)&&r(t))}])}},{key:"gotoAndPlay",value:function(t,e,r){this.init();var i=!0;this.__action("gotoAndPlay",[t,e,r&&function(t){i&&(i=!1,In(r)&&r(t))}])}},{key:"__set",value:function(e,r){this.list.forEach(function(t){t[e]=r})}},{key:"list",get:function(){return this.__list}},{key:"playbackRate",set:function(t){this.__set("playbackRate",t)}},{key:"iterations",set:function(t){this.__set("iterations",t)}},{key:"playCount",set:function(t){this.__set("playCount",t)}},{key:"fps",set:function(t){this.__set("fps",t)}},{key:"currentTime",set:function(t){this.__set("currentTime",t)}},{key:"spfLimit",set:function(t){this.__set("spfLimit",t)}},{key:"delay",set:function(t){this.__set("delay",t)}},{key:"endDelay",set:function(t){this.__set("endDelay",t)}},{key:"fill",set:function(t){this.__set("fill",t)}},{key:"direction",set:function(t){this.__set("direction",t)}}]),t}();function Wn(t,P,e,r,T,R){var C={},O=t.__sx1,L=t.__sy1,i=t.__cache,n=t.__blurValue,N=i&&i.available?i.bbox.slice(0):t.bbox,I=[e],F={index:n};for(R[e]=1;I.length;)I.splice(0).forEach(function(t){for(var e,r,i=t+1,n=t+(P[t].total||0)+1;i<n;i++){var a,o,s,h,u,l,c,f=P[i],_=f.node,d=_.__cacheTotal,p=_.__cache,v=_.__blurValue,y=_.__sx1,g=_.__sy1,m=_.__limitCache,b=_.computedStyle,x=b.display,k=b.visibility,M=b.transform,w=b.transformOrigin,S=b.opacity,A=f.node,E=f.total;if(m)return;"none"!==x?"hidden"!==k&&(T[i]=t,R[i]=R[t]*S,a=void 0,s=o=0,d&&d.available?(i+=E||0,a=d.bbox.slice(0),o=d.dbx,s=d.dby):p&&p.available?(a=p.bbox.slice(0),o=p.dbx,s=p.dby):a=A.bbox,a&&(c=C[t],h=(F[t]||0)+v,M&&!ee.isE(M)&&((u=w.slice(0))[0]+=y-O+o,u[1]+=g-L+s,l=ge.calMatrixByOrigin(M,u),c=c?ee.multiply(c,l):l),c&&(C[i]=c),a=re.transformBbox(a,c,h,h),E&&(F[i]=h,I.push(i)),N?(r=a,(e=N)[0]=Math.min(e[0],r[0]),e[1]=Math.min(e[1],r[1]),e[2]=Math.max(e[2],r[2]),e[3]=Math.max(e[3],r[3])):N=a)):i+=E||0}});if(!(N[2]-N[0]>Jr.MAX||N[3]-N[1]>Jr.MAX))return N;t.__limitCache=!0}var Dn={renderCacheCanvas:function(m,b,x,t){for(var k,M,w=t.__structs,i=t.width,n=t.height,S=[],A=[],E=1,P=[],T=0,R=0,e=w.length;R<e;R++)(function(t){var e,r,i,n,a,o,s,h,u,l=w[t],c=l.node,f=l.node,_=f.__cacheTotal,d=f.__cache,p=f.__refreshLevel,v=f.computedStyle,y=l.total,g=l.lv;c instanceof Xt?R=t:(0===t?P.push(c):T<g?(k=M.__matrixEvent,ee.isE(k)&&(k=null),S.push(k),E=M.__opacity,A.push(E),P.push(c)):g<T&&(e=T-g,S.splice(-1,e),k=S[g],A.splice(-1,e),E=A[g],P.splice(-1,e),M=P[g]),"none"===v.display?R=t+=y||0:(p<jr.REPAINT?(r=c.currentStyle,i=c.computedStyle,jr.contain(p,jr.TRANSFORM_ALL)&&(n=c.__cacheStyle,a=c.currentStyle,o=c.__matrix=c.__calMatrix(p,n,a,i),k&&(o=ee.multiply(k,o)),c.__matrixEvent=o),jr.contain(p,jr.OPACITY)&&(s=i.opacity=r.opacity,c.__opacity=E*s),jr.contain(p,jr.FILTER)&&(h=i.filter=r.filter,c.__blurValue=0,Array.isArray(h)&&h.forEach(function(t){var e=te(t,2),r=e[0],i=e[1];"blur"===r&&(c.__blurValue=i)}),u=c.bbox,(d=c.__cache=d?Jr.updateCache(d,u):Jr.getInstance(u)).enabled||console.warn("Downgrade for cache-filter change error")),_&&_.available&&(t+=y||0)):c instanceof nn?(c.__renderSelfData=c.__renderSelf(m,p,b,x,!0),c.__cache&&c.__cache.available&&c.render(m,p,c.__cache.ctx,x,!0)):c.render(m,p,b,x,!0),M=c,T=g,R=t))})(R);var r,a,o,s,h,u,l,c,f,_=function(_){for(var d=[0],p={0:{i:0}};d.length;)d.splice(0).forEach(function(t){for(var e,r=_[t],i=p[t],n=t+1,a=n+(r.total||0);n<a;n++){var o,s,h=_[n],u=h.node,l=h.total,c=h.node,f=c.__cacheTotal;"none"!==c.computedStyle.display?(o={i:n},s=s||o,e&&(o.p=e),e=o,u instanceof Xt||!l||(f&&f.available||(p[n]=o,d.push(n)),n+=l||0)):n+=l||0}i&&e&&(i.p&&(s.p=i.p),i.p=e)});for(var t=p[0],e=[];t;)e.push(t.i),t=t.p;return e.reverse()}(w);if(_.length)for(var d=Math.max(1,Jr.NUM),p=w[_[0]].lv,v=0,y={},g=0,C=_.length-1;g<C;g++){var O=w[_[g]],L=O.node,N=L.computedStyle,I=N.position,F=N.visibility,W=L.__cacheFilter,D=L.__cacheMask,B=L.__cacheTotal,H=L.__cache,z=L.__blurValue,G=O.node,Y=O.lv,X=O.index,$=O.total,j=O.hasMask;if(G instanceof Xt)p=Y,"hidden"!==F&&v++;else{var q=!G.__limitCache&&(("relative"===I||"absolute"===I)&&(G.__hasContent&&v||1<v)||j||0<z);if(q?(p=Y,v=1):Y<p?("hidden"!==F&&v++,v+=y[p=Y]||0,y[Y]=0,d<=v&&!G.__limitCache&&(v=1,q=!0)):p<Y?(p=Y,v&&(y[p-1]=v),v=0):"hidden"!==F&&v++,q){if(B&&B.available)continue;if(!(B=G.__cacheTotal=function(t,e,r,i,n,a,o){if(!e.__limitCache){var s={},h={},u={},l=Wn(e,n,r,0,s,u);if(l&&(a?a.reset(l):a=e.__cacheTotal=Jr.getInstance(l),a&&a.enabled)){var c=e.__sx1,f=e.__sy1;a.__appendData(c,f),a.__available=!0;var _=a,d=te(_.coords,2),p=d[0],v=d[1],y=_.ctx,g=_.dbx,m=_.dby;o&&o.available&&(y.globalAlpha=1,y.setTransform(1,0,0,1,0,0),Jr.drawCache(o,a));for(var b=r+1,x=r+(i||0)+1;b<x;b++){var k,M,w,S,A,E,P,T,R,C=n[b],O=C.node,L=C.total,N=C.node,I=N.__cacheMask,F=N.__cacheFilter,W=N.__cacheTotal,D=N.__cache,B=N.computedStyle,H=B.display,z=B.visibility,G=B.transform,Y=B.transformOrigin;"none"!==H?"hidden"!==z&&(T=h[k=s[b]],M=u[b],O instanceof Xt?(y.globalAlpha=u[k],w=h[k]||[1,0,0,1,0,0],y.setTransform(w[0],w[1],w[2],w[3],w[4],w[5]),O.render(t,0,y,null,p-c+g,v-f+m)):(G&&!ee.isE(G)&&(S=Y.slice(0),D&&D.available?(S[0]+=D.sx1,S[1]+=D.sy1):(S[0]+=O.__sx1,S[1]+=O.__sy1),A=-c+g+p,E=-f+m+v,S[0]+=A,S[1]+=E,P=ge.calMatrixByOrigin(G,S),T=T?ee.multiply(T,P):P),T&&(h[b]=T),(R=(R=I||F)||(W&&W.available?W:null))?b+=L||0:D&&D.available&&(R=D),R&&(y.globalAlpha=M,T?y.setTransform(T[0],T[1],T[2],T[3],T[4],T[5]):y.setTransform(1,0,0,1,0,0),Jr.drawCache(R,a)))):b+=L||0}return a}}}(m,G,X,$,w,B,H)))continue;0<z&&!W&&(l=G,c=B&&B.available?B:H,f=z,c&&c.available&&(l.__cacheFilter=Jr.genOffScreenBlur(c,f))),j&&!D&&(r=G,a=W||(B&&B.available?B:H),o=W,u=h=s=void 0,(a&&a.available||o)&&(h=(s=r.computedStyle).transform,u=s.transformOrigin,r.__cacheMask=Jr.drawMask(a,r.next,h,u)))}}}for(var U={},V={},Z={},K=0,J=w.length;K<J;K++){var Q=w[K],tt=Q.node,et=Q.total,rt=Q.hasMask,it=Q.node,nt=it.__cacheMask,at=it.__cacheFilter,ot=it.__cacheTotal,st=it.__cache,ht=it.__limitCache,ut=it.__blurValue,lt=it.computedStyle,ct=lt.display,ft=lt.visibility;if("none"!==ct)if(tt instanceof Xt){var _t=tt.parent,dt=_t.__opacity,pt=_t.matrixEvent,vt=_t.__refreshLevel;b.globalAlpha=dt,b.setTransform(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]),tt.render(m,vt,b,x)}else{var yt=tt.__opacity,gt=tt.matrixEvent,mt=nt||at;if(mt=mt||(ot&&ot.available?ot:null)){if(rt){for(var bt=K+(et||0)+1;rt--;)bt+=(w[bt].total||0)+1;K=bt-1}K+=et||0,Jr.draw(b,yt,gt,mt)}else{if(V.hasOwnProperty(K)&&(b=V[K].ctx),rt){for(var xt=K+(et||0)+1,kt=void 0,Mt=void 0;rt--;){var wt=w[xt],St=wt.total,At=wt.node.computedStyle,Et=At.display,Pt=At.visibility;"none"!==Et?("hidden"!==Pt&&(kt?Mt=xt:kt=Mt=xt),xt++):xt+=(St||0)+1}if(!kt){K+=et||0;continue}var Tt=Je.getCacheCanvas(i,n,"__$$mask1$$__"),Rt=Je.getCacheCanvas(i,n,"__$$mask2$$__");V[kt]=Rt,Z[Mt]={ctx:b,content:Tt,mask:Rt},b=Tt.ctx}var Ct,Ot,Lt,Nt,It,Ft,Wt=void 0;if(st&&st.available){if("hidden"===ft)continue;Jr.draw(b,yt,gt,st),ut&&(Wt={},(Ct=Je.getCacheCanvas(i,n,"__$$blur$$__")).ctx&&((Ot={ctx:b,blur:ut}).target=Ct,b=Ct.ctx,Wt.offScreen=Ot))}else if(ht){if(Wt=tt instanceof nn?tt.__renderSelfData=tt.__renderSelf(m,tt.__refreshLevel,b,x):tt.render(m,tt.__refreshLevel,b,x),"hidden"===ft)continue;var Dt,Bt=Wt.offScreen;Bt&&((U[Dt=K+(et||0)]=U[Dt]||[]).unshift(Bt),b=Bt.target.ctx),tt instanceof nn&&tt.render(m,tt.__refreshLevel,b,x)}U.hasOwnProperty(K)&&U[K].forEach(function(t){var e=Je.getCacheWebgl(i,n,"__$$blur$$__"),r=$e.gaussBlur(t.target,e,t.blur,i,n);t.ctx.drawImage(t.target.canvas,0,0),t.target.draw(),r.clear(),b=t.ctx}),Z.hasOwnProperty(K)&&(Nt=(Lt=Z[K]).ctx,It=Lt.content,Ft=Lt.mask,(b=It.ctx).globalCompositeOperation="destination-in",b.globalAlpha=1,b.setTransform(1,0,0,1,0,0),b.drawImage(Ft.canvas,0,0),Ft.draw(b),b.globalCompositeOperation="source-over",Ft.ctx.clearRect(0,0,i,n),(b=Nt).globalAlpha=1,b.setTransform(1,0,0,1,0,0),b.drawImage(It.canvas,0,0),It.draw(b),It.ctx.clearRect(0,0,i,n))}}else K+=et||0}},renderCanvas:function(t,i,e,r){for(var n=r.__structs,a=r.width,o=r.height,s={},h={},u={},l=0,c=n.length;l<c;l++){var f=n[l],_=f.node,d=f.total,p=f.hasMask,v=f.node.computedStyle;if(h.hasOwnProperty(l)&&(i=h[l].ctx),p){for(var y=l+(d||0)+1,g=void 0,m=void 0;p--;){var b=n[y],x=b.total,k=b.node.currentStyle,M=k.display,w=k.visibility;"none"!==M?("hidden"!==w&&(g?m=y:g=m=y),y++):y+=(x||0)+1}if(!g){l+=d||0;continue}var S=Je.getCacheCanvas(a,o,"__$$mask1$$__"),A=Je.getCacheCanvas(a,o,"__$$mask2$$__");h[g]=A,u[m]={ctx:i,content:S,mask:A},i=S.ctx}var E,P,T,R,C,O,L=void 0,L=_ instanceof nn?_.__renderSelfData=_.__renderSelf(t,_.__refreshLevel,i,e):_.render(t,_.__refreshLevel,i,e);"none"!==v.display?((E=L.offScreen)&&((s[P=l+(d||0)]=s[P]||[]).unshift(E),i=E.target.ctx),_ instanceof nn&&_.render(t,_.__refreshLevel,i,e),s.hasOwnProperty(l)&&s[l].forEach(function(t){var e=Je.getCacheWebgl(a,o,"__$$blur$$__"),r=$e.gaussBlur(t.target,e,t.blur,a,o);t.ctx.drawImage(t.target.canvas,0,0),t.target.draw(),r.clear(),i=t.ctx}),u.hasOwnProperty(l)&&(R=(T=u[l]).ctx,C=T.content,O=T.mask,(i=C.ctx).globalCompositeOperation="destination-in",i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),i.drawImage(O.canvas,0,0),O.draw(i),i.globalCompositeOperation="source-over",O.ctx.clearRect(0,0,a,o),(i=R).globalAlpha=1,i.setTransform(1,0,0,1,0,0),i.drawImage(C.canvas,0,0),C.draw(i),C.ctx.clearRect(0,0,a,o))):l+=d||0}},renderSvg:function(z,G,Y,t){for(var X,$,j,q=t.__structs,U={},V=[],Z=[],K=0,J=0,e=q.length;J<e;J++)(function(t){var e,r,i,n=q[t],h=n.node,a=n.node,o=a.__cacheTotal,s=a.__refreshLevel,u=n.total,l=n.lv,c=n.hasMask;c&&(U[(r=(e=t+(u||0)+1)+c)-1]={index:t,start:e,end:r}),l<K?(V.splice(l),X=V[l-1],Z.splice(l),$=Z[l-1]):K<l&&(V.push(j.__matrix),i=j.virtualDom,Z.push(i),$=i);var f,_,d,p,v,y,g,m=void 0;if(s<jr.REPAINT?(m=h.virtualDom,o&&o.available?(t+=u||0,m.cache=!0):(o&&(o.available=!0),m=h.__virtualDom=re.extend({},m),h instanceof $i&&!(h instanceof Vi)&&(m.children=[]),delete m.cache),f=h.currentStyle,_=h.computedStyle,jr.contain(s,jr.TRANSFORM_ALL)&&(d=h.__cacheStyle,p=h.currentStyle,v=h.__matrix=h.__renderMatrix=h.__calMatrix(s,d,p,_),ee.isE(v)?delete m.transform:m.transform="matrix("+re.joinArr(v,",")+")",X&&(v=ee.multiply(X,v)),h.__matrixEvent=v),jr.contain(s,jr.OPACITY)&&(1===(y=_.opacity=f.opacity)?delete m.opacity:m.opacity=y),jr.contain(s,jr.FILTER)&&(g=_.filter=f.filter,delete m.filter,Array.isArray(g)&&g.forEach(function(t){var e,r,i,n,a=te(t,2),o=a[0],s=a[1];"blur"===o&&0<s&&(e=ee.int2convolution(s),r=h.outerWidth,i=h.outerHeight,n=Y.add({tagName:"filter",props:[["x",-e/r],["y",-e/i],["width",1+2*e/r],["height",1+2*e/i]],children:[{tagName:"feGaussianBlur",props:[["stdDeviation",s]]}]}),m.filter="url(#"+n+")")})),m.lv=s):(h instanceof nn&&(h.__renderSelfData=h.__renderSelf(z,s,G,Y)),h.render(z,s,G,Y),m=h.virtualDom),"none"===h.computedStyle.display)return K=l,j=h,J=t+=u||0;if(U.hasOwnProperty(t))for(var b=U[t],x=b.index,k=b.start,M=b.end,w=q[x].node,S=[],A=k;A<M;A++){var E=q[A].node,P=E.computedStyle,T=P.display,R=P.visibility,C=E.virtualDom.children;if("none"!==T&&"hidden"!==R){S=S.concat(C);for(var O=0,L=C.length;O<L;O++){var N,I,F,W=C[O],D=W.tagName,B=W.props;"path"===D&&(I=E.renderMatrix,N=ee.inverse(w.renderMatrix),I=ee.multiply(I,N),(F=B.length)&&"transform"===B[F-1][0]?B[F-1][1]="matrix(".concat(I,")"):B.push(["transform","matrix(".concat(I,")")]))}}var H="url(#"+(H=Y.add({tagName:"mask",props:[],children:S}))+")";w.virtualDom.mask=H}$&&!h.isMask&&$.children.push(m),0===t&&(X=h.__matrix,$=m),K=l,j=h,J=t})(J)}},Bn=re.isNil,Hn=re.isObject,zn=re.isFunction,Gn=j.AUTO,Yn=j.PX,Xn=j.PERCENT,$n=Gt.calRelative,jn=Gt.isRelativeOrAbsolute;function qn(t,e,r){var i=t.currentStyle[r],n=t.computedStyle[r];if(i.unit===Yn)return i.value===n;if(i.unit!==Xn)return!1;var a=t.domParent.layoutData["width"===r?"w":"h"];return i.value*a*.01===n}function Un(t){return qn(t,0,"width")&&qn(t,0,"height")}var Vn=1;function Zn(t,e){return t.hasOwnProperty("__uniqueReflowId")&&e[t.__uniqueReflowId]>=Vn}function Kn(t,e,r){var i,n,a;n=e,a=r,(i=t).hasOwnProperty("__uniqueReflowId")||(i.__uniqueReflowId=Jn,n[Jn++]={node:i,lv:Vn,component:a}),e[t.__uniqueReflowId].lv|=Vn}var Jn=0;var Qn=0;function ta(t,e,r,n,i,a,o,s,h,u){var l=n.node,c=n.style,f=n.origin,_=n.overwrite,d=n.focus,p=n.img,v=n.component,y=n.measure,g=n.list;if(!l.isDestroyed){f&&c&&(c=Gt.normalize(c)),_&&c&&Object.assign(l.__style,c),c&&c!==n.style&&(n.style=c),g&&g.forEach(function(t){var e=t.style,r=t.origin,i=t.overwrite;r&&e&&(e=Gt.normalize(e)),i&&e&&Object.assign(l.__style,e),e&&Object.assign(n.style,e)}),c=n.style;var m,b,x,k,M,w=l.tagName,S=l.currentStyle,A=l.currentProps,E=l.__cacheStyle,P=l.__cacheProps,T=jr.NONE,R=y;if(!v)for(var C in c)if(c.hasOwnProperty(C)){var O=c[C];if(Ot.isGeom(w,C))Gt.equalStyle(C,O,A[C],l)||((m=m||{})[C]=c[C],T|=jr.REPAINT,P[C]=void 0);else if(!Gt.equalStyle(C,O,S[C],l))if(Ot.isIgnore(C))E[C]=void 0,S[C]=O;else{if({top:!0,right:!0,bottom:!0,left:!0}.hasOwnProperty(C)&&"relative"!==S.position&&"absolute"!==S.position){delete c[C];continue}T|=jr.getLevel(C),Ot.isMeasure(C)&&(R=!0),E[C]=void 0,S[C]=O,"zIndex"===C&&l!==e&&(b=!0),"visibility"===C&&(x=!0),"color"===C&&(k=!0)}}if(m&&Object.assign(A,m),c&&Object.assign(S,c),Bn(d)||(T|=d),T!==jr.NONE||v){if(b&&delete l.domParent.__zIndexChildren,x||k)for(var L=e.__structs,N=l.__struct,I=N.index+1,F=I+N.total;I<F;I++){var W=L[I],D=W.node,B=W.node.currentStyle,H=W.total,z=void 0;x&&(D instanceof Xt||B.visibility.unit===j.INHERIT)&&(z=!0),k&&(D instanceof Xt||B.color.unit===j.INHERIT)&&(z=!0),z?(D.__refreshLevel|=jr.REPAINT,D.__cache&&D.__cache.release(),D.__cacheTotal&&D.__cacheTotal.release(),D.__cacheMask&&(D.__cacheMask=null),D.__cacheFilter&&(D.__cacheFilter=null)):I+=H||0}if(l.isMask){for(var G=l.prev;G&&G.isMask;)G=G.prev;G&&G.__cacheMask&&(G.__cacheMask=null)}!v&&jr.isRepaint(T)?(b&&t===Qt.SVG&&(T|=jr.REPAINT,ea(l.domParent)),Bn(d)||(T|=d),b&&!v&&h&&((M=l.domParent).hasOwnProperty("__uniqueZId")||(h[Qn]=!0,M.__uniqueZId=Qn++,u.push(M)))):(i.push({node:l,style:c,img:p,component:v}),R&&a.push(l)),l.__refreshLevel=T;var Y=l.__refreshLevel>=jr.REPAINT||t===Qt.SVG&&l instanceof nn;Y&&(l.__cache&&l.__cache.release(),l.__cacheTotal&&l.__cacheTotal.release(),l.__cacheMask&&(l.__cacheMask=null)),(Y||jr.contain(T,jr.FILTER))&&l.__cacheFilter&&(l.__cacheFilter=null);for(var X=l.domParent;X;){if(X.hasOwnProperty("__uniqueUpdateId")){var $=X.__uniqueUpdateId;if(o.hasOwnProperty($))break;o[$]=!0}else o[Qn]=!0,X.__uniqueUpdateId=Qn++,s.push(X);X.__refreshLevel>=jr.REPAINT&&X.__cache&&X.__cache.release(),X.__cacheTotal&&X.__cacheTotal.release(),X.__cacheFilter&&(X.__cacheFilter=null),X.__cacheMask&&(X.__cacheMask=null),X=X.domParent}return!0}delete l.__uniqueUpdateId}}function ea(t,e){e?t.__refreshLevel|=jr.REPAINT:t.__cacheTotal.release(),Array.isArray(t.children)&&t.children.forEach(function(t){t instanceof Ni&&(t=t.shadowRoot),t instanceof Xt||ea(t,!0)})}var ra=0,ia=function(){e(a,$i);var n=f(a);function a(t,e,r){var i;return u(this,a),(i=n.call(this,t,e)).__cd=r||[],i.__dom=null,i.__mw=0,i.__mh=0,i.__task=[],i.__ref={},i.__updateList=[],i.__updateHash={},i.__reflowList=[{node:s(i)}],i.__animateController=new Fn,rr.mix(s(i)),i}return l(a,[{key:"__initProps",value:function(){var t,e=this.props.width;Bn(e)||0<(t=parseFloat(e)||0)&&(this.__width=t);var r,i=this.props.height;Bn(i)||0<(r=parseFloat(i)||0)&&(this.__height=r)}},{key:"__genHtml",value:function(){var a=this,o="<".concat(this.tagName);return Object.keys(this.props).forEach(function(t){var e,r,i,n=a.props[t];/^on[a-zA-Z]/.test(t)||(o+=(e=t,r=n,i=Array.isArray(r)?re.joinSourceArray(r):re.stringify(r),"className"===e&&(e="class")," "+e+'="'+re.encodeHtml(i,!0)+'"'))}),o+="></".concat(this.tagName,">")}},{key:"__wrapEvent",value:function(t){var e,r,i,n,a,o,s,h,u,l,c,f,_;return-1===["touchend","touchcancel"].indexOf(t.type)&&(e=this.dom,r=this.__scx,i=this.__scy,a=(n=e.getBoundingClientRect()).x,o=n.y,s=n.left,h=n.top,u=n.width,l=n.height,c=a||s||0,f=o||h||0,c=(_=t.touches?t.touches[0]:t).clientX-c,f=_.clientY-f,Bn(r)?c*=this.width/u:c/=r,Bn(i)?f*=this.height/l:f/=i),{event:t,stopPropagation:function(){this.__stopPropagation=!0,t.stopPropagation()},stopImmediatePropagation:function(){this.__stopPropagation=!0,this.__stopImmediatePropagation=!0,t.stopImmediatePropagation()},preventDefault:function(){t.preventDefault()},x:c,y:f,__hasEmitted:!1}}},{key:"__cb",value:function(t){if("touchmove"!==t.type||this.__touchstartTarget){var e=this.__wrapEvent(t);return this.__emitEvent(e),e}}},{key:"appendTo",value:function(t){var e,i;t=function(t){if(re.isString(t)&&t){var e=document.querySelector(t);if(!e)throw new Error("Can not find dom of selector: "+t);return e}if(!t)throw new Error("Can not find dom: "+t);return t}(t),this.__children=Ti.initRoot(this.__cd,this),this.__initProps(),(this.__root=this).cache=!!this.props.cache,t.nodeName.toUpperCase()===this.tagName.toUpperCase()?(this.__dom=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__dom=t.querySelector(this.tagName),this.__dom||(t.innerHTML=this.__genHtml(),this.__dom=t.querySelector(this.tagName))),this.__uuid=Bn(this.__dom.__uuid)?ra++:this.__dom.__uuid,this.__defs=this.dom.__defs||Zi.getInstance(this.__uuid),this.width&&this.height||(e=window.getComputedStyle(t,null),this.width||(this.__width=parseFloat(e.getPropertyValue("width"))||0,t.setAttribute("width",this.width)),this.height||(this.__height=parseFloat(e.getPropertyValue("height"))||0,t.setAttribute("height",this.height))),"canvas"===this.tagName?(this.__ctx=this.__dom.getContext("2d"),this.__renderMode=Qt.CANVAS):"svg"===this.tagName&&(this.__renderMode=Qt.SVG),this.refresh(null,!0),this.dom.__root?this.dom.__root.destroy():(i=this.dom,["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"].forEach(function(r){i.addEventListener(r,function(t){var e=i.__root;-1<["touchend","touchcancel","touchmove"].indexOf(r)?e.__touchstartTarget&&e.__touchstartTarget.__emitEvent(e.__wrapEvent(t),!0):e.__cb(t)})}),this.dom.__uuid=this.__uuid),this.dom.__root=this}},{key:"refresh",value:function(e,t){var r=this;this.__hookTask=null;var i=this.isDestroyed,n=this.renderMode,a=this.ctx,o=this.defs,s=this.width,h=this.height;if(!i){if(o.clear(),t)this.__checkRoot(s,h),this.__computeMeasure(n,a);else if(!this.__checkUpdate(n,a,s,h))return;Je.measureText(function(){var t;r.__checkReflow(s,h),n===Qt.CANVAS?(r.__clear(a),r.cache?Dn.renderCacheCanvas(n,a,o,r):Dn.renderCanvas(n,a,o,r)):n===Qt.SVG&&(Dn.renderSvg(n,a,o,r),(t=r.virtualDom).defs=o.value,r.dom.__root?kn(r.dom,r.dom.__vd,t):r.dom.innerHTML=re.joinVirtualDom(t),r.dom.__vd=t,r.dom.__defs=o),zn(e)&&e(),r.emit(rr.REFRESH)})}}},{key:"destroy",value:function(){this.__destroy(),or.offFrame(this.__rTask);var t=this.dom;t&&(t.__root=null)}},{key:"scale",value:function(t,e){var r=0<arguments.length&&void 0!==t?t:1,i=1<arguments.length&&void 0!==e?e:r;this.__scx=r,this.__scy=i}},{key:"addRefreshTask",value:function(t){var a,o,s=this;t&&((a=this.task).length||or.nextFrame(this.__rTask={__before:function(r){var i,t,e,n;(o=a.splice(0)).length&&(i=[],o.forEach(function(t,e){Hn(t)&&zn(t.__before)&&(t.__state&&i.push(e),t.__before(r))}),i.length&&mn.check(s),mn.updateList.length?(mn.updateList.forEach(function(t){var e=t.shadowRoot;e instanceof Xt&&(e=e.domParent),s.__addUpdate({node:e,style:e.currentStyle,focus:jr.REFLOW,measure:!0,component:!0})}),s.refresh()):o.length>i.length&&s.refresh(),!(t=s.__hookTask)||-1<(n=(e=or.__hookTask).indexOf(t))&&e.splice(n,1),mn.did())},__after:function(e){o.forEach(function(t){Hn(t)&&zn(t.__after)?t.__after(e):zn(t)&&t(e)})}}),-1===a.indexOf(t)&&a.push(t))}},{key:"delRefreshTask",value:function(t){if(t){for(var e=this.task,r=0,i=e.length;r<i;r++)if(e[r]===t){e.splice(r,1);break}e.length||or.offFrame(this.__rTask)}}},{key:"__checkRoot",value:function(t,e){var r=this.currentStyle,i=this.computedStyle;-1===["flex","block"].indexOf(r.display)&&(i.display=r.display="block"),"absolute"===r.positoin&&(i.position=r.positoin="static"),r.width={value:t,unit:Yn},r.height={value:e,unit:Yn},i.width=t,i.height=e,Gt.computeMeasure(this,!0)}},{key:"__addUpdate",value:function(t){var e,r,i,n,a,o,s,h,u=this.__updateHash,l=t.node;l===this?(e=this.__updateRoot)?(t.img&&(e.img=t.img),t.focus&&(e.focus=t.focus),t.measure&&(e.measure=!0),e.list=e.list||[],e.list.push({style:t.style,origin:t.origin,overwrite:t.overwrite})):this.__updateRoot=t:l.hasOwnProperty("__uniqueUpdateId")?u.hasOwnProperty(l.__uniqueUpdateId)?(r=t.style,i=t.origin,n=t.overwrite,a=t.focus,o=t.img,s=t.measure,h=u[l.__uniqueUpdateId],o&&(h.img=o),a&&(h.focus=a),s&&(h.measure=!0),h.list=h.list||[],h.list.push({style:r,origin:i,overwrite:n})):console.error("Update process miss uniqueUpdateId"):(l.__uniqueUpdateId=Qn,u[Qn++]=t)}},{key:"__checkUpdate",value:function(s,h,t,e){var r,u=this,i=[],n=[],a={},o=[],l={},c=[],f=this.__updateRoot,_=this.__updateHash,d=this;f&&(this.__updateRoot=null,r=ta(s,d,0,f,n,i,a,o),this.__checkRoot(t,e));var p=Object.keys(_);p.forEach(function(t){var e=ta(s,u,0,_[t],n,i,a,o,l,c);r=r||e}),this.__reflowList=n,Qn=0,this.__updateHash={},o.forEach(function(t){delete t.__uniqueUpdateId}),c.forEach(function(t){t.hasOwnProperty("__uniqueZId")&&(delete t.__uniqueZId,t.__updateStruct(d.__structs))});var v={};return i.forEach(function(t){var e=t.__uniqueUpdateId,r=t.domParent;if(!v.hasOwnProperty(e)){v[e]=!0;var i=t;if(Ot.isMeasureInherit(_[e].style))for(;r&&r!==u;){var n,a=r.__uniqueUpdateId,o=r.currentStyle;if(!(r.hasOwnProperty("__uniqueUpdateId")?(n=_[a].style,v[a]=!0,!!Ot.measureInheritList(n).length):Ot.isMeasureInherit(o)))break;r=(i=r).domParent}i.__computeMeasure(s,h,function(t){t.hasOwnProperty("__uniqueUpdateId")&&(v[t.__uniqueUpdateId]=!0)})}}),p.forEach(function(t){delete _[t].node.__uniqueUpdateId}),r}},{key:"__checkReflow",value:function(t,e){var ot=this,r=this.__reflowList;if(r.length){for(var i,st=this,ht={},n=Jn=0,a=r.length;n<a;n++){var o=r[n],s=o.node,h=o.style,u=o.img,l=o.component;if(s===this){i=!0;break}var c=s.currentStyle,f=s.computedStyle;s.hasOwnProperty("__uniqueReflowId")||(s.__uniqueReflowId=Jn,ht[Jn++]={node:s,lv:0,img:u,component:l});var _=ht[s.__uniqueReflowId];if("absolute"===c.position&&"absolute"===f.position)_.lv=Vn;else if(c.position!==f.position){if(_.lv=Vn,A(s,l,!0)){i=!0;break}}else{var d=!0;if(h)for(var p=Object.keys(h),v=0,y=p.length;v<y;v++){var g=p[v];if("left"!==g&&"top"!==g&&"right"!==g&&"bottom"!==g){d=!1;break}}if(!d||u||l){if(_.lv=Vn,A(s,l)){i=!0;break}}else"relative"===f.position&&(_.lv|=0)}}if(Jn=0,this.__reflowList=[],i)return r.forEach(function(t){return delete t.node.__uniqueReflowId}),this.__layout({x:0,y:0,w:t,h:e}),this.__layoutAbs(this,{x:0,y:0,w:t,h:e}),this.__structs=this.__structure(0,0),!0;var m=[];this.deepScan(function(t,e){if(t.hasOwnProperty("__uniqueReflowId")){var r,i=ht[t.__uniqueReflowId];return delete t.__uniqueReflowId,i.lv>=Vn||(r=[],t.deepScan(function(t,e){},{uniqueList:r}),r.forEach(function(t){e.uniqueList.push(t)})),e.uniqueList.push(i),!0}},{uniqueList:m});var ut=[],lt=0;m.forEach(function(t){var e=t.node,r=t.lv,i=t.component;if(Vn<=r){var n=e.computedStyle,a=e.currentStyle,o=n.zIndex,s=n.position,h=n.display,u="absolute"===s,l="absolute"===a.position,c="none"===h,f="none"===a.display;if(c&&f)return;for(var _=e.domParent,d=_.layoutData,p=d.x,v=d.y,y=(d.w,d.h),g=_.width,m=_.computedStyle,b=e;i&&b.isShadowRoot;)b=b.host;var x=b.prev;x?(v=x.y,v+=x.outerHeight):(v=_.y,v+=m.marginTop+m.borderTopWidth+m.paddingTop),p+=m.marginLeft+m.borderLeftWidth+m.paddingLeft;var k,M=e.outerWidth,w=e.outerHeight,S=e;if(l){for(S=S.domParent;S&&S!==st&&!jn;)if(S.parent)S=S.parent;else if(S.host)break;if(S=S||st,_.__layoutAbs(S,null,e),u)return;k=!0}else e.__layout({x:p,y:v,w:g,h:y}),e instanceof $i&&(!e.parent&&e.host&&(S=e),e.__layoutAbs(S,{x:p,y:v,w:g,h:y}));var A,E,P,T,R="absolute"===e.computedStyle.position;T=k?(A=-M,-w):(E=e.outerWidth,P=e.outerHeight,R?(A=E,P):(A=E-M,P-w));for(var C,O,L=e;L&&L!==st;)if("relative"===(m=(L=L.domParent).computedStyle).position){var N=L.ox,I=L.oy;N&&e.__offsetX(N),I&&e.__offsetY(I);break}if(A||T){for(var F,W=e;;){for(;W.isShadowRoot;)W=W.host;for(var D=(F=W).next;D;)"absolute"===D.currentStyle.position?D.currentStyle.top.unit===Gn&&D.currentStyle.bottom.unit===Gn&&(D.__offsetY(T,!0,jr.REFLOW),D.__cancelCache()):(!D.hasOwnProperty("____uniqueReflowId")||ht[D.____uniqueReflowId]<Vn)&&(D.__offsetY(T,!0,jr.REFLOW),D.__cancelCache()),D=D.next;if((W=W.parent)===st)break;var B,H=W.currentStyle,z="absolute"===H.positoin;if(A&&(B=void 0,z&&(H.width.unit!==Gn||H.left.unit!==Gn&&H.right.unit!==Gn||(B=!0)),B&&(W.__resizeX(A),W.__cancelCache(),W.__refreshLevel|=jr.REFLOW)),T){var G=void 0;if(z?H.height.unit!==Gn||H.top.unit!==Gn&&H.bottom.unit!==Gn||(G=!0):H.height.unit===Gn&&(G=!0),!G)break;W.__resizeY(T),W.__cancelCache(),W.__refreshLevel|=jr.REFLOW}}for(;F;)F.__cancelCache(),F=F.domParent}i?(C=e.__modifyStruct(st,lt),lt+=C[1],ut.push(C),(s===a.position||"static"!==s&&"static"!==a.position)&&o===a.zIndex||(e.domParent.__updateStruct(st.__structs),ot.renderMode===Qt.SVG&&ea(e.domParent))):(c||f)&&(e.__zIndexChildren=null,O=e.__modifyStruct(st,lt),lt+=O[1],ut.push(O))}else{var Y=e.currentStyle,X=Y.top,$=Y.right,j=Y.bottom,q=Y.left,U=e.currentStyle,V=e.computedStyle,Z=V.top,K=V.right,J=V.bottom,Q=V.left,tt=e.computedStyle,et=e===ot?e:e.domParent,rt=0;X.unit!==Gn?(rt=$n(U,"top",X,et),tt.top=rt,tt.bottom="auto"):j.unit!==Gn?(rt=-$n(U,"bottom",j,et),tt.bottom=-rt,tt.top="auto"):tt.top=tt.bottom="auto";var it=0;"auto"!==Z?it=Z:"auto"!==J&&(it=-J),rt!==it&&e.__offsetY(rt-it,!1,jr.REFLOW);var nt=0;q.unit!==Gn?(nt=$n(U,"left",q,et),tt.left=nt,tt.right="auto"):$.unit!==Gn?(nt=-$n(U,"right",$,et),tt.right=-nt,tt.left="auto"):tt.left=tt.right="auto";var at=0;"auto"!==Q?at=Q:"auto"!==K&&(at=-K),nt!==at&&e.__offsetX(nt-at,!1,jr.REFLOW)}});var b=0,x=0,k=!0,M=st.__structs;ut.forEach(function(t){var e=te(t,2),r=e[0],i=e[1];if(k)k=!1,x=r.index+r.total+1,b+=i;else{for(var n=r.index+r.total+1+b,a=x;a<n;a++)M[a].index+=b;x=n,b+=i}});for(var w=x,S=M.length;w<S;w++)M[w].index+=b;r.forEach(function(t){return delete t.node.__uniqueReflowId})}function A(t,e,r){if(!Un(t)||r){var i=t;if("inline"===t.currentStyle.display||"inline"===t.computedStyle.display){var n=t.domParent;do{if((i=n)===st)return 1;if(Zn(n,ht))return;if("absolute"===n.currentStyle.position||"absolute"===n.computedStyle.position)return void Kn(n,ht,e);if(Un(n))return void Kn(n,ht,e);n=n.domParent}while(n&&("inline"===n.currentStyle.display||"inline"===n.computedStyle.display));if(Un(i))return void Kn(i,ht,e)}var a=i.domParent;if(!a||!Zn(a,ht)){if(a&&("flex"===a.computedStyle.display||"flex"===a.currentStyle.display)){do{if((i=a)===st)return 1;if(Zn(a,ht))return;if("absolute"===a.currentStyle.position||"absolute"===a.computedStyle.position)return void Kn(a,ht,e);if(Un(a))return void Kn(a,ht,e);a=a.domParent}while(a&&("flex"===a.computedStyle.display||"flex"===a.currentStyle.display));if(Un(i))return void Kn(i,ht,e)}(a=i.domParent)&&Zn(a,ht)||i!==t&&Kn(i,ht,e)}}}}},{key:"__computeMeasure",value:function(e,r){Gt.computeMeasure(this,!0),this.children.forEach(function(t){t.__computeMeasure(e,r)})}},{key:"__frameHook",value:function(){var t,e=this;this.__hookTask||(t=this.__hookTask=function(){e.refresh()},or.__hookTask.push(t))}},{key:"__clear",value:function(t){this.__mw=Math.max(this.__mw,this.width),this.__mh=Math.max(this.__mh,this.height),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.__mw,this.__mh)}},{key:"dom",get:function(){return this.__dom}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"ctx",get:function(){return this.__ctx}},{key:"defs",get:function(){return this.__defs}},{key:"task",get:function(){return this.__task}},{key:"ref",get:function(){return this.__ref}},{key:"animateController",get:function(){return this.__animateController}}]),a}(),na=re.isNil;function aa(t,e,r,i){return i?t.map(function(t){return e+t*r}):e+t*r}function oa(t,e){var r=0;return 2<=t.length&&r++,2<=e.length&&(r+=2),r}function sa(t){return t<0?t=0:1<t&&(t=1),t}function ha(t,e,r,i,n,a,o,s,h){var u,l,c,f,_,d,p,v,y,g,m,b=7<arguments.length&&void 0!==s?s:0,x=8<arguments.length&&void 0!==h?h:1;return(0<b||x<1)&&(3===o?(u=te(ie.sliceBezier2Both([[t,e],n,a,[r,i]],b,x),4),t=(l=te(u[0],2))[0],e=l[1],n=u[1],a=u[2],r=(c=te(u[3],2))[0],i=c[1]):2===o?(f=te(ie.sliceBezier2Both([[t,e],a,[r,i]],b,x),3),t=(_=te(f[0],2))[0],e=_[1],a=f[1],r=(d=te(f[2],2))[0],i=d[1]):1===o?(p=te(ie.sliceBezier2Both([[t,e],n,[r,i]],b,x),3),t=(v=te(p[0],2))[0],e=v[1],n=p[1],r=(y=te(p[2],2))[0],i=y[1]):(t+=(g=Math.abs(t-r))*b,e+=(m=Math.abs(e-i))*b,r-=g*(1-x),i-=m*(1-x))),[t,e,r,i,n,a]}var ua=function(){e(B,nn);var h=f(B);function B(t,e){var r,i,n,a;if(u(this,B),(r=h.call(this,t,e)).isMulti){if(r.__x1=[0],r.__y1=[0],r.__x2=[1],r.__y2=[1],r.__controlA=[[]],r.__controlB=[[]],r.__start=[0],r.__end=[1],Array.isArray(e.x1)?r.__x1=e.x1.map(function(t){return parseFloat(t)||0}):na(e.x1)||(r.__x1=[parseFloat(e.x1)||0]),Array.isArray(e.y1)?r.__y1=e.y1.map(function(t){return parseFloat(t)||0}):na(e.y1)||(r.__y1=[parseFloat(e.y1)||0]),Array.isArray(e.x2)?r.__x2=e.x2.map(function(t){return parseFloat(t)||0}):na(e.x2)||(r.__x2=[parseFloat(e.x2)||0]),Array.isArray(e.y2)?r.__y2=e.y2.map(function(t){return parseFloat(t)||0}):na(e.y2)||(r.__y2=[parseFloat(e.y2)||0]),Array.isArray(e.controlA)&&(r.__controlA=e.controlA.map(function(t){return Array.isArray(t)?t:[]})),Array.isArray(e.controlB)&&(r.__controlB=e.controlB.map(function(t){return Array.isArray(t)?t:[]})),Array.isArray(e.start)){r.__start=e.start.map(function(t){return sa(parseFloat(t)||0)});for(var o=r.__start.length;o<r.__x1.length;o++)r.__start.push(0)}else{na(e.start)||(i=sa(parseFloat(e.start)||0),r.__start=r.__x1.map(function(){return i}))}if(Array.isArray(e.end)){r.__end=e.end.map(function(t){var e=parseFloat(t);return isNaN(e)&&(e=1),sa(e)});for(var s=r.__end.length;s<r.__x1.length;s++)r.__end.push(1)}else{na(e.end)||(n=parseFloat(e.end),isNaN(n)&&(n=1),n=sa(n),r.__end=r.__x1.map(function(){return n}))}}else{r.__x1=r.__y1=r.__start=0,r.__x2=r.__y2=r.__end=1,r.__controlA=[],r.__controlB=[],na(e.x1)||(r.__x1=parseFloat(e.x1)||0),na(e.y1)||(r.__y1=parseFloat(e.y1)||0),na(e.x2)||(r.__x2=parseFloat(e.x2)||0),na(e.y2)||(r.__y2=parseFloat(e.y2)||0),na(e.start)||(r.__start=sa(parseFloat(e.start)||0)),na(e.end)||(a=parseFloat(e.end),isNaN(a)&&(a=1),r.__end=sa(a)),Array.isArray(e.controlA)&&(r.__controlA=e.controlA),Array.isArray(e.controlB)&&(r.__controlB=e.controlB)}return r}return l(B,[{key:"buildCache",value:function(e,r){var i,n=this,a=this.width,o=this.height,s=this.__cacheProps,h=this.isMulti;return["x1","x2"].forEach(function(t){na(s[t])&&(i=!0,s[t]=aa(n[t],e,a,h))}),["y1","y2"].forEach(function(t){na(s[t])&&(i=!0,s[t]=aa(n[t],r,o,h))}),["controlA","controlB"].forEach(function(t){na(s[t])&&(i=!0,s[t]=function e(t,r,i,n,a,o){if(o){if(t)return t.map(function(t){return e(t,r,i,n,a)})}else if(t&&2<=t.length)return[r+t[0]*n,i+t[1]*a];return[]}(n[t],e,r,a,o,h))}),["start","end"].forEach(function(t){na(s[t])&&(i=!0,s[t]=n[t])}),i}},{key:"render",value:function(t,e,c,r){var i=Q(J(B.prototype),"render",this).call(this,t,e,c,r);if(i.break)return i;var f,n,a,o,s,h,u,l,_,d,p,v,y,g,m,b,x,k,M,w,S,A,E=i.originX,P=i.originY,T=i.stroke,R=i.strokeWidth,C=i.strokeDasharrayStr,O=i.strokeLinecap,L=i.strokeLinejoin,N=i.strokeMiterlimit,I=i.dx,F=i.dy,W=this.__cacheProps,D=this.isMulti;return this.buildCache(E,P)&&t===Qt.SVG&&(f="",D?W.x1.forEach(function(t,e){var r,i=W.x2[e],n=W.y1[e],a=W.y2[e],o=W.controlA[e],s=W.controlB[e],h=W.start[e],u=W.end[e],l=oa(o,s);0===h&&1===u||(t=(r=te(ha(t,n,i,n,o,s,l,h,u,W.len),6))[0],n=r[1],i=r[2],n=r[3],o=r[4],s=r[5]),f+=jt.svgLine(t,n,i,a,o,s,l)}):(n=oa(W.controlA,W.controlB),h=W.x1,u=W.y1,l=W.x2,_=W.y2,d=W.controlA,p=W.controlB,a=W.start,o=W.end,0===a&&1===o||(h=(s=te(ha(h,u,l,_,d,p,n,a,o,W.len),6))[0],u=s[1],l=s[2],_=s[3],d=s[4],p=s[5]),f=jt.svgLine(h,u,l,_,d,p,n)),W.d=f),t===Qt.CANVAS?0<R&&(c.beginPath(),D?W.x1.forEach(function(t,e){var r,i=W.x2[e],n=W.y1[e],a=W.y2[e],o=W.controlA[e],s=W.controlB[e],h=W.start[e],u=W.end[e],l=oa(o,s);0===h&&1===u||(t=(r=te(ha(t,n,i,n,o,s,l,h,u,W.len),6))[0],n=r[1],i=r[2],n=r[3],o=r[4],s=r[5]),jt.canvasLine(c,t,n,i,a,o,s,l,I,F)}):(v=oa(W.controlA,W.controlB),b=W.x1,x=W.y1,k=W.x2,M=W.y2,w=W.controlA,S=W.controlB,y=W.start,g=W.end,0===y&&1===g||(b=(m=te(ha(b,x,k,M,w,S,v,y,g,W.len),6))[0],x=m[1],k=m[2],M=m[3],w=m[4],S=m[5]),jt.canvasLine(c,b,x,k,M,w,S,v,I,F)),c.stroke(),c.closePath()):t===Qt.SVG&&(A=[["d",W.d],["fill","none"],["stroke",T],["stroke-width",R]],this.__propsStrokeStyle(A,C,O,L,N),this.addGeom("path",A)),i}},{key:"x1",get:function(){return this.getProps("x1")}},{key:"y1",get:function(){return this.getProps("y1")}},{key:"x2",get:function(){return this.getProps("x2")}},{key:"y2",get:function(){return this.getProps("y2")}},{key:"controlA",get:function(){return this.getProps("controlA")}},{key:"controlB",get:function(){return this.getProps("controlB")}},{key:"start",get:function(){return this.getProps("start")}},{key:"end",get:function(){return this.getProps("end")}},{key:"bbox",get:function(){var t=this.__sx2,e=this.__sy2,r=this.computedStyle,i=r.paddingTop,n=r.paddingLeft,a=r.strokeWidth,o=r.boxShadow,s=r.filter,h=this.isMulti,u=this.__cacheProps,l=t+n,c=e+i;this.buildCache(l,c);var f=u.x1,_=u.y1,d=u.x2,p=u.y2,v=u.controlA,y=u.controlB,g=Q(J(B.prototype),"bbox",this),m=.5*a,b=te(this.__spreadByBoxShadowAndFilter(o,s),2),x=b[0],k=b[1];return x+=m,k+=m,h||(f=[f],d=[d],_=[_],p=[p],v=[v],y=[y]),f.forEach(function(t,e){var r,i,n,a=_[e],o=d[e],s=p[e],h=v[e],u=y[e];(na(h)||h.length<2)&&(na(u)||u.length<2)?(g[0]=Math.min(g[0],t-x),g[0]=Math.min(g[0],o-x),g[1]=Math.min(g[1],a-k),g[1]=Math.min(g[1],s-k),g[2]=Math.max(g[2],t+x),g[2]=Math.max(g[2],o+x),g[3]=Math.max(g[3],a+k),g[3]=Math.max(g[3],s+k)):na(h)||h.length<2?(r=ie.bboxBezier(t,a,u[0],u[1],o,s),g[0]=Math.min(g[0],r[0]-x),g[0]=Math.min(g[0],r[2]-x),g[1]=Math.min(g[1],r[1]-k),g[1]=Math.min(g[1],r[3]-k),g[2]=Math.max(g[2],r[0]+x),g[2]=Math.max(g[2],r[2]+x),g[3]=Math.max(g[3],r[1]+k),g[3]=Math.max(g[3],r[3]+k)):na(u)||u.length<2?(i=ie.bboxBezier(t,a,h[0],h[1],o,s),g[0]=Math.min(g[0],i[0]-x),g[0]=Math.min(g[0],i[2]-x),g[1]=Math.min(g[1],i[1]-k),g[1]=Math.min(g[1],i[3]-k),g[2]=Math.max(g[2],i[0]+x),g[2]=Math.max(g[2],i[2]+x),g[3]=Math.max(g[3],i[1]+k),g[3]=Math.max(g[3],i[3]+k)):(n=ie.bboxBezier(t,a,h[0],h[1],u[0],u[1],o,s),g[0]=Math.min(g[0],n[0]-x),g[0]=Math.min(g[0],n[2]-x),g[1]=Math.min(g[1],n[1]-k),g[1]=Math.min(g[1],n[3]-k),g[2]=Math.max(g[2],n[0]+x),g[2]=Math.max(g[2],n[2]+x),g[3]=Math.max(g[3],n[1]+k),g[3]=Math.max(g[3],n[3]+k))}),g}}]),B}(),la=re.isNil;function ca(t,e){return Array.isArray(e)&&(2===e.length||4===e.length)&&Array.isArray(t)&&2===t.length?e.concat(t):t}function fa(t){return t<0?t=0:1<t&&(t=1),t}function _a(t,e){var r=[],i=0,n=[];if(e)i=[],t.forEach(function(t){var e=_a(t);r.push(e.list),i.push(e.total),n.push([0].concat(e.increase))});else if(Array.isArray(t)){i=0,n.push(0);for(var a=0,o=0,s=t.length;o<s;o++){var h=t[o];if(Array.isArray(h)){a=o;break}}for(var u=t[a],l=a+1,c=t.length;l<c;l++){var f,_,d,p,v,y=t[l];Array.isArray(y)&&(2===y.length?(f=Math.abs(y[0]-u[0]),_=Math.abs(y[1]-u[1]),d=Math.sqrt(Math.pow(f,2)+Math.pow(_,2)),r.push(d),i+=d,n.push(i),u=y):4===y.length?(p=ie.bezierLength([u,[y[0],y[1]],[y[2],y[3]]],2),r.push(p),i+=p,n.push(i),u=[y[2],y[3]]):6===y.length&&(v=ie.bezierLength([u,[y[0],y[1]],[y[2],y[3]],[y[4],y[5]]],3),r.push(v),i+=v,n.push(i),u=[y[4],y[5]]))}}return{list:r,total:i,increase:n}}function da(t,e,r,i){if(r===i)return t[r]>e?r-1:r;var n=r+(i-r>>1);return t[n]===e?n:t[n]>e?da(t,e,r,Math.max(n-1,r)):da(t,e,Math.min(n+1,i),i)}function pa(t,e,r,i){var n=2<arguments.length&&void 0!==r?r:0,a=3<arguments.length&&void 0!==i?i:1;if(0===n&&1===a)return t;if(a<=n)return[];var o=0,s=t.length-2;0<n&&(o=da(e.increase,n*e.total,o,s)),a<1&&(s=da(e.increase,a*e.total,o,s)),t=re.clone(t);var h,u,l,c,f,_,d,p,v,y,g,m,b,x,k,M,w=1;return(a*=e.total)>e.increase[s]&&(h=t[s].slice(t[s].length-2),u=t[s+1],l=e.list[s],w=c=(a-e.increase[s])/l,2===u.length?(f=Math.abs(u[0]-h[0]),_=Math.abs(u[1]-h[1]),t[s+1]=[u[1]-(1-c)*f,u[1]-(1-c)*_]):4===u.length?(d=ie.sliceBezier([h,[u[0],u[1]],[u[2],u[3]]],c),t[s+1]=[d[1][0],d[1][1],d[2][0],d[2][1]]):6===u.length&&(p=ie.sliceBezier([h,[u[0],u[1]],[u[2],u[3]],[u[4],u[5]]],c),t[s+1]=[p[1][0],p[1][1],p[2][0],p[2][1],p[3][0],p[3][1]])),(n*=e.total)>e.increase[o]&&(v=t[o].slice(t[o].length-2),y=t[o+1],g=e.list[o],o===s&&1!==w&&(g*=w),m=(n-e.increase[o])/g,2===y.length?(b=Math.abs(y[0]-v[0]),x=Math.abs(y[1]-v[1]),t[o]=[v[0]+m*b,v[1]+m*x]):4===y.length?(k=ie.sliceBezier([[y[2],y[3]],[y[0],y[1]],v],1-m).reverse(),t[o]=k[0],t[o+1]=[k[1][0],k[1][1],k[2][0],k[2][1]]):6===y.length&&(M=ie.sliceBezier([[y[4],y[5]],[y[2],y[3]],[y[0],y[1]],v],1-m).reverse(),t[o]=M[0],t[o+1]=[M[1][0],M[1][1],M[2][0],M[2][1],y[4],y[5]])),s<t.length-2&&(t=t.slice(0,s+2)),0<o&&(t=t.slice(o)),t}var va=function(){e(k,nn);var h=f(k);function k(t,e){var r,i,n,a;if(u(this,k),(r=h.call(this,t,e)).isMulti){if(r.__points=[[]],r.__controls=[[]],r.__start=[0],r.__end=[1],Array.isArray(e.start)){r.__start=e.start.map(function(t){return fa(parseFloat(t)||0)});for(var o=r.__start.length;o<r.__points.length;o++)r.__start.push(0)}else{la(e.start)||(i=fa(parseFloat(e.start)||0),r.__start=r.__points.map(function(){return i}))}if(Array.isArray(e.end)){r.__end=e.end.map(function(t){var e=parseFloat(t);return isNaN(e)&&(e=1),fa(e)});for(var s=r.__end.length;s<r.__points.length;s++)r.__end.push(1)}else{la(e.end)||(n=parseFloat(e.end),isNaN(n)&&(n=1),n=fa(n),r.__end=r.__points.map(function(){return n}))}}else{r.__points=[],r.__controls=[],r.__start=0,r.__end=1,la(e.start)||(r.__start=fa(parseFloat(e.start)||0)),la(e.end)||(a=parseFloat(e.end),isNaN(a)&&(a=1),r.__end=fa(a))}return Array.isArray(e.controls)&&(r.__controls=e.controls),Array.isArray(e.points)&&(r.__points=e.points),r}return l(k,[{key:"__getPoints",value:function(a,o,s,h,t,u){return t.map(function(t,e){if(Array.isArray(t)){var r=t.length;if(u){if(0!==r&&2!==r&&4!==r)return}else if(0!==r&&2!==r)return;for(var i=[],n=0;n<r;n++)n%2==0?i.push(a+t[n]*s):i.push(o+t[n]*h);return i}})}},{key:"buildCache",value:function(e,r){var t,i,n,a=this,o=this.width,s=this.height,h=this.points,u=this.controls,l=this.start,c=this.end,f=this.__cacheProps,_=this.isMulti;return la(f.points)&&(t=!0,f.points=_?h.map(function(t){if(Array.isArray(t))return a.__getPoints(e,r,o,s,t)}):this.__getPoints(e,r,o,s,h)),la(f.controls)&&(t=!0,f.controls=_?u.map(function(t){return Array.isArray(t)?a.__getPoints(e,r,o,s,t,!0):t}):this.__getPoints(e,r,o,s,u,!0)),la(f.start)&&(t=!0,f.start=l),la(f.end)&&(t=!0,f.end=c),t&&(i=f.points,n=f.controls,f.list=_?i.filter(function(t){return Array.isArray(t)}).map(function(t,e){var r=n[e];if(Array.isArray(t))return t.map(function(t,e){return e?ca(t,r&&r[e-1]):t})}):i.filter(function(t){return Array.isArray(t)}).map(function(t,e){return e?ca(t,n[e-1]):t}),f.len=_a(f.list,_)),t}},{key:"render",value:function(t,e,r,i){var n=Q(J(k.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.originX,o=n.originY,s=n.fill,h=n.stroke,u=n.strokeWidth,l=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,_=n.strokeMiterlimit,d=n.fillRule,p=n.dx,v=n.dy,y=this.__cacheProps,g=this.isMulti;this.buildCache(a,o);var m,b,x=y.list;return y.list2=g?x.map(function(t,e){if(Array.isArray(t)){var r=y.len;return pa(t,{list:r.list[e],total:r.total[e],increase:r.increase[e]},y.start[e],y.end[e])}}):pa(x,y.len,y.start,y.end),t===Qt.SVG&&(g?(m="",y.list2.forEach(function(t){return m+=jt.svgPolygon(t)}),y.d=m):y.d=jt.svgPolygon(y.list2)),t===Qt.CANVAS?(r.beginPath(),g?y.list2.forEach(function(t){return jt.canvasPolygon(r,t,p,v)}):jt.canvasPolygon(r,y.list2,p,v),r.fill("evenodd"===d?d:"nonzero"),0<u&&r.stroke(),r.closePath()):t===Qt.SVG&&(b=[["d",y.d],["fill",s],["stroke",h],["stroke-width",u]],"evenodd"===d&&b.push(["fill-rule","evenodd"]),this.__propsStrokeStyle(b,l,c,f,_),this.addGeom("path",b)),n}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}},{key:"start",get:function(){return this.getProps("start")}},{key:"end",get:function(){return this.getProps("end")}},{key:"bbox",get:function(){var t=this.__sx2,e=this.__sy2,r=this.computedStyle,i=r.paddingTop,n=r.paddingLeft,a=r.strokeWidth,o=r.boxShadow,s=r.filter,h=this.isMulti,u=this.__cacheProps,l=t+n,c=e+i;this.buildCache(l,c);var d=Q(J(k.prototype),"bbox",this),f=.5*a,_=te(this.__spreadByBoxShadowAndFilter(o,s),2),p=_[0],v=_[1];p+=f,v+=f;var y=u.points,g=u.controls;return h||(y=[y],g=[g]),y.forEach(function(t,e){if(!(!t||t.length<2||t[0].length<2||t[1].length<2))for(var r=g[e],i=te(t[0],2),n=i[0],a=i[1],o=1,s=t.length;o<s;o++){var h,u,l=te(t[o],2),c=l[0],f=l[1],_=r[o-1];_&&4===_.length?(h=ie.bboxBezier(n,a,_[0],_[1],_[2],_[3],c,f),d[0]=Math.min(d[0],h[0]-p),d[1]=Math.min(d[1],h[1]-v),d[2]=Math.max(d[2],h[2]+p),d[3]=Math.max(d[3],h[3]+v)):_&&2===_.length?(u=ie.bboxBezier(n,a,_[0],_[1],c,f),d[0]=Math.min(d[0],u[0]-p),d[1]=Math.min(d[1],u[1]-v),d[2]=Math.max(d[2],u[2]+p),d[3]=Math.max(d[3],u[3]+v)):(d[0]=Math.min(d[0],n-p),d[1]=Math.min(d[1],c-v),d[2]=Math.max(d[2],n+p),d[3]=Math.max(d[3],c+v)),n=c,a=f}}),d}}]),k}(),ya=function(){e(s,va);var r=f(s);function s(t,e){return u(this,s),r.call(this,t,e)}return l(s,[{key:"__getPoints",value:function(t,e,r,i,n,a){var o=Q(J(s.prototype),"__getPoints",this).call(this,t,e,r,i,n,a);return a||o.push(o[0]),o}}]),s}(),ga=re.isNil;function ma(t,e,r,i){return r=Math.max(r,0),0<=(i%=360)&&i<90?[t+Math.sin(i*Math.PI/180)*r,e-Math.cos(i*Math.PI/180)*r]:90<=i&&i<180?[t+Math.cos((i-90)*Math.PI/180)*r,e+Math.sin((i-90)*Math.PI/180)*r]:180<=i&&i<270?[t-Math.cos((270-i)*Math.PI/180)*r,e+Math.sin((270-i)*Math.PI/180)*r]:[t-Math.sin((360-i)*Math.PI/180)*r,e-Math.cos((360-i)*Math.PI/180)*r]}function ba(t,e){return t=parseFloat(t),isNaN(t)&&(t=e),t}var xa=function(){e(R,nn);var i=f(R);function R(t,e){var r;return u(this,R),(r=i.call(this,t,e)).isMulti?(r.__begin=[0],r.__end=[0],r.__r=[1],Array.isArray(e.begin)&&(r.__begin=e.begin.map(function(t){return ba(t,0)})),Array.isArray(e.end)&&(r.__end=e.end.map(function(t){return ba(t,0)})),Array.isArray(e.r)&&(r.__r=e.r.map(function(t){return ba(t,1)})),Array.isArray(e.edge)&&(r.__edge=e.edge.map(function(t){return!!t})),Array.isArray(e.closure)&&(r.__closure=e.closure.map(function(t){return!!t}))):(r.__begin=r.__end=0,r.__r=1,r.__edge=!1,r.__closure=!1,ga(e.begin)||(r.__begin=ba(e.begin,0)),ga(e.end)||(r.__end=ba(e.end,0)),ga(e.r)||(r.__r=ba(e.r,1)),ga(e.edge)||(r.__edge=!!e.edge),ga(e.closure)||(r.__closure=!!e.closure)),r}return l(R,[{key:"buildCache",value:function(l,c){var t,e,r,i,n,a,o,s,f=this.width,h=this.begin,_=this.end,d=this.r,u=this.edge,p=this.closure,v=this.__cacheProps,y=this.isMulti;return ga(v.begin)&&(t=!0,v.begin=h),ga(v.end)&&(t=!0,v.end=_),ga(v.r)&&(t=!0,v.r=y?d.map(function(t){return t*f*.5}):d*f*.5),d=v.r,ga(v.edge)&&(t=!0,v.edge=u),ga(v.closure)&&(t=!0,v.closure=p),t&&(y?(v.x1=[],v.x2=[],v.y1=[],v.y2=[],v.large=[],v.d=[],h.forEach(function(t,e){var r=ga(d[e])?.5*f:d[e],i=te(ma(l,c,r,t),2),n=i[0],a=i[1],o=te(ma(l,c,r,_[e]||0),2),s=o[0],h=o[1],u=180<(_[e]||0)-t?1:0;v.x1.push(n),v.x2.push(s),v.y1.push(a),v.y2.push(h),v.large.push(u)})):(r=(e=te(ma(l,c,d,h),2))[0],i=e[1],a=(n=te(ma(l,c,d,_),2))[0],o=n[1],s=180<_-h?1:0,v.x1=r,v.x2=a,v.y1=i,v.y2=o,v.large=s)),t}},{key:"render",value:function(t,e,r,i){var n=this,a=Q(J(R.prototype),"render",this).call(this,t,e,r,i);if(a.break)return a;var o=a.cx,s=a.cy,h=a.fill,u=a.stroke,l=a.strokeWidth,c=a.strokeDasharrayStr,f=a.strokeLinecap,_=a.strokeLinejoin,d=a.strokeMiterlimit,p=a.dx,v=a.dy,y=this.width,g=this.__cacheProps,m=this.isMulti;this.buildCache(o,s);var b=g.begin,x=g.end,k=g.r,M=g.x1,w=g.y1,S=g.x2,A=g.y2,E=g.edge,P=g.large,T=g.closure;return t===Qt.CANVAS?(r.beginPath(),m?b.forEach(function(t,e){return jt.canvasSector(r,o,s,k[e],M[e],w[e],S[e],A[e],l,t[e],x[e],P[e],E[e],T[e],p,v)}):jt.canvasSector(r,o,s,k,M,w,S,A,l,b,x,P,E,T,p,v),r.fill(),r.closePath()):t===Qt.SVG&&(m?b.forEach(function(t,e){var r=ga(k[e])?.5*y:k[e];n.__genSector(E[e],jt.svgSector(o,s,r,M[e],w[e],S[e],A[e],l,P[e],E[e],T[e]),h,u,l,c,f,_,d)}):this.__genSector(E,jt.svgSector(o,s,k,M,w,S,A,l,P,E,T),h,u,l,c,f,_,d)),a}},{key:"__genSector",value:function(t,e,r,i,n,a,o,s,h){var u,l;t?(u=[["d",e[0]],["fill",r],["stroke",i],["stroke-width",n]],this.__propsStrokeStyle(u,a,o,s,h),this.addGeom("path",u)):(this.addGeom("path",[["d",e[0]],["fill",r]]),0<n&&(l=[["d",e[1]],["fill","none"],["stroke",i],["stroke-width",n]],this.__propsStrokeStyle(l,a,o,s,h),this.addGeom("path",l)))}},{key:"begin",get:function(){return this.getProps("begin")}},{key:"end",get:function(){return this.getProps("end")}},{key:"r",get:function(){return this.getProps("r")}},{key:"edge",get:function(){return this.getProps("edge")}},{key:"closure",get:function(){return this.getProps("closure")}},{key:"bbox",get:function(){var t=this.isMulti,e=this.__cacheProps,r=this.__sx2,i=this.__sy2,n=this.width,a=this.height,o=this.computedStyle,s=o.paddingTop,h=o.paddingLeft,u=o.strokeWidth,l=o.boxShadow,c=o.filter,f=r+h+.5*n,_=i+s+.5*a;this.buildCache(f,_);var d,p=0,p=t?(d=0,e.r.forEach(function(t){d=Math.max(t,d)}),d):e.r,v=Q(J(R.prototype),"bbox",this),y=.5*u,g=te(this.__spreadByBoxShadowAndFilter(l,c),2),m=g[0],b=g[1],x=f-p-(m+=y),k=f+p+m,M=_-p-(b+=y),w=_+p+b;return v[0]=Math.min(v[0],x),v[1]=Math.min(v[1],M),v[2]=Math.max(v[2],k),v[3]=Math.max(v[3],w),v}}]),R}(),ka=re.isNil;function Ma(t,e,r,i,n,a){var o=4<arguments.length&&void 0!==n?n:0,s=5<arguments.length&&void 0!==a?a:0;if(0===o||0===s)return[[t,e],[t+r,e],[t+r,e+i],[t,e+i],[t,e]];var h=o*ie.H,u=s*ie.H;return[[t+o,e],[t+r-o,e],[t+r+h-o,e,t+r,e+s-u,t+r,e+s],[t+r,e+i-s],[t+r,e+i+u-s,t+r+h-o,e+i,t+r-o,e+i],[t+o,e+i],[t+o-h,e+i,t,e+i+u-s,t,e+i-s],[t,e+s],[t,e+s-u,t+o-h,e,t+o,e]]}function wa(t){return t=parseFloat(t),isNaN(t)&&(t=0),t}var Sa=function(){e(x,nn);var i=f(x);function x(t,e){var r;return u(this,x),(r=i.call(this,t,e)).isMulti?(r.__rx=[0],r.__ry=[0],Array.isArray(e.rx)&&(r.__rx=e.rx.map(wa)),Array.isArray(e.ry)&&(r.__ry=e.ry.map(wa))):(r.__rx=r.__ry=0,ka(e.rx)||(r.__rx=wa(e.rx)),ka(e.ry)||(r.__ry=wa(e.ry))),r}return l(x,[{key:"buildCache",value:function(r,i){var t,e,n,a=this.width,o=this.height,s=this.rx,h=this.ry,u=this.__cacheProps,l=this.isMulti;return ka(u.rx)&&(t=!0,u.rx=l?s.map(function(t){return Math.min(t,.5)*a}):Math.min(s,.5)*a),ka(u.ry)&&(t=!0,u.ry=l?s.map(function(t){return Math.min(t,.5)*o}):Math.min(h,.5)*o),t&&(e=u.rx,n=u.ry,u.list=l?e.map(function(t,e){return Ma(r,i,a,o,t,n[e])}):Ma(r,i,a,o,e,n)),t}},{key:"render",value:function(t,e,r,i){var n=Q(J(x.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.originX,o=n.originY,s=n.fill,h=n.stroke,u=n.strokeWidth,l=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,_=n.strokeMiterlimit,d=n.dx,p=n.dy,v=this.__cacheProps,y=this.isMulti;this.buildCache(a,o);var g,m,b=v.list;return t===Qt.CANVAS?(r.beginPath(),y?b.forEach(function(t){return jt.canvasPolygon(r,t,d,p)}):jt.canvasPolygon(r,b,d,p),r.fill(),0<u&&r.stroke(),r.closePath()):t===Qt.SVG&&(g="",y?b.forEach(function(t){return g+=jt.svgPolygon(t)}):g=jt.svgPolygon(b),m=[["d",g],["fill",s],["stroke",h],["stroke-width",u]],this.__propsStrokeStyle(m,l,c,f,_),this.addGeom("path",m)),n}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}},{key:"bbox",get:function(){var t=this.__sx2,e=this.__sy2,r=this.width,i=this.height,n=this.computedStyle,a=n.paddingTop,o=n.paddingLeft,s=n.strokeWidth,h=n.boxShadow,u=n.filter,l=t+o,c=e+a;this.buildCache(l,c);var f=Q(J(x.prototype),"bbox",this),_=.5*s,d=te(this.__spreadByBoxShadowAndFilter(h,u),2),p=d[0],v=d[1];return p+=_,v+=_,f[0]=Math.min(f[0],l-p),f[1]=Math.min(f[1],c-v),f[2]=Math.min(f[2],l+r+p),f[3]=Math.min(f[3],c+i+v),f}}]),x}(),Aa=re.isNil;function Ea(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var Pa=function(){e(S,nn);var i=f(S);function S(t,e){var r;return u(this,S),(r=i.call(this,t,e)).isMulti?(r.__r=[1],Array.isArray(e.r)?r.__r=e.r.map(Ea):Aa(e.r)||(r.__r=Ea(e.r))):(r.__r=1,Aa(e.r)||(r.__r=Ea(e.r))),r}return l(S,[{key:"buildCache",value:function(e,r){var i=this.width,t=this.r,n=this.__cacheProps,a=this.isMulti;Aa(n.r)&&(a?(n.r=t.map(function(t){return t*i*.5}),n.list=n.r.map(function(t){return ie.ellipsePoints(e,r,t)})):(n.r=t*i*.5,n.list=ie.ellipsePoints(e,r,n.r)))}},{key:"render",value:function(t,e,r,i){var n=Q(J(S.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.cx,o=n.cy,s=n.fill,h=n.stroke,u=n.strokeWidth,l=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,_=n.strokeMiterlimit,d=n.dx,p=n.dy,v=this.__cacheProps,y=this.isMulti;this.buildCache(a,o);var g,m,b=v.list;return t===Qt.CANVAS?(r.beginPath(),y?b.forEach(function(t){return jt.canvasPolygon(r,t,d,p)}):jt.canvasPolygon(r,b,d,p),r.fill(),0<u&&r.stroke(),r.closePath()):t===Qt.SVG&&(g="",y?b.forEach(function(t){return g+=jt.svgPolygon(t)}):g=jt.svgPolygon(b),m=[["d",g],["fill",s],["stroke",h],["stroke-width",u]],this.__propsStrokeStyle(m,l,c,f,_),this.addGeom("path",m)),n}},{key:"r",get:function(){return this.getProps("r")}},{key:"bbox",get:function(){var t=this.isMulti,e=this.__cacheProps,r=this.__sx2,i=this.__sy2,n=this.width,a=this.height,o=this.computedStyle,s=o.paddingTop,h=o.paddingLeft,u=o.strokeWidth,l=o.boxShadow,c=o.filter,f=r+h+.5*n,_=i+s+.5*a;this.buildCache(f,_);var d,p=0,p=t?(d=0,e.r.forEach(function(t){d=Math.max(t,d)}),d):e.r,v=Q(J(S.prototype),"bbox",this),y=.5*u,g=te(this.__spreadByBoxShadowAndFilter(l,c),2),m=g[0],b=g[1],x=f-p-(m+=y),k=f+p+m,M=_-p-(b+=y),w=_+p+b;return v[0]=Math.min(v[0],x),v[1]=Math.min(v[1],M),v[2]=Math.max(v[2],k),v[3]=Math.max(v[3],w),v}}]),S}(),Ta=re.isNil;function Ra(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var Ca=function(){e(E,nn);var i=f(E);function E(t,e){var r;return u(this,E),(r=i.call(this,t,e)).isMulti?(r.__rx=[1],r.__ry=[1],Array.isArray(e.rx)?r.__rx=e.rx.map(Ra):Ta(e.rx)||(r.__rx=[Ra(e.rx)]),Array.isArray(e.ry)?r.__ry=e.ry.map(Ra):Ta(e.ry)||(r.__ry=[Ra(e.ry)])):(r.__rx=1,Ta(e.rx)||(r.__rx=Ra(e.rx)),r.__ry=1,Ta(e.ry)||(r.__ry=Ra(e.ry))),r}return l(E,[{key:"buildCache",value:function(r,i){var t,e,n,a=this.width,o=this.height,s=this.rx,h=this.ry,u=this.__cacheProps,l=this.isMulti;return Ta(u.rx)&&(t=!0,u.rx=l?s.map(function(t){return t*a*.5}):s*a*.5),Ta(u.ry)&&(t=!0,u.ry=l?h.map(function(t){return t*o*.5}):h*o*.5),t&&(e=u.rx,n=u.ry,u.list=l?e.map(function(t,e){return ie.ellipsePoints(r,i,t,n[e])}):ie.ellipsePoints(r,i,e,n)),t}},{key:"render",value:function(t,e,r,i){var n=Q(J(E.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.cx,o=n.cy,s=n.fill,h=n.stroke,u=n.strokeWidth,l=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,_=n.strokeMiterlimit,d=n.dx,p=n.dy,v=this.__cacheProps,y=this.isMulti;this.buildCache(a,o);var g,m,b=v.list;return t===Qt.CANVAS?(r.beginPath(),y?b.forEach(function(t){return jt.canvasPolygon(r,t,d,p)}):jt.canvasPolygon(r,b,d,p),r.fill(),0<u&&r.stroke(),r.closePath()):t===Qt.SVG&&(g="",y?b.forEach(function(t){return g+=jt.svgPolygon(t)}):g=jt.svgPolygon(b),m=[["d",g],["fill",s],["stroke",h],["stroke-width",u]],this.__propsStrokeStyle(m,l,c,f,_),this.addGeom("path",m)),n}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}},{key:"bbox",get:function(){var t=this.isMulti,r=this.__cacheProps,e=this.__sx2,i=this.__sy2,n=this.width,a=this.height,o=this.computedStyle,s=o.paddingTop,h=o.paddingLeft,u=o.strokeWidth,l=o.boxShadow,c=o.filter,f=e+h+.5*n,_=i+s+.5*a;this.buildCache(f,_);var d,p,v=0,y=0,y=t?(p=d=0,r.rx.forEach(function(t,e){d=Math.max(t,d),p=Math.max(y,r.ry[e])}),v=d,p):(v=r.rx,r.ry),g=Q(J(E.prototype),"bbox",this),m=.5*u,b=te(this.__spreadByBoxShadowAndFilter(l,c),2),x=b[0],k=b[1],M=f-v-(x+=m),w=f+v+x,S=_-y-(k+=m),A=_+y+k;return g[0]=Math.min(g[0],M),g[1]=Math.min(g[1],S),g[2]=Math.max(g[2],w),g[3]=Math.max(g[3],A),g}}]),E}(),Oa={skewX:"kx",skewY:"ky",transform:"tf",fontSize:"fz",offset:"os",easing:"e",filter:"ft",boxShadow:"bd"},La={os:"offset",e:"easing",ft:"filter",bd:"boxShadow"},Na={value:"v",options:"o"},Ia={},Fa={duration:"dt",delay:"d",endDelay:"ed",iterations:"i",direction:"dc",fill:"f",fps:"fp",playbackRate:"p",spfLimit:"sl"},Wa={};nt.DOM_ENTRY_SET.concat(nt.GEOM_ENTRY_SET).forEach(function(t){var e,r=t.k;Oa.hasOwnProperty(r)?La[Oa[r]]=r:(e=r.charAt(0)+r.replace(/[a-z]/g,"").toLowerCase(),Oa[r]=e,La[e]=r)}),Object.keys(Na).forEach(function(t){Ia[Na[t]]=t}),Object.keys(Fa).forEach(function(t){Wa[Fa[t]]=t});var Da={fullCssProperty:Oa,abbrCssProperty:La,fullAnimate:Na,abbrAnimate:Ia,fullAnimateOption:Fa,abbrAnimateOption:Wa},Ba=c.TYPE_VD,Ha=c.TYPE_GM,za=c.TYPE_CP,Ga=re.isNil,Ya=re.isFunction,Xa=re.isPrimitive,$a=re.clone,ja=re.extend,qa=Da.abbrCssProperty,Ua=Da.abbrAnimateOption,Va=Da.abbrAnimate;function Za(n,a){n&&Object.keys(n).forEach(function(t){var e,r,i;0===t.indexOf("var-")?(e=t.slice(4),a.hasOwnProperty(e)&&(r=a[e],n["var-"+r]=n[t])):a.hasOwnProperty(t)&&(i=a[t],n[i]=n[t],delete n[t])})}function Ka(s,h){s&&h&&Object.keys(s).forEach(function(t){if(0===t.indexOf("var-")){var e=s[t];if(!e)return;var r=t.slice(4);if(e.id&&h.hasOwnProperty(e.id)){var i=h[e.id];if(void 0===i)return;if(-1<r.indexOf(".")){for(var n=r.split("."),a=n.length,o=0;o<a-1;o++)r=n[o],s[r]?s=s[r]:console.error("parseJson vars is not exist: "+e.id+", "+t+", "+n.slice(0,o).join("."));r=n[a-1]}Ya(i)&&(i=i(e)),s[r]=i}}})}function Ja(e,r){e.tagName=r.tagName,e.props=$a(r.props),e.children=r.children,Object.keys(r).forEach(function(t){0!==t.indexOf("var-")||e.hasOwnProperty(t)||(e[t]=r[t])}),e.libraryId=null;var t,i,n=e.init;n&&(i=(t=e.props=e.props||{}).style,ja(t,n),i&&(ja(i,n.style),t.style=i),e.init=null)}function Qa(r,t,i,n,e){var a=4<arguments.length&&void 0!==e?e:{};if(Xa(t)||t instanceof M)return t;if(Array.isArray(t))return t.map(function(t){return Qa(r,t,i,n,a)});var o=t.library,s=t.libraryId;if(Array.isArray(o))a={},o.forEach(function(t){!function(t,i){var e=t.id,r=t.children;if(Array.isArray(r)&&r.forEach(function(t){if(!Xa(t)){var e=t.libraryId;if(Ga(e))return;var r=i[e];if(!r)throw new Error("Link library item miss libraryId: "+e);Ja(t,r)}}),Ga(e))throw new Error("Library item miss id: "+JSON.stringify(t));i[e]=t}(t,a)}),t.library=null,t.libraryId=null;else if(!Ga(s)&&a){var h=a[s];if(!h)throw new Error("Link library miss id: "+s);Ja(t,h)}var u=t.tagName,l=t.props,c=void 0===l?{}:l,f=t.children,_=void 0===f?[]:f,d=t.animate,p=void 0===d?[]:d,v=t.__animateRecords;if(!u)throw new Error("Dom must have a tagName: "+JSON.stringify(t));var y,g,m,b,x,k=c.style;return Za(k,qa),Ka(k,n),Ka(c,n),Ka(t,n),y="$"===u.charAt(0)?r.createGm(u,c):r.createVd(u,c,_.map(function(t,e){return t&&-1<[Ba,Ha,za].indexOf(t.$$type)?t:Qa(r,t,i,n,a)})),v&&(y.__animateRecords=v),p&&(Array.isArray(p)?(p.forEach(function(t){Za(t,Va);var e=t.value,r=t.options;Array.isArray(e)&&e.length&&(m=!0,e.forEach(function(t){Za(t,qa),Ka(t,n)})),r&&(Za(r,Ua),Ka(r,n))}),m&&(g={animate:p,target:y})):(Za(p,Va),b=p.value,x=p.options,Array.isArray(b)&&b.length&&(b.forEach(function(t){Za(t,qa),Ka(t,n)}),g={animate:p,target:y}),x&&(Za(x,Ua),Ka(x,n)))),g&&i.push(g),y}var to={parse:function(t,e,r,i){var n=3<arguments.length&&void 0!==i?i:{};e=re.clone(e),Je.isDom(r)||(n=r||{},r=null);var a=[],o=Qa(t,e,a,n.vars);if(r){var s=e.tagName;if(-1===["canvas","svg"].indexOf(s))throw new Error("Parse dom must be canvas/svg");var h=n.controller instanceof Fn?n.controller:o.animateController;t.render(o,r),a.forEach(function(t){t.target=t.target.vd}),!1!==n.autoPlay?(h.__auto=h.__auto.concat(a),h.__playAuto()):h.__records=h.__records.concat(a)}else a.length&&(o.__animateRecords={options:n,list:a,controller:n.controller instanceof Fn?n.controller:null});return o},abbr:Da},eo={css:Gt,reset:nt,unit:j,font:h},ro={Animation:Yr,Controller:Fn,easing:yr,frame:or},io={level:jr,change:Ot,Page:Kr,Cache:Jr};nn.register("$line",ua),nn.register("$polyline",va),nn.register("$polygon",ya),nn.register("$sector",xa),nn.register("$rect",Sa),nn.register("$circle",Pa),nn.register("$ellipse",Ca);var no={version:"0.40.14",render:function(t,e){if(!(t instanceof ia))throw new Error("Render dom must be canvas/svg");return e&&t.appendTo(e),t},createElement:function(t,e){e=e||{};for(var r=[],i=2,n=arguments.length;i<n;i++)r.push(arguments[i]);return re.isString(t)?"$"===t.charAt(0)?this.createGm(t,e):this.createVd(t,e,r):t?this.createCp(t,e,r):void 0},createVd:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:[];if(-1<["canvas","svg"].indexOf(t))return new ia(t,e,i);if(Ii.TAG_NAME.hasOwnProperty(t))return{tagName:t,props:e,children:i,$$type:c.TYPE_VD};throw new Error("Can not use <".concat(t,">"))},createGm:function(t,e){return{tagName:t,props:e,$$type:c.TYPE_GM}},createCp:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:[];return e.children=i,{klass:t,props:e,$$type:c.TYPE_CP}},parse:function(t,e,r){return to.parse(this,t,e,r)},mode:Qt,Component:Ni,Node:M,Text:Xt,Geom:nn,Xom:xi,Dom:$i,Root:ia,Event:rr,util:re,inject:Je,style:eo,parser:to,animate:ro,math:Kt,builder:Ti,updater:mn,refresh:io};return Ti.ref({Xom:xi,Dom:$i,Img:Vi,Geom:nn,Component:Ni}),mn.ref({Xom:xi,Dom:$i,Img:Vi,Geom:nn,Component:Ni}),"undefined"!=typeof window&&(window.karas=no),no});
//# sourceMappingURL=index.min.js.map
