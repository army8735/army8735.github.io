!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).karas=e()}(this,(function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}function n(t){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=l(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(arguments.length<3?t:r):a.value}},h.apply(this,arguments)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var i,a,n=[],o=!0,s=!1;try{for(r=r.call(t);!(o=(i=r.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(t){s=!0,a=t}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return n}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return _(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var v=function(){function t(){this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__sx=0,this.__sy=0,this.__width=0,this.__height=0,this.__baseline=0,this.__verticalBaseline=0,this.__prev=null,this.__next=null,this.__parent=null,this.__domParent=null,this.__root=null,this.__host=null,this.__hostRoot=null,this.__virtualDom=null,this.__bbox=null,this.__filterBbox=null,this.__isDestroyed=!0}return r(t,[{key:"__structure",value:function(t,e){return this.__struct={node:this,childIndex:e,lv:t}}},{key:"__offsetX",value:function(t,e){e?this.__x+=t:this.__ox+=t,this.__sx+=t}},{key:"__offsetY",value:function(t,e){e?this.__y+=t:this.__oy+=t,this.__sy+=t}},{key:"__destroy",value:function(){this.__isDestroyed=!0}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"sx",get:function(){return this.x+this.ox}},{key:"sy",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"domParent",get:function(){return this.__domParent}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"hostRoot",get:function(){return this.__hostRoot}},{key:"baseline",get:function(){return this.__baseline}},{key:"verticalBaseline",get:function(){return this.__verticalBaseline}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"isReplaced",get:function(){return!1}}]),t}(),y={CANVAS:0,SVG:1,WEBGL:2},d={AUTO:0,PX:1,PERCENT:2,NUMBER:3,INHERIT:4,DEG:5,STRING:6,RGBA:7,REM:8,EM:9,VW:10,VH:11,VMAX:12,VMIN:13,GRADIENT:14,calUnit:function(t){var e=parseFloat(t)||0;return/%$/.test(t)?{v:e,u:2}:/px$/i.test(t)?{v:e,u:1}:/deg$/i.test(t)?{v:e,u:5}:/rem$/i.test(t)?{v:e,u:8}:/vw$/i.test(t)?{v:e,u:10}:/vh$/i.test(t)?{v:e,u:11}:/em$/i.test(t)?{v:e,u:9}:/vw$/i.test(t)?{v:e,u:10}:/vh$/i.test(t)?{v:e,u:11}:/vmax$/i.test(t)?{v:e,u:12}:/vmin$/i.test(t)?{v:e,u:13}:{v:e,u:3}}};function p(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function x(t){return!t||!t.length||(16===t.length?1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]:1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5])}var g={identity:p,multiply:function(t,e){if(!t&&!e)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];if(x(t))return e;if(x(e))return t;for(var r=[],i=0;i<4;i++){var a=t[i]||0,n=t[i+4]||0,o=t[i+8]||0,s=t[i+12]||0;r[i]=a*e[0]+n*e[1]+o*e[2]+s*e[3],r[i+4]=a*e[4]+n*e[5]+o*e[6]+s*e[7],r[i+8]=a*e[8]+n*e[9]+o*e[10]+s*e[11],r[i+12]=a*e[12]+n*e[13]+o*e[14]+s*e[15]}return r},multiplyTfo:function(t,e,r){return e||r?(t[12]+=t[0]*e+t[4]*r,t[13]+=t[1]*e+t[5]*r,t[14]+=t[2]*e+t[6]*r,t[15]+=t[3]*e+t[7]*r,t):t},tfoMultiply:function(t,e,r){if(!t&&!e)return r;var i=r[3],a=r[7],n=r[11],o=r[15];return r[0]+=i*t,r[1]+=i*e,r[4]+=a*t,r[5]+=a*e,r[8]+=n*t,r[9]+=n*e,r[12]+=o*t,r[13]+=o*e,r},multiplyTranslateX:function(t,e){return e?(t[12]+=t[0]*e,t[13]+=t[1]*e,t[14]+=t[2]*e,t[15]+=t[3]*e,t):t},multiplyTranslateY:function(t,e){return e?(t[12]+=t[4]*e,t[13]+=t[5]*e,t[14]+=t[6]*e,t[15]+=t[7]*e,t):t},multiplyTranslateZ:function(t,e){return e?(t[12]+=t[8]*e,t[13]+=t[9]*e,t[14]+=t[10]*e,t[15]+=t[11]*e,t):t},multiplyRotateX:function(t,e){if(!e)return t;var r=Math.sin(e),i=Math.cos(e),a=t[4],n=t[5],o=t[6],s=t[7],l=t[8];t[9];var h=t[10],u=t[11];return t[4]=a*i+l*r,t[5]=n*i+o*r,t[6]=o*i+h*r,t[7]=s*i+u*r,t[8]=a*-r+l*i,t[9]=n*-r+o*i,t[10]=o*-r+h*i,t[11]=s*-r+u*i,t},multiplyRotateY:function(t,e){if(!e)return t;var r=Math.sin(e),i=Math.cos(e),a=t[0],n=t[1],o=t[2],s=t[3],l=t[8],h=t[9],u=t[10],c=t[11];return t[0]=a*i+l*-r,t[1]=n*i+h*-r,t[2]=o*i+u*-r,t[3]=s*i+c*-r,t[8]=a*r+l*i,t[9]=n*r+h*i,t[10]=o*r+u*r,t[11]=s*r+c*r,t},multiplyRotateZ:function(t,e){if(!e)return t;var r=Math.sin(e),i=Math.cos(e),a=t[0],n=t[1],o=t[2],s=t[3],l=t[4],h=t[5],u=t[6],c=t[7];return t[0]=a*i+l*r,t[1]=n*i+h*r,t[2]=o*i+u*r,t[3]=s*i+c*r,t[4]=a*-r+l*i,t[5]=n*-r+h*i,t[6]=o*-r+u*i,t[7]=s*-r+c*i,t},multiplySkewX:function(t,e){if(!e)return t;var r=Math.tan(e);return t[4]+=t[0]*r,t[5]+=t[1]*r,t[6]+=t[2]*r,t[7]+=t[3]*r,t},multiplySkewY:function(t,e){if(!e)return t;var r=Math.tan(e);return t[0]+=t[4]*r,t[1]+=t[5]*r,t[2]+=t[6]*r,t[3]+=t[7]*r,t},multiplyScaleX:function(t,e){return 1===e||(t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e),t},multiplyScaleY:function(t,e){return 1===e||(t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e),t},multiplyScaleZ:function(t,e){return 1===e||(t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e),t},multiplyPerspective:function(t,e){return!e||e<=0||(e=-1/(e=Math.max(e,1)),t[8]+=t[12]*e,t[9]+=t[13]*e,t[10]+=t[14]*e,t[11]+=t[15]*e),t},calPoint:function(t,e){var r=u(t,4),i=r[0],a=r[1],n=r[2],o=r[3];if(void 0===o&&(o=1),e&&!x(e)){if(16===e.length){n=n||0;var s=u(e,16),l=s[0],h=s[1],c=s[2],f=s[3],_=s[4],v=s[5],y=s[6],d=s[7],p=s[8],g=s[9],m=s[10],b=s[11];return[i*l+a*_+n*p+s[12],i*h+a*v+n*g+s[13],i*c+a*y+n*m+s[14],o*=i*f+a*d+n*b+s[15]]}var M=u(e,6),E=M[0],A=M[1],S=M[2],T=M[3];return[E*i+S*a+M[4],A*i+T*a+M[5]]}return[i,a,n,o]},point2d:function(t){var e=t[3];return e&&1!==e&&((t=t.slice(0,2))[0]/=e,t[1]/=e),t},inverse:function(t){if(16===t.length)return function(t){var e=[];e[0]=t[5]*t[10]*t[15]-t[5]*t[11]*t[14]-t[9]*t[6]*t[15]+t[9]*t[7]*t[14]+t[13]*t[6]*t[11]-t[13]*t[7]*t[10],e[4]=-t[4]*t[10]*t[15]+t[4]*t[11]*t[14]+t[8]*t[6]*t[15]-t[8]*t[7]*t[14]-t[12]*t[6]*t[11]+t[12]*t[7]*t[10],e[8]=t[4]*t[9]*t[15]-t[4]*t[11]*t[13]-t[8]*t[5]*t[15]+t[8]*t[7]*t[13]+t[12]*t[5]*t[11]-t[12]*t[7]*t[9],e[12]=-t[4]*t[9]*t[14]+t[4]*t[10]*t[13]+t[8]*t[5]*t[14]-t[8]*t[6]*t[13]-t[12]*t[5]*t[10]+t[12]*t[6]*t[9],e[1]=-t[1]*t[10]*t[15]+t[1]*t[11]*t[14]+t[9]*t[2]*t[15]-t[9]*t[3]*t[14]-t[13]*t[2]*t[11]+t[13]*t[3]*t[10],e[5]=t[0]*t[10]*t[15]-t[0]*t[11]*t[14]-t[8]*t[2]*t[15]+t[8]*t[3]*t[14]+t[12]*t[2]*t[11]-t[12]*t[3]*t[10],e[9]=-t[0]*t[9]*t[15]+t[0]*t[11]*t[13]+t[8]*t[1]*t[15]-t[8]*t[3]*t[13]-t[12]*t[1]*t[11]+t[12]*t[3]*t[9],e[13]=t[0]*t[9]*t[14]-t[0]*t[10]*t[13]-t[8]*t[1]*t[14]+t[8]*t[2]*t[13]+t[12]*t[1]*t[10]-t[12]*t[2]*t[9],e[2]=t[1]*t[6]*t[15]-t[1]*t[7]*t[14]-t[5]*t[2]*t[15]+t[5]*t[3]*t[14]+t[13]*t[2]*t[7]-t[13]*t[3]*t[6],e[6]=-t[0]*t[6]*t[15]+t[0]*t[7]*t[14]+t[4]*t[2]*t[15]-t[4]*t[3]*t[14]-t[12]*t[2]*t[7]+t[12]*t[3]*t[6],e[10]=t[0]*t[5]*t[15]-t[0]*t[7]*t[13]-t[4]*t[1]*t[15]+t[4]*t[3]*t[13]+t[12]*t[1]*t[7]-t[12]*t[3]*t[5],e[14]=-t[0]*t[5]*t[14]+t[0]*t[6]*t[13]+t[4]*t[1]*t[14]-t[4]*t[2]*t[13]-t[12]*t[1]*t[6]+t[12]*t[2]*t[5],e[3]=-t[1]*t[6]*t[11]+t[1]*t[7]*t[10]+t[5]*t[2]*t[11]-t[5]*t[3]*t[10]-t[9]*t[2]*t[7]+t[9]*t[3]*t[6],e[7]=t[0]*t[6]*t[11]-t[0]*t[7]*t[10]-t[4]*t[2]*t[11]+t[4]*t[3]*t[10]+t[8]*t[2]*t[7]-t[8]*t[3]*t[6],e[11]=-t[0]*t[5]*t[11]+t[0]*t[7]*t[9]+t[4]*t[1]*t[11]-t[4]*t[3]*t[9]-t[8]*t[1]*t[7]+t[8]*t[3]*t[5],e[15]=t[0]*t[5]*t[10]-t[0]*t[6]*t[9]-t[4]*t[1]*t[10]+t[4]*t[2]*t[9]+t[8]*t[1]*t[6]-t[8]*t[2]*t[5];var r=t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12];if(0===r)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];r=1/r;for(var i=[],a=0;a<16;a++)i[a]=e[a]*r;return i}(t);var e=u(t,6),r=e[0],i=e[1],a=e[2],n=e[3],o=e[4],s=e[5];if(1===r&&0===i&&0===a&&1===n&&0===o&&0===s)return t;var l=r*n-i*a;return 0===l?t:[n/l,-i/l,-a/l,r/l,(a*s-n*o)/l,(i*o-r*s)/l]},isE:x,m2m6:function(t){return[t[0],t[1],t[4],t[5],t[12],t[13]]}},m={}.toString;function b(t){return function(e){return m.call(e)==="[object "+t+"]"}}var M=b("Object"),E=b("String"),A=b("Function"),S=b("Number"),T=b("Boolean"),w=b("Date"),R={}.hasOwnProperty,k=R.toString,C=k.call(Object);function O(t){return null==t}function I(t){for(var e="",r=0,i=t.length;r<i;r++){var a=t[r];Array.isArray(a)?e+=I(a):e+=F(a)}return e}function F(t){return O(t)?"":t.toString()}function L(t){if("item"===t.type||"img"===t.type){var e="";return(t.props||[]).forEach((function(t){e+=" "+t[0]+'="'+t[1]+'"'})),"text"===t.tagName?"<text"+e+">"+t.content+"</text>":"<"+t.tagName+e+"/>"}if("text"===t.type){var r="";return(t.children||[]).forEach((function(t){r+=L(t)})),"<g>"+r+"</g>"}if("dom"===t.type||"geom"===t.type){var i="<g>";t.bb.forEach((function(t){i+=L(t)})),i+="</g><g",t.conClip&&(i+=' clip-path="'+t.conClip+'"'),i+=">",(t.children||[]).forEach((function(t){t.isMask||(i+=L(t))})),i+="</g>";var a=t.opacity,n=t.transform,o=t.visibility,s=t.mask,l=t.overflow,h=t.filter,u=t.mixBlendMode;return"<g"+(1!==a&&void 0!==a?' opacity="'+a+'"':"")+(n?' transform="'+n+'"':"")+' visibility="'+o+'"'+(s?' mask="'+s+'"':"")+(l?' clip-path="'+l+'"':"")+(h||u?' style="':"")+(h?"filter:"+h+";":"")+(u?"mix-blend-mode:"+u+";":"")+(h||u?'"':"")+">"+i+"</g>"}}function D(t){var e="<"+t.tagName+' id="'+t.uuid+'"';return"mask"===t.tagName||"clipPath"===t.tagName||"filter"===t.tagName||(e+=' gradientUnits="userSpaceOnUse"'),(t.props||[]).forEach((function(t){e+=" "+t[0]+'="'+t[1]+'"'})),e+=">",(t.children||[]).forEach((function(t){e+=function(t){var e="<"+t.tagName;return(t.props||[]).forEach((function(t){e+=" "+t[0]+'="'+t[1]+'"'})),e+="></"+t.tagName+">"}(t)})),e+="</"+t.tagName+">"}function B(t,e){for(var r=t.length?t[0]:"",i=1,a=t.length;i<a;i++)r+=e+t[i];return r}function P(t){if(!t||"[object Object]"!==m.call(t))return!1;var e=Object.getPrototypeOf(t);if(!e)return!0;var r=R.call(e,"constructor")&&e.constructor;return"function"==typeof r&&k.call(r)===C}function N(t){return 1===t.length?"0"+t:t}var G={isObject:M,isString:E,isFunction:A,isNumber:S,isBoolean:T,isDate:w,isNil:O,isPrimitive:function(t){return G.isNil(t)||G.isBoolean(t)||G.isString(t)||G.isNumber(t)},isAuto:function(t){return O(t)||"auto"===t},isPlainObject:P,stringify:F,joinSourceArray:function(t){return I(t)},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},joinVirtualDom:function(t){var e="<defs>";return t.defs.forEach((function(t){e+=D(t)})),e+="</defs><g>",t.bb.forEach((function(t){e+=L(t)})),e+="</g><g",t.conClip&&(e+=' clip-path="'+t.conClip+'"'),e+=">",(t.children||[]).forEach((function(t){t.isMask||(e+=L(t))})),e+="</g>"},joinVd:L,joinDef:D,rgba2int:function(t){if(Array.isArray(t))return t;var e=[];if(t&&"transparent"!==t)if("#"===t.charAt(0))3===(t=t.slice(1)).length?(e.push(parseInt(t.charAt(0)+t.charAt(0),16)),e.push(parseInt(t.charAt(1)+t.charAt(1),16)),e.push(parseInt(t.charAt(2)+t.charAt(2),16)),e[3]=1):6===t.length?(e.push(parseInt(t.slice(0,2),16)),e.push(parseInt(t.slice(2,4),16)),e.push(parseInt(t.slice(4),16)),e[3]=1):8===t.length?(e.push(parseInt(t.slice(0,2),16)),e.push(parseInt(t.slice(2,4),16)),e.push(parseInt(t.slice(4,6),16)),e.push(parseInt(t.slice(6),16)/255)):(e[0]=e[1]=e[2]=0,e[3]=1);else{var r=t.match(/rgba?\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)(?:\s*,\s*([\d.]+))?\s*\)/i);r?(e=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],O(r[4])?e[3]=1:e[3]=parseFloat(r[4])):e=[0,0,0,0]}else e=[0,0,0,0];return e},int2rgba:function(t){return!Array.isArray(t)||3!==t.length&&4!==t.length?t||"rgba(0,0,0,0)":(t[0]=Math.floor(Math.max(t[0],0)),t[1]=Math.floor(Math.max(t[1],0)),t[2]=Math.floor(Math.max(t[2],0)),4===t.length?(t[3]=Math.max(t[3],0),"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"):"rgba("+t[0]+","+t[1]+","+t[2]+",1)")},int2invert:function(t){if(Array.isArray(t)){if((t=t.slice(0))[0]=255-t[0],t[1]=255-t[1],t[2]=255-t[2],4===t.length)return"rgba("+B(t,",")+")";if(3===t.length)return"rgba("+B(t,",")+",1)"}return"rgba(0,0,0,0)"},arr2hash:function(t){for(var e={},r=0,i=t.length;r<i;r++){var a=t[r];if(Array.isArray(a))e[a[0]]=a[1];else for(var n=Object.keys(a),o=n.length-1;o>=0;o--){var s=n[o];e[s]=a[s]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],r=Object.keys(t),i=0,a=r.length;i<a;i++){var n=r[i];e.push([n,t[n]])}return e},clone:function e(r){if(O(r)||"object"!==t(r))return r;if(G.isDate(r))return new Date(r);if(!P(r)&&!Array.isArray(r))return r;var i=Array.isArray(r)?[]:{};return Object.keys(r).forEach((function(t){i[t]=e(r[t])})),i},equalArr:function t(e,r){if(!e||!r)return e===r;if(e.length!==r.length)return!1;for(var i=0,a=e.length;i<a;i++){var n=e[i],o=r[i],s=Array.isArray(n),l=Array.isArray(o);if(s&&l){if(!t(n,o))return!1}else{if(s||l)return!1;if(n!==o)return!1}}return!0},equal:function t(e,r){if(e===r)return!0;if(M(e)&&M(r)){for(var i={},a=0,n=Object.keys(e),o=n.length;a<o;a++){var s=n[a];if(!r.hasOwnProperty(s)||!t(e[s],r[s]))return!1;i[s]=!0}for(var l=0,h=Object.keys(r),u=h.length;l<u;l++){var c=h[l];if(!i.hasOwnProperty(c))return!1}}else{if(w(e)&&w(r))return e.getTime()===r.getTime();if(!Array.isArray(e)||!Array.isArray(r))return e===r;if(e.length!==r.length)return!1;for(var f=0,_=e.length;f<_;f++)if(!t(e[f],r[f]))return!1}return!0},extend:function(e,r,i){if(null===r||"object"!==t(r))return e;i||(i=Object.keys(r));for(var a=0,n=i.length;a<n;){var o=i[a];e[o]=r[o],a++}return e},joinArr:B,transformBbox:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e&&!g.isE(e)){var a=t,n=u(a,4),o=n[0],s=n[1],l=n[2],h=n[3];r&&(o-=r,l+=r),i&&(s-=i,h+=i);var c,f=[l,s,o,h,l,h],_=g.calPoint([o,s],e),v=u(_,4);o=v[0],s=v[1],(c=v[3])&&1!==c&&(o/=c,s/=c);for(var y=o,d=s,p=o,x=s,m=0;m<6;m+=2){var b=f[m],M=f[m+1],E=g.calPoint([b,M],e),A=u(E,4);b=A[0],M=A[1],(c=A[3])&&1!==c&&(b/=c,M/=c),y=Math.min(y,b),p=Math.max(p,b),d=Math.min(d,M),x=Math.max(x,M)}t=[y,d,p,x]}else(r||i)&&((t=t.slice(0))[0]-=r,t[1]-=i,t[2]+=r,t[3]+=i);return t},assignMatrix:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},prefixHex:N,replaceRgba2Hex:function(t){return(t||"").replace(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([\d.]+)\s*)?\)/gi,(function(t,e,r,i,a){var n="#"+N(parseInt(e).toString(16))+N(parseInt(r).toString(16))+N(parseInt(i).toString(16));return a&&(n+=N(Math.floor(255*parseFloat(a)).toString(16))),n}))}},H={flag:!1},W={alpha:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!0},Y=g.calPoint;function z(t,e,r){var i=t.createShader(e);if(null==i)throw new Error("unable to create shader");if(t.shaderSource(i,r),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var a=t.getShaderInfoLog(i);throw t.deleteShader(i),new Error("Failed to compile shader: "+a)}return i}function X(t,e,r,i){var a=u(t,4),n=a[0],o=a[1],s=a[2],l=a[3];return void 0===s&&(s=0),void 0===l&&(l=1),l&&1!==l&&(n/=l,o/=l,s/=l),o===r?o=0:(o=(o-r)/r,i&&(o=-o)),[(n=n===e?0:(n-e)/e)*l,o*l,s*l,l]}function U(t,e,r,i,a){var n=t.createTexture();return V(t,n,r),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i&&a?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,i,a,0,t.RGBA,t.UNSIGNED_BYTE,e):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),n}function V(t,e,r){t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_2D,e)}var K={initShaders:function(t,e,r){var i=function(t,e,r){var i=z(t,t.VERTEX_SHADER,e),a=z(t,t.FRAGMENT_SHADER,r);if(!i||!a)return null;var n=t.createProgram();if(!n)return null;if(n.vertexShader=i,n.fragmentShader=a,t.attachShader(n,i),t.attachShader(n,a),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){var o=t.getProgramInfoLog(n);throw t.deleteProgram(n),t.deleteShader(a),t.deleteShader(i),new Error("Failed to link program: "+o)}return n}(t,e,r);if(!i)throw new Error("Failed to create program");return t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),i},createTexture:U,bindTexture:V,drawTextureCache:function(t,e,r,i,a,n){var o,s=e.length,l=new Float32Array(24*s),h=new Float32Array(12*s),c=new Float32Array(6*s),f=[0],_=[f];e.forEach((function(t,e){var s=u(t,5),v=s[0],y=s[1],d=s[2],p=s[3],x=s[4];if(e){var g=r[v.page.uuid];o!==g&&(f=[0,o=g],_.push(f))}else o=r[v.page.uuid],f[1]=o;var m=v.x,b=v.y,M=v.width,E=v.height,A=v.page,S=v.bbox,T=S[0],w=S[1],R=T+(p||0),k=w+E+(x||0),C=T+M+(p||0),O=w+(x||0),I=u(Y([R,k],d),4),F=I[0],L=I[1],D=I[3],B=u(Y([C,k],d),4),P=B[0],N=B[1],G=B[3],H=u(Y([C,O],d),4),W=H[0],z=H[1],U=H[3],V=u(Y([R,O],d),4),K=V[0],j=V[1],Z=V[3],q=u(X([F,L,0,D],i,a,n),2);F=q[0],L=q[1];var $=u(X([P,N,0,G],i,a,n),2);P=$[0],N=$[1];var J=u(X([W,z,0,U],i,a,n),2);W=J[0],z=J[1];var Q=u(X([K,j,0,Z],i,a,n),2);K=Q[0],j=Q[1];var tt=24*e;l[tt]=F,l[tt+1]=L,l[tt+3]=D,l[tt+4]=K,l[tt+5]=j,l[tt+7]=Z,l[tt+8]=P,l[tt+9]=N,l[tt+11]=G,l[tt+12]=K,l[tt+13]=j,l[tt+15]=Z,l[tt+16]=P,l[tt+17]=N,l[tt+19]=G,l[tt+20]=W,l[tt+21]=z,l[tt+23]=U;var et=m/A.width,rt=(b+E)/A.height,it=(m+M)/A.width,at=b/A.height;h[tt=12*e]=et,h[tt+1]=rt,h[tt+2]=et,h[tt+3]=at,h[tt+4]=it,h[tt+5]=rt,h[tt+6]=et,h[tt+7]=at,h[tt+8]=it,h[tt+9]=rt,h[tt+10]=it,h[tt+11]=at,c[tt=6*e]=y,c[tt+1]=y,c[tt+2]=y,c[tt+3]=y,c[tt+4]=y,c[tt+5]=y,f[0]++}));var v=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,v),t.bufferData(t.ARRAY_BUFFER,l,t.STATIC_DRAW);var y=t.getAttribLocation(t.program,"a_position");t.vertexAttribPointer(y,4,t.FLOAT,!1,0,0),t.enableVertexAttribArray(y);var d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,h,t.STATIC_DRAW);var p=t.getAttribLocation(t.program,"a_texCoords");t.vertexAttribPointer(p,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(p);var x=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,x),t.bufferData(t.ARRAY_BUFFER,c,t.STATIC_DRAW);var g=t.getAttribLocation(t.program,"a_opacity");t.vertexAttribPointer(g,1,t.FLOAT,!1,0,0),t.enableVertexAttribArray(g);var m=t.getUniformLocation(t.program,"u_texture"),b=0;_.forEach((function(e){var r=u(e,2),i=r[0],a=r[1];t.uniform1i(m,a),i*=6,t.drawArrays(t.TRIANGLES,b,i),b+=i})),t.deleteBuffer(v),t.deleteBuffer(d),t.deleteBuffer(x),t.disableVertexAttribArray(y),t.disableVertexAttribArray(p),t.disableVertexAttribArray(g)},drawBlur:function(t,e,r,i,a,n,o,s,l,h,c,f,_,v){var y=u(X([h,l+h,0,1],_,v,!1),2),d=y[0],p=y[1],x=u(X([s+h,h,0,1],_,v,!1),2),g=x[0],m=x[1],b=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,b),t.bufferData(t.ARRAY_BUFFER,new Float32Array([d,m,d,p,g,m,d,p,g,m,g,p]),t.STATIC_DRAW);var M=t.getAttribLocation(e,"a_position");t.vertexAttribPointer(M,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(M);var E=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,E),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,0,1,1]),t.STATIC_DRAW);var A=t.getAttribLocation(e,"a_texCoords");t.vertexAttribPointer(A,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(A);var S=t.getUniformLocation(e,"u_direction");t.uniform2f(S,0,0);var T=t.getUniformLocation(e,"u_texture");t.uniform1i(T,o),t.drawArrays(t.TRIANGLES,0,6),t.bindBuffer(t.ARRAY_BUFFER,b),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW);for(var w=100/Math.max(c,f),R=c/f,k=[],C=0;C<3;C++){var O=U(t,null,o,c,f);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,O,0),c>=f?t.uniform2f(S,w,0):t.uniform2f(S,w*R,0),t.uniform1i(T,n),t.drawArrays(t.TRIANGLES,0,6),k.push(i);var I=U(t,null,n,c,f);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,I,0),c>=f?t.uniform2f(S,0,w*R):t.uniform2f(S,0,w),t.uniform1i(T,o),t.drawArrays(t.TRIANGLES,0,6),i=I,k.push(O)}return t.deleteBuffer(b),t.deleteBuffer(E),t.disableVertexAttribArray(M),t.disableVertexAttribArray(A),k.forEach((function(e){return t.deleteTexture(e)})),i},drawOverflow:function(t,e,r,i,a,n,o,s){var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var h=t.getAttribLocation(t.programOverflow,"a_position");t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(h);var u=r/o,c=i/s,f=(a+r)/o,_=(n+i)/s,v=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,v),t.bufferData(t.ARRAY_BUFFER,new Float32Array([u,c,u,_,f,c,u,_,f,c,f,_]),t.STATIC_DRAW);var y=t.getAttribLocation(t.programOverflow,"a_texCoords");t.vertexAttribPointer(y,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(y);var d=t.getUniformLocation(t.programOverflow,"u_texture");t.uniform1i(d,e),t.drawArrays(t.TRIANGLES,0,6),t.deleteBuffer(l)},drawMask:function(t,e,r,i){var a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var n=t.getAttribLocation(i,"a_position");t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n);var o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,0,1,1]),t.STATIC_DRAW);var s=t.getAttribLocation(i,"a_texCoords");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s);var l=t.getUniformLocation(i,"u_texture1");t.uniform1i(l,r);var h=t.getUniformLocation(i,"u_texture2");t.uniform1i(h,e),t.drawArrays(t.TRIANGLES,0,6),t.deleteBuffer(a),t.deleteBuffer(o),t.disableVertexAttribArray(n),t.disableVertexAttribArray(s)},drawMbm:function(t,e,r,i,a,n){var o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var s=t.getAttribLocation(e,"a_position");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s);var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,0,1,1]),t.STATIC_DRAW);var h=t.getAttribLocation(e,"a_texCoords");t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(h);var u=t.getUniformLocation(e,"u_texture1");t.uniform1i(u,r);var c=t.getUniformLocation(e,"u_texture2");t.uniform1i(c,i),t.drawArrays(t.TRIANGLES,0,6),t.deleteBuffer(o),t.deleteBuffer(l),t.disableVertexAttribArray(s),t.disableVertexAttribArray(h)},drawCm:function(t,e,r,i){var a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var n=t.getAttribLocation(e,"a_position");t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n);var o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,0,1,1]),t.STATIC_DRAW);var s=t.getAttribLocation(e,"a_texCoords");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s);var l=t.getUniformLocation(e,"u_texture");t.uniform1i(l,r);var h=t.getUniformLocation(e,"u_m");t.uniform1fv(h,new Float32Array(i)),t.drawArrays(t.TRIANGLES,0,6),t.deleteBuffer(a),t.deleteBuffer(o),t.disableVertexAttribArray(n),t.disableVertexAttribArray(s)},drawDropShadow:function(t,e,r,i,a,n,o,s,l,h){var u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var c=t.getAttribLocation(e,"a_position");t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(c);var f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,0,1,1]),t.STATIC_DRAW);var _=t.getAttribLocation(e,"a_texCoords");t.vertexAttribPointer(_,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(_);var v=t.getUniformLocation(e,"u_texture");t.uniform1i(v,o);var y=t.getUniformLocation(e,"u_color");return t.uniform1fv(y,new Float32Array([h[0]/255,h[1]/255,h[2]/255,h[3]])),t.drawArrays(t.TRIANGLES,0,6),t.deleteBuffer(u),t.deleteBuffer(f),t.disableVertexAttribArray(c),t.disableVertexAttribArray(_),i}},j=1e3/60,Z={},q={},$=[],J=[],Q="function"==typeof OffscreenCanvas&&G.isFunction(OffscreenCanvas.prototype.getContext);function tt(t,e,r,i,a){var n,o;if(t)n=i[t]?i[t]:i[t]=!H.flag&&Q?new OffscreenCanvas(e,r):document.createElement("canvas");else{var s=i===Z?$:J;n=s.length?s.pop():!H.flag&&Q?new OffscreenCanvas(e,r):document.createElement("canvas")}return n.width=e,n.height=r,H.flag&&(n.style.width=e+"px",n.style.height=r+"px",n.setAttribute("type",i===Z?"canvas":"webgl"),t&&n.setAttribute("key",t),a&&n.setAttribute("message",a),document.body.appendChild(n)),o=i===Z?n.getContext("2d"):n.getContext("webgl",W)||n.getContext("experimental-webgl",W),{canvas:n,ctx:o,enabled:!0,available:!0,release:function(){!t&&this.available&&(i===Z?$.push(this.canvas):J.push(this.canvas)),this.available=!1}}}var et,rt,it={},at={},nt={},ot={};function st(){(et=document.createElement("div")).style.position="absolute",et.style.left="99999px",et.style.top="-99999px",et.style.visibility="hidden",et.style.whiteSpace="nowrap",document.body.appendChild(et)}var lt={measureTextSync:function(t,e,r,i,a){return et||st(),et.style.fontFamily=e,et.style.fontSize=r+"px",et.style.fontWeight=i,et.style.writingMode=a?"vertical-lr":"horizontal-tb",et.innerHTML=t.replace(/</g,"&lt;").replace(/[ \n]/g,"&nbsp;"),a?parseFloat(window.getComputedStyle(et,null).height):parseFloat(window.getComputedStyle(et,null).width)},measureTextListMax:function(t,e,r,i){et||st(),et.style.fontFamily=e,et.style.fontSize=r+"px",et.style.fontWeight=i;for(var a="",n=0,o=t.length;n<o;n++)a+='<span style="position:absolute">'+t.charAt(n).replace("<","&lt;").replace(/[ \n]/,"&nbsp;")+"</span>";et.innerHTML=a;for(var s=0,l=et.childNodes,h=0,u=l.length;h<u;h++){var c=l[h];s=Math.max(s,parseFloat(window.getComputedStyle(c,null).width))}return s},IMG:it,INIT:0,LOADED:2,LOADING:1,measureImg:function(t,e){if(Array.isArray(t)){if(!t.length)return e&&e();var r=0,i=t.length,a=[];t.forEach((function(t,n){lt.measureImg(t,(function(t){a[n]=t,++r===i&&e&&e(a)}))}))}else{if(!t||!G.isString(t))return lt.error("Measure img invalid: "+t),void(e&&e({state:2,success:!1,url:t}));var n=it[t]=it[t]||{state:0,task:[]};if(2===n.state)e&&e(n);else if(1===n.state)e&&n.task.push(e);else{n.state=1,e&&n.task.push(e);var o=new Image;if(o.onload=function(){n.state=2,n.success=!0,n.width=o.width,n.height=o.height,n.source=o,n.url=t,n.task.splice(0).forEach((function(t){return t(n)}))},o.onerror=function(e){n.state=2,n.success=!1,n.url=t,n.task.splice(0).forEach((function(t){return t(n)}))},"data:"!==t.substr(0,5)){var s=/^(?:\w+:)?\/\/([^/:]+)/.exec(t);s&&("undefined"!=typeof location&&location.hostname===s[1]||(o.crossOrigin="anonymous"))}o.src=t,H.flag&&"undefined"!=typeof document&&document.body.appendChild(o)}}},warn:function(t){console.warn(t)},error:function(t){console.error(t)},requestAnimationFrame:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e;if(t)return"undefined"!=typeof requestAnimationFrame?(lt.requestAnimationFrame=requestAnimationFrame.bind(window),e=requestAnimationFrame(t)):(e=setTimeout(t,j),lt.requestAnimationFrame=function(t){return setTimeout(t,j)}),e})),cancelAnimationFrame:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e;return"undefined"!=typeof cancelAnimationFrame?(lt.cancelAnimationFrame=cancelAnimationFrame.bind(window),e=cancelAnimationFrame(t)):(e=clearTimeout(t),lt.cancelAnimationFrame=function(t){return clearTimeout(t)}),e})),now:function(){return"undefined"!=typeof performance?(lt.now=function(){return Math.floor(performance.now())},Math.floor(performance.now())):(lt.now=Date.now.bind(Date),Date.now())},hasCacheCanvas:function(t){return t&&Z.hasOwnProperty(t)},getCacheCanvas:function(t,e,r,i){return function(t,e,r,i){return tt(t,e,r,Z,i)}(r,t,e,i)},releaseCacheCanvas:function(t){$.push(t)},delCacheCanvas:function(t){t&&delete Z[t]},hasCacheWebgl:function(t){return t&&q.hasOwnProperty(t)},getCacheWebgl:function(t,e,r,i){return function(t,e,r,i){return tt(t,e,r,q,i)}(r,t,e,i)},releaseCacheWebgl:function(t){J.push(t)},delCacheWebgl:function(t){t&&delete q[t]},isDom:function(t){if(t){if(G.isString(t))return!0;if("undefined"!=typeof window&&window.Element&&t instanceof window.Element)return!0;if("undefined"!=typeof window&&window.OffscreenCanvas&&t instanceof window.OffscreenCanvas)return!0;if("undefined"!=typeof self&&self.OffscreenCanvas&&t instanceof self.OffscreenCanvas)return!0;if(G.isFunction(t.getElementsByTagName))return!0}return!1},isWebGLTexture:function(t){if(t&&"undefined"!=typeof WebGLTexture)return t instanceof WebGLTexture},defaultFontFamily:"arial",getFontCanvas:function(){return lt.getCacheCanvas(16,16,"__$$CHECK_SUPPORT_FONT_FAMILY$$__")},checkSupportFontFamily:function(t){if((t=t.toLowerCase())===this.defaultFontFamily)return!0;if(ot.hasOwnProperty(t))return ot[t];var e=lt.getFontCanvas().ctx;e.textAlign="center",e.fillStyle="#000",e.textBaseline="middle",rt||(e.clearRect(0,0,16,16),e.font="16px "+this.defaultFontFamily,e.fillText("a",8,8),rt=e.getImageData(0,0,16,16).data),e.clearRect(0,0,16,16),/\s/.test(t)&&(t='"'+t.replace(/"/g,'\\"')+'"'),e.font="16px "+t+","+this.defaultFontFamily,e.fillText("a",8,8);for(var r=e.getImageData(0,0,16,16).data,i=0,a=r.length;i<a;i++)if(rt[i]!==r[i])return ot[t]=!0;return ot[t]=!1},loadFont:function(t,e,r){if(G.isFunction(e)&&(r=e,e=t),Array.isArray(e)){if(!e.length)return r();var i=0,a=e.length,n=[];e.forEach((function(t,e){lt.loadFont(t.fontFamily,t.url,(function(t){n[e]=t,++i===a&&r(n)}))}))}else{if(!e||!G.isString(e))return lt.error("Load font invalid: "+e),void(r&&r({state:2,success:!1,url:e}));t||(t=e);var o=at[e]=at[e]||{state:0,task:[]};if(2===o.state)r&&r(o);else if(1===o.state)r&&o.task.push(r);else{o.state=1,r&&o.task.push(r),e instanceof ArrayBuffer||/url\(/.test(e)||(e="url(".concat(e,")"));var s=new FontFace(t,e);s.load().then((function(){document.fonts.add(s),o.state=2,o.success=!0,o.url=e,o.task.splice(0).forEach((function(t){return t(o)}))})).catch((function(){o.state=2,o.success=!1,o.url=e,o.task.splice(0).forEach((function(t){return t(o)}))}))}}},loadComponent:function(t,e){if(Array.isArray(t)){if(!t.length)return e();var r=0,i=t.length,a=[];t.forEach((function(t,n){lt.loadComponent(t,(function(t){a[n]=t,++r===i&&e(a)}))}))}else{if(!t||!G.isString(t))return lt.error("Load component invalid: "+t),void(e&&e({state:2,success:!1,url:t}));var n=nt[t]=nt[t]||{state:0,task:[]};if(2===n.state)e&&e(n);else if(1===n.state)e&&n.task.push(e);else{n.state=1,e&&n.task.push(e);var o=document.createElement("script");o.src=t,o.async=!0,o.onload=function(){n.state=2,n.success=!0,n.url=t,n.task.splice(0).forEach((function(t){return t(n)})),document.head.removeChild(o)},o.onerror=function(){n.state=2,n.success=!1,n.url=t,n.task.splice(0).forEach((function(t){return t(n)})),document.head.removeChild(o)},document.head.appendChild(o)}}}},ht=G.isString,ut={},ct={info:{arial:{lhr:1.14990234375,blr:.9052734375,lgr:.03271484375},helvetica:{lhr:1.14990234375,blr:.927734375,lgr:.00390625},verdana:{lhr:1.21533203125,blr:1.00537109375},tahoma:{lhr:1.20703125,blr:1.00048828125},georgia:{lhr:1.13623046875,blr:.9169921875},"courier new":{lhr:1.1328125,blr:.83251953125},"pingfang sc":{lhr:1.4,blr:1.06},simsun:{lhr:1.4,blr:1.06}},support:function(t){return this.info.hasOwnProperty(t)&&this.info[t].checked},register:function(t,e,r){t=t.toLowerCase(),ht(e)||e instanceof ArrayBuffer||(r=e,e=null);var i=this.info;if(i[t]=i[t]||{},e&&!i[t].url&&(i[t].url=e,lt.loadFont(t,e,(function(e){if(i[t].success=e.success,e.success)for(var r=ut[t]||[];r.length;){r.pop().__emitFontRegister(t)}}))),r&&!i[t].lhr){var a=r||{},n=a.emSquare,o=void 0===n?2048:n,s=a.ascent,l=void 0===s?1854:s,h=a.descent,u=void 0===h?434:h,c=a.lineGap,f=void 0===c?0:c;Object.assign(i[t],{lhr:(l+u+f)/o,blr:l/o})}},hasRegister:function(t){return this.info.hasOwnProperty(t)&&this.info[t].hasOwnProperty("lhr")},hasLoaded:function(t){return this.info.hasOwnProperty(t)&&this.info[t].success},onRegister:function(t,e){(ut[t]=ut[t]||[]).push(e)},offRegister:function(t,e){var r=ut[t]=ut[t]||[],i=r.indexOf(e);i>-1&&r.splice(i,1)}};ct.info["宋体"]=ct.info.simsun,ct.info.pingfang=ct.info["pingfang sc"];var ft={position:"static",display:"block",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:"inherit",fontFamily:"inherit",color:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",backgroundImage:null,backgroundColor:"transparent",backgroundSize:"auto",backgroundRepeat:"repeat",backgroundPositionX:0,backgroundPositionY:0,backgroundClip:"borderBox",borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"transparent",borderRightColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent",borderTopStyle:"none",borderRightStyle:"none",borderBottomStyle:"none",borderLeftStyle:"none",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0,width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",flexWrap:"nowrap",order:0,justifyContent:"flexStart",alignItems:"stretch",alignSelf:"auto",alignContent:"stretch",textAlign:"inherit",letterSpacing:"inherit",transformOrigin:"center",visibility:"inherit",opacity:1,zIndex:0,transform:null,translateX:0,translateY:0,translateZ:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,skewY:0,rotateX:0,rotateY:0,rotateZ:0,rotate3d:"0, 0, 0, 0",perspective:0,perspectiveOrigin:"center",filter:null,boxShadow:null,pointerEvents:"inherit",overflow:"visible",mixBlendMode:"normal",whiteSpace:"inherit",textOverflow:"clip",lineClamp:0,textStrokeWidth:"inherit",textStrokeColor:"inherit",textStrokeOver:"inherit",writingMode:"inherit"},_t={fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:4,fillRule:"nonzero"},vt=[],yt=[];Object.keys(ft).forEach((function(t){yt.push(t);var e=ft[t];vt.push({k:t,v:e})}));var dt=[],pt=[];Object.keys(_t).forEach((function(t){pt.push(t);var e=_t[t];dt.push({k:t,v:e})}));var xt={get fontFamily(){return lt.defaultFontFamily},fontSize:16,fontWeight:400,fontStyle:"normal",color:"#000",textAlign:"left",visibility:"visible",pointerEvents:"auto",textStrokeColor:"#000",textStrokeWidth:0,textStrokeOver:"none",writingMode:"horizontalTb"},gt=[];Object.keys(xt).forEach((function(t){gt.push(t)}));var mt={DOM:ft,GEOM:_t,isValid:function(t){return ft.hasOwnProperty(t)||_t.hasOwnProperty(t)},DOM_KEY_SET:yt,GEOM_KEY_SET:pt,DOM_ENTRY_SET:vt,GEOM_ENTRY_SET:dt,INHERIT:xt,INHERIT_KEY_SET:gt,VALID_STRING_VALUE:{position:["static","relative","absolute"],display:["block","inlineBlock","inline","flex","none"],flexDirection:["row","column","rowReverse","columnReverse"],flexWrap:["wrap","wrapReverse","nowrap"],justifyContent:["flexStart","center","flexEnd","spaceBetween","spaceAround","spaceEvenly"],alignItems:["stretch","flexStart","center","flexEnd","baseline"],alignSelf:["auto","stretch","flexStart","center","flexEnd","baseline"],overflow:["visible","hidden"],mixBlendMode:["normal","multiply","screen","overlay","darken","lighten","colorDodge","colorBurn","hardLight","softLight","difference","exclusion","hue","saturation","color","luminosity"],borderTopStyle:["solid","dashed","dotted"],borderRightStyle:["solid","dashed","dotted"],borderBottomStyle:["solid","dashed","dotted"],borderLeftStyle:["solid","dashed","dotted"],backgroundClip:["borderBox","paddingBox","contentBox"],textOverflow:["clip","ellipsis"],alignContent:["stretch","flexStart","center","flexEnd","spaceBetween","spaceAround"]}},bt={position:/(([-+]?[\d.]+[pxremvwhina%]*)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-?gradient\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i};var Mt={dotProduct:function(t,e,r,i){return t*r+e*i},crossProduct:function(t,e,r,i){return t*i-r*e}},Et={POSITION:0,DISPLAY:1,TOP:2,RIGHT:3,BOTTOM:4,LEFT:5,MARGIN_TOP:6,MARGIN_RIGHT:7,MARGIN_BOTTOM:8,MARGIN_LEFT:9,PADDING_TOP:10,PADDING_RIGHT:11,PADDING_BOTTOM:12,PADDING_LEFT:13,FONT_SIZE:14,FONT_FAMILY:15,COLOR:16,FONT_STYLE:17,FONT_WEIGHT:18,LINE_HEIGHT:19,BACKGROUND_IMAGE:20,BACKGROUND_COLOR:21,BACKGROUND_SIZE:22,BACKGROUND_REPEAT:23,BACKGROUND_POSITION_X:24,BACKGROUND_POSITION_Y:25,BORDER_TOP_WIDTH:26,BORDER_RIGHT_WIDTH:27,BORDER_BOTTOM_WIDTH:28,BORDER_LEFT_WIDTH:29,BORDER_TOP_COLOR:30,BORDER_RIGHT_COLOR:31,BORDER_BOTTOM_COLOR:32,BORDER_LEFT_COLOR:33,BORDER_TOP_STYLE:34,BORDER_RIGHT_STYLE:35,BORDER_BOTTOM_STYLE:36,BORDER_LEFT_STYLE:37,BORDER_TOP_LEFT_RADIUS:38,BORDER_TOP_RIGHT_RADIUS:39,BORDER_BOTTOM_RIGHT_RADIUS:40,BORDER_BOTTOM_LEFT_RADIUS:41,WIDTH:42,HEIGHT:43,FLEX_GROW:44,FLEX_SHRINK:45,FLEX_BASIS:46,FLEX_DIRECTION:47,JUSTIFY_CONTENT:48,ALIGN_ITEMS:49,ALIGN_SELF:50,TEXT_ALIGN:51,TRANSFORM_ORIGIN:52,VISIBILITY:53,OPACITY:54,Z_INDEX:55,TRANSFORM:56,TRANSLATE_X:57,TRANSLATE_Y:58,TRANSLATE_Z:59,SCALE_X:60,SCALE_Y:61,SCALE_Z:62,SKEW_X:63,SKEW_Y:64,ROTATE_X:65,ROTATE_Y:66,ROTATE_Z:67,ROTATE_3D:68,PERSPECTIVE:69,PERSPECTIVE_ORIGIN:70,FILTER:71,BOX_SHADOW:72,POINTER_EVENTS:73,OVERFLOW:74,MIX_BLEND_MODE:75,BACKGROUND_CLIP:76,WHITE_SPACE:77,TEXT_OVERFLOW:78,LETTER_SPACING:79,LINE_CLAMP:80,ORDER:81,FLEX_WRAP:82,ALIGN_CONTENT:83,TEXT_STROKE_WIDTH:84,TEXT_STROKE_COLOR:85,TEXT_STROKE_OVER:86,WRITING_MODE:87,FILL:88,STROKE:89,STROKE_WIDTH:90,STROKE_DASHARRAY:91,STROKE_DASHARRAY_STR:92,STROKE_LINECAP:93,STROKE_LINEJOIN:94,STROKE_MITERLIMIT:95,FILL_RULE:96,MATRIX:97,BORDER_TOP:98,BORDER_RIGHT:99,BORDER_BOTTOM:100,BORDER_LEFT:101,TRANSLATE_PATH:102},At={};function St(t){var e=At[t];return e||(e=At[t]=t.toLowerCase().replace(/_([a-z])/g,(function(t,e){return e.toUpperCase()}))),e}var Tt={};var wt={},Rt={},kt={};Object.keys(Et).forEach((function(t){var e=Et[t];wt[e]=t;var r=St(t);Rt[e]=r,kt[r]=e}));var Ct={STYLE_KEY:Et,STYLE_R_KEY:wt,STYLE_RV_KEY:Rt,STYLE_V_KEY:kt,style2Lower:St,style2Upper:function(t){var e=Tt[t];return e||(e=Tt[t]=t.replace(/([a-z\d_])([A-Z])/g,(function(t,e,r){return e+"_"+r})).toUpperCase()),e},ELLIPSIS:"…"},Ot=4*(Math.sqrt(2)-1)/3,It=Mt.crossProduct,Ft=g.calPoint,Lt=g.isE,Dt=Ct.STYLE_KEY,Bt=Dt.WIDTH,Pt=Dt.HEIGHT,Nt=Dt.TRANSFORM_ORIGIN;function Gt(t){return t*=.5,(1-Math.cos(t))/Math.sin(t)*4/3}function Ht(t,e,r){for(var i,a=u(r[0],2),n=a[0],o=a[1],s=u(r[0],2),l=s[0],h=s[1],c=r.length,f=1;f<c;f++){var _=u(r[f],2),v=_[0],y=_[1];n=Math.max(n,v),o=Math.max(o,y),l=Math.min(l,v),h=Math.min(h,y)}if(t<l||e<h||t>n||e>o)return!1;for(var d=0,p=r.length;d<p;d++){var x=u(r[d],2),g=x[0],m=x[1],b=u(r[(d+1)%p],2),M=b[0],E=b[1],A=It(M-g,E-m,t-g,e-m);if(0!==A)if(A=A>0?1:0,void 0===i)i=A;else if(i^A)return!1}return!0}function Wt(t,e,r,i){return Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2))}function Yt(t,e,r){var i=u(t,4),a=i[0],n=i[1],o=i[2],s=i[3],l=u(e,4),h=l[0],c=l[1],f=l[2],_=l[3];if(r){if(a>f||n>_||h>o||c>s)return!1}else if(a>=f||n>=_||h>=o||c>=s)return!1;return!0}function zt(t,e,r){var i=r.matrix,a=void 0===i?[1,0,0,1,0,0]:i,n=r.computedStyle,o=void 0===n?[]:n,s=o[Bt],l=o[Pt],h=o[Nt],c=u(h=void 0===h?[.5*s,.5*l]:h,2),f=c[0],_=c[1],v=u(Ft([t*s-f,e*l-_],a),2);return[(t=v[0])+f,(e=v[1])+_]}function Xt(t){return t*Math.PI/180}var Ut={pointInConvexPolygon:Ht,pointInQuadrilateral:function(t,e,r,i,a,n,o,s,l,h,c){if(c&&!Lt(c)){var f,_,v,y,d=u(Ft([r,i],c),4);r=d[0],i=d[1],f=d[3];var p=u(Ft([a,n],c),4);a=p[0],n=p[1],_=p[3];var x=u(Ft([l,h],c),4);l=x[0],h=x[1],v=x[3];var g=u(Ft([o,s],c),4);return o=g[0],s=g[1],f&&1!==f&&(r/=f,i/=f),_&&1!==_&&(a/=_,n/=_),v&&1!==v&&(l/=v,h/=v),(y=g[3])&&1!==y&&(o/=y,s/=y),Ht(t,e,[[r,i],[a,n],[o,s],[l,h]])}return t>=r&&e>=i&&t<=o&&e<=s},d2r:Xt,r2d:function(t){return 180*t/Math.PI},H:Ot,h:Gt,angleBySide:function(t,e,r){var i=(Math.pow(e,2)+Math.pow(r,2)-Math.pow(t,2))/(2*e*r);return Math.acos(i)},sideByAngle:function(t,e,r){var i=Math.cos(t);return Math.sqrt(Math.pow(e,2)+Math.pow(r,2)-2*e*r*i)},pointsDistance:Wt,triangleIncentre:function(t,e,r,i,a,n){var o=Wt(r,i,a,n),s=Wt(t,e,a,n),l=Wt(t,e,r,i);return[(o*t+s*r+l*a)/(o+s+l),(o*e+s*i+l*n)/(o+s+l)]},ellipsePoints:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,a=r*Ot,n=i===r?a:i*Ot;return[[t-r,e],[t-r,e-n,t-a,e-i,t,e-i],[t+a,e-i,t+r,e-n,t+r,e],[t+r,e+n,t+a,e+i,t,e+i],[t-a,e+i,t-r,e+n,t-r,e]]},sectorPoints:function t(e,r,i,a,n){if(a>n){var o=[n,a];a=o[0],n=o[1]}if(a===n)return[];var s=[],l=Math.floor(a/90),h=Math.floor(n/90);if(l===h||h-l==1&&n%90==0){var u=Gt(Xt(Math.abs(a-n)))*i,c=Math.sqrt(Math.pow(i,2)+Math.pow(u,2)),f=Math.atan(u/i);if(l<90){var _=Math.sin(Xt(a))*i,v=Math.cos(Xt(a))*i,y=[e+_,r-v],d=f+Xt(a),p=[e+(_=Math.sin(d)*c),r-(v=Math.cos(d)*c)],x=[e+(_=Math.sin(Xt(n))*i),r-(v=Math.cos(Xt(n))*i)];d=Xt(n)-f;var g=[e+(_=Math.sin(d)*c),r-(v=Math.cos(d)*c)];s.push(y),s.push(p.concat(g).concat(x))}else if(l<180){var m=Math.cos(Xt(a-90))*i,b=Math.sin(Xt(a-90))*i,M=[e+m,r+b],E=f+Xt(a-90),A=[e+(m=Math.cos(E)*c),r+(b=Math.sin(E)*c)],S=[e+(m=Math.cos(Xt(n-90))*i),r+(b=Math.sin(Xt(n-90))*i)];E=Xt(n-90)-f;var T=[e+(m=Math.cos(E)*c),r+(b=Math.sin(E)*c)];s.push(M),s.push(A.concat(T).concat(S))}else if(l<270){var w=Math.sin(Xt(a-180))*i,R=Math.cos(Xt(a-180))*i,k=[e-w,r+R],C=f+Xt(a-180),O=[e-(w=Math.sin(C)*c),r+(R=Math.cos(C)*c)],I=[e-(w=Math.sin(Xt(n-180))*i),r+(R=Math.cos(Xt(n-180))*i)];C=Xt(n-180)-f;var F=[e-(w=Math.sin(C)*c),r+(R=Math.cos(C)*c)];s.push(k),s.push(O.concat(F).concat(I))}else{var L=Math.cos(Xt(a-270))*i,D=Math.sin(Xt(a-270))*i,B=[e-L,r+D],P=f+Xt(a-270),N=[e-(L=Math.cos(P)*c),r+(D=Math.sin(P)*c)],G=[e-(L=Math.cos(Xt(n-270))*i),r+(D=Math.sin(Xt(n-270))*i)];P=Xt(n-270)-f;var H=[e-(L=Math.cos(P)*c),r+(D=Math.sin(P)*c)];s.push(B),s.push(N.concat(H).concat(G))}}else{for(var W=l,Y=[];W<=h;W++)if(0===W){var z=t(e,r,i,a,90);Y.push(z)}else if(1===W){if(l===W||n>90){var X=t(e,r,i,a<90?90:a,n>180?180:n);Y.push(X)}}else if(2===W){if(l===W||n>180){var U=t(e,r,i,a<180?180:a,n>270?270:n);Y.push(U)}}else if(3===W&&(l===W||n>270)){var V=t(e,r,i,a<270?270:a,n);Y.push(V)}s=Y[0];for(var K=1,j=Y.length;K<j;K++)s.push(Y[K][1])}return s},getRectsIntersection:function(t,e){if(!Yt(t,e))return null;var r=u(t,4),i=r[0],a=r[1],n=r[2],o=r[3],s=u(e,4),l=s[0],h=s[1],c=s[2],f=s[3];return[Math.max(i,l),Math.max(a,h),Math.min(n,c),Math.min(o,f)]},isRectsOverlap:Yt,isRectsInside:function(t,e,r){var i=u(t,4),a=i[0],n=i[1],o=i[2],s=i[3],l=u(e,4),h=l[0],c=l[1],f=l[2],_=l[3];if(r){if(a<=h&&n<=c&&o>=f&&s>=_)return!0}else if(a<h&&n<c&&o>f&&s>_)return!0;return!1},calCoordsInNode:zt,calPercentInNode:function(t,e,r){var i,a,n=r.computedStyle,o=n[Bt],s=n[Pt],l=u(n[Nt],2),h=l[0],c=l[1],f=Math.atan((s-c)/(o-h)),_=u(zt(1,1,r),2),v=_[0],y=_[1];a=v>=h&&y>=c?(i=h===v?-Math.atan(1/0):Math.atan((y-c)/(v-h)))-f:v>=h&&y<c?(i=h===v?-Math.atan(1/0):Math.atan((c-y)/(v-h)))+f:v<h&&y>=c?(i=Math.atan((y-c)/(h-v)))-f:v<h&&y<c?f>=(i=Math.atan((y-c)/(v-h)))?i+Math.PI-f:-(a=Math.PI-i+f):0;var d,p=Math.sqrt(Math.pow(t-h,2)+Math.pow(e-c,2));return d=t>=h&&e>=c?h===t?-Math.atan(1/0):Math.atan((e-c)/(t-h)):t>=h&&e<c?h===t?-Math.atan(1/0):-Math.atan((e-c)/(h-t)):t<h&&e>=c?Math.PI-Math.atan((e-c)/(h-t)):Math.atan((e-c)/(t-h))-Math.PI,(d-=a)>Math.PI?(d-=Math.PI,[(h-p*Math.cos(d))/o,(c-p*Math.sin(d))/s]):d>.5*Math.PI?(d=Math.PI-d,[(h-p*Math.cos(d))/o,(c+p*Math.sin(d))/s]):d>=0?[(h+p*Math.cos(d))/o,(c+p*Math.sin(d))/s]:d>=.5*-Math.PI?(d=-d,[(h+p*Math.cos(d))/o,(c-p*Math.sin(d))/s]):d>=-Math.PI?(d=Math.PI+d,[(h-p*Math.cos(d))/o,(c-p*Math.sin(d))/s]):(d=-Math.PI-d,[(h-p*Math.cos(d))/o,(c+p*Math.sin(d))/s])},pointOnCircle:function(t,e,r,i){return i>=270?(i=Xt(i-=270),[t-Math.cos(i)*r,e-Math.sin(i)*r]):i>=180?(i=Xt(i-=180),[t-Math.sin(i)*r,e+Math.cos(i)*r]):i>=90?(i=Xt(i-=90),[t+Math.cos(i)*r,e+Math.sin(i)*r]):(i=Xt(i),[t+Math.sin(i)*r,e-Math.cos(i)*r])}};var Vt={getConicGradientImage:function(t,e,r,i,a,n){if(a.length<2)throw new Error("Conic gradient should recieve at least 2 gradient statements (start line and end line).");r=Math.floor(r),i=Math.floor(i);for(var o=function(r,i){var a=r-t,n=e-i;if(0===a)return n<0?1*Math.PI:0;if(0===n)return a<0?1.5*Math.PI:.5*Math.PI;var o=Math.atan(n/a);return a>0?.5*Math.PI-o:a<0?1.5*Math.PI-o:void 0},s=a.map((function(t){return{color:t[0],angle:t[1]*Math.PI*2}})),l=0;l<i;l++)for(var h=function(t){var e=o(t,l),i=void 0;for(i=0;i<s.length&&s[i].angle<=e;i++);var a=s[i-1],h=s[i];if(!a||!h)return"continue";var u=(e-a.angle)/(h.angle-a.angle),c=h.color.map((function(t,e){return u*(t-a.color[e])+a.color[e]})),f=4*(t+l*r);n[f]=c[0],n[f+1]=c[1],n[f+2]=c[2],n[f+3]=Math.min(255,255*c[3])},u=0;u<r;u++)h(u);return n}},Kt=G.int2rgba;function jt(t){var e="";return t.forEach((function(t){var r=t.k,i=t.v;"blur"===r?e+="blur(".concat(i,"px)"):"dropShadow"===r?e+="drop-shadow(".concat(i[0],"px ").concat(i[1],"px ").concat(i[2],"px ").concat(Kt(i[4]),")"):"hueRotate"===r?e+="hue-rotate(".concat(i,"deg)"):"saturate"!==r&&"brightness"!==r&&"grayscale"!==r&&"contrast"!==r&&"sepia"!==r&&"invert"!==r||(e+="".concat(r,"(").concat(i,"%)"))})),e}var Zt={canvasPolygon:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e&&e.length){for(var a=-1,n=0,o=e.length;n<o;n++){var s=e[n];if(Array.isArray(s)&&s.length){a=n;break}}if(-1!==a){var l=e[a];t.moveTo(l[0]+r,l[1]+i),4===l.length?t.moveTo(l[2]+r,l[3]+i):6===l.length&&t.moveTo(l[4]+r,l[5]+i);for(var h=a+1,u=e.length;h<u;h++){var c=e[h];Array.isArray(c)&&(2===c.length?t.lineTo(c[0]+r,c[1]+i):4===c.length?t.quadraticCurveTo(c[0]+r,c[1]+i,c[2]+r,c[3]+i):6===c.length&&t.bezierCurveTo(c[0]+r,c[1]+i,c[2]+r,c[3]+i,c[4]+r,c[5]+i))}}}},svgPolygon:function(t){if(!t||!t.length)return"";for(var e=-1,r=0,i=t.length;r<i;r++){var a=t[r];if(Array.isArray(a)&&a.length){e=r;break}}if(-1===e)return"";var n=t[e],o="M"+n[0]+","+n[1];4===n.length?o="M"+n[2]+","+n[3]:6===n.length&&(o="M"+n[4]+","+n[5]);for(var s=e+1,l=t.length;s<l;s++){var h=t[s];Array.isArray(h)&&(2===h.length?o+="L"+h[0]+","+h[1]:4===h.length?o+="Q"+h[0]+","+h[1]+" "+h[2]+","+h[3]:6===h.length&&(o+="C"+h[0]+","+h[1]+" "+h[2]+","+h[3]+" "+h[4]+","+h[5]))}return o},canvasLine:function(t,e,r,i,a,n,o,s){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;return t.moveTo(e+l,r+h),3===s?(t.bezierCurveTo(n[0]+l,n[1]+h,o[0]+l,o[1],i+l,a+h),2):2===s?(t.quadraticCurveTo(o[0]+l,o[1]+h,i+l,a+h),2):1===s?(t.quadraticCurveTo(n[0]+l,n[1]+h,i+l,a+h),2):(t.lineTo(i+l,a+h),1)},svgLine:function(t,e,r,i,a,n,o){return 3===o?"M"+t+","+e+"C"+a[0]+","+a[1]+" "+n[0]+","+n[1]+" "+r+","+i:2===o?"M"+t+","+e+"Q"+n[0]+","+n[1]+" "+r+","+i:1===o?"M"+t+","+e+"Q"+a[0]+","+a[1]+" "+r+","+i:"M"+t+","+e+"L"+r+","+i},canvasFilter:jt,svgFilter:jt},qt=Ut.H,$t=d.PX,Jt=d.PERCENT,Qt=d.REM,te=d.VW,ee=d.VH,re=d.VMAX,ie=d.VMIN,ae=Zt.canvasPolygon,ne=Zt.svgPolygon,oe=Ct.STYLE_KEY,se=oe.BORDER_LEFT_WIDTH,le=oe.BORDER_TOP_WIDTH,he=oe.BORDER_BOTTOM_WIDTH,ue=oe.PADDING_LEFT,ce=oe.PADDING_BOTTOM,fe=oe.PADDING_TOP,_e=oe.BORDER_TOP_LEFT_RADIUS,ve=oe.BORDER_TOP_RIGHT_RADIUS,ye=oe.BORDER_BOTTOM_LEFT_RADIUS,de=oe.BORDER_BOTTOM_RIGHT_RADIUS,pe=oe.FONT_SIZE;function xe(t,e,r,i,a,n,o,s){var l=1,h=1,u=1;t:for(var c=n;c>=a;c--)for(var f=s;f>=o;f--){var _=c+f,v=Math.floor((t+f)/_),y=f;if(v*_<f+t)if((y=(t-v*c)/(v-1))>s)continue;if(_=c+y,e>1&&e>c){if(e%_>c)continue;if(r>1)if((e+i)%_>c)continue}if(r>1)if((e+i)%_>c)continue;v>0&&(l=v,h=c,u=y);break t}return{n:l,ps:h,pd:u}}function ge(t,e,r,i,a,n){var o=a-e,s=i-r,l=r-e,h=a-i;if("dotted"===t)return xe(o,l,h,s,n,n,Math.max(1,.25*n),2*n);var u=xe(o,l,h,s,n,3*n,Math.max(1,.25*n),2*n),c=u.n,f=u.ps,_=u.pd;return 1===c?xe(o,l,h,s,n,n,Math.max(1,.25*n),2*n):{n:c,ps:f,pd:_}}function me(t,e,r,i,a,n,o,s,l,h,c,f,_,v){var y=u(_,2),d=y[0],p=y[1],x=u(v,2),g=x[0],m=x[1];if(!(d&&p||g&&m))return f;for(var b=a+d-(a-i),M=n-g+(o-n),E=[],A=[],S=[],T=0,w=f.length;T<w;T++){var R=f[T];if(R[1][0]<b)E.push(R);else if(R[0][0]>M)S.push(R);else if(R[1][0]>M&&R[0][0]<b){var k=b<a?s+Math.tan(e)*(b-i):l,C=M>n?s+Math.tan(r)*(o-M):l;E.push([R[0],[b,s],[b,k],R[3]]),b<M&&(b>a&&M<n?A.push([[b,s],[M,s],[M,l],[b,l]]):b>a?(A.push([[b,s],[n,s],[n,l],[b,l]]),A.push([[n,s],[M,s],[M,C],[n,l]])):M<n?(A.push([[b,s],[a,s],[a,l],[b,k]]),A.push([[a,s],[M,s],[M,l],[a,l]])):(A.push([[b,s],[a,s],[a,l],[b,k]]),A.push([[a,s],[n,s],[n,l],[a,l]]),A.push([[n,s],[M,s],[M,C],[n,l]]))),S.push([[M,s],R[1],R[2],[M,C]])}else if(R[1][0]>M){var O=M>n?s+Math.tan(r)*(o-M):l;A.push([R[0],[M,s],[M,O],R[3]]),S.push([[M,s],R[1],R[2],[M,O]])}else if(R[0][0]<b){var I=b<a?s+Math.tan(e)*(b-i):l;E.push([R[0],[b,s],[b,I],R[3]]),A.push([[b,s],R[1],R[2],[b,I]])}else A.push(R)}if(E.length){var F,L,D,B,P,N=d>a-i&&t<p,G=Math.atan((a-i)/(l-s)),H=p,W=H/d,Y=s+p,z=p-(l-s),X=z/(d-(a-i)),U=be(E[0][0],E[0][1],b,Y,W,H,!0,Math.tan(G)*H),V=u(U[0],2);if(F=V[0],L=V[1],N){var K=u((P=be(E[0][3],E[0][2],b,Y,X,z,!0,Math.tan(G)*z))[0],2);D=K[0],B=K[1]}E.forEach((function(t,e){var r,i;0===e?(r=U,N&&(i=P)):(r=be(t[0],t[1],b,Y,W,H),N&&(i=be(t[3],t[2],b,Y,X,z)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],F,L,0);if(t[0]=r[0],r[1]&&(t[1]=r[1].concat(r[2]).concat(r[3])),N){for(var o=0,s=i.length;o<s;o++)Ie(i[o],D,B,0);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}}))}var j=S.length;if(j){var Z,q,$,J,Q,tt=g>o-n&&t<m,et=Math.atan((o-n)/(l-s)),rt=m,it=rt/g,at=s+m,nt=m-(l-s),ot=nt/(g-(o-n)),st=Me(S[j-1][0],S[j-1][1],M,at,it,rt,!0,Math.tan(et)*rt),lt=u(st[st.length-1],2);if(Z=lt[0],q=lt[1],tt){var ht=u((Q=Me(S[j-1][3],S[j-1][2],M,at,ot,nt,!0,Math.tan(et)*nt))[Q.length-1],2);$=ht[0],J=ht[1]}S.forEach((function(t,e){var r,i;e===j-1?(r=st,tt&&(i=Q)):(r=Me(t[0],t[1],M,at,it,rt),tt&&(i=Me(t[3],t[2],M,at,ot,nt)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],Z,q,1);if(t[0]=r[0],r[1]&&(t[1]=r[1].concat(r[2]).concat(r[3])),tt){for(var o=0,s=i.length;o<s;o++)Ie(i[o],$,J,1);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}}))}return E.concat(A).concat(S)}function be(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(-_+r)*a,g=(-d+r)*a,m=Math.atan(g/(i-p)),b=r-Math.sin(m)*n/a,M=i-Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r-Math.cos(w)*n/a,c=i-Math.sin(w)*n}else l=Math.atan(x/(i-v)),h=r-Math.sin(l)*n/a,c=i-Math.cos(l)*n;if(l===m)return[[h,c]];var R=Ut.h(Math.abs(l-m))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=l-C,I=m+C;return[[h,c],[r-Math.sin(O)*k/a,i-Math.cos(O)*k],[r-Math.sin(I)*k/a,i-Math.cos(I)*k],[b,M]]}function Me(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(_-r)*a,g=(d-r)*a,m=Math.atan(x/(i-v)),b=r+Math.sin(m)*n/a,M=i-Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r+Math.cos(w)*n/a,c=i-Math.sin(w)*n}else l=Math.atan(g/(i-p)),h=r+Math.sin(l)*n/a,c=i-Math.cos(l)*n;if(m===l)return[[b,M]];var R=Ut.h(Math.abs(m-l))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=m+C,I=l-C;return[[b,M],[r+Math.sin(O)*k/a,i-Math.cos(O)*k],[r+Math.sin(I)*k/a,i-Math.cos(I)*k],[h,c]]}function Ee(t,e,r,i,a,n,o,s,l,h,c,f,_,v){var y=u(_,2),d=y[0],p=y[1],x=u(v,2),g=x[0],m=x[1];if(!(d&&p||g&&m))return f;for(var b=l+p-(l-s),M=h-m+(c-h),E=[],A=[],S=[],T=0,w=f.length;T<w;T++){var R=f[T];if(R[2][1]<b)E.push(R);else if(R[1][1]>M)S.push(R);else if(R[2][1]>M&&R[1][1]<b){var k=b<l?n+Math.tan(r)*(l-b):n,C=M>h?n+Math.tan(e)*(M-h):n;E.push([R[0],R[1],[o,b],[k,b]]),b<M&&(M<h&&b>l?A.push([[n,b],[o,b],[o,M],[n,M]]):b>l?(A.push([[n,l],[o,l],[o,h],[n,h]]),A.push([[n,h],[o,h],[o,M],[C,M]])):M<h?(A.push([[k,b],[o,b],[o,l],[n,l]]),A.push([[n,l],[o,l],[o,M],[n,M]])):(A.push([[k,b],[o,b],[o,l],[n,l]]),A.push([[n,l],[o,l],[o,h],[n,h]]),A.push([[n,h],[o,h],[o,M],[C,M]]))),S.push([[C,M],[o,M],R[2],R[3]])}else if(R[2][1]>M){var O=M>h?n+Math.tan(e)*(M-h):n;A.push([R[0],R[1],[o,M],[O,M]]),S.push([[O,M],[o,M],R[2],R[3]])}else if(R[1][1]<b){var I=b<l?n+Math.tan(r)*(l-b):n;E.push([R[0],R[1],[o,b],[I,b]]),A.push([[I,b],[o,b],R[2],R[3]])}else A.push(R)}if(E.length){var F,L,D,B,P,N=p>l-s&&t<d,G=Math.atan((o-n)/(l-s)),H=p,W=H/d,Y=o-d,z=p-(l-s),X=z/(d-(o-n)),U=Ae(E[0][1],E[0][2],Y,b,W,H,!0,Math.tan(G)*H),V=u(U[U.length-1],2);if(F=V[0],L=V[1],N){var K=u((P=Ae(E[0][0],E[0][3],Y,b,X,z,!0,Math.tan(G)*z))[P.length-1],2);D=K[0],B=K[1]}E.forEach((function(t,e){var r,i;0===e?(r=U,N&&(i=P)):(r=Ae(t[1],t[2],Y,b,W,H),N&&(i=Ae(t[0],t[3],Y,b,X,z)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],F,L,2);if(N){for(var o=0,s=i.length;o<s;o++)Ie(i[o],D,B,2);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[2]=t[3],t[3]=t[0];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}))}var j=S.length;if(j){var Z,q,$,J,Q,tt=m>c-h&&t<g,et=Math.atan((o-n)/(c-h)),rt=m,it=rt/g,at=o-g,nt=m-(c-h),ot=nt/(g-(o-n)),st=Se(S[j-1][1],S[j-1][2],at,M,it,rt,!0,Math.tan(et)*rt),lt=u(st[0],2);if(Z=lt[0],q=lt[1],tt){var ht=u((Q=Se(S[j-1][0],S[j-1][3],at,M,ot,nt,!0,Math.tan(et)*nt))[0],2);$=ht[0],J=ht[1]}S.forEach((function(t,e){var r,i;e===j-1?(r=st,tt&&(i=Q)):(r=Se(t[1],t[2],at,M,it,rt),tt&&(i=Se(t[0],t[3],at,M,ot,nt)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],Z,q,3);if(tt){for(var o=0,s=i.length;o<s;o++)Ie(i[o],$,J,3);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[2]=t[3],t[3]=t[0];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}))}return E.concat(A).concat(S)}function Ae(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(_-r)*a,g=(d-r)*a,m=Math.atan(g/(i-p)),b=r+Math.sin(m)*n/a,M=i-Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r+Math.cos(w)*n/a,c=i-Math.sin(w)*n}else l=Math.atan(x/(i-v)),h=r+Math.sin(l)*n/a,c=i-Math.cos(l)*n;if(l===m)return[[h,c]];var R=Ut.h(Math.abs(l-m))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=l+C,I=r+Math.sin(O)*k/a,F=i-Math.cos(O)*k,L=m-C;return[[b,M],[r+Math.sin(L)*k/a,i-Math.cos(L)*k],[I,F],[h,c]]}function Se(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(_-r)*a,g=(d-r)*a,m=Math.atan(x/(v-i)),b=r+Math.sin(m)*n/a,M=i+Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r+Math.cos(w)*n/a,c=i+Math.sin(w)*n}else l=Math.atan(g/(p-i)),h=r+Math.sin(l)*n/a,c=i+Math.cos(l)*n;if(m===l)return[[b,M]];var R=Ut.h(Math.abs(m-l))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=m-C,I=r+Math.sin(O)*k/a,F=i+Math.cos(O)*k,L=l+C;return[[h,c],[r+Math.sin(L)*k/a,i+Math.cos(L)*k],[I,F],[b,M]]}function Te(t,e,r,i,a,n,o,s,l,h,c,f,_,v){var y=u(_,2),d=y[0],p=y[1],x=u(v,2),g=x[0],m=x[1];if(!(d&&p||g&&m))return f;for(var b=a+d-(a-i),M=n-g+(o-n),E=[],A=[],S=[],T=0,w=f.length;T<w;T++){var R=f[T];if(R[2][0]<b)E.push(R);else if(R[3][0]>M)S.push(R);else if(R[2][0]>M&&R[3][0]<b){var k=b<a?c-Math.tan(e)*(b-i):l,C=M>n?c-Math.tan(r)*(o-M):h;E.push([R[0],[b,k],[b,c],R[3]]),b<M&&(b>a&&M<n?A.push([[b,h],[M,h],[M,c],[b,c]]):b>a?(A.push([[b,h],[n,h],[n,c],[b,c]]),A.push([[n,h],[M,C],[M,c],[n,c]])):M<n?(A.push([[b,k],[a,h],[a,c],[b,c]]),A.push([[a,h],[M,h],[M,c],[a,c]])):(A.push([[b,k],[a,h],[a,c],[b,c]]),A.push([[a,h],[n,h],[n,c],[a,c]]),A.push([[n,h],[M,C],[M,c],[n,c]]))),S.push([[M,C],R[1],R[2],[M,c]])}else if(R[2][0]>M){var O=M>n?c-Math.tan(r)*(o-M):h;A.push([R[0],[M,O],[M,c],R[3]]),S.push([[M,O],R[1],R[2],[M,c]])}else if(R[3][0]<b){var I=b<a?c-Math.tan(e)*(b-i):h;E.push([R[0],[b,I],[b,c],R[3]]),A.push([[b,I],R[1],R[2],[b,c]])}else A.push(R)}if(E.length){var F,L,D,B,P,N=d>a-i&&t<p,G=Math.atan((a-i)/(c-h)),H=p,W=H/d,Y=c-p,z=p-(c-h),X=z/(d-(a-i)),U=we(E[0][3],E[0][2],b,Y,W,H,!0,Math.tan(G)*H),V=u(U[0],2);if(F=V[0],L=V[1],N){var K=u((P=we(E[0][0],E[0][1],b,Y,X,z,!0,Math.tan(G)*z))[0],2);D=K[0],B=K[1]}E.forEach((function(t,e){var r,i;0===e?(r=U,N&&(i=P)):(r=we(t[3],t[2],b,Y,W,H),N&&(i=we(t[0],t[1],b,Y,X,z)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],F,L,4);if(N){for(var o=0,s=i.length;o<s;o++)Ie(i[o],D,B,4);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}else t[2]=t[1],t[3]=t[0];t[0]=r[0],r[1]&&(t[1]=r[1].concat(r[2]).concat(r[3]))}))}var j=S.length;if(j){var Z,q,$,J,Q,tt=g>o-n&&t<m,et=Math.atan((o-n)/(c-h)),rt=m,it=rt/g,at=c-m,nt=m-(c-h),ot=nt/(g-(o-n)),st=Re(S[j-1][3],S[j-1][2],M,at,it,rt,!0,Math.tan(et)*rt),lt=u(st[st.length-1],2);if(Z=lt[0],q=lt[1],tt){var ht=u((Q=Re(S[j-1][0],S[j-1][1],M,at,ot,nt,!0,Math.tan(et)*nt))[Q.length-1],2);$=ht[0],J=ht[1]}S.forEach((function(t,e){var r,i;e===j-1?(r=st,tt&&(i=Q)):(r=Re(t[3],t[2],M,at,it,rt),tt&&(i=Re(t[0],t[1],M,at,ot,nt)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],Z,q,5);if(tt){for(var o=0,s=i.length;o<s;o++)Ie(i[o],$,J,5);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}else t[2]=t[1],t[3]=t[0];t[0]=r[0],r[1]&&(t[1]=r[1].concat(r[2]).concat(r[3]))}))}return E.concat(A).concat(S)}function we(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(-_+r)*a,g=(-d+r)*a,m=Math.atan(g/(p-i)),b=r-Math.sin(m)*n/a,M=i+Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r-Math.cos(w)*n/a,c=i+Math.sin(w)*n}else l=Math.atan(x/(v-i)),h=r-Math.sin(l)*n/a,c=i+Math.cos(l)*n;if(l===m)return[[h,c]];var R=Ut.h(Math.abs(l-m))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=l-C,I=m+C;return[[h,c],[r-Math.sin(O)*k/a,i+Math.cos(O)*k],[r-Math.sin(I)*k/a,i+Math.cos(I)*k],[b,M]]}function Re(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(_-r)*a,g=(d-r)*a,m=Math.atan(x/(v-i)),b=r+Math.sin(m)*n/a,M=i+Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r+Math.cos(w)*n/a,c=i+Math.sin(w)*n}else l=Math.atan(g/(p-i)),h=r+Math.sin(l)*n/a,c=i+Math.cos(l)*n;if(m===l)return[[b,M]];var R=Ut.h(Math.abs(m-l))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=m+C,I=l-C;return[[b,M],[r+Math.sin(O)*k/a,i+Math.cos(O)*k],[r+Math.sin(I)*k/a,i+Math.cos(I)*k],[h,c]]}function ke(t,e,r,i,a,n,o,s,l,h,c,f,_,v){var y=u(_,2),d=y[0],p=y[1],x=u(v,2),g=x[0],m=x[1];if(!(d&&p||g&&m))return f;for(var b=l+p-(l-s),M=h-m+(c-h),E=[],A=[],S=[],T=0,w=f.length;T<w;T++){var R=f[T];if(R[3][1]<b)E.push(R);else if(R[0][1]>M)S.push(R);else if(R[3][1]>M&&R[0][1]<b){var k=b<l?a-Math.tan(r)*(l-b):a,C=M>h?a-Math.tan(e)*(M-h):a;E.push([R[0],R[1],[k,b],[i,b]]),b<M&&(M<h&&b>l?A.push([[i,b],[a,b],[a,M],[i,M]]):b>l?(A.push([[i,b],[a,b],[a,h],[i,h]]),A.push([[i,h],[a,h],[C,M],[i,M]])):M<h?(A.push([[i,b],[k,b],[a,l],[i,l]]),A.push([[i,l],[a,l],[a,M],[i,M]])):(A.push([[i,b],[k,b],[a,l],[i,l]]),A.push([[i,l],[a,l],[a,h],[i,h]]),A.push([[i,h],[a,h],[C,M],[i,M]]))),S.push([[i,M],[C,M],R[2],R[3]])}else if(R[3][1]>M){var O=M>h?a-Math.tan(e)*(M-h):a;A.push([R[0],R[1],[O,M],[i,M]]),S.push([[i,M],[O,M],R[2],R[3]])}else if(R[1][1]<b){var I=b<l?a-Math.tan(r)*(l-b):a;E.push([R[0],R[1],[I,b],[i,b]]),A.push([[i,b],[I,b],R[2],R[3]])}else A.push(R)}if(E.length){var F,L,D,B,P,N=p>l-s&&t<d,G=Math.atan((a-i)/(l-s)),H=p,W=H/d,Y=i+d,z=p-(l-s),X=z/(d-(a-i)),U=Ce(E[0][0],E[0][3],Y,b,W,H,!0,Math.tan(G)*H),V=u(U[U.length-1],2);if(F=V[0],L=V[1],N){var K=u((P=Ce(E[0][1],E[0][2],Y,b,X,z,!0,Math.tan(G)*z))[P.length-1],2);D=K[0],B=K[1]}E.forEach((function(t,e){var r,i;0===e?(r=U,N&&(i=P)):(r=Ce(t[0],t[3],Y,b,W,H),N&&(i=Ce(t[1],t[2],Y,b,X,z)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],F,L,6);if(N){for(var o=0,s=i.length;o<s;o++)Ie(i[o],D,B,6);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[3]=t[1];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}))}var j=S.length;if(j){var Z,q,$,J,Q,tt=m>c-h&&t<g,et=Math.atan((a-i)/(c-h)),rt=m,it=rt/g,at=i+g,nt=m-(c-h),ot=nt/(g-(a-i)),st=Oe(S[j-1][0],S[j-1][3],at,M,it,rt,!0,Math.tan(et)*rt),lt=u(st[0],2);if(Z=lt[0],q=lt[1],tt){var ht=u((Q=Oe(S[j-1][1],S[j-1][2],at,M,ot,nt,!0,Math.tan(et)*nt))[0],2);$=ht[0],J=ht[1]}S.forEach((function(t,e){var r,i;e===j-1?(r=st,tt&&(i=Q)):(r=Oe(t[0],t[3],at,M,it,rt),tt&&(i=Oe(t[1],t[2],at,M,ot,nt)));for(var a=0,n=r.length;a<n;a++)Ie(r[a],Z,q,7);if(tt){for(var o=0,s=i.length;o<s;o++)Ie(i[o],$,J,7);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[3]=t[1];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}))}return E.concat(A).concat(S)}function Ce(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(r-_)*a,g=(r-d)*a,m=Math.atan(g/(i-p)),b=r-Math.sin(m)*n/a,M=i-Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r-Math.cos(w)*n/a,c=i-Math.sin(w)*n}else l=Math.atan(x/(i-v)),h=r-Math.sin(l)*n/a,c=i-Math.cos(l)*n;if(l===m)return[[h,c]];var R=Ut.h(Math.abs(l-m))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=l+C,I=r-Math.sin(O)*k/a,F=i-Math.cos(O)*k,L=m-C;return[[b,M],[r-Math.sin(L)*k/a,i-Math.cos(L)*k],[I,F],[h,c]]}function Oe(t,e,r,i,a,n,o,s){var l,h,c,f=u(t,2),_=f[0],v=f[1],y=u(e,2),d=y[0],p=y[1],x=(r-_)*a,g=(r-d)*a,m=Math.atan(x/(v-i)),b=r-Math.sin(m)*n/a,M=i+Math.cos(m)*n;if(o){var E=s*a,A=Math.atan(E/n),S=Math.sqrt(Math.tan(A)/2),T=S/(1+S),w=2*Math.atan(T);l=.5*Math.PI-w,h=r-Math.cos(w)*n/a,c=i+Math.sin(w)*n}else l=Math.atan(g/(p-i)),h=r-Math.sin(l)*n/a,c=i+Math.cos(l)*n;if(m===l)return[[b,M]];var R=Ut.h(Math.abs(m-l))*n,k=Math.sqrt(Math.pow(n,2)+Math.pow(R,2)),C=Math.atan(R/n),O=m-C,I=r-Math.sin(O)*k/a,F=i+Math.cos(O)*k,L=l+C;return[[h,c],[r-Math.sin(L)*k/a,i+Math.cos(L)*k],[I,F],[b,M]]}function Ie(t,e,r,i){0===i?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],r)):1===i?(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r)):2===i?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],r)):3===i?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],r)):4===i?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],r)):5===i||6===i?(t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],r)):7===i&&(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r))}var Fe=[_e,ve,de,ye];var Le={calPoints:function(t,e,r,i,a,n,o,s,l,h,u,c,f,_,v){var y=[];if("none"===e)return y;if(["dashed","dotted"].indexOf(e)>-1){var d=0===f||2===f?ge(e,a,n,o,s,t):ge(e,l,h,u,c,t),p=d.n,x=d.ps,g=d.pd;if(p>1){for(var m=0;m<p;m++){var b,M=m===p-1,E=void 0,A=void 0,S=void 0;b=(E=0===f||2===f?m?a+x*m+g*m:a:m?l+x*m+g*m:l)+x,0===f?b<=n?M?y.push([[a,l],[s,l],[o,h],[n,h]]):(A=l+(E-a)*Math.tan(r),S=l+(b-a)*Math.tan(r),y.push([[E,l],[b,l],[b,S],[E,A]])):E>=o?(A=l+(s-E)*Math.tan(i),S=l+(s-b)*Math.tan(i),M?y.push([[E,l],[s,l],[s,l],[E,A]]):y.push([[E,l],[b,l],[b,S],[E,A]])):E<n?(A=l+(E-a)*Math.tan(r),y.push([[E,l],[n,l],[n,h],[E,A]]),M?(y.push([[n,l],[o,l],[o,h],[n,h]]),y.push([[o,l],[s,l],[s,l],[n,h]])):b>o?(S=l+(s-b)*Math.tan(i),y.push([[n,l],[o,l],[o,h],[n,h]]),y.push([[o,l],[b,l],[b,S],[o,h]])):y.push([[n,l],[b,l],[b,h],[n,h]])):b>o?(A=l+(s-b)*Math.tan(i),E<n?(S=l+(E-a)*Math.tan(r),y.push([[E,l],[n,l],[n,h],[E,S]]),y.push([[n,l],[o,l],[o,h],[n,h]]),M?y.push([[o,l],[s,l],[s,l],[o,h]]):y.push([[o,l],[b,l],[b,A],[o,h]])):(y.push([[E,l],[o,l],[o,h],[E,h]]),M?y.push([[o,l],[s,l],[s,l],[o,h]]):y.push([[o,l],[b,l],[b,A],[o,h]]))):M?y.push([[E,l],[s,l],[o,h],[E,h]]):y.push([[E,l],[b,l],[b,h],[E,h]]):1===f?b<=h?M?y.push([[o,h],[s,l],[s,c],[o,u]]):(A=s-(E-l)*Math.tan(r),S=s-(b-l)*Math.tan(r),y.push([[A,E],[s,E],[s,b],[S,b]])):E>=u?(A=o+(E-u)*Math.tan(i),S=o+(b-u)*Math.tan(i),M?y.push([[A,E],[s,E],[s,c],[s,c]]):y.push([[A,E],[s,E],[s,b],[S,b]])):E<h?(A=o+(h-E)*Math.tan(r),y.push([[A,E],[s,E],[s,h],[o,h]]),M?(y.push([[o,h],[s,h],[s,u],[o,u]]),y.push([[o,u],[s,u],[s,c],[s,c]])):b>u?(S=o+(b-u)*Math.tan(i),y.push([[o,h],[s,h],[s,u],[o,u]]),y.push([[o,u],[s,u],[s,b],[S,b]])):y.push([[o,h],[s,h],[s,b],[o,b]])):b>u?(A=o+(b-u)*Math.tan(i),E<h?(S=o+(h-E)*Math.tan(r),y.push([[S,E],[s,E],[s,h],[o,h]]),y.push([[o,h],[s,h],[s,u],[o,u]]),M?y.push([[o,u],[s,u],[s,s],[s,s]]):y.push([[o,u],[s,u],[s,b],[A,b]])):(y.push([[o,E],[s,E],[s,u],[o,u]]),M?y.push([[o,u],[s,u],[s,c],[s,c]]):y.push([[o,u],[s,u],[s,b],[A,b]]))):M?y.push([[o,E],[s,E],[s,c],[o,u]]):y.push([[o,E],[s,E],[s,b],[o,b]]):2===f?b<=n?M?y.push([[a,c],[n,u],[o,u],[s,c]]):(A=c-(E-a)*Math.tan(r),S=c-(b-a)*Math.tan(r),y.push([[E,A],[b,S],[b,c],[E,c]])):E>=o?(A=c-(s-E)*Math.tan(i),S=c-(s-b)*Math.tan(i),M?y.push([[E,A],[s,c],[s,c],[E,c]]):y.push([[E,A],[b,S],[b,c],[E,c]])):E<n?(A=c-(E-a)*Math.tan(r),y.push([[E,A],[n,u],[n,c],[E,c]]),M?(y.push([[n,u],[o,u],[o,c],[n,c]]),y.push([[o,u],[s,c],[s,c],[o,c]])):b>o?(S=c-(b-o)*Math.tan(i),y.push([[n,u],[o,u],[o,c],[n,c]]),y.push([[o,u],[b,S],[b,c],[o,c]])):y.push([[n,u],[b,u],[b,c],[n,c]])):b>o?(A=c-(s-b)*Math.tan(i),E<n?(S=c-(E-o)*Math.tan(r),y.push([[E,S],[n,u],[n,c],[E,c]]),y.push([[n,u],[o,u],[o,c],[n,c]]),M?y.push([[o,u],[s,c],[s,c],[o,c]]):y.push([[o,u],[b,A],[b,c],[o,c]])):(y.push([[E,u],[o,u],[o,c],[E,c]]),M?y.push([[o,u],[s,c],[s,c],[o,c]]):y.push([[o,u],[b,A],[b,c],[o,c]]))):M?y.push([[E,u],[o,u],[s,c],[E,c]]):y.push([[E,u],[b,u],[b,c],[E,c]]):3===f&&(b<=h?M?y.push([[a,l],[n,h],[n,u],[a,c]]):(A=a+(E-l)*Math.tan(r),S=a+(b-l)*Math.tan(r),y.push([[a,E],[A,E],[S,b],[a,b]])):E>=u?(A=a+(c-E)*Math.tan(i),S=a+(c-b)*Math.tan(i),M?y.push([[a,E],[A,E],[a,c],[a,c]]):y.push([[a,E],[A,E],[S,b],[a,b]])):E<h?(A=a+(E-l)*Math.tan(r),y.push([[a,E],[A,E],[n,h],[a,h]]),M?(y.push([[a,h],[n,h],[n,u],[a,u]]),y.push([[a,u],[n,u],[a,c],[a,c]])):b>u?(S=a+(c-b)*Math.tan(i),y.push([[a,h],[n,h],[n,u],[a,u]]),y.push([[a,u],[n,u],[S,b],[a,b]])):y.push([[a,h],[n,h],[n,b],[a,b]])):b>u?(A=a+(c-b)*Math.tan(i),E<h?(S=a+(E-l)*Math.tan(r),y.push([[a,E],[S,E],[n,h],[a,l]]),y.push([[a,h],[n,h],[n,u],[a,u]]),M?y.push([[a,u],[n,u],[a,c],[a,c]]):y.push([[a,u],[n,u],[A,b],[a,b]])):(y.push([[a,E],[n,E],[n,u],[a,u]]),M?y.push([[a,u],[n,u],[a,c],[a,c]]):y.push([[a,u],[n,u],[A,b],[a,b]]))):M?y.push([[a,E],[n,E],[n,u],[a,c]]):y.push([[a,E],[n,E],[n,b],[a,b]]))}if(0===f)return me(t,r,i,a,n,o,s,l,h,u,c,y,_,v);if(1===f)return Ee(t,r,i,a,n,o,s,l,h,u,c,y,_,v);if(2===f)return Te(t,r,i,a,n,o,s,l,h,u,c,y,_,v);if(3===f)return ke(t,r,i,a,n,o,s,l,h,u,c,y,_,v)}}return 0===f?(n>a&&y.push([[a,l],[n,l],[n,h],[a,l]]),y.push([[n,l],[o,l],[o,h],[n,h]]),s>o&&y.push([[o,l],[s,l],[s,l],[o,h]]),me(t,r,i,a,n,o,s,l,h,u,c,y,_,v)):1===f?(h>l&&y.push([[s,l],[s,l],[s,h],[o,h]]),y.push([[o,h],[s,h],[s,u],[o,u]]),c>u&&y.push([[o,u],[s,u],[s,c],[s,c]]),Ee(t,r,i,a,n,o,s,l,h,u,c,y,_,v)):2===f?(n>a&&y.push([[a,c],[n,u],[n,c],[a,c]]),y.push([[n,u],[o,u],[o,c],[n,c]]),s>o&&y.push([[o,u],[s,c],[s,c],[o,c]]),Te(t,r,i,a,n,o,s,l,h,u,c,y,_,v)):3===f?(h>l&&y.push([[a,l],[a,l],[n,h],[a,h]]),y.push([[a,h],[n,h],[n,u],[a,u]]),c>u&&y.push([[a,u],[n,u],[a,c],[a,c]]),ke(t,r,i,a,n,o,s,l,h,u,c,y,_,v)):void 0},calRadius:function(t,e,r,i,a,n,o,s){var l,h=u(a,2),c=h[0],f=h[1],_=u(n,2),v=_[0],y=_[1],d=u(o,2),p=d[0],x=d[1],g=u(s,2),m=g[0],b=g[1];if(c=Math.max(c,0),f=Math.max(f,0),v=Math.max(v,0),y=Math.max(y,0),p=Math.max(p,0),x=Math.max(x,0),m=Math.max(m,0),b=Math.max(b,0),(c>0&&f>0||v>0&&y>0||p>0&&x>0||m>0&&b>0)&&(l=!0),l){var M=[];return c>0&&f>0?(M.push([t,e+f]),M.push([t,e+f*(1-qt),t+c*(1-qt),e,t+c,e])):M.push([t,e]),v>0&&y>0?(M.push([t+r-v,e]),M.push([t+r-v*(1-qt),e,t+r,e+y*(1-qt),t+r,e+y])):M.push([t+r,e]),p>0&&x>0?(M.push([t+r,e+i-x]),M.push([t+r,e+i-x*(1-qt),t+r-p*(1-qt),e+i,t+r-p,e+i])):M.push([t+r,e+i]),m>0&&b>0?(M.push([t+m,e+i]),M.push([t+m*(1-qt),e+i,t,e+i-b*(1-qt),t,e+i-b])):M.push([t,e+i]),M}},calBorderRadius:function(t,e,r,i,a){var n=!0;Fe.forEach((function(o){i[o]=r[o].map((function(r,i){return r.v>0?(n=!1,r.u===$t?Math.max(0,r.v):r.u===Jt?Math.max(0,r.v*(i?e:t)*.01):r.u===Qt?Math.max(0,r.v*a.computedStyle[pe]):r.u===te?Math.max(0,r.v*a.width*.01):r.u===ee?Math.max(0,r.v*a.height*.01):r.u===re?Math.max(0,r.v*Math.max(a.width,a.height)*.01):r.u===ie?Math.max(0,r.v*Math.min(a.width,a.height)*.01):0):0}))})),n||Fe.forEach((function(r,a){var n=a%2==0?0:1,o=n?e:t,s=i[r],l=i[Fe[(a+1)%4]];if(s[n]+l[n]>o){var h=.5*o;s[n]>=h&&l[n]>=h?s[n]=l[n]=h:s[n]>h?s[n]=o-l[n]:l[n]>h&&(l[n]=o-s[n])}}))},calBorderRadiusInline:function(t,e,r){var i,a;t.length&&(i=t[0],(a=t[t.length-1]).isEllipsis&&(a=t[t.length-2]));var n=i?i.outerWidth:0,o=i?i.outerHeight:0;n+=r[se]+r[ue],o+=r[le]+r[he]+r[fe]+r[ce],[_e,ye].forEach((function(t){r[t]=e[t].map((function(t,e){var r;return t.u===$t?(r=Math.max(0,t.v),r=Math.min(e?o:n,r)):(r=Math.max(0,t.v*(e?o:n)*.01),r=Math.min(e?o:n,r)),r}))})),n=a?a.outerWidth:0,o=a?a.outerHeight:0,[ve,de].forEach((function(t){r[t]=e[t].map((function(t,e){var r;return t.u===$t?(r=Math.max(0,t.v),r=Math.min(e?o:n,r)):(r=Math.max(0,t.v*(e?o:n)*.01),r=Math.min(e?o:n,r)),r}))}))},renderBorder:function(t,e,r,i,a,n,o){if(e===y.CANVAS||e===y.WEBGL)r.beginPath(),r.fillStyle!==a&&(r.fillStyle=a),i.forEach((function(t){ae(r,t,n,o)})),r.fill(),r.closePath();else if(e===y.SVG){var s="";i.forEach((function(t){s+=ne(t)})),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",s],["fill",a]]})}}},De=G.rgba2int,Be=G.isNil,Pe=d.PX,Ne=d.PERCENT,Ge=d.DEG,He=d.NUMBER,We=d.REM,Ye=d.VW,ze=d.VH,Xe=d.VMAX,Ue=d.VMIN,Ve=d.calUnit,Ke=Ut.d2r,je=Zt.canvasPolygon,Ze=Ct.STYLE_KEY.FONT_SIZE;function qe(t){if(/^[-+]?[\d.]/.test(t)){var e=Ve(t);return[He,Ge].indexOf(e.u)>-1&&(e.v=Pe),e}return{v:{top:0,left:0,center:50,right:100,bottom:100}[t]||50,u:Ne}}function $e(t,e,r){for(var i=[],a=t[0][0],n=0,o=t.length;n<o;n++){var s=t[n];if(s.length>1){var l=s[1];l.u===Ne?i.push([s[0],.01*l.v]):l.u===We?i.push([s[0],l.v*r.computedStyle[Ze]/e]):l.u===Ye?i.push([s[0],l.v*r.width/e]):l.u===ze?i.push([s[0],l.v*r.height/e]):l.u===Xe?i.push([s[0],l.v*Math.max(r.width,r.height)/e]):l.u===Ue?i.push([s[0],l.v*Math.min(r.width,r.height)/e]):i.push([s[0],l.v/e])}else i.push([s[0]])}if(1===i.length&&i.push(G.clone(i[0])),1===i[0].length&&i[0].push(0),i.length>1){var h=i.length-1;1===i[h].length&&i[h].push(1)}for(var u=i[0][1],c=1,f=i.length;c<f-1;c++){var _=i[c];if(_.length>1)u=_[1];else{for(var v=c+1,y=i[i.length-1][1];v<f-1;v++){var d=i[v];if(d.length>1){y=d[1];break}}for(var p=(y-u)/(v-c+1),x=c;x<v;x++){i[x].push(u+p*(x+1-c))}c=v}}for(var g=1,m=i.length;g<m;g++){var b=i[g],M=i[g-1];b[1]<M[1]&&(b[1]=M[1])}for(var E=0,A=i.length;E<A;E++){var S=i[E];if(S[1]>1){i.splice(E);var T=i[E-1];if(T&&T[1]<1){var w=S[0][0]-T[0][0],R=S[0][1]-T[0][1],k=S[0][2]-T[0][2],C=S[0][3]-T[0][3],O=(1-T[1])/(S[1]-T[1]);i.push([[S[0][0]+w*O,S[0][1]+R*O,S[0][2]+k*O,S[0][3]+C*O],1])}break}}for(var I=i.length-1;I>=0;I--){var F=i[I];if(F[1]<0){i.splice(0,I+1);var L=i[I];if(L&&L[1]>0){var D=L[0][0]-F[0][0],B=L[0][1]-F[0][1],P=L[0][2]-F[0][2],N=L[0][3]-F[0][3],H=-F[1]/(L[1]-F[1]);i.unshift([[F[0][0]+D*H,F[0][1]+B*H,F[0][2]+P*H,F[0][3]+N*H],0])}break}}return i.forEach((function(t){t[1]<0?t[1]=0:t[1]>1&&(t[1]=1)})),i.length||i.push([a,0]),i}function Je(t,e,r,i){var a,n,o,s;if(t>=270){var l=Ke(360-t);a=r+Math.sin(l)*e,n=i+Math.cos(l)*e,o=r-Math.sin(l)*e,s=i-Math.cos(l)*e}else if(t>=180){var h=Ke(t-180);a=r+Math.sin(h)*e,n=i-Math.cos(h)*e,o=r-Math.sin(h)*e,s=i+Math.cos(h)*e}else if(t>=90){var u=Ke(180-t);a=r-Math.sin(u)*e,n=i-Math.cos(u)*e,o=r+Math.sin(u)*e,s=i+Math.cos(u)*e}else{var c=Ke(t);a=r-Math.sin(c)*e,n=i+Math.cos(c)*e,o=r+Math.sin(c)*e,s=i-Math.cos(c)*e}return[a,n,o,s]}function Qe(t,e,r,i,a,n){var o=t[0],s=t[1];return[o.u===Ne?e+o.v*i*.01:o.u===We?e+o.v*n.computedStyle[Ze]:o.u===Ye?e+o.v*n.width*.01:o.u===ze?e+o.v*n.height*.01:o.u===Xe?e+o.v*Math.max(n.width,n.height)*.01:o.u===Ue?e+o.v*Math.min(n.width,n.height)*.01:e+o.v,s.u===Ne?r+s.v*a*.01:s.u===We?r+s.v*n.computedStyle[Ze]:s.u===Ye?r+s.v*n.width*.01:s.u===ze?r+s.v*n.height*.01:s.u===ze?r+s.v*Math.max(n.width,n.height)*.01:s.u===ze?r+s.v*Math.min(n.width,n.height)*.01:r+s.v]}function tr(t,e,r,i,a,n,o,s,l,h){var c,f,_,v,y,d,p,x=0;if(Array.isArray(e))c=n+e[0]*i,f=o+e[1]*a,d=n+e[4]*i,p=o+e[5]*a,e[6]<=0?y=Math.min(Math.abs(c-n),Math.min(Math.abs(f-o),Math.min(Math.abs(f-l),Math.min(Math.abs(c-l))))):(v=(_=Math.sqrt(Math.pow((e[2]-e[0])*i,2)+Math.pow((e[3]-e[1])*a,2)))*e[6],y=Math.max(_,v),_!==v&&(x=e[2]>=e[0]?e[3]>=e[1]?Math.asin((e[3]-e[1])*a/_):-Math.asin((e[1]-e[3])*a/_):e[3]>=e[1]?Ke(180)-Math.asin((e[3]-e[1])*a/_):Math.asin((e[1]-e[3])*a/_)-Ke(180)));else{var g=u(Qe(r,n,o,i,a,h),2);d=c=g[0],p=f=g[1];var m=1;if("closest-corner"===e&&"circle"===t)c<=n||c>=s||f<=o||f>=l?y=Math.min(Math.abs(c-n),Math.min(Math.abs(f-o),Math.min(Math.abs(f-l),Math.min(Math.abs(c-l))))):(_=c<n+.5*i?c-n:s-c,v=f<o+.5*a?f-o:l-f,y=Math.sqrt(Math.pow(_,2)+Math.pow(v,2)));else if("closest-side"===e||"closest-corner"===e)if(c<=n||c>=s||f<=o||f>=l)y=Math.min(Math.abs(c-n),Math.min(Math.abs(f-o),Math.min(Math.abs(f-l),Math.min(Math.abs(c-l)))));else{var b=1;_=c<n+.5*i?c-n:s-c,v=f<o+.5*a?f-o:l-f,y=Math.min(_,v),"closest-corner"===e&&(b=Math.sqrt(2)),_*=b,v*=b,y*=b}else _=c<=n?n-c+i:c>=s?c-s+i:c<n+.5*i?s-c:c-n,v=f<=o?o-f+a:f>=l?f-l+a:f<o+.5*a?l-f:f-o,y=Math.max(_,v),"farthest-side"!==e&&(m=Math.sqrt(2)),_*=m,v*=m,y*=m}return"circle"===t&&(_=v=y),[c,f,y,_,v,d,p,x]}var er={parseGradient:function(t){var e=bt.gradient.exec(t);if(e){var r={k:e[1]};if("linear"===r.k){var i=/([-+]?[\d.]+deg)|(to\s+[toprighbml]+)/i.exec(e[2]);if(i)r.d=function(t){var e=180;if("to top"===t)e=0;else if("to top right"===t)e=45;else if("to right"===t)e=90;else if("to bottom right"===t)e=135;else if("to bottom"===t);else if("to bottom left"===t)e=225;else if("to left"===t)e=270;else if("to top left"===t)e=315;else{var r=/([-+]?[\d.]+)deg/.exec(t);r&&(e=parseFloat(r[1]))}return e%360}(i[0].toLowerCase());else{var a=/([-+]?[\d.]+)\s+([-+]?[\d.]+)\s+([-+]?[\d.]+)\s+([-+]?[\d.]+)/.exec(e[2]);r.d=a?[parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4])]:180}}else if("radial"===r.k){r.s=e[2].indexOf("circle")>-1?"circle":"ellipse";var n=/(closest|farthest)-(side|corner)/i.exec(e[2]);if(n)r.z=n[0].toLowerCase();else{var o=/([-+]?[\d.]+)\s+([-+]?[\d.]+)\s+([-+]?[\d.]+)\s+([-+]?[\d.]+)(?:\s+([-+]?[\d.]+))?(?:\s+([-+]?[\d.]+))?(?:\s+([-+]?[\d.]+))?/.exec(e[2]);if(o){r.z=[parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]),parseFloat(o[4])];var s=!Be(o[5]),l=!Be(o[6]),h=!Be(o[7]);s&&l&&h?(r.z.push(parseFloat(o[5])),r.z.push(parseFloat(o[6])),r.z.push(parseFloat(o[7]))):s&&l?(r.z.push(parseFloat(o[5])),r.z.push(parseFloat(o[6])),r.z.push(1)):s?(r.z.push(r.z[0]),r.z.push(r.z[1]),r.z.push(parseFloat(o[5]))):(r.z.push(r.z[0]),r.z.push(r.z[1]),r.z.push(1))}else r.z="farthest-corner"}var u=/at\s+((?:[-+]?[\d.]+[pxremvwhina%]*)|(?:left|top|right|bottom|center))(?:\s+((?:[-+]?[\d.]+[pxremvwhina%]*)|(?:left|top|right|bottom|center)))?/i.exec(e[2]);if(u){var c=qe(u[1]),f=u[2]?qe(u[2]):c;r.p=[c,f]}else r.p=[{v:50,u:Ne},{v:50,u:Ne}]}else if("conic"===r.k){var _=/([-+]?[\d.]+deg)/i.exec(e[2]);r.d=_?parseFloat(_[0])%360:0;var v=/at\s+((?:[-+]?[\d.]+[pxremvwhina%]*)|(?:left|top|right|bottom|center))(?:\s+((?:[-+]?[\d.]+[pxremvwhina%]*)|(?:left|top|right|bottom|center)))?/i.exec(e[2]);if(v){var y=qe(v[1]),d=v[2]?qe(v[2]):y;r.p=[y,d]}else r.p=[{v:50,u:Ne},{v:50,u:Ne}]}var p=e[2].match(/(([-+]?[\d.]+[pxremvwhina%]+)?\s*((#[0-9a-f]{3,8})|(rgba?\s*\(.+?\)))\s*([-+]?[\d.]+[pxremvwhina%]+)?)|(transparent)/gi)||[];return r.v=p.map((function(t){var e=/(?:#[0-9a-f]{3,8})|(?:rgba?\s*\(.+?\))|(?:transparent)/i.exec(t),r=[De(e[0])],i=/[-+]?[\d.]+[pxremvwhina%]+/.exec(t);if(i){var a=Ve(i[0]);[He,Ge].indexOf(a.u)>-1&&(a.v=Pe),r[1]=a}return r})),r}},getLinear:function(t,e,r,i,a,n,o,s,l){var h,u,c,f,_,v=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;if(r+=v,i+=y,a+=v,n+=y,Array.isArray(e)){h=r+e[0]*o,u=i+e[1]*s,c=r+e[2]*o,f=i+e[3]*s;var d=Math.sqrt(Math.pow(c-h,2)+Math.pow(f-u,2));_=$e(t,d)}else{for(;e>=360;)e-=360;for(;e<0;)e+=360;var p=Math.max(o,s),x=Je(e,p,a,n);p*=2;var g=Mt.dotProduct(r-x[0],i-x[1],x[2]-x[0],x[3]-x[1])/p,m=Mt.dotProduct(r+o-x[0],i-x[1],x[2]-x[0],x[3]-x[1])/p,b=Mt.dotProduct(r+o-x[0],i+s-x[1],x[2]-x[0],x[3]-x[1])/p,M=Mt.dotProduct(r-x[0],i+s-x[1],x[2]-x[0],x[3]-x[1])/p,E=g,A=g;E=Math.min(E,Math.min(m,Math.min(b,M)));var S=(A=Math.max(A,Math.max(m,Math.max(b,M))))-E,T=E/p,w=x[2]-x[0],R=x[3]-x[1];h=x[0]+w*T,u=x[1]+R*T,c=x[2]-w*T,f=x[3]-R*T,_=$e(t,S,l)}return{x1:h,y1:u,x2:c,y2:f,stop:_}},getRadial:function(t,e,r,i,a,n,o,s,l){var h,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,_=o-a,v=s-n,y=tr(e,r,i,_,v,a+=c,n+=f,o+=c,s+=f,l),d=u(y,8),p=d[0],x=d[1],m=d[2],b=d[3],M=d[4],E=d[5],A=d[6],S=d[7],T=1,w=1;if(b!==M||S){if(h=[1,0,0,1,0,0],S){var R=Math.sin(S),k=Math.cos(S);h=[k,R,0,0,-R,k,0,0,0,0,1,0,0,0,0,1]}if(b!==m){var C=[T=b/m,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];h=g.multiply(h,C)}if(M!==m){var O=[1,0,0,0,0,w=M/m,0,0,0,0,1,0,0,0,0,1];h=g.multiply(h,O)}}var I=$e(t,m,l);return{cx:p,cy:x,tx:E,ty:A,r:m,stop:I,scx:T,scy:w,matrix:h,d:S}},getConic:function(t,e,r,i,a,n,o,s,l){var h=function(t,e,r,i,a,n,o,s){var l,h,c,f=n-i,_=o-a,v=u(Qe(r,i,a,f,_,s),2),y=v[0],d=v[1];h=y>=i+.5*f?y-i:n-y;c=d>=a+.5*_?d-a:o-d;return l=Math.sqrt(Math.pow(h,2)+Math.pow(c,2)),[y,d,l,e]}(0,e,r,i,a,n,o,l),c=u(h,4),f=c[0],_=c[1],v=c[2];return v<<=1,{cx:f,cy:_,w:n-i,h:o-a,r:v*=s,deg:c[3],stop:$e(t,1,l)}},renderConic:function(t,e,r,i,a,n,o,s,l,h,u,c,f){var _=Le.calRadius(a,n,o,s,l,h,u,c);if(_||(_=[[a,n],[a+o,n],[a+o,n+s],[a,n+s],[a,n]]),e===y.CANVAS||e===y.WEBGL){var v=lt.getCacheCanvas(o,s,"__$$CONIC_GRADIENT$$__"),d=v.ctx.getImageData(0,0,o,s);Vt.getConicGradientImage(i.cx-a,i.cy-n,i.w,i.h,i.stop,d.data),v.ctx.putImageData(d,0,0),r.save(),r.beginPath(),je(r,_),r.clip(),r.closePath(),r.drawImage(v.canvas,a,n),r.restore(),v.ctx.clearRect(0,0,o,s)}}},rr=G.isNil;function ir(t,e,r,i){rr(t.flexGrow)&&(t.flexGrow=e||0),rr(t.flexShrink)&&(t.flexShrink=r||0),rr(t.flexBasis)&&(t.flexBasis=i||0)}var ar={margin:["marginTop","marginRight","marginBottom","marginLeft"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"],border:["borderTop","borderRight","borderBottom","borderLeft"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderWidth:["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],borderColor:["borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],borderStyle:["borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],background:["backgroundColor","backgroundImage","backgroundRepeat","backgroundPosition"],backgroundPosition:["backgroundPositionX","backgroundPositionY"],flex:["flexGrow","flexShrink","flexBasis"],translate:["translateX","translateY"],translate3d:["translateX","translateY","translateY"],scale:["scaleX","scaleY"],scale3d:["scaleX","scaleY","scaleZ"],rotate:["rotateZ"],skew:["skewX","skewY"],textStroke:["textStrokeWidth","textStrokeColor","textStrokeOver"],toFull:function(t,e){var r=this,i=t[e];if("background"===e)if(Array.isArray(i)){var a=i.length;if(rr(t.backgroundColor)){var n=/^\s*((transparent)|(#[0-9a-f]{3,8})|(rgba?\s*\(.+?\)))/i.exec(i[a-1]);n&&(t.backgroundColor=n[0],i=i.slice(0,a-1))}var o=[],s=[],l=[];i.forEach((function(e){if(rr(t.backgroundImage)){var r=bt.gradient.exec(e);if(r)o.push(r[0]),e=e.replace(r[0],"");else{var a=bt.img.exec(i);a&&(o.push(a[0]),e=e.replace(a[0],""))}}if(rr(t.backgroundRepeat)){var n=/(no-?)?repeat(-?[xy])?/i.exec(e);n&&s.push(n[0].toLowerCase())}if(rr(t.backgroundPosition)){var h=e.match(bt.position);h&&l.push(h.join(" "))}})),o.length&&(t.backgroundImage=o),s.length&&(t.backgroundRepeat=s),l.length&&(t.backgroundPosition=l,this.toFull(t,"backgroundPosition"))}else{if(rr(t.backgroundImage)){var h=bt.gradient.exec(i);if(h)t.backgroundImage=h[0],i=i.replace(h[0],"");else{var u=bt.img.exec(i);u&&(t.backgroundImage=u[0],i=i.replace(u[0],""))}}if(rr(t.backgroundRepeat)){var c=/(no-?)?repeat(-?[xy])?/i.exec(i);c&&(t.backgroundRepeat=c[0].toLowerCase())}if(rr(t.backgroundColor)){var f=/^(transparent)|(#[0-9a-f]{3,8})|(rgba?\s*\(.+?\))/i.exec(i);f&&(t.backgroundColor=f[0],i=i.replace(f[0],""))}if(rr(t.backgroundPosition)){var _=i.match(bt.position);_&&(t.backgroundPosition=_.join(" "),this.toFull(t,"backgroundPosition"))}}else if("flex"===e)if("none"===i)ir(t,0,0,"auto");else if("auto"===i)ir(t,1,1,"auto");else if(/^[\d.]+\s+[\d.]+\s+(auto|none|content)/.test(i)||/^[\d.]+\s+[\d.]+\s+[\d.]+[pxremvwhina%]*/.test(i)){var v=i.split(/\s+/);ir(t,parseFloat(v[0]),parseFloat(v[1]),v[2])}else if(/^[\d.]+\s+[\d.]+$/.test(i)){var y=i.split(/\s+/);ir(t,parseFloat(y[0]),parseFloat(y[1]),0)}else if(/^[\d.]+\s+[\d.]+[pxremvwhina%]+/.test(i)){var d=i.split(/\s+/);ir(t,parseFloat(d[0]),1,d[1])}else/^[\d.]+$/.test(i)?ir(t,parseFloat(i),1,0):/^[\d.]+[pxremvwhina%]+/i.test(i)?ir(t,1,1,i):ir(t,0,1,"auto");else if("flexFlow"===e)(i=i.toString().split(/\s+/)).length&&(rr(t.flexDirection),t.flexDirection=i[0],i.length>1&&(t.flexWrap=i[1]));else if("borderRadius"===e){1===(i=i.toString().split("/")).length&&(i[1]=i[0]);for(var p=0;p<2;p++){var x=i[p].toString().split(/\s+/);0===x.length?i[p]=[0,0,0,0]:1===x.length?i[p]=[x[0],x[0],x[0],x[0]]:2===x.length?i[p]=[x[0],x[1],x[0],x[1]]:3===x.length?i[p]=[x[0],x[1],x[2],x[1]]:i[p]=x.slice(0,4)}this[e].forEach((function(e,r){rr(t[e])&&(t[e]=i[0][r]+" "+i[1][r])}))}else if("backgroundPosition"===e){Array.isArray(i)||(i=[i]);var g=this[e].map((function(e){return rr(t[e])}));i.forEach((function(i){1===(i=i.toString().split(/\s+/)).length&&(i[1]="50%"),r[e].forEach((function(e,r){g[r]&&(t[e]=t[e]||[],t[e].push(i[r]))}))}))}else if(["translate","scale","skew"].indexOf(e)>-1){var m=i.toString().split(/\s*,\s*/);1===m.length&&(m[1]=m[0]),this[e].forEach((function(e,r){rr(t[e])&&(t[e]=m[r])}))}else if(["translate3d","scale3d"].indexOf(e)>-1){var b=i.toString().split(/\s*,\s*/);1===b.length?b[2]=b[1]=b[0]:2===b.length&&(b[2]="scale3d"===e?1:0),this[e].forEach((function(e,r){rr(t[e])&&(t[e]=b[r])}))}else if("margin"===e||"padding"===e)!function(t,e,r){var i=t[e];if(!rr(i)){var a=i.toString().match(/([-+]?[\d.]+[pxremvwhina%]*)|(auto)/gi);a&&(1===a.length?a[3]=a[2]=a[1]=a[0]:2===a.length?(a[2]=a[0],a[3]=a[1]):3===a.length&&(a[3]=a[1]),r.forEach((function(e,r){rr(t[e])&&(t[e]=a[r])})))}}(t,e,this[e]);else if(/^border((Top)|(Right)|(Bottom)|(Left))$/.test(e))!function(t,e){var r=t[e];if(!rr(r)){if(rr(t[e+"Width"])){var i=/\b[\d.]+[pxremvwhina%]*\b/i.exec(r);t[e+"Width"]=i?i[0]:0}if(rr(t[e+"Style"])){var a=/\b(solid|dashed|dotted)\b/i.exec(r);t[e+"Style"]=a?a[1]:"solid"}if(rr(t[e+"Color"])){var n=/#[0-9a-f]{3,8}/i.exec(r);n&&[4,7,9].indexOf(n[0].length)>-1?t[e+"Color"]=n[0]:/\btransparent\b/i.test(r)?t[e+"Color"]="transparent":(n=/rgba?\s*\(.+\)/i.exec(r),t[e+"Color"]=n?n[0]:"transparent")}}}(t,e);else if("textStroke"===e){var M=/(?:^|\s)([-+]?[\d.]+[pxremvwhina%]*)/.exec(i);M&&(t.textStrokeWidth=M[1]);var E=/(transparent)|(#[0-9a-f]{3,8})|(rgba?\s*\(.+?\))/i.exec(i);E&&(t.textStrokeColor=E[0]),/\bfill\b/i.test(i)?t.textStrokeOver="fill":t.textStrokeOver="none"}else this[e]&&this[e].forEach((function(e){rr(t[e])&&(t[e]=i)}));return t}},nr=Ct.STYLE_KEY,or=nr.BACKGROUND_COLOR,sr=nr.BORDER_BOTTOM_COLOR,lr=nr.BORDER_LEFT_COLOR,hr=nr.BORDER_RIGHT_COLOR,ur=nr.BORDER_TOP_COLOR,cr=nr.COLOR,fr=nr.TEXT_STROKE_COLOR,_r=nr.FONT_SIZE,vr=nr.BORDER_BOTTOM_WIDTH,yr=nr.BORDER_LEFT_WIDTH,dr=nr.BORDER_RIGHT_WIDTH,pr=nr.BORDER_TOP_WIDTH,xr=nr.LEFT,gr=nr.TOP,mr=nr.RIGHT,br=nr.BOTTOM,Mr=nr.FLEX_BASIS,Er=nr.WIDTH,Ar=nr.HEIGHT,Sr=nr.LINE_HEIGHT,Tr=nr.MARGIN_BOTTOM,wr=nr.MARGIN_LEFT,Rr=nr.MARGIN_TOP,kr=nr.MARGIN_RIGHT,Cr=nr.PADDING_TOP,Or=nr.PADDING_RIGHT,Ir=nr.PADDING_BOTTOM,Fr=nr.PADDING_LEFT,Lr=nr.STROKE_WIDTH,Dr=nr.STROKE_MITERLIMIT,Br=nr.LETTER_SPACING,Pr=nr.PERSPECTIVE,Nr=nr.TEXT_STROKE_WIDTH,Gr=nr.TRANSLATE_X,Hr=nr.TRANSLATE_Y,Wr=nr.TRANSLATE_Z,Yr=nr.SKEW_X,zr=nr.SKEW_Y,Xr=nr.SCALE_X,Ur=nr.SCALE_Y,Vr=nr.SCALE_Z,Kr=nr.ROTATE_X,jr=nr.ROTATE_Y,Zr=nr.ROTATE_Z,qr=nr.BACKGROUND_IMAGE,$r=nr.FILL,Jr=nr.STROKE,Qr=nr.BORDER_TOP_LEFT_RADIUS,ti=nr.BORDER_TOP_RIGHT_RADIUS,ei=nr.BORDER_BOTTOM_RIGHT_RADIUS,ri=nr.BORDER_BOTTOM_LEFT_RADIUS;var ii=function(t){return t===or||t===sr||t===lr||t===hr||t===ur||t===cr||t===fr},ai=function(t){return t===_r||t===Nr||t===vr||t===yr||t===dr||t===pr||t===xr||t===gr||t===mr||t===br||t===Mr||t===Er||t===Ar||t===Sr||t===Tr||t===Rr||t===wr||t===kr||t===Cr||t===Or||t===Fr||t===Ir||t===Lr||t===Dr||t===Br||t===Pr},ni=function(t){return t===Gr||t===Hr||t===Wr||t===Yr||t===zr||t===Xr||t===Ur||t===Vr||t===Kr||t===jr||t===Zr},oi=function(t){return t===qr||t===$r||t===Jr},si=function(t){return t===ri||t===Qr||t===ti||t===ei},li=mt.DOM,hi=mt.GEOM,ui=Ct.STYLE_KEY,ci=ui.POINTER_EVENTS,fi=ui.COLOR,_i=ui.STROKE_WIDTH,vi=ui.FILL,yi=ui.STROKE_DASHARRAY,di=ui.STROKE_LINECAP,pi=ui.STROKE_LINEJOIN,xi=ui.STROKE_MITERLIMIT,gi=ui.BACKGROUND_COLOR,mi=ui.BACKGROUND_IMAGE,bi=ui.BACKGROUND_POSITION_X,Mi=ui.BACKGROUND_POSITION_Y,Ei=ui.BACKGROUND_REPEAT,Ai=ui.BACKGROUND_SIZE,Si=ui.STROKE,Ti=ui.BORDER_BOTTOM_COLOR,wi=ui.BORDER_LEFT_COLOR,Ri=ui.BORDER_RIGHT_COLOR,ki=ui.BORDER_TOP_COLOR,Ci=ui.BORDER_TOP_LEFT_RADIUS,Oi=ui.BORDER_TOP_RIGHT_RADIUS,Ii=ui.BORDER_BOTTOM_RIGHT_RADIUS,Fi=ui.BORDER_BOTTOM_LEFT_RADIUS,Li=ui.VISIBILITY,Di=ui.BOX_SHADOW,Bi=ui.OVERFLOW,Pi=ui.BACKGROUND_CLIP,Ni=ui.TEXT_STROKE_WIDTH,Gi=ui.TEXT_STROKE_COLOR,Hi=ui.TEXT_STROKE_OVER,Wi=ui.TRANSLATE_PATH,Yi={},zi=[],Xi={GEOM:Yi,GEOM_KEY_SET:zi,addGeom:function(t,e,r){if(Array.isArray(e))e.forEach((function(e){Xi.addGeom(t,e,r)}));else if(e){Yi.hasOwnProperty(e)||zi.push(e),(Yi[e]=Yi[e]||{})[t]=r||!0}},isIgnore:function(t){return t===ci||t===Wi},isGeom:function(t,e){return t&&e&&Yi.hasOwnProperty(e)&&Yi[e].hasOwnProperty(t)},isRepaint:function(t,e){return t===fi||t===_i||t===vi||t===yi||t===di||t===pi||t===xi||t===gi||t===mi||t===bi||t===Mi||t===Ei||t===Ai||t===Si||t===Ti||t===wi||t===Ti||t===Ri||t===ki||t===Ci||t===Oi||t===Ii||t===Fi||t===Li||t===Di||t===Bi||t===Pi||t===Ni||t===Gi||t===Hi||Xi.isGeom(e,t)},isValid:function(t,e){return!!e&&(!!li.hasOwnProperty(e)||(!("$"!==t.charAt(0)||!hi.hasOwnProperty(e))||(Yi.hasOwnProperty(e)?Yi[e].hasOwnProperty(t):"translatePath"===e)))}};function Ui(t){if(t<=0)return 0;var e=Math.floor(3*t*Math.sqrt(2*Math.PI)/4+.5);return e<2&&(e=2),e%2==0&&e++,e}function Vi(t){return 3*Math.floor(.5*t)}Xi.addGeom("$line",["x1","y1","x2","y2","controlA","controlB","start","end"]),Xi.addGeom("$circle",["r"]),Xi.addGeom("$ellipse",["rx","ry"]),Xi.addGeom("$rect",["rx","ry"]),Xi.addGeom("$sector",["begin","end","edge","closure"]),Xi.addGeom("$polyline",["points","controls","start","end"]),Xi.addGeom("$polygon",["points","controls","start","end","booleanOperations"]);var Ki={kernelSize:Ui,outerSize:function(t){return Vi(Ui(t))},outerSizeByD:Vi,gaussianWeight:function(t,e){for(var r=[],i=Math.floor(.5*e),a=0,n=i;n>=0;n--){var o=Math.pow(Math.E,-Math.pow(n,2)/(2*Math.pow(t,2)))/(t*Math.sqrt(2*Math.PI));r.push(o),a+=o}for(var s=1;s<=i;s++){var l=Math.pow(Math.E,-Math.pow(s,2)/(2*Math.pow(t,2)))/(t*Math.sqrt(2*Math.PI));r.push(l),a+=l}if(1!==a)for(var h=0;h<e;h++)r[h]/=a;return r}},ji=Ct.STYLE_KEY,Zi=Ct.style2Upper,qi=Ct.STYLE_KEY,$i=qi.POSITION,Ji=qi.WIDTH,Qi=qi.HEIGHT,ta=qi.TRANSLATE_X,ea=qi.TRANSLATE_Y,ra=qi.TRANSLATE_Z,ia=qi.SCALE_X,aa=qi.SCALE_Y,na=qi.SCALE_Z,oa=qi.SKEW_X,sa=qi.SKEW_Y,la=qi.ROTATE_X,ha=qi.ROTATE_Y,ua=qi.ROTATE_Z,ca=qi.ROTATE_3D,fa=qi.PERSPECTIVE,_a=qi.PERSPECTIVE_ORIGIN,va=qi.TRANSFORM,ya=qi.TRANSFORM_ORIGIN,da=qi.BACKGROUND_IMAGE,pa=qi.BACKGROUND_COLOR,xa=qi.BACKGROUND_POSITION_X,ga=qi.BACKGROUND_POSITION_Y,ma=qi.BACKGROUND_SIZE,ba=qi.OPACITY,Ma=qi.Z_INDEX,Ea=qi.COLOR,Aa=qi.FONT_SIZE,Sa=qi.FONT_FAMILY,Ta=qi.FONT_WEIGHT,wa=qi.FONT_STYLE,Ra=qi.LINE_HEIGHT,ka=qi.TEXT_ALIGN,Ca=qi.FILTER,Oa=qi.VISIBILITY,Ia=qi.BOX_SHADOW,Fa=qi.POINTER_EVENTS,La=qi.FILL,Da=qi.STROKE,Ba=qi.STROKE_WIDTH,Pa=qi.STROKE_DASHARRAY,Na=qi.FLEX_BASIS,Ga=qi.MATRIX,Ha=qi.LETTER_SPACING,Wa=qi.WHITE_SPACE,Ya=qi.LINE_CLAMP,za=qi.ORDER,Xa=qi.TRANSLATE_PATH,Ua=qi.TEXT_STROKE_COLOR,Va=qi.TEXT_STROKE_WIDTH,Ka=qi.TEXT_STROKE_OVER,ja=qi.WRITING_MODE,Za=d.AUTO,qa=d.PX,$a=d.PERCENT,Ja=d.NUMBER,Qa=d.INHERIT,tn=d.DEG,en=d.RGBA,rn=d.STRING,an=d.REM,nn=d.VW,on=d.VH,sn=d.VMAX,ln=d.VMIN,hn=d.GRADIENT,un=d.calUnit,cn=G.isNil,fn=G.rgba2int,_n=G.equalArr,vn=G.equal,yn=G.replaceRgba2Hex,dn=Xi.isGeom,pn=Xi.GEOM,xn=Xi.GEOM_KEY_SET,gn=mt.VALID_STRING_VALUE,mn=ii,bn=ni,Mn=ai,En=oi,An=si;function Sn(t){if(bt.gradient.test(t)){var e=bt.gradient.exec(t);if(e&&["linear","radial","conic"].indexOf(e[1])>-1)return!0}}var Tn={translateX:ta,translateY:ea,translateZ:ra,scaleX:ia,scaleY:aa,scaleZ:na,skewX:oa,skewY:sa,rotateX:la,rotateY:ha,rotateZ:ua,rotate:ua};function wn(t,e){t===ia||t===aa||t===na?e.u=Ja:t===ta||t===ea||t===ra?e.u===Ja&&(e.u=qa):t===fa?[Ja,$a,tn].indexOf(e.u)>-1&&(e.u=qa):e.u===Ja&&(e.u=tn)}function Rn(t){return cn(t)&&(t=""),(t=t.toString()).indexOf("-")>-1?t.toString().toLowerCase().replace(/-([a-z])/gi,(function(t,e){return e.toUpperCase()})):t}function kn(t,e){e=Rn(e);var r=gn[t],i=r.indexOf(e);return i>-1?r[i]:r[0]}function Cn(t){var e=t[Aa],r=In(t[Sa]),i=On(t,r);return.5*(t[Ra]-i)+e*(ct.info[r]||ct.info[lt.defaultFontFamily]||ct.info.arial).blr}function On(t,e){return e||(e=In(t[Sa])),t[Aa]*(ct.info[e]||ct.info[lt.defaultFontFamily]||ct.info.arial).lhr}function In(t){for(var e=t.split(/\s*,\s*/),r=0,i=e.length;r<i;r++){var a=e[r].replace(/^['"]/,"").replace(/['"]$/,"");if(ct.hasLoaded(a)||lt.checkSupportFontFamily(a))return a}return lt.defaultFontFamily}function Fn(t,e,r){for(t*=.01;e;){var i=e.currentStyle[r];if(i.u===Za){if(r!==Ji)break;e=e.domParent}else{if(i.u===qa)return t*i.v;if(i.u===$a)t*=.01*i.v,e=e.domParent;else{if(i.u===an)return t*i.v*e.root.computedStyle[Aa];if(i.u===nn)return t*i.v*e.root.width*.01;if(i.u===on)return t*i.v*e.root.height*.01;if(i.u===sn)return t*i.v*Math.max(e.root.width,e.root.height)*.01;if(i.u===ln)return t*i.v*Math.min(e.root.width,e.root.height)*.01}}}return t}var Ln={normalize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!G.isObject(t))return{};var r={},i=(t=G.extend({},t)).border;if(i&&ar.toFull(t,"border"),["borderTop","borderRight","borderBottom","borderLeft"].forEach((function(e){ar.toFull(t,e)})),(i=t.borderWidth)&&ar.toFull(t,"borderWidth"),(i=t.borderColor)&&ar.toFull(t,"borderColor"),(i=t.borderStyle)&&ar.toFull(t,"borderStyle"),(i=t.borderRadius)&&ar.toFull(t,"borderRadius"),(i=t.background)&&ar.toFull(t,"background"),i=t.backgroundPosition,cn(i)||ar.toFull(t,"backgroundPosition"),(i=t.flex)&&ar.toFull(t,"flex"),(i=t.flexFlow)&&ar.toFull(t,"flexFlow"),i=t.margin,cn(i)||ar.toFull(t,"margin"),i=t.padding,cn(i)||ar.toFull(t,"padding"),(i=t.textStroke)&&ar.toFull(t,"textStroke"),(i=t.rotate3d)&&ar.toFull(t,"rotate3d"),["translate","scale","skew","translate3d","scale3d","rotate"].forEach((function(e){i=t[e],cn(i)||ar.toFull(t,e)})),["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","skewX","skewY","rotateX","rotateY","rotateZ","rotate3d"].forEach((function(e){void 0!==t[e]&&t.transform&&lt.warn('Can not use expand style "'.concat(e,'" with transform'))})),e.forEach((function(e){var r=e.k,i=e.v;cn(t[r])&&(t[r]=i)})),void 0!==(i=t.backgroundImage)&&(i?Array.isArray(i)?r[da]=i.map((function(t){return t?Sn(t)?{v:er.parseGradient(t),u:hn}:bt.img.test(t)?{v:bt.img.exec(t)[2],u:rn}:null:null})):Sn(i)?r[da]=[{v:er.parseGradient(i),u:hn}]:bt.img.test(i)?r[da]=[{v:bt.img.exec(i)[2],u:rn}]:r[da]=[]:r[da]=[]),void 0!==(i=t.backgroundColor)){var a=/^#[0-9a-f]{3,8}/i.exec(i=i||"transparent");a&&[4,7,9].indexOf(a[0].length)>-1?r[pa]={v:fn(a[0]),u:en}:(a=/rgba?\s*\(.+\)/i.exec(i),r[pa]={v:fn(a?a[0]:[0,0,0,0]),u:en})}if(["backgroundPositionX","backgroundPositionY"].forEach((function(e,a){void 0!==(i=t[e])&&(i=i||0,e=a?ga:xa,Array.isArray(i)||(i=[i]),r[e]=i.map((function(t){if(/^[-+]?[\d.]/.test(t)){var e=un(t);return[Ja,tn].indexOf(e.u)>-1&&(e.u=qa),e}return{v:{top:0,left:0,center:50,right:100,bottom:100}[t]||0,u:$a}})))})),void 0!==(i=t.backgroundSize)&&(Array.isArray(i)||(i=[i]),r[ma]=i.map((function(t){if(!t)return[{u:Za},{u:Za}];var e=t.toString().match(/\b(?:([-+]?[\d.]+[pxremvwhina%]*)|(contain|cover|auto))/gi);if(e){1===e.length&&("contain"===e[0].toLowerCase()||"cover"===e[0].toLowerCase()?e[1]=e[0].toLowerCase():e[1]="auto");for(var r=[],i=0;i<2;i++){var a=e[i].toLowerCase();if(/^[-+]?[\d.]/.test(a)){var n=un(a);[Ja,tn].indexOf(n.u)>-1&&(n.u=qa),r.push(n)}else"contain"===a||"cover"===a?r.push({v:a,u:rn}):r.push({u:Za})}return r}return[{u:Za},{u:Za}]}))),["Top","Right","Bottom","Left"].forEach((function(e){var i=t[e="border"+e+"Color"];void 0!==i&&(r[ji[Zi(e)]]={v:fn(i||"transparent"),u:en})})),["TopLeft","TopRight","BottomRight","BottomLeft"].forEach((function(e){var i=t[e="border"+e+"Radius"];if(void 0!==i){var a=(i=i||0).toString().split(/\s+/);1===a.length&&(a[1]=a[0]);for(var n=0;n<2;n++){var o=a[n];if(/^[-+]?[\d.]/.test(o)){var s=un(o);[Ja,tn].indexOf(s.u)>-1&&(s.u=qa),s.v<0&&(s.v=0),a[n]=s}else a[n]={u:0,v:qa}}r[ji[Zi(e)]]=a}})),void 0!==(i=t.transform)){var n=r[va]=[],o=(i||"").toString().match(/\w+\(.+?\)/g);o&&o.forEach((function(t){var e=t.indexOf("("),r=t.slice(0,e),i=t.slice(e+1,t.length-1);if("matrix"===r){var a=i.toString().split(/\s*,\s*/);a=a.map((function(t){return parseFloat(t)})),a.length>6&&(a=a.slice(0,6)),6===a.length&&n.push({k:Ga,v:[a[0],a[1],0,0,a[2],a[3],0,0,0,0,1,0,a[4],a[5],0,1]})}else if("matrix3d"===r){var o=i.toString().split(/\s*,\s*/);o=o.map((function(t){return parseFloat(t)})),o.length>16&&(o=o.slice(0,16)),16===o.length&&n.push({k:Ga,v:o})}else if("perspective"===r){var s=un(i);s.v<0&&(s.v=0),wn(fa,s),n.push({k:fa,v:s})}else if("rotate3d"===r){var l=i.toString().split(/\s*,\s*/);if(4===l.length){var h=un(l[3]);wn(ca,h),l[0]=parseFloat(l[0].replace("(","")),l[1]=parseFloat(l[1]),l[2]=parseFloat(l[2]),l[3]=h,n.push({k:ca,v:l})}}else if(Tn.hasOwnProperty(r)){var u=Tn[r],c=un(i);wn(u,c),n.push({k:u,v:c})}else if({translate:!0,scale:!0,skew:!0}.hasOwnProperty(r)){var f=i.toString().split(/\s*,\s*/);if(1===f.length&&(f[1]="scale"===r?f[0]:[0]),2===f.length){var _=ji[Zi(r+"X")],v=ji[Zi(r+"Y")],y=un(f[0]),d=un(f[1]);wn(_,y),wn(v,d),n.push({k:_,v:y}),n.push({k:v,v:d})}}else if({translate3d:!0,scale3d:!0}.hasOwnProperty(r)){var p=i.toString().split(/\s*,\s*/);if(1===p.length?(p[1]="scale3d"===r?[1]:[0],p[2]="scale3d"===r?[1]:[0]):2===p.length&&(p[2]="scale3d"===r?[1]:[0]),3===p.length){var x=ji[Zi(r+"X")],g=ji[Zi(r+"Y")],m=ji[Zi(r+"Z")],b=un(p[0]),M=un(p[1]),E=un(p[2]);wn(x,b),wn(g,M),wn(m,E),n.push({k:x,v:b}),n.push({k:g,v:M}),n.push({k:m,v:E})}}}))}if(void 0!==(i=t.perspective)){var s=un(i||0);s.v<0&&(s.v=0),wn(fa,s),r[fa]=s}if(["perspectiveOrigin","transformOrigin"].forEach((function(e){if(void 0!==(i=t[e])){null===i&&(i="");var a=r[ji[Zi(e)]]=[],n=i.toString().match(bt.position);if(n){1===n.length&&(n[1]=n[0]);for(var o=0;o<2;o++){var s=n[o];if(/^[-+]?[\d.]/.test(s)){var l=un(s);[Ja,tn].indexOf(l.u)>-1&&(l.u=qa),a.push(l)}else a.push({v:{top:0,left:0,center:50,right:100,bottom:100}[s],u:$a}),cn(a[o].v)&&(a[o].v=50)}}else a.push({v:50,u:$a}),a.push({v:50,u:$a})}})),["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","skewX","skewY","rotateX","rotateY","rotateZ","rotate"].forEach((function(e){var i=t[e];if(void 0!==i){null===i&&(i=0===e.indexOf("scale")?1:0);var a=Tn[e],n=un(i);wn(a,n),r[a]=n}})),void 0!==(i=t.rotate3d)){var l=(i||"").toString().split(/\s*,\s*/);if(4===l.length){var h=un(l[3]);wn(ca,h),l[0]=parseFloat(l[0].replace("(","")),l[1]=parseFloat(l[1]),l[2]=parseFloat(l[2]),l[3]=h}r[ca]=l}if(void 0!==(i=t.opacity)&&(null===i&&(i=1),i=parseFloat(i),isNaN(i)?r[ba]=1:(i=Math.max(i,0),i=Math.min(i,1),r[ba]=i)),void 0!==(i=t.zIndex)&&(r[Ma]=parseInt(i)||0),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","top","right","bottom","left","width","height"].forEach((function(e){var i=t[e];if(void 0!==i){"auto"===i?i={v:0,u:Za}:(i=un(i||0),[Ja,tn].indexOf(i.u)>-1&&(i.u=qa));var a=ji[Zi(e)];r[a]=i,{paddingTop:!0,paddingRight:!0,paddingBottom:!0,paddingLeft:!0,borderTopWidth:!0,borderRightWidth:!0,borderBottomWidth:!0,borderLeftWidth:!0,width:!0,height:!0}.hasOwnProperty(e)&&i.v<0&&(i.v=0)}})),void 0!==(i=t.flexBasis))if(/content/i.test(i))r[Na]={v:i.toLowerCase(),u:rn};else if(/^[\d.]/.test(i)){var u=r[Na]=un(i);u.v=Math.max(u.v,0),[Ja,tn].indexOf(u.u)>-1&&(u.u=qa)}else r[Na]={v:0,u:Za};if(void 0!==(i=t.order)&&(r[za]=parseInt(i)||0),void 0!==(i=t.color)&&(/inherit/i.test(i)?r[Ea]={u:Qa}:Sn(i)?r[Ea]={v:er.parseGradient(i),u:hn}:r[Ea]={v:fn(i),u:en}),void 0!==(i=t.textStrokeColor)&&(/inherit/i.test(i)?r[Ua]={u:Qa}:Sn(i)?r[Ua]={v:er.parseGradient(i),u:hn}:r[Ua]={v:fn(i),u:en}),void 0!==(i=t.fontSize))if(/inherit/i.test(i))r[Aa]={u:Qa};else{var c=un(i);c<0?r[Aa]={u:Qa}:([Ja,tn].indexOf(c.u)>-1&&(c.u=qa),r[Aa]=c)}if(void 0!==(i=t.textStrokeWidth))if(/inherit/i.test(i))r[Va]={u:Qa};else{var f=un(i);f<0?r[Va]={u:Qa}:([Ja,tn,$a].indexOf(f.u)>-1&&(f.u=qa),r[Va]=f)}if(void 0!==(i=t.textStrokeOver))if(null===i||/inherit/i.test(i))r[Ka]={u:Qa};else{var _=mt.INHERIT.textStrokeOver;/fill/i.test(i)&&(_="fill"),r[Ka]={v:_,u:rn}}if(void 0!==(i=t.fontWeight)&&(/bold/i.test(i)?r[Ta]={v:700,u:Ja}:/normal/i.test(i)?r[Ta]={v:400,u:Ja}:/lighter/i.test(i)?r[Ta]={v:200,u:Ja}:/inherit/i.test(i)?r[Ta]={u:Qa}:r[Ta]={v:Math.max(0,parseInt(i))||400,u:Ja}),void 0!==(i=t.fontStyle))if(null===i||/inherit/i.test(i))r[wa]={u:Qa};else{var v=mt.INHERIT.fontStyle;/italic/i.test(i)?v="italic":/oblique/i.test(i)&&(v="oblique"),r[wa]={v:v,u:rn}}if(void 0!==(i=t.fontFamily)&&(null===i||/inherit/i.test(i)?r[Sa]={u:Qa}:r[Sa]={v:i.toString().toLowerCase().replace(/['"]/,"").replace(/\s*,\s*/g,","),u:rn}),void 0!==(i=t.writingMode))if(null===i||/inherit/i.test(i))r[ja]={u:Qa};else{var y=mt.INHERIT.writingMode;/vertical-?rl/i.test(i)?y="verticalRl":/vertical-?lr/i.test(i)&&(y="verticalLr"),r[ja]={v:y,u:rn}}if(void 0!==(i=t.textAlign))if(null===i||/inherit/i.test(i))r[ka]={u:Qa};else{var d="left";/center/i.test(i)?d="center":/right/i.test(i)&&(d="right"),r[ka]={v:d,u:rn}}if(void 0!==(i=t.lineHeight))if(/inherit/i.test(i))r[Ra]={u:Qa};else if(/normal/i.test(i))r[Ra]={u:Za};else if(/^[\d.]+/i.test(i)){var p=un(i);[tn].indexOf(p.u)>-1&&(p.u=Ja),r[Ra]=p}else{var x=Math.max(0,parseFloat(i))||"normal";r[Ra]="normal"===x?{u:Za}:{v:x,u:Ja}}if(void 0!==(i=t.letterSpacing))if(null===i||/inherit/i.test(i))r[Ha]={u:Qa};else if(/normal/i.test(i))r[Ha]={v:0,u:qa};else if(/^[-+]?[\d.]/.test(i)){var g=un(i);[Ja,tn].indexOf(g.u)>-1&&(g.u=qa),r[Ha]=g}else r[Ha]={v:parseFloat(i)||0,u:qa};if(void 0!==(i=t.whiteSpace)&&(null===i||/inherit/i.test(i)?r[Wa]={u:Qa}:r[Wa]={v:i,u:rn}),void 0!==(i=t.lineClamp)&&(i=parseInt(i)||0,r[Ya]=Math.max(0,i)),["fill","stroke"].forEach((function(e,a){void 0!==(i=t[e])&&(e=a?Da:La,Array.isArray(i)||(i=[i]),r[e]=i.map((function(t){return t?Sn(t)?{v:er.parseGradient(t),u:hn}:{v:fn(t),u:en}:{v:"none",u:rn}})))})),void 0!==(i=t.strokeWidth)&&(Array.isArray(i)||(i=[i]),r[Ba]=i.map((function(t){var e=un(t);return[Ja,tn].indexOf(e.u)>-1&&(e.u=qa),e.v=Math.max(e.v,0),e}))),void 0!==(i=t.strokeDasharray))if(Array.isArray(i))r[Pa]=i.map((function(t){var e=(t||"").toString().match(/[\d.]+/g);return e?(e=e.map((function(t){return parseFloat(t)})),e.length%2==1&&e.push(e[e.length-1]),e):[]}));else{var m=(i||"").toString().match(/[\d.]+/g);m?((m=m.map((function(t){return parseFloat(t)}))).length%2==1&&m.push(m[m.length-1]),r[Pa]=[m]):r[Pa]=[[]]}if(void 0!==(i=t.filter)){var b=[],M=(yn(i)||"").match(/[\w-]+\s*\(.+?\)/gi);M&&M.forEach((function(t){var e=/([\w-]+)\s*\((\s*.+\s*)\)/i.exec(t);if(e){var r=e[1].toLowerCase(),i=e[2];if("drop-shadow"===r||"dropshadow"===r){var a=/([-+]?[\d.]+[pxremvwhina%]*)[\s,]+([-+]?[\d.]+[pxremvwhina%]*)[\s,]+(?:([-+]?[\d.]+[pxremvwhina%]*)[\s,])?([-+]?[\d.]+[pxremvwhina%]*\s*)?/gi.exec(t);if(a){for(var n=[],o=1;o<=4;o++){var s=a[o];if(s){var l=un(s);[Ja,tn].indexOf(l.u)>-1&&(l.u=qa),o>2&&l.v<0&&(l.v=0),n.push(l)}else n.push({v:0,u:qa})}var h=/#[a-f\d]{3,8}/i.exec(t);h?n.push(fn(h[0])):n.push([0,0,0,1]),b.push({k:"dropShadow",v:n})}}else{var u=/([-+]?[\d.]+\s*[pxremvwhdg%]*)/i.exec(i);if(u){var c=un(u[0]);if("blur"===r){if([tn,$a].indexOf(c.u)>-1)return;c.u===Ja&&(c.u=qa),c.v=Math.max(c.v,0),b.push({k:r,v:c})}else if("hue-rotate"===r||"huerotate"===r){if(-1===[Ja,tn].indexOf(c.u))return;c.u=tn,b.push({k:"hueRotate",v:c})}else if("saturate"===r||"brightness"===r||"grayscale"===r||"contrast"===r||"sepia"===r||"invert"===r){if(-1===[Ja,$a].indexOf(c.u))return;c.v=Math.max(c.v,0),c.u=$a,b.push({k:r,v:c})}}}}})),r[Ca]=b}if(void 0!==(i=t.visibility))if(null===i||/inherit/i.test(i))r[Oa]={u:Qa};else{var E=mt.INHERIT.visibility;/hidden/i.test(i)&&(E="hidden"),r[Oa]={v:E,u:rn}}if(void 0!==(i=t.pointerEvents))if(null===i||/inherit/i.test(i))r[Fa]={u:Qa};else{var A=mt.INHERIT.pointerEvents;/none/i.test(i)&&(A="none"),r[Fa]={v:A,u:rn}}if(void 0!==(i=t.boxShadow)){var S=[],T=(yn(i)||"").split(",");T&&T.forEach((function(t){var e=/([-+]?[\d.]+[pxremvwhina%]*)\s*([-+]?[\d.]+[pxremvwhina%]*)\s*([-+]?[\d.]+[pxremvwhina%]*\s*)?([-+]?[\d.]+[pxremvwhina%]*\s*)?/i.exec(t);if(e){for(var r=[],i=1;i<=4;i++){var a=e[i];if(a){var n=un(a);[Ja,tn].indexOf(n.u)>-1&&(n.u=qa),i>2&&n.v<0&&(n.v=0),r.push(n)}else r.push({v:0,u:qa})}var o=/#[a-f\d]{3,8}/i.exec(t);o?r.push(fn(o[0])):r.push([0,0,0,1]),r.push(/inset/i.test(t)?"inset":"outset"),S.push(r)}})),r[Ia]=S}return["position","display","flexDirection","flexWrap","justifyContent","alignItems","alignSelf","alignContent","overflow","mixBlendMode","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","backgroundClip","textOverflow"].forEach((function(e){t.hasOwnProperty(e)&&(r[ji[Zi(e)]]=kn(e,t[e]))})),["flexGrow","flexShrink"].forEach((function(e){t.hasOwnProperty(e)&&(r[ji[Zi(e)]]=Math.max(parseFloat(t[e])||0,0))})),void 0!==(i=t.zIndex)&&(r[Ma]=parseFloat(i)||0),["backgroundRepeat","strokeLinecap","strokeLinejoin","strokeMiterlimit","fillRule"].forEach((function(e){if(t.hasOwnProperty(e)){var i=t[e];Array.isArray(i)||(i=[i]),"backgroundRepeat"===e&&i.forEach((function(t,e){t&&(i[e]=Rn(t))})),r[ji[Zi(e)]]=i}})),xn.forEach((function(e){t.hasOwnProperty(e)&&(r[e]=t[e])})),r},setFontStyle:function(t){var e=t[Aa]||0,r=t[Sa]||lt.defaultFontFamily||"arial";return/\s/.test(r)&&(r='"'+r.replace(/"/g,'\\"')+'"'),(t[wa]||"normal")+" "+(t[Ta]||"400")+" "+e+"px/"+e+"px "+r},getBaseline:Cn,getVerticalBaseline:function(t){return t[Ra]-Cn(t)},calRelative:function(t,e,r,i,a){return r.u===Za?r=0:[qa,Ja].indexOf(r.u)>-1?r=r.v:r.u===$a?r=Fn(r.v,i,a?Ji:Qi):r.u===an?r=r.v*i.root.computedStyle[Aa]:r.u===nn?r=r.v*i.root.width*.01:r.u===on?r=r.v*i.root.height*.01:r.u===sn?r=r.v*Math.max(i.root.width,i.root.height)*.01:r.u===ln&&(r=r.v*Math.min(i.root.width,i.root.height)*.01),r},equalStyle:function(t,e,r,i){if(!e||!r)return e===r;if(t===va){if(e.length!==r.length)return!1;for(var a=0,n=e.length;a<n;a++){var o=e[a],s=r[a];if(o.k!==s.k)return!1;var l=o.v,h=s.v;if(o.k===Ga){if(!_n(l,h))return!1}else if(l.u!==h.u||l.v!==h.v)return!1}return!0}if(t===ca)return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3].v===r[3].v&&e[3].u===r[3].u;if(t===Ca){if(e.length!==r.length)return!1;for(var u=0,c=e.length;u<c;u++){var f=e[u],_=r[u];if(f.k!==_.k)return!1;var v=f.v,y=_.v;if("dropShadow"===f.k||"drop-shadow"===f.k){if(v.length!==y.length)return!1;for(var d=0;d<4;d++){var p=v[d],x=y[d];if(p.u!==x.u||p.v!==x.v)return!1}}else if(v.u!==y.u||v.v!==y.v)return!1}return!0}if(t===ya||t===_a||An(t))return e[0].v===r[0].v&&e[0].u===r[0].u&&e[1].v===r[1].v&&e[1].u===r[1].u;if(t===xa||t===ga||t===Ba){if(e.length!==r.length)return!1;for(var g=0,m=e.length;g<m;g++){var b=e[g],M=r[g];if(b.v!==M.v||b.u!==M.u||b.v!==M.v||b.u!==M.u)return!1}return!0}if(t===Ia){if(e.length!==r.length)return!1;for(var E=0,A=e.length;E<A;E++){var S=e[E],T=r[E];if(!(S&&T||S===T))return!1;for(var w=0;w<4;w++)if(S[w].v!==T[w].v||S[w].u!==T[w].u)return!1;for(var R=0;R<4;R++)if(S[4][R]!==T[4][R])return!1;if(S[5]!==T[5])return!1}return!0}if(t===ma||t===xa||t===ga){if(e.length!==r.length)return!1;for(var k=0,C=e.length;k<C;k++){var O=e[k],I=r[k];if(O[0].v!==I[0].v||O[0].u!==I[0].u||O[1].v!==I[1].v||O[1].u!==I[1].u)return!1}return!0}if(Mn(t)||bn(t))return e.v===r.v&&e.u===r.u;if(En(t)){if(e.length!==r.length)return!1;for(var F=0,L=e.length;F<L;F++){var D=e[F],B=r[F];if(D.u!==B.u)return!1;var P=D.v,N=B.v;if(D.u===hn){if(P.k!==N.k||P.d!==N.d||P.s!==N.s||P.z!==N.z)return!1;if("linear"===P.k){var G=P.d,H=N.d,W=Array.isArray(G);if(W!==Array.isArray(H))return!1;if(W){if(G[0]!==H[0]||G[1]!==H[1]||G[2]!==H[2]||G[3]!==H[3])return!1}else if(G!==H)return!1}else if("conic"===P.k&&P.d!==N.d)return!1;if("radial"===P.k||"conic"===P.k){var Y=P.p,z=N.p;if(Y[0].u!==z[0].u||Y[0].v!==z[0].v||Y[1].u!==z[1].u||Y[1].v!==z[1].v)return!1}for(var X=0;X<2;X++){var U=P.v[X],V=N.v[X],K=U[0],j=V[0];if(K[0]!==j[0]||K[1]!==j[1]||K[2]!==j[2]||K[3]!==j[3])return!1;if(U[1]&&V[1]){if(U[1].u!==V[1].u||U[1].v!==V[1].v)return!1}else if(U[1]||V[1])return!1}}else if(D.u===en){if(!_n(P,N))return!1}else if(P!==N)return!1}return!0}if(mn(t)){if(e.u!==r.u)return!1;if(e.u===hn);else if(e.u===en)return _n(e.v,r.v)}return dn(i.tagName,t)&&(i.isMulti||Array.isArray(e)&&Array.isArray(r))?vn(e,r):e===r},isRelativeOrAbsolute:function(t){var e=t.currentStyle[$i];return"relative"===e||"absolute"===e},cloneStyle:function(t,e){e||(e=Object.keys(t).map((function(t){return pn.hasOwnProperty(t)||(t=parseInt(t)),t})));for(var r={},i=0,a=e.length;i<a;i++){var n=e[i],o=t[n];if(n===va){if(o){for(var s=o.length,l=new Array(s),h=0;h<s;h++){var u=o[h];u.k===Ga?l[h]={k:u.k,v:u.v.slice(0)}:l[h]={k:u.k,v:{v:u.v.v,u:u.v.u}}}r[n]=l}}else if(n===ca)r[n]=[o[0],o[1],o[2],{v:o[3].v,u:o[3].u}];else if(n===Ca){if(o){for(var c=o.length,f=new Array(c),_=0;_<c;_++){var v=o[_],y=v.k,d=v.v;if("dropShadow"===y){var p=new Array(5);f[_]={k:y,v:p};for(var x=0;x<4;x++){var g=d[x];p[x]={v:g.v,u:g.u}}p[4]=d[4].slice(0)}else f[_]={k:y,v:{v:d.v,u:d.u}}}r[n]=f}}else if(n===ya||n===_a||An(n)){if(o){for(var m=new Array(2),b=0;b<2;b++){var M=o[b];m[b]={v:M.v,u:M.u}}r[n]=m}}else n===xa||n===ga||n===Ba?r[n]=o.map((function(t){return{v:t.v,u:t.u}})):n===Ia?o&&(o=o.map((function(t){for(var e=new Array(6),r=0;r<4;r++){var i=t[r];e[r]={v:i.v,u:i.u}}return e[4]=t[4].slice(0),e[5]=t[5],e})),r[n]=o):n===ma?o&&(r[n]=o.map((function(t){return[{v:t[0].v,u:t[0].u},{v:t[1].v,u:t[1].u}]}))):n===ba||n===Ma?r[n]=o:n===Xa?o&&(r[n]=o.map((function(t){return{v:t.v,u:t.u}}))):Mn(n)||bn(n)?r[n]={v:o.v,u:o.u}:En(n)?r[n]=o.map((function(t){return t?t.u===hn?{v:G.clone(t.v),u:hn}:t.u===en?{v:t.v.slice(0),u:en}:{v:t.v,u:t.u}:null})):mn(n)?o.u===hn?r[n]={v:G.clone(o.v),u:hn}:o.u===en?r[n]={v:o.v.slice(0),u:en}:r[n]={u:Qa}:pn.hasOwnProperty(n)?r[n]=G.clone(o):r[n]=o}return r},calNormalLineHeight:On,calFontFamily:In,spreadBoxShadow:function(t,e){var r=u(t,4),i=r[0],a=r[1],n=r[2],o=r[3];if(Array.isArray(e)){var s=0,l=0,h=0,c=0;e.forEach((function(t){var e=u(t,6),r=e[0],i=e[1],a=e[2],n=e[3],o=e[4];if("inset"!==e[5]&&o[3]>0){var f=Ki.outerSize(a);f+=n,s=Math.min(s,r-f),l=Math.min(l,r-f),h=Math.max(h,r+f),c=Math.max(c,i+f)}})),i+=s,a+=l,n+=h,o+=c}return[i,a,n,o]},spreadFilter:function(t,e){var r=u(t,4),i=r[0],a=r[1],n=r[2],o=r[3];return Array.isArray(e)&&e.forEach((function(t){var e=t.k,r=t.v;if("blur"===e&&r>0){var s=Ki.kernelSize(r),l=Ki.outerSizeByD(s);l&&(i-=l,a-=l,n+=l,o+=l)}else if("dropShadow"===e){var h=Ki.kernelSize(r[2]),u=Ki.outerSizeByD(h);(r[0]||r[1]||u)&&((r[0]<=0||r[0]>0&&r[0]<u)&&(i+=r[0]-u),(r[1]<=0||r[1]>0&&r[1]<u)&&(a+=r[1]-u),(r[0]<0&&-r[0]<u||r[0]>=0)&&(n+=r[0]+u),(r[1]<0&&-r[1]<u||r[1]>=0)&&(o+=r[1]+u))}})),[i,a,n,o]}};function Dn(t,e,r,i){var a=r-t,n=i-e,o=Math.atan(Math.abs(n)/Math.abs(a));return a<0&&n>=0?Math.PI-o:a<0&&n<0?o-Math.PI:a>=0&&n>=0?o:-o}function Bn(t){var e=Math.sin(t),r=Math.cos(t),i=g.identity();return i[0]=i[5]=r,i[1]=e,i[4]=-e,i}function Pn(t,e){var r=u(t,6),i=r[0],a=r[1],n=r[2],o=r[3],s=r[4],l=r[5],h=u(e,6),c=h[0],f=h[1],_=h[2],v=h[3],y=h[4],d=(n-i)*(l-a)-(s-i)*(o-a),p=(_-c)*(h[5]-f)-(y-c)*(v-f);return d>0&&p<0||d<0&&p>0}var Nn={exchangeOrder:function(t,e){var r=function(t){var e=u(t,6),r=e[0],i=e[1],a=e[2],n=e[3],o=e[4],s=e[5],l=[0,1,2];if(a<r&&a<o){var h=[a,n,r,i];r=h[0],i=h[1],a=h[2],n=h[3],l[0]=1,l[1]=0}else if(o<a&&o<r){var c=[o,s,r,i];r=c[0],i=c[1],o=c[2],s=c[3],l[0]=2,l[2]=0}if(r===a){if(i>n){var f=[a,n,r,i];r=f[0],i=f[1],a=f[2],n=f[3];var _=l[0];l[0]=l[1],l[1]=_}}else if(r===o&&i>s){var v=[o,s,r,i];r=v[0],i=v[1],o=v[2],s=v[3];var y=l[0];l[0]=l[2],l[2]=y}if((a-r)*(s-i)-(o-r)*(n-i)<0){var d=[o,s,a,n];a=d[0],n=d[1],o=d[2],s=d[3];var p=l[1];l[1]=l[2],l[2]=p}return[r,i,a,n,o,s,l]}(t),i=u(r,7),a=i[0],n=i[1],o=i[2],s=i[3],l=i[4],h=i[5],c=function(t,e){for(var r=[],i=0,a=e.length;i<a;i++){var n=e[i];r.push(t[2*n]),r.push(t[2*n+1])}return r}(e,i[6]),f=u(c,6);return[[a,n,o,s,l,h],[f[0],f[1],f[2],f[3],f[4],f[5]]]},isOverflow:Pn,transform:function(t,e){var r,i=u(t,6),a=i[0],n=i[1],o=i[2],s=i[3],l=i[4],h=i[5],c=u(e,6),f=c[0],_=c[1],v=c[2],y=c[3],d=c[4],p=c[5],x=Pn(t,e),m=g.identity();m[12]=-a,m[13]=-n;var b=Dn(a,n,o,s);0!==b&&(r=Bn(-b),m=g.multiply(r,m));var M=Ut.pointsDistance(a,n,o,s),E=Ut.pointsDistance(f,_,v,y),A=g.identity();A[12]=-f,A[13]=-_;var S=b=Dn(f,_,v,y);0!==b&&(r=Bn(-b),A=g.multiply(r,A));var T=Math.abs(g.calPoint([l,h],m)[1]),w=Math.abs(g.calPoint([d,p],A)[1]);M===E&&T===w||(r=g.identity(),M!==E&&(r[0]=E/M),T!==w&&(r[5]=w/T),m=g.multiply(r,m)),A=m;var R=u(g.calPoint([a,n],A),2),k=R[0],C=R[1],O=u(g.calPoint([o,s],A),2),I=O[0],F=O[1],L=u(g.calPoint([l,h],A),2),D=L[0],B=L[1],P=Ut.pointsDistance(k,C,I,F),N=Ut.pointsDistance(k,C,D,B),G=Ut.pointsDistance(D,B,I,F),H=Ut.pointsDistance(f,_,v,y),W=Ut.pointsDistance(f,_,d,p),Y=Ut.pointsDistance(d,p,v,y),z=Ut.angleBySide(G,P,N),X=Ut.angleBySide(Y,H,W);return z!==X&&((r=g.identity())[4]=Math.tan(z-.5*Math.PI)+Math.tan(.5*Math.PI-X),m=g.multiply(r,m)),x&&(m[1]=-m[1],m[5]=-m[5],m[13]=-m[13]),(r=0!==S?Bn(S):g.identity())[12]=f,r[13]=_,g.multiply(r,m)}},Gn=1e-6;function Hn(t){var e=[],r=t[3],i=t[2]/r,a=t[1]/r,n=(3*a-i*i)/3,o=(2*i*i*i-9*a*i+27*(t[0]/r))/27,s=i/3,l=o*o/4+n*n*n/27,h=o/2;if(Math.abs(l)<=Gn&&(l=0),l>0){var u,c,f=Math.sqrt(l);c=(u=-h+f)>=0?Math.pow(u,1/3):-Math.pow(-u,1/3),(u=-h-f)>=0?c+=Math.pow(u,1/3):c-=Math.pow(-u,1/3),e.push(c-s)}else if(l<0){var _=Math.sqrt(-n/3),v=Math.atan2(Math.sqrt(-l),-h)/3,y=Math.cos(v),d=Math.sin(v),p=Math.sqrt(3);e.push(2*_*y-s),e.push(-_*(y+p*d)-s),e.push(-_*(y-p*d)-s)}else{var x;x=h>=0?-Math.pow(h,1/3):Math.pow(-h,1/3),e.push(2*x-s),e.push(-x-s)}return e}var Wn={getRoots:function(t){for(var e=t.length-1,r=e;r>=0&&Math.abs(t[r])<1e-12;r--)e--;var i=[];switch(e){case 1:i=function(t){var e=[],r=t[1];return 0!==r&&e.push(-t[0]/r),e}(t);break;case 2:i=function(t){var e=[],r=t[2],i=t[1]/r,a=i*i-t[0]/r*4;if(a>0){var n=Math.sqrt(a);e.push(.5*(-i+n)),e.push(.5*(-i-n))}else 0===a&&e.push(.5*-i);return e}(t);break;case 3:i=Hn(t);break;case 4:i=function(t){var e=[],r=t[4],i=t[3]/r,a=t[2]/r,n=t[1]/r,o=t[0]/r,s=Hn([1,-a,i*n-4*o,-i*i*o+4*a*o-n*n].reverse())[0],l=i*i/4-a+s;if(Math.abs(l)<=Gn&&(l=0),l>0){var h=Math.sqrt(l),u=3*i*i/4-h*h-2*a,c=(4*i*a-8*n-i*i*i)/(4*h),f=u+c,_=u-c;if(Math.abs(f)<=Gn&&(f=0),Math.abs(_)<=Gn&&(_=0),f>=0){var v=Math.sqrt(f);e.push(-i/4+(h+v)/2),e.push(-i/4+(h-v)/2)}if(_>=0){var y=Math.sqrt(_);e.push(-i/4+(y-h)/2),e.push(-i/4-(y+h)/2)}}else if(l<0);else{var d=s*s-4*o;if(d>=-1e-6){d<0&&(d=0);var p=3*i*i/4-2*a;if(p+(d=2*Math.sqrt(d))>=Gn){var x=Math.sqrt(p+d);e.push(-i/4+x/2),e.push(-i/4-x/2)}if(p-d>=Gn){var g=Math.sqrt(p-d);e.push(-i/4+g/2),e.push(-i/4-g/2)}}}return e}(t)}return i}};function Yn(t,e,r,i,a,n){var o=Math.min(t,a),s=Math.min(e,n),l=Math.max(t,a),h=Math.max(e,n);if(r<o||i<s||r>l||i>h){var u=(t-r)/(t-2*r+a);u<0?u=0:u>1&&(u=1);var c=(e-i)/(e-2*i+n);c<0?c=0:c>1&&(c=1);var f=1-u,_=1-c,v=f*f*t+2*f*u*r+u*u*a,y=_*_*e+2*_*c*i+c*c*n;o=Math.min(o,v),s=Math.min(s,y),l=Math.max(l,v),h=Math.max(h,y)}return[o,s,l,h]}function zn(t,e,r,i,a,n,o,s){var l=Math.min(t,o),h=Math.min(e,s),u=Math.max(t,o),c=Math.max(e,s);if(r<l||i<h||r>u||i>c||a<l||n<h||a>u||n>c){var f=-t+r,_=-e+i,v=t-2*r+a,y=e-2*i+n,d=3*r-t-3*a+o,p=3*i-e-3*n+s,x=v*v-d*f,g=y*y-p*_;if(x>0){var m=(-v-(x=Math.sqrt(x)))/d;if(d&&m>0&&m<1){var b=1-m,M=b*b*b*t+3*b*b*m*r+3*b*m*m*a+m*m*m*o;l=Math.min(l,M),u=Math.max(u,M)}if((m=d?(-v+x)/d:.5*-f/v)>0&&m<1){var E=1-m,A=E*E*E*t+3*E*E*m*r+3*E*m*m*a+m*m*m*o;l=Math.min(l,A),u=Math.max(u,A)}}if(g>0){var S=(-y-(g=Math.sqrt(g)))/p;if(p&&S>0&&S<1){var T=1-S,w=T*T*T*e+3*T*T*S*i+3*T*S*S*n+S*S*S*s;h=Math.min(h,w),c=Math.max(c,w)}if((S=p?(-y+g)/p:.5*-_/y)>0&&S<1){var R=1-S,k=R*R*R*e+3*R*R*S*i+3*R*S*S*n+S*S*S*s;h=Math.min(h,k),c=Math.max(c,k)}}}return[l,h,u,c]}function Xn(t){var e=t.length,r=t.reduce((function(t,r){return Math.pow(t,e)+Math.pow(r,e)}));return Math.pow(r,1/e)}function Un(t,e,r){var i=t,a=(2*e+r)/3,n=(e+2*r)/3;return(i(e)+3*i(a)+3*i(n)+i(r))*(r-e)/8}function Vn(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,a=t,n=(e+r)/2,o=Un(a,e,r),s=Un(a,e,n),l=Un(a,n,r),h=s+l-o;return Math.abs(h)<=15*i?s+l+h/15:Vn(a,e,n,i/2)+Vn(a,n,r,i/2)}function Kn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(6===t.length?t=[[t[0],t[1]],[t[2],t[3]],[t[4],t[5]]]:8===t.length&&(t=[[t[0],t[1]],[t[2],t[3]],[t[4],t[5]],[t[6],t[7]]]),2===t.length){var i=u(t[0],2),a=i[0],n=i[1],o=u(t[1],2),s=o[0],l=o[1];return Math.sqrt(Math.pow(s-a,2)+Math.pow(l-n,2))}var h=function(e){return Xn(qn(e,t))};return Vn(h,e,r)}function jn(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=u(e,4),a=i[0],n=i[1],o=i[2],s=i[3],l=u(a,2),h=l[0],c=l[1],f=u(n,2),_=f[0],v=f[1],y=u(o,2),d=y[0],p=y[1],x=u(s,2),g=x[0],m=x[1],b=0,M=0;return 0===r?(b=Math.pow(1-t,3)*h+3*t*Math.pow(1-t,2)*_+3*(1-t)*Math.pow(t,2)*d+Math.pow(t,3)*g,M=Math.pow(1-t,3)*c+3*t*Math.pow(1-t,2)*v+3*(1-t)*Math.pow(t,2)*p+Math.pow(t,3)*m):1===r?(b=3*((1-t)*(1-t)*(_-h)+2*(1-t)*t*(d-_)+t*t*(g-d)),M=3*((1-t)*(1-t)*(v-c)+2*(1-t)*t*(p-v)+t*t*(m-p))):2===r?(b=6*(d-2*_+h)*(1-t)+6*(g-2*d+_)*t,M=6*(p-2*v+c)*(1-t)+6*(m-2*p+v)*t):3===r&&(b=6*(g-3*d+3*_-h),M=6*(m-3*p+3*v-c)),[b,M]}function Zn(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=u(e,3),a=i[0],n=i[1],o=i[2],s=u(a,2),l=s[0],h=s[1],c=u(n,2),f=c[0],_=c[1],v=u(o,2),y=v[0],d=v[1],p=0,x=0;return 0===r?(p=Math.pow(1-t,2)*l+2*t*(1-t)*f+Math.pow(t,2)*y,x=Math.pow(1-t,2)*h+2*t*(1-t)*_+Math.pow(t,2)*d):1===r?(p=2*(1-t)*(f-l)+2*t*(y-f),x=2*(1-t)*(_-h)+2*t*(d-_)):2===r&&(p=2*(y-2*f+l),x=2*(d-2*_+h)),[p,x]}function qn(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return 4===e.length?jn(t,e,r):3===e.length?Zn(t,e,r):void 0}function $n(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001,n=function(e){return Xn(qn(e,t))},o=e*r,s=r,l=s,h=0;h<i;h++){var u=Un(n,0,s)-o;if(Math.abs(u)<a)break;var c=Xn(qn(s,t,1)),f=Xn(qn(s,t,2)),_=u*c,v=u*f+c*c;if(s-=_/v,Math.abs(s-l)<a)break;l=s}return qn(s,t,0)}function Jn(t,e){var r=u(t,4),i=u(r[0],2),a=i[0],n=i[1],o=u(r[1],2),s=o[0],l=o[1],h=u(r[2],2),c=h[0],f=h[1],_=r[3],v=(s-a)*e+a,y=(l-n)*e+n,d=(c-s)*e+s,p=(f-l)*e+l,x=(d-v)*e+v,g=(p-y)*e+y;if(4===t.length){var m=u(_,2);return[[a,n],[v,y],[x,g],[(((m[0]-c)*e+c-d)*e+d-x)*e+x,(((m[1]-f)*e+f-p)*e+p-g)*e+g]]}if(3===t.length)return[[a,n],[v,y],[x,g]]}function Qn(t,e){return[t[0][0]*(1-e)*(1-e)+2*t[1][0]*e*(1-e)+t[2][0]*e*e,t[0][1]*(1-e)*(1-e)+2*t[1][1]*e*(1-e)+t[2][1]*e*e]}function to(t,e){return[t[0][0]*(1-e)*(1-e)*(1-e)+3*t[1][0]*e*(1-e)*(1-e)+3*t[2][0]*e*e*(1-e)+t[3][0]*e*e*e,t[0][1]*(1-e)*(1-e)*(1-e)+3*t[1][1]*e*(1-e)*(1-e)+3*t[2][1]*e*e*(1-e)+t[3][1]*e*e*e]}var eo={bboxBezier:function(t,e,r,i,a,n,o,s){var l=arguments.length;if(Array.isArray(t)){var h=t.length,c=t,f=u(c[0],2);t=f[0],e=f[1];var _=u(c[1],2);if(r=_[0],i=_[1],l=4,h>=3){var v=u(c[2],2);a=v[0],n=v[1],l=6}if(h>=4){var y=u(c[3],2);o=y[0],s=y[1],l=8}}if(4===l){var d=Math.min(t,r),p=Math.min(e,i),x=Math.max(t,r),g=Math.max(e,i);return[d,p,x,g]}return 6===l?Yn(t,e,r,i,a,n):8===l?zn(t,e,r,i,a,n,o,s):void 0},bezierLength:Kn,pointAtBezier:function(t,e,r,i){return $n(t,Kn(t,0,1),e,r,i)},pointAtBezierWithLength:$n,sliceBezier:Jn,sliceBezier2Both:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e=Math.max(e,0),r=Math.min(r,1),0===e&&1===r||(r<1&&(t=Jn(t,r)),e>0&&(r<1&&(e/=r),t=Jn(t.slice(0).reverse(),1-e).reverse())),t},pointAtByT:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 4===t.length?to(t,e):3===t.length?Qn(t,e):void 0},getPointT:function(t,e,r){return 4===t.length?function(t,e,r){for(var i=Wn.getRoots([t[0][0]-e,3*(t[1][0]-t[0][0]),3*(t[2][0]+t[0][0]-2*t[1][0]),t[3][0]-t[0][0]+3*t[1][0]-3*t[2][0]]).filter((function(t){return t>=0&&t<=1})),a=Wn.getRoots([t[0][1]-r,3*(t[1][1]-t[0][1]),3*(t[2][1]+t[0][1]-2*t[1][1]),t[3][1]-t[0][1]+3*t[1][1]-3*t[2][1]]).filter((function(t){return t>=0&&t<=1})),n=[],o=0,s=i.length;o<s;o++)for(var l=i[o],h=0,u=a.length;h<u;h++){var c=a[h],f=Math.abs(l-c);f<1e-10&&n.push({x:l,y:c,diff:f})}n.sort((function(t,e){return t.diff-e.diff})),n.length>3&&n.splice(3);n=n.map((function(t){return.5*(t.x+t.y)}));var _=[];return n.forEach((function(i){var a=t[0][0]*Math.pow(1-i,3)+3*t[1][0]*i*Math.pow(1-i,2)+3*t[2][0]*i*i*(1-i)+t[3][0]*Math.pow(i,3),n=t[0][1]*Math.pow(1-i,3)+3*t[1][1]*i*Math.pow(1-i,2)+3*t[2][1]*i*i*(1-i)+t[3][1]*Math.pow(i,3);Math.abs(a-e)<1e-10&&Math.abs(n-r)<1e-10&&_.push(i)})),_}(t,e,r):3===t.length?function(t,e,r){for(var i=Wn.getRoots([t[0][0]-e,2*(t[1][0]-t[0][0]),t[2][0]+t[0][0]-2*t[1][0]]).filter((function(t){return t>=0&&t<=1})),a=Wn.getRoots([t[0][1]-r,2*(t[1][1]-t[0][1]),t[2][1]+t[0][1]-2*t[1][1]]).filter((function(t){return t>=0&&t<=1})),n=[],o=0,s=i.length;o<s;o++)for(var l=i[o],h=0,u=a.length;h<u;h++){var c=a[h],f=Math.abs(l-c);f<1e-10&&n.push({x:l,y:c,diff:f})}n.sort((function(t,e){return t.diff-e.diff})),n.length>2&&n.splice(2);n=n.map((function(t){return.5*(t.x+t.y)}));var _=[];return n.forEach((function(i){var a=t[0][0]*Math.pow(1-i,2)+2*t[1][0]*i*(1-i)+t[2][0]*i*i,n=t[0][1]*Math.pow(1-i,2)+2*t[1][1]*i*(1-i)+t[2][1]*i*i;Math.abs(a-e)<1e-10&&Math.abs(n-r)<1e-10&&_.push(i)})),_}(t,e,r):void 0},bezierSlope:function(t,e){if(2===t.length){var r=u(t[0],2),i=r[0],a=r[1],n=u(t[1],2),o=n[0],s=n[1];return i===o?1/0:(s-a)/(o-i)}return 3===t.length?function(t,e){var r=u(t,3),i=u(r[0],2),a=i[0],n=i[1],o=u(r[1],2),s=o[0],l=o[1],h=u(r[2],2),c=h[0],f=h[1],_=2*(a-2*s+c)*e+2*s-2*a;if(0===_)return 1/0;return(2*(n-2*l+f)*e+2*l-2*n)/_}(t,e):4===t.length?function(t,e){var r=u(t,4),i=u(r[0],2),a=i[0],n=i[1],o=u(r[1],2),s=o[0],l=o[1],h=u(r[2],2),c=h[0],f=h[1],_=u(r[3],2),v=_[0],y=_[1],d=3*(3*s-a-3*c+v)*e*e+2*(3*a-6*s+3*c)*e+3*s-3*a;if(0===d)return 1/0;return(3*(3*l-n-3*f+y)*e*e+2*(3*n-6*l+3*f)*e+3*l-3*n)/d}(t,e):void 0}},ro=Wn.getRoots,io=1e-6;function ao(t,e){for(var r=0,i=e.length-1;i>=0;i--)r=r*t+e[i];return r}function no(t,e,r){var i,a=ao(t,r),n=ao(e,r);if(Math.abs(a)<=io)i=t;else if(Math.abs(n)<=io)i=e;else if(a*n<=0)for(var o=Math.log(e-t),s=6*Math.LN10,l=Math.ceil((o+s)/Math.LN2),h=0;h<l;h++){var u=ao(i=.5*(t+e),r);if(Math.abs(u)<=io)break;u*a<0?(e=i,n=u):(t=i,a=u)}return i}function oo(t,e,r){var i,a=[];if(1===r.length-1)null!=(i=no(t,e,r))&&a.push(i);else{var n=function(t){for(var e=[],r=1;r<t.length;r++)e.push(r*t[r]);return e}(r),o=oo(t,e,n);if(o.length>0){null!=(i=no(t,o[0],r))&&a.push(i);for(var s=0;s<=o.length-2;s++)null!=(i=no(o[s],o[s+1],r))&&a.push(i);null!=(i=no(o[o.length-1],e,r))&&a.push(i)}else null!=(i=no(t,e,r))&&a.push(i)}return a}var so={intersectBezier2Line:function(t,e,r,i,a,n,o,s,l,h){var u,c,f,_,v=[],y=Math.min(o,l),d=Math.min(s,h),p=Math.max(o,l),x=Math.max(s,h),g=function(t,e){return t.x*e.x+t.y*e.y},m=function(t,e,r){return{x:t.x-(t.x-e.x)*r,y:t.y-(t.y-e.y)*r,t:r}};u={x:-2*t+2*r,y:-2*e+2*i},c={x:t,y:e},f=o*h-l*s;for(var b=[g(_={x:s-h,y:l-o},{x:t-2*r+a,y:e-2*i+n}),g(_,u),g(_,c)+f].reverse(),M=ro(b),E=0;E<M.length;E++){var A=M[E];if(0<=A&&A<=1){var S=m({x:t,y:e},{x:r,y:i},A),T=m({x:r,y:i},{x:a,y:n},A),w=m(S,T,A);o===l?d<=w.y&&w.y<=x&&v.push(w):s===h?y<=w.x&&w.x<=p&&v.push(w):w.x>=y&&w.y>=d&&w.x<=p&&w.y<=x&&v.push(w)}}return v},intersectBezier3Line:function(t,e,r,i,a,n,o,s,l,h,u,c){var f,_,v,y,d=[],p=Math.min(l,u),x=Math.min(h,c),g=Math.max(l,u),m=Math.max(h,c),b=function(t,e){return t.x*e.x+t.y*e.y},M=function(t,e,r){return{x:t.x-(t.x-e.x)*r,y:t.y-(t.y-e.y)*r,t:r}};f={x:3*r-t-3*a+o,y:3*i-e-3*n+s},_={x:3*t-6*r+3*a,y:3*e-6*i+3*n},v={x:-3*t+3*r,y:-3*e+3*i};for(var E=[l*c-u*h+b(y={x:h-c,y:u-l},{x:t,y:e}),b(y,v),b(y,_),b(y,f)],A=ro(E),S=0;S<A.length;S++){var T=A[S];if(0<=T&&T<=1){var w=M({x:t,y:e},{x:r,y:i},T),R=M({x:r,y:i},{x:a,y:n},T),k=M({x:a,y:n},{x:o,y:s},T),C=M(w,R,T),O=M(R,k,T),I=M(C,O,T);l===u?x<=I.y&&I.y<=m&&d.push(I):h===c?p<=I.x&&I.x<=g&&d.push(I):I.x>=p&&I.y>=x&&I.x<=g&&I.y<=m&&d.push(I)}}return d},intersectBezier2Bezier2:function(t,e,r,i,a,n,o,s,l,h,u,c){var f,_,v,y,d,p,x,g=[];if(_={x:2*r-2*t,y:2*i-2*e},v={x:t,y:e},y={x:o-2*l+u,y:s-2*h+c},d={x:2*l-2*o,y:2*h-2*s},p={x:o,y:s},0===(f={x:t-2*r+a,y:e-2*i+n}).y){var m=f.x*(v.y-p.y),b=m-_.x*_.y,M=_.y*_.y;x=[f.x*y.y*y.y,2*f.x*d.y*y.y,f.x*d.y*d.y-y.x*M-y.y*m-y.y*b,-d.x*M-d.y*m-d.y*b,(v.x-p.x)*M+(v.y-p.y)*b].reverse()}else{var E=f.x*y.y-f.y*y.x,A=f.x*d.y-d.x*f.y,S=_.x*f.y-_.y*f.x,T=v.y-p.y,w=f.y*(v.x-p.x)-f.x*T,R=-_.y*S+f.y*w,k=S*S;x=[E*E,2*E*A,(-y.y*k+f.y*A*A+f.y*E*w+E*R)/f.y,(-d.y*k+f.y*A*w+A*R)/f.y,(T*k+w*R)/f.y].reverse()}for(var C=ro(x),O=0;O<C.length;O++){var I=C[O];if(0<=I&&I<=1){var F=ro([f.x,_.x,v.x-p.x-I*d.x-I*I*y.x].reverse()),L=ro([f.y,_.y,v.y-p.y-I*d.y-I*I*y.y].reverse());if(F.length>0&&L.length>0){t:for(var D=0;D<F.length;D++){var B=F[D];if(0<=B&&B<=1)for(var P=0;P<L.length;P++)if(Math.abs(B-L[P])<1e-4){var N=y.x*I*I+d.x*I+p.x,G=y.y*I*I+d.y*I+p.y;g.push({x:N,y:G,t:B});break t}}}}}return g},intersectBezier3Bezier3:function(t,e,r,i,a,n,o,s,l,h,u,c,f,_,v,y){var d,p,x,g,m,b,M,E,A=[];d={x:3*r-t-3*a+o,y:3*i-e-3*n+s},p={x:3*t-6*r+3*a,y:3*e-6*i+3*n},m={x:3*u-l-3*f+v,y:3*c-h-3*_+y},b={x:3*l-6*u+3*f,y:3*h-6*c+3*_},M={x:-3*l+3*u,y:-3*h+3*c},E={x:l,y:h};for(var S=(g={x:t,y:e}).x*g.x,T=g.x*g.x*g.x,w=g.y*g.y,R=g.y*g.y*g.y,k=(x={x:-3*t+3*r,y:-3*e+3*i}).x*x.x,C=x.x*x.x*x.x,O=x.y*x.y,I=x.y*x.y*x.y,F=p.x*p.x,L=p.x*p.x*p.x,D=p.y*p.y,B=p.y*p.y*p.y,P=d.x*d.x,N=d.x*d.x*d.x,G=d.y*d.y,H=d.y*d.y*d.y,W=E.x*E.x,Y=E.x*E.x*E.x,z=E.y*E.y,X=E.y*E.y*E.y,U=M.x*M.x,V=M.x*M.x*M.x,K=M.y*M.y,j=b.x*b.x,Z=b.x*b.x*b.x,q=b.y*b.y,$=m.x*m.x,J=m.y*m.y,Q=oo(0,1,[-N*(m.y*m.y*m.y)+H*(m.x*m.x*m.x)-3*d.x*G*$*m.y+3*P*d.y*m.x*J,-6*d.x*b.x*G*m.x*m.y+6*P*d.y*b.y*m.x*m.y+3*b.x*H*$-3*N*b.y*J-3*d.x*G*b.y*$+3*P*b.x*d.y*J,-6*M.x*d.x*G*m.x*m.y-6*d.x*b.x*G*b.y*m.x+6*P*b.x*d.y*b.y*m.y+3*M.x*H*$+3*j*H*m.x+3*M.x*P*d.y*J-3*d.x*M.y*G*$-3*d.x*j*G*m.y+P*d.y*m.x*(6*M.y*m.y+3*q)+N*(-M.y*J-2*q*m.y-m.y*(2*M.y*m.y+q)),x.x*p.y*d.x*d.y*m.x*m.y-x.y*p.x*d.x*d.y*m.x*m.y+6*M.x*b.x*H*m.x+3*x.x*p.x*d.x*d.y*J+6*g.x*d.x*G*m.x*m.y-3*x.x*p.x*G*m.x*m.y-3*x.y*p.y*d.x*d.y*$-6*g.y*P*d.y*m.x*m.y-6*E.x*d.x*G*m.x*m.y+3*x.y*p.y*P*m.x*m.y-2*p.x*D*d.x*m.x*m.y-6*M.x*d.x*b.x*G*m.y-6*M.x*d.x*G*b.y*m.x-6*d.x*M.y*b.x*G*m.x+6*M.x*P*d.y*b.y*m.y+2*F*p.y*d.y*m.x*m.y+Z*H-3*g.x*H*$+3*g.y*N*J+3*E.x*H*$+B*d.x*$-L*d.y*J-3*g.x*P*d.y*J+3*g.y*d.x*G*$-2*x.x*p.y*P*J+x.x*p.y*G*$-x.y*p.x*P*J+2*x.y*p.x*G*$+3*E.x*P*d.y*J-p.x*D*d.y*$-3*E.y*d.x*G*$+F*p.y*d.x*J-3*d.x*j*G*b.y+P*d.y*m.x*(6*E.y*m.y+6*M.y*b.y)+P*b.x*d.y*(6*M.y*m.y+3*q)+N*(-2*M.y*b.y*m.y-E.y*J-b.y*(2*M.y*m.y+q)-m.y*(2*E.y*m.y+2*M.y*b.y)),6*x.x*p.x*d.x*d.y*b.y*m.y+x.x*p.y*d.x*b.x*d.y*m.y+x.x*p.y*d.x*d.y*b.y*m.x-x.y*p.x*d.x*b.x*d.y*m.y-x.y*p.x*d.x*d.y*b.y*m.x-6*x.y*p.y*d.x*b.x*d.y*m.x-6*g.x*b.x*H*m.x+6*E.x*b.x*H*m.x+6*g.y*N*b.y*m.y+2*B*d.x*b.x*m.x-2*L*d.y*b.y*m.y+6*g.x*d.x*b.x*G*m.y+6*g.x*d.x*G*b.y*m.x+6*g.y*d.x*b.x*G*m.x-3*x.x*p.x*b.x*G*m.y-3*x.x*p.x*G*b.y*m.x+2*x.x*p.y*b.x*G*m.x+4*x.y*p.x*b.x*G*m.x-6*g.x*P*d.y*b.y*m.y-6*g.y*P*b.x*d.y*m.y-6*g.y*P*d.y*b.y*m.x-4*x.x*p.y*P*b.y*m.y-6*E.x*d.x*b.x*G*m.y-6*E.x*d.x*G*b.y*m.x-2*x.y*p.x*P*b.y*m.y+3*x.y*p.y*P*b.x*m.y+3*x.y*p.y*P*b.y*m.x-2*p.x*D*d.x*b.x*m.y-2*p.x*D*d.x*b.y*m.x-2*p.x*D*b.x*d.y*m.x-6*E.y*d.x*b.x*G*m.x-6*M.x*d.x*M.y*G*m.x-6*M.x*d.x*b.x*G*b.y+6*E.x*P*d.y*b.y*m.y+2*F*p.y*d.x*b.y*m.y+2*F*p.y*b.x*d.y*m.y+2*F*p.y*d.y*b.y*m.x+3*M.x*j*H+3*U*H*m.x-3*d.x*M.y*j*G-3*U*d.x*G*m.y+P*b.x*d.y*(6*E.y*m.y+6*M.y*b.y)+P*d.y*m.x*(6*E.y*b.y+3*K)+M.x*P*d.y*(6*M.y*m.y+3*q)+N*(-2*E.y*b.y*m.y-m.y*(2*E.y*b.y+K)-M.y*(2*M.y*m.y+q)-b.y*(2*E.y*m.y+2*M.y*b.y)),x.x*M.x*p.y*d.x*d.y*m.y+x.x*p.y*d.x*M.y*d.y*m.x+x.x*p.y*d.x*b.x*d.y*b.y-x.y*p.x*M.x*d.x*d.y*m.y-x.y*p.x*d.x*M.y*d.y*m.x-x.y*p.x*d.x*b.x*d.y*b.y-6*x.y*M.x*p.y*d.x*d.y*m.x-6*g.x*M.x*H*m.x+6*E.x*M.x*H*m.x+2*M.x*B*d.x*m.x+6*g.x*M.x*d.x*G*m.y+6*g.x*d.x*M.y*G*m.x+6*g.x*d.x*b.x*G*b.y+6*g.y*M.x*d.x*G*m.x-3*x.x*p.x*M.x*G*m.y-3*x.x*p.x*M.y*G*m.x-3*x.x*p.x*b.x*G*b.y+2*x.x*M.x*p.y*G*m.x+4*x.y*p.x*M.x*G*m.x-6*g.y*M.x*P*d.y*m.y-6*g.y*P*M.y*d.y*m.x-6*g.y*P*b.x*d.y*b.y-6*E.x*M.x*d.x*G*m.y-6*E.x*d.x*M.y*G*m.x-6*E.x*d.x*b.x*G*b.y+3*x.y*M.x*p.y*P*m.y-3*x.y*p.y*d.x*j*d.y+3*x.y*p.y*P*M.y*m.x+3*x.y*p.y*P*b.x*b.y-2*p.x*M.x*D*d.x*m.y-2*p.x*M.x*D*d.y*m.x-2*p.x*D*d.x*M.y*m.x-2*p.x*D*d.x*b.x*b.y-6*E.y*M.x*d.x*G*m.x-6*M.x*d.x*M.y*b.x*G+6*E.y*P*M.y*d.y*m.x+2*F*M.x*p.y*d.y*m.y+2*F*p.y*M.y*d.y*m.x+2*F*p.y*b.x*d.y*b.y-3*g.x*j*H+3*E.x*j*H+3*U*b.x*H+B*d.x*j+3*g.y*d.x*j*G+x.x*p.y*j*G+2*x.y*p.x*j*G-p.x*D*j*d.y-3*E.y*d.x*j*G-3*U*d.x*G*b.y+F*p.y*d.x*(2*M.y*m.y+q)+x.x*p.x*d.x*d.y*(6*M.y*m.y+3*q)+M.x*P*d.y*(6*E.y*m.y+6*M.y*b.y)+L*d.y*(-2*M.y*m.y-q)+g.y*N*(6*M.y*m.y+3*q)+x.y*p.x*P*(-2*M.y*m.y-q)+x.x*p.y*P*(-4*M.y*m.y-2*q)+g.x*P*d.y*(-6*M.y*m.y-3*q)+P*b.x*d.y*(6*E.y*b.y+3*K)+E.x*P*d.y*(6*M.y*m.y+3*q)+N*(-2*E.y*M.y*m.y-b.y*(2*E.y*b.y+K)-E.y*(2*M.y*m.y+q)-M.y*(2*E.y*m.y+2*M.y*b.y)),-g.x*x.x*p.y*d.x*d.y*m.y+g.x*x.y*p.x*d.x*d.y*m.y+6*g.x*x.y*p.y*d.x*d.y*m.x-6*g.y*x.x*p.x*d.x*d.y*m.y-g.y*x.x*p.y*d.x*d.y*m.x+g.y*x.y*p.x*d.x*d.y*m.x+x.x*x.y*p.x*p.y*d.x*m.y-x.x*x.y*p.x*p.y*d.y*m.x+x.x*E.x*p.y*d.x*d.y*m.y+x.x*E.y*p.y*d.x*d.y*m.x+x.x*M.x*p.y*d.x*d.y*b.y+x.x*p.y*d.x*M.y*b.x*d.y-E.x*x.y*p.x*d.x*d.y*m.y-6*E.x*x.y*p.y*d.x*d.y*m.x-x.y*p.x*E.y*d.x*d.y*m.x-x.y*p.x*M.x*d.x*d.y*b.y-x.y*p.x*d.x*M.y*b.x*d.y-6*x.y*M.x*p.y*d.x*b.x*d.y-6*g.x*E.x*H*m.x-6*g.x*M.x*b.x*H-2*g.x*B*d.x*m.x+6*E.x*M.x*b.x*H+2*E.x*B*d.x*m.x+2*M.x*B*d.x*b.x+2*g.y*L*d.y*m.y-6*g.x*g.y*d.x*G*m.x+3*g.x*x.x*p.x*G*m.y-2*g.x*x.x*p.y*G*m.x-4*g.x*x.y*p.x*G*m.x+3*g.y*x.x*p.x*G*m.x+6*g.x*g.y*P*d.y*m.y+6*g.x*E.x*d.x*G*m.y-3*g.x*x.y*p.y*P*m.y+2*g.x*p.x*D*d.x*m.y+2*g.x*p.x*D*d.y*m.x+6*g.x*E.y*d.x*G*m.x+6*g.x*M.x*d.x*G*b.y+6*g.x*d.x*M.y*b.x*G+4*g.y*x.x*p.y*P*m.y+6*g.y*E.x*d.x*G*m.x+2*g.y*x.y*p.x*P*m.y-3*g.y*x.y*p.y*P*m.x+2*g.y*p.x*D*d.x*m.x+6*g.y*M.x*d.x*b.x*G-3*x.x*E.x*p.x*G*m.y+2*x.x*E.x*p.y*G*m.x+x.x*x.y*D*d.x*m.x-3*x.x*p.x*E.y*G*m.x-3*x.x*p.x*M.x*G*b.y-3*x.x*p.x*M.y*b.x*G+2*x.x*M.x*p.y*b.x*G+4*E.x*x.y*p.x*G*m.x+4*x.y*p.x*M.x*b.x*G-2*g.x*F*p.y*d.y*m.y-6*g.y*E.x*P*d.y*m.y-6*g.y*E.y*P*d.y*m.x-6*g.y*M.x*P*d.y*b.y-2*g.y*F*p.y*d.x*m.y-2*g.y*F*p.y*d.y*m.x-6*g.y*P*M.y*b.x*d.y-x.x*x.y*F*d.y*m.y-2*x.x*O*d.x*d.y*m.x+3*E.x*x.y*p.y*P*m.y-2*E.x*p.x*D*d.x*m.y-2*E.x*p.x*D*d.y*m.x-6*E.x*E.y*d.x*G*m.x-6*E.x*M.x*d.x*G*b.y-6*E.x*d.x*M.y*b.x*G+3*x.y*E.y*p.y*P*m.x+3*x.y*M.x*p.y*P*b.y+3*x.y*p.y*P*M.y*b.x-2*p.x*E.y*D*d.x*m.x-2*p.x*M.x*D*d.x*b.y-2*p.x*M.x*D*b.x*d.y-2*p.x*D*d.x*M.y*b.x-6*E.y*M.x*d.x*b.x*G-O*p.x*p.y*d.x*m.x+2*E.x*F*p.y*d.y*m.y+6*E.y*P*M.y*b.x*d.y+2*k*x.y*d.x*d.y*m.y+k*p.x*p.y*d.y*m.y+2*F*E.y*p.y*d.y*m.x+2*F*M.x*p.y*d.y*b.y+2*F*p.y*M.y*b.x*d.y+V*H+3*S*H*m.x-3*w*N*m.y+3*W*H*m.x+I*P*m.x-C*G*m.y-x.x*O*P*m.y+k*x.y*G*m.x-3*S*d.x*G*m.y+3*w*P*d.y*m.x-k*D*d.x*m.y+O*F*d.y*m.x-3*U*d.x*M.y*G-3*W*d.x*G*m.y+3*z*P*d.y*m.x+x.x*p.x*d.x*d.y*(6*E.y*m.y+6*M.y*b.y)+L*d.y*(-2*E.y*m.y-2*M.y*b.y)+g.y*N*(6*E.y*m.y+6*M.y*b.y)+x.y*p.x*P*(-2*E.y*m.y-2*M.y*b.y)+F*p.y*d.x*(2*E.y*m.y+2*M.y*b.y)+x.x*p.y*P*(-4*E.y*m.y-4*M.y*b.y)+g.x*P*d.y*(-6*E.y*m.y-6*M.y*b.y)+E.x*P*d.y*(6*E.y*m.y+6*M.y*b.y)+M.x*P*d.y*(6*E.y*b.y+3*K)+N*(-2*E.y*M.y*b.y-z*m.y-M.y*(2*E.y*b.y+K)-E.y*(2*E.y*m.y+2*M.y*b.y)),-g.x*x.x*p.y*d.x*d.y*b.y+g.x*x.y*p.x*d.x*d.y*b.y+6*g.x*x.y*p.y*d.x*b.x*d.y-6*g.y*x.x*p.x*d.x*d.y*b.y-g.y*x.x*p.y*d.x*b.x*d.y+g.y*x.y*p.x*d.x*b.x*d.y+x.x*x.y*p.x*p.y*d.x*b.y-x.x*x.y*p.x*p.y*b.x*d.y+x.x*E.x*p.y*d.x*d.y*b.y+x.x*E.y*p.y*d.x*b.x*d.y+x.x*M.x*p.y*d.x*M.y*d.y-E.x*x.y*p.x*d.x*d.y*b.y-6*E.x*x.y*p.y*d.x*b.x*d.y-x.y*p.x*E.y*d.x*b.x*d.y-x.y*p.x*M.x*d.x*M.y*d.y-6*g.x*E.x*b.x*H-2*g.x*B*d.x*b.x+2*E.x*B*d.x*b.x+2*g.y*L*d.y*b.y-6*g.x*g.y*d.x*b.x*G+3*g.x*x.x*p.x*G*b.y-2*g.x*x.x*p.y*b.x*G-4*g.x*x.y*p.x*b.x*G+3*g.y*x.x*p.x*b.x*G+6*g.x*g.y*P*d.y*b.y+6*g.x*E.x*d.x*G*b.y-3*g.x*x.y*p.y*P*b.y+2*g.x*p.x*D*d.x*b.y+2*g.x*p.x*D*b.x*d.y+6*g.x*E.y*d.x*b.x*G+6*g.x*M.x*d.x*M.y*G+4*g.y*x.x*p.y*P*b.y+6*g.y*E.x*d.x*b.x*G+2*g.y*x.y*p.x*P*b.y-3*g.y*x.y*p.y*P*b.x+2*g.y*p.x*D*d.x*b.x-3*x.x*E.x*p.x*G*b.y+2*x.x*E.x*p.y*b.x*G+x.x*x.y*D*d.x*b.x-3*x.x*p.x*E.y*b.x*G-3*x.x*p.x*M.x*M.y*G+4*E.x*x.y*p.x*b.x*G-2*g.x*F*p.y*d.y*b.y-6*g.y*E.x*P*d.y*b.y-6*g.y*E.y*P*b.x*d.y-6*g.y*M.x*P*M.y*d.y-2*g.y*F*p.y*d.x*b.y-2*g.y*F*p.y*b.x*d.y-x.x*x.y*F*d.y*b.y-2*x.x*O*d.x*b.x*d.y+3*E.x*x.y*p.y*P*b.y-2*E.x*p.x*D*d.x*b.y-2*E.x*p.x*D*b.x*d.y-6*E.x*E.y*d.x*b.x*G-6*E.x*M.x*d.x*M.y*G+3*x.y*E.y*p.y*P*b.x+3*x.y*M.x*p.y*P*M.y-2*p.x*E.y*D*d.x*b.x-2*p.x*M.x*D*d.x*M.y-O*p.x*p.y*d.x*b.x+2*E.x*F*p.y*d.y*b.y-3*x.y*U*p.y*d.x*d.y+6*E.y*M.x*P*M.y*d.y+2*k*x.y*d.x*d.y*b.y+k*p.x*p.y*d.y*b.y+2*F*E.y*p.y*b.x*d.y+2*F*M.x*p.y*M.y*d.y-3*g.x*U*H+3*E.x*U*H+3*S*b.x*H-3*w*N*b.y+3*W*b.x*H+U*B*d.x+I*P*b.x-C*G*b.y+3*g.y*U*d.x*G-x.x*O*P*b.y+x.x*U*p.y*G+2*x.y*p.x*U*G+k*x.y*b.x*G-p.x*U*D*d.y-3*E.y*U*d.x*G-3*S*d.x*G*b.y+3*w*P*b.x*d.y-k*D*d.x*b.y+O*F*b.x*d.y-3*W*d.x*G*b.y+3*z*P*b.x*d.y+F*p.y*d.x*(2*E.y*b.y+K)+x.x*p.x*d.x*d.y*(6*E.y*b.y+3*K)+L*d.y*(-2*E.y*b.y-K)+g.y*N*(6*E.y*b.y+3*K)+x.y*p.x*P*(-2*E.y*b.y-K)+x.x*p.y*P*(-4*E.y*b.y-2*K)+g.x*P*d.y*(-6*E.y*b.y-3*K)+E.x*P*d.y*(6*E.y*b.y+3*K)+N*(-2*E.y*K-z*b.y-E.y*(2*E.y*b.y+K)),-g.x*x.x*p.y*d.x*M.y*d.y+g.x*x.y*p.x*d.x*M.y*d.y+6*g.x*x.y*M.x*p.y*d.x*d.y-6*g.y*x.x*p.x*d.x*M.y*d.y-g.y*x.x*M.x*p.y*d.x*d.y+g.y*x.y*p.x*M.x*d.x*d.y-x.x*x.y*p.x*M.x*p.y*d.y+x.x*x.y*p.x*p.y*d.x*M.y+x.x*E.x*p.y*d.x*M.y*d.y+6*x.x*p.x*E.y*d.x*M.y*d.y+x.x*E.y*M.x*p.y*d.x*d.y-E.x*x.y*p.x*d.x*M.y*d.y-6*E.x*x.y*M.x*p.y*d.x*d.y-x.y*p.x*E.y*M.x*d.x*d.y-6*g.x*E.x*M.x*H-2*g.x*M.x*B*d.x+6*g.y*E.y*N*M.y+2*E.x*M.x*B*d.x+2*g.y*L*M.y*d.y-2*L*E.y*M.y*d.y-6*g.x*g.y*M.x*d.x*G+3*g.x*x.x*p.x*M.y*G-2*g.x*x.x*M.x*p.y*G-4*g.x*x.y*p.x*M.x*G+3*g.y*x.x*p.x*M.x*G+6*g.x*g.y*P*M.y*d.y+6*g.x*E.x*d.x*M.y*G-3*g.x*x.y*p.y*P*M.y+2*g.x*p.x*M.x*D*d.y+2*g.x*p.x*D*d.x*M.y+6*g.x*E.y*M.x*d.x*G+4*g.y*x.x*p.y*P*M.y+6*g.y*E.x*M.x*d.x*G+2*g.y*x.y*p.x*P*M.y-3*g.y*x.y*M.x*p.y*P+2*g.y*p.x*M.x*D*d.x-3*x.x*E.x*p.x*M.y*G+2*x.x*E.x*M.x*p.y*G+x.x*x.y*M.x*D*d.x-3*x.x*p.x*E.y*M.x*G+4*E.x*x.y*p.x*M.x*G-6*g.x*E.y*P*M.y*d.y-2*g.x*F*p.y*M.y*d.y-6*g.y*E.x*P*M.y*d.y-6*g.y*E.y*M.x*P*d.y-2*g.y*F*M.x*p.y*d.y-2*g.y*F*p.y*d.x*M.y-x.x*x.y*F*M.y*d.y-4*x.x*E.y*p.y*P*M.y-2*x.x*O*M.x*d.x*d.y+3*E.x*x.y*p.y*P*M.y-2*E.x*p.x*M.x*D*d.y-2*E.x*p.x*D*d.x*M.y-6*E.x*E.y*M.x*d.x*G-2*x.y*p.x*E.y*P*M.y+3*x.y*E.y*M.x*p.y*P-2*p.x*E.y*M.x*D*d.x-O*p.x*M.x*p.y*d.x+6*E.x*E.y*P*M.y*d.y+2*E.x*F*p.y*M.y*d.y+2*k*x.y*d.x*M.y*d.y+k*p.x*p.y*M.y*d.y+2*F*E.y*M.x*p.y*d.y+2*F*E.y*p.y*d.x*M.y+3*S*M.x*H-3*w*N*M.y+3*W*M.x*H+I*M.x*P-C*M.y*G-3*z*N*M.y-x.x*O*P*M.y+k*x.y*M.x*G-3*S*d.x*M.y*G+3*w*M.x*P*d.y-k*D*d.x*M.y+O*F*M.x*d.y-3*W*d.x*M.y*G+3*z*M.x*P*d.y,g.x*g.y*x.x*p.y*d.x*d.y-g.x*g.y*x.y*p.x*d.x*d.y+g.x*x.x*x.y*p.x*p.y*d.y-g.y*x.x*x.y*p.x*p.y*d.x-g.x*x.x*E.y*p.y*d.x*d.y+6*g.x*E.x*x.y*p.y*d.x*d.y+g.x*x.y*p.x*E.y*d.x*d.y-g.y*x.x*E.x*p.y*d.x*d.y-6*g.y*x.x*p.x*E.y*d.x*d.y+g.y*E.x*x.y*p.x*d.x*d.y-x.x*E.x*x.y*p.x*p.y*d.y+x.x*x.y*p.x*E.y*p.y*d.x+x.x*E.x*E.y*p.y*d.x*d.y-E.x*x.y*p.x*E.y*d.x*d.y-2*g.x*E.x*B*d.x+2*g.y*L*E.y*d.y-3*g.x*g.y*x.x*p.x*G-6*g.x*g.y*E.x*d.x*G+3*g.x*g.y*x.y*p.y*P-2*g.x*g.y*p.x*D*d.x-2*g.x*x.x*E.x*p.y*G-g.x*x.x*x.y*D*d.x+3*g.x*x.x*p.x*E.y*G-4*g.x*E.x*x.y*p.x*G+3*g.y*x.x*E.x*p.x*G+6*g.x*g.y*E.y*P*d.y+2*g.x*g.y*F*p.y*d.y+2*g.x*x.x*O*d.x*d.y+2*g.x*E.x*p.x*D*d.y+6*g.x*E.x*E.y*d.x*G-3*g.x*x.y*E.y*p.y*P+2*g.x*p.x*E.y*D*d.x+g.x*O*p.x*p.y*d.x+g.y*x.x*x.y*F*d.y+4*g.y*x.x*E.y*p.y*P-3*g.y*E.x*x.y*p.y*P+2*g.y*E.x*p.x*D*d.x+2*g.y*x.y*p.x*E.y*P+x.x*E.x*x.y*D*d.x-3*x.x*E.x*p.x*E.y*G-2*g.x*F*E.y*p.y*d.y-6*g.y*E.x*E.y*P*d.y-2*g.y*E.x*F*p.y*d.y-2*g.y*k*x.y*d.x*d.y-g.y*k*p.x*p.y*d.y-2*g.y*F*E.y*p.y*d.x-2*x.x*E.x*O*d.x*d.y-x.x*x.y*F*E.y*d.y+3*E.x*x.y*E.y*p.y*P-2*E.x*p.x*E.y*D*d.x-E.x*O*p.x*p.y*d.x+3*w*x.x*p.x*d.x*d.y+3*x.x*p.x*z*d.x*d.y+2*E.x*F*E.y*p.y*d.y-3*S*x.y*p.y*d.x*d.y+2*k*x.y*E.y*d.x*d.y+k*p.x*E.y*p.y*d.y-3*W*x.y*p.y*d.x*d.y-T*H+R*N+Y*H-X*N-3*g.x*W*H-g.x*I*P+3*S*E.x*H+g.y*C*G+3*g.y*z*N+E.x*I*P+S*B*d.x-3*w*E.y*N-w*L*d.y+W*B*d.x-C*E.y*G-L*z*d.y-g.x*k*x.y*G+g.y*x.x*O*P-3*g.x*w*P*d.y-g.x*O*F*d.y+g.y*k*D*d.x-x.x*O*E.y*P+3*S*g.y*d.x*G+S*x.x*p.y*G+2*S*x.y*p.x*G-2*w*x.x*p.y*P-w*x.y*p.x*P+k*E.x*x.y*G-3*g.x*z*P*d.y+3*g.y*W*d.x*G+x.x*W*p.y*G-2*x.x*z*p.y*P+E.x*O*F*d.y-x.y*p.x*z*P-S*p.x*D*d.y-3*S*E.y*d.x*G+3*w*E.x*P*d.y+w*F*p.y*d.x-k*E.y*D*d.x+2*W*x.y*p.x*G+3*E.x*z*P*d.y-W*p.x*D*d.y-3*W*E.y*d.x*G+F*z*p.y*d.x].reverse()),tt=0;tt<Q.length;tt++){var et=Q[tt],rt=ro([d.x,p.x,x.x,g.x-E.x-et*M.x-et*et*b.x-et*et*et*m.x].reverse()),it=ro([d.y,p.y,x.y,g.y-E.y-et*M.y-et*et*b.y-et*et*et*m.y].reverse());if(rt.length>0&&it.length>0){t:for(var at=0;at<rt.length;at++){var nt=rt[at];if(0<=nt&&nt<=1)for(var ot=0;ot<it.length;ot++)if(Math.abs(nt-it[ot])<1e-4){var st=m.x*et*et*et+b.x*et*et+M.x*et+E.x,lt=m.y*et*et*et+b.y*et*et+M.y*et+E.y;A.push({x:st,y:lt,t:nt});break t}}}}return A},intersectBezier2Bezier3:function(t,e,r,i,a,n,o,s,l,h,u,c,f,_){var v,y,d,p,x,g,m,b=[];v={x:t-2*r+a,y:e-2*i+n},p={x:3*l-o-3*u+f,y:3*h-s-3*c+_},x={x:3*o-6*l+3*u,y:3*s-6*h+3*c},g={x:-3*o+3*l,y:-3*s+3*h},m={x:o,y:s};for(var M=(d={x:t,y:e}).x*d.x,E=d.y*d.y,A=(y={x:2*r-2*t,y:2*i-2*e}).x*y.x,S=y.y*y.y,T=v.x*v.x,w=v.y*v.y,R=m.x*m.x,k=m.y*m.y,C=g.x*g.x,O=g.y*g.y,I=x.x*x.x,F=x.y*x.y,L=p.x*p.x,D=p.y*p.y,B=oo(0,1,[-2*v.x*v.y*p.x*p.y+T*D+w*L,-2*v.x*v.y*x.x*p.y-2*v.x*v.y*x.y*p.x+2*w*x.x*p.x+2*T*x.y*p.y,-2*v.x*g.x*v.y*p.y-2*v.x*v.y*g.y*p.x-2*v.x*v.y*x.x*x.y+2*g.x*w*p.x+w*I+T*(2*g.y*p.y+F),2*d.x*v.x*v.y*p.y+2*d.y*v.x*v.y*p.x+y.x*y.y*v.x*p.y+y.x*y.y*v.y*p.x-2*m.x*v.x*v.y*p.y-2*v.x*m.y*v.y*p.x-2*v.x*g.x*v.y*x.y-2*v.x*v.y*g.y*x.x-2*d.x*w*p.x-2*d.y*T*p.y+2*m.x*w*p.x+2*g.x*w*x.x-S*v.x*p.x-A*v.y*p.y+T*(2*m.y*p.y+2*g.y*x.y),2*d.x*v.x*v.y*x.y+2*d.y*v.x*v.y*x.x+y.x*y.y*v.x*x.y+y.x*y.y*v.y*x.x-2*m.x*v.x*v.y*x.y-2*v.x*m.y*v.y*x.x-2*v.x*g.x*v.y*g.y-2*d.x*w*x.x-2*d.y*T*x.y+2*m.x*w*x.x-S*v.x*x.x-A*v.y*x.y+C*w+T*(2*m.y*x.y+O),2*d.x*v.x*v.y*g.y+2*d.y*v.x*g.x*v.y+y.x*y.y*v.x*g.y+y.x*y.y*g.x*v.y-2*m.x*v.x*v.y*g.y-2*v.x*m.y*g.x*v.y-2*d.x*g.x*w-2*d.y*T*g.y+2*m.x*g.x*w-S*v.x*g.x-A*v.y*g.y+2*T*m.y*g.y,-2*d.x*d.y*v.x*v.y-d.x*y.x*y.y*v.y-d.y*y.x*y.y*v.x+2*d.x*v.x*m.y*v.y+2*d.y*m.x*v.x*v.y+y.x*m.x*y.y*v.y+y.x*y.y*v.x*m.y-2*m.x*v.x*m.y*v.y-2*d.x*m.x*w+d.x*S*v.x+d.y*A*v.y-2*d.y*T*m.y-m.x*S*v.x-A*m.y*v.y+M*w+E*T+R*w+T*k].reverse()),P=0;P<B.length;P++){var N=B[P],G=ro([v.x,y.x,d.x-m.x-N*g.x-N*N*x.x-N*N*N*p.x].reverse()),H=ro([v.y,y.y,d.y-m.y-N*g.y-N*N*x.y-N*N*N*p.y].reverse());if(G.length>0&&H.length>0){t:for(var W=0;W<G.length;W++){var Y=G[W];if(0<=Y&&Y<=1)for(var z=0;z<H.length;z++)if(Math.abs(Y-H[z])<1e-4){var X=p.x*N*N*N+x.x*N*N+g.x*N+m.x,U=p.y*N*N*N+x.y*N*N+g.y*N+m.y;b.push({x:X,y:U,t:Y});break t}}}}return b}},lo=function(){function t(t,e){if(Array.isArray(t)){var r=u(t,2);t=r[0],e=r[1]}this.x=t,this.y=e}return r(t,[{key:"toString",value:function(){return this.x+","+this.y}},{key:"equal",value:function(t){return this===t||this.x===t.x&&this.y===t.y}}],[{key:"compare",value:function(t,e){return t.x>e.x||t.x===e.x&&t.y>e.y}}]),t}(),ho=function(){function t(t,e){this.coords=t,this.belong=e,this.calBbox(),this.myFill=[!1,!1],this.otherFill=[!1,!1],this.myCoincide=0,this.otherCoincide=0,this.isVisited=!1,this.isDeleted=!1}return r(t,[{key:"calBbox",value:function(){var t=this.coords;if(2===t.length){var e=t[0],r=t[1],i=Math.min(e.x,r.x),a=Math.min(e.y,r.y),n=Math.max(e.x,r.x),o=Math.max(e.y,r.y);this.bbox=[i,a,n,o]}else{var s=t.map((function(t){return[t.x,t.y]}));this.bbox=eo.bboxBezier(s)}}},{key:"reverse",value:function(){this.coords.reverse()}},{key:"equal",value:function(t){var e=this.coords,r=t.coords;if(e.length!==r.length)return!1;for(var i=0,a=e.length;i<a;i++)if(!e[i].equal(r[i]))return!1;return!0}},{key:"toHash",value:function(){return this.coords.map((function(t){return t.toString()})).join(" ")}},{key:"toString",value:function(){return this.toHash()+" "+this.belong+" "+this.myCoincide+this.otherCoincide+" "+this.myFill.map((function(t){return t?1:0})).join("")+this.otherFill.map((function(t){return t?1:0})).join("")}}]),t}(),uo=1e-9,co=1-1e-9;var fo=function(t,e,r,i,a,n,o,s,l){var h=((o-a)*(e-n)-(s-n)*(t-a))/l,u=((r-t)*(e-n)-(i-e)*(t-a))/l;if(h>uo&&h<co&&u>uo&&u<co)return[{point:new lo(t+h*(r-t),e+h*(i-e)),toSource:h,toClip:u}]},_o=function(t,e,r,i,a,n,o,s,l,h){var u=so.intersectBezier2Line(t,e,r,i,a,n,o,s,l,h);if(u.length&&(u=u.map((function(u){var c;if(c=Math.abs(l-o)>=Math.abs(h-s)?Math.abs((u.x-o)/(l-o)):Math.abs((u.y-s)/(h-s)),u.t>uo&&u.t<co&&c>uo&&c<co){var f=eo.bezierSlope([[t,e],[r,i],[a,n]],u.t),_=eo.bezierSlope([[o,s],[l,h]]);if(Math.abs(Math.abs(f)-Math.abs(_)||0)<uo)return;return{point:new lo(u.x,u.y),toSource:u.t,toClip:c}}})).filter((function(t){return t}))).length)return u},vo=function(t,e,r,i,a,n,o,s,l,h,u,c){var f=so.intersectBezier2Bezier2(t,e,r,i,a,n,o,s,l,h,u,c);if(f.length&&(f=f.map((function(f){var _=eo.getPointT([[o,s],[l,h],[u,c]],f.x,f.y);if(_.length&&(_=_[0],f.t>uo&&f.t<co&&_>uo&&_<co)){var v=eo.bezierSlope([[t,e],[r,i],[a,n]],f.t),y=eo.bezierSlope([[o,s],[l,h],[u,c]],_);if(Math.abs(Math.abs(v)-Math.abs(y)||0)<uo)return;return{point:new lo(f.x,f.y),toSource:f.t,toClip:_}}})).filter((function(t){return t}))).length)return f},yo=function(t,e,r,i,a,n,o,s,l,h,u,c,f,_){var v=so.intersectBezier2Bezier3(t,e,r,i,a,n,o,s,l,h,u,c,f,_);if(v.length&&(v=v.map((function(v){var y=eo.getPointT([[o,s],[l,h],[u,c],[f,_]],v.x,v.y);if(y.length&&(y=y[0],v.t>uo&&v.t<co&&y>uo&&y<co)){var d=eo.bezierSlope([[t,e],[r,i],[a,n]],v.t),p=eo.bezierSlope([[o,s],[l,h],[u,c],[f,_]],y);if(Math.abs(Math.abs(d)-Math.abs(p)||0)<uo)return;return{point:new lo(v.x,v.y),toSource:v.t,toClip:y}}})).filter((function(t){return t}))).length)return v},po=function(t,e,r,i,a,n,o,s,l,h,u,c){var f=so.intersectBezier3Line(t,e,r,i,a,n,o,s,l,h,u,c);if(f.length&&(f=f.map((function(f){var _;if(_=Math.abs(u-l)>=Math.abs(c-h)?Math.abs((f.x-l)/(u-l)):Math.abs((f.y-h)/(c-h)),f.t>uo&&f.t<co&&_>uo&&_<co){var v=eo.bezierSlope([[t,e],[r,i],[a,n],[o,s]],f.t),y=eo.bezierSlope([[l,h],[u,c]]);if(Math.abs(Math.abs(v)-Math.abs(y)||0)<uo)return;return{point:new lo(f.x,f.y),toSource:f.t,toClip:_}}})).filter((function(t){return t}))).length)return f},xo=function(t,e,r,i,a,n,o,s,l,h,u,c,f,_,v,y){var d=so.intersectBezier3Bezier3(t,e,r,i,a,n,o,s,l,h,u,c,f,_,v,y);if(d.length&&(d=d.map((function(d){var p=eo.getPointT([[l,h],[u,c],[f,_],[v,y]],d.x,d.y);if(p.length&&(p=p[0],d.t>uo&&d.t<co&&p>uo&&p<co)){var x=eo.bezierSlope([[t,e],[r,i],[a,n],[o,s]],d.t),g=eo.bezierSlope([[l,h],[u,c],[f,_],[v,y]],p);if(Math.abs(Math.abs(x)-Math.abs(g)||0)<uo)return;return{point:new lo(d.x,d.y),toSource:d.t,toClip:p}}})).filter((function(t){return t}))).length)return d},go=function(t,e){return t.sort((function(t,r){return e?t.toSource-r.toSource:t.toClip-r.toClip})).map((function(t){return{point:t.point,t:e?t.toSource:t.toClip}})).filter((function(t){return t.t>uo&&t.t<co}))},mo=function(){function t(t,e){this.index=e;var r=[];Array.isArray(t)&&(t.forEach((function(t){if(Array.isArray(t)&&!(t.length<2)&&!(2===t.length&&t[1].length<=2)){for(var i=new lo(t[0]),a=i,n=1,o=t.length;n<o;n++){var s=t[n],l=s.length,h=new lo(s[l-2],s[l-1]),u=void 0;if(2===l){if(i.equal(h))continue;var c=lo.compare(i,h)?[h,i]:[i,h];u=new ho(c,e)}else if(4===l){if(i.equal(h)&&i.x===s[0]&&i.y===s[1])continue;var f=new lo(s[0],s[1]),_=ko([i,f,h],!0);if(_){var v=[[i.x,i.y],[s[0],s[1]],[h.x,h.y]],y=eo.sliceBezier(v,_[0]),d=eo.sliceBezier2Both(v,_[0],1),p=new lo(y[1]),x=new lo(y[2]),g=new lo(d[1]),m=lo.compare(i,x)?[x,p,i]:[i,p,x];r.push(new ho(m,e)),m=lo.compare(x,h)?[h,g,x]:[x,g,h],u=new ho(m,e)}else{var b=lo.compare(i,h)?[h,f,i]:[i,f,h];u=new ho(b,e)}}else if(6===l){if(s[0]===s[2]&&s[1]===s[3]){s.splice(2,2),n--;continue}if(i.equal(h)&&i.x===s[0]&&i.y===s[1]&&i.x===s[2]&&i.y===s[3])continue;var M=new lo(s[0],s[1]),E=new lo(s[2],s[3]),A=ko([i,M,E,h],!0);if(A)!function(){var t=[[i.x,i.y],[s[0],s[1]],[s[2],s[3]],[h.x,h.y]],a=i,n=0;A.forEach((function(i){var o=eo.sliceBezier2Both(t,n,i),s=new lo(o[1]),l=new lo(o[2]),h=new lo(o[3]),u=lo.compare(a,h)?[h,l,s,a]:[a,s,l,h];r.push(new ho(u,e)),n=i,a=h}));var o=eo.sliceBezier2Both(t,n,1),l=new lo(o[1]),c=new lo(o[2]),f=lo.compare(a,h)?[h,c,l,a]:[a,l,c,h];u=new ho(f,e)}();else{var S=lo.compare(i,h)?[h,E,M,i]:[i,M,E,h];u=new ho(S,e)}}r.push(u),i=h}if(!i.equal(a)){var T=lo.compare(i,a)?[a,i]:[i,a];r.push(new ho(T,e))}}})),this.segments=r)}return r(t,[{key:"selfIntersect",value:function(){var t=Ao(this.segments);this.segments=bo(t,!1,!1,!1)}},{key:"toString",value:function(){return this.segments.map((function(t){return t.toString()}))}},{key:"reset",value:function(t){return this.index=t,this.segments.forEach((function(e){e.belong=t,e.otherCoincide=0,e.otherFill[0]=e.otherFill[1]=!1})),this}}],[{key:"intersect2",value:function(t,e,r,i){if(t.segments.length&&e.segments.length){var a=bo(Ao(t.segments.concat(e.segments)),!0,r,i);t.segments=a.filter((function(t){return 0===t.belong})),e.segments=a.filter((function(t){return 1===t.belong}))}}},{key:"annotate2",value:function(t,e,r,i){var a=function(t){var e={};t.forEach((function(t){var r=t.coords,i=r.length,a=r[0],n=r[i-1];To(e,a.x,a.y,t,!0),To(e,n.x,n.y,t,!1)}));var r=[];Object.keys(e).forEach((function(t){var i=e[t],a=[];Object.keys(i).forEach((function(t){var e=i[t].sort((function(t,e){return t.isStart!==e.isStart?t.isStart?1:-1:t.isStart?Ro(t.seg,e.seg)?1:-1:void 0}));a.push({y:parseFloat(t),arr:e})})),r.push({x:parseFloat(t),arr:a.sort((function(t,e){return t.y-e.y}))})})),r.sort((function(t,e){return t.x-e.x}));var i=[];return r.forEach((function(t){t.arr.forEach((function(t){i=i.concat(t.arr)}))})),i}(t.segments.concat(e.segments)),n=[],o=[],s={},l={};a.forEach((function(t){var e=t.isStart,a=t.seg,h=a.belong;if(!(0===h&&r||1===h&&i)){var u=0===h?n:o,c=0===h?s:l;if(e){if(a.myCoincide){var f=a.toHash();if(c.hasOwnProperty(f))return;c[f]=!0}if(u.length){var _=u.length,v=u[_-1];if(Ro(a,v))a.myFill[1]=v.myFill[0],a.myCoincide?a.myFill[0]=a.myCoincide%2==0?!a.myFill[1]:a.myFill[1]:a.myFill[0]=!a.myFill[1],u.push(a);else if(1===_)a.myCoincide?a.myFill[0]=a.myCoincide%2==0:a.myFill[0]=!0,u.unshift(a);else for(var y=_-2;y>=0;y--){var d=u[y];if(Ro(a,d)){a.myFill[1]=d.myFill[0],a.myCoincide?a.myFill[0]=a.myCoincide%2==0?!a.myFill[1]:a.myFill[1]:a.myFill[0]=!a.myFill[1],u.splice(y+1,0,a);break}0===y&&(a.myCoincide?a.myFill[0]=a.myCoincide%2==0:a.myFill[0]=!0,u.unshift(a))}}else a.myCoincide?a.myFill[0]=a.myCoincide%2==0:a.myFill[0]=!0,u.push(a)}else{var p=u.indexOf(a);p>-1&&u.splice(p,1)}}}));var h=[],u={};a.forEach((function(t){var e=t.isStart,r=t.seg,i=r.belong;if(e){if(r.myCoincide||r.otherCoincide){var a=r.toHash();if(u.hasOwnProperty(a))return;u[a]=!0}var n=!1;if(h.length){var o=h.length,s=h[o-1];if(Ro(r,s))n=s.belong===i?s.otherFill[0]:s.myFill[0],h.push(r);else if(1===o)h.unshift(r);else for(var l=o-2;l>=0;l--){var c=h[l];if(Ro(r,c)){n=c.belong===i?c.otherFill[0]:c.myFill[0],h.splice(l+1,0,r);break}0===l&&h.unshift(r)}}else n=!1,h.push(r);r.otherCoincide||(r.otherFill[0]=n,r.otherFill[1]=n)}else{var f=h.indexOf(r);f>-1&&h.splice(f,1)}}))}}]),t}();function bo(t,e,r,i){for(var a=[],n=[],o=[];t.length;){n.length&&n.splice(0).forEach((function(t){var e=a.indexOf(t);a.splice(e,1),t.isDeleted||o.push(t)}));for(var s=t[0],l=s.x,h=s.arr;h.length;){var u=h.shift();if(!u.isDeleted){var c=u.belong,f=u.bbox;if(u.isVisited){if(f[0]!==f[2]||2!==u.coords.length){var _=a.indexOf(u);a.splice(_,1),u.isDeleted||o.push(u)}else n.push(u);u.isVisited=!1}else{if(a.length)for(var v=u.coords,y=v.length,d=v[0],p=d.x,x=d.y,g=v[1],m=g.x,b=g.y,M=0;M<a.length;M++){var E=a[M];if(!E.isDeleted&&!u.isDeleted&&(!e||E.belong!==c)){var A=E.bbox,S=E.coords,T=S.length,w=!1;if(Oo(f,A,y,T)){if(y===T&&u.equal(E)){e?(u.otherCoincide++,E.otherCoincide++,u.otherFill=E.myFill,E.otherFill=u.myFill):(u.myCoincide++,E.myCoincide++,u.myFill=E.myFill);continue}var R=S[0],k=R.x,C=R.y,O=S[1],I=O.x,F=O.y,L=void 0,D=void 0;if(2===y)if(2===T){var B=(F-C)*(m-p)-(I-k)*(b-x);if(0===B)if(p===m)p===k&&m===I&&(D=Io(p,x,m,b,u,k,C,I,F,E,!0));else(b-x)*p/(m-p)+x===(F-C)*k/(I-k)+C&&(D=Io(p,x,m,b,u,k,C,I,F,E,!1));else L=fo(p,x,m,b,k,C,I,F,B)}else{var P=S[2],N=P.x,G=P.y;if(3===T)L=_o(k,C,I,F,N,G,p,x,m,b),w=!0;else{var H=S[3],W=H.x,Y=H.y;L=po(k,C,I,F,N,G,W,Y,p,x,m,b),w=!0}}else{var z=v[2],X=z.x,U=z.y;if(3===y)if(2===T)L=_o(p,x,m,b,X,U,k,C,I,F);else{var V=S[2],K=V.x,j=V.y;if(3===T)(L=vo(p,x,m,b,X,U,k,C,I,F,K,j))||(D=Fo(u,E));else{var Z=S[3],q=Z.x,$=Z.y;L=yo(p,x,m,b,X,U,k,C,I,F,K,j,q,$)}}else{var J=v[3],Q=J.x,tt=J.y;if(2===T)L=po(p,x,m,b,X,U,Q,tt,k,C,I,F);else{var et=S[2],rt=et.x,it=et.y;if(3===T)L=yo(k,C,I,F,rt,it,p,x,m,b,X,U,Q,tt),w=!0;else{var at=S[3],nt=at.x,ot=at.y;(L=xo(p,x,m,b,X,U,Q,tt,k,C,I,F,rt,it,nt,ot))||(D=Fo(u,E))}}}}if(D){Eo(o,t,a,l,D.ra),Eo(o,t,a,l,D.rb),u.isDeleted=E.isDeleted=!0,a.splice(M,1);break}if(L&&L.length){var st=Mo(u,go(L,!w),r&&0===c),lt=Mo(E,go(L,w),i&&1===c);Eo(o,t,a,l,st),Eo(o,t,a,l,lt),lt.length&&a.splice(M,1);break}}}}u.isDeleted||(a.push(u),u.isVisited=!0)}}}t.shift()}return n.forEach((function(t){t.isDeleted||o.push(t)})),o.filter((function(t){return!t.isDeleted}))}function Mo(t,e,r){var i=[];if(!e.length)return i;var a,n=t.belong,o=t.coords,s=o.length,l=o[0],h=0;if(e.forEach((function(e){var a,u=e.point,c=e.t;if(2===s)a=new ho([l,u],n);else if(3===s){var f=eo.sliceBezier2Both(o.map((function(t){return[t.x,t.y]})),h,c);a=new ho([l,new lo(f[1][0],f[1][1]),u],n)}else if(4===s){var _=eo.sliceBezier2Both(o.map((function(t){return[t.x,t.y]})),h,c);a=new ho([l,new lo(_[1][0],_[1][1]),new lo(_[2][0],_[2][1]),u],n)}r&&(a.myFill[0]=t.myFill[0],a.myFill[1]=t.myFill[1]),l=u,i.push(a),h=c})),2===s)a=new ho([l,o[1]],n);else if(3===s){var u=eo.sliceBezier2Both(o.map((function(t){return[t.x,t.y]})),h,1);a=new ho([l,new lo(u[1][0],u[1][1]),o[2]],n)}else if(4===s){var c=eo.sliceBezier2Both(o.map((function(t){return[t.x,t.y]})),h,1);a=new ho([l,new lo(c[1][0],c[1][1]),new lo(c[2][0],c[2][1]),o[3]],n)}return r&&(a.myFill[0]=t.myFill[0],a.myFill[1]=t.myFill[1]),i.push(a),t.isDeleted=!0,i}function Eo(t,e,r,i,a){a.forEach((function(a){var n=a.bbox,o=n[0],s=n[2];if(s<=i&&o!==s&&2!==a.coords.length)t.push(a);else{var l=0;if(o<i)a.isVisited=!0,r.push(a);else for(var h=e.length;l<h;l++){var u=e[l],c=u.x;if(o===c){u.arr.push(a);break}if(o<c){var f={x:o,arr:[a]};e.splice(l,0,f);break}}for(var _=e.length;l<_;l++){var v=e[l],y=v.x;if(s===y){v.arr.unshift(a);break}if(s<y){var d={x:s,arr:[a]};e.splice(l,0,d);break}}}}))}function Ao(t){var e={};t.forEach((function(t){var r=t.bbox,i=r[0],a=r[2];So(e,i,t),So(e,a,t)}));var r=[];return Object.keys(e).forEach((function(t){return r.push({x:parseFloat(t),arr:e[t]})})),r.sort((function(t,e){return t.x-e.x}))}function So(t,e,r){var i=t[e]=t[e]||[];r.isVisited?(i.unshift(r),r.isVisited=!1):(i.push(r),r.isVisited=!0)}function To(t,e,r,i,a){var n=t[e]=t[e]||{};(n[r]=n[r]||[]).push({isStart:a,seg:i})}function wo(t,e,r){var i=t.x,a=t.y,n=e.x,o=e.y,s=r.x,l=r.y;return Mt.crossProduct(n-i,o-a,s-i,l-a)>=0}function Ro(t,e){var r=t.coords,i=e.coords,a=r.length,n=i.length,o=r[0],s=i[0];if(2===a&&2===n){var l=r[1],h=i[1];return o.equal(s)?wo(l,s,h):wo(o,s,h)}if(2===a&&o.x===r[1].x)return s.x>=o.x;var u=Math.max(o.x,s.x),c=Math.min(r[a-1].x,i[n-1].x),f=u+.5*(c-u);if(o!==s){var _=Co(r,u),v=Co(i,u);if(_!==v)return _>v}if(r[a-1]!==i[n-1]){var y=Co(r,c),d=Co(i,c);if(y!==d)return y>d}var p=Co(r,f),x=Co(i,f);return p!==x?p>x:void 0}function ko(t,e){if(3===t.length){var r=e?(t[0].x-t[1].x)/(t[0].x-2*t[1].x+t[2].x):(t[0].y-t[1].y)/(t[0].y-2*t[1].y+t[2].y);if(r>0&&r<1)return[r]}else if(4===t.length){var i=Wn.getRoots([e?3*(t[1].x-t[0].x):3*(t[1].y-t[0].y),e?6*(t[2].x+t[0].x-2*t[1].x):6*(t[2].y+t[0].y-2*t[1].y),e?3*(t[3].x+3*t[1].x-t[0].x-3*t[2].x):3*(t[3].y+3*t[1].y-t[0].y-3*t[2].y)]).filter((function(t){return t>0&&t<1}));if(i.length)return i.sort((function(t,e){return t-e}))}}function Co(t,e){var r=t.length;if(e===t[0].x)return t[0].y;if(e===t[r-1].x)return t[r-1].y;if(2===r){if(t[0].y===t[1].y)return t[0].y;var i=(e-t[0].x)/(t[1].x-t[0].x);return t[0].y+i*(t[1].y-t[0].y)}if(3===r){var a=Wn.getRoots([t[0].x-e,2*(t[1].x-t[0].x),t[2].x+t[0].x-2*t[1].x]).filter((function(t){return t>=0&&t<=1})),n=t.map((function(t){return[t.x,t.y]}));return eo.pointAtByT(n,a[0])[1]}if(4===r){var o=Wn.getRoots([t[0].x-e,3*(t[1].x-t[0].x),3*(t[2].x+t[0].x-2*t[1].x),t[3].x+3*t[1].x-t[0].x-3*t[2].x]).filter((function(t){return t>=0&&t<=1})),s=t.map((function(t){return[t.x,t.y]}));return eo.pointAtByT(s,o[0])[1]}}function Oo(t,e,r,i){if(2===r&&2===i){if(t[0]===t[2]&&e[0]===e[2]&&t[0]===t[2])return!(t[1]>=e[3]||e[1]>=t[3]);if(t[1]===t[3]&&e[1]===e[3]&&t[1]==t[1])return!(t[0]>=e[2]||e[0]>=t[2])}return Ut.isRectsOverlap(t,e)}function Io(t,e,r,i,a,n,o,s,l,h,u){var c=[],f=[],_=a.coords,v=h.coords;return t<n&&!u||e<o&&u?(c.push(new ho([_[0],v[0]],a.belong)),r<s&&!u||i<l&&u?(c.push(new ho([v[0],_[1]],a.belong)),f.push(new ho([v[0],_[1]],h.belong)),f.push(new ho([_[1],v[1]],h.belong))):r===s&&!u||i===l&&u?(c.push(new ho([v[0],v[1]],a.belong)),f.push(new ho([v[0],v[1]],h.belong))):(c.push(new ho([v[0],v[1]],a.belong)),f.push(new ho([v[0],v[1]],h.belong)),c.push(new ho([v[1],_[1]],a.belong)))):t===n&&!u||e===o&&u?r<s&&!u||i<l&&u?(c.push(new ho([_[0],_[1]],a.belong)),f.push(new ho([_[0],_[1]],h.belong)),f.push(new ho([_[1],v[1]],h.belong))):(c.push(new ho([v[0],v[1]],a.belong)),c.push(new ho([v[1],_[1]],a.belong)),f.push(new ho([v[0],v[1]],h.belong))):(f.push(new ho([v[0],_[0]],h.belong)),r<s&&!u||i<l&&u?(c.push(new ho([_[0],_[1]],a.belong)),f.push(new ho([_[0],_[1]],h.belong)),f.push(new ho([_[1],v[1]],h.belong))):r===s&&!u||i===l&&u?(c.push(new ho([_[0],_[1]],a.belong)),f.push(new ho([_[0],_[1]],h.belong))):(c.push(new ho([_[0],v[1]],a.belong)),f.push(new ho([_[0],v[1]],h.belong)),c.push(new ho([v[1],_[1]],a.belong)))),{ra:c,rb:f}}function Fo(t,e){var r=t.coords.map((function(t){return[t.x,t.y]})),i=r.length,a=e.coords.map((function(t){return[t.x,t.y]})),n=a.length,o=r[0],s=a[0],l=r[i-1],h=a[n-1],u=eo.getPointT(r,s[0],s[1]),c=eo.getPointT(r,h[0],h[1]),f=eo.getPointT(a,o[0],o[1]),_=eo.getPointT(a,l[0],l[1]),v=u.length,y=c.length,d=f.length,p=_.length;if(1===v&&1===y&&0===d&&0===p||0===v&&0===y&&1===d&&1===p||(1===v&&1===y&&d+p===1||v+y===1&&1===d&&1===p)||v+y===1&&d+p===1){var x=v?u[0]:0,g=y?c[0]:1,m=eo.sliceBezier2Both(r,x,g),b=d?f[0]:0,M=p?_[0]:1;if(function(t,e){for(var r=0,i=t.length;r<i;r++){var a=t[r],n=e[r];if(Math.abs(a[0]-n[0])>1e-9||Math.abs(a[1]-n[1])>1e-9)return!1}return!0}(m,eo.sliceBezier2Both(a,b,M))){var E=m.map((function(t){return new lo(t)})),A=[],S=[];if(x>0){var T=eo.sliceBezier2Both(r,0,x),w=[t.coords[0],new lo(T[1]),e.coords[0]];4===i&&w.splice(2,0,new lo(T[2])),A.push(new ho(w,t.belong))}if(A.push(new ho(E,t.belong)),g<1){var R=eo.sliceBezier2Both(r,g,1),k=[e.coords[n-1],new lo(R[1]),t.coords[i-1]];4===i&&k.splice(2,0,new lo(R[2])),A.push(new ho(k,t.belong))}if(b>0){var C=eo.sliceBezier2Both(a,0,b),O=[e.coords[0],new lo(C[1]),t.coords[0]];4===n&&O.splice(2,0,new lo(C[2])),S.push(new ho(O,e.belong))}if(S.push(new ho(E,e.belong)),M<1){var I=eo.sliceBezier2Both(a,M,1),F=[t.coords[i-1],new lo(I[1]),e.coords[n-1]];4===n&&F.splice(2,0,new lo(I[2])),S.push(new ho(F,e.belong))}return{ra:A,rb:S}}}}function Lo(t,e,r,i,a,n){for(var o=0,s=e.length;o<s;o++){var l=e[o];if(l!==r){var h=l.length,u=l[0],c=l[h-1],f=u.coords[0],_=c.coords,v=_[_.length-1];if(a.equal(f))return n?(l=Bo(r).concat(l),e[o]=l,e.splice(i,1),Do(t,e,l,o)):(l=r.concat(l),e[o]=l,e.splice(i,1),Do(t,e,l,o));if(a.equal(v))return n?(l=l.concat(r),e[o]=l,e.splice(i,1),Do(t,e,l,o)):(l=l.concat(Bo(r)),e[o]=l,e.splice(i,1),Do(t,e,l,o))}}Do(t,e,r,i)}function Do(t,e,r,i){var a=r.length,n=r[0],o=r[a-1],s=n.coords[0],l=o.coords,h=l[l.length-1];s.equal(h)&&(e.splice(i,1),t.push(r))}function Bo(t){return t.forEach((function(t){return t.reverse()})),t.reverse()}function Po(t){var e=[],r=[];t.sort((function(t,e){return e.otherFill[0]&&e.otherFill[1]?1:-1}));t:for(;t.length;){for(var i=t.shift(),a=i.coords,n=a.length,o=a[0],s=a[n-1],l=void 0,h=0,u=e.length;h<u;h++){var c=e[h],f=c.length,_=c[0],v=c[f-1],y=_.coords[0],d=v.coords,p=d[d.length-1];if(o.equal(p)){if(i.belong!==v.belong){c.push(i),Lo(r,e,c,h,s,!1);continue t}l||(l={i:h,t:0})}else if(o.equal(y)){if(i.belong!==v.belong){i.reverse(),c.unshift(i),Lo(r,e,c,h,s,!0);continue t}l||(l={i:h,t:1})}else if(s.equal(p)){if(i.belong!==v.belong){i.reverse(),c.push(i),Lo(r,e,c,h,o,!1);continue t}l||(l={i:h,t:2})}else if(s.equal(y)){if(i.belong!==v.belong){c.unshift(i),Lo(r,e,c,h,o,!0);continue t}l||(l={i:h,t:3})}}l?0===l.t?(e[l.i].push(i),Lo(r,e,e[l.i],l.i,s,!1)):1===l.t?(i.reverse(),e[l.i].unshift(i),Lo(r,e,e[l.i],l.i,s,!0)):2===l.t?(i.reverse(),e[l.i].push(i),Lo(r,e,e[l.i],l.i,o,!1)):3===l.t&&(e[l.i].unshift(i),Lo(r,e,e[l.i],l.i,o,!0)):e.push([i])}var x=r.map((function(t){var e,r,i,a,n,o,s=!0,l=0;t.forEach((function(t,s){var h=t.coords,u=h.length,c=t.bbox;s?(i=Math.min(i,c[0]),a=Math.min(a,c[1]),n=Math.max(n,c[2]),o=Math.max(o,c[3])):(i=c[0],a=c[1],n=c[2],o=c[3]),2===u?(l+=s?e*h[1].y-r*h[1].x:h[0].x*h[1].y-h[0].y*h[1].x,e=h[1].x,r=h[1].y):3===u?(l+=s?e*h[2].y-r*h[2].x:h[0].x*h[1].y-h[0].y*h[2].x,e=h[2].x,r=h[2].y):4===u&&(l+=s?e*h[3].y-r*h[3].x:h[0].x*h[3].y-h[0].y*h[3].x,e=h[3].x,r=h[3].y)}));var h=t[0].coords;return(l+=e*h[0].y-r*h[0].x)<0&&(s=!1),{list:t,clockwise:s,bbox:[i,a,n,o],area:(n-i)*(o-a)}}));return x.forEach((function(t){if(!t.checked){for(var e=t.bbox,r=[t],i=0,a=x.length;i<a;i++){var n=x[i];n!==t&&(Ut.isRectsInside(e,n.bbox,!0)||Ut.isRectsInside(n.bbox,e,!0))&&r.push(n)}if(r.length>1){r.sort((function(t,e){return t.area-e.area}));for(var o=1,s=r.length;o<s;o++){var l=r[o];if(l.checked){for(var h=l.clockwise,u=o-1;u>=0;u--){var c=r[u];c.checked=!0,c.clockwise===h&&(Bo(c.list),c.clockwise=!h),h=!h}h=l.clockwise;for(var f=o+1;f<s;f++){var _=r[f];_.checked=!0,_.clockwise===h&&(Bo(_.list),_.clockwise=!h),h=!h}return}}var v=r[0].clockwise;r[0].checked=!0;for(var y=1,d=r.length;y<d;y++){var p=r[y];p.checked=!0,p.clockwise===v&&(Bo(p.list),p.clockwise=!v),v=!v}}}})),x.map((function(t){var e=t.list.map((function(t){var e=t.coords,r=e.length;return 2===r?[e[1].x,e[1].y]:3===r?[e[1].x,e[1].y,e[2].x,e[2].y]:4===r?[e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y]:void 0})),r=t.list[0].coords;return e.unshift([r[0].x,r[0].y]),e}))}function No(t){return t&&Array.isArray(t)&&Array.isArray(t[0])?Array.isArray(t[0][0])?t:[t]:[]}function Go(t,e){var r,i,a=t instanceof mo,n=e instanceof mo;return a?r=t.reset(0):(r=new mo(No(t),0)).selfIntersect(),n?i=e.reset(1):(i=new mo(No(e),1)).selfIntersect(),mo.intersect2(r,i,a,n),mo.annotate2(r,i,a,n),[r,i]}var Ho=[0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0],Wo=[0,1,1,1,1,0,0,0,1,0,0,0,1,0,0,0],Yo=[0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0],zo=[0,1,0,0,1,0,1,1,0,1,0,0,0,1,0,0],Xo=[0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0];function Uo(t,e){var r=[],i={};return t.forEach((function(t){var a,n=t.belong,o=t.myFill,s=t.otherFill;if(t.otherCoincide){var l=t.toHash();if(i.hasOwnProperty(l))return;i[l]=!0}a=n?(s[0]?8:0)+(o[0]?4:0)+(s[1]?2:0)+(o[1]?1:0):(o[0]?8:0)+(s[0]?4:0)+(o[1]?2:0)+(s[1]?1:0),e[a]&&r.push(t)})),r}var Vo={intersect:function(t,e,r){var i=u(Go(t,e),2),a=i[0],n=i[1],o=Uo(a.segments.concat(n.segments),Ho);return r?(a.segments=o,a):Po(o)},union:function(t,e,r){var i=u(Go(t,e),2),a=i[0],n=i[1],o=Uo(a.segments.concat(n.segments),Wo);return r?(a.segments=o,a):Po(o)},subtract:function(t,e,r){var i=u(Go(t,e),2),a=i[0],n=i[1],o=Uo(a.segments.concat(n.segments),Yo);return r?(a.segments=o,a):Po(o)},subtractRev:function(t,e,r){var i=u(Go(t,e),2),a=i[0],n=i[1],o=Uo(a.segments.concat(n.segments),zo);return r?(a.segments=o,a):Po(o)},xor:function(t,e,r){var i=u(Go(t,e),2),a=i[0],n=i[1],o=Uo(a.segments.concat(n.segments),Xo);return r?(a.segments=o,a):Po(o)},chain:function(t){return t instanceof mo?Po(t.segments):No(t)}},Ko={matrix:g,tar:Nn,vector:Mt,equation:Wn,geom:Ut,bezier:eo,isec:so,booleanOperations:Vo},jo=Ct.STYLE_KEY,Zo=jo.TRANSLATE_X,qo=jo.TRANSLATE_Y,$o=jo.TRANSLATE_Z,Jo=jo.SCALE_X,Qo=jo.SCALE_Y,ts=jo.SCALE_Z,es=jo.SKEW_X,rs=jo.SKEW_Y,is=jo.ROTATE_X,as=jo.ROTATE_Y,ns=jo.ROTATE_Z,os=jo.ROTATE_3D,ss=jo.PERSPECTIVE,ls=jo.MATRIX,hs=jo.FONT_SIZE,us=d.PX,cs=d.PERCENT,fs=d.REM,_s=d.VW,vs=d.VH,ys=d.VMAX,ds=d.VMIN,ps=Ko.matrix,xs=Ko.geom,gs=ps.identity,ms=ps.multiply,bs=ps.multiplyTfo,Ms=ps.tfoMultiply,Es=ps.isE,As=ps.multiplyTranslateX,Ss=ps.multiplyTranslateY,Ts=ps.multiplyTranslateZ,ws=ps.multiplyRotateX,Rs=ps.multiplyRotateY,ks=ps.multiplyRotateZ,Cs=ps.multiplySkewX,Os=ps.multiplySkewY,Is=ps.multiplyPerspective,Fs=ps.multiplyScaleX,Ls=ps.multiplyScaleY,Ds=ps.multiplyScaleZ,Bs=xs.d2r;function Ps(t,e){var r=u(e,4),i=r[0],a=r[1],n=r[2],o=r[3];o=Bs(o);var s=Math.sin(o),l=Math.cos(o);if(!i||a||n)if(!a||i||n)if(!n||i||a){var h=Math.sqrt(i*i+a*a+n*n);if(1!==h){var c=1/h;i*=c,a*=c,n*=c}var f=1-l,_=i*a,v=a*n,y=n*i,d=i*s,p=a*s,x=n*s;t[0]=i*i*f+l,t[1]=_*f+x,t[2]=y*f-p,t[3]=0,t[4]=_*f-x,t[5]=a*a*f+l,t[6]=v*f+d,t[7]=0,t[8]=y*f+p,t[9]=v*f-d,t[10]=n*n*f+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}else n<0&&(s=-s),t[0]=l,t[4]=-s,t[1]=s,t[5]=l;else a<0&&(s=-s),t[0]=l,t[8]=s,t[2]=-s,t[10]=l;else i<0&&(s=-s),t[5]=l,t[9]=-s,t[6]=s,t[10]=l;return t}function Ns(t,e,r,i){for(var a=gs(),n=0,o=t.length;n<o;n++){var s=t[n],l=s.k,h=Hs(l,s.v,e,r,i);if(l===Zo)a=As(a,h);else if(l===qo)a=Ss(a,h);else if(l===$o)a=Ts(a,h);else if(l===is)a=ws(a,Bs(h));else if(l===as)a=Rs(a,Bs(h));else if(l===ns)a=ks(a,Bs(h));else if(l===es)a=Cs(a,Bs(h));else if(l===rs)a=Os(a,Bs(h));else if(l===Jo)a=Fs(a,h);else if(l===Qo)a=Ls(a,h);else if(l===ts)a=Ds(a,h);else if(l===ss)a=Is(a,h);else if(l===os){var u=gs();Ps(u,[h[0],h[1],h[2],h[3].v]),a=ms(a,u)}else l===ls&&(a=ms(a,h))}return a}function Gs(t,e,r){var i=t.slice(0);return 0===e&&0===r||Es(t)?i:(i=Ms(e,r,i),i=bs(i,-e,-r))}function Hs(t,e,r,i,a){if(t===Zo||t===qo||t===$o){if(e.u===us)return e.v;if(e.u===cs)return e.v*(t===qo?i:r)*.01;if(e.u===fs)return e.v*a.__computedStyle[hs];if(e.u===_s)return e.v*a.width*.01;if(e.u===vs)return e.v*a.height*.01;if(e.u===ys)return e.v*Math.max(a.width,a.height)*.01;if(e.u===ds)return e.v*Math.min(a.width,a.height)*.01}else{if(t===ls)return e;if(t===os)return e}return e.v}var Ws={calSingleValue:Hs,calMatrix:Ns,calRotateX:function(t,e){e=Bs(e);var r=Math.sin(e),i=Math.cos(e);return t[5]=t[10]=i,t[6]=r,t[9]=-r,t},calRotateY:function(t,e){e=Bs(e);var r=Math.sin(e),i=Math.cos(e);return t[0]=t[10]=i,t[8]=r,t[2]=-r,t},calRotateZ:function(t,e){e=Bs(e);var r=Math.sin(e),i=Math.cos(e);return t[0]=t[5]=i,t[1]=r,t[4]=-r,t},calRotate3d:Ps,calPerspectiveMatrix:function(t,e,r){if(t&&t>0){var i=gs();return t=Math.max(t,1),i[11]=-1/t,(e||r)&&(i=Ms(e,r,i),i=bs(i,-e,-r)),i}},calMatrixByOrigin:Gs,calMatrixWithOrigin:function(t,e,r,i,a){return Gs(Ns(t,i,a),e,r)},isPerspectiveMatrix:function(t){if(t)return!!(t[3]||t[7]||t[11])}},Ys=Ct.STYLE_KEY,zs=Ys.COLOR,Xs=Ys.FONT_WEIGHT,Us=Ys.FONT_FAMILY,Vs=Ys.FONT_SIZE,Ks=Ys.FONT_STYLE,js=Ys.LETTER_SPACING,Zs=Ys.TEXT_STROKE_COLOR,qs=Ys.TEXT_STROKE_WIDTH,$s=Ys.TEXT_STROKE_OVER,Js=Ys.ROTATE_Z,Qs=Ys.LINE_HEIGHT,tl=d.DEG,el=y.CANVAS,rl=y.SVG,il=y.WEBGL,al=/(?:[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u02EA\u02EB\u1100-\u11FF\u1401-\u167F\u18B0-\u18FF\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2065\u20DD-\u20E0\u20E2-\u20E4\u2100\u2101\u2103-\u2109\u210F\u2113\u2114\u2116\u2117\u211E-\u2123\u2125\u2127\u2129\u212E\u2135-\u213F\u2145-\u214A\u214C\u214D\u214F-\u2189\u218C-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2B97\u2BB8-\u2BD1\u2BD3-\u2BEB\u2BF0-\u2BFF\u2E50\u2E51\u2E80-\u3007\u3012\u3013\u3020-\u302F\u3031-\u309F\u30A1-\u30FB\u30FD-\uA4CF\uA960-\uA97F\uAC00-\uD7FF\uE000-\uFAFF\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF01-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7\uFFF0-\uFFF8\uFFFC\uFFFD]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|[\uD80C\uD81C-\uD822\uD83C\uD83D\uD840-\uD87E\uD880-\uD8BE][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC3F]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFFF]|\uD823[\uDC00-\uDD7F]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFF]|\uD833[\uDF00-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83E[\uDD00-\uDEFF]|[\uD87F\uD8BF][\uDC00-\uDFFD])/,nl=function(){function t(t,e,r,i,a,n,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.__parent=t,this.__index=e,this.__x=r,this.__y=i,s?(this.__width=n,this.__height=a):(this.__width=a,this.__height=n),this.__content=o,this.__virtualDom={},this.__parentLineBox=null,this.__isVertical=s}return r(t,[{key:"render",value:function(t,e,r,i,a,n){var o=this.content,s=this.x,l=this.y,h=this.parent,u=this.width,c=this.height,f=this.isUpright,_=h.ox,v=h.oy,y=h.__domParent,d=Ln.getBaseline(r),p=Ln.getVerticalBaseline(r);f?s+=p:l+=d,s+=_+a,l+=v+n,f?(this.__endX=s,this.__endY=l+c):(this.__endX=s+u,this.__endY=l);var x=r[js],m=r[qs],b=r[Zs],M=r[Vs],E=r[Qs],A=0,S=o.length;if(t===el||t===il){var T,w=y.matrixEvent,R=0,k=0;f&&(T=[{k:Js,v:{v:90,u:tl}}],R=.6*p,k=.2*p);var C="fill"===r[$s];if(x)for(;A<S;A++){var O=o.charAt(A);if(f){if(al.test(O))e.setTransform(w[0],w[1],w[4],w[5],w[12],w[13]),C&&e.fillText(O,s-R,l-k),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(O,s-R,l-k),C||e.fillText(O,s-R,l-k);else{var I=Ws.calMatrixWithOrigin(T,s,l,0,0);I=g.multiply(w,I),e.setTransform(I[0],I[1],I[4],I[5],I[12],I[13]),C&&e.fillText(O,s,l),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(O,s,l),C||e.fillText(O,s,l)}l+=e.measureText(O).width+x}else C&&e.fillText(O,s,l),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(O,s,l),C||e.fillText(O,s,l),s+=e.measureText(O).width+x}else if(f){for(var F=al.test(o.charAt(0)),L=0,D=0,B=o.length,P=1;P<B;P++){var N=al.test(o.charAt(P));if(N!==F){if(F){e.setTransform(w[0],w[1],w[4],w[5],w[12],w[13]);var H=o.slice(L,P);C&&e.fillText(H,s-R,l+D+d-k),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(H,s-R,l+D+d-k),C||e.fillText(H,s-R,l+D+d-k),D+=M}else{var W=Ws.calMatrixWithOrigin(T,s,l+D,0,0);W=g.multiply(w,W),e.setTransform(W[0],W[1],W[4],W[5],W[12],W[13]);var Y=o.slice(L,P);C&&e.fillText(Y,s,l+D),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(Y,s,l+D),C||e.fillText(Y,s,l+D),D+=e.measureText(Y).width}L=P,F=!F}else if(N){e.setTransform(w[0],w[1],w[4],w[5],w[12],w[13]);var z=o.slice(L,P);C&&e.fillText(z,s-R,l+D+d-k),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(z,s-R,l+D+d-k),C||e.fillText(z,s-R,l+D+d-k),D+=M,L=P}}if(L<B){var X=o.slice(L,B);if(F)e.setTransform(w[0],w[1],w[4],w[5],w[12],w[13]),C&&e.fillText(X,s-R,l+D+d-k),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(X,s-R,l+D+d-k),C||e.fillText(X,s-R,l+D+d-k);else{var U=Ws.calMatrixWithOrigin(T,s,l+D,0,0);U=g.multiply(w,U),e.setTransform(U[0],U[1],U[4],U[5],U[12],U[13]),C&&e.fillText(X,s,l+D),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(X,s,l+D),C||e.fillText(X,s,l+D)}}}else C&&e.fillText(o,s,l),m&&(b[3]>0||3===b.length||b.k)&&e.strokeText(o,s,l),C||e.fillText(o,s,l)}else if(t===rl){var V=i[zs];V.k&&(V=y.__gradient(t,e,y.__bx1,y.__by1,y.__bx2,y.__by2,V,a,n).v),f&&(s+=.5*E-p);var K=[["x",s],["y",l],["fill",V],["font-family",r[Us]],["font-weight",r[Xs]],["font-style",r[Ks]],["font-size",r[Vs]+"px"]];if(m&&(b[3]>0||3===b.length||b.k)){var j=i[Zs];j.k&&(j=y.__gradient(t,e,y.__bx1,y.__by1,y.__bx2,y.__by2,j,a,n).v),K.push(["stroke",j]),K.push(["stroke-width",r[qs]])}x&&K.push(["letter-spacing",x]),f&&K.push(["writing-mode","vertical-lr"]),this.__virtualDom={type:"item",tagName:"text",props:K,content:G.encodeHtml(o)}}}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"endX",get:function(){return this.__endX}},{key:"endY",get:function(){return this.__endY}},{key:"width",get:function(){return this.__width}},{key:"offsetWidth",get:function(){return this.__width}},{key:"outerWidth",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"offsetHeight",get:function(){return this.__height}},{key:"outerHeight",get:function(){return this.__height}},{key:"content",get:function(){return this.__content}},{key:"baseline",get:function(){return this.parent.baseline}},{key:"verticalBaseline",get:function(){return this.parent.verticalBaseline}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}},{key:"parentLineBox",get:function(){return this.__parentLineBox}},{key:"isUpright",get:function(){return this.__isVertical}}]),t}(),ol=Ct.STYLE_KEY,sl=ol.FONT_SIZE,ll=ol.FONT_FAMILY,hl=ol.FONT_WEIGHT,ul=ol.FONT_STYLE,cl=ol.COLOR,fl=ol.LINE_HEIGHT,_l=ol.ROTATE_Z,vl=d.DEG,yl=y.CANVAS,dl=y.SVG,pl=y.WEBGL,xl="…",gl=function(t){function e(e,r,i,a,n){var o;return(o=t.call(this)||this).__x=o.__sx1=e,o.__y=o.__sy1=r,o.__width=i,o.__parent=o.__domParent=a,a.__ellipsis=s(o),o.__parentLineBox=null,o.__baseline=Ln.getBaseline(a.computedStyle),o.__isVertical=n,o}return a(e,t),r(e,[{key:"render",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this.x,n=this.y,o=this.parent,s=this.isUpright,l=o.ox,h=o.oy,u=o.computedStyle,c=o.cacheStyle[cl],f=Ln.getBaseline(u),_=Ln.getVerticalBaseline(u);if(s?a+=_:n+=f,a+=l+r,n+=h+i,t===yl||t===pl){var v=Ln.setFontStyle(u);if(e.font!==v&&(e.font=v),e.fillStyle!==c&&(e.fillStyle=c),s){var y=o.matrixEvent,d=[{k:_l,v:{v:90,u:vl}}],p=Ws.calMatrixWithOrigin(d,a,n,0,0);p=g.multiply(y,p),e.setTransform(p[0],p[1],p[4],p[5],p[12],p[13])}e.fillText(xl,a,n)}else if(t===dl){s&&(a+=.5*u[fl]-_);var x=[["x",a],["y",n],["fill",c],["font-family",u[ll]],["font-weight",u[hl]],["font-style",u[ul]],["font-size",u[sl]+"px"]];s&&x.push(["writing-mode","vertical-lr"]);var m=this.__virtualDom={type:"text",children:[{type:"item",tagName:"text",props:x,content:xl}]};o.virtualDom.children.push(m)}}},{key:"parentLineBox",get:function(){return this.__parentLineBox}},{key:"isUpright",get:function(){return this.__isVertical}},{key:"isEllipsis",get:function(){return!0}}]),e}(v),ml=Ct.STYLE_KEY,bl=ml.TRANSLATE_X,Ml=ml.TRANSLATE_Y,El=ml.TRANSLATE_Z,Al=ml.OPACITY,Sl=ml.FILTER,Tl=ml.PERSPECTIVE,wl=ml.PERSPECTIVE_ORIGIN,Rl=ml.Z_INDEX,kl=ml.SCALE_X,Cl=ml.SCALE_Y,Ol=ml.SCALE_Z,Il=ml.ROTATE_X,Fl=ml.ROTATE_Y,Ll=ml.ROTATE_Z,Dl=ml.ROTATE_3D,Bl=ml.SKEW_X,Pl=ml.SKEW_Y,Nl=ml.TRANSFORM,Gl=ml.TRANSFORM_ORIGIN,Hl=Xi.isIgnore,Wl=Xi.isRepaint,Yl=16384,zl={NONE:0,CACHE:1,TRANSLATE_X:2,TRANSLATE_Y:4,TRANSLATE_Z:8,TRANSLATE:14,ROTATE_Z:16,SCALE_X:32,SCALE_Y:64,SCALE_Z:128,SCALE:224,TRANSFORM:256,TRANSFORM_ALL:510,OPACITY:512,FILTER:1024,MIX_BLEND_MODE:2048,PERSPECTIVE:4096,REPAINT:8192,REFLOW:Yl,REBUILD:32768};var Xl=Object.assign({contain:function(t,e){return(t&e)>0},exclude:function(t,e){return(t|e)===e},getLevel:function(t){return Hl(t)?0:t===Rl?1:t===bl?2:t===Ml?4:t===El?8:t===Ll?16:t===kl?32:t===Cl?64:t===Ol?128:t===Al?512:t===Sl?1024:t===Tl||t===wl?4096:function(t){return t===Il||t===Fl||t===Dl||t===Bl||t===Pl||t===Nl||t===Gl}(t)?256:Wl(t)?8192:Yl},isReflow:function(t){return t>=Yl},isRepaint:function(t){return t<Yl}},zl),Ul=Ct.STYLE_KEY,Vl=Ul.DISPLAY,Kl=Ul.POSITION,jl=Ul.LINE_HEIGHT,Zl=Ul.FONT_SIZE,ql=Ul.FONT_FAMILY,$l=Ul.FONT_WEIGHT,Jl=Ul.COLOR,Ql=Ul.VISIBILITY,th=Ul.LETTER_SPACING,eh=Ul.OVERFLOW,rh=Ul.WHITE_SPACE,ih=Ul.TEXT_OVERFLOW,ah=Ul.WIDTH,nh=Ul.HEIGHT,oh=Ul.TEXT_STROKE_COLOR,sh=Ul.TEXT_STROKE_WIDTH,lh=Ul.MARGIN_TOP,hh=Ul.MARGIN_BOTTOM,uh=Ul.MARGIN_LEFT,ch=Ul.MARGIN_RIGHT,fh=Ul.PADDING_TOP,_h=Ul.PADDING_BOTTOM,vh=Ul.PADDING_LEFT,yh=Ul.PADDING_RIGHT,dh=Ul.BORDER_TOP_WIDTH,ph=Ul.BORDER_BOTTOM_WIDTH,xh=Ul.BORDER_LEFT_WIDTH,gh=Ul.BORDER_RIGHT_WIDTH,mh=Ul.FILTER,bh=Ct.ELLIPSIS,Mh=d.AUTO,Eh=y.CANVAS,Ah=y.SVG,Sh=y.WEBGL,Th=G.isFunction;function wh(t,e,r,i,a,n,o,s,l,h,u,c){if(r>=i)return[0,0,!1];var f=r,_=i,v=0,y=!1;if(u&&[Eh,Sh].indexOf(e)>-1){for(var d=0;f<_;f++){var p=t.measureText(a.charAt(f)).width+u;if(d+p>n+1e-10){y=!0;break}d+=p}return[f-r,d,y||d>n+1e-10]}var x=Math.round(n/o);for(x<=0?x=1:x>i-r&&(x=i-r);f<_;){var g=void 0,m=a.slice(r,r+x);if(e===Eh||e===Sh?g=t.measureText(m).width:e===Ah&&(g=lt.measureTextSync(m,s,l,h,c)),u&&(g+=x*u),g===n){v=n,y=!0;break}if(g>n+1e-10){if(y=!0,1===x){v=g;break}if(f===_-1||f-r==x-1){x=f-r;break}_=x+r-1;var b=Math.round((g-n)/o);b<=0&&(b=1),(x-=b)<f-r&&(x=f-r)}else{if(v=g,x===i-r)break;f=x+r;var M=Math.round((n-g)/o);M<=0&&(M=1),(x+=M)>_-r&&(x=_-r)}}return[x,v,y]}function Rh(t,e,r,i){return t+"_"+e+"_"+r+"_"+i}var kh=function(t){function e(e){var r;return(r=t.call(this)||this).__content=G.isNil(e)?"":e.toString(),r.__textBoxes=[],r.__charWidth=0,r.__textWidth=0,r.__bp=null,r.__widthHash={},r.__limitCache=null,r.__hasContent=!1,r}return a(e,t),r(e,[{key:"__layoutFlow",value:function(t){var e=this.__cache;e&&e.release();var r=t.x,i=t.y,a=t.w,n=t.h,o=t.lx,s=void 0===o?r:o,l=t.ly,h=void 0===l?i:l,c=t.lineBoxManager,f=t.endSpace,_=void 0===f?0:f,v=t.lineClamp,y=void 0===v?0:v,d=t.lineClampCount,p=void 0===d?0:d,x=t.isUpright,g=void 0!==x&&x;this.__x=this.__sx=this.__sx1=r,this.__y=this.__sy=this.__sy1=i;var m=this.__isDestroyed,b=this.content,M=this.computedStyle,E=this.textBoxes,A=this.root;if(E.splice(0),m||"none"===M[Vl]||!b||y&&p>=y)return p;this.__ox=this.__oy=0;for(var S=0,T=b.length,w=0,R=M[jl],k=M[th],C=M[rh],O=M[Zl],I=M[$l],F=M[ql],L=g?n:a,D=g?i-h:r-s,B=this.domParent;"inline"===B.computedStyle[Vl];)B=B.domParent;this.__bp=B;var P,N=B.computedStyle[ih],G=A.renderMode;G!==Eh&&G!==Sh||((P=G===Sh?lt.getFontCanvas().ctx:A.ctx).font=Ln.setFontStyle(M));var H,W=.8*O+k,Y=0;if("nowrap"===C){var z,X=this.textWidth,U=B.computedStyle,V=U[Kl],K=U[eh],j=B.currentStyle[g?nh:ah];if("hidden"===K&&(z=("absolute"!==V||j.u!==Mh)&&X>L+1e-10-D-_),z&&"ellipsis"===N){H=u(this.__lineBack(P,G,S,T,b,L-_-D,W,r,i,w,_,R,E,c,F,O,I,k,g),1)[0],Y++,g?r=H:i=H}else{var Z=new nl(this,E.length,r,i,X,R,b,g);E.push(Z),c.addItem(Z,!1),g?r+=R:i+=R,z&&Y++}w=X}else{for(;S<T;){var q=S?L:L-D;y&&Y+p>=y-1&&(q-=_);var $=u(wh(P,G,S,T,b,q,W,F,O,I,k),3),J=$[0],Q=$[1],tt=$[2];if(y&&tt&&Y+p>=y-1&&S+J<T){var et=u(this.__lineBack(P,G,S,S+J,b,q-_,W,Y?s:r,i,w,_,R,E,c,F,O,I,k,g),2);H=et[0],w=et[1],Y++,g?r=H:i=H;break}if(S+J===T&&_&&Q+_>q+1e-10&&J>1){var rt=u(wh(P,G,S,T,b,q-_,W,F,O,I,k),3);if(J=rt[0],Q=rt[1],tt=rt[2],y&&tt&&Y+p>=y-1){var it=u(this.__lineBack(P,G,S,S+J,b,q-_,W,Y?s:r,i,w,_,R,E,c,F,O,I,k,g),2);H=it[0],w=it[1],Y++,g?r=H:i=H;break}}w=Math.max(w,Q);var at=new nl(this,E.length,Y&&!g?s:r,Y&&g?h:i,Q,R,b.slice(S,S+J),g);E.push(at),c.addItem(at,tt),g?r+=Math.max(R,c.verticalLineHeight):i+=Math.max(R,c.lineHeight),S+=J,tt&&Y++}Y&&(g?this.__y=this.__sy1=h:this.__x=this.__sx1=s)}return g?(this.__width=r-t.x,this.__height=w,this.__verticalBaseline=Ln.getVerticalBaseline(M)):(this.__width=w,this.__height=i-t.y,this.__baseline=Ln.getBaseline(M)),p+Y}},{key:"__layoutNone",value:function(){this.__width=this.__height=this.__baseline=this.__verticalBaseline=0,this.__textBoxes.splice(0)}},{key:"__lineBack",value:function(t,e,r,i,a,n,o,s,l,h,c,f,_,v,y,d,p,x,g){var m,b=this.__bp,M=b.computedStyle;if(e===Eh||e===Sh){var E=Ln.setFontStyle(M);t.font!==E&&(t.font=E),m=t.measureText(bh).width}else m=lt.measureTextSync(bh,M[ql],M[Zl],M[$l]);if(e===Eh||e===Sh){var A=Ln.setFontStyle(this.computedStyle);t.font!==A&&(t.font=A)}var S=u(wh(t,e,r,i,a,n-m-c,o,y,d,p,x),2),T=S[0],w=S[1];if(w+m>n+1e-10-c){var R=v.lineBox;if(!v.isNewLine&&R&&R.size)for(var k=R.list,C=k.length-1;C>=0;C--){var O=k[C];if(O instanceof nl){var I=O.content,F=O.width,L=O.height,D=O.parent;if(!C||n>=F+m+1e-10+c){var B=I.length,P=D.computedStyle,N=P[jl],G=P[th],H=P[Zl],W=P[$l],Y=P[ql];e!==Eh&&e!==Sh||(t.font=Ln.setFontStyle(D.computedStyle));var z=u(wh(t,e,0,B,I,n-m+F-c,o,Y,H,W,G),2),X=z[0],U=z[1];X!==I.length&&(O.__content=I.slice(0,X),g?(l-=L-U,O.__height=U):(s-=F-U,O.__width=U)),R.__resetLb(M[jl],g?Ln.getVerticalBaseline(M):Ln.getBaseline(M));var V=g?new gl(s,l+U+c,m,b,g):new gl(s+U+c,l,m,b,g);return v.addItem(V,!0),g?s+=Math.max(N,v.verticalLineHeight):l+=Math.max(N,v.lineHeight),[l,h=Math.max(h,U+m)]}var K=k.pop();g?(n+=L,l-=L):(n+=F,s-=F);var j=K.parent.textBoxes,Z=j.indexOf(K);Z>-1&&j.splice(Z,1);var q=K.parent.parent,$=k[k.length-1];for($ instanceof nl&&($=$.parent.parent);q!==b&&q!==$;){var J=q.contentBoxList||[],Q=J.indexOf(K);Q>-1&&J.splice(Q,1);var tt=q.computedStyle;if(g){var et=tt[lh]+tt[hh]+tt[fh]+tt[_h]+tt[dh]+tt[ph];l-=et,n+=et}else{var rt=tt[uh]+tt[ch]+tt[vh]+tt[yh]+tt[xh]+tt[gh];s-=rt,n+=rt}q.__layoutNone(),q=q.domParent}var it=$.contentBoxList||[],at=it.indexOf(K);at>-1&&it.splice(at,1)}else{if(!C)break;var nt=k.pop();g?l-=nt.outerHeight:s-=nt.outerWidth,n+=g?nt.outerHeight:nt.outerWidth,nt.__layoutNone()}}}var ot=new nl(this,_.length,s,l,w,f,a.slice(r,r+T),g);_.push(ot),v.addItem(ot,!1);var st=g?new gl(s,l+w+c,m,b,g):new gl(s+w+c,l,m,b,g);return v.addItem(st,!0),g?s+=Math.max(f,v.verticalLineHeight):l+=Math.max(f,v.lineHeight),[g?s:l,h=Math.max(h,w+m)]}},{key:"__backtrack",value:function(t,e,r,i,a,n,o,s,l,h,c){for(var f=r.list,_=f.length-1;_>=0;_--){var v=f[_];if(v instanceof nl){var y=v.content,d=v.width,p=v.height,x=v.parent;if(!_||a>=d+o+1e-10+n){var g=y.length,m=x.computedStyle,b=m[th],M=m[Zl],E=m[$l],A=m[ql];h!==Eh&&h!==Sh||(l.font=Ln.setFontStyle(x.computedStyle));var S=u(wh(l,h,0,g,y,a-o-n+d,.8*M+b,A,M,E,b),2),T=S[0],w=S[1];T!==y.length&&(v.__content=y.slice(0,T),c?v.__height=w:v.__width=w),r.__resetLb(s[jl],c?Ln.getVerticalBaseline(s):Ln.getBaseline(s));var R=c?new gl(v.x,v.y+w+n,o,t,c):new gl(v.x+w+n,v.y,o,t,c);return void e.addItem(R,!0)}var k=f.pop();a+=c?p:d;var C=k.parent.textBoxes,O=C.indexOf(k);O>-1&&C.splice(O,1);var I=k.parent.parent,F=f[f.length-1];for(F instanceof nl&&(F=F.parent.parent);I!==t&&I!==F;){var L=I.contentBoxList||[],D=L.indexOf(k);D>-1&&L.splice(D,1);var B=I.computedStyle;if(c)a+=B[lh]+B[hh]+B[fh]+B[_h]+B[dh]+B[ph];else a+=B[uh]+B[ch]+B[vh]+B[yh]+B[xh]+B[gh];I.__layoutNone(),I=I.domParent}var P=F.contentBoxList||[],N=P.indexOf(k);N>-1&&P.splice(N,1)}else{if(!_)break;var G=f.pop();a+=c?G.outerHeight:G.outerWidth,G.__layoutNone()}}}},{key:"__offsetX",value:function(t,r){h(n(e.prototype),"__offsetX",this).call(this,t,r),r&&this.textBoxes.forEach((function(e){e.__offsetX(t)})),this.__sx1+=t}},{key:"__offsetY",value:function(t,r){h(n(e.prototype),"__offsetY",this).call(this,t,r),r&&this.textBoxes.forEach((function(e){e.__offsetY(t)})),this.__sy1+=t}},{key:"__tryLayInline",value:function(t){return t-this.firstCharWidth}},{key:"__inlineSize",value:function(t){var e,r;this.textBoxes.forEach((function(i,a){a?(e=Math.min(e,t?i.y:i.x),r=Math.max(r,(t?i.y:i.x)+i.width)):(e=t?i.y:i.x,r=(t?i.y:i.x)+i.width)})),t?(this.__y=e,this.__sy=this.__sy1=e+this.oy,this.__sx=this.__sx1,this.__height=r-e):(this.__x=e,this.__sx=this.__sx1=e+this.ox,this.__sy=this.__sy1,this.__width=r-e)}},{key:"render",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this.__isDestroyed,n=this.computedStyle,o=this.textBoxes,s=this.cacheStyle;if(t===Ah&&(this.__virtualDom={type:"text",children:[]}),this.__bbox=null,this.__filterBbox=null,!a&&"none"!==n[Vl]&&"hidden"!==n[Ql]&&o.length){if(this.__hasContent=!0,t!==Sh){if(t===Eh){var l=Ln.setFontStyle(n);e.font!==l&&(e.font=l);var h=s[Jl];if(h.k){var u=this.parent;h=u.__gradient(t,e,u.__bx1,u.__by1,u.__bx2,u.__by2,h,r,i).v}e.fillStyle!==h&&(e.fillStyle=h);var c=n[sh];e.lineWidth!==c&&(e.lineWidth=c);var f=s[oh];if(f.k){var _=this.parent;f=_.__gradient(t,e,_.__bx1,_.__by1,_.__bx2,_.__by2,f,r,i).v}e.strokeStyle!==f&&(e.strokeStyle=f)}o.forEach((function(a){a.render(t,e,n,s,r,i)})),t===Ah&&(this.__virtualDom.children=o.map((function(t){return t.virtualDom})))}}else this.__hasContent=!1}},{key:"__deepScan",value:function(t){t(this)}},{key:"__destroy",value:function(){if(!this.__isDestroyed){h(n(e.prototype),"__destroy",this).call(this);var t=this.__cache;t&&t.release()}}},{key:"getComputedStyle",value:function(t){return this.__domParent.getComputedStyle(t)}},{key:"updateContent",value:function(t,e){if(t===this.__content||this.__isDestroyed)return this.__content=t,void(Th(e)&&e());this.__content=t,this.__root.__addUpdate(this.__domParent,{focus:Xl.REFLOW,cb:e})}},{key:"remove",value:function(t){var e,r=this.__root,i=this.isShadowRoot?this.hostRoot.__parent:this.__parent;if(i){var a=this.isShadowRoot?this.hostRoot:this;e=i.__children.indexOf(a),i.__children.splice(e,1),e=i.__zIndexChildren.indexOf(a),i.__zIndexChildren.splice(e,1);var n=this.__prev,o=this.__next;n&&(n.__next=o),o&&(o.__prev=n)}if(this.__isDestroyed)Th(t)&&t();else{if(i.__deleteStruct(this,e),"none"===this.computedStyle[Vl])return this.__destroy(),void(Th(t)&&t());var s={focus:Xl.REFLOW,removeDom:!0,cb:t};r.__addUpdate(this,s)}}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"textBoxes",get:function(){return this.__textBoxes}},{key:"charWidth",get:function(){var t=this.__widthHash,e=this.content,r=this.computedStyle,i=this.root,a=i.ctx,n=i.renderMode,o=r[ql],s=r[Zl],l=r[$l],h=r[th],u=Rh(o,s,l,h);t.hasOwnProperty(u)||(t[u]={});var c=t[u];if(!c.hasOwnProperty("charWidth")){var f=0;if(n===Eh||n===Sh){n===Sh&&(a=lt.getFontCanvas().ctx),a.font=Ln.setFontStyle(r);for(var _=0,v=e.length;_<v;_++)f=Math.max(f,a.measureText(e.charAt([_])).width)}else n===Ah&&(f=lt.measureTextListMax(e,o,s,l));c.charWidth=f+h}return c.charWidth}},{key:"firstCharWidth",get:function(){var t=this.__widthHash,e=this.content,r=this.computedStyle,i=this.root,a=i.ctx,n=i.renderMode,o=r[ql],s=r[Zl],l=r[$l],h=r[th],u=Rh(o,s,l,h);t.hasOwnProperty(u)||(t[u]={});var c=t[u];return c.hasOwnProperty("firstCharWidth")||(n===Eh||n===Sh?(n===Sh&&(a=lt.getFontCanvas().ctx),a.font=Ln.setFontStyle(r),c.firstCharWidth=a.measureText(e.charAt(0)).width+h):n===Ah&&(c.firstCharWidth=lt.measureTextSync(e.charAt(0),o,s,l)+h)),c.firstCharWidth}},{key:"textWidth",get:function(){var t=this.__widthHash,e=this.content,r=this.computedStyle,i=this.root,a=i.ctx,n=i.renderMode,o=r[ql],s=r[Zl],l=r[$l],h=r[th],u=Rh(o,s,l,h);t.hasOwnProperty(u)||(t[u]={});var c=t[u];return c.hasOwnProperty("textWidth")||(n===Eh||n===Sh?(n===Sh&&(a=lt.getFontCanvas().ctx),a.font=Ln.setFontStyle(r),c.textWidth=a.measureText(e).width+h*e.length):n===Ah&&(c.textWidth=lt.measureTextSync(e,o,s,l)+h*e.length)),c.textWidth}},{key:"clientWidth",get:function(){return this.__width||0}},{key:"clientHeight",get:function(){return this.__height||0}},{key:"offsetWidth",get:function(){return this.__width||0}},{key:"offsetHeight",get:function(){return this.__height||0}},{key:"outerWidth",get:function(){return this.__width||0}},{key:"outerHeight",get:function(){return this.__height||0}},{key:"root",get:function(){return this.__domParent.__root}},{key:"currentStyle",get:function(){return this.__domParent.__currentStyle}},{key:"style",get:function(){return this.__domParent.__style}},{key:"computedStyle",get:function(){return this.__domParent.__computedStyle}},{key:"cacheStyle",get:function(){return this.__domParent.__cacheStyle}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.__sx1,e=this.__sy1,r=this.width,i=this.height,a=this.computedStyle[sh];this.__bbox=[t-a,e-a,t+r+a,e+i+a]}return this.__bbox}},{key:"filterBbox",get:function(){if(!this.__filterBbox){var t=this.__bbox||this.bbox,e=this.computedStyle[mh];this.__filterBbox=Ln.spreadFilter(t,e)}return this.__filterBbox}},{key:"isShadowRoot",get:function(){return!this.__parent&&this.__host&&this.__host!==this.root}},{key:"matrix",get:function(){return this.__domParent.__matrix}},{key:"matrixEvent",get:function(){return this.__domParent.__matrixEvent}},{key:"perspectiveMatrix",get:function(){return this.__domParent.__perspectiveMatrix}}]),e}(v),Ch=G.isFunction,Oh=function(){function t(){this.__eHash={}}return r(t,[{key:"on",value:function(t,e){if(Ch(e)){var r=this;if(Array.isArray(t))for(var i=0,a=t.length;i<a;i++)r.on(t[i],e);else{r.__eHash.hasOwnProperty(t)||(r.__eHash[t]=[]);for(var n=0,o=r.__eHash[t],s=o.length;n<s;n++)if(o[n]===e)return r;r.__eHash[t].push(e)}return r}}},{key:"once",value:function(t,e){if(Ch(e)){var r=this;if(n.__karasEventCb=e,Array.isArray(t))for(var i=0,a=t.length;i<a;i++)r.once(t[i],e);else e&&r.on(t,n);return this}function n(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];e.apply(r,a),r.off(t,n)}}},{key:"off",value:function(t,e){var r=this;if(Array.isArray(t))for(var i=0,a=t.length;i<a;i++)r.off(t[i],e);else if(r.__eHash.hasOwnProperty(t))if(e){for(var n=0,o=r.__eHash[t],s=o.length;n<s;n++)if(o[n]===e||o[n].__karasEventCb===e){o.splice(n,1);break}}else delete r.__eHash[t];return this}},{key:"emit",value:function(t){for(var e=this,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];if(Array.isArray(t))for(var n=0,o=t.length;n<o;n++)e.emit(t[n],i);else if(e.__eHash.hasOwnProperty(t)){var s=e.__eHash[t];if(s.length)for(var l=0,h=(s=s.slice()).length;l<h;l++){var u=s[l];Ch(u)&&u.apply(e,i)}}return this}}],[{key:"mix",value:function(){for(var e=arguments.length-1;e>=0;e--){var r=e<0||arguments.length<=e?void 0:arguments[e],i=new t;r.__eHash={};for(var a=["on","once","off","emit"],n=a.length-1;n>=0;n--){var o=a[n];r[o]=i[o]}}}}]),t}();i(Oh,"REFRESH","refresh"),i(Oh,"PAUSE","pause"),i(Oh,"PLAY","play"),i(Oh,"FRAME","frame"),i(Oh,"FINISH","finish"),i(Oh,"CANCEL","cancel"),i(Oh,"BEGIN","begin"),i(Oh,"END","end");var Ih=G.isNil,Fh=G.isFunction,Lh=G.extend,Dh={},Bh=function(t){function e(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(e=t.call(this)||this).__tagName=/(?:function|class)\s+([\w$]+)/.exec(e.constructor.toString())[1],Array.isArray(r)?e.props=G.arr2hash(r):e.props=r,e.__parent=null,e.__host=null,e.__ref={},e.__isMounted=!1,e.__taskList=[],e}return a(e,t),r(e,[{key:"__init",value:function(){var t=this;this.__ref={};var e=this.__shadowRoot;if(e instanceof kh);else if(e instanceof v){var r=Ln.normalize(this.props.style),i=Object.keys(r);Lh(e.style,r,i),Lh(e.currentStyle,r,i),Object.keys(this.props).forEach((function(r){var i=t.props[r];/^on[a-zA-Z]/.test(r)&&(r=r.slice(2).toLowerCase(),e.listener[r]=i)}))}Object.keys(this.props).forEach((function(e){var r=t.props[e];/^on-[a-zA-Z\d_$]/.test(e)&&(e=e.slice(3),t.on(e,r))})),Fh(this.componentDidMount)&&this.__root.once(Oh.REFRESH,(function(){t.componentDidMount()}))}},{key:"render",value:function(){lt.warn("Component should implement render()")}},{key:"__destroy",value:function(){if(!this.__isDestroyed){this.__isDestroyed=!0,this.__isMounted=!1;var t=this.props.ref;Ih(t)||Fh(t)||delete this.__root.__ref[t],Fh(this.componentWillUnmount)&&this.componentWillUnmount(),this.__shadow&&this.__shadow.__destroy(),this.__host=this.__hostRoot=this.__shadow=this.__shadowRoot=this.__prev=this.__next=this.__root=this.__parent=this.__domParent=null}}},{key:"__emitEvent",value:function(t,e){var r=this.shadowRoot;if(!(r instanceof kh))return r.__emitEvent(t,e)?(t.target=this,!0):void 0}},{key:"tagName",get:function(){return this.__tagName}},{key:"shadow",get:function(){return this.__shadow}},{key:"shadowRoot",get:function(){return this.__shadowRoot}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"hostRoot",get:function(){return this.__hostRoot}},{key:"parent",get:function(){return this.__parent}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"ref",get:function(){return this.__ref}},{key:"domParent",get:function(){return this.__domParent}},{key:"state",get:function(){return this.__state},set:function(t){this.__state=t}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}],[{key:"REGISTER",get:function(){return Dh}},{key:"getRegister",value:function(t){if(!t||!G.isString(t)||!/^[A-Z]/.test(t))throw new Error("Invalid param");if(!Dh.hasOwnProperty(t))throw new Error("Component has not register: ".concat(t));return Dh[t]}},{key:"register",value:function(t,r){if(!(t&&G.isString(t)&&/^[A-Z]/.test(t)&&r.prototype&&r.prototype instanceof e))throw new Error("Invalid param: Component register");if(e.hasRegister(t))throw new Error("Component has already register: ".concat(t));Dh[t]=r}},{key:"hasRegister",value:function(t){return t&&Dh.hasOwnProperty(t)}},{key:"delRegister",value:function(t){e.hasRegister(t)&&delete Dh[t]}}]),e}(Oh);Object.keys(Xi.GEOM).concat(["x","y","ox","oy","sx","sy","width","height","outerWidth","outerHeight","clientWidth","clientHeight","offsetWidth","offsetHeight","style","animationList","animateStyle","currentStyle","computedStyle","currentProps","baseline","virtualDom","mask","maskId","textWidth","content","lineBoxes","charWidthList","charWidth","__layoutData","__struct","availableAnimating","effectiveAnimating","displayAnimating","visibilityAnimating","bbox","contentBoxList","listener","matrix","matrixEvent"]).forEach((function(t){Object.defineProperty(Bh.prototype,t,{get:function(){var e=this.shadowRoot;if(e)return e[t]}})})),["__layout","__layoutFlow","__layoutStyle","__layoutAbs","__layoutNone","__tryLayInline","__offsetX","__offsetY","__calAutoBasis","__computeReflow","__mp","animate","removeAnimate","clearAnimate","frameAnimate","updateStyle","getBoundingClientRect","getComputedStyle","__deepScan","clearCache","__structure","__modifyStruct","__updateStruct","flowChildren","absChildren","__isRealInline","__calBasis","__calMinMax","__computeMeasure","appendChild","prependChild","insertBefore","insertAfter","removeChild","remove"].forEach((function(t){Bh.prototype[t]=function(){var e=this.shadowRoot;if(e&&Fh(e[t]))return e[t].apply(e,arguments)}}));var Ph=Ct.STYLE_KEY,Nh=Ph.MARGIN_TOP,Gh=Ph.MARGIN_LEFT,Hh=Ph.MARGIN_RIGHT,Wh=Ph.MARGIN_BOTTOM,Yh=Ph.PADDING_TOP,zh=Ph.PADDING_LEFT,Xh=Ph.PADDING_RIGHT,Uh=Ph.PADDING_BOTTOM,Vh=Ph.BORDER_TOP_WIDTH,Kh=Ph.BORDER_LEFT_WIDTH,jh=Ph.BORDER_RIGHT_WIDTH,Zh=Ph.BORDER_BOTTOM_WIDTH;var qh={getInlineBox:function(t,e,r,i,a,n,o,s,l,h,u,c,f,_,v,y,d,p,x,g){var m,b,M,E,A,S,T,w,R,k=0,C=0,O=e?y+g:f+d,I=e?_+p:v+x;"paddingBox"===c?(k=e?y:f,C=e?_:v):"borderBox"===c&&(k=O,C=I),m=e?n.verticalBaseline-o:n.baseline-o,e?(b=n.x+m-k+l,M=i.y,S=n.x+m-O+l):(b=i.x,M=n.y+m-k+l,T=n.y+m-O+l);for(var F=i instanceof nl?i.parent.domParent:i.domParent;F!==t;){if(i===F.contentBoxList[0])if(e){var L=F.computedStyle;M-=L[Nh]+L[Yh]+L[Vh]}else{var D=F.computedStyle;b-=D[Gh]+D[zh]+D[Kh]}F=F.domParent}for(e?(T=M,h&&(T-=f+d,"paddingBox"===c?M-=f:"borderBox"===c&&(M-=f+d)),E=n.x+m+s+C-l,w=n.x+m+s+I-l,A=a.y+a.outerHeight):(S=b,h&&(S-=y+g,"paddingBox"===c?b-=y:"borderBox"===c&&(b-=y+g)),E=a.x+a.outerWidth,A=n.y+m+s+C-l,R=n.y+m+s+I-l),F=a instanceof nl?a.parent.domParent:a.domParent;F!==t;){var B=F.contentBoxList;if(a===B[B.length-1])if(e){var P=F.computedStyle;A+=P[Wh]+P[Uh]+P[Zh]}else{var N=F.computedStyle;E+=N[Hh]+N[Xh]+N[jh]}F=F.domParent}return e?(R=A,u&&(R+=v+x,"paddingBox"===c?A+=v:"borderBox"===c&&(A+=v+x))):(w=E,u&&(w+=_+p,"paddingBox"===c?E+=_:"borderBox"===c&&(E+=_+p))),b+=t.ox,E+=t.ox,S+=t.ox,w+=t.ox,[b,M+=t.oy,E,A+=t.oy,S,T+=t.oy,w,R+=t.oy]},getInlineWidth:function(t,e,r){var i=0,a=e.length;e[a-1]instanceof gl&&a--;for(var n=0;n<a;n++){var o=e[n];i+=r?o.height:o.width;for(var s=o instanceof nl?o.parent.domParent:o.domParent;s!==t;){var l=s.contentBoxList;if(o===l[0])if(r){var h=s.computedStyle;i+=h[Nh]+h[Yh]+h[Vh]}else{var u=s.computedStyle;i+=u[Gh]+u[zh]+u[Kh]}if(o===l[l.length-1])if(r){var c=s.computedStyle;i+=c[Wh]+c[Uh]+c[Zh]}else{var f=s.computedStyle;i+=f[Hh]+f[Xh]+f[jh]}s=s.domParent}}return i}},$h=Ct.STYLE_KEY,Jh=$h.SCALE_X,Qh=$h.SCALE_Y,tu=d.NUMBER;var eu={matrixResize:function(t,e,r,i,a,n,o,s){if(t!==r||e!==i){var l=[{k:Jh,v:{v:r/t,u:tu}},{k:Qh,v:{v:i/e,u:tu}}];return Ws.calMatrixWithOrigin(l,a,n,o,s)}}},ru=Ct.STYLE_KEY,iu=ru.BACKGROUND_POSITION_X,au=ru.BACKGROUND_POSITION_Y,nu=G.clone,ou=G.joinArr,su=Zt.canvasPolygon,lu=Zt.svgPolygon;function hu(t,e,r,i,a,n,o,s,l,h,u,c,f){var _,v,d,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:"fill",x=arguments.length>14&&void 0!==arguments[14]&&arguments[14],m=arguments.length>15&&void 0!==arguments[15]?arguments[15]:0,b=arguments.length>16&&void 0!==arguments[16]?arguments[16]:0;if(Array.isArray(i)&&(_=i[1],v=i[2],d=i[3],i=i[0]),(a=a||Le.calRadius(n,o,s,l,h,u,c,f))||(a=[[n,o],[n+s,o],[n+s,o+l],[n,o+l],[n,o]]),_){_=Ws.calMatrixByOrigin(_,v,d);var M=g.inverse(_);a=a.map((function(t){if(!t||!t.length)return null;for(var e=[],r=0,i=t.length;r<i;r+=2){var a=g.calPoint([t[r],t[r+1]],M);e.push(a[0]),e.push(a[1])}return e}))}if(e===y.CANVAS||e===y.WEBGL){if(_){r.save();var E=t.matrixEvent;_=g.multiply(E,_),r.setTransform(_[0],_[1],_[4],_[5],_[12],_[13])}r.beginPath(),r.fillStyle!==i&&(r.fillStyle=i),su(r,a,m,b),r[p](),r.closePath(),_&&r.restore()}else if(e===y.SVG){var A=lu(a);if(x){var S={tagName:"symbol",props:[],children:[{type:"item",tagName:"path",props:[["d",A],["fill",i]]}]};return t.__cacheDefs.push(S),r.add(S)}if(t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",A],["fill",i]]}),_){var T=t.virtualDom.bb;T[T.length-1].props.push(["transform","matrix(".concat(ou(g.m2m6(_),","),")")])}}}var uu,cu={renderBgc:hu,renderImage:function(t,e,r,i,a,n,o,s,l,h,c,f,_,v,d,p,x){var m=arguments.length>17&&void 0!==arguments[17]?arguments[17]:0,b=arguments.length>18&&void 0!==arguments[18]?arguments[18]:0,M=i.source;if(M){var E=(o+=m)-(a+=m),A=(s+=b)-(n+=b),S=i.width,T=i.height,w=d[v]||[],R=u(w,2),k=R[0],C=R[1];-1===k&&-1===C?(k=S,C=T):-2===k?S>E&&T>A?(k=S/E)>=(C=T/A)?C=(k=E)*T/S:k=(C=A)*S/T:S>E?C=(k=E)*T/S:T>A?k=(C=A)*S/T:(k=S,C=T):-3===k?E>S&&A>T?(k=S/E)<=(C=T/A)?C=(k=E)*T/S:k=(C=A)*S/T:E>S?C=(k=E)*T/S:A>T?k=(C=A)*S/T:(k=S/E)<=(C=T/A)?C=(k=E)*T/S:k=(C=A)*S/T:-1===k?k=C*S/T:-1===C&&(C=k*T/S);var O=_[iu][v]||0;/%/.test(O)&&(O=(E-k)*parseFloat(O)*.01),O+=a;var I=_[au][v]||0;/%/.test(I)&&(I=(A-C)*parseFloat(I)*.01),I+=n;var F=O<a||I<n||O+k>a+E||I+C>n+A,L=0,D=0,B=0,P=0;if(["repeatX","repeat"].indexOf(p[v])>-1){var N=O-a;N>0&&(L=Math.ceil(N/k)),(N=a+E-O-k)>0&&(D=Math.ceil(N/k))}if(["repeatY","repeat"].indexOf(p[v])>-1){var G=I-n;G>0&&(B=Math.ceil(G/C)),(G=n+A-I-C)>0&&(P=Math.ceil(G/C))}var H=[];if(L>0)for(var W=0;W<L;W++){var Y=O-(W+1)*k;H.push([Y,I]),!F&&0===W&&Y<a&&(F=!0)}if(D>0)for(var z=0;z<D;z++){var X=O+(z+1)*k;H.push([X,I]),!F&&z===D-1&&X+k>a+E&&(F=!0)}if(B>0)for(var U=0;U<B;U++){var V=I-(U+1)*C;H.push([O,V]),!F&&0===U&&V<n&&(F=!0)}if(P>0)for(var K=0;K<P;K++){var j=I+(K+1)*C;H.push([O,j]),!F&&K===P-1&&j+k>n+A&&(F=!0)}if(L>0&&B>0)for(var Z=0;Z<L;Z++)for(var q=0;q<B;q++)H.push([O-(Z+1)*k,I-(q+1)*C]);if(D>0&&B>0)for(var $=0;$<D;$++)for(var J=0;J<B;J++)H.push([O+($+1)*k,I-(J+1)*C]);if(L>0&&P>0)for(var Q=0;Q<L;Q++)for(var tt=0;tt<P;tt++)H.push([O-(Q+1)*k,I+(tt+1)*C]);if(D>0&&P>0)for(var et=0;et<D;et++)for(var rt=0;rt<P;rt++)H.push([O+(et+1)*k,I+(rt+1)*C]);if(e===y.CANVAS||e===y.WEBGL)F&&(r.save(),hu(this,e,r,"#FFF",null,a,n,E,A,l,h,c,f,"clip")),r.drawImage(M,O,I,k,C),H.forEach((function(t){r.drawImage(M,t[0],t[1],k,C)})),F&&r.restore();else if(e===y.SVG){var it,at=eu.matrixResize(S,T,k,C,O,I,E,A),nt=[["xlink:href",i.url],["x",O],["y",I],["width",S],["height",T]];if(at&&!g.isE(at)&&(it=!0,nt.push(["transform","matrix("+ou(g.m2m6(at),",")+")"])),F){var ot=[a,n],st=[o,s];if(it){var lt=g.inverse(at);ot=g.calPoint(ot,lt),st=g.calPoint(st,lt)}var ht={tagName:"clipPath",children:[{tagName:"path",props:[["d","M".concat(ot[0],",").concat(ot[1],"L").concat(st[0],",").concat(ot[1],"L").concat(st[0],",").concat(st[1],"L").concat(ot[0],",").concat(st[1],"L").concat(ot[0],",").concat(ot[1])],["fill","#FFF"]]}]},ut=r.add(ht);t.__cacheDefs.push(ht),nt.push(["clip-path","url(#"+ut+")"])}if(x){var ct={tagName:"symbol",props:[],children:[{type:"img",tagName:"image",props:nt}]};return t.__cacheDefs.push(ct),H.forEach((function(t){var e=nu(nt);if(it){var r=eu.matrixResize(S,T,k,C,t[0],t[1],E,A);r&&!g.isE(r)&&(e[5][1]="matrix("+ou(g.m2m6(r),",")+")")}e[1][1]=t[0],e[2][1]=t[1],ct.children.push({type:"img",tagName:"image",props:e})})),r.add(ct)}t.virtualDom.bb.push({type:"img",tagName:"image",props:nt}),H.forEach((function(e){var r=nu(nt);if(it){var i=eu.matrixResize(S,T,k,C,e[0],e[1],E,A);i&&!g.isE(i)&&(r[5][1]="matrix("+ou(g.m2m6(i),",")+")")}r[1][1]=e[0],r[2][1]=e[1],t.virtualDom.bb.push({type:"img",tagName:"image",props:r})}))}}}},fu=G.isFunction;function _u(t,e,r,i){if(i)for(var a=0;a<e;a++){var n=t[a];n.__after&&n.__after(r)}else for(var o=0;o<e;o++){var s=t[o];s.__before&&s.__before(r)}}var vu=function(){function t(){this.__rootTask=[],this.__task=[],this.__now=null}return r(t,[{key:"__init",value:function(){var t=this,e=t.task;lt.cancelAnimationFrame(t.id);var r=t.__now=lt.now();!function i(){lt.cancelAnimationFrame(t.id),t.id=lt.requestAnimationFrame((function(){if(!uu&&e.length){var a=t.__now=lt.now(),n=a-r;n=Math.max(n,0),r=a;var o=e.slice(0),s=o.length;_u(o,s,n,!1);for(var l=t.__rootTask.splice(0),h=0,u=l.length;h<u;h++){var c=l[h];c&&c(n)}_u(o,s,n,!0),e.length&&i()}}))}()}},{key:"onFrame",value:function(t){if(t){var e=this.task;e.length||this.__init(),fu(t)&&(t={__after:t,__karasFramecb:t}),e.push(t)}}},{key:"offFrame",value:function(t){if(t){for(var e=this.task,r=0,i=e.length;r<i;r++){var a=e[r];if(a===t||a.__karasFramecb===t){e.splice(r,1);break}}e.length||(lt.cancelAnimationFrame(this.id),this.__now=null)}}},{key:"nextFrame",value:function(t){var e=this;if(t){var r=fu(t)?{__after:function(i){t(i),e.offFrame(r)}}:{__before:t.__before,__after:function(i){t.__after&&t.__after(i),e.offFrame(r)}};r.__karasFramecb=t,this.onFrame(r)}}},{key:"pause",value:function(){uu=!0}},{key:"resume",value:function(){uu&&(this.__init(),uu=!1)}},{key:"task",get:function(){return this.__task}}]),t}(),yu=new vu,du=.1,pu="function"==typeof Float32Array;function xu(t,e){return 1-3*e+3*t}function gu(t,e){return 3*e-6*t}function mu(t){return 3*t}function bu(t,e,r){return((xu(e,r)*t+gu(e,r))*t+mu(e))*t}function Mu(t,e,r){return 3*xu(e,r)*t*t+2*gu(e,r)*t+mu(e)}function Eu(t){return t}function Au(t,e,r,i){if(!(0<=t&&t<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&r===i)return Eu;for(var a=pu?new Float32Array(11):new Array(11),n=0;n<11;++n)a[n]=bu(n*du,t,r);function o(e){for(var i=0,n=1;10!==n&&a[n]<=e;++n)i+=du;--n;var o=i+(e-a[n])/(a[n+1]-a[n])*du,s=Mu(o,t,r);return s>=.001?function(t,e,r,i){for(var a=0;a<4;++a){var n=Mu(e,r,i);if(0===n)return e;e-=(bu(e,r,i)-t)/n}return e}(e,o,t,r):0===s?o:function(t,e,r,i,a){var n,o,s=0;do{(n=bu(o=e+(r-e)/2,i,a)-t)>0?r=o:e=o}while(Math.abs(n)>1e-7&&++s<10);return o}(e,i,i+du,t,r)}return function(t){return 0===t||1===t?t:bu(o(t),e,i)}}var Su={linear:Au(1,1,0,0),easeIn:Au(.42,0,1,1),easeOut:Au(0,0,.58,1),ease:Au(.25,.1,.25,1),easeInOut:Au(.42,0,.58,1),cubicBezier:Au,getEasing:function(t,e,r,i){return 4===arguments.length?Au(t,e,r,i):Array.isArray(t)&&4===t.length?Au(t[0],t[1],t[2],t[3]):t?(t=t.toString(),/^\s*(?:cubic-bezier\s*)?\(\s*[\d.]+\s*,\s*[-\d.]+\s*,\s*[\d.]+\s*,\s*[-\d.]+\s*\)\s*$/i.test(t)?a=Au((t=t.match(/[\d.]+/g))[0],t[1],t[2],t[3]):"getEasing"!==t&&(a=this[t]),a):void 0;var a}};Su["ease-in"]=Su.easeIn,Su["ease-out"]=Su.easeOut,Su["ease-in-out"]=Su.easeInOut;var Tu=Ct.STYLE_KEY,wu=Tu.FILTER,Ru=Tu.TRANSFORM_ORIGIN,ku=Tu.PERSPECTIVE_ORIGIN,Cu=Tu.BACKGROUND_CLIP,Ou=Tu.BACKGROUND_POSITION_X,Iu=Tu.BACKGROUND_POSITION_Y,Fu=Tu.BOX_SHADOW,Lu=Tu.TRANSLATE_X,Du=Tu.TRANSLATE_Y,Bu=Tu.TRANSLATE_Z,Pu=Tu.BACKGROUND_SIZE,Nu=Tu.FONT_SIZE,Gu=Tu.FLEX_BASIS,Hu=Tu.FLEX_DIRECTION,Wu=Tu.WIDTH,Yu=Tu.HEIGHT,zu=Tu.TOP,Xu=Tu.BOTTOM,Uu=Tu.LINE_HEIGHT,Vu=Tu.OPACITY,Ku=Tu.Z_INDEX,ju=Tu.TRANSFORM,Zu=Tu.COLOR,qu=Tu.FONT_WEIGHT,$u=Tu.FONT_STYLE,Ju=Tu.FONT_FAMILY,Qu=Tu.TEXT_ALIGN,tc=Tu.MATRIX,ec=Tu.ROTATE_3D,rc=Tu.TRANSLATE_PATH,ic=Tu.TEXT_STROKE_COLOR,ac=Tu.TEXT_STROKE_OVER,nc=Tu.STROKE_WIDTH,oc=Tu.BORDER_TOP_LEFT_RADIUS,sc=Tu.BORDER_TOP_RIGHT_RADIUS,lc=Tu.BORDER_BOTTOM_RIGHT_RADIUS,hc=Tu.BORDER_BOTTOM_LEFT_RADIUS,uc=Tu.TEXT_STROKE_WIDTH,cc=Tu.BORDER_BOTTOM_WIDTH,fc=Tu.BORDER_LEFT_WIDTH,_c=Tu.BORDER_RIGHT_WIDTH,vc=Tu.BORDER_TOP_WIDTH,yc=Tu.LEFT,dc=Tu.RIGHT,pc=Tu.MARGIN_BOTTOM,xc=Tu.MARGIN_TOP,gc=Tu.MARGIN_LEFT,mc=Tu.MARGIN_RIGHT,bc=Tu.PADDING_TOP,Mc=Tu.PADDING_RIGHT,Ec=Tu.PADDING_LEFT,Ac=Tu.PADDING_BOTTOM,Sc=Tu.STROKE_MITERLIMIT,Tc=Tu.LETTER_SPACING,wc=Tu.PERSPECTIVE,Rc=Tu.SKEW_X,kc=Tu.SKEW_Y,Cc=Tu.SCALE_X,Oc=Tu.SCALE_Y,Ic=Tu.SCALE_Z,Fc=Tu.ROTATE_X,Lc=Tu.ROTATE_Y,Dc=Tu.ROTATE_Z,Bc=Tu.BACKGROUND_IMAGE,Pc=Tu.FILL,Nc=Tu.STROKE,Gc=Tu.BACKGROUND_COLOR,Hc=Tu.BORDER_BOTTOM_COLOR,Wc=Tu.BORDER_LEFT_COLOR,Yc=Tu.BORDER_RIGHT_COLOR,zc=Tu.BORDER_TOP_COLOR,Xc=d.AUTO,Uc=d.PX,Vc=d.PERCENT,Kc=d.INHERIT,jc=d.RGBA,Zc=d.STRING,qc=d.NUMBER,$c=d.REM,Jc=d.VW,Qc=d.VH,tf=d.VMAX,ef=d.VMIN,rf=d.GRADIENT,af=d.calUnit,nf=G.isNil,of=G.isFunction,sf=G.isNumber,lf=G.isObject,hf=G.clone,uf=G.equalArr,cf=Su.linear,ff=Ln.cloneStyle,_f=Ln.equalStyle,vf=Xi.isGeom,yf=Xi.GEOM,df=ii,pf=ni,xf=ai,gf=oi,mf=si;function bf(t,e,r,i){e.__addUpdate(r,{keys:t,cb:i})}function Mf(t,e,r,i){if(t.u===Uc){if(e.u===Vc)return.01*e.v*r-t.v;if(e.u===$c)return e.v*i.computedStyle[Nu]-t.v;if(e.u===Jc)return e.v*i.width*.01-t.v;if(e.u===Qc)return e.v*i.height*.01-t.v;if(e.u===tf)return e.v*Math.max(i.width,i.height)*.01-t.v;if(e.u===ef)return e.v*Math.min(i.width,i.height)*.01-t.v}else if(t.u===Vc){if(e.u===Uc)return 100*e.v/r-t.v;if(e.u===$c)return e.v*i.computedStyle[Nu]*100/r-t.v;if(e.u===Jc)return e.v*i.width/r-t.v;if(e.u===Qc)return e.v*i.height/r-t.v;if(e.u===tf)return e.v*Math.max(i.width,i.height)/r-t.v;if(e.u===ef)return e.v*Math.min(i.width,i.height)/r-t.v}else if(t.u===$c){if(e.u===Uc)return e.v/i.computedStyle[Nu]-t.v;if(e.u===Vc)return.01*e.v*r/i.computedStyle[Nu]-t.v;if(e.u===Jc)return e.v*i.width*.01/i.computedStyle[Nu]-t.v;if(e.u===Qc)return e.v*i.height*.01/i.computedStyle[Nu]-t.v;if(e.u===tf)return e.v*Math.max(i.width,i.height)*.01/i.computedStyle[Nu]-t.v;if(e.u===ef)return e.v*Math.min(i.width,i.height)*.01/i.computedStyle[Nu]-t.v}else if(t.u===Jc){if(e.u===Uc)return 100*e.v/i.width-t.v;if(e.u===$c)return 100*e.v*i.computedStyle[Nu]/i.width-t.v;if(e.u===Vc)return e.v*r/i.width-t.v;if(e.u===Qc)return e.v*i.height/i.width-t.v;if(e.u===tf)return e.v*Math.max(i.width,i.height)/i.width-t.v;if(e.u===ef)return e.v*Math.min(i.width,i.height)/i.width-t.v}else if(t.u===Qc){if(e.u===Uc)return 100*e.v/i.height-t.v;if(e.u===$c)return 100*e.v*i.computedStyle[Nu]/i.height-t.v;if(e.u===Jc)return e.v*i.width/i.height-t.v;if(e.u===Vc)return e.v*r/i.height-t.v;if(e.u===tf)return e.v*Math.max(i.width,i.height)/i.height-t.v;if(e.u===ef)return e.v*Math.min(i.width,i.height)/i.height-t.v}else if(t.u===tf){if(e.u===Uc)return 100*e.v/Math.max(i.width,i.height)-t.v;if(e.u===$c)return 100*e.v*i.computedStyle[Nu]/Math.max(i.width,i.height)-t.v;if(e.u===Vc)return e.v*r/Math.max(i.width,i.height)-t.v;if(e.u===Jc)return e.v*i.width/Math.max(i.width,i.height)-t.v;if(e.u===Qc)return e.v*i.height/Math.max(i.width,i.height)-t.v;if(e.u===ef)return e.v*Math.min(i.width,i.height)/Math.max(i.width,i.height)-t.v}else if(t.u===ef){if(e.u===Uc)return 100*e.v/Math.min(i.width,i.height)-t.v;if(e.u===$c)return 100*e.v*i.computedStyle[Nu]/Math.min(i.width,i.height)-t.v;if(e.u===Vc)return e.v*r/Math.min(i.width,i.height)-t.v;if(e.u===Jc)return e.v*i.width/Math.min(i.width,i.height)-t.v;if(e.u===Qc)return e.v*i.height/Math.min(i.width,i.height)-t.v;if(e.u===tf)return e.v*Math.max(i.width,i.height)/Math.min(i.width,i.height)-t.v}return 0}function Ef(t,e,r){if(t.k===e.k){for(var i=t.v,a=e.v,n=[[]],o=uf(i,a),s=0,l=Math.min(i.length,a.length);s<l;s++){var h=i[s],u=a[s],c=[];if(c.push([u[0][0]-h[0][0],u[0][1]-h[0][1],u[0][2]-h[0][2],u[0][3]-h[0][3]]),h[1]&&u[1])if(h[1].u===u[1].u)c.push(u[1].v-h[1].v);else{var f=Mf(h[1],u[1],r.clientWidth,r.root);c.push(f||0)}n[0].push(c)}if("linear"===t.k){var _=Array.isArray(t.d);if(Array.isArray(e.d)!==_)return;if(_){var v=[e.d[0]-t.d[0],e.d[1]-t.d[1],e.d[2]-t.d[2],e.d[3]-t.d[3]];if(o&&uf(v,[0,0,0,0]))return;n[1]=v}else{var y=e.d-t.d;if(o&&0===y)return;n[1]=y}}else if("radial"===t.k){var d=Array.isArray(t.z);if(Array.isArray(e.z)!==d)return;if(n[2]=[],d){if(o&&uf(t.z,e.z))return;for(var p=0;p<5;p++){var x=t.z[p];void 0===x&&(x=1);var g=e.z[p];void 0===g&&(g=1),n[2].push(g-x)}}else{if(o&&t.z===e.z&&t.s===e.s&&uf(t.p,e.p))return;for(var m=0;m<2;m++){var b=t.p[m],M=e.p[m];if(b.u===M.u)n[2].push(M.v-b.v);else{var E=Mf(b,M,r[m?"clientWidth":"clientHeight"],r.root);n[2].push(E||0)}}}}else if("conic"===t.k){if(o&&t.d===e.d&&uf(t.p,e.p))return;n[1]=e.d-t.d,n[2]=[];for(var A=0;A<2;A++){var S=t.p[A],T=e.p[A];if(S[1]===T[1])n[2].push(T[0]-S[0]);else{var w=Mf(S,T,r[A?"clientWidth":"clientHeight"],r.root);n[2].push(w||0)}}}return n}}function Af(t,e,r,i){var a;if(r.forEach((function(r){r===rc&&(a=!0);var n=function(t,e,r,i){var a=t.style[r],n=e.style[r],o=t.clone[r];o&&o.hasOwnProperty("v")&&(o=o.v);var s={k:r,st:a,cl:o};if(r===ju){if(!a&&!n||!a.length&&!n.length)return;var l,h;if(l=a&&a[0]?a[0].v:g.identity(),h=n&&n[0]?n[0].v:g.identity(),uf(l,h))return;s.v=[h[0]-l[0],h[1]-l[1],h[2]-l[2],h[3]-l[3],h[4]-l[4],h[5]-l[5],h[6]-l[6],h[7]-l[7],h[8]-l[8],h[9]-l[9],h[10]-l[10],h[11]-l[11],h[12]-l[12],h[13]-l[13],h[14]-l[14],h[15]-l[15]]}else if(r===ec){if(a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3].v===n[3].v&&a[3].u===n[3].u)return;s.v=[n[0]-a[0],n[1]-a[1],n[2]-a[2],n[3].v-a[3].v]}else if(r===wu){for(var u=Math.max(a?a.length:0,n?n.length:0),c=[],f=0;f<u;f++){var _=a?a[f]:null,v=n?n[f]:null;if(nf(_)||nf(v)||_.k!==v.k)c.push(null);else{var y=_.k,d=_.v,p=v.v;if("blur"===y)if(d.u===p.u)c.push(p.v-d.v);else{var x=Mf(d,p,0,i.root);c.push(x)}else if("hueRotate"===y||"saturate"===y||"brightness"===y||"contrast"===y||"sepia"===y||"invert"===y||"grayscale"===y)c.push(p.v-d.v);else if("dropShadow"===y){for(var m=[],b=0;b<4;b++){var M=d[b],E=p[b];M.u===E.u?m.push(E.v-M.v):m.push(Mf(M,E,1===b?i.clientHeight:i.clientWidth,i.root))}m.push([p[4][0]-d[4][0],p[4][1]-d[4][1],p[4][2]-d[4][2],p[4][3]-d[4][3]]),c.push(m)}}}s.v=c}else if(r===Ru||r===ku||mf(r)){if(n[0].v===a[0].v&&n[0].u===a[0].u&&n[1].v===a[1].v&&n[1].u===a[1].u)return;s.v=[];for(var A=0;A<2;A++){var S=a[A],T=n[A];if(S.u===T.u)s.v.push(T.v-S.v);else{var w=Mf(S,T,i[A?"outerHeight":"outerWidth"],i.root);s.v.push(w)}}}else if(r===Ou||r===Iu){s.v=[];for(var R=Math.min(a.length,n.length),k=0;k<R;k++){var C=a[k],O=n[k];if(C.u===O.u){var I=O.v-C.v;s.v.push(I)}else{var F=void 0;F=["padding-box","paddingBox"].indexOf(i.computedStyle[Cu])>-1?r===Ou?"clientWidth":"clientHeight":["content-box","contentBox"].indexOf(i.computedStyle[Cu])>-1?r===Ou?"width":"height":r===Ou?"offsetWidth":"offsetHeight";var L=Mf(C,O,i[F],i.root);s.v.push(L)}}}else if(r===Fu){s.v=[];for(var D=0,B=Math.min(a.length,n.length);D<B;D++){var P=a[D],N=n[D];if(P&&N&&P[5]===N[5]){for(var G=[],H=0;H<4;H++)if(P[H].u===N[H].u)G.push(N[H].v-P[H].v);else{var W=Mf(P[H],N[H],1===D?i.offsetHeight:i.offsetWidth,i.root);G.push(W)}for(var Y=[],z=0;z<4;z++)Y.push(N[4][z]-P[4][z]);G.push(Y),s.v.push(G)}else s.v.push(null)}}else if(r===Pu){s.v=[];for(var X,U=Math.min(a.length,n.length),V=0;V<U;V++){var K=a[V],j=n[V];if(K&&j){for(var Z=[],q=0;q<2;q++){var $=K[q],J=j[q];if($.u===J.u)Z.push(J.v-$.v);else{var Q=void 0;Q=["padding-box","paddingBox"].indexOf(i.computedStyle[Cu])>-1?V?"clientWidth":"clientHeight":["content-box","contentBox"].indexOf(i.computedStyle[Cu])>-1?V?"width":"height":V?"offsetWidth":"offsetHeight";var tt=Mf($,J,i[Q],i.root);Z.push(tt)}}uf(Z,[0,0])?s.v.push(null):(s.v.push(Z),X=!0)}else s.v.push(null)}if(!X)return}else if(r===Vu||r===Ku){if(n===a)return;s.v=n-a}else if(r===nc){s.v=[];for(var et=Math.min(a.length,n.length),rt=0;rt<et;rt++){var it=a[rt],at=n[rt];if(it.u===at.u){var nt=at.v-it.v;s.v.push(nt)}var ot=Mf(it,at,i.offsetWidth,i.root);s.v.push(ot)}}else if(r===rc&&a){var st="offsetWidth",lt="offsetHeight";["padding-box","paddingBox"].indexOf(i.computedStyle[Cu])>-1?(st="clientWidth",lt="clientHeight"):["content-box","contentBox"].indexOf(i.computedStyle[Cu])>-1&&(st="width",lt="height"),s.v=a.map((function(t,e){var r=t.v,a=t.u;return a===Vc?e%2==0?{v:.01*(parseFloat(r)||0)*i[st],u:Uc}:{v:.01*(parseFloat(r)||0)*i[lt],u:Uc}:a===$c?{v:(parseFloat(r)||0)*i.root.computedStyle[Nu]*100,u:Uc}:a===Jc?{v:.01*(parseFloat(r)||0)*i.root.width,u:Uc}:a===Qc?{v:.01*(parseFloat(r)||0)*i.root.height,u:Uc}:a===tf?{v:.01*(parseFloat(r)||0)*Math.max(i.root.width,i.root.height),u:Uc}:a===ef?{v:.01*(parseFloat(r)||0)*Math.min(i.root.width,i.root.height),u:Uc}:{v:parseFloat(r)||0,u:Uc}}))}else if(pf(r))if(a.u===n.u){var ht=n.v-a.v;if(0===ht)return;s.v=ht}else{var ut=Mf(a,n,i[r===Lu||r===Bu?"outerWidth":"outerHeight"],i.root);if(!ut)return;s.v=ut}else if(xf(r)){if(a.u===Xc||n.u===Xc)return;var ct=i.computedStyle,ft=(i.domParent||i).computedStyle,_t=0;if(a.u===n.u?_t=n.v-a.v:r===Uu?_t=Mf(a,n,ct[Nu],i.root):r===Nu?_t=Mf(a,n,ft[Nu],i.root):r===Gu&&["column","column-reverse","columnReverse"].indexOf(ct[Hu])>-1||[Yu,zu,Xu].indexOf(r)>-1?a.u!==Xc&&n.u!==Xc&&(_t=Mf(a,n,ft[Yu],i.root)):a.u!==Xc&&n.u!==Xc&&(_t=Mf(a,n,ft[Wu],i.root)),0===_t||isNaN(_t))return;s.v=_t}else if(gf(r)){s.v=[];for(var vt=Math.min(a.length,n.length),yt=0;yt<vt;yt++){var dt=a[yt],pt=n[yt];if(dt&&pt&&dt.u===pt.u&&dt.u!==Zc){var xt=dt.u;dt=dt.v,pt=pt.v;var gt=void 0;if(xt===rf){var mt=Ef(dt,pt,i);if(!mt){s.v.push(null);continue}gt=mt}else{if(uf(pt,dt)){s.v.push(null);continue}gt=[pt[0]-dt[0],pt[1]-dt[1],pt[2]-dt[2],pt[3]-dt[3]]}s.v.push(gt)}else s.v.push(null)}}else if(df(r)){if(n.u!==a.u)return;if(n=n.v,a=a.v,n.u===rf){var bt=Ef(a,n,i);if(!bt)return;s.v=bt}else{if(uf(n,a))return;s.v=[n[0]-a[0],n[1]-a[1],n[2]-a[2],n[3]-a[3]]}}else{if(!yf.hasOwnProperty(r))return;var Mt=i.tagName;if(nf(a))return;if(yf[r][Mt]&&of(yf[r][Mt].calDiff)){var Et=yf[r][Mt].calDiff;if(i.isMulti){for(var At=[],St=0,Tt=Math.min(a.length,n.length);St<Tt;St++)At.push(Et(a[St],n[St]));return At}s.v=Et(a,n)}else if(i.isMulti)if("points"===r||"controls"===r){if(nf(n)||!n.length||nf(a)||!a.length||uf(a,n))return;s.v=[];for(var wt=0,Rt=Math.min(a.length,n.length);wt<Rt;wt++){var kt=a[wt],Ct=n[wt];if(nf(kt)||!kt.length||nf(Ct)||!Ct.length)s.v.push(null);else{for(var Ot=[],It=0,Ft=Math.min(kt.length,Ct.length);It<Ft;It++){var Lt=kt[It],Dt=Ct[It];if(nf(Lt)||nf(Dt))Ot.push(null);else{for(var Bt=[],Pt=0,Nt=Math.max(Lt.length,Dt.length);Pt<Nt;Pt++){var Gt=Lt[Pt],Ht=Dt[Pt];nf(Gt)||nf(Ht)?Bt.push(0):Bt.push(Ht-Gt)}Ot.push(Bt)}}s.v.push(Ot)}}}else if("controlA"===r||"controlB"===r){if(nf(n)||!n.length||nf(a)||!a.length||uf(a,n))return;s.v=[];for(var Wt=0,Yt=Math.min(a.length,n.length);Wt<Yt;Wt++){var zt=a[Wt],Xt=n[Wt];nf(zt)||!zt.length||nf(Xt)||!Xt.length?s.v.push(null):s.v.push([Xt[0]-zt[0],Xt[1]-zt[1]])}}else{if(n===a||uf(n,a)||"edge"===r||"closure"===r||"booleanOperations"===r)return;for(var Ut=[],Vt=0,Kt=Math.min(a.length,n.length);Vt<Kt;Vt++){var jt=a[Vt],Zt=n[Vt];(nf(jt)||nf(Zt))&&Ut.push(0),Ut.push(Zt-jt)}s.v=Ut}else if("points"===r||"controls"===r){if(nf(n)||!n.length||nf(a)||!a.length||uf(a,n))return;s.v=[];for(var qt=0,$t=Math.min(a.length,n.length);qt<$t;qt++){var Jt=a[qt],Qt=n[qt];if(nf(Jt)||!Jt.length||nf(Qt)||!Qt.length)s.v.push(null);else{for(var te=[],ee=0,re=Math.max(Jt.length,Qt.length);ee<re;ee++){var ie=Jt[ee],ae=Qt[ee];nf(ie)||nf(ae)?te.push(0):te.push(ae-ie)}s.v.push(te)}}}else if("controlA"===r||"controlB"===r){if(nf(n)||!n.length||nf(a)||!a.length||uf(a,n))return;s.v=[n[0]-a[0],n[1]-a[1]]}else{if(n===a||"edge"===r||"closure"===r||"booleanOperations"===r)return;s.v=n-a}}return s}(t,e,r,i);n?(n.fn=Tf[r],t.transition.push(n),t.keys.push(r)):t.fixed.push(r)})),a){var n=t.keys.indexOf(Lu);-1===n&&t.keys.push(Lu),-1===(n=t.keys.indexOf(Du))&&t.keys.push(Du),(n=t.fixed.indexOf(Lu))>-1&&t.fixed.splice(n,1),(n=t.fixed.indexOf(Du))>-1&&t.fixed.splice(n,1)}return e}function Sf(t){var e;if(t)if(e=/^\s*steps\s*\(\s*(\d+)(?:\s*,\s*(\w+))?\s*\)/i.exec(t)){var r=parseInt(e[1]),i=e[2];e=function(t){if(r&&r>0){var e=1/r;return("start"===i?Math.ceil(t/e):Math.floor(t/e))/r}return t}}else e=Su.getEasing(t);return e}var Tf=[];function wf(t,e,r){for(var i=e.__currentStyle,a=e.__currentProps,n=[],o=0,s=r.length;o<s;o++){var l=r[o],h=t[l],u=yf.hasOwnProperty(l);_f(l,h,u?a[l]:i[l],e)||(u?a[l]=h:i[l]=h,n.push(l))}return n}function Rf(t,e){return of(t)&&(e=t,t={}),[t||{},e]}function kf(t){t.emit(Oh.FRAME,t.__isChange),t.__firstPlay&&(t.__firstPlay=!1,t.emit(Oh.PLAY));var e=t.__playCb;of(e)&&(e(t.__isChange),t.__playCb===e&&(t.__playCb=null))}Tf[ju]=function(t,e,r,i,a,n,o){i&&i.length||(i=n.style[t]=[{k:tc,v:g.identity()}]);a&&a.length||(a=n.clone[t]=[{k:tc,v:g.identity()}]);for(var s=0;s<16;s++)i[0].v[s]=a[0].v[s]+e[s]*r;o[t]=i},Tf[ec]=function(t,e,r,i,a,n,o){i[0]=a[0]+e[0]*r,i[1]=a[1]+e[1]*r,i[2]=a[2]+e[2]*r,i[3].v=a[3].v+e[3]*r,o[t]=i},Tf[wu]=function(t,e,r,i,a,n,o){for(var s=0,l=e.length;s<l;s++){var h=e[s];if(h){var u=i[s].k,c=i[s].v;if("dropShadow"===u){c[0].v+=h[0]*r,c[1].v+=h[1]*r,c[2].v+=h[2]*r,c[3].v+=h[3]*r;var f=c[4],_=h[4];f[0]+=_[0]*r,f[1]+=_[1]*r,f[2]+=_[2]*r,f[3]+=_[3]*r}else c.v+=h*r}}o[t]=i},Tf[Ru]=Tf[ku]=Tf[oc]=Tf[sc]=Tf[lc]=Tf[hc]=function(t,e,r,i,a,n,o){0!==e[0]&&(i[0].v=a[0].v+e[0]*r);0!==e[1]&&(i[1].v=a[1].v+e[1]*r);o[t]=i},Tf[nc]=Tf[Ou]=Tf[Iu]=function(t,e,r,i,a,n,o){i.forEach((function(t,i){e[i]&&(t.v=a[i].v+e[i]*r)})),o[t]=i},Tf[Fu]=function(t,e,r,i,a,n,o){for(var s=0,l=Math.min(i.length,e.length);s<l;s++)if(e[s]){for(var h=0;h<4;h++)i[s][h].v=a[s][h].v+e[s][h]*r;for(var u=0;u<4;u++)i[s][4][u]=a[s][4][u]+e[s][4][u]*r}o[t]=i},Tf[Pu]=function(t,e,r,i,a,n,o){i.forEach((function(t,i){var n=e[i];n&&(t[0].v=a[i][0].v+n[0]*r,t[1].v=a[i][1].v+n[1]*r)})),o[t]=i},Tf[Vu]=Tf[Ku]=function(t,e,r,i,a,n,o){i=a+e*r,t===Vu&&(i<0?i=0:i>1&&(i=1));o[t]=i},Tf[rc]=function(t,e,r,i,a,n,o){var s=1-r;8===e.length?(o[Lu]={v:e[0].v*s*s*s+3*e[2].v*r*s*s+3*e[4].v*r*r*s+e[6].v*r*r*r,u:Uc},o[Du]={v:e[1].v*s*s*s+3*e[3].v*r*s*s+3*e[5].v*r*r*s+e[7].v*r*r*r,u:Uc}):6===e.length&&(o[Lu]={v:e[0].v*s*s+2*e[2].v*r*s+e[4].v*r*r,u:Uc},o[Du]={v:e[1].v*s*s+3*e[3].v*r*s+e[5].v*r*r,u:Uc})},Tf[Nu]=Tf[uc]=Tf[cc]=Tf[fc]=Tf[_c]=Tf[vc]=Tf[yc]=Tf[zu]=Tf[dc]=Tf[Xu]=Tf[Gu]=Tf[Wu]=Tf[Yu]=Tf[Uu]=Tf[pc]=Tf[xc]=Tf[gc]=Tf[mc]=Tf[bc]=Tf[Mc]=Tf[Ec]=Tf[Ac]=Tf[nc]=Tf[Sc]=Tf[Tc]=Tf[wc]=Tf[Lu]=Tf[Du]=Tf[Bu]=Tf[Rc]=Tf[kc]=Tf[Cc]=Tf[Oc]=Tf[Ic]=Tf[Fc]=Tf[Lc]=Tf[Dc]=function(t,e,r,i,a,n,o){i.v=a+e*r,o[t]=i},Tf[Bc]=Tf[Pc]=Tf[Nc]=function(t,e,r,i,a,n,o){i.forEach((function(t,i){var n=e[i];if(n){var o=a[i].v;if(t.u===rf){t=t.v;for(var s=u(n,4),l=s[0],h=s[1],c=s[2],f=s[3],_=0,v=Math.min(t.v.length,l.length);_<v;_++){var y=t.v[_],d=l[_];y[0][0]=o.v[_][0][0]+d[0][0]*r,y[0][1]=o.v[_][0][1]+d[0][1]*r,y[0][2]=o.v[_][0][2]+d[0][2]*r,y[0][3]=o.v[_][0][3]+d[0][3]*r,y[1]&&d[1]&&(y[1].v=o.v[_][1].v+d[1]*r)}"linear"===t.k&&void 0!==t.d&&void 0!==h?Array.isArray(h)?(t.d[0]=o.d[0]+h[0]*r,t.d[1]=o.d[1]+h[1]*r,t.d[2]=o.d[2]+h[2]*r,t.d[3]=o.d[3]+h[3]*r):t.d=o.d+h*r:"radial"===t.k?void 0!==t.z&&void 0!==f?(t.z[0]=o.z[0]+f[0]*r,t.z[1]=o.z[1]+f[1]*r,t.z[2]=o.z[2]+f[2]*r,t.z[3]=o.z[3]+f[3]*r,t.z[4]=o.z[4]+f[4]*r):void 0!==t.p&&void 0!==c&&(t.p[0].v=o.p[0].v+c[0]*r,t.p[1].v=o.p[1].v+c[1]*r):"conic"===t.k&&void 0!==t.d&&void 0!==h&&(t.d=o.d+h*r,t.p[0][0]=o.p[0]+c[0]*r,t.p[1][0]=o.p[1]+c[1]*r)}else(t=t.v)[0]=o[0]+n[0]*r,t[1]=o[1]+n[1]*r,t[2]=o[2]+n[2]*r,t[3]=o[3]+n[3]*r}})),o[t]=i},Tf[Gc]=Tf[Hc]=Tf[Wc]=Tf[Yc]=Tf[zc]=Tf[Zu]=Tf[ic]=function(t,e,r,i,a,n,o){var s=i.v;s[0]=a[0]+e[0]*r,s[1]=a[1]+e[1]*r,s[2]=a[2]+e[2]*r,s[3]=a[3]+e[3]*r,o[t]=i};var Cf=0,Of=function(t){function e(e,r,i){var a;if((a=t.call(this)||this).__id=Cf++,r=hf(r||[]),Array.isArray(r))r=r.filter((function(t){return t&&lf(t)}));else if(r&&lf(r)){var n=[];Object.keys(r).forEach((function(t){var e=r[t];if(Array.isArray(e))for(var i=0,a=e.length;i<a;i++){(n[i]=n[i]||{offset:i/(a-1)})[t]=e[i]}})),r=n}else r=[];sf(i)&&(a.__options={duration:i},i=a.__options);var o=a.__options=i||{duration:0};a.__begin=!0,a.__playState="idle",a.__target=e,a.__root=e.root,a.__isChange=!1,a.__firstPlay=!0,a.__firstEnter=!0;var s=a.iterations=o.iterations,l=a.duration=o.duration,h=u(a.__init(r,s,l,o.easing,e),4),c=h[0],f=h[1],_=h[2],v=h[3];a.__frames=c,a.__framesR=f,a.__keys=_,a.__originStyle=v,a.__isDelay=!1,a.__outBeginDelay=!1,a.__playCount=0;var y=parseInt(o.fps)||0;return y<=0&&(y=60),a.fps=y,a.spfLimit=o.spfLimit,a.delay=o.delay,a.endDelay=o.endDelay,a.playbackRate=o.playbackRate,a.fill=o.fill,a.iterations=o.iterations,a.direction=o.direction,a.easing=o.easing,a.__currentFrames={reverse:!0,"alternate-reverse":!0}.hasOwnProperty(o.direction)?f:c,a.__timestamp=yu.__now,a}return a(e,t),r(e,[{key:"__init",value:function(t,e,r,i,a){if(t.length<1)return[[],[],[],{}];for(var n=function(e,r){var i=t[e];if(i.hasOwnProperty("offset")){if(i.offset=parseFloat(i.offset)||0,i.offset=Math.max(0,i.offset),i.offset=Math.min(1,i.offset),isNaN(i.offset)||i.offset<0||i.offset>1)return t.splice(e,1),e--,r--,o=e,s=r,"continue";if(i.offset<=-1)return t.splice(e,1),e--,r--,o=e,s=r,"continue"}Object.keys(i).forEach((function(t){ar.hasOwnProperty(t)&&ar.toFull(i,t)})),Object.keys(i).forEach((function(t){"easing"===t||"offset"===t||Xi.isValid(a.tagName,t)||delete i[t]})),o=e,s=r},o=0,s=t.length;o<s;o++)n(o,s);if(1===t.length)if(t[0]=hf(t[0]),1===t[0].offset)t.unshift({offset:0});else{var l=hf(t[0]);l.offset=1,t.push(l)}else t.forEach((function(e,r){t[r]=hf(e)}));var h=t[0];h.hasOwnProperty("offset")&&h.offset>0?(h={offset:0},t.unshift(h)):h.offset=0;var u=t[t.length-1];u.hasOwnProperty("offset")&&u.offset<1?(u={offset:1},t.push(u)):u.offset=1;for(var c=1,f=t.length;c<f;c++){var _=t[c];if(!_.hasOwnProperty("offset")){for(var v=void 0,y=c+1;y<f&&!(v=t[y]).hasOwnProperty("offset");y++);var d=y-c+1;_=t[c-1];for(var p=(v.offset-_.offset)/d,x=c;x<y;x++){t[x].offset=_.offset+p*(x+1-c)}c=y}}var g=[];t.forEach((function(t){g.push(function(t,e,r){var i=t,a=i.offset,n=i.easing;delete t.offset,delete t.easing;var o=t.translatePath;return t=Ln.normalize(t),Array.isArray(o)&&[6,8].indexOf(o.length)>-1&&(t[rc]=o.map((function(t){var e=af(t);return e.u===qc&&(e.u=Uc),e}))),{style:t,time:a*e,easing:n||r,timingFunction:Sf(n||r),transition:[],keys:[],fixed:[]}}(t,r,i))}));var m=function(t,e){var r={},i=[];return t.forEach((function(t){var e=t.style;Object.keys(e).forEach((function(t){void 0===e[t]||r.hasOwnProperty(t)||(r[t]=!0,yf.hasOwnProperty(t)||(t=parseInt(t)),t===rc&&(r.hasOwnProperty(Lu)||i.push(Lu),r.hasOwnProperty(Du)||i.push(Du),r[Lu]=r[Du]=!0),i.push(t))}))})),t.forEach((function(t){var r=t.style;i.forEach((function(t){r.hasOwnProperty(t)&&!nf(r[t])||(yf.hasOwnProperty(t)?r[t]=hf(e.getProps(t)):t===Lu&&r.hasOwnProperty(rc)?r[t]=hf(r[rc][0]):t===Du&&r.hasOwnProperty(rc)?r[t]=hf(r[rc][1]):r[t]=ff(e.__currentStyle,[t])[t])}))})),i}(g,a);!function(t,e,r){var i=r.__computedStyle;t.forEach((function(t){var a=t.style;e.forEach((function(t){var e=a[t];if(!nf(e))if(t===ju){var n=r.__outerWidth,o=r.__outerHeight,s=Ws.calMatrix(e,n,o);a[t]=[{k:tc,v:s}]}else e.u===Kc&&(t===Zu||t===ic?a[t]={v:G.rgba2int(i[t]),u:jc}:xf(t)?a[t]={v:i[t],u:Uc}:t===qu?a[t]={v:i[t],u:qc}:t!==$u&&t!==Ju&&t!==Qu&&t!==ac||(a[t]={v:i[t],u:Zc}))})),t.clone=ff(a)}))}(g,m,a);var b=hf(g).reverse(),M=a.style,E=a.props,A={};m.forEach((function(t){vf(a.tagName,t)&&(A[t]=E[t]),A[t]=M[t]}));for(var S=g.length,T=g[0],w=1;w<S;w++){T=Af(T,g[w],m,a)}b.forEach((function(t){t.time=r-t.time,t.transition=[]})),T=b[0];for(var R=1;R<S;R++){T=Af(T,b[R],m,a)}return[g,b,m,A]}},{key:"__clean",value:function(t){this.__cancelTask(),this.__nextTime=0,t?(this.__currentTime=this.__delay+this.__duration*this.__iterations+this.__endDelay,this.__playState="finished"):(this.__playCount=this.__currentTime=0,this.__playState="idle")}},{key:"play",value:function(t){var e=this.__isDestroyed,r=this.__duration,i=this.__playState,a=this.__frames;if(e||r<=0||a.length<1)return this;if("running"===i)return this;if(this.__cancelTask(),this.__playCb=t,this.__playState="running",this.__firstPlay=!0,this.__firstEnter=!0,this.__playCount=0,this.__hasFin=!1,this.__hasCancel=!1,!this.__enterFrame){this.__enterFrame=!0;var n=this.__framesR,o=this.__direction;this.__currentFrames={reverse:!0,"alternate-reverse":!0}.hasOwnProperty(o)?n:a,this.__currentTime=this.__nextTime=this.__fpsTime=0}return yu.onFrame(this),this.__startTime=yu.__now,this.__end=!1,this}},{key:"__before",value:function(t){this.__timestamp=yu.__now;var e=this.__target,r=this.__fps,i=this.__currentFrames,a=this.__iterations,n=this.__stayBegin,o=this.__stayEnd,s=this.__delay,l=this.__root,h=this.__duration,u=this.__endDelay,c=i.length,f=this.__playbackRate,_=this.__spfLimit,v=this.__currentTime=this.__nextTime;if(this.__isChange=!1,_&&(!0===_?t=Math.min(t,1e3/r):_>0&&(t=Math.min(t,_))),1!==f&&f>0&&(t*=f),this.__nextTime+=t,!this.__firstEnter&&r<60){if((t=this.__fpsTime+=t)<1e3/r)return void(this.__inFps=!0);this.__fpsTime=0}if(this.__firstEnter=!1,v<s){if(n&&!this.__isDelay){var y=wf((this.__currentFrame=i[0]).style,e,this.__keys);this.__isChange=!!y.length,bf(y,l,e,null)}return this.__begin=!1,this.__outBeginDelay=!0,void(this.__isDelay=!0)}this.__isDelay=!1,v-=s,this.__outBeginDelay&&(this.__outBeginDelay=!1,this.__begin=!0);var d=Math.min(a-1,Math.floor(v/h));if(v-=h*d,this.__playCount<d){this.__begin=!0,this.__playCount=d;var p=this.__direction,x=this.__frames,g=this.__framesR;if("alternate"===p||"alternate-reverse"===p){var m=d%2==0;i=this.__currentFrames="alternate"===p?m?x:g:m?g:x}}var b,M,E=d>=a-1;2===c?(b=v<h?0:1,M=h):(b=function(t,e,r,i){for(;t<e;){if(t===e-1)return i[e].time<=r?e:t;var a=t+(e-t>>1),n=i[a];if(n.time===r)return a;n.time>r?e=Math.max(a-1,t):t=Math.min(a,e)}return t}(0,c-1,v,i),M=i[b].time);var A=E&&b===c-1,S=0;if(A);else if(2===c)S=v/h;else{S=(v-M)/(i[b+1].time-M)}var T,w,R,k=i[b];if(this.__currentFrame!==k&&(this.__currentFrame&&(this.__currentFrame.lastPercent=-1),this.__currentFrame=k),A?(T=v<h+u,R=wf(o?k.style:this.__originStyle,e,this.__keys),this.__nextEnd=!0,T||(this.__playCount++,this.__finished=!0,yu.offFrame(this),w=!0,this.__nextTime=0)):R=function(t,e,r){var i=t.style,a=t.transition,n=t.timingFunction;if(n&&n!==cf&&(e=n(e)),t.lastPercent===e)return[];t.lastPercent=e;for(var o,s=r.__currentStyle,l=r.__currentProps,h=t.keys,u=function(i,n){var u=a[i],c=u.k,f=u.v,_=u.st,v=u.cl,y=u.fn;if(y)y(c,f,e,_,v,t,s);else if(yf.hasOwnProperty(c)){var d=r.tagName;if(yf[c][d]&&of(yf[c][d].calIncrease)){var p=yf[c][d].calIncrease;_=r.isMulti?_.map((function(t,r){return p(t,f[r],e)})):p(_,f,e)}else if(r.isMulti)if("points"===c||"controls"===c)for(var x=0,g=Math.min(_.length,f.length);x<g;x++){var m=_[x],b=f[x],M=v[x];if(!nf(m)&&!nf(b))for(var E=0,A=Math.min(m.length,b.length);E<A;E++){var S=m[E],T=b[E];if(!nf(S)&&!nf(T))for(var w=0,R=Math.min(S.length,T.length);w<R;w++)nf(S[w])||nf(T[w])||(S[w]=M[E][w]+T[w]*e)}}else"controlA"===c||"controlB"===c?f.forEach((function(t,r){var i=_[r];nf(t[0])||nf(i[0])||(i[0]=v[r][0]+t[0]*e),nf(t[1])||nf(i[1])||(i[1]=v[r][1]+t[1]*e)})):f.forEach((function(t,r){nf(t)||nf(_[r])||(_[r]=v[r]+t*e)}));else if("points"===c||"controls"===c)for(var k=0,C=Math.min(_.length,f.length);k<C;k++){var O=_[k],I=f[k];if(!nf(O)&&!nf(I))for(var F=0,L=Math.min(O.length,I.length);F<L;F++)nf(O[F])||nf(I[F])||(O[F]=v[k][F]+I[F]*e)}else"controlA"===c||"controlB"===c?(nf(_[0])||nf(f[0])||(_[0]=v[0]+f[0]*e),nf(_[1])||nf(f[1])||(_[1]=v[1]+f[1]*e)):nf(_)||nf(f)||(_=v+f*e);l[c]=_}else if(s[c]!==_)s[c]=_;else{o||(o=!0,h=h.slice(0));var D=h.indexOf(c);h.splice(D,1)}},c=0,f=a.length;c<f;c++)u(c);for(var _=t.fixed,v=0,y=_.length;v<y;v++){var d=_[v],p=yf.hasOwnProperty(d);_f(d,i[d],p?l[d]:s[d],r)||(yf.hasOwnProperty(d)?l[d]=i[d]:s[d]=i[d],o||(o=!0,h=h.slice(0)),h.push(d))}return h}(k,S,e),this.__isChange=!R.length,bf(R,l,e,null),w){var C=this.__playCb;this.__clean(!0),C&&(this.__playCb=C)}}},{key:"__after",value:function(){this.__inFps?this.__inFps=!1:(kf(this),this.__begin&&(this.__begin=!1,this.emit(Oh.BEGIN,this.__playCount)),this.__nextEnd&&!this.__end&&(this.__end=!0,this.emit(Oh.END,this.__playCount-1)),this.__finished&&(this.__begin=this.__end=this.__isDelay=this.__finished=this.__inFps=this.__enterFrame=!1,this.__playState="finished",this.emit(Oh.FINISH,this.__isChange)))}},{key:"pause",value:function(t){var e=this.__isDestroyed,r=this.__duration,i=this.pending;return e||r<=0||i||(this.__playState="paused",this.__cancelTask(),t||this.emit(Oh.PAUSE)),this}},{key:"resume",value:function(t){var e=this.__isDestroyed,r=this.__duration,i=this.__playState;return e||r<=0||"paused"!==i?this:this.play(t)}},{key:"finish",value:function(t){var e=this,r=this.__isDestroyed,i=this.__duration,a=this.__playState,n=this.__frames;if(r||i<=0||n.length<1)return this;if("finished"===a)return of(t)&&t(),this;this.__clean(!0),this.__begin=this.__end=this.__isDelay=this.__finished=this.__inFps=this.__enterFrame=!1,this.__playState="finished";var o=this.__root;if(o){var s,l=this.__target;if(this.__stayEnd){var h=this.__framesR,u=this.__direction,c=this.__iterations;if("reverse".indexOf(u)>-1){var f=[h,n];n=f[0],h=f[1]}s=c===1/0||c%2?n[n.length-1].style:h[h.length-1].style}else s=this.__originStyle;var _=wf(s,l,this.__keys);this.__isChange=!_.length,bf(_,o,l,(function(){kf(e),e.emit(Oh.FINISH,e.__isChange),of(t)&&t(e.__isChange)}))}return this}},{key:"cancel",value:function(t){var e=this,r=this.__isDestroyed,i=this.__duration,a=this.__playState,n=this.__frames;if(r||i<=0||n.length<1)return this;if("idle"===a)return of(t)&&t(),this;this.__clean(),this.__begin=this.__end=this.__isDelay=this.__finished=this.__inFps=this.__enterFrame=!1,this.__playState="idle";var o=this.__root;if(o){var s=this.__target,l=wf(this.__originStyle,s,this.__keys);this.__isChange=!l.length,bf(l,o,s,(function(){kf(e),e.emit(Oh.CANCEL,e.__isChange),of(t)&&t(e.__isChange)}))}return this}},{key:"gotoAndPlay",value:function(t,e,r){var i=this.__isDestroyed,a=this.__duration,n=this.__frames,o=this.__delay,s=this.__endDelay;if(i||a<=0||n.length<1)return this;var l=u(Rf(e,r),2);return e=l[0],r=l[1],this.__goto(t,e.isFrame,e.excludeDelay),t>a+o+s?this.finish(r):this.play(r)}},{key:"gotoAndStop",value:function(t,e,r){var i=this,a=this.__isDestroyed,n=this.__duration,o=this.__frames,s=this.__delay,l=this.__endDelay;if(a||n<=0||o.length<1)return this;var h=u(Rf(e,r),2);return e=h[0],r=h[1],(t=this.__goto(t,e.isFrame,e.excludeDelay))>n+s+l?this.finish(r):this.play((function(){i.__playState="paused",i.__cancelTask(),of(r)&&r()}))}},{key:"__goto",value:function(t,e,r){var i=this.__iterations,a=this.__duration;if(this.__playState="paused",isNaN(t)||t<0)throw new Error("Param of gotoAnd(Play/Stop) is illegal: "+t);e&&(t=(t-1)/this.spf),r&&(t+=this.__delay),this.__nextTime=t,t-=this.__delay;for(var n=0;t>=a&&n<i-1;)n++,t-=a;this.__playCount=n,this.__enterFrame=!0;var o=this.__frames,s=this.__framesR,l=this.__direction;if({alternate:!0,"alternate-reverse":!0}.hasOwnProperty(l)){var h=n%2==0;this.__currentFrames="alternate"===l?h?o:s:h?s:o}return t}},{key:"addControl",value:function(){var t=this.root;if(t){var e=t.animateController;e&&e.add(this)}}},{key:"removeControl",value:function(){var t=this.__root;if(t){var e=t.__animateController;e&&e.remove(this)}}},{key:"__setTarget",value:function(t){this.__target=t}},{key:"__cancelTask",value:function(){yu.offFrame(this),this.__playCb=null}},{key:"__destroy",value:function(){this.__isDestroyed||(this.removeControl(),this.__clean(),this.__target=this.__root=null,this.__startTime=0,this.__isDestroyed=!0)}},{key:"__checkModify",value:function(){"idle"!==this.__playState&&"finished"!==this.__playState&&lt.warn("Modification will not come into effect when animation is running")}},{key:"id",get:function(){return this.__id}},{key:"target",get:function(){return this.__target}},{key:"root",get:function(){return this.__root}},{key:"keys",get:function(){return this.__keys}},{key:"options",get:function(){return this.__options}},{key:"duration",get:function(){return this.__duration},set:function(t){return t=Math.max(0,parseFloat(t)||0),this.__duration!==t&&(this.__duration=t,this.__checkModify()),t}},{key:"delay",get:function(){return this.__delay},set:function(t){return t=Math.max(0,parseFloat(t)||0),this.__delay!==t&&(this.__delay=t,this.__checkModify()),t}},{key:"endDelay",get:function(){return this.__endDelay},set:function(t){return t=Math.max(0,parseFloat(t)||0),this.__endDelay!==t&&(this.__endDelay=t,this.__checkModify()),t}},{key:"fps",get:function(){return this.__fps},set:function(t){return t=parseInt(t)||60,this.__fps!==t&&(t<=0&&(t=60),this.__fps=t),t}},{key:"spf",get:function(){return 1/this.fps}},{key:"iterations",get:function(){return this.__iterations},set:function(t){return t===1/0||G.isString(t)&&"infinity"===t.toLowerCase()?t=1/0:(t=parseInt(t),(isNaN(t)||t<0)&&(t=1)),this.__iterations!==t&&(this.__iterations=t),t}},{key:"fill",get:function(){return this.__fill},set:function(t){return t=t||"none",this.__fill!==t&&(this.__fill=t,this.__checkModify()),this.__stayBegin={backwards:!0,both:!0}.hasOwnProperty(t),this.__stayEnd={forwards:!0,both:!0}.hasOwnProperty(t),t}},{key:"direction",get:function(){return this.__direction},set:function(t){return t=t||"normal",this.__direction!==t&&(this.__direction=t,this.__checkModify()),t}},{key:"frames",get:function(){return this.__frames}},{key:"framesR",get:function(){return this.__framesR}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(t){return(t=parseFloat(t)||1)<=0&&(t=1),this.__playbackRate!==t&&(this.__playbackRate=t),t}},{key:"easing",get:function(){return this.__easing},set:function(t){this.__easing=t}},{key:"startTime",get:function(){return this.__startTime}},{key:"currentTime",get:function(){return this.__currentTime},set:function(t){return t=Math.max(0,parseFloat(t)||0),this.__currentTime!==t&&(this.__currentTime=t,this.__nextTime=t),t}},{key:"nextTime",get:function(){return this.__nextTime},set:function(t){return t=Math.max(0,parseFloat(t)||0),this.__nextTime!==t&&(this.__nextTime=t),t}},{key:"timestamp",get:function(){return this.__timestamp}},{key:"pending",get:function(){return"running"!==this.__playState}},{key:"finished",get:function(){return"finished"===this.__playState}},{key:"playState",get:function(){return this.__playState}},{key:"playCount",get:function(){return this.__playCount},set:function(t){return t=Math.max(0,parseInt(t)||0),this.__playCount!==t&&(this.__playCount=t),t}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"animating",get:function(){var t=this.__playState;return"idle"!==t&&("finished"!==t||this.__stayEnd||this.__stayBegin)}},{key:"spfLimit",get:function(){return this.__spfLimit},set:function(t){return t=G.isNumber(t)||/^\d/.test(t)?Math.max(0,parseInt(t)||0):!!t,this.__spfLimit!==t&&(this.__spfLimit=t),t}}]),e}(Oh),If=G.int2rgba,Ff=Zt.canvasPolygon,Lf=Zt.svgPolygon;var Df={renderBoxShadow:function(t,e,r,i,a,n,o,s,l,h){var c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0;a+=c,n+=f,o+=c,s+=f;var _=u(i,6),v=_[0],d=_[1],p=_[2],x=_[3],g=_[4],m=_[5],b=If(g),M=2*Math.abs(p)+2*Math.abs(x)+2*Math.abs(v)+2*Math.abs(d),E=[[a,n],[o,n],[o,s],[a,s],[a,n]],A=[[a-M,n-M],[a-M,s+M],[o+M,s+M],[o+M,n-M],[a-M,n-M]];if(g[3]>0)if(e===y.CANVAS||e===y.WEBGL){if(r.save(),r.beginPath(),"inset"===m){var S=a+v+x,T=n+d+x,w=o+v-x,R=s+d-x,k=[[S,T],[w,T],[w,R],[S,R]],C=Ut.getRectsIntersection([E[0][0],E[0][1],E[2][0],E[2][1]],[k[0][0],k[0][1],k[2][0],k[2][1]]);if(!C)return;C=[[C[0],C[1]],[C[2],C[1]],[C[2],C[3]],[C[0],C[3]],[C[0],C[1]]],x?(Ff(r,C),Ff(r,E.slice(0).reverse()),r.clip(),r.closePath(),r.beginPath(),r.fillStyle!==b&&(r.fillStyle=b),Ff(r,E),r.fill(),r.closePath(),r.restore(),r.save(),r.beginPath(),Ff(r,C),r.clip(),r.closePath(),r.beginPath(),"#FFF"!==r.fillStyle&&(r.fillStyle="#FFF"),r.shadowColor=b,r.shadowBlur=p,Ff(r,[[S,T],[w,T],[w,R],[a-M,R],[a-M,s+M],[o+M,s+M],[o+M,n-M],[a-M,n-M],[a-M,R],[S,R],[S,T]])):(Ff(r,E),r.clip(),r.closePath(),r.beginPath(),"#FFF"!==r.fillStyle&&(r.fillStyle="#FFF"),r.shadowOffsetX=v,r.shadowOffsetY=d,r.shadowColor=b,r.shadowBlur=p,Ff(r,[[a,n],[o,n],[o,s],[a-M,s],[a-M,s+M],[o+M,s+M],[o+M,n-M],[a-M,n-M],[a-M,s],[a,s],[a,n]]))}else{var O=a+v-x,I=n+d-x,F=o+v+x,L=s+d+x,D=[[O,I],[F,I],[F,L],[O,L]],B=Ut.getRectsIntersection([E[0][0],E[0][1],E[2][0],E[2][1]],[D[0][0],D[0][1],D[2][0],D[2][1]]);x?(Ff(r,E),Ff(r,D.slice(0).reverse()),r.clip(),r.closePath(),r.beginPath(),r.fillStyle!==b&&(r.fillStyle=b),Ff(r,D),r.fill(),r.closePath(),r.restore(),r.save(),r.beginPath(),B&&Ff(r,[[B[0],B[1]],[B[2],B[1]],[B[2],B[3]],[B[0],B[3]],[B[0],B[1]]].reverse()),Ff(r,E),Ff(r,D),Ff(r,A),r.clip(),r.closePath(),r.beginPath(),"#FFF"!==r.fillStyle&&(r.fillStyle="#FFF"),r.shadowColor=b,r.shadowBlur=p,Ff(r,D)):(Ff(r,E),Ff(r,A),r.clip(),r.closePath(),r.beginPath(),"#FFF"!==r.fillStyle&&(r.fillStyle="#FFF"),r.shadowOffsetX=v,r.shadowOffsetY=d,r.shadowColor=b,r.shadowBlur=p,Ff(r,E))}r.fill(),r.closePath(),r.restore()}else if(e===y.SVG){var P=Ki.outerSize(p);if("inset"===m){var N=a+v+x,G=n+d+x,H=o+v-x,W=s+d-x,Y=[[N,G],[H,G],[H,W],[N,W]],z=Ut.getRectsIntersection([E[0][0],E[0][1],E[2][0],E[2][1]],[Y[0][0],Y[0][1],Y[2][0],Y[2][1]]);if(!z)return;if(z=[[z[0],z[1]],[z[2],z[1]],[z[2],z[3]],[z[0],z[3]],[z[0],z[1]]],x){var X={tagName:"filter",props:[["x",-P/l],["y",-P/h],["width",1+2*P/l],["height",1+2*P/h]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*p],["flood-color",b]]}]};t.__cacheDefs.push(X);var U=r.add(X),V={tagName:"clipPath",children:[{tagName:"path",props:[["d",Lf(z)+Lf(E.slice(0).reverse())],["fill","#FFF"]]}]},K=r.add(V);t.__cacheDefs.push(V),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Lf(E)],["fill",b],["clip-path","url(#"+K+")"]]}),X={tagName:"clipPath",children:[{tagName:"path",props:[["d",Lf(z)],["fill","#FFF"]]}]},K=r.add(X),t.__cacheDefs.push(X),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Lf([[N,G],[H,G],[H,W],[a-M,W],[a-M,s+M],[o+M,s+M],[o+M,n-M],[a-M,n-M],[a-M,W],[N,W],[N,G]])],["fill","#FFF"],["filter","url(#"+U+")"],["clip-path","url(#"+K+")"]]})}else{var j={tagName:"filter",props:[["x",-P/l],["y",-P/h],["width",1+2*P/l],["height",1+2*P/h]],children:[{tagName:"feDropShadow",props:[["dx",v],["dy",d],["stdDeviation",.5*p],["flood-color",b]]}]},Z=r.add(j);t.__cacheDefs.push(j),j={tagName:"clipPath",children:[{tagName:"path",props:[["d",Lf(E)],["fill","#FFF"]]}]};var q=r.add(j);t.__cacheDefs.push(j),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Lf([[a,n],[o,n],[o,s],[a-M,s],[a-M,s+M],[o+M,s+M],[o+M,n-M],[a-M,n-M],[a-M,s],[a,s],[a,n]])],["fill","#FFF"],["filter","url(#"+Z+")"],["clip-path","url(#"+q+")"]]})}}else{var $=a+v-x,J=n+d-x,Q=o+v+x,tt=s+d+x,et=[[$,J],[Q,J],[Q,tt],[$,tt]],rt=Ut.getRectsIntersection([E[0][0],E[0][1],E[2][0],E[2][1]],[et[0][0],et[0][1],et[2][0],et[2][1]]);if(x){var it={tagName:"filter",props:[["x",-P/l],["y",-P/h],["width",1+2*P/l],["height",1+2*P/h]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*p],["flood-color",b]]}]},at=r.add(it);t.__cacheDefs.push(it),it={tagName:"clipPath",children:[{tagName:"path",props:[["d",Lf(E)+Lf(et.slice(0).reverse())],["fill","#FFF"]]}]};var nt=r.add(it);t.__cacheDefs.push(it),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Lf(et)],["fill",b],["clip-path","url(#"+nt+")"]]}),it={tagName:"clipPath",children:[{tagName:"path",props:[["d",(rt?Lf([[rt[0],rt[1]],[rt[2],rt[1]],[rt[2],rt[3]],[rt[0],rt[3]],[rt[0],rt[1]]].reverse()):"")+Lf(E)+Lf(et)+Lf(A)],["fill","#FFF"]]}]},nt=r.add(it),t.__cacheDefs.push(it),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Lf(et)],["fill","#FFF"],["filter","url(#"+at+")"],["clip-path","url(#"+nt+")"]]})}else{var ot={tagName:"filter",props:[["x",-P/l],["y",-P/h],["width",1+2*P/l],["height",1+2*P/h]],children:[{tagName:"feDropShadow",props:[["dx",v],["dy",d],["stdDeviation",.5*p],["flood-color",b]]}]},st=r.add(ot);t.__cacheDefs.push(ot),ot={tagName:"clipPath",children:[{tagName:"path",props:[["d",Lf(E)+Lf(A)],["fill","#FFF"]]}]};var lt=r.add(ot);t.__cacheDefs.push(ot),t.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Lf(E)],["fill","#FFF"],["filter","url(#"+st+")"],["clip-path","url(#"+lt+")"]]})}}}}},Bf={};var Pf=function(t){if(t)return Bf.hasOwnProperty(t)?Bf[t]:Bf[t]=t.replace(/[A-Z]/,(function(t){return"-"+t.toLowerCase()}))},Nf=function(t){return"normal"!==t&&("multiply"===t||"screen"===t||"overlay"===t||"darken"===t||"lighten"===t||"colorDodge"===t||"color-dodge"===t||"colorBurn"===t||"color-burn"===t||"hardLight"===t||"hard-light"===t||"softLight"===t||"soft-light"===t||"difference"===t||"exclusion"===t||"hue"===t||"saturation"===t||"color"===t||"luminosity"===t)},Gf=Zt.svgPolygon,Hf=y.CANVAS,Wf=y.SVG,Yf=y.WEBGL,zf=Ln.normalize,Xf=Ln.equalStyle,Uf=Ct.STYLE_KEY,Vf=Ct.STYLE_RV_KEY,Kf=Ct.style2Upper,jf=Ct.STYLE_KEY,Zf=jf.BORDER_TOP_LEFT_RADIUS,qf=jf.BORDER_TOP_RIGHT_RADIUS,$f=jf.BORDER_BOTTOM_LEFT_RADIUS,Jf=jf.BORDER_BOTTOM_RIGHT_RADIUS,Qf=jf.PADDING_LEFT,t_=jf.PADDING_RIGHT,e_=jf.PADDING_TOP,r_=jf.PADDING_BOTTOM,i_=jf.MARGIN_LEFT,a_=jf.MARGIN_TOP,n_=jf.MARGIN_BOTTOM,o_=jf.MARGIN_RIGHT,s_=jf.BORDER_LEFT_WIDTH,l_=jf.BORDER_TOP_WIDTH,h_=jf.BORDER_BOTTOM_WIDTH,u_=jf.BORDER_RIGHT_WIDTH,c_=jf.TOP,f_=jf.RIGHT,__=jf.BOTTOM,v_=jf.LEFT,y_=jf.POSITION,d_=jf.DISPLAY,p_=jf.WIDTH,x_=jf.HEIGHT,g_=jf.MATRIX,m_=jf.TRANSLATE_X,b_=jf.TRANSLATE_Y,M_=jf.TRANSLATE_Z,E_=jf.TRANSFORM,A_=jf.SCALE_X,S_=jf.SCALE_Y,T_=jf.SCALE_Z,w_=jf.ROTATE_X,R_=jf.ROTATE_Y,k_=jf.ROTATE_Z,C_=jf.SKEW_X,O_=jf.SKEW_Y,I_=jf.PERSPECTIVE,F_=jf.PERSPECTIVE_ORIGIN,L_=jf.ROTATE_3D,D_=jf.TRANSFORM_ORIGIN,B_=jf.BACKGROUND_POSITION_X,P_=jf.BACKGROUND_POSITION_Y,N_=jf.BACKGROUND_SIZE,G_=jf.BACKGROUND_COLOR,H_=jf.BACKGROUND_IMAGE,W_=jf.BACKGROUND_REPEAT,Y_=jf.BOX_SHADOW,z_=jf.OPACITY,X_=jf.Z_INDEX,U_=jf.BORDER_TOP_STYLE,V_=jf.BORDER_RIGHT_STYLE,K_=jf.BORDER_BOTTOM_STYLE,j_=jf.BORDER_LEFT_STYLE,Z_=jf.FILTER,q_=jf.OVERFLOW,$_=jf.MIX_BLEND_MODE,J_=jf.TEXT_OVERFLOW,Q_=jf.BORDER_TOP_COLOR,tv=jf.BORDER_BOTTOM_COLOR,ev=jf.BORDER_LEFT_COLOR,rv=jf.BORDER_RIGHT_COLOR,iv=jf.FONT_STYLE,av=jf.COLOR,nv=jf.VISIBILITY,ov=jf.POINTER_EVENTS,sv=jf.BORDER_TOP,lv=jf.BORDER_RIGHT,hv=jf.BORDER_BOTTOM,uv=jf.BORDER_LEFT,cv=jf.BACKGROUND_CLIP,fv=jf.FONT_SIZE,_v=jf.FONT_FAMILY,vv=jf.LINE_HEIGHT,yv=jf.TEXT_STROKE_COLOR,dv=jf.TEXT_STROKE_WIDTH,pv=jf.TEXT_STROKE_OVER,xv=jf.FONT_WEIGHT,gv=jf.FLEX_DIRECTION,mv=jf.JUSTIFY_CONTENT,bv=jf.ALIGN_ITEMS,Mv=jf.ALIGN_SELF,Ev=jf.FLEX_GROW,Av=jf.FLEX_SHRINK,Sv=jf.LINE_CLAMP,Tv=jf.ORDER,wv=jf.FLEX_WRAP,Rv=jf.ALIGN_CONTENT,kv=jf.TEXT_ALIGN,Cv=jf.LETTER_SPACING,Ov=jf.WHITE_SPACE,Iv=jf.WRITING_MODE,Fv=d.AUTO,Lv=d.PX,Dv=d.PERCENT,Bv=d.INHERIT,Pv=d.NUMBER,Nv=d.RGBA,Gv=d.STRING,Hv=d.REM,Wv=d.VW,Yv=d.VH,zv=d.VMAX,Xv=d.VMIN,Uv=d.DEG,Vv=d.GRADIENT,Kv=G.int2rgba,jv=G.rgba2int,Zv=G.joinArr,qv=G.isNil,$v=G.isFunction,Jv=Ln.calRelative,Qv=Ln.calNormalLineHeight,ty=Ln.calFontFamily,ey=Ln.spreadBoxShadow,ry=Ln.spreadFilter,iy=Xi.GEOM,ay=Pf,ny=Nf,oy=g.point2d,sy=g.multiply,ly=g.multiplyRotateX,hy=g.multiplyRotateY,uy=g.multiplyRotateZ,cy=g.multiplySkewX,fy=g.multiplySkewY,_y=g.multiplyScaleX,vy=g.multiplyScaleY,yy=g.multiplyScaleZ,dy=Xl.contain,py=Xl.TRANSFORM,xy=Xl.REFLOW,gy=Xl.REPAINT,my=Xl.TRANSLATE_X,by=Xl.TRANSLATE_Y,My=Xl.TRANSLATE_Z,Ey=Xl.ROTATE_Z,Ay=Xl.SCALE_X,Sy=Xl.SCALE_Y,Ty=Xl.SCALE_Z,wy=Xl.SCALE,Ry=Xl.TRANSFORM_ALL,ky=Xl.CACHE,Cy=Ut.d2r,Oy=Ws.calRotateX,Iy=Ws.calRotateY,Fy=Ws.calRotateZ,Ly=Ws.calRotate3d;function Dy(t){for(var e=0,r=t.flowChildren,i=r.length,a=0;a<i;a++){var n=r[a];if(!(n instanceof Py||n instanceof Bh&&n.shadowRoot instanceof Py))break;if(n.flowChildren&&n.flowChildren.length){e+=Dy(n);break}n.__isInline&&(e+=n.outerWidth)}return e}function By(t){for(var e=0,r=t.flowChildren,i=r.length-1;i>=0;i--){var a=r[i];if(!(a instanceof Py||a instanceof Bh&&a.shadowRoot instanceof Py))break;if(a.flowChildren&&a.flowChildren.length){e+=By(a);break}e+=a.outerWidth}return e}var Py=function(e){function i(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=e.call(this)||this,Array.isArray(i)?r.props=G.arr2hash(i):r.props=i,r.__tagName=t,r.__style=r.props.style||{},r.__currentStyle=[],r.__computedStyle=[],r.__listener={},Object.keys(r.props).forEach((function(t){var e=r.props[t];/^on[a-zA-Z]/.test(t)&&(t=t.slice(2).toLowerCase(),r.listener[t]=e)})),r.__animationList=[],r.__loadBgi={cb:function(){}},r.__cacheStyle=[],r.__cacheDefs=[];var a=r.__isClip=!!r.props.clip;return r.__isMask=a||!!r.props.mask,r.__refreshLevel=xy,r.__limitCache=!1,r.__isInline=!1,r.__hasContent=!1,r.__opacity=1,r.__matrix=[],r.__matrixEvent=[],r.__perspectiveMatrix=[],r.__frameAnimateList=[],r.__contentBoxList=[],r.__cacheAsBitmap=!!r.props.cacheAsBitmap,r.__cache=r.__cacheTotal=r.__cacheFilter=r.__cacheMask=r.__cacheOverflow=null,r.__layoutData=null,r.__hasComputeReflow=!1,r.__parentLineBox=null,r.__fontRegister={},r}return a(i,e),r(i,[{key:"__structure",value:function(t,e){var r=h(n(i.prototype),"__structure",this).call(this,t,e);return this.__hasMask&&(r.hasMask=this.__hasMask),r}},{key:"__modifyStruct",value:function(){}},{key:"__mp",value:function(t,e,r){var i=this;["Top","Right","Bottom","Left"].forEach((function(a){var n=Uf[Kf("margin"+a)],o=Uf[Kf("padding"+a)];e[n]=i.__calSize(t[n],r,!0),e[o]=i.__calSize(t[o],r,!0)}))}},{key:"__calSize",value:function(t,e,r){if(t.u===Lv)return t.v;if(t.u===Dv){if(r)return t.v*e*.01}else{if(t.u===Hv||t.u===Hv)return t.v*this.__root.computedStyle[fv];if(t.u===Wv)return t.v*this.__root.width*.01;if(t.u===Yv)return t.v*this.__root.height*.01;if(t.u===zv)return t.v*Math.max(this.__root.width,this.__root.height)*.01;if(t.u===Xv)return t.v*Math.min(this.__root.width,this.__root.height)*.01}return 0}},{key:"__computeReflow",value:function(){var t=this;if(!this.__hasComputeReflow){this.__hasComputeReflow=!0;var e=this.__currentStyle,r=this.__computedStyle,i=this.__domParent,a=!i,n=i&&i.__computedStyle;[fv,_v,xv,Iv].forEach((function(i){var o=e[i];if(i===_v)if(o.u===Bv)r[i]=a?mt.INHERIT[Vf[i]]:n[i];else{r[i]=o.v;for(var s=o.v.split(/\s*,\s*/),l=0,h=s.length;l<h;l++){var u=s[l].replace(/^['"]/,"").replace(/['"]$/,"");if(ct.hasRegister(u)&&(ct.hasLoaded(u)||lt.checkSupportFontFamily(u)))break;t.__fontRegister[u]=!0,ct.onRegister(u,t)}}else o.u===Bv?r[i]=a?mt.INHERIT[Vf[i]]:n[i]:o.u===Dv?r[i]=a?mt.INHERIT[Vf[i]]:n[i]*o.v*.01:o.u===Hv?r[i]=a?mt.INHERIT[Vf[i]]:t.root.computedStyle[fv]*o.v:o.u===Wv?r[i]=a?mt.INHERIT[Vf[i]]:.01*t.root.width*o.v:o.u===Yv?r[i]=a?mt.INHERIT[Vf[i]]:.01*t.root.height*o.v:o.u===zv?r[i]=a?mt.INHERIT[Vf[i]]:.01*Math.max(t.root.width,t.root.height)*o.v:o.u===Xv?r[i]=a?mt.INHERIT[Vf[i]]:.01*Math.min(t.root.width,t.root.height)*o.v:r[i]=o.v})),[l_,u_,h_,s_].forEach((function(i){var a=e[i];r[i]=t.__calSize(a,0,!1)})),[y_,d_,gv,mv,bv,Mv,Ev,Av,Sv,Tv,wv,Rv,q_,J_].forEach((function(t){r[t]=e[t]})),n&&r[Iv]!==n[Iv]&&"inline"===r[d_]&&(r[d_]="inlineBlock"),("absolute"===r[y_]||n&&"flex"===n[d_])&&-1===["block","flex"].indexOf(r[d_])&&(r[d_]="block");var o=e[kv];o.u===Bv?r[kv]=a?"left":n[kv]:r[kv]=o.v;var s=r[fv],l=e[vv];if(l.u===Bv)if(a)r[vv]=Qv(r);else{for(var h,u=i;u&&(h=u.currentStyle[vv]).u===Bv;)u=u.domParent;[Fv,Bv].indexOf(h.u)>-1?r[vv]=Qv(r):h.u===Pv?r[vv]=Math.max(h.v,0)*s:r[vv]=n[vv]}else if(l.u===Pv)r[vv]=Math.max(l.v,0)*s||Qv(r);else{var c=Math.max(this.__calSize(l,s,!0),0);r[vv]=c||Qv(r)}var f=e[Cv];f.u===Bv?r[Cv]=a?0:n[Cv]:r[Cv]=this.__calSize(f,s,!0);var _=e[Ov];_.u===Bv?r[Ov]=a?"normal":n[Ov]:r[Ov]=_.v;var v=e[p_],y=e[x_];if(this.__width=this.__height=0,v.u!==Fv&&(this.__width=r[p_]=this.__calSize(v,a?this.__width:i.__width,!0)),y.u!==Fv)this.__height=r[x_]=this.__calSize(y,a?this.__height:i.__height,!0);else if(u=this.__domParent){var d=u.__currentStyle,p=e[Mv];"flex"===d[d_]&&u.__height&&d[gv].indexOf("row")>-1&&("stretch"===p||"stretch"===d[bv]&&"auto"===p)&&(this.__height=u.__height)}}}},{key:"__emitFontRegister",value:function(t){var e=this,r=e.__fontRegister;if(!e.__isDestroyed){delete r[t];var i=e.root,a=e.currentStyle;if(i){var n=a[_v];if(n.u!==Bv)for(var o=n.v.split(/\s*,\s*/),s=0,l=o.length;s<l;s++){var h=o[s].replace(/^['"]/,"").replace(/['"]$/,"");if(h===t)return void(ct.hasRegister(h)&&i.__addUpdate(e,{focus:Xl.REFLOW}));if(ct.hasRegister(h)&&(ct.hasLoaded(h)||lt.checkSupportFontFamily(h)))return}}}}},{key:"__ioSize",value:function(t,e){var r=this.computedStyle;qv(t)||(this.__width=r[p_]=t,this.__clientWidth=t+=r[Qf]+r[t_],this.__offsetWidth=t+=r[s_]+r[u_],this.__outerWidth=t+r[i_]+r[o_]),qv(e)||(this.__height=r[x_]=e,this.__clientHeight=e+=r[e_]+r[r_],this.__offsetHeight=e+=r[l_]+r[h_],this.__outerHeight=e+r[a_]+r[n_])}},{key:"__addMBP",value:function(t,e,r,i,a,n){var o=r[i_],s=r[a_],l=r[o_],h=r[n_],u=r[Qf],c=r[e_],f=r[t_],_=r[r_],v=i[l_],y=i[u_],d=i[h_],p=i[s_],x=this.__calSize(o,e,n)+this.__calSize(l,e,n)+this.__calSize(u,e,n)+this.__calSize(f,e,n)+p+y;if(t)a=a.map((function(t){return t+x}));else{var g=this.__calSize(s,e,n)+this.__calSize(h,e,n)+this.__calSize(c,e,n)+this.__calSize(_,e,n)+v+d;a=a.map((function(t){return t+g}))}return a}},{key:"__layout",value:function(t,e,r,i){this.__layoutFlow(t,e,r,i)}},{key:"__layoutFlow",value:function(t,e,r,i){this.__computeReflow();var a=this.__isDestroyed,n=this.__currentStyle,o=this.__computedStyle;this.__ellipsis&&(this.__ellipsis=null),this.__parentLineBox=null,this.__isIbFull=this.__isUprightIbFull=!1;var s=o[d_],l=o[y_];if(this.__layoutData={x:t.x,y:t.y,w:t.w,h:t.h,lx:t.lx,ly:t.ly,isUpright:t.isUpright,container:t.container},!e&&!r&&!i){this.clearCache(),this.__cacheStyle=[],this.__refreshLevel=xy,this.__limitCache=!1,this.__isInline=!1;var h=this.next;if(!this.__isMask&&h&&h.__isMask){for(var u=0;h&&h.__isMask;)u++,h=h.next;this.__hasMask=u}}if(this.__ox=this.__oy=0,a||"none"===s)return this.__x=t.x,this.__y=t.y,this.__layoutNone(),void(this.__hasComputeReflow=!1);"absolute"!==l&&this.__mp(n,o,t.w);var c=t.lineClampCount||0;if("flex"===s?(t.lineClampCount=0,this.__layoutFlex(t,e,r,i)):"inlineBlock"===s?(t.lineClampCount=0,this.__layoutInline(t,e,r,i)):"inline"===s?c=this.__layoutInline(t,e,r,i,!0):(t.lineClampCount=0,this.__layoutBlock(t,e,r,i)),!e&&!r&&!i){if("relative"===l){var f=n[c_],_=n[f_],v=n[__],y=n[v_],d=this.parent;if(f.u!==Fv){var p=Jv(n,c_,f,d);this.__offsetY(p,!1,null),o[c_]=p,o[__]="auto"}else if(v.u!==Fv){var x=Jv(n,__,v,d);this.__offsetY(-x,!1,null),o[__]=x,o[c_]="auto"}else o[c_]=o[__]="auto";if(y.u!==Fv){var g=Jv(n,v_,y,d,!0);this.__offsetX(g,!1,null),o[v_]=g,o[f_]="auto"}else if(_.u!==Fv){var m=Jv(n,f_,_,d,!0);this.__offsetX(-m,!1,null),o[f_]=m,o[v_]="auto"}else o[v_]=o[f_]="auto"}else"absolute"!==l&&(o[c_]=o[__]=o[v_]=o[f_]="auto");var b=this.__sx=this.__x+this.__ox,M=this.__sy=this.__y+this.__oy;this.__isInline||(b=this.__sx1=b+o[i_],b=this.__sx2=b+o[s_],b=this.__sx3=b+o[Qf],b=this.__sx4=b+this.__width,b=this.__sx5=b+o[t_],this.__sx6=b+o[u_],M=this.__sy1=M+o[a_],M=this.__sy2=M+o[l_],M=this.__sy3=M+o[e_],M=this.__sy4=M+this.__height,M=this.__sy5=M+o[r_],this.__sy6=M+o[h_]),o[p_]=this.__width,o[x_]=this.__height,"absolute"!==l&&this.__execAr(),this.__hasComputeReflow=!1}return c}},{key:"__layoutStyle",value:function(){var t=this.__currentStyle,e=this.__computedStyle,r=this.__cacheStyle;this.__calStyle(Xl.REFLOW,t,e,r),this.__calPerspective(t,e,r)}},{key:"__execAr",value:function(){var t=this.__animateRecords;if(t){this.__animateRecords=null,t.list.forEach((function(t){t.target.vd instanceof i&&(t.target=t.target.vd)}));var e=t.controller||this.root.animateController;t.options&&!1===t.options.autoPlay?(e.__records2=e.__records2.concat(t.list),e.init(e.__records2,e.list2)):(e.__records=e.__records.concat(t.list),e.__playAuto())}}},{key:"__layoutNone",value:function(){this.__computeReflow(),this.__computedStyle[d_]="none",this.__reset0(),this.__hasComputeReflow=!1}},{key:"__reset0",value:function(){var t=this.__computedStyle;t[a_]=t[o_]=t[n_]=t[i_]=t[l_]=t[u_]=t[h_]=t[s_]=t[e_]=t[t_]=t[r_]=t[Qf]=t[p_]=t[x_]=this.__width=this.__height=this.__clientWidth=this.__clientHeight=this.__offsetWidth=this.__offsetHeight=this.__outerWidth=this.__outerHeight=0}},{key:"__preLayout",value:function(t,e){var r=t.x,i=t.y,a=t.w,n=t.h,o=t.w2,s=t.h2,l=t.w3,h=t.h3,u=t.lx,c=t.ly,f=t.lineBoxManager,_=t.endSpace,v=void 0===_?0:_,y=t.isUpright,d=t.container;this.__x=r,this.__y=i;var p,x,g=this.currentStyle,m=this.computedStyle,b=g[p_],M=g[x_],E=m[y_],A=m[l_],S=m[u_],T=m[h_],w=m[s_],R=m[a_],k=m[o_],C=m[n_],O=m[i_],I=m[e_],F=m[t_],L=m[r_],D=m[Qf],B=0===m[Iv].indexOf("vertical");if(void 0!==o?(p=!0,a=o):void 0!==l?(p=!0,a=l):b.u===Fv||e||(p=!0,a="absolute"===E&&b.u===Dv?this.__calSize(b,d.__clientWidth,!0):this.__calSize(b,a,!0)),void 0!==s)x=!0,n=s;else if(void 0!==h)x=!0,n=h;else if(M.u!==Fv&&!e)if("absolute"===E&&M.u===Dv)n=this.__calSize(M,d.__clientHeight,!0);else{var P=this.__domParent;M.u===Dv?P.height&&(x=!0,n=this.__calSize(M,P.height||0,!0)):(x=!0,n=this.__calSize(M,n,!0))}e?B?i+=A+R+I:r+=w+O+D:(r+=w+O+D,i+=A+R+I),t.x=r,t.y=i;var N=0;return e&&(N=B?L+T+C:F+S+k),e||(b.u!==Fv&&void 0===l||(a-=w+S+O+k+D+F),M.u!==Fv&&void 0===h||(n-=A+T+R+C+I+L)),{fixedWidth:p,fixedHeight:x,x:r,y:i,w:a,h:n,lx:u,ly:c,lineBoxManager:f,endSpace:v,selfEndSpace:N,isParentVertical:y,isUpright:B}}},{key:"__marginAuto",value:function(t,e,r){var i=t[y_],a=t[d_],n=t[a_],o=t[n_],s=t[i_],l=t[o_],h=t[p_],u=t[x_];if("absolute"!==i&&("block"===a||"flex"===a))if(r){if((u.u!==Fv||this.isReplaced)&&n.u===Fv&&o.u===Fv){var c=this.outerHeight;c<e.h&&this.__offsetY(.5*(e.h-c),!0,null)}}else if((h.u!==Fv||this.isReplaced)&&s.u===Fv&&l.u===Fv){var f=this.outerWidth;f<e.w&&this.__offsetX(.5*(e.w-f),!0,null)}}},{key:"__calMatrix",value:function(t,e,r,i){var a=this,n=this.__sx1,o=this.__sy1,s=this.__offsetWidth,l=this.__offsetHeight;if(this.__isInline)return r[D_]=[n,o],i[g_]=this.__matrix=g.identity();var h,c=i[g_];if(c&&t<xy&&!dy(t,py)&&(dy(t,Ay)&&!r[A_]||dy(t,Sy)&&!r[S_]||dy(t,Ty)&&!r[T_]||dy(t,Ey)&&(r[w_]||r[R_]||r[C_]||r[O_])||(h=!0)),h){var f=r[E_];if(dy(t,my)){var _=e[m_],v=(_=_?_.u===Lv?_.v:this.__calSize(_,this.__offsetWidth,!0):0)-r[m_];r[m_]=_,f[12]+=v,c[12]+=v}if(dy(t,by)){var y=e[b_],d=(y=y?y.u===Lv?y.v:this.__calSize(y,this.__offsetHeight,!0):0)-r[b_];r[b_]=y,f[13]+=d,c[13]+=d}if(dy(t,My)){var p=e[M_],x=(p=p?p.u===Lv?p.v:this.__calSize(p,this.__offsetWidth,!0):0)-r[M_];r[M_]=p,f[14]+=x,c[14]+=x}if(dy(t,Ey)){var m=e[k_].v;r[k_]=m,m=Cy(m);var b=Math.sin(m),M=Math.cos(m),E=r[A_],A=r[S_],S=c[0]=f[0]=M*E,T=c[1]=f[1]=b*E,w=c[4]=f[4]=-b*A,R=c[5]=f[5]=M*A,k=u(r[D_],2),C=k[0],O=k[1];C+=n,O+=o,c[12]=f[12]+C-S*C-O*w,c[13]=f[13]+O-T*C-O*R}if(dy(t,wy)){if(dy(t,Ay)){var I=e[A_].v,F=I/r[A_];r[A_]=I,f[0]*=F,f[1]*=F,f[2]*=F,c[0]*=F,c[1]*=F,c[2]*=F}if(dy(t,Sy)){var L=e[S_].v,D=L/r[S_];r[S_]=L,f[4]*=D,f[5]*=D,f[6]*=D,c[4]*=D,c[5]*=D,c[6]*=D}if(dy(t,Ty)){var B=e[T_].v,P=B/r[T_];r[T_]=B,f[8]*=P,f[9]*=P,f[10]*=P,c[8]*=P,c[9]*=P,c[10]*=P}var N=u(r[D_],2),G=N[0],H=N[1];G+=n,H+=o,c[12]=f[12]+G-f[0]*G-f[4]*H,c[13]=f[13]+H-f[1]*G-f[5]*H,c[14]=f[14]-f[2]*G-f[6]*H}}else if(void 0===i[D_]&&(i[D_]=!0,c=null,r[D_]=e[D_].map((function(t,e){return a.__calSize(t,e?l:s,!0)}))),void 0===i[E_]||void 0===i[m_]||void 0===i[b_]||void 0===i[M_]||void 0===i[w_]||void 0===i[R_]||void 0===i[k_]||void 0===i[L_]||void 0===i[A_]||void 0===i[S_]||void 0===i[T_]||void 0===i[C_]||void 0===i[O_]){var W;if(i[E_]=i[m_]=i[b_]=i[M_]=i[w_]=i[R_]=i[k_]=i[A_]=i[S_]=i[T_]=i[C_]=i[O_]=!0,c=null,e[E_]&&e[E_].length)W=Ws.calMatrix(e[E_],s,l,this.__root);else{r[m_]=0;var Y=e[m_];Y&&(Y=r[m_]=this.__calSize(Y,this.__offsetWidth,!0))&&((W=W||g.identity())[12]=Y),r[b_]=0,(Y=e[b_])&&(Y=r[b_]=this.__calSize(Y,this.__offsetHeight,!0))&&((W=W||g.identity())[13]=Y),r[M_]=0,(Y=e[M_])&&(Y=r[M_]=this.__calSize(Y,this.__offsetWidth,!0))&&((W=W||g.identity())[14]=Y),r[w_]=0,(Y=e[w_])&&(Y=r[w_]=Y.v)&&(W=(W=W||g.identity())?ly(W,Cy(Y)):Oy(g.identity(),Y)),r[R_]=0,(Y=e[R_])&&(Y=r[R_]=Y.v)&&(W=W?hy(W,Cy(Y)):Iy(g.identity(),Y)),r[k_]=0,(Y=e[k_])&&(Y=r[k_]=Y.v)&&(W=W?uy(W,Cy(Y)):Fy(g.identity(),Y)),r[L_]=[0,0,0,0],(Y=e[L_])&&((Y=r[L_]=[Y[0],Y[1],Y[2],Y[3].v])[0]||Y[1]||Y[2])&&Y[3]&&(W=W?sy(W,Ly(g.identity(),Y)):Ly(g.identity(),Y)),r[C_]=0,(Y=e[C_])&&(Y=r[C_]=Y.v)&&(W?W=cy(W,Cy(Y)):(W=g.identity())[4]=Math.tan(Cy(Y))),r[O_]=0,(Y=e[O_])&&(Y=r[O_]=Y.v)&&(W?W=fy(W,Cy(Y)):(W=g.identity())[1]=Math.tan(Cy(Y))),r[A_]=1,(Y=e[A_])&&1!==(Y=r[A_]=Y.v)&&(W?W=_y(W,Y):(W=g.identity())[0]=Y),r[S_]=1,(Y=e[S_])&&1!==(Y=r[S_]=Y.v)&&(W?W=vy(W,Y):(W=g.identity())[5]=Y),r[T_]=1,(Y=e[T_])&&1!==(Y=r[T_]=Y.v)&&(W?W=yy(W,Y):(W=g.identity())[10]=Y)}r[E_]=W||g.identity()}if(!c){var z=r[E_],X=r[D_];c=i[g_]=Ws.calMatrixByOrigin(z,X[0]+n,X[1]+o)}return this.__matrix=c}},{key:"__calStyle",value:function(t,e,r,i){var a=this,n=this.__sx1,o=this.__sx2,s=this.__sx3,l=this.__sx4,h=this.__sx5,u=this.__sx6,c=this.__sy1,f=this.__sy2,_=this.__sy3,v=this.__sy4,y=this.__sy5,d=this.__sy6;this.__bbox=null;var p=n,x=c,g=u,m=d,b=r[cv]=e[cv];"paddingBox"===b?(p=o,x=f,g=h,m=y):"contentBox"===b&&(p=s,x=_,g=l,m=v);var M=this.__isInline;if(M&&!this.__contentBoxList.length&&(M=!1),[z_,X_,U_,V_,K_,j_,W_,q_,$_,J_,cv].forEach((function(t){r[t]=e[t]})),qv(i[Z_])&&this.__calFilter(e,r,i),(qv(i[g_])||dy(t,Ry))&&this.__calMatrix(t,e,r,i),qv(i[B_])){i[B_]=!0;var E=e[B_];r[B_]=(E||[]).map((function(t){return t.u===Dv?t.v+"%":a.__calSize(t,g-p,!0)}))}if(qv(i[P_])){i[P_]=!0;var A=e[P_];r[P_]=(A||[]).map((function(t){return t.u===Dv?t.v+"%":a.__calSize(t,m-x,!0)}))}if(qv(i[N_])&&(i[N_]=!0,r[N_]=(e[N_]||[]).map((function(t){if(Array.isArray(t))return t.map((function(t,e){return t.u===Fv?-1:t.u===Gv?"contain"===t.v?-2:-3:a.__calSize(t,e?m-x:g-p,!0)}))}))),qv(i[H_])){var S=e[H_];r[H_]=S.map((function(t){return t?t.v:null})),i[H_]=S.map((function(t,e){if(!t)return null;if(t.u===Gv){var r=a.__loadBgi[e]=a.__loadBgi[e]||{},n=lt.IMG[t.v];if(n&&n.state===lt.LOADED)r.url=t.v,r.source=n.source,r.width=n.width,r.height=n.height;else if(r.url!==t.v){r.url=t.v,r.source=null;var o=a,s=a.__root,l=a.ctx;lt.measureImg(t.v,(function(t){t.success&&t.url===r.url&&!a.isDestroyed&&(r.source=t.source,r.width=t.width,r.height=t.height,i[H_]=void 0,s.__addUpdate(o,{focus:gy}))}),{ctx:l,root:s,width:g-p,height:m-x})}return!0}return!(M||!t.v||t.u!==Vv)||void 0}))}qv(i[Y_])&&(i[Y_]=!0,r[Y_]=(e[Y_]||[]).map((function(t){return t.map((function(t,e){return e>3?t:a.__calSize(t,0===e?g-p:m-x,!0)}))}))),[G_,Q_,rv,tv,ev].forEach((function(t){qv(i[t])&&(i[t]=Kv(r[t]=e[t].v))})),(qv(i[Zf])||qv(i[qf])||qv(i[Jf])||qv(i[$f]))&&(i[Zf]=i[qf]=i[Jf]=i[$f]=!0,M?Le.calBorderRadiusInline(this.__contentBoxList,e,r,this.__root):Le.calBorderRadius(this.__offsetWidth,this.__offsetHeight,e,r,this.__root));var T=r[Zf],w=r[qf],R=r[Jf],k=r[$f],C=r[l_],O=r[u_],I=r[h_],F=r[s_];["Top","Right","Bottom","Left"].forEach((function(t){var e=Uf[Kf(t="border"+t)],a=Uf[Kf(t+"Width")],s=Uf[Kf(t+"Style")];if(qv(i[a])&&(i[a]=!0,i[e]=void 0),qv(i[s])&&(i[s]=!0,i[e]=void 0),qv(i[e]))if(e===sv)if(C>0){if(!M){var l=Math.atan(C/F),_=Math.atan(C/O);i[e]=Le.calPoints(C,r[s],l,_,n,o,h,u,c,f,y,d,0,T,w)}}else i[e]=[];else if(e===lv)if(O>0){if(!M){var v=Math.atan(O/C),p=Math.atan(O/I);i[e]=Le.calPoints(O,r[s],v,p,n,o,h,u,c,f,y,d,1,w,R)}}else i[e]=[];else if(e===hv)if(I>0){if(!M){var x=Math.atan(I/F),g=Math.atan(I/O);i[e]=Le.calPoints(I,r[s],x,g,n,o,h,u,c,f,y,d,2,k,R)}}else i[e]=[];else if(e===uv)if(F>0){if(!M){var m=Math.atan(F/C),b=Math.atan(F/I);i[e]=Le.calPoints(F,r[s],m,b,n,o,h,u,c,f,y,d,3,T,k)}}else i[e]=[]}));var L=this.__domParent,D=L&&L.__computedStyle;e[iv].u===Bv?r[iv]=L?D[iv]:"normal":qv(i[iv])&&(r[iv]=e[iv].v),i[iv]=r[iv];var B=e[av];if(B.u===Bv){var P=r[av]=L?D[av]:jv(mt.INHERIT.color);P.k?i[av]=P:i[av]=Kv(r[av])}else qv(i[av])&&(B.u===Vv?i[av]=r[av]=B.v:i[av]=Kv(r[av]=jv(B.v)));var N=e[yv];if(N.u===Bv){var G=r[yv]=L?D[yv]:jv(mt.INHERIT.textStrokeColor);G.k?i[yv]=G:i[yv]=Kv(r[yv])}else qv(i[yv])&&(N.u===Vv?i[yv]=r[yv]=N.v:N.u===Nv&&(i[yv]=Kv(r[yv]=jv(N.v))));if(e[dv].u===Bv)r[dv]=L?D[dv]:mt.INHERIT.textStrokeWidth,i[dv]=!0;else if(qv(i[dv])){var H=e[dv];H=H.u===Hv?H.v*this.__root.__computedStyle[fv]:H.u===Wv?H.v*this.__root.width*.01:H.u===Yv?H.v*this.__root.height*.01:H.u===zv?H.v*Math.max(this.__root.width,this.__root.height)*.01:H.u===Xv?H.v*Math.min(this.__root.width,this.__root.height)*.01:H.v,r[dv]=H,i[dv]=!0}return e[pv].u===Bv?i[pv]=r[pv]=L?D[pv]:mt.INHERIT.textStrokeOver:i[pv]=r[pv]=e[pv].v,e[nv].u===Bv?r[nv]=L?D[nv]:"visible":qv(i[nv])&&(r[nv]=e[nv].v),i[nv]=r[nv],e[ov].u===Bv?r[ov]=L?D[ov]:"auto":qv(i[ov])&&(r[ov]=e[ov].v),i[ov]=r[ov],this.__bx1=p,this.__bx2=g,this.__by1=x,this.__by2=m,[p,x,g,m]}},{key:"__calPerspective",value:function(t,e,r){var i,a=this;this.__perspectiveMatrix=null;var n=this.__sx1,o=this.__sy1;if(qv(r[I_])){r[I_]=!0,i=!0;var s=t[I_];e[I_]=this.__calSize(s,this.clientWidth,!0)}qv(r[F_])&&(r[F_]=!0,i=!0,e[F_]=t[F_].map((function(t,e){return a.__calSize(t,e?a.__offsetHeight:a.__offsetWidth,!0)})));var l=e[I_];if(i&&l){var h=e[F_];this.__perspectiveMatrix=Ws.calPerspectiveMatrix(l,h[0]+n,h[1]+o)}return this.__perspectiveMatrix}},{key:"__calFilter",value:function(t,e,r){var i=this;return r[Z_]=!0,this.__filterBbox=null,e[Z_]=(t[Z_]||[]).map((function(t){var e=t.k,r=t.v;return"dropShadow"===e?{k:e,v:r.map((function(t,e){return e>3?t:i.__calSize(t,0===e?i.__bx2-i.__bx1:i.__by2-i.__by1,!0)}))}:{k:e,v:r=r.u===Uv||r.u===Pv||r.u===Dv?r.v:i.__calSize(r,i.root.width,!0)}}))}},{key:"__calOffscreen",value:function(t,e){var r,i,a,n,o=this.__root,s=o.width,l=o.height,h=t,u=e[$_],c=e[Z_],f=e[q_],_=e[d_];if("normal"!==u&&ny(u)){u=ay(u);var v=lt.getCacheCanvas(s,l,null,"blend");r={ctx:t,target:v,mixBlendMode:u},t=v.ctx}if(this.__hasMask){var y=lt.getCacheCanvas(s,l,null,"mask1");i={ctx:t,target:y},t=y.ctx}if(c&&c.length){var d=lt.getCacheCanvas(s,l,null,"filter");a={ctx:t,filter:c,target:d},t=d.ctx}if("hidden"===f&&"inline"!==_){var p=lt.getCacheCanvas(s,l,null,"overflow"),x=this.__bx1,g=this.__bx2,m=this.__by1,b=this.__by2,M=e[Zf],E=e[qf],A=e[Jf],S=e[$f],T=e[cv],w=e[s_],R=e[u_],k=e[l_],C=e[h_],O=e[e_],I=e[t_],F=e[r_],L=e[Qf],D=M.slice(0),B=E.slice(0),P=A.slice(0),N=S.slice(0);"paddingBox"===T?(D[0]-=w,D[1]-=k,B[0]-=R,B[1]-=k,P[0]-=R,P[1]-=C,N[0]-=w,N[1]-=C):"contentBox"===T&&(D[0]-=w+L,D[1]-=k+O,B[0]-=R+I,B[1]-=k+O,P[0]-=R+I,P[1]-=C+F,N[0]-=w+L,N[1]-=C+F);var G=Le.calRadius(x,m,g-x,b-m,D,B,P,N);n={ctx:t,target:p,matrix:this.__matrixEvent,x:this.__sx1,y:this.__sy1,offsetWidth:this.__offsetWidth,offsetHeight:this.__offsetHeight,borderList:G},t=p.ctx}if(h!==t)return{ctx:t,offscreenBlend:r,offscreenMask:i,offscreenFilter:a,offscreenOverflow:n}}},{key:"calContent",value:function(t,e){if("hidden"!==t[nv]){var r=t[H_];if(Array.isArray(r))for(var i=0,a=r.length;i<a;i++)if(r[i])return this.__hasContent=!0;if(t[G_].v[3]>0){var n=e[p_],o=e[x_],s=e[e_],l=e[t_],h=e[r_],u=e[Qf];if(n&&o||s||l||h||u)return this.__hasContent=!0}for(var c=["Top","Right","Bottom","Left"],f=0,_=c.length;f<_;f++){var v=c[f];if(e[Uf[Kf("border"+v+"Width")]]>0&&t[Uf[Kf("border"+v+"Color")]].v[3]>0)return this.__hasContent=!0}var y=t[Y_];if(Array.isArray(y))for(var d=0,p=y.length;d<p;d++){var x=y[d];if(x&&x[4][3]>0)return this.__hasContent=!0}}return this.__hasContent=!1}},{key:"render",value:function(e,r){var i,a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=this.__isDestroyed,l=this.__cacheStyle,h=this.__computedStyle;if(s)return{isDestroyed:s,break:!0};e===Wf&&(i=this.__virtualDom={bb:[],children:[],visibility:"visible"});var c=h[d_];if("none"===c)return{break:!0};if(e===Yf)return{};var f=this.__offsetWidth,_=this.__offsetHeight,v=h[e_],y=h[t_],d=h[r_],p=h[Qf],x=h[s_],m=h[u_],b=h[l_],M=h[h_],E=this.__isInline,A=this.__sx1,S=this.__sx2,T=this.__sx3,w=this.__sx4,R=this.__sx5,k=this.__sx6,C=this.__sy1,O=this.__sy2,I=this.__sy3,F=this.__sy4,L=this.__sy5,D=this.__sy6,B=this.__bx1,P=this.__bx2,N=this.__by1,H=this.__by2,W={ctx:r,dx:n,dy:o,sx1:A,sx2:S,sx3:T,sx4:w,sx5:R,sx6:k,sy1:C,sy2:O,sy3:I,sy4:F,sy5:L,sy6:D,bx1:B,bx2:P,by1:N,by2:H},Y=this.__matrix,z=h[G_],X=h[Q_],U=h[rv],V=h[tv],K=h[ev],j=h[Zf],Z=h[qf],q=h[Jf],$=h[$f],J=h[nv],Q=h[W_],tt=h[H_],et=h[z_],rt=h[Z_],it=h[N_],at=h[Y_],nt=h[q_],ot=h[$_],st=h[cv],ht=h[Iv],ut=0===ht.indexOf("vertical");e===Wf&&(1===et?delete i.opacity:i.opacity=et),e===Wf&&(g.isE(Y)?delete i.transform:i.transform="matrix("+Zv(g.m2m6(Y),",")+")",i.visibility=J),e===Wf&&("normal"!==ot&&ny(ot)?(ot=ay(ot),i.mixBlendMode=ot):delete i.mixBlendMode,rt&&rt.length?i.filter=Zt.svgFilter(rt):delete i.filter);var ft,_t=j.slice(0),vt=Z.slice(0),yt=q.slice(0),dt=$.slice(0);if("paddingBox"===st?(_t[0]-=x,_t[1]-=b,vt[0]-=m,vt[1]-=b,yt[0]-=m,yt[1]-=M,dt[0]-=x,dt[1]-=M):"contentBox"===st&&(_t[0]-=x+p,_t[1]-=b+v,vt[0]-=m+y,vt[1]-=b+v,yt[0]-=m+y,yt[1]-=M+d,dt[0]-=x+p,dt[1]-=M+d),"hidden"===nt&&"inline"!==c){if(ft=Le.calRadius(B,N,P-B,H-N,_t,vt,yt,dt),e===Wf){var pt=Gf(ft)||"M".concat(A,",").concat(C,"L").concat(A+f,",").concat(C,"L").concat(A+f,",").concat(C+_,"L").concat(A,",").concat(C+_,",L").concat(A,",").concat(C),xt={tagName:"clipPath",props:[],children:[{tagName:"path",props:[["d",pt]]}]},gt=r.add(xt);this.__cacheDefs.push(xt),i.overflow="url(#"+gt+")"}}else e===Wf&&delete i.overflow;if(("hidden"===J||W.break)&&(e===Hf||e===Yf))return W.break=!0,W;if(E){var mt=this.contentBoxList,bt=mt.length;mt[bt-1]instanceof gl&&bt--;var Mt=tt.some((function(t){return t}));if(bt){var Et=function(){var t,s=h[fv],c=h[_v],f=h[vv],_=0,g=0,E=[];if(Mt){if(_=qh.getInlineWidth(a,mt,ut),g=f,ut){var A=[g,_];_=A[0],g=A[1]}"paddingBox"===st||"padding-box"===st?ut?(_+=v+d,g+=p+y):(_+=p+y,g+=v+d):"contentBox"!==st&&"content-box"!==st&&(ut?(_+=v+d+b+M,g+=p+y+x+m):(_+=p+y+x+m,g+=v+d+b+M)),e!==Hf&&e!==Yf||(t=lt.getCacheCanvas(_,g,"__$$INLINE_BGI$$__"));var S=tt.length;tt.slice(0).reverse().forEach((function(i,s){if(i)if(s=S-1-s,G.isString(i)){var l=a.__loadBgi[s];if(l.url===i){var u=cu.renderImage(a,e,t&&t.ctx||r,l,0,0,_,g,_t,vt,yt,dt,h,s,it,Q,!0,n,o);e===Wf&&u&&E.push(u)}}else if(i.k){var c=a.__gradient(e,r,0,0,_,g,i,n,o);if(c)if("conic"===c.k)er.renderConic(a,e,t&&t.ctx||r,c.v,0,0,_,f,_t,vt,yt,dt,!0);else{var v=cu.renderBgc(a,e,t&&t.ctx||r,c.v,null,0,0,_,g,_t,vt,yt,dt,"fill",!0);e===Wf&&v&&E.push(v)}}}))}for(var T=s*((ct.info[ty(c)]||{}).lgr||0)*.5,w=ut?Ln.getVerticalBaseline(h):Ln.getBaseline(h),R=!0,k=mt[0],C=k.parentLineBox,O=0,I=0;I<bt;I++){var F=mt[I];F.parentLineBox!==C&&function(){var s=u(qh.getInlineBox(a,ut,mt,k,mt[I-1],C,w,f,T,R,!1,st,v,y,d,p,b,m,M,x),8),c=s[0],A=s[1],S=s[2],L=s[3],D=s[4],B=s[5],P=s[6],N=s[7];if(R){var G=Dy(a);c-=G,D-=G}z[3]>0&&cu.renderBgc(a,e,r,l[G_],null,c,A,S-c,L-A,_t,[0,0],[0,0],dt,"fill",!1,n,o);var H=S-c,W=L-A;if(e!==Hf&&e!==Yf||!t?e===Wf&&E.length&&E.forEach((function(t){if(t){var e={tagName:"clipPath",props:[],children:[{tagName:"path",props:[["d",ut?"M".concat(0,",",O,"L").concat(g,",").concat(O,"L").concat(g,",").concat(W+O,"L",0,",").concat(W+O,",L",0,",").concat(O):"M".concat(O,",",0,"L").concat(H+O,",",0,"L").concat(H+O,",").concat(g,"L").concat(O,",").concat(g,",L").concat(O,",",0)]]}]},n=r.add(e);a.__cacheDefs.push(e),i.bb.push({type:"item",tagName:"use",props:[["xlink:href","#"+t],["x",ut?c:c-O],["y",ut?A-O:A],["clip-path","url(#"+n+")"]]})}})):ut?r.drawImage(t.canvas,0,O,_,W,c+n,A+o,_,W):r.drawImage(t.canvas,O,0,H,g,c+n,A+o,H,g),O+=ut?W:H,at&&at.forEach((function(t){Df.renderBoxShadow(a,e,r,t,D,B,P,N,P-D,N-B,n,o)})),b>0&&X[3]>0){var Y=Math.atan(b/x),U=Math.atan(b/m),j=Le.calPoints(b,h[U_],Y,U,D,D+x,P,P,B,B+b,N-M,N,0,R?_t:[0,0],[0,0]);Le.renderBorder(a,e,r,j,l[Q_],n,o)}if(M>0&&V[3]>0){var Z=Math.atan(M/x),q=Math.atan(M/m),$=Le.calPoints(M,h[K_],Z,q,D,D+x,P,P,B,B+b,N-M,N,2,R?_t:[0,0],[0,0]);Le.renderBorder(a,e,r,$,l[tv],n,o)}if(R&&x>0&&K[3]>0){var J=Math.atan(x/b),Q=Math.atan(x/M),tt=Le.calPoints(x,h[j_],J,Q,D,D+x,P-m,P,B,B+b,N-M,N,3,_t,vt);Le.renderBorder(a,e,r,tt,l[ev],n,o)}R=!1,k=F,C=F.parentLineBox}(),I===bt-1&&function(){var s=u(qh.getInlineBox(a,ut,mt,k,mt[I],C,w,f,T,R,!0,st,v,y,d,p,b,m,M,x),8),c=s[0],A=s[1],S=s[2],F=s[3],L=s[4],D=s[5],B=s[6],P=s[7];if(R){var N=Dy(a);c-=N,L-=N}var G=By(a);S+=G,B+=G,z[3]>0&&cu.renderBgc(a,e,r,l[G_],null,c,A,S-c,F-A,R?_t:[0,0],vt,yt,R?dt:[0,0],"fill",!1,n,o);var H=S-c,W=F-A;if(e!==Hf&&e!==Yf||!t?e===Wf&&E.length&&E.forEach((function(t){if(t){var e={tagName:"clipPath",props:[],children:[{tagName:"path",props:[["d",ut?"M".concat(0,",",O,"L").concat(g,",").concat(O,"L").concat(g,",").concat(W+O,"L",0,",").concat(W+O,",L",0,",").concat(O):"M".concat(O,",",0,"L").concat(H+O,",",0,"L").concat(H+O,",").concat(g,"L").concat(O,",").concat(g,",L").concat(O,",",0)]]}]},n=r.add(e);a.__cacheDefs.push(e),i.bb.push({type:"item",tagName:"use",props:[["xlink:href","#"+t],["x",ut?c:c-O],["y",ut?A-O:A],["clip-path","url(#"+n+")"]]})}})):ut?r.drawImage(t.canvas,0,O,_,W,c+n,A+o,_,W):r.drawImage(t.canvas,O,0,H,g,c+n,A+o,H,g),at&&at.forEach((function(t){Df.renderBoxShadow(a,e,r,t,L,D,B,P,B-L,P-D,n,o)})),b>0&&X[3]>0){var Y=Math.atan(b/x),j=Math.atan(b/m),Z=Le.calPoints(b,h[U_],Y,j,L,L,B-m,B,D,D+b,P-M,P,0,R?_t:[0,0],vt);Le.renderBorder(a,e,r,Z,l[Q_],n,o)}if(m>0&&U[3]>0){var q=Math.atan(m/b),$=Math.atan(m/M),J=Le.calPoints(m,h[V_],q,$,L,L+x,B-m,B,D,D+b,P-M,P,1,_t,vt);Le.renderBorder(a,e,r,J,l[rv],n,o)}if(M>0&&V[3]>0){var Q=Math.atan(M/x),tt=Math.atan(M/m),et=Le.calPoints(M,h[K_],Q,tt,L,L,B-m,B,D,D+b,P-M,P,2,R?_t:[0,0],vt);Le.renderBorder(a,e,r,et,l[tv],n,o)}if(R&&x>0&&K[3]>0){var rt=Math.atan(x/b),it=Math.atan(x/M),nt=Le.calPoints(x,h[j_],rt,it,L,L+x,B-m,B,D,D+b,P-M,P,3,_t,vt);Le.renderBorder(a,e,r,nt,l[ev],n,o)}}()}return t&&t.ctx.clearRect(0,0,_,g),{v:W}}();if("object"===t(Et))return Et.v}else if(B===P||N===H)return W}if(z[3]>0&&cu.renderBgc(this,e,r,l[G_],ft,B,N,P-B,H-N,_t,vt,yt,dt,"fill",!1,n,o),tt){var At=tt.length;tt.slice(0).reverse().forEach((function(t,i){if(t)if(i=At-1-i,G.isString(t)){var s=a.__loadBgi[i];s.url===t&&cu.renderImage(a,e,r,s,B,N,P,H,_t,vt,yt,dt,h,i,it,Q,!1,n,o)}else if(t.k){var l=a.__gradient(e,r,B,N,P,H,t,n,o);l&&("conic"===l.k?er.renderConic(a,e,r,l.v,B,N,P-B,H-N,_t,vt,yt,dt):cu.renderBgc(a,e,r,l.v,ft,B,N,P-B,H-N,_t,vt,yt,dt,"fill",!1,n,o))}}))}return at&&at.forEach((function(t){Df.renderBoxShadow(a,e,r,t,A,C,k,D,k-A,D-C,n,o)})),b>0&&X[3]>0&&Le.renderBorder(this,e,r,l[sv],l[Q_],n,o),m>0&&U[3]>0&&Le.renderBorder(this,e,r,l[lv],l[rv],n,o),M>0&&V[3]>0&&Le.renderBorder(this,e,r,l[hv],l[tv],n,o),x>0&&K[3]>0&&Le.renderBorder(this,e,r,l[uv],l[ev],n,o),W}},{key:"__destroy",value:function(){if(!this.__isDestroyed){var t=this.props.ref;qv(t)||$v(t)||delete this.__root.__ref[t],h(n(i.prototype),"__destroy",this).call(this),this.clearAnimate(),this.clearFrameAnimate(),this.clearCache();var e=this.__fontRegister;for(var r in e)e.hasOwnProperty(r)&&ct.offRegister(r,this);this.__host=this.__hostRoot=this.__root=this.__prev=this.__next=this.__parent=this.__domParent=null,this.__reset0()}}},{key:"__emitEvent",value:function(t,e){var r=this.__isDestroyed,i=this.__computedStyle,a=this.__isMask;if(!(r||"none"===i[d_]||t.__stopPropagation||a)){var n,o=t.event.type,s=this.listener,l=this.__hasMask;if(s.hasOwnProperty(o)&&(n=s[o]),e)return"none"!==i[ov]&&$v(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0;if(this.willResponseEvent(t)){if(l){for(var h,u=this.next,c=u.__isClip;u&&u.__isMask;){if(u.willResponseEvent(t,!0)){h=!0;break}u=u.next}if(!c&&!h)return}return $v(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0}}}},{key:"willResponseEvent",value:function(t,e){var r=t.x,i=t.y,a=this.__sx1,n=this.__sy1,o=this.__offsetWidth,s=this.__offsetHeight,l=this.__matrixEvent;if("none"!==this.__computedStyle[ov])return Ut.pointInQuadrilateral(r,i,a,n,a+o,n,a+o,n+s,a,n+s,l)?(t.target||e||(t.target=this,"touchstart"===t.event.type&&this.root&&(this.root.__touchstartTarget=this)),!0):void 0}},{key:"__gradient",value:function(t,e,r,i,a,n,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=a-r,u=n-i;if(h&&u){var c=o.k,f=o.v,_=o.d,v=o.s,y=o.z,d=o.p,p=r+.5*h,x=i+.5*u,g={k:c};if("linear"===c){var m=er.getLinear(f,_,r,i,p,x,h,u,this.root,s,l);g.v=this.__getLg(t,e,m)}else if("radial"===c){var b=er.getRadial(f,v,y,d,r,i,a,n,this.root,s,l);b&&(g.v=this.__getRg(t,e,b),b.matrix&&(g.v=[g.v,b.matrix,b.cx,b.cy]))}else if("conic"===c){var M=this.bbox,E=Math.max(Math.abs(M[2]-M[0]),Math.abs(M[3]-M[1])),A=Math.max(Math.abs(h),Math.abs(u)),S=er.getConic(f,_,d,r,i,a,n,E/A,this.root,s,l);g.v=this.__getCg(t,e,S)}return g}}},{key:"__getLg",value:function(t,e,r){if(t===Hf||t===Yf){var i=e.createLinearGradient(r.x1,r.y1,r.x2,r.y2);return r.stop.forEach((function(t){i.addColorStop(t[1],Kv(t[0]))})),i}if(t===Wf){var a={tagName:"linearGradient",props:[["x1",r.x1],["y1",r.y1],["x2",r.x2],["y2",r.y2]],children:r.stop.map((function(t){return{tagName:"stop",props:[["stop-color",Kv(t[0])],["offset",100*t[1]+"%"]]}}))},n=e.add(a);return this.__cacheDefs.push(a),"url(#"+n+")"}}},{key:"__getRg",value:function(t,e,r){if(t===Hf||t===Yf){var i=e.createRadialGradient(r.cx,r.cy,0,r.tx,r.ty,r.r);return r.stop.forEach((function(t){i.addColorStop(t[1],Kv(t[0]))})),i}if(t===Wf){var a={tagName:"radialGradient",props:[["cx",r.tx],["cy",r.ty],["r",r.r]],children:r.stop.map((function(t){return{tagName:"stop",props:[["stop-color",Kv(t[0])],["offset",100*t[1]+"%"]]}}))};r.tx!==r.cx&&a.props.push(["fx",r.cx]),r.ty!==r.cy&&a.props.push(["fy",r.cy]);var n=e.add(a);return this.__cacheDefs.push(a),"url(#"+n+")"}}},{key:"__getCg",value:function(t,e,r){var i=r.stop,a=i.length-1;i[a][1]<1&&i.push([i[a][0].slice(0),1]),i[0][1]>0&&i.unshift([i[0][0].slice(0),0]);return t===Hf||t===Yf?r:[]}},{key:"clearCache",value:function(t){var e=this.__cacheTotal,r=this.__cacheFilter,i=this.__cacheMask,a=this.__cacheOverflow,n=this.__cache;if(n&&n.release(),e&&e.release(),r&&r.release(),i&&i.release(),a&&a.release(),this.__refreshLevel|=ky,t)for(var o=this.__domParent;o;){var s=o.__cacheTotal,l=o.__cacheFilter,h=o.__cacheMask,u=o.__cacheOverflow;o.__refreshLevel|=ky,s&&s.release(),l&&l.release(),h&&h.release(),u&&u.release(),o=o.__domParent}}},{key:"updateStyle",value:function(t,e){var r=zf(t);this.updateFormatStyle(r,e)}},{key:"updateFormatStyle",value:function(t,e){var r=this,i=this.__root,a=this.__currentStyle,n=this.__currentProps,o=[];Object.keys(t).forEach((function(e){var i=iy.hasOwnProperty(e);i||(e=parseInt(e)),Xf(e,i?n[e]:a[e],t[e],r)||(i?n[e]=t[e]:a[e]=t[e],o.push(e))})),o.length&&!this.__isDestroyed?i&&i.__addUpdate(this,{keys:o,cb:e}):$v(e)&&e()}},{key:"animate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Of(this,t,e);return this.__isDestroyed?(r.__destroy(),r):(this.__animationList.push(r),!1===e.autoPlay?r:r.play())}},{key:"removeAnimate",value:function(t){if(t instanceof Of){var e=this.__animationList.indexOf(t);e>-1&&(t.cancel(),t.__destroy(),this.__animationList.splice(e,1))}}},{key:"clearAnimate",value:function(){this.__animationList.splice(0).forEach((function(t){t.cancel(),t.__destroy()}))}},{key:"frameAnimate",value:function(t){if($v(t)){for(var e=this.__frameAnimateList,r=0,i=e.length;r<i;r++)if(e[r].__karasFramecb===t)return t;var a={__after:function(e){t(e)},__karasFramecb:t};return e.push(a),yu.onFrame(a),t}}},{key:"removeFrameAnimate",value:function(t){for(var e=0,r=this.__frameAnimateList,i=r.length;e<i;e++)if(r[e].__karasFramecb===t)return r.splice(e,1),void yu.offFrame(t)}},{key:"clearFrameAnimate",value:function(){this.__frameAnimateList.splice(0).forEach((function(t){yu.offFrame(t)}))}},{key:"__deepScan",value:function(t,e){return t(this,e)}},{key:"__offsetX",value:function(t,e,r){"none"!==this.__computedStyle[d_]&&(h(n(i.prototype),"__offsetX",this).call(this,t,e),e&&(this.__layoutData.x+=t),this.__sx1+=t,this.__sx2+=t,this.__sx3+=t,this.__sx4+=t,this.__sx5+=t,this.__sx6+=t,r&&(this.__refreshLevel|=r,r>=xy&&(this.__cacheStyle=[],this.__calStyle(r,this.__currentStyle,this.__computedStyle,this.__cacheStyle)),this.__bbox&&(this.__bbox[0]+=t,this.__bbox[2]+=t),this.__filterBbox&&(this.__filterBbox[0]+=t,this.__filterBbox[2]+=t)))}},{key:"__offsetY",value:function(t,e,r){"none"!==this.__computedStyle[d_]&&(h(n(i.prototype),"__offsetY",this).call(this,t,e),e&&this.__layoutData&&(this.__layoutData.y+=t),this.__sy1+=t,this.__sy2+=t,this.__sy3+=t,this.__sy4+=t,this.__sy5+=t,this.__sy6+=t,r&&(this.__refreshLevel|=r,r>=xy&&(this.__cacheStyle=[],this.__calStyle(r,this.__currentStyle,this.__computedStyle,this.__cacheStyle)),this.__bbox&&(this.__bbox[1]+=t,this.__bbox[3]+=t),this.__filterBbox&&(this.__filterBbox[1]+=t,this.__filterBbox[3]+=t),this.__cache&&this.__cache.__offsetY(t),this.__cacheTotal&&this.__cacheTotal.__offsetY(t),this.__cacheOverflow&&this.__cacheOverflow.__offsetY(t),this.__cacheFilter&&this.__cacheFilter.__offsetY(t),this.__cacheMask&&this.__cacheMask.__offsetY(t)))}},{key:"__resizeX",value:function(t,e){"none"!==this.__computedStyle[d_]&&(this.__computedStyle.width=this.__width+=t,this.__clientWidth+=t,this.__offsetWidth+=t,this.__outerWidth+=t,this.__layoutData&&(this.__layoutData.w+=t),this.__sx4+=t,this.__sx5+=t,this.__sx6+=t,t<0&&(this.__limitCache=!1),e&&(this.__refreshLevel|=e,e>=xy&&(this.__cacheStyle=[],this.__calStyle(e,this.__currentStyle,this.__computedStyle,this.__cacheStyle))),this.clearCache())}},{key:"__resizeY",value:function(t,e){"none"!==this.__computedStyle[d_]&&(this.__computedStyle.height=this.__height+=t,this.__clientHeight+=t,this.__offsetHeight+=t,this.__outerHeight+=t,this.__layoutData.h+=t,this.__sy4+=t,this.__sy5+=t,this.__sy6+=t,t<0&&(this.__limitCache=!1),e&&(this.__refreshLevel|=e,e>=xy&&(this.__cacheStyle=[],this.__calStyle(e,this.__currentStyle,this.__computedStyle,this.__cacheStyle))),this.clearCache())}},{key:"getComputedStyle",value:function(t){var e=this.__computedStyle,r={},i=[];t?(Array.isArray(t)?t:[t]).forEach((function(t){ar.hasOwnProperty(t)?ar[t].forEach((function(t){i.push(Uf[Kf(t)])})):i.push(Uf[Kf(t)])})):i=Object.keys(e);return i.forEach((function(t){iy.hasOwnProperty(t)?r[t]=e[t]:r[Vf[t]]=e[t]})),r}},{key:"getBoundingClientRect",value:function(t){var e;if(t)e=this.bbox;else{var r=this.__sx1,i=this.__sy1;e=[r,i,r+this.__offsetWidth,i+this.__offsetHeight]}var a=this.matrixEvent,n=oy(g.calPoint([e[0],e[1]],a)),o=oy(g.calPoint([e[2],e[1]],a)),s=oy(g.calPoint([e[2],e[3]],a)),l=oy(g.calPoint([e[0],e[3]],a));return{left:Math.min(n[0],Math.min(o[0],Math.min(s[0],l[0]))),top:Math.min(n[1],Math.min(o[1],Math.min(s[1],l[1]))),right:Math.max(n[0],Math.max(o[0],Math.max(s[0],l[0]))),bottom:Math.max(n[1],Math.max(o[1],Math.max(s[1],l[1]))),points:[n,o,s,l]}}},{key:"__isRealInline",value:function(){return!0}},{key:"remove",value:function(t){var e,r=this.__root,i=this.isShadowRoot?this.hostRoot.__parent:this.__parent;if(i){var a=this.isShadowRoot?this.hostRoot:this;e=i.__children.indexOf(a),i.__children.splice(e,1),e=i.__zIndexChildren.indexOf(a),i.__zIndexChildren.splice(e,1);var n=this.__prev,o=this.__next;n&&(n.__next=o),o&&(o.__prev=n)}if(this.__isDestroyed)$v(t)&&t();else{if(i.__deleteStruct(this,e),"none"===this.__computedStyle[d_]||"none"===i.__computedStyle[d_])return this.__destroy(),void($v(t)&&t());var s={focus:xy,removeDom:!0,cb:t};r.__addUpdate(this,s)}}},{key:"tagName",get:function(){return this.__tagName}},{key:"sx",get:function(){return this.__sx}},{key:"sy",get:function(){return this.__sy}},{key:"clientWidth",get:function(){return this.__clientWidth||0}},{key:"clientHeight",get:function(){return this.__clientHeight||0}},{key:"offsetWidth",get:function(){return this.__offsetWidth||0}},{key:"offsetHeight",get:function(){return this.__offsetHeight||0}},{key:"outerWidth",get:function(){return this.__outerWidth||0}},{key:"outerHeight",get:function(){return this.__outerHeight||0}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.__sx1,e=this.__sy1,r=this.__offsetWidth,i=this.__offsetHeight,a=this.__computedStyle[Y_];this.__bbox=ey([t,e,t+r,e+i],a)}return this.__bbox}},{key:"filterBbox",get:function(){if(!this.__filterBbox){var t=this.__bbox||this.bbox,e=this.__computedStyle[Z_];this.__filterBbox=ry(t,e)}return this.__filterBbox}},{key:"listener",get:function(){return this.__listener}},{key:"opacity",get:function(){return this.__opacity}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixEvent",get:function(){for(var t=this.__domParent,e=this.__matrix;t;)e=g.multiply(t.__perspectiveMatrix,e),e=g.multiply(t.__matrix,e),t=t.__domParent;return e}},{key:"perspectiveMatrix",get:function(){return this.__perspectiveMatrix}},{key:"style",get:function(){return this.__style}},{key:"computedStyle",get:function(){return this.__computedStyle}},{key:"animationList",get:function(){return this.__animationList}},{key:"currentStyle",get:function(){return this.__currentStyle}},{key:"cacheStyle",get:function(){return this.__cacheStyle}},{key:"isShadowRoot",get:function(){return!this.parent&&this.host&&this.host!==this.root}},{key:"contentBoxList",get:function(){return this.__contentBoxList}},{key:"baseline",get:function(){return this.offsetHeight}},{key:"firstBaseline",get:function(){return this.offsetHeight}},{key:"verticalBaseline",get:function(){return this.offsetWidth}},{key:"isMask",get:function(){return this.__isMask}},{key:"isClip",get:function(){return this.__isClip}},{key:"cacheAsBitmap",get:function(){return this.__cacheAsBitmap},set:function(t){this.__cacheAsBitmap=!!t}},{key:"parentLineBox",get:function(){return this.__parentLineBox}}]),i}(v),Ny=Ct.STYLE_KEY,Gy=Ny.DISPLAY,Hy=Ny.MARGIN_TOP,Wy=Ny.MARGIN_BOTTOM,Yy=Ny.MARGIN_LEFT,zy=Ny.MARGIN_RIGHT,Xy=Ny.BORDER_TOP_WIDTH,Uy=Ny.BORDER_BOTTOM_WIDTH,Vy=Ny.BORDER_LEFT_WIDTH,Ky=Ny.BORDER_RIGHT_WIDTH,jy=Ny.PADDING_TOP,Zy=Ny.PADDING_BOTTOM,qy=Ny.PADDING_LEFT,$y=Ny.PADDING_RIGHT,Jy=Ny.LINE_HEIGHT,Qy=function(){function t(t,e,r,i,a){this.__list=[],this.__x=t,this.__y=e,this.__lineHeight=r,this.__baseline=i,this.__isUpright=a,this.__bOffset=0}return r(t,[{key:"add",value:function(t){this.list.push(t),t.__parentLineBox=this}},{key:"verticalAlign",value:function(t){var e=t?this.verticalBaseline:this.baseline,r=t?this.verticalLineHeight:this.lineHeight,i=r;if(this.list.length){this.list.forEach((function(r){if(!r.isEllipsis)if(t){var a=r.verticalBaseline;if(a!==e){var n=e-a;r.__offsetX(n,!0),i=Math.max(i,r.offsetWidth+n)}}else{var o=r.baseline;if(o!==e){var s=e-o;r.__offsetY(s,!0),i=Math.max(i,r.offsetHeight+s)}}}));var a=e-this.__baseline;i=Math.max(i,this.__lineHeight+a)}return Math.max(0,i-r)}},{key:"__offsetX",value:function(t,e){this.__x+=t,e&&this.list.forEach((function(e){e.__offsetX(t,!0)}))}},{key:"__offsetY",value:function(t,e){this.__y+=t,e&&this.list.forEach((function(e){e.__offsetY(t,!0)}))}},{key:"__setLB",value:function(t,e){this.__lineHeight=Math.max(t,this.__lineHeight),this.__baseline=Math.max(e,this.__baseline)}},{key:"__resetLb",value:function(t,e){this.list.forEach((function(r){var i=r;r instanceof nl&&(i=r.parent.parent);for(var a=i.computedStyle;"inline"===a[Gy];)t=Math.max(t,a[Jy]),e=Math.max(e,Ln.getBaseline(a)),a=(i=i.domParent).computedStyle})),this.__lineHeight=t,this.__baseline=e}},{key:"list",get:function(){return this.__list}},{key:"size",get:function(){return this.__list.length}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"endX",get:function(){return this.x+this.width}},{key:"endY",get:function(){return this.y+this.height}},{key:"width",get:function(){if(this.isUpright)return this.verticalLineHeight;var t=this.list,e=t.length;if(e){for(var r=t[0],i=t[e-1],a=r.x,n=r instanceof nl?r.parent.domParent:r.domParent;;){var o=n.contentBoxList,s=n.computedStyle,l=s[Gy],h=s[Yy],u=s[Vy],c=s[qy];if("inline"!==l)break;r===o[0]&&(a-=h+u+c),n=n.domParent}var f=i.x+i.outerWidth;for(n=i instanceof nl?i.parent.domParent:i.domParent;;){var _=n.contentBoxList,v=n.computedStyle,y=v[Gy],d=v[zy],p=v[Ky],x=v[$y];if("inline"!==y)break;r===_[_.length-1]&&(f+=d+p+x),n=n.domParent}return f-a}return 0}},{key:"height",get:function(){if(!this.isUpright)return this.lineHeight;var t=this.list,e=t.length;if(e){for(var r=t[0],i=t[e-1],a=r.y,n=r instanceof nl?r.parent.domParent:r.domParent;;){var o=n.contentBoxList,s=n.computedStyle,l=s[Gy],h=s[Hy],u=s[Xy],c=s[jy];if("inline"!==l)break;r===o[0]&&(a-=h+u+c),n=n.domParent}var f=i.y+i.outerHeight;for(n=i instanceof nl?i.parent.domParent:i.domParent;;){var _=n.contentBoxList,v=n.computedStyle,y=v[Gy],d=v[Wy],p=v[Uy],x=v[Zy];if("inline"!==y)break;r===_[_.length-1]&&(f+=d+p+x),n=n.domParent}return f-a}return 0}},{key:"bOffset",get:function(){return this.__bOffset}},{key:"baseline",get:function(){var t=this.__baseline;return this.list.forEach((function(e){t=Math.max(t,e.baseline)})),t}},{key:"verticalBaseline",get:function(){var t=this.__baseline;return this.list.forEach((function(e){t=Math.max(t,e.verticalBaseline)})),t}},{key:"lineHeight",get:function(){var t=this.__lineHeight;return this.list.forEach((function(e){t=Math.max(t,e.outerHeight)})),t}},{key:"verticalLineHeight",get:function(){var t=this.__lineHeight;return this.list.forEach((function(e){t=Math.max(t,e.outerWidth)})),t}},{key:"isUpright",get:function(){return this.__isUpright}}]),t}(),td=function(){function t(t,e,r,i,a){this.__x=this.__lastX=t,this.__y=this.__lastY=e,this.__max=a?e:t,this.__domList=[],this.__domStack=[],this.__list=[],this.__isNewLine=!0,this.__lineHeight=r,this.__baseline=i,this.__isEnd=!0,this.__spreadList=[],this.__isVertical=a}return r(t,[{key:"genLineBox",value:function(t,e){var r=new Qy(t,e,this.__lineHeight,this.__baseline,this.isUpright);return this.list.push(r),this.__isEnd=!0,r}},{key:"genLineBoxByInlineIfNewLine",value:function(t,e,r,i){var a=Math.max(this.__lineHeight,r),n=Math.max(this.__baseline,i);if(this.__isNewLine){var o=new Qy(t,e,a,n,this.isUpright);return this.list.push(o),this.__isEnd=!0,this.__isNewLine=!1,o}}},{key:"setNotEnd",value:function(){this.__isEnd=!1}},{key:"setNewLine",value:function(){this.__isNewLine=!0}},{key:"addItem",value:function(t,e){var r,i=this.isUpright;if(this.__isNewLine)this.__isNewLine=!1,r=this.genLineBox(t.x,t.y);else{var a=this.list;r=a[a.length-1]}return this.__domStack.forEach((function(e){e.__contentBoxList.push(t)})),r.add(t),e?(this.__isNewLine=!0,this.__lastX=t.x,this.__lastY=t.y+t.outerHeight):i?(this.__lastX=t.x,this.__lastY=t.y+t.outerHeight):(this.__lastX=t.x+t.outerWidth,this.__lastY=t.y),this.__max=Math.max(this.__max,i?t.y+t.outerHeight:t.x+t.outerWidth),r}},{key:"horizonAlign",value:function(t,e,r){this.list.forEach((function(i){var a=t-(r?i.height:i.width);a>0&&("center"===e&&(a*=.5),r?i.__offsetY(a,!0):i.__offsetX(a,!0))}))}},{key:"verticalAlign",value:function(t){var e=this.__spreadList;e.splice(0);var r=0;return this.list.forEach((function(i){r&&(i.__bOffset=r,t?i.__offsetX(r,!0):i.__offsetY(r,!0)),r+=i.verticalAlign(t),e.push(r)})),r}},{key:"addX",value:function(t){this.__lastX+=t}},{key:"addY",value:function(t){this.__lastY+=t}},{key:"pushContentBoxList",value:function(t){this.__domList.push(t),this.__domStack.push(t)}},{key:"popContentBoxList",value:function(){this.__domStack.pop()}},{key:"__offsetX",value:function(t){this.list.forEach((function(e){e.__offsetX(t)}))}},{key:"__offsetY",value:function(t){this.list.forEach((function(e){e.__offsetY(t)}))}},{key:"setLbByInlineIfNotNewLine",value:function(t,e){var r=this.list.length;r&&!this.isNewLine&&this.list[r-1].__setLB(t,e,!1)}},{key:"size",get:function(){return this.list.length}},{key:"lastX",get:function(){return this.__lastX}},{key:"lastY",get:function(){return this.__lastY}},{key:"endX",get:function(){var t=this.list,e=t.length;return e?t[e-1].endX:this.__x}},{key:"endY",get:function(){var t=this.list,e=t.length;return e?t[e-1].endY:this.__y}},{key:"isEnd",get:function(){return this.__isEnd}},{key:"isNewLine",get:function(){return this.__isNewLine}},{key:"breakLine",get:function(){return this.list.length>1}},{key:"domList",get:function(){return this.__domList}},{key:"baseline",get:function(){var t=this.list,e=t.length;if(e){for(var r=0,i=0;i<e-1;i++)r+=t[i].height;return r+t[e-1].baseline+t[e-1].bOffset}return 0}},{key:"firstBaseline",get:function(){var t=this.list;return t.length?t[0].baseline:0}},{key:"verticalBaseline",get:function(){var t=this.list;return t.length?t[0].baseline+t[0].bOffset:0}},{key:"lineHeight",get:function(){var t=this.list;return t.length?t[t.length-1].lineHeight:0}},{key:"verticalLineHeight",get:function(){var t=this.list;return t.length?t[t.length-1].verticalLineHeight:0}},{key:"lineBox",get:function(){var t=this.list;if(t.length)return t[t.length-1]}},{key:"list",get:function(){return this.__list}},{key:"width",get:function(){var t=0;return this.list.forEach((function(e){t=Math.max(t,e.width)})),t}},{key:"spreadList",get:function(){return this.__spreadList}},{key:"isUpright",get:function(){return this.__isVertical}},{key:"max",get:function(){return this.__max}}]),t}(),ed={TAG_NAME:{div:!0,p:!0,span:!0,img:!0,b:!0,strong:!0},INLINE:{span:!0,img:!0,b:!0,strong:!0},BOLD:{b:!0,strong:!0}},rd=Ct.STYLE_KEY,id=rd.MARGIN_RIGHT,ad=rd.MARGIN_LEFT,nd=rd.PADDING_RIGHT,od=rd.PADDING_LEFT,sd=rd.WIDTH,ld=rd.HEIGHT,hd=rd.BORDER_RIGHT_WIDTH,ud=rd.BORDER_LEFT_WIDTH,cd=rd.FILL,fd=rd.STROKE,_d=rd.STROKE_MITERLIMIT,vd=rd.STROKE_WIDTH,yd=rd.STROKE_LINECAP,dd=rd.STROKE_LINEJOIN,pd=rd.STROKE_DASHARRAY,xd=rd.STROKE_DASHARRAY_STR,gd=rd.FILL_RULE,md=rd.VISIBILITY,bd=rd.FLEX_BASIS,Md=d.AUTO,Ed=d.PX,Ad=d.PERCENT,Sd=d.REM,Td=d.VW,wd=d.VH,Rd=d.VMAX,kd=d.VMIN,Cd=d.RGBA,Od=d.GRADIENT,Id=G.int2rgba,Fd=G.isNil,Ld=G.joinArr,Dd=Zt.canvasPolygon,Bd=Zt.svgPolygon,Pd={},Nd=function(t){function e(e,r){var i;return(i=t.call(this,e,r)||this).__isMulti=!!i.props.multi,i.__style=Ln.normalize(i.style,mt.DOM_ENTRY_SET.concat(mt.GEOM_ENTRY_SET)),i.__currentStyle=G.extend([],i.__style),i.__currentProps=G.clone(i.props),i.__cacheProps={},i}return a(e,t),r(e,[{key:"__tryLayInline",value:function(t,e){this.__computeReflow();var r=this.currentStyle,i=r[sd],a=r[ad],n=r[id],o=r[od],s=r[nd],l=this.computedStyle,h=l[ud],u=l[hd];return i[1]!==Md&&(t-=this.__calSize(i,e,!0)),t-=this.__calSize(n,e,!0),t-=this.__calSize(s,e,!0),t-=u,t-=this.__calSize(a,e,!0),t-=this.__calSize(o,e,!0),t-=h}},{key:"__calBasis",value:function(t,e,r,i,a){this.__computeReflow();var n=0,o=0,s=0,l=this.currentStyle,h=this.computedStyle,u=i.w,c=i.h,f=l[bd],_=l[sd],v=l[ld],y=t?_:v;return[Ed,Ad,Sd,Td,wd,Rd,kd].indexOf(f.u)>-1?n=s=o=this.__calSize(f,t?u:c,!0):[Ed,Ad,Sd,Td,wd,Rd,kd].indexOf(y.u)>-1&&(n=s=o=this.__calSize(y,t?u:c,!0)),this.__addMBP(t,u,l,h,[n,o,s],a)}},{key:"__layout",value:function(t,r,i,a){h(n(e.prototype),"__layout",this).call(this,t,r,i,a),this.__layoutStyle()}},{key:"__layoutBlock",value:function(t,e,r,i){var a=this.__preLayout(t,!1),n=a.fixedWidth,o=a.fixedHeight,s=a.w,l=a.h,h=a.isParentVertical,u=a.isUpright,c=0,f=0;!n&&(e||h||u)||(c=s),(o||!e&&h&&u)&&(f=l),this.__ioSize(c,f),e||r||i||(this.__marginAuto(this.currentStyle,t),this.__cacheProps={})}},{key:"__layoutFlex",value:function(t,e,r,i){this.__layoutBlock(t,e,r,i)}},{key:"__layoutInline",value:function(t,e,r){var i=this.__preLayout(t,!1),a=i.fixedWidth,n=i.fixedHeight,o=i.w,s=i.h,l=a?o:0,h=n?s:0;this.__ioSize(l,h),this.__cacheProps={}}},{key:"__calStyle",value:function(t,r,i,a){var o=this,s=h(n(e.prototype),"__calStyle",this).call(this,t,r,i,a);if(Fd(a[vd])){a[vd]=!0;var l=r[vd]||[],u=this.width;i[vd]=l.map((function(t){return o.__calSize(t,u,!0)}))}return Fd(a[pd])&&(a[pd]=!0,i[pd]=r[pd]||[],a[xd]=i[pd].map((function(t){return Ld(t,",")}))),[yd,dd,_d,gd].forEach((function(t){i[t]=r[t]})),[cd,fd].forEach((function(t){if(Fd(a[t])){var e=r[t],n=i[t]=[],o=a[t]=[];Array.isArray(e)&&e.forEach((function(t){t&&t.u===Od?(n.push(t.v),o.push(!0)):t&&t.u===Cd&&t.v[3]>0?(n.push(t.v),o.push(Id(t.v))):(n.push("none"),o.push("none"))}))}})),s}},{key:"calContent",value:function(t,e){return"hidden"!==e[md]}},{key:"__preSet",value:function(t,e){var r=this,i=this.width,a=this.height,n=this.__cacheStyle,o=this.computedStyle,s=e.sx3+.5*i,l=e.sy3+.5*a,h=n[xd],u=o[cd],c=o[fd],f=o[vd],_=o[yd],v=o[dd],y=o[_d],d=o[pd],p=o[gd];return{cx:s,cy:l,stroke:c=c.map((function(i){return i.k?r.__gradient(t,e.ctx,e.sx3,e.sy3,e.sx4,e.sy4,i,e.dx,e.dy):Id(i)})),strokeWidth:f,strokeDasharray:d,strokeDasharrayStr:h,strokeLinecap:_,strokeLinejoin:v,strokeMiterlimit:y,fill:u=u.map((function(i){return i.k?r.__gradient(t,e.ctx,e.sx3,e.sy3,e.sx4,e.sy4,i,e.dx,e.dy):Id(i)})),fillRule:p}}},{key:"__preSetCanvas",value:function(t,e,r){var i=r.stroke,a=r.strokeWidth,n=r.strokeDasharray,o=r.strokeLinecap,s=r.strokeLinejoin,l=r.strokeMiterlimit,h=r.fill;t===y.CANVAS&&(h&&("linear"===h.k?e.fillStyle=h.v:"radial"!==h.k||Array.isArray(h.v)?"conic"===h.k||h.k||e.fillStyle===h||(e.fillStyle=h):e.fillStyle=h.v),i&&("linear"===i.k?e.strokeStyle=i.v:"radial"!==i.k||Array.isArray(i.v)?"conic"===i.k||i.k||e.strokeStyle===i||(e.strokeStyle=i):e.strokeStyle=i.v),void 0!==a&&e.lineWidth!==a&&(e.lineWidth=a),void 0!==o&&e.lineCap!==o&&(e.lineCap=o),void 0!==s&&e.lineJoin!==s&&(e.lineJoin=s),void 0!==l&&e.miterLimit!==l&&(e.miterLimit=l),G.isFunction(e.getLineDash)?n&&!G.equalArr(e.getLineDash(),n)&&e.setLineDash(n):n&&e.setLineDash(n))}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a);if(t===y.SVG&&(this.virtualDom.type="geom"),o.break||t===y.WEBGL)return o;var s=this.__preSet(t,o);return Object.assign(o,s)}},{key:"__renderPolygon",value:function(t,e,r){var i=r.fill,a=r.fillRule,n=r.stroke,o=r.strokeWidth,s=r.strokeDasharray,l=r.strokeDasharrayStr,h=r.strokeLinecap,u=r.strokeLinejoin,c=r.strokeMiterlimit,f=r.dx,_=r.dy,v=this.__cacheProps.list,y=this.isMulti,d=this.bbox;if(i.length<=1&&n.length<=1){var p={fill:i[0],fillRule:a[0],stroke:n[0],strokeWidth:o[0],strokeDasharray:s[0],strokeDasharrayStr:l[0],strokeLinecap:h[0],strokeLinejoin:u[0],strokeMiterlimit:c[0],dx:f,dy:_,bbox:d};this.__renderOnePolygon(t,e,y,v,p)}else{for(var x=0,g=i.length;x<g;x++){var m=i[x];if(m){var b={fill:m,fillRule:a[x],dx:f,dy:_,bbox:d};this.__renderOnePolygon(t,e,y,v,b)}}for(var M=0,E=n.length;M<E;M++){var A=n[M];if(A){var S={stroke:A,strokeWidth:o[M],strokeDasharray:s[M],strokeDasharrayStr:l[M],strokeLinecap:h[M],strokeLinejoin:u[M],strokeMiterlimit:c[M],dx:f,dy:_,bbox:d};this.__renderOnePolygon(t,e,y,v,S)}}}}},{key:"__renderOnePolygon",value:function(t,e,r,i,a){var n=a.fill,o=a.stroke,s=a.strokeWidth,l=n&&"conic"===n.k,h=o&&"conic"===o.k,u=n&&"radial"===n.k&&Array.isArray(n.v),c=s&&s>0&&o&&"radial"===o.k&&Array.isArray(o.v);l||h?(l?this.__conicGradient(t,e,i,r,a):"none"!==n&&this.__drawPolygon(t,e,r,i,a,!0),s&&s>0&&h?lt.warn("Stroke style can not use conic-gradient"):s&&s>0&&"none"!==o&&this.__drawPolygon(t,e,r,i,a,!1,!0)):u||c?(u?this.__radialEllipse(t,e,i,r,a,"fill"):"none"!==n&&this.__drawPolygon(t,e,r,i,a,!0),s&&s>0&&c?(lt.warn("Stroke style can not use radial-gradient for ellipse"),a.stroke.v=a.stroke.v[0],this.__drawPolygon(t,e,r,i,a,!1,!0)):s&&s>0&&"none"!==o&&this.__drawPolygon(t,e,r,i,a,!1,!0)):this.__drawPolygon(t,e,r,i,a,!0,!0)}},{key:"__drawPolygon",value:function(t,e,r,i,a,n,o){var s=a.fill,l=a.stroke,h=a.strokeWidth,u=a.fillRule,c=a.strokeDasharrayStr,f=a.strokeLinecap,_=a.strokeLinejoin,v=a.strokeMiterlimit,d=a.dx,p=a.dy;if(t===y.CANVAS)this.__preSetCanvas(t,e,a),e.beginPath(),r?i.forEach((function(t){return Dd(e,t,d,p)})):Dd(e,i,d,p),n&&s&&"none"!==s&&e.fill(u),o&&l&&"none"!==l&&h&&h>0&&e.stroke(),e.closePath();else if(t===y.SVG){var x="";r?i.forEach((function(t){return x+=Bd(t)})):x=Bd(i);var g=[["d",x]];if(!(s&&"none"!==s||l&&"none"!==l))return;n&&s&&"none"!==s?(g.push(["fill",s.v||s]),u&&"nonzero"!==u&&g.push(["fill-rule",u])):g.push(["fill","none"]),o&&l&&"none"!==l&&h&&h>0?(g.push(["stroke",l.v||l]),g.push(["stroke-width",h]),this.__propsStrokeStyle(g,c,f,_,v)):g.push(["stroke-width",0]),this.addGeom("path",g)}}},{key:"__inversePtList",value:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return e?t.map((function(t){return t&&t.length?t.map((function(t){if(!t||!t.length)return null;for(var e=[],n=0,o=t.length;n<o;n+=2){var s=g.calPoint([t[n]+i,t[n+1]+a],r);e.push(s[0]),e.push(s[1])}return e})):null})):t.map((function(t){if(!t||!t.length)return null;for(var e=[],n=0,o=t.length;n<o;n+=2){var s=g.calPoint([t[n]+i,t[n+1]+a],r);e.push(s[0]),e.push(s[1])}return e}))}},{key:"__radialEllipse",value:function(t,e,r,i,a,n){var o=a.strokeWidth,s=a.strokeDasharrayStr,l=a.strokeLinecap,h=a.strokeLinejoin,c=a.strokeMiterlimit,f=a.dx,_=a.dy,v=u(a[n].v,4),d=v[0],p=v[1],x=v[2],m=v[3];p=Ws.calMatrixByOrigin(p,x,m);var b=g.inverse(p);if(r=this.__inversePtList(r,i,b,f,_),t===y.CANVAS){if(p){e.save();var M=e.getTransform();M=[M.a,M.b,0,0,M.c,M.d,0,0,0,0,1,0,M.e,M.f,1,0],p=g.multiply(M,p),e.setTransform(p[0],p[1],p[4],p[5],p[12],p[13])}e.beginPath(),e[n+"Style"]!==d&&(e[n+"Style"]=d),i?r.forEach((function(t){return Zt.canvasPolygon(e,t)})):Dd(e,r),e[n](),e.closePath(),p&&e.restore()}else if(t===y.SVG){var E="";i?r.forEach((function(t){return E+=Bd(t)})):E=Bd(r);var A=[["d",E]];"fill"===n?(A.push(["fill",d]),A.push(["strokeWidth",0])):"stroke"===n&&(A.push(["fill","none"]),A.push(["stroke",d]),A.push(["stroke-width",o]),this.__propsStrokeStyle(A,s,l,h,c)),A.push(["transform","matrix(".concat(Ld(g.m2m6(p),","),")")]),this.addGeom("path",A)}}},{key:"__conicGradient",value:function(t,e,r,i,a){var n=this,o=a.fill,s=a.bbox,l=a.dx,h=void 0===l?0:l,c=a.dy,f=void 0===c?0:c,_=o.v;if(t===y.CANVAS){var v=u(s,4),d=v[0],p=v[1],x=v[2],g=v[3],m=x-d,b=g-p,M=lt.getCacheCanvas(m,b,"__$$CONIC_GRADIENT$$__"),E=M.ctx.getImageData(0,0,m,b);Vt.getConicGradientImage(.5*m,.5*b,m,b,o.v.stop,E.data),M.ctx.putImageData(E,0,0),i?r.forEach((function(t){e.save(),e.beginPath(),Dd(e,t,h,f),e.clip(),e.closePath(),e.drawImage(M.canvas,d+h,p+f),e.restore()})):(e.save(),e.beginPath(),Dd(e,r,h,f),e.clip(),e.closePath(),e.drawImage(M.canvas,d+h,p+f),e.restore()),M.ctx.clearRect(0,0,m,b)}else if(t===y.SVG)if(i)r.forEach((function(t){var r={tagName:"clipPath",children:[{tagName:"path",props:[["d",Bd(t)]]}]},i=e.add(r);n.__cacheDefs.push(r),_.forEach((function(t){n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Bd(t[0])],["fill",t[1]],["clip-path","url(#"+i+")"]]})}))}));else{var A={tagName:"clipPath",children:[{tagName:"path",props:[["d",Bd(r)]]}]},S=e.add(A);this.__cacheDefs.push(A),_.forEach((function(t){n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Bd(t[0])],["fill",t[1]],["clip-path","url(#"+S+")"]]})}))}}},{key:"__propsStrokeStyle",value:function(t,e,r,i,a){e&&t.push(["stroke-dasharray",e]),r&&"butt"!==r&&t.push(["stroke-linecap",r]),i&&"miter"!==i&&t.push(["stroke-linejoin",i]),a&&4!==a&&t.push(["stroke-miterlimit",a])}},{key:"__offsetX",value:function(t,r,i){h(n(e.prototype),"__offsetX",this).call(this,t,r,i),i&&i>=Xl.REFLOW&&(this.__cacheProps={})}},{key:"__offsetY",value:function(t,r,i){h(n(e.prototype),"__offsetY",this).call(this,t,r,i),i&&i>=Xl.REFLOW&&(this.__cacheProps={})}},{key:"__resizeX",value:function(t,r){h(n(e.prototype),"__resizeX",this).call(this,t,r),r&&r>=Xl.REFLOW&&(this.__cacheProps={})}},{key:"__resizeY",value:function(t,r){h(n(e.prototype),"__resizeY",this).call(this,t,r),r&&r>=Xl.REFLOW&&(this.__cacheProps={})}},{key:"addGeom",value:function(t,e){e=G.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"getProps",value:function(t){var e=this.currentProps[t];return Fd(e)?this["__"+t]:e}},{key:"__isRealInline",value:function(){return!1}},{key:"isMulti",get:function(){return this.__isMulti}},{key:"currentProps",get:function(){return this.__currentProps}}],[{key:"REGISTER",get:function(){return Pd}},{key:"getRegister",value:function(t){if(t&&!G.isString(t)&&t.prototype&&t.prototype instanceof e)return t;if(!t||!G.isString(t)||"$"!==t.charAt(0))throw new Error("Invalid param");if(!Pd.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return Pd[t]}},{key:"register",value:function(t,r){if(!(t&&G.isString(t)&&"$"===t.charAt(0)&&r.prototype&&r.prototype instanceof e))throw new Error("Invalid param");if(e.hasRegister(t))throw new Error("Geom has already register: ".concat(t));Pd[t]=r}},{key:"hasRegister",value:function(t){return t&&Pd.hasOwnProperty(t)}},{key:"delRegister",value:function(t){e.hasRegister(t)&&delete Pd[t]}}]),e}(Py),Gd=Ct.STYLE_KEY,Hd=Gd.DISPLAY,Wd=Gd.TOP,Yd=Gd.BOTTOM,zd=Gd.POSITION,Xd=Gd.WIDTH,Ud=Gd.HEIGHT,Vd=Gd.MARGIN_TOP,Kd=Gd.MARGIN_BOTTOM,jd=Gd.MARGIN_LEFT,Zd=Gd.BORDER_TOP_WIDTH,qd=Gd.PADDING_TOP,$d=Gd.BORDER_LEFT_WIDTH,Jd=Gd.PADDING_LEFT,Qd=d.AUTO,tp=d.PX,ep=d.REM,rp=d.VW,ip=d.VH,ap=d.VMAX,np=d.VMIN,op=d.PERCENT,sp=Xl.REPAINT,lp=Xl.REFLOW,hp=Xl.CACHE,up=Ln.isRelativeOrAbsolute;function cp(t,e){t.__refreshLevel|=e?sp:hp,Array.isArray(t.children)&&t.children.forEach((function(t){t instanceof Bh&&(t=t.shadowRoot),cp(t,!0)}))}function fp(t,e){var r=0,i=t[0]||0,a=t[0]||0;t.forEach((function(t){r+=t,i=Math.max(i,t),a=Math.min(a,t)})),e.forEach((function(t){r+=t,i=Math.max(i,t),a=Math.min(a,t)}));var n=0;return i>0&&a>0?n=Math.max(i,a):i<0&&a<0?n=Math.min(i,a):0===i&&0===a||(n=i+a),{target:n,total:r,diff:n-r}}function _p(t,e){return t.currentStyle[e].u!==Qd}function vp(t,e){var r=_p(t,Xd)&&_p(t,Ud);if(r&&e){var i=t.__domParent;if(i&&"flex"===i.computedStyle[Hd])return!1}return r}function yp(t,e,r){for(;t&&!(t instanceof kh)&&!(t instanceof Bh&&t.shadowRoot instanceof kh)&&["block","flex"].indexOf(t.computedStyle[Hd])>-1&&"absolute"!==t.computedStyle[zd]&&(r.push(t.computedStyle[Kd]),!(t.offsetHeight>0));)e.push(t.computedStyle[Vd]),t=t.__prev}function dp(t,e,r){for(;t&&!(t instanceof kh)&&!(t instanceof Bh&&t.shadowRoot instanceof kh)&&["block","flex"].indexOf(t.computedStyle[Hd])>-1&&"absolute"!==t.computedStyle[zd]&&(e.push(t.computedStyle[Vd]),!(t.offsetHeight>0));)r.push(t.computedStyle[Kd]),t=t.__next}function pp(t,e,r,i){for(;t;){var a=t.currentStyle;"absolute"!==a[zd]||a[Wd].u===Qd&&a[Yd].u===Qd||a[Wd].u===Qd&&[tp,ep,rp,ip,ap,np].indexOf(a[Yd].u)>-1?t.__offsetY(e,!0,lp):r||"absolute"!==a[zd]||a[Wd].u!==op&&a[Yd].u!==op||(a[Wd].u===op?t.__offsetY(.01*e*a[Wd].v,!0,lp):t.__offsetY(e*(1-.01*a[Yd].v),!0,lp)),a instanceof kh||a instanceof Bh&&a.shadowRoot instanceof kh||"absolute"===a[zd]&&a[Ud].u===op&&i.push(t),t=t.__next}return e}var xp={getMergeMargin:fp,checkTop:function(t,e,r,i){if(t===e)return t;if(e instanceof kh&&(e=e.__domParent),r&&"absolute"===e.currentStyle[zd])return e;if(i&&"absolute"===e.computedStyle[zd])return e;var a=e;if(r||i){var n=!0,o=e,s=o.__prev,l=o.__next;if((s&&(s instanceof kh||["inline","inlineBlock"].indexOf(s.computedStyle[Hd])>-1)||l&&(l instanceof kh||["inline","inlineBlock"].indexOf(l.computedStyle[Hd])>-1))&&(n=!1),!n&&(a=e.__domParent)===t)return t}if("absolute"===a.currentStyle[zd]&&"absolute"===a.computedStyle[zd])return a;if(["inline","inlineBlock"].indexOf(a.currentStyle[Hd])>-1||["inline","inlineBlock"].indexOf(a.computedStyle[Hd])>-1){do{if((a=a.__domParent)===t)return t}while(["inline","inlineBlock"].indexOf(a.computedStyle[Hd])>-1&&"absolute"!==a.computedStyle[zd]);if(vp(a,!0))return a}var h,u=a;do{if(u===t)break;if("flex"===u.computedStyle[Hd]&&(h=u),"absolute"===u.computedStyle[zd]||vp(u,!0))break;u=u.__domParent}while(u);return h&&(a=h),a},checkNext:function(t,e,r,i,a,n){var o=e.computedStyle,s=e.currentStyle,l=o[zd],h=o[Hd],u="absolute"===l,c="absolute"===s[zd],f="none"===h,_="none"===s[Hd],v=0===e.offsetHeight;if(!f||!_){var d=e.__domParent,p=e.offsetHeight,x=t.renderMode===y.SVG;if(a||n||i&&"static"===l&&"static"===s[zd]?i=!1:l===s[zd]||"static"!==l&&"static"!==s[zd]?f===_||i||x&&cp(d,!1):i=!0,n&&e===r&&"absolute"===r.computedStyle[zd])return e.clearCache(!0),void(x&&cp(d,!1));var g=0,m=0,b=[],M=[],E=e.isShadowRoot?e.__hostRoot.__prev:e.__prev,A=e.isShadowRoot?e.__hostRoot.__next:e.__next;if(a||v){yp(E,M,b),dp(A,M,b),a||(M.push(o[Vd]),b.push(o[Kd]));var S=fp(M,b);g=S.target,S.diff}else{yp(E,M,b),M.push(o[Vd]);var T=fp(M,b);g=T.target,T.diff,M.splice(0),b.splice(0),dp(A,M,b),b.push(o[Kd]),m=(T=fp(M,b)).target,T.diff}var w=d.__layoutData,R=w.x,k=w.y,C=d.__width,O=d.__currentStyle[Ud].u===Qd?w.h:d.__height,I=e;I.isShadowRoot&&(I=I.__hostRoot);for(var F,L=I.__prev;L;){var D=L.computedStyle;if("absolute"!==D[zd]&&"none"!==D[Hd]){k=L.y+L.outerHeight,F=!0;break}L=L.__prev}var B=d.__computedStyle;F||(k+=B[Vd]+B[Zd]+B[qd]),R+=B[jd]+B[$d]+B[Jd];for(var P=c?d:e;P&&P!==t&&!up(P);)P=P.__domParent;if(P||(P=t),n&&e===r);else if(_)e.__layoutNone(),i&&(d.__zIndexChildren=null,d.__updateStruct(),x&&cp(d,!1));else if(c){if(d.__layoutAbs(P,w,e),i&&(d.__zIndexChildren=null,d.__updateStruct(),x&&cp(d,!1)),!a&&!n&&u)return void e.clearCache(!0)}else{var N=Object.assign({},a?w:e.__layoutData,{x:R,y:k,w:C,h:O});e.__layout(N,!1,!1,!1),e instanceof Nd||e.__layoutAbs(P,N,null),i&&(d.__zIndexChildren=null,d.__updateStruct(),x&&cp(d,!1))}if(a&&e===r&&"absolute"===r.currentStyle[zd])return e.clearCache(!0),void(x&&cp(d,!1));for(var G=d;G;){if("relative"===G.__computedStyle[zd]){var H=G,W=H.ox,Y=H.oy;W&&e.__offsetX(W,!1,null),Y&&e.__offsetY(Y,!1,null);break}G=G.__domParent}var z=n&&e===r||0===e.offsetHeight;if(a&&z||n&&v)e.clearCache(!0);else{e.isShadowRoot&&(e=e.__hostRoot);var X,U=0,V=0,K=0;if(b.splice(0),M.splice(0),n||z){yp(E,M,b),dp(A,M,b),n||(M.push(o[Vd]),b.push(o[Kd]));var j=fp(M,b);U=j.target,V=j.diff}else{yp(E,M,b),M.push(o[Vd]);var Z=fp(M,b);U=Z.target,V=Z.diff,M.splice(0),b.splice(0),dp(A,M,b),b.push(o[Kd]),K=(Z=fp(M,b)).target,Z.diff}if(n)X=e===r||r.isShadowRoot&&r.__hostRoot===e?0:e.offsetHeight;else X=c?0:e.offsetHeight;!n&&V&&e.__offsetY(V,!0,lp);var q=U+K-g-m+X-p;if(q){var $=_p(d,Ud);$||d.__resizeY(q,lp);var J=[];for(pp(A,q,$,J),d.clearCache(!0);d&&!$&&"absolute"!==d.__computedStyle[zd];)A=d.__next,($=(d=d.__domParent)&&_p(d,Ud))||d.__resizeY(q,lp),pp(A,q,$,J),$&&d.clearCache(!0);J.forEach((function(t){var e=t.__layoutData,r=e.container;t.__domParent.__layoutAbs(r,e,t)}))}else d.clearCache(!0)}}},clearSvgCache:cp};function gp(t,e,r){if(Array.isArray(e))e.forEach((function(e){gp(t,e,r)}));else if(e instanceof Py){if(["canvas","svg","webgl"].indexOf(e.tagName)>-1)throw new Error("Can not nest canvas/svg/webgl");e.__parent=t,r.push(e)}else if(e instanceof Bh)e.__parent=t,r.push(e);else if(!G.isNil(e)&&""!==e){var i=new kh(e);i.__parent=t,r.push(i)}}function mp(t,e,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(Array.isArray(i))i.forEach((function(i){mp(t,e,r,i,a)}));else if(i instanceof Py||i instanceof Bh||i instanceof kh){if(i.__root=t,i.__parent=r,i.__domParent=r,i.__isDestroyed=!1,a.prev&&(a.prev.__next=i,i.__prev=a.prev),a.prev=i,!(i instanceof kh)){var n=i.props.ref;G.isString(n)&&n||G.isNumber(n)?e.ref[n]=i:n&&G.isFunction(n)&&n(i)}if(i instanceof Py&&i.__children)mp(t,e,i,i.__children,{});else if(i instanceof Bh){for(var o=i.render(),s=[];o&&o instanceof Bh;){s.push(o);var l=o.render();l&&(o.__shadow=l,l.__host=o),o=l}o instanceof v||(o=new kh(o)),s.length?(i.__shadow=s[0],s[0].__host=i,s.forEach((function(e){e.__shadowRoot=o,e.__hostRoot=i,e.__root=t,e.__domParent=r}))):(i.__shadow=o,o.__host=i),i.__shadowRoot=o,o.__hostRoot=i,o.__root=t,o.__domParent=r,o.__isDestroyed=!1,i.__init(),o instanceof Py&&o.__children&&mp(t,i,o,o.__children,{})}}return i}var bp={buildChildren:function(t,e){var r=[];return gp(t,e,r),r},buildRoot:function(t,e){t.__root=t,t.__host=t,mp(t,t,t,e,{})},relation:mp},Mp=Ct.STYLE_KEY,Ep=Mp.POSITION,Ap=Mp.DISPLAY,Sp=Mp.MARGIN_LEFT,Tp=Mp.MARGIN_TOP,wp=Mp.MARGIN_RIGHT,Rp=Mp.MARGIN_BOTTOM,kp=Mp.PADDING_LEFT,Cp=Mp.PADDING_BOTTOM,Op=Mp.PADDING_RIGHT,Ip=Mp.PADDING_TOP,Fp=Mp.BORDER_TOP_WIDTH,Lp=Mp.BORDER_BOTTOM_WIDTH,Dp=Mp.BORDER_RIGHT_WIDTH,Bp=Mp.BORDER_LEFT_WIDTH,Pp=Mp.TOP,Np=Mp.RIGHT,Gp=Mp.BOTTOM,Hp=Mp.LEFT,Wp=Mp.WIDTH,Yp=Mp.HEIGHT,zp=Mp.TEXT_ALIGN,Xp=Mp.FLEX_DIRECTION,Up=Mp.FLEX_BASIS,Vp=Mp.FLEX_SHRINK,Kp=Mp.FLEX_GROW,jp=Mp.ALIGN_SELF,Zp=Mp.ALIGN_ITEMS,qp=Mp.JUSTIFY_CONTENT,$p=Mp.Z_INDEX,Jp=Mp.WHITE_SPACE,Qp=Mp.LINE_HEIGHT,tx=Mp.LINE_CLAMP,ex=Mp.ORDER,rx=Mp.FLEX_WRAP,ix=Mp.ALIGN_CONTENT,ax=Mp.OVERFLOW,nx=Mp.FONT_SIZE,ox=Mp.FONT_FAMILY,sx=Mp.FONT_WEIGHT,lx=Mp.WRITING_MODE,hx=Ct.ELLIPSIS,ux=d.AUTO,cx=d.PX,fx=d.PERCENT,_x=d.REM,vx=d.VW,yx=d.VH,dx=d.VMAX,px=d.VMIN,xx=Ln.isRelativeOrAbsolute,gx=Ln.getBaseline,mx=Ln.getVerticalBaseline,bx=G.extend;G.isNil;var Mx=G.isFunction,Ex=G.assignMatrix,Ax=y.CANVAS,Sx=y.SVG,Tx=y.WEBGL,wx=g.isE,Rx=g.multiply;function kx(t){var e,r,i=[],a={},n=t.children;if(n.forEach((function(t,o){var s=t;t instanceof Bh&&(t=t.shadowRoot),t instanceof Py&&t.__isMask?void 0!==r?a[r].push(t):o&&(n[r=o-1].__iIndex=r,a[r]=[t],e=!0):(r=void 0,t instanceof Py?(s.__zIndex=t.currentStyle[$p],xx(t)?(s.__aIndex=!0,i.push(s)):(s.__aIndex=void 0,i.push(s))):(s.__zIndex=0,i.push(s)),s.__iIndex=o)})),i.sort((function(t,e){return t.__zIndex!==e.__zIndex?t.__zIndex-e.__zIndex:t.__aIndex!==e.__aIndex?t.__aIndex?1:-1:t.__iIndex-e.__iIndex})),e)for(var o=i.length-1;o>=0;o--){var s=i[o].__iIndex;a.hasOwnProperty(s)&&i.splice.apply(i,[o+1,0].concat(c(a[s])))}return i}function Cx(t){var e=[];return t.forEach((function(t,r){var i=t;t instanceof Bh&&(t=t.shadowRoot),i.__order=t instanceof Py?t.currentStyle[ex]:0,e.push(i),i.__iIndex=r})),e.sort((function(t,e){return t.__order!==e.__order?t.__order-e.__order:t.__iIndex-e.__iIndex})),e}function Ox(t,e,r,i,a,n){var o,s,l=t.computedStyle,h=t.root,u=h.renderMode,c=r.list;if(c.forEach((function(t){i-=n?t.outerHeight:t.outerWidth})),u!==Ax&&u!==Tx||(s=u===Tx?lt.getFontCanvas().ctx:h.ctx),u===Ax||u===Tx){var f=Ln.setFontStyle(l);s.font!==f&&(s.font=f),o=s.measureText(hx).width}else o=lt.measureTextSync(hx,l[ox],l[nx],l[sx]);for(var _=c.length-1;_>=0;_--){var v=c[_];if(!_||i+v.outerWidth>=o+1e-10){if(v instanceof nl){v.parent.__backtrack(t,e,r,v,i,a,o,l,s,u,n)}else{var y=new gl(v.x+v.outerWidth+a,v.y,o,t);e.addItem(y,!0)}break}if(v instanceof nl){var d=v.parent,p=d.textBoxes.indexOf(v);p>-1&&d.textBoxes.splice(p,1)}else v.__layoutNone();c.pop(),i+=n?v.outerHeight:v.outerWidth}}var Ix=function(t){function e(e,r,i){var a,n=s(a=t.call(this,e,r)||this).style;return n.display&&{flex:!0,block:!0,inline:!0,"inline-block":!0,inlineBlock:!0,none:!0}.hasOwnProperty(n.display)||(ed.INLINE.hasOwnProperty(a.tagName)?n.display="inline":n.display="block"),!n[sx]&&ed.BOLD.hasOwnProperty(e)&&(n.fontWeight=700),a.__style=Ln.normalize(n,mt.DOM_ENTRY_SET),a.__currentStyle=bx([],a.__style),a.__children=bp.buildChildren(s(a),i),a.__flexLine=[],a.__ellipsis=null,a.__zIndexChildren=null,a}return a(e,t),r(e,[{key:"__structure",value:function(t,r){var i=h(n(e.prototype),"__structure",this).call(this,t,r),a=[i],o=this.__zIndexChildren=this.__zIndexChildren||kx(this);o.forEach((function(e,r){var i=e.__structure(t+1,r);Array.isArray(i)?a=a.concat(i):a.push(i)}));var s=a.length-1;return i.num=o.length,i.total=s,a}},{key:"__modifyStruct",value:function(){var t,e=this.__struct,r=e.total||0,i=this.__root,a=i.__structs,n=this.__structure(e.lv,e.childIndex),o=a.indexOf(e);(t=i.__structs).splice.apply(t,[o,r+1].concat(c(n)));var s=0;if(this!==i&&(s=((e=this.__struct).total||0)-r))for(var l=this.__domParent;l;)l.__struct.total=l.__struct.total||0,l.__struct.total+=s,l=l.__domParent}},{key:"__insertStruct",value:function(t,e){var r,i,a=this.__struct,n=t.__structure(a.lv+1,e),o=this.__root.__structs,s=this.__zIndexChildren;if(e){var l=s[e-1].__struct,h=l.total||0;r=o.indexOf(l)+h+1}else r=o.indexOf(a)+1;Array.isArray(n)?(o.splice.apply(o,[r,0].concat(c(n))),i=(n[0].total||0)+1):(o.splice(r,0,n),i=(n.total||0)+1),r++;for(var u=s.length;r<u;r++)s[r].__struct.childIndex++;a.num++,a.total+=i;for(var f=this.__domParent;f;)(a=f.__struct).total=a.total||0,a.total+=i,f=f.__domParent}},{key:"__deleteStruct",value:function(t,e){var r=t.__struct,i=(r.total||0)+1,a=this.__root.__structs,n=a.indexOf(r);a.splice(n,i);for(var o=this.__zIndexChildren,s=e+1,l=o.length;s<l;s++)o[s].__struct.childIndex--;var h=this.__struct;h.num--,h.total=h.total||0,h.total-=i;for(var u=this.__domParent;u;)(h=u.__struct).total=h.total||0,h.total-=i,u=u.__domParent}},{key:"__updateStruct",value:function(){var t=this.__root.__structs,e=this.__struct,r=e.total||0,i=t.indexOf(e),a=this.__zIndexChildren=kx(this);if(1!==a.length){var n;a.forEach((function(t,e){t.__struct.childIndex=e}));for(var o=[],s=0,l=i+1;l<=i+r;l++){var h=t[l],u={cs:h,list:t.slice(l,l+(h.total||0)+1)};h.childIndex!==s++&&(n=!0),o.push(u),l+=h.total||0}if(n){var f=[];o.sort((function(t,e){return t.cs.childIndex-e.cs.childIndex})),o.forEach((function(t){f=f.concat(t.list)})),t.splice.apply(t,[i+1,r].concat(c(f)))}}}},{key:"__tryLayInline",value:function(t,e,r){this.__computeReflow();var i=this.flowChildren,a=this.currentStyle,n=a[Ap],o=a[Wp],s=a[Yp],l=a[Sp],h=a[wp],u=a[Tp],c=a[Rp],f=a[kp],_=a[Op],v=a[Ip],y=a[Cp],d=this.computedStyle,p=d[Bp],x=d[Dp],g=d[Fp],m=d[Lp];if("inline"===n){if(i.length){var b=i[0];b instanceof Bh&&(b=b.shadowRoot),b instanceof Py?t=b.__tryLayInline(t,e,r):t-=b.firstCharWidth}}else{if(o.u!==ux)t-=r?this.__calSize(s,e,!0):this.__calSize(o,e,!0);else for(var M=0;M<i.length;M++){if(t<0)return t;var E=i[M];E instanceof Bh&&(E=E.shadowRoot),E instanceof Py?t=E.__tryLayInline(t,e,r):t-=E.textWidth}r?(t-=this.__calSize(c,e,!0),t-=this.__calSize(y,e,!0),t-=m):(t-=this.__calSize(h,e,!0),t-=this.__calSize(_,e,!0),t-=x)}return r?(t-=this.__calSize(u,e,!0),t-=this.__calSize(v,e,!0),t-=g):(t-=this.__calSize(l,e,!0),t-=this.__calSize(f,e,!0),t-=p),t}},{key:"__offsetX",value:function(t,r,i){if("none"!==this.__computedStyle[Ap]){h(n(e.prototype),"__offsetX",this).call(this,t,r,i);var a=this.__ellipsis;a&&a.__offsetX(t,r),r&&!this.__isInline&&this.lineBoxManager&&this.lineBoxManager.__offsetX(t),this.flowChildren.forEach((function(e){e&&e.__offsetX(t,r,i)}))}}},{key:"__offsetY",value:function(t,r,i){if("none"!==this.__computedStyle[Ap]){h(n(e.prototype),"__offsetY",this).call(this,t,r,i);var a=this.__ellipsis;a&&a.__offsetY(t,r),r&&!this.__isInline&&this.lineBoxManager&&this.lineBoxManager.__offsetY(t),this.flowChildren.forEach((function(e){e&&e.__offsetY(t,r,i)}))}}},{key:"__calBasis",value:function(t,e,r,i,a){var n=this;this.__computeReflow();var o,s=0,l=0,h=0,c=this.flowChildren,f=this.currentStyle,_=this.computedStyle,v=i.x,y=i.y,d=i.w,p=i.h,x=f[Xp],g=f[Up],m=f[Wp],b=f[Yp],M=_[Qp],E=_[Ap],A=_[tx],S=0===_[lx].indexOf("vertical"),T=t?m:b,w=g.u===ux,R=[cx,fx,_x,vx,yx,dx,px].indexOf(g.u)>-1,k=!w&&!R;R?s=o=this.__calSize(g,t?d:p,!0):w&&[cx,fx,_x,vx,yx,dx,px].indexOf(T.u)>-1?s=o=this.__calSize(T,t?d:p,!0):w&&(k=!0);var C=0,O=0;if(A=A||0,t){if("flex"===E){var I=-1===["column","columnReverse"].indexOf(x);(c=Cx(c)).forEach((function(i){if(i instanceof Py||i instanceof Bh&&i.shadowRoot instanceof Py){var a=u(i.__calBasis(t,e,r,{x:v,y:y,w:d,h:p},!1),3),o=a[1],s=a[2];I?(l+=o,h+=s):(l=Math.max(l,o),h=Math.max(h,s))}else{if(S){var c=n.__lineBoxManager=new td(v,y,M,S?mx(_):gx(_),S);i.__layoutFlow({x:v,y:y,w:d,h:p,lineBoxManager:c,lineClamp:A,isUpright:S}),l+=i.width,h+=i.width}I?(l+=i.charWidth,h+=i.textWidth):(l=Math.max(l,i.charWidth),h=Math.max(h,i.textWidth))}}))}else if(S){var F=this.__lineBoxManager=new td(v,y,M,S?mx(_):gx(_),S);this.__layoutFlow({x:v,y:y,w:d,h:p,lineBoxManager:F,lineClamp:A,isUpright:S},e,!1,!0),l=h=s=this.width}else{var L=i.lineBoxManager;"inline"!==E&&(L=this.__lineBoxManager=new td(v,y,M,S?mx(_):gx(_),S)),c.forEach((function(i){if(i instanceof Py||i instanceof Bh&&i.shadowRoot instanceof Py){var a=u(i.__calBasis(t,e,r,{x:v,y:y,w:d,h:p,lineBoxManager:L},!1),3),n=a[1],o=a[2],s=i.computedStyle[Ap];"block"===s||"flex"===s?(l=Math.max(l,n),h=Math.max(h,o),C=O=0):(C+=n,O+=o,l=Math.max(l,C),h=Math.max(h,O))}else C+=i.charWidth,O+=i.textWidth,l=Math.max(l,C),h=Math.max(h,O)}))}o&&(h=Math.max(o,h)),k&&(s=h)}else this.__layoutFlow({x:v,y:y,w:d,h:p,isUpright:S},e,!0,!1),l=h=s=this.height;return this.__addMBP(t,d,f,_,[s,l,h],a)}},{key:"__layout",value:function(t,r,i,a){h(n(e.prototype),"__layout",this).call(this,t,r,i,a),this.__layoutStyle()}},{key:"__layoutStyle",value:function(){h(n(e.prototype),"__layoutStyle",this).call(this),this.flowChildren.forEach((function(t){t instanceof kh||t.__layoutStyle()}))}},{key:"__layoutNone",value:function(){h(n(e.prototype),"__layoutNone",this).call(this),this.children.forEach((function(t){(t instanceof Py||t instanceof Bh&&t.shadowRoot instanceof Py)&&t.__layoutNone()}))}},{key:"__layoutBlock",value:function(t,e,r,i){var a=this,n=this.flowChildren,o=this.currentStyle,s=this.computedStyle,l=s[zp],h=s[Jp],u=s[tx],c=s[Qp],f=s[ax],_=this.__preLayout(t,!1),v=_.fixedWidth,y=_.fixedHeight,d=_.x,p=_.y,x=_.w,g=_.h,m=_.isParentVertical,b=_.isUpright;if(e&&(v&&!b||y&&b))b?this.__ioSize(void 0,g):this.__ioSize(x,void 0);else if(r&&y)this.__ioSize(void 0,g);else if(i&&v)this.__ioSize(x,void 0);else{u=u||0;var M,E,A=0,S=this.__lineBoxManager=new td(d,p,c,b?mx(s):gx(s),b),T=0,w=0,R=d,k=p,C=[],O=[],I=n.length;n.forEach((function(t,n){var o=t instanceof Py||t instanceof Bh&&t.shadowRoot instanceof Py;o&&t.__computeReflow();var s=o&&"inline"===t.computedStyle[Ap],l=o&&"inlineBlock"===t.computedStyle[Ap],c=s&&t.__isRealInline(),_=A;if(!o||s||l){if(C.length&&O.length){var v=xp.getMergeMargin(O,C).diff;v&&(b?d+=v:p+=v)}O=[],C=[]}if(o)if(l||s){if(M||E)return void t.__layoutNone();if(b&&p===k||!b&&d===R||!n||"nowrap"===h)A=t.__layoutFlow({x:d,y:p,w:x,h:g,lx:R,ly:k,lineBoxManager:S,lineClamp:u,lineClampCount:A,isUpright:b},e,r,i),t.__isIbFull&&A++,(b&&t.__isUprightIbFull||!b&&t.__isIbFull)&&"nowrap"!==h?(S.addItem(t,!0),b?(d+=t.outerWidth,p=k):(d=R,p+=t.outerHeight),S.setNotEnd()):((l||!c)&&S.addItem(t,!1),d=S.lastX,p=S.lastY),!e&&"hidden"===f&&"nowrap"===h&&(b&&p-k>g+1e-10||!b&&d-R>x+1e-10||A>_)?E=!0:u&&A>=u&&(M=!0),e&&("nowrap"===h?w+=b?t.outerHeight:t.outerWidth:(w=b?t.outerHeight:t.outerWidth,A>_&&(w=Math.max(w,b?g:x))),T=Math.max(T,w));else if(t.__tryLayInline(b?g+k-p:x+R-d,b?g:x,b)>=-1e-10)A=t.__layoutFlow({x:d,y:p,w:x,h:g,lx:R,ly:k,lineBoxManager:S,lineClamp:u,lineClampCount:A,isUpright:b},e,r,i),(l||!c)&&S.addItem(t,!1),d=S.lastX,p=S.lastY,u&&A>=u&&(M=!0),e&&(l||A===_?(w+=b?t.outerHeight:t.outerWidth,T=Math.max(T,w)):(T=Math.max(T,b?g:x),w=b?p-k:d-R,T=Math.max(T,w)));else{if(A++,b?(d=S.endX,p=k):(d=R,p=S.endY),S.setNewLine(),u&&A>=u){t.__layoutNone(),M=!0;var y=S.list,m=y[y.length-1];return void Ox(a,S,m,b?g:x,0,b)}A=t.__layoutFlow({x:d,y:p,w:x,h:g,lx:R,ly:k,lineBoxManager:S,lineClamp:u,lineClampCount:A,isUpright:b},e,r,i),t.__isIbFull||t.__isUprightIbFull?(S.addItem(t,!1),b?(d+=t.outerWidth,p=k):(d=R,p+=t.outerHeight),S.setNotEnd(),A++):((l||!c)&&S.addItem(t,!1),d=S.lastX,p=S.lastY),u&&A>=u&&(M=!0),e&&(T=Math.max(T,w),T=Math.max(T,b?g:x),w=b?t.outerHeight:t.outerWidth,T=Math.max(T,w))}}else{E=!1,(b&&p>k||!b&&d>R)&&A++,u&&A>=u&&(M=!0),b?p=k:d=R,S.isEnd&&(b?d=S.endX:p=S.endY,S.setNotEnd(),S.setNewLine()),t.__layoutFlow({x:d,y:p,w:x,h:g,isUpright:b},e,r,i);var F,L="none"===t.currentStyle[Ap];if(!L&&t.flowChildren&&0===t.flowChildren.length){var D=t.computedStyle,B=D[Tp],P=D[wp],N=D[Rp],G=D[Sp],H=D[Ip],W=D[Op],Y=D[Cp],z=D[kp],X=D[Wp],U=D[Yp],V=D[Fp],K=D[Dp],j=D[Lp],Z=D[Bp];b&&z<=0&&W<=0&&X<=0&&Z<=0&&K<=0?(C.push(P),O.push(G),F=!0):!b&&H<=0&&Y<=0&&U<=0&&V<=0&&j<=0&&(C.push(N),O.push(B),F=!0)}if(b?(d+=t.outerWidth,S.__lastX=d):(p+=t.outerHeight,S.__lastY=p),e&&(T=Math.max(T,b?t.outerHeight:t.outerWidth),w=0),L||F){if(n===I-1){var q=xp.getMergeMargin(O,C).diff;q&&(b?d+=q:p+=q)}}else{var $=t.computedStyle,J=$[Tp],Q=$[wp],tt=$[Rp],et=$[Sp];if(C.length)if(b){O.push(et);var rt=xp.getMergeMargin(O,C).diff;rt&&(t.__offsetX(rt,!0,null),d+=rt)}else{O.push(J);var it=xp.getMergeMargin(O,C).diff;it&&(t.__offsetY(it,!0,null),p+=it)}O=[],C=[b?Q:tt]}}else{if(M||E)return void t.__layoutNone();if(b&&p===k||!b&&d===R||!n||"nowrap"===h)A=t.__layoutFlow({x:d,y:p,w:x,h:g,lx:R,ly:k,lineBoxManager:S,lineClamp:u,lineClampCount:A,isUpright:b}),d=S.lastX,p=S.lastY,!e&&"hidden"===f&&"nowrap"===h&&(b&&p-k>g+1e-10||!b&&d-R>x+1e-10||A>_)?E=!0:u&&A>=u&&(M=!0),e&&("nowrap"===h?w+=b?t.height:t.width:(w=b?t.height:t.width,A>_&&(w=Math.max(w,b?g:x))),T=Math.max(T,w));else if(t.__tryLayInline(b?g+k-p:x+R-d)>=-1e-10)A=t.__layoutFlow({x:d,y:p,w:x,h:g,lx:R,ly:k,lineBoxManager:S,lineClamp:u,lineClampCount:A,isUpright:b}),d=S.lastX,p=S.lastY,u&&A>=u&&(M=!0),e&&(A===_?(w+=b?t.height:t.width,T=Math.max(T,w)):(T=Math.max(T,b?g:x),w=b?p-k:d-R,T=Math.max(T,w)));else{if(A++,b?(d=S.endX,p=k):(d=R,p=S.endY),S.setNewLine(),u&&A>=u){t.__layoutNone(),M=!0;var at=S.list,nt=at[at.length-1];return void Ox(a,S,nt,b?g:x,0,b)}A=t.__layoutFlow({x:d,y:p,w:x,h:g,lx:R,ly:k,lineBoxManager:S,lineClamp:u,lineClampCount:A,isUpright:b}),d=S.lastX,p=S.lastY,u&&A>=u&&(M=!0),e&&(T=Math.max(T,w),T=Math.max(T,b?g:x),w=b?t.height:t.width,T=Math.max(T,w))}}})),S.isEnd&&(b?d=S.endX:p=S.endY);var F=0,L=0;if(F=v||!e&&!m&&!b?x:e?b?d-t.x:T:d-t.x,L=y||!e&&m&&b?g:e&&b?T:p-t.y,this.__ioSize(F,L),!e){var D=S.verticalAlign(b);if(D){b&&!v?this.__resizeX(D,null):b||y||this.__resizeY(D,null);var B=0,P=S.spreadList,N=!1,G=!1;n.forEach((function(t){if((t instanceof Py||t instanceof Bh&&t.shadowRoot instanceof Py)&&["block","flex"].indexOf(t.computedStyle[Ap])>-1){if(!G)return;N=!0,b?t.__offsetX(P[B],!0,null):t.__offsetY(P[B],!0,null)}else G=!0,N&&B++,N=!1}))}r||i||(["center","right"].indexOf(l)>-1&&(S.horizonAlign(b?L:F,l,b),n.forEach((function(t){t instanceof Bh&&(t=t.shadowRoot),t instanceof kh&&t.__inlineSize(b)}))),S.domList.forEach((function(t){t.__inlineSize(b?L:F,l,b)})),this.__marginAuto(o,t,b))}}}},{key:"__layoutFlex",value:function(t,e,r,i){var a=this,n=this.flowChildren,o=this.currentStyle,s=this.computedStyle,l=this.__flexLine,h=s[Xp],c=s[qp],f=s[Zp],_=s[tx],v=s[rx],y=s[ix],d=s[Qp],p=s[zp],x=this.__preLayout(t,!1),g=x.fixedWidth,m=x.fixedHeight,b=x.x,M=x.y,E=x.w,A=x.h,S=x.isParentVertical,T=x.isUpright;if(e&&(g&&!T||m&&T))T?this.__ioSize(void 0,A):this.__ioSize(E,void 0);else if(r&&m)this.__ioSize(void 0,A);else if(i&&g)this.__ioSize(E,void 0);else{l.splice(0),_=_||0;var w=-1===["column","columnReverse"].indexOf(h),R=[],k=[],C=[],O=[],I=[],F=Cx(n);F.forEach((function(t){if(t instanceof Py||t instanceof Bh&&t.shadowRoot instanceof Py){var a=t.currentStyle,n=t.computedStyle,o=u(t.__calBasis(w,e,r,{x:b,y:M,w:E,h:A},!0),3),l=o[0],h=o[1],c=o[2],f=a[Kp],v=a[Vp];n[Up]=l,R.push(f),k.push(v),C.push(l),O.push(c),I.push(h)}else if(R.push(0),k.push(1),w&&T||!w&&!T){var y=new td(b,M,d,T?mx(s):gx(s),T);t.__layoutFlow({x:b,y:M,w:E,h:A,lineBoxManager:y,lineClamp:_,lineClampCount:0,isUpright:T},e,r,i);var p=T?t.width:t.height;C.push(p),O.push(p),I.push(p)}else{var x=t.charWidth,g=t.textWidth;C.push(g),O.push(g),I.push(x)}}));var L=w?E:A,D=["wrap","wrapReverse"].indexOf(v)>-1,B=[],P=0,N=[];C.forEach((function(t,e){var r,i=I[e],a=O[e];r=t<i?i:t>a?a:t,N.push(r),D?P+r>L?P?(l.push(B),B=[F[e]],P=r):(B.push(F[e]),l.push(B),B=[],P=0):(B.push(F[e]),P+=r):B.push(F[e])})),B.length&&l.push(B);var G=0,H={x:b,y:M,w:E,h:A},W=[],Y=[],z=[];if(l.forEach((function(t){var n=t.length,o=G+n,l=u(a.__layoutFlexLine(H,w,e,r,i,T,L,g,m,_,0,d,s,c,f,F.slice(G,o),t,p,R.slice(G,o),k.slice(G,o),C.slice(G,o),N.slice(G,o),I.slice(G,o),O.slice(G,o)),5),h=l[0],v=l[1],y=l[2],x=l[3],E=l[4];w?H.y=v:H.x=h,b=Math.max(b,h),M=Math.max(M,v),W.push(y),Y.push(x),z.push(E),G+=n})),e){var X=0;return l.forEach((function(t){var e=0;t.forEach((function(t){w?e+=T?t.outerHeight:t.outerWidth:e=Math.max(e,T?t.outerHeight:t.outerWidth),t instanceof kh&&(T?t.textWidth>A&&(X=Math.max(X,A)):t.textWidth>E&&(X=Math.max(X,E)))})),X=Math.max(X,e)})),void(T?this.__ioSize(void 0,X):this.__ioSize(X,void 0))}var U=0,V=0;if(U=g||!e&&!S&&!T?E:b-t.x,V=m||!e&&S&&T?A:M-t.y,this.__ioSize(U,V),!r&&!i){"rowReverse"===h?l.forEach((function(e){e.forEach((function(e){var r=U-e.outerWidth-2*(e.x-t.x);r&&e.__offsetX(r,!0,null)}))})):"columnReverse"===h&&l.forEach((function(e){e.forEach((function(e){var r=V-e.outerHeight-2*(e.y-t.y);r&&e.__offsetY(r,!0,null)}))}));var K,j=l.length;if("wrapReverse"===v&&j>1){var Z=0,q=[];W.forEach((function(t){q.push(Z),Z+=t}));for(var $=0,J=function(t){var e=l[t],r=q[t],i=$-r;i&&e.forEach((function(t){w?t.__offsetY(i,!0,null):t.__offsetX(i,!0,null)})),$+=W[t]},Q=j-1;Q>=0;Q--)J(Q);l.reverse()}if(j>1&&(m&&w||!w)){var tt=w?V-(M-t.y):U-(b-t.x);if(tt>0)if("center"===y){var et=.5*tt;F.forEach((function(t){w?t.__offsetY(et,!0,null):t.__offsetX(et,!0,null)}))}else if("flexStart"===y);else if("flexEnd"===y)F.forEach((function(t){w?t.__offsetY(tt,!0,null):t.__offsetX(tt,!0,null)}));else if("spaceBetween"===y){var rt=tt/(j-1);l.forEach((function(t,e){e&&t.forEach((function(t){w?t.__offsetY(rt,!0,null):t.__offsetX(rt,!0,null)}))}))}else if("spaceAround"===y){var it=tt/(j+1);l.forEach((function(t,e){t.forEach((function(t){w?t.__offsetY(it*(e+1),!0,null):t.__offsetX(it*(e+1),!0,null)}))}))}else K=tt/j,l.forEach((function(t,e){e&&t.forEach((function(t){w?t.__offsetY(K*e,!0,null):t.__offsetX(K*e,!0,null)}))}))}if(!r&&!i){if(j>1)l.forEach((function(t,e){var r=W[e];K&&(r+=K),a.__flexAlign(t,f,c,w,r,Y[e],z[e])}));else if(j){var at=w?V:U;this.__flexAlign(l[0],f,c,w,at,Y[0],z[0])}this.__marginAuto(o,t,T)}}}}},{key:"__layoutFlexLine",value:function(t,e,r,i,a,n,o,s,l,h,u,c,f,_,v,y,d,p,x,g,m,b,M,E){var A=this,S=t.x,T=t.y,w=t.w,R=t.h,k=0;b.forEach((function(t){k+=t}));var C=k>=o,O=[];m.forEach((function(t,e){C?(!g[e]||m[e]<b[e])&&(O[e]=b[e]):(!x[e]||m[e]>b[e])&&(O[e]=b[e])}));var I=0;m.forEach((function(t,e){void 0!==O[e]?I+=O[e]:I+=t}));var F=1/0;F=e?w:l?R:I,I=Math.abs(F-I);var L=0,D=0;C?function(){for(var t=g.map((function(t,e){if(void 0===O[e])return D+=t,t}));0!==D;){D<1&&(L+=I*(1-D),I*=D);var e=void 0,r=0,i=0,a=0;if(t.forEach((function(n,o){if(n){var s=n/D*I,l=m[o]-s;l<M[o]?(O[o]=M[o],t[o]=0,e=!0,i+=m[o]-M[o]):(O[o]=l,r+=n,a+=l)}})),!e){I-=a;break}I-=i,D=r}}():function(){for(var t=x.map((function(t,e){if(void 0===O[e])return D+=t,t}));0!==D;){D<1&&(L+=I*(1-D),I*=D);var e=void 0,r=0,i=0,a=0;if(t.forEach((function(n,o){if(n){var s=n/D*I,l=m[o]+s;l<M[o]?(O[o]=M[o],t[o]=0,e=!0,i+=m[o]-M[o]):(O[o]=l,r+=n,a+=l)}})),!e){I-=a;break}I-=i,D=r}}();var B=0,P=[],N=0;return y.forEach((function(t,o){var s=O[o];if(t instanceof Py||t instanceof Bh&&t.shadowRoot instanceof Py){if(e)t.__layoutFlow({x:S,y:T,w:s,h:R,w3:s,isUpright:n},r,i,a);else{var l,_=t.currentStyle,y=_[jp],d=_[Wp];if(r||i||a)t.__layoutFlow({x:S,y:T,w:w,h:s,h3:s,isUpright:n},r,i,a);else(d.u!==ux||"stretch"===y||"auto"===y&&"stretch"===v)&&(l=!0),l?t.__layoutFlow({x:S,y:T,w:w,h:s,h3:s,isUpright:n},r,i,a):(t.__layoutFlow({x:S,y:T,w:w,h:s,h3:s,isUpright:n},!0,i,a),t.__layoutFlow({x:S,y:T,w:w,w3:t.outerWidth,h:s,h3:s,isUpright:n},r,i,a))}if(!r&&!i&&!a){var p=t.currentStyle;e?(p[Sp].u===ux&&N++,p[wp].u===ux&&N++):(p[Tp].u===ux&&N++,p[Rp].u===ux&&N++)}}else{var x=A.__lineBoxManager=new td(S,T,c,n?mx(f):gx(f),n);P.push(x),t.__layoutFlow({x:S,y:T,w:e?s:w,h:e?R:s,lineBoxManager:x,lineClamp:h,lineClampCount:u,isUpright:n})}e?(S+=t.outerWidth,B=Math.max(B,t.outerHeight)):(T+=t.outerHeight,B=Math.max(B,t.outerWidth))})),e?T+=B:S+=B,!r&&!i&&!a&&["center","right"].indexOf(p)>-1&&P.forEach((function(t){t.horizonAlign(n?t.height:t.width,p,n)})),[S,T,B,N,C?0:Math.max(0,I+L)]}},{key:"__flexAlign",value:function(t,e,r,i,a,n,o){var s=0;t.forEach((function(t){s=Math.max(s,t.firstBaseline)}));var l=t.length;if(n)for(var h=0,u=o/n,c=0;c<l;c++){var f=t[c],_=f.currentStyle;i?(_[Sp].u===ux?(h+=u,f.__offsetX(h,!0,null)):h&&f.__offsetX(h,!0,null),_[wp].u===ux&&(h+=u)):(_[Tp].u===ux?(h+=u,f.__offsetY(h,!0,null)):h&&f.__offsetY(h,!0,null),_[Rp].u===ux&&(h+=u))}else if("flexEnd"===r)for(var v=0;v<l;v++){var y=t[v];i?y.__offsetX(o,!0,null):y.__offsetY(o,!0,null)}else if("center"===r)for(var d=.5*o,p=0;p<l;p++){var x=t[p];i?x.__offsetX(d,!0,null):x.__offsetY(d,!0,null)}else if("spaceBetween"===r)for(var g=o/(l-1),m=1;m<l;m++){var b=t[m];i?b.__offsetX(g*m,!0,null):b.__offsetY(g*m,!0,null)}else if("spaceAround"===r)for(var M=.5*o/l,E=0;E<l;E++){var A=t[E];i?A.__offsetX(M*(2*E+1),!0,null):A.__offsetY(M*(2*E+1),!0,null)}else if("spaceEvenly"===r)for(var S=o/(l+1),T=0;T<l;T++){var w=t[T];i?w.__offsetX(S*(T+1),!0,null):w.__offsetY(S*(T+1),!0,null)}t.forEach((function(t){var r=t.currentStyle[jp];if(i)if("flexStart"===r);else if("flexEnd"===r){var n=a-t.outerHeight;0!==n&&t.__offsetY(n,!0,null)}else if("center"===r){var o=a-t.outerHeight;0!==o&&t.__offsetY(.5*o,!0,null)}else if("stretch"===r){var l=t.computedStyle,h=t.currentStyle[Yp],u=l[Fp],c=l[Lp],f=l[Tp],_=l[Rp],v=l[Ip],y=l[Cp];if(h.u===ux){var d=t.height,p=(t.__height=l[Yp]=a-f-_-v-y-u-c)-d;t.__sy4+=p,t.__sy5+=p,t.__sy6+=p,t.__height+=p,t.__clientHeight+=p,t.__offsetHeight+=p,t.__outerHeight+=p}}else if("baseline"===r){var x=s-t.firstBaseline;0!==x&&t.__offsetY(x,!0,null)}else if("flexStart"===e);else if("center"===e){var g=a-t.outerHeight;0!==g&&t.__offsetY(.5*g,!0,null)}else if("flexEnd"===e){var m=a-t.outerHeight;0!==m&&t.__offsetY(m,!0,null)}else if("baseline"===e){var b=s-t.firstBaseline;0!==b&&t.__offsetY(b,!0,null)}else{var M=t.computedStyle,E=t.currentStyle,A=E[Ap],S=E[Xp],T=E[Yp];i&&"flex"===A&&"column"===S&&T.u===ux&&t.outerHeight<a&&t.__layoutFlow(Object.assign(t.__layoutData,{h3:a}));var w=M[Fp],R=M[Lp],k=M[Tp],C=M[Rp],O=M[Ip],I=M[Cp];if(T.u===ux){var F=t.height,L=a-k-C-O-I-w-R-F;t.__sy4+=L,t.__sy5+=L,t.__sy6+=L,t.__height+=L,t.__clientHeight+=L,t.__offsetHeight+=L,t.__outerHeight+=L}}else if("flexStart"===r);else if("flexEnd"===r){var D=a-t.outerWidth;0!==D&&t.__offsetX(D,!0,null)}else if("center"===r){var B=a-t.outerWidth;0!==B&&t.__offsetX(.5*B,!0,null)}else if("stretch"===r){var P=t.computedStyle,N=t.currentStyle[Wp],G=P[Dp],H=P[Bp],W=P[wp],Y=P[Sp],z=P[Op],X=P[kp];if(N.u===ux){var U=t.width,V=(t.__width=P[Wp]=a-Y-W-X-z-G-H)-U;t.__sx4+=V,t.__sx5+=V,t.__sx6+=V,t.__width+=V,t.__clientWidth+=V,t.__offsetWidth+=V,t.__outerWidth+=V}}else if("baseline"===e){var K=s-t.firstBaseline;0!==K&&t.__offsetX(K,!0,null)}else if("flexStart"===e);else if("center"===e){var j=a-t.outerWidth;0!==j&&t.__offsetX(.5*j,!0,null)}else if("flexEnd"===e){var Z=a-t.outerWidth;0!==Z&&t.__offsetX(Z,!0,null)}else if("baseline"===e){var q=s-t.firstBaseline;0!==q&&t.__offsetX(q,!0,null)}else{var $=t.computedStyle,J=t.currentStyle[Wp],Q=$[Dp],tt=$[Bp],et=$[wp],rt=$[Sp],it=$[Op],at=$[kp];if(J.u===ux){var nt=t.width,ot=(t.__width=$[Wp]=a-rt-et-at-it-Q-tt)-nt;t.__sx4+=ot,t.__sx5+=ot,t.__sx6+=ot,t.__width+=ot,t.__clientWidth+=ot,t.__offsetWidth+=ot,t.__outerWidth+=ot}}}))}},{key:"__layoutInline",value:function(t,e,r,i,a){var n=this.flowChildren,o=this.currentStyle,s=this.computedStyle,l=s[zp],h=s[Jp],u=s[tx],c=s[Qp],f=s[Tp],_=s[Rp],v=s[Sp],y=s[wp],d=s[Fp],p=s[Lp],x=s[Bp],g=s[Dp],m=s[Ip],b=s[Cp],M=s[kp],E=s[Op],A=t.lineClampCount||0,S=this.__preLayout(t,a),T=S.fixedWidth,w=S.fixedHeight,R=S.x,k=S.y,C=S.w,O=S.h,I=S.lx,F=S.ly,L=S.lineBoxManager,D=S.endSpace,B=S.selfEndSpace,P=S.isUpright;if(e&&(T&&!P||w&&P))return P?this.__ioSize(void 0,O):this.__ioSize(C,void 0),A;var N=o[Wp],G=o[Yp];if(a&&!this.__isRealInline()&&(a=!1),!a){if(r&&w)return this.__ioSize(void 0,O),A;if(i&&T)return this.__ioSize(C,void 0),A}if(a){this.__isInline=!0,this.__lineBoxManager=L;var H=P?mx(s):gx(s);(P&&(f||_||m||b||d||p)||!P&&(v||y||M||E||x||g))&&L.isNewLine?L.genLineBoxByInlineIfNewLine(R,k,c,H):L.setLbByInlineIfNotNewLine(c,H),u=t.lineClamp||0}else L=this.__lineBoxManager=new td(R,k,c,P?mx(s):gx(s),P),I=R,F=k,D=B=A=0;a&&(this.contentBoxList.splice(0),L.pushContentBoxList(this));for(var W=this;"inline"===W.computedStyle[Ap];)W=W.domParent;var Y,z,X,U=W.computedStyle[ax],V=!1,K=!1,j=n.length,Z=!1,q=!1;if(n.forEach((function(t,n){if(Z||q)t.__layoutNone();else{var o=t instanceof Py||t instanceof Bh&&t.shadowRoot instanceof Py;o&&t.__computeReflow();var s=o&&"inline"===t.computedStyle[Ap],l=o&&"inlineBlock"===t.computedStyle[Ap],c=s&&t.__isRealInline();a&&!Y&&("nowrap"===h||!o&&n===j-1||u&&n===j-1||A===u-1)&&(Y=!0,D+=B);var f=A;if(o){if(s||l||(t.currentStyle[Ap]=t.computedStyle[Ap]="inlineBlock",l=!0,lt.warn("Inline can not contain block/flex")),P&&k===F||!P&&R===I||!n||"nowrap"===h)A=t.__layoutFlow({x:R,y:k,w:C,h:O,lx:I,ly:F,lineBoxManager:L,endSpace:D,lineClamp:u,lineClampCount:A,isUpright:P},e,r,i),(t.__isIbFull||t.__isUprightIbFull)&&A++,t.__isIbFull&&"nowrap"!==h?(P&&O.u===ux?K=!0:P||C.u!==ux||(V=!0),L.addItem(t,!0),P?(R+=t.outerWidth,k=F):(R=I,k+=t.outerHeight),L.setNotEnd()):((l||!c)&&L.addItem(t,!1),R=L.lastX,k=L.lastY),!e&&"hidden"===U&&"nowrap"===h&&(P&&k-F>O+1e-10||!P&&R-I>C+1e-10||A>f)?q=!0:u&&A>=u&&(Z=!0);else if(t.__tryLayInline(P?O+F-k-D:C+I-R-D,P?O:C,P)>=-1e-10)A=t.__layoutFlow({x:R,y:k,w:C,h:O,lx:I,ly:F,lineBoxManager:L,endSpace:D,lineClamp:u,lineClampCount:A,isUpright:P},e,r,i),(l||!c)&&L.addItem(t,!1),R=L.lastX,k=L.lastY,u&&A>=u&&(Z=!0);else{if(A++,P?(R=L.endX,k=F):(R=I,k=L.endY),L.setNewLine(),u&&A>=u){t.__layoutNone(),Z=!0;var _=L.list,v=_[_.length-1];return void Ox(W,L,v,C,D,P)}A=t.__layoutFlow({x:R,y:k,w:C,h:O,lx:I,ly:F,lineBoxManager:L,endSpace:D,lineClamp:u,lineClampCount:A,isUpright:P},e,r,i),t.__isIbFull||t.__isUprightIbFull?(L.addItem(t,!0),P?(R+=t.outerWidth,k=F):(R=I,k+=t.outerHeight),L.setNotEnd(),A++):((l||!c)&&L.addItem(t,!1),R=L.lastX,k=L.lastY),u&&A>=u&&(Z=!0)}}else{var y=L.size;if(P&&k===F||!P&&R===I||!n||"nowrap"===h)A=t.__layoutFlow({x:R,y:k,w:C,h:O,lx:I,ly:F,lineBoxManager:L,endSpace:D,lineClamp:u,lineClampCount:A,isUpright:P},e,r,i),R=L.lastX,k=L.lastY,!a&&L.size-y>1&&(G.u===ux&&P&&(K=!0),N.u!==ux||P||(V=!0)),!e&&"hidden"===U&&"nowrap"===h&&(P&&k-F>O+1e-10||!P&&R-I>C+1e-10||A>f)?q=!0:u&&A>=u&&(Z=!0);else if(t.__tryLayInline(P?O+F-k-D:C+I-R-D)>=-1e-10)A=t.__layoutFlow({x:R,y:k,w:C,h:O,lx:I,ly:F,lineBoxManager:L,endSpace:D,lineClamp:u,lineClampCount:A,isUpright:P},e,r,i),R=L.lastX,k=L.lastY,u&&A>=u&&(Z=!0);else{if(A++,P?(R=L.endX,k=F):(R=I,k=L.endY),L.setNewLine(),u&&A>=u){t.__layoutNone(),Z=!0;var d=L.list,p=d[d.length-1];return void Ox(W,L,p,C,D,P)}A=t.__layoutFlow({x:R,y:k,w:C,h:O,lx:I,ly:F,lineBoxManager:L,endSpace:D,lineClamp:u,lineClampCount:A,isUpright:P},e,r,i),R=L.lastX,k=L.lastY,!a&&L.size-y>1&&(G.u===ux&&P&&(K=!0),N.u!==ux||P||(V=!0)),u&&A>=u&&(Z=!0)}}}})),P?R=L.endX:k=L.endY,this.__isIbFull=V,this.__isUprightIbFull=K,a){if(B&&(P?L.addY(B):L.addX(B)),!n.length){var $=s[Tp],J=s[Sp],Q=s[Ip],tt=s[kp],et=s[Fp],rt=s[Bp];P?L.addY($+Q+et):L.addX(J+tt+rt)}L.popContentBoxList(),e&&this.__inlineSize(0,"left",P)}else{var it=L.max-(P?t.y:t.x);P?(z=T?C:R-t.x,X=w?O:V?Math.max(O,it):it):(z=T?C:V?Math.max(C,it):it,X=w?O:k-t.y),this.__ioSize(z,X)}if(!e&&!a){var at=L.verticalAlign(P);at&&(P&&!T?this.__resizeX(at,null):P||w||this.__resizeY(at,null)),r||i||(["center","right"].indexOf(l)>-1&&(L.horizonAlign(P?X:z,l,P),n.forEach((function(t){t instanceof Bh&&(t=t.shadowRoot),t instanceof kh&&t.__inlineSize(P)}))),L.domList.forEach((function(t){t.__inlineSize(P?X:z,l,P)})))}return A}},{key:"__inlineSize",value:function(t,e,r){var i=this.contentBoxList,a=this.computedStyle,n=this.__ox,o=this.__oy,s=a[Ap],l=a[Tp],h=a[wp],u=a[Rp],c=a[Sp],f=a[Ip],_=a[Op],v=a[Cp],y=a[kp],d=a[Fp],p=a[Dp],x=a[Lp],g=a[Bp],m=a[Qp];if("none"!==s){var b,M,E,A,S,T,w,R,k,C,O,I,F,L,D,B,P=i.length;if(P)i.forEach((function(t,e){e?(E=Math.min(E,t.x),w=Math.min(w,t.x),O=Math.min(O,t.x),D=Math.min(D,t.x),e===P-1?(b=S=k=F=Math.max(b,t.x+t.outerWidth),M=T=C=L=Math.max(M,t.y+t.outerHeight),S+=_,T+=v,k+=_+p,C+=v+x,F+=p+_+h,L+=x+v+u):b=S=k=F=Math.max(b,t.x+t.outerWidth)):(E=t.x,A=t.y,D=(O=(w=E-y)-g)-c,B=(I=(R=A-f)-d)-l,b=S=k=F=t.x+t.outerWidth,M=T=C=L=t.y+t.outerHeight,e===P-1&&(S+=_,T+=v,k+=_+p,C+=v+x,F+=p+_+h,L+=x+v+u))})),this.__x=D,this.__y=B,this.__width=a[Wp]=b-E,this.__height=a[Yp]=Math.max(m,M-A),this.__clientWidth=S-w,this.__clientHeight=T-R,this.__offsetWidth=k-O,this.__offsetHeight=C-I,this.__outerWidth=F-D,this.__outerHeight=L-B,this.__sx=D+n,this.__sy=B+o,this.__sx1=O+n,this.__sy1=I+o,this.__sx2=w+n,this.__sy2=R+o,this.__sx3=E+n,this.__sy3=A+o,this.__sx4=b+n,this.__sy4=M+o,this.__sx5=S+n,this.__sy5=T+o,this.__sx6=k+n,this.__sy6=C+o,["center","right"].indexOf(e)>-1&&this.children.forEach((function(t){t instanceof kh&&t.__inlineSize(r)}));else{var N=0,G=0;if(["center","right"].indexOf(e)>-1){var H=t;"center"===e&&(H*=.5),H>0&&(r?this.__offsetY(H,!0,null):this.__offsetX(H,!0,null))}r?(N=m,this.__ioSize(N,0),this.__sx-=c+y+g):(G=m,this.__ioSize(0,G),this.__sy-=l+f+d),this.__sx1=this.__sx+c,this.__sy1=this.__sy+l,this.__sx2=this.__sx1+g,this.__sy2=this.__sy1+d,this.__sx4=this.__sx3=this.__sx2+y,this.__sy4=this.__sy3=this.__sy2+f,this.__sx5=this.__sx4+N+_,this.__sy5=this.__sy4+G+v,this.__sx6=this.__sx5+p,this.__sy6=this.__sy5+x,this.__clientWidth=this.__sx5-this.__sx2,this.__clientHeight=this.__sy5-this.__sy2,this.__offsetWidth=this.__sx6-this.__sx1,this.__offsetHeight=this.__sy6-this.__sy1,this.__outerWidth=this.__offsetWidth+c+h,this.__outerHeight=this.__offsetHeight+l+u}}}},{key:"__layoutAbs",value:function(t,r,i){var a=this,n=t.__sx,o=t.__sy,s=t.__clientWidth,l=t.__clientHeight,h=t.__computedStyle,u=this.__isDestroyed,c=this.children,f=this.absChildren,_=h[Ap],v=h[Fp],y=h[Bp],d=h[Tp],p=h[Sp],x=h[kp],g=h[Ip];u||"none"===_?this.__layoutNone():(n+=p+y,o+=d+v,f.forEach((function(e){if(i){var h=e;if(h instanceof Bh&&(h=e.shadowRoot),i!==h&&i!==e)return}var u=e.currentStyle,c=e.computedStyle;if(e.isDestroyed||"none"===u[Ap])e.__layoutNone();else{e.__computeReflow(),e.__mp(u,c,s);var f,_,v,y,d,p,m,b,M,E,A=u[Hp],S=u[Pp],T=u[Np],w=u[Gp],R=u[Wp],k=u[Yp];if(A.u!==ux?(E=!0,c[Hp]=a.__calSize(A,s,!0)):c[Hp]="auto",T.u!==ux?(b=!0,c[Np]=a.__calSize(T,s,!0)):c[Np]="auto",S.u!==ux?(m=!0,c[Pp]=a.__calSize(S,l,!0)):c[Pp]="auto",w.u!==ux?(M=!0,c[Gp]=a.__calSize(w,l,!0)):c[Gp]="auto",E&&b?(f=n+c[Hp],v=s-c[Np]-c[Hp]):E?(f=n+c[Hp],R.u!==ux&&(v=a.__calSize(R,s,!0))):b?(R.u!==ux?v=a.__calSize(R,s,!0):d=!0,f=n+s-c[Np]-(v||0),f-=c[Sp],f-=c[wp],f-=c[kp],f-=c[Op],f-=c[Bp],f-=c[Dp]):(f=n+x,R.u!==ux&&(v=a.__calSize(R,s,!0))),m&&M)_=o+c[Pp],y=l-c[Pp]-c[Gp];else if(m)_=o+c[Pp],k.u!==ux&&(y=a.__calSize(k,l,!0));else if(M)k.u!==ux?y=a.__calSize(k,l,!0):p=!0,_=o+l-c[Gp]-(y||0),_-=c[Tp],_-=c[Rp],_-=c[Ip],_-=c[Cp],_-=c[Fp],_-=c[Lp];else{_=o+g;for(var C=e.__prev,O=[],I=[];C;){if(C instanceof kh||C instanceof Bh&&C.shadowRoot instanceof kh||"absolute"!==C.computedStyle[Ep]){var F=C.computedStyle;if(!(C.clientHeight<=0)){I.push(F[Rp]);var L=xp.getMergeMargin(O,I);_=C.__sy1+C.offsetHeight+L.target;break}O.push(F[Tp]),I.push(F[Rp])}C=C.__prev}k.u!==ux&&(y=a.__calSize(k,l,!0))}var D=d?f-n:s+n-f,B=p?_-o:l+o-_;void 0===v&&(e.__layoutFlow({x:f,y:_,w:D,h:B,isUpright:r.isUpright,container:t},!0,!1),D=e.outerWidth),e.__layoutFlow({x:f,y:_,w:D,h:B,w2:v,h2:y,isUpright:r.isUpright,container:t},!1,!1),d&&e.__offsetX(-e.outerWidth,!0,null),p&&e.__offsetY(-e.outerHeight,!0,null),e.__layoutStyle()}})),c.forEach((function(a){if(i){var n=a;if(n instanceof Bh&&(n=a.shadowRoot),i!==n&&i!==a)return}if(a instanceof e)a.__layoutAbs(xx(a)?a:t,r,null);else if(a instanceof Bh){var o=a.shadowRoot;o instanceof e&&o.__layoutAbs(o,r,null)}})),this.__execAr())}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a),s=this.__ellipsis;return s&&s.render(t,o.ctx,i,a),t===Sx&&(this.virtualDom.type="dom"),o}},{key:"__destroy",value:function(){this.isDestroyed||(this.children.forEach((function(t){t&&t.__destroy()})),this.__ellipsis&&this.__ellipsis.__destroy(),h(n(e.prototype),"__destroy",this).call(this))}},{key:"__emitEvent",value:function(t,r,i){if(i)return h(n(e.prototype),"__emitEvent",this).call(this,t,i);var a=this.__isDestroyed,o=this.__computedStyle,s=this.__isMask,l=this.__cacheTotal;if(!(a||"none"===o[Ap]||t.__stopPropagation||s)&&("hidden"!==o[ax]||this.willResponseEvent(t,!0))){if(l&&l.available&&l.bbox){wx(this.__matrix)||(r=Rx(r,this.__matrix),Ex(this.__matrixEvent,r));var u=l.bbox;if(!Ut.pointInQuadrilateral(t.x,t.y,u[0],u[1],u[2],u[1],u[2],u[3],u[0],u[3],this.__matrixEvent))return}else g.isE(r)||G.assignMatrix(this.__matrixEvent,g.multiply(r,this.__matrix));var c,f=t.event.type,_=this.listener,v=this.zIndexChildren;_.hasOwnProperty(f)&&(c=_[f]);for(var y=v.length-1;y>=0;y--){var d=v[y];if((d instanceof Py||d instanceof Bh&&d.shadowRoot instanceof Py)&&d.__emitEvent(t,r,!1)){if(t.__stopPropagation)return;return Mx(c)&&!t.__stopImmediatePropagation&&c.call(this,t),!0}}return h(n(e.prototype),"__emitEvent",this).call(this,t,!1)}}},{key:"__deepScan",value:function(t,r){h(n(e.prototype),"__deepScan",this).call(this,t,r)||this.children.forEach((function(e){e.__deepScan(t,r)}))}},{key:"appendChild",value:function(t,e){var r=this.__root,i=this.__host,a=this.__children;t instanceof v||t instanceof Bh||(t=new kh(t)),t.remove();var n=a.length;if(n){var o=a[n-1];o.__next=t,t.__prev=o}t.__parent=this,a.push(t);var s=this.__zIndexChildren=kx(this);if(this.__isDestroyed)Mx(e)&&e();else{if(bp.relation(r,i,this,t,{}),this.__insertStruct(t,s.indexOf(t)),"none"===t.currentStyle[Ap]||"none"===this.__computedStyle[Ap])return t.__layoutNone(),void(Mx(e)&&e());t instanceof kh&&(t=this),r.__addUpdate(t,{focus:Xl.REFLOW,addDom:!0,cb:e})}}},{key:"prependChild",value:function(t,e){var r=this.__root,i=this.__host,a=this.__children;if(t instanceof v||t instanceof Bh||(t=new kh(t)),t.remove(),a.length){var n=a[0];n.__prev=t,t.__next=n}t.__parent=this,a.unshift(t);var o=this.__zIndexChildren=kx(this);if(this.__isDestroyed)Mx(e)&&e();else{if(bp.relation(r,i,this,t,{}),this.__insertStruct(t,o.indexOf(t)),"none"===t.currentStyle[Ap]||"none"===this.__computedStyle[Ap])return t.__layoutNone(),void(Mx(e)&&e());t instanceof kh&&(t=this),r.__addUpdate(t,{focus:Xl.REFLOW,addDom:!0,cb:e})}}},{key:"insertBefore",value:function(t,e){var r=this.__root;t instanceof v||t instanceof Bh||(t=new kh(t)),t.remove();var i,a=this.isShadowRoot?this.__hostRoot.__parent:this.__parent;if(!a)throw new Error("InsertBefore() illegal");var n=a.__children,o=this.isShadowRoot?this.__hostRoot:this;if(-1===(i=n.indexOf(o)))throw new Error("Index exception of insertBefore()");var s=o.__prev;if(s&&(s.__next=t,t.__prev=s),t.__next=o,o.__prev=t,n.splice(i,0,t),a.__zIndexChildren=kx(a),this.__isDestroyed)Mx(e)&&e();else{if(bp.relation(r,a.__host,a,t,{}),a.__insertStruct(t,a.__zIndexChildren.indexOf(t)),"none"===t.currentStyle[Ap]||"none"===a.__computedStyle[Ap])return t.__layoutNone(),void(Mx(e)&&e());t instanceof kh&&(t=a),r.__addUpdate(t,{focus:Xl.REFLOW,addDom:!0,cb:e})}}},{key:"insertAfter",value:function(t,e){var r=this.__root;t instanceof v||t instanceof Bh||(t=new kh(t)),t.remove();var i,a=this.isShadowRoot?this.__hostRoot.__parent:this.__parent;if(!a)throw new Error("InsertAfter() illegal");var n=a.__children,o=this.isShadowRoot?this.__hostRoot:this;if(-1===(i=n.indexOf(o)))throw new Error("Index exception of insertBefore()");if(o.__next=t,t.__prev=o,n.splice(i+1,0,t),a.__zIndexChildren=kx(a),this.__isDestroyed)Mx(e)&&e();else{if(bp.relation(r,a.__host,a,t,{}),a.__insertStruct(t,a.__zIndexChildren.indexOf(t)),"none"===t.currentStyle[Ap]||"none"===a.__computedStyle[Ap])return t.__layoutNone(),void(Mx(e)&&e());t instanceof kh&&(t=a),r.__addUpdate(t,{focus:Xl.REFLOW,addDom:!0,cb:e})}}},{key:"removeChild",value:function(t,e){t.__parent!==this&&t.__domParent!==this||!(t instanceof v||t instanceof Bh)?lt.error("Invalid parameter of removeChild()"):t.remove(e)}},{key:"children",get:function(){return this.__children}},{key:"flowChildren",get:function(){return this.__children.filter((function(t){return t instanceof Bh&&(t=t.shadowRoot),t instanceof kh||"absolute"!==t.__currentStyle[Ep]}))}},{key:"absChildren",get:function(){return this.__children.filter((function(t){return t instanceof Bh&&(t=t.__shadowRoot),t instanceof Py&&"absolute"===t.__currentStyle[Ep]}))}},{key:"zIndexChildren",get:function(){return this.__zIndexChildren}},{key:"lineBoxManager",get:function(){return this.__lineBoxManager}},{key:"baseline",get:function(){var t=this.computedStyle,e=t[Tp],r=t[Fp],i=t[Ip],a=t[lx];return this.lineBoxManager&&this.lineBoxManager.size&&0!==a.indexOf("vertical")?e+r+i+this.lineBoxManager.baseline:this.offsetHeight}},{key:"firstBaseline",get:function(){if(!this.lineBoxManager||!this.lineBoxManager.size)return this.offsetHeight;var t=this.computedStyle;return t[Tp]+t[Fp]+t[Ip]+this.lineBoxManager.firstBaseline}},{key:"verticalBaseline",get:function(){if(!this.lineBoxManager||!this.lineBoxManager.size)return 0;var t=this.computedStyle,e=t[Sp],r=t[Bp],i=t[kp],a=t[lx];return this.lineBoxManager&&this.lineBoxManager.size&&-1!==a.indexOf("vertical")?e+r+i+this.lineBoxManager.verticalBaseline:0}}]),e}(Py),Fx=Ct.STYLE_KEY,Lx=Fx.WIDTH,Dx=Fx.HEIGHT,Bx=Fx.DISPLAY,Px=Fx.BORDER_RIGHT_WIDTH,Nx=Fx.BORDER_LEFT_WIDTH,Gx=Fx.BORDER_TOP_LEFT_RADIUS,Hx=Fx.BORDER_TOP_RIGHT_RADIUS,Wx=Fx.BORDER_BOTTOM_RIGHT_RADIUS,Yx=Fx.BORDER_BOTTOM_LEFT_RADIUS,zx=Fx.VISIBILITY,Xx=Fx.MARGIN_RIGHT,Ux=Fx.MARGIN_LEFT,Vx=Fx.PADDING_RIGHT,Kx=Fx.PADDING_LEFT,jx=Fx.FONT_SIZE,Zx=Fx.FLEX_BASIS,qx=d.AUTO,$x=d.PX,Jx=d.PERCENT,Qx=d.REM,tg=d.VW,eg=d.VH,rg=d.VMAX,ig=d.VMIN,ag=Zt.canvasPolygon,ng=Zt.svgPolygon,og=G.isFunction,sg=function(t){function e(e,r){var i,a=(i=t.call(this,e,r)||this).props.src,n=i.__loadImg={src:a};if(a){var o=lt.IMG[a];o?o&&o.state===lt.LOADED&&(n.source=o.source,n.width=o.width,n.height=o.height):lt.measureImg(a,null)}else n.error=!0;return i}return a(e,t),r(e,[{key:"__preLayout",value:function(t,r){var i=h(n(e.prototype),"__preLayout",this).call(this,t,!1),a=this.__loadImg,o=a.src;if(o){var s=lt.IMG[o];s&&s.state!==lt.LOADING?s&&s.state===lt.LOADED&&s.success&&(a.source=s.source,a.width=s.width,a.height=s.height):a.loading||this.__loadAndRefresh(a,null),a.cache=!1}return i.fixedWidth&&i.fixedHeight||(a.error&&!this.props.placeholder?i.fixedWidth?i.h=i.w:i.fixedHeight?i.w=i.h:i.w=i.h=32:a.source?i.fixedWidth?i.h=i.w*a.height/a.width:i.fixedHeight?i.w=i.h*a.width/a.height:(i.w=a.width,i.h=a.height):i.w=i.h=0,i.fixedWidth=!0,i.fixedHeight=!0),i}},{key:"__addGeom",value:function(t,e){e=G.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),h(n(e.prototype),"__destroy",this).call(this),this.__task=null}},{key:"calContent",value:function(t,r){var i=h(n(e.prototype),"calContent",this).call(this,t,r);if(!i){var a=this.__loadImg;"hidden"!==r[zx]&&(r[Lx]||r[Dx])&&a.source&&(i=!0)}return i}},{key:"render",value:function(t,r){var i,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=h(n(e.prototype),"render",this).call(this,t,r,o,s),u=this.width,c=this.height,f=this.__isDestroyed,_=this.props.placeholder,v=this.__computedStyle,d=v[Bx],p=v[Gx],x=v[Hx],m=v[Wx],b=v[Yx],M=v[zx],E=this.virtualDom,A=this.__loadImg;if(f||"none"===d||"hidden"===M||t===y.WEBGL)return l;i=l.sx3+o,a=l.sy3+s;var S=A.source;if(A.error&&!_&&e.showError){var T=.02*Math.min(u,c),w="#CCC",R="#DDD",k=i+.7*u,C=a+.3*c,O=5*T,I=[[i+.15*u,a+.7*c],[i+.3*u,a+.4*c],[i+.5*u,a+.6*c],[i+.6*u,a+.5*c],[i+.9*u,a+.8*c],[i+.15*u,a+.8*c]];if(t===y.CANVAS||t===y.WEBGL){r.strokeStyle=w,r.lineWidth=T,r.fillStyle=R,r.beginPath(),r.moveTo(i,a),r.lineTo(i+u,a),r.lineTo(i+u,a+c),r.lineTo(i,a+c),r.lineTo(i,a),r.stroke(),r.closePath(),r.beginPath();var F=Ut.ellipsePoints(k,C,O,O);Zt.canvasPolygon(r,F,0,0),r.fill(),r.closePath(),r.beginPath(),r.moveTo(I[0][0],I[0][1]);for(var L=1,D=I.length;L<D;L++){var B=I[L];r.lineTo(B[0],B[1])}r.lineTo(I[0][0],I[0][1]),r.fill(),r.closePath()}else if(t===y.SVG){this.__addGeom("rect",[["x",i],["y",a],["width",u],["height",c],["stroke",w],["stroke-width",T],["fill","rgba(0,0,0,0)"]]),this.__addGeom("circle",[["cx",k],["cy",C],["r",O],["fill",R]]);for(var P="",N=0,H=I.length;N<H;N++){var W=I[N];N&&(P+=" "),P+=W[0]+","+W[1]}this.__addGeom("polygon",[["points",P],["fill",R]])}}else if(S){var Y=Le.calRadius(i,a,u,c,p,x,m,b);if(t===y.CANVAS||t===y.WEBGL)Y?(r.save(),r.beginPath(),ag(r,Y,o,s),r.clip(),r.closePath(),r.drawImage(S,i,a,u,c),r.restore()):r.drawImage(S,i,a,u,c);else if(t===y.SVG){if(A.cache){if(A.cache.cache=!0,E.children=[A.cache],!E.cache&&Y){var z=ng(Y),X={tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",z],["fill","#FFF"]]}]},U=r.add(X);this.__cacheDefs.push(X),E.conClip="url(#"+U+")"}return}var V;u===A.width&&c===A.height||(V=eu.matrixResize(A.width,A.height,u,c,i,a,u,c));var K=[["xlink:href",A.error?_:A.src],["x",i],["y",a],["width",A.width],["height",A.height]];if(Y){var j=ng(Y),Z={tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",j],["fill","#FFF"]]}]},q=r.add(Z);this.__cacheDefs.push(Z),E.conClip="url(#"+q+")",delete E.cache}V&&!g.isE(V)&&K.push(["transform","matrix("+G.joinArr(g.m2m6(V),",")+")"]);var $={type:"img",tagName:"image",props:K};E.children=[$],A.cache=$}}return l}},{key:"__isRealInline",value:function(){return!1}},{key:"__tryLayInline",value:function(t,e){var r=this.currentStyle,i=r[Lx],a=r[Dx],n=r[Ux],o=r[Xx],s=r[Kx],l=r[Vx],h=this.computedStyle,u=h[Nx],c=h[Px];if(i.u!==qx)t-=this.__calSize(i,e,!0);else{var f=this.__loadImg;f.source&&(a.u===$x?t-=f.width*a.v/f.height:a.u===Jx?t-=f.width*a.v*e*.01/f.height:a.u===Qx?t-=f.width*a.v*this.root.computedStyle[jx]/f.height:a.u===tg?t-=f.width*a.v*this.root.width*.01/f.height:a.u===eg?t-=f.width*a.v*this.root.height*.01/f.height:a.u===rg?t-=a.v*Math.max(this.root.width,this.root.height)*.01/f.height:a.u===ig?t-=a.v*Math.min(this.root.width,this.root.height)*.01/f.height:t-=f.width)}return t-=this.__calSize(o,e,!0),t-=this.__calSize(l,e,!0),t-=c,t-=this.__calSize(n,e,!0),t-=this.__calSize(s,e,!0),t-=u}},{key:"__calBasis",value:function(t,e,r,i,a){this.__computeReflow();var n=0,o=0,s=0,l=this.currentStyle,h=this.computedStyle,u=this.__loadImg,c=i.w,f=i.h,_=l[Zx],v=l[Lx],y=l[Dx],d=t?v:y,p=t?y:v;if([$x,Jx,Qx,tg,eg,rg,ig].indexOf(_.u)>-1)n=s=o=this.__calSize(_,t?c:f,!0);else if([$x,Jx,Qx,tg,eg,rg,ig].indexOf(d.u)>-1)n=s=o=this.__calSize(d,t?c:f,!0);else if(u.source||u.error){var x=this.__preLayout(i);if(p.u!==qx){p=this.__calSize(p,t?f:c,!0);var g=x.w/x.h;n=s=o=t?p*g:p/g}else n=s=o=t?x.w:x.h}return this.__addMBP(t,c,l,h,[n,o,s],a)}},{key:"__loadAndRefresh",value:function(t,e){var r=this;(t.source||t.error)&&(t.source=null),t.loading=!0;var i=this.__root,a=i.ctx,n=this.props.placeholder,o=this.__computedStyle,s=o[Lx],l=o[Dx];lt.measureImg(t.src,(function(h){if(h.url===t.src){var u=function(){var t=r.__currentStyle,a=t[Lx],n=t[Dx];a.u!==qx&&n.u!==qx?i.__addUpdate(r,{focus:Xl.REPAINT,cb:e}):i.__addUpdate(r,{focus:Xl.REFLOW,cb:e})};if(t.cache&&(t.cache.cache=!1),t.loading=!1,h.success)t.source=h.source,t.width=h.width,t.height=h.height;else{if(n)return t.error=!0,void lt.measureImg(n,(function(e){e.success&&(t.source=e.source,t.width=e.width,t.height=e.height,"none"===o[Bx]||r.__isDestroyed||u())}),{ctx:a,root:i,width:s,height:l});t.error=!0}"none"===o[Bx]||r.__isDestroyed||u()}}),{ctx:a,root:i,width:s,height:l})}},{key:"updateSrc",value:function(t,e){var r=this.__loadImg;if(t===r.src||this.__isDestroyed||!t&&r.error)return r.src=t,lt.measureImg(t,null),void(og(e)&&e());r.src=t,this.__loadAndRefresh(r,e)}},{key:"appendChild",value:function(){lt.error("Img can not appendChild.")}},{key:"src",get:function(){return this.__loadImg.src}},{key:"isReplaced",get:function(){return!0}}]),e}(Ix);i(sg,"showError",!0);var lg,hg=function(){function t(t){this.id=t,this.count=0,this.list=[],this.cacheHash={}}return r(t,[{key:"add",value:function(t){for(var e=this.count,r=this.cacheHash;r.hasOwnProperty(e);)e++;return this.count=e+1,t.id=e,t.uuid="karas-defs-"+this.id+"-"+e,t.index=this.list.length,this.list.push(t),t.uuid}},{key:"addCache",value:function(t){return t.index=this.list.length,this.list.push(t),this.cacheHash[t.id]=!0,t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0,this.cacheHash={}}},{key:"removeCache",value:function(t){for(var e=this.list,r=t.index;r>=0;r--)if(e[r]===t)return void e.splice(r,1)}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(e){return new t(e)}}]),t}(),ug=G.joinVd,cg=G.joinDef,fg=Xl.contain,_g=Xl.NONE,vg=Xl.TRANSFORM_ALL,yg=Xl.OPACITY,dg=Xl.FILTER,pg=Xl.MIX_BLEND_MODE;function xg(t,e,r){var i=t.childNodes;!function(t,e,r){for(var i=e.length,a=r.length,n=0,o=t.childNodes;n<Math.min(i,a);n++)gg(o[n],e[n],r[n]);if(n<i)for(var s=i-1;s>=n;s--)Cg(t,o,s);else if(n<a)for(;n<a;n++)kg(t,o,n,cg(r[n]))}(i[0],e.defs,r.defs),r.hasOwnProperty("lv")||Sg(i[1],e.bb,r.bb),Eg(t,e,r,!0)}function gg(t,e,r){if(e.tagName!==r.tagName)Og(t,"beforebegin",cg(r)),t.parentNode.removeChild(t);else{e.uuid!==r.uuid&&t.setAttribute("id",r.uuid);for(var i={},a=0,n=(e.props||[]).length;a<n;a++){var o=u(e.props[a],2),s=o[0],l=o[1];i[s]=l}for(var h=0,c=(r.props||[]).length;h<c;h++){var f=u(r.props[h],2),_=f[0],v=f[1];i.hasOwnProperty(_)?(i[_]!==v&&t.setAttribute(_,v),delete i[_]):t.setAttribute(_,v)}Object.keys(i).forEach((function(e){t.removeAttribute(e)}));for(var y=t.childNodes,d=e.children.length,p=r.children.length,x=0;x<Math.min(d,p);x++)Tg(t,x,e.children[x],r.children[x]);if(x<d)for(var g=d-1;g>=x;g--)Cg(t,y,g);else if(x<p)for(;x<p;x++)kg(t,y,x,ug(r.children[x]))}}function mg(t,e,r){"dom"===e.type?"dom"===r.type?Eg(t,e,r):"geom"===r.type?Ag(t,e,r):Rg(t,r):"text"===e.type?"text"===r.type?function(t,e,r){if(r.cache)return;for(var i=e.children.length,a=r.children.length,n=0;n<Math.min(i,a);n++)Tg(t,n,e.children[n],r.children[n],!0);var o=t.childNodes;if(n<i)for(var s=i-1;s>=n;s--)Cg(t,o,s);else if(n<a)for(;n<a;n++)kg(t,o,n,ug(r.children[n]))}(t,e,r):Rg(t,r):"geom"===e.type?"dom"===r.type?function(t,e,r){Ag(t,e,r)}(t,e,r):"geom"===r.type?function(t,e,r){if(r.cache)return void Mg(t,e,r,r.lv);if(r.hasOwnProperty("lv"))Mg(t,e,r,r.lv);else{bg(t,e,r),Sg(t.firstChild,e.bb,r.bb);for(var i=e.children.length,a=r.children.length,n=0,o=t.lastChild,s=o.childNodes;n<Math.min(i,a);n++)Tg(o,n,e.children[n],r.children[n]);if(n<i)for(var l=i-1;l>=n;l--)Cg(o,s,l);else if(n<a)for(;n<a;n++)kg(o,s,n,ug(r.children[n]))}}(t,e,r):Rg(t,r):"img"===e.type?"img"===r.type?wg(t,e,r):Rg(t,r):"item"===e.type&&"item"===r.type&&wg(t,e,r)}function bg(t,e,r){var i=r.transform,a=r.opacity,n=r.visibility,o=r.mask,s=r.overflow,l=r.filter,h=r.mixBlendMode,u=r.conClip;if(e.transform!==i&&(i?t.setAttribute("transform",i):t.removeAttribute("transform")),e.opacity!==a&&(1!==a&&void 0!==a?t.setAttribute("opacity",a):t.removeAttribute("opacity")),e.visibility!==n&&t.setAttribute("visibility",n),e.mask!==o&&(o?t.setAttribute("mask",o):t.removeAttribute("mask")),e.filter!==l||e.mixBlendMode!==h){var c=(l?"filter:".concat(l,";"):"")+(h?"mix-blend-mode:".concat(h,";"):"");c?t.setAttribute("style",c):t.removeAttribute("filter")}e.overflow!==s&&(s?t.setAttribute("clipPath",s):t.removeAttribute("overflow")),e.conClip!==u&&(u?t.childNodes[1].setAttribute("clip-path",u):t.childNodes[1].removeAttribute("clip-path"))}function Mg(t,e,r,i){var a=r.transform,n=r.opacity,o=r.mask,s=r.filter,l=r.mixBlendMode;if(o?t.setAttribute("mask",o):t.removeAttribute("mask"),i!==_g&&(fg(i,vg)&&(a?t.setAttribute("transform",a):t.removeAttribute("transform")),fg(i,yg)&&(1!==n&&void 0!==n?t.setAttribute("opacity",n):t.removeAttribute("opacity")),fg(i,dg)||fg(i,pg))){var h=(s?"filter:".concat(s,";"):"")+(l?"mix-blend-mode:".concat(l,";"):"");h?t.setAttribute("style",h):t.removeAttribute("style")}}function Eg(t,e,r,i){if(r.cache)Mg(t,0,r,r.lv);else{r.hasOwnProperty("lv")?Mg(t,0,r,r.lv):(bg(t,e,r),i||Sg(t.firstChild,e.bb,r.bb));for(var a=e.children.length,n=r.children.length,o=0,s=t.lastChild,l=s.childNodes;o<Math.min(a,n);o++)mg(l[o],e.children[o],r.children[o]);if(o<a)for(var h=a-1;h>=o;h--)Cg(s,l,h);else if(o<n)for(;o<n;o++)kg(s,l,o,ug(r.children[o]))}}function Ag(t,e,r){bg(t,e,r),Sg(t.firstChild,e.bb,r.bb);for(var i=e.children.length,a=r.children.length,n=0,o=t.lastChild,s=o.childNodes;n<Math.min(i,a);n++)Rg(s[n],r.children[n]);if(n<i)for(var l=i-1;l>=n;l--)Cg(o,s,l);else if(n<a)for(;n<a;n++)kg(o,s,n,ug(r.children[n]))}function Sg(t,e,r){for(var i=e.length,a=r.length,n=0;n<Math.min(i,a);n++)Tg(t,n,e[n],r[n]);var o=t.childNodes;if(n<i)for(var s=i-1;s>=n;s--)Cg(t,o,s);else if(n<a)for(;n<a;n++)kg(t,o,n,ug(r[n]))}function Tg(t,e,r,i,a){var n=t.childNodes;r.tagName!==i.tagName?Rg(n[e],i):(wg(n[e],r,i),a&&r.content!==i.content&&(n[e].innerHTML=i.content))}function wg(t,e,r){if(!r.cache){for(var i={},a=0,n=(e.props||[]).length;a<n;a++){var o=u(e.props[a],2),s=o[0],l=o[1];i[s]=l}for(var h=0,c=(r.props||[]).length;h<c;h++){var f=u(r.props[h],2),_=f[0],v=f[1];i.hasOwnProperty(_)?(i[_]!==v&&t.setAttribute(_,v),delete i[_]):t.setAttribute(_,v)}Object.keys(i).forEach((function(e){t.removeAttribute(e)}))}}function Rg(t,e){var r;Array.isArray(e)?(r="",e.forEach((function(t){r+=ug(t)}))):r=ug(e),Og(t,"beforebegin",r),t.parentNode.removeChild(t)}function kg(t,e,r,i){r>=e.length?Og(t,"beforeend",i):Og(e[r],"beforebegin",i)}function Cg(t,e,r){e[r]&&t.removeChild(e[r])}function Og(t,e,r){if(t.insertAdjacentHTML)t.insertAdjacentHTML(e,r);else switch(e){case"beforeend":t.innerHTML+=r;break;case"beforebegin":(lg=lg||document.createElement("svg")).innerHTML=r,t.parentNode.insertBefore(lg.childNodes[0],t)}}var Ig=G.isFunction,Fg=function(){function t(){this.__records=[],this.__records2=[],this.__list=[],this.__list2=[],this.__onList=[],this.__lastTime={}}return r(t,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.list;-1===e.indexOf(t)&&e.push(t)}},{key:"remove",value:function(t){var e=this.list.indexOf(t);e>-1&&this.list.splice(e,1)}},{key:"__destroy",value:function(){this.__records=[],this.__records2=[],this.__list=[],this.__list2=[]}},{key:"__action",value:function(t,e){this.list.forEach((function(r){r[t].apply(r,e)}))}},{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.__records,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.list;if(e.length&&e.splice(0).forEach((function(e){var i=e.target,a=e.animate,n=e.offsetTime;!i.isDestroyed&&a&&(Array.isArray(a)||(a=[a]),a.forEach((function(e){var a=e.value,o=e.options;o.autoPlay=!1,n&&((o=Object.assign({},o)).delay=o.delay||0,o.delay+=n);var s=i.animate(a,o);t.add(s,r)})))})),e===this.__records2){var i=this.__onList,a=this.list2;a.length&&i.length&&a.forEach((function(e){i.forEach((function(r){var i=function(){var i=e.timestamp;i!==t.__lastTime[r[0]]&&(t.__lastTime[r[0]]=i,r[1]&&r[1]())};i.__karasEventCb=r[1],e.off(r[0],r[1]),e.on(r[0],i)}))}))}}},{key:"__playAuto",value:function(){this.init(),this.__action("play")}},{key:"play",value:function(t){this.__mergeAuto(),this.__onList=[];var e=!0;this.__action("play",[t&&function(r){e&&(e=!1,Ig(t)&&t(r))}])}},{key:"pause",value:function(){this.__action("pause")}},{key:"resume",value:function(t){var e=!0;this.__action("resume",[t&&function(r){e&&(e=!1,Ig(t)&&t(r))}])}},{key:"__mergeAuto",value:function(){this.init(),this.init(this.__records2),this.__list2.length&&(this.__list=this.__list.concat(this.__list2),this.__list2=[])}},{key:"cancel",value:function(t){this.__mergeAuto(),this.__onList=[];var e=!0;this.__action("cancel",[t&&function(r){e&&(e=!1,Ig(t)&&t(r))}])}},{key:"finish",value:function(t){this.__mergeAuto(),this.__onList=[];var e=!0;this.__action("finish",[t&&function(r){e&&(e=!1,Ig(t)&&t(r))}])}},{key:"gotoAndStop",value:function(t,e,r){this.__mergeAuto(),this.__onList=[],Ig(e)&&(r=e,e={});var i=!0;this.__action("gotoAndStop",[t,e,r&&function(t){i&&(i=!1,Ig(r)&&r(t))}])}},{key:"gotoAndPlay",value:function(t,e,r){this.__mergeAuto(),this.__onList=[],Ig(e)&&(r=e,e={});var i=!0;this.__action("gotoAndPlay",[t,e,r&&function(t){i&&(i=!1,Ig(r)&&r(t))}])}},{key:"on",value:function(t,e){if(Ig(e))if(Array.isArray(t)){for(var r=0,i=t.length;r<i;r++)this.__on(t[r],e);this.__onList.push([t,e])}else this.__on(t,e),this.__onList.push([t,e])}},{key:"__on",value:function(t,e){var r=this;this.list.forEach((function(i){var a=function(){var a=i.timestamp;a!==r.__lastTime[t]&&(r.__lastTime[t]=a,e&&e())};a.__karasEventCb=e,i.on(t,a)}))}},{key:"off",value:function(t,e){if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++)this.off(t[r],e);else this.list.forEach((function(r){r.off(t,e)}))}},{key:"list",get:function(){return this.__list}},{key:"list2",get:function(){return this.__list2}},{key:"__set",value:function(t,e){this.list.forEach((function(r){r[t]=e}))}},{key:"playbackRate",set:function(t){this.__set("playbackRate",t)}},{key:"iterations",set:function(t){this.__set("iterations",t)}},{key:"playCount",set:function(t){this.__set("playCount",t)}},{key:"fps",set:function(t){this.__set("fps",t)}},{key:"currentTime",set:function(t){this.__set("currentTime",t)}},{key:"spfLimit",set:function(t){this.__set("spfLimit",t)}},{key:"delay",set:function(t){this.__set("delay",t)}},{key:"endDelay",set:function(t){this.__set("endDelay",t)}},{key:"fill",set:function(t){this.__set("fill",t)}},{key:"direction",set:function(t){this.__set("direction",t)}}]),t}(),Lg=[8,16,32,64,128,256,512,1024,2048,4096,8192],Dg=[128,64,32,16,8,4,2,1,1,1,1],Bg=Lg[Lg.length-1],Pg={},Ng=0,Gg=function(){function t(t,e){this.__size=t,this.__number=e,this.__free=this.__total=e*e,t*=e,this.__width=t,this.__height=t;var r=this.__canvas=lt.getCacheCanvas(t,t,null,e);r&&(this.__offscreen=r),this.__grid=[];for(var i=0;i<this.__total;i++)this.__grid.push(1);this.__uuid=Ng++,this.__update=!1,this.time=0}return r(t,[{key:"add",value:function(){for(var t=this.number,e=this.grid,r=0;r<t;r++)for(var i=0;i<t;i++){var a=r*t+i;if(e[a])return e[a]=0,this.__free--,a}throw new Error("Can not find free page")}},{key:"del",value:function(t){this.grid[t]||(this.grid[t]=1,this.__free++)}},{key:"getCoords",value:function(t){var e=this.size,r=this.number;return[t%r*e,Math.floor(t/r)*e]}},{key:"uuid",get:function(){return this.__uuid}},{key:"size",get:function(){return this.__size}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"number",get:function(){return this.__number}},{key:"total",get:function(){return this.__total}},{key:"free",get:function(){return this.__free}},{key:"grid",get:function(){return this.__grid}},{key:"offscreen",get:function(){return this.__offscreen}},{key:"canvas",get:function(){return this.__offscreen.canvas}},{key:"ctx",get:function(){return this.__offscreen.ctx}},{key:"update",get:function(){return this.__update},set:function(t){this.__update=t}}],[{key:"getInstance",value:function(e){if(!(e>Bg)){for(var r=Lg[0],i=Dg[0],a=0,n=Lg.length;a<n&&(r=Lg[a],i=Dg[a],!(Lg[a]>=e));a++);for(var o,s=Pg[r]=Pg[r]||[],l=0,h=s.length;l<h;l++){var u=s[l];if(u.free){o=u;break}}if(!o){if(!(o=new t(r,i)).offscreen)return void lt.error("Can not create off-screen for page");s.push(o)}var c=o.add();return{page:o,pos:c}}}},{key:"CONFIG",get:function(){return{SIZE:Lg,NUMBER:Dg}},set:function(t){t&&Array.isArray(t.SIZE)&&Array.isArray(t.NUMBER)&&(Lg=t.SIZE,Dg=t.NUMBER,Bg=Lg[Lg.length-1])}},{key:"MAX",get:function(){return Bg}},{key:"genUuid",value:function(){return Ng++}}]),t}(),Hg=Ct.STYLE_KEY,Wg=Hg.TRANSFORM_ORIGIN,Yg=Hg.TRANSFORM,zg=Ln.spreadFilter,Xg=g.isE;function Ug(t,e,r){var i=t.size,a=t.sx1,n=t.sy1,o=t.bbox,s=(r=r||o)[2]-r[0],l=r[3]-r[1],h=r[0]-o[0],u=r[1]-o[1],c=lt.getCacheCanvas(s,l,null,e);return c.x=0,c.y=0,c.bbox=r,c.size=i,c.sx1=a,c.sy1=n,c.dx=-r[0],c.dy=-r[1],c.dbx=t.dbx-h,c.dby=t.dby-u,c.width=s,c.height=l,c}var Vg=function(){function t(t,e,r,i,a,n,o){this.__init(t,e,r,i,a,n,o)}return r(t,[{key:"__init",value:function(t,e,r,i,a,n,o){this.__width=t,this.__height=e,this.__bbox=r,this.__page=i,this.__pos=a;var s=u(i.getCoords(a),2),l=s[0],h=s[1];if(this.__x=l,this.__y=h,this.__appendData(n,o),i.canvas){this.__enabled=!0;var c=i.ctx;c.setTransform(1,0,0,1,0,0),c.globalAlpha=1,H.flag&&i.canvas.setAttribute&&i.canvas.setAttribute("size",i.size)}}},{key:"__appendData",value:function(t,e){this.sx1=t,this.sy1=e;var r=this.__bbox;this.dx=this.__x-r[0],this.dy=this.__y-r[1],this.dbx=t-r[0],this.dby=e-r[1],this.update()}},{key:"update",value:function(){this.page.__update=!0}},{key:"clear",value:function(){if(this.__available){var t=this.ctx;t.setTransform(1,0,0,1,0,0);var e=this.page.size;t.clearRect(this.x,this.y,e,e),this.__available=!1}}},{key:"release",value:function(){this.__enabled&&(this.clear(),this.__page.del(this.pos),this.__page=null,this.__enabled=!1)}},{key:"reset",value:function(t,e,r){if(G.equalArr(this.bbox,t)&&this.__enabled)this.clear();else{this.release();var i=Math.ceil(t[2]-t[0]),a=Math.ceil(t[3]-t[1]),n=Gg.getInstance(Math.max(i,a));if(n){var o=n.page,s=n.pos;this.__init(i,a,t,o,s,e,r)}else this.__enabled=!1}}},{key:"__offsetY",value:function(t){this.sy1+=t;var e=this.__bbox;e[1]+=t,e[3]+=t,this.dy-=t}},{key:"enabled",get:function(){return this.__enabled}},{key:"available",get:function(){return this.__enabled&&this.__available}},{key:"bbox",get:function(){return this.__bbox}},{key:"page",get:function(){return this.__page}},{key:"canvas",get:function(){return this.__page.canvas}},{key:"ctx",get:function(){return this.__page.ctx}},{key:"size",get:function(){return this.__page.size}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"pos",get:function(){return this.__pos}}],[{key:"MAX",get:function(){return Gg.MAX}},{key:"getInstance",value:function(e,r,i){var a=Math.ceil(e[2]-e[0]),n=Math.ceil(e[3]-e[1]),o=Gg.getInstance(Math.max(a,n));if(o)return new t(a,n,e,o.page,o.pos,r,i)}},{key:"genFilter",value:function(t,e){var r=t.x,i=t.y,a=t.size,n=t.canvas,o=t.sx1,s=t.sy1,l=t.width,h=t.height,u=t.bbox,c=u[0]-(u=zg(u,e))[0],f=u[2]-u[0],_=u[3]-u[1],v=lt.getCacheCanvas(f,_,null,"filter");return v.ctx.filter=Zt.canvasFilter(e),v.ctx.drawImage(n,r,i,l,h,c,c,l,h),v.ctx.filter="none",v.bbox=u,v.x=0,v.y=0,v.size=a,v.sx1=o,v.sy1=s,v.dx=-u[0],v.dy=-u[1],v.dbx=t.dbx+c,v.dby=t.dby+c,v.width=f,v.height=_,v}},{key:"genMask",value:function(e,r,i){for(var a=Ug(e,"mask1"),n=[],o=r.__computedStyle,s=o[Yg],l=o[Wg],h=r.next,u=h.__isClip;h&&h.__isMask;)n.push(h),h=h.next;var c=a.x,f=a.y,_=a.ctx,v=a.dbx,y=a.dby,d=Ws.calMatrixByOrigin(s,l[0]+c+v,l[1]+f+y);return Xg(d)&&(d=null),n.forEach((function(t){i(t,a,d)})),_.setTransform(1,0,0,1,0,0),_.globalAlpha=1,_.globalCompositeOperation=u?"source-out":"source-in",t.drawCache(e,a),_.globalCompositeOperation="source-over",a}},{key:"genOverflow",value:function(e,r){var i=e.bbox,a=r.__sx1,n=r.__sy1,o=r.__clientWidth,s=r.__clientHeight,l=a+o,h=n+s;if(i[0]<a||i[1]<n||i[2]>l||i[3]>h){var u=Ug(e,"overflow",[a,n,l,h]),c=u.ctx;return c.setTransform(1,0,0,1,0,0),c.globalAlpha=1,t.drawCache(e,u),c.globalCompositeOperation="destination-in",c.fillStyle="#FFF",c.beginPath(),c.rect(0,0,o,s),c.fill(),c.closePath(),c.globalCompositeOperation="source-over",u}}},{key:"drawCache",value:function(t,e){var r=e.x,i=e.y,a=e.sx1,n=e.sy1,o=e.ctx,s=e.dbx,l=e.dby,h=t.x,u=t.y,c=t.canvas,f=t.sx1,_=t.sy1,v=t.dbx,y=t.dby,d=t.width,p=t.height,x=r+f-a+s-v,g=i+_-n+l-y;o.drawImage(c,h,u,d,p,x,g,d,p)}},{key:"getCache",value:function(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];if(i&&i.available)return i}}}]),t}(),Kg=Zt.canvasPolygon;var jg=0,Zg=1,qg=2,$g=3,Jg=4,Qg=function(t,e,r,i){return e.sort((function(t,e){return t.lv===e.lv?t.idx===e.idx?t.type-e.type:e.idx-t.idx:e.lv-t.lv})),e.forEach((function(e){var a=e.type,n=e.offscreen;if(0===a){var o=n.matrix,s=n.target,l=n.ctx,h=n.x,u=n.y,c=n.offsetWidth,f=n.offsetHeight,_=n.list;t.globalCompositeOperation="destination-in",t.globalAlpha=1,t.setTransform(o[0],o[1],o[4],o[5],o[12],o[13]),t.fillStyle="#FFF",t.beginPath(),_?Kg(t,_):t.rect(h,u,c,f),t.fill(),t.closePath(),t.globalCompositeOperation="source-over",(t=l).setTransform(1,0,0,1,0,0),t.globalAlpha=1,r&&i&&t.drawImage(s.canvas,0,0,r,i,0,0,r,i),s.ctx.setTransform(1,0,0,1,0,0),s.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(s.canvas)}else if(1===a){var v=n.target,y=n.ctx,d=n.filter;if(t.filter){var p=lt.getCacheCanvas(r,i,null,"filter2");p.ctx.filter=Zt.canvasFilter(d),r&&i&&p.ctx.drawImage(v.canvas,0,0,r,i,0,0,r,i),p.ctx.filter="none",v.ctx.globalAlpha=1,v.ctx.setTransform(1,0,0,1,0,0),v.ctx.clearRect(0,0,r,i),r&&i&&v.ctx.drawImage(p.canvas,0,0,r,i,0,0,r,i),p.ctx.setTransform(1,0,0,1,0,0),p.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(p.canvas)}(t=y).setTransform(1,0,0,1,0,0),t.globalAlpha=1,r&&i&&t.drawImage(v.canvas,0,0,r,i,0,0,r,i),v.ctx.setTransform(1,0,0,1,0,0),v.ctx.globalAlpha=1,v.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(v.canvas)}else if(2===a){var x=n.mask;if(n.isClip)(t=x.ctx).globalCompositeOperation="source-out",t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r&&i&&t.drawImage(n.target.canvas,0,0,r,i,0,0,r,i),t.globalCompositeOperation="source-over",n.target.ctx.setTransform(1,0,0,1,0,0),n.target.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(n.target.canvas),(t=n.ctx).globalAlpha=1,t.setTransform(1,0,0,1,0,0),r&&i&&t.drawImage(x.canvas,0,0,r,i,0,0,r,i),x.ctx.setTransform(1,0,0,1,0,0),x.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(x.canvas);else{var g=n.target;(t=g.ctx).globalCompositeOperation="destination-in",t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r&&i&&t.drawImage(x.canvas,0,0,r,i,0,0,r,i),t.globalCompositeOperation="source-over",x.ctx.setTransform(1,0,0,1,0,0),x.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(x.canvas),(t=n.ctx).globalAlpha=1,t.setTransform(1,0,0,1,0,0),r&&i&&t.drawImage(g.canvas,0,0,r,i,0,0,r,i),g.ctx.setTransform(1,0,0,1,0,0),g.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(g.canvas)}}else if(3===a){var m=n.target;(t=n.ctx).globalCompositeOperation=n.mixBlendMode,t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,r&&i&&t.drawImage(m.canvas,0,0,r,i,0,0,r,i),t.globalCompositeOperation="source-over",m.ctx.globalAlpha=1,m.ctx.setTransform(1,0,0,1,0,0),m.ctx.clearRect(0,0,r,i),lt.releaseCacheCanvas(m.canvas)}else 4===a&&(t=n.ctx)})),t},tm=r((function(t,e,r){this.uuid=Gg.genUuid(),this.time=lt.now(),this.texture=t,this.width=e,this.height=r})),em=function(){function t(t,e,r,i,a,n,o){this.gl=t,this.x=0,this.y=0,this.sx1=r,this.sy1=i,this.width=a,this.height=n,this.bbox=o,this.available=!0,this.page=new tm(e,a,n),this.reOffset()}return r(t,[{key:"reOffset",value:function(){var t=this.bbox;this.dx=-t[0],this.dy=-t[1],this.dbx=this.sx1-t[0],this.dby=this.sy1-t[1]}},{key:"release",value:function(){this.available=!1,this.gl.deleteTexture(this.page.texture)}}]),t}(),rm=Vg.getCache,im=jg,am=Zg,nm=qg,om=$g,sm=Jg,lm=Qg,hm=Ct.STYLE_KEY,um=hm.DISPLAY,cm=hm.OPACITY,fm=hm.VISIBILITY,_m=hm.FILTER,vm=hm.OVERFLOW,ym=hm.MIX_BLEND_MODE,dm=hm.FILL,pm=hm.TRANSFORM,xm=hm.TRANSFORM_ORIGIN,gm=hm.PERSPECTIVE,mm=hm.PERSPECTIVE_ORIGIN;hm.MATRIX;var bm=Xl.NONE,Mm=Xl.TRANSFORM_ALL,Em=Xl.OPACITY,Am=Xl.FILTER,Sm=Xl.REPAINT,Tm=Xl.contain,wm=Xl.MIX_BLEND_MODE,Rm=Xl.PERSPECTIVE,km=Xl.CACHE,Cm=g.isE,Om=g.inverse,Im=g.multiply,Fm=Pf,Lm=Nf,Dm=G.assignMatrix,Bm=G.transformBbox;function Pm(t,e,r,i){t[0]=Math.min(t[0],r+e[0]),t[1]=Math.min(t[1],i+e[1]),t[2]=Math.max(t[2],r+e[2]),t[3]=Math.max(t[3],i+e[3])}function Nm(t,e,r){for(var i=0;r--;){var a=t[e].total;i+=a||0,e+=a||0,i++,e++}return i}function Gm(t,e,r,i){var a=e.lockOneChannel(),n=K.createTexture(t,null,a,r,i),o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var s=t.checkFramebufferStatus(t.FRAMEBUFFER);return s!==t.FRAMEBUFFER_COMPLETE&&lt.error("Framebuffer object is incomplete: "+s.toString()),t.viewport(0,0,r,i),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),[a,o,n]}function Hm(t,e,r,i,a,n,o,s,l,h,c){var f,_={},v={},d=function(t,e,r,i,a,n,o,s){var l,h,u=t.__sx1,c=t.__sy1,f=t.__cache,_=t.__computedStyle,v=_[_m],y=_[gm],d=_[mm];l=(l=f&&f.available?f.bbox:t.filterBbox).slice(0),y&&(h=Ws.calPerspectiveMatrix(y,d[0],d[1]));var p=[r],x=0;v.forEach((function(t){var e=t.k,r=t.v;"blur"===e&&(x=Ki.outerSize(r))})),n[r]=1;for(var g={};p.length;)for(var m=p.splice(0),b=0,M=m.length;b<M;b++)for(var E=m[b],A=E+1,S=E+(e[E].total||0)+1;A<S;A++){var T=e[A],w=T.node,R=T.total;if(!w.__isMask){var k=w.__sx1,C=w.__sy1,O=w.__cache,I=w.__cacheTotal,F=w.__cacheFilter,L=w.__cacheMask,D=w.__cacheOverflow,B=w.__limitCache,P=w.computedStyle,N=P[um],G=P[fm],H=P[pm],W=P[xm],Y=P[cm];if(B&&!s)return;if("none"!==N){if("hidden"!==G){a[A]=E,n[A]=n[E]*Y;var z=void 0,X=0,U=0,V=void 0;if(w instanceof kh)z=w.bbox;else{var K=rm([L,F,D,I]);K?(z=K.bbox,X=K.dbx,U=K.dby,A+=R||0,V=!0):O&&O.available?(z=O.bbox,X=O.dbx,U=O.dby):z=w.filterBbox}if(z){(z=z.slice(0))[0]-=u,z[1]-=c,z[2]-=u,z[3]-=c;var j=g[E];if(H&&!Cm(H)){var Z=W,q=Ws.calMatrixByOrigin(H,Z[0]+k-u+X,Z[1]+C-c+U);j=j?Im(j,q):q}j&&(g[A]=j),h&&(j=Im(h,j)),z=Bm(z,j,x,x),R&&!V&&p.push(A),Pm(l,z,u,c)}}}else A+=R||0}}return[l,h]}(i,o,a,0,_,v,e.getParameter(e.MAX_TEXTURE_SIZE),l),p=u(d,2),x=p[0],g=p[1];x||(f=!0),(l||f)&&(x=[0,0,h,c]);var m=x[2]-x[0],b=x[3]-x[1],M=u(Gm(e,r,m,b),3),E=M[0],A=M[1],S=M[2],T=i.__sx1,w=i.__sy1,R=.5*m,k=.5*b,C=-x[0],O=-x[1],I=T-x[0],F=w-x[1];if(s&&s.available)r.addTexAndDrawWhenLimit(e,s,1,null,R,k,C,O,!1);else if(l){var L=lt.getCacheCanvas(m,b,"__$$OVERSIZE$$__");i.render(y.CANVAS,L.ctx,0,0);var D=r.lockOneChannel(),B=K.createTexture(e,L.canvas,D),P=new em(e,B,0,0,m,b,[0,0,m,b]);r.addTexAndDrawWhenLimit(e,P,1,null,R,k,0,0,!1),r.refresh(e,R,k),L.ctx.setTransform(1,0,0,1,0,0),L.ctx.globalAlpha=1,L.ctx.clearRect(0,0,m,b),P.release(),r.releaseLockChannel(D)}for(var N={},G=a+1,H=a+(n||0)+1;G<H;G++){var W=o[G],Y=W.node,z=W.total,X=W.hasMask,U=N[_[G]],V=v[G];if(Y instanceof kh)g&&(U=Im(g,U)),r.addTexAndDrawWhenLimit(e,Y.__cache,V,U,R,k,C,O,!1);else{var j=Y.__cache,Z=Y.__cacheTotal,q=Y.__cacheFilter,$=Y.__cacheMask,J=Y.__cacheOverflow,Q=Y.__isMask,tt=Y.__computedStyle,et=tt[um],rt=tt[fm],it=tt[pm],at=tt[xm],nt=tt[ym];if("none"===et){G+=z||0,X&&(G+=Nm(o,G+1,X));continue}if("hidden"===rt||Q){Y.render(t,e,C,O),e.useProgram(e.program),e.viewport(0,0,m,b);continue}if(it&&!Cm(it)){var ot=u(at,2),st=ot[0],ht=ot[1];j&&j.available?(st+=j.sx1,ht+=j.sy1):(st+=Y.__sx1,ht+=Y.__sy1),st+=-T+I,ht+=-w+F;var ut=Ws.calMatrixByOrigin(it,st,ht);U=U?Im(U,ut):ut}U&&(N[G]=U),g&&(U=Im(g,U));var ct=rm([$,q,J,Z,j]);if(ct){if(Lm(nt)){r.refresh(e,R,k);var ft=u(Gm(e,r,m,b),3),_t=ft[0],vt=ft[1],yt=ft[2];r.addTexAndDrawWhenLimit(e,ct,V,U,R,k,C,O,!1),r.refresh(e,R,k);var dt=u(Xm(e,r,E,_t,A,S,Fm(nt),m,b),3);E=dt[0],A=dt[1],S=dt[2],e.deleteFramebuffer(vt),e.deleteTexture(yt)}else r.addTexAndDrawWhenLimit(e,ct,V,U,R,k,C,O,!1);ct!==j?(G+=z||0,X&&(G+=Nm(o,G+1,X))):(Y.render(t,e,C,O),e.useProgram(e.program),e.viewport(0,0,m,b))}}}i.render(t,e,C,O),e.useProgram(e.program),e.viewport(0,0,m,b),r.refresh(e,R,k),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(A),e.viewport(0,0,h,c);var pt=new em(e,S,T,w,m,b,x);return r.releaseLockChannel(E,pt.page),[l||f,pt]}function Wm(t,e,r,i,a,n,o){var s=i.sx1,l=i.sy1,h=i.width,c=i.height,f=i.bbox,_=i;return a.forEach((function(r){var i=r.k,a=r.v;if("blur"===i&&a>0){var n=Ym(t,e,_,a,h,c,s,l,f);if(n){var o=u(n,4);_=o[0],h=o[1],c=o[2],f=o[3]}}else if("dropShadow"===i){var v=function(t,e,r,i,a,n,o,s,l){e.refresh(t,.5*a,.5*n);var h=u(i,5),c=h[0],f=h[1],_=h[2],v=h[4],y=u(Gm(t,e,a,n),3),d=y[0],p=y[1],x=y[2],g=e.findExistTexChannel(r.page);-1===g?(g=e.lockOneChannel(),K.bindTexture(t,r.page.texture,g)):e.lockChannel(g);t.useProgram(t.programDs),x=K.drawDropShadow(t,t.programDs,p,x,r.page.texture,d,g,a,n,v),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(p);var m=l,b=new em(t,x,o,s,a,n,l.slice(0)),M=Ym(t,e,b,_,a,n,o,s,l);if(e.releaseLockChannel(g),t.useProgram(t.program),M){t.deleteTexture(x);var E=u(M,4);b=E[0],a=E[1],n=E[2],l=E[3],(c||f)&&(l[0]+=c,l[1]+=f,l[2]+=c,l[3]+=f,b.sx1=l[0],b.sy1=l[1],b.reOffset());var A=m.slice(0);Pm(A,l,0,0);var S=.5*(a=A[2]-A[0]),T=.5*(n=A[3]-A[1]),w=-A[0],R=-A[1],k=u(Gm(t,e,a,n),3),C=k[0],O=k[1],I=k[2];e.addTexAndDrawWhenLimit(t,r,1,null,S,T,w,R,!1),e.addTexAndDrawWhenLimit(t,b,1,null,S,T,w,R,!1),e.refresh(t,S,T,!1),e.releaseLockChannel(d),e.releaseLockChannel(C),t.deleteFramebuffer(O);var F=new em(t,I,o,s,a,n,A);return e.releaseLockChannel(C,b.page),[F,a,n,A]}}(t,e,_,a,h,c,s,l,f);if(v){var y=u(v,4);_=y[0],h=y[1],c=y[2],f=y[3]}}else if("hueRotate"===i){var d=Ut.d2r(a%360),p=Math.cos(d),x=Math.sin(d),g=zm(t,e,_,[.213+.787*p-.213*x,.715-.715*p-.715*x,.072-.072*p+.928*x,0,0,.213-.213*p+.143*x,.715+.285*p+.14*x,.072-.072*p-.283*x,0,0,.213-.213*p-.787*x,.715-.715*p+.715*x,.072+.928*p+.072*x,0,0,0,0,0,1,0],h,c,s,l,f);if(g){var m=u(g,4);_=m[0],h=m[1],c=m[2],f=m[3]}}else if("saturate"===i&&100!==a){var b=.01*a,M=zm(t,e,_,[.213+.787*b,.715-.715*b,.072-.072*b,0,0,.213-.213*b,.715+.285*b,.072-.072*b,0,0,.213-.213*b,.715-.715*b,.072+.928*b,0,0,0,0,0,1,0],h,c,s,l,f);if(M){var E=u(M,4);_=E[0],h=E[1],c=E[2],f=E[3]}}else if("brightness"===i&&100!==a){var A=.01*a,S=zm(t,e,_,[A,0,0,0,0,0,A,0,0,0,0,0,A,0,0,0,0,0,1,0],h,c,s,l,f);if(S){var T=u(S,4);_=T[0],h=T[1],c=T[2],f=T[3]}}else if("grayscale"===i&&a>0){var w=1-.01*(a=Math.min(a,100));w<0?w=0:w>1&&(w=1);var R=zm(t,e,_,[.2126+.7874*w,.7152-.7152*w,.0722-.0722*w,0,0,.2126-.2126*w,.7152+.2848*w,.0722-.0722*w,0,0,.2126-.2126*w,.7152-.7152*w,.0722+.9278*w,0,0,0,0,0,1,0],h,c,s,l,f);if(R){var k=u(R,4);_=k[0],h=k[1],c=k[2],f=k[3]}}else if("contrast"===i&&100!==a){var C=.01*a,O=-.5*C+.5,I=zm(t,e,_,[C,0,0,0,O,0,C,0,0,O,0,0,C,0,O,0,0,0,1,0],h,c,s,l,f);if(I){var F=u(I,4);_=F[0],h=F[1],c=F[2],f=F[3]}}else if("sepia"===i&&a>0){var L=1-.01*(a=Math.min(a,100));L<0?L=0:L>1&&(L=1);var D=zm(t,e,_,[.393+.607*L,.769-.769*L,.189-.189*L,0,0,.349-.349*L,.686+.314*L,.168-.168*L,0,0,.272-.272*L,.534-.534*L,.131+.869*L,0,0,0,0,0,1,0],h,c,s,l,f);if(D){var B=u(D,4);_=B[0],h=B[1],c=B[2],f=B[3]}}else if("invert"===i&&a>0){var P=.01*(a=Math.min(a,100)),N=1-2*P,G=zm(t,e,_,[N,0,0,0,P,0,N,0,0,P,0,0,N,0,P,0,0,0,1,0],h,c,s,l,f);if(G){var H=u(G,4);_=H[0],h=H[1],c=H[2],f=H[3]}}})),t.useProgram(t.program),t.viewport(0,0,n,o),_}function Ym(t,e,r,i,a,n,o,s,l){for(var h=Ki.kernelSize(i),c=Math.max(15,t.getParameter(t.MAX_VARYING_VECTORS));h>c;)h-=2;var f=Ki.outerSizeByD(h),_=t.getParameter(t.MAX_TEXTURE_SIZE);if(!(a>_||n>_)){var v=l.slice(0);v[0]-=f,v[1]-=f,v[2]+=f,v[3]+=f;for(var y=a+2*f,d=n+2*f,p=.5*y,x=.5*d,g=Ki.gaussianWeight(i,h),m="",b="",M=Math.floor(.5*h),E=0;E<M;E++){var A=.01*(M-E);m+="v_texCoordsBlur[".concat(E,"] = a_texCoords + vec2(-").concat(A,", -").concat(A,") * u_direction;"),b+="gl_FragColor += texture2D(u_texture, v_texCoordsBlur[".concat(E,"]) * ").concat(g[E],";")}m+="v_texCoordsBlur[".concat(M,"] = a_texCoords;"),b+="gl_FragColor += texture2D(u_texture, v_texCoordsBlur[".concat(M,"]) * ").concat(g[M],";");for(var S=0;S<M;S++){var T=.01*(S+1);m+="v_texCoordsBlur[".concat(S+M+1,"] = a_texCoords + vec2(").concat(T,", ").concat(T,") * u_direction;"),b+="gl_FragColor += texture2D(u_texture, v_texCoordsBlur[".concat(S+M+1,"]) * ").concat(g[S+M+1],";")}m="#version 100\n#define GLSLIFY 1\nattribute vec4 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoordsBlur[3];uniform vec2 u_direction;void main(){gl_Position=a_position;}".replace("[3]","["+h+"]").replace(/}$/,m+"}"),b="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoordsBlur[3];uniform sampler2D u_texture;void main(){gl_FragColor=vec4(0.0);}".replace("[3]","["+h+"]").replace(/}$/,b+"}");var w=K.initShaders(t,m,b);t.useProgram(w);var R=u(Gm(t,e,y,d),3),k=R[0],C=R[1],O=R[2],I=e.findExistTexChannel(r.page);-1===I?(I=e.lockOneChannel(),K.bindTexture(t,r.page.texture,I)):e.lockChannel(I),O=K.drawBlur(t,w,C,O,r.page.texture,k,I,a,n,f,y,d,p,x),t.deleteShader(w.vertexShader),t.deleteShader(w.fragmentShader),t.deleteProgram(w),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(C),e.releaseLockChannel(I);var F=new em(t,O,o,s,y,d,v);return e.releaseLockChannel(k,F.page),[F,y,d,v]}}function zm(t,e,r,i,a,n,o,s,l){var h=u(Gm(t,e,a,n),3),c=h[0],f=h[1],_=h[2],v=e.findExistTexChannel(r.page);-1===v?(v=e.lockOneChannel(),K.bindTexture(t,r.page.texture,v)):e.lockChannel(v),t.useProgram(t.programCm),K.drawCm(t,t.programCm,v,i),e.releaseLockChannel(v),t.useProgram(t.program),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(f);var y=new em(t,_,o,s,a,n,l.slice(0));return e.releaseLockChannel(c,y.page),[y,a,n,l]}function Xm(t,e,r,i,a,n,o,s,l){var h;"multiply"===(o=Fm(o))?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return((1.0-a2/a3)*c1*255.0+a2/a3*((1.0-a1)*c2*255.0+a1*c3*255.0))/255.0;}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=bottom*top;float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"screen"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"overlay"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(top.r,bottom.r),op(top.g,bottom.g),op(top.b,bottom.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"darken"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return min(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"lighten"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return max(a,b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"color-dodge"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==1.0){return a==0.0 ? a : 1.0;}return min(1.0,a/(1.0-b));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"color-burn"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){if(b==0.0){return a==1.0 ? a : 0.0;}return 1.0-min(1.0,(1.0-a)/b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"hard-light"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5 ?(2.0*a*b):(a+2.0*b-1.0-a*(2.0*b-1.0));}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"soft-light"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return b<=0.5? a-(1.0-2.0*b)*a*(1.0-a): a+(2.0*b-1.0)*(a<=0.25?((16.0*a-12.0)*a+4.0)*a: sqrt(a)-a);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"difference"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return abs(a-b);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"exclusion"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float op(float a,float b){return a+b-2.0*a*b;}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=vec3(op(bottom.r,top.r),op(bottom.g,top.g),op(bottom.b,top.b));float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"hue"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(a);float l=getLuminosity(a);return setLuminosity(setSaturation(b,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"saturation"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float s=getSaturation(b);float l=getLuminosity(a);return setLuminosity(setSaturation(a,s),l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"color"===o?h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(a);return setLuminosity(b,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}":"luminosity"===o&&(h="#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;float getLuminosity(vec3 color){return 0.3*color[0]+0.59*color[1]+0.11*color[2];}float clipLowest(float channel,float lowestChannel,float luminosity){return luminosity+((channel-luminosity)*luminosity)/(luminosity-lowestChannel);}float clipHighest(float channel,float highestChannel,float luminosity){return luminosity+((channel-luminosity)*(1.0-luminosity))/(highestChannel-luminosity);}vec3 clipColor(vec3 rgb){float luminosity=getLuminosity(rgb);float lowestChannel=min(rgb[0],min(rgb[1],rgb[2]));float highestChannel=max(rgb[0],max(rgb[1],rgb[2]));float r=rgb[0],g=rgb[1],b=rgb[2];if(lowestChannel<0.0){r=clipLowest(r,lowestChannel,luminosity);g=clipLowest(g,lowestChannel,luminosity);b=clipLowest(b,lowestChannel,luminosity);}if(highestChannel>1.0){r=clipHighest(r,highestChannel,luminosity);g=clipHighest(g,highestChannel,luminosity);b=clipHighest(b,highestChannel,luminosity);}return vec3(r,g,b);}vec3 setLuminosity(vec3 rgb,float luminosity){float delta=luminosity-getLuminosity(rgb);float r=rgb[0],g=rgb[1],b=rgb[2];return clipColor(vec3(r+delta,g+delta,b+delta));}float getSaturation(vec3 rgb){return max(rgb[0],max(rgb[1],rgb[2]))-min(rgb[0],min(rgb[1],rgb[2]));}vec3 setSaturation(vec3 rgb,float saturation){float r=rgb[0],g=rgb[1],b=rgb[2];float maxC=0.0,minC=0.0,midC=0.0;int maxI=0,minI=0,midI=0;if(r>=g&&r>=b){maxI=0;maxC=r;if(g>=b){minI=2;midI=1;minC=b;midC=g;}else{minI=1;midI=2;minC=g;midC=b;}}else if(g>=r&&g>=b){maxI=1;maxC=g;if(r>=b){minI=2;midI=0;minC=b;midC=r;}else{minI=0;midI=2;minC=r;midC=b;}}else if(b>=r&&b>=g){maxI=2;maxC=b;if(r>=g){minI=1;midI=0;minC=g;midC=r;}else{minI=0;midI=1;minC=r;midC=g;}}vec3 result=vec3(r,g,b);if(maxC>minC){midC=(midC-minC)*saturation/(maxC-minC);maxC=saturation;}else{maxC=midC=0.0;}minC=0.0;if(maxI==0){result[0]=maxC;}else if(maxI==1){result[1]=maxC;}else if(maxI==2){result[2]=maxC;}if(minI==0){result[0]=minC;}else if(minI==1){result[1]=minC;}else if(minI==2){result[2]=minC;}if(midI==0){result[0]=midC;}else if(midI==1){result[1]=midC;}else if(midI==2){result[2]=midC;}return result;}vec3 op(vec3 a,vec3 b){float l=getLuminosity(b);return setLuminosity(a,l);}vec3 premultipliedAlpha(vec4 color){float a=color.a;if(a==0.0){return vec3(0.0,0.0,0.0);}return vec3(color.r/a,color.g/a,color.b/a);}float alphaCompose(float a1,float a2,float a3,float c1,float c2,float c3){return(1.0-a2/a3)*c1+a2/a3*((1.0-a1)*c2+a1*c3);}void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);if(color1.a==0.0){gl_FragColor=color2;}else if(color2.a==0.0){gl_FragColor=color1;}else{vec3 bottom=premultipliedAlpha(color1);vec3 top=premultipliedAlpha(color2);vec3 res=op(bottom,top);float a=color1.a+color2.a-color1.a*color2.a;gl_FragColor=vec4(alphaCompose(color1.a,color2.a,a,bottom.r,top.r,res.r)*a,alphaCompose(color1.a,color2.a,a,bottom.g,top.g,res.g)*a,alphaCompose(color1.a,color2.a,a,bottom.b,top.b,res.b)*a,a);}}");var c=K.initShaders(t,"#version 100\n#define GLSLIFY 1\nattribute vec4 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=a_position;v_texCoords=a_texCoords;}",h);t.useProgram(c);var f=u(Gm(t,e,s,l),3),_=f[0],v=f[1],y=f[2];return K.drawMbm(t,c,r,i,s,l),t.useProgram(t.program),t.viewport(0,0,s,l),t.deleteShader(c.vertexShader),t.deleteShader(c.fragmentShader),t.deleteProgram(c),t.deleteFramebuffer(a),t.deleteTexture(n),e.releaseLockChannel(r),e.releaseLockChannel(i),[_,v,y]}var Um={renderCanvas:function(t,e,r){for(var i=r.__structs,a=r.width,n=r.height,o=[],s=0,l=i.length;s<l;s++){var h=i[s],u=h.node,c=h.lv,f=h.total,_=h.hasMask;if(!(u instanceof kh))if("none"!==u.__computedStyle[um]){var v=u.__refreshLevel,y=u.__cacheTotal;u.__refreshLevel=bm,u.__cacheAsBitmap&&(Tm(v,km|Am)||v>=Sm)&&o.push({i:s,lv:c,total:f,node:u,hasMask:_}),y&&y.available&&(s+=f||0,v===bm&&_&&(s+=Nm(i,s+1,_)))}else s+=f||0,_&&(s+=Nm(i,s+1,_))}o.length&&(o.sort((function(t,e){return t.lv===e.lv?e.i-t.i:e.lv-t.lv})),o.forEach((function(e){var r=e.i,o=e.lv,s=e.total,l=e.node,h=e.hasMask,u=function(t,e,r,i,a,n,o,s,l){var h=e.__cacheTotal;if(!h||!h.available){var u=e.__sx1,c=e.__sy1,f=e.bbox.slice(0);Dm(e.__matrixEvent,g.identity()),e.__opacity=1;for(var _=r+1,v=r+(a||0)+1;_<v;_++){var y=n[_],d=y.node,p=y.total,x=y.hasMask;if(d instanceof kh){var m=d.filterBbox,b=d.__domParent.__matrixEvent;Cm(b)||(m=Bm(m,b,0,0)),Pm(f,m,0,0)}else{var M=d.__computedStyle,E=d.__isMask;if("none"===M[um]||_!==r&&E)_+=p||0,x&&(_+=Nm(n,_+1,x));else{var A=d.__cacheTotal,S=d.__cacheFilter,T=d.__cacheMask,w=d.__cacheOverflow,R=d.__domParent;d.__opacity=M[cm]*R.__opacity;var k=Im(R.__matrixEvent,d.__matrix);Dm(d.__matrixEvent,k);var C=void 0,O=rm([T,S,w,A]);O?(_+=p||0,x&&(_+=Nm(n,_+1,x)),C=O.bbox):C=d.filterBbox,Pm(f,C=Bm(C,k,0,0),0,0)}}}if(!(h=e.__cacheTotal=Vg.getInstance(f,u,c))||!h.__enabled)return void lt.warn("Cache of "+e.tagName+"("+r+") is oversize: "+(f[2]-f[0])+", "+(f[3]-f[1]));h.__available=!0;for(var I=h,F=I.dx,L=I.dy,D=I.dbx,B=I.dby,P=I.x,N=I.y,G=h.ctx,H=[],W=null,Y=null,z=i,X=[],U=[],V=r,K=r+(a||0)+1;V<K;V++){var j=n[V],Z=j.node,q=j.lv,$=j.total,J=j.hasMask;if(Z instanceof kh)Z.render(t,G,F,L),U.hasOwnProperty(V)&&(G=lm(G,U[V],s,l,!1));else{var Q=Z.__computedStyle;if("none"===Q[um]){V+=$||0,J&&(V+=Nm(n,V+1,J)),U.hasOwnProperty(V)&&(G=lm(G,U[V],s,l,!0));continue}var tt=Z.__cacheTotal,et=Z.__cacheFilter,rt=Z.__cacheMask,it=Z.__cacheOverflow,at=Q[pm],nt=Q[xm];if(X.hasOwnProperty(V)){var ot=X[V],st=ot.idx,ht=ot.hasMask,ut=ot.offscreenMask,ct=lt.getCacheCanvas(s,l,null,"mask2");ut.mask=ct,ut.isClip=Z.__isClip;for(var ft=V+($||0)+1;--ht;)ft+=(n[ft].total||0)+1;var _t=U[--ft]=U[ft]||[];_t.push({idx:st,lv:q,type:nm,offscreen:ut}),_t.push({idx:ft,lv:q,type:sm,offscreen:{ctx:G,target:ct}}),G=ct.ctx}if(V===r);else if(q>z)Cm(W=Y)&&(W=null),H.push(W);else if(q<z){var vt=z-q;H.splice(-vt),W=H[q-1]}z=q;var yt=void 0;V===r||Cm(W)&&Cm(at)||(yt=Ws.calMatrixByOrigin(at,nt[0]+D+Z.__sx1-u+P,nt[1]+B+Z.__sy1-c+N),Cm(W)||(yt=Im(W,yt))),Y=yt;var dt=V>r&&rm([rt,et,it,tt]);if(dt){V+=$||0,J&&(V+=Nm(n,V+1,J)),G.globalAlpha=Z.__opacity,yt?G.setTransform(yt[0],yt[1],yt[4],yt[5],yt[12],yt[13]):G.setTransform(1,0,0,1,0,0);var pt=Q[ym];Lm(pt)&&(G.globalCompositeOperation=Fm(pt)),Vg.drawCache(dt,h),G.globalCompositeOperation="source-over",U.hasOwnProperty(V)&&(G=lm(G,U[V],s,l,!1))}else{var xt=void 0,gt=void 0,mt=void 0,bt=void 0,Mt=V>r&&Z.__calOffscreen(G,Q);if(Mt&&(G=Mt.ctx,xt=Mt.offscreenBlend,gt=Mt.offscreenMask,mt=Mt.offscreenFilter,bt=Mt.offscreenOverflow),G.globalAlpha=Z.__opacity,yt?G.setTransform(yt[0],yt[1],yt[4],yt[5],yt[12],yt[13]):G.setTransform(1,0,0,1,0,0),Z.render(t,G,F,L),xt){var Et=V+($||0);J&&(Et+=Nm(n,Et+1,J)),(U[Et]=U[Et]||[]).push({idx:V,lv:q,type:om,offscreen:xt})}if(gt&&(X[V+($||0)+1]={idx:V,hasMask:J,offscreenMask:gt}),mt){var At=V+($||0);J&&(At+=Nm(n,At+1,J)),(U[At]=U[At]||[]).push({idx:V,lv:q,type:am,offscreen:mt})}if(bt){var St=V+($||0);J&&(St+=Nm(n,St+1,J)),(U[St]=U[St]||[]).push({idx:V,lv:q,type:im,offscreen:bt})}U.hasOwnProperty(V)&&(G=lm(G,U[V],s,l,!1))}}}}return h}(t,l,r,o,s||0,i,0,a,n);u&&function(t,e,r,i,a,n,o){var s,l=i.__computedStyle,h=i.__cacheOverflow,u=i.__cacheFilter,c=i.__cacheMask,f=l[vm],_=l[_m],v=r;"hidden"===f&&(h&&h.available||(i.__cacheOverflow=h=Vg.genOverflow(v,i),s=!0),h&&h.available&&(v=h)),_&&_.length&&(u&&u.available&&!s||(i.__cacheFilter=u=Vg.genFilter(v,_),s=!0),u&&u.available&&(v=u)),!a||c&&c.available&&!s||(i.__cacheMask=c=Vg.genMask(v,i,(function(r,i,a){for(var s={},l={},h=i.dx,u=i.dy,c=i.dbx,f=i.dby,_=i.x,v=i.y,y=i.ctx,d=i.sx1,p=i.sy1,x=r.__struct,m=r.__root.__structs.indexOf(x),b=x.total,M=[],E=null,A=null,S=[],T=1,w=1,R=x.lv,k=m,C=m+(b||0)+1;k<C;k++){var O=e[k],I=O.node,F=O.lv,L=O.total,D=O.hasMask;if(I instanceof kh)I.render(t,y,h,u),l.hasOwnProperty(k)&&(y=lm(y,l[k],n,o,!1));else{var B=I.__computedStyle;if("none"===B[um]){k+=L||0,D&&(k+=Nm(e,k+1,D)),l.hasOwnProperty(k)&&(y=lm(y,l[k],n,o,!0));continue}var P=I.__cacheTotal,N=I.__cacheFilter,H=I.__cacheMask,W=I.__cacheOverflow;if(s.hasOwnProperty(k)){var Y=s[k],z=Y.idx,X=Y.hasMask,U=Y.offscreenMask,V=lt.getCacheCanvas(n,o,null,"mask2");U.mask=V,U.isClip=I.__isClip;for(var K=k+(L||0)+1;--X;)K+=(e[K].total||0)+1;var j=l[--K]=l[K]||[];j.push({idx:z,lv:F,type:nm,offscreen:U}),j.push({idx:K,lv:F,type:sm,offscreen:{ctx:y,target:V}}),y=V.ctx}if(k===m);else if(F>R)Cm(E=A)&&(E=null),M.push(E),T=w,S.push(T);else if(F<R){var Z=R-F;M.splice(-Z),E=M[F-1],S.splice(-Z),T=S[F-1]}R=F;var q=B[pm],$=B[xm],J=B[cm];k!==m&&(J*=T),I.__opacity=w=J;var Q=void 0;Cm(q)||(Q=Ws.calMatrixByOrigin(q,$[0]+c+I.__sx1-d+_,$[1]+f+I.__sy1-p+v),Cm(E)||(Q=Im(E,Q))),A=Q,Q?G.equalArr(Q,a)?Q=g.identity():a&&(a=g.inverse(a),Q=g.multiply(a,Q)):Cm(a)||(Q=g.inverse(a)),Q=Q||g.identity(),Dm(I.__matrixEvent,Q);var tt=rm([H,N,W,P]);if(tt){k+=L||0,D&&(k+=Nm(e,k+1,D)),y.globalAlpha=J,y.setTransform(Q[0],Q[1],Q[4],Q[5],Q[12],Q[13]);var et=B[ym];Lm(et)?y.globalCompositeOperation=Fm(et):y.globalCompositeOperation="source-over";var rt=tt.x,it=tt.y,at=tt.canvas,nt=tt.width,ot=tt.height,st=tt.sx1,ht=tt.sy1,ut=_+st-d+c-tt.dbx,ct=v+ht-p+f-tt.dby;y.drawImage(at,rt,it,nt,ot,ut,ct,nt,ot),y.globalCompositeOperation="source-over",l.hasOwnProperty(k)&&(y=lm(y,l[k],nt,ot,!1))}else{var ft=void 0,_t=void 0,vt=void 0,yt=void 0,dt=I.__calOffscreen(y,B);if(dt&&(y=dt.ctx,ft=dt.offscreenBlend,_t=dt.offscreenMask,vt=dt.offscreenFilter,yt=dt.offscreenOverflow),y.globalAlpha=J,y.setTransform(Q[0],Q[1],Q[4],Q[5],Q[12],Q[13]),I.render(t,y,h,u),ft){var pt=k+(L||0);D&&(pt+=Nm(e,pt+1,D)),(l[pt]=l[pt]||[]).push({idx:k,lv:F,type:om,offscreen:ft})}if(_t&&(s[k+(L||0)+1]={idx:k,hasMask:D,offscreenMask:_t}),vt){var xt=k+(L||0);D&&(xt+=Nm(e,xt+1,D)),(l[xt]=l[xt]||[]).push({idx:k,lv:F,type:am,offscreen:vt})}if(yt){var gt=k+(L||0);D&&(gt+=Nm(e,gt+1,D)),(l[gt]=l[gt]||[]).push({idx:k,lv:F,type:im,offscreen:yt})}l.hasOwnProperty(k)&&(y=lm(y,l[k],n,o))}}}})),c&&c.available&&(v=c))}(t,i,u,l,h,a,n)})));for(var d={},p={},x=0,m=i.length;x<m;x++){var b=i[x],M=b.node,E=b.lv,A=b.total,S=b.hasMask;if(M instanceof kh)M.render(t,e,0,0),p.hasOwnProperty(x)&&(e=lm(e,p[x],a,n,!1));else{var T=M.__computedStyle;if("none"===T[um]){x+=A||0,S&&(x+=Nm(i,x+1,S)),p.hasOwnProperty(x)&&(e=lm(e,p[x],a,n,!0));continue}var w=M.__cacheTotal,R=M.__cacheFilter,k=M.__cacheMask,C=M.__cacheOverflow,O=M.__domParent,I=M.__matrix;if(d.hasOwnProperty(x)){var F=d[x],L=F.idx,D=F.hasMask,B=F.offscreenMask,P=lt.getCacheCanvas(a,n,null,"mask2");B.mask=P,B.isClip=M.__isClip;for(var N=x+(A||0)+1;--D;){N+=(i[N].total||0)+1}var H=p[--N]=p[N]||[];H.push({idx:L,lv:E,type:nm,offscreen:B}),H.push({idx:N,lv:E,type:sm,offscreen:{ctx:e,target:P}}),e=P.ctx}var W=T[cm],Y=I;O&&(W*=O.__opacity,Y=Im(O.__matrixEvent,Y)),M.__opacity=W,Dm(M.__matrixEvent,Y);var z=rm([k,R,C,w]);if(z){x+=A||0,S&&(x+=Nm(i,x+1,S)),e.globalAlpha=W,e.setTransform(Y[0],Y[1],Y[4],Y[5],Y[12],Y[13]);var X=T[ym];Lm(X)&&(e.globalCompositeOperation=Fm(X));var U=z.x,V=z.y,K=z.canvas,j=z.sx1,Z=z.sy1,q=z.dbx,$=z.dby,J=z.width,Q=z.height;e.drawImage(K,U,V,J,Q,j-q,Z-$,J,Q),e.globalCompositeOperation="source-over",p.hasOwnProperty(x)&&(e=lm(e,p[x],J,Q,!1))}else{var tt=void 0,et=void 0,rt=void 0,it=void 0,at=M.__calOffscreen(e,T);if(at&&(e=at.ctx,tt=at.offscreenBlend,et=at.offscreenMask,rt=at.offscreenFilter,it=at.offscreenOverflow),e.globalAlpha=W,e.setTransform(Y[0],Y[1],Y[4],Y[5],Y[12],Y[13]),M.render(t,e,0,0),tt){var nt=x+(A||0);S&&(nt+=Nm(i,nt+1,S)),(p[nt]=p[nt]||[]).push({idx:x,lv:E,type:om,offscreen:tt})}if(et)d[x+(A||0)+1]={idx:x,hasMask:S,offscreenMask:et};if(rt){var ot=x+(A||0);S&&(ot+=Nm(i,ot+1,S)),(p[ot]=p[ot]||[]).push({idx:x,lv:E,type:am,offscreen:rt})}if(it){var st=x+(A||0);S&&(st+=Nm(i,st+1,S)),(p[st]=p[st]||[]).push({idx:x,lv:E,type:im,offscreen:it})}p.hasOwnProperty(x)&&(e=lm(e,p[x],a,n,!1))}}}},renderSvg:function(t,e,r,i){var a=r.__structs,n=r.width,o=r.height,s={};if(!i)for(var l=0,h=a.length;l<h;l++){var u=a[l],c=u.node,f=u.total,_=u.hasMask,v=c.__cacheDefs,y=c.__refreshLevel;if(_&&(y>=Sm||Tm(y,Mm|Em)))s[l+(f||0)+1+_-1]=y;if(y<Sm)if(s.hasOwnProperty(l)){var d=s[l];!Tm(y,Mm)&&d<Sm&&!Tm(d,Mm)&&v.forEach((function(t){e.addCache(t)}))}else c instanceof kh||v.forEach((function(t){e.addCache(t)}))}for(var p,x,m,b={},M=[],E=[],A=0,S=0,T=function(r,i){var l=a[r],h=l.node,u=l.lv,c=l.total,f=l.hasMask,_=void 0,v=void 0,y=void 0,d=void 0;h instanceof kh?(_=h.computedStyle,v=S):(_=h.__computedStyle,y=h.__cacheDefs,v=h.__refreshLevel,d=h.__cacheTotal),S=v,h.__refreshLevel=bm;var T=_[um];if(f&&"none"!==T){var R=r+(c||0)+1,k=R+f;b[k-1]={index:r,start:R,end:k,isClip:a[R].node.__isClip}}if(u<A){var C=A-u;M.splice(-C),p=M[u-1],E.splice(-C),x=E[u-1]}else if(u>A){M.push(p=m.__matrix);var O=m.__virtualDom;E.push(O),x=O}m=h,A=u;var I=void 0;if(v<Sm&&!(h instanceof kh)){if(I=h.__virtualDom,d&&d.available?(r+=c||0,I.cache=!0):(d&&(d.available=!0),I=h.__virtualDom=G.extend({},I),h instanceof Ix&&!(h instanceof sg)&&(I.children=[]),"none"===T?(r+=c||0,f&&(r+=f)):delete I.cache),Tm(v,Mm)){var F=h.__matrix;!F||Cm(F)?delete I.transform:I.transform="matrix("+G.joinArr(g.m2m6(F),",")+")",p&&F&&(F=Im(p,F)),Dm(h.__matrixEvent,F)}if(Tm(v,Em)){var L=_[cm];1===L?delete I.opacity:I.opacity=L}if(Tm(v,Am)){var D=_[_m],B=Zt.svgFilter(D);B?I.filter=B:delete I.filter}if(Tm(v,wm)){var P=_[ym];Lm(P)?I.mixBlendMode=Fm(P):delete I.mixBlendMode}I.lv=v}else{if(!(h instanceof kh)){h.__cacheDefs.splice(0);var N=h.__matrix;p&&(N=Im(p,N)),Dm(h.__matrixEvent,N)}h.render(t,e,0,0),I=h.__virtualDom,h instanceof kh||(h.__cacheTotal=h.__cacheTotal||{available:!0,release:function(){this.available=!1,delete I.cache},__offsetY:function(){}},h.__cacheTotal.available=!0),"none"===(T=_[um])&&(r+=c||0,r+=f||0)}if(b.hasOwnProperty(r)&&(s.hasOwnProperty(r)||v>=Sm||Tm(v,Mm|Em))){var H=b[r],W=H.index,Y=H.start,z=H.end,X=H.isClip,U=a[W].node,V=[];X&&V.push({type:"item",tagName:"path",props:[["d","M0,0L".concat(n,",0L").concat(n,",").concat(o,"L0,").concat(o,"L0,0")],["fill","rgba(255,255,255,1)"],["stroke-width",0]]});for(var K=Y;K<z;K++){var j=a[K].node,Z=j.computedStyle,q=Z[um],$=Z[fm],J=Z[dm],Q=j.virtualDom,tt=Q.children,et=Q.opacity;if("none"!==q&&"hidden"!==$){tt=G.clone(tt),V=V.concat(tt);for(var rt=0,it=tt.length;rt<it;rt++){var at=tt[rt],nt=at.tagName,ot=at.props;if("path"===nt){if(X)for(var st=0,lt=ot.length;st<lt;st++){var ht=ot[st];"fill"===ht[0]&&(ht[1]=G.int2invert(J[0]))}var ut=j.matrix,ct=Om(U.matrix);ut=Im(ct,ut),ot.push(["transform","matrix(".concat(G.joinArr(g.m2m6(ut),","),")")]),G.isNil(et)||1===et||ot.push(["opacity",et])}else if("image"===nt){for(var ft=-1,_t=0,vt=ot.length;_t<vt;_t++)if("transform"===ot[_t][0]){ft=_t;break}if(-1===ft){var yt=Om(U.matrix);Cm(yt)||ot.push(["transform","matrix(".concat(G.joinArr(g.m2m6(yt),","),")")])}else{var dt=ot[ft][1].match(/[\d.]+/g).map((function(t){return parseFloat(t)})),pt=Om(U.matrix);dt=Im(pt,dt),ot[ft][1]="matrix(".concat(G.joinArr(g.m2m6(dt),","),")")}}}}}for(var xt=y.length-1;xt>=0;xt--){"mask"===y[xt].tagName&&y.splice(xt,1)}var gt={tagName:"mask",props:[],children:V},mt=e.add(gt);y.push(gt),mt="url(#"+mt+")",U.virtualDom.mask=mt}x&&!h.__isMask&&x.children.push(I),0===r&&(p=h.__matrix,x=I),w=r},w=0,R=a.length;w<R;w++)T(w)},renderWebgl:function(t,e,r,i){for(var a,n=r.__structs,o=r.width,s=r.height,l=r.texCache,h=.5*o,c=.5*s,f=bm,_=[],v=0,d=n.length;v<d;v++){var p=n[v],x=p.node,m=p.lv,b=p.total,M=p.hasMask;if(x.__index=v,x instanceof kh){if(f>=Sm){var E=x.bbox,A=x.__sx,S=x.__sy,T=x.__cache;T?T.reset(E,A,S):T=Vg.getInstance(E,A,S),T&&T.enabled?(T.__bbox=E,T.__available=!0,x.__cache=T,x.render(y.CANVAS,T.ctx,T.dx,T.dy)):(T&&T.release(),x.__limitCache=!0)}}else{var w=x.__computedStyle;if("none"!==w[um]){var R=x.__refreshLevel,k=x.__currentStyle,C=x.__cacheTotal;if(f=R,x.__refreshLevel=bm,R<Sm){var O=x.__matrix,I=w[ym],F=Tm(R,wm)&&Lm(I),L=x.__domParent,D=!Cm(L&&L.__perspectiveMatrix)||Ws.isPerspectiveMatrix(O);F&&(a=!0),(Tm(R,Am|wm)||Tm(R,Rm)&&x.__cacheAsBitmap||D)&&_.push({i:v,lv:m,total:b,node:x,hasMask:M}),C&&C.available&&(v+=b||0,R===bm&&M&&(v+=Nm(n,v+1,M)))}else{if(x.calContent(k,w)){var B=x.bbox,P=x.__cache,N=x.__sx1,G=x.__sy1;P?P.reset(B,N,G):P=Vg.getInstance(B,N,G),P&&P.enabled?(P.__bbox=B,P.__available=!0,x.__cache=P,x.render(y.CANVAS,P.ctx,P.dx,P.dy)):(P&&P.release(),x.__limitCache=!0)}else x.__limitCache=!1;var H=w[vm],W=w[_m],Y=w[ym],z=Lm(Y),X=x.__domParent,U=!Cm(X&&X.__perspectiveMatrix)||Ws.isPerspectiveMatrix(x.__matrix),V="hidden"===H&&b,j=W&&W.length;z&&(a=!0),(x.__cacheAsBitmap||M||j||z||V||U)&&_.push({i:v,lv:m,total:b,node:x,hasMask:M})}}else v+=b||0,M&&(v+=Nm(n,v+1,M))}}var Z,q,$,J={};if(_.length){_.sort((function(t,e){return t.lv===e.lv?e.i-t.i:e.lv-t.lv}));var Q={};_.forEach((function(r){var i=r.i,a=r.lv,h=r.total,c=r.node,f=r.hasMask,_=c.__limitCache,v=c.__matrix,y=c.__domParent,d=c.__computedStyle,p=d[vm],x=d[_m];if(!Cm(y&&y.__perspectiveMatrix)||Ws.isPerspectiveMatrix(v)){for(var m=c.__domParent;m;){var b=m.__index;if(Q[b])break;Ws.isPerspectiveMatrix(m.__matrix)&&(Q[b]=!0),(m=m.__domParent)&&m.__perspectiveMatrix&&(Q[b]=!0)}if(!(Q[i]||f||x.length||"hidden"===p&&h||c.__cacheAsBitmap))return}var M,E=c.__cache,A=c.__cacheTotal,S=c.__cacheFilter,T=c.__cacheMask,w=c.__cacheOverflow;if(!A||!A.available){var R=u(Hm(t,e,l,c,i,h||0,n,E,_,o,s),2),k=R[0],C=R[1];A=C,M=!0,(_=k)||(c.__cacheTotal=C)}var O=A;if("hidden"===p){if(!w||!w.available||M){var I=function(t,e,r,i,a,n){var o=i.bbox,s=r.__sx1,l=r.__sy1,h=r.__clientWidth,c=r.__clientHeight,f=s+h,_=l+c;if(!(o[0]>=s&&o[1]>=l&&o[2]<=f&&_)){var v=[s,l,f,_],y=u(Gm(t,e,h,c),3),d=y[0],p=y[1],x=y[2],g=e.findExistTexChannel(i.page);-1===g?(g=e.lockOneChannel(),K.bindTexture(t,i.page.texture,g)):e.lockChannel(g),t.useProgram(t.programOverflow),K.drawOverflow(t,g,v[0]-o[0],v[1]-o[1],h,c,i.width,i.height),e.releaseLockChannel(g),t.useProgram(t.program),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,a,n),t.deleteFramebuffer(p);var m=new em(t,x,i.sx1,i.sy1,h,c,v);return e.releaseLockChannel(d,m.page),m}}(e,l,c,O,o,s);I&&(O=I,M=!0,_||(c.__cacheOverflow=O))}w&&w.available&&(O=w)}if(x.length){if(!S||!S.available||M){var F=O;(O=Wm(e,l,0,O,x,o,s))!==F&&(M=!0,_||(c.__cacheFilter=O))}S&&S.available&&(O=S)}!f||T&&T.available&&!M||(O=function(t,e,r,i,a,n,o,s){var l,h=i.sx1,c=i.sy1,f=i.width,_=i.height,v=i.bbox,y=i.dx,d=i.dy,p=.5*f,x=.5*_,m=r.__computedStyle,b=m[pm],M=m[xm];if(Cm(b))l=g.identity();else{var E=M;l=Ws.calMatrixByOrigin(b,E[0]+h+y,E[1]+c+d)}l=g.inverse(l);for(var A=u(Gm(t,e,f,_),3),S=A[0],T=A[1],w=A[2],R=r.next,k=R.__isClip,C=[];R&&R.__isMask&&R.__isClip===k;)C.push(R),R=R.next;for(var O=0,I=C.length;O<I;O++)for(var F=[],L=void 0,D=void 0,B=[],P=1,N=void 0,G=o,H=C[O].__struct,W=s.indexOf(H),Y=W,z=W+(H.total||0)+1;Y<z;Y++){var X=s[Y],U=X.node,V=X.lv,j=X.total,Z=X.hasMask,q=U.__cache,$=U.__limitCache;if("none"!==U.__computedStyle[um])if(U instanceof kh){if(q&&q.available)e.addTexAndDrawWhenLimit(t,q,P,e.last[2],p,x,0,0,!0);else if($)return}else{var J=U.__cache,Q=U.__cacheMask,tt=U.__cacheFilter,et=U.__cacheOverflow,rt=U.__cacheTotal,it=U.__computedStyle,at=it[cm],nt=it[pm],ot=it[xm];if(Y===W);else if(V>G)Cm(L=D)&&(L=null),F.push(L),P=N,B.push(P);else if(V<G){var st=G-V;F.splice(-st),L=F[V-1],B.splice(-st),P=B[V-1]}G=V;var lt=rm([Q,tt,et,rt,J]);if(lt){var ht=void 0;ht=Cm(nt)?g.identity():Ws.calMatrixByOrigin(nt,ot[0]+lt.bbox[0]+y,ot[1]+lt.bbox[1]+d),ht=g.multiply(l,ht),D=Ws.calMatrixByOrigin(nt,ot[0]+lt.bbox[0]+y,ot[1]+lt.bbox[1]+d),Cm(L)||(D=Im(L,D)),N=P*at,e.addTexAndDrawWhenLimit(t,lt,N,ht,p,x,y,d,!0),lt!==J&&(Y+=j||0,Z&&(Y+=Nm(s,Y+1,Z)))}else if($)return}else Y+=j||0,Z&&(Y+=Nm(s,Y+1,Z))}e.refresh(t,p,x),t.deleteFramebuffer(T);var ut=e.findExistTexChannel(i.page);-1===ut?(ut=e.lockOneChannel(),K.bindTexture(t,i.page.texture,ut)):e.lockChannel(ut);var ct,ft=u(Gm(t,e,f,_),3),_t=ft[0],vt=ft[1],yt=ft[2];ct=k?t.programClip:t.programMask,t.useProgram(ct),K.drawMask(t,S,ut,ct),t.deleteTexture(w),e.releaseLockChannel(S),e.releaseLockChannel(ut),t.useProgram(t.program),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,a,n),t.deleteFramebuffer(vt);var dt=new em(t,yt,h,c,f,_,v);return e.releaseLockChannel(_t,dt.page),dt}(e,l,c,O,o,s,a,n),_||(c.__cacheMask=O)),_&&(J[i]=O)}))}if(a){var tt=u(Gm(e,l,o,s),3);Z=tt[0],q=tt[1],$=tt[2]}for(var et=0,rt=n.length;et<rt;et++){var it=n[et],at=it.node,nt=it.total,ot=it.hasMask;if(at instanceof kh){var st=at.__cache,ht=at.__domParent,ut=ht.__matrixEvent,ct=ht.__opacity;if(st&&st.available)l.addTexAndDrawWhenLimit(e,st,ct,ut,h,c,0,0,!0);else if(at.__limitCache&&"hidden"!==ht.__computedStyle[fm]){var ft=lt.getCacheCanvas(o,s,"__$$OVERSIZE$$__");at.render(y.CANVAS,ft.ctx,0,0);var _t=l.lockOneChannel(),vt=K.createTexture(e,ft.canvas,_t),yt=new em(e,vt,0,0,o,s,[0,0,o,s]);l.addTexAndDrawWhenLimit(e,yt,at.__opacity,at.__matrixEvent,h,c,0,0,!0),l.refresh(e,h,c,!0),ft.ctx.setTransform(1,0,0,1,0,0),ft.ctx.globalAlpha=1,ft.ctx.clearRect(0,0,o,s),yt.release(),l.releaseLockChannel(_t)}}else{var dt=at.__computedStyle;if("none"===dt[um]){et+=nt||0,ot&&(et+=Nm(n,et+1,ot));continue}var pt=at.__cache,xt=at.__cacheTotal,gt=at.__cacheFilter,mt=at.__cacheMask,bt=at.__cacheOverflow,Mt=at.__domParent,Et=at.__matrix,At=dt[cm],St=dt[ym],Tt=Et;if(Mt){At*=Mt.__opacity;var wt=Mt.__perspectiveMatrix;Cm(wt)||(Tt=Im(wt,Tt)),Tt=Im(Mt.__matrixEvent,Tt)}at.__opacity=At,Dm(at.__matrixEvent,Tt);var Rt=rm([mt,gt,bt,xt,pt]);if(Rt){if(a&&Lm(St)){l.refresh(e,h,c,!0);var kt=u(Gm(e,l,o,s),3),Ct=kt[0],Ot=kt[1],It=kt[2];l.addTexAndDrawWhenLimit(e,Rt,At,Tt,h,c,0,0,!0),l.refresh(e,h,c,!0);var Ft=u(Xm(e,l,Z,Ct,q,$,Fm(St),o,s),3);Z=Ft[0],q=Ft[1],$=Ft[2],e.deleteFramebuffer(Ot),e.deleteTexture(It)}else l.addTexAndDrawWhenLimit(e,Rt,At,Tt,h,c,0,0,!0);Rt!==pt?(et+=nt||0,ot&&(et+=Nm(n,et+1,ot))):(at.render(t,e,0,0),e.useProgram(e.program),e.viewport(0,0,o,s))}else if(J.hasOwnProperty(et)){var Lt=J[et];if(a&&Lm(St)){l.refresh(e,h,c,!0);var Dt=u(Gm(e,l,o,s),3),Bt=Dt[0],Pt=Dt[1],Nt=Dt[2];l.addTexAndDrawWhenLimit(e,Lt,At,Tt,h,c,0,0,!0),l.refresh(e,h,c,!0);var Gt=u(Xm(e,l,Z,Bt,q,$,Fm(St),o,s),3);Z=Gt[0],q=Gt[1],$=Gt[2],e.deleteFramebuffer(Pt),e.deleteTexture(Nt)}else l.addTexAndDrawWhenLimit(e,Lt,At,Tt,h,c,0,0,!0);et+=nt||0,ot&&(et+=Nm(n,et+1,ot)),at.render(t,e,0,0),e.useProgram(e.program),e.viewport(0,0,o,s)}else if(at.__limitCache&&at.__hasContent){var Ht=lt.getCacheCanvas(o,s,"__$$OVERSIZE$$__");at.render(y.CANVAS,Ht.ctx,0,0);var Wt=l.lockOneChannel(),Yt=K.createTexture(e,Ht.canvas,Wt),zt=new em(e,Yt,0,0,o,s,[0,0,o,s]);l.addTexAndDrawWhenLimit(e,zt,At,Tt,h,c,0,0,!0),l.refresh(e,h,c,!0),Ht.ctx.setTransform(1,0,0,1,0,0),Ht.ctx.globalAlpha=1,Ht.ctx.clearRect(0,0,o,s),zt.release(),l.releaseLockChannel(Wt),at.render(t,e,0,0),e.useProgram(e.program),e.viewport(0,0,o,s)}}}if(l.refresh(e,h,c,!0),a){e.bindFramebuffer(e.FRAMEBUFFER,null),l.releaseLockChannel(Z),e.deleteFramebuffer(q);var Xt=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,Xt),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,-1,1,1]),e.STATIC_DRAW);var Ut=e.getAttribLocation(e.program,"a_position");e.vertexAttribPointer(Ut,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(Ut);var Vt=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,Vt),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,0,1,1]),e.STATIC_DRAW);var Kt=e.getAttribLocation(e.program,"a_texCoords");e.vertexAttribPointer(Kt,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(Kt);var jt=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,jt),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,1,1,1,1]),e.STATIC_DRAW);var Zt=e.getAttribLocation(e.program,"a_opacity");e.vertexAttribPointer(Zt,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(Zt);var qt=e.getUniformLocation(e.program,"u_texture");e.uniform1i(qt,Z),e.drawArrays(e.TRIANGLES,0,6),e.deleteBuffer(Xt),e.deleteBuffer(Vt),e.deleteBuffer(jt),e.disableVertexAttribArray(Ut),e.disableVertexAttribArray(Kt),e.deleteTexture($)}}},Vm="#version 100\n#define GLSLIFY 1\nattribute vec4 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=a_position;v_texCoords=a_texCoords;}",Km=function(){function t(t){this.__units=t,this.__pages=[],this.__list=[],this.__channels=[],this.__locks=[],this.__lockUnits=0}return r(t,[{key:"addTexAndDrawWhenLimit",value:function(t,e,r,i,a,n){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8?arguments[8]:void 0,h=this.__pages,u=this.__list,c=e.page,f=h.indexOf(c);f>-1||((f=h.length)>=this.__units-this.__lockUnits&&this.refresh(t,a,n,l),h.push(c)),u.push([e,r,i,o,s])}},{key:"refresh",value:function(t,e,r,i){var a=this.__pages,n=this.__list;if(a.length){var o=this.channels,s=this.locks,l={};o.forEach((function(t,e){if(t){var r=t.uuid;l[r]=e}}));var h=this.__units,u=new Array(h),c=[];if(a.forEach((function(t){var e=t.uuid;if(l.hasOwnProperty(e)){var r=l[e];u[r]=t}else c.push(t)})),c.length){for(var f=0;f<h&&(u[f]||o[f]||s[f]||(u[f]=c.shift(),c.length));f++);var _=c.length;if(_){for(var v=[],y=0;y<h;y++)u[y]||s[y]||v.push([y,o[y]]);v.sort((function(t,e){return t[1].time!==e[1].time?(t[1].time||0)-(e[1].time||0):t[1].fullSize!==e[1].fullSize?t[1].fullSize-e[1].fullSize:t[0]-e[0]}));for(var d=0;d<_;d++)u[v[d][0]]=c[d]}}for(var p={},x=0,g=u.length;x<g;x++){var m=u[x];if(m){var b=o[x];b&&b===m&&!m.update||(m instanceof tm?K.bindTexture(t,m.texture,x):(!b||b instanceof tm||t.deleteTexture(b.texture),m.texture=K.createTexture(t,m.canvas,x)),o[x]=m),p[m.uuid]=x,m.update=!1,m.time=lt.now()}}K.drawTextureCache(t,n,p,e,r,i),a.splice(0),n.splice(0)}}},{key:"findExistTexChannel",value:function(t){return this.channels.indexOf(t)}},{key:"lockOneChannel",value:function(){for(var t=this.channels,e=this.locks,r=0;r<this.__units;r++)if(!t[r]&&!e[r])return e[r]=!0,this.__lockUnits++,r;for(var i=this.__units,a=[],n=0;n<i;n++)e[n]||a.push([n,t[n]]);if(a.length){a.sort((function(t,e){return t[1].time!==e[1].time?(t[1].time||0)-(e[1].time||0):t[1].fullSize!==e[1].fullSize?t[1].fullSize-e[1].fullSize:t[0]-e[0]}));var o=a[0][0];return t[o]=null,e[o]=!0,this.__lockUnits++,o}throw new Error("No free texture unit")}},{key:"releaseLockChannel",value:function(t,e){this.locks[t]&&(this.locks[t]=!1,this.__lockUnits--,e&&(this.channels[t]=e))}},{key:"lockChannel",value:function(t){var e=this.channels,r=this.locks;r[t]||(e[t]=null,r[t]=!0,this.__lockUnits++)}},{key:"release",value:function(t){this.channels.forEach((function(e){e&&t.deleteTexture(e.texture)}))}},{key:"channels",get:function(){return this.__channels}},{key:"locks",get:function(){return this.__locks}},{key:"last",get:function(){var t=this.__list,e=t.length;if(e)return t[e-1]}}]),t}(),jm=Ct.STYLE_KEY,Zm=jm.TOP,qm=jm.RIGHT,$m=jm.BOTTOM,Jm=jm.LEFT,Qm=jm.POSITION,tb=jm.DISPLAY,eb=jm.VISIBILITY,rb=jm.COLOR,ib=jm.WIDTH,ab=jm.HEIGHT,nb=jm.Z_INDEX,ob=jm.POINTER_EVENTS,sb=jm.WRITING_MODE,lb=jm.TEXT_STROKE_COLOR,hb=jm.TEXT_STROKE_WIDTH,ub=jm.TEXT_STROKE_OVER,cb=jm.MATRIX,fb=jm.TRANSFORM,_b=jm.OPACITY,vb=jm.MIX_BLEND_MODE,yb=G.isNil,db=G.isObject,pb=G.isFunction,xb=d.PX,gb=d.INHERIT,mb=Xl.contain,bb=Xl.getLevel,Mb=Xl.isRepaint,Eb=Xl.NONE,Ab=Xl.FILTER,Sb=Xl.PERSPECTIVE,Tb=Xl.REPAINT,wb=Xl.REFLOW,Rb=Xl.REBUILD,kb=Xl.CACHE,Cb=Xl.TRANSFORM,Ob=Xl.TRANSFORM_ALL,Ib=Xl.OPACITY,Fb=Xl.MIX_BLEND_MODE,Lb=Xi.isGeom,Db={canvas:"canvas",svg:"svg",webgl:"canvas"};var Bb=["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"];var Pb=0,Nb=function(t){function e(e,r,i){var a;return(a=t.call(this,e,r,i)||this).__dom=null,a.__mw=0,a.__mh=0,a.__taskUp=[],a.__task=[],a.__ref={},a.__reflowList=[{node:s(a)}],a.__animateController=new Fg,Oh.mix(s(a)),a.__updateHash={},a.__uuid=Pb++,a.__rlv=Rb,bp.buildRoot(s(a),a.__children),a}return a(e,t),r(e,[{key:"__initProps",value:function(){var t=this.props.width;if(!yb(t)){var e=parseFloat(t)||0;e>0&&(this.__width=e)}var r=this.props.height;if(!yb(r)){var i=parseFloat(r)||0;i>0&&(this.__height=i)}}},{key:"__genHtml",value:function(t){var e=this,r="<".concat(t);return Object.keys(this.props).forEach((function(t){var i=e.props[t];/^on[a-zA-Z]/.test(t)||(r+=function(t,e){var r=Array.isArray(e)?G.joinSourceArray(e):G.stringify(e);if("className"===t)t="class";else if("style"===t)return"";return" "+t+'="'+G.encodeHtml(r,!0)+'"'}(t,i))})),r+="></".concat(t,">")}},{key:"__wrapEvent",value:function(t){var e,r;if(-1===["touchend","touchcancel"].indexOf(t.type)){var i=this.dom,a=this.__scx,n=this.__scy,o=i.getBoundingClientRect(),s=o.x,l=o.y,h=o.left,u=o.top,c=o.width,f=o.height;e=s||h||0,r=l||u||0;var _=t.touches?t.touches[0]:t;e=_.clientX-e,r=_.clientY-r,yb(a)?e*=this.width/c:e/=a,yb(n)?r*=this.height/f:r/=n}return{event:t,stopPropagation:function(){this.__stopPropagation=!0,t.stopPropagation()},stopImmediatePropagation:function(){this.__stopPropagation=!0,this.__stopImmediatePropagation=!0,t.stopImmediatePropagation()},preventDefault:function(){t.preventDefault()},x:e,y:r,__hasEmitted:!1}}},{key:"__cb",value:function(t){if("touchmove"!==t.type||this.__touchstartTarget){var e=this.__wrapEvent(t);return this.__emitEvent(e,null,!1),e}}},{key:"appendTo",value:function(t){t=function(t){if(G.isString(t)&&t){var e=document.querySelector(t);if(!e)throw new Error("Can not find dom of selector: "+t);return e}if(!t)throw new Error("Can not find dom: "+t);return t}(t),this.__isDestroyed=!1,this.__initProps();var r=this.tagName,i=Db[r];if("undefined"!=typeof window&&window.OffscreenCanvas&&t instanceof window.OffscreenCanvas||"undefined"!=typeof self&&self.OffscreenCanvas&&t instanceof self.OffscreenCanvas?(this.__dom=t,this.__width=t.width,this.__height=t.height):t.nodeName.toLowerCase()===i?(this.__dom=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__dom=t.querySelector(i),this.__dom||(t.innerHTML=this.__genHtml(i),this.__dom=t.querySelector(i))),this.__defs=this.dom.__defs||hg.getInstance(this.__uuid),!this.width||!this.height){var a=window.getComputedStyle(t,null);this.width||(this.__width=parseFloat(a.getPropertyValue("width"))||0,t.setAttribute("width",this.width)),this.height||(this.__height=parseFloat(a.getPropertyValue("height"))||0,t.setAttribute("height",this.height))}this.width&&this.height||lt.warn("Karas render target with a width or height of 0.");var n=Object.assign({},W,this.props.contextAttributes);if("canvas"===this.tagName)this.__ctx=this.__dom.getContext("2d",n),this.__renderMode=y.CANVAS;else if("svg"===this.tagName)this.__renderMode=y.SVG;else if("webgl"===this.tagName){var o=this.__ctx=this.__dom.getContext("webgl",n);this.__renderMode=y.WEBGL,o.program=K.initShaders(o,"#version 100\n#define GLSLIFY 1\nattribute vec4 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;attribute float a_opacity;varying float v_opacity;void main(){gl_Position=a_position;v_texCoords=a_texCoords;v_opacity=a_opacity;}","#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;varying float v_opacity;uniform sampler2D u_texture;void main(){float opacity=v_opacity;if(opacity<=0.0){discard;}opacity=clamp(opacity,0.0,1.0);vec4 color=texture2D(u_texture,v_texCoords);gl_FragColor=color*opacity;}"),o.programMask=K.initShaders(o,Vm,"#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);float a=color1.a*color2.a;gl_FragColor=vec4(color1.rgb*color2.a,a);}"),o.programClip=K.initShaders(o,Vm,"#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture1;uniform sampler2D u_texture2;void main(){vec4 color1=texture2D(u_texture1,v_texCoords);vec4 color2=texture2D(u_texture2,v_texCoords);float a=color1.a*(1.0-color2.a);gl_FragColor=vec4(color1.rgb*(1.0-color2.a),a);}"),o.programOverflow=K.initShaders(o,Vm,"#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;void main(){gl_FragColor=texture2D(u_texture,v_texCoords);}"),o.programCm=K.initShaders(o,"#version 100\n#define GLSLIFY 1\nattribute vec4 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=a_position;v_texCoords=a_texCoords;}","#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_m[20];void main(){vec4 c=texture2D(u_texture,v_texCoords);if(c.a>0.0){c.rgb/=c.a;}vec4 result;result.r=(u_m[0]*c.r);result.r+=(u_m[1]*c.g);result.r+=(u_m[2]*c.b);result.r+=(u_m[3]*c.a);result.r+=u_m[4];result.g=(u_m[5]*c.r);result.g+=(u_m[6]*c.g);result.g+=(u_m[7]*c.b);result.g+=(u_m[8]*c.a);result.g+=u_m[9];result.b=(u_m[10]*c.r);result.b+=(u_m[11]*c.g);result.b+=(u_m[12]*c.b);result.b+=(u_m[13]*c.a);result.b+=u_m[14];result.a=(u_m[15]*c.r);result.a+=(u_m[16]*c.g);result.a+=(u_m[17]*c.b);result.a+=(u_m[18]*c.a);result.a+=u_m[19];gl_FragColor=vec4(result.rgb*result.a,result.a);}"),o.programDs=K.initShaders(o,"#version 100\n#define GLSLIFY 1\nattribute vec4 a_position;attribute vec2 a_texCoords;varying vec2 v_texCoords;void main(){gl_Position=a_position;v_texCoords=a_texCoords;}","#version 100\n#ifdef GL_ES\nprecision mediump float;\n#define GLSLIFY 1\n#endif\nvarying vec2 v_texCoords;uniform sampler2D u_texture;uniform float u_color[4];void main(){vec4 c=texture2D(u_texture,v_texCoords);gl_FragColor=vec4(u_color[0]*c.a,u_color[1]*c.a,u_color[2]*c.a,u_color[3]*c.a);}"),o.useProgram(o.program);var s=Math.min(16,o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS));this.__texCache=new Km(s)}this.refresh(!0),this.dom.__root&&this.dom.__root instanceof e&&this.dom.__root.destroy(),this.__eventCbList=function(t,e){var r=[];return Bb.forEach((function(i){function a(r){var a=t.__root;if(a&&a instanceof e)if(["touchend","touchcancel","touchmove"].indexOf(i)>-1){var n=a.__touchstartTarget,o=a.__wrapEvent(r);for(o.target=n;n;)n.__emitEvent(o,null,!0),n=n.domParent}else a.__cb(r)}t.addEventListener(i,a),r.push([i,a])})),r}(this.dom,e),this.dom.__root=this}},{key:"__reLayout",value:function(){var t=this.renderMode,e=this.width,r=this.height;this.__checkRoot(t,e,r);var i=this.__currentStyle[sb],a=i.v&&0===i.v.indexOf("vertical");this.__layout({x:0,y:0,w:e,h:r,isUpright:a},!1,!1,!1),this.__layoutAbs(this,{x:0,y:0,w:e,h:r,isUpright:a},null),this.__structs=this.__structure(0,0)}},{key:"refresh",value:function(t){var e=this.isDestroyed,r=this.renderMode,i=this.ctx,a=this.defs;if(!e&&(a.clear(),t&&this.__reLayout(),!this.props.noRender)){if(r===y.CANVAS)this.__clear(i,r),Um.renderCanvas(r,i,this);else if(r===y.SVG){Um.renderSvg(r,a,this,t);var n=this.virtualDom;n.defs=a.value,this.dom.__vd?xg(this.dom,this.dom.__vd,n):this.dom.innerHTML=G.joinVirtualDom(n),this.dom.__vd=n,this.dom.__defs=a}else r===y.WEBGL&&(this.__clear(i,r),Um.renderWebgl(r,i,this,t));this.emit(Oh.REFRESH,this.__rlv),this.__rlv=Eb}}},{key:"destroy",value:function(){this.__destroy(),this.animateController.__destroy();var t,e=this.dom;e&&(t=e,(this.__eventCbList||[]).forEach((function(e){t.removeEventListener(e[0],e[1])})),e.__root=null);var r=this.ctx;this.__texCache&&r&&(this.__texCache.release(r),r.program&&(r.deleteShader(r.program.vertexShader),r.deleteShader(r.program.fragmentShader),r.deleteProgram(r.program)),r.programMask&&(r.deleteShader(r.programMask.vertexShader),r.deleteShader(r.programMask.fragmentShader),r.deleteProgram(r.programMask)),r.programOverflow&&(r.deleteShader(r.programOverflow.vertexShader),r.deleteShader(r.programOverflow.fragmentShader),r.deleteProgram(r.programOverflow)))}},{key:"scale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.__scx=t,this.__scy=e}},{key:"resize",value:function(t,e,r){var i=this;t!==i.width||e!==i.height?(i.__width=t,i.__height=e,i.updateStyle({width:t,height:e},r)):pb(r)&&r(-1)}},{key:"addRefreshTask",value:function(t){var e=this,r=this.taskUp;if(!this.isDestroyed){var i;if(!r.length)yu.nextFrame({__before:function(t){e.isDestroyed||(i=r.splice(0)).length&&i.forEach((function(e,r){db(e)&&pb(e.__before)&&e.__before(t)}))},__after:function(t){e.isDestroyed||i.forEach((function(e){db(e)&&pb(e.__after)?e.__after(t):pb(e)&&e(t)}))}}),this.__frameHook();-1===r.indexOf(t)&&r.push(t)}}},{key:"delRefreshTask",value:function(t){if(t)for(var e=this.taskUp,r=0,i=e.length;r<i;r++)if(e[r]===t){e.splice(r,1);break}}},{key:"getTargetAtPoint",value:function(t,e,r){return function t(e,i,a,n,o){var s=e.__sx1,l=e.__sy1,h=e.offsetWidth,u=e.offsetHeight,c=e.matrixEvent,f=e.children,_=e.zIndexChildren,v=e.computedStyle,y=v[tb],d=v[ob];if(r||"none"!==y){if(Array.isArray(_)){for(var p=0,x=f.length;p<x;p++)f[p].__index__=p;for(var g=_.length-1;g>=0;g--){var m=_[g];if(!(m instanceof karas.Text)){var b=n.slice();b.push(m.__index__);var M=o.slice();M.push(g);var E=t(m,i,a,b,M);if(E)return E}}}if(r||"none"!==d)return Ut.pointInQuadrilateral(i,a,s,l,s+h,l,s+h,l+u,s,l+u,c)?{target:e,path:n,zPath:o}:void 0}}(this,t,e,[],[])}},{key:"__checkRoot",value:function(t,e,r){var i=this.dom,a=this.currentStyle,n=this.computedStyle;-1===["flex","block"].indexOf(a[tb])&&(n[tb]=a[tb]="block"),"absolute"===a[Qm]&&(n[Qm]=a[Qm]="static"),a[ib]={v:e,u:xb},a[ab]={v:r,u:xb},n[ib]=e,n[ab]=r,t===y.CANVAS||t===y.WEBGL?(i.width!==e&&(i.width=e),i.height!==r&&(i.height=r)):t===y.SVG&&(i.setAttribute("width",e),i.setAttribute("height",r))}},{key:"__addUpdate",value:function(t,e){t instanceof Bh&&(t=t.shadowRoot);var r,i,a,n,o,s,l,h=e.keys,u=e.focus,c=e.addDom,f=e.removeDom,_=t,v=_.computedStyle,d=_.currentStyle,p=_.cacheStyle,x=_.__cacheProps,g=_.__isMask,m=_.__domParent,b=u||Eb;if(h)for(var M=0,E=h.length;M<E;M++){var A=h[M];if(t instanceof Nd&&Lb(t.tagName,A))b|=Tb,x[A]=void 0;else{if(p[A]=void 0,(A===Zm||A===qm||A===$m||A===Jm)&&-1===["relative","absolute"].indexOf(v[Qm]))continue;b|=bb(A),A===tb?n=!0:A===nb?r=t!==this&&["relative","absolute"].indexOf(v[Qm])>-1:A===eb?i=!0:A===rb?a=!0:A===lb?o=!0:A===hb?s=!0:A===ub&&(l=!0)}}if(b===Eb||"none"===v[tb]&&!n)pb(e.cb)&&e.cb();else{if(mb(b,Cb)&&(p[cb]=v[fb]=void 0),g){for(var S=t.__prev;S&&S.__isMask;)S=S.__prev;S&&S.__cacheMask&&(S.__cacheMask.release(),S.__refreshLevel|=kb)}if(Mb(b)){var T=b>=Tb;if(T?(t.__cache&&t.__cache.release(),t.__calStyle(b,d,v,p),t.__calPerspective(d,v,p)):(mb(b,Sb)&&t.__calPerspective(d,v,p),mb(b,Ob)&&t.__calMatrix(b,d,v,p),mb(b,Ib)&&(v[_b]=d[_b]),mb(b,Ab)&&t.__calFilter(d,v,p),mb(b,Fb)&&(v[vb]=d[vb])),i||a||o||s||l)for(var w=this.__structs,R=t.__struct,k=w.indexOf(R)+1,C=k+(R.total||0);k<C;k++){var O=w[k],I=O.node,F=O.total;if(!(I instanceof kh)){var L=I.__currentStyle,D=I.__cacheStyle,B=void 0;i&&L[eb].u===gb?(B=!0,D[eb]=void 0):a&&L[rb].u===gb?(B=!0,D[rb]=void 0):o&&L[lb].u===gb?(B=!0,D[lb]=void 0):s&&L[hb].u===gb?(B=!0,D[hb]=void 0):l&&L[ub].u===gb&&(B=!0,D[ub]=void 0),B?(I.__refreshLevel|=Tb,I.clearCache(),I.__calStyle(Tb,L,I.__computedStyle,D)):k+=F||0}}(T||mb(b,Sb))&&(t.__cacheTotal&&t.__cacheTotal.release(),t.__cacheMask&&t.__cacheMask.release(),t.__cacheOverflow&&t.__cacheOverflow.release()),(T||mb(b,Ab))&&t.__cacheFilter&&t.__cacheFilter.release();for(var P=m;P&&!mb(P.__refreshLevel,kb|Tb|wb);)P.__refreshLevel|=kb,P.__cacheTotal&&P.__cacheTotal.release(),P.__cacheFilter&&P.__cacheFilter.release(),P.__cacheMask&&P.__cacheMask.release(),P.__cacheOverflow&&P.__cacheOverflow.release(),P=P.__domParent;r&&m&&(m.__zIndexChildren=null,m.__updateStruct(),this.renderMode===y.SVG&&(t.__cacheTotal.release(),xp.clearSvgCache(m)))}else{var N=xp.checkTop(this,t,c,f);if(N===this?this.__reLayout():xp.checkNext(this,N,t,r,c,f),f){for(var G=t;G.isShadowRoot;)(G=G.__host).__destroy();t.__destroy()}}t.__refreshLevel|=b,this.__rlv|=c||f?Rb:b,e.cb&&!pb(e.cb)&&(e.cb=null),this.__frameRefresh(e.cb)}}},{key:"__frameRefresh",value:function(t){var e=this;this.__task.length||(yu.nextFrame((function(){})),yu.__rootTask.push((function(){var t=e.__task.splice(0);e.refresh(),t.forEach((function(t){t&&t()}))}))),this.__task.push(t)}},{key:"__clear",value:function(t,e){e===y.CANVAS?(this.__mw=Math.max(this.__mw,this.width),this.__mh=Math.max(this.__mh,this.height),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.__mw,this.__mh)):e===y.WEBGL&&(t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT))}},{key:"dom",get:function(){return this.__dom}},{key:"uuid",get:function(){return this.__uuid}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"ctx",get:function(){return this.__ctx}},{key:"defs",get:function(){return this.__defs}},{key:"taskUp",get:function(){return this.__taskUp}},{key:"ref",get:function(){return this.__ref}},{key:"animateController",get:function(){return this.__animateController}},{key:"texCache",get:function(){return this.__texCache}}]),e}(Ix),Gb=Ct.STYLE_KEY.STROKE_WIDTH,Hb=G.isNil;function Wb(t,e,r,i){return i?t.map((function(t){return e+t*r})):e+t*r}function Yb(t,e,r,i,a,n){if(n){if(t)return t.map((function(t){return Yb(t,e,r,i,a)}))}else if(t&&t.length>=2)return[e+t[0]*i,r+t[1]*a];return[]}function zb(t,e){var r=0;return t&&t.length>=2&&r++,e&&e.length>=2&&(r+=2),r}function Xb(t,e,r,i,a,n,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;if(0===s&&1===l)return[t,e,r,i,a,n];if(s===l)return[];if(s>l){var h=[l,s];s=h[0],l=h[1]}if(s=Math.max(0,s),l=Math.min(1,l),3===o){var c=eo.sliceBezier2Both([[t,e],a,n,[r,i]],s,l),f=u(c,4),_=u(f[0],2);t=_[0],e=_[1],a=f[1],n=f[2];var v=u(f[3],2);r=v[0],i=v[1]}else if(2===o){var y=eo.sliceBezier2Both([[t,e],n,[r,i]],s,l),d=u(y,3),p=u(d[0],2);t=p[0],e=p[1],n=d[1];var x=u(d[2],2);r=x[0],i=x[1]}else if(1===o){var g=eo.sliceBezier2Both([[t,e],a,[r,i]],s,l),m=u(g,3),b=u(m[0],2);t=b[0],e=b[1],a=m[1];var M=u(m[2],2);r=M[0],i=M[1]}else{var E=r-t,A=i-e;t+=E*s,e+=A*s,r+=E*(1-l),i+=A*(1-l)}return[t,e,r,i,a,n]}var Ub=function(t){function e(e,r){var i;if((i=t.call(this,e,r)||this).isMulti){if(i.__x1=[0],i.__y1=[0],i.__x2=[1],i.__y2=[1],i.__controlA=[[]],i.__controlB=[[]],i.__start=[0],i.__end=[1],Array.isArray(r.x1)?i.__x1=r.x1.map((function(t){return parseFloat(t)||0})):Hb(r.x1)||(i.__x1=[parseFloat(r.x1)||0]),Array.isArray(r.y1)?i.__y1=r.y1.map((function(t){return parseFloat(t)||0})):Hb(r.y1)||(i.__y1=[parseFloat(r.y1)||0]),Array.isArray(r.x2)?i.__x2=r.x2.map((function(t){return parseFloat(t)||0})):Hb(r.x2)||(i.__x2=[parseFloat(r.x2)||0]),Array.isArray(r.y2)?i.__y2=r.y2.map((function(t){return parseFloat(t)||0})):Hb(r.y2)||(i.__y2=[parseFloat(r.y2)||0]),Array.isArray(r.controlA)&&(i.__controlA=r.controlA.map((function(t){return Array.isArray(t)?t:[]}))),Array.isArray(r.controlB)&&(i.__controlB=r.controlB.map((function(t){return Array.isArray(t)?t:[]}))),Array.isArray(r.start)){i.__start=r.start.map((function(t){return parseFloat(t)||0}));for(var a=i.__start.length;a<i.__x1.length;a++)i.__start.push(0)}else if(!Hb(r.start)){var n=parseFloat(r.start)||0;i.__start=i.__x1.map((function(){return n}))}if(Array.isArray(r.end)){i.__end=r.end.map((function(t){var e=parseFloat(t);return isNaN(e)&&(e=1),e}));for(var o=i.__end.length;o<i.__x1.length;o++)i.__end.push(1)}else if(!Hb(r.end)){var s=parseFloat(r.end);isNaN(s)&&(s=1),i.__end=i.__x1.map((function(){return s}))}}else{if(i.__x1=i.__y1=i.__start=0,i.__x2=i.__y2=i.__end=1,i.__controlA=[],i.__controlB=[],Hb(r.x1)||(i.__x1=parseFloat(r.x1)||0),Hb(r.y1)||(i.__y1=parseFloat(r.y1)||0),Hb(r.x2)||(i.__x2=parseFloat(r.x2)||0),Hb(r.y2)||(i.__y2=parseFloat(r.y2)||0),Hb(r.start)||(i.__start=parseFloat(r.start)||0),!Hb(r.end)){var l=parseFloat(r.end);isNaN(l)&&(l=1),i.__end=l}Array.isArray(r.controlA)&&(i.__controlA=r.controlA),Array.isArray(r.controlB)&&(i.__controlB=r.controlB)}return i}return a(e,t),r(e,[{key:"buildCache",value:function(t,e,r){var i,a=this,n=this.width,o=this.height,s=this.__cacheProps,l=this.isMulti;return["x1","x2"].forEach((function(e){(Hb(s[e])||r)&&(i=!0,s[e]=Wb(a[e],t,n,l))})),["y1","y2"].forEach((function(t){(Hb(s[t])||r)&&(i=!0,s[t]=Wb(a[t],e,o,l))})),["controlA","controlB"].forEach((function(h){(Hb(s[h])||r)&&(i=!0,s[h]=Yb(a[h],t,e,n,o,l))})),["start","end"].forEach((function(t){(Hb(s[t])||r)&&(i=!0,s[t]=a[t])})),i}},{key:"render",value:function(t,r,i,a){var o=this,s=h(n(e.prototype),"render",this).call(this,t,r,i,a);if(s.break||t===y.WEBGL)return s;var l=s.sx3,c=s.sy3,f=s.stroke,_=s.strokeWidth,v=s.strokeDasharray,d=s.strokeDasharrayStr,p=s.strokeLinecap,x=s.strokeLinejoin,g=s.strokeMiterlimit,m=s.dx,b=s.dy,M=this.__cacheProps,E=this.isMulti;if(this.buildCache(l,c)&&t===y.SVG){var A="";if(E)M.x1.forEach((function(t,e){var r=M.x2[e],i=M.y1[e],a=M.y2[e],n=M.controlA[e],o=M.controlB[e],s=M.start[e],l=M.end[e],h=zb(n,o);if(0!==s||1!==l){var c=u(Xb(t,i,r,i,n,o,h,s,l,M.len),6);t=c[0],i=c[1],r=c[2],i=c[3],n=c[4],o=c[5]}A+=Zt.svgLine(t,i,r,a,n,o,h)}));else{var S=zb(M.controlA,M.controlB),T=M.x1,w=M.y1,R=M.x2,k=M.y2,C=M.controlA,O=M.controlB,I=M.start,F=M.end;if(0!==I||1!==F){var L=u(Xb(T,w,R,k,C,O,S,I,F,M.len),6);T=L[0],w=L[1],R=L[2],k=L[3],C=L[4],O=L[5]}A=Zt.svgLine(T,w,R,k,C,O,S)}M.d=A}return t===y.CANVAS||t===y.WEBGL?f.forEach((function(e,i){var a=_[i],n=a>0&&"radial"===e.k&&Array.isArray(e.v);if(a>0&&"none"!==e){if(o.__preSetCanvas(t,r,{stroke:e,strokeWidth:a,strokeDasharray:v[i],strokeLinecap:p[i],strokeLinejoin:x[i],strokeMiterlimit:g[i]}),n&&(r.strokeStyle=e.v[0]),r.beginPath(),E)M.x1.forEach((function(t,e){var i=M.x2[e],a=M.y1[e],n=M.y2[e],o=M.controlA[e],s=M.controlB[e],l=M.start[e],h=M.end[e],c=zb(o,s);if(0!==l||1!==h){var f=u(Xb(t,a,i,a,o,s,c,l,h,M.len),6);t=f[0],a=f[1],i=f[2],a=f[3],o=f[4],s=f[5]}Zt.canvasLine(r,t,a,i,n,o,s,c,m,b)}));else{var s=zb(M.controlA,M.controlB),l=M.x1,h=M.y1,c=M.x2,f=M.y2,y=M.controlA,d=M.controlB,A=M.start,S=M.end;if(0!==A||1!==S){var T=u(Xb(l,h,c,f,y,d,s,A,S,M.len),6);l=T[0],h=T[1],c=T[2],f=T[3],y=T[4],d=T[5]}Zt.canvasLine(r,l,h,c,f,y,d,s,m,b)}r.stroke(),r.closePath()}})):t===y.SVG&&f.forEach((function(t,e){var r=_[e],i=r>0&&"radial"===t.k&&Array.isArray(t.v),a=[["d",M.d],["fill","none"],["stroke",i?t.v[0]:t.v||t],["stroke-width",r]];o.__propsStrokeStyle(a,d[e],p[e],x[e],g[e]),o.addGeom("path",a)})),s}},{key:"x1",get:function(){return this.getProps("x1")}},{key:"y1",get:function(){return this.getProps("y1")}},{key:"x2",get:function(){return this.getProps("x2")}},{key:"y2",get:function(){return this.getProps("y2")}},{key:"controlA",get:function(){return this.getProps("controlA")}},{key:"controlB",get:function(){return this.getProps("controlB")}},{key:"start",get:function(){return this.getProps("start")}},{key:"end",get:function(){return this.getProps("end")}},{key:"bbox",get:function(){var t=this.isMulti,r=this.__cacheProps,i=this.__sx3,a=this.__sy3,o=this.computedStyle[Gb];this.buildCache(i,a);var s=r.x1,l=r.y1,u=r.x2,c=r.y2,f=r.controlA,_=r.controlB,v=h(n(e.prototype),"bbox",this),y=0;return o.forEach((function(t){y=Math.max(y,t)})),y=Math.ceil(.5*y)+1,t||(s=[s],u=[u],l=[l],c=[c],f=[f],_=[_]),s.forEach((function(t,e){var r=l[e],i=u[e],a=c[e],n=f[e],o=_[e];if((Hb(n)||n.length<2)&&(Hb(o)||o.length<2))v[0]=Math.min(v[0],t-y),v[0]=Math.min(v[0],i-y),v[1]=Math.min(v[1],r-y),v[1]=Math.min(v[1],a-y),v[2]=Math.max(v[2],t+y),v[2]=Math.max(v[2],i+y),v[3]=Math.max(v[3],r+y),v[3]=Math.max(v[3],a+y);else if(Hb(n)||n.length<2){var s=eo.bboxBezier(t,r,o[0],o[1],i,a);v[0]=Math.min(v[0],s[0]-y),v[0]=Math.min(v[0],s[2]-y),v[1]=Math.min(v[1],s[1]-y),v[1]=Math.min(v[1],s[3]-y),v[2]=Math.max(v[2],s[0]+y),v[2]=Math.max(v[2],s[2]+y),v[3]=Math.max(v[3],s[1]+y),v[3]=Math.max(v[3],s[3]+y)}else if(Hb(o)||o.length<2){var h=eo.bboxBezier(t,r,n[0],n[1],i,a);v[0]=Math.min(v[0],h[0]-y),v[0]=Math.min(v[0],h[2]-y),v[1]=Math.min(v[1],h[1]-y),v[1]=Math.min(v[1],h[3]-y),v[2]=Math.max(v[2],h[0]+y),v[2]=Math.max(v[2],h[2]+y),v[3]=Math.max(v[3],h[1]+y),v[3]=Math.max(v[3],h[3]+y)}else{var d=eo.bboxBezier(t,r,n[0],n[1],o[0],o[1],i,a);v[0]=Math.min(v[0],d[0]-y),v[0]=Math.min(v[0],d[2]-y),v[1]=Math.min(v[1],d[1]-y),v[1]=Math.min(v[1],d[3]-y),v[2]=Math.max(v[2],d[0]+y),v[2]=Math.max(v[2],d[2]+y),v[3]=Math.max(v[3],d[1]+y),v[3]=Math.max(v[3],d[3]+y)}})),v}}]),e}(Nd),Vb=Vo.intersect,Kb=Vo.union,jb=Vo.subtract,Zb=Vo.subtract2,qb=Vo.xor,$b=Vo.chain,Jb=Ct.STYLE_KEY.STROKE_WIDTH,Qb=G.isNil;function tM(t,e){return Array.isArray(e)&&(2===e.length||4===e.length)&&Array.isArray(t)&&2===t.length?e.concat(t):t}function eM(t,e){var r=[],i=0,a=[];if(e)i=[],t.forEach((function(t){var e=eM(t);r.push(e.list),i.push(e.total),a.push([0].concat(e.increase))}));else if(Array.isArray(t)){i=0,a.push(0);for(var n=0,o=0,s=t.length;o<s;o++){var l=t[o];if(Array.isArray(l)){n=o;break}}for(var h=t[n],u=n+1,c=t.length;u<c;u++){var f=t[u];if(Array.isArray(f))if(2===f.length){var _=Math.abs(f[0]-h[0]),v=Math.abs(f[1]-h[1]),y=Math.sqrt(Math.pow(_,2)+Math.pow(v,2));r.push(y),i+=y,a.push(i),h=f}else if(4===f.length){var d=eo.bezierLength([h,[f[0],f[1]],[f[2],f[3]]]);r.push(d),i+=d,a.push(i),h=[f[2],f[3]]}else if(6===f.length){var p=eo.bezierLength([h,[f[0],f[1]],[f[2],f[3]],[f[4],f[5]]]);r.push(p),i+=p,a.push(i),h=[f[4],f[5]]}}}return{list:r,total:i,increase:a}}function rM(t,e,r,i){if(r===i)return t[r]>e?r-1:r;var a=r+(i-r>>1);return t[a]===e?a:t[a]>e?rM(t,e,r,Math.max(a-1,r)):rM(t,e,Math.min(a+1,i),i)}function iM(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(0===r&&1===i)return t;if(r===i)return[];if(r>i){var a=[i,r];r=a[0],i=a[1]}for(;i-r>1;)i--;for(;i<0||r<0;)i++,r++;for(;i>=1&&r>=1;)i--,r--;var n=t.length;t=G.clone(t);var o,s=[],l=r>1?r-1:r,h=i>1?i-1:i,u=rM(e.increase,l*e.total,0,n-1),c=rM(e.increase,h*e.total,0,n-1),f=r<0,_=i>1,v=1;if((h*=e.total)>e.increase[c]){var y=t[c].slice(t[c].length-2),d=t[c+1],p=e.list[c],x=h-e.increase[c],g=x/p;if(v=g,2===d.length){var m=d[0]-y[0],b=d[1]-y[1];_?o=[y[0]+g*m,y[1]+g*b]:(g=1-g,o=[d[0]-g*m,d[1]-g*b])}else if(4===d.length){var M=eo.sliceBezier([y,[d[0],d[1]],[d[2],d[3]]],g);o=[M[1][0],M[1][1],M[2][0],M[2][1]]}else if(6===d.length){var E=eo.sliceBezier([y,[d[0],d[1]],[d[2],d[3]],[d[4],d[5]]],g);o=[E[1][0],E[1][1],E[2][0],E[2][1],E[3][0],E[3][1]]}}if((l*=e.total)>e.increase[u]){var A,S=t[u].slice(t[u].length-2),T=e.list[u];u!==c||f||_||1===v||(T*=v,o&&(A=o)),A||(A=t[u+1]);var w=l-e.increase[u],R=w/T;if(2===A.length){var k=A[0]-S[0],C=A[1]-S[1];f?(R=1-R,s.push([A[0]-R*k,A[1]-R*C])):s.push([S[0]+R*k,S[1]+R*C]),s.push(A)}else if(4===A.length){var O=eo.sliceBezier([[A[2],A[3]],[A[0],A[1]],S],1-R).reverse();s.push(O[0]),s.push([O[1][0],O[1][1],O[2][0],O[2][1]]),u!==c||f||_||(o=null)}else if(6===A.length){var I=eo.sliceBezier([[A[4],A[5]],[A[2],A[3]],[A[0],A[1]],S],1-R).reverse();s.push(I[0]),s.push([I[1][0],I[1][1],I[2][0],I[2][1],A[4],A[5]]),u!==c||f||_||(o=null)}}for(var F=u+2;F<=c+(f||_?n:0);F++)s.push(t[F%n]);return o&&s.push(o),s}var aM=function(t){function e(e,r){var i;if((i=t.call(this,e,r)||this).isMulti){if(i.__points=[[]],i.__controls=[[]],i.__start=[0],i.__end=[1],Array.isArray(r.start)){i.__start=r.start.map((function(t){return parseFloat(t)||0}));for(var a=i.__start.length;a<i.__points.length;a++)i.__start.push(0)}else if(!Qb(r.start)){var n=parseFloat(r.start)||0;i.__start=i.__points.map((function(){return n}))}if(Array.isArray(r.end)){i.__end=r.end.map((function(t){var e=parseFloat(t);return isNaN(e)&&(e=1),e}));for(var o=i.__end.length;o<i.__points.length;o++)i.__end.push(1)}else if(!Qb(r.end)){var s=parseFloat(r.end);isNaN(s)&&(s=1),i.__end=i.__points.map((function(){return s}))}}else if(i.__points=[],i.__controls=[],i.__start=0,i.__end=1,Qb(r.start)||(i.__start=parseFloat(r.start)||0),!Qb(r.end)){var l=parseFloat(r.end);isNaN(l)&&(l=1),i.__end=l}return Array.isArray(r.controls)&&(i.__controls=r.controls),Array.isArray(r.points)&&(i.__points=r.points),r.booleanOperations&&(i.__booleanOperations=r.booleanOperations),i}return a(e,t),r(e,[{key:"__getPoints",value:function(t,e,r,i,a,n){return a.map((function(a){if(Array.isArray(a)){var o=a.length;if(n){if(0!==o&&2!==o&&4!==o)return}else if(0!==o&&2!==o)return;for(var s=[],l=0;l<o;l++)l%2==0?s.push(t+a[l]*r):s.push(e+a[l]*i);return s}}))}},{key:"__reprocessing",value:function(t,e){if(!e||t.length<2)return t;var r=this.booleanOperations,i=t.length;if(!r)return t;if(!Array.isArray(r)){var a=r;r=[r];for(var n=1;n<i-1;n++)r.push(a)}if(Array.isArray(r)&&r.length){for(var o=[],s=t[0],l=1;l<i;l++){var h=(r[l-1]||"").toString().toLowerCase(),u=t[l];if(-1!==["intersect","intersection","union","subtract","subtract2","diff","difference","xor"].indexOf(h))switch(h){case"intersect":case"intersection":s=Vb(s,u,!0);break;case"union":s=Kb(s,u,!0);break;case"subtract":case"diff":case"difference":s=jb(s,u,!0);break;case"subtract2":s=Zb(s,u,!0);break;case"xor":s=qb(s,u,!0)}else o=o.concat($b(s)),s=u||[]}return o.concat($b(s))}return t}},{key:"__needRebuildSE",value:function(t){if(G.isNil(t.booleanOperations))return t.booleanOperations=!0,!0}},{key:"buildCache",value:function(t,e){var r,i,a=this,n=this.width,o=this.height,s=this.points,l=this.controls,h=this.start,u=this.end,c=this.__cacheProps,f=this.isMulti;if(Qb(c.points)&&(r=!0,c.points=f?s.map((function(r){if(Array.isArray(r))return a.__getPoints(t,e,n,o,r)})):this.__getPoints(t,e,n,o,s)),Qb(c.controls)&&(r=!0,c.controls=f?l.map((function(r){return Array.isArray(r)?a.__getPoints(t,e,n,o,r,!0):r})):this.__getPoints(t,e,n,o,l,!0)),Qb(c.start)&&(i=!0,c.start=h),Qb(c.end)&&(i=!0,c.end=u),this.__needRebuildSE(c)&&(i=!0),r){var _=c.points,v=c.controls;f?(c.list2=_.map((function(t,e){var r=v[e];if(Array.isArray(t))return t.map((function(t,e){return e?tM(t,r&&r[e-1]):t}))})),c.len=eM(c.list2,f)):(c.list2=_.map((function(t,e){return e?tM(t,v[e-1]):t})),c.len=eM(c.list2,f))}return(r||i)&&(c.list=f?c.list2.map((function(t,e){if(Array.isArray(t)){var r=c.len;return iM(t,{list:r.list[e],total:r.total[e],increase:r.increase[e]},c.start[e],c.end[e])}})):iM(c.list2,c.len,c.start,c.end),c.list=this.__reprocessing(c.list,f)),r||i}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a);return o.break||t===y.WEBGL||(this.buildCache(o.sx3,o.sy3),this.__renderPolygon(t,r,o)),o}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}},{key:"start",get:function(){return this.getProps("start")}},{key:"end",get:function(){return this.getProps("end")}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.isMulti,r=this.__cacheProps,i=this.__sx3,a=this.__sy3,o=this.computedStyle[Jb];this.buildCache(i,a);var s=h(n(e.prototype),"bbox",this),l=0;o.forEach((function(t){l=Math.max(l,t)})),l=Math.ceil(.5*l)+1;var c=r.points,f=r.controls;t||(c=[c],f=[f]),c.forEach((function(t,e){if(!(!t||t.length<2||!t[0]||!t[1]||t[0].length<2||t[1].length<2))for(var r=f[e]||[],i=u(t[0],2),a=i[0],n=i[1],o=1,h=t.length;o<h;o++){var c=t[o];if(c&&!(c.length<2)){var _=u(t[o],2),v=_[0],y=_[1],d=r[o-1];if(d&&4===d.length){var p=eo.bboxBezier(a,n,d[0],d[1],d[2],d[3],v,y);s[0]=Math.min(s[0],p[0]-l),s[1]=Math.min(s[1],p[1]-l),s[2]=Math.max(s[2],p[2]+l),s[3]=Math.max(s[3],p[3]+l)}else if(d&&2===d.length){var x=eo.bboxBezier(a,n,d[0],d[1],v,y);s[0]=Math.min(s[0],x[0]-l),s[1]=Math.min(s[1],x[1]-l),s[2]=Math.max(s[2],x[2]+l),s[3]=Math.max(s[3],x[3]+l)}else s[0]=Math.min(s[0],a-l),s[1]=Math.min(s[1],n-l),s[2]=Math.max(s[2],a+l),s[3]=Math.max(s[3],n+l);a=v,n=y}}})),this.__bbox=s}return this.__bbox}},{key:"booleanOperations",get:function(){return this.getProps("booleanOperations")}}]),e}(Nd),nM=function(t){function e(e,r){return t.call(this,e,r)||this}return a(e,t),r(e,[{key:"__getPoints",value:function(t,r,i,a,o,s){var l=h(n(e.prototype),"__getPoints",this).call(this,t,r,i,a,o,s);return s||l.push(l[0]),l}}]),e}(aM),oM=Ct.STYLE_KEY.STROKE_WIDTH,sM=G.isNil,lM=Ut.sectorPoints;function hM(t,e){return t=parseFloat(t),isNaN(t)&&(t=e),t}var uM=function(t){function e(e,r){var i;return(i=t.call(this,e,r)||this).isMulti?(i.__begin=[0],i.__end=[0],i.__r=[1],Array.isArray(r.begin)&&(i.__begin=r.begin.map((function(t){return hM(t,0)}))),Array.isArray(r.end)&&(i.__end=r.end.map((function(t){return hM(t,0)}))),Array.isArray(r.r)&&(i.__r=r.r.map((function(t){return hM(t,1)}))),Array.isArray(r.edge)&&(i.__edge=r.edge.map((function(t){return!!t}))),Array.isArray(r.closure)&&(i.__closure=r.closure.map((function(t){return!!t})))):(i.__begin=i.__end=0,i.__r=1,i.__edge=!1,i.__closure=!1,sM(r.begin)||(i.__begin=hM(r.begin,0)),sM(r.end)||(i.__end=hM(r.end,0)),sM(r.r)||(i.__r=hM(r.r,1)),sM(r.edge)||(i.__edge=!!r.edge),sM(r.closure)||(i.__closure=!!r.closure)),i}return a(e,t),r(e,[{key:"buildCache",value:function(t,e,r){var i,a=this.width,n=this.begin,o=this.end,s=this.r,l=this.edge,h=this.closure,u=this.__cacheProps,c=this.isMulti;if((sM(u.begin)||r)&&(i=!0,u.begin=(n||0)%360),(sM(u.end)||r)&&(i=!0,u.end=(o||0)%360),(sM(u.r)||r)&&(i=!0,u.r=c?s.map((function(t){return t*a*.5})):s*a*.5),s=u.r,(sM(u.edge)||r)&&(i=!0,u.edge=l),(sM(u.closure)||r)&&(i=!0,u.closure=h),i)if(c)u.list=[],u.sList=[],n.forEach((function(r,i){var n=sM(s[i])?.5*a:s[i],c=lM(t,e,n,parseFloat(r||0)%360,parseFloat(o[i]||0)%360),f=c.slice(0);h[i]?(c.push(c[0].slice(0)),l&&f.push(f[0].slice(0))):(c.unshift([t,e]),c.push([t,e]),l&&(f.unshift([t,e]),f.push([t,e]))),u.list.push(c),u.sList.push(f)}));else{var f=lM(t,e,s,parseFloat(n||0),parseFloat(o||0)),_=f.slice(0);h?(f.push(f[0].slice(0)),l&&_.push(_[0].slice(0))):(f.unshift([t,e]),f.push([t,e]),l&&(_.unshift([t,e]),_.push([t,e]))),u.list=f,u.sList=_}return i}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a);if(o.break||t===y.WEBGL)return o;this.buildCache(o.cx,o.cy);var s=o.fill,l=o.fillRule,u=o.stroke,c=o.strokeWidth,f=o.strokeDasharray,_=o.strokeDasharrayStr,v=o.strokeLinecap,d=o.strokeLinejoin,p=o.strokeMiterlimit,x=o.dx,g=o.dy,m=this.__cacheProps,b=m.list,M=m.sList,E=this.isMulti;if(s.length<=1&&u.length<=1){var A={fill:s[0],fillRule:l[0],stroke:u[0],strokeWidth:c[0],strokeDasharray:f[0],strokeDasharrayStr:_[0],strokeLinecap:v[0],strokeLinejoin:d[0],strokeMiterlimit:p[0],dx:x,dy:g};this.__renderOneSector(t,r,E,b,M,A)}else{for(var S=0,T=s.length;S<T;S++){var w=s[S];if(w){var R={fill:w,fillRule:l[S],dx:x,dy:g};this.__renderOneSector(t,r,E,b,M,R)}}for(var k=0,C=u.length;k<C;k++){var O=u[k];if(O){var I={stroke:O,strokeWidth:c[k],strokeDasharray:f[k],strokeDasharrayStr:_[k],strokeLinecap:v[k],strokeLinejoin:d[k],strokeMiterlimit:p[k],dx:x,dy:g};this.__renderOnePolygon(t,r,E,b,M,I)}}}return o}},{key:"__renderOneSector",value:function(t,e,r,i,a,n){var o=n.fill,s=n.stroke,l=n.strokeWidth,h="conic"===o.k,u="conic"===s.k,c="radial"===o.k&&Array.isArray(o.v),f=l>0&&"radial"===s.k&&Array.isArray(s.v);h||u?(h?this.__conicGradient(t,e,i,r,n):o&&"none"!==o&&this.__drawPolygon(t,e,r,i,n,!0),l>0&&u?lt.warn("Stroke style can not use conic-gradient"):l>0&&s&&"none"!==s&&this.__drawPolygon(t,e,r,a,n,!1,!0)):c||f?(c?this.__radialEllipse(t,e,i,r,n,"fill"):o&&"none"!==o&&this.__drawPolygon(t,e,r,i,n,!0),l>0&&f?(lt.warn("Stroke style can not use radial-gradient for ellipse"),n.stroke=n.stroke.v[0],this.__drawPolygon(t,e,r,a,n,!1,!0)):l>0&&s&&"none"!==s&&this.__drawPolygon(t,e,r,a,n,!1,!0)):(o&&"none"!==o&&this.__drawPolygon(t,e,r,i,n,!0,!1),l>0&&s&&"none"!==s&&this.__drawPolygon(t,e,r,a,n,!1,!0))}},{key:"__genSector",value:function(t,e,r,i,a,n,o,s,l){if(t){var h=[["d",e[0]],["fill",r.v||r],["stroke",i.v||i],["stroke-width",a]];this.__propsStrokeStyle(h,n,o,s,l),this.addGeom("path",h)}else if(this.addGeom("path",[["d",e[0]],["fill",r.v||r]]),a>0){var u=[["d",e[1]],["fill","none"],["stroke",i.v||i],["stroke-width",a]];this.__propsStrokeStyle(u,n,o,s,l),this.addGeom("path",u)}}},{key:"begin",get:function(){return this.getProps("begin")}},{key:"end",get:function(){return this.getProps("end")}},{key:"r",get:function(){return this.getProps("r")}},{key:"edge",get:function(){return this.getProps("edge")}},{key:"closure",get:function(){return this.getProps("closure")}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.isMulti,r=this.__cacheProps,i=this.__sx3,a=this.__sy3,o=this.width,s=this.height,l=this.computedStyle[oM],u=i+.5*o,c=a+.5*s;this.buildCache(u,c);var f=0;if(t){var _=0;r.r.forEach((function(t){_=Math.max(t,_)})),f=_}else f=r.r;var v=h(n(e.prototype),"bbox",this),y=0;l.forEach((function(t){y=Math.max(y,t)}));var d=u-f-(y=Math.ceil(.5*y)+1),p=u+f-y,x=c-f+y,g=c+f+y;v[0]=Math.min(v[0],d),v[1]=Math.min(v[1],x),v[2]=Math.max(v[2],p),v[3]=Math.max(v[3],g),this.__bbox=v}return this.__bbox}}]),e}(Nd),cM=Ct.STYLE_KEY.STROKE_WIDTH,fM=G.isNil;function _M(t,e,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0===a||0===n)return[[t,e],[t+r,e],[t+r,e+i],[t,e+i],[t,e]];var o=a*Ut.H,s=n*Ut.H;return[[t+a,e],[t+r-a,e],[t+r+o-a,e,t+r,e+n-s,t+r,e+n],[t+r,e+i-n],[t+r,e+i+s-n,t+r+o-a,e+i,t+r-a,e+i],[t+a,e+i],[t+a-o,e+i,t,e+i+s-n,t,e+i-n],[t,e+n],[t,e+n-s,t+a-o,e,t+a,e]]}function vM(t){return t=parseFloat(t),isNaN(t)&&(t=0),t}var yM=function(t){function e(e,r){var i;return(i=t.call(this,e,r)||this).isMulti?(i.__rx=[0],i.__ry=[0],Array.isArray(r.rx)&&(i.__rx=r.rx.map((function(t){return vM(t)}))),Array.isArray(r.ry)&&(i.__ry=r.ry.map((function(t){return vM(t)})))):(i.__rx=i.__ry=0,fM(r.rx)||(i.__rx=vM(r.rx)),fM(r.ry)||(i.__ry=vM(r.ry))),i}return a(e,t),r(e,[{key:"buildCache",value:function(t,e,r){var i,a=this.width,n=this.height,o=this.rx,s=this.ry,l=this.__cacheProps,h=this.isMulti;if((fM(l.rx)||r)&&(i=!0,l.rx=h?o.map((function(t){return Math.min(t,.5)*a})):Math.min(o,.5)*a),(fM(l.ry)||r)&&(i=!0,l.ry=h?o.map((function(t){return Math.min(t,.5)*n})):Math.min(s,.5)*n),i){var u=l.rx,c=l.ry;l.list=h?u.map((function(r,i){return _M(t,e,a,n,r,c[i])})):_M(t,e,a,n,u,c)}return i}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a);return o.break||t===y.WEBGL||(this.buildCache(o.sx3,o.sy3),this.__renderPolygon(t,r,o)),o}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.__sx3,r=this.__sy3,i=this.width,a=this.height,o=this.computedStyle[cM];this.buildCache(t,r);var s=h(n(e.prototype),"bbox",this),l=0;o.forEach((function(t){l=Math.max(l,t)})),l=Math.ceil(.5*l)+1,s[0]=Math.min(s[0],t-l),s[1]=Math.min(s[1],r-l),s[2]=Math.max(s[2],t+i+l),s[3]=Math.max(s[3],r+a+l),this.__bbox=s}return this.__bbox}}]),e}(Nd),dM=Ct.STYLE_KEY.STROKE_WIDTH,pM=G.isNil;function xM(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var gM=function(t){function e(e,r){var i;return(i=t.call(this,e,r)||this).isMulti?(i.__r=[1],Array.isArray(r.r)?i.__r=r.r.map((function(t){return xM(t)})):pM(r.r)||(i.__r=xM(r.r))):(i.__r=1,pM(r.r)||(i.__r=xM(r.r))),i}return a(e,t),r(e,[{key:"buildCache",value:function(t,e,r){var i=this.width,a=this.r,n=this.__cacheProps,o=this.isMulti;(pM(n.r)||r)&&(o?(n.r=a.map((function(t){return t*i*.5})),n.list=n.r.map((function(r){return Ut.ellipsePoints(t,e,r,r)}))):(n.r=a*i*.5,n.list=Ut.ellipsePoints(t,e,n.r,n.r)))}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a);return o.break||t===y.WEBGL||(this.buildCache(o.cx,o.cy),this.__renderPolygon(t,r,o)),o}},{key:"r",get:function(){return this.getProps("r")}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.isMulti,r=this.__cacheProps,i=this.__sx3,a=this.__sy3,o=this.width,s=this.height,l=this.computedStyle[dM],u=i+.5*o,c=a+.5*s;this.buildCache(u,c);var f=0;if(t){var _=0;r.r.forEach((function(t){_=Math.max(t,_)})),f=_}else f=r.r;var v=h(n(e.prototype),"bbox",this),y=0;l.forEach((function(t){y=Math.max(y,t)}));var d=u-f-(y=Math.ceil(.5*y)+1),p=c-f-y,x=u+f+y,g=c+f+y;v[0]=Math.min(v[0],d),v[1]=Math.min(v[1],p),v[2]=Math.max(v[2],x),v[3]=Math.max(v[3],g),this.__bbox=v}return this.__bbox}}]),e}(Nd),mM=Ct.STYLE_KEY.STROKE_WIDTH,bM=G.isNil;function MM(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var EM=function(t){function e(e,r){var i;return(i=t.call(this,e,r)||this).isMulti?(i.__rx=[1],i.__ry=[1],Array.isArray(r.rx)?i.__rx=r.rx.map((function(t){return MM(t)})):bM(r.rx)||(i.__rx=[MM(r.rx)]),Array.isArray(r.ry)?i.__ry=r.ry.map((function(t){return MM(t)})):bM(r.ry)||(i.__ry=[MM(r.ry)])):(i.__rx=1,bM(r.rx)||(i.__rx=MM(r.rx)),i.__ry=1,bM(r.ry)||(i.__ry=MM(r.ry))),i}return a(e,t),r(e,[{key:"buildCache",value:function(t,e,r){var i,a=this.width,n=this.height,o=this.rx,s=this.ry,l=this.__cacheProps,h=this.isMulti;if((bM(l.rx)||r)&&(i=!0,l.rx=h?o.map((function(t){return t*a*.5})):o*a*.5),(bM(l.ry)||r)&&(i=!0,l.ry=h?s.map((function(t){return t*n*.5})):s*n*.5),i){var u=l.rx,c=l.ry;l.list=h?u.map((function(r,i){return Ut.ellipsePoints(t,e,r,c[i])})):Ut.ellipsePoints(t,e,u,c)}return i}},{key:"render",value:function(t,r,i,a){var o=h(n(e.prototype),"render",this).call(this,t,r,i,a);return o.break||t===y.WEBGL||(this.buildCache(o.cx,o.cy),this.__renderPolygon(t,r,o)),o}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}},{key:"bbox",get:function(){if(!this.__bbox){var t=this.isMulti,r=this.__cacheProps,i=this.__sx3,a=this.__sy3,o=this.width,s=this.height,l=this.computedStyle[mM],u=i+.5*o,c=a+.5*s;this.buildCache(u,c);var f=0,_=0;if(t){var v=0,y=0;r.rx.forEach((function(t,e){v=Math.max(t,v),y=Math.max(_,r.ry[e])})),f=v,_=y}else f=r.rx,_=r.ry;var d=h(n(e.prototype),"bbox",this),p=0;l.forEach((function(t){p=Math.max(p,t)}));var x=u-f-(p=Math.ceil(.5*p)+1),g=u+f+p,m=c-_-p,b=c+_+p;d[0]=Math.min(d[0],x),d[1]=Math.min(d[1],m),d[2]=Math.max(d[2],g),d[3]=Math.max(d[3],b),this.__bbox=d}return this.__bbox}}]),e}(Nd),AM=G.isPrimitive;function SM(t,e,r,i,a){if(AM(e)||e instanceof v||e instanceof Bh)return e;if(Array.isArray(e))return e.map((function(e){return SM(t,e,r,i,a)}));var n=a;a+=e.offsetTime||0;var o,s,l=e.tagName,h=e.props,u=void 0===h?{}:h,c=e.children,f=void 0===c?[]:c,_=e.animate,y=void 0===_?[]:_;if(!l)throw new Error("Dom must have a tagName: "+JSON.stringify(e));if(!Array.isArray(f))throw new Error("children must be an array");if("$"===l.charAt(0))o=t.createGm(l,u);else if(/^[A-Z]/.test(l)){var d=Bh.getRegister(l);o=t.createCp(d,u,f.map((function(e){return SM(t,e,r,i,a)})))}else o=t.createVd(l,u,f.map((function(e){return SM(t,e,r,i,a)})));y&&(Array.isArray(y)||(y=[y]),y.forEach((function(t){var e=t.value;Array.isArray(e)&&e.length&&(s=!0)})),s&&r.push({animate:y,target:o,offsetTime:n}));return o}var TM={skewX:"kx",skewY:"ky",transform:"tf",fontSize:"fz",offset:"os",easing:"e",filter:"ft",boxShadow:"bd",overflow:"of",backgroundClip:"bp",textOverflow:"tof",flexWrap:"fp",perspective:"ppt",rotate3d:"r3"},wM={os:"offset",e:"easing"},RM={value:"v",options:"o"},kM={},CM={duration:"dt",delay:"d",endDelay:"ed",iterations:"i",direction:"dc",fill:"f",fps:"fp",playbackRate:"p",spfLimit:"sl"},OM={};mt.DOM_KEY_SET.concat(mt.GEOM_KEY_SET).forEach((function(t){if(TM.hasOwnProperty(t))wM[TM[t]]=t;else{var e=t.charAt(0)+t.replace(/[a-z]/g,"").toLowerCase();TM[t]=e,wM[e]=t}})),Object.keys(RM).forEach((function(t){kM[RM[t]]=t})),Object.keys(CM).forEach((function(t){OM[CM[t]]=t}));var IM={fullCssProperty:TM,abbrCssProperty:wM,fullAnimate:RM,abbrAnimate:kM,fullAnimateOption:CM,abbrAnimateOption:OM},FM=G.isNil,LM=G.isFunction,DM=G.isPrimitive,BM=G.clone,PM=G.extend,NM=IM.abbrCssProperty,GM=IM.abbrAnimateOption,HM=IM.abbrAnimate;function WM(t,e){t&&Object.keys(t).forEach((function(r){if(0===r.indexOf("var-")){var i=r.slice(4);if(e.hasOwnProperty(i)){var a=e[i];t["var-"+a]=t[r]}}else if(e.hasOwnProperty(r)){var n=e[r];t[n]=t[r],delete t[r]}}))}function YM(t,e){if(t)if(t.hasOwnProperty("vars")){var r=t.vars;delete t.vars,Array.isArray(r)||(r=[r]),Array.isArray(r)&&r.forEach((function(r){var i=r.id,a=r.member;if(Array.isArray(a)||(a=[a]),Array.isArray(a)&&a.length&&"library"!==a[0]&&e&&e.hasOwnProperty(i))for(var n=t,o=0,s=a.length;o<s;o++){var l=a[o];if(!n.hasOwnProperty(l)&&o!==s-1)return void lt.error("Slot miss "+l);if(o===s-1){var h=e[i];if(void 0===h)return;LM(h)&&(h=h(n[l])),n[l]=h}else n=n[l]}}))}else Object.keys(t).forEach((function(r){if(0===r.indexOf("var-")){var i=t[r];if(delete t[r],!i||!e)return;var a=r.slice(4);if(a&&i.id&&e.hasOwnProperty(i.id)){var n=e[i.id];if(void 0===n)return;var o=t;if(a.indexOf(".")>-1){for(var s=a.split("."),l=s.length,h=0;h<l-1;h++){if(!o[a=s[h]])return void lt.warn("parseJson vars is not exist: "+i.id+", "+r+", "+s.slice(0,h).join("."));o=o[a]}a=s[l-1]}LM(n)&&(n=n(i)),o[a]=n}}}))}function zM(t,e,r){if(DM(t)||t instanceof v||t instanceof Bh)return t;if(Array.isArray(t))return t.map((function(t){return zM(t,e,r)}));var i=t.libraryId;if(!FM(i)){var a=r[i];if(!a)throw new Error("Link library miss id: "+i);!function(t,e){t.tagName=e.tagName,t.props=BM(e.props)||{},t.children=e.children||[],e.vars&&!t.vars&&(t.vars=e.vars),e.library&&(t.library=e.library),Object.keys(e).forEach((function(r){0!==r.indexOf("var-")||t.hasOwnProperty(r)||(t[r]=e[r])})),delete t.libraryId;var r=t.init;if(r){var i=t.props,a=i.style;PM(i,r),a&&(PM(a,r.style),i.style=a),delete t.init}}(t,a)}var n=t.library;Array.isArray(n)&&(r={},n.forEach((function(t){return function(t,e){var r=t.id;if(FM(r))throw new Error("Library item miss id: "+JSON.stringify(t));e[r]=t}(t,r)})),function(t,e,r){if(t.hasOwnProperty("vars")){var i=t.vars;delete t.vars,Array.isArray(i)||(i=[i]),i.forEach((function(t){var i=t.id,a=t.member;if(Array.isArray(a)||(a=[a]),Array.isArray(a)&&a.length>1&&r&&r.hasOwnProperty(i)&&"library"===a[0])for(var n=e,o=1,s=a.length;o<s;o++){var l=a[o];if(!n.hasOwnProperty(l)&&o!==s-1)return void lt.error("Library slot miss "+l);if(o===s-1){var h=r[i],u=n[l];LM(h)&&(h=h(u)),n[l]=1===o?Object.assign({id:u.id,tagName:u.tagName},h):h}else n=n[l]}}))}else Object.keys(t).forEach((function(i){if(0===i.indexOf("var-library.")){var a=t[i];if(delete t[i],!a||!r)return;var n=i.slice(12);if(n&&a.id&&r.hasOwnProperty(a.id)){var o=r[a.id];LM(o)&&(o=o(a)),e[n]=Object.assign({id:n},o)}}}))}(t,r,e.vars),delete t.library);var o=t.tagName,s=t.props,l=void 0===s?{}:s,h=t.children,u=void 0===h?[]:h,c=t.animate,f=void 0===c?[]:c;if(!o)throw new Error("Dom must have a tagName: "+JSON.stringify(t));var _=l.src;if(/^#\d+$/.test(_)){var y=e.imgs,d=parseInt(_.slice(1));Array.isArray(y)&&(l.src=y[d])}var p=l.style;if(p){var x=p.fontFamily;if(/^#\d+$/.test(x)){var g=e.fonts,m=parseInt(x.slice(1));Array.isArray(g)&&(p.fontFamily=g[m])}!1!==e.abbr&&WM(p,NM),YM(p,e.vars)}return YM(l,e.vars),YM(t,e.vars),t.children=zM(u,e,r),f&&(Array.isArray(f)||(f=[f]),f.forEach((function(t){!1!==e.abbr&&WM(t,HM);var r=t.value,i=t.options;Array.isArray(r)&&r.length&&r.forEach((function(t){!1!==e.abbr&&WM(t,NM),YM(t,e.vars)})),i&&(!1!==e.abbr&&WM(i,GM),YM(i,e.vars),function(t,e){["iterations","fill","duration","direction","easing","fps","delay","endDelay","playbackRate","spfLimit"].forEach((function(r){e.hasOwnProperty(r)&&(t[r]=e[r])}))}(i,e))}))),t}function XM(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!1===t.abbr&&(e.abbr=!1),!1!==e.abbr&&lt.warn("Abbr in json is deprecated"),e.singleton||t.singleton||(t=G.clone(t)),zM(t,e,{})}var UM={apply:XM,parse:function(t,e,r,i){if(e){var a=e.fonts;a&&(Array.isArray(a)||(a=[a]),a.forEach((function(t){var e=t.fontFamily,r=t.url,i=t.data;e&&(r||i)&&ct.register(e,r,i)}))),lt.isDom(r)?i=i||{}:(i=i||r||{},r=null);var n=[],o=SM(t,e=XM(e,i),n,i,0);if(r){var s=e.tagName;if(-1===["canvas","svg","webgl"].indexOf(s))throw new Error("Parse dom must be canvas/svg/webgl");var l=i.controller instanceof Fg?i.controller:o.animateController;t.render(o,r),!1!==i.autoPlay?(l.__records=l.__records.concat(n),l.__playAuto()):(l.__records2=l.__records2.concat(n),l.init(l.__records2,l.list2))}else n.length&&(o.__animateRecords={options:i,list:n,controller:i.controller instanceof Fg?i.controller:null});return o}},loadAndParse:function(t,e,r,i){var a=e.fonts,n=e.components,o=e.imgs,s=[],l=[],h=[];a&&(Array.isArray(a)||(a=[a]),a.forEach((function(t){t.url&&s.push(t)}))),n&&(Array.isArray(n)||(n=[n]),n.forEach((function(e){var r=e.tagName,i=e.url,a=e.reload;r&&t.Component.hasRegister(r)&&!a||i&&l.push(e)}))),o&&(Array.isArray(o)||(o=[o]),o.forEach((function(t){var e=t.url;e&&h.push(e)})));var u=s.length,c=l.length,f=h.length,_=0,v=function(){if(_===u+c+f){var a=UM.parse(t,e,r,i);i&&G.isFunction(i.callback)&&i.callback(a)}};u||c||f?(t.inject.loadFont(s,(function(){_+=u,v()})),t.inject.loadComponent(l.map((function(t){return t.url})),(function(){_+=c,l.forEach((function(e){var r=e.tagName;r&&window[r]&&!t.Component.hasRegister(r)&&t.Component.register(r,window[r])})),v()})),t.inject.measureImg(h,(function(){_+=f,v()}))):v()},abbr:IM},VM={css:Ln,reset:mt,unit:d,font:ct,abbr:ar,transform:Ws},KM={Animation:Of,Controller:Fg,easing:Su,frame:yu},jM={level:Xl,change:Xi,Page:Gg,Cache:Vg};Nd.register("$line",Ub),Nd.register("$polyline",aM),Nd.register("$polygon",nM),Nd.register("$sector",uM),Nd.register("$rect",yM),Nd.register("$circle",gM),Nd.register("$ellipse",EM);var ZM={version:"0.79.6",render:function(t,e){if(!(t instanceof Nb))throw new Error("Render dom must be canvas/svg/webgl");return e&&t.appendTo(e),t},createElement:function(t,e){e=e||{};for(var r=[],i=2,a=arguments.length;i<a;i++)r.push(arguments[i]);return G.isString(t)?"$"===t.charAt(0)?this.createGm(t,e):this.createVd(t,e,r):t?t instanceof Nd?this.createGm(t,e):this.createCp(t,e,r):void 0},createVd:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(["canvas","svg","webgl"].indexOf(t)>-1)return new Nb(t,e,r);if(ed.TAG_NAME.hasOwnProperty(t))return"img"===t?new sg(t,e):new Ix(t,e,r);throw new Error("Can not use <".concat(t,">"))},createGm:function(t,e){return new(Nd.getRegister(t))(t,e)},createCp:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.children=r,new t(e,r)},parse:function(t,e,r){return UM.parse(this,t,e,r)},loadAndParse:function(t,e,r){return UM.loadAndParse(this,t,e,r)},mode:y,Component:Bh,Node:v,Text:kh,Geom:Nd,Xom:Py,Dom:Ix,Img:sg,Root:Nb,Event:Oh,util:G,inject:lt,style:VM,parser:UM,animate:KM,math:Ko,refresh:jM,enums:Ct,set debug(t){H.flag=!!t}};return"undefined"!=typeof window?window.karas=ZM:"undefined"!=typeof self&&(self.karas=ZM),ZM}));
//# sourceMappingURL=index.min.js.map
