!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).karas=e()}(this,function(){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(a){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e,i,r,n=K(a);return e=o?(t=K(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),i=this,!(r=e)||"object"!=typeof r&&"function"!=typeof r?l(i):r}}function Q(t,e,i){return(Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){n=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var x=function(){function t(){h(this,t),this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__width=0,this.__height=0,this.__baseLine=0,this.__prev=null,this.__next=null,this.__parent=null,this.__host=null,this.__virtualDom={}}return u(t,[{key:"__offsetX",value:function(t,e){e?this.__x+=t:this.__ox+=t}},{key:"__offsetY",value:function(t,e){e?this.__y+=t:this.__oy+=t}},{key:"__destroy",value:function(){this.__isDestroyed=!0,this.__parent=null}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"sx",get:function(){return this.x+this.ox}},{key:"sy",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),t}(),s={AUTO:0,PX:1,PERCENT:2,NUMBER:3,INHERIT:4,DEG:5,STRING:6,RGBA:7},c={arial:{lhr:1.14990234375,car:1.1171875,blr:.9052734375}},d={}.toString;function _(e){return function(t){return d.call(t)==="[object "+e+"]"}}function p(t){return y(t)?"":t.toString()}function y(t){return null==t}function g(t){if("item"===t.type||"img"===t.type){var e="";return t.props.forEach(function(t){e+=" ".concat(t[0],'="').concat(t[1],'"')}),"text"===t.tagName?"<text".concat(e,">").concat(t.content,"</text>"):"<".concat(t.tagName).concat(e,"/>")}if("text"===t.type){var i="";return t.children.forEach(function(t){i+=g(t)}),"<g>".concat(i,"</g>")}if("dom"===t.type||"geom"===t.type){var r="<g";t.bbMask&&(r+=' mask="'.concat(t.bbMask,'"')),r+=">",t.bb.forEach(function(t){r+=g(t)}),r+="</g><g>",t.children.forEach(function(t){t.isMask||(r+=g(t))}),r+="</g>";var n=t.opacity,a=t.transform,o=t.mask,s=t.filter;return"<g".concat(1!==n?' opacity="'.concat(n,'"'):"").concat(a?' transform="'.concat(a,'"'):"").concat(o?' mask="'.concat(o,'"'):"").concat(s?' filter="'.concat(s,'"'):"",">").concat(r,"</g>")}}function v(t){var r="<".concat(t.tagName,' id="').concat(t.uuid,'"');return"mask"===t.tagName||"filter"===t.tagName||(r+=' gradientUnits="userSpaceOnUse"'),t.props.forEach(function(t){r+=" ".concat(t[0],'="').concat(t[1],'"')}),r+=">",t.children.forEach(function(t){var e,i;r+=(i="<".concat((e=t).tagName),e.props.forEach(function(t){i+=" ".concat(t[0],'="').concat(t[1],'"')}),i+="></".concat(e.tagName,">"))}),r+="</".concat(t.tagName,">")}function m(t,e){for(var i=t.length?t[0]:"",r=1,n=t.length;r<n;r++)i+=e+t[r];return i}var be={isObject:_("Object"),isString:_("String"),isFunction:_("Function"),isNumber:_("Number"),isBoolean:_("Boolean"),isDate:_("Date"),isNil:y,isPrimitive:function(t){return be.isNil(t)||be.isBoolean(t)||be.isString(t)||be.isNumber(t)},stringify:p,joinSourceArray:function t(e){for(var i="",r=0,n=e.length;r<n;r++){var a=e[r];Array.isArray(a)?i+=t(a):i+=p(a)}return i},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},joinVirtualDom:function(t){var e="<defs>";return t.defs.forEach(function(t){e+=v(t)}),e+="</defs><g",t.bbMask&&(e+=' mask="'.concat(t.bbMask,'"')),e+=">",t.bb.forEach(function(t){e+=g(t)}),e+="</g><g>",t.children.forEach(function(t){t.isMask||(e+=g(t))}),e+="</g>"},joinVd:g,joinDef:v,rgba2int:function(t){if(Array.isArray(t))return t;var e,i=[];return t&&"transparent"!==t?"#"===t.charAt(0)?(3===(t=t.slice(1)).length?(i.push(parseInt(t.charAt(0)+t.charAt(0),16)),i.push(parseInt(t.charAt(1)+t.charAt(1),16)),i.push(parseInt(t.charAt(2)+t.charAt(2),16))):6===t.length?(i.push(parseInt(t.slice(0,2),16)),i.push(parseInt(t.slice(2,4),16)),i.push(parseInt(t.slice(4),16))):i[0]=i[1]=i[2]=0,i[3]=1):(e=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\s*\)/i))?(i=[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])],y(e[4])?i[3]=1:i[3]=parseFloat(e[4])):i=[0,0,0,0]:i=[0,0,0,0],i},int2rgba:function(t){if(Array.isArray(t)){if(4===t.length)return"rgba(".concat(m(t,","),")");if(3===t.length)return"rgba(".concat(m(t,","),",1)")}return t||"rgba(0,0,0,0)"},arr2hash:function(t){for(var e={},i=0,r=t.length;i<r;i++){var n=t[i];if(Array.isArray(n))e[n[0]]=n[1];else for(var a=Object.keys(n),o=a.length-1;0<=o;o--){var s=a[o];e[s]=n[s]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],i=Object.keys(t),r=0,n=i.length;r<n;r++){var a=i[r];e.push([a,t[a]])}return e},clone:function e(i){if(y(i)||"object"!==a(i))return i;if(be.isDate(i))return new Date(i);var r=Array.isArray(i)?[]:{};return Object.keys(i).forEach(function(t){r[t]=e(i[t])}),r},equalArr:function t(e,i){if(e.length!==i.length)return!1;for(var r=0,n=e.length;r<n;r++){var a=e[r],o=i[r],s=Array.isArray(a),h=Array.isArray(o);if(s&&h){if(!t(a,o))return!1}else if(s||h)return!1;if(a!==o)return!1}return!0},extend:function(t,e,i){if(null===e||"object"!==a(e))return t;for(var r=(i=i||Object.keys(e)).length;r--;){var n=i[r];t[n]=e[n]}return t},joinArr:m},E={position:/((-?[\d.]+(px|%)?)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-gradient\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i};function k(t,e,i,r){return t*r-i*e}var A={vectorProduct:k,pointInLine:function(t,e,i,r,n,a){return t===i&&e===r||t===n&&e===a||(0===i&&0===r||(t-=i,e-=r,n-=i,a-=a),e===a/n*t&&(0<=n?0<=a?0<=t&&0<=e&&t<=n&&e<=a:0<=t&&e<0&&t<=n&&a<e:0<=a?t<0&&0<=e&&n<t&&e<=a:t<0&&e<0&&n<t&&a<e))},pointInPolygon:function(t,e,i){for(var r=me(i[0],2),n=r[0],a=r[1],o=me(i[0],2),s=o[0],h=o[1],u=i.length,l=1;l<u;l++)var c=me(i[l],2),f=c[0],d=c[1],n=Math.max(n,f),a=Math.max(a,d),s=Math.min(s,f),h=Math.min(h,d);if(t<s||e<h||n<t||a<e)return!1;for(var _=0,p=i.length;_<p;_++){var y=me(i[_],2),g=y[0],v=y[1],m=me(i[(_+1)%p],2);if(k(m[0]-g,m[1]-v,t-g,e-v)<0)return!1}return!0},transformPoint:function(t,e,i){var r=me(t,6),n=r[0],a=r[1],o=r[2],s=r[3];return[n*e+o*i+r[4],a*e+s*i+r[5]]},d2r:function(t){return t*Math.PI/180},r2d:function(t){return 180*t/Math.PI},H:4*(Math.sqrt(2)-1)/3},te=be.rgba2int,ee=be.int2rgba,b=be.isNil,W=s.PX,ie=s.PERCENT,w=A.d2r;function S(t){if(/%$/.test(t)||/px$/.test(t)||/^-?[\d.]+$/.test(t))return{value:parseFloat(t),unit:/%/.test(t)?ie:W};var e={value:{top:0,left:0,center:50,right:100,bottom:100}[t],unit:ie};return b(e.value)&&(e.value=50),e}function N(t,e){for(var i,r=[],n=0,a=t.length;n<a;n++){var o,s,h=t[n];1<h.length?(o=ee(h[0]),(s=h[1]).unit===ie?r.push([o,.01*s.value]):r.push([o,s.value/e])):r.push([ee(h[0])])}1===r[0].length&&r[0].push(0),1<r.length&&(1===r[i=r.length-1].length&&r[i].push(1));for(var u=r[0][1],l=1,c=r.length;l<c-1;l++){var f=r[l];if(1<f.length)u=f[1];else{for(var d=l+1,_=r[r.length-1][1];d<c-1;d++){var p=r[d];if(1<p.length){_=p[1];break}}for(var y=(_-u)/(d-l+1),g=l;g<d;g++){r[g].push(u+y*(g+1-l))}l=d}}for(var v=1,m=r.length;v<m;v++){var k=r[v],b=r[v-1];k[1]<b[1]&&(k[1]=b[1])}for(var x=0,w=r.length;x<w-1;x++){if(1<r[x][1]){r.splice(x+1);break}}for(var A=r.length-1;0<A;A--){if(r[A][1]<0){r.splice(0,A);break}}var S,M,E,T,R,P,C,L,O,W,N,F,D,I,B,H,z,G,X,Y,j,V,$,q,U,Z,K,Q,J,tt,et,it,rt,nt,at,ot,st,ht,ut,lt,ct,ft,dt,_t,pt,yt,gt,vt,mt,kt,bt,xt,wt,At,St,Mt,Et,Tt,Rt,Pt,Ct,Lt,Ot,Wt,Nt,Ft,Dt,It,Bt=r.length;if(1===Bt)r[0][1]=0;else{for(var Ht,zt,Gt,Xt,Yt,jt,Vt,$t,qt,Ut,Zt=!0,Kt=!0,Qt=Bt-1;0<=Qt;Qt--){var Jt=r[Qt][1];0<Jt&&(Zt=!1),Jt<1&&(Kt=!1)}Zt?(r.splice(0,Bt-1),r[0][1]=0):Kt?(r.splice(1),r[0][1]=0):(Ht=r[0],zt=r[Bt-1],2===Bt?Ht[1]<0&&1<zt[1]&&(yt=zt,gt=e,vt=te((pt=Ht)[0]),mt=te(yt[0]),kt=me(vt,4),bt=kt[0],xt=kt[1],wt=kt[2],At=kt[3],St=void 0===At?1:At,Mt=me(mt,4),Et=Mt[0],Tt=Mt[1],Rt=Mt[2],Pt=Mt[3],Ct=void 0===Pt?1:Pt,Lt=Math.abs(pt[1])*gt,Ot=yt[1]*gt,Wt=Lt/(Lt+Ot),Nt=Math.floor(bt+(Et-bt)*Wt),Ft=Math.floor(xt+(Tt-xt)*Wt),Dt=Math.floor(wt+(Rt-wt)*Wt),It=St+(Ct-St)*Wt,pt[0]="rgba(".concat(Nt,",").concat(Ft,",").concat(Dt,",").concat(It,")"),pt[1]=0,Wt=(gt+Lt)/(Lt+Ot),Nt=Math.floor(bt+(Et-bt)*Wt),Ft=Math.floor(xt+(Tt-xt)*Wt),Dt=Math.floor(wt+(Rt-wt)*Wt),It=St+(Ct-St)*Wt,yt[0]="rgba(".concat(Nt,",").concat(Ft,",").concat(Dt,",").concat(It,")"),yt[1]=1):(Ht[1]<0&&(Gt=r[1],Xt=te(Ht[0]),Yt=te(Gt[0]),$=Xt,q=Ht[1],U=Yt,Z=Gt[1],K=e,Q=me($,4),J=Q[0],tt=Q[1],et=Q[2],it=Q[3],rt=void 0===it?1:it,nt=me(U,4),at=nt[0],ot=nt[1],st=nt[2],ht=nt[3],ut=void 0===ht?1:ht,lt=Math.abs(q)*K,ct=lt/(Z*K+lt),ft=Math.floor(J+(at-J)*ct),dt=Math.floor(tt+(ot-tt)*ct),_t=Math.floor(et+(st-et)*ct),jt=[ft,dt,_t,rt+(ut-rt)*ct],Ht[0]="rgba(".concat(jt[0],",").concat(jt[1],",").concat(jt[2],",").concat(jt[3],")"),Ht[1]=0),1<zt[1]&&(Vt=r[Bt-2],$t=te(Vt[0]),qt=te(zt[0]),S=$t,M=Vt[1],E=qt,T=zt[1],R=e,P=me(S,4),C=P[0],L=P[1],O=P[2],W=P[3],N=void 0===W?1:W,F=me(E,4),D=F[0],I=F[1],B=F[2],H=F[3],z=void 0===H?1:H,X=(R-(G=M*R))/(T*R-G),Y=Math.floor(C+(D-C)*X),j=Math.floor(L+(I-L)*X),V=Math.floor(O+(B-O)*X),Ut=[Y,j,V,N+(z-N)*X],zt[0]="rgba(".concat(Ut[0],",").concat(Ut[1],",").concat(Ut[2],",").concat(Ut[3],")"),zt[1]=1)))}return r.forEach(function(t){t[1]<0?t[1]=0:1<t[1]&&(t[1]=1)}),r}var T={parseGradient:function(t){var e,i,r,n=E.gradient.exec(t);if(n){var a,o,s,h,u,l={k:n[1]};"linear"===l.k?(a=/(-?[\d.]+deg)|(to\s+[toprighbml]+)/i.exec(n[2]),l.d=a?(e=a[0].toLowerCase(),r=180,"to top"===e?r=0:"to top right"===e?r=45:"to right"===e?r=90:"to bottom right"===e?r=135:"to bottom"===e||("to bottom left"===e?r=225:"to left"===e?r=270:"to top left"===e?r=315:(i=/(-?[\d.]+)deg/.exec(e))&&(r=parseFloat(i[1]))),r%360):180):"radial"===l.k&&(l.s=-1<n[2].indexOf("ellipse")?"ellipse":"circle",o=/(closest|farthest)-(side|corner)/i.exec(n[2]),l.z=o?o[0].toLowerCase():"farthest-corner",(s=/at\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center))(?:\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center)))?/i.exec(n[2]))?(h=S(s[1]),u=s[2]?S(s[2]):h,l.p=[h,u]):l.p=[{value:50,unit:ie},{value:50,unit:ie}]);var c=n[2].match(/((#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*(-?[\d.]+(px|%))?/gi);return l.v=c.map(function(t){var e=/((?:#[0-9a-f]{3,6})|(?:rgba?\(.+?\)))\s*(-?[\d.]+(?:px|%))?/i.exec(t),i=[te(e[1])];return e[2]&&(i[1]={value:parseFloat(e[2])},/%$/.test(e[2])?i[1].unit=ie:i[1].unit=W),i}),l}},getLinear:function(t,e,i,r,n,a){var o,s,h,u,l,c,f,d,_,p,y,g,v=w(e),m=Math.abs(n*Math.sin(v))+Math.abs(a*Math.cos(v)),k=me((s=.5*m,h=i,u=r,_=270<=(o=e)?(l=w(360-o),c=h+Math.sin(l)*s,f=u+Math.cos(l)*s,d=h-Math.sin(l)*s,u-Math.cos(l)*s):180<=o?(p=w(o-180),c=h+Math.sin(p)*s,f=u-Math.cos(p)*s,d=h-Math.sin(p)*s,u+Math.cos(p)*s):90<=o?(y=w(180-o),c=h-Math.sin(y)*s,f=u-Math.cos(y)*s,d=h+Math.sin(y)*s,u+Math.cos(y)*s):(g=w(o),c=h-Math.sin(g)*s,f=u+Math.cos(g)*s,d=h+Math.sin(g)*s,u-Math.cos(g)*s),[c,f,d,_]),4);return{x1:k[0],y1:k[1],x2:k[2],y2:k[3],stop:N(t,m)}},getRadial:function(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,_,p,y,g,v,m,k,b,x,w,A,S,M,E=o-n,T=s-a,R=me((h=i,l=E,c=T,f=n,d=a,_=o,p=s,A=(u=r)[0].unit===W?f+u[0].value:f+u[0].value*l*.01,S=u[1].unit===W?d+u[1].value:d+u[1].value*c*.01,["closest-side"===h?A<=f||_<=A||S<=d||p<=S?0:(y=A<f+.5*l?A-f:_-A,g=S<d+.5*c?S-d:p-S,Math.min(y,g)):"closest-corner"===h?(v=A<f+.5*l?A-f:_-A,m=S<d+.5*c?S-d:p-S,Math.sqrt(Math.pow(v,2)+Math.pow(m,2))):"farthest-side"===h?A<=f?f-A+l:_<=A?A-_+l:S<=d?d-S+c:p<=A?S-p+c:(k=Math.max(_-A,A-f),b=Math.max(p-S,S-d),Math.max(k,b)):(x=A<f+.5*l?_-A:A-f,w=S<d+.5*c?p-S:S-d,Math.sqrt(Math.pow(x,2)+Math.pow(w,2))),A,S]),3),P=R[0],C=R[1],L=R[2],O=N(t,2*P);return P<=0&&((M=O[O.length-1])[1]=0,O=[M],C=n,L=a,P=E+T),{cx:C,cy:L,r:P,stop:O}}},R=s.AUTO,P=s.PX,C=s.PERCENT,L=s.NUMBER,O=s.INHERIT,M=s.DEG,F=s.RGBA,D=s.STRING,I=be.isNil,B=be.rgba2int;function H(t,e,i,r){I(t.flexGrow)&&(t.flexGrow=e),I(t.flexShrink)&&(t.flexShrink=i),I(t.flexBasis)&&(t.flexBasis=r)}function z(i,r){var n,t=i[r];t&&((n=t.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi))&&(1===n.length?n[3]=n[2]=n[1]=n[0]:2===n.length?(n[2]=n[0],n[3]=n[1]):3===n.length&&(n[3]=n[1]),["Top","Right","Bottom","Left"].forEach(function(t,e){I(i[t=r+t])&&(i[t]=n[e])})),delete i[r])}function G(t,e,i){return"auto"===i?t[e]={unit:R}:"inherit"===i?t[e]={unit:O}:/%$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:C}):/px$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:P}):/deg$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:M}):(i=parseFloat(i)||0,t[e]={value:i,unit:L}),0===e.toString().indexOf("border")&&(t[e].value=Math.max(t[e].value,0)),t}function X(t,e){-1<t.indexOf("scale")?e.unit=L:-1<t.indexOf("translate")?e.unit===L&&(e.unit=P):e.unit===L&&(e.unit=M)}function Y(t,e,i){var r;i||(r=t.animateStyle,i=t.__currentStyle=r);var n=t.computedStyle,a=e?null:t.parent.computedStyle,o=i.fontStyle,s=i.fontWeight,h=i.color;o.unit===O?n.fontStyle=e?"normal":a.fontStyle:n.fontStyle=o.value,s.unit===O?n.fontWeight=e?400:a.fontWeight:n.fontWeight=s.value,h.unit===O?n.color=e?[0,0,0,1]:a.color:n.color=h.value,["visibility","opacity","zIndex","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","backgroundRepeat","backgroundImage","filter"].forEach(function(t){n[t]=i[t]}),["backgroundColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"].forEach(function(t){n[t]=i[t].value})}function j(t){return t.fontSize*c.arial.lhr}function V(t,e,i){for(t*=.01;e;){var r=e.currentStyle[i];if(r.unit===R){if("width"!==i)break;e=e.parent}else{if(r.unit===P)return t*r.value;r.unit===C&&(t*=.01*r.value,e=e.parent)}}return t}var $={normalize:function(s){var t,e,i,r,n,a,o,h,u,l,c,f,d,_,p,y,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],v=s.border;if(v&&(["Top","Right","Bottom","Left"].forEach(function(t){I(s[t="border"+t])&&(s[t]=v)}),delete s.border),["Top","Right","Bottom","Left"].forEach(function(t){var e,i,r,n,a,o;e=s,a="border".concat(t),o=e[a],I(o)||(I(e[a+"Width"])&&(i=/\b[\d.]+px\b/i.exec(o),e[a+"Width"]=i?i[0]:0),I(e[a+"Style"])&&(r=/\b(solid|dashed|dotted)\b/i.exec(o),e[a+"Style"]=r?r[1]:"solid"),I(e[a+"Color"])&&((n=/#[0-9a-f]{3,6}/i.exec(o))&&-1<[4,7].indexOf(n[0].length)?e[a+"Color"]=n[0]:/\btransparent\b/i.test(o)?e[a+"Color"]="transparent":(n=/rgba?\(.+\)/i.exec(o),e[a+"Color"]=n?n[0]:"transparent")))}),(v=s.borderWidth)&&(["Top","Right","Bottom","Left"].forEach(function(t){I(s[t="border"+t+"Width"])&&(s[t]=v)}),delete s.borderWidth),(v=s.borderColor)&&(["Top","Right","Bottom","Left"].forEach(function(t){I(s[t="border"+t+"Color"])&&(s[t]=B(v))}),delete s.borderColor),(v=s.borderStyle)&&(["Top","Right","Bottom","Left"].forEach(function(t){I(s[t="border"+t+"Style"])&&(s[t]=v)}),delete s.borderStyle),(v=s.borderRadius)&&(["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){I(s[t="border"+t+"Radius"])&&(s[t]=v)}),delete s.borderRadius),(v=s.background)&&(I(s.backgroundImage)&&((t=E.gradient.exec(v))?(s.backgroundImage=t[0],v=v.replace(t[0],"")):(e=E.img.exec(v))&&(s.backgroundImage=e[0],v=v.replace(e[0],""))),!I(s.backgroundRepeat)||(i=/(no-)?repeat(-[xy])?/i.exec(v))&&(s.backgroundRepeat=i[0].toLowerCase()),!I(s.backgroundColor)||(r=/^(transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\))/i.exec(v))&&(s.backgroundColor=r[0],v=v.replace(r[0],"")),!I(s.backgroundPosition)||(n=v.match(E.position))&&(s.backgroundPositionX=n[0],s.backgroundPositionY=1<n.length?n[1]:n[0]),delete s.background),v=s.backgroundPosition,I(v)||(1===(v=v.toString().split(/\s+/)).length&&(v[1]="50%"),a=me(v,2),s.backgroundPositionX=a[0],s.backgroundPositionY=a[1],delete s.backgroundPosition),(v=s.flex)&&("none"===v?H(s,0,0,"auto"):"auto"===v?H(s,1,1,"auto"):/^[\d.]+$/.test(v)?H(s,Math.max(0,parseFloat(v)),1,0):/^[\d.]+px$/.test(v)?H(s,1,1,0):/^[\d.]+%$/.test(v)?H(s,1,1,v):/^[\d.]+\s+[\d.]+$/.test(v)?(o=v.split(/\s+/),H(s,o[0],o[1],0)):/^[\d.]+\s+[\d.]+%$/.test(v)?(h=v.split(/\s+/),H(s,h[0],1,h[1])):H(s,0,1,"auto"),delete s.flex),z(s,"margin"),z(s,"padding"),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=s[t];!I(e)&&s.transform&&console.error('Can not use expand style "'.concat(t,'" with transform'))}),g.forEach(function(t){var e=t.k,i=t.v;I(s[e])&&(s[e]=i)}),(v=s.backgroundImage)&&(E.gradient.test(v)?s.backgroundImage=T.parseGradient(v):E.img.test(v)&&(s.backgroundImage=E.img.exec(v)[2])),(v=s.backgroundColor)&&((u=/^#[0-9a-f]{3,6}/i.exec(v))&&-1<[4,7].indexOf(u[0].length)?s.backgroundColor={value:B(u[0]),unit:F}:(u=/rgba?\(.+\)/i.exec(v),s.backgroundColor={value:B(u?u[0]:[0,0,0,0]),unit:F})),["backgroundPositionX","backgroundPositionY"].forEach(function(t){v=s[t],I(v)||(/%$/.test(v)||/px$/.test(v)||/^-?[\d.]+$/.test(v)?(G(s,t,v),(v=s[t]).unit===L&&(v.unit=P)):s[t]={value:{top:0,left:0,center:50,right:100,bottom:100}[v],unit:C})}),v=s.backgroundSize){var m=s.backgroundSize=[],k=v.toString().match(/\b(?:(-?[\d.]+(px|%)?)|(contain|cover|auto))/gi);if(k){1===k.length&&(k[1]=k[0]);for(var b=0;b<2;b++){var x=k[b];/%$/.test(x)||/px$/.test(x)||/^-?[\d.]+$/.test(x)?(G(m,b,x),m[b].unit===L&&(m[b].unit=P)):"0"===x||0===x?m.push({value:0,unit:P}):"contain"===x||"cover"===x?m.push({value:x,unit:D}):m.push({unit:R})}}else m.push({unit:R}),m[1]=m[0]}if(["Top","Right","Bottom","Left"].forEach(function(t){var e=s[t="border"+t+"Color"];I(e)||(s[t]={value:B(e),unit:F})}),(v=s.transform)&&(l=s.transform=[],(c=v.toString().match(/\w+\(.+?\)/g))&&c.forEach(function(t){var e,i,r,n,a,o=t.indexOf("("),s=t.slice(0,o),h=t.slice(o+1,t.length-1);"matrix"===s?(6<(e=(e=h.toString().split(/\s*,\s*/)).map(function(t){return parseFloat(t)})).length&&(e=e.slice(0,6)),6===e.length&&l.push(["matrix",e])):!{translateX:!0,translateY:!0,scaleX:!0,scaleY:!0,skewX:!0,skewY:!0,rotate:!0,rotateZ:!0}.hasOwnProperty(s)?{translate:!0,scale:!0,skew:!0}.hasOwnProperty(s)&&(1===(r=h.toString().split(/\s*,\s*/)).length&&(r[1]=r[0]),n=G(["".concat(s,"X"),r[0]],1,r[0]),a=G(["".concat(s,"Y"),r[1]],1,r[1]),X(s,n[1]),X(s,a[1]),l.push(n),l.push(a)):("rotate"===s&&(s="rotateZ"),X(s,(i=G([s,h],1,h))[1]),l.push(i))})),v=s.transformOrigin,!I(v)){var w=s.transformOrigin=[],A=v.toString().match(E.position);if(A){1===A.length&&(A[1]=A[0]);for(var S=0;S<2;S++){var M=A[S];/%$/.test(M)||/px$/.test(M)||/^-?[\d.]+$/.test(M)?(G(w,S,M),w[S].unit===L&&(w[S].unit=P)):(w.push({value:{top:0,left:0,center:50,right:100,bottom:100}[M],unit:C}),I(w[S].value)&&(w[S].value=50))}}else w.push({value:50,unit:C}),w[1]=w[0]}return["translate","scale","skew"].forEach(function(t){var e;v=s[t],I(v)||(1===(e=v.toString().split(/\s*,\s*/)).length&&(e[1]=e[0]),s["".concat(t,"X")]=e[0],s["".concat(t,"Y")]=e[1],delete s[t])}),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=s[t];I(e)||(G(s,t,e),"rotate"===t&&(t="rotateZ",s.rotateZ=s.rotate,delete s.rotate),X(t,e=s[t]))}),(v=s.opacity)&&(v=parseFloat(v),isNaN(v)?s.opacity=1:(v=Math.max(v,0),v=Math.min(v,1),s.opacity=v)),(v=s.zIndex)&&(s.zIndex=parseInt(v)||0),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","top","right","bottom","left","width","height","flexBasis","strokeWidth"].forEach(function(t){var e=s[t];I(e)||(G(s,t,e),(e=s[t]).unit===L&&(e.unit=P))}),(v=s.color)&&(s.color="inherit"===v?{unit:O}:{value:B(v),unit:F}),!(v=s.fontSize)&&0!==v||("inherit"===v?s.fontSize={unit:O}:/%$/.test(v)?(f=Math.max(0,parseFloat(v)),s.fontSize=f?{value:f,unit:C}:{value:16,unit:P}):s.fontSize={value:Math.max(0,parseFloat(v))||16,unit:P}),!(v=s.fontWeight)&&0!==v||(s.fontWeight="bold"===v?{value:700,unit:L}:"normal"===v?{value:400,unit:L}:"lighter"===v?{value:200,unit:L}:"inherit"===v?{unit:O}:{value:Math.max(0,parseInt(v))||400,unit:L}),(v=s.fontStyle)&&(s.fontStyle="inherit"===v?{unit:O}:{value:v,unit:D}),(v=s.fontFamily)&&(s.fontFamily="inherit"===v?{unit:O}:{value:v,unit:D}),(v=s.textAlign)&&(s.textAlign="inherit"===v?{unit:O}:{value:v,unit:D}),!(v=s.lineHeight)&&0!==v||("inherit"===v?s.lineHeight={unit:O}:"normal"===v?s.lineHeight={unit:R}:/px$/.test(v)?s.lineHeight={value:parseFloat(v),unit:P}:(d=Math.max(0,parseFloat(v))||"normal",s.lineHeight="normal"===d?{unit:R}:{value:d,unit:L})),v=s.strokeDasharray,I(v)||((_=v.toString().match(/[\d.]+/g))?((_=_.map(function(t){return parseFloat(t)})).length%2==1&&_.push(_[_.length-1]),s.strokeDasharray=_):s.strokeDasharray=[]),(v=s.fill)&&(0<v.indexOf("-gradient(")?s.fill=T.parseGradient(v):s.fill=B(v)),(v=s.stroke)&&(0<v.indexOf("-gradient(")?s.stroke=T.parseGradient(v):s.stroke=B(v)),(v=s.filter)&&(s.filter=[],!(p=/\bblur\s*\(\s*([\d.]+)\s*(?:px)?\s*\)/.exec(v))||(y=parseFloat(p[1])||0)&&s.filter.push(["blur",y])),s},compute:function(t,e){var i=t.animateStyle,r=t.__currentStyle=i,n=t.__computedStyle={},a=e?null:t.parent.computedStyle,o=r.fontSize,s=r.fontFamily,h=r.textAlign,u=r.lineHeight;o.unit===O?n.fontSize=e?16:a.fontSize:o.unit===C?n.fontSize=e?16:a.fontSize*o.value*.01:n.fontSize=o.value,s.unit===O?n.fontFamily=e?"arial":a.fontFamily:n.fontFamily=s.value,["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"].forEach(function(t){n[t]=r[t].unit===P?Math.max(0,r[t].value):0}),["position","display","flexDirection","justifyContent","alignItems","flexGrow","flexShrink"].forEach(function(t){n[t]=r[t]}),h.unit===O?n.textAlign=e?"left":a.textAlign:n.textAlign=e?"left":h.value,u.unit===O?n.lineHeight=e?j(n):a.lineHeight:u.unit===P?n.lineHeight=Math.max(u.value,0)||j(n):u.unit===L?n.lineHeight=Math.max(u.value,0)*n.fontSize||j(n):n.lineHeight=j(n),Y(t,e,r)},repaint:Y,setFontStyle:function(t){var e=t.fontStyle,i=t.fontWeight,r=t.fontSize,n=t.fontFamily;return"".concat(e||""," ").concat(i||""," ").concat(r,"px/").concat(r,"px ").concat(n)},getBaseLine:function(t){var e=t.fontSize*c.arial.lhr;return.5*(t.lineHeight-e)+t.fontSize*c.arial.blr},calRelative:function(t,e,i,r,n){return i.unit===R?i=0:-1<[P,L,M,F,D].indexOf(i.unit)?i=i.value:i.unit===C&&(i=V(i.value,r,n?"width":"height")),i},calAbsolute:function(t,e,i,r){return i.unit===R?i=0:-1<[P,L,M,F,D].indexOf(i.unit)?i=i.value:i.unit===C&&(i=i.value*r*.01),i}},xe={CANVAS:0,SVG:1},q=function(){function a(t,e,i,r,n){h(this,a),this.__parent=t,this.__x=e,this.__y=i,this.__width=r,this.__content=n,this.__virtualDom={}}return u(a,[{key:"render",value:function(t,e,i){var r=this.content,n=this.x,a=this.y,o=this.parent,s=o.ox,h=o.oy;a+=$.getBaseLine(i),n+=s,a+=h,t===xe.CANVAS?e.fillText(r,n,a):t===xe.SVG&&(this.__virtualDom={type:"item",tagName:"text",props:[["x",n],["y",a],["fill",be.int2rgba(i.color)],["font-family",i.fontFamily],["font-weight",i.fontWeight],["font-style",i.fontStyle],["font-size","".concat(i.fontSize,"px")]],content:be.encodeHtml(r)})}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"content",get:function(){return this.__content}},{key:"baseLine",get:function(){return $.getBaseLine(this.parent.computedStyle)}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}}]),a}(),U=function(){e(_,x);var i=f(_);function _(t){var e;return h(this,_),(e=i.call(this)).__content=t.toString(),e.__lineBoxes=[],e.__charWidthList=[],e.__charWidth=0,e.__textWidth=0,e}return u(_,[{key:"__measure",value:function(t,e){var i=this.content,r=this.computedStyle,n=this.charWidthList;n.splice(0),t===xe.CANVAS&&(e.font=$.setFontStyle(r));for(var a=r.fontSize+","+r.fontFamily,o=_.MEASURE_TEXT.data[a]=_.MEASURE_TEXT.data[a]||{key:a,style:r,hash:{},s:[]},s=_.CHAR_WIDTH_CACHE[a]=_.CHAR_WIDTH_CACHE[a]||{},h=0,u=!1,l=0,c=i.length;l<c;l++){var f=i.charAt(l),d=void 0;s.hasOwnProperty(f)?(d=s[f],n.push(d),h+=d,this.__charWidth=Math.max(this.charWidth,d)):t===xe.CANVAS?(d=s[f]=e.measureText(f).width,n.push(d),h+=d,this.__charWidth=Math.max(this.charWidth,d)):(o.hash.hasOwnProperty(f)||(o.s+=f),o.hash[f]=!0,n.push(-1),u=!0)}this.__textWidth=h,u&&_.MEASURE_TEXT.list.push(this)}},{key:"__measureCb",value:function(){for(var t,e=this.content,i=this.computedStyle,r=this.charWidthList,n=i.fontSize+","+i.fontFamily,a=_.CHAR_WIDTH_CACHE[n],o=0,s=0,h=r.length;s<h;s++){r[s]<0&&(o+=t=r[s]=a[e.charAt(s)],this.__charWidth=Math.max(this.charWidth,t))}this.__textWidth=o}},{key:"__layout",value:function(t,e){var i=this,r=t.x,n=t.y,a=t.w;this.__x=r,this.__y=n;var o=this.isDestroyed,s=this.content,h=this.computedStyle,u=this.lineBoxes,l=this.charWidthList;if(!o&&"none"!==h.display){this.__ox=this.__oy=0,u.splice(0);for(var c,f,d,_,p=0,y=0,g=0,v=s.length,m=0;y<v;){(g+=l[y])===a?(c=new q(this,r,n,g,s.slice(p,y+1)),u.push(c),m=Math.max(m,g),n+=h.lineHeight,y=p=y+1,g=0):a<g?(f=void 0,f=y===p?(y=p+1,g):g-l[y],d=new q(this,r,n,f,s.slice(p,y)),u.push(d),m=Math.max(m,f),n+=h.lineHeight,p=y,g=0):y++}if(p<v&&p<y){for(g=0,y=p;y<v;y++)g+=l[y];var k=new q(this,r,n,g,s.slice(p,v));u.push(k),m=Math.max(m,g),n+=h.lineHeight}this.__width=m,this.__height=n-t.y,e||(_=h.textAlign,-1<["center","right"].indexOf(_)&&u.forEach(function(t){var e=i.__width-t.width;0<e&&t.__offsetX("center"===_?.5*e:e)}))}}},{key:"__offsetX",value:function(e,t){Q(K(_.prototype),"__offsetX",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetX(e)})}},{key:"__offsetY",value:function(e,t){Q(K(_.prototype),"__offsetY",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetY(e)})}},{key:"__renderByMask",value:function(t,e){this.render(t,e)}},{key:"__tryLayInline",value:function(t){return t-this.textWidth}},{key:"__calMaxAndMinWidth",value:function(){var e=0;return this.charWidthList.forEach(function(t){e=Math.max(e,t)}),{max:this.textWidth,min:e}}},{key:"__calAbsWidth",value:function(t,e,i){return this.__layout({x:t,y:e,w:i},!0),this.width}},{key:"render",value:function(e,i){var t=this.isDestroyed,r=this.computedStyle;t||"none"===r.display||"hidden"===r.visibility||(e===xe.CANVAS&&(i.font=$.setFontStyle(r),i.fillStyle=be.int2rgba(r.color)),this.lineBoxes.forEach(function(t){t.render(e,i,r)}),e===xe.SVG&&(this.__virtualDom={type:"text",children:this.lineBoxes.map(function(t){return t.virtualDom})}))}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"lineBoxes",get:function(){return this.__lineBoxes}},{key:"charWidthList",get:function(){return this.__charWidthList}},{key:"charWidth",get:function(){return this.__charWidth}},{key:"textWidth",get:function(){return this.__textWidth}},{key:"baseLine",get:function(){var t=this.lineBoxes;if(!t.length)return 0;var e=t[t.length-1];return e.y-this.y+e.baseLine}},{key:"currentStyle",get:function(){return this.parent.currentStyle}},{key:"computedStyle",get:function(){return this.parent.computedStyle}}]),_}();t(U,"CHAR_WIDTH_CACHE",{}),t(U,"MEASURE_TEXT",{list:[],data:{}});var Z={position:"static",display:"block",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:"inherit",fontFamily:"inherit",color:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"normal",backgroundImage:null,backgroundColor:"transparent",backgroundSize:"auto",backgroundRepeat:"repeat",backgroundPositionX:0,backgroundPositionY:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"#000",borderRightColor:"#000",borderBottomColor:"#000",borderLeftColor:"#000",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",borderLeftStyle:"solid",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0,width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",textAlign:"inherit",transformOrigin:"center",visibility:"visible",opacity:1,zIndex:0,transform:null,translateX:0,translateY:0,scaleX:1,scaleY:1,skewX:0,skewY:0,rotateZ:0,filter:null},J={fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"butt"},tt=[],et=[];Object.keys(Z).forEach(function(t){et.push(t);var e=Z[t];tt.push({k:t,v:e})});var it=[],rt=[];Object.keys(J).forEach(function(t){rt.push(t);var e=J[t];it.push({k:t,v:e})});var nt={DOM:Z,GEOM:J,domKey:et,geomKey:rt,dom:tt,geom:it};var at={identity:function(){for(var t=[],e=0;e<16;e++)t.push(e%5==0?1:0);return t},multiply:function(t,e){for(var i=[],r=0;r<4;r++)for(var n=[t[r],t[r+4],t[r+8],t[r+12]],a=0;a<4;a++){var o=4*a,s=[e[o],e[1+o],e[2+o],e[3+o]],h=n[0]*s[0]+n[1]*s[1]+n[2]*s[2]+n[3]*s[3];i[r+o]=h}return i},t43:function(t){return[t[0],t[1],t[4],t[5],t[12],t[13]]},calPoint:function(t,e){var i=me(t,2),r=i[0],n=i[1];return[e[0]*r+e[2]*n+e[4],e[1]*r+e[3]*n+e[5]]}};function ot(t,e,i,r){return Math.atan((r-e)/(i-t))}function st(t){var e=Math.sin(t),i=Math.cos(t),r=at.identity();return r[0]=r[5]=i,r[1]=e,r[4]=-e,r}var ht={transform:function(t,e){var i=me(t,6),r=i[0],n=i[1],a=i[2],o=i[3],s=i[4],h=i[5],u=me(e,6),l=u[0],c=u[1],f=u[2],d=u[3],_=u[4],p=u[5],y=l-r,g=f-a;l-=y,c-=g,f-=y,d-=g,_-=y,p-=g;var v=at.identity(),m=st(-(L=ot(r,n,a,o))),v=at.multiply(m,v),k=Math.sqrt(Math.pow(a-r,2)+Math.pow(o-n,2)),b=Math.sqrt(Math.pow(f-l,2)+Math.pow(d-c,2))/k;(m=at.identity())[0]=m[5]=b,v=at.multiply(m,v),m=st(-(L=ot(l,c,f,d)));var x=me(at.calPoint([f,d],at.t43(m)),2),w=x[0],A=x[1],S=me(at.calPoint([_,p],at.t43(m)),2),M=S[0],E=S[1],T=Math.atan((w-M)/(E-A)),b=E/at.calPoint([s,h],at.t43(v))[1];(m=at.identity())[5]=b,v=at.multiply(m,v);var R=me(at.calPoint([s,h],at.t43(v)),2),P=R[0],C=R[1],L=Math.atan((M-P)/C);return(m=at.identity())[4]=Math.tan(L),v=at.multiply(m,v),m=st(-T),v=at.multiply(m,v),(m=at.identity())[12]=y,m[13]=g,v=at.multiply(m,v),at.t43(v)}},ut={matrix:at,tar:ht,geom:A},lt=s.PX,ct=s.PERCENT,ft=ut.matrix,dt=ut.geom,_t=dt.d2r,pt=dt.transformPoint;function yt(t){var e=ft.identity();return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}var we={calMatrix:function(t,e,i,r){var n,a,o,s=me(e,2),h=s[0],u=s[1],l=(n=i,a=r,o=[],t.forEach(function(t){var e=me(t,2),i=e[0],r=e[1];o.push([i,function(t,e,i,r){if("translateX"===t){if(e.unit===ct)return e.value*i*.01}else if("translateY"===t){if(e.unit===ct)return e.value*r*.01}else if("matrix"===t)return e;return e.value}(i,r,n,a)])}),o),c=ft.identity();c[12]=h,c[13]=u,l.forEach(function(t){var e,i,r,n,a,o=me(t,2),s=o[0],h=o[1],u=ft.identity();e=u,r=h,"translateX"===(i=s)?e[12]=r:"translateY"===i?e[13]=r:"scaleX"===i?e[0]=r:"scaleY"===i?e[5]=r:"skewX"===i?(r=_t(r),e[4]=Math.tan(r)):"skewY"===i?(r=_t(r),e[1]=Math.tan(r)):"rotateZ"===i?(r=_t(r),n=Math.sin(r),a=Math.cos(r),e[0]=e[5]=a,e[1]=n,e[4]=-n):"matrix"===i&&(e[0]=r[0],e[1]=r[1],e[4]=r[2],e[5]=r[3],e[12]=r[4],e[13]=r[5]),c=ft.multiply(c,u)});var f=ft.identity();return f[12]=-h,f[13]=-u,c=ft.multiply(c,f),ft.t43(c)},calOrigin:function(t,i,r){var n=[];return t.forEach(function(t,e){t.unit===lt?n.push(t.value):t.unit===ct&&n.push(t.value*(e?r:i)*.01)}),n},pointInQuadrilateral:function(t,e,i,r,n,a,o,s,h,u,l){if(!l||be.equalArr(l,[1,0,0,1,0,0]))return i<=t&&r<=e&&t<=o&&e<=s;var c=me(pt(l,i,r),2);i=c[0],r=c[1];var f=me(pt(l,n,a),2);n=f[0],a=f[1];var d=me(pt(l,o,s),2);o=d[0],s=d[1];var _=me(pt(l,h,u),2);return h=_[0],u=_[1],dt.pointInPolygon(t,e,[[i,r],[n,a],[o,s],[h,u]])},mergeMatrix:function(t,e){var i=yt(t),r=yt(e),n=ft.multiply(i,r);return[n[0],n[1],n[4],n[5],n[12],n[13]]}},gt=A.H;function vt(t,e,i,r,n,a,o,s){var h=1,u=1,l=1;t:for(var c=a;n<=c;c--)for(var f=s;o<=f;f--){var d=c+f,_=Math.floor((t+f)/d),p=f;if(_*d<f+t)if(s<(p=(t-_*c)/(_-1)))continue;if(d=c+p,1<e&&c<e){if(c<e%d)continue;if(1<i)if(c<(e+r)%d)continue}if(1<i)if(c<(e+r)%d)continue;0<_&&(h=_,u=c,l=p);break t}return{n:h,ps:u,pd:l}}function mt(t,e,i,r,n,a){var o=n-e,s=r-i,h=i-e,u=n-r;if("dotted"===t)return vt(o,h,u,s,a,a,Math.max(1,.25*a),2*a);var l=vt(o,h,u,s,a,3*a,Math.max(1,.25*a),2*a),c=l.n,f=l.ps,d=l.pd;return 1===c?vt(o,h,u,s,a,a,Math.max(1,.25*a),2*a):{n:c,ps:f,pd:d}}var Ae={calDashed:mt,calPoints:function(t,e,i,r,n,a,o,s,h,u,l,c,f){var d=[];if(-1<["dashed","dotted"].indexOf(e)){var _=0===f||2===f?mt(e,n,a,o,s,t):mt(e,h,u,l,c,t),p=_.n,y=_.ps,g=_.pd;if(1<p){for(var v=0;v<p;v++){var m=v===p-1,k=void 0,b=void 0,x=void 0,w=(k=0===f||2===f?v?n+y*v+g*v:n:v?h+y*v+g*v:h)+y;0===f?w<a?m?d.push([n,h,s,h,o,u,a,u]):(b=h+(k-n)*Math.tan(i),x=h+(w-n)*Math.tan(i),d.push([k,h,w,h,w,x,k,b])):o<k?(b=h+(s-k)*Math.tan(r),x=h+(s-w)*Math.tan(r),m?d.push([k,h,s,h,k,b]):d.push([k,h,w,h,w,x,k,b])):k<a?(b=h+(k-n)*Math.tan(i),m?d.push([k,h,s,h,o,u,a,u,k,b]):o<w?d.push([k,h,w,h,o,u,a,u,k,b]):d.push([k,h,w,h,w,u,a,u,k,b])):o<w?(b=h+(s-w)*Math.tan(r),k<a?m?d.push([k,h,s,h,o,u,a,u,k,b]):d.push([k,h,w,h,w,b,o,u,a,u,k,b]):m?d.push([k,h,s,h,o,u,k,u]):d.push([k,h,w,h,w,b,o,u,k,u])):m?d.push([k,h,s,h,o,u,k,u]):d.push([k,h,w,h,w,u,k,u]):1===f?w<u?m?d.push([o,u,s,h,s,c,o,l]):(b=s-(w-h)*Math.tan(i),x=s-(k-h)*Math.tan(i),d.push([b,w,x,k,s,k,s,w])):l<k?(b=o+(k-l)*Math.tan(r),x=o+(w-l)*Math.tan(r),m?d.push([b,k,s,k,s,c]):d.push([b,k,s,k,s,w,x,w])):k<u?(b=o+(u-k)*Math.tan(i),m?d.push([o,u,b,k,s,k,s,c,o,c]):l<w?d.push([o,u,b,k,s,k,s,w,b,w,o,l]):d.push([o,u,b,k,s,k,s,w,o,w])):l<w?(b=o+(w-l)*Math.tan(r),k<u?m?d.push([o,u,b,k,s,k,s,c,o,l]):d.push([o,u,b,k,s,k,s,w,b,w,o,l]):m?d.push([o,k,s,k,s,c,o,l]):d.push([o,k,s,k,s,w,b,w,o,l])):m?d.push([o,k,s,k,s,c,o,l]):d.push([o,k,s,k,s,w,o,w]):2===f?w<a?m?d.push([n,c,a,l,o,l,s,c]):(b=c-(k-n)*Math.tan(i),x=c-(w-n)*Math.tan(i),d.push([k,b,w,x,w,c,k,c])):o<k?(b=c-(k-n)*Math.tan(r),x=c-(w-n)*Math.tan(r),m?d.push([k,b,s,c,k,c]):d.push([k,b,w,x,w,c,k,c])):k<a?(b=l+(k-n)*Math.tan(i),m?d.push([k,b,a,l,o,l,s,c,k,c]):o<w?d.push([k,b,a,l,o,l,w,c,k,c]):d.push([k,b,a,l,w,l,w,c,k,c])):o<w?(b=c-(s-w)*Math.tan(r),k<a?m?d.push([k,b,o,l,s,c,k,c]):d.push([k,b,o,l,w,b,w,c,k,c]):m?d.push([k,l,o,l,s,c,k,c]):d.push([k,l,o,l,w,b,w,c,k,c])):m?d.push([k,l,o,l,s,c,k,c]):d.push([k,l,w,l,w,c,k,c]):3===f&&(w<u?m?d.push([n,h,a,u,a,l,n,c]):(b=n+(k-h)*Math.tan(i),x=n+(w-h)*Math.tan(i),d.push([n,k,b,k,x,w,n,w])):l<k?(b=n+(c-k)*Math.tan(r),x=n+(c-w)*Math.tan(r),m?d.push([n,k,b,k,n,c]):d.push([n,k,b,k,x,w,n,w])):k<u?(b=n+(k-h)*Math.tan(i),m?d.push([n,k,b,k,a,u,a,l,n,c]):l<w?d.push([n,k,b,k,a,u,a,l,b,w,n,w]):d.push([n,k,b,k,a,u,a,w,n,w])):l<w?(b=n+(c-w)*Math.tan(r),k<u?m?d.push([n,k,b,k,a,u,a,l,n,c]):d.push([n,k,b,k,a,u,a,l,b,w,n,w]):m?d.push([n,k,a,k,a,l,n,c]):d.push([n,k,a,k,a,l,b,w,n,w])):m?d.push([n,k,a,k,a,l,n,c]):d.push([n,k,a,k,a,w,n,w]))}return d}}return 0===f?d.push([n,h,s,h,o,u,a,u]):1===f?d.push([o,u,s,h,s,c,o,l]):2===f?d.push([n,c,a,l,o,l,s,c]):3===f&&d.push([n,h,a,u,a,l,n,c]),d},calRadius:function(t,e,i,r,n,a,o,s){if(n||a||o||s){var h=[];return h.push([t+n,e]),h.push([t+i-a,e]),h.push([t+i-a*(1-gt),e,t+i,e+a*(1-gt),t+i,e+a]),h.push([t+i,e+r-o]),h.push([t+i,e+r-o*(1-gt),t+i-o*(1-gt),e+r,t+i-o,e+r]),h.push([t+s,e+r]),h.push([t+s*(1-gt),e+r,t,e+r-s*(1-gt),t,e+r-s]),h.push([t,e+n]),h.push([t,e+n*(1-gt),t+n*(1-gt),e,t+n,e]),h}},genRdRect:function(t,e,i,r,n,a,o,s){if(t!==xe.CANVAS){for(var h="M".concat(s[0][1],",").concat(s[0][1]),u=1,l=s.length;u<l;u+=2){var c=s[u],f=s[u+1];h+="L".concat(c[0],",").concat(c[1]),h+="C".concat(f[0],",").concat(f[1],",").concat(f[2],",").concat(f[3],",").concat(f[4],",").concat(f[5])}return{type:"item",tagName:"path",props:[["d",h],["fill",i]]}}e.beginPath(),e.fillStyle=i,e.moveTo(s[0][0],s[0][1]);for(var d=1,_=s.length;d<_;d+=2){var p=s[d],y=s[d+1];e.lineTo(p[0],p[1]),e.bezierCurveTo(y[0],y[1],y[2],y[3],y[4],y[5])}e.fill(),e.closePath()}},kt=s.PERCENT,bt=s.NUMBER;var Se={matrixResize:function(t,e,i,r,n,a,o,s){if(t!==i||e!==r){var h=[["scaleX",{value:i/t,unit:bt}],["scaleY",{value:r/e,unit:bt}]],u=we.calOrigin([{value:0,unit:kt},{value:0,unit:kt}],o,s);return u[0]+=n,u[1]+=a,we.calMatrix(h,u,o,s)}}},xt=be.isFunction,wt=function(){function o(){h(this,o),this.__eHash={}}return u(o,[{key:"on",value:function(t,e){if(e){var i=this;if(Array.isArray(t))for(var r=0,n=t.length;r<n;r++)i.on(t[r],e);else if(e){i.__eHash.hasOwnProperty(t)||(i.__eHash[t]=[]);for(var a=0,o=i.__eHash[t],s=o.length;a<s;a++)if(o[a]===e)return i;i.__eHash[t].push(e)}return i}}},{key:"once",value:function(r,n){if(xt(n)){var a=this;if(o.__karasEventCb=n,Array.isArray(r))for(var t=0,e=r.length;t<e;t++)a.once(r[t],n);else n&&a.on(r,o);return this}function o(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.apply(a,e),a.off(r,o)}}},{key:"off",value:function(t,e){if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)this.off(t[i],e);else if(this.__eHash.hasOwnProperty(t))if(e){for(var n=0,a=this.__eHash[t],o=a.length;n<o;n++)if(a[n]===e||a[n].__karasEventCb===e){a.splice(n,1);break}}else delete this.__eHash[t];return this}},{key:"emit",value:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];if(Array.isArray(t))for(var n=0,a=t.length;n<a;n++)this.emit(t[n],i);else if(this.__eHash.hasOwnProperty(t)){var o=this.__eHash[t];if(o.length)for(var s=0,h=(o=o.slice()).length;s<h;s++){var u=o[s];xt(u)&&u.apply(this,i)}}return this}}],[{key:"mix",value:function(){for(var t=arguments.length-1;0<=t;t--){var e=t<0||arguments.length<=t?void 0:arguments[t],i=new o;e.__eHash={};for(var r=["on","once","off","emit"],n=r.length-1;0<=n;n--){var a=r[n];e[a]=i[a]}}}}]),o}();t(wt,"REFRESH","refresh"),t(wt,"PAUSE","pause"),t(wt,"PLAY","play"),t(wt,"FRAME","frame"),t(wt,"FINISH","finish"),t(wt,"CANCEL","cancel"),t(wt,"BEGIN","begin"),t(wt,"END","end");var At={REPAINT:0,REFLOW:1},St={GEOM:{x1:!0,y1:!0,x2:!0,y2:!0,controlA:!0,controlB:!0,r:!0,rx:!0,ry:!0,begin:!0,end:!0,points:!0,controls:!0},STYLE:{transform:!0,translateX:!0,translateY:!0,skewX:!0,skewY:!0,scaleX:!0,scaleY:!0,rotateZ:!0,color:!0,fontStyle:!0,strokeWidth:!0,fill:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0,backgroundSize:!0,stroke:!0,borderBottomColor:!0,borderLeftColor:!0,borderRightColor:!0,borderTopColor:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0,visibility:!0,opacity:!0,zIndex:!0,filter:!0}},Mt=be.isNil,Et=be.isString,Tt=be.isFunction,Rt=be.clone,Pt=be.extend;var Ct=function(){e(o,wt);var n=f(o);function o(t,e,i){var r;return h(this,o),r=n.call(this),Et(t)||(i=e,e=t,t=/(?:function|class)\s+([\w$]+)/.exec(r.constructor.toString())[1]),r.__tagName=t,e=e||[],Array.isArray(e)?(r.props=be.arr2hash(e),r.__props=e):(r.props=e,r.__props=be.hash2arr(e)),r.__children=i||[],r.__shadowRoot=null,r.__parent=null,r.__ref={},r.__state={},r}return u(o,[{key:"setState",value:function(t,e){var i=this;Mt(t)?this.state={}:Pt(this.state,t);var r,n=this.root;n?(n.delRefreshTask(this.__task),r=this.shadowRoot,this.__task={before:function(){i.__init(),n.setRefreshLevel(At.REFLOW)},after:function(){!function t(e,i){if(e!==i&&e.tagName===i.tagName&&i.tagName){e.animationList.forEach(function(t){t.__target=i}),i.__animationList=e.animationList.splice(0);var r=e.children,n=i.children;if(r&&n)for(var a=r.length,o=n.length,s=0,h=Math.min(a,o);s<h;s++)e=r[s],i=n[s],e instanceof Ct&&(e=e.shadowRoot),i instanceof Ct&&(i=i.shadowRoot),t(e,i)}}(r,i.shadowRoot),r instanceof x&&r.__destroy(),Tt(e)&&e()}},n.addRefreshTask(this.__task)):Tt(e)&&e()}},{key:"__init",value:function(){for(var t,e,n=this,a=this.render();a instanceof o;)a=a.__init();return a instanceof x?(a.__host=this,a.__initRef(this),t=Rt(this.props.style)||{},$.normalize(t),Pt(a.style,t),this.__props.forEach(function(t){var e,i=t[0],r=t[1];/^on[a-zA-Z]/.test(i)?(i=i.slice(2).toLowerCase(),-1===(e=a.listener[i]=a.listener[i]||[]).indexOf(r)&&e.push(r)):/^on-[a-zA-Z\d_$]/.test(i)&&(i=i.slice(3),n.on(i,function(){r.apply(void 0,arguments)}))})):(e="",Mt(a)||(e=be.encodeHtml(a.toString())),(a=new U(e)).__parent=this.parent),this.__shadowRoot=a}},{key:"__initRef",value:function(t){var e=this.props.ref;Et(e)?t.ref[e]=this:Tt(e)&&e(t)}},{key:"render",value:function(){}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),this.shadowRoot&&this.shadowRoot.__destroy(),this.children.splice(0),this.__shadowRoot=null,this.__parent=null}},{key:"__emitEvent",value:function(t,e){var i=this.shadowRoot;if(!(i instanceof U))return e?i.__emitEvent(t,e):i.__emitEvent(t)?(t.target=this,!0):void 0}},{key:"__measure",value:function(t,e){var i=this.shadowRoot;i instanceof U?i.__measure(t,e):i.__measure(t,e,!0)}},{key:"__repaint",value:function(){var t=this.shadowRoot;t instanceof x&&t.__repaint(!0)}},{key:"tagName",get:function(){return this.__tagName}},{key:"children",get:function(){return this.__children}},{key:"shadowRoot",get:function(){return this.__shadowRoot}},{key:"root",get:function(){if(this.parent)return this.parent.root}},{key:"parent",get:function(){return this.__parent}},{key:"ref",get:function(){return this.__ref}},{key:"state",get:function(){return this.__state},set:function(t){this.__state=t}}]),o}();Object.keys(St.GEOM).concat(["x","y","ox","oy","sx","sy","width","height","outerWidth","outerHeight","style","animating","animationList","animateStyle","currentStyle","computedStyle","animateProps","currentProps","baseLine","virtualDom","mask","maskId","textWidth","content","lineBoxes","charWidthList","charWidth"]).forEach(function(e){Object.defineProperty(Ct.prototype,e,{get:function(){var t=this.shadowRoot;if(t)return t[e]}})}),["__layout","__layoutAbs","__tryLayInline","__offsetX","__offsetY","__calAutoBasis","__calMp","__calAbs","__renderAsMask","__renderByMask","__mp","animate","removeAnimate","clearAnimate"].forEach(function(e){Ct.prototype[e]=function(){var t=this.shadowRoot;if(t&&Tt(t[e]))return t[e].apply(t,arguments)}});var Lt={cache:null,mask:null};function Ot(t,e,i){var r;return Lt[t]||((r=Lt[t]=document.createElement("canvas")).style.position="absolute",r.style.left="9999px",r.style.top="-9999px",document.body.append(r)),(r=Lt[t]).setAttribute("width",e),r.setAttribute("height",i),r.style.width=e+"px",r.style.height=i+"px",{canvas:r,ctx:r.getContext("2d"),draw:function(){}}}var Wt,Nt,Ft={},Me={measureText:function(t){var e=U.MEASURE_TEXT,i=e.list,u=e.data,l="",c=[],f=[];if(Object.keys(u).forEach(function(t){var e=u[t],i=e.key,r=e.style,n=e.s;if(n)for(var a="position:absolute;font-family:".concat(r.fontFamily,";font-size:").concat(r.fontSize,"px"),o=0,s=n.length;o<s;o++){c.push(i);var h=n.charAt(o);f.push(h),l+='<span style="'.concat(a,'">').concat(h.replace(/</,"&lt;").replace(" ","&nbsp;"),"</span>")}}),l){var r=document.createElement("div");r.style.position="absolute",r.style.left="99999px",r.style.top="-99999px",r.style.visibility="hidden",document.body.appendChild(r),r.innerHTML=l;for(var n=r.childNodes,a=U.CHAR_WIDTH_CACHE,o=U.MEASURE_TEXT,s=0,h=n.length;s<h;s++){var d=n[s],_=c[s],p=f[s],y=window.getComputedStyle(d,null);a[_][p]=parseFloat(y.width)}i.forEach(function(t){return t.__measureCb()}),t(),o.list=[],o.data={},document.body.removeChild(r)}else t()},IMG:Ft,INIT:0,LOADED:2,LOADING:1,measureImg:function(t,e){var i,r,n=Ft[t]=Ft[t]||{state:0,task:[]};2===n.state?e(n):1===n.state?n.task.push(e):(n.state=1,n.task.push(e),(i=new Image).onload=function(){n.state=2,n.success=!0,n.width=i.width,n.height=i.height,n.source=i,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},i.onerror=function(){n.state=2,n.success=!1,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},"data:"===t.substr(0,5)||(r=/^(?:\w+:)?\/\/([^/:]+)/.exec(t))&&location.hostname!==r[1]&&(i.crossOrigin="anonymous"),i.src=t)},warn:function(t){console.warn(t)},requestAnimationFrame:(Nt=function(t){var e;return"undefined"!=typeof requestAnimationFrame?(Me.requestAnimationFrame=requestAnimationFrame.bind(window),e=requestAnimationFrame(t)):(e=setTimeout(t,1e3/60),Me.requestAnimationFrame=function(t){return setTimeout(t,1e3/60)}),e},It.toString=function(){return Nt.toString()},It),cancelAnimationFrame:(Wt=function(t){var e;return"undefined"!=typeof cancelAnimationFrame?(Me.cancelAnimationFrame=cancelAnimationFrame.bind(window),e=cancelAnimationFrame(t)):(e=clearTimeout(t),Me.cancelAnimationFrame=function(t){return clearTimeout(t)}),e},Dt.toString=function(){return Wt.toString()},Dt),now:function(){return"undefined"!=typeof performance?(Me.now=performance.now.bind(performance),performance.now()):(Me.now=Date.now.bind(Date),Date.now())},getCacheCanvas:function(t,e){return Ot("cache",t,e)},getMaskCanvas:function(t,e){return Ot("mask",t,e)},isDom:function(t){if(t){if(be.isString(t))return!0;if("undefined"!=typeof window&&window.Element&&t instanceof window.Element)return!0;if(be.isFunction(t.getElementsByTagName))return!0}return!1}};function Dt(t){return Wt.apply(this,arguments)}function It(t){return Nt.apply(this,arguments)}var Bt=be.isFunction,Ht=be.isObject;function zt(t,e,i){"before"===i?t.forEach(function(t){Ht(t)&&Bt(t.before)&&t.before(e)}):"after"===i&&t.forEach(function(t){Ht(t)&&Bt(t.after)?t.after(e):Bt(t)&&t(e)})}var Gt=new(function(){function t(){h(this,t),this.__aTask=[],this.__hookTask=[],this.__task=[],this.__now=null}return u(t,[{key:"__init",value:function(){var a=this,o=a.aTask,s=a.task;Me.cancelAnimationFrame(a.id);var h=a.__now=Me.now();!function n(){Me.cancelAnimationFrame(a.id),a.id=Me.requestAnimationFrame(function(){var t,e,i,r;(o.length||s.length)&&(e=(t=a.__now=Me.now())-h,e=Math.max(e,0),h=t,i=o.slice(0),r=s.slice(0),zt(i,e,"before"),zt(r,e,"before"),a.__hookTask.splice(0).forEach(function(t){return t()}),zt(i,e,"after"),zt(r,e,"after"),(o.length||s.length)&&n())})}()}},{key:"__onFrame",value:function(t,e){var i,r;t&&(i=this.aTask,r=this.task,i.length||r.length||this.__init(),e.push(t))}},{key:"__offFrame",value:function(t,e){if(t){for(var i=0,r=e.length;i<r;i++){var n=e[i];if(n===t||n.__karasFramecb===t){e.splice(i,1);break}}var a=this.aTask,o=this.task;a.length||o.length||(Me.cancelAnimationFrame(this.id),this.__now=null)}}},{key:"onFrame",value:function(t){this.__onFrame(t,this.task)}},{key:"offFrame",value:function(t){this.__offFrame(t,this.task)}},{key:"__onFrameA",value:function(t){this.__onFrame(t,this.aTask)}},{key:"__offFrameA",value:function(t){this.__offFrame(t,this.aTask)}},{key:"__nextFrame",value:function(e,i){var r,n=this;e&&((r=Bt(e)?function(t){e(t),i?n.__offFrameA(r):n.offFrame(r)}:{before:e.before,after:function(t){e.after(t),i?n.__offFrameA(r):n.offFrame(r)}}).__karasFramecb=e,i?this.__onFrameA(r):this.onFrame(r))}},{key:"nextFrame",value:function(t){this.__nextFrame(t)}},{key:"__nextFrameA",value:function(t){this.__nextFrame(t,!0)}},{key:"task",get:function(){return this.__task}},{key:"aTask",get:function(){return this.__aTask}}]),t}()),Xt=4,Yt=1e-7,jt=10,Vt="function"==typeof Float32Array;function $t(t,e){return 1-3*e+3*t}function qt(t,e){return 3*e-6*t}function Ut(t,e,i){return(($t(e,i)*t+qt(e,i))*t+3*e)*t}function Zt(t,e,i){return 3*$t(e,i)*t*t+2*qt(e,i)*t+3*e}function Kt(t){return t}function Qt(a,e,o,i){if(!(0<=a&&a<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(a===e&&o===i)return Kt;for(var s=new(Vt?Float32Array:Array)(11),t=0;t<11;++t)s[t]=Ut(.1*t,a,o);function r(t){for(var e=0,i=1;10!==i&&s[i]<=t;++i)e+=.1;var r=e+.1*((t-s[--i])/(s[i+1]-s[i])),n=Zt(r,a,o);return.001<=n?function(t,e,i,r){for(var n=0;n<Xt;++n){var a=Zt(e,i,r);if(0===a)return e;e-=(Ut(e,i,r)-t)/a}return e}(t,r,a,o):0===n?r:function(t,e,i,r,n){for(var a,o,s=0;0<(a=Ut(o=e+(i-e)/2,r,n)-t)?i=o:e=o,Math.abs(a)>Yt&&++s<jt;);return o}(t,e,e+.1,a,o)}return function(t){return 0===t||1===t?t:Ut(r(t),e,i)}}var Jt={linear:Qt(1,1,0,0),easeIn:Qt(.42,0,1,1),easeOut:Qt(0,0,.58,1),ease:Qt(.25,.1,.25,1),easeInOut:Qt(.42,0,.58,1),cubicBezier:Qt},re=s.AUTO,ne=s.PX,ae=s.PERCENT,oe=s.INHERIT,se=s.RGBA,he=s.STRING,ue=s.NUMBER,le=be.isNil,ce=be.isFunction,fe=be.isNumber,de=be.isObject,_e=be.clone,pe=be.equalArr,ye=Jt.linear,ge={};["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color"].forEach(function(t){ge[t]=!0});var ve={};["fontSize","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","bottom","left","right","top","flexBasis","width","height","lineHeight","marginBottom","marginLeft","marginRight","marginTop","paddingBottom","paddingLeft","paddingRight","paddingTop","strokeWidth"].forEach(function(t){ve[t]=!0});var Ee={};["backgroundImage","fill","stroke"].forEach(function(t){Ee[t]=!0});var Te={linear:!0,radial:!0},Re={};function Pe(t){return!St.STYLE.hasOwnProperty(t)&&!St.GEOM.hasOwnProperty(t)}function Ce(t,e,i){for(var r=!1,n=At.REPAINT,a=0,o=i.length;a<o;a++){var s=i[a],h=t[s],u=e[s];if(le(h)||le(u)){if((!le(h)||!le(u))&&(r=!0,Pe(s))){n=At.REFLOW;break}}else if(!function(t,e,i){if("transform"===t)return pe(e[0][1],i[0][1]);if("filter"===t){if(e.length!==i.length)return;for(var r=0,n=e.length;r<n;r++)if(!pe(e[r],i[r]))return}else{if("transformOrigin"===t||"backgroundSize"===t)return e[0].value===i[0].value&&e[0].unit===i[0].unit&&e[1].value===i[1].value&&e[1].unit===i[1].unit;if("backgroundPositionX"===t||"backgroundPositionY"===t||ve.hasOwnProperty(t)||Re.hasOwnProperty(t))return e.value===i.value&&e.unit===i.unit;if(ge.hasOwnProperty(t))return e.unit===i.unit&&pe(e.value,i.value);if(Ee.hasOwnProperty(t)&&e.k===i.k&&Te.hasOwnProperty(e.k)){var a=e.v,o=i.v;if(e.d!==i.d||a.length!==o.length)return;for(var s=0,h=a.length;s<h;s++){var u=a[s],l=o[s];if(u.length!==l.length)return;for(var c=0;c<4;c++)if(u[0][c]!==l[0][c])return;if(1<u.length&&(u[1].value!==l[1].value||u[1].unit!==l[1].unit))return}return 1}if(St.GEOM.hasOwnProperty(t)){if("points"===t||"controls"===t){if(e.length!==i.length)return;for(var f=0,d=e.length;f<d;f++)if(e[f]!==i[f]&&(e[f][0]!==i[f][0]||e[f][1]!==i[f][1]))return;return 1}if("controlA"===t||"controlB"===t)return e.length===i.length&&(e[0]===i[0]&&e[1]===i[1])}}return e===i}(s,h,u)){if(r=!0,n!==At.REPAINT)break;if(Pe(s)){n=At.REFLOW;break}}}return[r,n]}function Le(i,t,e,r){e.setRefreshLevel(r),e.__frameHook();var n={},a={};Object.keys(i).forEach(function(t){var e=i[t];le(e)||(St.GEOM.hasOwnProperty(t)&&(a[t]=e),n[t]=e)}),t.__style=n,t.__props=a}function Oe(i,r,t,n){return t.forEach(function(t){var e=function(t,e,i,r){var n={k:i},a=t[i],o=e[i];if("transform"===i){if(!a&&!o)return;var s=a?a[0][1]:[1,0,0,1,0,0],h=o?o[0][1]:[1,0,0,1,0,0];if(pe(s,h))return;return n.v=[h[0]-s[0],h[1]-s[1],h[2]-s[2],h[3]-s[3],h[4]-s[4],h[5]-s[5]],n}if("filter"===i)a&&a.length?o&&o.length?n.v=o[0][1]-a[0][1]:n.v=-a[0][1]:n.v=o[0][1];else if("transformOrigin"===i){n.v=[];for(var u=0;u<2;u++){var l,c,f=a[u],d=o[u];f.unit===d.unit?n.v.push(d.value-f.value):f.unit===ne&&d.unit===ae?(l=.01*d.value*r[u?"outerHeight":"outerWidth"],n.v.push(l-f.value)):f.unit===ae&&d.unit===ne&&(c=100*d.value/r[u?"outerHeight":"outerWidth"],n.v.push(c-f.value))}if(pe(n.v,[0,0]))return}else if("backgroundPositionX"===i||"backgroundPositionY"===i){if(a.unit===o.unit&&-1<[ne,ae].indexOf(a.unit)){var _=o.value-a.value;if(0==_)return;n.v=_}else if(a.unit===ne&&o.unit===ae){var p=.01*o.value*r["backgroundPositionX"===i?"innerWidth":"innerHeight"];if(0===(p-=a.value))return;n.v=p}else if(a.unit===ae&&o.unit===ne){var y=100*o.value/r["backgroundPositionX"===i?"innerWidth":"innerHeight"];if(0===(y-=a.value))return;n.v=y}}else if(Re.hasOwnProperty(i)){if(a.unit===o.unit){var g=o.value-a.value;if(0==g)return;n.v=g}else if(a.unit===ne&&o.unit===ae){var v=.01*o.value*r[/\w+X$/.test(i)?"outerWidth":"outerHeight"];if(0===(v-=a.value))return;n.v=v}else if(a.unit===ae&&o.unit===ne){var m=100*o.value/r[/\w+X$/.test(i)?"outerWidth":"outerHeight"];if(0===(m-=a.value))return;n.v=m}}else if("backgroundSize"===i){n.v=[];for(var k=0;k<2;k++){var b=a[k],x=o[k];if(b.unit===x.unit&&-1<[ne,ae].indexOf(b.unit))n.v.push(x.value-b.value);else if(b.unit===ne&&x.unit===ae){var w=.01*x.value*r[k?"innerWidth":"innerHeight"];n.v.push(w-b.value)}else{if(b.unit!==ae||x.unit!==ne)return n.n=a,n;var A=100*x.value/r[k?"innerWidth":"innerHeight"];n.v.push(A-b.value)}}if(pe(n.v,[0,0]))return}else if(Ee.hasOwnProperty(i))if(a.k!==o.k)n.n=a;else if("linear"===a.k||"radial"===a.k){var S=a.v,M=o.v;if(pe(S,M))return;n.v=[];for(var E,T=r.innerWidth,R=0,P=Math.min(S.length,M.length);R<P;R++){var C=S[R],L=M[R],O=[];O.push([L[0][0]-C[0][0],L[0][1]-C[0][1],L[0][2]-C[0][2],L[0][3]-C[0][3]]),E=pe(O,[0,0,0,0]),C[1]&&L[1]?(C[1].unit===L[1].unit?O.push(L[1].value-C[1].value):C[1].unit===ne&&L[1].unit===ae?O.push(L[1].value*T*.01-C[1].value):C[1].unit===ae&&L[1].unit===ne&&O.push(100*L[1].value/T-C[1].value),E=E&&0===O[4]):(C[1]||L[1])&&(E=!1),n.v.push(O)}if("linear"===a.k){var W=o.d-a.d;if(E&&0==W)return;n.d=W}else{n.p=[];for(var N=0;N<2;N++){var F,D,I=a.p[N],B=o.p[N];I.unit===B.unit?n.p.push(B.value-I.value):I.unit===ne&&B.unit===ae?(F=.01*B.value*r[N?"innerWidth":"innerHeight"],n.p.push(F-I.value)):I.unit===ae&&B.unit===ne&&(D=100*B.value/r[N?"innerWidth":"innerHeight"],n.p.push(D-I.value))}if(E&&pe(n.p,[0,0]))return}}else{if(pe(o,a))return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}else if(ge.hasOwnProperty(i)){if(o=o.value,a=a.value,pe(o,a)||0===o[3]&&0===a[3])return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}else if(ve.hasOwnProperty(i)){if(a.unit===re&&o.unit===re)return;if(a.unit===re||o.unit===re)return n.n=a,n;var H,z,G=r.computedStyle,X=(r.parent||r).computedStyle,Y=0;if(a.unit===o.unit?Y=o.value-a.value:a.unit===ne&&o.unit===ae?("fontSize"===i?H=o.value*X[i]*.01:"flexBasis"===i&&"row"===G.flexDirection||"width"===i||/margin/.test(i)||/padding/.test(i)||-1<["left","right"].indexOf(i)?H=o.value*X.width*.01:("flexBasis"===i||"height"===i||-1<["top","bottom"].indexOf(i))&&(H=o.value*X.height*.01),Y=H-a.value):a.unit===ae&&o.unit===ne?("fontSize"===i?z=100*o.value/X[i]:"flexBasis"===i&&"row"===G.flexDirection||"width"===i||/margin/.test(i)||/padding/.test(i)||-1<["left","right"].indexOf(i)?z=100*o.value/X.width:("flexBasis"===i||"height"===i||-1<["top","bottom"].indexOf(i))&&(z=100*o.value/X.height),Y=z-a.value):"lineHeight"===i&&(a.unit===ne&&o.unit===ue?Y=o.value*G.fontSize-a.value:a.unit===ue&&o.unit===ne&&(Y=o.value/G.fontSize-a.value)),0===Y||isNaN(Y))return;n.v=Y}else if(St.GEOM.hasOwnProperty(i))if(le(a))n.n=null;else if("points"===i||"controls"===i){if(le(o)||le(a))return a;if(pe(a,o))return;n.v=[];for(var j=0,V=Math.min(a.length,o.length);j<V;j++){var $=a[j],q=o[j];if(le($)||le(q))n.v.push(q);else{for(var U=[],Z=0,K=Math.max($.length,q.length);Z<K;Z++)le($[Z])||le(q[Z])?U.push(q[Z]):U.push(q[Z]-$[Z]);n.v.push(U)}}}else if("controlA"===i||"controlB"===i){if(le(o)||le(a))return a;if(pe(a,o))return;n.v=[o[0]-a[0],o[1]-a[1]]}else{if(o===a)return;n.v=o-a}else if("opacity"===i||"zIndex"===i){if(o===a)return;n.v=o-a}else{if(o===a)return;n.n=a}return n}(i.style,r.style,t,n);e&&i.transition.push(e)}),r}function We(t,g){var e,i,r,n,a,v=_e(t.style),o=(e=t.easing,r=/^\s*(?:cubic-bezier\s*)?\(\s*[\d.]+\s*,\s*[-\d.]+\s*,\s*[\d.]+\s*,\s*[-\d.]+\s*\)\s*$/i.test(e)?(i=e.match(/[\d.]+/g),Jt.cubicBezier(i[0],i[1],i[2],i[3])):(r=/^\s*steps\s*\(\s*(\d+)(?:\s*,\s*(\w+))?\s*\)/i.exec(e))?(n=parseInt(r[1]),a=r[2],function(t){if(n&&0<n){var e=1/n;return("start"===a?Math.ceil(t/e):Math.floor(t/e))/n}return t}):Jt[e]||ye);return o!==ye&&(g=o(g)),t.transition.forEach(function(t){var e=t.k,i=t.v,r=t.n,n=t.d,a=t.p,o=v[e];if(t.hasOwnProperty("n"))v[e]=r;else if("transform"===e){o=o||(v[e]=[["matrix",[1,0,0,1,0,0]]]);for(var s=0;s<6;s++)o[0][1][s]+=i[s]*g}else if("filter"===e)(o=o||(v[e]=[["blur",0]]))[0][1]+=i*g;else if("backgroundPositionX"===e||"backgroundPositionY"===e||ve.hasOwnProperty(e)||Re.hasOwnProperty(e))0!==i&&(o.value+=i*g);else if("transformOrigin"===e||"backgroundSize"===e)0!==i[0]&&(o[0].value+=i[0]*g),0!==i[1]&&(o[1].value+=i[1]*g);else if(Ee.hasOwnProperty(e))if(Te.hasOwnProperty(o.k)){for(var h=0,u=Math.min(o.v.length,i.length);h<u;h++){var l=o.v[h],c=i[h];l[0][0]+=c[0][0]*g,l[0][1]+=c[0][1]*g,l[0][2]+=c[0][2]*g,l[0][3]+=c[0][3]*g,l[1]&&c[1]&&(l[1].value+=c[1]*g)}"linear"===o.k&&void 0!==o.d&&void 0!==n&&(o.d+=n*g),"radial"===o.k&&void 0!==o.p&&void 0!==a&&(o.p[0].value+=a[0]*g,o.p[1].value+=a[1]*g)}else o[0]+=i[0]*g,o[1]+=i[1]*g,o[2]+=i[2]*g,o[3]+=i[3]*g;else if(ge.hasOwnProperty(e))(o=o.value)[0]+=i[0]*g,o[1]+=i[1]*g,o[2]+=i[2]*g,o[3]+=i[3]*g;else if(St.GEOM.hasOwnProperty(e)){var f=v[e];if("points"===e||"controls"===e){for(var d=0,_=Math.min(f.length,i.length);d<_;d++)if(!le(f[d])&&f[d].length)for(var p=0,y=Math.min(f[d].length,i[d].length);p<y;p++)le(f[d][p])||le(i[d][p])||(f[d][p]+=i[d][p]*g)}else"controlA"===e||"controlB"===e?(f[0]+=i[0]*g,f[1]+=i[1]*g):v[e]+=i*g}else"opacity"!==e&&"zIndex"!==e||(v[e]+=i*g)}),v}function Ne(t,e){return ce(t)&&(e=t,t={}),[t||{},e]}["translateX","translateY","scaleX","scaleY","rotateZ","skewX","skewY"].forEach(function(t){Re[t]=!0});var Fe=0,De=function(){e(s,wt);var o=f(s);function s(t,n,e){var i,a;h(this,s),(i=o.call(this)).__id=Fe++,i.__target=t,n=_e(n||[]),Array.isArray(n)?i.__list=n.filter(function(t){return t&&de(t)}):n&&de(n)?(a=[],Object.keys(n).forEach(function(t){var e=n[t];if(Array.isArray(e))for(var i=0,r=e.length;i<r;i++){(a[i]=a[i]||{offset:i/(r-1)})[t]=e[i]}}),i.__list=a):i.__list=[],fe(e)&&(i.__options={duration:e},e=i.__options);var r=i.__options=e||{};return i.__duration=Math.max(0,parseFloat(r.duration)||0),i.delay=r.delay,i.endDelay=r.endDelay,i.iterations=r.iterations,i.fps=r.fps,i.fill=r.fill,i.direction=r.direction,i.playbackRate=r.playbackRate,i.__easing=r.easing,i.playCount=0,i.spfLimit=r.spfLimit,i.__frames=[],i.__framesR=[],i.__startTime=null,i.currentTime=0,i.__nextTime=0,i.__fpsTime=0,i.__playState="idle",i.__isDestroyed=!1,i.__style={},i.__init(),i}return u(s,[{key:"__init",value:function(){var i=this,e=this.iterations,o=this.duration,r=this.list,s=this.easing,t=this.target;if(!(e<1||r.length<1)){for(var n=0,a=r.length;n<a;n++){var h=r[n];h.hasOwnProperty("offset")&&(h.offset=parseFloat(h.offset)||0,h.offset=Math.max(0,h.offset),h.offset=Math.min(1,h.offset),(isNaN(h.offset)||h.offset<0||1<h.offset||h.offset<=-1)&&(r.splice(n,1),n--,a--))}1===r.length&&r.push(r[0]),r.forEach(function(t,e){r[e]=_e(t)});var u=r[0];u.hasOwnProperty("offset")&&0<u.offset?(u={offset:0},r.unshift(u)):u.offset=0;var l=r[r.length-1];l.hasOwnProperty("offset")&&l.offset<1?(l={offset:1},r.push(l)):l.offset=1;for(var c=1,f=r.length;c<f;c++){if(!(y=r[c]).hasOwnProperty("offset")){for(var d=void 0,_=c+1;_<f&&!(d=r[_]).hasOwnProperty("offset");_++);for(var p=_-c+1,y=r[c-1],g=(d.offset-y.offset)/p,v=c;v<_;v++){r[v].offset=y.offset+g*(v+1-c)}c=_}}var m=[];r.forEach(function(t){var e,i,r,n,a;m.push((i=o,r=s,n=(e=t).offset,a=e.easing,delete e.offset,delete e.easing,$.normalize(e),{style:e,time:n*i,easing:a||r,transition:[]}))}),this.__frames=m;var k,b,x,w,A,S,M,E,T=this.__keys=(b=t,x={},w=[],(k=m).forEach(function(t){var i=t.style;Object.keys(i).forEach(function(t){var e=i[t];le(e)||x.hasOwnProperty(t)||(x[t]=!0,w.push(t))})}),k.forEach(function(t){var e=t.style;w.forEach(function(t){e.hasOwnProperty(t)||(St.GEOM.hasOwnProperty(t)?e[t]=b.currentProps[t]:e[t]=b.currentStyle[t])})}),w);A=m,S=T,E=(M=t).computedStyle,A.forEach(function(t){var a=t.style;S.forEach(function(t){var e,i,r,n=a[t];le(n)||("transform"===t?(e=M.outerWidth,i=M.outerHeight,r=we.calMatrix(n,[0,0],e,i),a[t]=[["matrix",r]]):n.unit===oe&&("color"===t?a[t]={value:be.rgba2int(E[t]),unit:se}:ve.hasOwnProperty(t)?a[t]={value:E[t],unit:ne}:"fontWeight"===t?a[t]={value:E[t],unit:ue}:"fontStyle"!==t&&"fontFamily"!==t&&"textAlign"!==t||(a[t]={value:E[t],unit:he})))})});for(var R=m.length,P=m[0],C=1;C<R;C++)P=Oe(P,m[C],T,t);var L=_e(m).reverse();L.forEach(function(t){t.time=o-t.time,t.transition=[]}),P=L[0];for(var O=1;O<R;O++){P=Oe(P,L[O],T,t)}this.__framesR=L,this.__clean=function(t){i.__cancelTask(),i.__nextTime=0,t?(i.__currentTime=i.delay+o+i.endDelay,i.__playCount=e,i.__playState="finished",i.__stayEnd()||(i.__style={})):(i.__playCount=i.__currentTime=0,i.__playState="idle",i.__style={})},this.__fin=function(t){i.__begin=i.__end=i.__isDelay=i.__finish=i.__inFps=i.__enterFrame=null,i.emit(wt.FINISH),ce(t)&&t()},this.__frameCb=function(t,e){i.emit(wt.FRAME,t,e),i.__firstPlay&&(i.__firstPlay=!1,i.emit(wt.PLAY)),ce(i.__playCb)&&(i.__playCb(t,e),i.__playCb=null)}}}},{key:"__calDiffTime",value:function(t){var e=this.playbackRate,i=this.spfLimit,r=this.fps;return this.__currentTime=this.__nextTime,i&&(!0===i?t=Math.min(t,1e3/r):0<i&&(t=Math.min(t,i))),1!==e&&0<e&&(t*=e),this.__nextTime+=t,this.__currentTime}},{key:"play",value:function(t){var x=this,e=this.isDestroyed,w=this.duration,i=this.playState,r=this.__frameCb,n=this.list;if(e||w<=0||n.length<1)return this;if("running"===i)return this;this.__cancelTask(),this.__playCb=t,this.__playState="running";var A,S,M,E,T,R,P,a,C,L,O,W,N=this.__firstPlay=!0;return this.__enterFrame||(A=this.frames,S=this.framesR,M=this.direction,E=this.delay,T=this.endDelay,R=this.keys,P=this.__clean,a=this.__fin,C=this.__stayEnd(),L=this.__stayBegin(),this.__currentTime=this.__nextTime=this.__fpsTime=0,O=A.length,W=this.__enterFrame={before:function(t){var e=x.root,i=x.style,r=x.fps,n=x.playCount,a=x.iterations;if(e){var o,s,h,u,l,c,f=x.__calDiffTime(t);if(!N&&r<60){if((t=x.__fpsTime+=t)<1e3/r)return void(x.__inFps=!0);x.__fpsTime=0}if(N=!1,0<n&&(E=0),f<E)return L&&(h=(s=me(Ce(o=A[0].style,i,R),2))[0],u=s[1],h&&Le(o,x,e,u)),0===f&&(x.__begin=!0),void(x.__isDelay=!0);c="reverse"===M?S:{alternate:!0,"alternate-reverse":!0}.hasOwnProperty(M)?(l=n%2==0,"alternate"===M?l?A:S:l?S:A):A,0===(f-=E)&&(x.__begin=!0);var d,_,p,y,g,v=function t(e,i,r,n){if(e===i)return n[e].time>r?e-1:e;var a=e+(i-e>>1),o=n[a];return o.time===r?a:o.time>r?t(e,Math.max(a-1,e),r,n):t(Math.min(a+1,i),i,r,n)}(0,O-1,f,c),m=c[v],k=v===O-1,b=a-1<=n;k?(p=f<w+T,u=C||!b?(h=(d=me(Ce(m=m.style,i,R),2))[0],d[1]):(h=(_=me(Ce(m={},i,R),2))[0],_[1]),b?p||(x.__nextTime=0,a<=(n=++x.__playCount)&&Gt.__offFrameA(W)):(x.__nextTime=f-w,n=++x.__playCount,x.__nextBegin=!0)):(y=c[v+1].time-m.time,h=(g=me(Ce(m=We(m,(f-m.time)/y),i,R),2))[0],u=g[1]),h&&Le(m,x,e,u),!k||p&&!b||(x.__end=!0,a<=n&&(x.__finish=!0,P(!0)))}},after:function(t){x.__inFps?x.__inFps=!1:(r(t,x.__isDelay),x.__isDelay=!1,x.__begin&&(x.__begin=!1,x.emit(wt.BEGIN,x.playCount)),x.__end&&(x.__end=!1,x.emit(wt.END,x.playCount-1)),x.__finish&&(x.__finish=!1,a()),x.__nextBegin&&(x.__nextBegin=!1,x.__begin=!0))}}),Gt.__onFrameA(this.__enterFrame),this.__startTime=Gt.__now,this}},{key:"pause",value:function(){var t=this.isDestroyed,e=this.duration,i=this.pending;return t||e<=0||i||(this.__playState="paused",this.__cancelTask(),this.emit(wt.PAUSE)),this}},{key:"resume",value:function(t){var e=this.isDestroyed,i=this.duration,r=this.playState;return e||i<=0||"paused"!==r?this:this.play(t)}},{key:"finish",value:function(e){var t=this,i=this,r=i.isDestroyed,n=i.duration,a=i.playState,o=i.list;if(r||n<=0||o.length<1||"finished"===a||"idle"===a)return i;i.__cancelTask();var s,h,u,l,c,f=i.root,d=i.style,_=i.keys,p=i.frames,y=i.__frameCb,g=i.__clean,v=i.__fin;return f&&(l=i.__stayEnd()?(u=(h=me(Ce(s=p[p.length-1].style,d,_),2))[0],h[1]):(u=(c=me(Ce(s={},d,_),2))[0],c[1]),u?Gt.__nextFrameA(this.__enterFrame={before:function(){Le(s,t,f,l),g(!0)},after:function(t){y(t),v(e)}}):(g(!0),v(e))),i}},{key:"cancel",value:function(t){var e=this,i=this.isDestroyed,r=this.duration,n=this.playState,a=this.list;if(i||r<=0||"idle"===n||a.length<1)return this;this.__cancelTask();var o,s,h,u,l=this.root,c=this.style,f=this.keys,d=this.__frameCb,_=this.__clean;return l&&(s=(o=me(Ce({},c,f),2))[0],h=o[1],u=function(){e.__cancelTask(),e.__begin=e.__end=e.__isDelay=e.__finish=e.__inFps=e.__enterFrame=null,e.emit(wt.CANCEL),ce(t)&&t()},s?Gt.__nextFrameA(this.__enterFrame={before:function(){Le({},e,l,h),_()},after:function(t){d(t),u()}}):(_(),u())),this}},{key:"gotoAndPlay",value:function(t,e,i){var r=this.isDestroyed,n=this.duration,a=this.delay,o=this.endDelay;if(r||n<=0)return this;var s=me(Ne(e,i),2);return e=s[0],i=s[1],this.__goto(t,e.isFrame,e.excludeDelay),n+a+o<t?this.finish(i):this.play(i)}},{key:"gotoAndStop",value:function(t,e,i){var r=this,n=this.isDestroyed,a=this.duration,o=this.delay,s=this.endDelay;if(n||a<=0)return this;var h=me(Ne(e,i),2);return e=h[0],i=h[1],a+o+s<(t=this.__goto(t,e.isFrame,e.excludeDelay))?this.finish(i):this.play(function(t){r.__playState="paused",r.__cancelTask(),ce(i)&&i(t)})}},{key:"__goto",value:function(t,e,i){var r=this.duration,n=this.iterations,a=this.delay;if(this.__playState="paused",this.__cancelTask(),isNaN(t)||t<0)throw new Error("Param of gotoAnd(Play/Stop) is illegal: "+t);for(e&&(t=(t-1)/this.spf),i&&(t+=a);r<t&&this.playCount<n-1;)this.__playCount++,t-=r;return this.__nextTime=t}},{key:"addControl",value:function(){var t=this.root.animateController;t&&t.add(this)}},{key:"removeControl",value:function(){var t=this.root.animateController;t&&t.remove(this)}},{key:"__stayBegin",value:function(){return{backwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__stayEnd",value:function(){return{forwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__cancelTask",value:function(){Gt.__offFrameA(this.__enterFrame),this.__playCb=null}},{key:"__destroy",value:function(){this.__clean&&this.__clean(),this.__startTime=null,this.__isDestroyed=!0,this.removeControl()}},{key:"id",get:function(){return this.__id}},{key:"target",get:function(){return this.__target}},{key:"root",get:function(){return this.target.root}},{key:"keys",get:function(){return this.__keys}},{key:"style",get:function(){return this.__style}},{key:"props",get:function(){return this.__props}},{key:"list",get:function(){return this.__list}},{key:"options",get:function(){return this.__options}},{key:"duration",get:function(){return this.__duration},set:function(t){this.__duration=Math.max(0,parseFloat(t)||0)}},{key:"delay",get:function(){return this.__delay},set:function(t){this.__delay=Math.max(0,parseFloat(t)||0)}},{key:"endDelay",get:function(){return this.__endDelay},set:function(t){this.__endDelay=Math.max(0,parseFloat(t)||0)}},{key:"fps",get:function(){return this.__fps},set:function(t){(t=parseInt(t)||60)<=0&&(t=60),this.__fps=t}},{key:"spf",get:function(){return 1/this.fps}},{key:"iterations",get:function(){return this.__iterations},set:function(t){t===1/0||be.isString(t)&&"infinity"===t.toLowerCase()?t=1/0:(t=parseInt(t),(isNaN(t)||t<0)&&(t=1)),this.__iterations=t}},{key:"fill",get:function(){return this.__fill},set:function(t){this.__fill=t||"none"}},{key:"direction",get:function(){return this.__direction},set:function(t){this.__direction=t||"normal"}},{key:"frames",get:function(){return this.__frames}},{key:"framesR",get:function(){return this.__framesR}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(t){(t=parseFloat(t)||1)<=0&&(t=1),this.__playbackRate=t}},{key:"easing",get:function(){return this.__easing}},{key:"startTime",get:function(){return this.__startTime}},{key:"currentTime",get:function(){return this.__currentTime},set:function(t){0<=(t=parseFloat(t)||0)&&(this.__currentTime=this.__nextTime=t)}},{key:"pending",get:function(){return"running"!==this.playState}},{key:"finished",get:function(){return"finished"===this.playState}},{key:"playState",get:function(){return this.__playState}},{key:"playCount",get:function(){return this.__playCount},set:function(t){this.__playCount=Math.max(0,parseInt(t)||0)}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"animating",get:function(){var t=this.playState;return"idle"!==t&&("finished"!==t||this.__stayEnd())}},{key:"spfLimit",get:function(){return this.__spfLimit},set:function(t){be.isNumber(t)||/^\d/.test(t)?this.__spfLimit=Math.max(t,parseInt(t)||0):this.__spfLimit=!!t}}]),s}(),Ie=s.AUTO,Be=s.PX,He=s.PERCENT,ze=s.STRING,Ge=be.clone,Xe=be.int2rgba,Ye=be.equalArr,je=be.extend,Ve=be.joinArr,$e=$.calRelative,qe=$.compute,Ue=$.repaint;function Ze(t,e,r,n,i){var a;r=Xe(r),t===xe.CANVAS?e.forEach(function(t){n.beginPath(),n.fillStyle=r,n.moveTo(t[0],t[1]);for(var e=2,i=t.length;e<i;e+=2)n.lineTo(t[e],t[e+1]);n.fill(),n.closePath()}):t===xe.SVG&&(a="",e.forEach(function(t){a+="M ".concat(t[0]," ").concat(t[1]);for(var e=2,i=t.length;e<i;e+=2)a+="L ".concat(t[e]," ").concat(t[e+1]," ")}),i.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",a],["fill",r]]}))}function Ke(t,e,i,r,n,a,o,s,h,u,l,c){var f=Ae.calRadius(i,r,n,a,h,u,l,c),d=f?Ae.genRdRect(t,o,e,i,r,n,a,f):null;t===xe.CANVAS?f||(o.beginPath(),o.fillStyle=e,o.rect(i,r,n,a),o.fill(),o.closePath()):t===xe.SVG&&s.virtualDom.bb.push(d||{type:"item",tagName:"rect",props:[["x",i],["y",r],["width",n],["height",a],["fill",e]]})}function Qe(t,e,i){return t.unit===Be?t.value:t.unit===He?(e-i)*t.value*.01:0}function Je(t,e){var i=[];return function e(i,r,t,n){if(Array.isArray(t))t.forEach(function(t){e(i,r,t,n)});else if(t instanceof ti){if(-1<["canvas","svg"].indexOf(t.tagName))throw new Error("Can not nest canvas/svg");r.push(t),t.__parent=i,n.lastText=null,n.prev&&((n.prev.__next=t).__prev=n.prev),n.prev=t}else{var a;t instanceof Ct?(r.push(t),t.__parent=i,n.lastText=null,n.prev&&((n.prev.__next=t).__prev=n.prev),t.__init(),n.prev=t):be.isNil(t)||""===t||(n.lastText?n.lastText.content+=t:(a=n.lastText=new U(t),r.push(a),a.__parent=i,n.prev&&((n.prev.__next=a).__prev=n.prev),n.prev=a))}}(t,i,e,{lastText:null,prev:null}),i}var ti=function(){e(d,x);var r=f(d);function d(t){var n,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return h(this,d),n=r.call(this),Array.isArray(e)?(n.props=be.arr2hash(e),n.__props=e):(n.props=e,n.__props=be.hash2arr(e)),n.__tagName=t,n.__style=Ge(n.props.style)||{},n.__currentStyle=n.__style,n.__listener={},n.__props.forEach(function(t){var e,i=t[0],r=t[1];/^on[a-zA-Z]/.test(i)&&(i=i.slice(2).toLowerCase(),-1===(e=n.__listener[i]=n.__listener[i]||[]).indexOf(r)&&e.push(r))}),n.__children=Je(l(n),i),n.__matrix=null,n.__matrixEvent=null,n.__animationList=[],n.__loadBgi={cb:function(){}},n}return u(d,[{key:"__mp",value:function(r,n,a){var o=this;["Top","Right","Bottom","Left"].forEach(function(t){var e="margin"+t,i="padding"+t;n[e]=o.__mpWidth(r[e],a),n[i]=o.__mpWidth(r[i],a)})}},{key:"__mpWidth",value:function(t,e){return t.unit===Be?t.value:t.unit===He?t.value*e*.01:0}},{key:"__layout",value:function(t,e,i){var r,n,a,o,s,h,u,l,c,f=t.w,d=this.isDestroyed,_=this.currentStyle,p=this.computedStyle,y=_.display,g=_.width,v=_.position;if(d||"none"===y)p.width=p.height=0;else{if(i||this.__mp(_,p,f),g.unit!==Ie)switch(g.unit){case Be:f=g.value;break;case He:f*=.01*g.value}this.__ox=this.__oy=0,"block"===y?this.__layoutBlock(t,e):"flex"===y?this.__layoutFlex(t,e):"inline"===y&&this.__layoutInline(t,e),"relative"===v?(r=_.top,n=_.right,a=_.bottom,o=_.left,s=this.parent,r.unit!==Ie?(h=$e(_,"top",r,s),this.__offsetY(h),p.top=h,p.bottom="auto"):a.unit!==Ie?(u=$e(_,"bottom",a,s),this.__offsetY(-u),p.bottom=u,p.top="auto"):p.top=p.bottom="auto",o.unit!==Ie?(l=$e(_,"left",o,s,!0),this.__offsetX(l),p.left=l,p.right="auto"):n.unit!==Ie?(c=$e(_,"right",n,s,!0),this.__offsetX(-c),p.right=c,p.left="auto"):p.left=p.right="auto"):"absolute"!==_.position&&(p.top=p.bottom=p.left=p.right="auto"),p.width=this.width,p.height=this.height;var m,k=this.__animateRecords;k&&(this.__animateRecords=null,(m=this.root.animateController).__records=m.records.concat(k))}}},{key:"__preLayout",value:function(t){var e=t.x,i=t.y,r=t.w,n=t.h,a=t.w2,o=t.h2;this.__x=e,this.__y=i;var s,h,u=this.currentStyle,l=this.computedStyle,c=u.width,f=u.height,d=l.borderTopWidth,_=l.borderRightWidth,p=l.borderBottomWidth,y=l.borderLeftWidth,g=l.marginTop,v=l.marginRight,m=l.marginBottom,k=l.marginLeft,b=l.paddingTop,x=l.paddingRight,w=l.paddingBottom,A=l.paddingLeft;if(void 0!==a)s=!0,r=a;else if(c.unit!==Ie)switch(s=!0,c.unit){case Be:r=c.value;break;case He:r*=.01*c.value}if(void 0!==o)h=!0,n=o;else if(f.unit!==Ie)switch(h=!0,f.unit){case Be:n=f.value;break;case He:n*=.01*f.value}return e+=y+k+A,t.x=e,i+=d+g+b,t.y=i,c.unit===Ie&&(r-=y+_+k+v+A+x),f.unit===Ie&&(n-=d+p+g+m+b+w),{fixedWidth:s,fixedHeight:h,x:e,y:i,w:r,h:n}}},{key:"__marginAuto",value:function(t,e){var i,r=t.position,n=t.marginLeft,a=t.marginRight,o=t.width;"absolute"===r||o===Ie||n.unit!==Ie||a.unit!==Ie||(i=this.outerWidth)<e.w&&this.__offsetX(.5*(e.w-i),!0)}},{key:"render",value:function(o,t,s,e){var h=this;o===xe.SVG&&(this.__virtualDom={bb:[],children:[],opacity:1});var i=this.isDestroyed,u=this.currentStyle,l=this.computedStyle,c=this.width,f=this.height,r=this.innerWidth,n=this.innerHeight,d=this.outerWidth,_=this.outerHeight;["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){var e,i,r,n,a,o;e=c,i=f,r="border".concat(t,"Radius"),n=l,(o=u[r]).unit===Be&&0<o.value?(a=Math.min(.5*e,.5*i),n[r]=Math.min(a,o.value)):n[r]=0});for(var a=l.display,p=l.marginTop,y=l.marginLeft,g=l.paddingTop,v=l.paddingRight,m=l.paddingBottom,k=l.paddingLeft,b=l.backgroundColor,x=l.borderTopWidth,w=l.borderTopColor,A=l.borderTopStyle,S=l.borderRightWidth,M=l.borderRightColor,E=l.borderRightStyle,T=l.borderBottomWidth,R=l.borderBottomColor,P=l.borderBottomStyle,C=l.borderLeftWidth,L=l.borderLeftColor,O=l.borderLeftStyle,W=l.borderTopLeftRadius,N=l.borderTopRightRadius,F=l.borderBottomRightRadius,D=l.borderBottomLeftRadius,I=l.visibility,B=l.backgroundRepeat,H=l.backgroundImage,z=l.opacity,G=l.filter,X=u.backgroundSize,Y=u.backgroundPositionX,j=u.backgroundPositionY,V=u.transform,$=u.transformOrigin,q=this.sx,U=this.sy,Z=q+y,K=Z+C,Q=K+c+k+v,J=Q+S,tt=U+p,et=tt+x,it=et+f+g+m,rt=it+T,nt=this.parent,at=z;nt;)at*=nt.computedStyle.opacity,nt=nt.parent;o===xe.CANVAS?t.globalAlpha=at:this.__virtualDom.opacity=z;var ot=we.calOrigin($,d,_);l.transformOrigin=ot.slice(0),ot[0]+=q,ot[1]+=U;var st=[1,0,0,1,0,0];if(this.__matrix=st,!i&&"none"!==a){var ht,ut,lt,ct,ft,dt,_t,pt,yt,gt,vt,mt,kt,bt,xt,wt,nt=this.parent;for(V?(st=we.calMatrix(V,ot,d,_),this.__matrix=st):(ht=[],["translateX","translateY","rotateZ","rotate","skewX","skewY","scaleX","scaleY"].forEach(function(t){var e,i=u[t];be.isNil(i)||(l[t]=i.value,e=-1<t.indexOf("scale"),1===i.value&&e||!e&&0===i.value||(i.unit===He&&("translateX"===t?l[t]=i.value*d*.01:"translateY"===t&&(l[t]=i.value*_*.01)),ht.push([t,i])))}),ht.length&&(st=we.calMatrix(ht,ot,d,_),this.__matrix=st)),l.transform=st;nt;){if(nt.matrixEvent){st=we.mergeMatrix(nt.matrixEvent,st);break}nt=nt.parent}if(this.__matrixEvent=st,o===xe.CANVAS?t.setTransform.apply(t,ke(st)):o===xe.SVG&&(Ye(this.matrix,[1,0,0,1,0,0])||(this.virtualDom.transform="matrix(".concat(Ve(this.matrix,","),")"))),l.backgroundPositionX=Y.unit===Be?Y.value:Y.value*r,l.backgroundPositionY=j.unit===Be?j.value:j.value*r,ut=r,lt=n,ct=[],X.forEach(function(t,e){t.unit===Be?ct.push(t.value):t.unit===He?ct.push(t.value*(e?lt:ut)*.01):t.unit===Ie?ct.push(-1):t.unit===ze&&ct.push("contain"===t.value?-2:-3)}),X=ct,l.backgroundSize=X,"hidden"===I||e)l.visibility="hidden";else{if(0<b[3]&&Ke(o,Xe(b),K,et,r,n,t,this,W,N,F,D),H){var At,St=this.__loadBgi;if(be.isString(H)){var Mt=Me.IMG[H];if(Mt&&Mt.state===Me.LOADED&&(St.url=H,St.source=Mt.source,St.width=Mt.width,St.height=Mt.height),St.url===H){var Et=St.source;if(Et){var Tt=St.width,Rt=St.height,Pt=me(X,2),Ct=Pt[0],Lt=Pt[1];-1===Ct&&-1===Lt?(Ct=Tt,Lt=Rt):-2===Ct?r<Tt&&n<Rt?(Lt=Rt/n)<=(Ct=Tt/r)?Lt=(Ct=r)*Rt/Tt:Ct=(Lt=n)*Tt/Rt:r<Tt?Lt=(Ct=r)*Rt/Tt:n<Rt?Ct=(Lt=n)*Tt/Rt:(Ct=Tt,Lt=Rt):-3===Ct?Tt<r&&Rt<n?(Ct=Tt/r)<=(Lt=Rt/n)?Lt=(Ct=r)*Rt/Tt:Ct=(Lt=n)*Tt/Rt:Tt<r||!(Rt<n)&&(Ct=Tt/r)<=(Lt=Rt/n)?Lt=(Ct=r)*Rt/Tt:Ct=(Lt=n)*Tt/Rt:-1===Ct?Ct=Lt*Tt/Rt:-1===Lt&&(Lt=Ct*Rt/Tt);var Ot,Wt,Nt=K+Qe(Y,r,Ct),Ft=et+Qe(j,n,Lt),Dt=Nt<K||Ft<et||r<Ct||n<Lt,It=0,Bt=0,Ht=0,zt=0;-1<["repeat-x","repeat"].indexOf(B)&&(0<(Ot=Nt-K)&&(It=Math.ceil(Ot/Ct)),0<(Ot=K+r-Nt-Ct)&&(Bt=Math.ceil(Ot/Ct))),-1<["repeat-y","repeat"].indexOf(B)&&(0<(Wt=Ft-et)&&(Ht=Math.ceil(Wt/Lt)),0<(Wt=et+n-Ft-Lt)&&(zt=Math.ceil(Wt/Lt)));var Gt,Xt,Yt,jt,Vt,$t,qt,Ut,Zt,Kt,Qt,Jt,te=[];if(0<It)for(var ee=0;ee<It;ee++){var ie=Nt-(ee+1)*Ct;te.push([ie,Ft]),!Dt&&0===ee&&ie<K&&(Dt=!0)}if(0<Bt)for(var re=0;re<Bt;re++){var ne=Nt+(re+1)*Ct;te.push([ne,Ft]),!Dt&&re===Bt-1&&K+r<ne+Ct&&(Dt=!0)}if(0<Ht)for(var ae=0;ae<Ht;ae++){var oe=Ft-(ae+1)*Lt;te.push([Nt,oe]),!Dt&&0===ae&&oe<et&&(Dt=!0)}if(0<zt)for(var se=0;se<zt;se++){var he=Ft+(se+1)*Lt;te.push([Nt,he]),!Dt&&se===zt-1&&et+n<he+Ct&&(Dt=!0)}if(0<It&&0<Ht)for(var ue=0;ue<It;ue++)for(var le=0;le<Ht;le++)te.push([Nt-(ue+1)*Ct,Ft-(le+1)*Lt]);if(0<Bt&&0<Ht)for(var ce=0;ce<Bt;ce++)for(var fe=0;fe<Ht;fe++)te.push([Nt+(ce+1)*Ct,Ft-(fe+1)*Lt]);if(0<It&&0<zt)for(var de=0;de<It;de++)for(var _e=0;_e<zt;_e++)te.push([Nt-(de+1)*Ct,Ft+(_e+1)*Lt]);if(0<Bt&&0<zt)for(var pe=0;pe<Bt;pe++)for(var ye=0;ye<zt;ye++)te.push([Nt+(pe+1)*Ct,Ft+(ye+1)*Lt]);if(!Dt&&te.length)for(var ge=0,ve=te.length;ge<ve;ge++);o===xe.CANVAS?(Dt?(Xt=(Gt=this.root).width,Yt=Gt.height,jt=Me.getCacheCanvas(Xt,Yt),(Vt=jt.ctx).setTransform.apply(Vt,ke(st))):Vt=t,Vt.drawImage(Et,Nt,Ft,Ct,Lt),te.forEach(function(t){Vt.drawImage(Et,t[0],t[1],Ct,Lt)}),Dt&&(Vt.globalCompositeOperation="destination-in",Ke(o,"#FFF",K,et,r,n,Vt,this,W,N,F,D),t.setTransform(1,0,0,1,0,0),t.drawImage(jt.canvas,0,0),t.setTransform.apply(t,ke(st)),Vt.globalCompositeOperation="source-over",qt=($t=this.root).width,Ut=$t.height,Vt.setTransform(1,0,0,1,0,0),Vt.clearRect(0,0,qt,Ut))):o===xe.SVG&&(Zt=Se.matrixResize(Tt,Rt,Ct,Lt,Nt,Ft,r,n),Kt=[["xlink:href",H],["x",Nt],["y",Ft],["width",Tt],["height",Rt]],Zt&&!Ye(Zt,[1,0,0,1,0,0])&&(Qt=!0,Kt.push(["transform","matrix("+Ve(Zt,",")+")"])),Dt&&(Jt=s.add({tagName:"mask",props:[],children:[{tagName:"rect",props:[["x",K],["y",et],["width",r],["height",n],["fill","#FFF"]]}]}),this.virtualDom.bbMask="url(#".concat(Jt,")")),this.virtualDom.bb.push({type:"img",tagName:"image",props:Kt}),te.forEach(function(t){var e,i=Ge(Kt);!Qt||(e=Se.matrixResize(Tt,Rt,Ct,Lt,t[0],t[1],r,n))&&!Ye(e,[1,0,0,1,0,0])&&(i[5][1]="matrix("+Ve(e,",")+")"),i[1][1]=t[0],i[2][1]=t[1],h.virtualDom.bb.push({type:"img",tagName:"image",props:i})}))}}else St.url=H,St.source=null,Me.measureImg(H,function(t){t.success&&t.url===St.url&&!h.__isDestroyed&&(St.source=t.source,St.width=t.width,St.height=t.height,h.root.delRefreshTask(St.cb),h.root.addRefreshTask(St.cb))},{width:r,height:n})}else{H.k&&(At=this.__gradient(o,t,s,K,et,Q,it,r,n,H),Ke(o,At,K,et,r,n,t,this))}}0<x&&0<w[3]&&(ft=Math.atan(x/C),dt=Math.atan(x/S),_t=Ae.calPoints(x,A,ft,dt,Z,K,Q,J,tt,et,it,rt,0),Ze(o,_t,w,t,this)),0<S&&0<M[3]&&(pt=Math.atan(S/x),yt=Math.atan(S/T),gt=Ae.calPoints(S,E,pt,yt,Z,K,Q,J,tt,et,it,rt,1),Ze(o,gt,M,t,this)),0<T&&0<R[3]&&(vt=Math.atan(T/C),mt=Math.atan(T/S),kt=Ae.calPoints(T,P,vt,mt,Z,K,Q,J,tt,et,it,rt,2),Ze(o,kt,R,t,this)),0<C&&0<L[3]&&(bt=Math.atan(C/x),xt=Math.atan(C/T),wt=Ae.calPoints(C,O,bt,xt,Z,K,Q,J,tt,et,it,rt,3),Ze(o,wt,L,t,this)),G&&G.forEach(function(t){var e,i,r=me(t,2),n=r[0],a=r[1];"blur"===n&&0<a&&o===xe.SVG&&(e=Math.floor(3*a*Math.sqrt(2*Math.PI)/4+.5),(e*=3)%2==0&&e++,i=s.add({tagName:"filter",props:[["x",-e/d],["y",-e/_],["width",1+2*e/d],["height",1+2*e/_]],children:[{tagName:"feGaussianBlur",props:[["stdDeviation",a]]}]}),h.virtualDom.filter="url(#".concat(i,")"))})}}}},{key:"__renderByMask",value:function(e,t,i,r){var n=this.prev,a=this.root;if(n&&n.isMask&&!r)if(e===xe.CANVAS){var o=a.width,s=a.height,h=Me.getCacheCanvas(o,s);this.render(e,h.ctx);for(var u,l=[];n&&n.isMask;)l.unshift(n),n=n.prev;1===l.length?(n=l[0],h.ctx.globalCompositeOperation="destination-in",n.render(e,h.ctx),h.draw(h.ctx),t.drawImage(h.canvas,0,0),h.draw(t)):(u=Me.getMaskCanvas(o,s),l.forEach(function(t){t.render(e,u.ctx)}),u.draw(u.ctx),h.ctx.globalCompositeOperation="destination-in",h.ctx.drawImage(u.canvas,0,0),h.draw(h.ctx),t.drawImage(h.canvas,0,0),h.draw(t),u.ctx.globalCompositeOperation="source-over",u.ctx.clearRect(0,0,o,s),u.draw(u.ctx)),h.ctx.globalCompositeOperation="source-over",h.ctx.clearRect(0,0,o,s),h.draw(h.ctx)}else e===xe.SVG&&(this.render(e,t,i),this.virtualDom.mask=n.maskId);else this.render(e,t,i,r)}},{key:"__destroy",value:function(){var t,e=this.props.ref;!e||(t=this.host||this.root)&&t.ref[e]&&delete t.ref[e],this.animationList.forEach(function(t){return t.__destroy()}),this.root.delRefreshTask(this.__loadBgi.cb),Q(K(d.prototype),"__destroy",this).call(this),this.__matrix=this.__matrixEvent=null}},{key:"__emitEvent",value:function(e,t){var i,r,n=e.event.type,a=this.isDestroyed,o=this.listener,s=(this.children,this.computedStyle);if(!a&&"none"!==s.display&&!e.__stopPropagation){o.hasOwnProperty(n)&&(i=o[n]);var h=this.zIndexChildren;if(t){if(!this.isGeom)for(var u=h.length-1;0<=u;u--){var l=h[u];(l instanceof d||l instanceof Ct&&l.shadowRoot instanceof d)&&l.__emitEvent(e,t)&&(r=!0)}if(!r&&this.root.__touchstartTarget!==this)return;if(e.__stopPropagation)return;return-1<["touchmove","touchend","touchcancel"].indexOf(n)&&(e.target=this.root.__touchstartTarget),i&&i.forEach(function(t){e.__stopImmediatePropagation||t(e)}),!0}if(!this.isGeom)for(var c=h.length-1;0<=c;c--){var f=h[c];(f instanceof d||f instanceof Ct&&f.shadowRoot instanceof d)&&f.__emitEvent(e)&&(r=!0)}if(!e.__stopPropagation)return r||this.willResponseEvent(e)?(e.__hasEmitted=!0,i&&i.forEach(function(t){e.__stopImmediatePropagation||be.isFunction(t)&&t(e)}),!0):void 0}}},{key:"willResponseEvent",value:function(t){var e=t.x,i=t.y;if(!t.__hasEmitted){var r=this.sx,n=this.sy,a=this.outerWidth,o=this.outerHeight,s=this.matrixEvent;return we.pointInQuadrilateral(e,i,r,n,r+a,n,r+a,n+o,r,n+o,s)?(t.target||(t.target=this,"touchstart"===t.event.type&&(this.root.__touchstartTarget=this)),!0):void 0}}},{key:"__gradient",value:function(t,e,i,r,n,a,o,s,h,u){var l,c,f,d=u.k,_=u.v,p=u.d,y=u.s,g=u.z,v=u.p,m=r+.5*s,k=n+.5*h;return"linear"===d?(l=T.getLinear(_,p,m,k,s,h),c=this.__getLg(t,e,i,l)):"radial"===d&&(f=T.getRadial(_,y,g,v,r,n,a,o),c=this.__getRg(t,e,i,f)),c}},{key:"__getLg",value:function(t,e,i,r){if(t===xe.CANVAS){var n=e.createLinearGradient(r.x1,r.y1,r.x2,r.y2);return r.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===xe.SVG){var a=i.add({tagName:"linearGradient",props:[["x1",r.x1],["y1",r.y1],["x2",r.x2],["y2",r.y2]],children:r.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})});return"url(#".concat(a,")")}}},{key:"__getRg",value:function(t,e,i,r){if(t===xe.CANVAS){var n=e.createRadialGradient(r.cx,r.cy,0,r.cx,r.cy,r.r);return r.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===xe.SVG){var a=i.add({tagName:"radialGradient",props:[["cx",r.cx],["cy",r.cy],["r",r.r]],children:r.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})});return"url(#".concat(a,")")}}},{key:"animate",value:function(t,e,i){if(!this.isDestroyed){var r=new De(this,t,e);return this.animationList.push(r),i&&this.root.animateController.add(r),e.hasOwnProperty("autoPlay")&&!e.autoPlay?r:r.play()}}},{key:"removeAnimate",value:function(t){var e;t instanceof De&&(-1<(e=this.animationList.indexOf(t))&&(t.cancel(),t.__destroy(),this.animationList.splice(e,1)))}},{key:"clearAnimate",value:function(){this.animationList.splice(0).forEach(function(t){t.cancel(),t.__destroy()})}},{key:"__initRef",value:function(e){var t=this.props.ref;be.isString(t)?e.ref[t]=this:be.isFunction(t)&&t(e),this.children.forEach(function(t){(t instanceof d||t instanceof Ct)&&t.__initRef(e)})}},{key:"__measure",value:function(e,i,t){qe(this,t),this.children.forEach(function(t){t.__measure(e,i)})}},{key:"__repaint",value:function(t){Ue(this,t),this.children.forEach(function(t){(t instanceof d||t instanceof Ct)&&t.__repaint()})}},{key:"tagName",get:function(){return this.__tagName}},{key:"children",get:function(){return this.__children}},{key:"root",get:function(){return this.host?this.host.root:this.parent?this.parent.root:-1<["canvas","svg"].indexOf(this.tagName)?this:void 0}},{key:"host",get:function(){return this.__host?this.__host:this.parent?this.parent.host:void 0}},{key:"isGeom",get:function(){return"$"===this.tagName.charAt(0)}},{key:"innerWidth",get:function(){var t=this.computedStyle,e=t.display,i=t.paddingRight,r=t.paddingLeft;return"none"===e?0:this.width+r+i}},{key:"innerHeight",get:function(){var t=this.computedStyle,e=t.display,i=t.paddingTop,r=t.paddingBottom;return"none"===e?0:this.height+i+r}},{key:"outerWidth",get:function(){var t=this.computedStyle,e=t.display,i=t.borderLeftWidth,r=t.borderRightWidth,n=t.marginRight,a=t.marginLeft;return"none"===e?0:this.innerWidth+i+r+a+n}},{key:"outerHeight",get:function(){var t=this.computedStyle,e=t.display,i=t.borderTopWidth,r=t.borderBottomWidth,n=t.marginTop,a=t.marginBottom;return"none"===e?0:this.innerHeight+i+r+n+a}},{key:"listener",get:function(){return this.__listener}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixEvent",get:function(){return this.__matrixEvent}},{key:"style",get:function(){return this.__style}},{key:"computedStyle",get:function(){return this.__computedStyle}},{key:"animationList",get:function(){return this.__animationList}},{key:"animateStyle",get:function(){var e,i=this,r=this.style;return this.animationList.forEach(function(t){t.animating&&(e=e||je({},r,i.isGeom?nt.domKey.concat(nt.geomKey):nt.domKey),je(e,t.style))}),e||r}},{key:"currentStyle",get:function(){return this.__currentStyle}}]),d}(),ei=function(){function i(t,e){h(this,i),this.__list=[],this.__x=t,this.__y=e,this.__baseLine=0}return u(i,[{key:"add",value:function(t){this.list.push(t)}},{key:"__calBaseLine",value:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.baseLine)}),e}},{key:"verticalAlign",value:function(){var i=this.__baseLine=this.__calBaseLine();1<this.list.length&&this.list.forEach(function(t){var e=t.baseLine;e!==i&&t.__offsetY(i-e)})}},{key:"horizonAlign",value:function(e){this.list.forEach(function(t){t.__offsetX(e)})}},{key:"list",get:function(){return this.__list}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){var e=0;return this.list.forEach(function(t){e+=t.width}),e}},{key:"height",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.height)}),e}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"size",get:function(){return this.__list.length}}]),i}();function ii(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function ri(t,e){return!Array.isArray(t)||t.length<2||(e=e||function(){},function t(e,i,r,n){if(!(r<=i)){for(var a=i,o=r,s=a,h=e[s],u=!0;a<o;)if(u){for(;a<o;o--)if(n.call(e,h,e[o])){ii(e,s,o),s=o,u=!u,a++;break}}else for(;a<o;a++)if(n.call(e,e[a],h)){ii(e,s,a),s=a,u=!u,o--;break}t(e,i,s-1,n),t(e,s+1,r,n)}}(t,0,t.length-1,e)),t}var ni=s.AUTO,ai=s.PX,oi=s.PERCENT,si=$.calAbsolute,hi={div:!0,span:!0,img:!0},ui={span:!0,img:!0};function li(t){return-1<["relative","absolute"].indexOf(t.computedStyle.position)}var ci,fi=function(){e(c,ti);var a=f(c);function c(t,e,i){var r;h(this,c),(r=a.call(this,t,e,i)).__lineGroups=[];var n=l(r).style;return n.display&&{flex:!0,block:!0,inline:!0,none:!0}.hasOwnProperty(n.display)||(ui.hasOwnProperty(r.tagName)?n.display="inline":n.display="block"),$.normalize(n,nt.dom),r}return u(c,[{key:"__tryLayInline",value:function(t,e){var i=this.flowChildren,r=this.currentStyle.width;if(r.unit===ai)return t-r.value;if(r.unit===oi)return t-e*r.value*.01;for(var n=0;n<i.length;n++){if(t<0)return t;var a=i[n];t-=a instanceof ti||a instanceof Ct?a.__tryLayInline(t,e):a.textWidth}return t}},{key:"__offsetX",value:function(e,i){Q(K(c.prototype),"__offsetX",this).call(this,e,i),this.flowChildren.forEach(function(t){t&&t.__offsetX(e,i)})}},{key:"__offsetY",value:function(e,i){Q(K(c.prototype),"__offsetY",this).call(this,e,i),this.flowChildren.forEach(function(t){t&&t.__offsetY(e,i)})}},{key:"__calAutoBasis",value:function(a,o,s,t){var e,i,h=0,u=0,l=0,r=this.flowChildren,n=this.currentStyle,c=this.computedStyle,f=n.width,d=n.height,_=n.marginLeft,p=n.marginTop,y=n.marginRight,g=n.marginBottom,v=n.paddingLeft,m=n.paddingTop,k=n.paddingRight,b=n.paddingBottom,x=c.borderTopWidth,w=c.borderRightWidth,A=c.borderBottomWidth,S=c.borderLeftWidth,M=a?f:d;return M.unit===ai&&(h=l=M.value,t&&(u=h)),r.forEach(function(t){var e,i,r,n;l=t instanceof ti||t instanceof Ct&&t.shadowRoot instanceof ti?(i=(e=t.__calAutoBasis(a,o,s,!0)).b,r=e.min,n=e.max,h=Math.max(h,i),u=Math.max(u,r),Math.max(l,n)):a?(u=Math.max(t.charWidth,u),Math.max(t.textWidth,l)):(t.__layout({x:0,y:0,w:o,h:s},!0),u=Math.max(u,t.height),Math.max(l,t.height))}),a?(e=w+S+(this.__calMp(_,o)+this.__calMp(y,o)+this.__calMp(v,o)+this.__calMp(k,o)),h+=e,l+=e,u+=e):(i=x+A+(this.__calMp(p,o)+this.__calMp(g,o)+this.__calMp(m,o)+this.__calMp(b,o)),h+=i,l+=i,u+=i),{b:h,min:u,max:l}}},{key:"__calMp",value:function(t,e){var i=0;return t.unit===ai?i+=t.value:t.unit===oi&&(t.value*=.01*e,t.unit=ai,i+=t.value),i}},{key:"__layoutBlock",value:function(e,i){var t=this.flowChildren,r=this.currentStyle,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o,s,h,u=n.textAlign,l=this.__preLayout(e),c=l.fixedWidth,f=l.fixedHeight,d=l.x,_=l.y,p=l.w,y=l.h;c&&i?this.__width=p:(s=o=0,h=new ei(d,_),t.forEach(function(t){t instanceof ti||t instanceof Ct&&t.shadowRoot instanceof ti?"inline"===t.currentStyle.display?d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:y},i),d+=t.outerWidth,i&&(o=Math.max(o,s),s=t.outerWidth)):(0<=t.__tryLayInline(p-d+e.x,p)?t.__layout({x:d,y:_,w:p,h:y},i):(a.push(h),i||h.verticalAlign(),d=e.x,_+=h.height,t.__layout({x:e.x,y:_,w:p,h:y},i),h=new ei(d,_),i&&(o=Math.max(o,s),s=0)),d+=t.outerWidth,h.add(t),i&&(s+=t.outerWidth)):(h.size&&(a.push(h),h.verticalAlign(),_+=h.height,h=new ei(e.x,_),i&&(o=Math.max(o,s),s=0)),t.__layout({x:e.x,y:_,w:p,h:y},i),d=e.x,_+=t.outerHeight,i&&(o=Math.max(o,t.outerWidth),s=0)):d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:y},i),d+=t.width,i&&(o=Math.max(o,s),s=t.width)):(0<=t.__tryLayInline(p-d+e.x)?t.__layout({x:d,y:_,w:p,h:y},i):(a.push(h),h.verticalAlign(),d=e.x,_+=h.height,t.__layout({x:e.x,y:_,w:p,h:y},i),h=new ei(d,_),i&&(o=Math.max(o,s),s=0)),d+=t.width,h.add(t),i&&(s+=t.width))}),h.size&&(a.push(h),i?o=Math.max(o,s):h.verticalAlign(),_+=h.height),this.__width=c||!i?p:o,this.__height=f?y:_-e.y,!i&&-1<["center","right"].indexOf(u)&&a.forEach(function(t){var e=p-t.width;0<e&&t.horizonAlign("center"===u?.5*e:e)}),i||this.__marginAuto(r,e))}},{key:"__layoutFlex",value:function(t,l){var e=this.flowChildren,i=this.currentStyle,r=i.flexDirection,n=i.justifyContent,a=i.alignItems,o=this.__preLayout(t),s=o.fixedWidth,S=o.fixedHeight,M=o.x,E=o.y,T=o.w,R=o.h;if(s&&l)this.__width=T;else{var c=0,P="row"===r,C=[],L=[],O=[],W=[],N=0,F=0,D=0,f=0;if(e.forEach(function(t){if(t instanceof ti||t instanceof Ct&&t.shadowRoot instanceof ti){var e=t.__calAutoBasis(!!l||P,T,R),i=e.b,r=e.min,n=e.max;if(l)return void(P?c+=n:c=Math.max(c,n));var a=t.currentStyle,o=t.computedStyle,s=a.flexGrow,h=a.flexShrink,u=a.flexBasis;C.push(s),L.push(h),N+=s,F+=h,u.unit===ni?(O.push(n),D+=n):u.unit===ai?(o.flexBasis=i=u.value,O.push(i),D+=i):u.unit===oi&&(i=o.flexBasis=(P?T:R)*u.value*.01,O.push(i),D+=i),f+=n,W.push(r)}else{if(l)return void(P?c+=t.textWidth:c=Math.max(c,t.textWidth));C.push(0),L.push(1),F+=1,P?(O.push(t.textWidth),D+=t.textWidth,f+=t.textWidth,W.push(t.charWidth)):(t.__layout({x:0,y:0,w:T,h:R},!0),O.push(t.height),D+=t.height,f+=t.height,W.push(t.height))}}),l)this.__width=Math.min(c,T);else{var I=0,B=(P?T:R)<f;e.forEach(function(t,e){var i,r,n,a,o,s,h,u,l,c,f,d,_,p,y,g,v,m,k,b,x,w=L[e],A=C[e];r=B?(i=D-(P?T:R),w?O[e]-i*w/F:O[e]):(n=(P?T:R)-D,A?O[e]+n*A/N:O[e]),r=Math.max(r,W[e]),t instanceof ti||t instanceof Ct&&t.shadowRoot instanceof ti?(a=t.currentStyle,o=t.computedStyle,s=a.display,h=a.flexDirection,u=a.width,l=a.height,"inline"===s&&(a.display=o.display="block"),P?("flex"===s&&"column"===h&&S&&l.unit===ni&&(l.value=R,l.unit=ai),t.__layout({x:M,y:E,w:r,h:R})):("flex"===s&&"row"===h&&u.unit===ni&&(u.value=T,u.unit=ai),t.__layout({x:M,y:E,w:T,h:r})),(B&&w||!B&&A)&&(c=o.borderTopWidth,f=o.borderRightWidth,d=o.borderBottomWidth,_=o.borderLeftWidth,p=o.marginTop,y=o.marginRight,g=o.marginBottom,v=o.marginLeft,m=o.paddingTop,k=o.paddingRight,b=o.paddingBottom,x=o.paddingLeft,P?t.__width=r-v-y-x-k-_-f:t.__height=r-p-g-m-b-c-d)):t.__layout({x:M,y:E,w:P?r:T,h:P?R:r}),I=P?(M+=t.outerWidth,Math.max(I,t.outerHeight)):(E+=t.outerHeight,Math.max(I,t.outerWidth))});var h=P?T-M+t.x:R-E+t.y;if(!B&&0===N&&0<h){var u=e.length;if("flex-end"===n)for(var d=0;d<u;d++){var _=e[d];P?_.__offsetX(h,!0):_.__offsetY(h,!0)}else if("center"===n)for(var p=.5*h,y=0;y<u;y++){var g=e[y];P?g.__offsetX(p,!0):g.__offsetY(p,!0)}else if("space-between"===n)for(var v=h/(u-1),m=1;m<u;m++){var k=e[m];P?k.__offsetX(v*m,!0):k.__offsetY(v*m,!0)}else if("space-around"===n)for(var b=h/(u+1),x=0;x<u;x++){var w=e[x];P?w.__offsetX(b*(x+1),!0):w.__offsetY(b*(x+1),!0)}}P?(S&&(I=R),E+=I):s&&(I=T),l||("stretch"===a?e.forEach(function(t){var e=t.computedStyle,i=t.currentStyle,r=e.borderTopWidth,n=e.borderRightWidth,a=e.borderBottomWidth,o=e.borderLeftWidth,s=e.marginTop,h=e.marginRight,u=e.marginBottom,l=e.marginLeft,c=e.paddingTop,f=e.paddingRight,d=e.paddingBottom,_=e.paddingLeft;P?i.height.unit===ni&&(t.__height=e.height=I-s-u-c-d-r-a):i.width.unit===ni&&(t.__width=e.width=I-l-h-_-f-n-o)}):"center"===a?e.forEach(function(t){var e=I-t.outerHeight;0<e&&t.__offsetY(.5*e,!0)}):"flex-end"===a&&e.forEach(function(t){var e=I-t.outerHeight;0<e&&t.__offsetY(e,!0)})),this.__width=T,this.__height=S?R:E-t.y,this.__marginAuto(i,t)}}}},{key:"__layoutInline",value:function(e,i){var r=this,t=this.flowChildren,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o,s,h,u=n.textAlign,l=this.__preLayout(e),c=l.fixedWidth,f=l.fixedHeight,d=l.x,_=l.y,p=l.w,y=l.h;c&&i?this.__width=p:(s=o=0,h=new ei(d,_),t.forEach(function(t){t instanceof ti||t instanceof Ct&&t.shadowRoot instanceof ti?("inline"!==t.computedStyle.display&&(t.currentStyle.display=t.computedStyle.display="inline",console.error("Inline can not contain block/flex")),d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:y},i),d+=t.outerWidth,o=Math.max(o,s),s=t.outerWidth):(0<=t.__tryLayInline(p-d+e.x,p)?t.__layout({x:d,y:_,w:p,h:y},i):(a.push(h),h.verticalAlign(),d=e.x,_+=h.height,t.__layout({x:e.x,y:_,w:p,h:y},i),h=new ei(d,_),o=Math.max(o,s),s=0),d+=t.outerWidth,h.add(t),s+=t.outerWidth)):d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:y},i),d+=t.width,o=Math.max(o,s),s=t.width):(0<=t.__tryLayInline(p-d+e.x)?t.__layout({x:d,y:_,w:p,h:y},i):(a.push(h),i||h.verticalAlign(),d=e.x,_+=h.height,t.__layout({x:e.x,y:_,w:p,h:y},i),h=new ei(d,_),o=Math.max(o,s),s=0),d+=t.width,h.add(t),s+=t.width)}),h.size&&(a.push(h),i||h.verticalAlign(),_+=h.height,o=Math.max(o,s)),this.__width=c?p:o,this.__height=f?y:_-e.y,!i&&-1<["center","right"].indexOf(u)&&a.forEach(function(t){var e=r.__width-t.width;0<e&&t.horizonAlign("center"===u?.5*e:e)}))}},{key:"__layoutAbs",value:function(i,r){var S=i.sx,M=i.sy,E=i.innerWidth,T=i.innerHeight,t=i.computedStyle,e=this.isDestroyed,n=this.children,a=this.absChildren,o=t.display,s=t.borderTopWidth,h=t.borderLeftWidth,u=t.marginTop,l=t.marginLeft,R=t.paddingLeft;e||"none"===o||(S+=l+h,M+=u+s,a.forEach(function(t){var e=t.currentStyle,i=t.computedStyle;t.__mp(e,i,E),"inline"===i.display&&(e.display=i.display="block");var r,n,a,o,s,h,u,l,c,f,d,_=e.left,p=e.top,y=e.right,g=e.bottom,v=e.width,m=e.height,k=e.display,b=e.flexDirection;if(_.unit!==ni?(f=!0,i.left=si(e,"left",_,E)):i.left="auto",y.unit!==ni?(l=!0,i.right=si(e,"right",y,E)):i.right="auto",p.unit!==ni?(u=!0,i.top=si(e,"top",p,T)):i.top="auto",g.unit!==ni?(c=!0,i.bottom=si(e,"bottom",g,T)):i.bottom="auto",f&&l?(r=S+i.left,a=S+E-i.right-r):f&&v.unit!==ni?(r=S+i.left,a=v.unit===ai?v.value:E*v.value*.01):l&&v.unit!==ni?(a=v.unit===ai?v.value:E*v.value*.01,r=S+E-i.right-a,r-=i.marginLeft,r-=i.marginRight,r-=i.paddingLeft,r-=i.paddingRight,r-=i.borderLeftWidth,r-=i.borderRightWidth):f?r=S+i.left:l?(r=S+E-i.right,s=!0):(r=S+R,v.unit!==ni&&(a=v.unit===ai?v.value:E*v.value*.01)),u&&c)n=M+i.top,o=M+T-i.bottom-n;else if(u&&m.unit!==ni)n=M+i.top,o=m.unit===ai?m.value:T*m.value*.01;else if(c&&m.unit!==ni)o=m.unit===ai?m.value:T*m.value*.01,n=M+T-i.bottom-o,n-=i.marginTop,n-=i.marginBottom,n-=i.paddingTop,n-=i.paddingBottom,n-=i.borderTopWidth,n-=i.borderBottomWidth;else if(u)n=M+i.top;else if(c)n=M+T-i.bottom,h=!0;else{n=M;for(var x=t.prev;x;){if(x instanceof U||"absolute"!==x.computedStyle.position){n=x.y+x.outerHeight;break}x=x.prev}x||(n=M),m.unit!==ni&&(o=m.unit===ai?m.value:T*m.value*.01)}("block"===k&&void 0===a||"flex"===k&&(void 0===a||"column"===b&&void 0===o))&&(d=!0);var w=s?r-S:E+S-r,A=h?n-M:T+M-n;d&&(t.__layout({x:r,y:n,w:w,h:A},!0,!0),w=t.outerWidth),t.__layout({x:r,y:n,w:w,h:A,w2:a,h2:o},!1,!0),s&&t.__offsetX(-t.outerWidth,!0),h&&t.__offsetY(-t.outerHeight,!0)}),n.forEach(function(t){var e;t instanceof c?t.__layoutAbs(-1<["absolute","relative"].indexOf(t.computedStyle.position)?t:i,r):t instanceof Ct&&((e=t.shadowRoot)instanceof c&&e.__layoutAbs(e,r))}))}},{key:"render",value:function(e,i,r,n){Q(K(c.prototype),"render",this).call(this,e,i,r,n),e===xe.SVG&&(this.virtualDom.type="dom");var t,a=this.isDestroyed,o=this.computedStyle,s=o.display,h=o.visibility,u=this.children;a||"none"===s||(n||"hidden"!==h||(n=!0),n||u.forEach(function(t){t.isMask&&t.__renderAsMask(e,i,r)}),(t=this.zIndexChildren).forEach(function(t){t.__renderByMask(e,i,r,n)}),n||e!==xe.SVG||(this.virtualDom.children=t.map(function(t){return t.virtualDom})))}},{key:"__destroy",value:function(){this.children.forEach(function(t){t.__destroy()}),Q(K(c.prototype),"__destroy",this).call(this),this.children.splice(0),this.lineGroups.splice(0)}},{key:"flowChildren",get:function(){return this.children.filter(function(t){return t instanceof Ct&&(t=t.shadowRoot),t instanceof U||t.computedStyle&&"absolute"!==t.computedStyle.position})}},{key:"absChildren",get:function(){return this.children.filter(function(t){return t instanceof Ct&&(t=t.shadowRoot),t instanceof ti&&t.computedStyle&&"absolute"===t.computedStyle.position})}},{key:"zIndexChildren",get:function(){var t=this.children.filter(function(t,e){return t.__iIndex=e,!t.isMask&&t.computedStyle});return ri(t,function(t,e){var i=t instanceof ti,r=e instanceof ti,n=li(t),a=li(e);if(i&&r)if(n&&a){if(t.computedStyle.zIndex>e.computedStyle.zIndex)return!0;if(t.computedStyle.zIndex<e.computedStyle.zIndex)return!1}else{if(n)return!0;if(a)return!1}else if(t instanceof ti){if(n)return!0}else if(e instanceof ti&&a)return!1;return t.__iIndex>e.__iIndex}),t}},{key:"lineGroups",get:function(){return this.__lineGroups}},{key:"baseLine",get:function(){var t=this.lineGroups.length;if(t){var e=this.lineGroups[t-1];return e.y-this.y+e.baseLine}return this.y}}],[{key:"isValid",value:function(t){return hi.hasOwnProperty(t)}}]),c}(),di=s.AUTO,_i=function(){e(Z,fi);var a=f(Z);function Z(t,e){var i;h(this,Z);var r=(i=a.call(this,t,e)).props.src,n=i.__loadImg={cb:function(){}};return r||(n.error=!0),i}return u(Z,[{key:"__preLayout",value:function(t){var e,i,r=Q(K(Z.prototype),"__preLayout",this).call(this,t),n=this.__loadImg;return n.error||(e=this.props.src,(i=Me.IMG[e])&&i.state===Me.LOADED&&(n.url=e,n.source=i.source,n.width=i.width,n.height=i.height)),r.fixedWidth&&r.fixedHeight||(n.error?r.fixedWidth?r.h=r.w:r.fixedHeight?r.w=r.h:r.w=r.h=32:n.source?r.fixedWidth?r.h=r.w*n.height/n.width:r.fixedHeight?r.w=r.h*n.width/n.height:(r.w=n.width,r.h=n.height):r.w=r.h=0,r.fixedWidth=!0,r.fixedHeight=!0),r}},{key:"__addGeom",value:function(t,e){e=be.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),Q(K(Z.prototype),"__destroy",this).call(this)}},{key:"render",value:function(t,e,i,r){var a=this;Q(K(Z.prototype),"render",this).call(this,t,e,i,r);var n=this.sx,o=this.sy,s=this.width,h=this.height,u=this.isDestroyed,l=this.props.src,c=this.computedStyle,f=c.display,d=c.borderTopWidth,_=c.borderLeftWidth,p=c.marginTop,y=c.marginLeft,g=c.paddingTop,v=c.paddingLeft,m=c.borderTopLeftRadius,k=c.borderTopRightRadius,b=c.borderBottomRightRadius,x=c.borderBottomLeftRadius,w=c.visibility;if(!u&&"none"!==f&&"hidden"!==w){var A,S,M,E,T,R,P,C,L,O,W=n+y+_+v,N=o+p+d+g,F=this.__loadImg;if(F.error){var D=.02*Math.min(s,h),I="#DDD",B=W+.7*s,H=N+.3*h,z=5*D,G=[[W+.15*s,N+.7*h],[W+.3*s,N+.4*h],[W+.5*s,N+.6*h],[W+.6*s,N+.5*h],[W+.9*s,N+.8*h],[W+.15*s,N+.8*h]];if(t===xe.CANVAS){e.strokeStyle="#CCC",e.lineWidth=D,e.fillStyle=I,e.beginPath(),e.moveTo(W,N),e.lineTo(W+s,N),e.lineTo(W+s,N+h),e.lineTo(W,N+h),e.lineTo(W,N),e.stroke(),e.closePath(),e.beginPath(),e.arc(B,H,z,0,2*Math.PI),e.fill(),e.closePath(),e.beginPath(),e.moveTo(G[0][0],G[0][1]);for(var X=1,Y=G.length;X<Y;X++){var j=G[X];e.lineTo(j[0],j[1])}e.lineTo(G[0][0],G[0][1]),e.fill(),e.closePath()}else if(t===xe.SVG){this.__addGeom("rect",[["x",W],["y",N],["width",s],["height",h],["stroke","#CCC"],["stroke-width",D],["fill","rgba(0,0,0,0)"]]),this.__addGeom("circle",[["cx",B],["cy",H],["r",z],["fill",I]]);for(var V="",$=0,q=G.length;$<q;$++){var U=G[$];V+="".concat(U[0],",").concat(U[1]," ")}this.__addGeom("polygon",[["points",V],["fill",I]])}}else{F.url===l?(A=F.source)&&(S=Ae.calRadius(W,N,s,h,m,k,b,x),t===xe.CANVAS?S?(E=(M=this.root).width,T=M.height,(R=Me.getCacheCanvas(E,T)).ctx.drawImage(A,0,0,E,T),R.ctx.globalCompositeOperation="destination-in",Ae.genRdRect(t,R.ctx,"#FFF",n,o,E,T,S),R.draw(R.ctx),e.drawImage(R.canvas,0,0),R.draw(e),R.ctx.globalCompositeOperation="source-over",R.ctx.clearRect(0,0,E,T),R.draw(R.ctx)):e.drawImage(A,W,N,s,h):t===xe.SVG&&(s===F.width&&h===F.height||(P=Se.matrixResize(F.width,F.height,s,h,W,N,s,h)),C=[["xlink:href",l],["x",W],["y",N],["width",F.width],["height",F.height]],S&&(L=i.add({tagName:"mask",props:[],children:[Ae.genRdRect(t,e,"#FFF",W,N,s,h,S)]}),C.push(["mask","url(#".concat(L,")")])),P&&!be.equalArr(P,[1,0,0,1,0,0])&&C.push(["transform","matrix("+be.joinArr(P,",")+")"]),this.virtualDom.children.push({type:"img",tagName:"image",props:C}))):((O=this.__loadImg).url=l,O.source=null,O.error=null,Me.measureImg(l,function(t){var e,i,r,n;t.url!==O.url||a.__isDestroyed||(t.success?(O.source=t.source,O.width=t.width,O.height=t.height):O.error=!0,e=a.root,r=(i=a.currentStyle).width,n=i.height,e.delRefreshTask(O.cb),e.delRefreshTask(a.__task),r.unit!==di&&n.unit!==di?e.addRefreshTask(O.cb):e.addRefreshTask(a.__task={before:function(){e.setRefreshLevel(At.REFLOW)}}))},{width:s,height:h}))}}}},{key:"baseLine",get:function(){return this.height}}]),Z}(),pi=be.joinVd,yi=be.joinDef;function gi(t,e,i){var r=t.childNodes;!function(t,e,i){for(var r=e.length,n=i.length,a=0,o=t.childNodes;a<Math.min(r,n);a++)!function(e,t,i){if(t.tagName!==i.tagName)Ti(e,"beforebegin",yi(i)),e.parentNode.removeChild(e);else{t.uuid!==i.uuid&&e.setAttribute("id",i.uuid);for(var r={},n=0,a=t.props.length;n<a;n++){var o=me(t.props[n],2),s=o[0],h=o[1];r[s]=h}for(var u=0,l=i.props.length;u<l;u++){var c=me(i.props[u],2),f=c[0],d=c[1];r.hasOwnProperty(f)?(r[f]!==d&&e.setAttribute(f,d),delete r[f]):e.setAttribute(f,d)}Object.keys(r).forEach(function(t){e.removeAttribute(t)});for(var _=e.childNodes,p=t.children.length,y=i.children.length,g=0;g<Math.min(p,y);g++)wi(e,g,t.children[g],i.children[g]);if(g<p)for(var v=p-1;g<=v;v--)Ei(e,_,v);else if(g<y)for(;g<y;g++)Mi(e,_,g,pi(i.children[g]))}}(o[a],e[a],i[a]);if(a<r)for(var s=r-1;a<=s;s--)Ei(t,o,s);else if(a<n)for(;a<n;a++)Mi(t,o,a,yi(i[a]))}(r[0],e.defs,i.defs),xi(r[1],e.bb,i.bb,e.bbMask,i.bbMask),ki(t,e,i,!0)}function vi(t,e,i){"dom"===e.type?"dom"===i.type?ki(t,e,i):"geom"===i.type?bi(t,e,i):Si(t,i):"text"===e.type?"text"===i.type?function(t,e,i){for(var r=e.children.length,n=i.children.length,a=0;a<Math.min(r,n);a++)wi(t,a,e.children[a],i.children[a],!0);var o=t.childNodes;if(a<r)for(var s=r-1;a<=s;s--)Ei(t,o,s);else if(a<n)for(;a<n;a++)Mi(t,o,a,pi(i.children[a]))}(t,e,i):Si(t,i):"geom"===e.type?"dom"===i.type?bi(t,e,i):"geom"===i.type?function(t,e,i){mi(t,e,i),xi(t.firstChild,e.bb,i.bb,e.bbMask,i.bbMask);for(var r=e.children.length,n=i.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(r,n);a++)wi(o,a,e.children[a],i.children[a]);if(a<r)for(var h=r-1;a<=h;h--)Ei(o,s,h);else if(a<n)for(;a<n;a++)Mi(o,s,a,pi(i.children[a]))}(t,e,i):Si(t,i):"img"===e.type&&("img"===i.type?Ai(t,e,i):Si(t,i))}function mi(t,e,i){var r=i.transform,n=i.opacity,a=i.mask,o=i.filter;e.transform!==r&&(r?t.setAttribute("transform",r):t.removeAttribute("transform")),e.opacity!==n&&(1!==n?t.setAttribute("opacity",n):t.removeAttribute("opacity")),e.mask!==a&&(a?t.setAttribute("mask",a):t.removeAttribute("mask")),e.filter!==o&&(o?t.setAttribute("filter",o):t.removeAttribute("filter"))}function ki(t,e,i,r){mi(t,e,i),r||xi(t.firstChild,e.bb,i.bb,e.bbMask,i.bbMask);for(var n=e.children.length,a=i.children.length,o=0,s=t.lastChild,h=s.childNodes;o<Math.min(n,a);o++)vi(h[o],e.children[o],i.children[o]);if(o<n)for(var u=n-1;o<=u;u--)Ei(s,h,u);else if(o<a)for(;o<a;o++)Mi(s,h,o,pi(i.children[o]))}function bi(t,e,i){mi(t,e,i),xi(t.firstChild,e.bb,i.bb,e.bbMask,i.bbMask);for(var r=e.children.length,n=i.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(r,n);a++)Si(s[a],i.children[a]);if(a<r)for(var h=r-1;a<=h;h--)Ei(o,s,h);else if(a<n)for(;a<n;a++)Mi(o,s,a,pi(i.children[a]))}function xi(t,e,i,r,n){var a=e.length,o=i.length;r!==n&&(n?t.setAttribute("mask",n):t.removeAttribute("mask"));for(var s=0;s<Math.min(a,o);s++)wi(t,s,e[s],i[s]);var h=t.childNodes;if(s<a)for(var u=a-1;s<=u;u--)Ei(t,h,u);else if(s<o)for(;s<o;s++)Mi(t,h,s,pi(i[s]))}function wi(t,e,i,r,n){var a=t.childNodes;i.tagName!==r.tagName?Si(a[e],r):(Ai(a[e],i,r),n&&i.content!==r.content&&(a[e].innerHTML=r.content))}function Ai(e,t,i){for(var r={},n=0,a=t.props.length;n<a;n++){var o=me(t.props[n],2),s=o[0],h=o[1];r[s]=h}for(var u=0,l=i.props.length;u<l;u++){var c=me(i.props[u],2),f=c[0],d=c[1];r.hasOwnProperty(f)?(r[f]!==d&&e.setAttribute(f,d),delete r[f]):e.setAttribute(f,d)}Object.keys(r).forEach(function(t){e.removeAttribute(t)})}function Si(t,e){var i;Array.isArray(e)?(i="",e.forEach(function(t){i+=pi(t)})):i=pi(e),Ti(t,"beforebegin",i),t.parentNode.removeChild(t)}function Mi(t,e,i,r){i>=e.length?Ti(t,"beforeend",r):Ti(e[i],"beforebegin",r)}function Ei(t,e,i){e[i]&&t.removeChild(e[i])}function Ti(t,e,i){if(t.insertAdjacentHTML)t.insertAdjacentHTML(e,i);else switch(e){case"beforeend":t.innerHTML+=i;break;case"beforebegin":(ci=ci||document.createElement("svg")).innerHTML=i,t.parentNode.insertBefore(ci.childNodes[0],t)}}var Ri=function(){function e(t){h(this,e),this.id=t,this.count=0,this.list=[]}return u(e,[{key:"add",value:function(t){return t.uuid="karas-defs-".concat(this.id,"-").concat(this.count++),this.list.push(t),t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(t){return new e(t)}}]),e}(),Pi=be.isNil,Ci=be.isFunction,Li=["playbackRate","iterations","fps","spfLimit","delay","endDelay","duration","direction","fill","playCount","currentTime","easing"];function Oi(s,h){Li.forEach(function(t){var e,i,r,n,a,o;s.hasOwnProperty(t)&&(e=h,i=s[t],r=t,n=s.vars,Pi(i)||((a=e["var-"+r])&&(o=a.id)&&n[o]||(e[r]=i)))})}var Wi=function(){function t(){h(this,t),this.__records=[],this.__list=[]}return u(t,[{key:"__op",value:function(i){this.records.forEach(function(t){var e=t.animate;Array.isArray(e)?e.forEach(function(t){Oi(i,t.options)}):Oi(i,e.options)})}},{key:"add",value:function(t){-1===this.__list.indexOf(t)&&this.list.push(t)}},{key:"remove",value:function(t){var e=this.list.indexOf(t);-1<e&&this.list.splice(e,1)}},{key:"__destroy",value:function(){this.__records=[],this.__list=[]}},{key:"__action",value:function(e,i){this.list.forEach(function(t){t[e].apply(t,i)})}},{key:"init",value:function(){var o=this,t=this.records;t.length&&t.splice(0).forEach(function(t){var e,i,r,n=t.target,a=t.animate;Array.isArray(a)?a.forEach(function(t){var e=t.value,i=t.options;i.autoPlay=!1;var r=n.animate(e,i);o.add(r)}):(e=a.value,(i=a.options).autoPlay=!1,r=n.animate(e,i),o.add(r))})}},{key:"play",value:function(e){this.init();var i=!0;this.__action("play",[e&&function(t){i&&(i=!1,Ci(e)&&e(t))}])}},{key:"pause",value:function(){this.__action("pause")}},{key:"resume",value:function(e){var i=!0;this.__action("resume",[e&&function(t){i&&(i=!1,Ci(e)&&e(t))}])}},{key:"cancel",value:function(e){var i=!0;this.__action("cancel",[e&&function(t){i&&(i=!1,Ci(e)&&e(t))}])}},{key:"finish",value:function(e){var i=!0;this.__action("finish",[e&&function(t){i&&(i=!1,Ci(e)&&e(t))}])}},{key:"gotoAndStop",value:function(t,e,i){this.init();var r=!0;this.__action("gotoAndStop",[t,e,i&&function(t){r&&(r=!1,Ci(i)&&i(t))}])}},{key:"gotoAndPlay",value:function(t,e,i){this.init();var r=!0;this.__action("gotoAndPlay",[t,e,i&&function(t){r&&(r=!1,Ci(i)&&i(t))}])}},{key:"__set",value:function(e,i){this.list.forEach(function(t){t[e]=i})}},{key:"records",get:function(){return this.__records}},{key:"list",get:function(){return this.__list}},{key:"playbackRate",set:function(t){this.__set("playbackRate",t)}},{key:"iterations",set:function(t){this.__set("iterations",t)}},{key:"playCount",set:function(t){this.__set("playCount",t)}},{key:"fps",set:function(t){this.__set("fps",t)}},{key:"currentTime",set:function(t){this.__set("currentTime",t)}},{key:"spfLimit",set:function(t){this.__set("spfLimit",t)}},{key:"delay",set:function(t){this.__set("delay",t)}},{key:"endDelay",set:function(t){this.__set("endDelay",t)}},{key:"fill",set:function(t){this.__set("fill",t)}},{key:"direction",set:function(t){this.__set("direction",t)}}]),t}(),Ni=be.isNil,Fi=be.isObject,Di=be.isFunction,Ii=s.PX;var Bi=0,Hi=function(){e(a,fi);var n=f(a);function a(t,e,i){var r;return h(this,a),(r=n.call(this,t,e,i)).__node=null,r.__mw=0,r.__mh=0,r.__task=[],r.__ref={},r.__animateController=new Wi,r.__initRef(l(r)),wt.mix(l(r)),r}return u(a,[{key:"__initProps",value:function(){var t,e=this.props.width;Ni(e)||0<(t=parseFloat(e)||0)&&(this.__width=t);var i,r=this.props.height;Ni(r)||0<(i=parseFloat(r)||0)&&(this.__height=i)}},{key:"__genHtml",value:function(){for(var t,e,i,r="<".concat(this.tagName),n=0,a=this.__props.length;n<a;n++){var o=me(this.__props[n],2),s=o[0],h=o[1];/^on[a-zA-Z]/.test(s)||(r+=(t=s,e=h,i=Array.isArray(e)?be.joinSourceArray(e):be.stringify(e),"className"===t&&(t="class")," "+t+'="'+be.encodeHtml(i,!0)+'"'))}return r+="></".concat(this.tagName,">")}},{key:"__cb",value:function(t,e){if("touchmove"!==t.type||this.__touchstartTarget){var i,r,n,a,o,s,h,u,l,c,f,d;-1===["touchend","touchcancel"].indexOf(t.type)&&(r=(i=this.node.getBoundingClientRect()).x,n=i.y,a=i.left,o=i.top,s=i.width,h=i.height,u=r||a||0,l=n||o||0,u=(c=t.touches?t.touches[0]:t).pageX-u,l=c.pageY-l,1!=(f=s/this.width)&&(u/=f),1!=(d=h/this.height)&&(l/=d));var _={event:t,stopPropagation:function(){this.__stopPropagation=!0,t.stopPropagation()},stopImmediatePropagation:function(){this.__stopPropagation=!0,this.__stopImmediatePropagation=!0,t.stopImmediatePropagation()},preventDefault:function(){t.preventDefault()},x:u,y:l,__hasEmitted:!1};return this.__emitEvent(_,e),_}}},{key:"appendTo",value:function(t){var e,i;t=function(t){if(be.isString(t)&&t){var e=document.querySelector(t);if(!e)throw new Error("can not find dom of selector: "+t);return e}if(!t)throw new Error("can not find dom: "+t);return t}(t),this.__initProps(),this.__refreshLevel=At.REFLOW,t.nodeName.toUpperCase()===this.tagName.toUpperCase()?(this.__node=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__node=t.querySelector(this.tagName),this.__node||(t.innerHTML=this.__genHtml(),this.__node=t.querySelector(this.tagName))),this.__uuid=Ni(this.__node.__uuid)?Bi++:this.__node.__uuid,this.__defs=this.node.__defs||Ri.getInstance(this.__uuid),this.width&&this.height||(e=window.getComputedStyle(t,null),this.width||(this.__width=parseFloat(e.getPropertyValue("width"))||0,t.setAttribute("width",this.width)),this.height||(this.__height=parseFloat(e.getPropertyValue("height"))||0,t.setAttribute("height",this.height))),"canvas"===this.tagName?(this.__ctx=this.__node.getContext("2d"),this.__renderMode=xe.CANVAS):"svg"===this.tagName&&(this.__renderMode=xe.SVG),this.refresh(),this.node.__root?this.node.__root.__destroy():(i=this.node,["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"].forEach(function(e){i.addEventListener(e,function(t){i.__root.__cb(t,-1<["touchend","touchcancel","touchmove"].indexOf(e))})}),this.node.__uuid=this.__uuid),this.node.__root=this}},{key:"refresh",value:function(i){var r,n=this,t=this.isDestroyed,a=this.renderMode,o=this.ctx,s=this.defs,e=this.style;t||(s.clear(),-1===["flex","block"].indexOf(e.display)&&(e.display="block"),"absolute"===e.position&&(e.position="static"),e.width={value:this.width,unit:Ii},e.height={value:this.height,unit:Ii},r=this.__refreshLevel,this.__refreshLevel=At.REPAINT,r===At.REFLOW&&this.__measure(a,o,!0),Me.measureText(function(){var t,e;r===At.REFLOW?(n.__layout({x:0,y:0,w:n.width,h:n.height}),n.__layoutAbs(n,{x:0,y:0,w:n.width,h:n.height})):n.__repaint(!0),a===xe.CANVAS&&n.__clear(),n.render(a,o,s),a===xe.SVG&&(t=n.virtualDom,e=s,t.defs=e.value,n.node.__root?gi(n.node,n.node.__vd,t):n.node.innerHTML=be.joinVirtualDom(t),n.node.__vd=t,n.node.__defs=e),Di(i)&&i(),n.emit(wt.REFRESH,r)}))}},{key:"addRefreshTask",value:function(t){var n,a,o=this;t&&((n=this.task).length||Gt.nextFrame(this.__rTask={before:function(e){var t,i,r;(a=n.splice(0)).length&&(a.forEach(function(t){Fi(t)&&Di(t.before)&&t.before(e)}),o.refresh(),!(t=o.__hookTask)||-1<(r=(i=Gt.__hookTask).indexOf(t))&&i.splice(r,1))},after:function(e){a.forEach(function(t){Fi(t)&&Di(t.after)?t.after(e):Di(t)&&t(e)})}}),-1===n.indexOf(t)&&n.push(t))}},{key:"delRefreshTask",value:function(t){if(t){for(var e=this.task,i=0,r=e.length;i<r;i++)if(e[i]===t){e.splice(i,1);break}e.length||Gt.offFrame(this.__rTask)}}},{key:"setRefreshLevel",value:function(t){t>this.__refreshLevel&&(this.__refreshLevel=t)}},{key:"__frameHook",value:function(){var t=this,e=this.__hookTask=this.__hookTask||function(){t.refresh()};-1===Gt.__hookTask.indexOf(e)&&Gt.__hookTask.push(e)}},{key:"__clear",value:function(){this.__mw=Math.max(this.__mw,this.width),this.__mh=Math.max(this.__mh,this.height),this.__ctx.setTransform(1,0,0,1,0,0),this.__ctx.clearRect(0,0,this.__mw,this.__mh)}},{key:"node",get:function(){return this.__node}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"ctx",get:function(){return this.__ctx}},{key:"defs",get:function(){return this.__defs}},{key:"task",get:function(){return this.__task}},{key:"ref",get:function(){return this.__ref}},{key:"animateController",get:function(){return this.__animateController}}]),a}(),zi=s.AUTO,Gi=s.PX,Xi=s.PERCENT,Yi=be.clone,ji=be.int2rgba,Vi=be.isNil,$i=be.extend,qi=be.joinArr,Ui={},Zi=function(){e(s,ti);var a=f(s);function s(t,e){var i;h(this,s),(i=a.call(this,t,e)).__isMask=!!i.props.mask,i.__currentProps=i.props;var r=l(i),n=r.style;return r.isMask&&(n.visibility="visible",n.background=null,n.border=null,n.strokeWidth=0,n.stroke=null),$.normalize(i.style,nt.dom.concat(nt.geom)),i}return u(s,[{key:"__tryLayInline",value:function(t,e){var i=this.currentStyle.width;return i.unit===Gi?t-i.value:i.unit===Xi?t-e*i.value*.01:t}},{key:"__calAutoBasis",value:function(t){var e,i,r=0,n=0,a=0,o=this.currentStyle,s=this.computedStyle,h=o.width,u=o.height,l=s.borderTopWidth,c=s.borderRightWidth,f=s.borderBottomWidth,d=s.borderLeftWidth,_=t?h:u;return _.unit!==zi&&(r=a+=_.value),t?(r+=e=c+d,a+=e,n+=e):(r+=i=l+f,a+=i,n+=i),{b:r,min:n,max:a}}},{key:"__layoutBlock",value:function(t,e){var i=this.__preLayout(t),r=i.fixedWidth,n=i.fixedHeight,a=i.w,o=i.h;this.__height=n?o:0,e?this.__width=r?a:0:(this.__width=a,this.__marginAuto(this.currentStyle,t))}},{key:"__layoutFlex",value:function(t){this.__layoutBlock(t)}},{key:"__layoutInline",value:function(t){var e=this.__preLayout(t),i=e.fixedWidth,r=e.fixedHeight,n=e.x,a=e.y,o=e.w,s=e.h;this.__width=i?o:n-t.x,this.__height=r?s:a-t.y}},{key:"__preRender",value:function(t,e,i){var r=this.sx,n=this.sy,a=this.width,o=this.height,s=this.currentStyle,h=this.computedStyle,u=s.strokeWidth,l=s.fill,c=s.stroke,f=s.strokeDasharray,d=s.strokeLinecap,_=h.borderTopWidth,p=h.borderLeftWidth,y=h.display,g=h.marginTop,v=h.marginLeft,m=h.paddingTop,k=h.paddingRight,b=h.paddingBottom,x=h.paddingLeft,w=h.visibility,A=r+p+v+x,S=n+_+g+m,M=A+.5*a,E=S+.5*o,T=a+x+k,R=o+m+b,u=u.unit===Gi?u.value:u.unit===Xi?u.value*a*.01:0;return h.strokeWidth=u,c=!(h.stroke=c)||"linear"!==c.k&&"radial"!==c.k?ji(c):this.__gradient(t,e,i,A,S,A+a,S+o,T,R,c),l=!(h.fill=l)||"linear"!==l.k&&"radial"!==l.k?ji(l):this.__gradient(t,e,i,A,S,A+a,S+o,T,R,l),h.strokeWidth=u,h.strokeDasharray=f,h.strokeLinecap=d,{x:r,y:n,originX:A,originY:S,cx:M,cy:E,display:y,stroke:c,strokeWidth:u,strokeDasharray:f,strokeDasharrayStr:be.joinArr(f,","),strokeLinecap:d,fill:l,visibility:w}}},{key:"render",value:function(t,e,i,r){Q(K(s.prototype),"render",this).call(this,t,e,i,r),t===xe.SVG&&(this.virtualDom.type="geom");var n=this.isDestroyed,a=this.animateProps,o=this.computedStyle.display;return this.__currentProps=a,n||"none"===o?{isDestroyed:n,display:o}:this.__preRender(t,e,i,r)}},{key:"__renderAsMask",value:function(t,e,i){if(t===xe.SVG){this.render(t,e,i);var r=this.virtualDom;r.isMask=!0;var n=Yi(r.children),T=this.matrixEvent;n.forEach(function(t){var e,i,r=0,n=1,a=t.props;if("rect"===t.tagName){for(var o=0,s=a.length;o<s;o++){var h=me(a[o],2),u=h[0],l=h[1];"x"===u?(r=o,e=l):"y"===u&&(n=o,i=l)}var c=at.calPoint([e,i],T);a[r][1]=c[0],a[n][1]=c[1]}else if("circle"===t.tagName||"ellipse"===t.tagName){for(var f=0,d=a.length;f<d;f++){var _=me(a[f],2),p=_[0],y=_[1];"cx"===p?(r=f,e=y):"cy"===p&&(n=f,i=y)}var g=at.calPoint([e,i],T);a[r][1]=g[0],a[n][1]=g[1]}else if("polyline"===t.tagName)for(var v=0,m=a.length;v<m;v++){var k=me(a[v],2),b=k[0],x=k[1];if("points"===b){a[v][1]=x.replace(/([\d.]+),([\d.]+)/g,function(t,e,i){return qi(at.calPoint([e,i],T),",")});break}}else if("path"===t.tagName)for(var w=0,A=a.length;w<A;w++){var S=me(a[w],2),M=S[0],E=S[1];if("d"===M){a[w][1]=E.replace(/([\d.]+),([\d.]+)/g,function(t,e,i){return qi(at.calPoint([e,i],T),",")});break}}});var a=this.prev;if(a&&a.isMask){var o=i.value;return(o=o[o.length-1]).children=o.children.concat(n),void(this.__maskId=a.maskId)}var s=i.add({tagName:"mask",props:[],children:n});this.__maskId="url(#".concat(s,")")}}},{key:"addGeom",value:function(t,e){e=be.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"getProps",value:function(t){var e=this.currentProps[t];return Vi(e)?this["__"+t]:e}},{key:"baseLine",get:function(){return this.__height}},{key:"isMask",get:function(){return this.__isMask}},{key:"maskId",get:function(){return this.__maskId}},{key:"animateProps",get:function(){var e,i=this.props;return this.animationList.forEach(function(t){t.animating&&(e=e||$i({},i),$i(e,t.props,t.keys))}),e||i}},{key:"currentProps",get:function(){return this.__currentProps}}],[{key:"getRegister",value:function(t){if(!Ui.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return Ui[t]}},{key:"register",value:function(t,e){if(s.hasRegister(t))throw new Error("Geom has already register: ".concat(t));Ui[t]=e}},{key:"hasRegister",value:function(t){return Ui.hasOwnProperty(t)}}]),s}(),Ki=function(){e(R,Zi);var r=f(R);function R(t,e){var i;return h(this,R),(i=r.call(this,t,e)).__x1=i.__y1=0,i.__x2=i.__y2=1,i.__controlA=[],i.__controlB=[],void 0!==i.props.x1&&(i.__x1=parseFloat(i.props.x1)||0),void 0!==i.props.y1&&(i.__y1=parseFloat(i.props.y1)||0),void 0!==i.props.x2&&(i.__x2=parseFloat(i.props.x2)||0),void 0!==i.props.y2&&(i.__y2=parseFloat(i.props.y2)||0),Array.isArray(i.props.controlA)&&(i.__controlA=i.props.controlA),Array.isArray(i.props.controlB)&&(i.__controlB=i.props.controlB),i}return u(R,[{key:"render",value:function(t,e,i,r){var n,a,o,s,h,u,l,c,f,d,_,p,y,g,v=Q(K(R.prototype),"render",this).call(this,t,e,i,r),m=v.isDestroyed,k=v.display,b=v.visibility,x=v.originX,w=v.originY,A=v.stroke,S=v.strokeWidth,M=v.strokeDasharray,E=v.strokeDasharrayStr,T=v.strokeLinecap;m||"none"===k||"hidden"===b||(n=this.width,a=this.height,h=this.x1,u=this.y1,l=this.x2,c=this.y2,o=this.controlA,s=this.controlB,h=x+h*n,u=w+u*a,l=x+l*n,c=w+c*a,f=0,2===o.length&&(f++,d=x+o[0]*n,_=w+o[1]*a),2===s.length&&(f+=2,p=x+s[0]*n,y=w+s[1]*a),t===xe.CANVAS?(e.strokeStyle=A,e.lineWidth=S,e.lineCap=T,e.setLineDash(M),e.beginPath(),e.moveTo(h,u),3===f?e.bezierCurveTo(d,_,p,y,l,c):2===f?e.quadraticCurveTo(p,y,l,c):1===f?e.quadraticCurveTo(d,_,l,c):e.lineTo(l,c),0<S&&e.stroke(),e.closePath()):t===xe.SVG&&(g=[["d",3===f?"M".concat(h,",").concat(u," C").concat(d,",").concat(_," ").concat(p,",").concat(y," ").concat(l,",").concat(c):2===f?"M".concat(h,",").concat(u," Q").concat(p,",").concat(y," ").concat(l,",").concat(c):1===f?"M".concat(h,",").concat(u," Q").concat(d,",").concat(_," ").concat(l,",").concat(c):"M".concat(h,",").concat(u," L").concat(l,",").concat(c)],["fill","none"],["stroke",A],["stroke-width",S]],M.length&&g.push(["stroke-dasharray",E]),"butt"!==T&&g.push(["stroke-linecap",T]),this.addGeom("path",g)))}},{key:"x1",get:function(){return this.getProps("x1")}},{key:"y1",get:function(){return this.getProps("y1")}},{key:"x2",get:function(){return this.getProps("x2")}},{key:"y2",get:function(){return this.getProps("y2")}},{key:"controlA",get:function(){return this.getProps("controlA")}},{key:"controlB",get:function(){return this.getProps("controlB")}}]),R}(),Qi=function(){e(z,Zi);var r=f(z);function z(t,e){var i;return h(this,z),(i=r.call(this,t,e)).__points=[],Array.isArray(i.props.points)&&(i.__points=i.props.points),i.__controls=[],Array.isArray(i.props.controls)&&(i.__controls=i.props.controls),i}return u(z,[{key:"__getPoints",value:function(n,a,o,s,t,e){var i=[],h=[],u=!1;return t.forEach(function(t){i.push([n+t[0]*o,a+t[1]*s])}),e.forEach(function(i){var r;!Array.isArray(i)||2!==i.length&&4!==i.length?h.push(null):(r=[],i.forEach(function(t,e){0===e||2===e?r.push(n+i[e]*o):r.push(a+i[e]*s)}),h.push(r),u=!0)}),[i,h,u]}},{key:"render",value:function(t,e,i,r){var n=Q(K(z.prototype),"render",this).call(this,t,e,i,r),a=n.isDestroyed,o=n.originX,s=n.originY,h=n.display,u=n.visibility,l=n.fill,c=n.stroke,f=n.strokeWidth,d=n.strokeDasharray,_=n.strokeDasharrayStr,p=n.strokeLinecap;if(!a&&"none"!==h&&"hidden"!==u){var y=this.width,g=this.height,v=this.points,m=this.controls,k=me(this.__getPoints(o,s,y,g,v,m),3),b=k[0],x=k[1],w=k[2];if(v.length<2)console.error("Points must have at lease 2 item: "+v);else{for(var A=0,S=v.length;A<S;A++)if(!Array.isArray(v[A])||v[A].length<2)return void console.error("Each Point must have a coords: "+v[A]);if(t===xe.CANVAS){e.strokeStyle=c,e.lineWidth=f,e.fillStyle=l,e.lineCap=p,e.setLineDash(d),e.beginPath(),e.moveTo(b[0][0],b[0][1]);for(var M=1,E=b.length;M<E;M++){var T=b[M],R=x[M-1];R&&R.length?4===R.length?e.bezierCurveTo(R[0],R[1],R[2],R[3],T[0],T[1]):e.quadraticCurveTo(R[0],R[1],T[0],T[1]):e.lineTo(T[0],T[1])}e.fill(),0<f&&e.stroke(),e.closePath()}else if(t===xe.SVG){var P,C=[["fill",l],["stroke",c],["stroke-width",f]];if(w){for(var L="M".concat(b[0][0],",").concat(b[0][1]),O=1,W=b.length;O<W;O++){var N=b[O],F=x[O-1];F&&F.length?4===F.length?L+="C".concat(F[0],",").concat(F[1]," ").concat(F[2],",").concat(F[3]," ").concat(N[0],",").concat(N[1]):L+="Q".concat(F[0],",").concat(F[1]," ").concat(N[0],",").concat(N[1]):L+="L".concat(N[0],",").concat(N[1])}C.push(["d",L]),P="path"}else{for(var D="",I=0,B=b.length;I<B;I++){var H=b[I];I&&(D+=" "),D+="".concat(H[0],",").concat(H[1])}C.push(["points",D]),P="polyline"}d.length&&C.push(["stroke-dasharray",_]),"butt"!==p&&C.push(["stroke-linecap",p]),this.addGeom(P,C)}}}}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}}]),z}(),Ji=function(){e(l,Qi);var i=f(l);function l(t,e){return h(this,l),i.call(this,t,e)}return u(l,[{key:"__getPoints",value:function(t,e,i,r,n,a){var o=me(Q(K(l.prototype),"__getPoints",this).call(this,t,e,i,r,n,a),3),s=o[0],h=o[1],u=o[2];return s.push(s[0]),[s,h,u]}}]),l}(),tr=.5*Math.PI;function er(t,e,i,r){return 0<=(r%=360)&&r<90?[t+Math.sin(r*Math.PI/180)*i,e-Math.cos(r*Math.PI/180)*i]:90<=r&&r<180?[t+Math.cos((r-90)*Math.PI/180)*i,e+Math.sin((r-90)*Math.PI/180)*i]:180<=r&&r<270?[t-Math.cos((270-r)*Math.PI/180)*i,e+Math.sin((270-r)*Math.PI/180)*i]:[t-Math.sin((360-r)*Math.PI/180)*i,e-Math.cos((360-r)*Math.PI/180)*i]}var ir=function(){e(L,Zi);var r=f(L);function L(t,e){var i;return h(this,L),(i=r.call(this,t,e)).__begin=0,i.__end=0,i.props.begin&&(i.__begin=parseFloat(i.props.begin),isNaN(i.begin)&&(i.__begin=0)),i.props.end&&(i.__end=parseFloat(i.props.end),isNaN(i.end)&&(i.__end=0)),i.__r=1,i.props.r&&(i.__r=parseFloat(i.props.r),isNaN(i.r)&&(i.__r=1)),i.__edge=!1,void 0!==i.props.edge&&(i.__edge=!!i.props.edge),i.__closure=!1,void 0!==i.props.closure&&(i.__closure=!!i.props.closure),i}return u(L,[{key:"render",value:function(t,e,i,r){var n,a,o,s,h,u,l,c,f,d,_,p,y,g,v,m,k=Q(K(L.prototype),"render",this).call(this,t,e,i,r),b=k.isDestroyed,x=k.cx,w=k.cy,A=k.display,S=k.visibility,M=k.fill,E=k.stroke,T=k.strokeWidth,R=k.strokeDasharray,P=k.strokeDasharrayStr,C=k.strokeLinecap;b||"none"===A||"hidden"===S||(n=this.width,a=this.height,o=this.begin,s=this.end,h=this.r,u=this.edge,l=this.closure,o!==s&&(f=(c=me(er(x,w,h*=.5*Math.min(n,a),o),2))[0],d=c[1],p=(_=me(er(x,w,h,s),2))[0],y=_[1],g=180<s-o?1:0,t===xe.CANVAS?(e.strokeStyle=E,e.lineWidth=T,e.fillStyle=M,e.lineCap=C,e.setLineDash(R),e.beginPath(),e.arc(x,w,h,o*Math.PI/180-tr,s*Math.PI/180-tr),u?(g&&l||e.lineTo(x,w),e.lineTo(f,d),0<T&&e.stroke()):(0<T&&e.stroke(),g&&l||e.lineTo(x,w),e.lineTo(f,d)),e.fill(),e.closePath()):t===xe.SVG&&(u?(v=[["d",l?"M".concat(f," ").concat(d," A").concat(h," ").concat(h," 0 ").concat(g," 1 ").concat(p," ").concat(y," z"):"M".concat(x," ").concat(w," L").concat(f," ").concat(d," A").concat(h," ").concat(h," 0 ").concat(g," 1 ").concat(p," ").concat(y," z")],["fill",M],["stroke",E],["stroke-width",T]],R.length&&v.push(["stroke-dasharray",P]),"butt"!==C&&v.push(["stroke-linecap",C]),this.addGeom("path",v)):(this.addGeom("path",[["d",l?"M".concat(f,",").concat(d," A").concat(h," ").concat(h," 0 ").concat(g," 1 ").concat(p,",").concat(y," z"):"M".concat(x,",").concat(w," L").concat(f,",").concat(d," A").concat(h," ").concat(h," 0 ").concat(g," 1 ").concat(p,",").concat(y," z")],["fill",M]]),0<T&&(m=[["d","M".concat(f,",").concat(d," A").concat(h,",").concat(h," 0 ").concat(g," 1 ").concat(p,",").concat(y)],["fill","rgba(0,0,0,0)"],["stroke",E],["stroke-width",T]],R.length&&m.push(["stroke-dasharray",P]),"butt"!==C&&m.push(["stroke-linecap",C]),this.addGeom("path",m))))))}},{key:"begin",get:function(){return this.getProps("begin")}},{key:"end",get:function(){return this.getProps("end")}},{key:"r",get:function(){return this.getProps("r")}},{key:"edge",get:function(){return this.getProps("edge")}},{key:"closure",get:function(){return this.getProps("closure")}}]),L}(),rr=function(){e(w,Zi);var r=f(w);function w(t,e){var i;return h(this,w),(i=r.call(this,t,e)).__rx=0,i.props.rx&&(i.__rx=parseFloat(i.props.rx),isNaN(i.rx)&&(i.__rx=0)),i.__ry=0,i.props.ry&&(i.__ry=parseFloat(i.props.ry),isNaN(i.ry)&&(i.__ry=0)),i}return u(w,[{key:"render",value:function(t,e,i,r){var n,a,o,s,h,u,l,c=Q(K(w.prototype),"render",this).call(this,t,e,i,r),f=c.isDestroyed,d=c.originX,_=c.originY,p=c.display,y=c.visibility,g=c.fill,v=c.stroke,m=c.strokeWidth,k=c.strokeDasharray,b=c.strokeDasharrayStr,x=c.strokeLinecap;f||"none"===p||"hidden"===y||(n=this.width,a=this.height,u=this.rx,l=this.ry,u=Math.min(u,.5),l=Math.min(l,.5),u*=n,l*=a,t===xe.CANVAS?(e.strokeStyle=v,e.lineWidth=m,e.fillStyle=g,e.lineCap=x,e.setLineDash(k),e.beginPath(),0===u&&0===l?e.rect(d,_,n,a):(o=u*A.H,s=l*A.H,e.moveTo(d+u,_),e.lineTo(d+n-u,_),e.bezierCurveTo(d+n+o-u,_,d+n,_+l-s,d+n,_+l),e.lineTo(d+n,_+a-l),e.bezierCurveTo(d+n,_+a+s-l,d+n+o-u,_+a,d+n-u,_+a),e.lineTo(d+u,_+a),e.bezierCurveTo(d+u-o,_+a,d,_+a+s-l,d,_+a-l),e.lineTo(d,_+l),e.bezierCurveTo(d,_+l-s,d+u-o,_,d+u,_)),e.fill(),0<m&&e.stroke(),e.closePath()):t===xe.SVG&&(h=[["x",d],["y",_],["width",n],["height",a],["fill",g],["stroke",v],["stroke-width",m]],u&&h.push(["rx",u]),l&&h.push(["ry",l]),k.length&&h.push(["stroke-dasharray",b]),"butt"!==x&&h.push(["stroke-linecap",x]),this.addGeom("rect",h)))}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}}]),w}(),nr=function(){e(k,Zi);var r=f(k);function k(t,e){var i;return h(this,k),(i=r.call(this,t,e)).__r=1,i.props.r&&(i.__r=parseFloat(i.props.r),isNaN(i.r)&&(i.__r=1)),i}return u(k,[{key:"render",value:function(t,e,i,r){var n,a,o,s,h=Q(K(k.prototype),"render",this).call(this,t,e,i,r),u=h.isDestroyed,l=h.cx,c=h.cy,f=h.display,d=h.visibility,_=h.fill,p=h.stroke,y=h.strokeWidth,g=h.strokeDasharray,v=h.strokeDasharrayStr,m=h.strokeLinecap;u||"none"===f||"hidden"===d||(n=this.width,a=this.height,o=this.r,o*=.5*Math.min(n,a),t===xe.CANVAS?(e.strokeStyle=p,e.lineWidth=y,e.fillStyle=_,e.lineCap=m,e.setLineDash(g),e.beginPath(),e.arc(l,c,o,0,2*Math.PI),e.fill(),0<y&&e.stroke(),e.closePath()):t===xe.SVG&&(s=[["cx",l],["cy",c],["r",o],["fill",_],["stroke",p],["stroke-width",y]],g.length&&s.push(["stroke-dasharray",v]),"butt"!==m&&s.push(["stroke-linecap",m]),this.addGeom("circle",s)))}},{key:"r",get:function(){return this.getProps("r")}}]),k}(),ar=function(){e(w,Zi);var r=f(w);function w(t,e){var i;return h(this,w),(i=r.call(this,t,e)).__rx=1,i.props.rx&&(i.__rx=parseFloat(i.props.rx),isNaN(i.rx)&&(i.__rx=1)),i.__ry=1,i.props.ry&&(i.__ry=parseFloat(i.props.ry),isNaN(i.ry)&&(i.__ry=1)),i}return u(w,[{key:"render",value:function(t,e,i,r){var n,a,o,s,h,u,l,c=Q(K(w.prototype),"render",this).call(this,t,e,i,r),f=c.isDestroyed,d=c.cx,_=c.cy,p=c.display,y=c.visibility,g=c.fill,v=c.stroke,m=c.strokeWidth,k=c.strokeDasharray,b=c.strokeDasharrayStr,x=c.strokeLinecap;f||"none"===p||"hidden"===y||(n=this.width,a=this.height,o=this.rx,s=this.ry,o*=.5*n,s*=.5*a,t===xe.CANVAS?(e.strokeStyle=v,e.lineWidth=m,e.fillStyle=g,e.lineCap=x,e.setLineDash(k),e.beginPath(),e.ellipse?e.ellipse(d,_,o,s,0,0,2*Math.PI):(h=o*A.H,u=s*A.H,e.moveTo(d-o,_),e.bezierCurveTo(d-o,_-u,d-h,_-s,d,_-s),e.bezierCurveTo(d+h,_-s,d+o,_-u,d+o,_),e.bezierCurveTo(d+o,_+u,d+h,_+s,d,_+s),e.bezierCurveTo(d-h,_+s,d-o,_+u,d-o,_)),e.fill(),0<m&&e.stroke(),e.closePath()):t===xe.SVG&&(l=[["cx",d],["cy",_],["rx",o],["ry",s],["fill",g],["stroke",v],["stroke-width",m]],k.length&&l.push(["stroke-dasharray",b]),"butt"!==x&&l.push(["stroke-linecap",x]),this.addGeom("ellipse",l)))}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}}]),w}(),or={skewX:"kx",skewY:"ky",transform:"tf",fontSize:"fz",offset:"os",easing:"e"},sr={os:"offset",e:"easing"},hr={value:"v",options:"o"},ur={},lr={duration:"dt",delay:"d",endDelay:"ed",iterations:"i",direction:"dc",fill:"f",fps:"fp",playbackRate:"p",spfLimit:"sl"},cr={};nt.dom.concat(nt.geom).forEach(function(t){var e,i=t.k;or.hasOwnProperty(i)?sr[or[i]]=i:(e=i.charAt(0)+i.replace(/[a-z]/g,"").toLowerCase(),or[i]=e,sr[e]=i)}),Object.keys(hr).forEach(function(t){ur[hr[t]]=t}),Object.keys(lr).forEach(function(t){cr[lr[t]]=t});var fr={fullCssProperty:or,abbrCssProperty:sr,fullAnimate:hr,abbrAnimate:ur,fullAnimateOption:lr,abbrAnimateOption:cr},dr=be.isNil,_r=be.isFunction,pr=be.isPrimitive,yr=be.clone,gr=be.extend,vr=fr.abbrCssProperty,mr=fr.abbrAnimateOption,kr=fr.abbrAnimate;function br(n,a){n&&Object.keys(n).forEach(function(t){var e,i,r;0===t.indexOf("var-")?(e=t.slice(4),a.hasOwnProperty(e)&&(i=a[e],n["var-"+i]=n[t])):a.hasOwnProperty(t)&&(r=a[t],n[r]=n[t],delete n[t])})}function xr(s,h){s&&h&&Object.keys(s).forEach(function(t){if(0===t.indexOf("var-")){var e=s[t],i=t.slice(4);if(e.id&&h.hasOwnProperty(e.id)){var r=h[e.id];if(dr(e))return;if(-1<i.indexOf(".")){for(var n=i.split("."),a=n.length,o=0;o<a-1;o++)i=n[o],s[i]?s=s[i]:console.error("parseJson vars is not exist: "+e.id+", "+t+", "+n.slice(0,o).join("."));i=n[a-1]}_r(r)&&(r=r(e)),s[i]=r}}})}function wr(e,i){e.tagName=i.tagName,e.props=yr(i.props),e.children=i.children,Object.keys(i).forEach(function(t){0!==t.indexOf("var-")||e.hasOwnProperty(t)||(e[t]=i[t])}),e.libraryId=null;var t,r,n=e.init;n&&(r=(t=e.props=e.props||{}).style,gr(t,n),r&&(gr(r,n.style),t.style=r),e.init=null)}function Ar(e,t,i,r,n){var a=4<arguments.length&&void 0!==n?n:{};if(pr(t)||t instanceof x)return t;if(Array.isArray(t))return t.map(function(t){return Ar(e,t,i,r,a)});var o=t.library,s=t.libraryId;if(Array.isArray(o))a={},o.forEach(function(t){!function(t,r){var e=t.id,i=t.children;if(Array.isArray(i)&&i.forEach(function(t){if(!pr(t)){var e=t.libraryId;if(dr(e))return;var i=r[e];if(!i)throw new Error("Link library item miss id: "+e);wr(t,i)}}),dr(e))throw new Error("Library item miss id: "+e);r[e]=t}(t,a)}),t.library=null,t.libraryId=null;else if(!dr(s)&&a){var h=a[s];if(!h)throw new Error("Link library miss id: "+s);wr(t,h)}var u=t.tagName,l=t.props,c=void 0===l?{}:l,f=t.children,d=void 0===f?[]:f,_=t.animate,p=void 0===_?[]:_;if(!u)throw new Error("Dom must have a tagName: "+t);var y,g,v,m,k,b=c.style;return br(b,vr),xr(b,r),xr(c,r),xr(t,r),y="$"===u.charAt(0)?e.createGm(u,c):e.createVd(u,c,d.map(function(t){return Ar(e,t,i,r,a)})),p&&(Array.isArray(p)?(p.forEach(function(t){br(t,kr);var e=t.value,i=t.options;Array.isArray(e)&&e.length&&(v=!0,e.forEach(function(t){br(t,vr),xr(t,r)})),i&&(br(i,mr),xr(i,r))}),v&&(g={animate:p,target:y})):(br(p,kr),m=p.value,k=p.options,Array.isArray(m)&&m.length&&(m.forEach(function(t){br(t,vr),xr(t,r)}),g={animate:p,target:y}),k&&(br(k,mr),xr(k,r)))),g&&i.push(g),y}Zi.register("$line",Ki),Zi.register("$polyline",Qi),Zi.register("$polygon",Ji),Zi.register("$sector",ir),Zi.register("$rect",rr),Zi.register("$circle",nr),Zi.register("$ellipse",ar);var Sr={version:"0.30.2",render:function(t,e){if(!(t instanceof Hi))throw new Error("Render dom must be canvas/svg");return e&&t.appendTo(e),t},createVd:function(t,e,i){if(-1<["canvas","svg"].indexOf(t))return new Hi(t,e,i);if(fi.isValid(t))return"img"===t?new _i(t,e):new fi(t,e,i);throw new Error("Can not use <".concat(t,">"))},createGm:function(t,e){return new(Zi.getRegister(t))(t,e)},createCp:function(t,e,i){return new t(e,i)},parse:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:{};Me.isDom(e)||(r=e||{},e=null);var n=[],a=Ar(this,t,n,r.vars);if(e){var o=t.tagName;if(-1===["canvas","svg"].indexOf(o))throw new Error("Parse dom must be canvas/svg");var s=a.animateController;s.__records=n,this.render(a,e),s.__op(r),r.hasOwnProperty("autoPlay")&&!r.autoPlay||s.play()}else n.length&&(a.__animateRecords=n);return a},Root:Hi,Dom:fi,Img:_i,Geom:Zi,mode:xe,Component:Ct,Event:wt,sort:ri,util:be,inject:Me,css:$,unit:s,reset:nt,abbr:fr,frame:Gt,easing:Jt,level:At,math:ut};return"undefined"!=typeof window&&(window.karas=Sr),Sr});
//# sourceMappingURL=index.min.js.map
