!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).karas=e()}(this,function(){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(a){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e,i,r,n=K(a);return e=o?(t=K(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),i=this,!(r=e)||"object"!=typeof r&&"function"!=typeof r?c(i):r}}function J(t,e,i){return(J="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function xe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){n=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var M=function(){function t(){u(this,t),this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__width=0,this.__height=0,this.__baseLine=0,this.__prev=null,this.__next=null,this.__parent=null,this.__root=null,this.__host=null}return l(t,[{key:"__offsetX",value:function(t,e){e?this.__x+=t:this.__ox+=t}},{key:"__offsetY",value:function(t,e){e?this.__y+=t:this.__oy+=t}},{key:"__destroy",value:function(){this.__isDestroyed=!0,this.__parent=null}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"sx",get:function(){return this.x+this.ox}},{key:"sy",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),t}();var p=.5*Math.PI;var q={canvasPolygon:function(t,e){if(e&&e.length){t.moveTo(e[0][0],e[0][1]);for(var i=1,r=e.length;i<r;i++){var n=e[i];Array.isArray(n)&&(2===n.length?t.lineTo(n[0],n[1]):4===n.length?t.quadraticCurveTo(n[0],n[1],n[2],n[3]):6===n.length&&t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]))}}},svgPolygon:function(t){if(!t||!t.length)return"";for(var e="M"+t[0][0]+","+t[0][1],i=1,r=t.length;i<r;i++){var n=t[i];Array.isArray(n)&&(2===n.length?e+="L"+n[0]+","+n[1]:4===n.length?e+="Q"+n[0]+","+n[1]+" "+n[2]+","+n[3]:6===n.length&&(e+="C"+n[0]+","+n[1]+" "+n[2]+","+n[3]+" "+n[4]+","+n[5]))}return e},canvasLine:function(t,e,i,r,n,a,o,s){t.moveTo(e,i),3===s?t.bezierCurveTo(a[0],a[1],o[0],o[1],r,n):2===s?t.quadraticCurveTo(o[0],o[1],r,n):1===s?t.quadraticCurveTo(a[0],a[1],r,n):t.lineTo(r,n)},svgLine:function(t,e,i,r,n,a,o){return 3===o?"M"+t+","+e+"C"+n[0]+","+n[1]+" "+a[0]+","+a[1]+" "+i+","+r:2===o?"M"+t+","+e+"Q"+a[0]+","+a[1]+" "+i+","+r:1===o?"M"+t+","+e+"Q"+n[0]+","+n[1]+" "+i+","+r:"M"+t+","+e+"L"+i+","+r},canvasSector:function(t,e,i,r,n,a,o,s,h,u,l,c,f,d){t.arc(e,i,r,u*Math.PI/180-p,l*Math.PI/180-p),f?(c&&d||t.lineTo(e,i),t.lineTo(n,a),0<h&&t.stroke()):(0<h&&t.stroke(),c&&d||t.lineTo(e,i),t.lineTo(n,a))},svgSector:function(t,e,i,r,n,a,o,s,h,u,l){var c;return(!u||0<s)&&(c="M"+r+","+n+"A"+i+","+i+" 0 "+h+" 1 "+a+","+o),[l&&h?"M"+r+","+n+"A"+i+","+i+" 0 "+h+" 1 "+a+","+o+"z":"M"+t+","+e+"L"+r+","+n+"A"+i+","+i+" 0 "+h+" 1 "+a+","+o+"z",c]}},we={CANVAS:0,SVG:1},s={AUTO:0,PX:1,PERCENT:2,NUMBER:3,INHERIT:4,DEG:5,STRING:6,RGBA:7};var Se={identity:function(){return[1,0,0,1,0,0]},multiply:function(t,e){var i=1===t[0]&&0===t[1]&&0===t[2]&&1===t[3],r=1===e[0]&&0===e[1]&&0===e[2]&&1===e[3],n=0===t[4]&&0===t[5],a=0===e[4]&&0===e[5];if(i&&n)return e;if(r&&a)return t;if(i&&r)return(t=t.slice(0))[4]+=e[4],t[5]+=e[5],t;if(i||r){var o=i?e.slice(0):t.slice(0);return o[4]=t[0]*e[4]+t[2]*e[5]+t[4],o[5]=t[1]*e[4]+t[3]*e[5]+t[5],o}var s=[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],0,0];return n&&a||(a?(s[4]=t[4],s[5]=t[5]):(s[4]=t[0]*e[4]+t[2]*e[5]+t[4],s[5]=t[1]*e[4]+t[3]*e[5]+t[5])),s},calPoint:function(t,e){var i=xe(t,2),r=i[0],n=i[1],a=xe(e,6),o=a[0],s=a[1],h=a[2],u=a[3];return[o*r+h*n+a[4],s*r+u*n+a[5]]},int2convolution:function(t){var e=Math.floor(3*t*Math.sqrt(2*Math.PI)/4+.5);return(e*=3)%2==0&&e++,e}},h=4*(Math.sqrt(2)-1)/3;function b(t,e,i,r){return t*r-i*e}function d(t,e,i,r){return Math.sqrt(Math.pow(i-t,2)+Math.pow(r-e,2))}function _(t,e){var i=xe(t,4),r=i[0],n=i[1],a=i[2],o=i[3],s=xe(e,4),h=s[0],u=s[1],l=s[2],c=s[3];return!(l<=r||c<=n||a<=h||o<=u)}function y(t,e,i){var r=i.matrix,n=void 0===r?[1,0,0,1,0,0]:r,a=i.computedStyle,o=void 0===a?{}:a,s=o.width,h=o.height,u=o.transformOrigin,l=xe(u=void 0===u?[.5*s,.5*h]:u,2),c=l[0],f=l[1],d=xe(Se.calPoint([t*s-c,e*h-f],n),2);return[(t=d[0])+c,(e=d[1])+f]}var Ae={vectorProduct:b,pointInPolygon:function(t,e,i){for(var r=xe(i[0],2),n=r[0],a=r[1],o=xe(i[0],2),s=o[0],h=o[1],u=i.length,l=1;l<u;l++)var c=xe(i[l],2),f=c[0],d=c[1],n=Math.max(n,f),a=Math.max(a,d),s=Math.min(s,f),h=Math.min(h,d);if(t<s||e<h||n<t||a<e)return!1;for(var p=0,_=i.length;p<_;p++){var v=xe(i[p],2),y=v[0],g=v[1],m=xe(i[(p+1)%_],2);if(b(m[0]-y,m[1]-g,t-y,e-g)<0)return!1}return!0},d2r:function(t){return t*Math.PI/180},r2d:function(t){return 180*t/Math.PI},H:h,h:function(t){return t*=.5,(1-Math.cos(t))/Math.sin(t)*4/3},angleBySide:function(t,e,i){var r=(Math.pow(e,2)+Math.pow(i,2)-Math.pow(t,2))/(2*e*i);return Math.acos(r)},pointsDistance:d,triangleIncentre:function(t,e,i,r,n,a){var o=d(i,r,n,a),s=d(t,e,n,a),h=d(t,e,i,r);return[(o*t+s*i+h*n)/(o+s+h),(o*e+s*r+h*a)/(o+s+h)]},ellipsePoints:function(t,e,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:i,n=i*h,a=r===i?n:r*h;return[[t-i,e],[t-i,e-a,t-n,e-r,t,e-r],[t+n,e-r,t+i,e-a,t+i,e],[t+i,e+a,t+n,e+r,t,e+r],[t-n,e+r,t-i,e+a,t-i,e]]},getRectsIntersection:function(t,e){if(!_(t,e))return null;var i=xe(t,4),r=i[0],n=i[1],a=i[2],o=i[3],s=xe(e,4),h=s[0],u=s[1],l=s[2],c=s[3];return[Math.max(r,h),Math.max(n,u),Math.min(a,l),Math.min(o,c)]},isRectsOverlap:_,isRectsInside:function(t,e){var i=xe(t,4),r=i[0],n=i[1],a=i[2],o=i[3],s=xe(e,4),h=s[0],u=s[1],l=s[2],c=s[3];return r<=h&&n<=u&&l<=a&&c<=o},calCoordsInNode:y,calPercentInNode:function(t,e,i){var r,n=i.computedStyle,a=n.width,o=n.height,s=xe(n.transformOrigin,2),h=s[0],u=s[1],l=Math.atan((o-u)/(a-h)),c=xe(y(1,1,i),2),f=c[0],d=c[1],p=h<=f&&u<=d?(r=Math.atan((d-u)/(f-h)))-l:h<=f&&d<u?(r=Math.atan((u-d)/(f-h)))+l:f<h&&u<=d?(r=Math.atan((d-u)/(h-f)))-l:f<h&&d<u?(r=Math.atan((d-u)/(f-h)))<=l?r+Math.PI-l:-(p=Math.PI-r+l):0;if(0===p)return[h/a,u/a];var _=Math.sqrt(Math.pow(t-h,2)+Math.pow(e-u,2)),v=h<=t&&u<=e?Math.atan((e-u)/(t-h)):h<=t&&e<u?-Math.atan((e-u)/(h-t)):t<h&&u<=e?Math.PI-Math.atan((e-u)/(h-t)):Math.atan((e-u)/(t-h))-Math.PI;return(v-=p)>Math.PI?(v-=Math.PI,[(h-_*Math.cos(v))/a,(u-_*Math.sin(v))/o]):v>.5*Math.PI?(v=Math.PI-v,[(h-_*Math.cos(v))/a,(u+_*Math.sin(v))/o]):0<=v?[(h+_*Math.cos(v))/a,(u+_*Math.sin(v))/o]:v>=.5*-Math.PI?(v=-v,[(h+_*Math.cos(v))/a,(u-_*Math.sin(v))/o]):v>=-Math.PI?(v=Math.PI+v,[(h-_*Math.cos(v))/a,(u-_*Math.sin(v))/o]):(v=-Math.PI-v,[(h-_*Math.cos(v))/a,(u+_*Math.sin(v))/o])}};function X(t,e,i,r){var n=i-t,a=r-e,o=Math.atan(Math.abs(a)/Math.abs(n));return n<0&&0<=a?Math.PI-o:n<0&&a<0?o-Math.PI:0<=n&&0<=a?o:-o}function Y(t){var e=Math.sin(t),i=Math.cos(t),r=Se.identity();return r[0]=r[3]=i,r[1]=e,r[2]=-e,r}function z(t,e){var i=xe(t,6),r=i[0],n=i[1],a=i[2],o=i[3],s=i[4],h=i[5],u=xe(e,6),l=u[0],c=u[1],f=u[2],d=u[3],p=u[4],_=(a-r)*(h-n)-(s-r)*(o-n),v=(f-l)*(u[5]-c)-(p-l)*(d-c);return 0<_&&v<0||_<0&&0<v}var v={exchangeOrder:function(t,e){var i,r,n,a,o,s,h,u,l,c,f,d,p,_,v,y,g=(l=xe(t,6),c=l[0],f=l[1],d=l[2],p=l[3],_=l[4],v=l[5],y=[0,1,2],d<c&&d<_?(c=(i=[d,p,c,f])[0],f=i[1],d=i[2],p=i[3],y[0]=1,y[1]=0):_<d&&_<c&&(c=(r=[_,v,c,f])[0],f=r[1],_=r[2],v=r[3],y[0]=2,y[2]=0),c===d?p<f&&(c=(n=[d,p,c,f])[0],f=n[1],d=n[2],p=n[3],a=y[0],y[0]=y[1],y[1]=a):c===_&&v<f&&(c=(o=[_,v,c,f])[0],f=o[1],_=o[2],v=o[3],s=y[0],y[0]=y[2],y[2]=s),(d-c)*(v-f)-(_-c)*(p-f)<0&&(d=(h=[_,v,d,p])[0],p=h[1],_=h[2],v=h[3],u=y[1],y[1]=y[2],y[2]=u),[c,f,d,p,_,v,y]),m=xe(g,7),b=m[0],k=m[1],x=m[2],M=m[3],w=m[4],S=m[5],A=xe(function(t,e){for(var i=[],r=0,n=e.length;r<n;r++){var a=e[r];i.push(t[2*a]),i.push(t[2*a+1])}return i}(e,m[6]),6);return[[b,k,x,M,w,S],[A[0],A[1],A[2],A[3],A[4],A[5]]]},isOverflow:z,transform:function(t,e){var i,r=xe(t,6),n=r[0],a=r[1],o=r[2],s=r[3],h=r[4],u=r[5],l=xe(e,6),c=l[0],f=l[1],d=l[2],p=l[3],_=l[4],v=l[5],y=z(t,e),g=Se.identity();g[4]=-n,g[5]=-a;var m=X(n,a,o,s);0!==m&&(i=Y(-m),g=Se.multiply(i,g));var b=Ae.pointsDistance(n,a,o,s),k=Ae.pointsDistance(c,f,d,p),x=Se.identity();x[4]=-c,x[5]=-f;var M=m=X(c,f,d,p);0!==m&&(i=Y(-m),x=Se.multiply(i,x));var w=Math.abs(Se.calPoint([h,u],g)[1]),S=Math.abs(Se.calPoint([_,v],x)[1]);b===k&&w===S||(i=Se.identity(),b!==k&&(i[0]=k/b),w!==S&&(i[3]=S/w),g=Se.multiply(i,g)),x=g;var A=xe(Se.calPoint([n,a],x),2),E=A[0],P=A[1],T=xe(Se.calPoint([o,s],x),2),R=T[0],C=T[1],L=xe(Se.calPoint([h,u],x),2),O=L[0],N=L[1],D=Ae.pointsDistance(E,P,R,C),F=Ae.pointsDistance(E,P,O,N),I=Ae.pointsDistance(O,N,R,C),W=Ae.pointsDistance(c,f,d,p),B=Ae.pointsDistance(c,f,_,v),H=Ae.pointsDistance(_,v,d,p),G=Ae.angleBySide(I,D,F),$=Ae.angleBySide(H,W,B);return G!==$&&((i=Se.identity())[2]=Math.tan(G-.5*Math.PI)+Math.tan(.5*Math.PI-$),g=Se.multiply(i,g)),y&&(g[1]=-g[1],g[3]=-g[3],g[5]=-g[5]),(i=0!==M?Y(M):Se.identity())[4]=c,i[5]=f,g=Se.multiply(i,g)}},g={matrix:Se,tar:v,geom:Ae},m={TYPE_VD:{_:1},TYPE_GM:{_:2},TYPE_CP:{_:3},TYPE_PL:{_:0}},k={}.toString;function x(e){return function(t){return k.call(t)==="[object "+e+"]"}}var w=x("Object"),S=x("String"),A=x("Function"),E=x("Number"),P=x("Boolean"),T=x("Date");function R(t){return null==t}function C(t){return R(t)?"":t.toString()}function L(t){if("item"===t.type||"img"===t.type){var e="";return(t.props||[]).forEach(function(t){e+=" "+t[0]+'="'+t[1]+'"'}),"text"===t.tagName?"<text"+e+">"+t.content+"</text>":"<"+t.tagName+e+"/>"}if("text"===t.type){var i="";return(t.children||[]).forEach(function(t){i+=L(t)}),"<g>"+i+"</g>"}if("dom"===t.type||"geom"===t.type){var r="<g";t.bbClip&&(r+=' clip-path="'+t.bbClip+'"'),r+=">",t.bb.forEach(function(t){r+=L(t)}),r+="</g><g",t.conClip&&(r+=' clip-path="'+t.conClip+'"'),r+=">",(t.children||[]).forEach(function(t){t.isMask||t.isClip||(r+=L(t))}),r+="</g>";var n=t.opacity,a=t.transform,o=t.mask,s=t.clip,h=t.filter;return"<g"+(1!==n?' opacity="'+n+'"':"")+(a?' transform="'+a+'"':"")+(o?' mask="'+o+'"':"")+(s?' clip-path="'+s+'"':"")+(h?' filter="'+h+'"':"")+">"+r+"</g>"}}function O(t){var r="<"+t.tagName+' id="'+t.uuid+'"';return"mask"===t.tagName||"clipPath"===t.tagName||"filter"===t.tagName||(r+=' gradientUnits="userSpaceOnUse"'),(t.props||[]).forEach(function(t){r+=" "+t[0]+'="'+t[1]+'"'}),r+=">",(t.children||[]).forEach(function(t){var e,i;r+=(i="<"+(e=t).tagName,(e.props||[]).forEach(function(t){i+=" "+t[0]+'="'+t[1]+'"'}),i+="></"+e.tagName+">")}),r+="</"+t.tagName+">"}function N(t,e){for(var i=t.length?t[0]:"",r=1,n=t.length;r<n;r++)i+=e+t[r];return i}var Ee={isObject:w,isString:S,isFunction:A,isNumber:E,isBoolean:P,isDate:T,isNil:R,isPrimitive:function(t){return Ee.isNil(t)||Ee.isBoolean(t)||Ee.isString(t)||Ee.isNumber(t)},stringify:C,joinSourceArray:function t(e){for(var i="",r=0,n=e.length;r<n;r++){var a=e[r];Array.isArray(a)?i+=t(a):i+=C(a)}return i},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},joinVirtualDom:function(t){var e="<defs>";return t.defs.forEach(function(t){e+=O(t)}),e+="</defs><g",t.bbClip&&(e+=' clip-path="'+t.bbClip+'"'),e+=">",t.bb.forEach(function(t){e+=L(t)}),e+="</g><g",t.conClip&&(e+=' clip-path="'+t.conClip+'"'),e+=">",(t.children||[]).forEach(function(t){t.isMask||t.isClip||(e+=L(t))}),e+="</g>"},joinVd:L,joinDef:O,rgba2int:function(t){if(Array.isArray(t))return t;var e,i=[];return t&&"transparent"!==t?"#"===t.charAt(0)?(3===(t=t.slice(1)).length?(i.push(parseInt(t.charAt(0)+t.charAt(0),16)),i.push(parseInt(t.charAt(1)+t.charAt(1),16)),i.push(parseInt(t.charAt(2)+t.charAt(2),16))):6===t.length?(i.push(parseInt(t.slice(0,2),16)),i.push(parseInt(t.slice(2,4),16)),i.push(parseInt(t.slice(4),16))):i[0]=i[1]=i[2]=0,i[3]=1):(e=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\s*\)/i))?(i=[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])],R(e[4])?i[3]=1:i[3]=parseFloat(e[4])):i=[0,0,0,0]:i=[0,0,0,0],i},int2rgba:function(t){if(Array.isArray(t)){if(4===t.length)return"rgba("+N(t,",")+")";if(3===t.length)return"rgba("+N(t,",")+",1)"}return t||"rgba(0,0,0,0)"},arr2hash:function(t){for(var e={},i=0,r=t.length;i<r;i++){var n=t[i];if(Array.isArray(n))e[n[0]]=n[1];else for(var a=Object.keys(n),o=a.length-1;0<=o;o--){var s=a[o];e[s]=n[s]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],i=Object.keys(t),r=0,n=i.length;r<n;r++){var a=i[r];e.push([a,t[a]])}return e},clone:function e(i){if(R(i)||"object"!==o(i))return i;if(i.$$type===m.TYPE_PL||i.$$type===m.TYPE_VD||i.$$type===m.TYPE_GM||i.$$type===m.TYPE_CP)return i;if(Ee.isDate(i))return new Date(i);var r=Array.isArray(i)?[]:{};return Object.keys(i).forEach(function(t){r[t]=e(i[t])}),r},equalArr:function t(e,i){if(!e||!i)return e===i;if(e.length!==i.length)return!1;for(var r=0,n=e.length;r<n;r++){var a=e[r],o=i[r],s=Array.isArray(a),h=Array.isArray(o);if(s&&h){if(!t(a,o))return!1}else{if(s||h)return!1;if(a!==o)return!1}}return!0},equal:function t(e,i){if(e===i)return!0;if(w(e)&&w(i)){for(var r={},n=0,a=Object.keys(e),o=a.length;n<o;n++){var s=a[n];if(!i.hasOwnProperty(s)||!t(e[s],i[s]))return!1;r[s]=!0}for(var h=0,u=Object.keys(i),l=u.length;h<l;h++){var c=u[h];if(!r.hasOwnProperty(c))return!1}}else{if(T(e)&&T(i))return e.getTime()===i.getTime();if(!Array.isArray(e)||!Array.isArray(i))return e===i;if(e.length!==i.length)return!1;for(var f=0,d=e.length;f<d;f++)if(!t(e[f],i[f]))return!1}return!0},extend:function(t,e,i){if(null===e||"object"!==o(e))return t;for(var r=0,n=(i=i||Object.keys(e)).length;r<n;){var a=i[r];t[a]=e[a],r++}return t},joinArr:N,extendAnimate:function(t,e){(e.__animationList=t.animationList.splice(0)).forEach(function(t){t.__target=e,t.assigning&&t.assignCurrentStyle()})}},D=s.PX,F=s.PERCENT,I=g.matrix,W=g.geom,B=I.identity,H=I.calPoint,G=I.multiply,$=W.d2r,j=W.pointInPolygon;function V(t,e,i){var n,a,o,r=(n=e,a=i,o=[],t.forEach(function(t){var e=xe(t,2),i=e[0],r=e[1];o.push([i,function(t,e,i,r){if("translateX"===t){if(e.unit===F)return e.value*i*.01}else if("translateY"===t){if(e.unit===F)return e.value*r*.01}else if("matrix"===t)return e;return e.value}(i,r,n,a)])}),o),l=B();return r.forEach(function(t){var e,i,r,n,a,o=xe(t,2),s=o[0],h=o[1],u=B();e=u,r=h,"translateX"===(i=s)?e[4]=r:"translateY"===i?e[5]=r:"scaleX"===i?e[0]=r:"scaleY"===i?e[3]=r:"skewX"===i?(r=$(r),e[2]=Math.tan(r)):"skewY"===i?(r=$(r),e[1]=Math.tan(r)):"rotateZ"===i?(r=$(r),n=Math.sin(r),a=Math.cos(r),e[0]=e[3]=a,e[1]=n,e[2]=-n):"matrix"===i&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5]),l=G(l,u)}),l}function U(t,e){var i=xe(e,2),r=i[0],n=i[1];if(0===r&&0===n)return t;var a=B();a[4]=r,a[5]=n;var o=G(a,t),s=B();return s[4]=-r,s[5]=-n,G(o,s)}var Pe={calMatrix:V,calOrigin:function(t,i,r){var n=[];return t.forEach(function(t,e){t.unit===D?n.push(t.value):t.unit===F&&n.push(t.value*(e?r:i)*.01)}),n},calMatrixByOrigin:U,calMatrixWithOrigin:function(t,e,i,r){return U(V(t,i,r),e)},pointInQuadrilateral:function(t,e,i,r,n,a,o,s,h,u,l){if(!l||Ee.equalArr(l,[1,0,0,1,0,0]))return i<=t&&r<=e&&t<=o&&e<=s;var c=xe(H([i,r],l),2);i=c[0],r=c[1];var f=xe(H([n,a],l),2);n=f[0],a=f[1];var d=xe(H([h,u],l),2);h=d[0],u=d[1];var p=xe(H([o,s],l),2);return o=p[0],s=p[1],j(t,e,[[i,r],[n,a],[o,s],[h,u]])}},Z={position:/((-?[\d.]+(px|%)?)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-gradient\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i},te=Ee.rgba2int,ee=Ee.int2rgba,Q=Ee.isNil,tt=s.PX,ie=s.PERCENT,et=Ae.d2r;function it(t){if(/%$/.test(t)||/px$/.test(t)||/^-?[\d.]+$/.test(t))return{value:parseFloat(t),unit:/%/.test(t)?ie:tt};var e={value:{top:0,left:0,center:50,right:100,bottom:100}[t],unit:ie};return Q(e.value)&&(e.value=50),e}function rt(t,e){for(var i,r=[],n=0,a=t.length;n<a;n++){var o,s,h=t[n];1<h.length?(o=ee(h[0]),(s=h[1]).unit===ie?r.push([o,.01*s.value]):r.push([o,s.value/e])):r.push([ee(h[0])])}1===r[0].length&&r[0].push(0),1<r.length&&(1===r[i=r.length-1].length&&r[i].push(1));for(var u=r[0][1],l=1,c=r.length;l<c-1;l++){var f=r[l];if(1<f.length)u=f[1];else{for(var d=l+1,p=r[r.length-1][1];d<c-1;d++){var _=r[d];if(1<_.length){p=_[1];break}}for(var v=(p-u)/(d-l+1),y=l;y<d;y++){r[y].push(u+v*(y+1-l))}l=d}}for(var g=1,m=r.length;g<m;g++){var b=r[g],k=r[g-1];b[1]<k[1]&&(b[1]=k[1])}for(var x=0,M=r.length;x<M-1;x++){if(1<r[x][1]){r.splice(x+1);break}}for(var w=r.length-1;0<w;w--){if(r[w][1]<0){r.splice(0,w);break}}var S,A,E,P,T,R,C,L,O,N,D,F,I,W,B,H,G,$,X,Y,z,j,V,U,q,Z,K,J,Q,tt,et,it,rt,nt,at,ot,st,ht,ut,lt,ct,ft,dt,pt,_t,vt,yt,gt,mt,bt,kt,xt,Mt,wt,St,At,Et,Pt,Tt,Rt,Ct,Lt,Ot,Nt,Dt,Ft,It,Wt,Bt=r.length;if(1===Bt)r[0][1]=0;else{for(var Ht,Gt,$t,Xt,Yt,zt,jt,Vt,Ut,qt,Zt=!0,Kt=!0,Jt=Bt-1;0<=Jt;Jt--){var Qt=r[Jt][1];0<Qt&&(Zt=!1),Qt<1&&(Kt=!1)}Zt?(r.splice(0,Bt-1),r[0][1]=0):Kt?(r.splice(1),r[0][1]=0):(Ht=r[0],Gt=r[Bt-1],2===Bt?Ht[1]<0&&1<Gt[1]&&(vt=Gt,yt=e,gt=te((_t=Ht)[0]),mt=te(vt[0]),bt=xe(gt,4),kt=bt[0],xt=bt[1],Mt=bt[2],wt=bt[3],St=void 0===wt?1:wt,At=xe(mt,4),Et=At[0],Pt=At[1],Tt=At[2],Rt=At[3],Ct=void 0===Rt?1:Rt,Lt=Math.abs(_t[1])*yt,Ot=vt[1]*yt,Nt=Lt/(Lt+Ot),Dt=Math.floor(kt+(Et-kt)*Nt),Ft=Math.floor(xt+(Pt-xt)*Nt),It=Math.floor(Mt+(Tt-Mt)*Nt),Wt=St+(Ct-St)*Nt,_t[0]="rgba("+Dt+","+Ft+","+It+","+Wt+")",_t[1]=0,Nt=(yt+Lt)/(Lt+Ot),Dt=Math.floor(kt+(Et-kt)*Nt),Ft=Math.floor(xt+(Pt-xt)*Nt),It=Math.floor(Mt+(Tt-Mt)*Nt),Wt=St+(Ct-St)*Nt,vt[0]="rgba("+Dt+","+Ft+","+It+","+Wt+")",vt[1]=1):(Ht[1]<0&&($t=r[1],Xt=te(Ht[0]),Yt=te($t[0]),V=Xt,U=Ht[1],q=Yt,Z=$t[1],K=e,J=xe(V,4),Q=J[0],tt=J[1],et=J[2],it=J[3],rt=void 0===it?1:it,nt=xe(q,4),at=nt[0],ot=nt[1],st=nt[2],ht=nt[3],ut=void 0===ht?1:ht,lt=Math.abs(U)*K,ct=lt/(Z*K+lt),ft=Math.floor(Q+(at-Q)*ct),dt=Math.floor(tt+(ot-tt)*ct),pt=Math.floor(et+(st-et)*ct),zt=[ft,dt,pt,rt+(ut-rt)*ct],Ht[0]="rgba("+zt[0]+","+zt[1]+","+zt[2]+","+zt[3]+")",Ht[1]=0),1<Gt[1]&&(jt=r[Bt-2],Vt=te(jt[0]),Ut=te(Gt[0]),S=Vt,A=jt[1],E=Ut,P=Gt[1],T=e,R=xe(S,4),C=R[0],L=R[1],O=R[2],N=R[3],D=void 0===N?1:N,F=xe(E,4),I=F[0],W=F[1],B=F[2],H=F[3],G=void 0===H?1:H,X=(T-($=A*T))/(P*T-$),Y=Math.floor(C+(I-C)*X),z=Math.floor(L+(W-L)*X),j=Math.floor(O+(B-O)*X),qt=[Y,z,j,D+(G-D)*X],Gt[0]="rgba("+qt[0]+","+qt[1]+","+qt[2]+","+qt[3]+")",Gt[1]=1)))}return r.forEach(function(t){t[1]<0?t[1]=0:1<t[1]&&(t[1]=1)}),r}var nt={parseGradient:function(t){var e,i,r,n=Z.gradient.exec(t);if(n){var a,o,s,h,u,l={k:n[1]};"linear"===l.k?(a=/(-?[\d.]+deg)|(to\s+[toprighbml]+)/i.exec(n[2]),l.d=a?(e=a[0].toLowerCase(),r=180,"to top"===e?r=0:"to top right"===e?r=45:"to right"===e?r=90:"to bottom right"===e?r=135:"to bottom"===e||("to bottom left"===e?r=225:"to left"===e?r=270:"to top left"===e?r=315:(i=/(-?[\d.]+)deg/.exec(e))&&(r=parseFloat(i[1]))),r%360):180):"radial"===l.k&&(l.s=-1<n[2].indexOf("ellipse")?"ellipse":"circle",o=/(closest|farthest)-(side|corner)/i.exec(n[2]),l.z=o?o[0].toLowerCase():"farthest-corner",(s=/at\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center))(?:\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center)))?/i.exec(n[2]))?(h=it(s[1]),u=s[2]?it(s[2]):h,l.p=[h,u]):l.p=[{value:50,unit:ie},{value:50,unit:ie}]);var c=n[2].match(/((#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*(-?[\d.]+(px|%))?/gi);return l.v=c.map(function(t){var e=/((?:#[0-9a-f]{3,6})|(?:rgba?\(.+?\)))\s*(-?[\d.]+(?:px|%))?/i.exec(t),i=[te(e[1])];return e[2]&&(i[1]={value:parseFloat(e[2])},/%$/.test(e[2])?i[1].unit=ie:i[1].unit=tt),i}),l}},getLinear:function(t,e,i,r,n,a){var o,s,h,u,l,c,f,d,p,_,v,y,g=et(e),m=Math.abs(n*Math.sin(g))+Math.abs(a*Math.cos(g)),b=xe((s=.5*m,h=i,u=r,p=270<=(o=e)?(l=et(360-o),c=h+Math.sin(l)*s,f=u+Math.cos(l)*s,d=h-Math.sin(l)*s,u-Math.cos(l)*s):180<=o?(_=et(o-180),c=h+Math.sin(_)*s,f=u-Math.cos(_)*s,d=h-Math.sin(_)*s,u+Math.cos(_)*s):90<=o?(v=et(180-o),c=h-Math.sin(v)*s,f=u-Math.cos(v)*s,d=h+Math.sin(v)*s,u+Math.cos(v)*s):(y=et(o),c=h-Math.sin(y)*s,f=u+Math.cos(y)*s,d=h+Math.sin(y)*s,u-Math.cos(y)*s),[c,f,d,p]),4);return{x1:b[0],y1:b[1],x2:b[2],y2:b[3],stop:rt(t,m)}},getRadial:function(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v,y,g,m,b,k,x,M,w,S,A,E=o-n,P=s-a,T=xe((h=i,l=E,c=P,f=n,d=a,p=o,_=s,w=(u=r)[0].unit===tt?f+u[0].value:f+u[0].value*l*.01,S=u[1].unit===tt?d+u[1].value:d+u[1].value*c*.01,["closest-side"===h?w<=f||p<=w||S<=d||_<=S?0:(v=w<f+.5*l?w-f:p-w,y=S<d+.5*c?S-d:_-S,Math.min(v,y)):"closest-corner"===h?(g=w<f+.5*l?w-f:p-w,m=S<d+.5*c?S-d:_-S,Math.sqrt(Math.pow(g,2)+Math.pow(m,2))):"farthest-side"===h?w<=f?f-w+l:p<=w?w-p+l:S<=d?d-S+c:_<=w?S-_+c:(b=Math.max(p-w,w-f),k=Math.max(_-S,S-d),Math.max(b,k)):(x=w<f+.5*l?p-w:w-f,M=S<d+.5*c?_-S:S-d,Math.sqrt(Math.pow(x,2)+Math.pow(M,2))),w,S]),3),R=T[0],C=T[1],L=T[2],O=rt(t,2*R);return R<=0&&((A=O[O.length-1])[1]=0,O=[A],C=n,L=a,R=E+P),{cx:C,cy:L,r:R,stop:O}}},at=Ae.H;function ot(t,e,i,r,n,a,o,s){var h=1,u=1,l=1;t:for(var c=a;n<=c;c--)for(var f=s;o<=f;f--){var d=c+f,p=Math.floor((t+f)/d),_=f;if(p*d<f+t)if(s<(_=(t-p*c)/(p-1)))continue;if(d=c+_,1<e&&c<e){if(c<e%d)continue;if(1<i)if(c<(e+r)%d)continue}if(1<i)if(c<(e+r)%d)continue;0<p&&(h=p,u=c,l=_);break t}return{n:h,ps:u,pd:l}}function st(t,e,i,r,n,a){var o=n-e,s=r-i,h=i-e,u=n-r;if("dotted"===t)return ot(o,h,u,s,a,a,Math.max(1,.25*a),2*a);var l=ot(o,h,u,s,a,3*a,Math.max(1,.25*a),2*a),c=l.n,f=l.ps,d=l.pd;return 1===c?ot(o,h,u,s,a,a,Math.max(1,.25*a),2*a):{n:c,ps:f,pd:d}}function ht(t,e,i,r,n,a,o,s,h,u,l,c,f,d){var p=xe(f,2),_=p[0],v=p[1],y=xe(d,2),g=y[0],m=y[1];if(!(_&&v||g&&m))return c;for(var b,k,x,M,w,S,A,E,P,T,R,C,L,O,N,D=n+_-(n-r),F=a-g+(o-a),I=[],W=[],B=[],H=0,G=c.length;H<G;H++){var $,X,Y,z,j=c[H];j[1][0]<D?I.push(j):j[0][0]>F?B.push(j):j[1][0]>F&&j[0][0]<D?($=D<n?s+Math.tan(e)*(D-r):h,X=a<F?s+Math.tan(i)*(o-F):h,I.push([j[0],[D,s],[D,$],j[3]]),D<F&&(n<D&&F<a?W.push([[D,s],[F,s],[F,h],[D,h]]):n<D?(W.push([[D,s],[a,s],[a,h],[D,h]]),W.push([[a,s],[F,s],[F,X],[a,h]])):F<a?(W.push([[D,s],[n,s],[n,h],[D,$]]),W.push([[n,s],[F,s],[F,h],[n,h]])):(W.push([[D,s],[n,s],[n,h],[D,$]]),W.push([[n,s],[a,s],[a,h],[n,h]]),W.push([[a,s],[F,s],[F,X],[a,h]]))),B.push([[F,s],j[1],j[2],[F,X]])):j[1][0]>F?(Y=a<F?s+Math.tan(i)*(o-F):h,W.push([j[0],[F,s],[F,Y],j[3]]),B.push([[F,s],j[1],j[2],[F,Y]])):j[0][0]<D?(z=D<n?s+Math.tan(e)*(D-r):h,I.push([j[0],[D,s],[D,z],j[3]]),W.push([[D,s],j[1],j[2],[D,z]])):W.push(j)}I.length&&(b=n-r<_&&t<v,k=Math.atan((n-r)/(h-s)),M=(x=v)/_,w=s+v,A=(S=v-(h-s))/(_-(n-r)),P=xe((E=ut(I[0][0],I[0][1],D,w,M,x,!0,Math.tan(k)*x))[0],2),O=P[0],N=P[1],b&&(R=xe((T=ut(I[0][3],I[0][2],D,w,A,S,!0,Math.tan(k)*S))[0],2),C=R[0],L=R[1]),I.forEach(function(t,e){var i,r;0===e?(i=E,b&&(r=T)):(i=ut(t[0],t[1],D,w,M,x),b&&(r=ut(t[3],t[2],D,w,A,S)));for(var n=0,a=i.length;n<a;n++)bt(i[n],O,N,0);if(t[0]=i[0],t[1]=i[1].concat(i[2]).concat(i[3]),b){for(var o=0,s=r.length;o<s;o++)bt(r[o],C,L,0);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[3],t[3]=r[2].concat(r[1]).concat(r[0]))}}));var V,U,q,Z,K,J,Q,tt,et,it,rt,nt,at,ot,st,ht=B.length;return ht&&(V=o-a<g&&t<m,U=Math.atan((o-a)/(h-s)),Z=(q=m)/g,K=s+m,Q=(J=m-(h-s))/(g-(o-a)),et=xe((tt=lt(B[ht-1][0],B[ht-1][1],F,K,Z,q,!0,Math.tan(U)*q))[tt.length-1],2),ot=et[0],st=et[1],V&&(rt=xe((it=lt(B[ht-1][3],B[ht-1][2],F,K,Q,J,!0,Math.tan(U)*J))[it.length-1],2),nt=rt[0],at=rt[1]),B.forEach(function(t,e){var i,r;e===ht-1?(i=tt,V&&(r=it)):(i=lt(t[0],t[1],F,K,Z,q),V&&(r=lt(t[3],t[2],F,K,Q,J)));for(var n=0,a=i.length;n<a;n++)bt(i[n],ot,st,1);if(t[0]=i[0],t[1]=i[1].concat(i[2]).concat(i[3]),V){for(var o=0,s=r.length;o<s;o++)bt(r[o],nt,at,1);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[3],t[3]=r[2].concat(r[1]).concat(r[0]))}})),I.concat(W).concat(B)}function ut(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(-y+i)*n,M=(-b+i)*n,w=Math.atan(M/(r-k)),S=i-Math.sin(w)*a/n,A=r-Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i-Math.cos(f)*a/n,r-Math.sin(f)*a):(d=Math.atan(x/(r-g)),p=i-Math.sin(d)*a/n,r-Math.cos(d)*a),d===w)return[[p,_]];var E=Ae.h(Math.abs(d-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=d-T,C=w+T;return[[p,_],[i-Math.sin(R)*P/n,r-Math.cos(R)*P],[i-Math.sin(C)*P/n,r-Math.cos(C)*P],[S,A]]}function lt(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(y-i)*n,M=(b-i)*n,w=Math.atan(x/(r-g)),S=i+Math.sin(w)*a/n,A=r-Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i+Math.cos(f)*a/n,r-Math.sin(f)*a):(d=Math.atan(M/(r-k)),p=i+Math.sin(d)*a/n,r-Math.cos(d)*a),w===d)return[[S,A]];var E=Ae.h(Math.abs(w-d))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w+T,C=d-T;return[[S,A],[i+Math.sin(R)*P/n,r-Math.cos(R)*P],[i+Math.sin(C)*P/n,r-Math.cos(C)*P],[p,_]]}function ct(t,e,i,r,n,a,o,s,h,u,l,c,f,d){var p=xe(f,2),_=p[0],v=p[1],y=xe(d,2),g=y[0],m=y[1];if(!(_&&v||g&&m))return c;for(var b,k,x,M,w,S,A,E,P,T,R,C,L,O,N,D=h+v-(h-s),F=u-m+(l-u),I=[],W=[],B=[],H=0,G=c.length;H<G;H++){var $,X,Y,z,j=c[H];j[2][1]<D?I.push(j):j[1][1]>F?B.push(j):j[2][1]>F&&j[1][1]<D?($=D<h?a+Math.tan(i)*(h-D):a,X=u<F?a+Math.tan(e)*(F-u):a,I.push([j[0],j[1],[o,D],[$,D]]),D<F&&(F<u&&h<D?W.push([[a,D],[o,D],[o,F],[a,F]]):h<D?(W.push([[a,h],[o,h],[o,u],[a,u]]),W.push([[a,u],[o,u],[o,F],[X,F]])):F<u?(W.push([[$,D],[o,D],[o,h],[a,h]]),W.push([[a,h],[o,h],[o,F],[a,F]])):(W.push([[$,D],[o,D],[o,h],[a,h]]),W.push([[a,h],[o,h],[o,u],[a,u]]),W.push([[a,u],[o,u],[o,F],[X,F]]))),B.push([[X,F],[o,F],j[2],j[3]])):j[2][1]>F?(Y=u<F?a+Math.tan(e)*(F-u):a,W.push([j[0],j[1],[o,F],[Y,F]]),B.push([[Y,F],[o,F],j[2],j[3]])):j[1][1]<D?(z=D<h?a+Math.tan(i)*(h-D):a,I.push([j[0],j[1],[o,D],[z,D]]),W.push([[z,D],[o,D],j[2],j[3]])):W.push(j)}I.length&&(b=h-s<v&&t<_,k=Math.atan((o-a)/(h-s)),M=(x=v)/_,w=o-_,A=(S=v-(h-s))/(_-(o-a)),P=xe((E=ft(I[0][1],I[0][2],w,D,M,x,!0,Math.tan(k)*x))[E.length-1],2),O=P[0],N=P[1],b&&(R=xe((T=ft(I[0][0],I[0][3],w,D,A,S,!0,Math.tan(k)*S))[T.length-1],2),C=R[0],L=R[1]),I.forEach(function(t,e){var i,r;0===e?(i=E,b&&(r=T)):(i=ft(t[1],t[2],w,D,M,x),b&&(r=ft(t[0],t[3],w,D,A,S)));for(var n=0,a=i.length;n<a;n++)bt(i[n],O,N,2);if(b){for(var o=0,s=r.length;o<s;o++)bt(r[o],C,L,2);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[0],t[3]=r[1].concat(r[2]).concat(r[3]))}else t[2]=t[3],t[3]=t[0];t[0]=i[3],t[1]=i[2].concat(i[1]).concat(i[0])}));var V,U,q,Z,K,J,Q,tt,et,it,rt,nt,at,ot,st,ht=B.length;return ht&&(V=l-u<m&&t<g,U=Math.atan((o-a)/(l-u)),Z=(q=m)/g,K=o-g,Q=(J=m-(l-u))/(g-(o-a)),et=xe((tt=dt(B[ht-1][1],B[ht-1][2],K,F,Z,q,!0,Math.tan(U)*q))[0],2),ot=et[0],st=et[1],V&&(rt=xe((it=dt(B[ht-1][0],B[ht-1][3],K,F,Q,J,!0,Math.tan(U)*J))[0],2),nt=rt[0],at=rt[1]),B.forEach(function(t,e){var i,r;e===ht-1?(i=tt,V&&(r=it)):(i=dt(t[1],t[2],K,F,Z,q),V&&(r=dt(t[0],t[3],K,F,Q,J)));for(var n=0,a=i.length;n<a;n++)bt(i[n],ot,st,3);if(V){for(var o=0,s=r.length;o<s;o++)bt(r[o],nt,at,3);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[0],t[3]=r[1].concat(r[2]).concat(r[3]))}else t[2]=t[3],t[3]=t[0];t[0]=i[3],t[1]=i[2].concat(i[1]).concat(i[0])})),I.concat(W).concat(B)}function ft(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(y-i)*n,M=(b-i)*n,w=Math.atan(M/(r-k)),S=i+Math.sin(w)*a/n,A=r-Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i+Math.cos(f)*a/n,r-Math.sin(f)*a):(d=Math.atan(x/(r-g)),p=i+Math.sin(d)*a/n,r-Math.cos(d)*a),d===w)return[[p,_]];var E=Ae.h(Math.abs(d-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=d+T,C=i+Math.sin(R)*P/n,L=r-Math.cos(R)*P,O=w-T;return[[S,A],[i+Math.sin(O)*P/n,r-Math.cos(O)*P],[C,L],[p,_]]}function dt(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(y-i)*n,M=(b-i)*n,w=Math.atan(x/(g-r)),S=i+Math.sin(w)*a/n,A=r+Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i+Math.cos(f)*a/n,r+Math.sin(f)*a):(d=Math.atan(M/(k-r)),p=i+Math.sin(d)*a/n,r+Math.cos(d)*a),w===d)return[[S,A]];var E=Ae.h(Math.abs(w-d))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w-T,C=i+Math.sin(R)*P/n,L=r+Math.cos(R)*P,O=d+T;return[[p,_],[i+Math.sin(O)*P/n,r+Math.cos(O)*P],[C,L],[S,A]]}function pt(t,e,i,r,n,a,o,s,h,u,l,c,f,d){var p=xe(f,2),_=p[0],v=p[1],y=xe(d,2),g=y[0],m=y[1];if(!(_&&v||g&&m))return c;for(var b,k,x,M,w,S,A,E,P,T,R,C,L,O,N,D=n+_-(n-r),F=a-g+(o-a),I=[],W=[],B=[],H=0,G=c.length;H<G;H++){var $,X,Y,z,j=c[H];j[2][0]<D?I.push(j):j[3][0]>F?B.push(j):j[2][0]>F&&j[3][0]<D?($=D<n?l-Math.tan(e)*(D-r):h,X=a<F?l-Math.tan(i)*(o-F):u,I.push([j[0],[D,$],[D,l],j[3]]),D<F&&(n<D&&F<a?W.push([[D,u],[F,u],[F,l],[D,l]]):n<D?(W.push([[D,u],[a,u],[a,l],[D,l]]),W.push([[a,u],[F,X],[F,l],[a,l]])):F<a?(W.push([[D,$],[n,u],[n,l],[D,l]]),W.push([[n,u],[F,u],[F,l],[n,l]])):(W.push([[D,$],[n,u],[n,l],[D,l]]),W.push([[n,u],[a,u],[a,l],[n,l]]),W.push([[a,u],[F,X],[F,l],[a,l]]))),B.push([[F,X],j[1],j[2],[F,l]])):j[2][0]>F?(Y=a<F?l-Math.tan(i)*(o-F):u,W.push([j[0],[F,Y],[F,l],j[3]]),B.push([[F,Y],j[1],j[2],[F,l]])):j[3][0]<D?(z=D<n?l-Math.tan(e)*(D-r):u,I.push([j[0],[D,z],[D,l],j[3]]),W.push([[D,z],j[1],j[2],[D,l]])):W.push(j)}I.length&&(b=n-r<_&&t<v,k=Math.atan((n-r)/(l-u)),M=(x=v)/_,w=l-v,A=(S=v-(l-u))/(_-(n-r)),P=xe((E=_t(I[0][3],I[0][2],D,w,M,x,!0,Math.tan(k)*x))[0],2),O=P[0],N=P[1],b&&(R=xe((T=_t(I[0][0],I[0][1],D,w,A,S,!0,Math.tan(k)*S))[0],2),C=R[0],L=R[1]),I.forEach(function(t,e){var i,r;0===e?(i=E,b&&(r=T)):(i=_t(t[3],t[2],D,w,M,x),b&&(r=_t(t[0],t[1],D,w,A,S)));for(var n=0,a=i.length;n<a;n++)bt(i[n],O,N,4);if(b){for(var o=0,s=r.length;o<s;o++)bt(r[o],C,L,4);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[3],t[3]=r[2].concat(r[1]).concat(r[0]))}else t[2]=t[1],t[3]=t[0];t[0]=i[0],t[1]=i[1].concat(i[2]).concat(i[3])}));var V,U,q,Z,K,J,Q,tt,et,it,rt,nt,at,ot,st,ht=B.length;return ht&&(V=o-a<g&&t<m,U=Math.atan((o-a)/(l-u)),Z=(q=m)/g,K=l-m,Q=(J=m-(l-u))/(g-(o-a)),et=xe((tt=vt(B[ht-1][3],B[ht-1][2],F,K,Z,q,!0,Math.tan(U)*q))[tt.length-1],2),ot=et[0],st=et[1],V&&(rt=xe((it=vt(B[ht-1][0],B[ht-1][1],F,K,Q,J,!0,Math.tan(U)*J))[it.length-1],2),nt=rt[0],at=rt[1]),B.forEach(function(t,e){var i,r;e===ht-1?(i=tt,V&&(r=it)):(i=vt(t[3],t[2],F,K,Z,q),V&&(r=vt(t[0],t[1],F,K,Q,J)));for(var n=0,a=i.length;n<a;n++)bt(i[n],ot,st,5);if(V){for(var o=0,s=r.length;o<s;o++)bt(r[o],nt,at,5);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[3],t[3]=r[2].concat(r[1]).concat(r[0]))}else t[2]=t[1],t[3]=t[0];t[0]=i[0],t[1]=i[1].concat(i[2]).concat(i[3])})),I.concat(W).concat(B)}function _t(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(-y+i)*n,M=(-b+i)*n,w=Math.atan(M/(k-r)),S=i-Math.sin(w)*a/n,A=r+Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i-Math.cos(f)*a/n,r+Math.sin(f)*a):(d=Math.atan(x/(g-r)),p=i-Math.sin(d)*a/n,r+Math.cos(d)*a),d===w)return[[p,_]];var E=Ae.h(Math.abs(d-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=d-T,C=w+T;return[[p,_],[i-Math.sin(R)*P/n,r+Math.cos(R)*P],[i-Math.sin(C)*P/n,r+Math.cos(C)*P],[S,A]]}function vt(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(y-i)*n,M=(b-i)*n,w=Math.atan(x/(g-r)),S=i+Math.sin(w)*a/n,A=r+Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i+Math.cos(f)*a/n,r+Math.sin(f)*a):(d=Math.atan(M/(k-r)),p=i+Math.sin(d)*a/n,r+Math.cos(d)*a),w===d)return[[S,A]];var E=Ae.h(Math.abs(w-d))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w+T,C=d-T;return[[S,A],[i+Math.sin(R)*P/n,r+Math.cos(R)*P],[i+Math.sin(C)*P/n,r+Math.cos(C)*P],[p,_]]}function yt(t,e,i,r,n,a,o,s,h,u,l,c,f,d){var p=xe(f,2),_=p[0],v=p[1],y=xe(d,2),g=y[0],m=y[1];if(!(_&&v||g&&m))return c;for(var b,k,x,M,w,S,A,E,P,T,R,C,L,O,N,D=h+v-(h-s),F=u-m+(l-u),I=[],W=[],B=[],H=0,G=c.length;H<G;H++){var $,X,Y,z,j=c[H];j[3][1]<D?I.push(j):j[0][1]>F?B.push(j):j[3][1]>F&&j[0][1]<D?($=D<h?n-Math.tan(i)*(h-D):n,X=u<F?n-Math.tan(e)*(F-u):n,I.push([j[0],j[1],[$,D],[r,D]]),D<F&&(F<u&&h<D?W.push([[r,D],[n,D],[n,F],[r,F]]):h<D?(W.push([[r,D],[n,D],[n,u],[r,u]]),W.push([[r,u],[n,u],[X,F],[r,F]])):F<u?(W.push([[r,D],[$,D],[n,h],[r,h]]),W.push([[r,h],[n,h],[n,F],[r,F]])):(W.push([[r,D],[$,D],[n,h],[r,h]]),W.push([[r,h],[n,h],[n,u],[r,u]]),W.push([[r,u],[n,u],[X,F],[r,F]]))),B.push([[r,F],[X,F],j[2],j[3]])):j[3][1]>F?(Y=u<F?n-Math.tan(e)*(F-u):n,W.push([j[0],j[1],[Y,F],[r,F]]),B.push([[r,F],[Y,F],j[2],j[3]])):j[1][1]<D?(z=D<h?n-Math.tan(i)*(h-D):n,I.push([j[0],j[1],[z,D],[r,D]]),W.push([[r,D],[z,D],j[2],j[3]])):W.push(j)}I.length&&(b=h-s<v&&t<_,k=Math.atan((n-r)/(h-s)),M=(x=v)/_,w=r+_,A=(S=v-(h-s))/(_-(n-r)),P=xe((E=gt(I[0][0],I[0][3],w,D,M,x,!0,Math.tan(k)*x))[E.length-1],2),O=P[0],N=P[1],b&&(R=xe((T=gt(I[0][1],I[0][2],w,D,A,S,!0,Math.tan(k)*S))[T.length-1],2),C=R[0],L=R[1]),I.forEach(function(t,e){var i,r;0===e?(i=E,b&&(r=T)):(i=gt(t[0],t[3],w,D,M,x),b&&(r=gt(t[1],t[2],w,D,A,S)));for(var n=0,a=i.length;n<a;n++)bt(i[n],O,N,6);if(b){for(var o=0,s=r.length;o<s;o++)bt(r[o],C,L,6);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[0],t[3]=r[1].concat(r[2]).concat(r[3]))}else t[3]=t[1];t[0]=i[3],t[1]=i[2].concat(i[1]).concat(i[0])}));var V,U,q,Z,K,J,Q,tt,et,it,rt,nt,at,ot,st,ht=B.length;return ht&&(V=l-u<m&&t<g,U=Math.atan((n-r)/(l-u)),Z=(q=m)/g,K=r+g,Q=(J=m-(l-u))/(g-(n-r)),et=xe((tt=mt(B[ht-1][0],B[ht-1][3],K,F,Z,q,!0,Math.tan(U)*q))[0],2),ot=et[0],st=et[1],V&&(rt=xe((it=mt(B[ht-1][1],B[ht-1][2],K,F,Q,J,!0,Math.tan(U)*J))[0],2),nt=rt[0],at=rt[1]),B.forEach(function(t,e){var i,r;e===ht-1?(i=tt,V&&(r=it)):(i=mt(t[0],t[3],K,F,Z,q),V&&(r=mt(t[1],t[2],K,F,Q,J)));for(var n=0,a=i.length;n<a;n++)bt(i[n],ot,st,7);if(V){for(var o=0,s=r.length;o<s;o++)bt(r[o],nt,at,7);1===r.length?(t[2]=r[0],t.pop()):(t[2]=r[0],t[3]=r[1].concat(r[2]).concat(r[3]))}else t[3]=t[1];t[0]=i[3],t[1]=i[2].concat(i[1]).concat(i[0])})),I.concat(W).concat(B)}function gt(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(i-y)*n,M=(i-b)*n,w=Math.atan(M/(r-k)),S=i-Math.sin(w)*a/n,A=r-Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i-Math.cos(f)*a/n,r-Math.sin(f)*a):(d=Math.atan(x/(r-g)),p=i-Math.sin(d)*a/n,r-Math.cos(d)*a),d===w)return[[p,_]];var E=Ae.h(Math.abs(d-w))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=d+T,C=i-Math.sin(R)*P/n,L=r-Math.cos(R)*P,O=w-T;return[[S,A],[i-Math.sin(O)*P/n,r-Math.cos(O)*P],[C,L],[p,_]]}function mt(t,e,i,r,n,a,o,s){var h,u,l,c,f,d,p,_,v=xe(t,2),y=v[0],g=v[1],m=xe(e,2),b=m[0],k=m[1],x=(i-y)*n,M=(i-b)*n,w=Math.atan(x/(g-r)),S=i-Math.sin(w)*a/n,A=r+Math.cos(w)*a;if(_=o?(h=s*n,u=Math.atan(h/a),c=(l=Math.sqrt(Math.tan(u)/2))/(1+l),f=2*Math.atan(c),d=.5*Math.PI-f,p=i-Math.cos(f)*a/n,r+Math.sin(f)*a):(d=Math.atan(M/(k-r)),p=i-Math.sin(d)*a/n,r+Math.cos(d)*a),w===d)return[[S,A]];var E=Ae.h(Math.abs(w-d))*a,P=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),T=Math.atan(E/a),R=w-T,C=i-Math.sin(R)*P/n,L=r+Math.cos(R)*P,O=d+T;return[[p,_],[i-Math.sin(O)*P/n,r+Math.cos(O)*P],[C,L],[S,A]]}function bt(t,e,i,r){0===r?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],i)):1===r?(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i)):2===r?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],i)):3===r?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],i)):4===r?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],i)):5===r||6===r?(t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],i)):7===r&&(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i))}var Te={calPoints:function(t,e,i,r,n,a,o,s,h,u,l,c,f,d,p){var _=[];if(-1<["dashed","dotted"].indexOf(e)){var v=0===f||2===f?st(e,n,a,o,s,t):st(e,h,u,l,c,t),y=v.n,g=v.ps,m=v.pd;if(1<y){for(var b=0;b<y;b++){var k=b===y-1,x=void 0,M=void 0,w=void 0,S=(x=0===f||2===f?b?n+g*b+m*b:n:b?h+g*b+m*b:h)+g;0===f?S<=a?k?_.push([[n,h],[s,h],[o,u],[a,u]]):(M=h+(x-n)*Math.tan(i),w=h+(S-n)*Math.tan(i),_.push([[x,h],[S,h],[S,w],[x,M]])):o<=x?(M=h+(s-x)*Math.tan(r),w=h+(s-S)*Math.tan(r),k?_.push([[x,h],[s,h],[s,h],[x,M]]):_.push([[x,h],[S,h],[S,w],[x,M]])):x<a?(M=h+(x-n)*Math.tan(i),_.push([[x,h],[a,h],[a,u],[x,M]]),k?(_.push([[a,h],[o,h],[o,u],[a,u]]),_.push([[o,h],[s,h],[s,h],[a,u]])):o<S?(w=h+(s-S)*Math.tan(r),_.push([[a,h],[o,h],[o,u],[a,u]]),_.push([[o,h],[S,h],[S,w],[o,u]])):_.push([[a,h],[S,h],[S,u],[a,u]])):o<S?(M=h+(s-S)*Math.tan(r),x<a?(w=h+(x-n)*Math.tan(i),_.push([[x,h],[a,h],[a,u],[x,w]]),_.push([[a,h],[o,h],[o,u],[a,u]])):_.push([[x,h],[o,h],[o,u],[x,u]]),k?_.push([[o,h],[s,h],[s,h],[o,u]]):_.push([[o,h],[S,h],[S,M],[o,u]])):k?_.push([[x,h],[s,h],[o,u],[x,u]]):_.push([[x,h],[S,h],[S,u],[x,u]]):1===f?S<=u?k?_.push([[o,u],[s,h],[s,c],[o,l]]):(M=s-(x-h)*Math.tan(i),w=s-(S-h)*Math.tan(i),_.push([[M,x],[s,x],[s,S],[w,S]])):l<=x?(M=o+(x-l)*Math.tan(r),w=o+(S-l)*Math.tan(r),k?_.push([[M,x],[s,x],[s,c],[s,c]]):_.push([[M,x],[s,x],[s,S],[w,S]])):x<u?(M=o+(u-x)*Math.tan(i),_.push([[M,x],[s,x],[s,u],[o,u]]),k?(_.push([[o,u],[s,u],[s,l],[o,l]]),_.push([[o,l],[s,l],[s,c],[s,c]])):l<S?(w=o+(S-l)*Math.tan(r),_.push([[o,u],[s,u],[s,l],[o,l]]),_.push([[o,l],[s,l],[s,S],[w,S]])):_.push([[o,u],[s,u],[s,S],[o,S]])):l<S?(M=o+(S-l)*Math.tan(r),x<u?(w=o+(u-x)*Math.tan(i),_.push([[w,x],[s,x],[s,u],[o,u]]),_.push([[o,u],[s,u],[s,l],[o,l]]),k?_.push([[o,l],[s,l],[s,s],[s,s]]):_.push([[o,l],[s,l],[s,S],[M,S]])):(_.push([[o,x],[s,x],[s,l],[o,l]]),k?_.push([[o,l],[s,l],[s,c],[s,c]]):_.push([[o,l],[s,l],[s,S],[M,S]]))):k?_.push([[o,x],[s,x],[s,c],[o,l]]):_.push([[o,x],[s,x],[s,S],[o,S]]):2===f?S<=a?k?_.push([[n,c],[a,l],[o,l],[s,c]]):(M=c-(x-n)*Math.tan(i),w=c-(S-n)*Math.tan(i),_.push([[x,M],[S,w],[S,c],[x,c]])):o<=x?(M=c-(s-x)*Math.tan(r),w=c-(s-S)*Math.tan(r),k?_.push([[x,M],[s,c],[s,c],[x,c]]):_.push([[x,M],[S,w],[S,c],[x,c]])):x<a?(M=c-(x-n)*Math.tan(i),_.push([[x,M],[a,l],[a,c],[x,c]]),k?(_.push([[a,l],[o,l],[o,c],[a,c]]),_.push([[o,l],[s,c],[s,c],[o,c]])):o<S?(w=c-(S-o)*Math.tan(r),_.push([[a,l],[o,l],[o,c],[a,c]]),_.push([[o,l],[S,w],[S,c],[o,c]])):_.push([[a,l],[S,l],[S,c],[a,c]])):o<S?(M=c-(s-S)*Math.tan(r),x<a?(w=c-(x-o)*Math.tan(i),_.push([[x,w],[a,l],[a,c],[x,c]]),_.push([[a,l],[o,l],[o,c],[a,c]])):_.push([[x,l],[o,l],[o,c],[x,c]]),k?_.push([[o,l],[s,c],[s,c],[o,c]]):_.push([[o,l],[S,M],[S,c],[o,c]])):k?_.push([[x,l],[o,l],[s,c],[x,c]]):_.push([[x,l],[S,l],[S,c],[x,c]]):3===f&&(S<=u?k?_.push([[n,h],[a,u],[a,l],[n,c]]):(M=n+(x-h)*Math.tan(i),w=n+(S-h)*Math.tan(i),_.push([[n,x],[M,x],[w,S],[n,S]])):l<=x?(M=n+(c-x)*Math.tan(r),w=n+(c-S)*Math.tan(r),k?_.push([[n,x],[M,x],[n,c],[n,c]]):_.push([[n,x],[M,x],[w,S],[n,S]])):x<u?(M=n+(x-h)*Math.tan(i),_.push([[n,x],[M,x],[a,u],[n,u]]),k?(_.push([[n,u],[a,u],[a,l],[n,l]]),_.push([[n,l],[a,l],[n,c],[n,c]])):l<S?(w=n+(c-S)*Math.tan(r),_.push([[n,u],[a,u],[a,l],[n,l]]),_.push([[n,l],[a,l],[w,S],[n,S]])):_.push([[n,u],[a,u],[a,S],[n,S]])):l<S?(M=n+(c-S)*Math.tan(r),x<u?(w=n+(x-h)*Math.tan(i),_.push([[n,x],[w,x],[a,u],[n,h]]),_.push([[n,u],[a,u],[a,l],[n,l]])):_.push([[n,x],[a,x],[a,l],[n,l]]),k?_.push([[n,l],[a,l],[n,c],[n,c]]):_.push([[n,l],[a,l],[M,S],[n,S]])):k?_.push([[n,x],[a,x],[a,l],[n,c]]):_.push([[n,x],[a,x],[a,S],[n,S]]))}if(0===f)return ht(t,i,r,n,a,o,s,h,u,0,0,_,d,p);if(1===f)return ct(t,i,r,0,0,o,s,h,u,l,c,_,d,p);if(2===f)return pt(t,i,r,n,a,o,s,0,u,l,c,_,d,p);if(3===f)return yt(t,i,r,n,a,0,0,h,u,l,c,_,d,p)}}return 0===f?(n<a&&_.push([[n,h],[a,h],[a,u],[n,h]]),_.push([[a,h],[o,h],[o,u],[a,u]]),o<s&&_.push([[o,h],[s,h],[s,h],[o,u]]),ht(t,i,r,n,a,o,s,h,u,0,0,_,d,p)):1===f?(h<u&&_.push([[s,h],[s,h],[s,u],[o,u]]),_.push([[o,u],[s,u],[s,l],[o,l]]),l<c&&_.push([[o,l],[s,l],[s,c],[s,c]]),ct(t,i,r,0,0,o,s,h,u,l,c,_,d,p)):2===f?(n<a&&_.push([[n,c],[a,l],[a,c],[n,c]]),_.push([[a,l],[o,l],[o,c],[a,c]]),o<s&&_.push([[o,l],[s,c],[s,c],[o,c]]),pt(t,i,r,n,a,o,s,0,u,l,c,_,d,p)):3===f?(h<u&&_.push([[n,h],[n,h],[a,u],[n,u]]),_.push([[n,u],[a,u],[a,l],[n,l]]),l<c&&_.push([[n,l],[a,l],[n,c],[n,c]]),yt(t,i,r,n,a,0,0,h,u,l,c,_,d,p)):void 0},calRadius:function(t,e,i,r,n,a,o,s,h,u,l,c){var f,d=xe(h,2),p=d[0],_=d[1],v=xe(u,2),y=v[0],g=v[1],m=xe(l,2),b=m[0],k=m[1],x=xe(c,2),M=x[0],w=x[1];if(_-=n,y-=a,g-=n,b-=a,k-=o,M-=s,w-=o,(0<(p-=s)&&0<_||0<y&&0<g||0<b&&0<k||0<M&&0<w)&&(f=!0),f){var S=[];return 0<p&&0<_?(S.push([t,e+_]),S.push([t,e+_*(1-at),t+p*(1-at),e,t+p,e])):S.push([t,e]),0<y&&0<g?(S.push([t+i-y,e]),S.push([t+i-y*(1-at),e,t+i,e+g*(1-at),t+i,e+g])):S.push([t+i,e]),0<b&&0<k?(S.push([t+i,e+r-k]),S.push([t+i,e+r-k*(1-at),t+i-b*(1-at),e+r,t+i-b,e+r])):S.push([t+i,e+r]),0<M&&0<w?(S.push([t+M,e+r]),S.push([t+M*(1-at),e+r,t,e+r-w*(1-at),t,e+r-w])):S.push([t,e+r]),S}}},kt={arial:{lhr:1.14990234375,car:1.1171875,blr:.9052734375}},Lt={GEOM:{x1:!0,y1:!0,x2:!0,y2:!0,controlA:!0,controlB:!0,r:!0,rx:!0,ry:!0,begin:!0,end:!0,points:!0,controls:!0,edge:!0,closure:!0},STYLE:{transform:!0,translateX:!0,translateY:!0,skewX:!0,skewY:!0,scaleX:!0,scaleY:!0,rotateZ:!0,color:!0,fontStyle:!0,strokeWidth:!0,fill:!0,strokeDasharray:!0,strokeLinecap:!0,strokeLinejoin:!0,strokeMiterlimit:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0,backgroundSize:!0,stroke:!0,borderBottomColor:!0,borderLeftColor:!0,borderRightColor:!0,borderTopColor:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0,visibility:!0,opacity:!0,zIndex:!0,filter:!0,boxShadow:!0},isRepaint:function(t){return this.STYLE.hasOwnProperty(t)||this.GEOM.hasOwnProperty(t)}},xt=["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color"],Mt=["fontSize","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","bottom","left","right","top","flexBasis","width","height","lineHeight","marginBottom","marginLeft","marginRight","marginTop","paddingBottom","paddingLeft","paddingRight","paddingTop","strokeWidth","strokeMiterlimit"],wt=["backgroundImage","fill","stroke"],St=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],At={};xt.forEach(function(t){At[t]=!0});var Et={};Mt.forEach(function(t){Et[t]=!0});var Pt={};St.forEach(function(t){Pt[t]=!0});var Tt={};wt.forEach(function(t){Tt[t]=!0});var Rt=["translateX","translateY","scaleX","scaleY","rotateZ","skewX","skewY"],Ct={};Rt.forEach(function(t){Ct[t]=!0});var Ot={KEY_COLOR:xt,KEY_EXPAND:Rt,KEY_GRADIENT:wt,KEY_LENGTH:Mt,KEY_RADIUS:St,COLOR_HASH:At,EXPAND_HASH:Ct,GRADIENT_HASH:Tt,LENGTH_HASH:Et,RADIUS_HASH:Pt,GRADIENT_TYPE:{linear:!0,radial:!0}},Nt=s.AUTO,Dt=s.PX,Ft=s.PERCENT,It=s.NUMBER,Wt=s.INHERIT,Bt=s.DEG,Ht=s.RGBA,Gt=s.STRING,$t=Ee.isNil,Xt=Ee.rgba2int,Yt=Ot.COLOR_HASH,zt=Ot.LENGTH_HASH,jt=Ot.RADIUS_HASH,Vt=Ot.GRADIENT_HASH,Ut=Ot.EXPAND_HASH,qt=Ot.GRADIENT_TYPE;function Zt(t,e,i,r){$t(t.flexGrow)&&(t.flexGrow=e),$t(t.flexShrink)&&(t.flexShrink=i),$t(t.flexBasis)&&(t.flexBasis=r)}function Kt(i,r){var n,t=i[r];t&&((n=t.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi))&&(1===n.length?n[3]=n[2]=n[1]=n[0]:2===n.length?(n[2]=n[0],n[3]=n[1]):3===n.length&&(n[3]=n[1]),["Top","Right","Bottom","Left"].forEach(function(t,e){$t(i[t=r+t])&&(i[t]=n[e])})),delete i[r])}function Jt(t,e,i){return"auto"===i?t[e]={unit:Nt}:"inherit"===i?t[e]={unit:Wt}:/%$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:Ft}):/px$/i.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:Dt}):/deg$/i.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:Bt}):(i=parseFloat(i)||0,t[e]={value:i,unit:It}),0===e.toString().indexOf("border")&&(t[e].value=Math.max(t[e].value,0)),t}function Qt(t,e){-1<t.indexOf("scale")?e.unit=It:-1<t.indexOf("translate")?e.unit===It&&(e.unit=Dt):e.unit===It&&(e.unit=Bt)}function re(t){return t.fontSize*kt.arial.lhr}function ne(t,e,i){for(t*=.01;e;){var r=e.currentStyle[i];if(r.unit===Nt){if("width"!==i)break;e=e.parent}else{if(r.unit===Dt)return t*r.value;r.unit===Ft&&(t*=.01*r.value,e=e.parent)}}return t}var ae={normalize:function(s){var t,e,i,r,n,a,o,h,u,l,c,f,d,p,_,v,y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],g=(s=Ee.extend({},s)).border;if(g&&(["Top","Right","Bottom","Left"].forEach(function(t){$t(s[t="border"+t])&&(s[t]=g)}),delete s.border),["Top","Right","Bottom","Left"].forEach(function(t){var e,i,r,n,a,o;o=(e=s)[a="border"+t],$t(o)||($t(e[a+"Width"])&&(i=/\b[\d.]+px\b/i.exec(o),e[a+"Width"]=i?i[0]:0),$t(e[a+"Style"])&&(r=/\b(solid|dashed|dotted)\b/i.exec(o),e[a+"Style"]=r?r[1]:"solid"),$t(e[a+"Color"])&&((n=/#[0-9a-f]{3,6}/i.exec(o))&&-1<[4,7].indexOf(n[0].length)?e[a+"Color"]=n[0]:/\btransparent\b/i.test(o)?e[a+"Color"]="transparent":(n=/rgba?\(.+\)/i.exec(o),e[a+"Color"]=n?n[0]:"transparent")))}),(g=s.borderWidth)&&(["Top","Right","Bottom","Left"].forEach(function(t){$t(s[t="border"+t+"Width"])&&(s[t]=g)}),delete s.borderWidth),(g=s.borderColor)&&(["Top","Right","Bottom","Left"].forEach(function(t){$t(s[t="border"+t+"Color"])&&(s[t]=Xt(g))}),delete s.borderColor),(g=s.borderStyle)&&(["Top","Right","Bottom","Left"].forEach(function(t){$t(s[t="border"+t+"Style"])&&(s[t]=g)}),delete s.borderStyle),g=s.borderRadius){1===(g=g.toString().split("/")).length&&(g[1]=g[0]);for(var m=0;m<2;m++){var b=g[m].toString().split(/\s+/);0===b.length?g[m]=[0,0,0,0]:1===b.length?g[m]=[b[0],b[0],b[0],b[0]]:2===b.length?g[m]=[b[0],b[1],b[0],b[1]]:3===b.length?g[m]=[b[0],b[1],b[2],b[1]]:g[m]=b.slice(0,4)}["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t,e){$t(s[t="border"+t+"Radius"])&&(s[t]=g[0][e]+" "+g[1][e])}),delete s.borderRadius}if((g=s.background)&&($t(s.backgroundImage)&&((t=Z.gradient.exec(g))?(s.backgroundImage=t[0],g=g.replace(t[0],"")):(e=Z.img.exec(g))&&(s.backgroundImage=e[0],g=g.replace(e[0],""))),!$t(s.backgroundRepeat)||(i=/(no-)?repeat(-[xy])?/i.exec(g))&&(s.backgroundRepeat=i[0].toLowerCase()),!$t(s.backgroundColor)||(r=/^(transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\))/i.exec(g))&&(s.backgroundColor=r[0],g=g.replace(r[0],"")),!$t(s.backgroundPosition)||(n=g.match(Z.position))&&(s.backgroundPositionX=n[0],s.backgroundPositionY=1<n.length?n[1]:n[0]),delete s.background),g=s.backgroundPosition,$t(g)||(1===(g=g.toString().split(/\s+/)).length&&(g[1]="50%"),a=xe(g,2),s.backgroundPositionX=a[0],s.backgroundPositionY=a[1],delete s.backgroundPosition),(g=s.flex)&&("none"===g?Zt(s,0,0,"auto"):"auto"===g?Zt(s,1,1,"auto"):/^[\d.]+$/.test(g)?Zt(s,Math.max(0,parseFloat(g)),1,0):/^[\d.]+px$/i.test(g)?Zt(s,1,1,0):/^[\d.]+%$/.test(g)?Zt(s,1,1,g):/^[\d.]+\s+[\d.]+$/.test(g)?(o=g.split(/\s+/),Zt(s,o[0],o[1],0)):/^[\d.]+\s+[\d.]+%$/.test(g)?(h=g.split(/\s+/),Zt(s,h[0],1,h[1])):Zt(s,0,1,"auto"),delete s.flex),Kt(s,"margin"),Kt(s,"padding"),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=s[t];!$t(e)&&s.transform&&console.error('Can not use expand style "'.concat(t,'" with transform'))}),y.forEach(function(t){var e=t.k,i=t.v;$t(s[e])&&(s[e]=i)}),(g=s.backgroundImage)&&(Z.gradient.test(g)?s.backgroundImage=nt.parseGradient(g):Z.img.test(g)&&(s.backgroundImage=Z.img.exec(g)[2])),(g=s.backgroundColor)&&((u=/^#[0-9a-f]{3,6}/i.exec(g))&&-1<[4,7].indexOf(u[0].length)?s.backgroundColor={value:Xt(u[0]),unit:Ht}:(u=/rgba?\(.+\)/i.exec(g),s.backgroundColor={value:Xt(u?u[0]:[0,0,0,0]),unit:Ht})),["backgroundPositionX","backgroundPositionY"].forEach(function(t){g=s[t],$t(g)||(/%$/.test(g)||/px$/i.test(g)||/^-?[\d.]+$/.test(g)?(Jt(s,t,g),(g=s[t]).unit===It&&(g.unit=Dt)):s[t]={value:{top:0,left:0,center:50,right:100,bottom:100}[g],unit:Ft})}),g=s.backgroundSize){var k=s.backgroundSize=[],x=g.toString().match(/\b(?:(-?[\d.]+(px|%)?)|(contain|cover|auto))/gi);if(x){1===x.length&&("contain"===x[0]||"cover"===x[0]?x[1]=x[0]:x[1]="auto");for(var M=0;M<2;M++){var w=x[M];/%$/.test(w)||/px$/i.test(w)||/^-?[\d.]+$/.test(w)?(Jt(k,M,w),k[M].unit===It&&(k[M].unit=Dt)):"0"===w||0===w?k.push({value:0,unit:Dt}):"contain"===w||"cover"===w?k.push({value:w,unit:Gt}):k.push({unit:Nt})}}else k.push({unit:Nt}),k[1]=k[0]}if(["Top","Right","Bottom","Left"].forEach(function(t){var e=s[t="border"+t+"Color"];$t(e)||(s[t]={value:Xt(e),unit:Ht})}),["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){var e=s[t="border"+t+"Radius"];if(!$t(e)){var i=e.toString().split(/\s+/);1===i.length&&(i[1]=i[0]);for(var r=0;r<2;r++){var n=i[r];/%$/.test(n)||/px$/i.test(n)||/^-?[\d.]+$/.test(n)?(Jt(i,r,n),i[r].unit===It&&(i[r].unit=Dt)):i[r]={value:0,unit:Dt}}s[t]=i}}),(g=s.transform)&&(l=s.transform=[],(c=g.toString().match(/\w+\(.+?\)/g))&&c.forEach(function(t){var e,i,r,n,a,o=t.indexOf("("),s=t.slice(0,o),h=t.slice(o+1,t.length-1);"matrix"===s?(6<(e=(e=h.toString().split(/\s*,\s*/)).map(function(t){return parseFloat(t)})).length&&(e=e.slice(0,6)),6===e.length&&l.push(["matrix",e])):!{translateX:!0,translateY:!0,scaleX:!0,scaleY:!0,skewX:!0,skewY:!0,rotate:!0,rotateZ:!0}.hasOwnProperty(s)?{translate:!0,scale:!0,skew:!0}.hasOwnProperty(s)&&(1===(r=h.toString().split(/\s*,\s*/)).length&&(r[1]=r[0]),n=Jt([s+"X",r[0]],1,r[0]),a=Jt([s+"Y",r[1]],1,r[1]),Qt(s,n[1]),Qt(s,a[1]),l.push(n),l.push(a)):("rotate"===s&&(s="rotateZ"),Qt(s,(i=Jt([s,h],1,h))[1]),l.push(i))})),g=s.transformOrigin,!$t(g)){var S=s.transformOrigin=[],A=g.toString().match(Z.position);if(A){1===A.length&&(A[1]=A[0]);for(var E=0;E<2;E++){var P=A[E];/%$/.test(P)||/px$/i.test(P)||/^-?[\d.]+$/.test(P)?(Jt(S,E,P),S[E].unit===It&&(S[E].unit=Dt)):(S.push({value:{top:0,left:0,center:50,right:100,bottom:100}[P],unit:Ft}),$t(S[E].value)&&(S[E].value=50))}}else S.push({value:50,unit:Ft}),S[1]=S[0]}return["translate","scale","skew"].forEach(function(t){var e;g=s[t],$t(g)||(1===(e=g.toString().split(/\s*,\s*/)).length&&(e[1]=e[0]),s[t+"X"]=e[0],s[t+"Y"]=e[1],delete s[t])}),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=s[t];$t(e)||(Jt(s,t,e),"rotate"===t&&(t="rotateZ",s.rotateZ=s.rotate,delete s.rotate),Qt(t,s[t]))}),(g=s.opacity)&&(g=parseFloat(g),isNaN(g)?s.opacity=1:(g=Math.max(g,0),g=Math.min(g,1),s.opacity=g)),(g=s.zIndex)&&(s.zIndex=parseInt(g)||0),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","top","right","bottom","left","width","height","flexBasis","strokeWidth"].forEach(function(t){var e=s[t];$t(e)||(Jt(s,t,e),(e=s[t]).unit===It&&(e.unit=Dt))}),(g=s.color)&&(s.color="inherit"===g?{unit:Wt}:{value:Xt(g),unit:Ht}),!(g=s.fontSize)&&0!==g||("inherit"===g?s.fontSize={unit:Wt}:/%$/.test(g)?(f=Math.max(0,parseFloat(g)),s.fontSize=f?{value:f,unit:Ft}:{value:16,unit:Dt}):s.fontSize={value:Math.max(0,parseFloat(g))||16,unit:Dt}),!(g=s.fontWeight)&&0!==g||(s.fontWeight="bold"===g?{value:700,unit:It}:"normal"===g?{value:400,unit:It}:"lighter"===g?{value:200,unit:It}:"inherit"===g?{unit:Wt}:{value:Math.max(0,parseInt(g))||400,unit:It}),(g=s.fontStyle)&&(s.fontStyle="inherit"===g?{unit:Wt}:{value:g,unit:Gt}),(g=s.fontFamily)&&(s.fontFamily="inherit"===g?{unit:Wt}:{value:g,unit:Gt}),(g=s.textAlign)&&(s.textAlign="inherit"===g?{unit:Wt}:{value:g,unit:Gt}),!(g=s.lineHeight)&&0!==g||("inherit"===g?s.lineHeight={unit:Wt}:"normal"===g?s.lineHeight={unit:Nt}:/px$/i.test(g)?s.lineHeight={value:parseFloat(g),unit:Dt}:(d=Math.max(0,parseFloat(g))||"normal",s.lineHeight="normal"===d?{unit:Nt}:{value:d,unit:It})),g=s.strokeDasharray,$t(g)||((p=g.toString().match(/[\d.]+/g))?((p=p.map(function(t){return parseFloat(t)})).length%2==1&&p.push(p[p.length-1]),s.strokeDasharray=p):s.strokeDasharray=[]),(g=s.fill)&&(0<g.indexOf("-gradient(")?s.fill=nt.parseGradient(g):s.fill=Xt(g)),(g=s.stroke)&&(0<g.indexOf("-gradient(")?s.stroke=nt.parseGradient(g):s.stroke=Xt(g)),(g=s.filter)&&(s.filter=[],!(_=/\bblur\s*\(\s*([\d.]+)\s*(?:px)?\s*\)/i.exec(g))||(v=parseFloat(_[1])||0)&&s.filter.push(["blur",v])),(g=s.visibility)&&(s.visibility="inherit"===g?{unit:Wt}:{value:g,unit:Gt}),(g=s.boxShadow)&&(s.boxShadow=[],g.match(/(-?[\d.]+(px)?)\s+(-?[\d.]+(px)?)\s+(-?[\d.]+(px)?\s*)?(-?[\d.]+(px)?\s*)?(((transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*)?(inset|outset)?\s*,?/gi).forEach(function(t){var e=/(-?[\d.]+(?:px)?)\s+(-?[\d.]+(?:px)?)\s+(-?[\d.]+(?:px)?\s*)?(-?[\d.]+(?:px)?\s*)?(?:((?:transparent)|(?:#[0-9a-f]{3,6})|(?:rgba?\(.+\)))\s*)?(inset|outset)?/i.exec(t);if(e){for(var i=[e[1],e[2],e[3]||0,e[4]||0,e[5]||"#000",e[6]||"outset"],r=0;r<4;r++)Jt(i,r,i[r]),1<r&&i[r].value<0&&(i[r]=0),i[r].unit===It&&(i[r]=i[r].value);i[4]=Xt(i[4]),s.boxShadow.push(i)}})),s},compute:function(t,e,i,r){var n=e?null:t.parent.computedStyle,a=i.fontSize,o=i.fontFamily,s=i.fontWeight,h=i.textAlign,u=i.lineHeight;a.unit===Wt?r.fontSize=e?16:n.fontSize:a.unit===Ft?r.fontSize=e?16:n.fontSize*a.value*.01:r.fontSize=a.value,o.unit===Wt?r.fontFamily=e?"arial":n.fontFamily:r.fontFamily=o.value,s.unit===Wt?r.fontWeight=e?400:n.fontWeight:r.fontWeight=s.value,["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"].forEach(function(t){r[t]=i[t].unit===Dt?Math.max(0,i[t].value):0}),["position","display","flexDirection","justifyContent","alignItems","flexGrow","flexShrink"].forEach(function(t){r[t]=i[t]}),h.unit===Wt?r.textAlign=e?"left":n.textAlign:r.textAlign=e?"left":h.value,u.unit===Wt?r.lineHeight=e?re(r):n.lineHeight:u.unit===Dt?r.lineHeight=Math.max(u.value,0)||re(r):u.unit===It?r.lineHeight=Math.max(u.value,0)*r.fontSize||re(r):r.lineHeight=re(r)},setFontStyle:function(t){var e=t.fontStyle,i=t.fontWeight,r=t.fontSize;return(e||"")+" "+(i||"")+" "+r+"px/"+r+"px "+(t.fontFamily||"")},getBaseLine:function(t){var e=t.fontSize*kt.arial.lhr;return.5*(t.lineHeight-e)+t.fontSize*kt.arial.blr},calRelative:function(t,e,i,r,n){return i.unit===Nt?i=0:-1<[Dt,It,Bt,Ht,Gt].indexOf(i.unit)?i=i.value:i.unit===Ft&&(i=ne(i.value,r,n?"width":"height")),i},calAbsolute:function(t,e,i,r){return i.unit===Nt?i=0:-1<[Dt,It,Bt,Ht,Gt].indexOf(i.unit)?i=i.value:i.unit===Ft&&(i=i.value*r*.01),i},equalStyle:function(t,e,i,r){if(!e||!i)return e===i;if("transform"===t){if(e.length!==i.length)return!1;for(var n=0,a=e.length;n<a;n++){var o=e[n],s=i[n];if(o[0]!==s[0])return!1;if("matrix"===o){if(!Ee.equalArr(o[1],s[1]))return!1}else if(!Ee.equal(o[1],s[1]))return!1}return!0}if("filter"===t){if(e.length!==i.length)return!1;for(var h=0,u=e.length;h<u;h++)if(!Ee.equalArr(e[h],i[h]))return!1}if("transformOrigin"===t||"backgroundSize"===t)return e[0].value===i[0].value&&e[0].unit===i[0].unit&&e[1].value===i[1].value&&e[1].unit===i[1].unit;if("backgroundPositionX"===t||"backgroundPositionY"===t||zt.hasOwnProperty(t)||Ut.hasOwnProperty(t))return e.value===i.value&&e.unit===i.unit;if("boxShadow"===t)return Ee.equalArr(e,i);if(jt.hasOwnProperty(t))return e[0].value===i[0].value&&e[0].unit===i[0].unit&&e[1].value===i[1].value&&e[1].unit===i[1].unit;if(Yt.hasOwnProperty(t))return e.unit===i.unit&&Ee.equalArr(e.value,i.value);if(Vt.hasOwnProperty(t)&&e.k===i.k&&qt.hasOwnProperty(e.k)){var l=e.v,c=i.v;if(e.d!==i.d||l.length!==c.length)return!1;for(var f=0,d=l.length;f<d;f++){var p=l[f],_=c[f];if(p.length!==_.length)return!1;for(var v=0;v<4;v++)if(p[0][v]!==_[0][v])return!1;if(1<p.length&&(p[1].value!==_[1].value||p[1].unit!==_[1].unit))return!1}return!0}return Lt.GEOM.hasOwnProperty(t)&&(r.isMulti||"points"===t||"controls"===t||"controlA"===t||"controlB"===t)?Ee.equalArr(e,i):e===i}},oe=s.PERCENT,se=s.NUMBER;var Re={matrixResize:function(t,e,i,r,n,a,o,s){if(t!==i||e!==r){var h=[["scaleX",{value:i/t,unit:se}],["scaleY",{value:r/e,unit:se}]],u=Pe.calOrigin([{value:0,unit:oe},{value:0,unit:oe}],o,s);return u[0]+=n,u[1]+=a,Pe.calMatrixWithOrigin(h,u,o,s)}}},he={position:"static",display:"block",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:"inherit",fontFamily:"inherit",color:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"normal",backgroundImage:null,backgroundColor:"transparent",backgroundSize:"auto",backgroundRepeat:"repeat",backgroundPositionX:0,backgroundPositionY:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"#000",borderRightColor:"#000",borderBottomColor:"#000",borderLeftColor:"#000",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",borderLeftStyle:"solid",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0,width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",textAlign:"inherit",transformOrigin:"center",visibility:"inherit",opacity:1,zIndex:0,transform:null,translateX:0,translateY:0,scaleX:1,scaleY:1,skewX:0,skewY:0,rotateZ:0,filter:null,boxShadow:null},ue={fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:4},le=[],ce=[];Object.keys(he).forEach(function(t){ce.push(t);var e=he[t];le.push({k:t,v:e})});var fe=[],de=[];Object.keys(ue).forEach(function(t){de.push(t);var e=ue[t];fe.push({k:t,v:e})});var pe={DOM:he,GEOM:ue,domKey:ce,geomKey:de,dom:le,geom:fe},_e="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nvarying vec2 vTextureCoord;\nuniform mat3 projectionMatrix;\n\nvoid main(void)\n{\n  gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n  vTextureCoord = aTextureCoord;\n}",ve="\n#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 color = vec4(0.0);\n\n  // Sample top left pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample top right pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample bottom right pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample bottom left pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Average\n  color *= 0.25;\n\n  gl_FragColor = color;\n}";function ye(t,e,i){var r=function(t,e,i){var r=ge(t,t.VERTEX_SHADER,e),n=ge(t,t.FRAGMENT_SHADER,i);if(!r||!n)return null;var a=t.createProgram();if(!a)return null;if(t.attachShader(a,r),t.attachShader(a,n),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS))return a;var o=t.getProgramInfoLog(a);return console.error("Failed to link program: "+o),t.deleteProgram(a),t.deleteShader(n),t.deleteShader(r),null}(t,e,i);if(r)return t.useProgram(r),t.program=r,1;console.error("Failed to create program")}function ge(t,e,i){var r=t.createShader(e);if(null==r)return console.error("unable to create shader"),null;if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;var n=t.getShaderInfoLog(r);return console.error("Failed to compile shader: "+n),t.deleteShader(r),null}function me(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),e}var be=function(){function a(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;u(this,a),this.webgl=t;var r,n=this.gl=t.ctx;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,-1),ye(n,_e,ve),this.vertexLocations=function(t){var e=new Float32Array([-1,1,0,1,-1,-1,0,0,1,1,1,1,1,-1,1,0]),i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);var r=Float32Array.BYTES_PER_ELEMENT,n=t.getAttribLocation(t.program,"aVertexPosition");t.vertexAttribPointer(n,2,t.FLOAT,!1,4*r,0),t.enableVertexAttribArray(n);var a=t.getAttribLocation(t.program,"aTextureCoord");t.vertexAttribPointer(a,2,t.FLOAT,!1,4*r,2*r);var o=t.getUniformLocation(t.program,"projectionMatrix");return t.uniformMatrix3fv(o,!1,new Float32Array([1,0,0,0,1,0,0,0,1])),t.enableVertexAttribArray(a),{aPosition:n,aTexCoord:a}}(n),this.textureLocations={uSampler:(r=n).getUniformLocation(r.program,"uSampler"),uOffset:r.getUniformLocation(r.program,"uOffset"),uClamp:r.getUniformLocation(r.program,"filterClamp")},this._pixelSize={x:0,y:0},this.pixelSize=1,this._kernels=null,this._blur=e,this.quality=i,this.textures=[],this.framebuffers=[]}return l(a,[{key:"initBuffers",value:function(t,e,i){for(var r=0;r<2;r++){var n=me(t);this.textures.push(n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null);var a=t.createFramebuffer();this.framebuffers.push(a),t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}}},{key:"draw",value:function(t,e,i){var r=this.textureLocations,n=r.uOffset,a=r.uClamp,o=this.gl;o.uniform2f(n,e[0],e[1]),o.viewport(0,0,t.width,t.height),o.uniform4f(a,0,0,t.width,t.height),i&&o.bindFramebuffer(o.FRAMEBUFFER,null),o.drawArrays(o.TRIANGLE_STRIP,0,4)}},{key:"apply",value:function(t,e,i){var r=this.gl;this.initBuffers(r,e,i);var n=this.textureLocations.uSampler;r.uniform1i(n,0);var a=me(r);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t.canvas);var o,s=this._pixelSize.x/e,h=this._pixelSize.y/i,u=this._quality-1;r.bindTexture(r.TEXTURE_2D,a);for(var l=0;l<u;l++){o=this._kernels[l]+.5,r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffers[l%2]);var c=new Float32Array([o*s,o*h]);this.draw(t.canvas,c,!1),r.bindTexture(r.TEXTURE_2D,this.textures[l%2])}o=this._kernels[u]+.5;var f=new Float32Array([o*s,o*h]);return this.draw(t.canvas,f,!0),this.webgl.draw(),t.ctx.clearRect(0,0,e,i),t.ctx.drawImage(r.canvas,0,0),t.draw(),this}},{key:"_generateKernels",value:function(){var t=this._blur,e=this._quality,i=[t];if(0<t)for(var r=t,n=t/e,a=1;a<e;a++)r-=n,i.push(r);this._kernels=i}},{key:"clear",value:function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}},{key:"kernels",get:function(){return this._kernels},set:function(t){Array.isArray(t)&&0<t.length?(this._kernels=t,this._quality=t.length,this._blur=Math.max.apply(Math,t)):(this._kernels=[0],this._quality=1)}},{key:"pixelSize",set:function(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):(this._pixelSize.x=1,this._pixelSize.y=1)},get:function(){return this._pixelSize}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this._generateKernels()}}]),a}();var ke={gaussBlur:function(t,e,i,r,n){return new be(e,i).apply(t,r,n)}},Ce=Ee.isFunction,Le=function(){function o(){u(this,o),this.__eHash={}}return l(o,[{key:"on",value:function(t,e){if(e){var i=this;if(Array.isArray(t))for(var r=0,n=t.length;r<n;r++)i.on(t[r],e);else if(e){i.__eHash.hasOwnProperty(t)||(i.__eHash[t]=[]);for(var a=0,o=i.__eHash[t],s=o.length;a<s;a++)if(o[a]===e)return i;i.__eHash[t].push(e)}return i}}},{key:"once",value:function(r,n){if(Ce(n)){var a=this;if(o.__karasEventCb=n,Array.isArray(r))for(var t=0,e=r.length;t<e;t++)a.once(r[t],n);else n&&a.on(r,o);return this}function o(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.apply(a,e),a.off(r,o)}}},{key:"off",value:function(t,e){if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)this.off(t[i],e);else if(this.__eHash.hasOwnProperty(t))if(e){for(var n=0,a=this.__eHash[t],o=a.length;n<o;n++)if(a[n]===e||a[n].__karasEventCb===e){a.splice(n,1);break}}else delete this.__eHash[t];return this}},{key:"emit",value:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];if(Array.isArray(t))for(var n=0,a=t.length;n<a;n++)this.emit(t[n],i);else if(this.__eHash.hasOwnProperty(t)){var o=this.__eHash[t];if(o.length)for(var s=0,h=(o=o.slice()).length;s<h;s++){var u=o[s];Ce(u)&&u.apply(this,i)}}return this}}],[{key:"mix",value:function(){for(var t=arguments.length-1;0<=t;t--){var e=t<0||arguments.length<=t?void 0:arguments[t],i=new o;e.__eHash={};for(var r=["on","once","off","emit"],n=r.length-1;0<=n;n--){var a=r[n];e[a]=i[a]}}}}]),o}();t(Le,"REFRESH","refresh"),t(Le,"PAUSE","pause"),t(Le,"PLAY","play"),t(Le,"FRAME","frame"),t(Le,"FINISH","finish"),t(Le,"CANCEL","cancel"),t(Le,"BEGIN","begin"),t(Le,"END","end");var Oe=function(){function a(t,e,i,r,n){u(this,a),this.__parent=t,this.__x=e,this.__y=i,this.__width=r,this.__content=n,this.__virtualDom={}}return l(a,[{key:"render",value:function(t,e,i,r){var n=this.content,a=this.x,o=this.y,s=this.parent,h=s.ox,u=s.oy;o+=ae.getBaseLine(i),a+=h,o+=u,t===we.CANVAS?e.fillText(n,a,o):t===we.SVG&&(this.__virtualDom={type:"item",tagName:"text",props:[["x",a],["y",o],["fill",r.color],["font-family",i.fontFamily],["font-weight",i.fontWeight],["font-style",i.fontStyle],["font-size",i.fontSize+"px"]],content:Ee.encodeHtml(n)})}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"content",get:function(){return this.__content}},{key:"baseLine",get:function(){return ae.getBaseLine(this.parent.computedStyle)}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}}]),a}(),Ne=function(){e(p,M);var i=f(p);function p(t){var e;return u(this,p),(e=i.call(this)).__content=Ee.isNil(t)?"":t.toString(),e.__lineBoxes=[],e.__charWidthList=[],e.__charWidth=0,e.__textWidth=0,e}return l(p,[{key:"__measure",value:function(t,e){var i=this.content,r=this.computedStyle,n=this.charWidthList;n.splice(0),t===we.CANVAS&&(e.font=ae.setFontStyle(r));for(var a=r.fontSize+","+r.fontFamily,o=p.MEASURE_TEXT.data[a]=p.MEASURE_TEXT.data[a]||{key:a,style:r,hash:{},s:[]},s=p.CHAR_WIDTH_CACHE[a]=p.CHAR_WIDTH_CACHE[a]||{},h=0,u=!1,l=0,c=i.length;l<c;l++){var f=i.charAt(l),d=void 0;s.hasOwnProperty(f)?(d=s[f],n.push(d),h+=d,this.__charWidth=Math.max(this.charWidth,d)):t===we.CANVAS?(d=s[f]=e.measureText(f).width,n.push(d),h+=d,this.__charWidth=Math.max(this.charWidth,d)):(o.hash.hasOwnProperty(f)||(o.s+=f),o.hash[f]=!0,n.push(-1),u=!0)}this.__textWidth=h,u&&p.MEASURE_TEXT.list.push(this)}},{key:"__measureCb",value:function(){for(var t,e=this.content,i=this.computedStyle,r=this.charWidthList,n=i.fontSize+","+i.fontFamily,a=p.CHAR_WIDTH_CACHE[n],o=0,s=0,h=r.length;s<h;s++){r[s]<0&&(o+=t=r[s]=a[e.charAt(s)],this.__charWidth=Math.max(this.charWidth,t))}this.__textWidth=o}},{key:"__layout",value:function(t,e){var i=this,r=t.x,n=t.y,a=t.w;this.__x=r,this.__y=n;var o=this.isDestroyed,s=this.content,h=this.computedStyle,u=this.lineBoxes,l=this.charWidthList;if(!o&&"none"!==h.display){this.__ox=this.__oy=0,u.splice(0);for(var c,f,d,p,_=0,v=0,y=0,g=s.length,m=0;v<g;){(y+=l[v])===a?(c=new Oe(this,r,n,y,s.slice(_,v+1)),u.push(c),m=Math.max(m,y),n+=h.lineHeight,v=_=v+1,y=0):a<y?(f=void 0,f=v===_?(v=_+1,y):y-l[v],d=new Oe(this,r,n,f,s.slice(_,v)),u.push(d),m=Math.max(m,f),n+=h.lineHeight,_=v,y=0):v++}if(_<g&&_<v){for(y=0,v=_;v<g;v++)y+=l[v];var b=new Oe(this,r,n,y,s.slice(_,g));u.push(b),m=Math.max(m,y),n+=h.lineHeight}this.__width=m,this.__height=n-t.y,e||(p=h.textAlign,-1<["center","right"].indexOf(p)&&u.forEach(function(t){var e=i.__width-t.width;0<e&&t.__offsetX("center"===p?.5*e:e)}))}}},{key:"__offsetX",value:function(e,t){J(K(p.prototype),"__offsetX",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetX(e)})}},{key:"__offsetY",value:function(e,t){J(K(p.prototype),"__offsetY",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetY(e)})}},{key:"__tryLayInline",value:function(t){return t-this.textWidth}},{key:"__calMaxAndMinWidth",value:function(){var e=0;return this.charWidthList.forEach(function(t){e=Math.max(e,t)}),{max:this.textWidth,min:e}}},{key:"__calAbsWidth",value:function(t,e,i){return this.__layout({x:t,y:e,w:i},!0),this.width}},{key:"render",value:function(e,i){e===we.SVG&&(this.__virtualDom={type:"text",children:[]});var t,r,n=this.isDestroyed,a=this.computedStyle,o=this.lineBoxes,s=this.cacheStyle;n||"none"===a.display||"hidden"===a.visibility||(e===we.CANVAS&&(t=ae.setFontStyle(a),i.font!==t&&(i.font=t),r=s.color,i.fillStyle!==r&&(i.fillStyle=r)),o.forEach(function(t){t.render(e,i,a,s)}),e===we.SVG&&(this.virtualDom.children=o.map(function(t){return t.virtualDom})))}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"lineBoxes",get:function(){return this.__lineBoxes}},{key:"charWidthList",get:function(){return this.__charWidthList}},{key:"charWidth",get:function(){return this.__charWidth}},{key:"textWidth",get:function(){return this.__textWidth}},{key:"baseLine",get:function(){var t=this.lineBoxes;if(!t.length)return 0;var e=t[t.length-1];return e.y-this.y+e.baseLine}},{key:"currentStyle",get:function(){return this.parent.currentStyle}},{key:"computedStyle",get:function(){return this.parent.computedStyle}},{key:"cacheStyle",get:function(){return this.parent.__cacheStyle}}]),p}();t(Ne,"CHAR_WIDTH_CACHE",{}),t(Ne,"MEASURE_TEXT",{list:[],data:{}}),Ne.prototype.__renderByMask=Ne.prototype.render;var De={},Fe={};var Ie,We,Be={},He={measureText:function(t){var e=Ne.MEASURE_TEXT,i=e.list,u=e.data,l="",c=[],f=[];if(Object.keys(u).forEach(function(t){var e=u[t],i=e.key,r=e.style,n=e.s;if(n)for(var a="position:absolute;font-family:".concat(r.fontFamily,";font-size:").concat(r.fontSize,"px"),o=0,s=n.length;o<s;o++){c.push(i);var h=n.charAt(o);f.push(h),l+='<span style="'.concat(a,'">').concat(h.replace(/</,"&lt;").replace(" ","&nbsp;"),"</span>")}}),l){var r=document.createElement("div");r.style.position="absolute",r.style.left="99999px",r.style.top="-99999px",r.style.visibility="hidden",document.body.appendChild(r),r.innerHTML=l;for(var n=r.childNodes,a=Ne.CHAR_WIDTH_CACHE,o=Ne.MEASURE_TEXT,s=0,h=n.length;s<h;s++){var d=n[s],p=c[s],_=f[s],v=window.getComputedStyle(d,null);a[p][_]=parseFloat(v.width)}i.forEach(function(t){return t.__measureCb()}),t(),o.list=[],o.data={},document.body.removeChild(r)}else t()},IMG:Be,INIT:0,LOADED:2,LOADING:1,measureImg:function(t,e){var i,r,n=Be[t]=Be[t]||{state:0,task:[]};2===n.state?e(n):1===n.state?n.task.push(e):(n.state=1,n.task.push(e),(i=new Image).onload=function(){n.state=2,n.success=!0,n.width=i.width,n.height=i.height,n.source=i,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},i.onerror=function(){n.state=2,n.success=!1,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},"data:"===t.substr(0,5)||(r=/^(?:\w+:)?\/\/([^/:]+)/.exec(t))&&location.hostname!==r[1]&&(i.crossOrigin="anonymous"),i.src=t)},warn:function(t){console.warn(t)},requestAnimationFrame:(We=function(t){var e;return"undefined"!=typeof requestAnimationFrame?(He.requestAnimationFrame=requestAnimationFrame.bind(window),e=requestAnimationFrame(t)):(e=setTimeout(t,1e3/60),He.requestAnimationFrame=function(t){return setTimeout(t,1e3/60)}),e},$e.toString=function(){return We.toString()},$e),cancelAnimationFrame:(Ie=function(t){var e;return"undefined"!=typeof cancelAnimationFrame?(He.cancelAnimationFrame=cancelAnimationFrame.bind(window),e=cancelAnimationFrame(t)):(e=clearTimeout(t),He.cancelAnimationFrame=function(t){return clearTimeout(t)}),e},Ge.toString=function(){return Ie.toString()},Ge),now:function(){return"undefined"!=typeof performance?(He.now=performance.now.bind(performance),performance.now()):(He.now=Date.now.bind(Date),Date.now())},getCacheCanvas:function(t,e,i){var r,n,a,o;return n=t,a=e,(o=De[r=2<arguments.length&&void 0!==i?i:"__$$cache$$__"]?De[r]:De[r]=document.createElement("canvas")).setAttribute("width",n),o.setAttribute("height",a),o.style.width=n+"px",o.style.height=a+"px",{canvas:o,ctx:o.getContext("2d"),draw:function(){}}},getCacheWebgl:function(t,e,i){var r,n,a,o;return n=t,a=e,(o=Fe[r=2<arguments.length&&void 0!==i?i:"__$$cache$$__"]?Fe[r]:Fe[r]=document.createElement("canvas")).setAttribute("width",n),o.setAttribute("height",a),o.style.width=n+"px",o.style.height=a+"px",{canvas:o,ctx:o.getContext("webgl")||o.getContext("experimental-webgl"),draw:function(){}}},isDom:function(t){if(t){if(Ee.isString(t))return!0;if("undefined"!=typeof window&&window.Element&&t instanceof window.Element)return!0;if(Ee.isFunction(t.getElementsByTagName))return!0}return!1}};function Ge(t){return Ie.apply(this,arguments)}function $e(t){return We.apply(this,arguments)}var Xe=Ee.isFunction,Ye=Ee.isObject;function ze(t,e,i){"before"===i?t.forEach(function(t){Ye(t)&&Xe(t.before)&&t.before(e)}):"after"===i&&t.forEach(function(t){Ye(t)&&Xe(t.after)?t.after(e):Xe(t)&&t(e)})}var je=new(function(){function t(){u(this,t),this.__hookTask=[],this.__task=[],this.__now=null}return l(t,[{key:"__init",value:function(){var n=this,a=n.task;He.cancelAnimationFrame(n.id);var o=n.__now=He.now();!function r(){He.cancelAnimationFrame(n.id),n.id=He.requestAnimationFrame(function(){var t,e,i;a.length&&(e=(t=n.__now=He.now())-o,e=Math.max(e,0),o=t,ze(i=a.slice(0),e,"before"),n.__hookTask.splice(0).forEach(function(t){return t()}),ze(i,e,"after"),a.length&&r())})}()}},{key:"onFrame",value:function(t){var e;t&&((e=this.task).length||this.__init(),e.push(t))}},{key:"offFrame",value:function(t){if(t){for(var e=this.task,i=0,r=e.length;i<r;i++){var n=e[i];if(n===t||n.__karasFramecb===t){e.splice(i,1);break}}e.length||(He.cancelAnimationFrame(this.id),this.__now=null)}}},{key:"nextFrame",value:function(e){var i,r=this;e&&((i=Xe(e)?function(t){e(t),r.offFrame(i)}:{before:e.before,after:function(t){e.after&&e.after(t),r.offFrame(i)}}).__karasFramecb=e,this.onFrame(i))}},{key:"task",get:function(){return this.__task}},{key:"aTask",get:function(){return this.__aTask}}]),t}()),Ve=4,Ue=1e-7,qe=10,Ze="function"==typeof Float32Array;function Ke(t,e){return 1-3*e+3*t}function Je(t,e){return 3*e-6*t}function Qe(t,e,i){return((Ke(e,i)*t+Je(e,i))*t+3*e)*t}function ti(t,e,i){return 3*Ke(e,i)*t*t+2*Je(e,i)*t+3*e}function ei(t){return t}function ii(a,e,o,i){if(!(0<=a&&a<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(a===e&&o===i)return ei;for(var s=new(Ze?Float32Array:Array)(11),t=0;t<11;++t)s[t]=Qe(.1*t,a,o);function r(t){for(var e=0,i=1;10!==i&&s[i]<=t;++i)e+=.1;var r=e+.1*((t-s[--i])/(s[i+1]-s[i])),n=ti(r,a,o);return.001<=n?function(t,e,i,r){for(var n=0;n<Ve;++n){var a=ti(e,i,r);if(0===a)return e;e-=(Qe(e,i,r)-t)/a}return e}(t,r,a,o):0===n?r:function(t,e,i,r,n){for(var a,o,s=0;0<(a=Qe(o=e+(i-e)/2,r,n)-t)?i=o:e=o,Math.abs(a)>Ue&&++s<qe;);return o}(t,e,e+.1,a,o)}return function(t){return 0===t||1===t?t:Qe(r(t),e,i)}}var ri={linear:ii(1,1,0,0),easeIn:ii(.42,0,1,1),easeOut:ii(0,0,.58,1),ease:ii(.25,.1,.25,1),easeInOut:ii(.42,0,.58,1),cubicBezier:ii},ni={REPAINT:0,REFLOW:1},ai=s.AUTO,oi=s.PX,si=s.PERCENT,hi=s.INHERIT,ui=s.RGBA,li=s.STRING,ci=s.NUMBER,fi=Ee.isNil,di=Ee.isFunction,pi=Ee.isNumber,_i=Ee.isObject,vi=Ee.clone,yi=Ee.equalArr,gi=ri.linear,mi=Ot.COLOR_HASH,bi=Ot.LENGTH_HASH,ki=Ot.RADIUS_HASH,xi=Ot.GRADIENT_HASH,Mi=Ot.EXPAND_HASH,wi=Ot.GRADIENT_TYPE;function Si(t,e,i,r){for(var n=!1,a=ni.REPAINT,o=0,s=i.length;o<s;o++){var h=i[o],u=t[h],l=e[h];if(fi(u)||fi(l)){if(!(fi(u)&&fi(l)||(n=!0,Lt.isRepaint(h)))){a=ni.REFLOW;break}}else if(!ae.equalStyle(h,u,l,r)){if(n=!0,a!==ni.REPAINT)break;if(!Lt.isRepaint(h)){a=ni.REFLOW;break}}}return[n,a]}function Ai(t,e,i,r){i.setRefreshLevel(r),i.__frameHook(),Ei(t,e),e.__style=t,e.__assigning=!0}function Ei(i,t){var r,n=t.target;t.keys.forEach(function(t){"zIndex"===t&&(r=!0);var e=i.hasOwnProperty(t)?i[t]:n.style[t];Lt.GEOM.hasOwnProperty(t)?(n.currentProps[t]=e,n.__cacheProps[t]=void 0):(n.currentStyle[t]=e,n.__cacheStyle[t]=void 0)}),n.__cacheSvg=!1,r&&/svg/i.test(n.root.tagName)&&n.__cancelCacheSvg()}function Pi(i,r,t,n){return t.forEach(function(t){var e=function(t,e,i,r){var n={k:i},a=t[i],o=e[i];if("transform"===i){if(!a&&!o)return;var s=a?a[0][1]:[1,0,0,1,0,0],h=o?o[0][1]:[1,0,0,1,0,0];if(yi(s,h))return;return n.v=[h[0]-s[0],h[1]-s[1],h[2]-s[2],h[3]-s[3],h[4]-s[4],h[5]-s[5]],n}if("filter"===i)a&&a.length?o&&o.length?n.v=o[0][1]-a[0][1]:n.v=-a[0][1]:n.v=o[0][1];else if("transformOrigin"===i){n.v=[];for(var u=0;u<2;u++){var l,c,f=a[u],d=o[u];f.unit===d.unit?n.v.push(d.value-f.value):f.unit===oi&&d.unit===si?(l=.01*d.value*r[u?"outerHeight":"outerWidth"],n.v.push(l-f.value)):f.unit===si&&d.unit===oi&&(c=100*d.value/r[u?"outerHeight":"outerWidth"],n.v.push(c-f.value))}if(yi(n.v,[0,0]))return}else if("backgroundPositionX"===i||"backgroundPositionY"===i){if(a.unit===o.unit&&-1<[oi,si].indexOf(a.unit)){var p=o.value-a.value;if(0==p)return;n.v=p}else if(a.unit===oi&&o.unit===si){var _=.01*o.value*r["backgroundPositionX"===i?"innerWidth":"innerHeight"];if(0==(_-=a.value))return;n.v=_}else if(a.unit===si&&o.unit===oi){var v=100*o.value/r["backgroundPositionX"===i?"innerWidth":"innerHeight"];if(0==(v-=a.value))return;n.v=v}}else if("boxShadow"===i){n.v=[];for(var y=0,g=Math.min(a.length,o.length);y<g;y++){for(var m=a[y],b=o[y],k=[],x=0;x<4;x++)k.push(b[x]-m[x]);for(var M=[],w=0;w<4;w++)M.push(b[4][w]-m[4][w]);k.push(M),n.v.push(k)}}else if(Mi.hasOwnProperty(i)){if(a.unit===o.unit){var S=o.value-a.value;if(0==S)return;n.v=S}else if(a.unit===oi&&o.unit===si){var A=.01*o.value*r[/\w+X$/.test(i)?"outerWidth":"outerHeight"];if(0==(A-=a.value))return;n.v=A}else if(a.unit===si&&o.unit===oi){var E=100*o.value/r[/\w+X$/.test(i)?"outerWidth":"outerHeight"];if(0==(E-=a.value))return;n.v=E}}else if("backgroundSize"===i){n.v=[];for(var P=0;P<2;P++){var T=a[P],R=o[P];if(T.unit===R.unit&&-1<[oi,si].indexOf(T.unit))n.v.push(R.value-T.value);else if(T.unit===oi&&R.unit===si){var C=.01*R.value*r[P?"innerWidth":"innerHeight"];n.v.push(C-T.value)}else{if(T.unit!==si||R.unit!==oi)return;var L=100*R.value/r[P?"innerWidth":"innerHeight"];n.v.push(L-T.value)}}if(yi(n.v,[0,0]))return}else if(xi.hasOwnProperty(i)){if(a.k!==o.k)return;if("linear"===a.k||"radial"===a.k){var O=a.v,N=o.v;if(yi(O,N))return;n.v=[];for(var D,F=r.innerWidth,I=0,W=Math.min(O.length,N.length);I<W;I++){var B=O[I],H=N[I],G=[];G.push([H[0][0]-B[0][0],H[0][1]-B[0][1],H[0][2]-B[0][2],H[0][3]-B[0][3]]),D=yi(G,[0,0,0,0]),B[1]&&H[1]?(B[1].unit===H[1].unit?G.push(H[1].value-B[1].value):B[1].unit===oi&&H[1].unit===si?G.push(H[1].value*F*.01-B[1].value):B[1].unit===si&&H[1].unit===oi&&G.push(100*H[1].value/F-B[1].value),D=D&&0===G[4]):(B[1]||H[1])&&(D=!1),n.v.push(G)}if("linear"===a.k){var $=o.d-a.d;if(D&&0==$)return;n.d=$}else{n.p=[];for(var X=0;X<2;X++){var Y,z,j=a.p[X],V=o.p[X];j.unit===V.unit?n.p.push(V.value-j.value):j.unit===oi&&V.unit===si?(Y=.01*V.value*r[X?"innerWidth":"innerHeight"],n.p.push(Y-j.value)):j.unit===si&&V.unit===oi&&(z=100*V.value/r[X?"innerWidth":"innerHeight"],n.p.push(z-j.value))}if(D&&yi(n.p,[0,0]))return}}else{if(yi(o,a))return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}}else if(mi.hasOwnProperty(i)){if(o=o.value,a=a.value,yi(o,a)||0===o[3]&&0===a[3])return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}else if(ki.hasOwnProperty(i)){if(o[0].value===a[0].value&&o[0].unit===a[0].unit&&o[1].value===a[1].value&&o[1].unit===a[1].unit)return;n.v=[];for(var U=0;U<2;U++)o[U].unit===a[U].unit?n.v.push(o[U].value-a[U].value):a[U].unit===oi&&o[U].unit===si?n.v.push(.01*o[U].value*r[U?"outerHeight":"outerWidth"]-a[U].value):a[U].unit===si&&o[U].unit===oi?n.v.push(100*o[U].value/r[U?"outerHeight":"outerWidth"]-a[U].value):n.v.push(0)}else if(bi.hasOwnProperty(i)){if(a.unit===ai||o.unit===ai)return;var q,Z,K=r.computedStyle,J=(r.parent||r).computedStyle,Q=0;if(a.unit===o.unit?Q=o.value-a.value:a.unit===oi&&o.unit===si?("fontSize"===i?q=o.value*J[i]*.01:"flexBasis"===i&&"row"===K.flexDirection||"width"===i||/margin/.test(i)||/padding/.test(i)||-1<["left","right"].indexOf(i)?q=o.value*J.width*.01:("flexBasis"===i||"height"===i||-1<["top","bottom"].indexOf(i))&&(q=o.value*J.height*.01),Q=q-a.value):a.unit===si&&o.unit===oi?("fontSize"===i?Z=100*o.value/J[i]:"flexBasis"===i&&"row"===K.flexDirection||"width"===i||/margin/.test(i)||/padding/.test(i)||-1<["left","right"].indexOf(i)?Z=100*o.value/J.width:("flexBasis"===i||"height"===i||-1<["top","bottom"].indexOf(i))&&(Z=100*o.value/J.height),Q=Z-a.value):"lineHeight"===i&&(a.unit===oi&&o.unit===ci?Q=o.value*K.fontSize-a.value:a.unit===ci&&o.unit===oi&&(Q=o.value/K.fontSize-a.value)),0===Q||isNaN(Q))return;n.v=Q}else if(Lt.GEOM.hasOwnProperty(i)){if(fi(a))return;if(r.isMulti)if("points"===i||"controls"===i){if(fi(o)||fi(a)||yi(a,o))return;n.v=[];for(var tt=0,et=Math.min(a.length,o.length);tt<et;tt++){var it=a[tt],rt=o[tt];if(fi(it)||fi(rt))n.v.push(null);else{for(var nt=[],at=0,ot=Math.min(it.length,rt.length);at<ot;at++){var st=it[at],ht=rt[at];if(fi(st)||fi(ht))nt.push(null);else{for(var ut=[],lt=0,ct=Math.max(st.length,ht.length);lt<ct;lt++){var ft=st[lt],dt=ht[lt];fi(ft)||fi(dt)?ut.push(0):ut.push(dt-ft)}nt.push(ut)}}n.v.push(nt)}}}else if("controlA"===i||"controlB"===i){if(fi(o)||fi(a)||yi(a,o))return;n.v=[];for(var pt=0,_t=Math.min(a.length,o.length);pt<_t;pt++){var vt=a[pt],yt=o[pt];fi(vt)||fi(yt)?n.v.push(null):n.v.push([yt[0]-vt[0],yt[1]-vt[1]])}}else{if(o===a||yi(o,a)||"edge"===i||"closure"===i)return;for(var gt=[],mt=0,bt=Math.min(a.length,o.length);mt<bt;mt++){var kt=a[mt],xt=o[mt];(fi(kt)||fi(xt))&&gt.push(0),gt.push(xt-kt)}n.v=gt}else if("points"===i||"controls"===i){if(fi(o)||fi(a)||yi(a,o))return;n.v=[];for(var Mt=0,wt=Math.min(a.length,o.length);Mt<wt;Mt++){var St=a[Mt],At=o[Mt];if(fi(St)||fi(At))n.v.push(null);else{for(var Et=[],Pt=0,Tt=Math.max(St.length,At.length);Pt<Tt;Pt++){var Rt=St[Pt],Ct=At[Pt];fi(Rt)||fi(Ct)?Et.push(0):Et.push(Ct-Rt)}n.v.push(Et)}}}else if("controlA"===i||"controlB"===i){if(fi(o)||fi(a)||yi(a,o))return;n.v=[o[0]-a[0],o[1]-a[1]]}else{if(o===a||"edge"===i||"closure"===i)return;n.v=o-a}}else{if("opacity"!==i&&"zIndex"!==i)return;if(o===a)return;n.v=o-a}return n}(i.style,r.style,t,n);e&&i.transition.push(e)}),r}function Ti(t,O,N){var e,i,r,n,a,D=vi(t.style),o=(e=t.easing,r=/^\s*(?:cubic-bezier\s*)?\(\s*[\d.]+\s*,\s*[-\d.]+\s*,\s*[\d.]+\s*,\s*[-\d.]+\s*\)\s*$/i.test(e)?(i=e.match(/[\d.]+/g),ri.cubicBezier(i[0],i[1],i[2],i[3])):(r=/^\s*steps\s*\(\s*(\d+)(?:\s*,\s*(\w+))?\s*\)/i.exec(e))?(n=parseInt(r[1]),a=r[2],function(t){if(n&&0<n){var e=1/n;return("start"===a?Math.ceil(t/e):Math.floor(t/e))/n}return t}):ri[e]||gi);return o!==gi&&(O=o(O)),t.transition.forEach(function(t){var e=t.k,i=t.v,r=t.d,n=t.p,a=D[e];if("transform"===e){a=a||(D[e]=[["matrix",[1,0,0,1,0,0]]]);for(var o=0;o<6;o++)a[0][1][o]+=i[o]*O}else if("filter"===e)(a=a||(D[e]=[["blur",0]]))[0][1]+=i*O;else if(ki.hasOwnProperty(e))for(var s=0;s<2;s++)a[s].value+=i[s]*O;else if("backgroundPositionX"===e||"backgroundPositionY"===e||bi.hasOwnProperty(e)||Mi.hasOwnProperty(e))0!==i&&(a.value+=i*O);else if("transformOrigin"===e||"backgroundSize"===e)0!==i[0]&&(a[0].value+=i[0]*O),0!==i[1]&&(a[1].value+=i[1]*O);else if("boxShadow"===e)for(var h=0,u=Math.min(a.length,i.length);h<u;h++){for(var l=0;l<4;l++)a[h][l]+=i[h][l]*O;for(var c=0;c<4;c++)a[h][4][c]+=i[h][4][c]*O}else if(xi.hasOwnProperty(e))if(wi.hasOwnProperty(a.k)){for(var f=0,d=Math.min(a.v.length,i.length);f<d;f++){var p=a.v[f],_=i[f];p[0][0]+=_[0][0]*O,p[0][1]+=_[0][1]*O,p[0][2]+=_[0][2]*O,p[0][3]+=_[0][3]*O,p[1]&&_[1]&&(p[1].value+=_[1]*O)}"linear"===a.k&&void 0!==a.d&&void 0!==r&&(a.d+=r*O),"radial"===a.k&&void 0!==a.p&&void 0!==n&&(a.p[0].value+=n[0]*O,a.p[1].value+=n[1]*O)}else a[0]+=i[0]*O,a[1]+=i[1]*O,a[2]+=i[2]*O,a[3]+=i[3]*O;else if(mi.hasOwnProperty(e))(a=a.value)[0]+=i[0]*O,a[1]+=i[1]*O,a[2]+=i[2]*O,a[3]+=i[3]*O;else if(Lt.GEOM.hasOwnProperty(e)){var v=D[e];if(N.isMulti)if("points"===e||"controls"===e)for(var y=0,g=Math.min(v.length,i.length);y<g;y++){var m=v[y],b=i[y];if(!fi(m)&&!fi(b))for(var k=0,x=Math.min(m.length,b.length);k<x;k++){var M=m[k],w=b[k];if(!fi(M)&&!fi(w))for(var S=0,A=Math.min(M.length,w.length);S<A;S++)fi(M[S])||fi(w[S])||(M[S]+=w[S]*O)}}else"controlA"===e||"controlB"===e?i.forEach(function(t,e){var i=v[e];if(!fi(t)&&!fi(i))for(var r=0,n=Math.min(i.length,t.length);r<n;r++){var a=i[r],o=t[r];fi(a)||fi(o)||(i[r]+=o*O)}}):i.forEach(function(t,e){fi(t)||fi(v[e])||(v[e]+=t*O)});else if("points"===e||"controls"===e)for(var E=0,P=Math.min(v.length,i.length);E<P;E++){var T=v[E],R=i[E];if(!fi(T)&&!fi(R))for(var C=0,L=Math.min(T.length,R.length);C<L;C++)fi(T[C])||fi(R[C])||(T[C]+=R[C]*O)}else"controlA"===e||"controlB"===e?(fi(v[0])||fi(i[0])||(v[0]+=i[0]*O),fi(v[1])||fi(i[1])||(v[1]+=i[1]*O)):fi(v)||fi(i)||(D[e]+=i*O)}else"opacity"!==e&&"zIndex"!==e||(D[e]+=i*O)}),D}function Ri(t,e){return di(t)&&(e=t,t={}),[t||{},e]}var Ci=0,Li=function(){e(s,Le);var o=f(s);function s(t,n,e){var i,a;u(this,s),(i=o.call(this)).__id=Ci++,i.__target=t,n=vi(n||[]),Array.isArray(n)?i.__list=n.filter(function(t){return t&&_i(t)}):n&&_i(n)?(a=[],Object.keys(n).forEach(function(t){var e=n[t];if(Array.isArray(e))for(var i=0,r=e.length;i<r;i++){(a[i]=a[i]||{offset:i/(r-1)})[t]=e[i]}}),i.__list=a):i.__list=[],pi(e)&&(i.__options={duration:e},e=i.__options);var r=i.__options=e||{};return i.__duration=Math.max(0,parseFloat(r.duration)||0),i.delay=r.delay,i.endDelay=r.endDelay,i.iterations=r.iterations,i.fps=r.fps,i.fill=r.fill,i.direction=r.direction,i.playbackRate=r.playbackRate,i.__easing=r.easing,i.playCount=0,i.spfLimit=r.spfLimit,i.__frames=[],i.__framesR=[],i.__startTime=null,i.currentTime=0,i.__nextTime=0,i.__fpsTime=0,i.__playState="idle",i.__isDestroyed=!1,i.__style={},i.__assigning=!1,i.__init(),i}return l(s,[{key:"__init",value:function(){var r=this,n=this.iterations,o=this.duration,i=this.list,s=this.easing,a=this.target;if(!(n<1||i.length<1)){for(var t,e=0,h=i.length;e<h;e++){var u=i[e];u.hasOwnProperty("offset")&&(u.offset=parseFloat(u.offset)||0,u.offset=Math.max(0,u.offset),u.offset=Math.min(1,u.offset),(isNaN(u.offset)||u.offset<0||1<u.offset||u.offset<=-1)&&(i.splice(e,1),e--,h--))}1===i.length?(i[0]=vi(i[0]),1===i[0].offset?i.unshift({offset:0}):((t=vi(i[0])).offset=1,i.push(t))):i.forEach(function(t,e){i[e]=vi(t)});var l=i[0];l.hasOwnProperty("offset")&&0<l.offset?(l={offset:0},i.unshift(l)):l.offset=0;var c=i[i.length-1];c.hasOwnProperty("offset")&&c.offset<1?(c={offset:1},i.push(c)):c.offset=1;for(var f=1,d=i.length;f<d;f++){if(!(y=i[f]).hasOwnProperty("offset")){for(var p=void 0,_=f+1;_<d&&!(p=i[_]).hasOwnProperty("offset");_++);for(var v=_-f+1,y=i[f-1],g=(p.offset-y.offset)/v,m=f;m<_;m++){i[m].offset=y.offset+g*(m+1-f)}f=_}}var b=[];i.forEach(function(t){var e,i,r,n,a;b.push((i=o,r=s,n=(e=t).offset,a=e.easing,delete e.offset,delete e.easing,{style:e=ae.normalize(e),time:n*i,easing:a||r,transition:[]}))}),this.__frames=b;var k,x,M,w,S,A,E,P,T=this.__keys=(x=a,M={},w=[],(k=b).forEach(function(t){var i=t.style;Object.keys(i).forEach(function(t){var e=i[t];fi(e)||M.hasOwnProperty(t)||(M[t]=!0,w.push(t))})}),k.forEach(function(t){var e=t.style;w.forEach(function(t){e.hasOwnProperty(t)&&!fi(e[t])||(Lt.GEOM.hasOwnProperty(t)?e[t]=x.currentProps[t]:e[t]=x.currentStyle[t])})}),w);S=b,A=T,P=(E=a).computedStyle,S.forEach(function(t){var a=t.style;A.forEach(function(t){var e,i,r,n=a[t];fi(n)||("transform"===t?(e=E.outerWidth,i=E.outerHeight,r=Pe.calMatrix(n,e,i),a[t]=[["matrix",r]]):n.unit===hi&&("color"===t?a[t]={value:Ee.rgba2int(P[t]),unit:ui}:bi.hasOwnProperty(t)?a[t]={value:P[t],unit:oi}:"fontWeight"===t?a[t]={value:P[t],unit:ci}:"fontStyle"!==t&&"fontFamily"!==t&&"textAlign"!==t||(a[t]={value:P[t],unit:li})))})});for(var R=b.length,C=b[0],L=1;L<R;L++)C=Pi(C,b[L],T,a);var O=vi(b).reverse();O.forEach(function(t){t.time=o-t.time,t.transition=[]}),C=O[0];for(var N=1;N<R;N++){C=Pi(C,O[N],T,a)}this.__framesR=O,this.__clean=function(t){var e;r.__cancelTask(),r.__nextTime=0;var i=r.style;t?(r.__currentTime=r.delay+o+r.endDelay,r.__playCount=n,r.__playState="finished",r.__stayEnd()||(r.__style={},e=!0)):(r.__playCount=r.__currentTime=0,r.__playState="idle",r.__style={},e=!0),e&&T.forEach(function(t){Lt.GEOM.hasOwnProperty(t)?a.__currentProps[t]===i[t]&&(a.__currentProps[t]=a.props[t]):a.__currentStyle[t]===i[t]&&(a.__currentStyle[t]=a.style[t]),a.__cacheSvg=!1})},this.__fin=function(t,e){r.__begin=r.__end=r.__isDelay=r.__finish=r.__inFps=r.__enterFrame=null,r.emit(Le.FINISH),di(t)&&t(e)},this.__frameCb=function(t,e){r.emit(Le.FRAME,t,e),r.__firstPlay&&(r.__firstPlay=!1,r.emit(Le.PLAY)),di(r.__playCb)&&(r.__playCb(t,e),r.__playCb=null)}}}},{key:"__calDiffTime",value:function(t){var e=this.playbackRate,i=this.spfLimit,r=this.fps;return this.__currentTime=this.__nextTime,i&&(!0===i?t=Math.min(t,1e3/r):0<i&&(t=Math.min(t,i))),1!==e&&0<e&&(t*=e),this.__nextTime+=t,this.__currentTime}},{key:"play",value:function(t){var k=this,e=this.isDestroyed,x=this.duration,i=this.playState,r=this.__frameCb,n=this.list;if(e||x<=0||n.length<1)return this;if("running"===i)return this;this.__cancelTask(),this.__playCb=t,this.__playState="running";var M,w,S,A,E,P,T,a,R,C,L,O,N,D=this.__firstPlay=!0;return this.__enterFrame||(M=this.frames,w=this.framesR,S=this.direction,A=this.delay,E=this.endDelay,P=this.keys,T=this.__clean,a=this.__fin,R=this.target,C=this.__stayEnd(),L=this.__stayBegin(),this.__currentTime=this.__nextTime=this.__fpsTime=0,O=M.length,N=this.__enterFrame={before:function(t){var e=k.root,i=k.style,r=k.fps,n=k.playCount,a=k.iterations;if(e){var o,s,h,u,l,c,f=k.__calDiffTime(t);if(!D&&r<60){if((t=k.__fpsTime+=t)<1e3/r)return void(k.__inFps=!0);k.__fpsTime=0}if(D=!1,0<n&&(A=0),f<A)return L&&(h=(s=xe(Si(o=M[0].style,i,P,R),2))[0],u=s[1],h&&Ai(o,k,e,u)),0===f&&(k.__begin=!0),void(k.__isDelay=!0);c="reverse"===S?w:{alternate:!0,"alternate-reverse":!0}.hasOwnProperty(S)?(l=n%2==0,"alternate"===S?l?M:w:l?w:M):M,0===(f-=A)&&(k.__begin=!0);var d,p,_,v,y=function t(e,i,r,n){if(e===i)return n[e].time>r?e-1:e;var a=e+(i-e>>1),o=n[a];return o.time===r?a:o.time>r?t(e,Math.max(a-1,e),r,n):t(Math.min(a+1,i),i,r,n)}(0,O-1,f,c),g=c[y],m=y===O-1,b=a-1<=n;m?(d=f<x+E,h=(p=xe(Si(g=C||!b?g.style:{},i,P,R),2))[0],u=p[1],b?d||(k.__nextTime=0,a<=(n=++k.__playCount)&&je.offFrame(N)):(k.__nextTime=f-x,n=++k.__playCount,k.__nextBegin=!0)):(_=c[y+1].time-g.time,h=(v=xe(Si(g=Ti(g,(f-g.time)/_,R),i,P,R),2))[0],u=v[1]),h&&Ai(g,k,e,u),!m||d&&!b||(k.__end=!0,a<=n&&(k.__finish=!0,T(!0)))}},after:function(t){k.__assigning=!1,k.__inFps?k.__inFps=!1:(r(t,k.__isDelay),k.__isDelay=!1,k.__begin&&(k.__begin=!1,k.emit(Le.BEGIN,k.playCount)),k.__end&&(k.__end=!1,k.emit(Le.END,k.playCount-1)),k.__finish&&(k.__finish=!1,a()),k.__nextBegin&&(k.__nextBegin=!1,k.__begin=!0))}}),je.onFrame(this.__enterFrame),this.__startTime=je.__now,this}},{key:"pause",value:function(){var t=this.isDestroyed,e=this.duration,i=this.pending;return t||e<=0||i||(this.__playState="paused",this.__cancelTask(),this.emit(Le.PAUSE)),this}},{key:"resume",value:function(t){var e=this.isDestroyed,i=this.duration,r=this.playState;return e||i<=0||"paused"!==r?this:this.play(t)}},{key:"finish",value:function(e){var i=this,t=this.isDestroyed,r=this.duration,n=this.playState,a=this.list;if(t||r<=0||a.length<1||"finished"===n||"idle"===n)return this;this.__cancelTask();var o,s,h,u,l,c=this.root,f=this.style,d=this.keys,p=this.frames,_=this.__frameCb,v=this.__clean,y=this.__fin,g=this.target;return c&&(u=this.__stayEnd()?(h=(s=xe(Si(o=p[p.length-1].style,f,d,g),2))[0],s[1]):(h=(l=xe(Si(o={},f,d,g),2))[0],l[1]),h?je.nextFrame(this.__enterFrame={before:function(){Ai(o,i,c,u),v(!0)},after:function(t){i.__assigning=!1,_(t),y(e,t)}}):(v(!0),y(e,0))),this}},{key:"cancel",value:function(e){var i=this,t=this.isDestroyed,r=this.duration,n=this.playState,a=this.list;if(t||r<=0||"idle"===n||a.length<1)return this;this.__cancelTask();var o,s,h,u,l=this.root,c=this.style,f=this.keys,d=this.__frameCb,p=this.__clean,_=this.target;return l&&(s=(o=xe(Si({},c,f,_),2))[0],h=o[1],u=function(t){i.__cancelTask(),i.__begin=i.__end=i.__isDelay=i.__finish=i.__inFps=i.__enterFrame=null,i.emit(Le.CANCEL),di(e)&&e(t)},s?je.nextFrame(this.__enterFrame={before:function(){Ai({},i,l,h),p()},after:function(t){i.__assigning=!1,d(t),u(t)}}):(p(),u(0))),this}},{key:"gotoAndPlay",value:function(t,e,i){var r=this.isDestroyed,n=this.duration,a=this.delay,o=this.endDelay;if(r||n<=0)return this;var s=xe(Ri(e,i),2);return e=s[0],i=s[1],this.__goto(t,e.isFrame,e.excludeDelay),n+a+o<t?this.finish(i):this.play(i)}},{key:"gotoAndStop",value:function(t,e,i){var r=this,n=this.isDestroyed,a=this.duration,o=this.delay,s=this.endDelay;if(n||a<=0)return this;var h=xe(Ri(e,i),2);return e=h[0],i=h[1],a+o+s<(t=this.__goto(t,e.isFrame,e.excludeDelay))?this.finish(i):this.play(function(t){r.__playState="paused",r.__cancelTask(),di(i)&&i(t)})}},{key:"assignCurrentStyle",value:function(){Ei(this.style,this)}},{key:"__goto",value:function(t,e,i){var r=this.duration,n=this.iterations,a=this.delay;if(this.__playState="paused",this.__cancelTask(),isNaN(t)||t<0)throw new Error("Param of gotoAnd(Play/Stop) is illegal: "+t);for(e&&(t=(t-1)/this.spf),i&&(t+=a);r<t&&this.playCount<n-1;)this.__playCount++,t-=r;return this.__nextTime=t}},{key:"addControl",value:function(){var t=this.root.animateController;t&&t.add(this)}},{key:"removeControl",value:function(){var t=this.root.animateController;t&&t.remove(this)}},{key:"__stayBegin",value:function(){return{backwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__stayEnd",value:function(){return{forwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__cancelTask",value:function(){je.offFrame(this.__enterFrame),this.__playCb=null}},{key:"__destroy",value:function(t){var e=this;e.removeControl(),t?(e.__clean&&e.__clean(),e.__target=null):je.nextFrame({before:function(){e.__clean&&e.__clean(),e.__target=null}}),e.__startTime=null,e.__isDestroyed=!0}},{key:"id",get:function(){return this.__id}},{key:"target",get:function(){return this.__target}},{key:"root",get:function(){return this.target.root}},{key:"keys",get:function(){return this.__keys}},{key:"style",get:function(){return this.__style}},{key:"list",get:function(){return this.__list}},{key:"options",get:function(){return this.__options}},{key:"duration",get:function(){return this.__duration},set:function(t){this.__duration=Math.max(0,parseFloat(t)||0)}},{key:"delay",get:function(){return this.__delay},set:function(t){this.__delay=Math.max(0,parseFloat(t)||0)}},{key:"endDelay",get:function(){return this.__endDelay},set:function(t){this.__endDelay=Math.max(0,parseFloat(t)||0)}},{key:"fps",get:function(){return this.__fps},set:function(t){(t=parseInt(t)||60)<=0&&(t=60),this.__fps=t}},{key:"spf",get:function(){return 1/this.fps}},{key:"iterations",get:function(){return this.__iterations},set:function(t){t===1/0||Ee.isString(t)&&"infinity"===t.toLowerCase()?t=1/0:(t=parseInt(t),(isNaN(t)||t<0)&&(t=1)),this.__iterations=t}},{key:"fill",get:function(){return this.__fill},set:function(t){this.__fill=t||"none"}},{key:"direction",get:function(){return this.__direction},set:function(t){this.__direction=t||"normal"}},{key:"frames",get:function(){return this.__frames}},{key:"framesR",get:function(){return this.__framesR}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(t){(t=parseFloat(t)||1)<=0&&(t=1),this.__playbackRate=t}},{key:"easing",get:function(){return this.__easing}},{key:"startTime",get:function(){return this.__startTime}},{key:"currentTime",get:function(){return this.__currentTime},set:function(t){0<=(t=parseFloat(t)||0)&&(this.__currentTime=this.__nextTime=t)}},{key:"pending",get:function(){return"running"!==this.playState}},{key:"finished",get:function(){return"finished"===this.playState}},{key:"playState",get:function(){return this.__playState}},{key:"playCount",get:function(){return this.__playCount},set:function(t){this.__playCount=Math.max(0,parseInt(t)||0)}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"animating",get:function(){var t=this.playState;return"idle"!==t&&("finished"!==t||this.__stayEnd())}},{key:"spfLimit",get:function(){return this.__spfLimit},set:function(t){Ee.isNumber(t)||/^\d/.test(t)?this.__spfLimit=Math.max(t,parseInt(t)||0):this.__spfLimit=!!t}},{key:"assigning",get:function(){return this.__assigning}}]),s}(),Oi=s.AUTO,Ni=s.PX,Di=s.PERCENT,Fi=s.STRING,Ii=s.INHERIT,Wi=Ee.clone,Bi=Ee.int2rgba,Hi=Ee.equalArr,Gi=Ee.extend,$i=Ee.joinArr,Xi=ae.normalize,Yi=ae.calRelative,zi=ae.compute,ji=q.canvasPolygon,Vi=q.svgPolygon;function Ui(t,e,i,r,n){var a;t===we.CANVAS?(r.beginPath(),r.fillStyle!==i&&(r.fillStyle=i),e.forEach(function(t){ji(r,t)}),r.fill(),r.closePath()):t===we.SVG&&(a="",e.forEach(function(t){a+=Vi(t)}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",a],["fill",i]]}))}function qi(t,e,i,r,n,a,o,s,h,u,l,c,f,d,p,_,v){var y,g=16<arguments.length&&void 0!==v?v:"fill",m=Te.calRadius(i,r,n,a,h,u,l,c,f,d,p,_);t===we.CANVAS?(o.beginPath(),o.fillStyle!==e&&(o.fillStyle=e),m?ji(o,m):o.rect(i,r,n,a),o[g](),o.closePath()):t===we.SVG&&(m?(y=Vi(m),s.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",y],["fill",e]]})):s.virtualDom.bb.push({type:"item",tagName:"rect",props:[["x",i],["y",r],["width",n],["height",a],["fill",e]]}))}var Zi=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"];function Ki(t,e,i){return t.unit===Ni?t.value:t.unit===Di?(e-i)*t.value*.01:0}function Ji(){}var Qi,tr,er,ir,rr,nr=function(){e(n,M);var r=f(n);function n(t){var i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,n),i=r.call(this),Array.isArray(e)?i.props=Ee.arr2hash(e):i.props=e,i.__tagName=t,i.__style=i.props.style||{},i.__currentStyle={},i.__computedStyle={},i.__listener={},Object.keys(i.props).forEach(function(t){var e=i.props[t];/^on[a-zA-Z]/.test(t)&&(t=t.slice(2).toLowerCase(),i.listener[t]=e)}),i.__animationList=[],i.__loadBgi={cb:function(){}},i.__cacheStyle={},i}return l(n,[{key:"__mp",value:function(r,n,a){var o=this;["Top","Right","Bottom","Left"].forEach(function(t){var e="margin"+t,i="padding"+t;n[e]=o.__mpWidth(r[e],a),n[i]=o.__mpWidth(r[i],a)})}},{key:"__mpWidth",value:function(t,e){return t.unit===Ni?t.value:t.unit===Di?t.value*e*.01:0}},{key:"__layout",value:function(t,e,i){var r,n,a,o,s,h,u,l,c,f=t.w,d=this.isDestroyed,p=this.currentStyle,_=this.computedStyle,v=p.display,y=p.width,g=p.position;if(d||"none"===v)_.width=_.height=0;else{if(i||this.__mp(p,_,f),y.unit!==Oi)switch(y.unit){case Ni:f=y.value;break;case Di:f*=.01*y.value}this.__ox=this.__oy=0,"flex"===v?this.__layoutFlex(t,e):"inline"===v?this.__layoutInline(t,e):this.__layoutBlock(t,e),"relative"===g?(r=p.top,n=p.right,a=p.bottom,o=p.left,s=this.parent,r.unit!==Oi?(h=Yi(p,"top",r,s),this.__offsetY(h),_.top=h,_.bottom="auto"):a.unit!==Oi?(u=Yi(p,"bottom",a,s),this.__offsetY(-u),_.bottom=u,_.top="auto"):_.top=_.bottom="auto",o.unit!==Oi?(l=Yi(p,"left",o,s,!0),this.__offsetX(l),_.left=l,_.right="auto"):n.unit!==Oi?(c=Yi(p,"right",n,s,!0),this.__offsetX(-c),_.right=c,_.left="auto"):_.left=_.right="auto"):"absolute"!==p.position&&(_.top=_.bottom=_.left=_.right="auto"),_.width=this.width,_.height=this.height,this.__cacheStyle={},this.__cacheSvg=!1;var m,b=this.__animateRecords;b&&(this.__animateRecords=null,m=b.controller||this.root.animateController,b.options&&!1===b.options.autoPlay?m.__records=m.__records.concat(b.list):(m.__auto=m.__auto.concat(b.list),m.__playAuto()))}}},{key:"__preLayout",value:function(t){var e=t.x,i=t.y,r=t.w,n=t.h,a=t.w2,o=t.h2;this.__x=e,this.__y=i;var s,h,u=this.currentStyle,l=this.computedStyle,c=u.width,f=u.height,d=l.borderTopWidth,p=l.borderRightWidth,_=l.borderBottomWidth,v=l.borderLeftWidth,y=l.marginTop,g=l.marginRight,m=l.marginBottom,b=l.marginLeft,k=l.paddingTop,x=l.paddingRight,M=l.paddingBottom,w=l.paddingLeft;if(void 0!==a)s=!0,r=a;else if(c.unit!==Oi)switch(s=!0,c.unit){case Ni:r=c.value;break;case Di:r*=.01*c.value}if(void 0!==o)h=!0,n=o;else if(f.unit!==Oi)switch(h=!0,f.unit){case Ni:n=f.value;break;case Di:n*=.01*f.value}return e+=v+b+w,t.x=e,i+=d+y+k,t.y=i,c.unit===Oi&&(r-=v+p+b+g+w+x),f.unit===Oi&&(n-=d+_+y+m+k+M),{fixedWidth:s,fixedHeight:h,x:e,y:i,w:r,h:n}}},{key:"__marginAuto",value:function(t,e){var i,r=t.position,n=t.marginLeft,a=t.marginRight,o=t.width;"absolute"===r||o===Oi||n.unit!==Oi||a.unit!==Oi||(i=this.outerWidth)<e.w&&this.__offsetX(.5*(e.w-i),!0)}},{key:"render",value:function(o,h,s){var u=this;if(o===we.SVG){if(this.__cacheSvg){var t=Gi({},this.__virtualDom);return t.cache=!0,void(this.__virtualDom=t)}this.__cacheSvg=!0,this.__virtualDom={bb:[],children:[],opacity:1}}var e=this.isDestroyed,r=this.currentStyle,n=this.computedStyle,i=this.width,a=this.height,l=this.innerWidth,c=this.innerHeight,f=this.outerWidth,d=this.outerHeight,p=this.__cacheStyle,_=this.parent;if(!e&&"none"!==n.display){var v,y,g,m,b,k,x,M,w,S,A,E,P,T,R,C=this.sx,L=this.sy,O=n.marginTop,N=n.marginLeft,D=n.paddingTop,F=n.paddingRight,I=n.paddingBottom,W=n.paddingLeft,B=n.borderLeftWidth,H=n.borderRightWidth,G=n.borderTopWidth,$=n.borderBottomWidth,X=C+N,Y=X+B,z=Y+i+W+F,j=z+H,V=L+O,U=V+G,q=U+a+D+I,Z=q+$,K=r.backgroundPositionX,J=r.backgroundPositionY,Q=p.matrix;void 0===p.transformOrigin&&(Q=!(p.transformOrigin=!0),n.transformOrigin=Pe.calOrigin(r.transformOrigin,f,d)),void 0!==p.transform&&void 0!==p.translateX&&void 0!==p.translateY&&void 0!==p.rotateZ&&void 0!==p.scaleX&&void 0!==p.scaleY&&void 0!==p.skewX&&void 0!==p.skewY||(Q=!(p.transform=p.translateX=p.translateY=p.rotateZ=p.scaleX=p.scaleY=p.skewX=p.skewY=!0),r.transform?v=Pe.calMatrix(r.transform,f,d):(y=[],["translateX","translateY","rotateZ","rotate","skewX","skewY","scaleX","scaleY"].forEach(function(t){var e,i=r[t];Ee.isNil(i)||(n[t]=i.value,e=-1<t.indexOf("scale"),1===i.value&&e||!e&&0===i.value||(i.unit===Di&&("translateX"===t?n[t]=i.value*f*.01:"translateY"===t&&(n[t]=i.value*d*.01)),y.push([t,i])))}),y.length&&(v=Pe.calMatrix(y,f,d))),this.__matrix=n.transform=v||[1,0,0,1,0,0]),void 0===p.backgroundPositionX&&(p.backgroundPositionX=!0,n.backgroundPositionX=K.unit===Ni?K.value:K.value*l),void 0===p.backgroundPositionY&&(p.backgroundPositionY=!0,n.backgroundPositionY=J.unit===Ni?J.value:J.value*l),void 0===p.backgroundSize&&(p.backgroundSize=!0,n.backgroundSize=(g=r.backgroundSize,m=l,b=c,k=[],g.forEach(function(t,e){t.unit===Ni?k.push(t.value):t.unit===Di?k.push(t.value*(e?b:m)*.01):t.unit===Oi?k.push(-1):t.unit===Fi&&k.push("contain"===t.value?-2:-3)}),k)),void 0===p.backgroundImage&&(x=n.backgroundImage=r.backgroundImage,Ee.isString(x)?(p.backgroundImage=!0,M=this.__loadBgi,(w=He.IMG[x])&&w.state===He.LOADED&&(M.url=x,M.source=w.source,M.width=w.width,M.height=w.height),M.url!==x&&(M.url=x,M.source=null,He.measureImg(x,function(t){t.success&&t.url===M.url&&!u.__isDestroyed&&(M.source=t.source,M.width=t.width,M.height=t.height,u.__cacheSvg=!1,u.root.delRefreshTask(M.cb),u.root.addRefreshTask(M.cb))},{width:l,height:c}))):x&&x.k&&(p.backgroundImage=this.__gradient(o,h,s,Y,U,z,q,l,c,x))),void 0===p.boxShadow&&(p.boxShadow=!0,n.boxShadow=r.boxShadow),["opacity","zIndex","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","backgroundRepeat","filter"].forEach(function(t){n[t]=r[t]}),["backgroundColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"].forEach(function(t){void 0===p[t]&&(p[t]=Bi(n[t]=r[t].value))}),_?(S=_.computedStyle,["fontStyle","color","visibility"].forEach(function(t){r[t].unit===Ii?n[t]=S[t]:n[t]=r[t].value,"color"===t&&(p.color=Bi(n.color))})):(["fontStyle","color","visibility"].forEach(function(t){r[t].unit!==Ii&&(n[t]=r[t].value,"color"===t&&(p.color=Bi(n.color)))}),4===r.fontStyle.unit&&(n.fontStyle="normal"),4===r.fontWeight.unit&&(n.fontWeight=400),4===r.color.unit&&(n.color=[0,0,0,1],p.color="rgba(0,0,0,1)"),4===r.visibility.unit&&(n.visibility="visible")),void 0!==p.borderTopLeftRadius&&void 0!==p.borderTopRightRadius&&void 0!==p.borderBottomRightRadius&&void 0!==p.borderBottomLeftRadius||(p.borderTopLeftRadius=p.borderTopRightRadius=p.borderBottomRightRadius=p.borderBottomLeftRadius=!0,A=f,E=d,P=r,T=n,R=!0,Zi.forEach(function(t){T[t]=P[t].map(function(t,e){return 0<t.value?(R=!1,t.unit===Ni?Math.max(0,t.value):Math.max(0,t.value*(e?E:A)*.01)):0})}),R||Zi.forEach(function(t,e){var i,r=e%2==0?0:1,n=r?E:A,a=T[t],o=T[Zi[(e+1)%4]];a[r]+o[r]>n&&(i=.5*n,a[r]>=i&&o[r]>=i?a[r]=o[r]=i:a[r]>i?a[r]=n-o[r]:o[r]>i&&(o[r]=n-a[r]))}));var tt,et,it=n.backgroundColor,rt=n.borderTopColor,nt=n.borderTopStyle,at=n.borderRightColor,ot=n.borderRightStyle,st=n.borderBottomColor,ht=n.borderBottomStyle,ut=n.borderLeftColor,lt=n.borderLeftStyle,ct=n.borderTopLeftRadius,ft=n.borderTopRightRadius,dt=n.borderBottomRightRadius,pt=n.borderBottomLeftRadius,_t=n.visibility,vt=n.backgroundRepeat,yt=n.backgroundImage,gt=n.opacity,mt=n.filter,bt=n.backgroundSize,kt=n.transformOrigin,xt=n.transform,Mt=n.boxShadow,wt=_||this.host&&this.host.parent;o===we.CANVAS?(wt&&(gt*=wt.__opacity),this.__opacity=gt,h.globalAlpha!==gt&&(h.globalAlpha=gt)):this.__virtualDom.opacity=gt;var St,At,Et,Pt,Tt,Rt,Ct,Lt,Ot,Nt,Dt,Ft,It,Wt=tt=Q||((et=kt.slice(0))[0]+=C,et[1]+=L,tt=xt,p.matrix=Pe.calMatrixByOrigin(tt,et));if(wt&&(tt=Se.multiply(wt.matrixEvent,tt)),this.__matrixEvent=tt,o===we.CANVAS?h.setTransform.apply(h,Me(tt)):o===we.SVG&&(Hi(Wt,[1,0,0,1,0,0])||(this.virtualDom.transform="matrix("+$i(Wt,",")+")")),"hidden"!==_t){if(mt&&o===we.CANVAS&&mt.forEach(function(t){var e,i,r,n,a=xe(t,2),o=a[0],s=a[1];"blur"===o&&0<s&&(i=(e=u.root).width,r=e.height,(n=He.getCacheCanvas(i,r,"__$$blur$$__")).ctx&&((St={ctx:h}).target=n,h=n.ctx))}),0<it[3]&&qi(o,p.backgroundColor,Y,U,l,c,h,this,G,H,$,B,ct,ft,dt,pt),yt)if(Ee.isString(yt)){var Bt=this.__loadBgi;if(Bt.url===yt){var Ht=Bt.source;if(Ht){var Gt=Bt.width,$t=Bt.height,Xt=xe(bt,2),Yt=Xt[0],zt=Xt[1];-1===Yt&&-1===zt?(Yt=Gt,zt=$t):-2===Yt?l<Gt&&c<$t?(zt=$t/c)<=(Yt=Gt/l)?zt=(Yt=l)*$t/Gt:Yt=(zt=c)*Gt/$t:l<Gt?zt=(Yt=l)*$t/Gt:c<$t?Yt=(zt=c)*Gt/$t:(Yt=Gt,zt=$t):-3===Yt?Gt<l&&$t<c?(Yt=Gt/l)<=(zt=$t/c)?zt=(Yt=l)*$t/Gt:Yt=(zt=c)*Gt/$t:Gt<l||!($t<c)&&(Yt=Gt/l)<=(zt=$t/c)?zt=(Yt=l)*$t/Gt:Yt=(zt=c)*Gt/$t:-1===Yt?Yt=zt*Gt/$t:-1===zt&&(zt=Yt*$t/Gt);var jt,Vt,Ut=Y+Ki(K,l,Yt),qt=U+Ki(J,c,zt),Zt=Ut<Y||qt<U||l<Yt||c<zt,Kt=0,Jt=0,Qt=0,te=0;-1<["repeat-x","repeat"].indexOf(vt)&&(0<(jt=Ut-Y)&&(Kt=Math.ceil(jt/Yt)),0<(jt=Y+l-Ut-Yt)&&(Jt=Math.ceil(jt/Yt))),-1<["repeat-y","repeat"].indexOf(vt)&&(0<(Vt=qt-U)&&(Qt=Math.ceil(Vt/zt)),0<(Vt=U+c-qt-zt)&&(te=Math.ceil(Vt/zt)));var ee,ie,re,ne,ae=[];if(0<Kt)for(var oe=0;oe<Kt;oe++){var se=Ut-(oe+1)*Yt;ae.push([se,qt]),!Zt&&0===oe&&se<Y&&(Zt=!0)}if(0<Jt)for(var he=0;he<Jt;he++){var ue=Ut+(he+1)*Yt;ae.push([ue,qt]),!Zt&&he===Jt-1&&Y+l<ue+Yt&&(Zt=!0)}if(0<Qt)for(var le=0;le<Qt;le++){var ce=qt-(le+1)*zt;ae.push([Ut,ce]),!Zt&&0===le&&ce<U&&(Zt=!0)}if(0<te)for(var fe=0;fe<te;fe++){var de=qt+(fe+1)*zt;ae.push([Ut,de]),!Zt&&fe===te-1&&U+c<de+Yt&&(Zt=!0)}if(0<Kt&&0<Qt)for(var pe=0;pe<Kt;pe++)for(var _e=0;_e<Qt;_e++)ae.push([Ut-(pe+1)*Yt,qt-(_e+1)*zt]);if(0<Jt&&0<Qt)for(var ve=0;ve<Jt;ve++)for(var ye=0;ye<Qt;ye++)ae.push([Ut+(ve+1)*Yt,qt-(ye+1)*zt]);if(0<Kt&&0<te)for(var ge=0;ge<Kt;ge++)for(var me=0;me<te;me++)ae.push([Ut-(ge+1)*Yt,qt+(me+1)*zt]);if(0<Jt&&0<te)for(var be=0;be<Jt;be++)for(var ke=0;ke<te;ke++)ae.push([Ut+(be+1)*Yt,qt+(ke+1)*zt]);o===we.CANVAS?(Zt&&(h.save(),qi(o,"#FFF",Y,U,l,c,h,this,G,H,$,B,ct,ft,dt,pt,"clip")),h.drawImage(Ht,Ut,qt,Yt,zt),ae.forEach(function(t){h.drawImage(Ht,t[0],t[1],Yt,zt)}),Zt&&h.restore()):o===we.SVG&&(ee=Re.matrixResize(Gt,$t,Yt,zt,Ut,qt,l,c),ie=[["xlink:href",yt],["x",Ut],["y",qt],["width",Gt],["height",$t]],ee&&!Hi(ee,[1,0,0,1,0,0])&&(re=!0,ie.push(["transform","matrix("+$i(ee,",")+")"])),Zt&&(ne=s.add({tagName:"clipPath",children:[{tagName:"rect",props:[["x",Y],["y",U],["width",l],["height",c],["fill","#FFF"]]}]}),this.virtualDom.bbClip="url(#"+ne+")"),this.virtualDom.bb.push({type:"img",tagName:"image",props:ie}),ae.forEach(function(t){var e,i=Wi(ie);!re||(e=Re.matrixResize(Gt,$t,Yt,zt,t[0],t[1],l,c))&&!Hi(e,[1,0,0,1,0,0])&&(i[5][1]="matrix("+$i(e,",")+")"),i[1][1]=t[0],i[2][1]=t[1],u.virtualDom.bb.push({type:"img",tagName:"image",props:i})}))}}}else yt.k&&qi(o,p.backgroundImage,Y,U,l,c,h,this,G,H,$,B,ct,ft,dt,pt);return Mt&&Mt.forEach(function(t){!function(t,e,i,r,n,a,o,s,h,u,l){var c=xe(r,6),f=c[0],d=c[1],p=c[2],_=c[3],v=c[4],y=c[5],g=Bi(v),m=2*Math.abs(p)+2*Math.abs(_)+2*Math.abs(f)+2*Math.abs(d),b=[[a,o],[s,o],[s,h],[a,h],[a,o]],k=[[a-m,o-m],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m]];if(0<v[3]&&(0<p||0<_))if(t===we.CANVAS){if(e.save(),e.beginPath(),"inset"===y){var x=a+f+_,M=o+d+_,w=s+f-_,S=h+d-_,A=[[x,M],[w,M],[w,S],[x,S]],E=Ae.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[A[0][0],A[0][1],A[2][0],A[2][1]]);if(!E)return;E=[[E[0],E[1]],[E[2],E[1]],[E[2],E[3]],[E[0],E[3]],[E[0],E[1]]],_?(ji(e,E),ji(e,b.slice(0).reverse()),e.clip(),e.closePath(),e.beginPath(),e.fillStyle!==g&&(e.fillStyle=g),ji(e,b),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),ji(e,E),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowColor=g,e.shadowBlur=p,ji(e,[[x,M],[w,M],[w,S],[a-m,S],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,S],[x,S],[x,M]])):(ji(e,b),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowOffsetX=f,e.shadowOffsetY=d,e.shadowColor=g,e.shadowBlur=p,ji(e,[[a,o],[s,o],[s,h],[a-m,h],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,h],[a,h],[a,o]]))}else{var P=a+f-_,T=o+d-_,R=s+f+_,C=h+d+_,L=[[P,T],[R,T],[R,C],[P,C]],O=Ae.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[L[0][0],L[0][1],L[2][0],L[2][1]]);_?(ji(e,b),ji(e,L.slice(0).reverse()),e.clip(),e.closePath(),e.beginPath(),e.fillStyle!==g&&(e.fillStyle=g),ji(e,L),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),O&&ji(e,[[O[0],O[1]],[O[2],O[1]],[O[2],O[3]],[O[0],O[3]],[O[0],O[1]]].reverse()),ji(e,b),ji(e,L),ji(e,k),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowColor=g,e.shadowBlur=p,ji(e,L)):(ji(e,b),ji(e,k),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowOffsetX=f,e.shadowOffsetY=d,e.shadowColor=g,e.shadowBlur=p,ji(e,b))}e.fill(),e.closePath(),e.restore()}else if(t===we.SVG){var N=Se.int2convolution(p);if("inset"===y){var D,F,I,W,B=a+f+_,H=o+d+_,G=s+f-_,$=h+d-_,X=[[B,H],[G,H],[G,$],[B,$]],Y=Ae.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[X[0][0],X[0][1],X[2][0],X[2][1]]);if(!Y)return;Y=[[Y[0],Y[1]],[Y[2],Y[1]],[Y[2],Y[3]],[Y[0],Y[3]],[Y[0],Y[1]]],_?(D=i.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*p],["flood-color",g]]}]}),F=i.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",Vi(Y)+Vi(b.slice(0).reverse())],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Vi(b)],["fill",g],["clip-path","url(#"+F+")"]]}),F=i.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",Vi(Y)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Vi([[B,H],[G,H],[G,$],[a-m,$],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,$],[B,$],[B,H]])],["fill","#FFF"],["filter","url(#"+D+")"],["clip-path","url(#"+F+")"]]})):(I=i.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",f],["dy",d],["stdDeviation",.5*p],["flood-color",g]]}]}),W=i.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",Vi(b)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Vi([[a,o],[s,o],[s,h],[a-m,h],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,h],[a,h],[a,o]])],["fill","#FFF"],["filter","url(#"+I+")"],["clip-path","url(#"+W+")"]]}))}else{var z,j,V,U,q=a+f-_,Z=o+d-_,K=s+f+_,J=h+d+_,Q=[[q,Z],[K,Z],[K,J],[q,J]],tt=Ae.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[Q[0][0],Q[0][1],Q[2][0],Q[2][1]]);_?(z=i.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*p],["flood-color",g]]}]}),j=i.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",Vi(b)+Vi(Q.slice(0).reverse())],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Vi(Q)],["fill",g],["clip-path","url(#"+j+")"]]}),j=i.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",(tt?Vi([[tt[0],tt[1]],[tt[2],tt[1]],[tt[2],tt[3]],[tt[0],tt[3]],[tt[0],tt[1]]].reverse()):"")+Vi(b)+Vi(Q)+Vi(k)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Vi(Q)],["fill","#FFF"],["filter","url(#"+z+")"],["clip-path","url(#"+j+")"]]})):(V=i.add({tagName:"filter",props:[["x",-N/u],["y",-N/l],["width",1+2*N/u],["height",1+2*N/l]],children:[{tagName:"feDropShadow",props:[["dx",f],["dy",d],["stdDeviation",.5*p],["flood-color",g]]}]}),U=i.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",Vi(b)+Vi(k)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",Vi(b)],["fill","#FFF"],["filter","url(#"+V+")"],["clip-path","url(#"+U+")"]]}))}}}(o,h,s,t,u,X,V,j,Z,f,d)}),0<G&&0<rt[3]&&(At=Math.atan(G/B),Et=Math.atan(G/H),Pt=Te.calPoints(G,nt,At,Et,X,Y,z,j,V,U,q,Z,0,ct,ft),Ui(o,Pt,p.borderTopColor,h,this)),0<H&&0<at[3]&&(Tt=Math.atan(H/G),Rt=Math.atan(H/$),Ct=Te.calPoints(H,ot,Tt,Rt,X,Y,z,j,V,U,q,Z,1,ft,dt),Ui(o,Ct,p.borderRightColor,h,this)),0<$&&0<st[3]&&(Lt=Math.atan($/B),Ot=Math.atan($/H),Nt=Te.calPoints($,ht,Lt,Ot,X,Y,z,j,V,U,q,Z,2,pt,dt),Ui(o,Nt,p.borderBottomColor,h,this)),0<B&&0<ut[3]&&(Dt=Math.atan(B/G),Ft=Math.atan(B/$),It=Te.calPoints(B,lt,Dt,Ft,X,Y,z,j,V,U,q,Z,3,ct,pt),Ui(o,It,p.borderLeftColor,h,this)),mt&&mt.forEach(function(t){var e,i,r=xe(t,2),n=r[0],a=r[1];"blur"===n&&0<a&&(o===we.CANVAS?St.blur=a:o===we.SVG&&(e=Se.int2convolution(a),i=s.add({tagName:"filter",props:[["x",-e/f],["y",-e/d],["width",1+2*e/f],["height",1+2*e/d]],children:[{tagName:"feGaussianBlur",props:[["stdDeviation",a]]}]}),u.virtualDom.filter="url(#"+i+")"))}),St}}}},{key:"__renderByMask",value:function(e,t,i){var r=this.next,n=this.root,a=r&&r.isMask,o=r&&r.isClip;if(a||o)if(e===we.CANVAS){if(a){var s=n.width,h=n.height,u=He.getCacheCanvas(s,h,"__$$mask1$$__");this.render(e,u.ctx);for(var l,c=[];r&&r.isMask;)c.push(r),r=r.next;t.save(),t.setTransform(1,0,0,1,0,0),1===c.length?(r=c[0],u.ctx.globalCompositeOperation="destination-in",r.render(e,u.ctx),u.draw(u.ctx),t.drawImage(u.canvas,0,0),u.draw(t)):(l=He.getCacheCanvas(s,h,"__$$mask2$$__"),c.forEach(function(t){t.render(e,l.ctx)}),l.draw(l.ctx),u.ctx.globalCompositeOperation="destination-in",u.ctx.drawImage(l.canvas,0,0),u.draw(u.ctx),t.drawImage(u.canvas,0,0),u.draw(t),l.ctx.globalCompositeOperation="source-over",l.ctx.clearRect(0,0,s,h),l.draw(l.ctx)),t.restore(),u.ctx.globalCompositeOperation="source-over",u.ctx.clearRect(0,0,s,h),u.draw(u.ctx)}else if(o){t.save(),t.beginPath();var f=t.fill,d=t.beginPath,p=t.closePath;for(t.fill=t.beginPath=t.closePath=Ji;r&&r.isClip;)r.render(e,t),r=r.next;t.fill=f,t.beginPath=d,t.closePath=p,t.clip(),t.closePath(),this.render(e,t),t.restore()}}else e===we.SVG&&(this.render(e,t,i),a?this.virtualDom.mask=r.maskId:o&&(this.virtualDom.clip=r.clipId));else this.render(e,t,i)}},{key:"__destroy",value:function(){var t,e;this.isDestroyed||(!(t=this.props.ref)||(e=this.host||this.root)&&e.ref[t]&&delete e.ref[t],this.animationList.forEach(function(t){return t.__destroy()}),this.root.delRefreshTask(this.__loadBgi.cb),this.root.delRefreshTask(this.__task),J(K(n.prototype),"__destroy",this).call(this),this.__matrix=this.__matrixEvent=this.__root=null)}},{key:"__emitEvent",value:function(t,e){var i=this.isDestroyed,r=this.computedStyle;if(!i&&"none"!==r.display&&!t.__stopPropagation){var n,a=t.event.type,o=this.listener;return o.hasOwnProperty(a)&&(n=o[a]),e?(t.target=this,Ee.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0):this.willResponseEvent(t)?(Ee.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0):void 0}}},{key:"willResponseEvent",value:function(t){var e=t.x,i=t.y,r=this.sx,n=this.sy,a=this.outerWidth,o=this.outerHeight,s=this.matrixEvent;if(Pe.pointInQuadrilateral(e,i,r,n,r+a,n,r+a,n+o,r,n+o,s))return t.target||(t.target=this,"touchstart"===t.event.type&&(this.root.__touchstartTarget=this)),!0}},{key:"__gradient",value:function(t,e,i,r,n,a,o,s,h,u){var l,c,f,d=u.k,p=u.v,_=u.d,v=u.s,y=u.z,g=u.p,m=r+.5*s,b=n+.5*h;return"linear"===d?(l=nt.getLinear(p,_,m,b,s,h),c=this.__getLg(t,e,i,l)):"radial"===d&&(f=nt.getRadial(p,v,y,g,r,n,a,o),c=this.__getRg(t,e,i,f)),c}},{key:"__getLg",value:function(t,e,i,r){if(t===we.CANVAS){var n=e.createLinearGradient(r.x1,r.y1,r.x2,r.y2);return r.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===we.SVG)return"url(#"+i.add({tagName:"linearGradient",props:[["x1",r.x1],["y1",r.y1],["x2",r.x2],["y2",r.y2]],children:r.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})})+")"}},{key:"__cancelCacheSvg",value:function(){this.__cacheSvg=!1}},{key:"__getRg",value:function(t,e,i,r){if(t===we.CANVAS){var n=e.createRadialGradient(r.cx,r.cy,0,r.cx,r.cy,r.r);return r.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===we.SVG)return"url(#"+i.add({tagName:"radialGradient",props:[["cx",r.cx],["cy",r.cy],["r",r.r]],children:r.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})})+")"}},{key:"updateStyle",value:function(e,t){var i=this.root,r=this.__style,n=this.__currentStyle,a=this.__cacheStyle,o=this.props,s=this.__currentProps,h=this.__cacheProps,u=void 0===h?{}:h;if(i){var l,c,f,d=ni.REPAINT;for(var p in e)if(e.hasOwnProperty(p))if(Lt.GEOM.hasOwnProperty(p))ae.equalStyle(p,e[p],o[p],this)||(l=!0,this.__cacheSvg=!1,(f=f||{})[p]=e[p],u[p]=void 0);else if((pe.DOM.hasOwnProperty(p)||pe.GEOM.hasOwnProperty(p))&&!ae.equalStyle(p,e[p],r[p],this)){if(l=!0,this.__cacheSvg=!1,!Lt.isRepaint(p)){d=ni.REFLOW;break}a[p]=void 0,"zIndex"===p&&(c=!0)}if(!l)return void(Ee.isFunction(t)&&t(0));d===ni.REPAINT&&c&&/svg/i.test(i.tagName)&&this.__cancelCacheSvg(),i.addRefreshTask(this.__task={before:function(){var t=Xi(e);Gi(r,t),Gi(n,t),f&&s&&(Gi(o,f),Gi(s,f)),i.setRefreshLevel(d)},after:t})}}},{key:"animate",value:function(t,e){if(!this.isDestroyed){var i=new Li(this,t,e);return this.animationList.push(i),!1===e.autoPlay?i:i.play()}}},{key:"removeAnimate",value:function(t){var e;t instanceof Li&&(-1<(e=this.animationList.indexOf(t))&&(t.cancel(),t.__destroy(),this.animationList.splice(e,1)))}},{key:"clearAnimate",value:function(){this.animationList.splice(0).forEach(function(t){t.cancel(),t.__destroy()})}},{key:"__measure",value:function(t,e,i){zi(this,i,this.currentStyle,this.computedStyle)}},{key:"tagName",get:function(){return this.__tagName}},{key:"innerWidth",get:function(){var t=this.computedStyle,e=t.display,i=t.paddingRight,r=t.paddingLeft;return"none"===e?0:this.width+r+i}},{key:"innerHeight",get:function(){var t=this.computedStyle,e=t.display,i=t.paddingTop,r=t.paddingBottom;return"none"===e?0:this.height+i+r}},{key:"outerWidth",get:function(){var t=this.computedStyle,e=t.display,i=t.borderLeftWidth,r=t.borderRightWidth,n=t.marginRight,a=t.marginLeft;return"none"===e?0:this.innerWidth+i+r+a+n}},{key:"outerHeight",get:function(){var t=this.computedStyle,e=t.display,i=t.borderTopWidth,r=t.borderBottomWidth,n=t.marginTop,a=t.marginBottom;return"none"===e?0:this.innerHeight+i+r+n+a}},{key:"listener",get:function(){return this.__listener}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixEvent",get:function(){return this.__matrixEvent}},{key:"style",get:function(){return this.__style}},{key:"computedStyle",get:function(){return this.__computedStyle}},{key:"animationList",get:function(){return this.__animationList}},{key:"currentStyle",get:function(){return this.__currentStyle}}]),n}(),ar=function(){function i(t,e){u(this,i),this.__list=[],this.__x=t,this.__y=e,this.__baseLine=0}return l(i,[{key:"add",value:function(t){this.list.push(t)}},{key:"__calBaseLine",value:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.baseLine)}),e}},{key:"verticalAlign",value:function(){var i=this.__baseLine=this.__calBaseLine();1<this.list.length&&this.list.forEach(function(t){var e=t.baseLine;e!==i&&t.__offsetY(i-e)})}},{key:"horizonAlign",value:function(e){this.list.forEach(function(t){t.__offsetX(e)})}},{key:"list",get:function(){return this.__list}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){var e=0;return this.list.forEach(function(t){e+=t.width}),e}},{key:"height",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.height)}),e}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"size",get:function(){return this.__list.length}},{key:"marginBottom",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.computedStyle.marginBottom)}),e}}]),i}(),or=m.TYPE_PL,sr=m.TYPE_VD,hr=m.TYPE_GM,ur=m.TYPE_CP;function lr(t,e,i,r){if(Array.isArray(t))return t.map(function(t){return lr(t,e,i,r)});if(Ee.isObject(t)&&t.$$type){var n=t.tagName,a=t.props,o=t.children,s=t.klass,h=t.$$type,u=t.inherit,l=t.__animateRecords;if(h===or)return t.value;if(h===sr)"div"===n||"span"===n?c=new tr(n,a):"img"===n&&(c=new er(n,a)),o=Array.isArray(o)?fr(c,lr(o,e,i,r)):[],c.__children=o;else if(h===hr)var c=new(ir.getRegister(n))(n,a);else{if(h!==ur)return new Ne(t);(c=new s(a)).__tagName=n}t.vd=c,l&&(c.__animateRecords=l).list.forEach(function(t){t.target=c}),u&&Ee.extendAnimate(u,c),c.__root=e,r&&(c.__host=r),h===ur&&c.__init();var f=a.ref;return Ee.isString(f)&&f||Ee.isNumber(f)?i.ref[f]=c:Ee.isFunction(f)&&f(c),c}return new Ne(t)}function cr(t){if(Array.isArray(t))return t.map(cr);if(!t||-1===[sr,hr,ur].indexOf(t.$$type)||!Array.isArray(t.children))return t;var e=[];return function e(i,t,r){if(Array.isArray(t))t.forEach(function(t){e(i,t,r)});else if(!t||t.$$type!==sr&&t.$$type!==hr)!t||t.$$type!==ur&&t.$$type!==or?Ee.isNil(t)||""===t||(null!==r.lastText?i[i.length-1]=r.lastText+=t:i.push(t)):(i.push(t),r.lastText=null);else{if(-1<["canvas","svg"].indexOf(t.tagName))throw new Error("Can not nest canvas/svg");t.$$type===sr&&cr(t.children),i.push(t),r.lastText=null}}(e,t.children,{lastText:null}),t.children=e,t}function fr(e,t){var i,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(t)?t.forEach(function(t){fr(e,t,r)}):(t instanceof Qi||t instanceof rr||t instanceof Ne)&&(t.__parent=e,r.prev&&((r.prev.__next=t).__prev=r.prev),(r.prev=t)instanceof tr?fr(t,t.children):t instanceof rr&&((i=t.shadowRoot)instanceof Ne&&(i.__parent=e))),t}var dr={ref:function(t){Qi=t.Xom,tr=t.Dom,er=t.Img,ir=t.Geom,rr=t.Component},initRoot:function(t,e){return fr(e,lr(cr({children:t,$$type:sr}).children,e,e))},initCp:function(t,e,i){if(Ee.isObject(t)){var r=lr(t,e,i,i);return Array.isArray(r)&&fr(i,r),r}return new Ne(t)},flattenJson:cr,relation:fr,build:lr},pr=Ee.isNil,_r=Ee.isFunction,vr=Ee.clone,yr=Ee.extend;var gr=function(){e(h,Le);var i=f(h);function h(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return u(this,h),t=i.call(this),Array.isArray(e)?t.props=Ee.arr2hash(e):t.props=e,t.__parent=null,t.__host=null,t.__ref={},t.__state={},t.__isMounted=!1,t}return l(h,[{key:"setState",value:function(t,e){var i,r=this;t=pr(t)?{}:(i=vr(this.state),yr(i,t));var n=this.root;n&&this.__isMounted?(n.delRefreshTask(this.__task),this.__task={before:function(){r.__nextState=t,function t(e){e.__hasUpdate=!0;var i=e.host;i&&t(i)}(r)},after:function(){_r(e)&&e()},__state:!0},n.addRefreshTask(this.__task)):_r(e)&&(this.__state=t,e())}},{key:"__init",value:function(t){var e,i=this,r=this.root,n=t||dr.flattenJson(this.render()),a=dr.initCp(n,r,this,this);if(this.__cd=n,a instanceof Ne)console.warn("Component render() return a text, should not inherit style/event");else if(a instanceof M){var o=ae.normalize(this.props.style||{}),s=Object.keys(o);yr(a.style,o,s),yr(a.currentStyle,o,s),Object.keys(this.props).forEach(function(t){var e=i.props[t];/^on[a-zA-Z]/.test(t)?(t=t.slice(2).toLowerCase(),a.listener[t]=e):/^on-[a-zA-Z\d_$]/.test(t)&&(t=t.slice(3),i.on(t,e))})}else{if(!(a instanceof h))throw new Error("Component render() must return a dom/text: "+this);console.warn("Component render() return a component: "+this+" -> "+a.tagName+", should not inherit style/event")}(a.__host=this).__shadowRoot=a,this.__isMounted||(this.__isMounted=!0,e=this.componentDidMount,_r(e)&&r.once(Le.REFRESH,function(){e.call(i)}))}},{key:"render",value:function(){}},{key:"__destroy",value:function(){var t;this.isDestroyed||(this.__isDestroyed=!0,t=this.componentWillUnmount,_r(t)&&(t.call(this),this.__isMounted=!1),this.root.delRefreshTask(this.__task),this.shadowRoot&&this.shadowRoot.__destroy(),this.__shadowRoot=null,this.__parent=null)}},{key:"__emitEvent",value:function(t){var e=this.shadowRoot;if(!(e instanceof Ne))return e.__emitEvent(t)?(t.target=this,!0):void 0}},{key:"__measure",value:function(t,e){var i=this.shadowRoot;i instanceof Ne?i.__measure(t,e):i.__measure(t,e,!0)}},{key:"shadowRoot",get:function(){return this.__shadowRoot}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"parent",get:function(){return this.__parent}},{key:"ref",get:function(){return this.__ref}},{key:"state",get:function(){return this.__state},set:function(t){this.__state=t}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),h}();Object.keys(Lt.GEOM).concat(["x","y","ox","oy","sx","sy","width","height","outerWidth","outerHeight","style","animating","animationList","animateStyle","currentStyle","computedStyle","animateProps","currentProps","baseLine","virtualDom","mask","maskId","textWidth","content","lineBoxes","charWidthList","charWidth"]).forEach(function(e){Object.defineProperty(gr.prototype,e,{get:function(){var t=this.shadowRoot;if(t)return t[e]}})}),["__layout","__layoutAbs","__tryLayInline","__offsetX","__offsetY","__calAutoBasis","__calMp","__calAbs","__renderAsMask","__renderByMask","__mp","animate","removeAnimate","clearAnimate","updateStyle","__cancelCacheSvg"].forEach(function(e){gr.prototype[e]=function(){var t=this.shadowRoot;if(t&&_r(t[e]))return t[e].apply(t,arguments)}});var mr=s.AUTO,br=s.PX,kr=s.PERCENT,xr=ae.calAbsolute,Mr={div:!0,span:!0,img:!0},wr={span:!0,img:!0};var Sr,Ar,Er=function(){e(d,nr);var a=f(d);function d(t,e,i){var r;u(this,d),(r=a.call(this,t,e)).__lineGroups=[];var n=c(r).style;return n.display&&{flex:!0,block:!0,inline:!0,none:!0}.hasOwnProperty(n.display)||(wr.hasOwnProperty(r.tagName)?n.display="inline":n.display="block"),r.__style=ae.normalize(n,pe.dom),r.__currentStyle=Ee.extend({},r.__style),r.__children=i||[],r}return l(d,[{key:"__tryLayInline",value:function(t,e){var i=this.flowChildren,r=this.currentStyle.width;if(r.unit===br)return t-r.value;if(r.unit===kr)return t-e*r.value*.01;for(var n=0;n<i.length;n++){if(t<0)return t;var a=i[n];t-=a instanceof nr||a instanceof gr?a.__tryLayInline(t,e):a.textWidth}return t}},{key:"__offsetX",value:function(e,i){J(K(d.prototype),"__offsetX",this).call(this,e,i),this.flowChildren.forEach(function(t){t&&t.__offsetX(e,i)})}},{key:"__offsetY",value:function(e,i){J(K(d.prototype),"__offsetY",this).call(this,e,i),this.flowChildren.forEach(function(t){t&&t.__offsetY(e,i)})}},{key:"__calAutoBasis",value:function(a,o,s,t){var e,i,h=0,u=0,l=0,r=this.flowChildren,n=this.currentStyle,c=this.computedStyle,f=n.width,d=n.height,p=n.marginLeft,_=n.marginTop,v=n.marginRight,y=n.marginBottom,g=n.paddingLeft,m=n.paddingTop,b=n.paddingRight,k=n.paddingBottom,x=c.borderTopWidth,M=c.borderRightWidth,w=c.borderBottomWidth,S=c.borderLeftWidth,A=a?f:d;return A.unit===br&&(h=l=A.value,t&&(u=h)),r.forEach(function(t){var e,i,r,n;l=t instanceof nr||t instanceof gr&&t.shadowRoot instanceof nr?(i=(e=t.__calAutoBasis(a,o,s,!0)).b,r=e.min,n=e.max,h=Math.max(h,i),u=Math.max(u,r),Math.max(l,n)):a?(u=Math.max(t.charWidth,u),Math.max(t.textWidth,l)):(t.__layout({x:0,y:0,w:o,h:s},!0),u=Math.max(u,t.height),Math.max(l,t.height))}),a?(e=M+S+(this.__calMp(p,o)+this.__calMp(v,o)+this.__calMp(g,o)+this.__calMp(b,o)),h+=e,l+=e,u+=e):(i=x+w+(this.__calMp(_,o)+this.__calMp(y,o)+this.__calMp(m,o)+this.__calMp(k,o)),h+=i,l+=i,u+=i),{b:h,min:u,max:l}}},{key:"__calMp",value:function(t,e){var i=0;return t.unit===br?i+=t.value:t.unit===kr&&(t.value*=.01*e,t.unit=br,i+=t.value),i}},{key:"__layoutBlock",value:function(e,i){var t=this.flowChildren,r=this.currentStyle,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o,s,h,u=n.textAlign,l=this.__preLayout(e),c=l.fixedWidth,f=l.fixedHeight,d=l.x,p=l.y,_=l.w,v=l.h;c&&i?this.__width=_:(s=o=0,h=new ar(d,p),t.forEach(function(t){t instanceof nr||t instanceof gr&&t.shadowRoot instanceof nr?"inline"===t.currentStyle.display?d===e.x?(h.add(t),t.__layout({x:d,y:p,w:_,h:v},i),d+=t.outerWidth,i&&(o=Math.max(o,s),s=t.outerWidth)):(0<=t.__tryLayInline(_-d+e.x,_)?t.__layout({x:d,y:p,w:_,h:v},i):(a.push(h),i||h.verticalAlign(),d=e.x,p+=h.height+h.marginBottom,t.__layout({x:e.x,y:p,w:_,h:v},i),h=new ar(d,p),i&&(o=Math.max(o,s),s=0)),d+=t.outerWidth,h.add(t),i&&(s+=t.outerWidth)):(h.size&&(a.push(h),h.verticalAlign(),p+=h.height+h.marginBottom,h=new ar(e.x,p),i&&(o=Math.max(o,s),s=0)),t.__layout({x:e.x,y:p,w:_,h:v},i),d=e.x,p+=t.outerHeight,i&&(o=Math.max(o,t.outerWidth),s=0)):d===e.x?(h.add(t),t.__layout({x:d,y:p,w:_,h:v},i),d+=t.width,i&&(o=Math.max(o,s),s=t.width)):(0<=t.__tryLayInline(_-d+e.x)?t.__layout({x:d,y:p,w:_,h:v},i):(a.push(h),h.verticalAlign(),d=e.x,p+=h.height+h.marginBottom,t.__layout({x:e.x,y:p,w:_,h:v},i),h=new ar(d,p),i&&(o=Math.max(o,s),s=0)),d+=t.width,h.add(t),i&&(s+=t.width))}),h.size&&(a.push(h),i?o=Math.max(o,s):h.verticalAlign(),p+=h.height),this.__width=c||!i?_:o,this.__height=f?v:p-e.y,h.size&&(p+=h.marginBottom),!i&&-1<["center","right"].indexOf(u)&&a.forEach(function(t){var e=_-t.width;0<e&&t.horizonAlign("center"===u?.5*e:e)}),i||this.__marginAuto(r,e))}},{key:"__layoutFlex",value:function(t,l){var e=this.flowChildren,i=this.currentStyle,r=i.flexDirection,n=i.justifyContent,a=i.alignItems,o=this.__preLayout(t),s=o.fixedWidth,S=o.fixedHeight,A=o.x,E=o.y,P=o.w,T=o.h;if(s&&l)this.__width=P;else{var c=0,R="row"===r,C=[],L=[],O=[],N=[],D=0,F=0,I=0,f=0;if(e.forEach(function(t){if(t instanceof nr||t instanceof gr&&t.shadowRoot instanceof nr){var e=t.__calAutoBasis(!!l||R,P,T),i=e.b,r=e.min,n=e.max;if(l)return void(R?c+=n:c=Math.max(c,n));var a=t.currentStyle,o=t.computedStyle,s=a.flexGrow,h=a.flexShrink,u=a.flexBasis;C.push(s),L.push(h),D+=s,F+=h,u.unit===mr?(O.push(n),I+=n):u.unit===br?(o.flexBasis=i=u.value,O.push(i),I+=i):u.unit===kr&&(i=o.flexBasis=(R?P:T)*u.value*.01,O.push(i),I+=i),f+=n,N.push(r)}else{if(l)return void(R?c+=t.textWidth:c=Math.max(c,t.textWidth));C.push(0),L.push(1),F+=1,R?(O.push(t.textWidth),I+=t.textWidth,f+=t.textWidth,N.push(t.charWidth)):(t.__layout({x:0,y:0,w:P,h:T},!0),O.push(t.height),I+=t.height,f+=t.height,N.push(t.height))}}),l)this.__width=Math.min(c,P);else{var W=0,B=(R?P:T)<f;e.forEach(function(t,e){var i,r,n,a,o,s,h,u,l,c,f,d,p,_,v,y,g,m,b,k,x,M=L[e],w=C[e];r=B?(i=I-(R?P:T),M?O[e]-i*M/F:O[e]):(n=(R?P:T)-I,w?O[e]+n*w/D:O[e]),r=Math.max(r,N[e]),t instanceof nr||t instanceof gr&&t.shadowRoot instanceof nr?(a=t.currentStyle,o=t.computedStyle,s=a.display,h=a.flexDirection,u=a.width,l=a.height,"inline"===s&&(a.display=o.display="block"),R?("flex"===s&&"column"===h&&S&&l.unit===mr&&(l.value=T,l.unit=br),t.__layout({x:A,y:E,w:r,h:T})):("flex"===s&&"row"===h&&u.unit===mr&&(u.value=P,u.unit=br),t.__layout({x:A,y:E,w:P,h:r})),(B&&M||!B&&w)&&(c=o.borderTopWidth,f=o.borderRightWidth,d=o.borderBottomWidth,p=o.borderLeftWidth,_=o.marginTop,v=o.marginRight,y=o.marginBottom,g=o.marginLeft,m=o.paddingTop,b=o.paddingRight,k=o.paddingBottom,x=o.paddingLeft,R?t.__width=r-g-v-x-b-p-f:t.__height=r-_-y-m-k-c-d)):t.__layout({x:A,y:E,w:R?r:P,h:R?T:r}),W=R?(A+=t.outerWidth,Math.max(W,t.outerHeight)):(E+=t.outerHeight,Math.max(W,t.outerWidth))});var h=R?P-A+t.x:T-E+t.y;if(!B&&0===D&&0<h){var u=e.length;if("flex-end"===n)for(var d=0;d<u;d++){var p=e[d];R?p.__offsetX(h,!0):p.__offsetY(h,!0)}else if("center"===n)for(var _=.5*h,v=0;v<u;v++){var y=e[v];R?y.__offsetX(_,!0):y.__offsetY(_,!0)}else if("space-between"===n)for(var g=h/(u-1),m=1;m<u;m++){var b=e[m];R?b.__offsetX(g*m,!0):b.__offsetY(g*m,!0)}else if("space-around"===n)for(var k=h/(u+1),x=0;x<u;x++){var M=e[x];R?M.__offsetX(k*(x+1),!0):M.__offsetY(k*(x+1),!0)}}R?(S&&(W=T),E+=W):s&&(W=P),l||("stretch"===a?e.forEach(function(t){var e=t.computedStyle,i=t.currentStyle,r=e.borderTopWidth,n=e.borderRightWidth,a=e.borderBottomWidth,o=e.borderLeftWidth,s=e.marginTop,h=e.marginRight,u=e.marginBottom,l=e.marginLeft,c=e.paddingTop,f=e.paddingRight,d=e.paddingBottom,p=e.paddingLeft;R?i.height.unit===mr&&(t.__height=e.height=W-s-u-c-d-r-a):i.width.unit===mr&&(t.__width=e.width=W-l-h-p-f-n-o)}):"center"===a?e.forEach(function(t){var e=W-t.outerHeight;0<e&&t.__offsetY(.5*e,!0)}):"flex-end"===a&&e.forEach(function(t){var e=W-t.outerHeight;0<e&&t.__offsetY(e,!0)})),this.__width=P,this.__height=S?T:E-t.y,this.__marginAuto(i,t)}}}},{key:"__layoutInline",value:function(e,i){var r=this,t=this.flowChildren,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o,s,h,u=n.textAlign,l=this.__preLayout(e),c=l.fixedWidth,f=l.fixedHeight,d=l.x,p=l.y,_=l.w,v=l.h;c&&i?this.__width=_:(s=o=0,h=new ar(d,p),t.forEach(function(t){t instanceof nr||t instanceof gr&&t.shadowRoot instanceof nr?("inline"!==t.computedStyle.display&&(t.currentStyle.display=t.computedStyle.display="inline",console.error("Inline can not contain block/flex")),d===e.x?(h.add(t),t.__layout({x:d,y:p,w:_,h:v},i),d+=t.outerWidth,o=Math.max(o,s),s=t.outerWidth):(0<=t.__tryLayInline(_-d+e.x,_)?t.__layout({x:d,y:p,w:_,h:v},i):(a.push(h),h.verticalAlign(),d=e.x,p+=h.height,t.__layout({x:e.x,y:p,w:_,h:v},i),h=new ar(d,p),o=Math.max(o,s),s=0),d+=t.outerWidth,h.add(t),s+=t.outerWidth)):d===e.x?(h.add(t),t.__layout({x:d,y:p,w:_,h:v},i),d+=t.width,o=Math.max(o,s),s=t.width):(0<=t.__tryLayInline(_-d+e.x)?t.__layout({x:d,y:p,w:_,h:v},i):(a.push(h),i||h.verticalAlign(),d=e.x,p+=h.height,t.__layout({x:e.x,y:p,w:_,h:v},i),h=new ar(d,p),o=Math.max(o,s),s=0),d+=t.width,h.add(t),s+=t.width)}),h.size&&(a.push(h),i||h.verticalAlign(),p+=h.height,o=Math.max(o,s)),this.__width=c?_:o,this.__height=f?v:p-e.y,!i&&-1<["center","right"].indexOf(u)&&a.forEach(function(t){var e=r.__width-t.width;0<e&&t.horizonAlign("center"===u?.5*e:e)}))}},{key:"__layoutAbs",value:function(i,r){var S=i.sx,A=i.sy,E=i.innerWidth,P=i.innerHeight,t=i.computedStyle,e=this.isDestroyed,n=this.children,a=this.absChildren,o=t.display,s=t.borderTopWidth,h=t.borderLeftWidth,u=t.marginTop,l=t.marginLeft,T=t.paddingLeft;e||"none"===o||(S+=l+h,A+=u+s,a.forEach(function(t){var e=t.currentStyle,i=t.computedStyle;t.__mp(e,i,E),"inline"===i.display&&(e.display=i.display="block");var r,n,a,o,s,h,u,l,c,f,d,p=e.left,_=e.top,v=e.right,y=e.bottom,g=e.width,m=e.height,b=e.display,k=e.flexDirection;if(p.unit!==mr?(f=!0,i.left=xr(e,"left",p,E)):i.left="auto",v.unit!==mr?(l=!0,i.right=xr(e,"right",v,E)):i.right="auto",_.unit!==mr?(u=!0,i.top=xr(e,"top",_,P)):i.top="auto",y.unit!==mr?(c=!0,i.bottom=xr(e,"bottom",y,P)):i.bottom="auto",f&&l?(r=S+i.left,a=S+E-i.right-r):f&&g.unit!==mr?(r=S+i.left,a=g.unit===br?g.value:E*g.value*.01):l&&g.unit!==mr?(a=g.unit===br?g.value:E*g.value*.01,r=S+E-i.right-a,r-=i.marginLeft,r-=i.marginRight,r-=i.paddingLeft,r-=i.paddingRight,r-=i.borderLeftWidth,r-=i.borderRightWidth):f?r=S+i.left:l?(r=S+E-i.right,s=!0):(r=S+T,g.unit!==mr&&(a=g.unit===br?g.value:E*g.value*.01)),u&&c)n=A+i.top,o=A+P-i.bottom-n;else if(u&&m.unit!==mr)n=A+i.top,o=m.unit===br?m.value:P*m.value*.01;else if(c&&m.unit!==mr)o=m.unit===br?m.value:P*m.value*.01,n=A+P-i.bottom-o,n-=i.marginTop,n-=i.marginBottom,n-=i.paddingTop,n-=i.paddingBottom,n-=i.borderTopWidth,n-=i.borderBottomWidth;else if(u)n=A+i.top;else if(c)n=A+P-i.bottom,h=!0;else{n=A;for(var x=t.prev;x;){if(x instanceof Ne||"absolute"!==x.computedStyle.position){n=x.y+x.outerHeight;break}x=x.prev}x||(n=A),m.unit!==mr&&(o=m.unit===br?m.value:P*m.value*.01)}("block"===b&&void 0===a||"flex"===b&&(void 0===a||"column"===k&&void 0===o))&&(d=!0);var M=s?r-S:E+S-r,w=h?n-A:P+A-n;d&&(t.__layout({x:r,y:n,w:M,h:w},!0,!0),M=t.outerWidth),t.__layout({x:r,y:n,w:M,h:w,w2:a,h2:o},!1,!0),s&&t.__offsetX(-t.outerWidth,!0),h&&t.__offsetY(-t.outerHeight,!0)}),n.forEach(function(t){var e;t instanceof d?t.__layoutAbs(-1<["absolute","relative"].indexOf(t.computedStyle.position)?t:i,r):t instanceof gr&&((e=t.shadowRoot)instanceof d&&e.__layoutAbs(e,r))}))}},{key:"render",value:function(e,i,r){var t=J(K(d.prototype),"render",this).call(this,e,i,r);t&&t.target&&t.target.ctx?i=t.target.ctx:t=null,e===we.SVG&&(this.virtualDom.type="dom");var n,a,o,s,h,u,l=this.isDestroyed,c=this.computedStyle.display,f=this.children;!l&&"none"!==c&&f.length&&(f.forEach(function(t){(t.isMask||t.isClip)&&t.__renderAsMask(e,i,r,!t.isMask)}),(n=this.zIndexChildren).forEach(function(t){t.__renderByMask(e,i,r)}),e===we.CANVAS&&t?(o=(a=this.root).width,s=a.height,h=He.getCacheWebgl(o,s),u=ke.gaussBlur(t.target,h,t.blur,o,s),t.ctx.drawImage(t.target.canvas,0,0),t.target.draw(),u.clear()):e===we.SVG&&"img"!==this.tagName&&(this.virtualDom.children=n.map(function(t){return t.virtualDom}),this.virtualDom.cache&&this.virtualDom.children.forEach(function(t){"text"===t.type&&(t.cache=!0)})))}},{key:"__measure",value:function(e,i,t){J(K(d.prototype),"__measure",this).call(this,e,i,t),this.children.forEach(function(t){t.__measure(e,i)})}},{key:"__destroy",value:function(){this.isDestroyed||(this.children.forEach(function(t){t&&t.__destroy()}),J(K(d.prototype),"__destroy",this).call(this),this.children.splice(0),this.lineGroups.splice(0))}},{key:"__emitEvent",value:function(t,e){if(e)return J(K(d.prototype),"__emitEvent",this).call(this,t,e);var i=this.isDestroyed,r=this.computedStyle;if(!i&&"none"!==r.display&&!t.__stopPropagation){var n,a=t.event.type,o=this.listener,s=this.zIndexChildren;o.hasOwnProperty(a)&&(n=o[a]);for(var h=s.length-1;0<=h;h--){var u=s[h];if((u instanceof nr||u instanceof gr&&u.shadowRoot instanceof nr)&&u.__emitEvent(t)){if(t.__stopPropagation)return;return Ee.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0}}return J(K(d.prototype),"__emitEvent",this).call(this,t)}}},{key:"__cancelCacheSvg",value:function(){J(K(d.prototype),"__cancelCacheSvg",this).call(this),this.children.forEach(function(t){(t instanceof nr||t instanceof gr&&t.shadowRoot instanceof nr)&&t.__cancelCacheSvg()})}},{key:"children",get:function(){return this.__children}},{key:"flowChildren",get:function(){return this.children.filter(function(t){return t instanceof gr&&(t=t.shadowRoot),t instanceof Ne||t.computedStyle&&"absolute"!==t.computedStyle.position})}},{key:"absChildren",get:function(){return this.children.filter(function(t){return t instanceof gr&&(t=t.shadowRoot),t instanceof nr&&t.computedStyle&&"absolute"===t.computedStyle.position})}},{key:"zIndexChildren",get:function(){var a,o=[],s=[],h=!1;return this.children.forEach(function(t,e){var i,r,n=t;t instanceof gr&&(t=t.shadowRoot),t.isMask||t.isClip||!t.computedStyle||(t instanceof nr&&("relative"===(r=t.computedStyle.position)||"absolute"===r)?(n.__iIndex=e,i=n.__zIndex=t.currentStyle.zIndex,s.push(n),void 0===a?a=i:h||(i<a&&(h=!0),a=i)):o.push(n))}),h&&s.sort(function(t,e){return t.__zIndex!==e.__zIndex?t.__zIndex-e.__zIndex:t.__iIndex-e.__iIndex}),o.concat(s)}},{key:"lineGroups",get:function(){return this.__lineGroups}},{key:"baseLine",get:function(){var t=this.lineGroups.length;if(t){var e=this.lineGroups[t-1];return e.y-this.y+e.baseLine}return this.y}}],[{key:"isValid",value:function(t){return Mr.hasOwnProperty(t)}}]),d}(),Pr=s.AUTO,Tr=q.canvasPolygon,Rr=q.svgPolygon,Cr=function(){e(Z,Er);var a=f(Z);function Z(t,e){var i;u(this,Z);var r=(i=a.call(this,t,e)).props.src,n=i.__loadImg={cb:function(){}};return r||(n.error=!0),i}return l(Z,[{key:"__preLayout",value:function(t){var e,i,r=J(K(Z.prototype),"__preLayout",this).call(this,t),n=this.__loadImg;return n.error||(e=this.props.src,(i=He.IMG[e])&&i.state===He.LOADED&&(n.url=e,n.source=i.source,n.width=i.width,n.height=i.height),n.cache=!1),r.fixedWidth&&r.fixedHeight||(n.error?r.fixedWidth?r.h=r.w:r.fixedHeight?r.w=r.h:r.w=r.h=32:n.source?r.fixedWidth?r.h=r.w*n.height/n.width:r.fixedHeight?r.w=r.h*n.width/n.height:(r.w=n.width,r.h=n.height):r.w=r.h=0,r.fixedWidth=!0,r.fixedHeight=!0),r}},{key:"__addGeom",value:function(t,e){e=Ee.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),J(K(Z.prototype),"__destroy",this).call(this)}},{key:"render",value:function(t,e,i){var a=this;J(K(Z.prototype),"render",this).call(this,t,e,i);var r=this.sx,n=this.sy,o=this.width,s=this.height,h=this.isDestroyed,u=this.props.src,l=this.computedStyle,c=l.display,f=l.borderTopWidth,d=l.borderRightWidth,p=l.borderBottomWidth,_=l.borderLeftWidth,v=l.marginTop,y=l.marginLeft,g=l.paddingTop,m=l.paddingLeft,b=l.borderTopLeftRadius,k=l.borderTopRightRadius,x=l.borderBottomRightRadius,M=l.borderBottomLeftRadius,w=l.visibility;if(!h&&"none"!==c&&"hidden"!==w){var S=r+y+_+m,A=n+v+f+g,E=this.__loadImg;if(E.error){var P=.02*Math.min(o,s),T=S+.7*o,R=A+.3*s,C=5*P,L=[[S+.15*o,A+.7*s],[S+.3*o,A+.4*s],[S+.5*o,A+.6*s],[S+.6*o,A+.5*s],[S+.9*o,A+.8*s],[S+.15*o,A+.8*s]];if(t===we.CANVAS){e.strokeStyle="#CCC",e.lineWidth=P,e.fillStyle="#DDD",e.beginPath(),e.moveTo(S,A),e.lineTo(S+o,A),e.lineTo(S+o,A+s),e.lineTo(S,A+s),e.lineTo(S,A),e.stroke(),e.closePath(),e.beginPath(),e.arc(T,R,C,0,2*Math.PI),e.fill(),e.closePath(),e.beginPath(),e.moveTo(L[0][0],L[0][1]);for(var O=1,N=L.length;O<N;O++){var D=L[O];e.lineTo(D[0],D[1])}e.lineTo(L[0][0],L[0][1]),e.fill(),e.closePath()}else if(t===we.SVG){this.virtualDom.children=[],this.__addGeom("rect",[["x",S],["y",A],["width",o],["height",s],["stroke","#CCC"],["stroke-width",P],["fill","rgba(0,0,0,0)"]]),this.__addGeom("circle",[["cx",T],["cy",R],["r",C],["fill","#DDD"]]);for(var F="",I=0,W=L.length;I<W;I++){var B=L[I];I&&(F+=" "),F+=B[0]+","+B[1]}this.__addGeom("polygon",[["points",F],["fill","#DDD"]])}}else if(E.url===u){var H=E.source;if(H){var G,$,X,Y=Te.calRadius(S,A,o,s,f,d,p,_,b,k,x,M);if(t===we.CANVAS)Y?(e.save(),e.beginPath(),Tr(e,Y),e.clip(),e.closePath(),e.drawImage(H,S,A,o,s),e.restore()):e.drawImage(H,S,A,o,s);else if(t===we.SVG){if(E.cache)return E.cache.cache=!0,this.virtualDom.children=[E.cache],void(!this.virtualDom.cache&&Y&&(G=Rr(Y),$=i.add({tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",G],["fill","#FFF"]]}]}),this.virtualDom.conClip="url(#"+$+")"));o===E.width&&s===E.height||(X=Re.matrixResize(E.width,E.height,o,s,S,A,o,s));var z,j,V=[["xlink:href",u],["x",S],["y",A],["width",E.width],["height",E.height]];Y&&(z=Rr(Y),j=i.add({tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",z],["fill","#FFF"]]}]}),this.virtualDom.conClip="url(#"+j+")",delete this.virtualDom.cache),X&&!Ee.equalArr(X,[1,0,0,1,0,0])&&V.push(["transform","matrix("+Ee.joinArr(X,",")+")"]);var U={type:"img",tagName:"image",props:V};this.virtualDom.children=[U],E.cache=U}}}else{var q=this.__loadImg;q.url=u,q.source=null,q.error=null,q.cache=!1,He.measureImg(u,function(t){var e,i,r,n;t.url!==q.url||a.__isDestroyed||(t.success?(q.source=t.source,q.width=t.width,q.height=t.height):q.error=!0,e=a.root,r=(i=a.currentStyle).width,n=i.height,e.delRefreshTask(q.cb),e.delRefreshTask(a.__task),r.unit!==Pr&&n.unit!==Pr?e.addRefreshTask(q.cb):e.addRefreshTask(a.__task={before:function(){e.setRefreshLevel(ni.REFLOW)}}))},{width:o,height:s})}}}},{key:"baseLine",get:function(){return this.height}}]),Z}(),Lr=m.TYPE_PL,Or=m.TYPE_VD,Nr=m.TYPE_GM,Dr=m.TYPE_CP,Fr=[],Ir=[],Wr={};function Br(t){t instanceof Sr&&t.children.forEach(function(t){t instanceof Sr?Br(t):t instanceof Ar&&t.__hasUpdate&&(t.__hasUpdate=!1,Hr(t,t.props))})}function Hr(t,e,i){(t.__nextState||i)&&(!Ee.isFunction(t.shouldComponentUpdate)||t.shouldComponentUpdate(e,t.__nextState||t.state))?function(t,e,i){t.props=e,t.__state=i,t.__nextState=null;var r=t.shadowRoot,n=t.__cd,a=dr.flattenJson(t.render());(function(t,e,i){var o=Yr(e,{},t),s=Yr(i,{}),h=[],u=[];Object.keys(o).forEach(function(t){var e=o[t];s[t]||(e.json.key=Wr)}),Object.keys(s).forEach(function(t){var e,i,r,n=o[t],a=s[t];n?(e=n.json,i=a.json,r=n.vd,e.$$type===Dr&&i.$$type===Dr?e.klass===i.klass&&(Xr(e,i,r),e.key=i.key=Wr,u.push(r)):e.$$type===i.$$type&&e.tagName===i.tagName&&(i.$$type===Nr&&e.props.multi!==i.props.multi||(i.inherit=r),e.key=i.key=Wr,i.$$type===Or&&h.push({vd:r,oj:e,nj:i}))):a.json.key=Wr}),h.forEach(function(t){$r(t.vd,t.oj,t.nj)}),Gr(t,e,i),u.forEach(function(t){zr(t)})})(t.shadowRoot,n,a),t.__init(a),Fr.push(t),Ee.isObject(a)&&a.$$type===Lr||Ir.push(r)}(t,e,t.__nextState||t.state):Br(t.shadowRoot)}function Gr(t,e,i){if(Ee.isObject(i))if(i.$$type===Dr){if(i.key===Wr)return;e.$$type===i.$$type&&e.klass===i.klass&&(Xr(e,i,t),zr(t))}else i.$$type===Nr&&e.$$type===Nr?e.tagName===i.tagName&&e.props.multi===i.props.multi&&(i.inherit=t):i.$$type===Or&&e.$$type===Or&&(e.tagName===i.tagName&&(i.inherit=t),$r(t,e,i))}function $r(t,e,i){for(var r=e.children,n=i.children,a=r.length,o=n.length,s=t.children,h=0,u=0,l=0,c=Math.min(a,o);h<c;h++){var f=r[h+u],d=n[h+l];f.key===Wr&&d.key===Wr||(f.key===Wr?(u++,h--,a--,c=Math.min(a,o)):d.key===Wr?(l++,h--,o--,c=Math.min(a,o)):Gr(s[h+u],f,d))}}function Xr(n,a,o){a.$$type=Lr;var s=(a.value=o).shadowRoot,h={};Object.keys(n.props).forEach(function(t){var e=n.props[t];h[t]=e}),Object.keys(a.props).forEach(function(t){var e,i,r=a.props[t];/^on[a-zA-Z]/.test(t)?(n.props[t]=r,(e=h[t])?(delete h[t],e!==r&&(t=t.slice(2).toLowerCase(),s.listener[t]=r)):(t=t.slice(2).toLowerCase(),s.listener[t]=r)):/^on-[a-zA-Z\d_$]/.test(t)&&(n.props[t]=r,(i=h[t])?(delete h[t],i!==r&&(t=t.slice(2).toLowerCase(),o.off(t,h[t]),o.on(t,r)),delete h[t]):(t=t.slice(2).toLowerCase(),o.on(t,r)))}),Object.keys(h).forEach(function(t){var e=h[t];/^on[a-zA-Z]/.test(t)?(a.props[t]=e,t=t.slice(2).toLowerCase(),delete s.listener[t]):/^on-[a-zA-Z\d_$]/.test(t)&&(a.props[t]=e,t=t.slice(2).toLowerCase(),o.off(t,e))}),Hr(o,a.props,!Ee.equal(n.props,a.props))}function Yr(t,i,r){var e;return Array.isArray(t)?t.forEach(function(t,e){return Yr(t,i,r&&r[e])}):Ee.isObject(t)&&(t.$$type!==Or&&t.$$type!==Nr&&t.$$type!==Dr||(t.$$type===Or&&Yr(t.children,i,r&&r.children),e=t.props.key,Ee.isNil(e)||""===e||(i.hasOwnProperty(e)&&console.error("Component "+r.tagName+" has duplicate key: "+e),i[e]={json:t,vd:r}))),i}function zr(t){if(t.host){var e=t.parent;if(e){var i=e.children.indexOf(t);if(!(-1<i))throw new Error("Can not find child: "+t.tagName);e.children[i]=null}}}var jr,Vr={ref:function(t){t.Xom,Sr=t.Dom,t.Img,t.Geom,Ar=t.Component},updateList:Fr,check:Br,checkCp:Hr,did:function(){Fr.forEach(function(t){Ee.isFunction(t.componentDidUpdate)&&t.componentDidUpdate()}),Fr=[],Ir.forEach(function(t){t.__destroy()}),Ir=[]}},Ur=Ee.joinVd,qr=Ee.joinDef;function Zr(t,e,i){var r=t.childNodes;!function(t,e,i){for(var r=e.length,n=i.length,a=0,o=t.childNodes;a<Math.min(r,n);a++)!function(e,t,i){if(t.tagName!==i.tagName)hn(e,"beforebegin",qr(i)),e.parentNode.removeChild(e);else{t.uuid!==i.uuid&&e.setAttribute("id",i.uuid);for(var r={},n=0,a=(t.props||[]).length;n<a;n++){var o=xe(t.props[n],2),s=o[0],h=o[1];r[s]=h}for(var u=0,l=(i.props||[]).length;u<l;u++){var c=xe(i.props[u],2),f=c[0],d=c[1];r.hasOwnProperty(f)?(r[f]!==d&&e.setAttribute(f,d),delete r[f]):e.setAttribute(f,d)}Object.keys(r).forEach(function(t){e.removeAttribute(t)});for(var p=e.childNodes,_=t.children.length,v=i.children.length,y=0;y<Math.min(_,v);y++)rn(e,y,t.children[y],i.children[y]);if(y<_)for(var g=_-1;y<=g;g--)sn(e,p,g);else if(y<v)for(;y<v;y++)on(e,p,y,Ur(i.children[y]))}}(o[a],e[a],i[a]);if(a<r)for(var s=r-1;a<=s;s--)sn(t,o,s);else if(a<n)for(;a<n;a++)on(t,o,a,qr(i[a]))}(r[0],e.defs,i.defs),en(r[1],e.bb,i.bb,e.bbClip,i.bbClip),Qr(t,e,i,!0)}function Kr(t,e,i){"dom"===e.type?"dom"===i.type?Qr(t,e,i):"geom"===i.type?tn(t,e,i):an(t,i):"text"===e.type?"text"===i.type?function(t,e,i){if(i.cache)return;for(var r=e.children.length,n=i.children.length,a=0;a<Math.min(r,n);a++)rn(t,a,e.children[a],i.children[a],!0);var o=t.childNodes;if(a<r)for(var s=r-1;a<=s;s--)sn(t,o,s);else if(a<n)for(;a<n;a++)on(t,o,a,Ur(i.children[a]))}(t,e,i):an(t,i):"geom"===e.type?"dom"===i.type?tn(t,e,i):"geom"===i.type?function(t,e,i){if(i.cache)return;Jr(t,e,i),en(t.firstChild,e.bb,i.bb,e.bbClip,i.bbClip);for(var r=e.children.length,n=i.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(r,n);a++)rn(o,a,e.children[a],i.children[a]);if(a<r)for(var h=r-1;a<=h;h--)sn(o,s,h);else if(a<n)for(;a<n;a++)on(o,s,a,Ur(i.children[a]))}(t,e,i):an(t,i):"img"===e.type&&("img"===i.type?nn(t,e,i):an(t,i))}function Jr(t,e,i){var r=i.transform,n=i.opacity,a=i.mask,o=i.clip,s=i.filter,h=i.conClip;e.transform!==r&&(r?t.setAttribute("transform",r):t.removeAttribute("transform")),e.opacity!==n&&(1!==n?t.setAttribute("opacity",n):t.removeAttribute("opacity")),e.mask!==a&&(a?t.setAttribute("mask",a):t.removeAttribute("mask"),e.clip&&t.removeAttribute("clip-path")),e.clip!==o&&(o?t.setAttribute("clip-path",o):t.removeAttribute("clip-path"),e.mask&&t.removeAttribute("mask")),e.filter!==s&&(s?t.setAttribute("filter",s):t.removeAttribute("filter")),e.conClip!==h&&(h?t.childNodes[1].setAttribute("clip-path",h):t.childNodes[1].removeAttribute("clip-path"))}function Qr(t,e,i,r){i.cache||(Jr(t,e,i),r||en(t.firstChild,e.bb,i.bb,e.bbClip,i.bbClip));for(var n=e.children.length,a=i.children.length,o=0,s=t.lastChild,h=s.childNodes;o<Math.min(n,a);o++)Kr(h[o],e.children[o],i.children[o]);if(o<n)for(var u=n-1;o<=u;u--)sn(s,h,u);else if(o<a)for(;o<a;o++)on(s,h,o,Ur(i.children[o]))}function tn(t,e,i){Jr(t,e,i),en(t.firstChild,e.bb,i.bb,e.bbClip,i.bbClip);for(var r=e.children.length,n=i.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(r,n);a++)an(s[a],i.children[a]);if(a<r)for(var h=r-1;a<=h;h--)sn(o,s,h);else if(a<n)for(;a<n;a++)on(o,s,a,Ur(i.children[a]))}function en(t,e,i,r,n){var a=e.length,o=i.length;r!==n&&(nMask?t.setAttribute("clip-path",n):t.removeAttribute("clip-path"));for(var s=0;s<Math.min(a,o);s++)rn(t,s,e[s],i[s]);var h=t.childNodes;if(s<a)for(var u=a-1;s<=u;u--)sn(t,h,u);else if(s<o)for(;s<o;s++)on(t,h,s,Ur(i[s]))}function rn(t,e,i,r,n){var a=t.childNodes;i.tagName!==r.tagName?an(a[e],r):(nn(a[e],i,r),n&&i.content!==r.content&&(a[e].innerHTML=r.content))}function nn(e,t,i){if(!i.cache){for(var r={},n=0,a=(t.props||[]).length;n<a;n++){var o=xe(t.props[n],2),s=o[0],h=o[1];r[s]=h}for(var u=0,l=(i.props||[]).length;u<l;u++){var c=xe(i.props[u],2),f=c[0],d=c[1];r.hasOwnProperty(f)?(r[f]!==d&&e.setAttribute(f,d),delete r[f]):e.setAttribute(f,d)}Object.keys(r).forEach(function(t){e.removeAttribute(t)})}}function an(t,e){var i;Array.isArray(e)?(i="",e.forEach(function(t){i+=Ur(t)})):i=Ur(e),hn(t,"beforebegin",i),t.parentNode.removeChild(t)}function on(t,e,i,r){i>=e.length?hn(t,"beforeend",r):hn(e[i],"beforebegin",r)}function sn(t,e,i){e[i]&&t.removeChild(e[i])}function hn(t,e,i){if(t.insertAdjacentHTML)t.insertAdjacentHTML(e,i);else switch(e){case"beforeend":t.innerHTML+=i;break;case"beforebegin":(jr=jr||document.createElement("svg")).innerHTML=i,t.parentNode.insertBefore(jr.childNodes[0],t)}}var un=function(){function e(t){u(this,e),this.id=t,this.count=0,this.list=[]}return l(e,[{key:"add",value:function(t){return t.uuid="karas-defs-"+this.id+"-"+this.count++,this.list.push(t),t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(t){return new e(t)}}]),e}(),ln=Ee.isFunction,cn=function(){function t(){u(this,t),this.__records=[],this.__auto=[],this.__list=[]}return l(t,[{key:"add",value:function(t){-1===this.__list.indexOf(t)&&this.list.push(t)}},{key:"remove",value:function(t){var e=this.list.indexOf(t);-1<e&&this.list.splice(e,1)}},{key:"__destroy",value:function(){this.__records=[],this.__auto=[],this.__list=[]}},{key:"__action",value:function(e,i){this.list.forEach(function(t){t[e].apply(t,i)})}},{key:"init",value:function(t){var o=this,e=0<arguments.length&&void 0!==t?t:this.__records;e.length&&e.splice(0).forEach(function(t){var e,i,r,n=t.target,a=t.animate;Array.isArray(a)?a.forEach(function(t){var e=t.value,i=t.options;i.autoPlay=!1;var r=n.animate(e,i);o.add(r)}):(e=a.value,(i=a.options).autoPlay=!1,r=n.animate(e,i),o.add(r))})}},{key:"__playAuto",value:function(){this.init(this.__auto),this.__action("play")}},{key:"play",value:function(e){this.init();var i=!0;this.__action("play",[e&&function(t){i&&(i=!1,ln(e)&&e(t))}])}},{key:"pause",value:function(){this.__action("pause")}},{key:"resume",value:function(e){var i=!0;this.__action("resume",[e&&function(t){i&&(i=!1,ln(e)&&e(t))}])}},{key:"cancel",value:function(e){var i=!0;this.__action("cancel",[e&&function(t){i&&(i=!1,ln(e)&&e(t))}])}},{key:"finish",value:function(e){var i=!0;this.__action("finish",[e&&function(t){i&&(i=!1,ln(e)&&e(t))}])}},{key:"gotoAndStop",value:function(t,e,i){this.init();var r=!0;this.__action("gotoAndStop",[t,e,i&&function(t){r&&(r=!1,ln(i)&&i(t))}])}},{key:"gotoAndPlay",value:function(t,e,i){this.init();var r=!0;this.__action("gotoAndPlay",[t,e,i&&function(t){r&&(r=!1,ln(i)&&i(t))}])}},{key:"__set",value:function(e,i){this.list.forEach(function(t){t[e]=i})}},{key:"list",get:function(){return this.__list}},{key:"playbackRate",set:function(t){this.__set("playbackRate",t)}},{key:"iterations",set:function(t){this.__set("iterations",t)}},{key:"playCount",set:function(t){this.__set("playCount",t)}},{key:"fps",set:function(t){this.__set("fps",t)}},{key:"currentTime",set:function(t){this.__set("currentTime",t)}},{key:"spfLimit",set:function(t){this.__set("spfLimit",t)}},{key:"delay",set:function(t){this.__set("delay",t)}},{key:"endDelay",set:function(t){this.__set("endDelay",t)}},{key:"fill",set:function(t){this.__set("fill",t)}},{key:"direction",set:function(t){this.__set("direction",t)}}]),t}(),fn=Ee.isNil,dn=Ee.isObject,pn=Ee.isFunction,_n=s.PX;var vn=0,yn=function(){e(a,Er);var n=f(a);function a(t,e,i){var r;return u(this,a),(r=n.call(this,t,e)).__cd=i||[],r.__node=null,r.__mw=0,r.__mh=0,r.__sx=1,r.__sy=1,r.__task=[],r.__ref={},r.__animateController=new cn,Le.mix(c(r)),r}return l(a,[{key:"__initProps",value:function(){var t,e=this.props.width;fn(e)||0<(t=parseFloat(e)||0)&&(this.__width=t);var i,r=this.props.height;fn(r)||0<(i=parseFloat(r)||0)&&(this.__height=i),this.__offScreen=!!this.props.offScreen}},{key:"__genHtml",value:function(){var a=this,o="<".concat(this.tagName);return Object.keys(this.props).forEach(function(t){var e,i,r,n=a.props[t];/^on[a-zA-Z]/.test(t)||(o+=(e=t,i=n,r=Array.isArray(i)?Ee.joinSourceArray(i):Ee.stringify(i),"className"===e&&(e="class")," "+e+'="'+Ee.encodeHtml(r,!0)+'"'))}),o+="></".concat(this.tagName,">")}},{key:"__wrapEvent",value:function(t){var e,i,r,n,a,o,s,h,u,l,c;return-1===["touchend","touchcancel"].indexOf(t.type)&&(e=this.node,i=this.__sx,r=this.__sy,a=(n=e.getBoundingClientRect()).x,o=n.y,s=n.left,h=n.top,u=a||s||0,l=o||h||0,u=(c=t.touches?t.touches[0]:t).pageX-u,l=c.pageY-l,1!==i&&(u/=i),1!==r&&(l/=r)),{event:t,stopPropagation:function(){this.__stopPropagation=!0,t.stopPropagation()},stopImmediatePropagation:function(){this.__stopPropagation=!0,this.__stopImmediatePropagation=!0,t.stopImmediatePropagation()},preventDefault:function(){t.preventDefault()},x:u,y:l,__hasEmitted:!1}}},{key:"__cb",value:function(t){if("touchmove"!==t.type||this.__touchstartTarget){var e=this.__wrapEvent(t);return this.__emitEvent(e),e}}},{key:"appendTo",value:function(t){var e,r;t=function(t){if(Ee.isString(t)&&t){var e=document.querySelector(t);if(!e)throw new Error("can not find dom of selector: "+t);return e}if(!t)throw new Error("can not find dom: "+t);return t}(t),this.__children=dr.initRoot(this.__cd,this),this.__initProps(),(this.__root=this).__refreshLevel=ni.REFLOW,t.nodeName.toUpperCase()===this.tagName.toUpperCase()?(this.__node=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__node=t.querySelector(this.tagName),this.__node||(t.innerHTML=this.__genHtml(),this.__node=t.querySelector(this.tagName))),this.__uuid=fn(this.__node.__uuid)?vn++:this.__node.__uuid,this.__defs=this.node.__defs||un.getInstance(this.__uuid),this.width&&this.height||(e=window.getComputedStyle(t,null),this.width||(this.__width=parseFloat(e.getPropertyValue("width"))||0,t.setAttribute("width",this.width)),this.height||(this.__height=parseFloat(e.getPropertyValue("height"))||0,t.setAttribute("height",this.height))),"canvas"===this.tagName?(this.__ctx=this.__node.getContext("2d"),this.__renderMode=we.CANVAS):"svg"===this.tagName&&(this.__renderMode=we.SVG),this.refresh(),this.node.__root?this.node.__root.destroy():(r=this.node,["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"].forEach(function(i){r.addEventListener(i,function(t){var e=r.__root;-1<["touchend","touchcancel","touchmove"].indexOf(i)?e.__touchstartTarget.__emitEvent(e.__wrapEvent(t),!0):e.__cb(t)})}),this.node.__uuid=this.__uuid),this.node.__root=this}},{key:"refresh",value:function(e){var i,r,n,a=this,t=this.isDestroyed,o=this.renderMode,s=this.ctx,h=this.defs,u=this.style,l=this.currentStyle,c=this.computedStyle,f=this.width,d=this.height,p=this.offScreen;t||(h.clear(),-1===["flex","block"].indexOf(u.display)&&(c.display=l.display=u.display="block"),"absolute"===u.position&&(c.position=l.positoin=u.position="static"),l.width=u.width={value:f,unit:_n},l.height=u.height={value:d,unit:_n},p&&((i=He.getCacheCanvas(f,d,"__$$offScreen$$__"))?(r=s,s=i.ctx):(this.__offScreen=p=!1,console.error("Can not use offScreen mode, inject.getCacheCanvas() return null"))),n=this.__refreshLevel,this.__refreshLevel=ni.REPAINT,ni.REFLOW<=n&&this.__measure(o,s,!0),He.measureText(function(){var t;ni.REFLOW<=n&&(a.__layout({x:0,y:0,w:a.width,h:a.height}),a.__layoutAbs(a,{x:0,y:0,w:a.width,h:a.height})),o===we.CANVAS&&a.__clear(s),a.render(o,s,h),o===we.SVG&&((t=a.virtualDom).defs=h.value,a.node.__root?Zr(a.node,a.node.__vd,t):a.node.innerHTML=Ee.joinVirtualDom(t),a.node.__vd=t,a.node.__defs=h),p&&(a.__clear(r),r.drawImage(i.canvas,0,0)),pn(e)&&e(),a.emit(Le.REFRESH,n)}))}},{key:"destroy",value:function(){this.__destroy(),je.offFrame(this.__rTask);var t=this.node;t&&(t.__root=null)}},{key:"scale",value:function(t,e){var i=0<arguments.length&&void 0!==t?t:1,r=1<arguments.length&&void 0!==e?e:i;this.__sx=i,this.__sy=r}},{key:"addRefreshTask",value:function(t){var a,o,s=this;t&&((a=this.task).length||je.nextFrame(this.__rTask={before:function(i){var r,t,e,n;(o=a.splice(0)).length&&(r=[],o.forEach(function(t,e){dn(t)&&pn(t.before)&&(t.__state&&r.push(e),t.before(i))}),r.length&&Vr.check(s),Vr.updateList.length?(s.setRefreshLevel(ni.REFLOW),s.refresh()):o.length>r.length&&s.refresh(),!(t=s.__hookTask)||-1<(n=(e=je.__hookTask).indexOf(t))&&e.splice(n,1),Vr.did())},after:function(e){o.forEach(function(t){dn(t)&&pn(t.after)?t.after(e):pn(t)&&t(e)})}}),-1===a.indexOf(t)&&a.push(t))}},{key:"delRefreshTask",value:function(t){if(t){for(var e=this.task,i=0,r=e.length;i<r;i++)if(e[i]===t){e.splice(i,1);break}e.length||je.offFrame(this.__rTask)}}},{key:"setRefreshLevel",value:function(t){t>this.__refreshLevel&&(this.__refreshLevel=t)}},{key:"__frameHook",value:function(){var t=this,e=this.__hookTask=this.__hookTask||function(){t.refresh()};-1===je.__hookTask.indexOf(e)&&je.__hookTask.push(e)}},{key:"__clear",value:function(t){this.__mw=Math.max(this.__mw,this.width),this.__mh=Math.max(this.__mh,this.height),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.__mw,this.__mh)}},{key:"node",get:function(){return this.__node}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"ctx",get:function(){return this.__ctx}},{key:"offScreen",get:function(){return this.__offScreen}},{key:"defs",get:function(){return this.__defs}},{key:"task",get:function(){return this.__task}},{key:"ref",get:function(){return this.__ref}},{key:"animateController",get:function(){return this.__animateController}}]),a}(),gn=s.AUTO,mn=s.PX,bn=s.PERCENT,kn=Ee.clone,xn=Ee.int2rgba,Mn=Ee.isNil,wn=Ee.joinArr,Sn={},An=function(){e(h,nr);var s=f(h);function h(t,e){var i;u(this,h),(i=s.call(this,t,e)).__isMulti=!!i.props.multi,i.__isMask=!!i.props.mask,i.__isClip=!!i.props.clip;var r=c(i),n=r.style,a=r.isMask,o=r.isClip;return(a||o)&&(n.visibility="visible",n.background=null,n.border=null,n.strokeWidth=0,n.stroke=null,o&&(n.fill="#FFF",n.opacity=1)),i.__style=ae.normalize(i.style,pe.dom.concat(pe.geom)),i.__currentStyle=Ee.extend({},i.__style),i.__currentProps=Ee.clone(i.props),i.__cacheProps={},i}return l(h,[{key:"__tryLayInline",value:function(t,e){var i=this.currentStyle.width;return i.unit===mn?t-i.value:i.unit===bn?t-e*i.value*.01:t}},{key:"__calAutoBasis",value:function(t){var e,i,r=0,n=0,a=0,o=this.currentStyle,s=this.computedStyle,h=o.width,u=o.height,l=s.borderTopWidth,c=s.borderRightWidth,f=s.borderBottomWidth,d=s.borderLeftWidth,p=t?h:u;return p.unit!==gn&&(r=a+=p.value),t?(r+=e=c+d,a+=e,n+=e):(r+=i=l+f,a+=i,n+=i),{b:r,min:n,max:a}}},{key:"__layoutBlock",value:function(t,e){var i=this.__preLayout(t),r=i.fixedWidth,n=i.fixedHeight,a=i.w,o=i.h;this.__height=n?o:0,e?this.__width=r?a:0:(this.__width=a,this.__marginAuto(this.currentStyle,t),this.__cacheProps={})}},{key:"__layoutFlex",value:function(t){this.__layoutBlock(t)}},{key:"__layoutInline",value:function(t){var e=this.__preLayout(t),i=e.fixedWidth,r=e.fixedHeight,n=e.x,a=e.y,o=e.w,s=e.h;this.__width=i?o:n-t.x,this.__height=r?s:a-t.y,this.__cacheProps={}}},{key:"__preRender",value:function(t,e,i){var r,n,a,o,s=this.sx,h=this.sy,u=this.width,l=this.height,c=this.__cacheStyle,f=this.currentStyle,d=this.computedStyle,p=d.borderTopWidth,_=d.borderLeftWidth,v=d.display,y=d.marginTop,g=d.marginLeft,m=d.paddingTop,b=d.paddingRight,k=d.paddingBottom,x=d.paddingLeft,M=d.visibility,w=s+_+g+x,S=h+p+y+m,A=w+.5*u,E=S+.5*l,P=u+x+b,T=l+m+k;void 0===c.stroke&&(r=f.stroke,!(d.stroke=r)||"linear"!==r.k&&"radial"!==r.k?c.stroke=xn(f.stroke):c.stroke=this.__gradient(t,e,i,w,S,w+u,S+l,P,T,r)),void 0===c.fill&&(n=f.fill,!(d.fill=n)||"linear"!==n.k&&"radial"!==n.k?c.fill=xn(f.fill):c.fill=this.__gradient(t,e,i,w,S,w+u,S+l,P,T,n)),void 0===c.strokeWidth&&(c.strokeWidth=!0,(a=f.strokeWidth).unit===mn?d.strokeWidth=a.value:a.unit===bn?d.strokeWidth=a.value*u*.01:d.strokeWidth=0),void 0===c.strokeWidth&&(c.strokeWidth=!0,(o=f.strokeWidth).unit===mn?d.strokeWidth=o.value:o.unit===bn?d.strokeWidth=o.value*u*.01:d.strokeWidth=0),void 0===c.strokeDasharray&&(c.strokeDasharray=!0,d.strokeDasharray=f.strokeDasharray,c.strokeDasharrayStr=Ee.joinArr(f.strokeDasharray,",")),["strokeLinecap","strokeLinejoin","strokeMiterlimit"].forEach(function(t){d[t]=f[t]});var R=c.fill,C=c.stroke,L=c.strokeDasharrayStr,O=d.strokeWidth,N=d.strokeLinecap,D=d.strokeLinejoin,F=d.strokeMiterlimit,I=d.strokeDasharray;return t===we.CANVAS&&(e.fillStyle!==R&&(e.fillStyle=R),e.strokeStyle!==C&&(e.strokeStyle=C),e.lineWidth!==O&&(e.lineWidth=O),e.lineCap!==N&&(e.lineCap=N),e.lineJoin!==D&&(e.lineJoin=D),e.miterLimit!==F&&(e.miterLimit=F),Ee.equalArr(e.getLineDash(),I)||e.setLineDash(I)),{x:s,y:h,originX:w,originY:S,cx:A,cy:E,display:v,stroke:C,strokeWidth:O,strokeDasharray:I,strokeDasharrayStr:L,strokeLinecap:N,strokeLinejoin:D,strokeMiterlimit:F,fill:R,visibility:M}}},{key:"render",value:function(t,e,i){if(J(K(h.prototype),"render",this).call(this,t,e,i),t===we.SVG){if(this.virtualDom.cache)return{cache:!0};this.virtualDom.type="geom"}var r=this.isDestroyed,n=this.computedStyle.display;return r||"none"===n?{isDestroyed:r,display:n}:this.__preRender(t,e,i)}},{key:"__renderAsMask",value:function(t,e,i,r){if(t===we.SVG){this.render(t,e,i);var n=this.virtualDom;r?n.isClip=!0:n.isMask=!0;var a=kn(n.children),s=this.matrix;a.forEach(function(t){var e=t.props;if("path"===t.tagName)for(var i=0,r=e.length;i<r;i++){var n=xe(e[i],2),a=n[0],o=n[1];if("d"===a){e[i][1]=o.replace(/([\d.]+),([\d.]+)/g,function(t,e,i){return wn(Se.calPoint([e,i],s),",")});break}}});var o=this.prev;if(o&&(r?o.isClip:o.isMask)){var h=i.value;return void((h=h[h.length-1]).children=h.children.concat(a))}var u=i.add({tagName:r?"clipPath":"mask",props:[],children:a});r?this.__clipId="url(#"+u+")":this.__maskId="url(#"+u+")"}}},{key:"__propsStrokeStyle",value:function(t,e,i,r,n){e&&t.push(["stroke-dasharray",e]),"butt"!==i&&t.push(["stroke-linecap",i]),"miter"!==r&&t.push(["stroke-linejoin",r]),4!==n&&t.push(["stroke-miterlimit",n])}},{key:"addGeom",value:function(t,e){e=Ee.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"getProps",value:function(t){var e=this.currentProps[t];return Mn(e)?this["__"+t]:e}},{key:"baseLine",get:function(){return this.__height}},{key:"isMulti",get:function(){return this.__isMulti}},{key:"isMask",get:function(){return this.__isMask}},{key:"isClip",get:function(){return this.__isClip}},{key:"maskId",get:function(){return this.__maskId}},{key:"clipId",get:function(){return this.__clipId}},{key:"currentProps",get:function(){return this.__currentProps}}],[{key:"getRegister",value:function(t){if(!Sn.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return Sn[t]}},{key:"register",value:function(t,e){if(h.hasRegister(t))throw new Error("Geom has already register: ".concat(t));Sn[t]=e}},{key:"hasRegister",value:function(t){return Sn.hasOwnProperty(t)}}]),h}(),En=Ee.isNil;function Pn(t,e,i,r){return r?t.map(function(t){return e+t*i}):e+t*i}function Tn(t,e,i,r,n,a){if(a){if(t)return t.map(function(t){return Tn(t,e,i,r,n)})}else if(t&&2===t.length)return[e+t[0]*r,i+t[1]*n];return[]}function Rn(t,e){var i=0;return 2===t.length&&i++,2===e.length&&(i+=2),i}var Cn=function(){e(C,An);var r=f(C);function C(t,e){var i;return u(this,C),(i=r.call(this,t,e)).isMulti?(i.__x1=[0],i.__y1=[0],i.__x2=[1],i.__y2=[1],i.__controlA=[[]],i.__controlB=[[]],Array.isArray(e.x1)?i.__x1=e.x1.map(function(t){return parseFloat(t)||0}):En(e.x1)||(i.__x1=[parseFloat(e.x1)||0]),Array.isArray(e.y1)?i.__y1=e.y1.map(function(t){return parseFloat(t)||0}):En(e.y1)||(i.__y1=[parseFloat(e.y1)||0]),Array.isArray(e.x2)?i.__x2=e.x2.map(function(t){return parseFloat(t)||0}):En(e.x2)||(i.__x2=[parseFloat(e.x2)||0]),Array.isArray(e.y2)?i.__y2=e.y2.map(function(t){return parseFloat(t)||0}):En(e.y2)||(i.__y2=[parseFloat(e.y2)||0]),Array.isArray(e.controlA)&&(i.__controlA=e.controlA.map(function(t){return Array.isArray(t)?t:[]})),Array.isArray(e.controlB)&&(i.__controlB=e.controlB.map(function(t){return Array.isArray(t)?t:[]}))):(i.__x1=i.__y1=0,i.__x2=i.__y2=1,i.__controlA=[],i.__controlB=[],En(e.x1)||(i.__x1=parseFloat(e.x1)||0),En(e.y1)||(i.__y1=parseFloat(e.y1)||0),En(e.x2)||(i.__x2=parseFloat(e.x2)||0),En(e.y2)||(i.__y2=parseFloat(e.y2)||0),Array.isArray(e.controlA)&&(i.__controlA=e.controlA),Array.isArray(e.controlB)&&(i.__controlB=e.controlB)),i}return l(C,[{key:"render",value:function(t,h,e){var i,r,n,a,o,s,u,l,c,f,d,p,_,v,y,g=J(K(C.prototype),"render",this).call(this,t,h,e),m=g.isDestroyed,b=g.cache,k=g.display,x=g.visibility,M=g.originX,w=g.originY,S=g.stroke,A=g.strokeWidth,E=g.strokeDasharrayStr,P=g.strokeLinecap,T=g.strokeLinejoin,R=g.strokeMiterlimit;m||"none"===k||"hidden"===x||b||(i=this.width,r=this.height,n=this.x1,a=this.y1,o=this.x2,s=this.y2,u=this.controlA,l=this.controlB,c=this.__cacheProps,f=this.isMulti,En(c.x1)&&(d=!0,c.x1=Pn(n,M,i,f)),En(c.x2)&&(d=!0,c.x2=Pn(o,M,i,f)),En(c.y1)&&(d=!0,c.y1=Pn(a,w,r,f)),En(c.y2)&&(d=!0,c.y2=Pn(s,w,r,f)),En(c.controlA)&&(d=!0,c.controlA=Tn(u,M,w,i,r,f)),En(c.controlB)&&(d=!0,c.controlB=Tn(l,M,w,i,r,f)),d&&t===we.SVG&&(_="",f?c.x1.forEach(function(t,e){var i=c.x2[e],r=c.y1[e],n=c.y2[e],a=c.controlA[e],o=c.controlB[e],s=Rn(a,o);_+=q.svgLine(t,r,i,n,a,o,s)}):(p=Rn(c.controlA,c.controlB),_=q.svgLine(c.x1,c.y1,c.x2,c.y2,c.controlA,c.controlB,p)),c.d=_),t===we.CANVAS?0<A&&(h.beginPath(),f?c.x1.forEach(function(t,e){var i=c.x2[e],r=c.y1[e],n=c.y2[e],a=c.controlA[e],o=c.controlB[e],s=Rn(a,o);q.canvasLine(h,t,r,i,n,a,o,s)}):(v=Rn(c.controlA,c.controlB),q.canvasLine(h,c.x1,c.y1,c.x2,c.y2,c.controlA,c.controlB,v)),h.stroke(),h.closePath()):t===we.SVG&&(y=[["d",c.d],["fill","none"],["stroke",S],["stroke-width",A]],this.__propsStrokeStyle(y,E,P,T,R),this.addGeom("path",y)))}},{key:"x1",get:function(){return this.getProps("x1")}},{key:"y1",get:function(){return this.getProps("y1")}},{key:"x2",get:function(){return this.getProps("x2")}},{key:"y2",get:function(){return this.getProps("y2")}},{key:"controlA",get:function(){return this.getProps("controlA")}},{key:"controlB",get:function(){return this.getProps("controlB")}}]),C}(),Ln=Ee.isNil;function On(t,e){return Array.isArray(e)&&e.length?e.concat(t):t}var Nn=function(){e(C,An);var r=f(C);function C(t,e){var i;return u(this,C),(i=r.call(this,t,e)).isMulti?(i.__points=[[]],i.__controls=[[]]):(i.__points=[],i.__controls=[]),Array.isArray(e.controls)&&(i.__controls=e.controls),Array.isArray(e.points)&&(i.__points=e.points),i}return l(C,[{key:"__getPoints",value:function(a,o,s,h,u,l){return u.map(function(t,e){if(!Array.isArray(t))return null;var i=t.length;if(l){if(0!==i&&2!==i&&4!==i)throw new Error("Control must have 0/2/4 coords: "+u)}else if(0!==i&&2!==i)throw new Error("Point must have 0/2 coords: "+u);for(var r=[],n=0;n<i;n++)n%2==0?r.push(a+t[n]*s):r.push(o+t[n]*h);return r})}},{key:"render",value:function(t,e,i){var r,n,a,o,s,h,u,l,c,f,d,p,_,v=this,y=J(K(C.prototype),"render",this).call(this,t,e,i),g=y.isDestroyed,m=y.cache,b=y.originX,k=y.originY,x=y.display,M=y.visibility,w=y.fill,S=y.stroke,A=y.strokeWidth,E=y.strokeDasharrayStr,P=y.strokeLinecap,T=y.strokeLinejoin,R=y.strokeMiterlimit;g||"none"===x||"hidden"===M||m||(r=this.width,n=this.height,a=this.points,o=this.controls,s=this.__cacheProps,h=this.isMulti,Ln(s.points)&&(s.points=h?a.map(function(t){return Array.isArray(t)?v.__getPoints(b,k,r,n,t):null}):this.__getPoints(b,k,r,n,a)),Ln(s.controls)&&(s.controls=h?o.map(function(t){return Array.isArray(t)?v.__getPoints(b,k,r,n,t,!0):t}):this.__getPoints(b,k,r,n,o,!0)),u=s.points,l=s.controls,h?(c=u.map(function(t,e){var i=l[e];if(Array.isArray(t))return t.map(function(t,e){return e?On(t,i&&i[e-1]):t})}),t===we.CANVAS?s.list=c:t===we.SVG&&(f="",c.forEach(function(t){return f+=q.svgPolygon(t)}),s.d=f)):(d=u.map(function(t,e){return e?On(t,l[e-1]):t}),t===we.CANVAS?s.list=d:t===we.SVG&&(s.d=q.svgPolygon(d))),t===we.CANVAS?(e.beginPath(),p=s.list,h?p.forEach(function(t){return q.canvasPolygon(e,t)}):q.canvasPolygon(e,p),e.fill(),0<A&&e.stroke(),e.closePath()):t===we.SVG&&(_=[["d",s.d],["fill",w],["stroke",S],["stroke-width",A]],this.__propsStrokeStyle(_,E,P,T,R),this.addGeom("path",_)))}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}}]),C}(),Dn=function(){e(s,Nn);var i=f(s);function s(t,e){return u(this,s),i.call(this,t,e)}return l(s,[{key:"__getPoints",value:function(t,e,i,r,n,a){var o=J(K(s.prototype),"__getPoints",this).call(this,t,e,i,r,n,a);return a||o.push(o[0]),o}}]),s}(),Fn=Ee.isNil;function In(t,e,i,r){return 0<=(r%=360)&&r<90?[t+Math.sin(r*Math.PI/180)*i,e-Math.cos(r*Math.PI/180)*i]:90<=r&&r<180?[t+Math.cos((r-90)*Math.PI/180)*i,e+Math.sin((r-90)*Math.PI/180)*i]:180<=r&&r<270?[t-Math.cos((270-r)*Math.PI/180)*i,e+Math.sin((270-r)*Math.PI/180)*i]:[t-Math.sin((360-r)*Math.PI/180)*i,e-Math.cos((360-r)*Math.PI/180)*i]}function Wn(t,e){return t=parseFloat(t),isNaN(t)&&(t=e),t}var Bn=function(){e(U,An);var r=f(U);function U(t,e){var i;return u(this,U),(i=r.call(this,t,e)).isMulti?(i.__begin=[0],i.__end=[0],i.__r=[1],Array.isArray(e.begin)&&(i.__begin=e.begin.map(function(t){return Wn(t,0)})),Array.isArray(e.end)&&(i.__end=e.end.map(function(t){return Wn(t,0)})),Array.isArray(e.r)&&(i.__r=e.r.map(function(t){return Wn(t,1)})),Array.isArray(e.edge)&&(i.__edge=e.edge.map(function(t){return!!t})),Array.isArray(e.closure)&&(i.__closure=e.closure.map(function(t){return!!t}))):(i.__begin=i.__end=0,i.__r=1,i.__edge=!1,i.__closure=!1,Fn(e.begin)||(i.__begin=Wn(e.begin,0)),Fn(e.end)||(i.__end=Wn(e.end,0)),Fn(e.r)||(i.__r=Wn(e.r,1)),Fn(e.edge)||(i.__edge=!!e.edge),Fn(e.closure)||(i.__closure=!!e.closure)),i}return l(U,[{key:"render",value:function(l,i,t){var c,e,r,n,f,a,d,o,s,h,p,u,_,v,y,g,m,b,k,x,M,w,S,A,E,P,T,R,C,L,O=this,N=J(K(U.prototype),"render",this).call(this,l,i,t),D=N.isDestroyed,F=N.cache,I=N.cx,W=N.cy,B=N.display,H=N.visibility,G=N.fill,$=N.stroke,X=N.strokeWidth,Y=N.strokeDasharrayStr,z=N.strokeLinecap,j=N.strokeLinejoin,V=N.strokeMiterlimit;D||"none"===B||"hidden"===H||F||(c=this.width,e=this.begin,r=this.end,n=this.r,f=this.edge,a=this.closure,d=this.__cacheProps,o=this.isMulti,Fn(d.begin)&&(s=!0,d.begin=e),Fn(d.end)&&(s=!0,d.end=r),Fn(d.r)&&(s=!0,d.r=o?n.map(function(t){return t*c*.5}):n*c*.5),Fn(d.edge)&&(s=!0,d.edge=f),Fn(d.closure)&&(s=!0,d.closure=a),s&&(h=d.begin,p=d.end,u=d.r,_=d.closure,o?(d.x1=[],d.x2=[],d.y1=[],d.y2=[],d.large=[],d.d=[],h.forEach(function(t,e){var i=Fn(i)?.5*c:i,r=xe(In(I,W,i,t),2),n=r[0],a=r[1],o=xe(In(I,W,i,p[e]||0),2),s=o[0],h=o[1],u=180<(p[e]||0)-t?1:0;d.x1.push(n),d.x2.push(s),d.y1.push(a),d.y2.push(h),d.large.push(u),l===we.SVG&&d.d.push(q.svgSector(I,W,i,n,a,s,h,X,u,f[e]||0,_[e]))})):(y=(v=xe(In(I,W,u,h),2))[0],g=v[1],b=(m=xe(In(I,W,u,p),2))[0],k=m[1],x=180<p-h?1:0,d.x1=y,d.x2=b,d.y1=g,d.y2=k,d.large=x,l===we.SVG&&(d.d=q.svgSector(I,W,u,y,g,b,k,X,x,f,_)))),l===we.CANVAS?(M=d.begin,w=d.end,S=d.r,A=d.x1,E=d.y1,P=d.x2,T=d.y2,R=d.edge,C=d.large,L=d.closure,i.beginPath(),o?M.forEach(function(t,e){return q.canvasSector(i,I,W,S[e],A[e],E[e],P[e],T[e],X,t[e],w[e],C[e],R[e],L[e])}):q.canvasSector(i,I,W,S,A,E,P,T,X,M,w,C,R,L),i.fill(),i.closePath()):l===we.SVG&&(o?d.d.map(function(t,e){return O.__genSector(d.edge[e],t,G,$,X,Y,z,j,V)}):this.__genSector(d.edge,d.d,G,$,X,Y,z,j,V)))}},{key:"__genSector",value:function(t,e,i,r,n,a,o,s,h){var u,l;t?(u=[["d",e[0]],["fill",i],["stroke",r],["stroke-width",n]],this.__propsStrokeStyle(u,a,o,s,h),this.addGeom("path",u)):(this.addGeom("path",[["d",e[0]],["fill",i]]),0<n&&(l=[["d",e[1]],["fill","none"],["stroke",r],["stroke-width",n]],this.__propsStrokeStyle(l,a,o,s,h),this.addGeom("path",l)))}},{key:"begin",get:function(){return this.getProps("begin")}},{key:"end",get:function(){return this.getProps("end")}},{key:"r",get:function(){return this.getProps("r")}},{key:"edge",get:function(){return this.getProps("edge")}},{key:"closure",get:function(){return this.getProps("closure")}}]),U}(),Hn=Ee.isNil;function Gn(t,e,i,r,n,a){var o=4<arguments.length&&void 0!==n?n:0,s=5<arguments.length&&void 0!==a?a:0;if(0===o||0===s)return[[t,e],[t+i,e],[t+i,e+r],[t,e+r],[t,e]];var h=o*Ae.H,u=s*Ae.H;return[[t+o,e],[t+i-o,e],[t+i+h-o,e,t+i,e+s-u,t+i,e+s],[t+i,e+r-s],[t+i,e+r+u-s,t+i+h-o,e+r,t+i-o,e+r],[t+o,e+r],[t+o-h,e+r,t,e+r+u-s,t,e+r-s],[t,e+s],[t,e+s-u,t+o-h,e,t+o,e]]}function $n(t){return t=parseFloat(t),isNaN(t)&&(t=0),t}var Xn=function(){e(C,An);var r=f(C);function C(t,e){var i;return u(this,C),(i=r.call(this,t,e)).isMulti?(i.__rx=[0],i.__ry=[0],Array.isArray(e.rx)&&(i.__rx=e.rx.map($n)),Array.isArray(e.ry)&&(i.__ry=e.ry.map($n))):(i.__rx=i.__ry=0,Hn(e.rx)||(i.__rx=$n(e.rx)),Hn(e.ry)||(i.__ry=$n(e.ry))),i}return l(C,[{key:"render",value:function(t,e,i){var r,n,a,o,s,h,u,l,c,f,d,p,_,v,y=J(K(C.prototype),"render",this).call(this,t,e,i),g=y.isDestroyed,m=y.cache,b=y.originX,k=y.originY,x=y.display,M=y.visibility,w=y.fill,S=y.stroke,A=y.strokeWidth,E=y.strokeDasharrayStr,P=y.strokeLinecap,T=y.strokeLinejoin,R=y.strokeMiterlimit;g||"none"===x||"hidden"===M||m||(r=this.width,n=this.height,a=this.rx,o=this.ry,s=this.__cacheProps,h=this.isMulti,Hn(s.rx)&&(u=!0,s.rx=h?a.map(function(t){return Math.min(t,.5)*r}):Math.min(a,.5)*r),Hn(s.ry)&&(u=!0,s.ry=h?a.map(function(t){return Math.min(t,.5)*n}):Math.min(o,.5)*n),u&&(l=s.rx,c=s.ry,h?(f=l.map(function(t,e){return Gn(b,k,r,n,t,c[e])}),t===we.CANVAS?s.list=f:t===we.SVG&&(d="",f.forEach(function(t){return d+=q.svgPolygon(t)}),s.d=d)):(p=Gn(b,k,r,n,l,c),t===we.CANVAS?s.list=p:t===we.SVG&&(s.d=q.svgPolygon(p)))),t===we.CANVAS?(_=s.list,e.beginPath(),h?_.forEach(function(t){return q.canvasPolygon(e,t)}):q.canvasPolygon(e,_),e.fill(),0<A&&e.stroke(),e.closePath()):t===we.SVG&&(v=[["d",s.d],["fill",w],["stroke",S],["stroke-width",A]],this.__propsStrokeStyle(v,E,P,T,R),this.addGeom("path",v)))}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}}]),C}(),Yn=Ee.isNil;function zn(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var jn=function(){e(S,An);var r=f(S);function S(t,e){var i;return u(this,S),(i=r.call(this,t,e)).isMulti?(i.__r=[1],Array.isArray(e.r)?i.__r=e.r.map(zn):Yn(e.r)||(i.__r=zn(e.r))):(i.__r=1,Yn(e.r)||(i.__r=zn(e.r))),i}return l(S,[{key:"render",value:function(t,e,i){var r,n,a,o,s,h,u,l,c=J(K(S.prototype),"render",this).call(this,t,e,i),f=c.isDestroyed,d=c.cache,p=c.cx,_=c.cy,v=c.display,y=c.visibility,g=c.fill,m=c.stroke,b=c.strokeWidth,k=c.strokeDasharrayStr,x=c.strokeLinecap,M=c.strokeLinejoin,w=c.strokeMiterlimit;f||"none"===v||"hidden"===y||d||(r=this.width,n=this.r,a=this.__cacheProps,o=this.isMulti,Yn(a.r)&&(o?(a.r=n.map(function(t){return t*r*.5}),s=a.r.map(function(t){return Ae.ellipsePoints(p,_,t)}),t===we.CANVAS?a.list=s:t===we.SVG&&(a.d="",s.forEach(function(t){return a.d+=q.svgPolygon(t)}))):(a.r=n*r*.5,h=Ae.ellipsePoints(p,_,a.r),t===we.CANVAS?a.list=h:t===we.SVG&&(a.d=q.svgPolygon(h)))),t===we.CANVAS?(u=a.list,e.beginPath(),o?u.forEach(function(t){return q.canvasPolygon(e,t)}):q.canvasPolygon(e,u),e.fill(),0<b&&e.stroke(),e.closePath()):t===we.SVG&&(l=[["d",a.d],["fill",g],["stroke",m],["stroke-width",b]],this.__propsStrokeStyle(l,k,x,M,w),this.addGeom("path",l)))}},{key:"r",get:function(){return this.getProps("r")}}]),S}(),Vn=Ee.isNil;function Un(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var qn=function(){e(R,An);var r=f(R);function R(t,e){var i;return u(this,R),(i=r.call(this,t,e)).isMulti?(i.__rx=[1],i.__ry=[1],Array.isArray(e.rx)?i.__rx=e.rx.map(Un):Vn(e.rx)||(i.__rx=[Un(e.rx)]),Array.isArray(e.ry)?i.__ry=e.ry.map(Un):Vn(e.ry)||(i.__ry=[Un(e.ry)])):(i.__rx=1,Vn(e.rx)||(i.__rx=Un(e.rx)),i.__ry=1,Vn(e.ry)||(i.__ry=Un(e.ry))),i}return l(R,[{key:"render",value:function(t,e,i){var r,n,a,o,s,h,u,l,c,f,d,p,_,v=J(K(R.prototype),"render",this).call(this,t,e,i),y=v.isDestroyed,g=v.cache,m=v.cx,b=v.cy,k=v.display,x=v.visibility,M=v.fill,w=v.stroke,S=v.strokeWidth,A=v.strokeDasharrayStr,E=v.strokeLinecap,P=v.strokeLinejoin,T=v.strokeMiterlimit;y||"none"===k||"hidden"===x||g||(r=this.width,n=this.height,a=this.rx,o=this.ry,s=this.__cacheProps,h=this.isMulti,Vn(s.rx)&&(u=!0,s.rx=h?a.map(function(t){return t*r*.5}):a*r*.5),Vn(s.ry)&&(u=!0,s.ry=h?o.map(function(t){return t*n*.5}):o*n*.5),u&&(l=s.rx,c=s.ry,h?(f=l.map(function(t,e){return Ae.ellipsePoints(m,b,t,c[e])}),t===we.CANVAS?s.list=f:t===we.SVG&&(s.d="",f.forEach(function(t){return s.d+=q.svgPolygon(t)}))):(d=Ae.ellipsePoints(m,b,l,c),t===we.CANVAS?s.list=d:t===we.SVG&&(s.d=q.svgPolygon(d)))),t===we.CANVAS?(p=s.list,e.beginPath(),h?p.forEach(function(t){return q.canvasPolygon(e,t)}):q.canvasPolygon(e,p),e.fill(),0<S&&e.stroke(),e.closePath()):t===we.SVG&&(_=[["d",s.d],["fill",M],["stroke",w],["stroke-width",S]],this.__propsStrokeStyle(_,A,E,P,T),this.addGeom("path",_)))}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}}]),R}(),Zn={skewX:"kx",skewY:"ky",transform:"tf",fontSize:"fz",offset:"os",easing:"e",filter:"ft",boxShadow:"bd"},Kn={os:"offset",e:"easing",ft:"filter",bd:"boxShadow"},Jn={value:"v",options:"o"},Qn={},ta={duration:"dt",delay:"d",endDelay:"ed",iterations:"i",direction:"dc",fill:"f",fps:"fp",playbackRate:"p",spfLimit:"sl"},ea={};pe.dom.concat(pe.geom).forEach(function(t){var e,i=t.k;Zn.hasOwnProperty(i)?Kn[Zn[i]]=i:(e=i.charAt(0)+i.replace(/[a-z]/g,"").toLowerCase(),Zn[i]=e,Kn[e]=i)}),Object.keys(Jn).forEach(function(t){Qn[Jn[t]]=t}),Object.keys(ta).forEach(function(t){ea[ta[t]]=t});var ia={fullCssProperty:Zn,abbrCssProperty:Kn,fullAnimate:Jn,abbrAnimate:Qn,fullAnimateOption:ta,abbrAnimateOption:ea},ra=m.TYPE_PL,na=m.TYPE_VD,aa=m.TYPE_GM,oa=m.TYPE_CP,sa=Ee.isNil,ha=Ee.isFunction,ua=Ee.isPrimitive,la=Ee.clone,ca=Ee.extend,fa=ia.abbrCssProperty,da=ia.abbrAnimateOption,pa=ia.abbrAnimate;function _a(n,a){n&&Object.keys(n).forEach(function(t){var e,i,r;0===t.indexOf("var-")?(e=t.slice(4),a.hasOwnProperty(e)&&(i=a[e],n["var-"+i]=n[t])):a.hasOwnProperty(t)&&(r=a[t],n[r]=n[t],delete n[t])})}function va(s,h){s&&h&&Object.keys(s).forEach(function(t){if(0===t.indexOf("var-")){var e=s[t];if(!e)return;var i=t.slice(4);if(e.id&&h.hasOwnProperty(e.id)){var r=h[e.id];if(-1<i.indexOf(".")){for(var n=i.split("."),a=n.length,o=0;o<a-1;o++)i=n[o],s[i]?s=s[i]:console.error("parseJson vars is not exist: "+e.id+", "+t+", "+n.slice(0,o).join("."));i=n[a-1]}ha(r)&&(r=r(e)),s[i]=r}}})}function ya(e,i){e.tagName=i.tagName,e.props=la(i.props),e.children=i.children,Object.keys(i).forEach(function(t){0!==t.indexOf("var-")||e.hasOwnProperty(t)||(e[t]=i[t])}),e.libraryId=null;var t,r,n=e.init;n&&(r=(t=e.props=e.props||{}).style,ca(t,n),r&&(ca(r,n.style),t.style=r),e.init=null)}function ga(i,t,r,n,e){var a=4<arguments.length&&void 0!==e?e:{};if(ua(t)||t instanceof M)return t;if(Array.isArray(t))return t.map(function(t){return ga(i,t,r,n,a)});var o=t.library,s=t.libraryId;if(Array.isArray(o))a={},o.forEach(function(t){!function(t,r){var e=t.id,i=t.children;if(Array.isArray(i)&&i.forEach(function(t){if(!ua(t)){var e=t.libraryId;if(sa(e))return;var i=r[e];if(!i)throw new Error("Link library item miss id: "+e);ya(t,i)}}),sa(e))throw new Error("Library item miss id: "+e);r[e]=t}(t,a)}),t.library=null,t.libraryId=null;else if(!sa(s)&&a){var h=a[s];if(!h)throw new Error("Link library miss id: "+s);ya(t,h)}var u=t.tagName,l=t.props,c=void 0===l?{}:l,f=t.children,d=void 0===f?[]:f,p=t.animate,_=void 0===p?[]:p,v=t.__animateRecords;if(!u)throw new Error("Dom must have a tagName: "+t);var y,g,m,b,k,x=c.style;return _a(x,fa),va(x,n),va(c,n),va(t,n),y="$"===u.charAt(0)?i.createGm(u,c):i.createVd(u,c,d.map(function(t,e){return t&&-1<[ra,na,aa,oa].indexOf(t.$$type)?t:ga(i,t,r,n,a)})),v&&(y.__animateRecords=v),_&&(Array.isArray(_)?(_.forEach(function(t){_a(t,pa);var e=t.value,i=t.options;Array.isArray(e)&&e.length&&(m=!0,e.forEach(function(t){_a(t,fa),va(t,n)})),i&&(_a(i,da),va(i,n))}),m&&(g={animate:_,target:y})):(_a(_,pa),b=_.value,k=_.options,Array.isArray(b)&&b.length&&(b.forEach(function(t){_a(t,fa),va(t,n)}),g={animate:_,target:y}),k&&(_a(k,da),va(k,n)))),g&&r.push(g),y}var ma={parse:function(t,e,i,r){var n=3<arguments.length&&void 0!==r?r:{};e=Ee.clone(e),He.isDom(i)||(n=i||{},i=null);var a=[],o=ga(t,e,a,n.vars);if(i){var s=e.tagName;if(-1===["canvas","svg"].indexOf(s))throw new Error("Parse dom must be canvas/svg");var h=n.controller instanceof cn?n.controller:o.animateController;t.render(o,i),a.forEach(function(t){t.target=t.target.vd}),!1!==n.autoPlay?(h.__auto=h.__auto.concat(a),h.__playAuto()):h.__records=h.__records.concat(a)}else a.length&&(o.__animateRecords={options:n,list:a,controller:n.controller instanceof cn?n.controller:null});return o},abbr:ia},ba={css:ae,reset:pe,unit:s},ka={Animation:Li,Controller:cn,easing:ri,frame:je,level:ni,repaint:Lt};An.register("$line",Cn),An.register("$polyline",Nn),An.register("$polygon",Dn),An.register("$sector",Bn),An.register("$rect",Xn),An.register("$circle",jn),An.register("$ellipse",qn);var xa={version:"0.37.6",render:function(t,e){if(!(t instanceof yn))throw new Error("Render dom must be canvas/svg");return e&&t.appendTo(e),t},createElement:function(t,e){e=e||{};for(var i=[],r=2,n=arguments.length;r<n;r++)i.push(arguments[r]);return Ee.isString(t)?"$"===t.charAt(0)?this.createGm(t,e):this.createVd(t,e,i):t?this.createCp(t,e,i):void 0},createVd:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:[];if(-1<["canvas","svg"].indexOf(t))return new yn(t,e,r);if(Er.isValid(t))return{tagName:t,props:e,children:r,$$type:m.TYPE_VD};throw new Error("Can not use <".concat(t,">"))},createGm:function(t,e){return{tagName:t,props:e,$$type:m.TYPE_GM}},createCp:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:[];return e.children=r,{klass:t,props:e,$$type:m.TYPE_CP}},parse:function(t,e,i){return ma.parse(this,t,e,i)},mode:we,Component:gr,Geom:An,Event:Le,util:Ee,inject:He,style:ba,parser:ma,animate:ka,math:g,builder:dr,updater:Vr};return dr.ref({Xom:nr,Dom:Er,Img:Cr,Geom:An,Component:gr}),Vr.ref({Xom:nr,Dom:Er,Img:Cr,Geom:An,Component:gr}),"undefined"!=typeof window&&(window.karas=xa),xa});
//# sourceMappingURL=index.min.js.map
