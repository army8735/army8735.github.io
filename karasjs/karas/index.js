!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).karas=e()}(this,function(){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e(a){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e,r,i,n=dt(a);return e=o?(t=dt(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),r=this,!(i=e)||"object"!=typeof i&&"function"!=typeof i?h(r):i}}function _t(t,e,r){return(_t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=dt(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw a}}return r}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var M=function(){function t(){l(this,t),this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__width=0,this.__height=0,this.__baseLine=0}return u(t,[{key:"__structure",value:function(t,e,r){return this.__struct={node:this,index:t,childIndex:r,lv:e}}},{key:"__modifyStruct",value:function(t,e){var r=1<arguments.length&&void 0!==e?e:0,i=this.__struct,n=this.__structure(i.index,i.lv,i.childIndex);return t.__structs.splice(i.index+r,1,n),[this.__struct,1]}},{key:"__offsetX",value:function(t,e){e?this.__x+=t:this.__ox+=t}},{key:"__offsetY",value:function(t,e){e?this.__y+=t:this.__oy+=t}},{key:"__destroy",value:function(){this.__isDestroyed=!0}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"sx",get:function(){return this.x+this.ox}},{key:"sy",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"domParent",get:function(){if(void 0!==this.__domParent)return this.__domParent;for(var t=this,e=this.root;t;){if(t===e){t=void 0;break}if(t.parent){t=t.parent;break}t.host&&(t=t.host)}return this.__domParent=t||null}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),t}(),fe={CANVAS:0,SVG:1},f={AUTO:0,PX:1,PERCENT:2,NUMBER:3,INHERIT:4,DEG:5,STRING:6,RGBA:7},d={arial:{lhr:1.14990234375,car:1.1171875,blr:.9052734375}},_={TYPE_VD:{_:1},TYPE_GM:{_:2},TYPE_CP:{_:3}};var de={identity:function(){return[1,0,0,1,0,0]},multiply:function(t,e){var r=1===t[0]&&0===t[1]&&0===t[2]&&1===t[3],i=1===e[0]&&0===e[1]&&0===e[2]&&1===e[3],n=0===t[4]&&0===t[5],a=0===e[4]&&0===e[5];if(r&&n)return e.slice(0);if(i&&a)return t.slice(0);if(r&&i)return(t=t.slice(0))[4]+=e[4],t[5]+=e[5],t;if(r||i){var o=r?e.slice(0):t.slice(0);return o[4]=t[0]*e[4]+t[2]*e[5]+t[4],o[5]=t[1]*e[4]+t[3]*e[5]+t[5],o}var s=[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],0,0];return n&&a||(a?(s[4]=t[4],s[5]=t[5]):(s[4]=t[0]*e[4]+t[2]*e[5]+t[4],s[5]=t[1]*e[4]+t[3]*e[5]+t[5])),s},calPoint:function(t,e){var r=ue(t,2),i=r[0],n=r[1],a=ue(e,6),o=a[0],s=a[1],h=a[2],l=a[3];return[o*i+h*n+a[4],s*i+l*n+a[5]]},int2convolution:function(t){var e=Math.floor(3*t*Math.sqrt(2*Math.PI)/4+.5);return(e*=3)%2==0&&e++,e},inverse:function(t){var e=ue(t,6),r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],s=e[5];if(1===r&&0===i&&0===n&&1===a&&0===o&&0===s)return t;var h,l,u=1,c=0,f=0,d=1,_=0,p=0;if(0===r)if(1===i)var v=[i,r,a,n,s,o,c,u,d,f,p,_],r=v[0],i=v[1],n=v[2],a=v[3],o=v[4],s=v[5],u=v[6],c=v[7],f=v[8],d=v[9],_=v[10],p=v[11];else{if(0===i)return[0,0,0,0,0,0];r=1,n+=n/i,o+=o/i,u+=u/i,f+=f/i,_+=_/i,i=0}return 0!==i&&(h=i/r,i=0,a-=n*h,s-=o*h,c-=u*h,d-=f*h,p-=_*h),1!==r&&(n/=r,o/=r,u/=r,f/=r,_/=r,r=1),0!==n&&(l=n/a,n=0,o-=s*l,u-=c*l,f-=d*l,_-=p*l),0===a?(s+=(a=1)-o,c+=1-u,d+=1-f,p+=1-_):1!==a&&(s/=a,c/=a,d/=a,p/=a,a=1),0!==o&&(_-=o,o=0),0!==s&&(p-=s,s=0),[u,c,f,d,_,p]}},p={}.toString;function v(e){return function(t){return p.call(t)==="[object "+e+"]"}}var y=v("Object"),g=v("String"),m=v("Function"),b=v("Number"),k=v("Boolean"),w=v("Date");function A(t){return null==t}function S(t){return A(t)?"":t.toString()}function E(t){if("item"===t.type||"img"===t.type){var e="";return(t.props||[]).forEach(function(t){e+=" "+t[0]+'="'+t[1]+'"'}),"text"===t.tagName?"<text"+e+">"+t.content+"</text>":"<"+t.tagName+e+"/>"}if("text"===t.type){var r="";return(t.children||[]).forEach(function(t){r+=E(t)}),"<g>"+r+"</g>"}if("dom"===t.type||"geom"===t.type){var i="<g";t.bbClip&&(i+=' clip-path="'+t.bbClip+'"'),i+=">",t.bb.forEach(function(t){i+=E(t)}),i+="</g><g",t.conClip&&(i+=' clip-path="'+t.conClip+'"'),i+=">",(t.children||[]).forEach(function(t){t.isMask||t.isClip||(i+=E(t))}),i+="</g>";var n=t.opacity,a=t.transform,o=t.visibility,s=t.mask,h=t.clip,l=t.filter;return"<g"+(1!==n&&void 0!==n?' opacity="'+n+'"':"")+(a?' transform="'+a+'"':"")+' visibility="'+o+'"'+(s?' mask="'+s+'"':"")+(h?' clip-path="'+h+'"':"")+(l?' filter="'+l+'"':"")+">"+i+"</g>"}}function T(t){var i="<"+t.tagName+' id="'+t.uuid+'"';return"mask"===t.tagName||"clipPath"===t.tagName||"filter"===t.tagName||(i+=' gradientUnits="userSpaceOnUse"'),(t.props||[]).forEach(function(t){i+=" "+t[0]+'="'+t[1]+'"'}),i+=">",(t.children||[]).forEach(function(t){var e,r;i+=(r="<"+(e=t).tagName,(e.props||[]).forEach(function(t){r+=" "+t[0]+'="'+t[1]+'"'}),r+="></"+e.tagName+">")}),i+="</"+t.tagName+">"}function P(t,e){if(!t||!e)return t===e;if(t.length!==e.length)return!1;for(var r=0,i=t.length;r<i;r++){var n=t[r],a=e[r],o=Array.isArray(n),s=Array.isArray(a);if(o&&s){if(!P(n,a))return!1}else{if(o||s)return!1;if(n!==a)return!1}}return!0}function R(t,e){for(var r=t.length?t[0]:"",i=1,n=t.length;i<n;i++)r+=e+t[i];return r}var _e={isObject:y,isString:g,isFunction:m,isNumber:b,isBoolean:k,isDate:w,isNil:A,isPrimitive:function(t){return _e.isNil(t)||_e.isBoolean(t)||_e.isString(t)||_e.isNumber(t)},isAuto:function(t){return A(t)||"auto"===t},stringify:S,joinSourceArray:function t(e){for(var r="",i=0,n=e.length;i<n;i++){var a=e[i];Array.isArray(a)?r+=t(a):r+=S(a)}return r},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},joinVirtualDom:function(t){var e="<defs>";return t.defs.forEach(function(t){e+=T(t)}),e+="</defs><g",t.bbClip&&(e+=' clip-path="'+t.bbClip+'"'),e+=">",t.bb.forEach(function(t){e+=E(t)}),e+="</g><g",t.conClip&&(e+=' clip-path="'+t.conClip+'"'),e+=">",(t.children||[]).forEach(function(t){t.isMask||t.isClip||(e+=E(t))}),e+="</g>"},joinVd:E,joinDef:T,rgba2int:function(t){if(Array.isArray(t))return t;var e,r=[];return t&&"transparent"!==t?"#"===t.charAt(0)?(3===(t=t.slice(1)).length?(r.push(parseInt(t.charAt(0)+t.charAt(0),16)),r.push(parseInt(t.charAt(1)+t.charAt(1),16)),r.push(parseInt(t.charAt(2)+t.charAt(2),16))):6===t.length?(r.push(parseInt(t.slice(0,2),16)),r.push(parseInt(t.slice(2,4),16)),r.push(parseInt(t.slice(4),16))):r[0]=r[1]=r[2]=0,r[3]=1):(e=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\s*\)/i))?(r=[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])],A(e[4])?r[3]=1:r[3]=parseFloat(e[4])):r=[0,0,0,0]:r=[0,0,0,0],r},int2rgba:function(t){if(Array.isArray(t)){if(4===t.length)return"rgba("+R(t,",")+")";if(3===t.length)return"rgba("+R(t,",")+",1)"}return t||"rgba(0,0,0,0)"},arr2hash:function(t){for(var e={},r=0,i=t.length;r<i;r++){var n=t[r];if(Array.isArray(n))e[n[0]]=n[1];else for(var a=Object.keys(n),o=a.length-1;0<=o;o--){var s=a[o];e[s]=n[s]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],r=Object.keys(t),i=0,n=r.length;i<n;i++){var a=r[i];e.push([a,t[a]])}return e},clone:function e(r){if(A(r)||"object"!==o(r))return r;if(r.$$type===_.TYPE_VD||r.$$type===_.TYPE_GM||r.$$type===_.TYPE_CP)return r;if(_e.isDate(r))return new Date(r);var i=Array.isArray(r)?[]:{};return Object.keys(r).forEach(function(t){i[t]=e(r[t])}),i},equalArr:P,equal:function t(e,r){if(e===r)return!0;if(y(e)&&y(r)){for(var i={},n=0,a=Object.keys(e),o=a.length;n<o;n++){var s=a[n];if(!r.hasOwnProperty(s)||!t(e[s],r[s]))return!1;i[s]=!0}for(var h=0,l=Object.keys(r),u=l.length;h<u;h++){var c=l[h];if(!i.hasOwnProperty(c))return!1}}else{if(w(e)&&w(r))return e.getTime()===r.getTime();if(!Array.isArray(e)||!Array.isArray(r))return e===r;if(e.length!==r.length)return!1;for(var f=0,d=e.length;f<d;f++)if(!t(e[f],r[f]))return!1}return!0},extend:function(t,e,r){if(null===e||"object"!==o(e))return t;for(var i=0,n=(r=r||Object.keys(e)).length;i<n;){var a=r[i];t[a]=e[a],i++}return t},joinArr:R,extendAnimate:function(t,e){(e.__animationList=t.animationList.splice(0)).forEach(function(t){t.__target=e,(t.assigning||t.finished&&t.__stayEnd())&&t.assignCurrentStyle()})},transformBbox:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!P(e,[1,0,0,1,0,0])){var n=ue(t,4),a=n[0],o=n[1],s=n[2],h=n[3];r&&(a-=r,s+=r),i&&(o-=i,h+=i);for(var l=[s,o,a,h,s,h],u=ue(de.calPoint([a,o],e),2),c=a=u[0],f=o=u[1],d=a,_=o,p=0;p<6;p+=2)var v=l[p],y=l[p+1],g=ue(de.calPoint([v,y],e),2),v=g[0],y=g[1],c=Math.min(c,v),d=Math.max(c,v),f=Math.min(f,y),_=Math.max(_,y);t=[c,f,d,_]}return t}},C={position:/((-?[\d.]+(px|%)?)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-gradient\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i},O=4*(Math.sqrt(2)-1)/3;function L(t,e,r,i){return t*i-r*e}function F(t,e,r,i){return Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2))}function N(t,e){var r=ue(t,4),i=r[0],n=r[1],a=r[2],o=r[3],s=ue(e,4),h=s[0],l=s[1],u=s[2],c=s[3];return!(u<=i||c<=n||a<=h||o<=l)}function I(t,e,r){var i=r.matrix,n=void 0===i?[1,0,0,1,0,0]:i,a=r.computedStyle,o=void 0===a?{}:a,s=o.width,h=o.height,l=o.transformOrigin,u=ue(l=void 0===l?[.5*s,.5*h]:l,2),c=u[0],f=u[1],d=ue(de.calPoint([t*s-c,e*h-f],n),2);return[(t=d[0])+c,(e=d[1])+f]}function B(t){var r=t.length,e=t.reduce(function(t,e){return Math.pow(t,r)+Math.pow(e,r)});return Math.pow(e,1/r)}function D(t,e,r){var i=t,n=(2*e+r)/3,a=(e+2*r)/3;return(i(e)+3*i(n)+3*i(a)+i(r))*(r-e)/8}function W(e,r){return function t(e,r,i,n){var a=3<arguments.length&&void 0!==n?n:.001,o=e,s=(r+i)/2,h=D(o,r,i),l=D(o,r,s),u=D(o,s,i),c=l+u-h;return Math.abs(c)<=15*a?l+u+c/15:t(o,r,s,a/2)+t(o,s,i,a/2)}(function(t){return B(G(t,e,r))},2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1)}function G(t,e,r,i){var n=3<arguments.length&&void 0!==i?i:1;return 2===r?function(t,e,r){var i=2<arguments.length&&void 0!==r?r:1,n=ue(e,3),a=n[0],o=n[1],s=n[2],h=ue(a,2),l=h[0],u=h[1],c=ue(o,2),f=c[0],d=c[1],_=ue(s,2),p=_[0],v=_[1],y=0,g=0,g=0===i?(y=Math.pow(1-t,2)*l+2*t*(1-t)*f+Math.pow(t,2)*p,Math.pow(1-t,2)*u+2*t*(1-t)*d+Math.pow(t,2)*v):1===i?(y=2*(1-t)*(f-l)+2*t*(p-f),2*(1-t)*(d-u)+2*t*(v-d)):2===i?(y=2*(p-2*f+l),2*(v-2*d+u)):y=0;return[y,g]}(t,e,n):3===r?function(t,e,r){var i=2<arguments.length&&void 0!==r?r:1,n=ue(e,4),a=n[0],o=n[1],s=n[2],h=n[3],l=ue(a,2),u=l[0],c=l[1],f=ue(o,2),d=f[0],_=f[1],p=ue(s,2),v=p[0],y=p[1],g=ue(h,2),m=g[0],b=g[1],x=0,k=0,k=0===i?(x=Math.pow(1-t,3)*u+3*t*Math.pow(1-t,2)*d+3*(1-t)*Math.pow(t,2)*v+Math.pow(t,3)*m,Math.pow(1-t,3)*c+3*t*Math.pow(1-t,2)*_+3*(1-t)*Math.pow(t,2)*y+Math.pow(t,3)*b):1===i?(x=3*((1-t)*(1-t)*(d-u)+2*(1-t)*t*(v-d)+t*t*(m-v)),3*((1-t)*(1-t)*(_-c)+2*(1-t)*t*(y-_)+t*t*(b-y))):2===i?(x=6*(v-2*d+u)*(1-t)+6*(m-2*v+d)*t,6*(y-2*_+c)*(1-t)+6*(b-2*y+_)*t):3===i?(x=6*(m-3*v+3*d-u),6*(b-3*y+3*_-c)):x=0;return[x,k]}(t,e,n):void 0}function H(e,r,t){for(var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:.001,o=function(t){return B(G(t,e,r))},s=t*i,h=i,l=h,u=0;u<n;u++){var c=D(o,0,h)-s;if(Math.abs(c)<a)break;var f=B(G(h,e,r,1));if(h-=c*f/(c*B(G(h,e,r,2))+f*f),Math.abs(h-l)<a)break;l=h}return G(h,e,r,0)}function z(t,e){var r=ue(t,4),i=ue(r[0],2),n=i[0],a=i[1],o=ue(r[1],2),s=o[0],h=o[1],l=ue(r[2],2),u=l[0],c=l[1],f=r[3],d=(s-n)*e+n,_=(h-a)*e+a,p=(u-s)*e+s,v=(c-h)*e+h,y=(p-d)*e+d,g=(v-_)*e+_;if(4===t.length){var m=ue(f,2);return[[n,a],[d,_],[y,g],[(((m[0]-u)*e+u-p)*e+p-y)*e+y,(((m[1]-c)*e+c-v)*e+v-g)*e+g]]}if(3===t.length)return[[n,a],[d,_],[y,g]]}var pe={vectorProduct:L,pointInPolygon:function(t,e,r){for(var i=ue(r[0],2),n=i[0],a=i[1],o=ue(r[0],2),s=o[0],h=o[1],l=r.length,u=1;u<l;u++)var c=ue(r[u],2),f=c[0],d=c[1],n=Math.max(n,f),a=Math.max(a,d),s=Math.min(s,f),h=Math.min(h,d);if(t<s||e<h||n<t||a<e)return!1;for(var _=0,p=r.length;_<p;_++){var v=ue(r[_],2),y=v[0],g=v[1],m=ue(r[(_+1)%p],2);if(L(m[0]-y,m[1]-g,t-y,e-g)<0)return!1}return!0},d2r:function(t){return t*Math.PI/180},r2d:function(t){return 180*t/Math.PI},H:O,h:function(t){return t*=.5,(1-Math.cos(t))/Math.sin(t)*4/3},angleBySide:function(t,e,r){var i=(Math.pow(e,2)+Math.pow(r,2)-Math.pow(t,2))/(2*e*r);return Math.acos(i)},pointsDistance:F,triangleIncentre:function(t,e,r,i,n,a){var o=F(r,i,n,a),s=F(t,e,n,a),h=F(t,e,r,i);return[(o*t+s*r+h*n)/(o+s+h),(o*e+s*i+h*a)/(o+s+h)]},ellipsePoints:function(t,e,r){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:r,n=r*O,a=i===r?n:i*O;return[[t-r,e],[t-r,e-a,t-n,e-i,t,e-i],[t+n,e-i,t+r,e-a,t+r,e],[t+r,e+a,t+n,e+i,t,e+i],[t-n,e+i,t-r,e+a,t-r,e]]},getRectsIntersection:function(t,e){if(!N(t,e))return null;var r=ue(t,4),i=r[0],n=r[1],a=r[2],o=r[3],s=ue(e,4),h=s[0],l=s[1],u=s[2],c=s[3];return[Math.max(i,h),Math.max(n,l),Math.min(a,u),Math.min(o,c)]},isRectsOverlap:N,isRectsInside:function(t,e){var r=ue(t,4),i=r[0],n=r[1],a=r[2],o=r[3],s=ue(e,4),h=s[0],l=s[1],u=s[2],c=s[3];return i<=h&&n<=l&&u<=a&&c<=o},calCoordsInNode:I,calPercentInNode:function(t,e,r){var i,n=r.computedStyle,a=n.width,o=n.height,s=ue(n.transformOrigin,2),h=s[0],l=s[1],u=Math.atan((o-l)/(a-h)),c=ue(I(1,1,r),2),f=c[0],d=c[1],_=h<=f&&l<=d?(i=h===f?-Math.atan(1/0):Math.atan((d-l)/(f-h)))-u:h<=f&&d<l?(i=h===f?-Math.atan(1/0):Math.atan((l-d)/(f-h)))+u:f<h&&l<=d?(i=Math.atan((d-l)/(h-f)))-u:f<h&&d<l?(i=Math.atan((d-l)/(f-h)))<=u?i+Math.PI-u:-(_=Math.PI-i+u):0,p=Math.sqrt(Math.pow(t-h,2)+Math.pow(e-l,2)),v=h<=t&&l<=e?h===t?-Math.atan(1/0):Math.atan((e-l)/(t-h)):h<=t&&e<l?h===t?-Math.atan(1/0):-Math.atan((e-l)/(h-t)):t<h&&l<=e?Math.PI-Math.atan((e-l)/(h-t)):Math.atan((e-l)/(t-h))-Math.PI;return(v-=_)>Math.PI?(v-=Math.PI,[(h-p*Math.cos(v))/a,(l-p*Math.sin(v))/o]):v>.5*Math.PI?(v=Math.PI-v,[(h-p*Math.cos(v))/a,(l+p*Math.sin(v))/o]):0<=v?[(h+p*Math.cos(v))/a,(l+p*Math.sin(v))/o]:v>=.5*-Math.PI?(v=-v,[(h+p*Math.cos(v))/a,(l-p*Math.sin(v))/o]):v>=-Math.PI?(v=Math.PI+v,[(h-p*Math.cos(v))/a,(l-p*Math.sin(v))/o]):(v=-Math.PI-v,[(h-p*Math.cos(v))/a,(l+p*Math.sin(v))/o])},bboxBezier:function(t,e,r,i,n,a,o,s){return 4===arguments.length?[t,e,r,i]:6===arguments.length?(h=t,l=e,u=r,c=i,f=n,d=a,b=Math.min(h,f),k=Math.min(l,d),M=Math.max(h,f),w=Math.max(l,d),(u<b||c<k||M<u||w<c)&&(g=(v=1-(_=(h-u)/(h-2*u+f)))*v*h+2*v*_*u+_*_*f,m=(y=1-(p=(l-c)/(l-x*c+d)))*y*l+2*y*p*c+p*p*d,b=Math.min(b,g),k=Math.min(k,m),M=Math.min(M,g),w=Math.min(w,m)),[b,k,M,w]):8===arguments.length?(A=t,S=e,E=r,T=i,P=n,R=a,C=o,O=s,U=Math.min(A,C),Z=Math.min(S,O),K=Math.max(A,C),J=Math.max(S,O),(E<U||T<Z||K<E||J<T||P<U||R<Z||K<P||J<R)&&(D=(F=S-2*T+R)*F-(I=3*T-S-3*R+O)*(-S+T),0<(B=(L=A-2*E+P)*L-(N=3*E-A-3*P+C)*(-A+E))&&(0<(W=(-L-(B=Math.sqrt(B)))/N)&&W<1&&(H=(G=1-W)*G*G*A+3*G*G*W*E+3*G*W*W*P+W*W*W*C,U=Math.min(U,H),K=Math.max(K,H)),0<(W=(-L+B)/N)&&W<1&&(Y=(z=1-W)*z*z*A+3*z*z*W*E+3*z*W*W*P+W*W*W*C,U=Math.min(U,Y),K=Math.max(K,Y))),0<D&&(0<(X=(-F-(D=Math.sqrt(D)))/I)&&X<1&&(j=($=1-X)*$*$*S+3*$*$*X*T+3*$*X*X*R+X*X*X*O,Z=Math.min(Z,j),J=Math.max(J,j)),0<(X=(-F+D)/I)&&X<1&&(q=(V=1-X)*V*V*S+3*V*V*X*T+3*V*X*X*R+X*X*X*O,Z=Math.min(Z,q),J=Math.max(J,q)))),[U,Z,K,J]):void 0;var h,l,u,c,f,d,_,p,v,y,g,m,b,k,M,w,A,S,E,T,P,R,C,O,L,F,N,I,B,D,W,G,H,z,Y,X,$,j,V,q,U,Z,K,J},bezierLength:W,pointAtBezier:function(t,e,r,i,n){return H(t,e,W(t,e,0,1),r,i,n)},pointAtBezierWithLength:H,sliceBezier:z,sliceBezier2Both:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e=Math.max(e,0),r=Math.min(r,1);return 0===e&&1===r||(r<1&&(t=z(t,r)),0<e&&(r<1&&(e/=r),t=z(t.reverse(),1-e).reverse())),t}},te=_e.rgba2int,ee=_e.int2rgba,Y=_e.isNil,X=f.PX,re=f.PERCENT,$=pe.d2r;function j(t){if(/%$/.test(t)||/px$/.test(t)||/^-?[\d.]+$/.test(t))return{value:parseFloat(t),unit:/%/.test(t)?re:X};var e={value:{top:0,left:0,center:50,right:100,bottom:100}[t],unit:re};return Y(e.value)&&(e.value=50),e}function V(t,e){for(var r,i=[],n=0,a=t.length;n<a;n++){var o,s,h=t[n];1<h.length?(o=ee(h[0]),(s=h[1]).unit===re?i.push([o,.01*s.value]):i.push([o,s.value/e])):i.push([ee(h[0])])}1===i[0].length&&i[0].push(0),1<i.length&&(1===i[r=i.length-1].length&&i[r].push(1));for(var l=i[0][1],u=1,c=i.length;u<c-1;u++){var f=i[u];if(1<f.length)l=f[1];else{for(var d=u+1,_=i[i.length-1][1];d<c-1;d++){var p=i[d];if(1<p.length){_=p[1];break}}for(var v=(_-l)/(d-u+1),y=u;y<d;y++){i[y].push(l+v*(y+1-u))}u=d}}for(var g=1,m=i.length;g<m;g++){var b=i[g],x=i[g-1];b[1]<x[1]&&(b[1]=x[1])}for(var k=0,M=i.length;k<M-1;k++){if(1<i[k][1]){i.splice(k+1);break}}for(var w=i.length-1;0<w;w--){if(i[w][1]<0){i.splice(0,w);break}}var A,S,E,T,P,R,C,O,L,F,N,I,B,D,W,G,H,z,Y,X,$,j,V,q,U,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht,lt,ut,ct,ft,dt,_t,pt,vt,yt,gt,mt,bt,xt,kt,Mt,wt,At,St,Et,Tt,Pt,Rt,Ct,Ot,Lt,Ft,Nt,It,Bt,Dt,Wt=i.length;if(1===Wt)i[0][1]=0;else{for(var Gt,Ht,zt,Yt,Xt,$t,jt,Vt,qt,Ut,Zt=!0,Kt=!0,Jt=Wt-1;0<=Jt;Jt--){var Qt=i[Jt][1];0<Qt&&(Zt=!1),Qt<1&&(Kt=!1)}Zt?(i.splice(0,Wt-1),i[0][1]=0):Kt?(i.splice(1),i[0][1]=0):(Gt=i[0],Ht=i[Wt-1],2===Wt?Gt[1]<0&&1<Ht[1]&&(vt=Ht,yt=e,gt=te((pt=Gt)[0]),mt=te(vt[0]),bt=ue(gt,4),xt=bt[0],kt=bt[1],Mt=bt[2],wt=bt[3],At=void 0===wt?1:wt,St=ue(mt,4),Et=St[0],Tt=St[1],Pt=St[2],Rt=St[3],Ct=void 0===Rt?1:Rt,Ot=Math.abs(pt[1])*yt,Lt=vt[1]*yt,Ft=Ot/(Ot+Lt),Nt=Math.floor(xt+(Et-xt)*Ft),It=Math.floor(kt+(Tt-kt)*Ft),Bt=Math.floor(Mt+(Pt-Mt)*Ft),Dt=At+(Ct-At)*Ft,pt[0]="rgba("+Nt+","+It+","+Bt+","+Dt+")",pt[1]=0,Ft=(yt+Ot)/(Ot+Lt),Nt=Math.floor(xt+(Et-xt)*Ft),It=Math.floor(kt+(Tt-kt)*Ft),Bt=Math.floor(Mt+(Pt-Mt)*Ft),Dt=At+(Ct-At)*Ft,vt[0]="rgba("+Nt+","+It+","+Bt+","+Dt+")",vt[1]=1):(Gt[1]<0&&(zt=i[1],Yt=te(Gt[0]),Xt=te(zt[0]),V=Yt,q=Gt[1],U=Xt,Z=zt[1],K=e,J=ue(V,4),Q=J[0],tt=J[1],et=J[2],rt=J[3],it=void 0===rt?1:rt,nt=ue(U,4),at=nt[0],ot=nt[1],st=nt[2],ht=nt[3],lt=void 0===ht?1:ht,ut=Math.abs(q)*K,ct=ut/(Z*K+ut),ft=Math.floor(Q+(at-Q)*ct),dt=Math.floor(tt+(ot-tt)*ct),_t=Math.floor(et+(st-et)*ct),$t=[ft,dt,_t,it+(lt-it)*ct],Gt[0]="rgba("+$t[0]+","+$t[1]+","+$t[2]+","+$t[3]+")",Gt[1]=0),1<Ht[1]&&(jt=i[Wt-2],Vt=te(jt[0]),qt=te(Ht[0]),A=Vt,S=jt[1],E=qt,T=Ht[1],P=e,R=ue(A,4),C=R[0],O=R[1],L=R[2],F=R[3],N=void 0===F?1:F,I=ue(E,4),B=I[0],D=I[1],W=I[2],G=I[3],H=void 0===G?1:G,Y=(P-(z=S*P))/(T*P-z),X=Math.floor(C+(B-C)*Y),$=Math.floor(O+(D-O)*Y),j=Math.floor(L+(W-L)*Y),Ut=[X,$,j,N+(H-N)*Y],Ht[0]="rgba("+Ut[0]+","+Ut[1]+","+Ut[2]+","+Ut[3]+")",Ht[1]=1)))}return i.forEach(function(t){t[1]<0?t[1]=0:1<t[1]&&(t[1]=1)}),i}var q={parseGradient:function(t){var e,r,i,n=C.gradient.exec(t);if(n){var a,o,s,h,l,u={k:n[1]};"linear"===u.k?(a=/(-?[\d.]+deg)|(to\s+[toprighbml]+)/i.exec(n[2]),u.d=a?(e=a[0].toLowerCase(),i=180,"to top"===e?i=0:"to top right"===e?i=45:"to right"===e?i=90:"to bottom right"===e?i=135:"to bottom"===e||("to bottom left"===e?i=225:"to left"===e?i=270:"to top left"===e?i=315:(r=/(-?[\d.]+)deg/.exec(e))&&(i=parseFloat(r[1]))),i%360):180):"radial"===u.k&&(u.s=-1<n[2].indexOf("ellipse")?"ellipse":"circle",o=/(closest|farthest)-(side|corner)/i.exec(n[2]),u.z=o?o[0].toLowerCase():"farthest-corner",(s=/at\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center))(?:\s+((?:-?[\d.]+(?:px|%)?)|(?:left|top|right|bottom|center)))?/i.exec(n[2]))?(h=j(s[1]),l=s[2]?j(s[2]):h,u.p=[h,l]):u.p=[{value:50,unit:re},{value:50,unit:re}]);var c=n[2].match(/((#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*(-?[\d.]+(px|%))?/gi);return u.v=c.map(function(t){var e=/((?:#[0-9a-f]{3,6})|(?:rgba?\(.+?\)))\s*(-?[\d.]+(?:px|%))?/i.exec(t),r=[te(e[1])];return e[2]&&(r[1]={value:parseFloat(e[2])},/%$/.test(e[2])?r[1].unit=re:r[1].unit=X),r}),u}},getLinear:function(t,e,r,i,n,a){var o,s,h,l,u,c,f,d,_,p,v,y,g=$(e),m=Math.abs(n*Math.sin(g))+Math.abs(a*Math.cos(g)),b=ue((s=.5*m,h=r,l=i,_=270<=(o=e)?(u=$(360-o),c=h+Math.sin(u)*s,f=l+Math.cos(u)*s,d=h-Math.sin(u)*s,l-Math.cos(u)*s):180<=o?(p=$(o-180),c=h+Math.sin(p)*s,f=l-Math.cos(p)*s,d=h-Math.sin(p)*s,l+Math.cos(p)*s):90<=o?(v=$(180-o),c=h-Math.sin(v)*s,f=l-Math.cos(v)*s,d=h+Math.sin(v)*s,l+Math.cos(v)*s):(y=$(o),c=h-Math.sin(y)*s,f=l+Math.cos(y)*s,d=h+Math.sin(y)*s,l-Math.cos(y)*s),[c,f,d,_]),4);return{x1:b[0],y1:b[1],x2:b[2],y2:b[3],stop:V(t,m)}},getRadial:function(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v,y,g,m,b,x,k,M,w,A,S,E=o-n,T=s-a,P=ue((h=r,u=E,c=T,f=n,d=a,_=o,p=s,w=(l=i)[0].unit===X?f+l[0].value:f+l[0].value*u*.01,A=l[1].unit===X?d+l[1].value:d+l[1].value*c*.01,["closest-side"===h?w<=f||_<=w||A<=d||p<=A?0:(v=w<f+.5*u?w-f:_-w,y=A<d+.5*c?A-d:p-A,Math.min(v,y)):"closest-corner"===h?(g=w<f+.5*u?w-f:_-w,m=A<d+.5*c?A-d:p-A,Math.sqrt(Math.pow(g,2)+Math.pow(m,2))):"farthest-side"===h?w<=f?f-w+u:_<=w?w-_+u:A<=d?d-A+c:p<=w?A-p+c:(b=Math.max(_-w,w-f),x=Math.max(p-A,A-d),Math.max(b,x)):(k=w<f+.5*u?_-w:w-f,M=A<d+.5*c?p-A:A-d,Math.sqrt(Math.pow(k,2)+Math.pow(M,2))),w,A]),3),R=P[0],C=P[1],O=P[2],L=V(t,2*R);return R<=0&&((S=L[L.length-1])[1]=0,L=[S],C=n,O=a,R=E+T),{cx:C,cy:O,r:R,stop:L}}},U={position:"static",display:"block",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:"inherit",fontFamily:"inherit",color:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"normal",backgroundImage:null,backgroundColor:"transparent",backgroundSize:"auto",backgroundRepeat:"repeat",backgroundPositionX:0,backgroundPositionY:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"#000",borderRightColor:"#000",borderBottomColor:"#000",borderLeftColor:"#000",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",borderLeftStyle:"solid",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0,width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",alignSelf:"auto",textAlign:"inherit",transformOrigin:"center",visibility:"inherit",opacity:1,zIndex:0,transform:null,translateX:0,translateY:0,scaleX:1,scaleY:1,skewX:0,skewY:0,rotateZ:0,filter:null,boxShadow:null,pointerEvents:"inherit"},Z={fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:4,fillRule:"nonzero"},K=[],J=[];Object.keys(U).forEach(function(t){J.push(t);var e=U[t];K.push({k:t,v:e})});var Q=[],tt=[];Object.keys(Z).forEach(function(t){tt.push(t);var e=Z[t];Q.push({k:t,v:e})});var et={fontFamily:"arial",fontSize:16,fontWeight:400,fontStyle:"normal",color:"#000",textAlign:"left",visibility:"visible",pointerEvents:"auto"},rt=[];Object.keys(et).forEach(function(t){rt.push(t)});var it={DOM:U,GEOM:Z,isValid:function(t){return U.hasOwnProperty(t)||Z.hasOwnProperty(t)},DOM_KEY_SET:J,GEOM_KEY_SET:tt,DOM_ENTRY_SET:K,GEOM_ENTRY_SET:Q,INHERIT:et,INHERIT_KEY_SET:rt},nt=_e.isNil;function at(t,e,r,i){nt(t.flexGrow)&&(t.flexGrow=e||0),nt(t.flexShrink)&&(t.flexShrink=r||0),nt(t.flexBasis)&&(t.flexBasis=i||0)}var ot={margin:["marginTop","marginRight","marginBottom","marginLeft"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"],border:["borderTop","borderRight","borderBottom","borderLeft"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderWidth:["borderWidthTop","borderWidthRight","borderWidthBottom","borderWidthLeft"],borderColor:["borderColorTop","borderColorRight","borderColorBottom","borderColorLeft"],borderStyle:["borderStyleTop","borderStyleRight","borderStyleBottom","borderStyleLeft"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],background:["backgroundColor","backgroundImage","backgroundRepeat","backgroundPosition"],backgroundRepeat:["backgroundRepeatX","backgroundRepeatY"],backgroundPosition:["backgroundPositionX","backgroundPositionY"],flex:["flexGrow","flexShrink","flexBasis"],translate:["translateX","translateY"],scale:["scaleX","scaleY"],rotate:["rotateZ"],skew:["skewX","skewY"],toFull:function(r,t){var e,i,n,a,o,s,h,l,u,c,f,d,_,p,v,y,g,m,b,x=r[t];if("background"===t)nt(r.backgroundImage)&&((e=C.gradient.exec(x))?(r.backgroundImage=e[0],x=x.replace(e[0],"")):(i=C.img.exec(x))&&(r.backgroundImage=i[0],x=x.replace(i[0],""))),!nt(r.backgroundRepeat)||(n=/(no-)?repeat(-[xy])?/i.exec(x))&&(r.backgroundRepeat=n[0].toLowerCase(),this.toFull(r,"backgroundRepeat")),!nt(r.backgroundColor)||(a=/^(transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\))/i.exec(x))&&(r.backgroundColor=a[0],x=x.replace(a[0],"")),!nt(r.backgroundPosition)||(o=x.match(C.position))&&(r.backgroundPosition=o.join(" "),this.toFull(r,"backgroundPosition"));else if("flex"===t){"none"===x?at(r,0,0,"auto"):"auto"===x?at(r,1,1,"auto"):/^[\d.]+$/.test(x)?at(r,Math.max(0,parseFloat(x)),1,0):/^[\d.]+px$/i.test(x)?at(r,1,1,0):/^[\d.]+%$/.test(x)?at(r,1,1,x):/^[\d.]+\s+[\d.]+$/.test(x)?(s=x.split(/\s+/),at(r,s[0],s[1],0)):/^[\d.]+\s+[\d.]+%$/.test(x)?(h=x.split(/\s+/),at(r,h[0],1,h[1])):at(r,0,1,"auto")}else if("borderRadius"===t){1===(x=x.toString().split("/")).length&&(x[1]=x[0]);for(var k=0;k<2;k++){var M=x[k].toString().split(/\s+/);0===M.length?x[k]=[0,0,0,0]:1===M.length?x[k]=[M[0],M[0],M[0],M[0]]:2===M.length?x[k]=[M[0],M[1],M[0],M[1]]:3===M.length?x[k]=[M[0],M[1],M[2],M[1]]:x[k]=M.slice(0,4)}this[t].forEach(function(t,e){nt(r[t])&&(r[t]=x[0][e]+" "+x[1][e])})}else{"backgroundPosition"===t?(1===(x=x.toString().split(/\s+/)).length&&(x[1]="50%"),this[t].forEach(function(t,e){nt(r[t])&&(r[t]=x[e])})):-1<["translate","scale","skew"].indexOf(t)?(1===(l=x.toString().split(/\s*,\s*/)).length&&(l[1]=l[0]),this[t].forEach(function(t,e){nt(r[t])&&(r[t]=l[e])})):"margin"===t||"padding"===t?(v=r,g=this[y=t],!(b=v[y])||(m=b.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi))&&(1===m.length?m[3]=m[2]=m[1]=m[0]:2===m.length?(m[2]=m[0],m[3]=m[1]):3===m.length&&(m[3]=m[1]),g.forEach(function(t,e){nt(v[t])&&(v[t]=m[e])}))):/^border((Top)|(Right)|(Bottom)|(Left))$/.test(t)?(p=(u=r)[c=t],nt(p)||(nt(u[c+"Width"])&&(f=/\b[\d.]+px\b/i.exec(p),u[c+"Width"]=f?f[0]:0),nt(u[c+"Style"])&&(d=/\b(solid|dashed|dotted)\b/i.exec(p),u[c+"Style"]=d?d[1]:"solid"),nt(u[c+"Color"])&&((_=/#[0-9a-f]{3,6}/i.exec(p))&&-1<[4,7].indexOf(_[0].length)?u[c+"Color"]=_[0]:/\btransparent\b/i.test(p)?u[c+"Color"]="transparent":(_=/rgba?\(.+\)/i.exec(p),u[c+"Color"]=_?_[0]:"transparent")))):this[t]&&this[t].forEach(function(t){nt(r[t])&&(r[t]=x)})}}},st=["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color"],ht=["fontSize","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","bottom","left","right","top","flexBasis","width","height","lineHeight","marginBottom","marginLeft","marginRight","marginTop","paddingBottom","paddingLeft","paddingRight","paddingTop","strokeWidth","strokeMiterlimit"],lt=["backgroundImage","fill","stroke"],ut=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],ct={};st.forEach(function(t){ct[t]=!0});var ft={};ht.forEach(function(t){ft[t]=!0});var pt={};ut.forEach(function(t){pt[t]=!0});var vt={};lt.forEach(function(t){vt[t]=!0});var yt=["translateX","translateY","scaleX","scaleY","rotateZ","skewX","skewY"],gt={};yt.forEach(function(t){gt[t]=!0});var mt={KEY_COLOR:st,KEY_EXPAND:yt,KEY_GRADIENT:lt,KEY_LENGTH:ht,KEY_RADIUS:ut,COLOR_HASH:ct,EXPAND_HASH:gt,GRADIENT_HASH:vt,LENGTH_HASH:ft,RADIUS_HASH:pt,GRADIENT_TYPE:{linear:!0,radial:!0}},Ot={GEOM:{},IGNORE:{pointerEvents:!0},REPAINT:{transform:!0,translateX:!0,translateY:!0,skewX:!0,skewY:!0,scaleX:!0,scaleY:!0,rotateZ:!0,color:!0,fontStyle:!0,strokeWidth:!0,fill:!0,strokeDasharray:!0,strokeLinecap:!0,strokeLinejoin:!0,strokeMiterlimit:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0,backgroundSize:!0,stroke:!0,borderBottomColor:!0,borderLeftColor:!0,borderRightColor:!0,borderTopColor:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0,visibility:!0,opacity:!0,zIndex:!0,filter:!0,boxShadow:!0},MEASURE:{fontSize:!0,fontWeight:!0,fontFamily:!0},isIgnore:function(t){return this.IGNORE.hasOwnProperty(t)},isRepaint:function(t){return this.REPAINT.hasOwnProperty(t)||this.isGeom(t)},isMeasure:function(t){return this.MEASURE.hasOwnProperty(t)},addGeom:function(e,t){Array.isArray(t)?t.forEach(function(t){Ot.addGeom(e,t)}):t&&((Ot.GEOM[t]=Ot.GEOM[t]||{})[e]=!0)},isGeom:function(t,e){return this.GEOM.hasOwnProperty(e)&&this.GEOM[e].hasOwnProperty(t)},isValid:function(t,e){return!!e&&(!!it.DOM.hasOwnProperty(e)||(!("$"!==t.charAt(0)||!it.GEOM.hasOwnProperty(e))||!!this.GEOM.hasOwnProperty(e)&&this.GEOM[e].hasOwnProperty(t)))}},bt=Ot.MEASURE_KEY_SET=Object.keys(Ot.MEASURE),xt=bt.length;Ot.isMeasureInherit=function(t){for(var e=0;e<xt;e++){var r=bt[e];if(t.hasOwnProperty(r)&&t[r].unit===f.INHERIT)return!0}return!1},Ot.measureInheritList=function(t){for(var e=[],r=0;r<xt;r++){var i=bt[r];t.hasOwnProperty(i)&&t[i].unit===f.INHERIT&&e.push(i)}return e},Ot.addGeom("$line",["x1","y1","x2","y2","controlA","controlB","start","end"]),Ot.addGeom("$circle",["r"]),Ot.addGeom("$ellipse",["rx","ry"]),Ot.addGeom("$rect",["rx","ry"]),Ot.addGeom("$sector",["begin","end","edge","closure"]),Ot.addGeom("$polyline",["points","controls","start","end"]),Ot.addGeom("$polygon",["points","controls","start","end"]);var kt=f.AUTO,Mt=f.PX,wt=f.PERCENT,At=f.NUMBER,St=f.INHERIT,Et=f.DEG,Tt=f.RGBA,Pt=f.STRING,Rt=_e.isNil,Ct=_e.rgba2int,Lt=mt.COLOR_HASH,Ft=mt.LENGTH_HASH,Nt=mt.RADIUS_HASH,It=mt.GRADIENT_HASH,Bt=mt.EXPAND_HASH,Dt=mt.GRADIENT_TYPE;function Wt(t,e,r){return"auto"===r?t[e]={unit:kt}:"inherit"===r?t[e]={unit:St}:/%$/.test(r)?(r=parseFloat(r)||0,t[e]={value:r,unit:wt}):/px$/i.test(r)?(r=parseFloat(r)||0,t[e]={value:r,unit:Mt}):/deg$/i.test(r)?(r=parseFloat(r)||0,t[e]={value:r,unit:Et}):(r=parseFloat(r)||0,t[e]={value:r,unit:At}),0===e.toString().indexOf("border")&&(t[e].value=Math.max(t[e].value,0)),t}function Gt(t,e){-1<t.indexOf("scale")?e.unit=At:-1<t.indexOf("translate")?e.unit===At&&(e.unit=Mt):e.unit===At&&(e.unit=Et)}function Ht(t){return t.fontSize*d.arial.lhr}function zt(t,e,r){for(t*=.01;e;){var i=e.currentStyle[r];if(i.unit===kt){if("width"!==r)break;e=e.parent}else{if(i.unit===Mt)return t*i.value;i.unit===wt&&(t*=.01*i.value,e=e.parent)}}return t}var Yt={normalize:function(a){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!_e.isObject(a))return{};var e,l,r,i,n,o,s,h,u=(a=_e.extend({},a)).border;if(u&&(ot.toFull(a,"border"),delete a.border),["borderTop","borderRight","borderBottom","borderLeft"].forEach(function(t){ot.toFull(a,t),delete a[t]}),(u=a.borderWidth)&&(ot.toFull(a,"borderWidth"),delete a.borderWidth),(u=a.borderColor)&&(ot.toFull(a,"borderColor"),delete a.borderColor),(u=a.borderStyle)&&(ot.toFull(a,"borderStyle"),delete a.borderStyle),(u=a.borderRadius)&&(ot.toFull(a,"borderRadius"),delete a.borderRadius),(u=a.background)&&(ot.toFull(a,"background"),delete a.background),u=a.backgroundPosition,Rt(u)||(ot.toFull(a,"backgroundPosition"),delete a.backgroundPosition),(u=a.flex)&&(ot.toFull(a,"flex"),delete a.flex),u=a.margin,Rt(u)||(ot.toFull(a,"margin"),delete a.margin),u=a.padding,Rt(u)||(ot.toFull(a,"padding"),delete a.padding),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=a[t];!Rt(e)&&a.transform&&console.error('Can not use expand style "'.concat(t,'" with transform'))}),["translate","scale","skew"].forEach(function(t){u=a[t],Rt(u)||(ot.toFull(a,t),delete a[t])}),u=a.rotate,Rt(u)||(ot.toFull(a,"rotate"),delete a.rotate),t.forEach(function(t){var e=t.k,r=t.v;Rt(a[e])&&(a[e]=r)}),(u=a.backgroundImage)&&(C.gradient.test(u)?a.backgroundImage=q.parseGradient(u):C.img.test(u)&&(a.backgroundImage=C.img.exec(u)[2])),(u=a.backgroundColor)&&((e=/^#[0-9a-f]{3,6}/i.exec(u))&&-1<[4,7].indexOf(e[0].length)?a.backgroundColor={value:Ct(e[0]),unit:Tt}:(e=/rgba?\(.+\)/i.exec(u),a.backgroundColor={value:Ct(e?e[0]:[0,0,0,0]),unit:Tt})),["backgroundPositionX","backgroundPositionY"].forEach(function(t){u=a[t],Rt(u)||(/%$/.test(u)||/px$/i.test(u)||/^-?[\d.]+$/.test(u)?(Wt(a,t,u),(u=a[t]).unit===At&&(u.unit=Mt)):a[t]={value:{top:0,left:0,center:50,right:100,bottom:100}[u],unit:wt})}),u=a.backgroundSize){var c=a.backgroundSize=[],f=u.toString().match(/\b(?:(-?[\d.]+(px|%)?)|(contain|cover|auto))/gi);if(f){1===f.length&&("contain"===f[0]||"cover"===f[0]?f[1]=f[0]:f[1]="auto");for(var d=0;d<2;d++){var _=f[d];/%$/.test(_)||/px$/i.test(_)||/^-?[\d.]+$/.test(_)?(Wt(c,d,_),c[d].unit===At&&(c[d].unit=Mt)):"0"===_||0===_?c.push({value:0,unit:Mt}):"contain"===_||"cover"===_?c.push({value:_,unit:Pt}):c.push({unit:kt})}}else c.push({unit:kt}),c[1]=c[0]}if(["Top","Right","Bottom","Left"].forEach(function(t){var e=a[t="border"+t+"Color"];Rt(e)||(a[t]={value:Ct(e),unit:Tt})}),["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){var e=a[t="border"+t+"Radius"];if(!Rt(e)){var r=e.toString().split(/\s+/);1===r.length&&(r[1]=r[0]);for(var i=0;i<2;i++){var n=r[i];/%$/.test(n)||/px$/i.test(n)||/^-?[\d.]+$/.test(n)?(Wt(r,i,n),r[i].unit===At&&(r[i].unit=Mt)):r[i]={value:0,unit:Mt}}a[t]=r}}),(u=a.transform)&&(l=a.transform=[],(r=u.toString().match(/\w+\(.+?\)/g))&&r.forEach(function(t){var e,r,i,n,a,o=t.indexOf("("),s=t.slice(0,o),h=t.slice(o+1,t.length-1);"matrix"===s?(6<(e=(e=h.toString().split(/\s*,\s*/)).map(function(t){return parseFloat(t)})).length&&(e=e.slice(0,6)),6===e.length&&l.push(["matrix",e])):!{translateX:!0,translateY:!0,scaleX:!0,scaleY:!0,skewX:!0,skewY:!0,rotate:!0,rotateZ:!0}.hasOwnProperty(s)?{translate:!0,scale:!0,skew:!0}.hasOwnProperty(s)&&(1===(i=h.toString().split(/\s*,\s*/)).length&&(i[1]=i[0]),n=Wt([s+"X",i[0]],1,i[0]),a=Wt([s+"Y",i[1]],1,i[1]),Gt(s,n[1]),Gt(s,a[1]),l.push(n),l.push(a)):("rotate"===s&&(s="rotateZ"),Gt(s,(r=Wt([s,h],1,h))[1]),l.push(r))})),u=a.transformOrigin,!Rt(u)){var p=a.transformOrigin=[],v=u.toString().match(C.position);if(v){1===v.length&&(v[1]=v[0]);for(var y=0;y<2;y++){var g=v[y];/%$/.test(g)||/px$/i.test(g)||/^-?[\d.]+$/.test(g)?(Wt(p,y,g),p[y].unit===At&&(p[y].unit=Mt)):(p.push({value:{top:0,left:0,center:50,right:100,bottom:100}[g],unit:wt}),Rt(p[y].value)&&(p[y].value=50))}}else p.push({value:50,unit:wt}),p[1]=p[0]}return["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=a[t];Rt(e)||(Wt(a,t,e),"rotate"===t&&(t="rotateZ",a.rotateZ=a.rotate,delete a.rotate),Gt(t,a[t]))}),(u=a.opacity)&&(u=parseFloat(u),isNaN(u)?a.opacity=1:(u=Math.max(u,0),u=Math.min(u,1),a.opacity=u)),(u=a.zIndex)&&(a.zIndex=parseInt(u)||0),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","top","right","bottom","left","width","height","flexBasis","strokeWidth"].forEach(function(t){var e=a[t];Rt(e)||(Wt(a,t,e),(e=a[t]).unit===At&&(e.unit=Mt))}),(u=a.color)&&(a.color="inherit"===u?{unit:St}:{value:Ct(u),unit:Tt}),!(u=a.fontSize)&&0!==u||("inherit"===u?a.fontSize={unit:St}:/%$/.test(u)?(i=Math.max(0,parseFloat(u)),a.fontSize=i?{value:i,unit:wt}:{value:16,unit:Mt}):a.fontSize={value:Math.max(0,parseFloat(u))||16,unit:Mt}),!(u=a.fontWeight)&&0!==u||(a.fontWeight="bold"===u?{value:700,unit:At}:"normal"===u?{value:400,unit:At}:"lighter"===u?{value:200,unit:At}:"inherit"===u?{unit:St}:{value:Math.max(0,parseInt(u))||400,unit:At}),(u=a.fontStyle)&&(a.fontStyle="inherit"===u?{unit:St}:{value:u,unit:Pt}),(u=a.fontFamily)&&(a.fontFamily="inherit"===u?{unit:St}:{value:u,unit:Pt}),(u=a.textAlign)&&(a.textAlign="inherit"===u?{unit:St}:{value:u,unit:Pt}),!(u=a.lineHeight)&&0!==u||("inherit"===u?a.lineHeight={unit:St}:"normal"===u?a.lineHeight={unit:kt}:/px$/i.test(u)?a.lineHeight={value:parseFloat(u),unit:Mt}:(n=Math.max(0,parseFloat(u))||"normal",a.lineHeight="normal"===n?{unit:kt}:{value:n,unit:At})),u=a.strokeDasharray,Rt(u)||((o=u.toString().match(/[\d.]+/g))?((o=o.map(function(t){return parseFloat(t)})).length%2==1&&o.push(o[o.length-1]),a.strokeDasharray=o):a.strokeDasharray=[]),(u=a.fill)&&(0<u.indexOf("-gradient(")?a.fill=q.parseGradient(u):a.fill=Ct(u)),(u=a.stroke)&&(0<u.indexOf("-gradient(")?a.stroke=q.parseGradient(u):a.stroke=Ct(u)),(u=a.filter)&&(a.filter=[],!(s=/\bblur\s*\(\s*([\d.]+)\s*(?:px)?\s*\)/i.exec(u))||(h=parseFloat(s[1])||0)&&a.filter.push(["blur",h])),(u=a.visibility)&&(a.visibility="inherit"===u?{unit:St}:{value:u,unit:Pt}),(u=a.pointerEvents)&&(a.pointerEvents="inherit"===u?{unit:St}:{value:u,unit:Pt}),(u=a.boxShadow)&&(a.boxShadow=[],u.match(/(-?[\d.]+(px)?)\s+(-?[\d.]+(px)?)\s+(-?[\d.]+(px)?\s*)?(-?[\d.]+(px)?\s*)?(((transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\)))\s*)?(inset|outset)?\s*,?/gi).forEach(function(t){var e=/(-?[\d.]+(?:px)?)\s+(-?[\d.]+(?:px)?)\s+(-?[\d.]+(?:px)?\s*)?(-?[\d.]+(?:px)?\s*)?(?:((?:transparent)|(?:#[0-9a-f]{3,6})|(?:rgba?\(.+\)))\s*)?(inset|outset)?/i.exec(t);if(e){for(var r=[e[1],e[2],e[3]||0,e[4]||0,e[5]||"#000",e[6]||"outset"],i=0;i<4;i++)Wt(r,i,r[i]),1<i&&r[i].value<0&&(r[i]=0),r[i].unit===At&&(r[i]=r[i].value);r[4]=Ct(r[4]),a.boxShadow.push(r)}})),a},computeMeasure:function(t,r){var i=t.currentStyle,n=t.computedStyle,e=t.parent,a=!r&&e.computedStyle;Ot.MEASURE_KEY_SET.forEach(function(t){var e=i[t];e.unit===St?n[t]=r?it.INHERIT[t]:a[t]:e.unit===wt?n[t]=r?it.INHERIT[t]:a[t]*e.value*.01:n[t]=e.value})},computeReflow:function(t,e){var r=t.currentStyle,i=t.computedStyle,n=t.parent,a=r.textAlign,o=r.lineHeight,s=!n,h=n&&n.computedStyle;["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"].forEach(function(t){i[t]=r[t].unit===Mt?Math.max(0,r[t].value):0}),["position","display","flexDirection","justifyContent","alignItems","alignSelf","flexGrow","flexShrink"].forEach(function(t){i[t]=r[t]}),a.unit===St?i.textAlign=s?"left":h.textAlign:i.textAlign=s?"left":a.value,o.unit===St?i.lineHeight=s?Ht(i):h.lineHeight:o.unit===Mt?i.lineHeight=Math.max(o.value,0)||Ht(i):o.unit===At?i.lineHeight=Math.max(o.value,0)*i.fontSize||Ht(i):i.lineHeight=Ht(i)},setFontStyle:function(t){var e=t.fontStyle,r=t.fontWeight,i=t.fontSize;return(e||"normal")+" "+(r||"400")+" "+i+"px/"+i+"px "+(t.fontFamily||"arial")},getBaseLine:function(t){var e=t.fontSize*d.arial.lhr;return.5*(t.lineHeight-e)+t.fontSize*d.arial.blr},calRelative:function(t,e,r,i,n){return r.unit===kt?r=0:-1<[Mt,At,Et,Tt,Pt].indexOf(r.unit)?r=r.value:r.unit===wt&&(r=zt(r.value,i,n?"width":"height")),r},calAbsolute:function(t,e,r,i){return r.unit===kt?r=0:-1<[Mt,At,Et,Tt,Pt].indexOf(r.unit)?r=r.value:r.unit===wt&&(r=r.value*i*.01),r},equalStyle:function(t,e,r,i){if(!e||!r)return e===r;if("transform"===t){if(e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++){var o=e[n],s=r[n];if(o[0]!==s[0])return!1;if("matrix"===o){if(!_e.equalArr(o[1],s[1]))return!1}else if(!_e.equal(o[1],s[1]))return!1}return!0}if("filter"===t){if(e.length!==r.length)return!1;for(var h=0,l=e.length;h<l;h++)if(!_e.equalArr(e[h],r[h]))return!1}if("transformOrigin"===t||"backgroundSize"===t)return e[0].value===r[0].value&&e[0].unit===r[0].unit&&e[1].value===r[1].value&&e[1].unit===r[1].unit;if("backgroundPositionX"===t||"backgroundPositionY"===t||Ft.hasOwnProperty(t)||Bt.hasOwnProperty(t))return e.value===r.value&&e.unit===r.unit;if("boxShadow"===t)return _e.equalArr(e,r);if(Nt.hasOwnProperty(t))return e[0].value===r[0].value&&e[0].unit===r[0].unit&&e[1].value===r[1].value&&e[1].unit===r[1].unit;if(Lt.hasOwnProperty(t))return e.unit===r.unit&&_e.equalArr(e.value,r.value);if(It.hasOwnProperty(t)&&e.k===r.k&&Dt.hasOwnProperty(e.k)){var u=e.v,c=r.v;if(e.d!==r.d||u.length!==c.length)return!1;for(var f=0,d=u.length;f<d;f++){var _=u[f],p=c[f];if(_.length!==p.length)return!1;for(var v=0;v<4;v++)if(_[0][v]!==p[0][v])return!1;if(1<_.length&&(_[1].value!==p[1].value||_[1].unit!==p[1].unit))return!1}return!0}return Ot.isGeom(i.tagName,t)&&(i.isMulti||Array.isArray(e)&&Array.isArray(r))?_e.equalArr(e,r):e===r},isRelativeOrAbsolute:function(t){var e=t.currentStyle.position;return"relative"===e||"absolute"===e}},Xt=function(){function a(t,e,r,i,n){l(this,a),this.__parent=t,this.__x=e,this.__y=r,this.__width=i,this.__content=n,this.__virtualDom={}}return u(a,[{key:"render",value:function(t,e,r,i,n,a){var o=this.content,s=this.x,h=this.y,l=this.parent,u=l.ox,c=l.oy;h+=Yt.getBaseLine(r),s+=u+n,h+=c+a,t===fe.CANVAS?e.fillText(o,s,h):t===fe.SVG&&(this.__virtualDom={type:"item",tagName:"text",props:[["x",s],["y",h],["fill",i.color],["font-family",r.fontFamily],["font-weight",r.fontWeight],["font-style",r.fontStyle],["font-size",r.fontSize+"px"]],content:_e.encodeHtml(o)})}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"content",get:function(){return this.__content}},{key:"baseLine",get:function(){return Yt.getBaseLine(this.parent.computedStyle)}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}}]),a}(),$t=function(){t(_,M);var r=e(_);function _(t){var e;return l(this,_),(e=r.call(this)).__content=_e.isNil(t)?"":t.toString(),e.__lineBoxes=[],e.__charWidthList=[],e.__charWidth=0,e.__textWidth=0,e}return u(_,[{key:"__computeMeasure",value:function(t,e){var r=this.content,i=this.computedStyle,n=this.charWidthList;n.splice(0),t===fe.CANVAS&&(e.font=Yt.setFontStyle(i));for(var a=i.fontSize+","+i.fontFamily+","+i.fontWeight,o=_.MEASURE_TEXT.data[a]=_.MEASURE_TEXT.data[a]||{key:a,style:i,hash:{},s:[]},s=_.CHAR_WIDTH_CACHE[a]=_.CHAR_WIDTH_CACHE[a]||{},h=0,l=!1,u=0,c=r.length;u<c;u++){var f=r.charAt(u),d=void 0;s.hasOwnProperty(f)?(d=s[f],n.push(d),h+=d,this.__charWidth=Math.max(this.charWidth,d)):t===fe.CANVAS?(d=s[f]=e.measureText(f).width,n.push(d),h+=d,this.__charWidth=Math.max(this.charWidth,d)):(o.hash.hasOwnProperty(f)||(o.s+=f),o.hash[f]=!0,n.push(-1),l=!0)}this.__textWidth=h,l&&_.MEASURE_TEXT.list.push(this)}},{key:"__measureCb",value:function(){for(var t,e=this.content,r=this.computedStyle,i=this.charWidthList,n=r.fontSize+","+r.fontFamily+","+r.fontWeight,a=_.CHAR_WIDTH_CACHE[n],o=0,s=0,h=i.length;s<h;s++){i[s]<0&&(o+=t=i[s]=a[e.charAt(s)],this.__charWidth=Math.max(this.charWidth,t))}this.__textWidth=o}},{key:"__layout",value:function(t,e){var r=this,i=t.x,n=t.y,a=t.w;this.__x=i,this.__y=n;var o=this.isDestroyed,s=this.content,h=this.computedStyle,l=this.lineBoxes,u=this.charWidthList;if(!o&&"none"!==h.display){this.__ox=this.__oy=0,l.splice(0);for(var c,f,d,_,p=0,v=0,y=0,g=s.length,m=0;v<g;){(y+=u[v])===a?(c=new Xt(this,i,n,y,s.slice(p,v+1)),l.push(c),m=Math.max(m,y),n+=h.lineHeight,v=p=v+1,y=0):a<y?(f=void 0,f=v===p?(v=p+1,y):y-u[v],d=new Xt(this,i,n,f,s.slice(p,v)),l.push(d),m=Math.max(m,f),n+=h.lineHeight,p=v,y=0):v++}if(p<g&&p<v){for(y=0,v=p;v<g;v++)y+=u[v];var b=new Xt(this,i,n,y,s.slice(p,g));l.push(b),m=Math.max(m,y),n+=h.lineHeight}this.__width=m,this.__height=n-t.y,e||(_=h.textAlign,-1<["center","right"].indexOf(_)&&l.forEach(function(t){var e=r.__width-t.width;0<e&&t.__offsetX("center"===_?.5*e:e)}))}}},{key:"__offsetX",value:function(e,t){_t(dt(_.prototype),"__offsetX",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetX(e)})}},{key:"__offsetY",value:function(e,t){_t(dt(_.prototype),"__offsetY",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetY(e)})}},{key:"__tryLayInline",value:function(t){return t-this.textWidth}},{key:"__calMaxAndMinWidth",value:function(){var e=0;return this.charWidthList.forEach(function(t){e=Math.max(e,t)}),{max:this.textWidth,min:e}}},{key:"__calAbsWidth",value:function(t,e,r){return this.__layout({x:t,y:e,w:r},!0),this.width}},{key:"render",value:function(e,t,r,i,n,a){var o=4<arguments.length&&void 0!==n?n:0,s=5<arguments.length&&void 0!==a?a:0;e===fe.SVG&&(this.__virtualDom={type:"text",children:[]});var h,l,u=this.isDestroyed,c=this.computedStyle,f=this.lineBoxes,d=this.cacheStyle;u||"none"===c.display||"hidden"===c.visibility||(e===fe.CANVAS&&(h=Yt.setFontStyle(c),r.font!==h&&(r.font=h),l=d.color,r.fillStyle!==l&&(r.fillStyle=l)),f.forEach(function(t){t.render(e,r,c,d,o,s)}),e===fe.SVG&&(this.virtualDom.children=f.map(function(t){return t.virtualDom})))}},{key:"deepScan",value:function(t){t(this)}},{key:"__mergeBbox",value:function(t,e,r,i,n){return _e.transformBbox(this.bbox,t,i,n)}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"lineBoxes",get:function(){return this.__lineBoxes}},{key:"charWidthList",get:function(){return this.__charWidthList}},{key:"charWidth",get:function(){return this.__charWidth}},{key:"textWidth",get:function(){return this.__textWidth}},{key:"baseLine",get:function(){var t=this.lineBoxes;if(!t.length)return 0;var e=t[t.length-1];return e.y-this.y+e.baseLine}},{key:"currentStyle",get:function(){return this.parent.currentStyle}},{key:"computedStyle",get:function(){return this.parent.computedStyle}},{key:"cacheStyle",get:function(){return this.parent.__cacheStyle}},{key:"bbox",get:function(){var t=this.sx,e=this.sy;return[t,e,t+this.width,e+this.height]}}]),_}();n($t,"CHAR_WIDTH_CACHE",{}),n($t,"MEASURE_TEXT",{list:[],data:{}}),$t.prototype.__renderByMask=$t.prototype.render;var jt=.5*Math.PI;var Vt={canvasPolygon:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(e&&e.length){for(var n=0,a=0,o=e.length;a<o;a++){var s=e[a];if(Array.isArray(s)){n=a;break}}t.moveTo(e[n][0]+r,e[n][1]+i);for(var h=n+1,l=e.length;h<l;h++){var u=e[h];Array.isArray(u)&&(2===u.length?t.lineTo(u[0]+r,u[1]+i):4===u.length?t.quadraticCurveTo(u[0]+r,u[1]+i,u[2]+r,u[3]+i):6===u.length&&t.bezierCurveTo(u[0]+r,u[1]+i,u[2]+r,u[3]+i,u[4]+r,u[5]+i))}}},svgPolygon:function(t){if(!t||!t.length)return"";for(var e=0,r=0,i=t.length;r<i;r++){var n=t[r];if(Array.isArray(n)){e=r;break}}for(var a="M"+t[e][0]+","+t[e][1],o=e+1,s=t.length;o<s;o++){var h=t[o];Array.isArray(h)&&(2===h.length?a+="L"+h[0]+","+h[1]:4===h.length?a+="Q"+h[0]+","+h[1]+" "+h[2]+","+h[3]:6===h.length&&(a+="C"+h[0]+","+h[1]+" "+h[2]+","+h[3]+" "+h[4]+","+h[5]))}return a},canvasLine:function(t,e,r,i,n,a,o,s){var h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,l=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0;return t.moveTo(e+h,r+l),3===s?(t.bezierCurveTo(a[0]+h,a[1]+l,o[0]+h,o[1],i+h,n+l),2):2===s?(t.quadraticCurveTo(o[0]+h,o[1]+l,i+h,n+l),2):1===s?(t.quadraticCurveTo(a[0]+h,a[1]+l,i+h,n+l),2):(t.lineTo(i+h,n+l),1)},svgLine:function(t,e,r,i,n,a,o){return 3===o?"M"+t+","+e+"C"+n[0]+","+n[1]+" "+a[0]+","+a[1]+" "+r+","+i:2===o?"M"+t+","+e+"Q"+a[0]+","+a[1]+" "+r+","+i:1===o?"M"+t+","+e+"Q"+n[0]+","+n[1]+" "+r+","+i:"M"+t+","+e+"L"+r+","+i},canvasSector:function(t,e,r,i,n,a,o,s,h,l,u,c,f,d){var _=14<arguments.length&&void 0!==arguments[14]?arguments[14]:0,p=15<arguments.length&&void 0!==arguments[15]?arguments[15]:0;t.arc(e+_,r+p,i,l*Math.PI/180-jt,u*Math.PI/180-jt),f?(c&&d||t.lineTo(e+_,r+p),t.lineTo(n+_,a+p),0<h&&t.stroke()):(0<h&&t.stroke(),c&&d||t.lineTo(e+_,r+p),t.lineTo(n+_,a+p))},svgSector:function(t,e,r,i,n,a,o,s,h,l,u){var c;return(!l||0<s)&&(c="M"+i+","+n+"A"+r+","+r+" 0 "+h+" 1 "+a+","+o),[u&&h?"M"+i+","+n+"A"+r+","+r+" 0 "+h+" 1 "+a+","+o+"z":"M"+t+","+e+"L"+i+","+n+"A"+r+","+r+" 0 "+h+" 1 "+a+","+o+"z",c]}};function qt(t,e,r,i){var n=r-t,a=i-e,o=Math.atan(Math.abs(a)/Math.abs(n));return n<0&&0<=a?Math.PI-o:n<0&&a<0?o-Math.PI:0<=n&&0<=a?o:-o}function Ut(t){var e=Math.sin(t),r=Math.cos(t),i=de.identity();return i[0]=i[3]=r,i[1]=e,i[2]=-e,i}function Zt(t,e){var r=ue(t,6),i=r[0],n=r[1],a=r[2],o=r[3],s=r[4],h=r[5],l=ue(e,6),u=l[0],c=l[1],f=l[2],d=l[3],_=l[4],p=(a-i)*(h-n)-(s-i)*(o-n),v=(f-u)*(l[5]-c)-(_-u)*(d-c);return 0<p&&v<0||p<0&&0<v}var Kt={exchangeOrder:function(t,e){var r,i,n,a,o,s,h,l,u,c,f,d,_,p,v,y,g=(u=ue(t,6),c=u[0],f=u[1],d=u[2],_=u[3],p=u[4],v=u[5],y=[0,1,2],d<c&&d<p?(c=(r=[d,_,c,f])[0],f=r[1],d=r[2],_=r[3],y[0]=1,y[1]=0):p<d&&p<c&&(c=(i=[p,v,c,f])[0],f=i[1],p=i[2],v=i[3],y[0]=2,y[2]=0),c===d?_<f&&(c=(n=[d,_,c,f])[0],f=n[1],d=n[2],_=n[3],a=y[0],y[0]=y[1],y[1]=a):c===p&&v<f&&(c=(o=[p,v,c,f])[0],f=o[1],p=o[2],v=o[3],s=y[0],y[0]=y[2],y[2]=s),(d-c)*(v-f)-(p-c)*(_-f)<0&&(d=(h=[p,v,d,_])[0],_=h[1],p=h[2],v=h[3],l=y[1],y[1]=y[2],y[2]=l),[c,f,d,_,p,v,y]),m=ue(g,7),b=m[0],x=m[1],k=m[2],M=m[3],w=m[4],A=m[5],S=ue(function(t,e){for(var r=[],i=0,n=e.length;i<n;i++){var a=e[i];r.push(t[2*a]),r.push(t[2*a+1])}return r}(e,m[6]),6);return[[b,x,k,M,w,A],[S[0],S[1],S[2],S[3],S[4],S[5]]]},isOverflow:Zt,transform:function(t,e){var r,i=ue(t,6),n=i[0],a=i[1],o=i[2],s=i[3],h=i[4],l=i[5],u=ue(e,6),c=u[0],f=u[1],d=u[2],_=u[3],p=u[4],v=u[5],y=Zt(t,e),g=de.identity();g[4]=-n,g[5]=-a;var m=qt(n,a,o,s);0!==m&&(r=Ut(-m),g=de.multiply(r,g));var b=pe.pointsDistance(n,a,o,s),x=pe.pointsDistance(c,f,d,_),k=de.identity();k[4]=-c,k[5]=-f;var M=m=qt(c,f,d,_);0!==m&&(r=Ut(-m),k=de.multiply(r,k));var w=Math.abs(de.calPoint([h,l],g)[1]),A=Math.abs(de.calPoint([p,v],k)[1]);b===x&&w===A||(r=de.identity(),b!==x&&(r[0]=x/b),w!==A&&(r[3]=A/w),g=de.multiply(r,g)),k=g;var S=ue(de.calPoint([n,a],k),2),E=S[0],T=S[1],P=ue(de.calPoint([o,s],k),2),R=P[0],C=P[1],O=ue(de.calPoint([h,l],k),2),L=O[0],F=O[1],N=pe.pointsDistance(E,T,R,C),I=pe.pointsDistance(E,T,L,F),B=pe.pointsDistance(L,F,R,C),D=pe.pointsDistance(c,f,d,_),W=pe.pointsDistance(c,f,p,v),G=pe.pointsDistance(p,v,d,_),H=pe.angleBySide(B,N,I),z=pe.angleBySide(G,D,W);return H!==z&&((r=de.identity())[2]=Math.tan(H-.5*Math.PI)+Math.tan(.5*Math.PI-z),g=de.multiply(r,g)),y&&(g[1]=-g[1],g[3]=-g[3],g[5]=-g[5]),(r=0!==M?Ut(M):de.identity())[4]=c,r[5]=f,g=de.multiply(r,g)}},Jt={matrix:de,tar:Kt,geom:pe},Qt=f.PX,ie=f.PERCENT,ne=Jt.matrix,ae=Jt.geom,oe=ne.identity,se=ne.calPoint,he=ne.multiply,ve=ae.d2r,ye=ae.pointInPolygon;function ge(t,e,r){var n,a,o,i=(n=e,a=r,o=[],t.forEach(function(t){var e=ue(t,2),r=e[0],i=e[1];o.push([r,function(t,e,r,i){if("translateX"===t){if(e.unit===ie)return e.value*r*.01}else if("translateY"===t){if(e.unit===ie)return e.value*i*.01}else if("matrix"===t)return e;return e.value}(r,i,n,a)])}),o),u=oe();return i.forEach(function(t){var e,r,i,n,a,o=ue(t,2),s=o[0],h=o[1],l=oe();e=l,i=h,"translateX"===(r=s)?e[4]=i:"translateY"===r?e[5]=i:"scaleX"===r?e[0]=i:"scaleY"===r?e[3]=i:"skewX"===r?(i=ve(i),e[2]=Math.tan(i)):"skewY"===r?(i=ve(i),e[1]=Math.tan(i)):"rotateZ"===r?(i=ve(i),n=Math.sin(i),a=Math.cos(i),e[0]=e[3]=a,e[1]=n,e[2]=-n):"matrix"===r&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5]),u=he(u,l)}),u}function me(t,e){var r=ue(e,2),i=r[0],n=r[1];if(0===i&&0===n)return t;var a=oe();a[4]=i,a[5]=n;var o=he(a,t),s=oe();return s[4]=-i,s[5]=-n,he(o,s)}var be={calMatrix:ge,calOrigin:function(t,r,i){var n=[];return t.forEach(function(t,e){t.unit===Qt?n.push(t.value):t.unit===ie&&n.push(t.value*(e?i:r)*.01)}),n},calMatrixByOrigin:me,calMatrixWithOrigin:function(t,e,r,i){return me(ge(t,r,i),e)},pointInQuadrilateral:function(t,e,r,i,n,a,o,s,h,l,u){if(!u||_e.equalArr(u,[1,0,0,1,0,0]))return r<=t&&i<=e&&t<=o&&e<=s;var c=ue(se([r,i],u),2);r=c[0],i=c[1];var f=ue(se([n,a],u),2);n=f[0],a=f[1];var d=ue(se([h,l],u),2);h=d[0],l=d[1];var _=ue(se([o,s],u),2);return o=_[0],s=_[1],ye(t,e,[[r,i],[n,a],[o,s],[h,l]])}},xe=pe.H;function ke(t,e,r,i,n,a,o,s){var h=1,l=1,u=1;t:for(var c=a;n<=c;c--)for(var f=s;o<=f;f--){var d=c+f,_=Math.floor((t+f)/d),p=f;if(_*d<f+t)if(s<(p=(t-_*c)/(_-1)))continue;if(d=c+p,1<e&&c<e){if(c<e%d)continue;if(1<r)if(c<(e+i)%d)continue}if(1<r)if(c<(e+i)%d)continue;0<_&&(h=_,l=c,u=p);break t}return{n:h,ps:l,pd:u}}function Me(t,e,r,i,n,a){var o=n-e,s=i-r,h=r-e,l=n-i;if("dotted"===t)return ke(o,h,l,s,a,a,Math.max(1,.25*a),2*a);var u=ke(o,h,l,s,a,3*a,Math.max(1,.25*a),2*a),c=u.n,f=u.ps,d=u.pd;return 1===c?ke(o,h,l,s,a,a,Math.max(1,.25*a),2*a):{n:c,ps:f,pd:d}}function we(t,e,r,i,n,a,o,s,h,l,u,c,f,d){var _=ue(f,2),p=_[0],v=_[1],y=ue(d,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,A,S,E,T,P,R,C,O,L,F,N=n+p-(n-i),I=a-g+(o-a),B=[],D=[],W=[],G=0,H=c.length;G<H;G++){var z,Y,X,$,j=c[G];j[1][0]<N?B.push(j):j[0][0]>I?W.push(j):j[1][0]>I&&j[0][0]<N?(z=N<n?s+Math.tan(e)*(N-i):h,Y=a<I?s+Math.tan(r)*(o-I):h,B.push([j[0],[N,s],[N,z],j[3]]),N<I&&(n<N&&I<a?D.push([[N,s],[I,s],[I,h],[N,h]]):n<N?(D.push([[N,s],[a,s],[a,h],[N,h]]),D.push([[a,s],[I,s],[I,Y],[a,h]])):I<a?(D.push([[N,s],[n,s],[n,h],[N,z]]),D.push([[n,s],[I,s],[I,h],[n,h]])):(D.push([[N,s],[n,s],[n,h],[N,z]]),D.push([[n,s],[a,s],[a,h],[n,h]]),D.push([[a,s],[I,s],[I,Y],[a,h]]))),W.push([[I,s],j[1],j[2],[I,Y]])):j[1][0]>I?(X=a<I?s+Math.tan(r)*(o-I):h,D.push([j[0],[I,s],[I,X],j[3]]),W.push([[I,s],j[1],j[2],[I,X]])):j[0][0]<N?($=N<n?s+Math.tan(e)*(N-i):h,B.push([j[0],[N,s],[N,$],j[3]]),D.push([[N,s],j[1],j[2],[N,$]])):D.push(j)}B.length&&(b=n-i<p&&t<v,x=Math.atan((n-i)/(h-s)),M=(k=v)/p,w=s+v,S=(A=v-(h-s))/(p-(n-i)),T=ue((E=Ae(B[0][0],B[0][1],N,w,M,k,!0,Math.tan(x)*k))[0],2),L=T[0],F=T[1],b&&(R=ue((P=Ae(B[0][3],B[0][2],N,w,S,A,!0,Math.tan(x)*A))[0],2),C=R[0],O=R[1]),B.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=P)):(r=Ae(t[0],t[1],N,w,M,k),b&&(i=Ae(t[3],t[2],N,w,S,A)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],L,F,0);if(t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3]),b){for(var o=0,s=i.length;o<s;o++)Ie(i[o],C,O,0);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}}));var V,q,U,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=W.length;return ht&&(V=o-a<g&&t<m,q=Math.atan((o-a)/(h-s)),Z=(U=m)/g,K=s+m,Q=(J=m-(h-s))/(g-(o-a)),et=ue((tt=Se(W[ht-1][0],W[ht-1][1],I,K,Z,U,!0,Math.tan(q)*U))[tt.length-1],2),ot=et[0],st=et[1],V&&(it=ue((rt=Se(W[ht-1][3],W[ht-1][2],I,K,Q,J,!0,Math.tan(q)*J))[rt.length-1],2),nt=it[0],at=it[1]),W.forEach(function(t,e){var r,i;e===ht-1?(r=tt,V&&(i=rt)):(r=Se(t[0],t[1],I,K,Z,U),V&&(i=Se(t[3],t[2],I,K,Q,J)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],ot,st,1);if(t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3]),V){for(var o=0,s=i.length;o<s;o++)Ie(i[o],nt,at,1);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}})),B.concat(D).concat(W)}function Ae(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(-y+r)*n,M=(-b+r)*n,w=Math.atan(M/(i-x)),A=r-Math.sin(w)*a/n,S=i-Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r-Math.cos(f)*a/n,i-Math.sin(f)*a):(d=Math.atan(k/(i-g)),_=r-Math.sin(d)*a/n,i-Math.cos(d)*a),d===w)return[[_,p]];var E=pe.h(Math.abs(d-w))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=d-P,C=w+P;return[[_,p],[r-Math.sin(R)*T/n,i-Math.cos(R)*T],[r-Math.sin(C)*T/n,i-Math.cos(C)*T],[A,S]]}function Se(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(k/(i-g)),A=r+Math.sin(w)*a/n,S=i-Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r+Math.cos(f)*a/n,i-Math.sin(f)*a):(d=Math.atan(M/(i-x)),_=r+Math.sin(d)*a/n,i-Math.cos(d)*a),w===d)return[[A,S]];var E=pe.h(Math.abs(w-d))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=w+P,C=d-P;return[[A,S],[r+Math.sin(R)*T/n,i-Math.cos(R)*T],[r+Math.sin(C)*T/n,i-Math.cos(C)*T],[_,p]]}function Ee(t,e,r,i,n,a,o,s,h,l,u,c,f,d){var _=ue(f,2),p=_[0],v=_[1],y=ue(d,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,A,S,E,T,P,R,C,O,L,F,N=h+v-(h-s),I=l-m+(u-l),B=[],D=[],W=[],G=0,H=c.length;G<H;G++){var z,Y,X,$,j=c[G];j[2][1]<N?B.push(j):j[1][1]>I?W.push(j):j[2][1]>I&&j[1][1]<N?(z=N<h?a+Math.tan(r)*(h-N):a,Y=l<I?a+Math.tan(e)*(I-l):a,B.push([j[0],j[1],[o,N],[z,N]]),N<I&&(I<l&&h<N?D.push([[a,N],[o,N],[o,I],[a,I]]):h<N?(D.push([[a,h],[o,h],[o,l],[a,l]]),D.push([[a,l],[o,l],[o,I],[Y,I]])):I<l?(D.push([[z,N],[o,N],[o,h],[a,h]]),D.push([[a,h],[o,h],[o,I],[a,I]])):(D.push([[z,N],[o,N],[o,h],[a,h]]),D.push([[a,h],[o,h],[o,l],[a,l]]),D.push([[a,l],[o,l],[o,I],[Y,I]]))),W.push([[Y,I],[o,I],j[2],j[3]])):j[2][1]>I?(X=l<I?a+Math.tan(e)*(I-l):a,D.push([j[0],j[1],[o,I],[X,I]]),W.push([[X,I],[o,I],j[2],j[3]])):j[1][1]<N?($=N<h?a+Math.tan(r)*(h-N):a,B.push([j[0],j[1],[o,N],[$,N]]),D.push([[$,N],[o,N],j[2],j[3]])):D.push(j)}B.length&&(b=h-s<v&&t<p,x=Math.atan((o-a)/(h-s)),M=(k=v)/p,w=o-p,S=(A=v-(h-s))/(p-(o-a)),T=ue((E=Te(B[0][1],B[0][2],w,N,M,k,!0,Math.tan(x)*k))[E.length-1],2),L=T[0],F=T[1],b&&(R=ue((P=Te(B[0][0],B[0][3],w,N,S,A,!0,Math.tan(x)*A))[P.length-1],2),C=R[0],O=R[1]),B.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=P)):(r=Te(t[1],t[2],w,N,M,k),b&&(i=Te(t[0],t[3],w,N,S,A)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],L,F,2);if(b){for(var o=0,s=i.length;o<s;o++)Ie(i[o],C,O,2);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[2]=t[3],t[3]=t[0];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}));var V,q,U,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=W.length;return ht&&(V=u-l<m&&t<g,q=Math.atan((o-a)/(u-l)),Z=(U=m)/g,K=o-g,Q=(J=m-(u-l))/(g-(o-a)),et=ue((tt=Pe(W[ht-1][1],W[ht-1][2],K,I,Z,U,!0,Math.tan(q)*U))[0],2),ot=et[0],st=et[1],V&&(it=ue((rt=Pe(W[ht-1][0],W[ht-1][3],K,I,Q,J,!0,Math.tan(q)*J))[0],2),nt=it[0],at=it[1]),W.forEach(function(t,e){var r,i;e===ht-1?(r=tt,V&&(i=rt)):(r=Pe(t[1],t[2],K,I,Z,U),V&&(i=Pe(t[0],t[3],K,I,Q,J)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],ot,st,3);if(V){for(var o=0,s=i.length;o<s;o++)Ie(i[o],nt,at,3);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[2]=t[3],t[3]=t[0];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])})),B.concat(D).concat(W)}function Te(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(M/(i-x)),A=r+Math.sin(w)*a/n,S=i-Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r+Math.cos(f)*a/n,i-Math.sin(f)*a):(d=Math.atan(k/(i-g)),_=r+Math.sin(d)*a/n,i-Math.cos(d)*a),d===w)return[[_,p]];var E=pe.h(Math.abs(d-w))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=d+P,C=r+Math.sin(R)*T/n,O=i-Math.cos(R)*T,L=w-P;return[[A,S],[r+Math.sin(L)*T/n,i-Math.cos(L)*T],[C,O],[_,p]]}function Pe(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(k/(g-i)),A=r+Math.sin(w)*a/n,S=i+Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r+Math.cos(f)*a/n,i+Math.sin(f)*a):(d=Math.atan(M/(x-i)),_=r+Math.sin(d)*a/n,i+Math.cos(d)*a),w===d)return[[A,S]];var E=pe.h(Math.abs(w-d))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=w-P,C=r+Math.sin(R)*T/n,O=i+Math.cos(R)*T,L=d+P;return[[_,p],[r+Math.sin(L)*T/n,i+Math.cos(L)*T],[C,O],[A,S]]}function Re(t,e,r,i,n,a,o,s,h,l,u,c,f,d){var _=ue(f,2),p=_[0],v=_[1],y=ue(d,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,A,S,E,T,P,R,C,O,L,F,N=n+p-(n-i),I=a-g+(o-a),B=[],D=[],W=[],G=0,H=c.length;G<H;G++){var z,Y,X,$,j=c[G];j[2][0]<N?B.push(j):j[3][0]>I?W.push(j):j[2][0]>I&&j[3][0]<N?(z=N<n?u-Math.tan(e)*(N-i):h,Y=a<I?u-Math.tan(r)*(o-I):l,B.push([j[0],[N,z],[N,u],j[3]]),N<I&&(n<N&&I<a?D.push([[N,l],[I,l],[I,u],[N,u]]):n<N?(D.push([[N,l],[a,l],[a,u],[N,u]]),D.push([[a,l],[I,Y],[I,u],[a,u]])):I<a?(D.push([[N,z],[n,l],[n,u],[N,u]]),D.push([[n,l],[I,l],[I,u],[n,u]])):(D.push([[N,z],[n,l],[n,u],[N,u]]),D.push([[n,l],[a,l],[a,u],[n,u]]),D.push([[a,l],[I,Y],[I,u],[a,u]]))),W.push([[I,Y],j[1],j[2],[I,u]])):j[2][0]>I?(X=a<I?u-Math.tan(r)*(o-I):l,D.push([j[0],[I,X],[I,u],j[3]]),W.push([[I,X],j[1],j[2],[I,u]])):j[3][0]<N?($=N<n?u-Math.tan(e)*(N-i):l,B.push([j[0],[N,$],[N,u],j[3]]),D.push([[N,$],j[1],j[2],[N,u]])):D.push(j)}B.length&&(b=n-i<p&&t<v,x=Math.atan((n-i)/(u-l)),M=(k=v)/p,w=u-v,S=(A=v-(u-l))/(p-(n-i)),T=ue((E=Ce(B[0][3],B[0][2],N,w,M,k,!0,Math.tan(x)*k))[0],2),L=T[0],F=T[1],b&&(R=ue((P=Ce(B[0][0],B[0][1],N,w,S,A,!0,Math.tan(x)*A))[0],2),C=R[0],O=R[1]),B.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=P)):(r=Ce(t[3],t[2],N,w,M,k),b&&(i=Ce(t[0],t[1],N,w,S,A)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],L,F,4);if(b){for(var o=0,s=i.length;o<s;o++)Ie(i[o],C,O,4);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}else t[2]=t[1],t[3]=t[0];t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3])}));var V,q,U,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=W.length;return ht&&(V=o-a<g&&t<m,q=Math.atan((o-a)/(u-l)),Z=(U=m)/g,K=u-m,Q=(J=m-(u-l))/(g-(o-a)),et=ue((tt=Oe(W[ht-1][3],W[ht-1][2],I,K,Z,U,!0,Math.tan(q)*U))[tt.length-1],2),ot=et[0],st=et[1],V&&(it=ue((rt=Oe(W[ht-1][0],W[ht-1][1],I,K,Q,J,!0,Math.tan(q)*J))[rt.length-1],2),nt=it[0],at=it[1]),W.forEach(function(t,e){var r,i;e===ht-1?(r=tt,V&&(i=rt)):(r=Oe(t[3],t[2],I,K,Z,U),V&&(i=Oe(t[0],t[1],I,K,Q,J)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],ot,st,5);if(V){for(var o=0,s=i.length;o<s;o++)Ie(i[o],nt,at,5);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[3],t[3]=i[2].concat(i[1]).concat(i[0]))}else t[2]=t[1],t[3]=t[0];t[0]=r[0],t[1]=r[1].concat(r[2]).concat(r[3])})),B.concat(D).concat(W)}function Ce(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(-y+r)*n,M=(-b+r)*n,w=Math.atan(M/(x-i)),A=r-Math.sin(w)*a/n,S=i+Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r-Math.cos(f)*a/n,i+Math.sin(f)*a):(d=Math.atan(k/(g-i)),_=r-Math.sin(d)*a/n,i+Math.cos(d)*a),d===w)return[[_,p]];var E=pe.h(Math.abs(d-w))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=d-P,C=w+P;return[[_,p],[r-Math.sin(R)*T/n,i+Math.cos(R)*T],[r-Math.sin(C)*T/n,i+Math.cos(C)*T],[A,S]]}function Oe(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(y-r)*n,M=(b-r)*n,w=Math.atan(k/(g-i)),A=r+Math.sin(w)*a/n,S=i+Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r+Math.cos(f)*a/n,i+Math.sin(f)*a):(d=Math.atan(M/(x-i)),_=r+Math.sin(d)*a/n,i+Math.cos(d)*a),w===d)return[[A,S]];var E=pe.h(Math.abs(w-d))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=w+P,C=d-P;return[[A,S],[r+Math.sin(R)*T/n,i+Math.cos(R)*T],[r+Math.sin(C)*T/n,i+Math.cos(C)*T],[_,p]]}function Le(t,e,r,i,n,a,o,s,h,l,u,c,f,d){var _=ue(f,2),p=_[0],v=_[1],y=ue(d,2),g=y[0],m=y[1];if(!(p&&v||g&&m))return c;for(var b,x,k,M,w,A,S,E,T,P,R,C,O,L,F,N=h+v-(h-s),I=l-m+(u-l),B=[],D=[],W=[],G=0,H=c.length;G<H;G++){var z,Y,X,$,j=c[G];j[3][1]<N?B.push(j):j[0][1]>I?W.push(j):j[3][1]>I&&j[0][1]<N?(z=N<h?n-Math.tan(r)*(h-N):n,Y=l<I?n-Math.tan(e)*(I-l):n,B.push([j[0],j[1],[z,N],[i,N]]),N<I&&(I<l&&h<N?D.push([[i,N],[n,N],[n,I],[i,I]]):h<N?(D.push([[i,N],[n,N],[n,l],[i,l]]),D.push([[i,l],[n,l],[Y,I],[i,I]])):I<l?(D.push([[i,N],[z,N],[n,h],[i,h]]),D.push([[i,h],[n,h],[n,I],[i,I]])):(D.push([[i,N],[z,N],[n,h],[i,h]]),D.push([[i,h],[n,h],[n,l],[i,l]]),D.push([[i,l],[n,l],[Y,I],[i,I]]))),W.push([[i,I],[Y,I],j[2],j[3]])):j[3][1]>I?(X=l<I?n-Math.tan(e)*(I-l):n,D.push([j[0],j[1],[X,I],[i,I]]),W.push([[i,I],[X,I],j[2],j[3]])):j[1][1]<N?($=N<h?n-Math.tan(r)*(h-N):n,B.push([j[0],j[1],[$,N],[i,N]]),D.push([[i,N],[$,N],j[2],j[3]])):D.push(j)}B.length&&(b=h-s<v&&t<p,x=Math.atan((n-i)/(h-s)),M=(k=v)/p,w=i+p,S=(A=v-(h-s))/(p-(n-i)),T=ue((E=Fe(B[0][0],B[0][3],w,N,M,k,!0,Math.tan(x)*k))[E.length-1],2),L=T[0],F=T[1],b&&(R=ue((P=Fe(B[0][1],B[0][2],w,N,S,A,!0,Math.tan(x)*A))[P.length-1],2),C=R[0],O=R[1]),B.forEach(function(t,e){var r,i;0===e?(r=E,b&&(i=P)):(r=Fe(t[0],t[3],w,N,M,k),b&&(i=Fe(t[1],t[2],w,N,S,A)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],L,F,6);if(b){for(var o=0,s=i.length;o<s;o++)Ie(i[o],C,O,6);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[3]=t[1];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])}));var V,q,U,Z,K,J,Q,tt,et,rt,it,nt,at,ot,st,ht=W.length;return ht&&(V=u-l<m&&t<g,q=Math.atan((n-i)/(u-l)),Z=(U=m)/g,K=i+g,Q=(J=m-(u-l))/(g-(n-i)),et=ue((tt=Ne(W[ht-1][0],W[ht-1][3],K,I,Z,U,!0,Math.tan(q)*U))[0],2),ot=et[0],st=et[1],V&&(it=ue((rt=Ne(W[ht-1][1],W[ht-1][2],K,I,Q,J,!0,Math.tan(q)*J))[0],2),nt=it[0],at=it[1]),W.forEach(function(t,e){var r,i;e===ht-1?(r=tt,V&&(i=rt)):(r=Ne(t[0],t[3],K,I,Z,U),V&&(i=Ne(t[1],t[2],K,I,Q,J)));for(var n=0,a=r.length;n<a;n++)Ie(r[n],ot,st,7);if(V){for(var o=0,s=i.length;o<s;o++)Ie(i[o],nt,at,7);1===i.length?(t[2]=i[0],t.pop()):(t[2]=i[0],t[3]=i[1].concat(i[2]).concat(i[3]))}else t[3]=t[1];t[0]=r[3],t[1]=r[2].concat(r[1]).concat(r[0])})),B.concat(D).concat(W)}function Fe(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(r-y)*n,M=(r-b)*n,w=Math.atan(M/(i-x)),A=r-Math.sin(w)*a/n,S=i-Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r-Math.cos(f)*a/n,i-Math.sin(f)*a):(d=Math.atan(k/(i-g)),_=r-Math.sin(d)*a/n,i-Math.cos(d)*a),d===w)return[[_,p]];var E=pe.h(Math.abs(d-w))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=d+P,C=r-Math.sin(R)*T/n,O=i-Math.cos(R)*T,L=w-P;return[[A,S],[r-Math.sin(L)*T/n,i-Math.cos(L)*T],[C,O],[_,p]]}function Ne(t,e,r,i,n,a,o,s){var h,l,u,c,f,d,_,p,v=ue(t,2),y=v[0],g=v[1],m=ue(e,2),b=m[0],x=m[1],k=(r-y)*n,M=(r-b)*n,w=Math.atan(k/(g-i)),A=r-Math.sin(w)*a/n,S=i+Math.cos(w)*a;if(p=o?(h=s*n,l=Math.atan(h/a),c=(u=Math.sqrt(Math.tan(l)/2))/(1+u),f=2*Math.atan(c),d=.5*Math.PI-f,_=r-Math.cos(f)*a/n,i+Math.sin(f)*a):(d=Math.atan(M/(x-i)),_=r-Math.sin(d)*a/n,i+Math.cos(d)*a),w===d)return[[A,S]];var E=pe.h(Math.abs(w-d))*a,T=Math.sqrt(Math.pow(a,2)+Math.pow(E,2)),P=Math.atan(E/a),R=w-P,C=r-Math.sin(R)*T/n,O=i+Math.cos(R)*T,L=d+P;return[[_,p],[r-Math.sin(L)*T/n,i+Math.cos(L)*T],[C,O],[A,S]]}function Ie(t,e,r,i){0===i?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],r)):1===i?(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r)):2===i?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],r)):3===i?(t[0]=Math.max(t[0],e),t[1]=Math.min(t[1],r)):4===i?(t[0]=Math.max(t[0],e),t[1]=Math.max(t[1],r)):5===i||6===i?(t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],r)):7===i&&(t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r))}var Be={calPoints:function(t,e,r,i,n,a,o,s,h,l,u,c,f,d,_){var p=[];if(-1<["dashed","dotted"].indexOf(e)){var v=0===f||2===f?Me(e,n,a,o,s,t):Me(e,h,l,u,c,t),y=v.n,g=v.ps,m=v.pd;if(1<y){for(var b=0;b<y;b++){var x=b===y-1,k=void 0,M=void 0,w=void 0,A=(k=0===f||2===f?b?n+g*b+m*b:n:b?h+g*b+m*b:h)+g;0===f?A<=a?x?p.push([[n,h],[s,h],[o,l],[a,l]]):(M=h+(k-n)*Math.tan(r),w=h+(A-n)*Math.tan(r),p.push([[k,h],[A,h],[A,w],[k,M]])):o<=k?(M=h+(s-k)*Math.tan(i),w=h+(s-A)*Math.tan(i),x?p.push([[k,h],[s,h],[s,h],[k,M]]):p.push([[k,h],[A,h],[A,w],[k,M]])):k<a?(M=h+(k-n)*Math.tan(r),p.push([[k,h],[a,h],[a,l],[k,M]]),x?(p.push([[a,h],[o,h],[o,l],[a,l]]),p.push([[o,h],[s,h],[s,h],[a,l]])):o<A?(w=h+(s-A)*Math.tan(i),p.push([[a,h],[o,h],[o,l],[a,l]]),p.push([[o,h],[A,h],[A,w],[o,l]])):p.push([[a,h],[A,h],[A,l],[a,l]])):o<A?(M=h+(s-A)*Math.tan(i),k<a?(w=h+(k-n)*Math.tan(r),p.push([[k,h],[a,h],[a,l],[k,w]]),p.push([[a,h],[o,h],[o,l],[a,l]])):p.push([[k,h],[o,h],[o,l],[k,l]]),x?p.push([[o,h],[s,h],[s,h],[o,l]]):p.push([[o,h],[A,h],[A,M],[o,l]])):x?p.push([[k,h],[s,h],[o,l],[k,l]]):p.push([[k,h],[A,h],[A,l],[k,l]]):1===f?A<=l?x?p.push([[o,l],[s,h],[s,c],[o,u]]):(M=s-(k-h)*Math.tan(r),w=s-(A-h)*Math.tan(r),p.push([[M,k],[s,k],[s,A],[w,A]])):u<=k?(M=o+(k-u)*Math.tan(i),w=o+(A-u)*Math.tan(i),x?p.push([[M,k],[s,k],[s,c],[s,c]]):p.push([[M,k],[s,k],[s,A],[w,A]])):k<l?(M=o+(l-k)*Math.tan(r),p.push([[M,k],[s,k],[s,l],[o,l]]),x?(p.push([[o,l],[s,l],[s,u],[o,u]]),p.push([[o,u],[s,u],[s,c],[s,c]])):u<A?(w=o+(A-u)*Math.tan(i),p.push([[o,l],[s,l],[s,u],[o,u]]),p.push([[o,u],[s,u],[s,A],[w,A]])):p.push([[o,l],[s,l],[s,A],[o,A]])):u<A?(M=o+(A-u)*Math.tan(i),k<l?(w=o+(l-k)*Math.tan(r),p.push([[w,k],[s,k],[s,l],[o,l]]),p.push([[o,l],[s,l],[s,u],[o,u]]),x?p.push([[o,u],[s,u],[s,s],[s,s]]):p.push([[o,u],[s,u],[s,A],[M,A]])):(p.push([[o,k],[s,k],[s,u],[o,u]]),x?p.push([[o,u],[s,u],[s,c],[s,c]]):p.push([[o,u],[s,u],[s,A],[M,A]]))):x?p.push([[o,k],[s,k],[s,c],[o,u]]):p.push([[o,k],[s,k],[s,A],[o,A]]):2===f?A<=a?x?p.push([[n,c],[a,u],[o,u],[s,c]]):(M=c-(k-n)*Math.tan(r),w=c-(A-n)*Math.tan(r),p.push([[k,M],[A,w],[A,c],[k,c]])):o<=k?(M=c-(s-k)*Math.tan(i),w=c-(s-A)*Math.tan(i),x?p.push([[k,M],[s,c],[s,c],[k,c]]):p.push([[k,M],[A,w],[A,c],[k,c]])):k<a?(M=c-(k-n)*Math.tan(r),p.push([[k,M],[a,u],[a,c],[k,c]]),x?(p.push([[a,u],[o,u],[o,c],[a,c]]),p.push([[o,u],[s,c],[s,c],[o,c]])):o<A?(w=c-(A-o)*Math.tan(i),p.push([[a,u],[o,u],[o,c],[a,c]]),p.push([[o,u],[A,w],[A,c],[o,c]])):p.push([[a,u],[A,u],[A,c],[a,c]])):o<A?(M=c-(s-A)*Math.tan(i),k<a?(w=c-(k-o)*Math.tan(r),p.push([[k,w],[a,u],[a,c],[k,c]]),p.push([[a,u],[o,u],[o,c],[a,c]])):p.push([[k,u],[o,u],[o,c],[k,c]]),x?p.push([[o,u],[s,c],[s,c],[o,c]]):p.push([[o,u],[A,M],[A,c],[o,c]])):x?p.push([[k,u],[o,u],[s,c],[k,c]]):p.push([[k,u],[A,u],[A,c],[k,c]]):3===f&&(A<=l?x?p.push([[n,h],[a,l],[a,u],[n,c]]):(M=n+(k-h)*Math.tan(r),w=n+(A-h)*Math.tan(r),p.push([[n,k],[M,k],[w,A],[n,A]])):u<=k?(M=n+(c-k)*Math.tan(i),w=n+(c-A)*Math.tan(i),x?p.push([[n,k],[M,k],[n,c],[n,c]]):p.push([[n,k],[M,k],[w,A],[n,A]])):k<l?(M=n+(k-h)*Math.tan(r),p.push([[n,k],[M,k],[a,l],[n,l]]),x?(p.push([[n,l],[a,l],[a,u],[n,u]]),p.push([[n,u],[a,u],[n,c],[n,c]])):u<A?(w=n+(c-A)*Math.tan(i),p.push([[n,l],[a,l],[a,u],[n,u]]),p.push([[n,u],[a,u],[w,A],[n,A]])):p.push([[n,l],[a,l],[a,A],[n,A]])):u<A?(M=n+(c-A)*Math.tan(i),k<l?(w=n+(k-h)*Math.tan(r),p.push([[n,k],[w,k],[a,l],[n,h]]),p.push([[n,l],[a,l],[a,u],[n,u]])):p.push([[n,k],[a,k],[a,u],[n,u]]),x?p.push([[n,u],[a,u],[n,c],[n,c]]):p.push([[n,u],[a,u],[M,A],[n,A]])):x?p.push([[n,k],[a,k],[a,u],[n,c]]):p.push([[n,k],[a,k],[a,A],[n,A]]))}if(0===f)return we(t,r,i,n,a,o,s,h,l,0,0,p,d,_);if(1===f)return Ee(t,r,i,0,0,o,s,h,l,u,c,p,d,_);if(2===f)return Re(t,r,i,n,a,o,s,0,l,u,c,p,d,_);if(3===f)return Le(t,r,i,n,a,0,0,h,l,u,c,p,d,_)}}return 0===f?(n<a&&p.push([[n,h],[a,h],[a,l],[n,h]]),p.push([[a,h],[o,h],[o,l],[a,l]]),o<s&&p.push([[o,h],[s,h],[s,h],[o,l]]),we(t,r,i,n,a,o,s,h,l,0,0,p,d,_)):1===f?(h<l&&p.push([[s,h],[s,h],[s,l],[o,l]]),p.push([[o,l],[s,l],[s,u],[o,u]]),u<c&&p.push([[o,u],[s,u],[s,c],[s,c]]),Ee(t,r,i,0,0,o,s,h,l,u,c,p,d,_)):2===f?(n<a&&p.push([[n,c],[a,u],[a,c],[n,c]]),p.push([[a,u],[o,u],[o,c],[a,c]]),o<s&&p.push([[o,u],[s,c],[s,c],[o,c]]),Re(t,r,i,n,a,o,s,0,l,u,c,p,d,_)):3===f?(h<l&&p.push([[n,h],[n,h],[a,l],[n,l]]),p.push([[n,l],[a,l],[a,u],[n,u]]),u<c&&p.push([[n,u],[a,u],[n,c],[n,c]]),Le(t,r,i,n,a,0,0,h,l,u,c,p,d,_)):void 0},calRadius:function(t,e,r,i,n,a,o,s,h,l,u,c){var f,d=ue(h,2),_=d[0],p=d[1],v=ue(l,2),y=v[0],g=v[1],m=ue(u,2),b=m[0],x=m[1],k=ue(c,2),M=k[0],w=k[1];if(p-=n,y-=a,g-=n,b-=a,x-=o,M-=s,w-=o,(0<(_-=s)&&0<p||0<y&&0<g||0<b&&0<x||0<M&&0<w)&&(f=!0),f){var A=[];return 0<_&&0<p?(A.push([t,e+p]),A.push([t,e+p*(1-xe),t+_*(1-xe),e,t+_,e])):A.push([t,e]),0<y&&0<g?(A.push([t+r-y,e]),A.push([t+r-y*(1-xe),e,t+r,e+g*(1-xe),t+r,e+g])):A.push([t+r,e]),0<b&&0<x?(A.push([t+r,e+i-x]),A.push([t+r,e+i-x*(1-xe),t+r-b*(1-xe),e+i,t+r-b,e+i])):A.push([t+r,e+i]),0<M&&0<w?(A.push([t+M,e+i]),A.push([t+M*(1-xe),e+i,t,e+i-w*(1-xe),t,e+i-w])):A.push([t,e+i]),A}}},De=f.PERCENT,We=f.NUMBER;var Ge={matrixResize:function(t,e,r,i,n,a,o,s){if(t!==r||e!==i){var h=[["scaleX",{value:r/t,unit:We}],["scaleY",{value:i/e,unit:We}]],l=be.calOrigin([{value:0,unit:De},{value:0,unit:De}],o,s);return l[0]+=n,l[1]+=a,be.calMatrixWithOrigin(h,l,o,s)}}},He="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nvarying vec2 vTextureCoord;\nuniform mat3 projectionMatrix;\n\nvoid main(void)\n{\n  gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n  vTextureCoord = aTextureCoord;\n}",ze="\n#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 color = vec4(0.0);\n\n  // Sample top left pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample top right pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample bottom right pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Sample bottom left pixel\n  color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n  // Average\n  color *= 0.25;\n\n  gl_FragColor = color;\n}";function Ye(t,e,r){var i=function(t,e,r){var i=Xe(t,t.VERTEX_SHADER,e),n=Xe(t,t.FRAGMENT_SHADER,r);if(!i||!n)return null;var a=t.createProgram();if(!a)return null;if(t.attachShader(a,i),t.attachShader(a,n),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS))return a;var o=t.getProgramInfoLog(a);return console.error("Failed to link program: "+o),t.deleteProgram(a),t.deleteShader(n),t.deleteShader(i),null}(t,e,r);if(i)return t.useProgram(i),t.program=i,1;console.error("Failed to create program")}function Xe(t,e,r){var i=t.createShader(e);if(null==i)return console.error("unable to create shader"),null;if(t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;var n=t.getShaderInfoLog(i);return console.error("Failed to compile shader: "+n),t.deleteShader(i),null}function $e(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),e}var je=function(){function a(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;l(this,a),this.webgl=t;var i,n=this.gl=t.ctx;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,-1),Ye(n,He,ze),this.vertexLocations=function(t){var e=new Float32Array([-1,1,0,1,-1,-1,0,0,1,1,1,1,1,-1,1,0]),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);var i=Float32Array.BYTES_PER_ELEMENT,n=t.getAttribLocation(t.program,"aVertexPosition");t.vertexAttribPointer(n,2,t.FLOAT,!1,4*i,0),t.enableVertexAttribArray(n);var a=t.getAttribLocation(t.program,"aTextureCoord");t.vertexAttribPointer(a,2,t.FLOAT,!1,4*i,2*i);var o=t.getUniformLocation(t.program,"projectionMatrix");return t.uniformMatrix3fv(o,!1,new Float32Array([1,0,0,0,1,0,0,0,1])),t.enableVertexAttribArray(a),{aPosition:n,aTexCoord:a}}(n),this.textureLocations={uSampler:(i=n).getUniformLocation(i.program,"uSampler"),uOffset:i.getUniformLocation(i.program,"uOffset"),uClamp:i.getUniformLocation(i.program,"filterClamp")},this._pixelSize={x:0,y:0},this.pixelSize=1,this._kernels=null,this._blur=e,this.quality=r,this.textures=[],this.framebuffers=[]}return u(a,[{key:"initBuffers",value:function(t,e,r){for(var i=0;i<2;i++){var n=$e(t);this.textures.push(n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null);var a=t.createFramebuffer();this.framebuffers.push(a),t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}}},{key:"draw",value:function(t,e,r){var i=this.textureLocations,n=i.uOffset,a=i.uClamp,o=this.gl;o.uniform2f(n,e[0],e[1]),o.viewport(0,0,t.width,t.height),o.uniform4f(a,0,0,t.width,t.height),r&&o.bindFramebuffer(o.FRAMEBUFFER,null),o.drawArrays(o.TRIANGLE_STRIP,0,4)}},{key:"apply",value:function(t,e,r){var i=this.gl;this.initBuffers(i,e,r);var n=this.textureLocations.uSampler;i.uniform1i(n,0);var a=$e(i);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.canvas);var o,s=this._pixelSize.x/e,h=this._pixelSize.y/r,l=this._quality-1;i.bindTexture(i.TEXTURE_2D,a);for(var u=0;u<l;u++){o=this._kernels[u]+.5,i.bindFramebuffer(i.FRAMEBUFFER,this.framebuffers[u%2]);var c=new Float32Array([o*s,o*h]);this.draw(t.canvas,c,!1),i.bindTexture(i.TEXTURE_2D,this.textures[u%2])}o=this._kernels[l]+.5;var f=new Float32Array([o*s,o*h]);return this.draw(t.canvas,f,!0),this.webgl.draw(),t.ctx.clearRect(0,0,e,r),t.ctx.drawImage(i.canvas,0,0),t.draw(),this}},{key:"_generateKernels",value:function(){var t=this._blur,e=this._quality,r=[t];if(0<t)for(var i=t,n=t/e,a=1;a<e;a++)i-=n,r.push(i);this._kernels=r}},{key:"clear",value:function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}},{key:"kernels",get:function(){return this._kernels},set:function(t){Array.isArray(t)&&0<t.length?(this._kernels=t,this._quality=t.length,this._blur=Math.max.apply(Math,t)):(this._kernels=[0],this._quality=1)}},{key:"pixelSize",set:function(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):(this._pixelSize.x=1,this._pixelSize.y=1)},get:function(){return this._pixelSize}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this._generateKernels()}}]),a}();var Ve={gaussBlur:function(t,e,r,i,n){return new je(e,r).apply(t,i,n)}},qe={},Ue={};function Ze(t,e,r,i){var n=t?i[t]?i[t]:i[t]=document.createElement("canvas"):document.createElement("canvas");return n.setAttribute("width",e+"px"),n.setAttribute("height",r+"px"),"undefined"!=typeof karas&&karas.debug&&(n.style.width=e+"px",n.style.height=r+"px",n.setAttribute("type",i===qe?"canvas":"webgl"),t&&n.setAttribute("key",t),document.body.appendChild(n)),{canvas:n,ctx:i===qe?n.getContext("2d"):n.getContext("webgl")||n.getContext("experimental-webgl"),draw:function(){},available:!0,release:function(){this.canvas=null,this.ctx=null}}}var Ke,Je,Qe={},tr={measureText:function(t){var e=$t.MEASURE_TEXT,r=e.list,l=e.data,u="",c=[],f=[];if(Object.keys(l).forEach(function(t){var e=l[t],r=e.key,i=e.style,n=e.s;if(n)for(var a="position:absolute;font-family:".concat(i.fontFamily,";font-size:").concat(i.fontSize,"px;font-weight:").concat(i.fontWeight),o=0,s=n.length;o<s;o++){c.push(r);var h=n.charAt(o);f.push(h),u+='<span style="'.concat(a,'">').concat(h.replace(/</,"&lt;").replace(" ","&nbsp;"),"</span>")}}),u){var i=document.createElement("div");i.style.position="absolute",i.style.left="99999px",i.style.top="-99999px",i.style.visibility="hidden",document.body.appendChild(i),i.innerHTML=u;for(var n=i.childNodes,a=$t.CHAR_WIDTH_CACHE,o=$t.MEASURE_TEXT,s=0,h=n.length;s<h;s++){var d=n[s],_=c[s],p=f[s],v=window.getComputedStyle(d,null);a[_][p]=parseFloat(v.width)}r.forEach(function(t){return t.__measureCb()}),t(),o.list=[],o.data={},document.body.removeChild(i)}else t()},IMG:Qe,INIT:0,LOADED:2,LOADING:1,measureImg:function(t,e){var r,i,n=Qe[t]=Qe[t]||{state:0,task:[]};2===n.state?e(n):1===n.state?n.task.push(e):(n.state=1,n.task.push(e),(r=new Image).onload=function(){n.state=2,n.success=!0,n.width=r.width,n.height=r.height,n.source=r,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},r.onerror=function(){n.state=2,n.success=!1,n.url=t,n.task.splice(0).forEach(function(t){return t(n)})},"data:"===t.substr(0,5)||(i=/^(?:\w+:)?\/\/([^/:]+)/.exec(t))&&location.hostname!==i[1]&&(r.crossOrigin="anonymous"),r.src=t)},warn:function(t){console.warn(t)},requestAnimationFrame:(Je=function(t){var e;return"undefined"!=typeof requestAnimationFrame?(tr.requestAnimationFrame=requestAnimationFrame.bind(window),e=requestAnimationFrame(t)):(e=setTimeout(t,1e3/60),tr.requestAnimationFrame=function(t){return setTimeout(t,1e3/60)}),e},rr.toString=function(){return Je.toString()},rr),cancelAnimationFrame:(Ke=function(t){var e;return"undefined"!=typeof cancelAnimationFrame?(tr.cancelAnimationFrame=cancelAnimationFrame.bind(window),e=cancelAnimationFrame(t)):(e=clearTimeout(t),tr.cancelAnimationFrame=function(t){return clearTimeout(t)}),e},er.toString=function(){return Ke.toString()},er),now:function(){return"undefined"!=typeof performance?(tr.now=function(){return Math.floor(performance.now())},Math.floor(performance.now())):(tr.now=Date.now.bind(Date),Date.now())},hasCacheCanvas:function(t){return t&&qe.hasOwnProperty(t)},getCacheCanvas:function(t,e,r){return Ze(r,t,e,qe)},delCacheCanvas:function(t){t&&delete qe[t]},hasCacheWebgl:function(t){return t&&Ue.hasOwnProperty(t)},getCacheWebgl:function(t,e,r){return Ze(r,t,e,Ue)},delCacheWebgl:function(t){t&&delete Ue[t]},isDom:function(t){if(t){if(_e.isString(t))return!0;if("undefined"!=typeof window&&window.Element&&t instanceof window.Element)return!0;if(_e.isFunction(t.getElementsByTagName))return!0}return!1}};function er(t){return Ke.apply(this,arguments)}function rr(t){return Je.apply(this,arguments)}var ir=_e.isFunction,nr=function(){function o(){l(this,o),this.__eHash={}}return u(o,[{key:"on",value:function(t,e){if(e){var r=this;if(Array.isArray(t))for(var i=0,n=t.length;i<n;i++)r.on(t[i],e);else if(e){r.__eHash.hasOwnProperty(t)||(r.__eHash[t]=[]);for(var a=0,o=r.__eHash[t],s=o.length;a<s;a++)if(o[a]===e)return r;r.__eHash[t].push(e)}return r}}},{key:"once",value:function(i,n){if(ir(n)){var a=this;if(o.__karasEventCb=n,Array.isArray(i))for(var t=0,e=i.length;t<e;t++)a.once(i[t],n);else n&&a.on(i,o);return this}function o(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.apply(a,e),a.off(i,o)}}},{key:"off",value:function(t,e){if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++)this.off(t[r],e);else if(this.__eHash.hasOwnProperty(t))if(e){for(var n=0,a=this.__eHash[t],o=a.length;n<o;n++)if(a[n]===e||a[n].__karasEventCb===e){a.splice(n,1);break}}else delete this.__eHash[t];return this}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];if(Array.isArray(t))for(var n=0,a=t.length;n<a;n++)this.emit(t[n],r);else if(this.__eHash.hasOwnProperty(t)){var o=this.__eHash[t];if(o.length)for(var s=0,h=(o=o.slice()).length;s<h;s++){var l=o[s];ir(l)&&l.apply(this,r)}}return this}}],[{key:"mix",value:function(){for(var t=arguments.length-1;0<=t;t--){var e=t<0||arguments.length<=t?void 0:arguments[t],r=new o;e.__eHash={};for(var i=["on","once","off","emit"],n=i.length-1;0<=n;n--){var a=i[n];e[a]=r[a]}}}}]),o}();n(nr,"REFRESH","refresh"),n(nr,"PAUSE","pause"),n(nr,"PLAY","play"),n(nr,"FRAME","frame"),n(nr,"FINISH","finish"),n(nr,"CANCEL","cancel"),n(nr,"BEGIN","begin"),n(nr,"END","end");var ar,or=_e.isFunction;function sr(t,e,r){"before"===r?t.forEach(function(t){t&&or(t.before)&&t.before(e)}):"after"===r&&t.forEach(function(t){t&&or(t.after)?t.after(e):or(t)&&t(e)})}var hr=new(function(){function t(){l(this,t),this.__hookTask=[],this.__task=[],this.__taskBF=[],this.__now=null}return u(t,[{key:"__init",value:function(){var a=this,o=a.task,s=a.taskBF;tr.cancelAnimationFrame(a.id);var h=a.__now=tr.now();!function n(){tr.cancelAnimationFrame(a.id),a.id=tr.requestAnimationFrame(function(){var t,e,r,i;ar||!o.length&&!s.length||(t=a.__now=tr.now(),e=t-h,e=Math.max(e,0),h=t,r=s.slice(0),i=o.slice(0),r.forEach(function(t){t.before(e)}),sr(i,e,"before"),a.__hookTask.splice(0).forEach(function(t){return t()}),r.forEach(function(t){t.after(e)}),sr(i,e,"after"),(o.length||s.length)&&n())})}()}},{key:"onFrame",value:function(t){var e,r;t&&(e=this.task,r=this.taskBF,e.length||r.length||this.__init(),e.push(t))}},{key:"__onFrameBF",value:function(t){var e=this.task,r=this.taskBF;e.length||r.length||this.__init(),r.push(t)}},{key:"offFrame",value:function(t){if(t){for(var e=this.task,r=this.taskBF,i=0,n=e.length;i<n;i++){var a=e[i];if(a===t||a.__karasFramecb===t){e.splice(i,1);break}}e.length||r.length||(tr.cancelAnimationFrame(this.id),this.__now=null)}}},{key:"__offFrameBF",value:function(t){for(var e=this.task,r=this.taskBF,i=0,n=r.length;i<n;i++){if(r[i]===t){t.splice(i,1);break}}e.length||r.length||(tr.cancelAnimationFrame(this.id),this.__now=null)}},{key:"nextFrame",value:function(e){var r,i=this;e&&((r=or(e)?function(t){e(t),i.offFrame(r)}:{before:e.before,after:function(t){e.after&&e.after(t),i.offFrame(r)}}).__karasFramecb=e,this.onFrame(r))}},{key:"pause",value:function(){ar=!0}},{key:"resume",value:function(){ar&&(this.__init(),ar=!1)}},{key:"task",get:function(){return this.__task}},{key:"taskBF",get:function(){return this.__taskBF}}]),t}()),lr=4,ur=1e-7,cr=10,fr="function"==typeof Float32Array;function dr(t,e){return 1-3*e+3*t}function _r(t,e){return 3*e-6*t}function pr(t,e,r){return((dr(e,r)*t+_r(e,r))*t+3*e)*t}function vr(t,e,r){return 3*dr(e,r)*t*t+2*_r(e,r)*t+3*e}function yr(t){return t}function gr(a,e,o,r){if(!(0<=a&&a<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(a===e&&o===r)return yr;for(var s=new(fr?Float32Array:Array)(11),t=0;t<11;++t)s[t]=pr(.1*t,a,o);function i(t){for(var e=0,r=1;10!==r&&s[r]<=t;++r)e+=.1;var i=e+.1*((t-s[--r])/(s[r+1]-s[r])),n=vr(i,a,o);return.001<=n?function(t,e,r,i){for(var n=0;n<lr;++n){var a=vr(e,r,i);if(0===a)return e;e-=(pr(e,r,i)-t)/a}return e}(t,i,a,o):0===n?i:function(t,e,r,i,n){for(var a,o,s=0;0<(a=pr(o=e+(r-e)/2,i,n)-t)?r=o:e=o,Math.abs(a)>ur&&++s<cr;);return o}(t,e,e+.1,a,o)}return function(t){return 0===t||1===t?t:pr(i(t),e,r)}}var mr={linear:gr(1,1,0,0),easeIn:gr(.42,0,1,1),easeOut:gr(0,0,.58,1),ease:gr(.25,.1,.25,1),easeInOut:gr(.42,0,.58,1),cubicBezier:gr},br=f.AUTO,xr=f.PX,kr=f.PERCENT,Mr=f.INHERIT,wr=f.RGBA,Ar=f.STRING,Sr=f.NUMBER,Er=_e.isNil,Tr=_e.isFunction,Pr=_e.isNumber,Rr=_e.isObject,Cr=_e.clone,Or=_e.equalArr,Lr=mr.linear,Fr=mt.COLOR_HASH,Nr=mt.LENGTH_HASH,Ir=mt.RADIUS_HASH,Br=mt.GRADIENT_HASH,Dr=mt.EXPAND_HASH,Wr=mt.GRADIENT_TYPE;function Gr(t,e,r,i){r.__addUpdate({node:i,style:t}),e.__style=t,e.__assigning=!0,r.__frameHook()}function Hr(r,i,t,n){return t.forEach(function(t){var e=function(t,e,r,i){var n={k:r},a=t[r],o=e[r];if("transform"===r){if(!a&&!o)return;var s=a?a[0][1]:[1,0,0,1,0,0],h=o?o[0][1]:[1,0,0,1,0,0];if(Or(s,h))return;return n.v=[h[0]-s[0],h[1]-s[1],h[2]-s[2],h[3]-s[3],h[4]-s[4],h[5]-s[5]],n}if("filter"===r)a&&a.length?o&&o.length?n.v=o[0][1]-a[0][1]:n.v=-a[0][1]:n.v=o[0][1];else if("transformOrigin"===r){n.v=[];for(var l=0;l<2;l++){var u,c,f=a[l],d=o[l];f.unit===d.unit?n.v.push(d.value-f.value):f.unit===xr&&d.unit===kr?(u=.01*d.value*i[l?"outerHeight":"outerWidth"],n.v.push(u-f.value)):f.unit===kr&&d.unit===xr&&(c=100*d.value/i[l?"outerHeight":"outerWidth"],n.v.push(c-f.value))}if(Or(n.v,[0,0]))return}else if("backgroundPositionX"===r||"backgroundPositionY"===r){if(a.unit===o.unit&&-1<[xr,kr].indexOf(a.unit)){var _=o.value-a.value;if(0==_)return;n.v=_}else if(a.unit===xr&&o.unit===kr){var p=.01*o.value*i["backgroundPositionX"===r?"innerWidth":"innerHeight"];if(0==(p-=a.value))return;n.v=p}else if(a.unit===kr&&o.unit===xr){var v=100*o.value/i["backgroundPositionX"===r?"innerWidth":"innerHeight"];if(0==(v-=a.value))return;n.v=v}}else if("boxShadow"===r){n.v=[];for(var y=0,g=Math.min(a.length,o.length);y<g;y++){for(var m=a[y],b=o[y],x=[],k=0;k<4;k++)x.push(b[k]-m[k]);for(var M=[],w=0;w<4;w++)M.push(b[4][w]-m[4][w]);x.push(M),n.v.push(x)}}else if(Dr.hasOwnProperty(r)){if(a.unit===o.unit){var A=o.value-a.value;if(0==A)return;n.v=A}else if(a.unit===xr&&o.unit===kr){var S=.01*o.value*i[/\w+X$/.test(r)?"outerWidth":"outerHeight"];if(0==(S-=a.value))return;n.v=S}else if(a.unit===kr&&o.unit===xr){var E=100*o.value/i[/\w+X$/.test(r)?"outerWidth":"outerHeight"];if(0==(E-=a.value))return;n.v=E}}else if("backgroundSize"===r){n.v=[];for(var T=0;T<2;T++){var P=a[T],R=o[T];if(P.unit===R.unit&&-1<[xr,kr].indexOf(P.unit))n.v.push(R.value-P.value);else if(P.unit===xr&&R.unit===kr){var C=.01*R.value*i[T?"innerWidth":"innerHeight"];n.v.push(C-P.value)}else{if(P.unit!==kr||R.unit!==xr)return;var O=100*R.value/i[T?"innerWidth":"innerHeight"];n.v.push(O-P.value)}}if(Or(n.v,[0,0]))return}else if(Br.hasOwnProperty(r)){if(a.k!==o.k)return;if("linear"===a.k||"radial"===a.k){var L=a.v,F=o.v;if(Or(L,F))return;n.v=[];for(var N,I=i.innerWidth,B=0,D=Math.min(L.length,F.length);B<D;B++){var W=L[B],G=F[B],H=[];H.push([G[0][0]-W[0][0],G[0][1]-W[0][1],G[0][2]-W[0][2],G[0][3]-W[0][3]]),N=Or(H,[0,0,0,0]),W[1]&&G[1]?(W[1].unit===G[1].unit?H.push(G[1].value-W[1].value):W[1].unit===xr&&G[1].unit===kr?H.push(G[1].value*I*.01-W[1].value):W[1].unit===kr&&G[1].unit===xr&&H.push(100*G[1].value/I-W[1].value),N=N&&0===H[4]):(W[1]||G[1])&&(N=!1),n.v.push(H)}if("linear"===a.k){var z=o.d-a.d;if(N&&0==z)return;n.d=z}else{n.p=[];for(var Y=0;Y<2;Y++){var X,$,j=a.p[Y],V=o.p[Y];j.unit===V.unit?n.p.push(V.value-j.value):j.unit===xr&&V.unit===kr?(X=.01*V.value*i[Y?"innerWidth":"innerHeight"],n.p.push(X-j.value)):j.unit===kr&&V.unit===xr&&($=100*V.value/i[Y?"innerWidth":"innerHeight"],n.p.push($-j.value))}if(N&&Or(n.p,[0,0]))return}}else{if(Or(o,a))return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}}else if(Fr.hasOwnProperty(r)){if(o=o.value,a=a.value,Or(o,a)||0===o[3]&&0===a[3])return;n.v=[o[0]-a[0],o[1]-a[1],o[2]-a[2],o[3]-a[3]]}else if(Ir.hasOwnProperty(r)){if(o[0].value===a[0].value&&o[0].unit===a[0].unit&&o[1].value===a[1].value&&o[1].unit===a[1].unit)return;n.v=[];for(var q=0;q<2;q++)o[q].unit===a[q].unit?n.v.push(o[q].value-a[q].value):a[q].unit===xr&&o[q].unit===kr?n.v.push(.01*o[q].value*i[q?"outerHeight":"outerWidth"]-a[q].value):a[q].unit===kr&&o[q].unit===xr?n.v.push(100*o[q].value/i[q?"outerHeight":"outerWidth"]-a[q].value):n.v.push(0)}else if(Nr.hasOwnProperty(r)){if(a.unit===br||o.unit===br)return;var U,Z,K=i.computedStyle,J=(i.parent||i).computedStyle,Q=0;if(a.unit===o.unit?Q=o.value-a.value:a.unit===xr&&o.unit===kr?("fontSize"===r?U=o.value*J[r]*.01:"flexBasis"===r&&"row"===K.flexDirection||"width"===r||/margin/.test(r)||/padding/.test(r)||-1<["left","right"].indexOf(r)?U=o.value*J.width*.01:("flexBasis"===r||"height"===r||-1<["top","bottom"].indexOf(r))&&(U=o.value*J.height*.01),Q=U-a.value):a.unit===kr&&o.unit===xr?("fontSize"===r?Z=100*o.value/J[r]:"flexBasis"===r&&"row"===K.flexDirection||"width"===r||/margin/.test(r)||/padding/.test(r)||-1<["left","right"].indexOf(r)?Z=100*o.value/J.width:("flexBasis"===r||"height"===r||-1<["top","bottom"].indexOf(r))&&(Z=100*o.value/J.height),Q=Z-a.value):"lineHeight"===r&&(a.unit===xr&&o.unit===Sr?Q=o.value*K.fontSize-a.value:a.unit===Sr&&o.unit===xr&&(Q=o.value/K.fontSize-a.value)),0===Q||isNaN(Q))return;n.v=Q}else if(Ot.GEOM.hasOwnProperty(r)){if(Er(a))return;if(i.isMulti)if("points"===r||"controls"===r){if(Er(o)||Er(a)||Or(a,o))return;n.v=[];for(var tt=0,et=Math.min(a.length,o.length);tt<et;tt++){var rt=a[tt],it=o[tt];if(Er(rt)||Er(it))n.v.push(null);else{for(var nt=[],at=0,ot=Math.min(rt.length,it.length);at<ot;at++){var st=rt[at],ht=it[at];if(Er(st)||Er(ht))nt.push(null);else{for(var lt=[],ut=0,ct=Math.max(st.length,ht.length);ut<ct;ut++){var ft=st[ut],dt=ht[ut];Er(ft)||Er(dt)?lt.push(0):lt.push(dt-ft)}nt.push(lt)}}n.v.push(nt)}}}else if("controlA"===r||"controlB"===r){if(Er(o)||Er(a)||Or(a,o))return;n.v=[];for(var _t=0,pt=Math.min(a.length,o.length);_t<pt;_t++){var vt=a[_t],yt=o[_t];Er(vt)||Er(yt)?n.v.push(null):n.v.push([yt[0]-vt[0],yt[1]-vt[1]])}}else{if(o===a||Or(o,a)||"edge"===r||"closure"===r)return;for(var gt=[],mt=0,bt=Math.min(a.length,o.length);mt<bt;mt++){var xt=a[mt],kt=o[mt];(Er(xt)||Er(kt))&&gt.push(0),gt.push(kt-xt)}n.v=gt}else if("points"===r||"controls"===r){if(Er(o)||Er(a)||Or(a,o))return;n.v=[];for(var Mt=0,wt=Math.min(a.length,o.length);Mt<wt;Mt++){var At=a[Mt],St=o[Mt];if(Er(At)||Er(St))n.v.push(null);else{for(var Et=[],Tt=0,Pt=Math.max(At.length,St.length);Tt<Pt;Tt++){var Rt=At[Tt],Ct=St[Tt];Er(Rt)||Er(Ct)?Et.push(0):Et.push(Ct-Rt)}n.v.push(Et)}}}else if("controlA"===r||"controlB"===r){if(Er(o)||Er(a)||Or(a,o))return;n.v=[o[0]-a[0],o[1]-a[1]]}else{if(o===a||"edge"===r||"closure"===r)return;n.v=o-a}}else{if("opacity"!==r&&"zIndex"!==r)return;if(o===a)return;n.v=o-a}return n}(r.style,i.style,t,n);e&&r.transition.push(e)}),i}function zr(t,y,g){var e,r,i,n,a,m=Cr(t.style),o=((e=t.easing)&&(i=/^\s*(?:cubic-bezier\s*)?\(\s*[\d.]+\s*,\s*[-\d.]+\s*,\s*[\d.]+\s*,\s*[-\d.]+\s*\)\s*$/i.test(e)?(r=e.match(/[\d.]+/g),mr.cubicBezier(r[0],r[1],r[2],r[3])):(i=/^\s*steps\s*\(\s*(\d+)(?:\s*,\s*(\w+))?\s*\)/i.exec(e))?(n=parseInt(i[1]),a=i[2],function(t){if(n&&0<n){var e=1/n;return("start"===a?Math.ceil(t/e):Math.floor(t/e))/n}return t}):mr[e]),i);o&&o!==Lr&&(y=o(y));for(var s=t.transition,h=0,l=s.length;h<l;h++){var u=s[h],b=u.k,x=u.v,c=u.d,f=u.p,d=m[b];if("transform"===b){d=d||(m[b]=[["matrix",[1,0,0,1,0,0]]]);for(var _=0;_<6;_++)d[0][1][_]+=x[_]*y}else if("filter"===b)(d=d||(m[b]=[["blur",0]]))[0][1]+=x*y;else if(Ir.hasOwnProperty(b))for(var p=0;p<2;p++)d[p].value+=x[p]*y;else if("backgroundPositionX"===b||"backgroundPositionY"===b||Nr.hasOwnProperty(b)||Dr.hasOwnProperty(b))0!==x&&(d.value+=x*y);else if("transformOrigin"===b||"backgroundSize"===b)0!==x[0]&&(d[0].value+=x[0]*y),0!==x[1]&&(d[1].value+=x[1]*y);else if("boxShadow"===b)for(var v=0,k=Math.min(d.length,x.length);v<k;v++){for(var M=0;M<4;M++)d[v][M]+=x[v][M]*y;for(var w=0;w<4;w++)d[v][4][w]+=x[v][4][w]*y}else if(Br.hasOwnProperty(b))if(Wr.hasOwnProperty(d.k)){for(var A=0,S=Math.min(d.v.length,x.length);A<S;A++){var E=d.v[A],T=x[A];E[0][0]+=T[0][0]*y,E[0][1]+=T[0][1]*y,E[0][2]+=T[0][2]*y,E[0][3]+=T[0][3]*y,E[1]&&T[1]&&(E[1].value+=T[1]*y)}"linear"===d.k&&void 0!==d.d&&void 0!==c&&(d.d+=c*y),"radial"===d.k&&void 0!==d.p&&void 0!==f&&(d.p[0].value+=f[0]*y,d.p[1].value+=f[1]*y)}else d[0]+=x[0]*y,d[1]+=x[1]*y,d[2]+=x[2]*y,d[3]+=x[3]*y;else Fr.hasOwnProperty(b)?((d=d.value)[0]+=x[0]*y,d[1]+=x[1]*y,d[2]+=x[2]*y,d[3]+=x[3]*y):Ot.GEOM.hasOwnProperty(b)?function(){var s=m[b];if(g.isMulti)if("points"===b||"controls"===b)for(var t=0,e=Math.min(s.length,x.length);t<e;t++){var r=s[t],i=x[t];if(!Er(r)&&!Er(i))for(var n=0,a=Math.min(r.length,i.length);n<a;n++){var o=r[n],h=i[n];if(!Er(o)&&!Er(h))for(var l=0,u=Math.min(o.length,h.length);l<u;l++)Er(o[l])||Er(h[l])||(o[l]+=h[l]*y)}}else"controlA"===b||"controlB"===b?x.forEach(function(t,e){var r=s[e];if(!Er(t)&&!Er(r))for(var i=0,n=Math.min(r.length,t.length);i<n;i++){var a=r[i],o=t[i];Er(a)||Er(o)||(r[i]+=o*y)}}):x.forEach(function(t,e){Er(t)||Er(s[e])||(s[e]+=t*y)});else if("points"===b||"controls"===b)for(var c=0,f=Math.min(s.length,x.length);c<f;c++){var d=s[c],_=x[c];if(!Er(d)&&!Er(_))for(var p=0,v=Math.min(d.length,_.length);p<v;p++)Er(d[p])||Er(_[p])||(d[p]+=_[p]*y)}else"controlA"===b||"controlB"===b?(Er(s[0])||Er(x[0])||(s[0]+=x[0]*y),Er(s[1])||Er(x[1])||(s[1]+=x[1]*y)):Er(s)||Er(x)||(m[b]+=x*y)}():"opacity"!==b&&"zIndex"!==b||(m[b]+=x*y)}return m}function Yr(t,e){return Tr(t)&&(e=t,t={}),[t||{},e]}var Xr=0,$r=function(){t(s,nr);var o=e(s);function s(t,n,e){var r,a;l(this,s),(r=o.call(this)).__id=Xr++,r.__target=t,r.__root=t.root,n=Cr(n||[]),Array.isArray(n)?r.__list=n.filter(function(t){return t&&Rr(t)}):n&&Rr(n)?(a=[],Object.keys(n).forEach(function(t){var e=n[t];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){(a[r]=a[r]||{offset:r/(i-1)})[t]=e[r]}}),r.__list=a):r.__list=[],Pr(e)&&(r.__options={duration:e},e=r.__options);var i=r.__options=e||{};return r.__duration=Math.max(0,parseFloat(i.duration)||0),r.delay=i.delay,r.endDelay=i.endDelay,r.iterations=i.iterations,r.fps=i.fps,r.fill=i.fill,r.direction=i.direction,r.playbackRate=i.playbackRate,r.__easing=i.easing,r.__playCount=0,r.spfLimit=i.spfLimit,r.__frames=[],r.__framesR=[],r.__startTime=null,r.currentTime=0,r.__nextTime=0,r.__fpsTime=0,r.__playState="idle",r.__isDestroyed=!1,r.__style={},r.__assigning=!1,r.__init(),r}return u(s,[{key:"__init",value:function(){var t=this.iterations,o=this.duration,i=this.list,s=this.easing,e=this.target;if(!(t<1||i.length<1)){for(var r,n=e.tagName,a=0,h=i.length;a<h;a++)(function(t,e){var r=i[t];if(r.hasOwnProperty("offset")){if(r.offset=parseFloat(r.offset)||0,r.offset=Math.max(0,r.offset),r.offset=Math.min(1,r.offset),isNaN(r.offset)||r.offset<0||1<r.offset)return i.splice(t,1),a=--t,h=--e;if(r.offset<=-1)return i.splice(t,1),a=--t,h=--e}Object.keys(r).forEach(function(t){ot.hasOwnProperty(t)&&ot.toFull(r,t)}),Object.keys(r).forEach(function(t){"easing"===t||"offset"===t||Ot.isValid(n,t)||delete r[t]}),a=t,h=e})(a,h);1===i.length?(i[0]=Cr(i[0]),1===i[0].offset?i.unshift({offset:0}):((r=Cr(i[0])).offset=1,i.push(r))):i.forEach(function(t,e){i[e]=Cr(t)});var l=i[0];l.hasOwnProperty("offset")&&0<l.offset?(l={offset:0},i.unshift(l)):l.offset=0;var u=i[i.length-1];u.hasOwnProperty("offset")&&u.offset<1?(u={offset:1},i.push(u)):u.offset=1;for(var c=1,f=i.length;c<f;c++){if(!(v=i[c]).hasOwnProperty("offset")){for(var d=void 0,_=c+1;_<f&&!(d=i[_]).hasOwnProperty("offset");_++);for(var p=_-c+1,v=i[c-1],y=(d.offset-v.offset)/p,g=c;g<_;g++){i[g].offset=v.offset+y*(g+1-c)}c=_}}var m=[];i.forEach(function(t){var e,r,i,n,a;m.push((r=o,i=s,n=(e=t).offset,a=e.easing,delete e.offset,delete e.easing,{style:e=Yt.normalize(e),time:n*r,easing:a||i,transition:[]}))}),this.__frames=m;var b,x,k,M,w,A,S,E,T=this.__keys=(x=e,k={},M=[],(b=m).forEach(function(t){var r=t.style;Object.keys(r).forEach(function(t){var e=r[t];Er(e)||k.hasOwnProperty(t)||(k[t]=!0,M.push(t))})}),b.forEach(function(t){var e=t.style;M.forEach(function(t){e.hasOwnProperty(t)&&!Er(e[t])||(Ot.GEOM.hasOwnProperty(t)?e[t]=x.currentProps[t]:e[t]=x.currentStyle[t])})}),M);w=m,A=T,E=(S=e).computedStyle,w.forEach(function(t){var a=t.style;A.forEach(function(t){var e,r,i,n=a[t];Er(n)||("transform"===t?(e=S.outerWidth,r=S.outerHeight,i=be.calMatrix(n,e,r),a[t]=[["matrix",i]]):n.unit===Mr&&("color"===t?a[t]={value:_e.rgba2int(E[t]),unit:wr}:Nr.hasOwnProperty(t)?a[t]={value:E[t],unit:xr}:"fontWeight"===t?a[t]={value:E[t],unit:Sr}:"fontStyle"!==t&&"fontFamily"!==t&&"textAlign"!==t||(a[t]={value:E[t],unit:Ar})))})});var P=e.style,R=e.props,C=this.__originStyle={};T.forEach(function(t){Ot.isGeom(n,t)&&(C[t]=R[t]),C[t]=P[t]});for(var O=m.length,L=m[0],F=1;F<O;F++)L=Hr(L,m[F],T,e);var N=Cr(m).reverse();N.forEach(function(t){t.time=o-t.time,t.transition=[]}),L=N[0];for(var I=1;I<O;I++){L=Hr(L,N[I],T,e)}this.__framesR=N}}},{key:"__clean",value:function(t){var e;this.__cancelTask(),this.__nextTime=0;var r=this.style,i=this.duration,n=this.iterations,a=this.keys,o=this.target;t?(this.__currentTime=this.delay+i+this.endDelay,this.__playCount=n,this.__playState="finished",this.__stayEnd()||(this.__style={},e=!0)):(this.__playCount=this.__currentTime=0,this.__playState="idle",this.__style={},e=!0),e&&(this.__currentFrames=void 0,this.__currentFrame=void 0,a.forEach(function(t){Ot.GEOM.hasOwnProperty(t)?o.__currentProps[t]===r[t]&&(o.__currentProps[t]=o.props[t]):o.__currentStyle[t]===r[t]&&(o.__currentStyle[t]=o.style[t])}))}},{key:"__fin",value:function(t,e){this.__hasFin||(this.__hasFin=!0,this.__begin=this.__end=this.__isDelay=this.__finish=this.__inFps=this.__enterFrame=null,this.emit(nr.FINISH)),Tr(t)&&t.call(this,e)}},{key:"__frameCb",value:function(t,e){this.emit(nr.FRAME,t,e),this.__firstPlay&&(this.__firstPlay=!1,this.emit(nr.PLAY)),Tr(this.__playCb)&&(this.__playCb.call(this,t,e),this.__playCb=null)}},{key:"__calDiffTime",value:function(t){var e=this.playbackRate,r=this.spfLimit,i=this.fps,n=this.__currentTime=this.__nextTime;return r&&(!0===r?t=Math.min(t,1e3/i):0<r&&(t=Math.min(t,r))),1!==e&&0<e&&(t*=e),this.__nextTime+=t,n}},{key:"play",value:function(t){var d=this,e=this.isDestroyed,_=this.duration,r=this.playState,i=this.list;if(e||_<=0||i.length<1)return this;if("running"===r)return this;this.__cancelTask(),this.__playCb=t,this.__playState="running",this.__firstPlay=!0,this.__hasFin=!1;var p,n,a,v,y,g,m,b,x,k,M,w,o,s,A,S,E,T=!(this.__hasCancel=!1);return this.__enterFrame||(p=this.frames,n=this.framesR,a=this.direction,v=this.delay,y=this.endDelay,g=this.root,m=p.length,b=2===m,o={alternate:!0,"alternate-reverse":!0}.hasOwnProperty(a),s=this.__currentFrames={reverse:!0,"alternate-reverse":!0}.hasOwnProperty(a)?n:p,b&&(M=s[1].time,w=1/M),A=this.__stayEnd(),S=this.__stayBegin(),this.__currentTime=this.__nextTime=this.__fpsTime=0,E=this.__enterFrame={before:function(t){var e,r=d.target,i=d.fps,n=d.playCount,a=d.iterations,o=d.currentFrames,s=d.__calDiffTime(t);if(!T&&i<60){if((t=d.__fpsTime+=t)<1e3/i)return void(d.__inFps=!0);d.__fpsTime=0}if(T=!1,0<n)v=0;else if(s<v){return S&&Gr(p[0].style,d,g,r),0===s&&(d.__begin=!0),void(d.__isDelay=!0)}0===(s-=v)&&(d.__begin=!0),e=b?s<M?0:1:function t(e,r,i,n){if(e===r)return n[e].time>i?e-1:e;var a=e+(r-e>>1),o=n[a];return o.time===i?a:o.time>i?t(e,Math.max(a-1,e),i,n):t(Math.min(a+1,r),r,i,n)}(0,m-1,s,o),l=x!==e?(x=e,d.__currentFrame=k=o[e]):k;var h,l,u,c=e===m-1,f=a-1<=n;c?(h=s<_+y,l=A||!f?l.style:d.__originStyle,f?h||(d.__nextTime=0,a<=(n=++d.__playCount)&&hr.offFrame(E)):(d.__nextTime=s-_,n=++d.__playCount,d.__nextBegin=!0)):l=b?zr(l,s*w,r):(u=o[e+1].time-l.time,zr(l,(s-l.time)/u,r)),Gr(l,d,g,r),!c||h&&!f||(d.__end=!0,a<=n&&(d.__finish=!0,d.__clean(!0)))},after:function(t){var e;d.__assigning=!1,d.__inFps?d.__inFps=!1:(d.__frameCb(t,d.__isDelay),d.__isDelay=!1,d.__begin&&(d.__begin=!1,d.emit(nr.BEGIN,d.playCount)),d.__end&&(d.__end=!1,d.emit(nr.END,d.playCount-1),o&&(e=d.playCount%2==0,d.__currentFrames="alternate"===a?e?p:n:e?n:p)),d.__finish&&(d.__finish=!1,d.__fin()),d.__nextBegin&&(d.__nextBegin=!1,d.__begin=!0))}}),hr.offFrame(this.__enterFrame),hr.onFrame(this.__enterFrame),this.__startTime=hr.__now,this}},{key:"pause",value:function(t){var e=this.isDestroyed,r=this.duration,i=this.pending;return e||r<=0||i||(this.__playState="paused",this.__cancelTask(),t||this.emit(nr.PAUSE)),this}},{key:"resume",value:function(t){var e=this.isDestroyed,r=this.duration,i=this.playState;return e||r<=0||"paused"!==i?this:this.play(t)}},{key:"finish",value:function(e){var r=this,t=r.isDestroyed,i=r.duration,n=r.playState,a=r.list;if(t||i<=0||a.length<1||"finished"===n||"idle"===n)return r;r.__cancelTask();var o,s=r.root,h=r.frames,l=r.__originStyle;if(s){if(r.__hasFin)return r.__fin(e,0),r;o=r.__stayEnd()?h[h.length-1].style:l,s.addRefreshTask({before:function(){Gr(o,r,s,r.target),r.__clean(!0)},after:function(t){r.__assigning=!1,r.__frameCb(t),r.__fin(e,t)}})}return r}},{key:"cancel",value:function(r){var i=this,t=i.isDestroyed,e=i.duration,n=i.playState,a=i.list;if(t||e<=0||"idle"===n||a.length<1)return i;i.__cancelTask();var o=i.root,s=i.__originStyle;if(o){if(i.__hasCancel)return Tr(r)&&r.call(i,0),i;o.addRefreshTask({before:function(){Gr(s,i,o,i.target),i.__clean()},after:function(t){var e;i.__assigning=!1,i.__frameCb(t),e=t,i.__hasCancel||(i.__hasCancel=!0,i.__cancelTask(),i.__begin=i.__end=i.__isDelay=i.__finish=i.__inFps=i.__enterFrame=null,i.emit(nr.CANCEL)),Tr(r)&&r.call(i,e)}})}return i}},{key:"gotoAndPlay",value:function(t,e,r){var i=this.isDestroyed,n=this.duration,a=this.delay,o=this.endDelay;if(i||n<=0)return this;var s=ue(Yr(e,r),2);return e=s[0],r=s[1],this.__goto(t,e.isFrame,e.excludeDelay),n+a+o<t?this.finish(r):this.play(r)}},{key:"gotoAndStop",value:function(t,e,r){var i=this,n=this.isDestroyed,a=this.duration,o=this.delay,s=this.endDelay;if(n||a<=0)return this;var h=ue(Yr(e,r),2);return e=h[0],r=h[1],a+o+s<(t=this.__goto(t,e.isFrame,e.excludeDelay))?this.finish(r):this.play(function(t){i.__playState="paused",i.__cancelTask(),Tr(r)&&r.call(i,t)})}},{key:"assignCurrentStyle",value:function(){var r=this.style,i=this.target;this.keys.forEach(function(t){var e;r.hasOwnProperty(t)&&(e=r[t],Ot.GEOM.hasOwnProperty(t)?i.currentProps[t]=e:i.currentStyle[t]=e)})}},{key:"__goto",value:function(t,e,r){var i=this.duration,n=this.iterations,a=this.delay;if(this.__playState="paused",this.__cancelTask(),isNaN(t)||t<0)throw new Error("Param of gotoAnd(Play/Stop) is illegal: "+t);for(e&&(t=(t-1)/this.spf),r&&(t+=a);i<t&&this.playCount<n-1;)this.__playCount++,t-=i;return this.__nextTime=t}},{key:"addControl",value:function(){var t=this.root.animateController;t&&t.add(this)}},{key:"removeControl",value:function(){var t=this.root.animateController;t&&t.remove(this)}},{key:"__stayBegin",value:function(){return{backwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__stayEnd",value:function(){return{forwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__cancelTask",value:function(){hr.offFrame(this.__enterFrame),this.__playCb=null}},{key:"__destroy",value:function(t){var e=this;e.removeControl(),t?(e.__clean&&e.__clean(),e.__target=null):hr.nextFrame({before:function(){e.__clean&&e.__clean(),e.__target=null}}),e.__startTime=null,e.__isDestroyed=!0}},{key:"id",get:function(){return this.__id}},{key:"target",get:function(){return this.__target}},{key:"root",get:function(){return this.__root}},{key:"keys",get:function(){return this.__keys}},{key:"style",get:function(){return this.__style}},{key:"list",get:function(){return this.__list}},{key:"options",get:function(){return this.__options}},{key:"duration",get:function(){return this.__duration},set:function(t){this.__duration=Math.max(0,parseFloat(t)||0)}},{key:"delay",get:function(){return this.__delay},set:function(t){this.__delay=Math.max(0,parseFloat(t)||0)}},{key:"endDelay",get:function(){return this.__endDelay},set:function(t){this.__endDelay=Math.max(0,parseFloat(t)||0)}},{key:"fps",get:function(){return this.__fps},set:function(t){(t=parseInt(t)||60)<=0&&(t=60),this.__fps=t}},{key:"spf",get:function(){return 1/this.fps}},{key:"iterations",get:function(){return this.__iterations},set:function(t){t===1/0||_e.isString(t)&&"infinity"===t.toLowerCase()?t=1/0:(t=parseInt(t),(isNaN(t)||t<0)&&(t=1)),this.__iterations=t}},{key:"fill",get:function(){return this.__fill},set:function(t){this.__fill=t||"none","running"===this.playState&&(this.pause(!0),this.resume())}},{key:"direction",get:function(){return this.__direction},set:function(t){this.__direction=t||"normal","running"===this.playState&&(this.pause(!0),this.resume())}},{key:"frames",get:function(){return this.__frames}},{key:"framesR",get:function(){return this.__framesR}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(t){(t=parseFloat(t)||1)<=0&&(t=1),this.__playbackRate=t}},{key:"easing",get:function(){return this.__easing}},{key:"startTime",get:function(){return this.__startTime}},{key:"currentTime",get:function(){return this.__currentTime},set:function(t){0<=(t=parseFloat(t)||0)&&(this.__currentTime=this.__nextTime=t)}},{key:"pending",get:function(){return"running"!==this.playState}},{key:"finished",get:function(){return"finished"===this.playState}},{key:"playState",get:function(){return this.__playState}},{key:"playCount",get:function(){return this.__playCount}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"animating",get:function(){var t=this.playState;return"idle"!==t&&("finished"!==t||this.__stayEnd())}},{key:"spfLimit",get:function(){return this.__spfLimit},set:function(t){_e.isNumber(t)||/^\d/.test(t)?this.__spfLimit=Math.max(t,parseInt(t)||0):this.__spfLimit=!!t}},{key:"assigning",get:function(){return this.__assigning}},{key:"currentFrames",get:function(){return this.__currentFrames}},{key:"currentFrame",get:function(){return this.__currentFrame}}]),s}(),jr={NONE:0,TRANSLATE_X:1,TRANSLATE_Y:2,TRANSFORM:4,OPACITY:8,FILTER:16,VISIBILITY:32,REPAINT:64,REFLOW:128},Vr={scaleX:!0,scaleY:!0,rotateZ:!0,transform:!0,transformOrigin:!0},qr=Object.assign({contain:function(t,e){return 0<(t&e)},getLevel:function(t){return Ot.isIgnore(t)?jr.NONE:"translateX"===t?jr.TRANSLATE_X:"translateY"===t?jr.TRANSLATE_Y:Vr.hasOwnProperty(t)?jr.TRANSFORM:"opacity"===t?jr.OPACITY:"filter"===t?jr.FILTER:Ot.isRepaint(t)?jr.REPAINT:jr.REFLOW},isReflow:function(t){return!this.isRepaint(t)},isRepaint:function(t){return t<jr.REFLOW}},jr);qr.TRANSFORMS=Vr;var Ur=[8,16,32,64,128,256,512,1024,2048,4096],Zr=[8,8,8,8,8,8,8,4,2,1],Kr=4096,Jr={},Qr=function(){function c(t,e){l(this,c),this.__size=t,this.__number=e,this.__free=this.__total=e*e,t*=e;var r=this.__canvas=tr.getCacheCanvas(t,t);r&&(this.__offScreen=r),this.__grid=[];for(var i=0;i<this.__total;i++)this.__grid.push(1)}return u(c,[{key:"add",value:function(){for(var t=this.number,e=this.grid,r=0;r<t;r++)for(var i=0;i<t;i++){var n=r*t+i;if(e[n])return e[n]=0,this.__free--,n}throw new Error("Can not find free page")}},{key:"del",value:function(t){this.grid[t]=1,this.__free++}},{key:"getCoords",value:function(t){var e=this.size,r=this.number;return[t%r*e,Math.floor(t/r)*e]}},{key:"size",get:function(){return this.__size}},{key:"number",get:function(){return this.__number}},{key:"total",get:function(){return this.__total}},{key:"free",get:function(){return this.__free}},{key:"grid",get:function(){return this.__grid}},{key:"offScreen",get:function(){return this.__offScreen}},{key:"canvas",get:function(){return this.offScreen.canvas}},{key:"ctx",get:function(){return this.offScreen.ctx}}],[{key:"getInstance",value:function(t){if(!(Kr<t)){for(var e=Ur[0],r=Zr[0],i=0,n=Ur.length;i<n&&(e=Ur[i],r=Zr[i],!(Ur[i]>=t));i++);for(var a,o=Jr[e]=Jr[e]||[],s=0,h=o.length;s<h;s++){var l=o[s];if(l.free){a=l;break}}if(!a){if(!(a=new c(e,r)).offScreen)return void console.error("Can not create off-screen for page");o.push(a)}var u=a.add();return{page:a,pos:u}}}},{key:"MAX",set:function(t){for(var e=t;2<e;)e%=2;if(0===e)if(t<8)console.error("Page max-size must >= 8");else for(Kr=t,e=1,Ur=[],Zr=[];Ur.unshift(t),Zr.unshift(e),e<8&&(e<<=1),!((t>>=1)<8););else console.error("Page max-size must be a multiple of 2")},get:function(){return Kr}}]),c}(),ti=function(){function p(t,e,r,i,n){l(this,p),this.__init(t,e,r,i,n)}return u(p,[{key:"__init",value:function(t,e,r,i,n){this.__width=t,this.__height=e,this.__bbox=r,this.__page=i,this.__pos=n;var a,o=ue(i.getCoords(n),2),s=o[0],h=o[1];this.__coords=[s+1,h+1],i.canvas&&(this.__enabled=!0,(a=i.ctx).setTransform([1,0,0,1,0,0]),a.globalAlpha=1,"undefined"!=typeof karas&&karas.debug&&(i.canvas.setAttribute("size",i.size),a.fillStyle="rgba(0, 0, 0, 0.1)",a.beginPath(),a.rect(s+1,h+1,i.size-2,i.size-2),a.closePath(),a.fill()))}},{key:"__appendData",value:function(t,e){this.x1=t,this.y1=e;var r=ue(this.coords,2),i=r[0],n=r[1],a=this.bbox;this.dx=i-a[0],this.dy=n-a[1],this.dbx=t-a[0],this.dby=e-a[1]}},{key:"clear",value:function(){var t,e,r,i,n=this.ctx;this.enabled&&n&&this.available&&(n.setTransform([1,0,0,1,0,0]),e=(t=ue(this.coords,2))[0],r=t[1],i=this.page.size,n.clearRect(e-1,r-1,i,i)),this.__available=!1}},{key:"release",value:function(){this.enabled&&(this.clear(),this.page.del(this.pos),this.__page=null,this.__enabled=!1)}},{key:"reset",value:function(t){var e,r,i,n,a;_e.equalArr(this.bbox,t)&&this.enabled?this.clear():(this.release(),e=Math.ceil(t[2]-t[0]),r=Math.ceil(t[3]-t[1]),e+=2,r+=2,(i=Qr.getInstance(Math.max(e,r)))?(n=i.page,a=i.pos,this.__init(e,r,t,n,a)):this.__enabled=!1)}},{key:"enabled",get:function(){return this.__enabled}},{key:"available",get:function(){return this.enabled&&this.__available}},{key:"bbox",get:function(){return this.__bbox}},{key:"page",get:function(){return this.__page}},{key:"canvas",get:function(){return this.page.canvas}},{key:"ctx",get:function(){return this.page.ctx}},{key:"size",get:function(){return this.page.size}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"pos",get:function(){return this.__pos}},{key:"coords",get:function(){return this.__coords}}],[{key:"getInstance",value:function(t){var e=Math.ceil(t[2]-t[0]),r=Math.ceil(t[3]-t[1]);e+=2,r+=2;var i=Qr.getInstance(Math.max(e,r));if(i)return new p(e,r,t,i.page,i.pos)}},{key:"genMask",value:function(t){var e=t.size,r=t.x1,i=t.y1,n=t.width,a=t.height,o=tr.getCacheCanvas(n,a);return o.coords=[1,1],o.size=e,o.x1=r,o.y1=i,o.dbx=t.dbx,o.dby=t.dby,o.width=n,o.height=a,o}},{key:"genOffScreenBlur",value:function(t,e){var r=ue(t.coords,2),i=r[0],n=r[1],a=t.size,o=t.canvas,s=t.x1,h=t.y1,l=t.width,u=t.height,c=tr.getCacheCanvas(l,u);c.ctx.drawImage(o,i-1,n-1,l,u,0,0,l,u),c.draw();var f=tr.getCacheWebgl(l,u);return Ve.gaussBlur(c,f,e,l,u),f.coords=[1,1],f.size=a,f.x1=s,f.y1=h,f.dbx=t.dbx,f.dby=t.dby,f.width=l,f.height=u,f}},{key:"updateCache",value:function(t,e){var r=t.bbox;if(_e.equalArr(e,r))return t;var i=r[0]-e[0],n=r[1]-e[1],a=p.getInstance(e);if(a&&a.enabled){var o=ue(t.coords,2),s=o[0],h=o[1],l=t.canvas,u=t.width,c=t.height,f=ue(a.coords,2),d=f[0],_=f[1];return a.x1=t.x1,a.y1=t.y1,a.dx=t.dx+i,a.dy=t.dy+n,a.dbx=t.dbx+i,a.dby=t.dby+n,a.ctx.drawImage(l,s-1,h-1,u,c,i+d-1,n+_-1,u,c),a.__available=!0,t.release(),a}}},{key:"drawCache",value:function(t,e,r,i,n,a){var o,s=ue(e.coords,2),h=s[0],l=s[1],u=e.x1,c=e.y1,f=e.ctx,d=e.dbx,_=e.dby,p=ue(t.coords,2),v=p[0],y=p[1],g=t.canvas,m=t.x1,b=t.y1,x=t.dbx,k=t.dby,M=t.width,w=t.height,A=h+m-u+d-x,S=l+b-c+_-k;r&&i&&n&&(n[0]+=A,n[1]+=S,o=be.calMatrixByOrigin(r,n),i=de.multiply(i,o),a&&(i=_e.equalArr(i,a)?[1,0,0,1,0,0]:(a=de.inverse(a),de.multiply(i,a))),f.setTransform.apply(f,ce(i))),f.drawImage(g,v-1,y-1,M,w,A-1,S-1,M,w)}},{key:"drawMask",value:function(t,e,r,i){for(var n=p.genMask(t),a=[];e&&(e.isMask||e.isClip);)a.push(e),e=e.next;var o=ue(n.coords,2),s=o[0],h=o[1],l=n.ctx,u=n.dbx,c=n.dby;i[0]+=s+u,i[1]+=h+c;var f=be.calMatrixByOrigin(r,i);return a.forEach(function(t){var e=t.__cacheFilter,r=t.__cache,i=e&&e.available&&e;(i=i||r&&r.available&&r)?(l.globalAlpha=t.__opacity,p.drawCache(i,n,t.computedStyle.transform,[1,0,0,1,0,0],t.computedStyle.transformOrigin.slice(0),f)):console.error("CacheMask is oversize")}),l.setTransform(1,0,0,1,0,0),l.globalAlpha=1,l.globalCompositeOperation="source-in",p.drawCache(t,n),l.globalCompositeOperation="source-over",n.draw(l),n}}]),p}(),ei=f.AUTO,ri=f.PX,ii=f.PERCENT,ni=f.STRING,ai=f.INHERIT,oi=_e.clone,si=_e.int2rgba,hi=_e.rgba2int,li=_e.equalArr,ui=_e.extend,ci=_e.joinArr,fi=Yt.calRelative,di=Vt.canvasPolygon,_i=Vt.svgPolygon,pi=qr.TRANSFORM|qr.TRANSLATE_X|qr.TRANSLATE_Y;function vi(t,e,r,i,n,a,o){var s;t===fe.CANVAS?(i.beginPath(),i.fillStyle!==r&&(i.fillStyle=r),e.forEach(function(t){di(i,t,a,o)}),i.fill(),i.closePath()):t===fe.SVG&&(s="",e.forEach(function(t){s+=_i(t)}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",s],["fill",r]]}))}function yi(t,e,r,i,n,a,o,s,h,l,u,c,f,d,_,p,v){var y,g=16<arguments.length&&void 0!==v?v:"fill",m=Be.calRadius(r,i,n,a,h,l,u,c,f,d,_,p);t===fe.CANVAS?(o.beginPath(),o.fillStyle!==e&&(o.fillStyle=e),m?di(o,m):o.rect(r,i,n,a),o[g](),o.closePath()):t===fe.SVG&&(m?(y=_i(m),s.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",y],["fill",e]]})):s.virtualDom.bb.push({type:"item",tagName:"rect",props:[["x",r],["y",i],["width",n],["height",a],["fill",e]]}))}var gi=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"];function mi(t,e,r){return t.unit===ri?t.value:t.unit===ii?(e-r)*t.value*.01:0}function bi(){}var xi,ki,Mi,wi,Ai,Si=function(){t(x,M);var i=e(x);function x(t){var r,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return l(this,x),r=i.call(this),Array.isArray(e)?r.props=_e.arr2hash(e):r.props=e,r.__tagName=t,r.__style=r.props.style||{},r.__currentStyle={},r.__computedStyle={},r.__listener={},r.__refreshLevel=qr.REFLOW,Object.keys(r.props).forEach(function(t){var e=r.props[t];/^on[a-zA-Z]/.test(t)&&(t=t.slice(2).toLowerCase(),r.listener[t]=e)}),r.__animationList=[],r.__loadBgi={cb:function(){}},r.__cacheStyle={},r}return u(x,[{key:"__mp",value:function(i,n,a){var o=this;["Top","Right","Bottom","Left"].forEach(function(t){var e="margin"+t,r="padding"+t;n[e]=o.__mpWidth(i[e],a),n[r]=o.__mpWidth(i[r],a)})}},{key:"__mpWidth",value:function(t,e){return t.unit===ri?t.value:t.unit===ii?t.value*e*.01:0}},{key:"__layout",value:function(t,e,r){Yt.computeReflow(this,this.isShadowRoot);var i,n,a,o,s,h,l,u,c,f=t.w,d=this.isDestroyed,_=this.currentStyle,p=this.computedStyle,v=_.display,y=_.width,g=_.position;if(this.__refreshLevel=qr.REFLOW,this.__cancelCache(),this.__layoutData=oi(t),d||"none"===v)this.__width=this.__height=p.width=p.height=0;else{if(r||this.__mp(_,p,f),y.unit!==ei)switch(y.unit){case ri:f=y.value;break;case ii:f*=.01*y.value}this.__ox=this.__oy=0,"flex"===v?this.__layoutFlex(t,e):"inline"===v?this.__layoutInline(t,e):this.__layoutBlock(t,e),"relative"===g?(i=_.top,n=_.right,a=_.bottom,o=_.left,s=this.parent,i.unit!==ei?(h=fi(_,"top",i,s),this.__offsetY(h),p.top=h,p.bottom="auto"):a.unit!==ei?(l=fi(_,"bottom",a,s),this.__offsetY(-l),p.bottom=l,p.top="auto"):p.top=p.bottom="auto",o.unit!==ei?(u=fi(_,"left",o,s,!0),this.__offsetX(u),p.left=u,p.right="auto"):n.unit!==ei?(c=fi(_,"right",n,s,!0),this.__offsetX(-c),p.right=c,p.left="auto"):p.left=p.right="auto"):"absolute"!==_.position&&(p.top=p.bottom=p.left=p.right="auto"),p.width=this.width,p.height=this.height;var m,b=this.__animateRecords;b&&(this.__animateRecords=null,b.list.forEach(function(t){t.target.vd instanceof x&&(t.target=t.target.vd)}),m=b.controller||this.root.animateController,b.options&&!1===b.options.autoPlay?m.__records=m.__records.concat(b.list):(m.__auto=m.__auto.concat(b.list),m.__playAuto()))}}},{key:"__preLayout",value:function(t){var e=t.x,r=t.y,i=t.w,n=t.h,a=t.w2,o=t.h2;this.__x=e,this.__y=r;var s,h,l=this.currentStyle,u=this.computedStyle,c=l.width,f=l.height,d=u.borderTopWidth,_=u.borderRightWidth,p=u.borderBottomWidth,v=u.borderLeftWidth,y=u.marginTop,g=u.marginRight,m=u.marginBottom,b=u.marginLeft,x=u.paddingTop,k=u.paddingRight,M=u.paddingBottom,w=u.paddingLeft;if(void 0!==a)s=!0,i=a;else if(c.unit!==ei)switch(s=!0,c.unit){case ri:i=c.value;break;case ii:i*=.01*c.value}if(void 0!==o)h=!0,n=o;else if(f.unit!==ei)switch(h=!0,f.unit){case ri:n=f.value;break;case ii:n*=.01*f.value}return e+=v+b+w,t.x=e,r+=d+y+x,t.y=r,c.unit===ei&&(i-=v+_+b+g+w+k),f.unit===ei&&(n-=d+p+y+m+x+M),{fixedWidth:s,fixedHeight:h,x:e,y:r,w:i,h:n}}},{key:"__marginAuto",value:function(t,e){var r,i=t.position,n=t.marginLeft,a=t.marginRight,o=t.width;"absolute"===i||o===ei||n.unit!==ei||a.unit!==ei||(r=this.outerWidth)<e.w&&this.__offsetX(.5*(e.w-r),!0)}},{key:"__calCache",value:function(t,e,r,i,n,f,a,d,o,s,h,l,u,c,_,p,v,y,g,m,b,x,k,M,w,A){var S,E,T,P,R,C,O,L,F,N,I,B,D,W,G,H,z,Y,X,$,j,V,q,U,Z=this,K=f.matrix;K&&e<qr.REFLOW&&!qr.contain(e,qr.TRANSFORM)?(P=E=0,qr.contain(e,qr.TRANSLATE_X)&&(S=a.translateX,E=(S=_e.isNil(S)?0:S.unit===ii?S.value*this.outerWidth*.01:S.value)-(d.translateX||0),d.translateX=S),qr.contain(e,qr.TRANSLATE_Y)&&(T=a.translateY,P=(T=_e.isNil(T)?0:T.unit===ii?T.value*this.outerHeight*.01:T.value)-(d.translateY||0),d.translateY=T),K[4]+=E,K[5]+=P,f.matrix=K):(void 0===f.transformOrigin&&(f.transformOrigin=!0,K=null,d.transformOrigin=be.calOrigin(a.transformOrigin,u,c)),void 0!==f.transform&&void 0!==f.translateX&&void 0!==f.translateY&&void 0!==f.rotateZ&&void 0!==f.scaleX&&void 0!==f.scaleY&&void 0!==f.skewX&&void 0!==f.skewY||(f.transform=f.translateX=f.translateY=f.rotateZ=f.scaleX=f.scaleY=f.skewX=f.skewY=!0,K=null,a.transform?R=be.calMatrix(a.transform,u,c):(C=[],["translateX","translateY","rotateZ","rotate","skewX","skewY","scaleX","scaleY"].forEach(function(t){var e,r=a[t];_e.isNil(r)||(d[t]=r.value,e=-1<t.indexOf("scale"),1===r.value&&e||!e&&0===r.value||(r.unit===ii&&("translateX"===t?d[t]=r.value*u*.01:"translateY"===t&&(d[t]=r.value*c*.01)),C.push([t,r])))}),C.length&&(R=be.calMatrix(C,u,c))),this.__matrix=d.transform=R||[1,0,0,1,0,0])),e>=qr.REPAINT?(void 0===f.backgroundPositionX&&(f.backgroundPositionX=!0,O=a.backgroundPositionX,d.backgroundPositionX=O.unit===ri?O.value:O.value*h+"%"),void 0===f.backgroundPositionY&&(f.backgroundPositionY=!0,L=a.backgroundPositionY,d.backgroundPositionY=L.unit===ri?L.value:L.value*h+"%"),void 0===f.backgroundSize&&(f.backgroundSize=!0,d.backgroundSize=(j=a.backgroundSize,V=h,q=l,U=[],j.forEach(function(t,e){t.unit===ri?U.push(t.value):t.unit===ii?U.push(t.value*(e?q:V)*.01):t.unit===ei?U.push(-1):t.unit===ni&&U.push("contain"===t.value?-2:-3)}),U)),void 0===f.backgroundImage&&(F=d.backgroundImage=a.backgroundImage,_e.isString(F)?(f.backgroundImage=!0,N=this.__loadBgi,(I=tr.IMG[F])&&I.state===tr.LOADED&&(N.url=F,N.source=I.source,N.width=I.width,N.height=I.height),N.url!==F&&(N.url=F,N.source=null,tr.measureImg(F,function(t){var e,r;t.success&&t.url===N.url&&!Z.__isDestroyed&&(N.source=t.source,N.width=t.width,N.height=t.height,(r=(e=Z).root).delRefreshTask(N.cb),r.addRefreshTask(N.cb={before:function(){r.__addUpdate({node:e,focus:qr.REPAINT})}}))},{width:h,height:l}))):F&&F.k&&(f.backgroundImage=this.__gradient(t,r,i,m,M,b,w,h,l,F))),void 0===f.boxShadow&&(f.boxShadow=!0,d.boxShadow=a.boxShadow),["opacity","zIndex","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","backgroundRepeat","filter"].forEach(function(t){d[t]=a[t]}),["backgroundColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"].forEach(function(t){void 0===f[t]&&(f[t]=si(d[t]=a[t].value))}),void 0!==f.borderTopLeftRadius&&void 0!==f.borderTopRightRadius&&void 0!==f.borderBottomRightRadius&&void 0!==f.borderBottomLeftRadius||(f.borderTopLeftRadius=f.borderTopRightRadius=f.borderBottomRightRadius=f.borderBottomLeftRadius=!0,H=u,z=c,Y=a,X=d,$=!0,gi.forEach(function(t){X[t]=Y[t].map(function(t,e){return 0<t.value?($=!1,t.unit===ri?Math.max(0,t.value):Math.max(0,t.value*(e?z:H)*.01)):0})}),$||gi.forEach(function(t,e){var r,i=e%2==0?0:1,n=i?z:H,a=X[t],o=X[gi[(e+1)%4]];a[i]+o[i]>n&&(r=.5*n,a[i]>=r&&o[i]>=r?a[i]=o[i]=r:a[i]>r?a[i]=n-o[i]:o[i]>r&&(o[i]=n-a[i]))}),["Top","Right","Bottom","Left"].forEach(function(t){f["border"+t]=void 0})),B=d.borderTopLeftRadius,D=d.borderTopRightRadius,W=d.borderBottomRightRadius,G=d.borderBottomLeftRadius,["Top","Right","Bottom","Left"].forEach(function(t){var e,r,i,n,a,o,s,h,l="border"+t,u=l+"Width",c=l+"Style";void 0===f[u]&&(f[u]=!0,f[l]=void 0),void 0===f[c]&&(f[c]=!0,f[l]=void 0),void 0===f[l]&&("Top"===t?0<_?(e=Math.atan(_/y),r=Math.atan(_/p),f[l]=Be.calPoints(_,d[c],e,r,g,m,b,x,k,M,w,A,0,B,D)):f[l]=[]:"Right"===t?0<p?(i=Math.atan(p/_),n=Math.atan(p/v),f[l]=Be.calPoints(p,d[c],i,n,g,m,b,x,k,M,w,A,1,D,W)):f[l]=[]:"Bottom"===t?0<v?(a=Math.atan(v/y),o=Math.atan(v/p),f[l]=Be.calPoints(v,d[c],a,o,g,m,b,x,k,M,w,A,2,G,W)):f[l]=[]:"Left"===t&&(0<y?(s=Math.atan(y/_),h=Math.atan(y/v),f[l]=Be.calPoints(y,d[c],s,h,g,m,b,x,k,M,w,A,3,B,G)):f[l]=[]))})):(qr.contain(e,qr.OPACITY)&&(d.opacity=a.opacity),qr.contain(e,qr.FILTER)&&(d.filter=a.filter));var J,Q=n&&n.computedStyle;if(a.fontStyle.unit===ai?d.fontStyle=n?Q.fontStyle:"normal":f.fontStyle||(d.fontStyle=a.fontStyle.value),f.fontStyle=d.fontStyle,a.color.unit===ai?(d.color=n?Q.color:[0,0,0,1],f.color=si(d.color)):f.color||(d.color=hi(a.color.value),f.color=si(d.color)),a.visibility.unit===ai?d.visibility=n?Q.visibility:"visible":f.visibility||(d.visibility=a.visibility.value),f.visibility=d.visibility,a.pointerEvents.unit===ai?d.pointerEvents=n?Q.pointerEvents:"auto":f.pointerEvents||(d.pointerEvents=a.pointerEvents.value),f.pointerEvents=d.pointerEvents,K||((J=d.transformOrigin.slice(0))[0]+=o,J[1]+=s,f.matrix=be.calMatrixByOrigin(d.transform,J)),t===fe.CANVAS){if(e<qr.REPAINT)return this.__hasContent;var tt=f.backgroundImage;if(_e.isString(tt))return!0;if(0<d.backgroundColor[3])return!0;if(tt&&tt.k)return!0;for(var et=["borderTop","borderRight","borderBottom","borderLeft"],rt=0,it=et.length;rt<it;rt++){var nt=et[rt];if(0<d[nt+"Width"]&&0<d[nt+"Color"][3])return!0}var at=d.boxShadow;if(Array.isArray(at))for(var ot=0,st=at.length;ot<st;ot++){var ht=at[ot];if(ht&&(0<ht[2]||0<ht[3]))return!0}for(var lt=0,ut=gi.length;lt<ut;lt++){var ct=d[gi[lt]];if(0<ct[0]&&0<ct[1])return!0}}return!1}},{key:"render",value:function(l,u,c,f){var d,_=this,t=this.isDestroyed,e=this.currentStyle,r=this.computedStyle,i=this.__cacheStyle,p=this.root,v=this.__cache,n=this.__cacheTotal;if(this.__refreshLevel=qr.NONE,t)return{isDestroyed:t,break:!0};if(l===fe.SVG&&(u<qr.REPAINT&&this.__virtualDom?n&&n.available?((d=this.__virtualDom).lv=u,d.cache=!0):((d=this.__virtualDom=ui({},this.__virtualDom)).lv=u,delete d.cache):d=this.__virtualDom={bb:[],children:[],visibility:"visible"}),"none"===r.display){if(l===fe.CANVAS)return{displayNone:!0,canCache:!this.displayAnimating};if(l===fe.SVG){var a="none"===this.__lastDisplay;return this.__lastDisplay="none",{displayNone:!0,break:!0,canCache:a}}}else l===fe.SVG&&(this.__lastDisplay=r.display);if(this.__blurValue=0,p.cache&&l===fe.CANVAS&&u<qr.REPAINT){var o=n&&n.available;if(u>qr.NONE){var s,h,y,g=this.__sx,m=this.__sy,b=this.parent;if(this.__calCache(l,u,c,f,b,i,e,r,g,m),qr.contain(u,pi)&&(y=y||this.domParent,s=i.matrix,y&&(s=de.multiply(y.matrixEvent,s)),this.__matrixEvent=s),qr.contain(u,qr.OPACITY)&&(h=r.opacity,(y=y||this.domParent)&&(h*=y.__opacity),this.__opacity=h),qr.contain(u,qr.FILTER)&&Array.isArray(r.filter)&&r.filter.forEach(function(t){var e,r=ue(t,2),i=r[0],n=r[1];"blur"===i&&(_.__blurValue=n,e=_.bbox,_.__cache=v?ti.updateCache(v,e):ti.getInstance(e))}),"hidden"===r.visibility)return{canCache:o||!this.visibilityAnimating}}return{canCache:o||!this.availableAnimating}}var x=this.sx,k=this.sy,M=this.width,w=this.height,A=this.innerWidth,S=this.innerHeight,E=this.outerWidth,T=this.outerHeight;this.__sx=x,this.__sy=k;var P=r.marginTop,R=r.marginLeft,C=r.paddingTop,O=r.paddingRight,L=r.paddingBottom,F=r.paddingLeft,N=r.borderLeftWidth,I=r.borderRightWidth,B=r.borderTopWidth,D=r.borderBottomWidth,W=x+R,G=W+N,H=G+M+F+O,z=H+I,Y=k+P,X=Y+B,$=X+w+C+L,j=$+D,V={x1:W,x2:G,x3:H,x4:z,y1:Y,y2:X,y3:$,y4:j},q=this.domParent,U=this.__hasContent=this.__calCache(l,u,c,f,this.parent,i,e,r,x,k,A,S,E,T,B,I,D,N,W,G,H,z,Y,X,$,j),Z=r.backgroundColor,K=r.borderTopColor,J=r.borderRightColor,Q=r.borderBottomColor,tt=r.borderLeftColor,et=r.borderTopLeftRadius,rt=r.borderTopRightRadius,it=r.borderBottomRightRadius,nt=r.borderBottomLeftRadius,at=r.visibility,ot=r.backgroundRepeat,st=r.backgroundImage,ht=r.opacity,lt=r.filter,ut=r.backgroundSize,ct=r.boxShadow;l===fe.CANVAS?(q&&(ht*=q.__opacity),this.__opacity=ht):l===fe.SVG&&(1===ht?delete d.opacity:d.opacity=ht);var ft=i.matrix,dt=this.__renderMatrix=ft;if(q&&(ft=de.multiply(q.matrixEvent,ft)),this.__matrixEvent=ft,l===fe.SVG&&(!qr.contain(u,pi)&&u<qr.REPAINT||(li(dt,[1,0,0,1,0,0])?delete d.transform:d.transform="matrix("+ci(dt,",")+")")),"hidden"===at&&l===fe.CANVAS)return le(le({},V),{},{break:!0,canCache:!this.visibilityAnimating});l===fe.SVG&&(d.visibility=at);var _t,pt=!U||!this.availableAnimating,vt=0,yt=0;if(p.cache&&l===fe.CANVAS){this.__cache=this.__cacheTotal=this.__cacheFilter=this.__cacheMask=null;var gt,mt,bt,xt,kt,Mt,wt="$"===this.tagName.charAt(0),At="img"===this.tagName.toLowerCase();if(!U){if(!wt&&v&&v.available&&v.release(),u<qr.REPAINT&&wt)return le(le({},V),{},{break:!0,canCache:pt});if(!At)return le(le({},V),{},{canCache:pt})}if(v&&v.available&&u<qr.REPAINT)return qr.contain(u,qr.FILTER)&&(v=this.__cache=ti.updateCache(v,this.bbox)),le(le({},V),{},{break:!0,canCache:pt,cache:v});v&&v.available||(gt=this.bbox,v?v.reset(gt):v=ti.getInstance(gt),v&&v.enabled?((this.__cache=v).__bbox=gt,v.__appendData(W,Y),mt=v.dbx,bt=v.dby,c=v.ctx,kt=(xt=ue(v.coords,2))[0],Mt=xt[1],vt=v.dx,yt=v.dy,V.x1=W=kt+mt,V.y1=Y=Mt+bt,vt&&(V.x2=G+=vt,V.x3=H+=vt,V.x4=z+=vt),yt&&(V.y2=X+=yt,V.y3=$+=yt,V.y4=j+=yt)):this.__cache&&(this.__cache.release(),this.__cache=null)),v||(pt=!1)}if(Array.isArray(lt)&&lt.forEach(function(t){var e,r,i,n,a,o=ue(t,2),s=o[0],h=o[1];"blur"===s&&(_.__blurValue=h,!(l===fe.CANVAS&&0<h)||v&&v.enabled||"$"===_.tagName.charAt(0)?l===fe.SVG&&(u>=qr.REFLOW||qr.contain(u,qr.FILTER))&&(0<h?(e=de.int2convolution(h),r=f.add({tagName:"filter",props:[["x",-e/E],["y",-e/T],["width",1+2*e/E],["height",1+2*e/T]],children:[{tagName:"feGaussianBlur",props:[["stdDeviation",h]]}]}),d.filter="url(#"+r+")"):delete d.filter):(i=p.width,n=p.height,(a=tr.getCacheCanvas(i,n,"__$$blur$$__")).ctx&&((_t={ctx:c,blur:h}).target=a,c=a.ctx)))}),d&&d.filter&&this.__blurValue<=0&&delete d.filter,l===fe.SVG&&d.hasOwnProperty("lv"))return{break:!0,canCache:u===qr.NONE};if(l!==fe.CANVAS||v&&v.enabled||(c.globalAlpha=ht,c.setTransform.apply(c,ce(ft))),0<Z[3]&&yi(l,i.backgroundColor,G,X,A,S,c,this,B,I,D,N,et,rt,it,nt),st)if(_e.isString(st)){var St=this.__loadBgi;if(St.url===st){var Et=St.source;if(Et){var Tt=St.width,Pt=St.height,Rt=ue(ut,2),Ct=Rt[0],Ot=Rt[1];-1===Ct&&-1===Ot?(Ct=Tt,Ot=Pt):-2===Ct?A<Tt&&S<Pt?(Ot=Pt/S)<=(Ct=Tt/A)?Ot=(Ct=A)*Pt/Tt:Ct=(Ot=S)*Tt/Pt:A<Tt?Ot=(Ct=A)*Pt/Tt:S<Pt?Ct=(Ot=S)*Tt/Pt:(Ct=Tt,Ot=Pt):-3===Ct?Tt<A&&Pt<S?(Ct=Tt/A)<=(Ot=Pt/S)?Ot=(Ct=A)*Pt/Tt:Ct=(Ot=S)*Tt/Pt:Tt<A||!(Pt<S)&&(Ct=Tt/A)<=(Ot=Pt/S)?Ot=(Ct=A)*Pt/Tt:Ct=(Ot=S)*Tt/Pt:-1===Ct?Ct=Ot*Tt/Pt:-1===Ot&&(Ot=Ct*Pt/Tt);var Lt,Ft,Nt=G+mi(e.backgroundPositionX,A,Ct),It=X+mi(e.backgroundPositionY,S,Ot),Bt=Nt<G||It<X||A<Ct||S<Ot,Dt=0,Wt=0,Gt=0,Ht=0;-1<["repeat-x","repeat"].indexOf(ot)&&(0<(Lt=Nt-G)&&(Dt=Math.ceil(Lt/Ct)),0<(Lt=G+A-Nt-Ct)&&(Wt=Math.ceil(Lt/Ct))),-1<["repeat-y","repeat"].indexOf(ot)&&(0<(Ft=It-X)&&(Gt=Math.ceil(Ft/Ot)),0<(Ft=X+S-It-Ot)&&(Ht=Math.ceil(Ft/Ot)));var zt,Yt,Xt,$t,jt=[];if(0<Dt)for(var Vt=0;Vt<Dt;Vt++){var qt=Nt-(Vt+1)*Ct;jt.push([qt,It]),!Bt&&0===Vt&&qt<G&&(Bt=!0)}if(0<Wt)for(var Ut=0;Ut<Wt;Ut++){var Zt=Nt+(Ut+1)*Ct;jt.push([Zt,It]),!Bt&&Ut===Wt-1&&G+A<Zt+Ct&&(Bt=!0)}if(0<Gt)for(var Kt=0;Kt<Gt;Kt++){var Jt=It-(Kt+1)*Ot;jt.push([Nt,Jt]),!Bt&&0===Kt&&Jt<X&&(Bt=!0)}if(0<Ht)for(var Qt=0;Qt<Ht;Qt++){var te=It+(Qt+1)*Ot;jt.push([Nt,te]),!Bt&&Qt===Ht-1&&X+S<te+Ct&&(Bt=!0)}if(0<Dt&&0<Gt)for(var ee=0;ee<Dt;ee++)for(var re=0;re<Gt;re++)jt.push([Nt-(ee+1)*Ct,It-(re+1)*Ot]);if(0<Wt&&0<Gt)for(var ie=0;ie<Wt;ie++)for(var ne=0;ne<Gt;ne++)jt.push([Nt+(ie+1)*Ct,It-(ne+1)*Ot]);if(0<Dt&&0<Ht)for(var ae=0;ae<Dt;ae++)for(var oe=0;oe<Ht;oe++)jt.push([Nt-(ae+1)*Ct,It+(oe+1)*Ot]);if(0<Wt&&0<Ht)for(var se=0;se<Wt;se++)for(var he=0;he<Ht;he++)jt.push([Nt+(se+1)*Ct,It+(he+1)*Ot]);l===fe.CANVAS?(Bt&&(c.save(),yi(l,"#FFF",G,X,A,S,c,this,B,I,D,N,et,rt,it,nt,"clip")),c.drawImage(Et,Nt,It,Ct,Ot),jt.forEach(function(t){c.drawImage(Et,t[0],t[1],Ct,Ot)}),Bt&&c.restore()):l===fe.SVG&&(zt=Ge.matrixResize(Tt,Pt,Ct,Ot,Nt,It,A,S),Yt=[["xlink:href",st],["x",Nt],["y",It],["width",Tt],["height",Pt]],zt&&!li(zt,[1,0,0,1,0,0])&&(Xt=!0,Yt.push(["transform","matrix("+ci(zt,",")+")"])),Bt&&($t=f.add({tagName:"clipPath",children:[{tagName:"rect",props:[["x",G],["y",X],["width",A],["height",S],["fill","#FFF"]]}]}),this.virtualDom.bbClip="url(#"+$t+")"),this.virtualDom.bb.push({type:"img",tagName:"image",props:Yt}),jt.forEach(function(t){var e,r=oi(Yt);!Xt||(e=Ge.matrixResize(Tt,Pt,Ct,Ot,t[0],t[1],A,S))&&!li(e,[1,0,0,1,0,0])&&(r[5][1]="matrix("+ci(e,",")+")"),r[1][1]=t[0],r[2][1]=t[1],_.virtualDom.bb.push({type:"img",tagName:"image",props:r})}))}}}else st.k&&yi(l,i.backgroundImage,G,X,A,S,c,this,B,I,D,N,et,rt,it,nt);return ct&&ct.forEach(function(t){!function(t,e,r,i,n,a,o,s,h,l,u){var c=ue(i,6),f=c[0],d=c[1],_=c[2],p=c[3],v=c[4],y=c[5],g=si(v),m=2*Math.abs(_)+2*Math.abs(p)+2*Math.abs(f)+2*Math.abs(d),b=[[a,o],[s,o],[s,h],[a,h],[a,o]],x=[[a-m,o-m],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m]];if(0<v[3]&&(0<_||0<p))if(t===fe.CANVAS){if(e.save(),e.beginPath(),"inset"===y){var k=a+f+p,M=o+d+p,w=s+f-p,A=h+d-p,S=[[k,M],[w,M],[w,A],[k,A]],E=pe.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[S[0][0],S[0][1],S[2][0],S[2][1]]);if(!E)return;E=[[E[0],E[1]],[E[2],E[1]],[E[2],E[3]],[E[0],E[3]],[E[0],E[1]]],p?(di(e,E),di(e,b.slice(0).reverse()),e.clip(),e.closePath(),e.beginPath(),e.fillStyle!==g&&(e.fillStyle=g),di(e,b),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),di(e,E),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowColor=g,e.shadowBlur=_,di(e,[[k,M],[w,M],[w,A],[a-m,A],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,A],[k,A],[k,M]])):(di(e,b),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowOffsetX=f,e.shadowOffsetY=d,e.shadowColor=g,e.shadowBlur=_,di(e,[[a,o],[s,o],[s,h],[a-m,h],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,h],[a,h],[a,o]]))}else{var T=a+f-p,P=o+d-p,R=s+f+p,C=h+d+p,O=[[T,P],[R,P],[R,C],[T,C]],L=pe.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[O[0][0],O[0][1],O[2][0],O[2][1]]);p?(di(e,b),di(e,O.slice(0).reverse()),e.clip(),e.closePath(),e.beginPath(),e.fillStyle!==g&&(e.fillStyle=g),di(e,O),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),L&&di(e,[[L[0],L[1]],[L[2],L[1]],[L[2],L[3]],[L[0],L[3]],[L[0],L[1]]].reverse()),di(e,b),di(e,O),di(e,x),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowColor=g,e.shadowBlur=_,di(e,O)):(di(e,b),di(e,x),e.clip(),e.closePath(),e.beginPath(),"#FFF"!==e.fillStyle&&(e.fillStyle="#FFF"),e.shadowOffsetX=f,e.shadowOffsetY=d,e.shadowColor=g,e.shadowBlur=_,di(e,b))}e.fill(),e.closePath(),e.restore()}else if(t===fe.SVG){var F=de.int2convolution(_);if("inset"===y){var N,I,B,D,W=a+f+p,G=o+d+p,H=s+f-p,z=h+d-p,Y=[[W,G],[H,G],[H,z],[W,z]],X=pe.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[Y[0][0],Y[0][1],Y[2][0],Y[2][1]]);if(!X)return;X=[[X[0],X[1]],[X[2],X[1]],[X[2],X[3]],[X[0],X[3]],[X[0],X[1]]],p?(N=r.add({tagName:"filter",props:[["x",-F/l],["y",-F/u],["width",1+2*F/l],["height",1+2*F/u]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*_],["flood-color",g]]}]}),I=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",_i(X)+_i(b.slice(0).reverse())],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",_i(b)],["fill",g],["clip-path","url(#"+I+")"]]}),I=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",_i(X)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",_i([[W,G],[H,G],[H,z],[a-m,z],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,z],[W,z],[W,G]])],["fill","#FFF"],["filter","url(#"+N+")"],["clip-path","url(#"+I+")"]]})):(B=r.add({tagName:"filter",props:[["x",-F/l],["y",-F/u],["width",1+2*F/l],["height",1+2*F/u]],children:[{tagName:"feDropShadow",props:[["dx",f],["dy",d],["stdDeviation",.5*_],["flood-color",g]]}]}),D=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",_i(b)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",_i([[a,o],[s,o],[s,h],[a-m,h],[a-m,h+m],[s+m,h+m],[s+m,o-m],[a-m,o-m],[a-m,h],[a,h],[a,o]])],["fill","#FFF"],["filter","url(#"+B+")"],["clip-path","url(#"+D+")"]]}))}else{var $,j,V,q,U=a+f-p,Z=o+d-p,K=s+f+p,J=h+d+p,Q=[[U,Z],[K,Z],[K,J],[U,J]],tt=pe.getRectsIntersection([b[0][0],b[0][1],b[2][0],b[2][1]],[Q[0][0],Q[0][1],Q[2][0],Q[2][1]]);p?($=r.add({tagName:"filter",props:[["x",-F/l],["y",-F/u],["width",1+2*F/l],["height",1+2*F/u]],children:[{tagName:"feDropShadow",props:[["dx",0],["dy",0],["stdDeviation",.5*_],["flood-color",g]]}]}),j=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",_i(b)+_i(Q.slice(0).reverse())],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",_i(Q)],["fill",g],["clip-path","url(#"+j+")"]]}),j=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",(tt?_i([[tt[0],tt[1]],[tt[2],tt[1]],[tt[2],tt[3]],[tt[0],tt[3]],[tt[0],tt[1]]].reverse()):"")+_i(b)+_i(Q)+_i(x)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",_i(Q)],["fill","#FFF"],["filter","url(#"+$+")"],["clip-path","url(#"+j+")"]]})):(V=r.add({tagName:"filter",props:[["x",-F/l],["y",-F/u],["width",1+2*F/l],["height",1+2*F/u]],children:[{tagName:"feDropShadow",props:[["dx",f],["dy",d],["stdDeviation",.5*_],["flood-color",g]]}]}),q=r.add({tagName:"clipPath",children:[{tagName:"path",props:[["d",_i(b)+_i(x)],["fill","#FFF"]]}]}),n.virtualDom.bb.push({type:"item",tagName:"path",props:[["d",_i(b)],["fill","#FFF"],["filter","url(#"+V+")"],["clip-path","url(#"+q+")"]]}))}}}(l,c,f,t,_,W,Y,z,j,E,T)}),0<B&&0<K[3]&&vi(l,i.borderTop,i.borderTopColor,c,this,vt,yt),0<I&&0<J[3]&&vi(l,i.borderRight,i.borderRightColor,c,this,vt,yt),0<D&&0<Q[3]&&vi(l,i.borderBottom,i.borderBottomColor,c,this,vt,yt),0<N&&0<tt[3]&&vi(l,i.borderLeft,i.borderLeftColor,c,this,vt,yt),v&&v.enabled&&(v.__available=!0),l===fe.CANVAS?le(le({},V),{},{canCache:pt,cache:v,offScreen:_t}):l===fe.SVG?{canCache:!1}:void 0}},{key:"__renderByMask",value:function(e,r,t,i){var n=this.next,a=this.root,o=this.__hasMask,s=this.__hasClip;if(void 0!==o&&void 0!==s||(o=this.__hasMask=!(!n||!n.isMask),s=this.__hasClip=!(!n||!n.isClip)),a.cache&&e===fe.CANVAS||!o&&!s)return this.render(e,r,t,i);if(e===fe.CANVAS){if(o){for(var h,l=a.width,u=a.height,c=tr.getCacheCanvas(l,u,"__$$mask1$$__"),f=this.render(e,r,c.ctx),d=[];n&&n.isMask;)d.push(n),n=n.next;t.save(),t.setTransform(1,0,0,1,0,0),(t.globalAlpha=1)===d.length?(n=d[0],c.ctx.globalCompositeOperation="destination-in",n.render(e,r,c.ctx,null),c.draw(c.ctx),t.drawImage(c.canvas,0,0),c.draw(t)):(h=tr.getCacheCanvas(l,u,"__$$mask2$$__"),d.forEach(function(t){t.render(e,r,h.ctx,null,!0)}),h.draw(h.ctx),c.ctx.globalCompositeOperation="destination-in",c.ctx.drawImage(h.canvas,0,0),c.draw(c.ctx),t.drawImage(c.canvas,0,0),c.draw(t),h.ctx.globalCompositeOperation="source-over",h.ctx.clearRect(0,0,l,u),h.draw(h.ctx)),t.restore(),c.ctx.globalCompositeOperation="source-over",c.ctx.clearRect(0,0,l,u),c.draw(c.ctx)}else if(s){t.save(),t.beginPath();var _=t.fill,p=t.beginPath,v=t.closePath;for(t.fill=t.beginPath=t.closePath=bi;n&&n.isClip;)n.render(e,r,t),n=n.next;t.fill=_,t.beginPath=p,t.closePath=v,t.clip(),t.closePath(),f=this.render(e,r,t),t.restore()}return f}if(e===fe.SVG){var y=this.render(e,r,t,i),g=!0,m=n;t:for(;m;){for(var b=m.virtualDom.children,x=0,k=b.length;x<k;x++){var M=b[x],w=M.tagName,A=M.props;if("path"===w)for(var S=0,E=A.length;S<E;S++){var T=ue(A[x],2),P=T[0],R=T[1];if("d"===P&&R){g=!1;break t}}}if(!(m=m.next))break;if(o){if(!m.isMask)break}else if(s&&!m.isClip)break}if(g||"none"===this.computedStyle.display)return y;m=n;for(var C=[];m;){var O=m.computedStyle,L=O.display,F=O.visibility;if("none"!==L&&"hidden"!==F)for(var N=m.virtualDom.children,C=C.concat(N),I=0,B=N.length;I<B;I++){var D,W,G,H=N[I],z=H.tagName,Y=H.props;"path"===z&&(W=m.__renderMatrix,D=de.inverse(this.__renderMatrix),W=de.multiply(W,D),(G=Y.length)&&"transform"===Y[G-1][0]?Y[G-1][1]="matrix(".concat(W,")"):Y.push(["transform","matrix(".concat(W,")")]))}if(!(m=m.next))break;if(o){if(!m.isMask)break}else if(s&&!m.isClip)break}var X="url(#"+(X=i.add({tagName:s?"clipPath":"mask",props:[],children:C}))+")";return o?this.virtualDom.mask=X:s&&(this.virtualDom.clip=X),y}}},{key:"__applyCache",value:function(t,e,r,i){var n,a,o,s,h,l,u,c,f=this.__cache;f&&f.available&&(n=f.coords,a=f.canvas,o=f.size,s=f.dbx,h=f.dby,u=(l=ue(n,2))[0],c=l[1],e.drawImage(a,u-1,c-1,o,o,r-s,i-h,o,o))}},{key:"__mergeBbox",value:function(t,e,r,i){var n=this.__cache&&this.__cache.available?this.__cache.bbox.slice(0):this.bbox;return e||(n=_e.transformBbox(n,t,r,i)),n}},{key:"__destroy",value:function(){var t,e;this.isDestroyed||(!(t=this.props.ref)||(e=this.host||this.root)&&e.ref[t]&&delete e.ref[t],this.animationList.forEach(function(t){return t.__destroy()}),this.root.delRefreshTask(this.__loadBgi.cb),this.root.delRefreshTask(this.__task),_t(dt(x.prototype),"__destroy",this).call(this),this.__matrix=this.__matrixEvent=this.__root=null,this.__cache&&(this.__cache.release(),this.__cache=null),this.__cacheTotal&&(this.__cacheTotal.release(),this.__cacheTotal=null),this.__cacheFilter&&(this.__cacheFilter.release(),this.__cacheFilter=null))}},{key:"__emitEvent",value:function(t,e){var r=this.isDestroyed,i=this.computedStyle;if(!r&&"none"!==i.display&&!t.__stopPropagation){var n,a=t.event.type,o=this.listener;return o.hasOwnProperty(a)&&(n=o[a]),e?(t.target=this,_e.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0):this.willResponseEvent(t)?(_e.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0):void 0}}},{key:"willResponseEvent",value:function(t){var e=t.x,r=t.y,i=this.sx,n=this.sy,a=this.outerWidth,o=this.outerHeight,s=this.matrixEvent;if("none"!==this.computedStyle.pointerEvents)return be.pointInQuadrilateral(e,r,i,n,i+a,n,i+a,n+o,i,n+o,s)?(t.target||(t.target=this,"touchstart"===t.event.type&&(this.root.__touchstartTarget=this)),!0):void 0}},{key:"__gradient",value:function(t,e,r,i,n,a,o,s,h,l){var u,c,f,d=l.k,_=l.v,p=l.d,v=l.s,y=l.z,g=l.p,m=i+.5*s,b=n+.5*h;return"linear"===d?(u=q.getLinear(_,p,m,b,s,h),c=this.__getLg(t,e,r,u)):"radial"===d&&(f=q.getRadial(_,v,y,g,i,n,a,o),c=this.__getRg(t,e,r,f)),c}},{key:"__getLg",value:function(t,e,r,i){if(t===fe.CANVAS){var n=e.createLinearGradient(i.x1,i.y1,i.x2,i.y2);return i.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===fe.SVG)return"url(#"+r.add({tagName:"linearGradient",props:[["x1",i.x1],["y1",i.y1],["x2",i.x2],["y2",i.y2]],children:i.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})})+")"}},{key:"__cancelCache",value:function(){this.__cacheStyle={},this.__cache&&this.__cache.release(),this.__cacheTotal&&this.__cacheTotal.release()}},{key:"__getRg",value:function(t,e,r,i){if(t===fe.CANVAS){var n=e.createRadialGradient(i.cx,i.cy,0,i.cx,i.cy,i.r);return i.stop.forEach(function(t){n.addColorStop(t[1],t[0])}),n}if(t===fe.SVG)return"url(#"+r.add({tagName:"radialGradient",props:[["cx",i.cx],["cy",i.cy],["r",i.r]],children:i.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})})+")"}},{key:"updateStyle",value:function(e,r){var t=this.tagName,i=this.root,n=this.props,a=this.style;if(i){var o,s=Object.keys(e);for(var h in s.forEach(function(t){ot.hasOwnProperty(t)&&(ot.toFull(e,t),delete e[t])}),e)e.hasOwnProperty(h)&&(Ot.isValid(t,h)?Ot.isGeom(t,h)?Yt.equalStyle(h,e[h],n[h],this)||(o=!0):Yt.equalStyle(h,e[h],a[h],this)||(o=!0):delete e[h]);if(!o)return void(_e.isFunction(r)&&r(0));var l=this;i.addRefreshTask(l.__task={before:function(){l.isDestroyed||i.__addUpdate({node:l,style:e,origin:!0,overwrite:!0})},after:function(t){_e.isFunction(r)&&r.call(l,t)}})}}},{key:"animate",value:function(t,e){if(!this.isDestroyed){var r=new $r(this,t,e);return this.animationList.push(r),!1===e.autoPlay?r:r.play()}}},{key:"removeAnimate",value:function(t){var e;t instanceof $r&&(-1<(e=this.animationList.indexOf(t))&&(t.cancel(),t.__destroy(),this.animationList.splice(e,1)))}},{key:"clearAnimate",value:function(){this.animationList.splice(0).forEach(function(t){t.cancel(),t.__destroy()})}},{key:"__computeMeasure",value:function(t,e,r,i){Yt.computeMeasure(this,r),_e.isFunction(i)&&i(this)}},{key:"deepScan",value:function(t,e){return t(this,e)}},{key:"__offsetX",value:function(t,e,r){_t(dt(x.prototype),"__offsetX",this).call(this,t,e),e&&(this.layoutData.x+=t),void 0!==r&&(this.__refreshLevel|=r)}},{key:"__offsetY",value:function(t,e,r){_t(dt(x.prototype),"__offsetY",this).call(this,t,e),e&&(this.layoutData.y+=t),void 0!==r&&(this.__refreshLevel|=r)}},{key:"__resizeX",value:function(t){this.computedStyle.width=this.__width+=t,this.layoutData.w+=t}},{key:"__resizeY",value:function(t){this.computedStyle.height=this.__height+=t,this.layoutData.h+=t}},{key:"__spreadByBoxShadowAndFilter",value:function(t,e){var s=0,h=0;if(Array.isArray(t)&&t.forEach(function(t){var e,r=ue(t,6),i=r[0],n=r[1],a=r[2],o=r[3];"inset"!==r[5]&&(e=de.int2convolution(a),e+=o,s=Math.max(s,i+e),h=Math.max(h,n+e))}),Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var n,a=ue(e[r],2),o=a[0],l=a[1];"blur"===o&&(n=de.int2convolution(l),s=Math.max(s,n),h=Math.max(h,n))}return[s,h]}},{key:"tagName",get:function(){return this.__tagName}},{key:"innerWidth",get:function(){var t=this.computedStyle,e=t.display,r=t.paddingRight,i=t.paddingLeft;return"none"===e?0:this.width+i+r}},{key:"innerHeight",get:function(){var t=this.computedStyle,e=t.display,r=t.paddingTop,i=t.paddingBottom;return"none"===e?0:this.height+r+i}},{key:"outerWidth",get:function(){var t=this.computedStyle,e=t.display,r=t.borderLeftWidth,i=t.borderRightWidth,n=t.marginRight,a=t.marginLeft;return"none"===e?0:this.innerWidth+r+i+a+n}},{key:"outerHeight",get:function(){var t=this.computedStyle,e=t.display,r=t.borderTopWidth,i=t.borderBottomWidth,n=t.marginTop,a=t.marginBottom;return"none"===e?0:this.innerHeight+r+i+n+a}},{key:"bbox",get:function(){var t=this.sx,e=this.sy,r=this.width,i=this.height,n=this.computedStyle,a=n.borderTopWidth,o=n.borderRightWidth,s=n.borderBottomWidth,h=n.borderLeftWidth,l=n.marginTop,u=n.marginLeft,c=n.paddingTop,f=n.paddingRight,d=n.paddingBottom,_=n.paddingLeft,p=n.boxShadow,v=n.filter,y=ue(this.__spreadByBoxShadowAndFilter(p,v),2),g=y[0],m=y[1];return[(t+=u)-g,(e+=l)-m,t+(r+=h+_+o+f)+g,e+(i+=a+c+s+d)+m]}},{key:"listener",get:function(){return this.__listener}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixEvent",get:function(){return this.__matrixEvent}},{key:"renderMatrix",get:function(){return this.__renderMatrix}},{key:"style",get:function(){return this.__style}},{key:"computedStyle",get:function(){return this.__computedStyle}},{key:"animationList",get:function(){return this.__animationList}},{key:"availableAnimating",get:function(){for(var t=this.animationList,e=0,r=t.length;e<r;e++){var i=t[e];if(i.animating&&i.currentFrame)for(var n=i.currentFrame.transition,a=0,o=n.length;a<o;a++)if(!Ot.isIgnore(n[a].k))return!0}return!1}},{key:"effectiveAnimating",get:function(){for(var t=this.animationList,e=0,r=t.length;e<r;e++){var i=t[e];if(i.animating&&i.currentFrame)for(var n=i.currentFrame.transition,a=0,o=n.length;a<o;a++){var s=n[a].k;if(!Ot.isIgnore(s)||qr.TRANSFORMS.hasOwnProperty(s)||"opacity"===s||"transform"===s||"filter"===s||"visibility"===s)return!0}}return!1}},{key:"displayAnimating",get:function(){for(var t=this.animationList,e=0,r=t.length;e<r;e++){var i=t[e];if(i.animating&&i.currentFrame)for(var n=i.currentFrame.transition,a=0,o=n.length;a<o;a++){if("display"===n[a].k)return!0}}return!1}},{key:"visibilityAnimating",get:function(){for(var t=this.animationList,e=0,r=t.length;e<r;e++){var i=t[e];if(i.animating&&i.currentFrame)for(var n=i.currentFrame.transition,a=0,o=n.length;a<o;a++){if("visibility"===n[a].k)return!0}}return!1}},{key:"currentStyle",get:function(){return this.__currentStyle}},{key:"layoutData",get:function(){return this.__layoutData}},{key:"isShadowRoot",get:function(){return!this.parent&&this.host&&this.host!==this.root}}]),x}(),Ei=function(){function r(t,e){l(this,r),this.__list=[],this.__x=t,this.__y=e,this.__baseLine=0}return u(r,[{key:"add",value:function(t){this.list.push(t)}},{key:"__calBaseLine",value:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.baseLine)}),e}},{key:"verticalAlign",value:function(){var r=this.__baseLine=this.__calBaseLine();1<this.list.length&&this.list.forEach(function(t){var e=t.baseLine;e!==r&&t.__offsetY(r-e)})}},{key:"horizonAlign",value:function(e){this.list.forEach(function(t){t.__offsetX(e,!0)})}},{key:"list",get:function(){return this.__list}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){var e=0;return this.list.forEach(function(t){e+=t.outerWidth}),e}},{key:"height",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.outerHeight)}),e}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"size",get:function(){return this.__list.length}},{key:"marginBottom",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.computedStyle.marginBottom)}),e}}]),r}(),Ti={TAG_NAME:{div:!0,p:!0,span:!0,img:!0,b:!0,strong:!0},INLINE:{span:!0,img:!0,b:!0,strong:!0},BOLD:{b:!0,strong:!0}},Pi=_.TYPE_VD,Ri=_.TYPE_GM,Ci=_.TYPE_CP;function Oi(t,e,r,i,n){if(Array.isArray(t))return t.map(function(t){return Oi(t,e,r,i)});if(_e.isObject(t)&&t.$$type){var a=t.tagName,o=t.props,s=t.children,h=t.klass,l=t.$$type,u=t.inherit,c=t.__animateRecords;if(l===Ci&&t.placeholder)return t.value;if(l===Pi){if("img"===a){if(f=new Mi(a,o),Array.isArray(s)&&s.length)throw new Error("Img can not contain children")}else f=new ki(a,o);if("p"===a)n=!0;else if("div"===a&&n)throw new Error("Markup p can not contain div");s=Array.isArray(s)?Fi(f,Oi(s,e,r,i,n)):[],f.__children=s}else if(l===Ri)var f=new(wi.getRegister(a))(a,o);else{if(l!==Ci)return new $t(t);(f=new h(o)).__tagName=f.__tagName||a}t.vd=f,c&&(f.__animateRecords=c).list.forEach(function(t){t.target=f}),u&&_e.extendAnimate(u,f),f.__root=e,i&&(f.__host=i),l===Ci&&f.__init();var d=o.ref;return _e.isString(d)&&d||_e.isNumber(d)?r.ref[d]=f:_e.isFunction(d)&&d(f),f}return new $t(t)}function Li(t){if(Array.isArray(t))return t.map(Li);if(!t||-1===[Pi,Ri,Ci].indexOf(t.$$type)||!Array.isArray(t.children))return t;var e=[];return function e(r,t,i){if(Array.isArray(t))t.forEach(function(t){e(r,t,i)});else if(!t||t.$$type!==Pi&&t.$$type!==Ri)t&&t.$$type===Ci?(r.push(t),i.lastText=null):_e.isNil(t)||""===t||(null!==i.lastText?r[r.length-1]=i.lastText+=t:r.push(t));else{if(-1<["canvas","svg"].indexOf(t.tagName))throw new Error("Can not nest canvas/svg");t.$$type===Pi&&Li(t.children),r.push(t),i.lastText=null}}(e,t.children,{lastText:null}),t.children=e,t}function Fi(e,t){var r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(t)?t.forEach(function(t){Fi(e,t,i)}):(t instanceof xi||t instanceof Ai||t instanceof $t)&&(t.__parent=e,i.prev&&((i.prev.__next=t).__prev=i.prev),(i.prev=t)instanceof ki?Fi(t,t.children):t instanceof Ai&&((r=t.shadowRoot)instanceof $t&&(r.__parent=e))),t}var Ni={ref:function(t){xi=t.Xom,ki=t.Dom,Mi=t.Img,wi=t.Geom,Ai=t.Component},initRoot:function(t,e){return Fi(e,Oi(Li({children:t,$$type:Pi}).children,e,e))},initCp:function(t,e,r){if(_e.isObject(t)){var i=Oi(t,e,r,r);return Array.isArray(i)&&Fi(r,i),i}return new $t(t)},flattenJson:Li,relation:Fi,build:Oi},Ii=_e.isNil,Bi=_e.isFunction,Di=_e.clone,Wi=_e.extend;var Gi=function(){t(h,nr);var r=e(h);function h(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l(this,h),(t=r.call(this)).__tagName=/(?:function|class)\s+([\w$]+)/.exec(t.constructor.toString())[1],Array.isArray(e)?t.props=_e.arr2hash(e):t.props=e,t.__parent=null,t.__host=null,t.__ref={},t.__state={},t.__isMounted=!1,t}return u(h,[{key:"setState",value:function(t,e){var r=this,i=this;if(Ii(t))t={};else{if(Bi(t))return void e.call(i);if(0===Object.keys(t).length)return void(Bi(e)&&e.call(i));var n=Di(i.state);t=Wi(n,t)}var a=i.root;a&&i.__isMounted?(a.delRefreshTask(i.__task),this.__task={before:function(){i.__nextState=t,function t(e){e.__hasUpdate=!0;var r=e.host;r&&t(r)}(r)},after:function(){Bi(e)&&e.call(i)},__state:!0},a.addRefreshTask(i.__task)):Bi(e)&&(i.__state=t,e.call(i))}},{key:"__init",value:function(t){var e,r=this,i=this.root,n=t||Ni.flattenJson(this.render()),a=Ni.initCp(n,i,this,this);if(this.__cd=n,a instanceof $t)console.warn("Component render() return a text, should not inherit style/event");else if(a instanceof M){var o=Yt.normalize(this.props.style),s=Object.keys(o);Wi(a.style,o,s),Wi(a.currentStyle,o,s),Object.keys(this.props).forEach(function(t){var e=r.props[t];/^on[a-zA-Z]/.test(t)?(t=t.slice(2).toLowerCase(),a.listener[t]=e):/^on-[a-zA-Z\d_$]/.test(t)&&(t=t.slice(3),r.on(t,e))})}else{if(!(a instanceof h))throw new Error("Component render() must return a dom/text: "+this);console.warn("Component render() return a component: "+this.tagName+" -> "+a.tagName+", should not inherit style/event")}for((this.__shadow=a).__host=this;a instanceof h;)a=a.shadowRoot;(a.__host=this).__shadowRoot=a,this.__isMounted||(this.__isMounted=!0,e=this.componentDidMount,Bi(e)&&i.once(nr.REFRESH,function(){e.call(r)}))}},{key:"render",value:function(){}},{key:"__destroy",value:function(){var t;this.isDestroyed||(this.__isDestroyed=!0,t=this.componentWillUnmount,Bi(t)&&(t.call(this),this.__isMounted=!1),this.root.delRefreshTask(this.__task),this.shadowRoot&&this.shadowRoot.__destroy(),this.__shadow=null,this.__shadowRoot=null,this.__parent=null)}},{key:"__emitEvent",value:function(t){var e=this.shadowRoot;if(!(e instanceof $t))return e.__emitEvent(t)?(t.target=this,!0):void 0}},{key:"__computeMeasure",value:function(t,e,r,i){var n=this.shadowRoot;n instanceof $t?n.__computeMeasure(t,e):n.__computeMeasure(t,e,!0,i)}},{key:"tagName",get:function(){return this.__tagName}},{key:"shadow",get:function(){return this.__shadow}},{key:"shadowRoot",get:function(){return this.__shadowRoot}},{key:"root",get:function(){return this.__root}},{key:"host",get:function(){return this.__host}},{key:"parent",get:function(){return this.__parent}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"ref",get:function(){return this.__ref}},{key:"state",get:function(){return this.__state},set:function(t){this.__state=t}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),h}();Object.keys(Ot.GEOM).concat(["x","y","ox","oy","sx","sy","width","height","outerWidth","outerHeight","innerWidth","innerHeight","style","animationList","animateStyle","currentStyle","computedStyle","currentProps","baseLine","virtualDom","mask","maskId","textWidth","content","lineBoxes","charWidthList","charWidth","layoutData","availableAnimating","effectiveAnimating","displayAnimating","visibilityAnimating","__refreshLevel","__cacheTotal","__cache","bbox","__struct"]).forEach(function(e){Object.defineProperty(Gi.prototype,e,{get:function(){var t=this.shadowRoot;if(t)return t[e]}})}),["__layout","__layoutAbs","__tryLayInline","__offsetX","__offsetY","__calAutoBasis","__calMp","__calAbs","__renderAsMask","__renderByMask","__mp","animate","removeAnimate","clearAnimate","updateStyle","deepScan","__cancelCache","__applyCache","__mergeBbox","__structure","__modifyStruct"].forEach(function(e){Gi.prototype[e]=function(){var t=this.shadowRoot;if(t&&Bi(t[e]))return t[e].apply(t,arguments)}});var Hi=0,zi=1,Yi=2,Xi=f.AUTO,$i=f.PX,ji=f.PERCENT,Vi=_e.int2rgba,qi=_e.isNil,Ui={},Zi=function(){t(p,Si);var s=e(p);function p(t,e){var r;l(this,p),(r=s.call(this,t,e)).__isMulti=!!r.props.multi,r.__isMask=!!r.props.mask,r.__isClip=!!r.props.clip;var i=h(r),n=i.style,a=i.isMask,o=i.isClip;return(a||o)&&(n.visibility="visible",n.background=null,n.border=null,n.strokeWidth=0,n.stroke=null,o&&(n.fill="#FFF",n.opacity=1)),r.__style=Yt.normalize(r.style,it.DOM_ENTRY_SET.concat(it.GEOM_ENTRY_SET)),r.__currentStyle=_e.extend({},r.__style),r.__currentProps=_e.clone(r.props),r.__cacheProps={},r}return u(p,[{key:"__tryLayInline",value:function(t,e){var r=this.currentStyle.width;return r.unit===$i?t-r.value:r.unit===ji?t-e*r.value*.01:t}},{key:"__calAutoBasis",value:function(t){var e,r,i=0,n=0,a=0,o=this.currentStyle,s=this.computedStyle,h=o.width,l=o.height,u=s.borderTopWidth,c=s.borderRightWidth,f=s.borderBottomWidth,d=s.borderLeftWidth,_=t?h:l;return _.unit!==Xi&&(i=a+=_.value),t?(i+=e=c+d,a+=e,n+=e):(i+=r=u+f,a+=r,n+=r),{b:i,min:n,max:a}}},{key:"__layoutBlock",value:function(t,e){var r=this.__preLayout(t),i=r.fixedWidth,n=r.fixedHeight,a=r.w,o=r.h;this.__height=n?o:0,e?this.__width=i?a:0:(this.__width=a,this.__marginAuto(this.currentStyle,t),this.__cacheProps={})}},{key:"__layoutFlex",value:function(t){this.__layoutBlock(t)}},{key:"__layoutInline",value:function(t){var e=this.__preLayout(t),r=e.fixedWidth,i=e.fixedHeight,n=e.x,a=e.y,o=e.w,s=e.h;this.__width=r?o:n-t.x,this.__height=i?s:a-t.y,this.__cacheProps={}}},{key:"__preSet",value:function(r,i,n){var t,a=this,e=this.sx,o=this.sy,s=this.width,h=this.height,l=this.__cacheStyle,u=this.currentStyle,c=this.computedStyle,f=c.borderTopWidth,d=c.borderLeftWidth,_=c.display,p=c.marginTop,v=c.marginLeft,y=c.paddingTop,g=c.paddingRight,m=c.paddingBottom,b=c.paddingLeft,x=c.visibility,k=e+d+v+b,M=o+f+p+y,w=k+.5*s,A=M+.5*h,S=s+b+g,E=h+y+m;["stroke","fill"].forEach(function(t){var e;qi(l[t])&&(e=u[t],!(c[t]=e)||"linear"!==e.k&&"radial"!==e.k?l[t]=Vi(u[t]):l[t]=a.__gradient(r,i,n,k,M,k+s,M+h,S,E,e))}),qi(l.strokeWidth)&&(l.strokeWidth=!0,(t=u.strokeWidth).unit===$i?c.strokeWidth=t.value:t.unit===ji?c.strokeWidth=t.value*s*.01:c.strokeWidth=0),qi(l.strokeDasharray)&&(l.strokeDasharray=!0,c.strokeDasharray=u.strokeDasharray,l.strokeDasharrayStr=_e.joinArr(u.strokeDasharray,",")),["strokeLinecap","strokeLinejoin","strokeMiterlimit","fillRule"].forEach(function(t){c[t]=u[t]});var T=l.fill,P=l.stroke,R=l.strokeDasharrayStr,C=c.strokeWidth,O=c.strokeLinecap,L=c.strokeLinejoin,F=c.strokeMiterlimit,N=c.strokeDasharray,I=c.fillRule;return{x:e,y:o,originX:k,originY:M,cx:w,cy:A,display:_,stroke:P,strokeWidth:C,strokeDasharray:N,strokeDasharrayStr:R,strokeLinecap:O,strokeLinejoin:L,strokeMiterlimit:F,fill:T,visibility:x,fillRule:I}}},{key:"__preSetCanvas",value:function(t,e,r){var i=r.stroke,n=r.strokeWidth,a=r.strokeDasharray,o=r.strokeLinecap,s=r.strokeLinejoin,h=r.strokeMiterlimit,l=r.fill;t===fe.CANVAS&&(e.fillStyle!==l&&(e.fillStyle=l),e.strokeStyle!==i&&(e.strokeStyle=i),e.lineWidth!==n&&(e.lineWidth=n),e.lineCap!==o&&(e.lineCap=o),e.lineJoin!==s&&(e.lineJoin=s),e.miterLimit!==h&&(e.miterLimit=h),_e.isFunction(e.getLineDash)&&_e.equalArr(e.getLineDash(),a)||e.setLineDash(a))}},{key:"render",value:function(t,e,r,i){var n=_t(dt(p.prototype),"render",this).call(this,t,e,r,i),a=this.__cacheFilter,o=this.__cacheTotal,s=this.__cache,h=this.virtualDom;if(e<qr.REPAINT&&(o&&o.available||s&&s.available||!qr.contain(e,qr.FILTER)&&a)&&(n.break=!0),t===fe.SVG&&(o?o.available||(o.available=!0):this.__cacheTotal={available:!0,release:function(){this.available=!1,delete h.cache}},this.virtualDom.type="geom"),n.break)return n;this.__cacheFilter=null;var l=this.root.cache&&t===fe.CANVAS?this.__preData:this.__preSet(t,r,i),u=n.x2,c=n.y2,f=l.originX,d=l.originY,_=this.computedStyle;return u+=_.paddingLeft,c+=_.paddingTop,l.dx=u-f,l.dy=c-d,this.__preSetCanvas(t,r,l),Object.assign(n,l)}},{key:"__renderAsMask",value:function(t,e,r,i,n){var a;t===fe.CANVAS?this.root.cache&&(this.__preData=this.__preSet(t,r,i)):t===fe.SVG&&(this.render(t,e,r,i),a=this.virtualDom,n?a.isClip=!0:a.isMask=!0,delete a.lv)}},{key:"__applyCache",value:function(t,e,r,i,n,a,o){var s,h,l,u,c,f,d,_,p,v,y,g,m,b,x,k,M,w,A,S,E,T,P,R,C,O,L,F=this.__cacheFilter,N=this.__cacheMask,I=this.__cache,B=this.computedStyle,D=F||N;i===Yi?(s=this.sx,h=this.sy,s+=B.marginLeft,h+=B.marginTop,u=(l=ue(n.coords,2))[0],c=l[1],f=n.x1,d=n.y1,_=u+s-f+n.dbx,p=c+h-d+n.dby,(v=B.transformOrigin.slice(0))[0]+=_,v[1]+=p,y=be.calMatrixByOrigin(B.transform,v),o=de.multiply(o,y),r.setTransform.apply(r,ce(o)),a*=B.opacity,r.globalAlpha=a,D?ti.drawCache(D,n):I&&I.available&&ti.drawCache(I,n)):i===Hi&&(g=this.__opacity,m=this.matrixEvent,r.globalAlpha=g,r.setTransform.apply(r,ce(m)),D?(b=D.x1,x=D.y1,k=D.dbx,M=D.dby,w=D.canvas,r.drawImage(w,b-1-k,x-1-M)):I&&I.available&&(S=(A=ue(I.coords,2))[0],E=A[1],T=I.x1,P=I.y1,R=I.dbx,C=I.dby,O=I.canvas,L=I.size,r.drawImage(O,S-1,E-1,L,L,T-1-R,P-1-C,L,L)))}},{key:"__propsStrokeStyle",value:function(t,e,r,i,n){e&&t.push(["stroke-dasharray",e]),"butt"!==r&&t.push(["stroke-linecap",r]),"miter"!==i&&t.push(["stroke-linejoin",i]),4!==n&&t.push(["stroke-miterlimit",n])}},{key:"__cancelCache",value:function(t){_t(dt(p.prototype),"__cancelCache",this).call(this,t),this.__cacheProps={}}},{key:"__calCache",value:function(){return _t(dt(p.prototype),"__calCache",this).apply(this,arguments),!0}},{key:"addGeom",value:function(t,e){e=_e.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"getProps",value:function(t){var e=this.currentProps[t];return qi(e)?this["__"+t]:e}},{key:"baseLine",get:function(){return this.__height}},{key:"isMulti",get:function(){return this.__isMulti}},{key:"isMask",get:function(){return this.__isMask}},{key:"isClip",get:function(){return this.__isClip}},{key:"currentProps",get:function(){return this.__currentProps}}],[{key:"getRegister",value:function(t){if(!Ui.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return Ui[t]}},{key:"register",value:function(t,e){if(p.hasRegister(t))throw new Error("Geom has already register: ".concat(t));Ui[t]=e}},{key:"hasRegister",value:function(t){return Ui.hasOwnProperty(t)}}]),p}(),Ki=f.AUTO,Ji=f.PX,Qi=f.PERCENT,tn=Yt.calAbsolute,en=Yt.isRelativeOrAbsolute;function rn(t){var n,a=[],o=[],s=!1;return t.children.forEach(function(t,e){var r,i=t;t instanceof Gi&&(t=t.shadowRoot),t.isMask||t.isClip||!(t.__layoutData||t instanceof $t)||(t instanceof Si&&en(t)?(i.__iIndex=e,r=i.__zIndex=t.currentStyle.zIndex,o.push(i),void 0===n?n=r:s||(r<n&&(s=!0),n=r)):a.push(i))}),s&&o.sort(function(t,e){return t.__zIndex!==e.__zIndex?t.__zIndex-e.__zIndex:t.__iIndex-e.__iIndex}),a.concat(o)}function nn(t){var r=[];return t.children.forEach(function(t){var e=t;t instanceof Gi&&(t=t.shadowRoot),(t.isMask||t.isClip)&&r.push(e)}),r}var an,on,sn,hn=function(){t(ft,Si);var a=e(ft);function ft(t,e,r){var i;l(this,ft),(i=a.call(this,t,e)).__lineGroups=[];var n=h(i).style;return n.display&&{flex:!0,block:!0,inline:!0,none:!0}.hasOwnProperty(n.display)||(Ti.INLINE.hasOwnProperty(i.tagName)?n.display="inline":n.display="block"),!n.fontWeight&&Ti.BOLD.hasOwnProperty(t)&&(n.fontWeight=700),i.__style=Yt.normalize(n,it.DOM_ENTRY_SET),i.__currentStyle=_e.extend({},i.__style),i.__children=r||[],i}return u(ft,[{key:"__structure",value:function(i,n,t){var e,r=_t(dt(ft.prototype),"__structure",this).call(this,i++,n,t),a=[r],o=this.__zIndexChildren=this.__zIndexChildren||rn(this);return!this.root.cache||this.root.renderMode!==fe.CANVAS||(e=this.__maskChildren=this.__maskChildren||nn(this)).length&&(o=e.concat(o)),o.forEach(function(t,e){var r=t.__structure(i,n+1,e);Array.isArray(r)?(i+=r.length,a=a.concat(r)):(i++,a.push(r))}),r.num=o.length,r.total=a.length-1,a}},{key:"__modifyStruct",value:function(t,e){var r,i=1<arguments.length&&void 0!==e?e:0,n=this.__struct,a=this.__structure(n.index,n.lv,n.childIndex);(r=t.__structs).splice.apply(r,[n.index+i,n.total+1].concat(ce(a)));var o=0;return this!==t&&(o=this.__struct.total-n.total,(n=this.domParent.__struct).total+=o),[this.__struct,o]}},{key:"__updateStruct",value:function(t){var e=this.__struct,r=e.index,i=e.total,n=this.__zIndexChildren=rn(this);if(1!==n.length){n.forEach(function(t,e){t.__struct.childIndex=e});for(var a,o,s=[],h=r+1;h<=i;h++){var l=t[h];s.push({child:l,list:t.slice(l.index,l.index+l.total+1)}),h+=l.total}s.sort(function(t,e){var r=t.child.childIndex-e.child.childIndex;return r<0&&(a=!0),r}),a&&(o=[],s.forEach(function(t){o=o.concat(t.list)}),o.forEach(function(t,e){t.index=r+e+1}),t.splice.apply(t,[r+1,i].concat(ce(o))))}}},{key:"__tryLayInline",value:function(t,e){var r=this.flowChildren,i=this.currentStyle.width;if(i.unit===Ji)return t-i.value;if(i.unit===Qi)return t-e*i.value*.01;for(var n=0;n<r.length;n++){if(t<0)return t;var a=r[n];t-=a instanceof Si||a instanceof Gi?a.__tryLayInline(t,e):a.textWidth}return t}},{key:"__offsetX",value:function(e,r,i){_t(dt(ft.prototype),"__offsetX",this).call(this,e,r,i),this.flowChildren.forEach(function(t){t&&t.__offsetX(e,r,i)})}},{key:"__offsetY",value:function(e,r,i){_t(dt(ft.prototype),"__offsetY",this).call(this,e,r,i),this.flowChildren.forEach(function(t){t&&t.__offsetY(e,r,i)})}},{key:"__calAutoBasis",value:function(a,o,s,t){var e,r,i,n,h=0,l=0,u=0,c=this.flowChildren,f=this.currentStyle,d=(this.computedStyle,f.width),_=f.height,p=f.marginLeft,v=f.marginTop,y=f.marginRight,g=f.marginBottom,m=f.paddingLeft,b=f.paddingTop,x=f.paddingRight,k=f.paddingBottom,M=f.borderTopWidth,w=f.borderRightWidth,A=f.borderBottomWidth,S=f.borderLeftWidth,E=a?d:_;return E.unit===Ji&&(h=u=E.value,t&&(l=h)),c.forEach(function(t){var e,r,i,n;u=t instanceof Si||t instanceof Gi&&t.shadowRoot instanceof Si?(r=(e=t.__calAutoBasis(a,o,s,!0)).b,i=e.min,n=e.max,h=Math.max(h,r),l=Math.max(l,i),Math.max(u,n)):a?(l=Math.max(t.charWidth,l),Math.max(t.textWidth,u)):(Yt.computeReflow(t),t.__layout({x:0,y:0,w:o,h:s},!0),l=Math.max(l,t.height),Math.max(u,t.height))}),a?(e=this.__calMp(p,o)+this.__calMp(y,o)+this.__calMp(m,o)+this.__calMp(x,o),r=S.value+w.value+e,h+=r,u+=r,l+=r):(i=this.__calMp(v,o)+this.__calMp(g,o)+this.__calMp(b,o)+this.__calMp(k,o),n=M.value+A.value+i,h+=n,u+=n,l+=n),{b:h,min:l,max:u}}},{key:"__calMp",value:function(t,e){var r=0;return t.unit===Ji?r+=t.value:t.unit===Qi&&(t.value*=.01*e,t.unit=Ji,r+=t.value),r}},{key:"__layoutBlock",value:function(e,r){var t=this.flowChildren,i=this.currentStyle,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o,s,h,l=n.textAlign,u=this.__preLayout(e),c=u.fixedWidth,f=u.fixedHeight,d=u.x,_=u.y,p=u.w,v=u.h;c&&r?this.__width=p:(s=o=0,h=new Ei(d,_),t.forEach(function(t){t instanceof Si||t instanceof Gi&&t.shadowRoot instanceof Si?"inline"===t.currentStyle.display?d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:v},r),d+=t.outerWidth,r&&(o=Math.max(o,s),s=t.outerWidth)):(0<=t.__tryLayInline(p-d+e.x,p)?t.__layout({x:d,y:_,w:p,h:v},r):(a.push(h),r||h.verticalAlign(),d=e.x,_+=h.height+h.marginBottom,t.__layout({x:e.x,y:_,w:p,h:v},r),h=new Ei(d,_),r&&(o=Math.max(o,s),s=0)),d+=t.outerWidth,h.add(t),r&&(s+=t.outerWidth)):(h.size&&(a.push(h),h.verticalAlign(),_+=h.height+h.marginBottom,h=new Ei(e.x,_),r&&(o=Math.max(o,s),s=0)),t.__layout({x:e.x,y:_,w:p,h:v},r),d=e.x,_+=t.outerHeight,r&&(o=Math.max(o,t.outerWidth),s=0)):d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:v},r),d+=t.width,r&&(o=Math.max(o,s),s=t.width)):(0<=t.__tryLayInline(p-d+e.x)?t.__layout({x:d,y:_,w:p,h:v},r):(a.push(h),h.verticalAlign(),d=e.x,_+=h.height+h.marginBottom,t.__layout({x:e.x,y:_,w:p,h:v},r),h=new Ei(d,_),r&&(o=Math.max(o,s),s=0)),d+=t.width,h.add(t),r&&(s+=t.width))}),h.size&&(a.push(h),r?o=Math.max(o,s):h.verticalAlign(),_+=h.height),this.__width=c||!r?p:o,this.__height=f?v:_-e.y,h.size&&(_+=h.marginBottom),!r&&-1<["center","right"].indexOf(l)&&a.forEach(function(t){var e=p-t.width;0<e&&t.horizonAlign("center"===l?.5*e:e)}),r||this.__marginAuto(i,e))}},{key:"__layoutFlex",value:function(t,u){var e=this.flowChildren,r=this.currentStyle,i=r.flexDirection,n=r.justifyContent,a=r.alignItems,o=this.__preLayout(t),s=o.fixedWidth,A=o.fixedHeight,S=o.x,E=o.y,T=o.w,P=o.h;if(s&&u)this.__width=T;else{var c=0,R="row"===i,C=[],O=[],L=[],F=[],N=0,I=0,B=0,f=0;if(e.forEach(function(t){if(t instanceof Si||t instanceof Gi&&t.shadowRoot instanceof Si){var e=t.__calAutoBasis(!!u||R,T,P),r=e.b,i=e.min,n=e.max;if(u)return void(R?c+=n:c=Math.max(c,n));var a=t.currentStyle,o=t.computedStyle,s=a.flexGrow,h=a.flexShrink,l=a.flexBasis;C.push(s),O.push(h),N+=s,I+=h,l.unit===Ki?(L.push(n),B+=n):l.unit===Ji?(o.flexBasis=r=l.value,L.push(r),B+=r):l.unit===Qi&&(r=o.flexBasis=(R?T:P)*l.value*.01,L.push(r),B+=r),f+=n,F.push(i)}else{if(u)return void(R?c+=t.textWidth:c=Math.max(c,t.textWidth));C.push(0),O.push(1),I+=1,R?(L.push(t.textWidth),B+=t.textWidth,f+=t.textWidth,F.push(t.charWidth)):(t.__layout({x:0,y:0,w:T,h:P},!0),L.push(t.height),B+=t.height,f+=t.height,F.push(t.height))}}),u)this.__width=Math.min(c,T);else{var D=0,W=(R?T:P)<f;e.forEach(function(t,e){var r,i,n,a,o,s,h,l,u,c,f,d,_,p,v,y,g,m,b,x,k,M=O[e],w=C[e];i=W?(r=B-(R?T:P),M?L[e]-r*M/I:L[e]):(n=(R?T:P)-B,w?L[e]+n*w/N:L[e]),i=Math.max(i,F[e]),t instanceof Si||t instanceof Gi&&t.shadowRoot instanceof Si?(a=t.currentStyle,o=t.computedStyle,s=a.display,h=a.flexDirection,l=a.width,u=a.height,"inline"===s&&(a.display=o.display="block"),R?("flex"===s&&"column"===h&&A&&u.unit===Ki&&(u.value=P,u.unit=Ji),t.__layout({x:S,y:E,w:i,h:P})):("flex"===s&&"row"===h&&l.unit===Ki&&(l.value=T,l.unit=Ji),t.__layout({x:S,y:E,w:T,h:i})),(W&&M||!W&&w)&&(c=o.borderTopWidth,f=o.borderRightWidth,d=o.borderBottomWidth,_=o.borderLeftWidth,p=o.marginTop,v=o.marginRight,y=o.marginBottom,g=o.marginLeft,m=o.paddingTop,b=o.paddingRight,x=o.paddingBottom,k=o.paddingLeft,R?t.__width=i-g-v-k-b-_-f:t.__height=i-p-y-m-x-c-d)):t.__layout({x:S,y:E,w:R?i:T,h:R?P:i}),D=R?(S+=t.outerWidth,Math.max(D,t.outerHeight)):(E+=t.outerHeight,Math.max(D,t.outerWidth))});var h=R?T-S+t.x:P-E+t.y;if(!W&&0===N&&0<h){var l=e.length;if("flex-end"===n)for(var d=0;d<l;d++){var _=e[d];R?_.__offsetX(h,!0):_.__offsetY(h,!0)}else if("center"===n)for(var p=.5*h,v=0;v<l;v++){var y=e[v];R?y.__offsetX(p,!0):y.__offsetY(p,!0)}else if("space-between"===n)for(var g=h/(l-1),m=1;m<l;m++){var b=e[m];R?b.__offsetX(g*m,!0):b.__offsetY(g*m,!0)}else if("space-around"===n)for(var x=h/(l+1),k=0;k<l;k++){var M=e[k];R?M.__offsetX(x*(k+1),!0):M.__offsetY(x*(k+1),!0)}}R?(A&&(D=P),E+=D):s&&(D=T),u||("stretch"===a?e.forEach(function(t){var e,r,i,n,a=t.computedStyle,o=t.currentStyle,s=o.alignSelf,h=o.width,l=o.height,u=a.borderTopWidth,c=a.borderRightWidth,f=a.borderBottomWidth,d=a.borderLeftWidth,_=a.marginTop,p=a.marginRight,v=a.marginBottom,y=a.marginLeft,g=a.paddingTop,m=a.paddingRight,b=a.paddingBottom,x=a.paddingLeft;R?"flex-start"===s||("center"===s?0!=(e=D-t.outerHeight)&&t.__offsetY(.5*e,!0):"flex-end"===s?0!=(r=D-t.outerHeight)&&t.__offsetY(r,!0):l.unit===Ki&&(t.__height=a.height=D-_-v-g-b-u-f)):"flex-start"===s||("center"===s?0!=(i=D-t.outerWidth)&&t.__offsetX(.5*i,!0):"flex-end"===s?0!=(n=D-t.outerWidth)&&t.__offsetX(n,!0):h.unit===Ki&&(t.__width=a.width=D-y-p-x-m-c-d))}):"center"===a?e.forEach(function(t){var e,r,i,n,a,o,s,h,l,u,c,f,d,_,p,v,y,g,m,b,x=t.currentStyle.alignSelf;R?"flex-start"===x||("flex-end"===x?0!=(e=D-t.outerHeight)&&t.__offsetY(e,!0):"stretch"===x?(r=t.computedStyle,i=t.currentStyle.height,n=r.borderTopWidth,a=r.borderBottomWidth,o=r.marginTop,s=r.marginBottom,h=r.paddingTop,l=r.paddingBottom,i.unit===Ki&&(t.__height=r.height=D-o-s-h-l-n-a)):0!=(u=D-t.outerHeight)&&t.__offsetY(.5*u,!0)):"flex-start"===x||("flex-end"===x?0!=(c=D-t.outerWidth)&&t.__offsetX(c,!0):"stretch"===x?(f=t.computedStyle,d=t.currentStyle.width,_=f.borderRightWidth,p=f.borderLeftWidth,v=f.marginRight,y=f.marginLeft,g=f.paddingRight,m=f.paddingLeft,d.unit===Ki&&(t.__width=f.width=D-y-v-m-g-_-p)):0!=(b=D-t.outerWidth)&&t.__offsetX(.5*b,!0))}):"flex-end"===a?e.forEach(function(t){var e,r,i,n,a,o,s,h,l,u,c,f,d,_,p,v,y,g,m,b,x=t.currentStyle.alignSelf;R?"flex-start"===x||("center"===x?0!=(e=D-t.outerHeight)&&t.__offsetY(.5*e,!0):"stretch"===x?(r=t.computedStyle,i=t.currentStyle.height,n=r.borderTopWidth,a=r.borderBottomWidth,o=r.marginTop,s=r.marginBottom,h=r.paddingTop,l=r.paddingBottom,i.unit===Ki&&(t.__height=r.height=D-o-s-h-l-n-a)):0!=(u=D-t.outerHeight)&&t.__offsetY(u,!0)):"flex-start"===x||("center"===x?0!=(c=D-t.outerWidth)&&t.__offsetX(.5*c,!0):"stretch"===x?(f=t.computedStyle,d=t.currentStyle.width,_=f.borderRightWidth,p=f.borderLeftWidth,v=f.marginRight,y=f.marginLeft,g=f.paddingRight,m=f.paddingLeft,d.unit===Ki&&(t.__width=f.width=D-y-v-m-g-_-p)):0!=(b=D-t.outerHeight)&&t.__offsetY(b,!0))}):e.forEach(function(t){var e,r,i,n,a,o,s,h,l,u,c,f,d,_,p,v,y,g,m,b,x=t.currentStyle.alignSelf;R?"flex-start"===x||("center"===x?0!=(e=D-t.outerHeight)&&t.__offsetY(.5*e,!0):"flex-end"===x?0!=(r=D-t.outerHeight)&&t.__offsetY(r,!0):"stretch"===x&&(i=t.computedStyle,n=t.currentStyle.height,a=i.borderTopWidth,o=i.borderBottomWidth,s=i.marginTop,h=i.marginBottom,l=i.paddingTop,u=i.paddingBottom,n.unit===Ki&&(t.__height=i.height=D-s-h-l-u-a-o))):"flex-start"===x||("center"===x?0!=(c=D-t.outerWidth)&&t.__offsetX(.5*c,!0):"flex-end"===x?0!=(f=D-t.outerWidth)&&t.__offsetX(f,!0):"stretch"===x&&(d=t.computedStyle,_=t.currentStyle.width,p=d.borderRightWidth,v=d.borderLeftWidth,y=d.marginRight,g=d.marginLeft,m=d.paddingRight,b=d.paddingLeft,_.unit===Ki&&(t.__width=d.width=D-g-y-b-m-p-v)))})),this.__width=T,this.__height=A?P:E-t.y,this.__marginAuto(r,t)}}}},{key:"__layoutInline",value:function(e,r){var i=this,t=this.flowChildren,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o,s,h,l=n.textAlign,u=this.__preLayout(e),c=u.fixedWidth,f=u.fixedHeight,d=u.x,_=u.y,p=u.w,v=u.h;c&&r?this.__width=p:(s=o=0,h=new Ei(d,_),t.forEach(function(t){t instanceof Si||t instanceof Gi&&t.shadowRoot instanceof Si?("inline"!==t.currentStyle.display&&(t.currentStyle.display=t.computedStyle.display="inline",console.error("Inline can not contain block/flex")),d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:v},r),d+=t.outerWidth,o=Math.max(o,s),s=t.outerWidth):(0<=t.__tryLayInline(p-d+e.x,p)?t.__layout({x:d,y:_,w:p,h:v},r):(a.push(h),h.verticalAlign(),d=e.x,_+=h.height,t.__layout({x:e.x,y:_,w:p,h:v},r),h=new Ei(d,_),o=Math.max(o,s),s=0),d+=t.outerWidth,h.add(t),s+=t.outerWidth)):d===e.x?(h.add(t),t.__layout({x:d,y:_,w:p,h:v},r),d+=t.width,o=Math.max(o,s),s=t.width):(0<=t.__tryLayInline(p-d+e.x)?t.__layout({x:d,y:_,w:p,h:v},r):(a.push(h),r||h.verticalAlign(),d=e.x,_+=h.height,t.__layout({x:e.x,y:_,w:p,h:v},r),h=new Ei(d,_),o=Math.max(o,s),s=0),d+=t.width,h.add(t),s+=t.width)}),h.size&&(a.push(h),r||h.verticalAlign(),_+=h.height,o=Math.max(o,s)),this.__width=c?p:o,this.__height=f?v:_-e.y,!r&&-1<["center","right"].indexOf(l)&&a.forEach(function(t){var e=i.__width-t.width;0<e&&t.horizonAlign("center"===l?.5*e:e)}))}},{key:"__layoutAbs",value:function(r,i,A){var S=r.sx,E=r.sy,T=r.innerWidth,P=r.innerHeight,t=r.computedStyle,e=this.isDestroyed,n=this.children,a=this.absChildren,o=t.display,s=t.borderTopWidth,h=t.borderLeftWidth,l=t.marginTop,u=t.marginLeft,R=t.paddingLeft;e||"none"===o||(S+=u+h,E+=l+s,a.forEach(function(t){if(!A||A===t){var e=t.currentStyle,r=t.computedStyle;t.__mp(e,r,T),"inline"===r.display&&(e.display=r.display="block");var i,n,a,o,s,h,l,u,c,f,d,_=e.left,p=e.top,v=e.right,y=e.bottom,g=e.width,m=e.height,b=e.display,x=e.flexDirection;if(_.unit!==Ki?(f=!0,r.left=tn(e,"left",_,T)):r.left="auto",v.unit!==Ki?(u=!0,r.right=tn(e,"right",v,T)):r.right="auto",p.unit!==Ki?(l=!0,r.top=tn(e,"top",p,P)):r.top="auto",y.unit!==Ki?(c=!0,r.bottom=tn(e,"bottom",y,P)):r.bottom="auto",f&&u?(i=S+r.left,a=S+T-r.right-i):f&&g.unit!==Ki?(i=S+r.left,a=g.unit===Ji?g.value:T*g.value*.01):u&&g.unit!==Ki?(a=g.unit===Ji?g.value:T*g.value*.01,i=S+T-r.right-a,i-=r.marginLeft,i-=r.marginRight,i-=r.paddingLeft,i-=r.paddingRight,i-=e.borderLeftWidth.value,i-=e.borderRightWidth.value):f?i=S+r.left:u?(i=S+T-r.right,s=!0):(i=S+R,g.unit!==Ki&&(a=g.unit===Ji?g.value:T*g.value*.01)),l&&c)n=E+r.top,o=E+P-r.bottom-n;else if(l&&m.unit!==Ki)n=E+r.top,o=m.unit===Ji?m.value:P*m.value*.01;else if(c&&m.unit!==Ki)o=m.unit===Ji?m.value:P*m.value*.01,n=E+P-r.bottom-o,n-=r.marginTop,n-=r.marginBottom,n-=r.paddingTop,n-=r.paddingBottom,n-=e.borderTopWidth.value,n-=e.borderBottomWidth.value;else if(l)n=E+r.top;else if(c)n=E+P-r.bottom,h=!0;else{n=E;for(var k=t.prev;k;){if(k instanceof $t||"absolute"!==k.computedStyle.position){n=k.y+k.outerHeight;break}k=k.prev}k||(n=E),m.unit!==Ki&&(o=m.unit===Ji?m.value:P*m.value*.01)}("block"===b&&void 0===a||"flex"===b&&(void 0===a||"column"===x&&void 0===o))&&(d=!0);var M=s?i-S:T+S-i,w=h?n-E:P+E-n;d&&(t.__layout({x:i,y:n,w:M,h:w},!0,!0),M=t.outerWidth),t.__layout({x:i,y:n,w:M,h:w,w2:a,h2:o},!1,!0),s&&t.__offsetX(-t.outerWidth,!0),h&&t.__offsetY(-t.outerHeight,!0)}}),n.forEach(function(t){var e;A&&A!==t||(t instanceof ft?t.__layoutAbs(en(t)?t:r,i):t instanceof Gi&&((e=t.shadowRoot)instanceof ft&&e.__layoutAbs(e,i)))}))}},{key:"render",value:function(P,R,C,O){var L=this,t=_t(dt(ft.prototype),"render",this).call(this,P,R,C,O),e=(t=t||{}).offScreen,r=t.isDestroyed,i=t.displayNone;e&&e.target&&e.target.ctx?C=e.target.ctx:e=null;var F=this.root,n=this.virtualDom,a=this.children,o=this.computedStyle.position;if(P===fe.SVG&&(n.type="dom"),r||i)return t;var s=this.__blurValue;if(P===fe.CANVAS&&s&&this.__cacheFilter&&R<qr.REPAINT&&!qr.contain(R,qr.FILTER))return t;this.__cacheFilter=null;var h,l,u,c=this.__cacheTotal;if(R<qr.REPAINT&&c&&c.available)return P===fe.CANVAS&&s&&qr.contain(R,qr.FILTER)&&(h=this.__mergeBbox(null,!0),(l=ti.updateCache(c,h))?(this.__cacheTotal=l,this.__cacheFilter=ti.genOffScreenBlur(c,s)):(console.error("CacheTotal is oversize"),this.__cacheTotal=null,this.__cacheFilter=null)),t;P!==fe.SVG||this.__noChildMask||(a.forEach(function(t){t instanceof Gi||!t.isMask&&!t.isClip||(u=!0,t.__renderAsMask(P,t.__refreshLevel,C,O,!t.isMask))}),u||(this.__noChildMask=!0));var f,N=!0,I=!F.cache||P===fe.SVG,d=this.__zIndexChildren=this.__zIndexChildren||rn(this);!F.cache||P!==fe.CANVAS||(f=this.__maskChildren=this.__maskChildren||nn(this)).length&&(d=f.concat(d)),d.forEach(function(t){var e,n,r,i,a,o,s,h,l,u,c,f,d,_,p,v,y,g,m,b,x,k,M,w,A,S,E,T;t instanceof $t||t instanceof Gi&&t.shadowRoot instanceof $t?I&&(P===fe.CANVAS&&(C.globalAlpha!==L.__opacity&&(C.globalAlpha=L.__opacity),C.setTransform.apply(C,ce(L.matrixEvent))),t.__renderByMask(P,null,C)):(e=t.__refreshLevel,r=C,(i=t instanceof Zi)&&(t.__preData=t.__preSet(P,C,O)),P===fe.CANVAS&&i&&(s=t.currentStyle.filter,Array.isArray(s)&&s.forEach(function(t){var e=ue(t,2),r=e[0],i=e[1];"blur"===r&&0<i&&(n=i)}),F.cache?(h=t.__cacheFilter,l=t.__cacheMask,u=t.__cache,h&&n&&R<qr.REPAINT&&!qr.contain(e,qr.FILTER)||l?a=!0:(t.__cacheFilter=t.__cacheMask=null,c=t.bbox,e<qr.REPAINT&&u&&u.available?(a=!0,n&&qr.contain(e,qr.FILTER)&&(l=l&&(t.__cacheMask=ti.updateCache(l,c)),u=t.__cache=ti.updateCache(u,c),l||u&&u.available?t.__cacheFilter=ti.genOffScreenBlur(l||u,n):(console.error("Geom cache is oversize"),t.__cache=null))):(u?u.enabled&&e<qr.REPAINT&&!qr.contain(e,qr.FILTER)||u.reset(c):u=t.__cache=ti.getInstance(c),u&&u.enabled&&(r=u.ctx)))):n&&(f=F.width,d=F.height,(_=tr.getCacheCanvas(f,d,"__$$blur$$__")).ctx&&(r=((o={ctx:C}).target=_).ctx))),p=t.__renderByMask(P,e,r,O),a&&(p={canCache:!0}),P===fe.CANVAS&&i&&!a&&(g=(y=t.next)&&y.isMask,m=y&&y.isClip,(g||m)&&(v=!0),b=t.__cacheMask,x=t.__cache,F.cache&&v&&x&&x.available&&(M=(k=t.computedStyle).transform,w=k.transformOrigin,t.__cacheMask=ti.drawMask(x,y,M,w.slice(0))),F.cache&&n&&(b||x&&x.available)?t.__cacheFilter=ti.genOffScreenBlur(b||x,n):o&&(A=F.width,S=F.height,E=tr.getCacheWebgl(A,S,"__$$blur$$__"),T=Ve.gaussBlur(o.target,E,n,A,S),o.ctx.drawImage(o.target.canvas,0,0),o.target.draw(),T.clear())),N&&p&&p.canCache&&!t.availableAnimating||(N=!1))});var _,p,v,y,g,m,b,x,k,M,w,A,S,E=P===fe.CANVAS&&(N&&!this.effectiveAnimating||s);return!E||s||-1!==["relative","absolute"].indexOf(o)||this.isShadowRoot||(E=!1),P===fe.CANVAS&&(v=(p=this.next)&&p.isMask,y=p&&p.isClip,(v||y)&&(E=_=!0)),P===fe.CANVAS?F.cache?this===F?this.__applyCache(P,R,C,Hi):E&&"img"!==this.tagName.toLowerCase()&&(this.__applyCache(P,R,C,zi),_&&((g=this.__cacheTotal)&&g.available?(b=(m=this.computedStyle).transform,x=m.transformOrigin,k=this.next,this.__cacheMask=ti.drawMask(g,k,b,x.slice(0))):console.error("CacheTotal is oversize with mask"))):e&&(M=F.width,w=F.height,A=tr.getCacheWebgl(M,w,"__$$blur$$__"),S=Ve.gaussBlur(e.target,A,e.blur,M,w),e.ctx.drawImage(e.target.canvas,0,0),e.target.draw(),S.clear()):P===fe.SVG&&(c?c.available||(c.available=!0):this.__cacheTotal={available:!0,release:function(){this.available=!1,delete n.cache}},"img"!==this.tagName.toLowerCase()&&(n.children=d.map(function(t){return t.virtualDom})),n.hasOwnProperty("lv")?this.virtualDom.children.forEach(function(t){"text"===t.type&&(t.cache=!0)}):this.virtualDom.children.forEach(function(t){"text"===t.type&&delete t.cache})),t.canCache&&!N&&(t.canCache=!1),t.canCacheSelf=E,t.hasMC=_,t}},{key:"__applyCache",value:function(e,t,r,i,n,a,o){var s=this.computedStyle,h=this.__blurValue,l=this.__cacheMask,u=this.__cacheFilter,c=this.__cacheTotal,f=this.__cache,d=this.zIndexChildren,_=s.display,p=s.visibility;if("none"!==_)if(i===zi){if("hidden"===p)return;var v=this.__mergeBbox(null,!0);if(!v)return;c?c.enabled||c.reset(v):c=this.__cacheTotal=ti.getInstance(v);var y,g,m=this.sx,b=this.sy,x=m+s.marginLeft,k=b+s.marginTop;c&&c.enabled?(c.__bbox=v,c.__appendData(x,k),c.available||(c.__available=!0,1!==(r=c.ctx).globalAlpha&&(r.globalAlpha=1),r.setTransform(1,0,0,1,0,0),f&&f.available&&ti.drawCache(f,c),d.forEach(function(t){t instanceof $t||t instanceof Gi&&t.shadowRoot instanceof $t?(1!==r.globalAlpha&&(r.globalAlpha=1),r.setTransform(1,0,0,1,0,0),t.__renderByMask(e,null,r,null,c.dx,c.dy)):t.__applyCache(e,t.__refreshLevel,r,Yi,c,1,[1,0,0,1,0,0])}))):(y=m+s.marginLeft,g=b+s.marginTop,_t(dt(ft.prototype),"__applyCache",this).call(this,e,r,y-1,g-1),d.forEach(function(t){t instanceof $t||t instanceof Gi&&t.shadowRoot instanceof $t?t.__renderByMask(e,null,r):t.__applyCache(e,t.__refreshLevel,r,Hi)})),h&&c&&c.available?this.__cacheFilter=ti.genOffScreenBlur(c,h):u&&(console.error("CacheFilter is oversize"),this.__cacheFilter=null)}else if(i===Yi){var M=ue(n.coords,2),w=M[0],A=M[1],S=n.x1,E=n.y1,T=n.dbx,P=n.dby,R=this.sx,C=this.sy;R+=s.marginLeft,C+=s.marginTop;var O=w+R-S+T,L=A+C-E+P;if("hidden"!==p){var F=s.transformOrigin.slice(0);if(a*=s.opacity,r.globalAlpha!==a&&(r.globalAlpha=a),u||l||c&&c.available){var N=u||l||c;return void ti.drawCache(N,n,s.transform,o,F)}F[0]+=O,F[1]+=L;var I=be.calMatrixByOrigin(s.transform,F);o=de.multiply(o,I),r.setTransform.apply(r,ce(o)),f&&f.available&&ti.drawCache(f,n)}d.forEach(function(t){t instanceof $t||t instanceof Gi&&t.shadowRoot instanceof $t?"hidden"!==p&&(r.globalAlpha!==a&&(r.globalAlpha=a),r.setTransform.apply(r,ce(o)),t.__renderByMask(e,null,r,null,O-t.sx+s.paddingLeft,L-t.sy+s.paddingTop)):t.__applyCache(e,t.__refreshLevel,r,i,n,a,o)})}else if(i===Hi){var B=this.__opacity,D=this.matrixEvent;if("hidden"!==p){r.globalAlpha!==B&&(r.globalAlpha=B),r.setTransform.apply(r,ce(D));var W,G,H,z,Y,X,$,j,V,q,U=u||l;if(U){var Z=U.x1,K=U.y1,J=U.dbx,Q=U.dby,tt=U.canvas;return void r.drawImage(tt,Z-1-J,K-1-Q)}if(c&&c.available){var et=c,rt=ue(et.coords,2),it=rt[0],nt=rt[1],at=et.canvas,ot=et.x1,st=et.y1,ht=et.dbx,lt=et.dby,ut=et.width,ct=et.height;return void r.drawImage(at,it-1,nt-1,ut,ct,ot-1-ht,st-1-lt,ut,ct)}f&&f.available&&(G=(W=ue(f.coords,2))[0],H=W[1],z=f.canvas,Y=f.x1,X=f.y1,$=f.dbx,j=f.dby,V=f.width,q=f.height,r.drawImage(z,G-1,H-1,V,q,Y-1-$,X-1-j,V,q))}d.forEach(function(t){t instanceof $t||t instanceof Gi&&t.shadowRoot instanceof $t?"hidden"!==p&&(r.globalAlpha!==B&&(r.globalAlpha=B),r.setTransform.apply(r,ce(D)),t.__renderByMask(e,null,r)):t.__applyCache(e,t.__refreshLevel,r,i)})}}},{key:"__mergeBbox",value:function(r,t,i,n,a,o){var s,e,h,l=this.sx,u=this.sy,c=this.computedStyle,f=c.display;return t?(r=[1,0,0,1,0,0],s=_t(dt(ft.prototype),"__mergeBbox",this).call(this,r,t),i=l,n=u,s?(a=l+c.marginLeft-s[0],o=u+c.marginTop-s[1]):Array.isArray(c.filter)?c.filter.forEach(function(t){var e,r=ue(t,2),i=r[0],n=r[1];"blur"===i&&0<n&&(e=de.int2convolution(n),a=o=e)}):a=o=0):"none"!==f&&((e=c.transformOrigin.slice(0))[0]+=l-i,e[1]+=u-n,h=be.calMatrixByOrigin(c.transform,e),r=de.multiply(r,h),s=_t(dt(ft.prototype),"__mergeBbox",this).call(this,r,t,a,o)),"none"!==f&&this.zIndexChildren.forEach(function(t){var e=t.__mergeBbox(r,!1,i,n,a,o);s?e&&(s[0]=Math.min(s[0],e[0]),s[1]=Math.min(s[1],e[1]),s[2]=Math.max(s[2],e[2]),s[3]=Math.max(s[3],e[3])):s=e}),s}},{key:"__computeMeasure",value:function(e,r,t,i){_t(dt(ft.prototype),"__computeMeasure",this).call(this,e,r,t,i),this.children.forEach(function(t){t.__computeMeasure(e,r,!1,i)})}},{key:"__destroy",value:function(){this.isDestroyed||(this.children.forEach(function(t){t&&t.__destroy()}),_t(dt(ft.prototype),"__destroy",this).call(this),this.children.splice(0),this.lineGroups.splice(0))}},{key:"__emitEvent",value:function(t,e){if(e)return _t(dt(ft.prototype),"__emitEvent",this).call(this,t,e);var r=this.isDestroyed,i=this.computedStyle;if(!r&&"none"!==i.display&&!t.__stopPropagation){var n,a=t.event.type,o=this.listener,s=this.zIndexChildren;o.hasOwnProperty(a)&&(n=o[a]);for(var h=s.length-1;0<=h;h--){var l=s[h];if((l instanceof Si||l instanceof Gi&&l.shadowRoot instanceof Si)&&l.__emitEvent(t)){if(t.__stopPropagation)return;return _e.isFunction(n)&&!t.__stopImmediatePropagation&&n.call(this,t),!0}}return _t(dt(ft.prototype),"__emitEvent",this).call(this,t)}}},{key:"__cancelCache",value:function(e){_t(dt(ft.prototype),"__cancelCache",this).call(this,e),e&&this.children.forEach(function(t){(t instanceof Si||t instanceof Gi&&t.shadowRoot instanceof Si)&&t.__cancelCache(e)})}},{key:"deepScan",value:function(e,r){_t(dt(ft.prototype),"deepScan",this).call(this,e,r)||this.children.forEach(function(t){t.deepScan(e,r)})}},{key:"children",get:function(){return this.__children}},{key:"flowChildren",get:function(){return this.children.filter(function(t){return t instanceof Gi&&(t=t.shadowRoot),t instanceof $t||"absolute"!==t.currentStyle.position})}},{key:"absChildren",get:function(){return this.children.filter(function(t){return t instanceof Gi&&(t=t.shadowRoot),t instanceof Si&&"absolute"===t.currentStyle.position})}},{key:"zIndexChildren",get:function(){return this.__zIndexChildren}},{key:"lineGroups",get:function(){return this.__lineGroups}},{key:"baseLine",get:function(){var t=this.lineGroups.length;if(t){var e=this.lineGroups[t-1];return e.y-this.y+e.baseLine}return this.y}}]),ft}(),ln=f.AUTO,un=Vt.canvasPolygon,cn=Vt.svgPolygon,fn=function(){t(at,hn);var a=e(at);function at(t,e){var r;l(this,at);var i=(r=a.call(this,t,e)).props.src,n=r.__loadImg={};return i||(n.error=!0),r}return u(at,[{key:"__preLayout",value:function(t){var e,r,i=_t(dt(at.prototype),"__preLayout",this).call(this,t),n=this.__loadImg;return n.error||(e=this.props.src,(r=tr.IMG[e])&&r.state===tr.LOADED&&(n.url=e,n.source=r.source,n.width=r.width,n.height=r.height),n.cache=!1),i.fixedWidth&&i.fixedHeight||(n.error?i.fixedWidth?i.h=i.w:i.fixedHeight?i.w=i.h:i.w=i.h=32:n.source?i.fixedWidth?i.h=i.w*n.height/n.width:i.fixedHeight?i.w=i.h*n.width/n.height:(i.w=n.width,i.h=n.height):i.w=i.h=0,i.fixedWidth=!0,i.fixedHeight=!0),i}},{key:"__addGeom",value:function(t,e){e=_e.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),_t(dt(at.prototype),"__destroy",this).call(this)}},{key:"render",value:function(t,e,r,i){var n,a,o=this,s=_t(dt(at.prototype),"render",this).call(this,t,e,r,i),h=this.sx,l=this.sy,u=this.width,c=this.height,f=this.isDestroyed,d=this.props.src,_=this.computedStyle,p=_.display,v=_.borderTopWidth,y=_.borderRightWidth,g=_.borderBottomWidth,m=_.borderLeftWidth,b=_.marginTop,x=_.marginLeft,k=_.paddingTop,M=_.paddingLeft,w=_.borderTopLeftRadius,A=_.borderTopRightRadius,S=_.borderBottomRightRadius,E=_.borderBottomLeftRadius,T=_.visibility,P=this.virtualDom,R=this.__cache;if(f||"none"===p||"hidden"===T)return s;t===fe.CANVAS&&(this.__cacheTotal=R),a=R&&R.enabled?(r=R.ctx,n=s.x2+M,s.y2+k):(n=h+x+m+M,l+b+v+k);var C,O,L,F,N,I=this.__loadImg;if(I.error){var B=.02*Math.min(u,c),D=n+.7*u,W=a+.3*c,G=5*B,H=[[n+.15*u,a+.7*c],[n+.3*u,a+.4*c],[n+.5*u,a+.6*c],[n+.6*u,a+.5*c],[n+.9*u,a+.8*c],[n+.15*u,a+.8*c]];if(t===fe.CANVAS){r.strokeStyle="#CCC",r.lineWidth=B,r.fillStyle="#DDD",r.beginPath(),r.moveTo(n,a),r.lineTo(n+u,a),r.lineTo(n+u,a+c),r.lineTo(n,a+c),r.lineTo(n,a),r.stroke(),r.closePath(),r.beginPath(),r.arc(D,W,G,0,2*Math.PI),r.fill(),r.closePath(),r.beginPath(),r.moveTo(H[0][0],H[0][1]);for(var z=1,Y=H.length;z<Y;z++){var X=H[z];r.lineTo(X[0],X[1])}r.lineTo(H[0][0],H[0][1]),r.fill(),r.closePath()}else if(t===fe.SVG){this.__addGeom("rect",[["x",n],["y",a],["width",u],["height",c],["stroke","#CCC"],["stroke-width",B],["fill","rgba(0,0,0,0)"]]),this.__addGeom("circle",[["cx",D],["cy",W],["r",G],["fill","#DDD"]]);for(var $="",j=0,V=H.length;j<V;j++){var q=H[j];j&&($+=" "),$+=q[0]+","+q[1]}this.__addGeom("polygon",[["points",$],["fill","#DDD"]])}}else if(I.url===d){var U=I.source;if(U){var Z,K,J,Q=Be.calRadius(n,a,u,c,v,y,g,m,w,A,S,E);if(t===fe.CANVAS)Q?(r.save(),r.beginPath(),un(r,Q),r.clip(),r.closePath(),r.drawImage(U,n,a,u,c),r.restore()):r.drawImage(U,n,a,u,c);else if(t===fe.SVG){if(I.cache)return I.cache.cache=!0,P.children=[I.cache],void(!P.cache&&Q&&(Z=cn(Q),K=i.add({tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",Z],["fill","#FFF"]]}]}),P.conClip="url(#"+K+")"));u===I.width&&c===I.height||(J=Ge.matrixResize(I.width,I.height,u,c,n,a,u,c));var tt,et,rt=[["xlink:href",d],["x",n],["y",a],["width",I.width],["height",I.height]];Q&&(tt=cn(Q),et=i.add({tagName:"clipPath",props:[],children:[{type:"item",tagName:"path",props:[["d",tt],["fill","#FFF"]]}]}),P.conClip="url(#"+et+")",delete P.cache),J&&!_e.equalArr(J,[1,0,0,1,0,0])&&rt.push(["transform","matrix("+_e.joinArr(J,",")+")"]);var it={type:"img",tagName:"image",props:rt};P.children=[it],I.cache=it}}}else{var nt=this.__loadImg;nt.url=d,nt.source=null,nt.error=null,nt.cache=!1,tr.measureImg(d,function(t){var e,r,i,n,a=o;t.url!==nt.url||a.__isDestroyed||(t.success?(nt.source=t.source,nt.width=t.width,nt.height=t.height):nt.error=!0,e=a.root,i=(r=a.currentStyle).width,n=r.height,e.delRefreshTask(a.__task),i.unit!==ln&&n.unit!==ln?e.addRefreshTask(a.__task={before:function(){a.isDestroyed||e.__addUpdate({node:a,focus:qr.REPAINT,img:!0})}}):e.addRefreshTask(a.__task={before:function(){a.isDestroyed||e.__addUpdate({node:a,focus:qr.REFLOW,img:!0})}}))},{width:u,height:c})}return s.canCacheSelf&&(this.__applyCache(t,e,r,zi),s.hasMC&&((C=this.__cacheTotal)&&C.available?(L=(O=this.computedStyle).transform,F=O.transformOrigin,N=this.next,this.__cacheMask=ti.drawMask(C,N,L,F.slice(0))):console.error("CacheTotal is oversize with img's mask"))),s}},{key:"baseLine",get:function(){return this.height}}]),at}(),dn=function(){function e(t){l(this,e),this.id=t,this.count=0,this.list=[]}return u(e,[{key:"add",value:function(t){return t.uuid="karas-defs-"+this.id+"-"+this.count++,this.list.push(t),t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(t){return new e(t)}}]),e}(),_n=_.TYPE_VD,pn=_.TYPE_GM,vn=_.TYPE_CP,yn=[],gn=[],mn={};function bn(t){t instanceof on&&t.children.forEach(function(t){t instanceof on?bn(t):t instanceof sn&&t.__hasUpdate&&(t.__hasUpdate=!1,xn(t,t.props))})}function xn(t,e,r){(t.__nextState||r)&&(!_e.isFunction(t.shouldComponentUpdate)||t.shouldComponentUpdate(e,t.__nextState||t.state))?function(t,e,r){t.props=e,t.__state=r,t.__nextState=null;var i=t.shadow,n=t.shadowRoot,a=t.__cd,o=Ni.flattenJson(t.render());(function(t,e,r){var o=An(e,{},t),s=An(r,{}),h=[],l=[];Object.keys(o).forEach(function(t){var e=o[t];s[t]||(e.json.key=mn)}),Object.keys(s).forEach(function(t){var e,r,i,n=o[t],a=s[t];n?(e=n.json,r=a.json,i=n.vd,e.$$type===vn&&r.$$type===vn?e.klass===r.klass&&(wn(e,r,i),e.key=r.key=mn,l.push(i)):e.$$type===r.$$type&&e.tagName===r.tagName&&(r.$$type===pn&&e.props.multi!==r.props.multi||(r.inherit=i),e.key=r.key=mn,r.$$type===_n&&h.push({vd:i,oj:e,nj:r}))):a.json.key=mn}),h.forEach(function(t){Mn(t.vd,t.oj,t.nj)}),kn(t,e,r),l.forEach(function(t){Sn(t)})})(i,a,o),t.__init(o);var s=t.shadowRoot;s instanceof an&&(s.__width=n.width,s.__height=n.height,s.__computedStyle=n.computedStyle,s.__layoutData=n.layoutData);s.__parent=n.parent,s.__struct=n.__struct,yn.push(t),_e.isObject(o)&&o.placeholder||gn.push(i);o&&o.placeholder&&delete o.placeholder}(t,e,t.__nextState||t.state):bn(t.shadowRoot)}function kn(t,e,r){if(_e.isObject(r))if(r.$$type===vn){if(r.key===mn)return;e.$$type===r.$$type&&e.klass===r.klass&&(wn(e,r,t),Sn(t))}else r.$$type===pn&&e.$$type===pn?e.tagName===r.tagName&&e.props.multi===r.props.multi&&(r.inherit=t):r.$$type===_n&&e.$$type===_n&&(e.tagName===r.tagName&&(r.inherit=t),Mn(t,e,r))}function Mn(t,e,r){for(var i=e.children,n=r.children,a=i.length,o=n.length,s=t.children,h=0,l=0,u=0,c=Math.min(a,o);h<c;h++){var f=i[h+l],d=n[h+u];f.key===mn&&d.key===mn||(f.key===mn?(l++,h--,a--,c=Math.min(a,o)):d.key===mn?(u++,h--,o--,c=Math.min(a,o)):kn(s[h+l],f,d))}}function wn(n,a,o){a.placeholder=!0;var s=(a.value=o).shadowRoot,h={};Object.keys(n.props).forEach(function(t){var e=n.props[t];h[t]=e}),Object.keys(a.props).forEach(function(t){var e,r,i=a.props[t];/^on[a-zA-Z]/.test(t)?(n.props[t]=i,(e=h[t])?(delete h[t],e!==i&&(t=t.slice(2).toLowerCase(),s.listener[t]=i)):(t=t.slice(2).toLowerCase(),s.listener[t]=i)):/^on-[a-zA-Z\d_$]/.test(t)&&(n.props[t]=i,(r=h[t])?(delete h[t],r!==i&&(t=t.slice(2).toLowerCase(),o.off(t,h[t]),o.on(t,i)),delete h[t]):(t=t.slice(2).toLowerCase(),o.on(t,i)))}),Object.keys(h).forEach(function(t){var e=h[t];/^on[a-zA-Z]/.test(t)?(a.props[t]=e,t=t.slice(2).toLowerCase(),delete s.listener[t]):/^on-[a-zA-Z\d_$]/.test(t)&&(a.props[t]=e,t=t.slice(2).toLowerCase(),o.off(t,e))}),xn(o,a.props,!_e.equal(n.props,a.props))}function An(t,r,i){var e;return Array.isArray(t)?t.forEach(function(t,e){return An(t,r,i&&i[e])}):_e.isObject(t)&&(t.$$type!==_n&&t.$$type!==pn&&t.$$type!==vn||(t.$$type===_n&&An(t.children,r,i&&i.children),e=t.props.key,_e.isNil(e)||""===e||(r.hasOwnProperty(e)&&console.error("Component "+i.tagName+" has duplicate key: "+e),r[e]={json:t,vd:i}))),r}function Sn(t){if(t.host){var e=t.parent;if(e){var r=e.children.indexOf(t);if(!(-1<r))throw new Error("Can not find child: "+t.tagName);e.children[r]=null}}}var En,Tn={ref:function(t){an=t.Xom,on=t.Dom,t.Img,t.Geom,sn=t.Component},updateList:yn,check:bn,checkCp:xn,did:function(){yn.forEach(function(t){_e.isFunction(t.componentDidUpdate)&&t.componentDidUpdate()}),yn=[],gn.forEach(function(t){t.__destroy()}),gn=[]}},Pn=_e.joinVd,Rn=_e.joinDef;function Cn(t,e,r){var i=t.childNodes;!function(t,e,r){for(var i=e.length,n=r.length,a=0,o=t.childNodes;a<Math.min(i,n);a++)!function(e,t,r){if(t.tagName!==r.tagName)Yn(e,"beforebegin",Rn(r)),e.parentNode.removeChild(e);else{t.uuid!==r.uuid&&e.setAttribute("id",r.uuid);for(var i={},n=0,a=(t.props||[]).length;n<a;n++){var o=ue(t.props[n],2),s=o[0],h=o[1];i[s]=h}for(var l=0,u=(r.props||[]).length;l<u;l++){var c=ue(r.props[l],2),f=c[0],d=c[1];i.hasOwnProperty(f)?(i[f]!==d&&e.setAttribute(f,d),delete i[f]):e.setAttribute(f,d)}Object.keys(i).forEach(function(t){e.removeAttribute(t)});for(var _=e.childNodes,p=t.children.length,v=r.children.length,y=0;y<Math.min(p,v);y++)Dn(e,y,t.children[y],r.children[y]);if(y<p)for(var g=p-1;y<=g;g--)zn(e,_,g);else if(y<v)for(;y<v;y++)Hn(e,_,y,Pn(r.children[y]))}}(o[a],e[a],r[a]);if(a<i)for(var s=i-1;a<=s;s--)zn(t,o,s);else if(a<n)for(;a<n;a++)Hn(t,o,a,Rn(r[a]))}(i[0],e.defs,r.defs),r.hasOwnProperty("lv")||Bn(i[1],e.bb,r.bb,e.bbClip,r.bbClip),Nn(t,e,r,!0)}function On(t,e,r){"dom"===e.type?"dom"===r.type?Nn(t,e,r):"geom"===r.type?In(t,e,r):Gn(t,r):"text"===e.type?"text"===r.type?function(t,e,r){if(r.cache)return;for(var i=e.children.length,n=r.children.length,a=0;a<Math.min(i,n);a++)Dn(t,a,e.children[a],r.children[a],!0);var o=t.childNodes;if(a<i)for(var s=i-1;a<=s;s--)zn(t,o,s);else if(a<n)for(;a<n;a++)Hn(t,o,a,Pn(r.children[a]))}(t,e,r):Gn(t,r):"geom"===e.type?"dom"===r.type?In(t,e,r):"geom"===r.type?function(t,e,r){if(r.cache)return;Ln(t,e,r),Bn(t.firstChild,e.bb,r.bb,e.bbClip,r.bbClip);for(var i=e.children.length,n=r.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(i,n);a++)Dn(o,a,e.children[a],r.children[a]);if(a<i)for(var h=i-1;a<=h;h--)zn(o,s,h);else if(a<n)for(;a<n;a++)Hn(o,s,a,Pn(r.children[a]))}(t,e,r):Gn(t,r):"img"===e.type&&("img"===r.type?Wn(t,e,r):Gn(t,r))}function Ln(t,e,r){var i=r.transform,n=r.opacity,a=r.visibility,o=r.mask,s=r.clip,h=r.filter,l=r.conClip;e.transform!==i&&(i?t.setAttribute("transform",i):t.removeAttribute("transform")),e.opacity!==n&&(1!==n&&void 0!==n?t.setAttribute("opacity",n):t.removeAttribute("opacity")),e.visibility!==a&&t.setAttribute("visibility",a),e.mask!==o&&(o?t.setAttribute("mask",o):t.removeAttribute("mask"),e.clip&&t.removeAttribute("clip-path")),e.clip!==s&&(s?t.setAttribute("clip-path",s):t.removeAttribute("clip-path"),e.mask&&t.removeAttribute("mask")),e.filter!==h&&(h?t.setAttribute("filter",h):t.removeAttribute("filter")),e.conClip!==l&&(l?t.childNodes[1].setAttribute("clip-path",l):t.childNodes[1].removeAttribute("clip-path"))}function Fn(t,e,r,i){var n,a,o,s,h,l;i!==qr.NONE&&(n=r.transform,a=r.opacity,o=r.visibility,s=r.mask,h=r.clip,l=r.filter,qr.contain(i,qr.TRANSLATE_X|qr.TRANSLATE_Y|qr.TRANSFORM)&&(n?t.setAttribute("transform",n):t.removeAttribute("transform")),qr.contain(i,qr.OPACITY)&&(1!==a?t.setAttribute("opacity",a):t.removeAttribute("opacity")),qr.contain(i,qr.VISIBILITY)&&t.setAttribute("visibility",o),qr.contain(i,qr.FILTER)&&(l?t.setAttribute("filter",l):t.removeAttribute("filter")),s?t.setAttribute("mask",s):t.removeAttribute("mask"),e.clip&&t.removeAttribute("clip-path"),h?t.setAttribute("clip-path",h):t.removeAttribute("clip-path"),e.mask&&t.removeAttribute("mask"))}function Nn(t,e,r,i){if(r.cache)Fn(t,e,r,r.lv);else{r.hasOwnProperty("lv")?Fn(t,e,r,r.lv):(Ln(t,e,r),i||Bn(t.firstChild,e.bb,r.bb,e.bbClip,r.bbClip));for(var n=e.children.length,a=r.children.length,o=0,s=t.lastChild,h=s.childNodes;o<Math.min(n,a);o++)On(h[o],e.children[o],r.children[o]);if(o<n)for(var l=n-1;o<=l;l--)zn(s,h,l);else if(o<a)for(;o<a;o++)Hn(s,h,o,Pn(r.children[o]))}}function In(t,e,r){Ln(t,e,r),Bn(t.firstChild,e.bb,r.bb,e.bbClip,r.bbClip);for(var i=e.children.length,n=r.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(i,n);a++)Gn(s[a],r.children[a]);if(a<i)for(var h=i-1;a<=h;h--)zn(o,s,h);else if(a<n)for(;a<n;a++)Hn(o,s,a,Pn(r.children[a]))}function Bn(t,e,r,i,n){var a=e.length,o=r.length;i!==n&&(n?t.setAttribute("clip-path",n):t.removeAttribute("clip-path"));for(var s=0;s<Math.min(a,o);s++)Dn(t,s,e[s],r[s]);var h=t.childNodes;if(s<a)for(var l=a-1;s<=l;l--)zn(t,h,l);else if(s<o)for(;s<o;s++)Hn(t,h,s,Pn(r[s]))}function Dn(t,e,r,i,n){var a=t.childNodes;r.tagName!==i.tagName?Gn(a[e],i):(Wn(a[e],r,i),n&&r.content!==i.content&&(a[e].innerHTML=i.content))}function Wn(e,t,r){if(!r.cache){for(var i={},n=0,a=(t.props||[]).length;n<a;n++){var o=ue(t.props[n],2),s=o[0],h=o[1];i[s]=h}for(var l=0,u=(r.props||[]).length;l<u;l++){var c=ue(r.props[l],2),f=c[0],d=c[1];i.hasOwnProperty(f)?(i[f]!==d&&e.setAttribute(f,d),delete i[f]):e.setAttribute(f,d)}Object.keys(i).forEach(function(t){e.removeAttribute(t)})}}function Gn(t,e){var r;Array.isArray(e)?(r="",e.forEach(function(t){r+=Pn(t)})):r=Pn(e),Yn(t,"beforebegin",r),t.parentNode.removeChild(t)}function Hn(t,e,r,i){r>=e.length?Yn(t,"beforeend",i):Yn(e[r],"beforebegin",i)}function zn(t,e,r){e[r]&&t.removeChild(e[r])}function Yn(t,e,r){if(t.insertAdjacentHTML)t.insertAdjacentHTML(e,r);else switch(e){case"beforeend":t.innerHTML+=r;break;case"beforebegin":(En=En||document.createElement("svg")).innerHTML=r,t.parentNode.insertBefore(En.childNodes[0],t)}}var Xn=_e.isFunction,$n=function(){function t(){l(this,t),this.__records=[],this.__auto=[],this.__list=[]}return u(t,[{key:"add",value:function(t){-1===this.__list.indexOf(t)&&this.list.push(t)}},{key:"remove",value:function(t){var e=this.list.indexOf(t);-1<e&&this.list.splice(e,1)}},{key:"__destroy",value:function(){this.__records=[],this.__auto=[],this.__list=[]}},{key:"__action",value:function(e,r){this.list.forEach(function(t){t[e].apply(t,r)})}},{key:"init",value:function(t){var o=this,e=0<arguments.length&&void 0!==t?t:this.__records;e.length&&e.splice(0).forEach(function(t){var e,r,i,n=t.target,a=t.animate;Array.isArray(a)?a.forEach(function(t){var e=t.value,r=t.options;r.autoPlay=!1;var i=n.animate(e,r);o.add(i)}):(e=a.value,(r=a.options).autoPlay=!1,i=n.animate(e,r),o.add(i))})}},{key:"__playAuto",value:function(){this.init(this.__auto),this.__action("play")}},{key:"play",value:function(e){this.init();var r=!0;this.__action("play",[e&&function(t){r&&(r=!1,Xn(e)&&e(t))}])}},{key:"pause",value:function(){this.__action("pause")}},{key:"resume",value:function(e){var r=!0;this.__action("resume",[e&&function(t){r&&(r=!1,Xn(e)&&e(t))}])}},{key:"cancel",value:function(e){var r=!0;this.__action("cancel",[e&&function(t){r&&(r=!1,Xn(e)&&e(t))}])}},{key:"finish",value:function(e){var r=!0;this.__action("finish",[e&&function(t){r&&(r=!1,Xn(e)&&e(t))}])}},{key:"gotoAndStop",value:function(t,e,r){this.init();var i=!0;this.__action("gotoAndStop",[t,e,r&&function(t){i&&(i=!1,Xn(r)&&r(t))}])}},{key:"gotoAndPlay",value:function(t,e,r){this.init();var i=!0;this.__action("gotoAndPlay",[t,e,r&&function(t){i&&(i=!1,Xn(r)&&r(t))}])}},{key:"__set",value:function(e,r){this.list.forEach(function(t){t[e]=r})}},{key:"list",get:function(){return this.__list}},{key:"playbackRate",set:function(t){this.__set("playbackRate",t)}},{key:"iterations",set:function(t){this.__set("iterations",t)}},{key:"playCount",set:function(t){this.__set("playCount",t)}},{key:"fps",set:function(t){this.__set("fps",t)}},{key:"currentTime",set:function(t){this.__set("currentTime",t)}},{key:"spfLimit",set:function(t){this.__set("spfLimit",t)}},{key:"delay",set:function(t){this.__set("delay",t)}},{key:"endDelay",set:function(t){this.__set("endDelay",t)}},{key:"fill",set:function(t){this.__set("fill",t)}},{key:"direction",set:function(t){this.__set("direction",t)}}]),t}(),jn=_e.isNil,Vn=_e.isObject,qn=_e.isFunction,Un=f.AUTO,Zn=f.PX,Kn=f.PERCENT,Jn=Yt.calRelative,Qn=Yt.isRelativeOrAbsolute;function ta(t,e,r){var i=t.currentStyle[r],n=t.computedStyle[r];if(i.unit===Zn)return i.value===n;if(i.unit!==Kn)return!1;var a=t.domParent.layoutData["width"===r?"w":"h"];return i.value*a*.01===n}function ea(t){return ta(t,0,"width")&&ta(t,0,"height")}var ra=1;function ia(t,e){return t.hasOwnProperty("__uniqueReflowId")&&e[t.__uniqueReflowId]>=ra}function na(t,e,r){var i,n,a;n=e,a=r,(i=t).hasOwnProperty("__uniqueReflowId")||(i.__uniqueReflowId=aa,n[aa++]={node:i,lv:ra,component:a}),e[t.__uniqueReflowId].lv|=ra}var aa=0;var oa=0;function sa(t,e,r,n,i,a,o,s,h,l){var u=n.node,c=n.style,f=n.origin,d=n.overwrite,_=n.focus,p=n.img,v=n.component,y=n.measure,g=n.list;f&&c&&(c=Yt.normalize(c)),d&&c&&Object.assign(u.__style,c),c&&c!==n.style&&Object.assign(n.style,c),g&&g.forEach(function(t){var e=t.style,r=t.origin,i=t.overwrite;r&&e&&(e=Yt.normalize(e)),i&&e&&Object.assign(u.__style,e),e&&Object.assign(n.style,e)}),c=n.style;var m,b,x,k=u.tagName,M=u.currentStyle,w=u.currentProps,A=u.__cacheStyle,S=void 0===A?{}:A,E=u.__cacheProps,T=void 0===E?{}:E,P=qr.NONE,R=y;if(!v)for(var C in c)if(c.hasOwnProperty(C)){var O=c[C];if(Ot.isGeom(k,C))Yt.equalStyle(C,O,w[C],u)||((m=m||{})[C]=c[C],P|=qr.REPAINT,T[C]=void 0);else if(!Yt.equalStyle(C,O,M[C],u)){if(Ot.isIgnore(C))S[C]=void 0,M[C]=O;else{if({top:!0,right:!0,bottom:!0,left:!0}.hasOwnProperty(C)&&"relative"!==M.position&&"absolute"!==M.position&&"relative"!==c.position&&"absolute"!==c.position){delete c[C];continue}P|=qr.getLevel(C),Ot.isMeasure(C)&&(R=!0),S[C]=void 0,M[C]=O}"zIndex"===C&&u!==e&&(b=!0)}}if(m&&Object.assign(w,m),c&&Object.assign(M,c),jn(_)||(P|=_),P!==qr.NONE||p||v){b&&delete u.domParent.__zIndexChildren,!v&&qr.isRepaint(P)?(b&&t===fe.SVG&&(P|=qr.REPAINT,ha(u.domParent)),jn(_)||(P|=_),b&&!v&&h&&((x=u.domParent).hasOwnProperty("__uniqueZId")||(h[oa]=!0,x.__uniqueZId=oa++,l.push(x)))):(i.push({node:u,style:c,img:p,component:v}),R&&a.push(u)),u.__refreshLevel=P;var L=u.__refreshLevel>=qr.REPAINT||t===fe.SVG&&u instanceof Zi;L&&(u.__cache&&u.__cache.release(),u.__cacheTotal&&u.__cacheTotal.release(),u.__cacheMask&&(u.__cacheMask=null)),(L||qr.contain(P,qr.FILTER))&&u.__cacheFilter&&(u.__cacheFilter=null);for(var F=u.domParent;F;){if(F.hasOwnProperty("__uniqueUpdateId")){var N=F.__uniqueUpdateId;if(o.hasOwnProperty(N))break;o[N]=!0}else o[oa]=!0,F.__uniqueUpdateId=oa++,s.push(F);F.__refreshLevel>=qr.REPAINT&&F.__cache&&F.__cache.release(),F.__cacheTotal&&F.__cacheTotal.release(),F.__cacheFilter&&(F.__cacheFilter=null),F.__cacheMask&&(F.__cacheMask=null),F=F.domParent}return!0}delete u.__uniqueUpdateId}function ha(t,e){e?t.__refreshLevel|=qr.REPAINT:t.__cacheTotal.release(),Array.isArray(t.children)&&t.children.forEach(function(t){t instanceof Gi&&(t=t.shadowRoot),t instanceof $t||ha(t,!0)})}var la=0,ua=function(){t(a,hn);var n=e(a);function a(t,e,r){var i;return l(this,a),(i=n.call(this,t,e)).__cd=r||[],i.__dom=null,i.__mw=0,i.__mh=0,i.__scx=1,i.__scy=1,i.__task=[],i.__ref={},i.__updateList=[],i.__updateHash={},i.__reflowList=[{node:h(i)}],i.__animateController=new $n,nr.mix(h(i)),i}return u(a,[{key:"__initProps",value:function(){var t,e=this.props.width;jn(e)||0<(t=parseFloat(e)||0)&&(this.__width=t);var r,i=this.props.height;jn(i)||0<(r=parseFloat(i)||0)&&(this.__height=r)}},{key:"__genHtml",value:function(){var a=this,o="<".concat(this.tagName);return Object.keys(this.props).forEach(function(t){var e,r,i,n=a.props[t];/^on[a-zA-Z]/.test(t)||(o+=(e=t,r=n,i=Array.isArray(r)?_e.joinSourceArray(r):_e.stringify(r),"className"===e&&(e="class")," "+e+'="'+_e.encodeHtml(i,!0)+'"'))}),o+="></".concat(this.tagName,">")}},{key:"__wrapEvent",value:function(t){var e,r,i,n,a,o,s,h,l,u,c;return-1===["touchend","touchcancel"].indexOf(t.type)&&(e=this.dom,r=this.__scx,i=this.__scy,a=(n=e.getBoundingClientRect()).x,o=n.y,s=n.left,h=n.top,l=a||s||0,u=o||h||0,l=(c=t.touches?t.touches[0]:t).pageX-l,u=c.pageY-u,1!==r&&(l/=r),1!==i&&(u/=i)),{event:t,stopPropagation:function(){this.__stopPropagation=!0,t.stopPropagation()},stopImmediatePropagation:function(){this.__stopPropagation=!0,this.__stopImmediatePropagation=!0,t.stopImmediatePropagation()},preventDefault:function(){t.preventDefault()},x:l,y:u,__hasEmitted:!1}}},{key:"__cb",value:function(t){if("touchmove"!==t.type||this.__touchstartTarget){var e=this.__wrapEvent(t);return this.__emitEvent(e),e}}},{key:"appendTo",value:function(t){var e,i;t=function(t){if(_e.isString(t)&&t){var e=document.querySelector(t);if(!e)throw new Error("Can not find dom of selector: "+t);return e}if(!t)throw new Error("Can not find dom: "+t);return t}(t),this.__children=Ni.initRoot(this.__cd,this),this.__initProps(),(this.__root=this).cache=!!this.props.cache,t.nodeName.toUpperCase()===this.tagName.toUpperCase()?(this.__dom=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__dom=t.querySelector(this.tagName),this.__dom||(t.innerHTML=this.__genHtml(),this.__dom=t.querySelector(this.tagName))),this.__uuid=jn(this.__dom.__uuid)?la++:this.__dom.__uuid,this.__defs=this.dom.__defs||dn.getInstance(this.__uuid),this.width&&this.height||(e=window.getComputedStyle(t,null),this.width||(this.__width=parseFloat(e.getPropertyValue("width"))||0,t.setAttribute("width",this.width)),this.height||(this.__height=parseFloat(e.getPropertyValue("height"))||0,t.setAttribute("height",this.height))),"canvas"===this.tagName?(this.__ctx=this.__dom.getContext("2d"),this.__renderMode=fe.CANVAS):"svg"===this.tagName&&(this.__renderMode=fe.SVG),this.refresh(null,!0),this.dom.__root?this.dom.__root.destroy():(i=this.dom,["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"].forEach(function(r){i.addEventListener(r,function(t){var e=i.__root;-1<["touchend","touchcancel","touchmove"].indexOf(r)?e.__touchstartTarget&&e.__touchstartTarget.__emitEvent(e.__wrapEvent(t),!0):e.__cb(t)})}),this.dom.__uuid=this.__uuid),this.dom.__root=this}},{key:"refresh",value:function(e,t){var r=this;this.__hookTask=null;var i=this.isDestroyed,n=this.renderMode,a=this.ctx,o=this.defs,s=this.width,h=this.height;if(!i){if(o.clear(),t)this.__checkRoot(s,h),this.__computeMeasure(n,a);else if(!this.__checkUpdate(n,a,s,h))return;tr.measureText(function(){var t;r.__checkReflow(s,h),n===fe.CANVAS&&r.__clear(a),r.render(n,r.__refreshLevel,a,o),n===fe.SVG&&((t=r.virtualDom).defs=o.value,r.dom.__root?Cn(r.dom,r.dom.__vd,t):r.dom.innerHTML=_e.joinVirtualDom(t),r.dom.__vd=t,r.dom.__defs=o),qn(e)&&e(),r.emit(nr.REFRESH)})}}},{key:"destroy",value:function(){this.__destroy(),hr.offFrame(this.__rTask);var t=this.dom;t&&(t.__root=null)}},{key:"scale",value:function(t,e){var r=0<arguments.length&&void 0!==t?t:1,i=1<arguments.length&&void 0!==e?e:r;this.__scx=r,this.__scy=i}},{key:"addRefreshTask",value:function(t){var a,o,s=this;t&&((a=this.task).length||hr.nextFrame(this.__rTask={before:function(r){var i,t,e,n;(o=a.splice(0)).length&&(i=[],o.forEach(function(t,e){Vn(t)&&qn(t.before)&&(t.__state&&i.push(e),t.before(r))}),i.length&&Tn.check(s),Tn.updateList.length?(Tn.updateList.forEach(function(t){var e=t.shadowRoot;e instanceof $t&&(e=e.domParent),s.__addUpdate({node:e,style:e.currentStyle,focus:qr.REFLOW,measure:!0,component:!0})}),s.refresh()):o.length>i.length&&s.refresh(),!(t=s.__hookTask)||-1<(n=(e=hr.__hookTask).indexOf(t))&&e.splice(n,1),Tn.did())},after:function(e){o.forEach(function(t){Vn(t)&&qn(t.after)?t.after(e):qn(t)&&t(e)})}}),-1===a.indexOf(t)&&a.push(t))}},{key:"delRefreshTask",value:function(t){if(t){for(var e=this.task,r=0,i=e.length;r<i;r++)if(e[r]===t){e.splice(r,1);break}e.length||hr.offFrame(this.__rTask)}}},{key:"__checkRoot",value:function(t,e){var r=this.currentStyle,i=this.computedStyle;-1===["flex","block"].indexOf(r.display)&&(i.display=r.display="block"),"absolute"===r.positoin&&(i.position=r.positoin="static"),r.width={value:t,unit:Zn},r.height={value:e,unit:Zn},i.width=t,i.height=e,Yt.computeMeasure(this,!0)}},{key:"__addUpdate",value:function(t){var e,r,i=this.__updateHash,n=t.node,a=t.style,o=t.origin,s=t.overwrite,h=t.focus,l=t.img,u=t.component,c=t.measure;n.isDestroyed||(n===this?(e=this.__updateRoot)?(l&&(e.img=l),h&&(e.focus=h),c&&(e.measure=!0),e.list=e.list||[],e.list.push({style:a,origin:o,overwrite:s})):this.__updateRoot={node:n,style:a,origin:o,overwrite:s,focus:h,img:l,measure:c}:n.hasOwnProperty("__uniqueUpdateId")?i.hasOwnProperty(n.__uniqueUpdateId)?(r=i[n.__uniqueUpdateId],l&&(r.img=l),h&&(r.focus=h),c&&(r.measure=!0),r.list=r.list||[],r.list.push({style:a,origin:o,overwrite:s})):console.error("Update process miss uniqueUpdateId"):(n.__uniqueUpdateId=oa,i[oa++]={node:n,style:a,origin:o,overwrite:s,focus:h,img:l,component:u,measure:c}))}},{key:"__checkUpdate",value:function(s,h,t,e){var r,l=this,i=[],n=[],a={},o=[],u={},c=[],f=this.__updateRoot,d=this.__updateHash,_=this;f&&(this.__updateRoot=null,r=sa(s,_,0,f,n,i,a,o),this.__checkRoot(t,e));var p=Object.keys(d);p.forEach(function(t){r=sa(s,l,0,d[t],n,i,a,o,u,c)||r}),this.__reflowList=n,oa=0,this.__updateHash={},o.forEach(function(t){delete t.__uniqueUpdateId}),c.forEach(function(t){t.hasOwnProperty("__uniqueZId")&&(delete t.__uniqueZId,t.__updateStruct(_.__structs))});var v={};return i.forEach(function(t){var e=t.__uniqueUpdateId,r=t.domParent;if(!v.hasOwnProperty(e)){v[e]=!0;var i=t;if(Ot.isMeasureInherit(d[e].style))for(;r&&r!==l;){var n,a=r.__uniqueUpdateId,o=r.currentStyle;if(!(r.hasOwnProperty("__uniqueUpdateId")?(n=d[a].style,v[a]=!0,!!Ot.measureInheritList(n).length):Ot.isMeasureInherit(o)))break;r=(i=r).domParent}i.__computeMeasure(s,h,function(t){t.hasOwnProperty("__uniqueUpdateId")&&(v[t.__uniqueUpdateId]=!0)})}}),p.forEach(function(t){delete d[t].node.__uniqueUpdateId}),r}},{key:"__checkReflow",value:function(t,e){var et=this,r=this.__reflowList;if(r.length){for(var i,rt=this,it={},n=aa=0,a=r.length;n<a;n++){var o=r[n],s=o.node,h=o.style,l=o.img,u=o.component;if(s===this){i=!0;break}var c=s.currentStyle,f=s.computedStyle;s.hasOwnProperty("__uniqueReflowId")||(s.__uniqueReflowId=aa,it[aa++]={node:s,lv:0,img:l,component:u});var d=it[s.__uniqueReflowId];if("absolute"===c.position&&"absolute"===f.position)d.lv=ra;else if(c.position!==f.position){if(d.lv=ra,S(s,u,!0)){i=!0;break}}else{var _=!0;if(h)for(var p=Object.keys(h),v=0,y=p.length;v<y;v++){var g=p[v];if("left"!==g&&"top"!==g&&"right"!==g&&"bottom"!==g){_=!1;break}}if(!_||l||u){if(d.lv=ra,S(s,u)){i=!0;break}}else"relative"===f.position&&(d.lv|=0)}}if(aa=0,this.__reflowList=[],i)r.forEach(function(t){return delete t.node.__uniqueReflowId}),this.__layout({x:0,y:0,w:t,h:e}),this.__layoutAbs(this,{x:0,y:0,w:t,h:e}),this.__structs=this.__structure(0,0);else{var m=[];this.deepScan(function(t,e){if(t.hasOwnProperty("__uniqueReflowId")){var r,i=it[t.__uniqueReflowId];return delete t.__uniqueReflowId,i.lv>=ra||(r=[],t.deepScan(function(t,e){},{uniqueList:r}),r.forEach(function(t){e.uniqueList.push(t)})),e.uniqueList.push(i),!0}},{uniqueList:m});var nt=[],at=0;m.forEach(function(t){var e=t.node,r=t.lv,i=t.component;if(ra<=r){var n,a,o=e.computedStyle;i&&(n=o.zIndex,a=o.position);for(var s="absolute"===o.position,h="absolute"===o.position,l=e.domParent,u=l.layoutData,c=u.x,f=u.y,d=(u.w,u.h),_=l.width,p=l.computedStyle,v=e;i&&v.isShadowRoot;)v=v.host;var y=v.prev;y?(f=y.y,f+=y.outerHeight):(f=l.y,f+=p.marginTop+p.borderTopWidth+p.paddingTop),c+=p.marginLeft+p.borderLeftWidth+p.paddingLeft;var g,m=e.outerWidth,b=e.outerHeight,x=e;if(h){for(x=x.domParent;x&&x!==rt&&!Qn;)if(x.parent)x=x.parent;else if(x.host)break;if(x=x||rt,l.__layoutAbs(x,null,e),s)return;g=!0}else e.__layout({x:c,y:f,w:_,h:d}),e instanceof hn&&(!e.parent&&e.host&&(x=e),e.__layoutAbs(x,{x:c,y:f,w:_,h:d}));var k,M,w,A,S="absolute"===e.computedStyle.position;A=g?(k=-m,-b):(M=e.outerWidth,w=e.outerHeight,S?(k=M,w):(k=M-m,w-b));for(var E,T=e;T&&T!==rt;)if("relative"===(p=(T=T.domParent).computedStyle).position){var P=T.ox,R=T.oy;P&&e.__offsetX(P),R&&e.__offsetY(R);break}if(k||A){for(var C,O=e;;){for(;O.isShadowRoot;)O=O.host;for(var L=(C=O).next;L;)"absolute"===L.currentStyle.position?L.currentStyle.top.unit===Un&&L.currentStyle.bottom.unit===Un&&(L.__offsetY(A,!0,qr.REFLOW),L.__cancelCache()):(!L.hasOwnProperty("____uniqueReflowId")||it[L.____uniqueReflowId]<ra)&&(L.__offsetY(A,!0,qr.REFLOW),L.__cancelCache()),L=L.next;if((O=O.parent)===rt)break;var F,N=O.currentStyle,I="absolute"===N.positoin;if(k&&(F=void 0,I&&(N.width.unit!==Un||N.left.unit!==Un&&N.right.unit!==Un||(F=!0)),F&&(O.__resizeX(k),O.__cancelCache(),O.__refreshLevel|=qr.REFLOW)),A){var B=void 0;if(I?N.height.unit!==Un||N.top.unit!==Un&&N.bottom.unit!==Un||(B=!0):N.height.unit===Un&&(B=!0),!B)break;O.__resizeY(A),O.__cancelCache(),O.__refreshLevel|=qr.REFLOW}}for(;C;)C.__cancelCache(),C=C.domParent}i&&(E=e.__modifyStruct(rt,at),at+=E[1],nt.push(E),(o.position===a||"static"!==o.position&&"static"!==a)&&o.zIndex===n||(e.domParent.__updateStruct(rt.__structs),et.renderMode===fe.SVG&&ha(e.domParent)))}else{var D=e.currentStyle,W=D.top,G=D.right,H=D.bottom,z=D.left,Y=e.currentStyle,X=e.computedStyle,$=X.top,j=X.right,V=X.bottom,q=X.left,U=e.computedStyle,Z=e===et?e:e.domParent,K=0;W.unit!==Un?(K=Jn(Y,"top",W,Z),U.top=K,U.bottom="auto"):H.unit!==Un?(K=-Jn(Y,"bottom",H,Z),U.bottom=-K,U.top="auto"):U.top=U.bottom="auto";var J=0;"auto"!==$?J=$:"auto"!==V&&(J=-V),K!==J&&e.__offsetY(K-J,!1,qr.REFLOW);var Q=0;z.unit!==Un?(Q=Jn(Y,"left",z,Z),U.left=Q,U.right="auto"):G.unit!==Un?(Q=-Jn(Y,"right",G,Z),U.right=-Q,U.left="auto"):U.left=U.right="auto";var tt=0;"auto"!==q?tt=q:"auto"!==j&&(tt=-j),Q!==tt&&e.__offsetX(Q-tt,!1,qr.REFLOW)}});var b=0,x=0,k=!0,M=rt.__structs;nt.forEach(function(t){var e=ue(t,2),r=e[0],i=e[1];if(k)k=!1,x=r.index+r.total+1,b+=i;else{for(var n=r.index+r.total+1+b,a=x;a<n;a++)M[a].index+=b;x=n,b+=i}});for(var w=x,A=M.length;w<A;w++)M[w].index+=b;r.forEach(function(t){return delete t.node.__uniqueReflowId})}}function S(t,e,r){if(!ea(t)||r){var i=t;if("inline"===t.currentStyle.display||"inline"===t.computedStyle.display){var n=t.domParent;do{if((i=n)===rt)return 1;if(ia(n,it))return;if("absolute"===n.currentStyle.position||"absolute"===n.computedStyle.position)return void na(n,it,e);if(ea(n))return void na(n,it,e);n=n.domParent}while(n&&("inline"===n.currentStyle.display||"inline"===n.computedStyle.display));if(ea(i))return void na(i,it,e)}var a=i.domParent;if(!a||!ia(a,it)){if(a&&("flex"===a.computedStyle.display||"flex"===a.currentStyle.display)){do{if((i=a)===rt)return 1;if(ia(a,it))return;if("absolute"===a.currentStyle.position||"absolute"===a.computedStyle.position)return void na(a,it,e);if(ea(a))return void na(a,it,e);a=a.domParent}while(a&&("flex"===a.computedStyle.display||"flex"===a.currentStyle.display));if(ea(i))return void na(i,it,e)}(a=i.domParent)&&ia(a,it)||i!==t&&na(i,it,e)}}}}},{key:"__computeMeasure",value:function(e,r){Yt.computeMeasure(this,!0),this.children.forEach(function(t){t.__computeMeasure(e,r)})}},{key:"__frameHook",value:function(){var t,e=this;this.__hookTask||(t=this.__hookTask=function(){e.refresh()},hr.__hookTask.push(t))}},{key:"__clear",value:function(t){this.__mw=Math.max(this.__mw,this.width),this.__mh=Math.max(this.__mh,this.height),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.__mw,this.__mh)}},{key:"dom",get:function(){return this.__dom}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"ctx",get:function(){return this.__ctx}},{key:"defs",get:function(){return this.__defs}},{key:"task",get:function(){return this.__task}},{key:"ref",get:function(){return this.__ref}},{key:"animateController",get:function(){return this.__animateController}}]),a}(),ca=_e.isNil;function fa(t,e,r,i){return i?t.map(function(t){return e+t*r}):e+t*r}function da(t,e){var r=0;return 2<=t.length&&r++,2<=e.length&&(r+=2),r}function _a(t){return t<0?t=0:1<t&&(t=1),t}function pa(t,e,r,i,n,a,o,s,h){var l,u,c,f,d,_,p,v,y,g,m,b=7<arguments.length&&void 0!==s?s:0,x=8<arguments.length&&void 0!==h?h:1;return(0<b||x<1)&&(3===o?(l=ue(pe.sliceBezier2Both([[t,e],n,a,[r,i]],b,x),4),t=(u=ue(l[0],2))[0],e=u[1],n=l[1],a=l[2],r=(c=ue(l[3],2))[0],i=c[1]):2===o?(f=ue(pe.sliceBezier2Both([[t,e],a,[r,i]],b,x),3),t=(d=ue(f[0],2))[0],e=d[1],a=f[1],r=(_=ue(f[2],2))[0],i=_[1]):1===o?(p=ue(pe.sliceBezier2Both([[t,e],n,[r,i]],b,x),3),t=(v=ue(p[0],2))[0],e=v[1],n=p[1],r=(y=ue(p[2],2))[0],i=y[1]):(t+=(g=Math.abs(t-r))*b,e+=(m=Math.abs(e-i))*b,r-=g*(1-x),i-=m*(1-x))),[t,e,r,i,n,a]}var va=function(){t(W,Zi);var h=e(W);function W(t,e){var r,i,n,a;if(l(this,W),(r=h.call(this,t,e)).isMulti){if(r.__x1=[0],r.__y1=[0],r.__x2=[1],r.__y2=[1],r.__controlA=[[]],r.__controlB=[[]],r.__start=[0],r.__end=[1],Array.isArray(e.x1)?r.__x1=e.x1.map(function(t){return parseFloat(t)||0}):ca(e.x1)||(r.__x1=[parseFloat(e.x1)||0]),Array.isArray(e.y1)?r.__y1=e.y1.map(function(t){return parseFloat(t)||0}):ca(e.y1)||(r.__y1=[parseFloat(e.y1)||0]),Array.isArray(e.x2)?r.__x2=e.x2.map(function(t){return parseFloat(t)||0}):ca(e.x2)||(r.__x2=[parseFloat(e.x2)||0]),Array.isArray(e.y2)?r.__y2=e.y2.map(function(t){return parseFloat(t)||0}):ca(e.y2)||(r.__y2=[parseFloat(e.y2)||0]),Array.isArray(e.controlA)&&(r.__controlA=e.controlA.map(function(t){return Array.isArray(t)?t:[]})),Array.isArray(e.controlB)&&(r.__controlB=e.controlB.map(function(t){return Array.isArray(t)?t:[]})),Array.isArray(e.start)){r.__start=e.start.map(function(t){return _a(parseFloat(t)||0)});for(var o=r.__start.length;o<r.__x1.length;o++)r.__start.push(0)}else{ca(e.start)||(i=_a(parseFloat(e.start)||0),r.__start=r.__x1.map(function(){return i}))}if(Array.isArray(e.end)){r.__end=e.end.map(function(t){var e=parseFloat(t);return isNaN(e)&&(e=1),_a(e)});for(var s=r.__end.length;s<r.__x1.length;s++)r.__end.push(1)}else{ca(e.end)||(n=parseFloat(e.end),isNaN(n)&&(n=1),n=_a(n),r.__end=r.__x1.map(function(){return n}))}}else{r.__x1=r.__y1=r.__start=0,r.__x2=r.__y2=r.__end=1,r.__controlA=[],r.__controlB=[],ca(e.x1)||(r.__x1=parseFloat(e.x1)||0),ca(e.y1)||(r.__y1=parseFloat(e.y1)||0),ca(e.x2)||(r.__x2=parseFloat(e.x2)||0),ca(e.y2)||(r.__y2=parseFloat(e.y2)||0),ca(e.start)||(r.__start=_a(parseFloat(e.start)||0)),ca(e.end)||(a=parseFloat(e.end),isNaN(a)&&(a=1),r.__end=_a(a)),Array.isArray(e.controlA)&&(r.__controlA=e.controlA),Array.isArray(e.controlB)&&(r.__controlB=e.controlB)}return r}return u(W,[{key:"buildCache",value:function(e,r){var i,n=this,a=this.width,o=this.height,s=this.__cacheProps,h=this.isMulti;return["x1","x2"].forEach(function(t){ca(s[t])&&(i=!0,s[t]=fa(n[t],e,a,h))}),["y1","y2"].forEach(function(t){ca(s[t])&&(i=!0,s[t]=fa(n[t],r,o,h))}),["controlA","controlB"].forEach(function(t){ca(s[t])&&(i=!0,s[t]=function e(t,r,i,n,a,o){if(o){if(t)return t.map(function(t){return e(t,r,i,n,a)})}else if(t&&2<=t.length)return[r+t[0]*n,i+t[1]*a];return[]}(n[t],e,r,a,o,h))}),["start","end"].forEach(function(t){ca(s[t])&&(i=!0,s[t]=n[t])}),i}},{key:"render",value:function(t,e,c,r){var i=_t(dt(W.prototype),"render",this).call(this,t,e,c,r);if(i.break)return i;var f,n,a,o,s,h,l,u,d,_,p,v,y,g,m,b,x,k,M,w,A,S,E=i.originX,T=i.originY,P=i.stroke,R=i.strokeWidth,C=i.strokeDasharrayStr,O=i.strokeLinecap,L=i.strokeLinejoin,F=i.strokeMiterlimit,N=i.dx,I=i.dy,B=this.__cacheProps,D=this.isMulti;return this.buildCache(E,T)&&t===fe.SVG&&(f="",D?B.x1.forEach(function(t,e){var r,i=B.x2[e],n=B.y1[e],a=B.y2[e],o=B.controlA[e],s=B.controlB[e],h=B.start[e],l=B.end[e],u=da(o,s);0===h&&1===l||(t=(r=ue(pa(t,n,i,n,o,s,u,h,l,B.len),6))[0],n=r[1],i=r[2],n=r[3],o=r[4],s=r[5]),f+=Vt.svgLine(t,n,i,a,o,s,u)}):(n=da(B.controlA,B.controlB),h=B.x1,l=B.y1,u=B.x2,d=B.y2,_=B.controlA,p=B.controlB,a=B.start,o=B.end,0===a&&1===o||(h=(s=ue(pa(h,l,u,d,_,p,n,a,o,B.len),6))[0],l=s[1],u=s[2],d=s[3],_=s[4],p=s[5]),f=Vt.svgLine(h,l,u,d,_,p,n)),B.d=f),t===fe.CANVAS?0<R&&(c.beginPath(),D?B.x1.forEach(function(t,e){var r,i=B.x2[e],n=B.y1[e],a=B.y2[e],o=B.controlA[e],s=B.controlB[e],h=B.start[e],l=B.end[e],u=da(o,s);0===h&&1===l||(t=(r=ue(pa(t,n,i,n,o,s,u,h,l,B.len),6))[0],n=r[1],i=r[2],n=r[3],o=r[4],s=r[5]),Vt.canvasLine(c,t,n,i,a,o,s,u,N,I)}):(v=da(B.controlA,B.controlB),b=B.x1,x=B.y1,k=B.x2,M=B.y2,w=B.controlA,A=B.controlB,y=B.start,g=B.end,0===y&&1===g||(b=(m=ue(pa(b,x,k,M,w,A,v,y,g,B.len),6))[0],x=m[1],k=m[2],M=m[3],w=m[4],A=m[5]),Vt.canvasLine(c,b,x,k,M,w,A,v,N,I)),c.stroke(),c.closePath()):t===fe.SVG&&(S=[["d",B.d],["fill","none"],["stroke",P],["stroke-width",R]],this.__propsStrokeStyle(S,C,O,L,F),this.addGeom("path",S)),i}},{key:"x1",get:function(){return this.getProps("x1")}},{key:"y1",get:function(){return this.getProps("y1")}},{key:"x2",get:function(){return this.getProps("x2")}},{key:"y2",get:function(){return this.getProps("y2")}},{key:"controlA",get:function(){return this.getProps("controlA")}},{key:"controlB",get:function(){return this.getProps("controlB")}},{key:"start",get:function(){return this.getProps("start")}},{key:"end",get:function(){return this.getProps("end")}},{key:"bbox",get:function(){var t=this.sx,e=this.sy,r=this.currentStyle,i=r.boxShadow,n=r.filter,a=this.computedStyle,o=a.borderTopWidth,s=a.borderLeftWidth,h=a.marginTop,l=a.marginLeft,u=a.paddingTop,c=a.paddingLeft,f=a.strokeWidth,d=this.isMulti,_=this.__cacheProps,p=t+s+l+c,v=e+o+h+u;this.buildCache(p,v);var y=_.x1,g=_.y1,m=_.x2,b=_.y2,x=_.controlA,k=_.controlB,M=_t(dt(W.prototype),"bbox",this),w=.5*f,A=ue(this.__spreadByBoxShadowAndFilter(i,n),2),S=A[0],E=A[1];return S+=w,E+=w,d||(y=[y],m=[m],g=[g],b=[b],x=[x],k=[k]),y.forEach(function(t,e){var r,i,n,a=g[e],o=m[e],s=b[e],h=x[e],l=k[e];(ca(h)||h.length<2)&&(ca(l)||l.length<2)?(M[0]=Math.min(M[0],t-S),M[0]=Math.min(M[0],o-S),M[1]=Math.min(M[1],a-E),M[1]=Math.min(M[1],s-E),M[2]=Math.max(M[2],t+S),M[2]=Math.max(M[2],o+S),M[3]=Math.max(M[3],a+E),M[3]=Math.max(M[3],s+E)):ca(h)||h.length<2?(r=pe.bboxBezier(t,a,l[0],l[1],o,s),M[0]=Math.min(M[0],r[0]-S),M[0]=Math.min(M[0],r[2]-S),M[1]=Math.min(M[1],r[1]-E),M[1]=Math.min(M[1],r[3]-E),M[2]=Math.max(M[2],r[0]+S),M[2]=Math.max(M[2],r[2]+S),M[3]=Math.max(M[3],r[1]+E),M[3]=Math.max(M[3],r[3]+E)):ca(l)||l.length<2?(i=pe.bboxBezier(t,a,h[0],h[1],o,s),M[0]=Math.min(M[0],i[0]-S),M[0]=Math.min(M[0],i[2]-S),M[1]=Math.min(M[1],i[1]-E),M[1]=Math.min(M[1],i[3]-E),M[2]=Math.max(M[2],i[0]+S),M[2]=Math.max(M[2],i[2]+S),M[3]=Math.max(M[3],i[1]+E),M[3]=Math.max(M[3],i[3]+E)):(n=pe.bboxBezier(t,a,h[0],h[1],l[0],l[1],o,s),M[0]=Math.min(M[0],n[0]-S),M[0]=Math.min(M[0],n[2]-S),M[1]=Math.min(M[1],n[1]-E),M[1]=Math.min(M[1],n[3]-E),M[2]=Math.max(M[2],n[0]+S),M[2]=Math.max(M[2],n[2]+S),M[3]=Math.max(M[3],n[1]+E),M[3]=Math.max(M[3],n[3]+E))}),M}}]),W}(),ya=_e.isNil;function ga(t,e){return Array.isArray(e)&&(2===e.length||4===e.length)&&Array.isArray(t)&&2===t.length?e.concat(t):t}function ma(t){return t<0?t=0:1<t&&(t=1),t}function ba(t,e){var r=[],i=0,n=[];if(e)i=[],t.forEach(function(t){var e=ba(t);r.push(e.list),i.push(e.total),n.push([0].concat(e.increase))});else if(Array.isArray(t)){i=0,n.push(0);for(var a=0,o=0,s=t.length;o<s;o++){var h=t[o];if(Array.isArray(h)){a=o;break}}for(var l=t[a],u=a+1,c=t.length;u<c;u++){var f,d,_,p,v,y=t[u];Array.isArray(y)&&(2===y.length?(f=Math.abs(y[0]-l[0]),d=Math.abs(y[1]-l[1]),_=Math.sqrt(Math.pow(f,2)+Math.pow(d,2)),r.push(_),i+=_,n.push(i),l=y):4===y.length?(p=pe.bezierLength([l,[y[0],y[1]],[y[2],y[3]]],2),r.push(p),i+=p,n.push(i),l=[y[2],y[3]]):6===y.length&&(v=pe.bezierLength([l,[y[0],y[1]],[y[2],y[3]],[y[4],y[5]]],3),r.push(v),i+=v,n.push(i),l=[y[4],y[5]]))}}return{list:r,total:i,increase:n}}function xa(t,e,r,i){if(r===i)return t[r]>e?r-1:r;var n=r+(i-r>>1);return t[n]===e?n:t[n]>e?xa(t,e,r,Math.max(n-1,r)):xa(t,e,Math.min(n+1,i),i)}function ka(t,e,r,i){var n=2<arguments.length&&void 0!==r?r:0,a=3<arguments.length&&void 0!==i?i:1;if(0===n&&1===a)return t;if(a<=n)return[];var o=0,s=t.length-2;0<n&&(o=xa(e.increase,n*e.total,o,s)),a<1&&(s=xa(e.increase,a*e.total,o,s)),t=_e.clone(t);var h,l,u,c,f,d,_,p,v,y,g,m,b,x,k,M,w=1;return(a*=e.total)>e.increase[s]&&(h=t[s].slice(t[s].length-2),l=t[s+1],u=e.list[s],w=c=(a-e.increase[s])/u,2===l.length?(f=Math.abs(l[0]-h[0]),d=Math.abs(l[1]-h[1]),t[s+1]=[l[1]-(1-c)*f,l[1]-(1-c)*d]):4===l.length?(_=pe.sliceBezier([h,[l[0],l[1]],[l[2],l[3]]],c),t[s+1]=[_[1][0],_[1][1],_[2][0],_[2][1]]):6===l.length&&(p=pe.sliceBezier([h,[l[0],l[1]],[l[2],l[3]],[l[4],l[5]]],c),t[s+1]=[p[1][0],p[1][1],p[2][0],p[2][1],p[3][0],p[3][1]])),(n*=e.total)>e.increase[o]&&(v=t[o].slice(t[o].length-2),y=t[o+1],g=e.list[o],o===s&&1!==w&&(g*=w),m=(n-e.increase[o])/g,2===y.length?(b=Math.abs(y[0]-v[0]),x=Math.abs(y[1]-v[1]),t[o]=[v[0]+m*b,v[1]+m*x]):4===y.length?(k=pe.sliceBezier([[y[2],y[3]],[y[0],y[1]],v],1-m).reverse(),t[o]=k[0],t[o+1]=[k[1][0],k[1][1],k[2][0],k[2][1]]):6===y.length&&(M=pe.sliceBezier([[y[4],y[5]],[y[2],y[3]],[y[0],y[1]],v],1-m).reverse(),t[o]=M[0],t[o+1]=[M[1][0],M[1][1],M[2][0],M[2][1],y[4],y[5]])),s<t.length-2&&(t=t.slice(0,s+2)),0<o&&(t=t.slice(o)),t}var Ma=function(){t(w,Zi);var h=e(w);function w(t,e){var r,i,n,a;if(l(this,w),(r=h.call(this,t,e)).isMulti){if(r.__points=[[]],r.__controls=[[]],r.__start=[0],r.__end=[1],Array.isArray(e.start)){r.__start=e.start.map(function(t){return ma(parseFloat(t)||0)});for(var o=r.__start.length;o<r.__points.length;o++)r.__start.push(0)}else{ya(e.start)||(i=ma(parseFloat(e.start)||0),r.__start=r.__points.map(function(){return i}))}if(Array.isArray(e.end)){r.__end=e.end.map(function(t){var e=parseFloat(t);return isNaN(e)&&(e=1),ma(e)});for(var s=r.__end.length;s<r.__points.length;s++)r.__end.push(1)}else{ya(e.end)||(n=parseFloat(e.end),isNaN(n)&&(n=1),n=ma(n),r.__end=r.__points.map(function(){return n}))}}else{r.__points=[],r.__controls=[],r.__start=0,r.__end=1,ya(e.start)||(r.__start=ma(parseFloat(e.start)||0)),ya(e.end)||(a=parseFloat(e.end),isNaN(a)&&(a=1),r.__end=ma(a))}return Array.isArray(e.controls)&&(r.__controls=e.controls),Array.isArray(e.points)&&(r.__points=e.points),r}return u(w,[{key:"__getPoints",value:function(a,o,s,h,t,l){return t.map(function(t,e){if(Array.isArray(t)){var r=t.length;if(l){if(0!==r&&2!==r&&4!==r)return}else if(0!==r&&2!==r)return;for(var i=[],n=0;n<r;n++)n%2==0?i.push(a+t[n]*s):i.push(o+t[n]*h);return i}})}},{key:"buildCache",value:function(e,r){var t,i,n,a=this,o=this.width,s=this.height,h=this.points,l=this.controls,u=this.start,c=this.end,f=this.__cacheProps,d=this.isMulti;return ya(f.points)&&(t=!0,f.points=d?h.map(function(t){if(Array.isArray(t))return a.__getPoints(e,r,o,s,t)}):this.__getPoints(e,r,o,s,h)),ya(f.controls)&&(t=!0,f.controls=d?l.map(function(t){return Array.isArray(t)?a.__getPoints(e,r,o,s,t,!0):t}):this.__getPoints(e,r,o,s,l,!0)),ya(f.start)&&(t=!0,f.start=u),ya(f.end)&&(t=!0,f.end=c),t&&(i=f.points,n=f.controls,f.list=d?i.filter(function(t){return Array.isArray(t)}).map(function(t,e){var r=n[e];if(Array.isArray(t))return t.map(function(t,e){return e?ga(t,r&&r[e-1]):t})}):i.filter(function(t){return Array.isArray(t)}).map(function(t,e){return e?ga(t,n[e-1]):t}),f.len=ba(f.list,d)),t}},{key:"render",value:function(t,e,r,i){var n=_t(dt(w.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.originX,o=n.originY,s=n.fill,h=n.stroke,l=n.strokeWidth,u=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,d=n.strokeMiterlimit,_=n.fillRule,p=n.dx,v=n.dy,y=this.__cacheProps,g=this.isMulti;this.buildCache(a,o);var m,b,x=y.list;return y.list2=g?x.map(function(t,e){if(Array.isArray(t)){var r=y.len;return ka(t,{list:r.list[e],total:r.total[e],increase:r.increase[e]},y.start[e],y.end[e])}}):ka(x,y.len,y.start,y.end),t===fe.SVG&&(g?(m="",y.list2.forEach(function(t){return m+=Vt.svgPolygon(t)}),y.d=m):y.d=Vt.svgPolygon(y.list2)),t===fe.CANVAS?(r.beginPath(),g?y.list2.forEach(function(t){return Vt.canvasPolygon(r,t,p,v)}):Vt.canvasPolygon(r,y.list2,p,v),r.fill("evenodd"===_?_:"nonzero"),0<l&&r.stroke(),r.closePath()):t===fe.SVG&&(b=[["d",y.d],["fill",s],["stroke",h],["stroke-width",l]],"evenodd"===_&&b.push(["fill-rule","evenodd"]),this.__propsStrokeStyle(b,u,c,f,d),this.addGeom("path",b)),n}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}},{key:"start",get:function(){return this.getProps("start")}},{key:"end",get:function(){return this.getProps("end")}},{key:"bbox",get:function(){var t=this.isMulti,e=this.__cacheProps,r=this.sx,i=this.sy,n=this.currentStyle,a=n.boxShadow,o=n.filter,s=this.computedStyle,h=s.borderTopWidth,l=s.borderLeftWidth,u=s.marginTop,c=s.marginLeft,f=s.paddingTop,d=s.paddingLeft,_=s.strokeWidth,p=r+l+c+d,v=i+h+u+f;this.buildCache(p,v);var y=_t(dt(w.prototype),"bbox",this),g=.5*_,m=ue(this.__spreadByBoxShadowAndFilter(a,o),2),b=m[0],x=m[1];b+=g,x+=g;var k=e.points,M=e.controls;return t||(k=[k],M=[M]),k.forEach(function(t,e){if(!(!t||t.length<2||t[0].length<2||t[1].length<2))for(var r=M[e],i=ue(t[0],2),n=i[0],a=i[1],o=1,s=t.length;o<s;o++){var h,l,u=ue(t[o],2),c=u[0],f=u[1],d=r[o-1];d&&4===d.length?(h=pe.bboxBezier(n,a,d[0],d[1],d[2],d[3],c,f),y[0]=Math.min(y[0],h[0]-b),y[1]=Math.min(y[1],h[1]-x),y[2]=Math.max(y[2],h[2]+b),y[3]=Math.max(y[3],h[3]+x)):d&&2===d.length?(l=pe.bboxBezier(n,a,d[0],d[1],c,f),y[0]=Math.min(y[0],l[0]-b),y[1]=Math.min(y[1],l[1]-x),y[2]=Math.max(y[2],l[2]+b),y[3]=Math.max(y[3],l[3]+x)):(y[0]=Math.min(y[0],n-b),y[1]=Math.min(y[1],c-x),y[2]=Math.max(y[2],n+b),y[3]=Math.max(y[3],c+x)),n=c,a=f}}),y}}]),w}(),wa=function(){t(s,Ma);var r=e(s);function s(t,e){return l(this,s),r.call(this,t,e)}return u(s,[{key:"__getPoints",value:function(t,e,r,i,n,a){var o=_t(dt(s.prototype),"__getPoints",this).call(this,t,e,r,i,n,a);return a||o.push(o[0]),o}}]),s}(),Aa=_e.isNil;function Sa(t,e,r,i){return r=Math.max(r,0),0<=(i%=360)&&i<90?[t+Math.sin(i*Math.PI/180)*r,e-Math.cos(i*Math.PI/180)*r]:90<=i&&i<180?[t+Math.cos((i-90)*Math.PI/180)*r,e+Math.sin((i-90)*Math.PI/180)*r]:180<=i&&i<270?[t-Math.cos((270-i)*Math.PI/180)*r,e+Math.sin((270-i)*Math.PI/180)*r]:[t-Math.sin((360-i)*Math.PI/180)*r,e-Math.cos((360-i)*Math.PI/180)*r]}function Ea(t,e){return t=parseFloat(t),isNaN(t)&&(t=e),t}var Ta=function(){t(R,Zi);var i=e(R);function R(t,e){var r;return l(this,R),(r=i.call(this,t,e)).isMulti?(r.__begin=[0],r.__end=[0],r.__r=[1],Array.isArray(e.begin)&&(r.__begin=e.begin.map(function(t){return Ea(t,0)})),Array.isArray(e.end)&&(r.__end=e.end.map(function(t){return Ea(t,0)})),Array.isArray(e.r)&&(r.__r=e.r.map(function(t){return Ea(t,1)})),Array.isArray(e.edge)&&(r.__edge=e.edge.map(function(t){return!!t})),Array.isArray(e.closure)&&(r.__closure=e.closure.map(function(t){return!!t}))):(r.__begin=r.__end=0,r.__r=1,r.__edge=!1,r.__closure=!1,Aa(e.begin)||(r.__begin=Ea(e.begin,0)),Aa(e.end)||(r.__end=Ea(e.end,0)),Aa(e.r)||(r.__r=Ea(e.r,1)),Aa(e.edge)||(r.__edge=!!e.edge),Aa(e.closure)||(r.__closure=!!e.closure)),r}return u(R,[{key:"buildCache",value:function(u,c){var t,e,r,i,n,a,o,s,f=this.width,h=this.begin,d=this.end,_=this.r,l=this.edge,p=this.closure,v=this.__cacheProps,y=this.isMulti;return Aa(v.begin)&&(t=!0,v.begin=h),Aa(v.end)&&(t=!0,v.end=d),Aa(v.r)&&(t=!0,v.r=y?_.map(function(t){return t*f*.5}):_*f*.5),_=v.r,Aa(v.edge)&&(t=!0,v.edge=l),Aa(v.closure)&&(t=!0,v.closure=p),t&&(y?(v.x1=[],v.x2=[],v.y1=[],v.y2=[],v.large=[],v.d=[],h.forEach(function(t,e){var r=Aa(_[e])?.5*f:_[e],i=ue(Sa(u,c,r,t),2),n=i[0],a=i[1],o=ue(Sa(u,c,r,d[e]||0),2),s=o[0],h=o[1],l=180<(d[e]||0)-t?1:0;v.x1.push(n),v.x2.push(s),v.y1.push(a),v.y2.push(h),v.large.push(l)})):(r=(e=ue(Sa(u,c,_,h),2))[0],i=e[1],a=(n=ue(Sa(u,c,_,d),2))[0],o=n[1],s=180<d-h?1:0,v.x1=r,v.x2=a,v.y1=i,v.y2=o,v.large=s)),t}},{key:"render",value:function(t,e,r,i){var n=this,a=_t(dt(R.prototype),"render",this).call(this,t,e,r,i);if(a.break)return a;var o=a.cx,s=a.cy,h=a.fill,l=a.stroke,u=a.strokeWidth,c=a.strokeDasharrayStr,f=a.strokeLinecap,d=a.strokeLinejoin,_=a.strokeMiterlimit,p=a.dx,v=a.dy,y=this.width,g=this.__cacheProps,m=this.isMulti;this.buildCache(o,s);var b=g.begin,x=g.end,k=g.r,M=g.x1,w=g.y1,A=g.x2,S=g.y2,E=g.edge,T=g.large,P=g.closure;return t===fe.CANVAS?(r.beginPath(),m?b.forEach(function(t,e){return Vt.canvasSector(r,o,s,k[e],M[e],w[e],A[e],S[e],u,t[e],x[e],T[e],E[e],P[e],p,v)}):Vt.canvasSector(r,o,s,k,M,w,A,S,u,b,x,T,E,P,p,v),r.fill(),r.closePath()):t===fe.SVG&&(m?b.forEach(function(t,e){var r=Aa(k[e])?.5*y:k[e];n.__genSector(E[e],Vt.svgSector(o,s,r,M[e],w[e],A[e],S[e],u,T[e],E[e],P[e]),h,l,u,c,f,d,_)}):this.__genSector(E,Vt.svgSector(o,s,k,M,w,A,S,u,T,E,P),h,l,u,c,f,d,_)),a}},{key:"__genSector",value:function(t,e,r,i,n,a,o,s,h){var l,u;t?(l=[["d",e[0]],["fill",r],["stroke",i],["stroke-width",n]],this.__propsStrokeStyle(l,a,o,s,h),this.addGeom("path",l)):(this.addGeom("path",[["d",e[0]],["fill",r]]),0<n&&(u=[["d",e[1]],["fill","none"],["stroke",i],["stroke-width",n]],this.__propsStrokeStyle(u,a,o,s,h),this.addGeom("path",u)))}},{key:"begin",get:function(){return this.getProps("begin")}},{key:"end",get:function(){return this.getProps("end")}},{key:"r",get:function(){return this.getProps("r")}},{key:"edge",get:function(){return this.getProps("edge")}},{key:"closure",get:function(){return this.getProps("closure")}},{key:"bbox",get:function(){var t=this.isMulti,e=this.__cacheProps,r=this.sx,i=this.sy,n=this.width,a=this.height,o=this.currentStyle,s=o.boxShadow,h=o.filter,l=this.computedStyle,u=l.borderTopWidth,c=l.borderLeftWidth,f=l.marginTop,d=l.marginLeft,_=l.paddingTop,p=l.paddingLeft,v=l.strokeWidth,y=r+c+d+p+.5*n,g=i+u+f+_+.5*a;this.buildCache(y,g);var m,b=0,b=t?(m=0,e.r.forEach(function(t){m=Math.max(t,m)}),m):e.r,x=_t(dt(R.prototype),"bbox",this),k=.5*v,M=ue(this.__spreadByBoxShadowAndFilter(s,h),2),w=M[0],A=M[1],S=y-b-(w+=k),E=y+b+w,T=g-b-(A+=k),P=g+b+A;return x[0]=Math.min(x[0],S),x[1]=Math.min(x[1],T),x[2]=Math.max(x[2],E),x[3]=Math.max(x[3],P),x}}]),R}(),Pa=_e.isNil;function Ra(t,e,r,i,n,a){var o=4<arguments.length&&void 0!==n?n:0,s=5<arguments.length&&void 0!==a?a:0;if(0===o||0===s)return[[t,e],[t+r,e],[t+r,e+i],[t,e+i],[t,e]];var h=o*pe.H,l=s*pe.H;return[[t+o,e],[t+r-o,e],[t+r+h-o,e,t+r,e+s-l,t+r,e+s],[t+r,e+i-s],[t+r,e+i+l-s,t+r+h-o,e+i,t+r-o,e+i],[t+o,e+i],[t+o-h,e+i,t,e+i+l-s,t,e+i-s],[t,e+s],[t,e+s-l,t+o-h,e,t+o,e]]}function Ca(t){return t=parseFloat(t),isNaN(t)&&(t=0),t}var Oa=function(){t(k,Zi);var i=e(k);function k(t,e){var r;return l(this,k),(r=i.call(this,t,e)).isMulti?(r.__rx=[0],r.__ry=[0],Array.isArray(e.rx)&&(r.__rx=e.rx.map(Ca)),Array.isArray(e.ry)&&(r.__ry=e.ry.map(Ca))):(r.__rx=r.__ry=0,Pa(e.rx)||(r.__rx=Ca(e.rx)),Pa(e.ry)||(r.__ry=Ca(e.ry))),r}return u(k,[{key:"buildCache",value:function(r,i){var t,e,n,a=this.width,o=this.height,s=this.rx,h=this.ry,l=this.__cacheProps,u=this.isMulti;return Pa(l.rx)&&(t=!0,l.rx=u?s.map(function(t){return Math.min(t,.5)*a}):Math.min(s,.5)*a),Pa(l.ry)&&(t=!0,l.ry=u?s.map(function(t){return Math.min(t,.5)*o}):Math.min(h,.5)*o),t&&(e=l.rx,n=l.ry,l.list=u?e.map(function(t,e){return Ra(r,i,a,o,t,n[e])}):Ra(r,i,a,o,e,n)),t}},{key:"render",value:function(t,e,r,i){var n=_t(dt(k.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.originX,o=n.originY,s=n.fill,h=n.stroke,l=n.strokeWidth,u=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,d=n.strokeMiterlimit,_=n.dx,p=n.dy,v=this.__cacheProps,y=this.isMulti;this.buildCache(a,o);var g,m,b=v.list;return t===fe.CANVAS?(r.beginPath(),y?b.forEach(function(t){return Vt.canvasPolygon(r,t,_,p)}):Vt.canvasPolygon(r,b,_,p),r.fill(),0<l&&r.stroke(),r.closePath()):t===fe.SVG&&(g="",y?b.forEach(function(t){return g+=Vt.svgPolygon(t)}):g=Vt.svgPolygon(b),m=[["d",g],["fill",s],["stroke",h],["stroke-width",l]],this.__propsStrokeStyle(m,u,c,f,d),this.addGeom("path",m)),n}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}},{key:"bbox",get:function(){var t=this.sx,e=this.sy,r=this.width,i=this.height,n=this.currentStyle,a=n.boxShadow,o=n.filter,s=this.computedStyle,h=s.borderTopWidth,l=s.borderLeftWidth,u=s.marginTop,c=s.marginLeft,f=s.paddingTop,d=s.paddingLeft,_=s.strokeWidth,p=t+l+c+d,v=e+h+u+f;this.buildCache(p,v);var y=_t(dt(k.prototype),"bbox",this),g=.5*_,m=ue(this.__spreadByBoxShadowAndFilter(a,o),2),b=m[0],x=m[1];return b+=g,x+=g,y[0]=Math.min(y[0],p-b),y[1]=Math.min(y[1],v-x),y[2]=Math.min(y[2],p+r+b),y[3]=Math.min(y[3],v+i+x),y}}]),k}(),La=_e.isNil;function Fa(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var Na=function(){t(R,Zi);var i=e(R);function R(t,e){var r;return l(this,R),(r=i.call(this,t,e)).isMulti?(r.__r=[1],Array.isArray(e.r)?r.__r=e.r.map(Fa):La(e.r)||(r.__r=Fa(e.r))):(r.__r=1,La(e.r)||(r.__r=Fa(e.r))),r}return u(R,[{key:"buildCache",value:function(e,r){var i=this.width,t=this.r,n=this.__cacheProps,a=this.isMulti;La(n.r)&&(a?(n.r=t.map(function(t){return t*i*.5}),n.list=n.r.map(function(t){return pe.ellipsePoints(e,r,t)})):(n.r=t*i*.5,n.list=pe.ellipsePoints(e,r,n.r)))}},{key:"render",value:function(t,e,r,i){var n=_t(dt(R.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.cx,o=n.cy,s=n.fill,h=n.stroke,l=n.strokeWidth,u=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,d=n.strokeMiterlimit,_=n.dx,p=n.dy,v=this.__cacheProps,y=this.isMulti;this.buildCache(a,o);var g,m,b=v.list;return t===fe.CANVAS?(r.beginPath(),y?b.forEach(function(t){return Vt.canvasPolygon(r,t,_,p)}):Vt.canvasPolygon(r,b,_,p),r.fill(),0<l&&r.stroke(),r.closePath()):t===fe.SVG&&(g="",y?b.forEach(function(t){return g+=Vt.svgPolygon(t)}):g=Vt.svgPolygon(b),m=[["d",g],["fill",s],["stroke",h],["stroke-width",l]],this.__propsStrokeStyle(m,u,c,f,d),this.addGeom("path",m)),n}},{key:"r",get:function(){return this.getProps("r")}},{key:"bbox",get:function(){var t=this.isMulti,e=this.__cacheProps,r=this.sx,i=this.sy,n=this.width,a=this.height,o=this.currentStyle,s=o.boxShadow,h=o.filter,l=this.computedStyle,u=l.borderTopWidth,c=l.borderLeftWidth,f=l.marginTop,d=l.marginLeft,_=l.paddingTop,p=l.paddingLeft,v=l.strokeWidth,y=r+c+d+p+.5*n,g=i+u+f+_+.5*a;this.buildCache(y,g);var m,b=0,b=t?(m=0,e.r.forEach(function(t){m=Math.max(t,m)}),m):e.r,x=_t(dt(R.prototype),"bbox",this),k=.5*v,M=ue(this.__spreadByBoxShadowAndFilter(s,h),2),w=M[0],A=M[1],S=y-b-(w+=k),E=y+b+w,T=g-b-(A+=k),P=g+b+A;return x[0]=Math.min(x[0],S),x[1]=Math.min(x[1],T),x[2]=Math.max(x[2],E),x[3]=Math.max(x[3],P),x}}]),R}(),Ia=_e.isNil;function Ba(t){return t=parseFloat(t),isNaN(t)&&(t=1),t}var Da=function(){t(O,Zi);var i=e(O);function O(t,e){var r;return l(this,O),(r=i.call(this,t,e)).isMulti?(r.__rx=[1],r.__ry=[1],Array.isArray(e.rx)?r.__rx=e.rx.map(Ba):Ia(e.rx)||(r.__rx=[Ba(e.rx)]),Array.isArray(e.ry)?r.__ry=e.ry.map(Ba):Ia(e.ry)||(r.__ry=[Ba(e.ry)])):(r.__rx=1,Ia(e.rx)||(r.__rx=Ba(e.rx)),r.__ry=1,Ia(e.ry)||(r.__ry=Ba(e.ry))),r}return u(O,[{key:"buildCache",value:function(r,i){var t,e,n,a=this.width,o=this.height,s=this.rx,h=this.ry,l=this.__cacheProps,u=this.isMulti;return Ia(l.rx)&&(t=!0,l.rx=u?s.map(function(t){return t*a*.5}):s*a*.5),Ia(l.ry)&&(t=!0,l.ry=u?h.map(function(t){return t*o*.5}):h*o*.5),t&&(e=l.rx,n=l.ry,l.list=u?e.map(function(t,e){return pe.ellipsePoints(r,i,t,n[e])}):pe.ellipsePoints(r,i,e,n)),t}},{key:"render",value:function(t,e,r,i){var n=_t(dt(O.prototype),"render",this).call(this,t,e,r,i);if(n.break)return n;var a=n.cx,o=n.cy,s=n.fill,h=n.stroke,l=n.strokeWidth,u=n.strokeDasharrayStr,c=n.strokeLinecap,f=n.strokeLinejoin,d=n.strokeMiterlimit,_=n.dx,p=n.dy,v=this.__cacheProps,y=this.isMulti;this.buildCache(a,o);var g,m,b=v.list;return t===fe.CANVAS?(r.beginPath(),y?b.forEach(function(t){return Vt.canvasPolygon(r,t,_,p)}):Vt.canvasPolygon(r,b,_,p),r.fill(),0<l&&r.stroke(),r.closePath()):t===fe.SVG&&(g="",y?b.forEach(function(t){return g+=Vt.svgPolygon(t)}):g=Vt.svgPolygon(b),m=[["d",g],["fill",s],["stroke",h],["stroke-width",l]],this.__propsStrokeStyle(m,u,c,f,d),this.addGeom("path",m)),n}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}},{key:"bbox",get:function(){var t=this.isMulti,r=this.__cacheProps,e=this.sx,i=this.sy,n=this.width,a=this.height,o=this.currentStyle,s=o.boxShadow,h=o.filter,l=this.computedStyle,u=l.borderTopWidth,c=l.borderLeftWidth,f=l.marginTop,d=l.marginLeft,_=l.paddingTop,p=l.paddingLeft,v=l.strokeWidth,y=e+c+d+p+.5*n,g=i+u+f+_+.5*a;this.buildCache(y,g);var m,b,x=0,k=0,k=t?(b=m=0,r.rx.forEach(function(t,e){m=Math.max(t,m),b=Math.max(k,r.ry[e])}),x=m,b):(x=r.rx,r.ry),M=_t(dt(O.prototype),"bbox",this),w=.5*v,A=ue(this.__spreadByBoxShadowAndFilter(s,h),2),S=A[0],E=A[1],T=y-x-(S+=w),P=y+x+S,R=g-k-(E+=w),C=g+k+E;return M[0]=Math.min(M[0],T),M[1]=Math.min(M[1],R),M[2]=Math.max(M[2],P),M[3]=Math.max(M[3],C),M}}]),O}(),Wa={skewX:"kx",skewY:"ky",transform:"tf",fontSize:"fz",offset:"os",easing:"e",filter:"ft",boxShadow:"bd"},Ga={os:"offset",e:"easing",ft:"filter",bd:"boxShadow"},Ha={value:"v",options:"o"},za={},Ya={duration:"dt",delay:"d",endDelay:"ed",iterations:"i",direction:"dc",fill:"f",fps:"fp",playbackRate:"p",spfLimit:"sl"},Xa={};it.DOM_ENTRY_SET.concat(it.GEOM_ENTRY_SET).forEach(function(t){var e,r=t.k;Wa.hasOwnProperty(r)?Ga[Wa[r]]=r:(e=r.charAt(0)+r.replace(/[a-z]/g,"").toLowerCase(),Wa[r]=e,Ga[e]=r)}),Object.keys(Ha).forEach(function(t){za[Ha[t]]=t}),Object.keys(Ya).forEach(function(t){Xa[Ya[t]]=t});var $a={fullCssProperty:Wa,abbrCssProperty:Ga,fullAnimate:Ha,abbrAnimate:za,fullAnimateOption:Ya,abbrAnimateOption:Xa},ja=_.TYPE_VD,Va=_.TYPE_GM,qa=_.TYPE_CP,Ua=_e.isNil,Za=_e.isFunction,Ka=_e.isPrimitive,Ja=_e.clone,Qa=_e.extend,to=$a.abbrCssProperty,eo=$a.abbrAnimateOption,ro=$a.abbrAnimate;function io(n,a){n&&Object.keys(n).forEach(function(t){var e,r,i;0===t.indexOf("var-")?(e=t.slice(4),a.hasOwnProperty(e)&&(r=a[e],n["var-"+r]=n[t])):a.hasOwnProperty(t)&&(i=a[t],n[i]=n[t],delete n[t])})}function no(s,h){s&&h&&Object.keys(s).forEach(function(t){if(0===t.indexOf("var-")){var e=s[t];if(!e)return;var r=t.slice(4);if(e.id&&h.hasOwnProperty(e.id)){var i=h[e.id];if(void 0===i)return;if(-1<r.indexOf(".")){for(var n=r.split("."),a=n.length,o=0;o<a-1;o++)r=n[o],s[r]?s=s[r]:console.error("parseJson vars is not exist: "+e.id+", "+t+", "+n.slice(0,o).join("."));r=n[a-1]}Za(i)&&(i=i(e)),s[r]=i}}})}function ao(e,r){e.tagName=r.tagName,e.props=Ja(r.props),e.children=r.children,Object.keys(r).forEach(function(t){0!==t.indexOf("var-")||e.hasOwnProperty(t)||(e[t]=r[t])}),e.libraryId=null;var t,i,n=e.init;n&&(i=(t=e.props=e.props||{}).style,Qa(t,n),i&&(Qa(i,n.style),t.style=i),e.init=null)}function oo(r,t,i,n,e){var a=4<arguments.length&&void 0!==e?e:{};if(Ka(t)||t instanceof M)return t;if(Array.isArray(t))return t.map(function(t){return oo(r,t,i,n,a)});var o=t.library,s=t.libraryId;if(Array.isArray(o))a={},o.forEach(function(t){!function(t,i){var e=t.id,r=t.children;if(Array.isArray(r)&&r.forEach(function(t){if(!Ka(t)){var e=t.libraryId;if(Ua(e))return;var r=i[e];if(!r)throw new Error("Link library item miss libraryId: "+e);ao(t,r)}}),Ua(e))throw new Error("Library item miss id: "+JSON.stringify(t));i[e]=t}(t,a)}),t.library=null,t.libraryId=null;else if(!Ua(s)&&a){var h=a[s];if(!h)throw new Error("Link library miss id: "+s);ao(t,h)}var l=t.tagName,u=t.props,c=void 0===u?{}:u,f=t.children,d=void 0===f?[]:f,_=t.animate,p=void 0===_?[]:_,v=t.__animateRecords;if(!l)throw new Error("Dom must have a tagName: "+JSON.stringify(t));var y,g,m,b,x,k=c.style;return io(k,to),no(k,n),no(c,n),no(t,n),y="$"===l.charAt(0)?r.createGm(l,c):r.createVd(l,c,d.map(function(t,e){return t&&-1<[ja,Va,qa].indexOf(t.$$type)?t:oo(r,t,i,n,a)})),v&&(y.__animateRecords=v),p&&(Array.isArray(p)?(p.forEach(function(t){io(t,ro);var e=t.value,r=t.options;Array.isArray(e)&&e.length&&(m=!0,e.forEach(function(t){io(t,to),no(t,n)})),r&&(io(r,eo),no(r,n))}),m&&(g={animate:p,target:y})):(io(p,ro),b=p.value,x=p.options,Array.isArray(b)&&b.length&&(b.forEach(function(t){io(t,to),no(t,n)}),g={animate:p,target:y}),x&&(io(x,eo),no(x,n)))),g&&i.push(g),y}var so={parse:function(t,e,r,i){var n=3<arguments.length&&void 0!==i?i:{};e=_e.clone(e),tr.isDom(r)||(n=r||{},r=null);var a=[],o=oo(t,e,a,n.vars);if(r){var s=e.tagName;if(-1===["canvas","svg"].indexOf(s))throw new Error("Parse dom must be canvas/svg");var h=n.controller instanceof $n?n.controller:o.animateController;t.render(o,r),a.forEach(function(t){t.target=t.target.vd}),!1!==n.autoPlay?(h.__auto=h.__auto.concat(a),h.__playAuto()):h.__records=h.__records.concat(a)}else a.length&&(o.__animateRecords={options:n,list:a,controller:n.controller instanceof $n?n.controller:null});return o},abbr:$a},ho={css:Yt,reset:it,unit:f,font:d},lo={Animation:$r,Controller:$n,easing:mr,frame:hr},uo={level:qr,change:Ot,Page:Qr,Cache:ti};Zi.register("$line",va),Zi.register("$polyline",Ma),Zi.register("$polygon",wa),Zi.register("$sector",Ta),Zi.register("$rect",Oa),Zi.register("$circle",Na),Zi.register("$ellipse",Da);var co={version:"0.40.8",render:function(t,e){if(!(t instanceof ua))throw new Error("Render dom must be canvas/svg");return e&&t.appendTo(e),t},createElement:function(t,e){e=e||{};for(var r=[],i=2,n=arguments.length;i<n;i++)r.push(arguments[i]);return _e.isString(t)?"$"===t.charAt(0)?this.createGm(t,e):this.createVd(t,e,r):t?this.createCp(t,e,r):void 0},createVd:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:[];if(-1<["canvas","svg"].indexOf(t))return new ua(t,e,i);if(Ti.TAG_NAME.hasOwnProperty(t))return{tagName:t,props:e,children:i,$$type:_.TYPE_VD};throw new Error("Can not use <".concat(t,">"))},createGm:function(t,e){return{tagName:t,props:e,$$type:_.TYPE_GM}},createCp:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:[];return e.children=i,{klass:t,props:e,$$type:_.TYPE_CP}},parse:function(t,e,r){return so.parse(this,t,e,r)},mode:fe,Component:Gi,Node:M,Text:$t,Geom:Zi,Xom:Si,Dom:hn,Root:ua,Event:nr,util:_e,inject:tr,style:ho,parser:so,animate:lo,math:Jt,builder:Ni,updater:Tn,refresh:uo};return Ni.ref({Xom:Si,Dom:hn,Img:fn,Geom:Zi,Component:Gi}),Tn.ref({Xom:Si,Dom:hn,Img:fn,Geom:Zi,Component:Gi}),"undefined"!=typeof window&&(window.karas=co),co});
//# sourceMappingURL=index.min.js.map
